{"url":"https://api.github.com/repos/sktime/sktime/pulls/2884","id":980615626,"node_id":"PR_kwDOCVKAsc46cwHK","html_url":"https://github.com/sktime/sktime/pull/2884","diff_url":"https://github.com/sktime/sktime/pull/2884.diff","patch_url":"https://github.com/sktime/sktime/pull/2884.patch","issue_url":"https://api.github.com/repos/sktime/sktime/issues/2884","number":2884,"state":"closed","locked":false,"title":"[WIP] [ENH] Reimplement benchmarking with `kotsu`","user":{"login":"DBCerigo","id":8318425,"node_id":"MDQ6VXNlcjgzMTg0MjU=","avatar_url":"https://avatars.githubusercontent.com/u/8318425?v=4","gravatar_id":"","url":"https://api.github.com/users/DBCerigo","html_url":"https://github.com/DBCerigo","followers_url":"https://api.github.com/users/DBCerigo/followers","following_url":"https://api.github.com/users/DBCerigo/following{/other_user}","gists_url":"https://api.github.com/users/DBCerigo/gists{/gist_id}","starred_url":"https://api.github.com/users/DBCerigo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DBCerigo/subscriptions","organizations_url":"https://api.github.com/users/DBCerigo/orgs","repos_url":"https://api.github.com/users/DBCerigo/repos","events_url":"https://api.github.com/users/DBCerigo/events{/privacy}","received_events_url":"https://api.github.com/users/DBCerigo/received_events","type":"User","site_admin":false},"body":"#### To do:\r\n- [ ] Generally, shift use case from \"benchmarking all sktime estimators\" to \"enable a user to benchmark something they care about\"\r\n- [ ] Spike on implementing new interface that wraps kotsu and only relies on sktime objects, for easy user life\r\n- [ ] Implement storing folds and predictions\r\n- [ ] Add dependencies \r\n- [ ] Move nb to https://github.com/alan-turing-institute/sktime/tree/main/examples\r\n- [ ] Expand nb to include examples, to guide a user on its usage (?)\r\n\r\n#### Usage instructions:\r\n- Dependencies to install specific for this PR: `kotsu`, `jupyter`, `autoreload` `typing_extensions`\r\n- Start a jupyter server and run the `sktime/benchmarking/run.ipynb`\r\n\r\n#### Reference Issues/PRs\r\nSee discussion: https://github.com/alan-turing-institute/sktime/issues/2777\r\nSee discussion: https://github.com/alan-turing-institute/sktime/issues/2804\r\nSee spike: https://github.com/alan-turing-institute/sktime/pull/2805\r\n\r\n\r\n#### What does this implement/fix? Explain your changes.\r\nImplement benchmarking using `kotsu`. \r\n- Instantiation of a `validation_registry` and `estimator_registry` in `benchmarking`'s `init`\r\n- A `validations.py` module which defines a paramaterised validation run, which takes a `dataset_loader: Callable`, a `cv_splitter: BaseSplitter`, and a list of `scorers: List[BaseMetric]`. The module registers an example specification.\r\n- An `estimators.py` module which imports and registers estimators + their configs (i.e. param specifications)\r\n- A `run.ipynb` which runs the registry of estimators through the validations, storing the benchmark results\r\n\r\nLikely we will eventually want to have separate registries corresponding to different types of predictions (classification, regression, etc.), for now this just implements for regression (point prediction).  \r\n\r\n#### Does your contribution introduce a new dependency? If yes, which one?\r\n- `kotsu` - soft dependency\r\n- TBC: `jupyter` - soft dependency - depending on discussions outcome\r\n\r\n#### What should a reviewer concentrate their feedback on?\r\n\r\nThe understandability, flexibility, extendability, and maintainability, of this benchmarking system implementation.\r\n\r\n#### To discuss at Tuesday 28th June meeting:\r\n(\"we\" refers to @DBCerigo @alex-hh @ali-tny) \r\n- [x] What [type of dependency](https://www.sktime.org/en/latest/developer_guide/dependencies.html#types-of-dependencies) will `kotsu` be? We think `soft`.\r\n    - Answer: TBD, but maybe a core dep given benchmarking is intended to be a core functionality. \r\n- [x] What interface wanted for running the benchmarking? We implemented a jupyter notebook.\r\n    - Answer: Likely jupyter notebook yes. Should put it in https://github.com/alan-turing-institute/sktime/tree/main/examples\r\n- [x] How much is the `benchmarking` module intended to \"enable an `sktime` user to do the benchmarking they want to do\" vs \"do benchmarking of all `sktime` estimators and have the results for anyone to see\"?\r\n    - Answer: Primarily the former. \r\n- [x] Should we register estimators in estimator modules or in benchmarking module? We think within benchmarking.\r\n    - Answer: In benchmarking module/not even at all, and just let users register on the models they want to, in a notebook.\r\n- [x] When we use kotsu, we often store copies of the folds, copies of the predictions on the training folds and predictions on the test folds - this enables one to read the predictions for an estimator easily to do deep-dive/comparison analysis. Would this be wanted in `sktime` benchmarking?\r\n    - Answer: Yep, probably want this. \r\n- [x] Should we implement visualisations/explorations/further analysis? In benchmarking there's some analysis (e.g. t-tests etc.) modules. Or should `sktime` just store the base benchmark results and let users do analysis on those as they see fit?\r\n    - Answer: Maybe add at least 1 basic plot/analysis in the example notebook. \r\n- [x] We're trying to write as little code as possible and rely on sktime functionality as much as possible . \r\n    - [x] `evaluate` only takes a single `scorer` - we would want to avoid re-running training and predictions for every scoring metric as occurs in this PR. We could extend `evaluate` to take a list of scorers?\r\n        - Answer: Probably resolved when implementing storing fold data + predictions.  \r\n\r\n#### Any other comments?\r\n\r\n#### PR checklist\r\n\r\n##### For all contributions\r\n- [ ] I've added myself to the [list of contributors](https://github.com/alan-turing-institute/sktime/blob/main/.all-contributorsrc).\r\n- [ ] Optionally, I've updated sktime's [CODEOWNERS](https://github.com/alan-turing-institute/sktime/blob/main/CODEOWNERS) to receive notifications about future changes to these files.\r\n- [x] I've added unit tests and made sure they pass locally.\r\n- [x] The PR title starts with either [ENH], [MNT], [DOC], or [BUG] indicating whether the PR topic is related to enhancement, maintenance, documentation, or bug.\r\n","created_at":"2022-06-27T21:35:11Z","updated_at":"2022-07-24T08:11:07Z","closed_at":"2022-07-24T08:11:07Z","merged_at":null,"merge_commit_sha":"dc54e68b5558abb6df99ff59b7aee01bfd59c945","assignee":null,"assignees":[],"requested_reviewers":[{"login":"fkiraly","id":7985502,"node_id":"MDQ6VXNlcjc5ODU1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7985502?v=4","gravatar_id":"","url":"https://api.github.com/users/fkiraly","html_url":"https://github.com/fkiraly","followers_url":"https://api.github.com/users/fkiraly/followers","following_url":"https://api.github.com/users/fkiraly/following{/other_user}","gists_url":"https://api.github.com/users/fkiraly/gists{/gist_id}","starred_url":"https://api.github.com/users/fkiraly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkiraly/subscriptions","organizations_url":"https://api.github.com/users/fkiraly/orgs","repos_url":"https://api.github.com/users/fkiraly/repos","events_url":"https://api.github.com/users/fkiraly/events{/privacy}","received_events_url":"https://api.github.com/users/fkiraly/received_events","type":"User","site_admin":false}],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/sktime/sktime/pulls/2884/commits","review_comments_url":"https://api.github.com/repos/sktime/sktime/pulls/2884/comments","review_comment_url":"https://api.github.com/repos/sktime/sktime/pulls/comments{/number}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/2884/comments","statuses_url":"https://api.github.com/repos/sktime/sktime/statuses/c483a606ca4c9865fdd5ff0b8f6994c430253fcc","head":{"label":"datavaluepeople:benchmarking-kotsu","ref":"benchmarking-kotsu","sha":"c483a606ca4c9865fdd5ff0b8f6994c430253fcc","user":{"login":"datavaluepeople","id":64023538,"node_id":"MDEyOk9yZ2FuaXphdGlvbjY0MDIzNTM4","avatar_url":"https://avatars.githubusercontent.com/u/64023538?v=4","gravatar_id":"","url":"https://api.github.com/users/datavaluepeople","html_url":"https://github.com/datavaluepeople","followers_url":"https://api.github.com/users/datavaluepeople/followers","following_url":"https://api.github.com/users/datavaluepeople/following{/other_user}","gists_url":"https://api.github.com/users/datavaluepeople/gists{/gist_id}","starred_url":"https://api.github.com/users/datavaluepeople/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/datavaluepeople/subscriptions","organizations_url":"https://api.github.com/users/datavaluepeople/orgs","repos_url":"https://api.github.com/users/datavaluepeople/repos","events_url":"https://api.github.com/users/datavaluepeople/events{/privacy}","received_events_url":"https://api.github.com/users/datavaluepeople/received_events","type":"Organization","site_admin":false},"repo":{"id":502644904,"node_id":"R_kgDOHfXAqA","name":"sktime","full_name":"datavaluepeople/sktime","private":false,"owner":{"login":"datavaluepeople","id":64023538,"node_id":"MDEyOk9yZ2FuaXphdGlvbjY0MDIzNTM4","avatar_url":"https://avatars.githubusercontent.com/u/64023538?v=4","gravatar_id":"","url":"https://api.github.com/users/datavaluepeople","html_url":"https://github.com/datavaluepeople","followers_url":"https://api.github.com/users/datavaluepeople/followers","following_url":"https://api.github.com/users/datavaluepeople/following{/other_user}","gists_url":"https://api.github.com/users/datavaluepeople/gists{/gist_id}","starred_url":"https://api.github.com/users/datavaluepeople/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/datavaluepeople/subscriptions","organizations_url":"https://api.github.com/users/datavaluepeople/orgs","repos_url":"https://api.github.com/users/datavaluepeople/repos","events_url":"https://api.github.com/users/datavaluepeople/events{/privacy}","received_events_url":"https://api.github.com/users/datavaluepeople/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/datavaluepeople/sktime","description":"A unified framework for machine learning with time series","fork":true,"url":"https://api.github.com/repos/datavaluepeople/sktime","forks_url":"https://api.github.com/repos/datavaluepeople/sktime/forks","keys_url":"https://api.github.com/repos/datavaluepeople/sktime/keys{/key_id}","collaborators_url":"https://api.github.com/repos/datavaluepeople/sktime/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/datavaluepeople/sktime/teams","hooks_url":"https://api.github.com/repos/datavaluepeople/sktime/hooks","issue_events_url":"https://api.github.com/repos/datavaluepeople/sktime/issues/events{/number}","events_url":"https://api.github.com/repos/datavaluepeople/sktime/events","assignees_url":"https://api.github.com/repos/datavaluepeople/sktime/assignees{/user}","branches_url":"https://api.github.com/repos/datavaluepeople/sktime/branches{/branch}","tags_url":"https://api.github.com/repos/datavaluepeople/sktime/tags","blobs_url":"https://api.github.com/repos/datavaluepeople/sktime/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/datavaluepeople/sktime/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/datavaluepeople/sktime/git/refs{/sha}","trees_url":"https://api.github.com/repos/datavaluepeople/sktime/git/trees{/sha}","statuses_url":"https://api.github.com/repos/datavaluepeople/sktime/statuses/{sha}","languages_url":"https://api.github.com/repos/datavaluepeople/sktime/languages","stargazers_url":"https://api.github.com/repos/datavaluepeople/sktime/stargazers","contributors_url":"https://api.github.com/repos/datavaluepeople/sktime/contributors","subscribers_url":"https://api.github.com/repos/datavaluepeople/sktime/subscribers","subscription_url":"https://api.github.com/repos/datavaluepeople/sktime/subscription","commits_url":"https://api.github.com/repos/datavaluepeople/sktime/commits{/sha}","git_commits_url":"https://api.github.com/repos/datavaluepeople/sktime/git/commits{/sha}","comments_url":"https://api.github.com/repos/datavaluepeople/sktime/comments{/number}","issue_comment_url":"https://api.github.com/repos/datavaluepeople/sktime/issues/comments{/number}","contents_url":"https://api.github.com/repos/datavaluepeople/sktime/contents/{+path}","compare_url":"https://api.github.com/repos/datavaluepeople/sktime/compare/{base}...{head}","merges_url":"https://api.github.com/repos/datavaluepeople/sktime/merges","archive_url":"https://api.github.com/repos/datavaluepeople/sktime/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/datavaluepeople/sktime/downloads","issues_url":"https://api.github.com/repos/datavaluepeople/sktime/issues{/number}","pulls_url":"https://api.github.com/repos/datavaluepeople/sktime/pulls{/number}","milestones_url":"https://api.github.com/repos/datavaluepeople/sktime/milestones{/number}","notifications_url":"https://api.github.com/repos/datavaluepeople/sktime/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/datavaluepeople/sktime/labels{/name}","releases_url":"https://api.github.com/repos/datavaluepeople/sktime/releases{/id}","deployments_url":"https://api.github.com/repos/datavaluepeople/sktime/deployments","created_at":"2022-06-12T14:52:34Z","updated_at":"2022-06-22T14:43:50Z","pushed_at":"2023-02-02T10:51:46Z","git_url":"git://github.com/datavaluepeople/sktime.git","ssh_url":"git@github.com:datavaluepeople/sktime.git","clone_url":"https://github.com/datavaluepeople/sktime.git","svn_url":"https://github.com/datavaluepeople/sktime","homepage":"https://sktime.org","size":54373,"stargazers_count":0,"watchers_count":0,"language":"Python","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause","node_id":"MDc6TGljZW5zZTU="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"main"}},"base":{"label":"sktime:main","ref":"main","sha":"adad11df6da0a133ba75d5cbe88f0c92dc774889","user":{"login":"sktime","id":56396127,"node_id":"MDEyOk9yZ2FuaXphdGlvbjU2Mzk2MTI3","avatar_url":"https://avatars.githubusercontent.com/u/56396127?v=4","gravatar_id":"","url":"https://api.github.com/users/sktime","html_url":"https://github.com/sktime","followers_url":"https://api.github.com/users/sktime/followers","following_url":"https://api.github.com/users/sktime/following{/other_user}","gists_url":"https://api.github.com/users/sktime/gists{/gist_id}","starred_url":"https://api.github.com/users/sktime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sktime/subscriptions","organizations_url":"https://api.github.com/users/sktime/orgs","repos_url":"https://api.github.com/users/sktime/repos","events_url":"https://api.github.com/users/sktime/events{/privacy}","received_events_url":"https://api.github.com/users/sktime/received_events","type":"Organization","site_admin":false},"repo":{"id":156401841,"node_id":"MDEwOlJlcG9zaXRvcnkxNTY0MDE4NDE=","name":"sktime","full_name":"sktime/sktime","private":false,"owner":{"login":"sktime","id":56396127,"node_id":"MDEyOk9yZ2FuaXphdGlvbjU2Mzk2MTI3","avatar_url":"https://avatars.githubusercontent.com/u/56396127?v=4","gravatar_id":"","url":"https://api.github.com/users/sktime","html_url":"https://github.com/sktime","followers_url":"https://api.github.com/users/sktime/followers","following_url":"https://api.github.com/users/sktime/following{/other_user}","gists_url":"https://api.github.com/users/sktime/gists{/gist_id}","starred_url":"https://api.github.com/users/sktime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sktime/subscriptions","organizations_url":"https://api.github.com/users/sktime/orgs","repos_url":"https://api.github.com/users/sktime/repos","events_url":"https://api.github.com/users/sktime/events{/privacy}","received_events_url":"https://api.github.com/users/sktime/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/sktime/sktime","description":"A unified framework for machine learning with time series","fork":false,"url":"https://api.github.com/repos/sktime/sktime","forks_url":"https://api.github.com/repos/sktime/sktime/forks","keys_url":"https://api.github.com/repos/sktime/sktime/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sktime/sktime/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sktime/sktime/teams","hooks_url":"https://api.github.com/repos/sktime/sktime/hooks","issue_events_url":"https://api.github.com/repos/sktime/sktime/issues/events{/number}","events_url":"https://api.github.com/repos/sktime/sktime/events","assignees_url":"https://api.github.com/repos/sktime/sktime/assignees{/user}","branches_url":"https://api.github.com/repos/sktime/sktime/branches{/branch}","tags_url":"https://api.github.com/repos/sktime/sktime/tags","blobs_url":"https://api.github.com/repos/sktime/sktime/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sktime/sktime/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sktime/sktime/git/refs{/sha}","trees_url":"https://api.github.com/repos/sktime/sktime/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sktime/sktime/statuses/{sha}","languages_url":"https://api.github.com/repos/sktime/sktime/languages","stargazers_url":"https://api.github.com/repos/sktime/sktime/stargazers","contributors_url":"https://api.github.com/repos/sktime/sktime/contributors","subscribers_url":"https://api.github.com/repos/sktime/sktime/subscribers","subscription_url":"https://api.github.com/repos/sktime/sktime/subscription","commits_url":"https://api.github.com/repos/sktime/sktime/commits{/sha}","git_commits_url":"https://api.github.com/repos/sktime/sktime/git/commits{/sha}","comments_url":"https://api.github.com/repos/sktime/sktime/comments{/number}","issue_comment_url":"https://api.github.com/repos/sktime/sktime/issues/comments{/number}","contents_url":"https://api.github.com/repos/sktime/sktime/contents/{+path}","compare_url":"https://api.github.com/repos/sktime/sktime/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sktime/sktime/merges","archive_url":"https://api.github.com/repos/sktime/sktime/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sktime/sktime/downloads","issues_url":"https://api.github.com/repos/sktime/sktime/issues{/number}","pulls_url":"https://api.github.com/repos/sktime/sktime/pulls{/number}","milestones_url":"https://api.github.com/repos/sktime/sktime/milestones{/number}","notifications_url":"https://api.github.com/repos/sktime/sktime/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sktime/sktime/labels{/name}","releases_url":"https://api.github.com/repos/sktime/sktime/releases{/id}","deployments_url":"https://api.github.com/repos/sktime/sktime/deployments","created_at":"2018-11-06T15:08:24Z","updated_at":"2023-02-05T08:09:43Z","pushed_at":"2023-02-05T11:07:39Z","git_url":"git://github.com/sktime/sktime.git","ssh_url":"git@github.com:sktime/sktime.git","clone_url":"https://github.com/sktime/sktime.git","svn_url":"https://github.com/sktime/sktime","homepage":"https://sktime.org","size":56018,"stargazers_count":6087,"watchers_count":6087,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":1016,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":644,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause","node_id":"MDc6TGljZW5zZTU="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["data-mining","data-science","forecasting","machine-learning","scikit-learn","time-series","time-series-analysis","time-series-classification","time-series-regression"],"visibility":"public","forks":1016,"open_issues":644,"watchers":6087,"default_branch":"main"}},"_links":{"self":{"href":"https://api.github.com/repos/sktime/sktime/pulls/2884"},"html":{"href":"https://github.com/sktime/sktime/pull/2884"},"issue":{"href":"https://api.github.com/repos/sktime/sktime/issues/2884"},"comments":{"href":"https://api.github.com/repos/sktime/sktime/issues/2884/comments"},"review_comments":{"href":"https://api.github.com/repos/sktime/sktime/pulls/2884/comments"},"review_comment":{"href":"https://api.github.com/repos/sktime/sktime/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/sktime/sktime/pulls/2884/commits"},"statuses":{"href":"https://api.github.com/repos/sktime/sktime/statuses/c483a606ca4c9865fdd5ff0b8f6994c430253fcc"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null,"merged":false,"mergeable":null,"rebaseable":null,"mergeable_state":"unknown","merged_by":null,"comments":6,"review_comments":3,"maintainer_can_modify":false,"commits":8,"additions":296,"deletions":0,"changed_files":5}