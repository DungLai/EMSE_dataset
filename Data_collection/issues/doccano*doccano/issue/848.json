{"url":"https://api.github.com/repos/doccano/doccano/issues/848","repository_url":"https://api.github.com/repos/doccano/doccano","labels_url":"https://api.github.com/repos/doccano/doccano/issues/848/labels{/name}","comments_url":"https://api.github.com/repos/doccano/doccano/issues/848/comments","events_url":"https://api.github.com/repos/doccano/doccano/issues/848/events","html_url":"https://github.com/doccano/doccano/issues/848","id":642246159,"node_id":"MDU6SXNzdWU2NDIyNDYxNTk=","number":848,"title":"How to upload a document with annotation from doccano API","user":{"login":"br-dr3","id":42852567,"node_id":"MDQ6VXNlcjQyODUyNTY3","avatar_url":"https://avatars.githubusercontent.com/u/42852567?v=4","gravatar_id":"","url":"https://api.github.com/users/br-dr3","html_url":"https://github.com/br-dr3","followers_url":"https://api.github.com/users/br-dr3/followers","following_url":"https://api.github.com/users/br-dr3/following{/other_user}","gists_url":"https://api.github.com/users/br-dr3/gists{/gist_id}","starred_url":"https://api.github.com/users/br-dr3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/br-dr3/subscriptions","organizations_url":"https://api.github.com/users/br-dr3/orgs","repos_url":"https://api.github.com/users/br-dr3/repos","events_url":"https://api.github.com/users/br-dr3/events{/privacy}","received_events_url":"https://api.github.com/users/br-dr3/received_events","type":"User","site_admin":false},"labels":[{"id":927327719,"node_id":"MDU6TGFiZWw5MjczMjc3MTk=","url":"https://api.github.com/repos/doccano/doccano/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":927327728,"node_id":"MDU6TGFiZWw5MjczMjc3Mjg=","url":"https://api.github.com/repos/doccano/doccano/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2020-06-19T22:28:22Z","updated_at":"2020-08-02T22:53:59Z","closed_at":"2020-08-02T22:53:59Z","author_association":"NONE","active_lock_reason":null,"body":"Some context:\r\nDoccanoDocumentDTO.py\r\n```\r\nfrom pydantic import BaseModel\r\nclass DoccanoAnnotationDTO(BaseModel):\r\n    id: Optional[int]\r\n    prob: int = 0\r\n    label: int\r\n    start_offset: int\r\n    end_offset: int\r\n    user: Optional[int]\r\n    document: Optional[int]\r\n\r\nclass DoccanoDocumentDTO(BaseModel):\r\n    id: Optional[int]\r\n    text: str\r\n    annotations: List[DoccanoAnnotationDTO]\r\n    meta: str = \"{}\"\r\n    annotation_approver: Optional[str]\r\n```\r\n\r\nDoccanoClient.py\r\n```    \r\ndef insert_new_document(\r\n    self, document: DoccanoDocumentDTO, project_id: int\r\n) -> DoccanoDocumentDTO:\r\n    url = self.doccano_url + f\"/projects/{project_id}/docs\"  \r\n    posted_document = self._request_url(\r\n        \"POST\", url, data=document.dict(), headers=self.headers\r\n    ).json()\r\n\r\n    return DoccanoDocumentDTO(**posted_document)\r\n```\r\n\r\nWhen building a DoccanoDocumentDTO and sending to API, it receives and uploads document, without any annotations. \r\n\r\nIn doccano api, when using `<localhost>:<port>/v1/projects/{project_id}/docs/{doc_id}` endpoint, is possible to see that annotations is expected to be `string`, but when returning an annotated document, it comes a list as my dto suggests.\r\n\r\n![Captura de Tela 2020-06-19 aÌ€s 19 32 22](https://user-images.githubusercontent.com/42852567/85183862-c4b62800-b263-11ea-8144-0645411d5eab.png)\r\n","closed_by":{"login":"Hironsan","id":6737785,"node_id":"MDQ6VXNlcjY3Mzc3ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6737785?v=4","gravatar_id":"","url":"https://api.github.com/users/Hironsan","html_url":"https://github.com/Hironsan","followers_url":"https://api.github.com/users/Hironsan/followers","following_url":"https://api.github.com/users/Hironsan/following{/other_user}","gists_url":"https://api.github.com/users/Hironsan/gists{/gist_id}","starred_url":"https://api.github.com/users/Hironsan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hironsan/subscriptions","organizations_url":"https://api.github.com/users/Hironsan/orgs","repos_url":"https://api.github.com/users/Hironsan/repos","events_url":"https://api.github.com/users/Hironsan/events{/privacy}","received_events_url":"https://api.github.com/users/Hironsan/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/doccano/doccano/issues/848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/doccano/doccano/issues/848/timeline","performed_via_github_app":null,"state_reason":"completed"}