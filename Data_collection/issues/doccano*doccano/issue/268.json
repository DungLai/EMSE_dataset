{"url":"https://api.github.com/repos/doccano/doccano/issues/268","repository_url":"https://api.github.com/repos/doccano/doccano","labels_url":"https://api.github.com/repos/doccano/doccano/issues/268/labels{/name}","comments_url":"https://api.github.com/repos/doccano/doccano/issues/268/comments","events_url":"https://api.github.com/repos/doccano/doccano/issues/268/events","html_url":"https://github.com/doccano/doccano/issues/268","id":462297474,"node_id":"MDU6SXNzdWU0NjIyOTc0NzQ=","number":268,"title":"Sequence to sequence: cannot download labels","user":{"login":"remykarem","id":11023859,"node_id":"MDQ6VXNlcjExMDIzODU5","avatar_url":"https://avatars.githubusercontent.com/u/11023859?v=4","gravatar_id":"","url":"https://api.github.com/users/remykarem","html_url":"https://github.com/remykarem","followers_url":"https://api.github.com/users/remykarem/followers","following_url":"https://api.github.com/users/remykarem/following{/other_user}","gists_url":"https://api.github.com/users/remykarem/gists{/gist_id}","starred_url":"https://api.github.com/users/remykarem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remykarem/subscriptions","organizations_url":"https://api.github.com/users/remykarem/orgs","repos_url":"https://api.github.com/users/remykarem/repos","events_url":"https://api.github.com/users/remykarem/events{/privacy}","received_events_url":"https://api.github.com/users/remykarem/received_events","type":"User","site_admin":false},"labels":[{"id":927327719,"node_id":"MDU6TGFiZWw5MjczMjc3MTk=","url":"https://api.github.com/repos/doccano/doccano/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-06-29T12:21:30Z","updated_at":"2019-07-29T06:39:10Z","closed_at":"2019-07-29T06:39:10Z","author_association":"NONE","active_lock_reason":null,"body":"### System information\r\n- macOS 10.14\r\n- Python 3.6\r\n\r\n### Describe the problem\r\nRan the Docker image as a container. Created a sequence to sequence project and imported a one-column .txt file. Managed to annotate the data and the annotations persist but I notice that:\r\n\r\n1.  Progress bar shows 0/0 despite having imported data.\r\n2. No statistics available.\r\n3. Cannot export data.\r\n\r\n### Source code / logs\r\n\r\n[Here](https://github.com/chakki-works/doccano/files/3341857/testing.txt) is the data that I imported. Below is a screenshot that shows the progress bar is at 0/0.\r\n\r\n<img width=\"1674\" alt=\"image\" src=\"https://user-images.githubusercontent.com/11023859/60383923-923b7a00-9aaa-11e9-8885-d84a83ccbf18.png\">\r\n\r\nLogs for viewing statistics.\r\n\r\n```\r\nInternal Server Error: /v1/projects/4/statistics\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/exception.py\", line 34, in inner\r\n    response = get_response(request)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/base.py\", line 126, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/base.py\", line 124, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/views/decorators/csrf.py\", line 54, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/rest_framework/views.py\", line 483, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/usr/local/lib/python3.6/site-packages/rest_framework/views.py\", line 443, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/usr/local/lib/python3.6/site-packages/rest_framework/views.py\", line 480, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/doccano/app/api/views.py\", line 70, in get\r\n    label_count, user_count = self.label_per_data(p)\r\n  File \"/doccano/app/api/views.py\", line 94, in label_per_data\r\n    for d in annotations.values('label__text', 'user__username').annotate(Count('label'), Count('user')):\r\n  File \"/usr/local/lib/python3.6/site-packages/django/db/models/query.py\", line 750, in values\r\n    clone = self._values(*fields, **expressions)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/db/models/query.py\", line 745, in _values\r\n    clone.query.set_values(fields)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/db/models/sql/query.py\", line 1987, in set_values\r\n    self.add_fields(field_names, True)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/db/models/sql/query.py\", line 1735, in add_fields\r\n    join_info = self.setup_joins(name.split(LOOKUP_SEP), opts, alias, allow_many=allow_m2m)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/db/models/sql/query.py\", line 1473, in setup_joins\r\n    names[:pivot], opts, allow_many, fail_on_missing=True,\r\n  File \"/usr/local/lib/python3.6/site-packages/django/db/models/sql/query.py\", line 1389, in names_to_path\r\n    \"Choices are: %s\" % (name, \", \".join(available)))\r\ndjango.core.exceptions.FieldError: Cannot resolve keyword 'label' into field. Choices are: created_at, document, document_id, id, manual, prob, text, updated_at, user, user_id\r\n```\r\n\r\nLogs for downloading labeled data.\r\n\r\n```\r\nInternal Server Error: /v1/projects/4/docs/download\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/exception.py\", line 34, in inner\r\n    response = get_response(request)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/base.py\", line 126, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/base.py\", line 124, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/views/decorators/csrf.py\", line 54, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/rest_framework/views.py\", line 483, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/usr/local/lib/python3.6/site-packages/rest_framework/views.py\", line 443, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/usr/local/lib/python3.6/site-packages/rest_framework/views.py\", line 480, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/doccano/app/api/views.py\", line 312, in get\r\n    data = painter.paint(documents)\r\n  File \"/doccano/app/api/utils.py\", line 412, in paint\r\n    data = super().paint(documents)\r\n  File \"/doccano/app/api/utils.py\", line 385, in paint\r\n    a.pop('prob')\r\nKeyError: 'prob'\r\n```","closed_by":{"login":"Hironsan","id":6737785,"node_id":"MDQ6VXNlcjY3Mzc3ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6737785?v=4","gravatar_id":"","url":"https://api.github.com/users/Hironsan","html_url":"https://github.com/Hironsan","followers_url":"https://api.github.com/users/Hironsan/followers","following_url":"https://api.github.com/users/Hironsan/following{/other_user}","gists_url":"https://api.github.com/users/Hironsan/gists{/gist_id}","starred_url":"https://api.github.com/users/Hironsan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hironsan/subscriptions","organizations_url":"https://api.github.com/users/Hironsan/orgs","repos_url":"https://api.github.com/users/Hironsan/repos","events_url":"https://api.github.com/users/Hironsan/events{/privacy}","received_events_url":"https://api.github.com/users/Hironsan/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/doccano/doccano/issues/268/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/doccano/doccano/issues/268/timeline","performed_via_github_app":null,"state_reason":"completed"}