{"url":"https://api.github.com/repos/doccano/doccano/issues/1381","repository_url":"https://api.github.com/repos/doccano/doccano","labels_url":"https://api.github.com/repos/doccano/doccano/issues/1381/labels{/name}","comments_url":"https://api.github.com/repos/doccano/doccano/issues/1381/comments","events_url":"https://api.github.com/repos/doccano/doccano/issues/1381/events","html_url":"https://github.com/doccano/doccano/issues/1381","id":903696635,"node_id":"MDU6SXNzdWU5MDM2OTY2MzU=","number":1381,"title":"Cannot docker-compose.prod.yml up. backend/celery service - Permission denied: '/backend/filepond-temp-uploads' ","user":{"login":"koxx009","id":51743518,"node_id":"MDQ6VXNlcjUxNzQzNTE4","avatar_url":"https://avatars.githubusercontent.com/u/51743518?v=4","gravatar_id":"","url":"https://api.github.com/users/koxx009","html_url":"https://github.com/koxx009","followers_url":"https://api.github.com/users/koxx009/followers","following_url":"https://api.github.com/users/koxx009/following{/other_user}","gists_url":"https://api.github.com/users/koxx009/gists{/gist_id}","starred_url":"https://api.github.com/users/koxx009/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/koxx009/subscriptions","organizations_url":"https://api.github.com/users/koxx009/orgs","repos_url":"https://api.github.com/users/koxx009/repos","events_url":"https://api.github.com/users/koxx009/events{/privacy}","received_events_url":"https://api.github.com/users/koxx009/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-05-27T12:52:18Z","updated_at":"2021-05-27T13:20:11Z","closed_at":"2021-05-27T13:20:11Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"<!-- Before submitting an issue, make sure to check the docs and closed issues and FAQ to see if any of the solutions work for you. https://github.com/doccano/doccano/wiki/Frequently-Asked-Questions -->\r\n\r\nCannot start project with docker-compose. I receive error `Exit (1)` for `backend` and `celery` containers.\r\nIn `docker-compose logs` I find error message (bellow).\r\n\r\nProblem with permission on directory `/backend/filepond-temp-uploads` (`/backend/`).\r\n\r\nHow to reproduce the problem\r\n---------\r\n\r\n```bash\r\ngit clone https://github.com/doccano/doccano.git\r\nln -s docker-compose.prod.yml docker-compose.yml\r\ndocker-compose build\r\ndocker-compose  up backend \r\n```\r\n\r\nError message:\r\n---\r\n```bash\r\ndoccano_postgres_1 is up-to-date \r\nStarting doccano_backend_1 ... done \r\nAttaching to doccano_backend_1 \r\nbackend_1   | Making staticfiles \r\nbackend_1   | Executing collectstatic \r\nbackend_1   | Filepond app init: Creating temporary file upload directory </backend/filepond-temp-uploads> \r\nbackend_1   | Traceback (most recent call last): \r\nbackend_1   |   File \"manage.py\", line 15, in <module> \r\nbackend_1   |     execute_from_command_line(sys.argv) \r\nbackend_1   |   File \"/usr/local/lib/python3.8/site-packages/django/core/management/__init__.py\", line 419, in execute_from_command_line \r\nbackend_1   |     utility.execute() \r\nbackend_1   |   File \"/usr/local/lib/python3.8/site-packages/django/core/management/__init__.py\", line 395, in execute \r\nbackend_1   |     django.setup() \r\nbackend_1   |   File \"/usr/local/lib/python3.8/site-packages/django/__init__.py\", line 24, in setup \r\nbackend_1   |     apps.populate(settings.INSTALLED_APPS) \r\nbackend_1   |   File \"/usr/local/lib/python3.8/site-packages/django/apps/registry.py\", line 122, in populate \r\nbackend_1   |     app_config.ready() \r\nbackend_1   |   File \"/usr/local/lib/python3.8/site-packages/django_drf_filepond/apps.py\", line 29, in ready \r\nbackend_1   |     os.makedirs(local_settings.UPLOAD_TMP, mode=0o700) \r\nbackend_1   |   File \"/usr/local/lib/python3.8/os.py\", line 223, in makedirs \r\nbackend_1   |     mkdir(name, mode) \r\nbackend_1   | PermissionError: [Errno 13] Permission denied: '/backend/filepond-temp-uploads' \r\ndoccano_backend_1 exited with code 1 \r\n\r\n```\r\n\r\nMy Environment\r\n---------\r\n<!-- Include details of your environment.-->\r\n*   Operating System: `Ubuntu 20.04.1 LTS` / `Ubuntu 18.04.1` / `MacOS 11.3` \r\n*   Docker Version Used: `20.10.2`\r\n*   Docker-compose Version Used: `1.25.0` \r\n*   When you install doccano: 2021.05.27  (https://github.com/doccano/doccano/commit/08158da4366eeacf6bf57e3a1528d8158cddcead)\r\n*   How did you install doccano (Heroku button etc): `Docker-compose`\r\n\r\nFix:\r\n---------\r\n\r\nIn file `backend/Dockerfile.prod` need change 31 line.\r\nFrom:\r\n\r\n```Docker\r\nRUN mkdir -p /backend/staticfiles \\\r\n  && chown -R doccano:doccano /backend/staticfiles \\\r\n  && mkdir -p /backend/client/dist/static \\\r\n  && chown -R doccano:doccano /backend/client/dist/static \r\n```\r\n\r\nto\r\n\r\n```Docker\r\nRUN mkdir -p /backend/staticfiles \\\r\n  && chown -R doccano:doccano /backend/staticfiles \\\r\n  && mkdir -p /backend/client/dist/static \\\r\n  && chown -R doccano:doccano /backend/client/dist/static \\\r\n  && chown -R doccano:doccano /backend\r\n```","closed_by":{"login":"Hironsan","id":6737785,"node_id":"MDQ6VXNlcjY3Mzc3ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6737785?v=4","gravatar_id":"","url":"https://api.github.com/users/Hironsan","html_url":"https://github.com/Hironsan","followers_url":"https://api.github.com/users/Hironsan/followers","following_url":"https://api.github.com/users/Hironsan/following{/other_user}","gists_url":"https://api.github.com/users/Hironsan/gists{/gist_id}","starred_url":"https://api.github.com/users/Hironsan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hironsan/subscriptions","organizations_url":"https://api.github.com/users/Hironsan/orgs","repos_url":"https://api.github.com/users/Hironsan/repos","events_url":"https://api.github.com/users/Hironsan/events{/privacy}","received_events_url":"https://api.github.com/users/Hironsan/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/doccano/doccano/issues/1381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/doccano/doccano/issues/1381/timeline","performed_via_github_app":null,"state_reason":"completed"}