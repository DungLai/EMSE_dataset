{"url":"https://api.github.com/repos/doccano/doccano/issues/493","repository_url":"https://api.github.com/repos/doccano/doccano","labels_url":"https://api.github.com/repos/doccano/doccano/issues/493/labels{/name}","comments_url":"https://api.github.com/repos/doccano/doccano/issues/493/comments","events_url":"https://api.github.com/repos/doccano/doccano/issues/493/events","html_url":"https://github.com/doccano/doccano/issues/493","id":535653232,"node_id":"MDU6SXNzdWU1MzU2NTMyMzI=","number":493,"title":"Docker not writing data to disk","user":{"login":"CalmDownKarm","id":11739734,"node_id":"MDQ6VXNlcjExNzM5NzM0","avatar_url":"https://avatars.githubusercontent.com/u/11739734?v=4","gravatar_id":"","url":"https://api.github.com/users/CalmDownKarm","html_url":"https://github.com/CalmDownKarm","followers_url":"https://api.github.com/users/CalmDownKarm/followers","following_url":"https://api.github.com/users/CalmDownKarm/following{/other_user}","gists_url":"https://api.github.com/users/CalmDownKarm/gists{/gist_id}","starred_url":"https://api.github.com/users/CalmDownKarm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CalmDownKarm/subscriptions","organizations_url":"https://api.github.com/users/CalmDownKarm/orgs","repos_url":"https://api.github.com/users/CalmDownKarm/repos","events_url":"https://api.github.com/users/CalmDownKarm/events{/privacy}","received_events_url":"https://api.github.com/users/CalmDownKarm/received_events","type":"User","site_admin":false},"labels":[{"id":927327728,"node_id":"MDU6TGFiZWw5MjczMjc3Mjg=","url":"https://api.github.com/repos/doccano/doccano/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-12-10T11:00:02Z","updated_at":"2020-05-20T19:48:44Z","closed_at":"2019-12-10T12:26:05Z","author_association":"NONE","active_lock_reason":null,"body":"How to reproduce the behaviour\r\n---------\r\nPull docker image, use docker container create as mentioned in the readme. \r\nCreate projects as administrator -> add users through django Admin, but users can't see projects when they log in, even though they're added to the project\r\n\r\nFurther, tables in /doccano/app/db.sqlite3 in the docker image are empty - even thought the admin can see all the uploaded data/projects, no-one else can. \r\n\r\nDocker logs\r\n\r\n```bash\r\nOperations to perform:\r\n  Apply all migrations: admin, api, auth, authtoken, contenttypes, sessions, social_django\r\nRunning migrations:\r\n  Applying contenttypes.0001_initial... OK\r\n  Applying auth.0001_initial... OK\r\n  Applying admin.0001_initial... OK\r\n  Applying admin.0002_logentry_remove_auto_add... OK\r\n  Applying admin.0003_logentry_add_action_flag_choices... OK\r\n  Applying contenttypes.0002_remove_content_type_name... OK\r\n  Applying api.0001_initial... OK\r\n  Applying auth.0002_alter_permission_name_max_length... OK\r\n  Applying auth.0003_alter_user_email_max_length... OK\r\n  Applying auth.0004_alter_user_username_opts... OK\r\n  Applying auth.0005_alter_user_last_login_null... OK\r\n  Applying auth.0006_require_contenttypes_0002... OK\r\n  Applying auth.0007_alter_validators_add_error_messages... OK\r\n  Applying auth.0008_alter_user_username_max_length... OK\r\n  Applying auth.0009_alter_user_last_name_max_length... OK\r\n  Applying authtoken.0001_initial... OK\r\n  Applying authtoken.0002_auto_20160226_1747... OK\r\n  Applying sessions.0001_initial... OK\r\n  Applying social_django.0001_initial... OK\r\n  Applying social_django.0002_add_related_name... OK\r\n  Applying social_django.0003_alter_email_max_length... OK\r\n  Applying social_django.0004_auto_20160423_0400... OK\r\n  Applying social_django.0005_auto_20160727_2333... OK\r\n  Applying social_django.0006_partial... OK\r\n  Applying social_django.0007_code_timestamp... OK\r\n  Applying social_django.0008_partial_timestamp... OK\r\nRole created successfully \"project_admin\"\r\nRole created successfully \"annotator\"\r\nRole created successfully \"annotation_approver\"\r\nSuperuser created successfully.\r\n[2019-12-09 10:37:38 +0000] [146] [INFO] Starting gunicorn 19.9.0\r\n[2019-12-09 10:37:38 +0000] [146] [INFO] Listening at: http://0.0.0.0:8000 (146)\r\n[2019-12-09 10:37:38 +0000] [146] [INFO] Using worker: sync\r\n[2019-12-09 10:37:38 +0000] [149] [INFO] Booting worker with pid: 149\r\n[2019-12-09 10:37:38 +0000] [150] [INFO] Booting worker with pid: 150\r\nNot Found: /favicon.ico\r\nNot Found: /projects/admin\r\nNot Found: /favicon.ico\r\nInternal Server Error: /projects/1/docs/create\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/exception.py\", line 34, in inner\r\n    response = get_response(request)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/base.py\", line 126, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/base.py\", line 124, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/contrib/auth/mixins.py\", line 109, in dispatch\r\n    return super().dispatch(request, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/contrib/auth/mixins.py\", line 52, in dispatch\r\n    return super().dispatch(request, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/views/generic/base.py\", line 88, in dispatch\r\n    return handler(request, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/views/generic/base.py\", line 149, in get\r\n    context = self.get_context_data(**kwargs)\r\n  File \"/doccano/app/server/views.py\", line 87, in get_context_data\r\n    context['bundle_name'] = project.get_bundle_name_upload()\r\n  File \"/doccano/app/api/models.py\", line 47, in get_bundle_name_upload\r\n    raise NotImplementedError()\r\nNotImplementedError\r\nInternal Server Error: /projects/1/\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/exception.py\", line 34, in inner\r\n    response = get_response(request)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/base.py\", line 126, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/base.py\", line 124, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/contrib/auth/mixins.py\", line 52, in dispatch\r\n    return super().dispatch(request, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/views/generic/base.py\", line 88, in dispatch\r\n    return handler(request, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/views/generic/base.py\", line 149, in get\r\n    context = self.get_context_data(**kwargs)\r\n  File \"/doccano/app/server/views.py\", line 33, in get_context_data\r\n    context['bundle_name'] = project.get_bundle_name()\r\n  File \"/doccano/app/api/models.py\", line 44, in get_bundle_name\r\n    raise NotImplementedError()\r\nNotImplementedError\r\nBad Request: /v1/projects/2/docs/upload\r\nBad Request: /v1/projects/2/docs/upload\r\nBad Request: /v1/projects/2/docs/upload\r\nBad Request: /v1/projects/2/labels/3\r\n/usr/local/lib/python3.6/site-packages/django/views/generic/list.py:88: UnorderedObjectListWarning: Pagination may yield inconsistent results with an unordered object_list: <class 'api.models.Document'> QuerySet.\r\n  allow_empty_first_page=allow_empty_first_page, **kwargs)\r\nBad Request: /v1/projects/3/docs/upload\r\nBad Request: /v1/projects/3/docs/upload\r\nBad Request: /v1/projects\r\n/usr/local/lib/python3.6/site-packages/django/views/generic/list.py:88: UnorderedObjectListWarning: Pagination may yield inconsistent results with an unordered object_list: <class 'api.models.Document'> QuerySet.\r\n  allow_empty_first_page=allow_empty_first_page, **kwargs)\r\nNot Found: /v1/projects\r\nNot Found: /favicon.ico\r\nNot Found: /favicon.ico\r\nNot Found: /v1/projects\r\nNot Found: /v1/projects\r\nNot Found: /v1/projects\r\nNot Found: /v1/projects\r\nNot Found: /v1/projects\r\nNot Found: /v1/projects\r\nNot Found: /v1/projects\r\nInternal Server Error: /projects/1/\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/exception.py\", line 34, in inner\r\n    response = get_response(request)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/base.py\", line 126, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/core/handlers/base.py\", line 124, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/contrib/auth/mixins.py\", line 52, in dispatch\r\n    return super().dispatch(request, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/views/generic/base.py\", line 88, in dispatch\r\n    return handler(request, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/views/generic/base.py\", line 149, in get\r\n    context = self.get_context_data(**kwargs)\r\n  File \"/doccano/app/server/views.py\", line 33, in get_context_data\r\n    context['bundle_name'] = project.get_bundle_name()\r\n  File \"/doccano/app/api/models.py\", line 44, in get_bundle_name\r\n    raise NotImplementedError()\r\nNotImplementedError\r\nNot Found: /favicon.ico\r\nNot Found: /projects/v1\r\nOperations to perform:\r\n  Apply all migrations: admin, api, auth, authtoken, contenttypes, sessions, social_django\r\nRunning migrations:\r\n  No migrations to apply.\r\nDatbase Error: \"UNIQUE constraint failed: api_role.name\"\r\nDatbase Error: \"UNIQUE constraint failed: api_role.name\"\r\nDatbase Error: \"UNIQUE constraint failed: api_role.name\"\r\nUser admin already exists.\r\n[2019-12-10 10:21:12 +0000] [146] [INFO] Starting gunicorn 19.9.0\r\n[2019-12-10 10:21:12 +0000] [146] [INFO] Listening at: http://0.0.0.0:8000 (146)\r\n[2019-12-10 10:21:12 +0000] [146] [INFO] Using worker: sync\r\n[2019-12-10 10:21:12 +0000] [149] [INFO] Booting worker with pid: 149\r\n[2019-12-10 10:21:12 +0000] [151] [INFO] Booting worker with pid: 151\r\nNot Found: /v1/projects\r\nNot Found: /projects/admin\r\n/usr/local/lib/python3.6/site-packages/django/views/generic/list.py:88: UnorderedObjectListWarning: Pagination may yield inconsistent results with an unordered object_list: <class 'api.models.Document'> QuerySet.\r\n  allow_empty_first_page=allow_empty_first_page, **kwargs)\r\nNot Found: /v1/projects\r\n/usr/local/lib/python3.6/site-packages/django/views/generic/list.py:88: UnorderedObjectListWarning: Pagination may yield inconsistent results with an unordered object_list: <class 'api.models.Document'> QuerySet.\r\n  allow_empty_first_page=allow_empty_first_page, **kwargs)\r\nNot Found: /favicon.ico\r\nNot Found: /v1/projects\r\nNot Found: /v1/projects\r\nNot Found: /favicon.ico\r\nNot Found: /v1/projects\r\nNot Found: /favicon.ico\r\nNot Found: /v1/projects\r\n```","closed_by":{"login":"CalmDownKarm","id":11739734,"node_id":"MDQ6VXNlcjExNzM5NzM0","avatar_url":"https://avatars.githubusercontent.com/u/11739734?v=4","gravatar_id":"","url":"https://api.github.com/users/CalmDownKarm","html_url":"https://github.com/CalmDownKarm","followers_url":"https://api.github.com/users/CalmDownKarm/followers","following_url":"https://api.github.com/users/CalmDownKarm/following{/other_user}","gists_url":"https://api.github.com/users/CalmDownKarm/gists{/gist_id}","starred_url":"https://api.github.com/users/CalmDownKarm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CalmDownKarm/subscriptions","organizations_url":"https://api.github.com/users/CalmDownKarm/orgs","repos_url":"https://api.github.com/users/CalmDownKarm/repos","events_url":"https://api.github.com/users/CalmDownKarm/events{/privacy}","received_events_url":"https://api.github.com/users/CalmDownKarm/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/doccano/doccano/issues/493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/doccano/doccano/issues/493/timeline","performed_via_github_app":null,"state_reason":"completed"}