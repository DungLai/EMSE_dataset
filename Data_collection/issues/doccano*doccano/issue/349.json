{"url":"https://api.github.com/repos/doccano/doccano/issues/349","repository_url":"https://api.github.com/repos/doccano/doccano","labels_url":"https://api.github.com/repos/doccano/doccano/issues/349/labels{/name}","comments_url":"https://api.github.com/repos/doccano/doccano/issues/349/comments","events_url":"https://api.github.com/repos/doccano/doccano/issues/349/events","html_url":"https://github.com/doccano/doccano/issues/349","id":484715951,"node_id":"MDU6SXNzdWU0ODQ3MTU5NTE=","number":349,"title":"Site just hangs with Debug = False and ALLOWED_HOSTS = ['*'] in production server","user":{"login":"roperi","id":9901508,"node_id":"MDQ6VXNlcjk5MDE1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/9901508?v=4","gravatar_id":"","url":"https://api.github.com/users/roperi","html_url":"https://github.com/roperi","followers_url":"https://api.github.com/users/roperi/followers","following_url":"https://api.github.com/users/roperi/following{/other_user}","gists_url":"https://api.github.com/users/roperi/gists{/gist_id}","starred_url":"https://api.github.com/users/roperi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roperi/subscriptions","organizations_url":"https://api.github.com/users/roperi/orgs","repos_url":"https://api.github.com/users/roperi/repos","events_url":"https://api.github.com/users/roperi/events{/privacy}","received_events_url":"https://api.github.com/users/roperi/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-08-23T21:18:52Z","updated_at":"2021-03-31T16:08:38Z","closed_at":"2019-08-24T18:05:07Z","author_association":"NONE","active_lock_reason":null,"body":"If you open a GitHub issue, here is our policy:\r\n\r\n1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\r\n2. The form below must be filled out.\r\n\r\n------------------------\r\n\r\n### System information\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Debian 9.9\r\n- **Python version**: 3.6.4\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug or a feature request.\r\n\r\n\r\nI am using a private production server (not Heroku) with Gunicorn and Nginx as a proxy server. I am not sure if this is related but I was getting the 502 server error as soon as I changed to `Debug = False` and `ALLOWED_HOSTS = ['111.222.333.444']` in prod_settings.py.\r\n\r\nI put logging in prod_settings.py to find out more about the issue and foiund this error:  `ValueError: Missing staticfiles manifest entry for 'admin/css/base.css'`. So I did a `python app/manage.py collectstatic --noinput -i node_modules`  and 502 server errors went away.\r\n\r\nBut now whenever I try to open a valid page it will just hang out and eventually Nginx will throw a 504 error (gunicorn workers will time out as well). \r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\nFrom the Gunicorn logs this is the only thing I get (NOTE: I do not use Heroku): \r\n```\r\ndjango_heroku.core INFO     $DATABASE_URL not found, falling back to previous settings!\r\ndjango_heroku.core INFO     Applying Heroku Staticfiles configuration to Django settings.\r\ndjango_heroku.core INFO     Applying Heroku ALLOWED_HOSTS configuration to Django settings.\r\ndjango_heroku.core INFO     Applying Heroku logging configuration to Django settings.\r\ndjango_heroku.core INFO     $DATABASE_URL not found, falling back to previous settings!\r\ndjango_heroku.core INFO     Applying Heroku Staticfiles configuration to Django settings.\r\ndjango_heroku.core INFO     Applying Heroku ALLOWED_HOSTS configuration to Django settings.\r\ndjango_heroku.core INFO     Applying Heroku logging configuration to Django settings.\r\ndjango_heroku.core INFO     $DATABASE_URL not found, falling back to previous settings!\r\ndjango_heroku.core INFO     Applying Heroku Staticfiles configuration to Django settings.\r\ndjango_heroku.core INFO     Applying Heroku ALLOWED_HOSTS configuration to Django settings.\r\ndjango_heroku.core INFO     Applying Heroku logging configuration to Django settings.\r\n[2019-08-23 21:15:55 +0000] [8813] [CRITICAL] WORKER TIMEOUT (pid:9014)\r\n[2019-08-23 21:15:55 +0000] [8813] [CRITICAL] WORKER TIMEOUT (pid:9015)\r\n[2019-08-23 21:15:55 +0000] [8813] [CRITICAL] WORKER TIMEOUT (pid:9017)\r\n[2019-08-23 21:15:55 +0000] [9014] [INFO] Worker exiting (pid: 9014)\r\n[2019-08-23 21:15:55 +0000] [9015] [INFO] Worker exiting (pid: 9015)\r\n[2019-08-23 21:15:55 +0000] [9017] [INFO] Worker exiting (pid: 9017)\r\n[2019-08-23 21:15:56 +0000] [9020] [INFO] Booting worker with pid: 9020\r\n[2019-08-23 21:15:56 +0000] [8813] [DEBUG] 1 workers\r\n[2019-08-23 21:15:56 +0000] [9021] [INFO] Booting worker with pid: 9021\r\n[2019-08-23 21:15:56 +0000] [9023] [INFO] Booting worker with pid: 9023\r\n[2019-08-23 21:15:56 +0000] [8813] [DEBUG] 3 workers\r\ndjango_heroku.core INFO     $DATABASE_URL not found, falling back to previous settings!\r\ndjango_heroku.core INFO     Applying Heroku Staticfiles configuration to Django settings.\r\ndjango_heroku.core INFO     Applying Heroku ALLOWED_HOSTS configuration to Django settings.\r\ndjango_heroku.core INFO     Applying Heroku logging configuration to Django settings.\r\ndjango_heroku.core INFO     $DATABASE_URL not found, falling back to previous settings!\r\ndjango_heroku.core INFO     Applying Heroku Staticfiles configuration to Django settings.\r\ndjango_heroku.core INFO     Applying Heroku ALLOWED_HOSTS configuration to Django settings.\r\ndjango_heroku.core INFO     Applying Heroku logging configuration to Django settings.\r\ndjango_heroku.core INFO     $DATABASE_URL not found, falling back to previous settings!\r\ndjango_heroku.core INFO     Applying Heroku Staticfiles configuration to Django settings.\r\ndjango_heroku.core INFO     Applying Heroku ALLOWED_HOSTS configuration to Django settings.\r\ndjango_heroku.core INFO     Applying Heroku logging configuration to Django settings.\r\n```\r\nNote that when using `Debug = True` in `prod_settings.py` I can access the website without any problem. \r\n\r\nI was getting the same problems in local development after setting `Debug = False` (i.e. getting 502 errors) but after collecting the staticfiles it started to work again.\r\n\r\nAny pointers, ideas or suggestions? I'm stuck here. Thanks in advance!\r\n","closed_by":{"login":"roperi","id":9901508,"node_id":"MDQ6VXNlcjk5MDE1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/9901508?v=4","gravatar_id":"","url":"https://api.github.com/users/roperi","html_url":"https://github.com/roperi","followers_url":"https://api.github.com/users/roperi/followers","following_url":"https://api.github.com/users/roperi/following{/other_user}","gists_url":"https://api.github.com/users/roperi/gists{/gist_id}","starred_url":"https://api.github.com/users/roperi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roperi/subscriptions","organizations_url":"https://api.github.com/users/roperi/orgs","repos_url":"https://api.github.com/users/roperi/repos","events_url":"https://api.github.com/users/roperi/events{/privacy}","received_events_url":"https://api.github.com/users/roperi/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/doccano/doccano/issues/349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/doccano/doccano/issues/349/timeline","performed_via_github_app":null,"state_reason":"completed"}