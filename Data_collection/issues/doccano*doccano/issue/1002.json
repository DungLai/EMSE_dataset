{"url":"https://api.github.com/repos/doccano/doccano/issues/1002","repository_url":"https://api.github.com/repos/doccano/doccano","labels_url":"https://api.github.com/repos/doccano/doccano/issues/1002/labels{/name}","comments_url":"https://api.github.com/repos/doccano/doccano/issues/1002/comments","events_url":"https://api.github.com/repos/doccano/doccano/issues/1002/events","html_url":"https://github.com/doccano/doccano/issues/1002","id":709280877,"node_id":"MDU6SXNzdWU3MDkyODA4Nzc=","number":1002,"title":"docker-compose.prod.yml status 500 after reaching /admin or creating project","user":{"login":"jgieringer","id":5882254,"node_id":"MDQ6VXNlcjU4ODIyNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/5882254?v=4","gravatar_id":"","url":"https://api.github.com/users/jgieringer","html_url":"https://github.com/jgieringer","followers_url":"https://api.github.com/users/jgieringer/followers","following_url":"https://api.github.com/users/jgieringer/following{/other_user}","gists_url":"https://api.github.com/users/jgieringer/gists{/gist_id}","starred_url":"https://api.github.com/users/jgieringer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jgieringer/subscriptions","organizations_url":"https://api.github.com/users/jgieringer/orgs","repos_url":"https://api.github.com/users/jgieringer/repos","events_url":"https://api.github.com/users/jgieringer/events{/privacy}","received_events_url":"https://api.github.com/users/jgieringer/received_events","type":"User","site_admin":false},"labels":[{"id":927327719,"node_id":"MDU6TGFiZWw5MjczMjc3MTk=","url":"https://api.github.com/repos/doccano/doccano/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-09-25T21:02:15Z","updated_at":"2020-09-28T23:48:47Z","closed_at":"2020-09-28T23:48:47Z","author_association":"NONE","active_lock_reason":null,"body":"The problem\r\n---------\r\nWhen I clone doccano and run docker-compose on docker-compose.prod.yml, enter 0.0.0.0:80/admin, `docker logs doccano_nginx_1` shows:\r\n```bash\r\n172.26.0.1 - - [24/Sep/2020:20:56:17 +0000] \"GET /admin/ HTTP/1.1\" 302 0 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.102 Safari/537.36\" \"-\"\r\n172.26.0.1 - - [24/Sep/2020:20:56:17 +0000] \"GET /admin/login/?next=/admin/ HTTP/1.1\" 500 27 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.102 Safari/537.36\" \"-\"\r\n```\r\n\r\nWhen I take down the containers & volumes and rebuild with `debug=\"True\"`, `docker logs doccano_nginx_1` shows:\r\n```bash\r\n172.29.0.1 - - [24/Sep/2020:20:59:03 +0000] \"GET /admin/login/?next=/admin/ HTTP/1.1\" 200 1819 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.102 Safari/537.36\" \"-\"\r\n2020/09/24 20:59:03 [error] 8#8: *2 open() \"/static/admin/css/base.css\" failed (2: No such file or directory), client: 172.29.0.1, server: , request: \"GET /static/admin/css/base.css HTTP/1.1\", host: \"0.0.0.0\", referrer: \"http://0.0.0.0/admin/login/?next=/admin/\"\r\n172.29.0.1 - - [24/Sep/2020:20:59:03 +0000] \"GET /static/admin/css/base.css HTTP/1.1\" 404 548 \"http://0.0.0.0/admin/login/?next=/admin/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.102 Safari/537.36\" \"-\"\r\n172.29.0.1 - - [24/Sep/2020:20:59:03 +0000] \"GET /static/admin/css/login.css HTTP/1.1\" 404 548 \"http://0.0.0.0/admin/login/?next=/admin/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.102 Safari/537.36\" \"-\"\r\n172.29.0.1 - - [24/Sep/2020:20:59:03 +0000] \"GET /static/admin/css/responsive.css HTTP/1.1\" 404 548 \"http://0.0.0.0/admin/login/?next=/admin/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.102 Safari/537.36\" \"-\"\r\n2020/09/24 20:59:03 [error] 8#8: *7 open() \"/static/admin/css/login.css\" failed (2: No such file or directory), client: 172.29.0.1, server: , request: \"GET /static/admin/css/login.css HTTP/1.1\", host: \"0.0.0.0\", referrer: \"http://0.0.0.0/admin/login/?next=/admin/\"\r\n2020/09/24 20:59:03 [error] 8#8: *8 open() \"/static/admin/css/responsive.css\" failed (2: No such file or directory), client: 172.29.0.1, server: , request: \"GET /static/admin/css/responsive.css HTTP/1.1\", host: \"0.0.0.0\", referrer: \"http://0.0.0.0/admin/login/?next=/admin/\"\r\n172.29.0.1 - - [24/Sep/2020:20:59:03 +0000] \"GET /admin/login/?next=/admin/ HTTP/1.1\" 200 1819 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.102 Safari/537.36\" \"-\"\r\n```\r\n\r\nWhen I first ran `docker-compose -f docker-compose.prod.yml up -d --build`, I did notice some things that might be suspect:\r\n```bash\r\nWARNING in asset size limit: The following asset(s) exceed the recommended size limit (244 KiB).\r\nThis can impact web performance.\r\nAssets:\r\n  vendors~app.3bd7c47.js (2.22 MiB)\r\n  vendors~pages/projects/_id/statistics/index.51665ea.js (435 KiB)\r\n\r\nWARNING in entrypoint size limit: The following entrypoint(s) combined asset size exceeds the recommended limit (1000 KiB). This can impact web performance.\r\nEntrypoints:\r\n  app (2.52 MiB)\r\n      runtime.2c83a56.js\r\n      commons/app.486f7a2.js\r\n      vendors~app.3bd7c47.js\r\n      app.a99115b.js\r\n```\r\n\r\nHow to reproduce the problem\r\n---------\r\n```bash\r\ngit clone https://github.com/doccano/doccano.git\r\ncd doccano\r\ndocker-compose -f docker-compose.prod.yml up -d --build\r\n```\r\nEnter 0.0.0.0:80/admin in web browser\r\n\r\nYour Environment\r\n---------\r\n*   Operating System:\r\n  * Mac 10.15.5\r\n*   When you install doccano:\r\n  * 2020.09.24\r\n*   How did you install doccano (Heroku button etc):\r\n  * git clone https://github.com/doccano/doccano.git\r\n* docker-compose version\r\n  * docker-compose version 1.27.2, build 18f557f9\r\n* Browser\r\n  * Chrome - Version 85.0.4183.102 (Official Build) (64-bit)\r\n","closed_by":{"login":"Hironsan","id":6737785,"node_id":"MDQ6VXNlcjY3Mzc3ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6737785?v=4","gravatar_id":"","url":"https://api.github.com/users/Hironsan","html_url":"https://github.com/Hironsan","followers_url":"https://api.github.com/users/Hironsan/followers","following_url":"https://api.github.com/users/Hironsan/following{/other_user}","gists_url":"https://api.github.com/users/Hironsan/gists{/gist_id}","starred_url":"https://api.github.com/users/Hironsan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hironsan/subscriptions","organizations_url":"https://api.github.com/users/Hironsan/orgs","repos_url":"https://api.github.com/users/Hironsan/repos","events_url":"https://api.github.com/users/Hironsan/events{/privacy}","received_events_url":"https://api.github.com/users/Hironsan/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/doccano/doccano/issues/1002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/doccano/doccano/issues/1002/timeline","performed_via_github_app":null,"state_reason":"completed"}