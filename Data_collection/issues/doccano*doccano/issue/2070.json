{"url":"https://api.github.com/repos/doccano/doccano/issues/2070","repository_url":"https://api.github.com/repos/doccano/doccano","labels_url":"https://api.github.com/repos/doccano/doccano/issues/2070/labels{/name}","comments_url":"https://api.github.com/repos/doccano/doccano/issues/2070/comments","events_url":"https://api.github.com/repos/doccano/doccano/issues/2070/events","html_url":"https://github.com/doccano/doccano/issues/2070","id":1468648185,"node_id":"I_kwDOB-j9wM5Xicr5","number":2070,"title":"Tables and documents deleted after 1.4.0 upgrade","user":{"login":"s19n","id":1647955,"node_id":"MDQ6VXNlcjE2NDc5NTU=","avatar_url":"https://avatars.githubusercontent.com/u/1647955?v=4","gravatar_id":"","url":"https://api.github.com/users/s19n","html_url":"https://github.com/s19n","followers_url":"https://api.github.com/users/s19n/followers","following_url":"https://api.github.com/users/s19n/following{/other_user}","gists_url":"https://api.github.com/users/s19n/gists{/gist_id}","starred_url":"https://api.github.com/users/s19n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s19n/subscriptions","organizations_url":"https://api.github.com/users/s19n/orgs","repos_url":"https://api.github.com/users/s19n/repos","events_url":"https://api.github.com/users/s19n/events{/privacy}","received_events_url":"https://api.github.com/users/s19n/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-11-29T20:18:16Z","updated_at":"2022-11-29T20:18:40Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Possibly related to issue #2038 .\r\n\r\n### System information\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Docker 19.03.12 on Ubuntu 18.04\r\n- **Python version**: 3.6.9 on Ubuntu, 3.8.12 inside Docker image\r\n- Using PostgreSQL adapter\r\n\r\n### Describe the problem\r\nDocumentation improvement request: when upgrading from 1.3.0 git tag to 1.4.0 all documents stored in the `api_document` table are deleted from the database.\r\nThis potential data loss would require the documentation to state very clearly that launching the backend, migrations will be triggered and **they will delete the `api_document` table with all of its contents** without any sort or confirmation or visual indication of what is going on.\r\nIn addition, those data do not appear to be migrated in a different table whatsoever, pratically making 1.4.0 incompatible with a previous version.\r\n\r\n### Source code / logs\r\nI believe that the related migration is in `backend/api/migrations/0012_auto_20210514_0654.py`, line 153 and following:\r\n```\r\nmigrations.DeleteModel(\r\n    name='Document',\r\n),\r\nmigrations.DeleteModel(\r\n     name='DocumentAnnotation',\r\n),\r\n```","closed_by":null,"reactions":{"url":"https://api.github.com/repos/doccano/doccano/issues/2070/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/doccano/doccano/issues/2070/timeline","performed_via_github_app":null,"state_reason":null}