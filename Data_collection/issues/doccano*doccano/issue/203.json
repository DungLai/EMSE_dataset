{"url":"https://api.github.com/repos/doccano/doccano/issues/203","repository_url":"https://api.github.com/repos/doccano/doccano","labels_url":"https://api.github.com/repos/doccano/doccano/issues/203/labels{/name}","comments_url":"https://api.github.com/repos/doccano/doccano/issues/203/comments","events_url":"https://api.github.com/repos/doccano/doccano/issues/203/events","html_url":"https://github.com/doccano/doccano/issues/203","id":445095881,"node_id":"MDU6SXNzdWU0NDUwOTU4ODE=","number":203,"title":"Deploy to Azure stopped working ","user":{"login":"roiza","id":45923146,"node_id":"MDQ6VXNlcjQ1OTIzMTQ2","avatar_url":"https://avatars.githubusercontent.com/u/45923146?v=4","gravatar_id":"","url":"https://api.github.com/users/roiza","html_url":"https://github.com/roiza","followers_url":"https://api.github.com/users/roiza/followers","following_url":"https://api.github.com/users/roiza/following{/other_user}","gists_url":"https://api.github.com/users/roiza/gists{/gist_id}","starred_url":"https://api.github.com/users/roiza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roiza/subscriptions","organizations_url":"https://api.github.com/users/roiza/orgs","repos_url":"https://api.github.com/users/roiza/repos","events_url":"https://api.github.com/users/roiza/events{/privacy}","received_events_url":"https://api.github.com/users/roiza/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-05-16T18:21:34Z","updated_at":"2019-05-20T14:17:45Z","closed_at":"2019-05-16T21:26:21Z","author_association":"NONE","active_lock_reason":null,"body":"Hey\r\nDeploying to Azure stopped working.  yesterday I noticed that my instance was down. A new deployment to a new resource group failed as well with the same error.\r\nThe issues seem to be related to furl URL validation\r\n\r\nI tried to reproduce the error by installing furl 2.0.0 on my local machine and invoking furl(url,'') but I could not reproduce it. \r\n\r\nRunning the dockerized version on a local container seems to work as well. \r\n\r\nTo reproduce the issue - just click on the \"Deploy to azure\" button in the main README of the repo. \r\n\r\n\r\n\r\n------------------------\r\n\r\n### System information\r\nAzure\r\n\r\n### Source code / logs (formatted log here: https://pastebin.com/S9yXVEcK)\r\n`2019_05_16_RD0003FF688799_default_docker.log:\r\n2019-05-16T00:31:53.737046000Z Traceback (most recent call last):\r\n2019-05-16T00:31:53.737099802Z   File \"app/manage.py\", line 15, in <module>\r\n2019-05-16T00:31:53.737112703Z     execute_from_command_line(sys.argv)\r\n2019-05-16T00:31:53.737121803Z   File \"/usr/local/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n2019-05-16T00:31:53.737133604Z     utility.execute()\r\n2019-05-16T00:31:53.737142004Z   File \"/usr/local/lib/python3.6/site-packages/django/core/management/__init__.py\", line 325, in execute\r\n2019-05-16T00:31:53.737150805Z     settings.INSTALLED_APPS\r\n2019-05-16T00:31:53.737159205Z   File \"/usr/local/lib/python3.6/site-packages/django/conf/__init__.py\", line 57, in __getattr__\r\n2019-05-16T00:31:53.737168206Z     self._setup(name)\r\n2019-05-16T00:31:53.737176406Z   File \"/usr/local/lib/python3.6/site-packages/django/conf/__init__.py\", line 44, in _setup\r\n2019-05-16T00:31:53.737184906Z     self._wrapped = Settings(settings_module)\r\n2019-05-16T00:31:53.737193107Z   File \"/usr/local/lib/python3.6/site-packages/django/conf/__init__.py\", line 107, in __init__\r\n2019-05-16T00:31:53.737201807Z     mod = importlib.import_module(self.SETTINGS_MODULE)\r\n2019-05-16T00:31:53.737210507Z   File \"/usr/local/lib/python3.6/importlib/__init__.py\", line 126, in import_module\r\n2019-05-16T00:31:53.737219908Z     return _bootstrap._gcd_import(name[level:], package, level)\r\n2019-05-16T00:31:53.737228408Z   File \"<frozen importlib._bootstrap>\", line 994, in _gcd_import\r\n2019-05-16T00:31:53.737236909Z   File \"<frozen importlib._bootstrap>\", line 971, in _find_and_load\r\n2019-05-16T00:31:53.737245409Z   File \"<frozen importlib._bootstrap>\", line 955, in _find_and_load_unlocked\r\n2019-05-16T00:31:53.737253909Z   File \"<frozen importlib._bootstrap>\", line 665, in _load_unlocked\r\n2019-05-16T00:31:53.737262410Z   File \"<frozen importlib._bootstrap_external>\", line 678, in exec_module\r\n2019-05-16T00:31:53.737271010Z   File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\n2019-05-16T00:31:53.737279511Z   File \"/doccano/app/app/settings.py\", line 204, in <module>\r\n2019-05-16T00:31:53.737287911Z     ssl_require='sslmode' not in furl(env('DATABASE_URL', '')).args,\r\n2019-05-16T00:31:53.737296211Z   File \"/usr/local/lib/python3.6/site-packages/furl/furl.py\", line 1310, in __init__\r\n2019-05-16T00:31:53.737306712Z     self.load(url)  # Raises ValueError on invalid url.\r\n2019-05-16T00:31:53.737315112Z   File \"/usr/local/lib/python3.6/site-packages/furl/furl.py\", line 1337, in load\r\n2019-05-16T00:31:53.737323513Z     self.netloc = tokens.netloc  # Raises ValueError in Python 2.7+.\r\n2019-05-16T00:31:53.737331713Z   File \"/usr/local/lib/python3.6/site-packages/furl/furl.py\", line 1801, in __setattr__\r\n2019-05-16T00:31:53.737340013Z     object.__setattr__(self, attr, value)\r\n2019-05-16T00:31:53.737348114Z   File \"/usr/local/lib/python3.6/site-packages/furl/furl.py\", line 1464, in netloc\r\n2019-05-16T00:31:53.737364115Z     self.host = host\r\n2019-05-16T00:31:53.737375315Z   File \"/usr/local/lib/python3.6/site-packages/furl/furl.py\", line 1801, in __setattr__\r\n2019-05-16T00:31:53.737384416Z     object.__setattr__(self, attr, value)\r\n2019-05-16T00:31:53.737392616Z   File \"/usr/local/lib/python3.6/site-packages/furl/furl.py\", line 1379, in host\r\n2019-05-16T00:31:53.737401116Z     raise ValueError(errmsg % (host, INVALID_HOST_CHARS))\r\n2019-05-16T00:31:53.737409317Z ValueError: Invalid host 'user:password@db-instance-url.azure.com'. Host strings must have at least one non-period character, can't contain any of '!@#$%^&'\"*()+=:;/', and can't have adjacent periods.`","closed_by":{"login":"roiza","id":45923146,"node_id":"MDQ6VXNlcjQ1OTIzMTQ2","avatar_url":"https://avatars.githubusercontent.com/u/45923146?v=4","gravatar_id":"","url":"https://api.github.com/users/roiza","html_url":"https://github.com/roiza","followers_url":"https://api.github.com/users/roiza/followers","following_url":"https://api.github.com/users/roiza/following{/other_user}","gists_url":"https://api.github.com/users/roiza/gists{/gist_id}","starred_url":"https://api.github.com/users/roiza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roiza/subscriptions","organizations_url":"https://api.github.com/users/roiza/orgs","repos_url":"https://api.github.com/users/roiza/repos","events_url":"https://api.github.com/users/roiza/events{/privacy}","received_events_url":"https://api.github.com/users/roiza/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/doccano/doccano/issues/203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/doccano/doccano/issues/203/timeline","performed_via_github_app":null,"state_reason":"completed"}