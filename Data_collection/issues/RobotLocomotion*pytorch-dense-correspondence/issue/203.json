{"url":"https://api.github.com/repos/RobotLocomotion/pytorch-dense-correspondence/issues/203","repository_url":"https://api.github.com/repos/RobotLocomotion/pytorch-dense-correspondence","labels_url":"https://api.github.com/repos/RobotLocomotion/pytorch-dense-correspondence/issues/203/labels{/name}","comments_url":"https://api.github.com/repos/RobotLocomotion/pytorch-dense-correspondence/issues/203/comments","events_url":"https://api.github.com/repos/RobotLocomotion/pytorch-dense-correspondence/issues/203/events","html_url":"https://github.com/RobotLocomotion/pytorch-dense-correspondence/issues/203","id":476038289,"node_id":"MDU6SXNzdWU0NzYwMzgyODk=","number":203,"title":"ZeroDivisionError: float division by zero in loss function","user":{"login":"ZhangZhaofeng","id":4942242,"node_id":"MDQ6VXNlcjQ5NDIyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/4942242?v=4","gravatar_id":"","url":"https://api.github.com/users/ZhangZhaofeng","html_url":"https://github.com/ZhangZhaofeng","followers_url":"https://api.github.com/users/ZhangZhaofeng/followers","following_url":"https://api.github.com/users/ZhangZhaofeng/following{/other_user}","gists_url":"https://api.github.com/users/ZhangZhaofeng/gists{/gist_id}","starred_url":"https://api.github.com/users/ZhangZhaofeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ZhangZhaofeng/subscriptions","organizations_url":"https://api.github.com/users/ZhangZhaofeng/orgs","repos_url":"https://api.github.com/users/ZhangZhaofeng/repos","events_url":"https://api.github.com/users/ZhangZhaofeng/events{/privacy}","received_events_url":"https://api.github.com/users/ZhangZhaofeng/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-08-02T07:28:48Z","updated_at":"2020-10-12T19:04:56Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Run script in \r\n\r\n> dense_correspondence/experiments/shoes/training_shoes.ipynb\r\n\r\n meet a ZeroDivisionError \r\n\r\nDataset is \r\n\r\n> shoe_train_4_shoes.yaml\r\n\r\nIt seems that in some case, the num_matches == 0 cause the error.  How to fix it?\r\n\r\nError msg is as follows:\r\n\r\n> ZeroDivisionError                         Traceback (most recent call last)\r\n> <ipython-input-3-77b56ac20ed4> in <module>()\r\n>       5     print \"training descriptor of dimension %d\" %(d)\r\n>       6     train = DenseCorrespondenceTraining(dataset=dataset, config=train_config)\r\n> ----> 7     train.run()\r\n>       8     print \"finished training descriptor of dimension %d\" %(d)\r\n> \r\n> /home/zhang/code/dense_correspondence/training/training.pyc in run(self, loss_current_iteration, use_pretrained)\r\n>     340                                                                                 masked_non_matches_a, masked_non_matches_b,\r\n>     341                                                                                 background_non_matches_a, background_non_matches_b,\r\n> --> 342                                                                                 blind_non_matches_a, blind_non_matches_b)\r\n>     343 \r\n>     344 \r\n> \r\n> /home/zhang/code/dense_correspondence/loss_functions/loss_composer.pyc in get_loss(pixelwise_contrastive_loss, match_type, image_a_pred, image_b_pred, matches_a, matches_b, masked_non_matches_a, masked_non_matches_b, background_non_matches_a, background_non_matches_b, blind_non_matches_a, blind_non_matches_b)\r\n>      31                                             masked_non_matches_a, masked_non_matches_b,\r\n>      32                                             background_non_matches_a, background_non_matches_b,\r\n> ---> 33                                             blind_non_matches_a, blind_non_matches_b)\r\n>      34 \r\n>      35     if (match_type == SpartanDatasetDataType.SINGLE_OBJECT_ACROSS_SCENE).all():\r\n> \r\n> /home/zhang/code/dense_correspondence/loss_functions/loss_composer.pyc in get_within_scene_loss(pixelwise_contrastive_loss, image_a_pred, image_b_pred, matches_a, matches_b, masked_non_matches_a, masked_non_matches_b, background_non_matches_a, background_non_matches_b, blind_non_matches_a, blind_non_matches_b)\r\n>      82                                                                           matches_a,            matches_b,\r\n>      83                                                                           masked_non_matches_a, masked_non_matches_b,\r\n> ---> 84                                                                           M_descriptor=pcl._config[\"M_masked\"])\r\n>      85 \r\n>      86     if pcl._config[\"use_l2_pixel_loss_on_background_non_matches\"]:\r\n> \r\n> /home/zhang/code/dense_correspondence/loss_functions/pixelwise_contrastive_loss.py in get_loss_matched_and_non_matched_with_l2(self, image_a_pred, image_b_pred, matches_a, matches_b, non_matches_a, non_matches_b, M_descriptor, M_pixel, non_match_loss_weight, use_l2_pixel_loss)\r\n>      84 \r\n>      85 \r\n> ---> 86         match_loss, _, _ = PCL.match_loss(image_a_pred, image_b_pred, matches_a, matches_b)\r\n>      87 \r\n>      88 \r\n> \r\n> /home/zhang/code/dense_correspondence/loss_functions/pixelwise_contrastive_loss.py in match_loss(image_a_pred, image_b_pred, matches_a, matches_b)\r\n>     169             #print(match_loss)\r\n>     170         #else:\r\n> --> 171         match_loss = 1.0 / num_matches * (matches_a_descriptors - matches_b_descriptors).pow(2).sum()\r\n>     172 \r\n>     173         return match_loss, matches_a_descriptors, matches_b_descriptors\r\n> \r\n> ZeroDivisionError: float division by zero","closed_by":null,"reactions":{"url":"https://api.github.com/repos/RobotLocomotion/pytorch-dense-correspondence/issues/203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/RobotLocomotion/pytorch-dense-correspondence/issues/203/timeline","performed_via_github_app":null,"state_reason":null}