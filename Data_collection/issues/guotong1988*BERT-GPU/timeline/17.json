[{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/525751698","html_url":"https://github.com/guotong1988/BERT-GPU/issues/17#issuecomment-525751698","issue_url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/17","id":525751698,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNTc1MTY5OA==","user":{"login":"ChrisMii","id":19492360,"node_id":"MDQ6VXNlcjE5NDkyMzYw","avatar_url":"https://avatars.githubusercontent.com/u/19492360?v=4","gravatar_id":"","url":"https://api.github.com/users/ChrisMii","html_url":"https://github.com/ChrisMii","followers_url":"https://api.github.com/users/ChrisMii/followers","following_url":"https://api.github.com/users/ChrisMii/following{/other_user}","gists_url":"https://api.github.com/users/ChrisMii/gists{/gist_id}","starred_url":"https://api.github.com/users/ChrisMii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChrisMii/subscriptions","organizations_url":"https://api.github.com/users/ChrisMii/orgs","repos_url":"https://api.github.com/users/ChrisMii/repos","events_url":"https://api.github.com/users/ChrisMii/events{/privacy}","received_events_url":"https://api.github.com/users/ChrisMii/received_events","type":"User","site_admin":false},"created_at":"2019-08-28T13:44:11Z","updated_at":"2019-08-28T13:44:11Z","author_association":"NONE","body":"problem solved.","reactions":{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/525751698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ChrisMii","id":19492360,"node_id":"MDQ6VXNlcjE5NDkyMzYw","avatar_url":"https://avatars.githubusercontent.com/u/19492360?v=4","gravatar_id":"","url":"https://api.github.com/users/ChrisMii","html_url":"https://github.com/ChrisMii","followers_url":"https://api.github.com/users/ChrisMii/followers","following_url":"https://api.github.com/users/ChrisMii/following{/other_user}","gists_url":"https://api.github.com/users/ChrisMii/gists{/gist_id}","starred_url":"https://api.github.com/users/ChrisMii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChrisMii/subscriptions","organizations_url":"https://api.github.com/users/ChrisMii/orgs","repos_url":"https://api.github.com/users/ChrisMii/repos","events_url":"https://api.github.com/users/ChrisMii/events{/privacy}","received_events_url":"https://api.github.com/users/ChrisMii/received_events","type":"User","site_admin":false}},{"id":2590592805,"node_id":"MDExOkNsb3NlZEV2ZW50MjU5MDU5MjgwNQ==","url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/events/2590592805","actor":{"login":"ChrisMii","id":19492360,"node_id":"MDQ6VXNlcjE5NDkyMzYw","avatar_url":"https://avatars.githubusercontent.com/u/19492360?v=4","gravatar_id":"","url":"https://api.github.com/users/ChrisMii","html_url":"https://github.com/ChrisMii","followers_url":"https://api.github.com/users/ChrisMii/followers","following_url":"https://api.github.com/users/ChrisMii/following{/other_user}","gists_url":"https://api.github.com/users/ChrisMii/gists{/gist_id}","starred_url":"https://api.github.com/users/ChrisMii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChrisMii/subscriptions","organizations_url":"https://api.github.com/users/ChrisMii/orgs","repos_url":"https://api.github.com/users/ChrisMii/repos","events_url":"https://api.github.com/users/ChrisMii/events{/privacy}","received_events_url":"https://api.github.com/users/ChrisMii/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-08-28T13:44:11Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/526446015","html_url":"https://github.com/guotong1988/BERT-GPU/issues/17#issuecomment-526446015","issue_url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/17","id":526446015,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNjQ0NjAxNQ==","user":{"login":"AiliAili","id":32501371,"node_id":"MDQ6VXNlcjMyNTAxMzcx","avatar_url":"https://avatars.githubusercontent.com/u/32501371?v=4","gravatar_id":"","url":"https://api.github.com/users/AiliAili","html_url":"https://github.com/AiliAili","followers_url":"https://api.github.com/users/AiliAili/followers","following_url":"https://api.github.com/users/AiliAili/following{/other_user}","gists_url":"https://api.github.com/users/AiliAili/gists{/gist_id}","starred_url":"https://api.github.com/users/AiliAili/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AiliAili/subscriptions","organizations_url":"https://api.github.com/users/AiliAili/orgs","repos_url":"https://api.github.com/users/AiliAili/repos","events_url":"https://api.github.com/users/AiliAili/events{/privacy}","received_events_url":"https://api.github.com/users/AiliAili/received_events","type":"User","site_admin":false},"created_at":"2019-08-30T03:55:14Z","updated_at":"2019-08-30T03:55:14Z","author_association":"NONE","body":"@ChrisMii how did you fix this problem? I got the same error.","reactions":{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/526446015/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AiliAili","id":32501371,"node_id":"MDQ6VXNlcjMyNTAxMzcx","avatar_url":"https://avatars.githubusercontent.com/u/32501371?v=4","gravatar_id":"","url":"https://api.github.com/users/AiliAili","html_url":"https://github.com/AiliAili","followers_url":"https://api.github.com/users/AiliAili/followers","following_url":"https://api.github.com/users/AiliAili/following{/other_user}","gists_url":"https://api.github.com/users/AiliAili/gists{/gist_id}","starred_url":"https://api.github.com/users/AiliAili/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AiliAili/subscriptions","organizations_url":"https://api.github.com/users/AiliAili/orgs","repos_url":"https://api.github.com/users/AiliAili/repos","events_url":"https://api.github.com/users/AiliAili/events{/privacy}","received_events_url":"https://api.github.com/users/AiliAili/received_events","type":"User","site_admin":false}},{"id":2595922124,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjU5NTkyMjEyNA==","url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/events/2595922124","actor":{"login":"ChrisMii","id":19492360,"node_id":"MDQ6VXNlcjE5NDkyMzYw","avatar_url":"https://avatars.githubusercontent.com/u/19492360?v=4","gravatar_id":"","url":"https://api.github.com/users/ChrisMii","html_url":"https://github.com/ChrisMii","followers_url":"https://api.github.com/users/ChrisMii/followers","following_url":"https://api.github.com/users/ChrisMii/following{/other_user}","gists_url":"https://api.github.com/users/ChrisMii/gists{/gist_id}","starred_url":"https://api.github.com/users/ChrisMii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChrisMii/subscriptions","organizations_url":"https://api.github.com/users/ChrisMii/orgs","repos_url":"https://api.github.com/users/ChrisMii/repos","events_url":"https://api.github.com/users/ChrisMii/events{/privacy}","received_events_url":"https://api.github.com/users/ChrisMii/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-08-30T03:55:14Z","performed_via_github_app":null},{"id":2595922125,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI1OTU5MjIxMjU=","url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/events/2595922125","actor":{"login":"ChrisMii","id":19492360,"node_id":"MDQ6VXNlcjE5NDkyMzYw","avatar_url":"https://avatars.githubusercontent.com/u/19492360?v=4","gravatar_id":"","url":"https://api.github.com/users/ChrisMii","html_url":"https://github.com/ChrisMii","followers_url":"https://api.github.com/users/ChrisMii/followers","following_url":"https://api.github.com/users/ChrisMii/following{/other_user}","gists_url":"https://api.github.com/users/ChrisMii/gists{/gist_id}","starred_url":"https://api.github.com/users/ChrisMii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChrisMii/subscriptions","organizations_url":"https://api.github.com/users/ChrisMii/orgs","repos_url":"https://api.github.com/users/ChrisMii/repos","events_url":"https://api.github.com/users/ChrisMii/events{/privacy}","received_events_url":"https://api.github.com/users/ChrisMii/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-08-30T03:55:14Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/919781239","html_url":"https://github.com/guotong1988/BERT-GPU/issues/17#issuecomment-919781239","issue_url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/17","id":919781239,"node_id":"IC_kwDOCbgXGM420r93","user":{"login":"lfoppiano","id":15426,"node_id":"MDQ6VXNlcjE1NDI2","avatar_url":"https://avatars.githubusercontent.com/u/15426?v=4","gravatar_id":"","url":"https://api.github.com/users/lfoppiano","html_url":"https://github.com/lfoppiano","followers_url":"https://api.github.com/users/lfoppiano/followers","following_url":"https://api.github.com/users/lfoppiano/following{/other_user}","gists_url":"https://api.github.com/users/lfoppiano/gists{/gist_id}","starred_url":"https://api.github.com/users/lfoppiano/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lfoppiano/subscriptions","organizations_url":"https://api.github.com/users/lfoppiano/orgs","repos_url":"https://api.github.com/users/lfoppiano/repos","events_url":"https://api.github.com/users/lfoppiano/events{/privacy}","received_events_url":"https://api.github.com/users/lfoppiano/received_events","type":"User","site_admin":false},"created_at":"2021-09-15T07:46:13Z","updated_at":"2021-09-15T07:46:13Z","author_association":"NONE","body":"I still get this issue when I run with a predefined checkpoint \r\n\r\n```\r\nb:localhost/replica:0/task:0/device:GPU:3 with 14926 MB memory) -> physical GPU (device: 3, name: Tesla V100-PCIE-16GB, pci bus id: 0000:c8:00.0, compute capability: 7.0)\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:*** Features ***\r\nINFO:tensorflow:  name = input_ids, shape = (64, 128)\r\nINFO:tensorflow:  name = input_mask, shape = (64, 128)\r\nINFO:tensorflow:  name = masked_lm_ids, shape = (64, 20)\r\nINFO:tensorflow:  name = masked_lm_positions, shape = (64, 20)\r\nINFO:tensorflow:  name = masked_lm_weights, shape = (64, 20)\r\nINFO:tensorflow:  name = next_sentence_labels, shape = (64, 1)\r\nINFO:tensorflow:  name = segment_ids, shape = (64, 128)\r\nWARNING:tensorflow:From /lustre/group/tdm/Luca/scibert/BERT-GPU/modeling.py:341: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nPlease use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.\r\nWARNING:tensorflow:From /lustre/group/tdm/Luca/scibert/BERT-GPU/modeling.py:640: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse keras.layers.dense instead.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:*** Features ***\r\nINFO:tensorflow:  name = input_ids, shape = (64, 128)\r\nINFO:tensorflow:  name = input_mask, shape = (64, 128)\r\nINFO:tensorflow:  name = masked_lm_ids, shape = (64, 20)\r\nINFO:tensorflow:  name = masked_lm_positions, shape = (64, 20)\r\nINFO:tensorflow:  name = masked_lm_weights, shape = (64, 20)\r\nINFO:tensorflow:  name = next_sentence_labels, shape = (64, 1)\r\nINFO:tensorflow:  name = segment_ids, shape = (64, 128)\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:*** Features ***\r\nINFO:tensorflow:  name = input_ids, shape = (64, 128)\r\nINFO:tensorflow:  name = input_mask, shape = (64, 128)\r\nINFO:tensorflow:  name = masked_lm_ids, shape = (64, 20)\r\nINFO:tensorflow:  name = masked_lm_positions, shape = (64, 20)\r\nINFO:tensorflow:  name = masked_lm_weights, shape = (64, 20)\r\nINFO:tensorflow:  name = next_sentence_labels, shape = (64, 1)\r\nINFO:tensorflow:  name = segment_ids, shape = (64, 128)\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:*** Features ***\r\nINFO:tensorflow:  name = input_ids, shape = (64, 128)\r\nINFO:tensorflow:  name = input_mask, shape = (64, 128)\r\nINFO:tensorflow:  name = masked_lm_ids, shape = (64, 20)\r\nINFO:tensorflow:  name = masked_lm_positions, shape = (64, 20)\r\nINFO:tensorflow:  name = masked_lm_weights, shape = (64, 20)\r\nINFO:tensorflow:  name = next_sentence_labels, shape = (64, 1)\r\nINFO:tensorflow:  name = segment_ids, shape = (64, 128)\r\nINFO:tensorflow:Error reported to Coordinator: unsupported operand type(s) for +: 'PerReplica' and 'str'\r\nTraceback (most recent call last):\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow/python/training/coordinator.py\", line 297, in stop_on_exception\r\n    yield\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow/python/distribute/mirrored_strategy.py\", line 183, in _call_for_each_replica\r\n    **merge_kwargs)\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow/python/training/checkpoint_utils.py\", line 214, in _init_from_checkpoint\r\n    var = _collect_partitioned_variable(current_var_or_name, store_vars)\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow/python/training/checkpoint_utils.py\", line 368, in _collect_partitioned_variable\r\n    if name + \"/part_0\" in all_vars:\r\nTypeError: unsupported operand type(s) for +: 'PerReplica' and 'str'\r\nWARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.\r\nFor more information, please see:\r\n  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md\r\n  * https://github.com/tensorflow/addons\r\nIf you depend on functionality not listed there, please file an issue.\r\n\r\nTraceback (most recent call last):\r\n  File \"run_pretraining_gpu_v2.py\", line 508, in <module>\r\n    tf.app.run()\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"run_pretraining_gpu_v2.py\", line 481, in main\r\n    estimator.train(input_fn=train_input_fn, max_steps=FLAGS.num_train_steps)\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 358, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1122, in _train_model\r\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1185, in _train_model_distributed\r\n    self._config._train_distribute, input_fn, hooks, saving_listeners)\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1254, in _actual_train_model_distributed\r\n    self.config))\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py\", line 1199, in call_for_each_replica\r\n    return self._call_for_each_replica(fn, args, kwargs)\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow/python/distribute/mirrored_strategy.py\", line 641, in _call_for_each_replica\r\n    return _call_for_each_replica(self._container_strategy(), fn, args, kwargs)\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow/python/distribute/mirrored_strategy.py\", line 189, in _call_for_each_replica\r\n    coord.join(threads)\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow/python/training/coordinator.py\", line 389, in join\r\n    six.reraise(*self._exc_info_to_raise)\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/six.py\", line 693, in reraise\r\n    raise value\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow/python/training/coordinator.py\", line 297, in stop_on_exception\r\n    yield\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow/python/distribute/mirrored_strategy.py\", line 183, in _call_for_each_replica\r\n    **merge_kwargs)\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow/python/training/checkpoint_utils.py\", line 214, in _init_from_checkpoint\r\n    var = _collect_partitioned_variable(current_var_or_name, store_vars)\r\n  File \"/home/lfoppian0/anaconda3/envs/tensorflow-gpu_env/lib/python3.7/site-packages/tensorflow/python/training/checkpoint_utils.py\", line 368, in _collect_partitioned_variable\r\n    if name + \"/part_0\" in all_vars:\r\nTypeError: unsupported operand type(s) for +: 'PerReplica' and 'str'\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/919781239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lfoppiano","id":15426,"node_id":"MDQ6VXNlcjE1NDI2","avatar_url":"https://avatars.githubusercontent.com/u/15426?v=4","gravatar_id":"","url":"https://api.github.com/users/lfoppiano","html_url":"https://github.com/lfoppiano","followers_url":"https://api.github.com/users/lfoppiano/followers","following_url":"https://api.github.com/users/lfoppiano/following{/other_user}","gists_url":"https://api.github.com/users/lfoppiano/gists{/gist_id}","starred_url":"https://api.github.com/users/lfoppiano/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lfoppiano/subscriptions","organizations_url":"https://api.github.com/users/lfoppiano/orgs","repos_url":"https://api.github.com/users/lfoppiano/repos","events_url":"https://api.github.com/users/lfoppiano/events{/privacy}","received_events_url":"https://api.github.com/users/lfoppiano/received_events","type":"User","site_admin":false}}]