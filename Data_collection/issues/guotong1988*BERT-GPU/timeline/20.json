[{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563207862","html_url":"https://github.com/guotong1988/BERT-GPU/issues/20#issuecomment-563207862","issue_url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/20","id":563207862,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MzIwNzg2Mg==","user":{"login":"guotong1988","id":4702353,"node_id":"MDQ6VXNlcjQ3MDIzNTM=","avatar_url":"https://avatars.githubusercontent.com/u/4702353?v=4","gravatar_id":"","url":"https://api.github.com/users/guotong1988","html_url":"https://github.com/guotong1988","followers_url":"https://api.github.com/users/guotong1988/followers","following_url":"https://api.github.com/users/guotong1988/following{/other_user}","gists_url":"https://api.github.com/users/guotong1988/gists{/gist_id}","starred_url":"https://api.github.com/users/guotong1988/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guotong1988/subscriptions","organizations_url":"https://api.github.com/users/guotong1988/orgs","repos_url":"https://api.github.com/users/guotong1988/repos","events_url":"https://api.github.com/users/guotong1988/events{/privacy}","received_events_url":"https://api.github.com/users/guotong1988/received_events","type":"User","site_admin":false},"created_at":"2019-12-09T12:05:19Z","updated_at":"2019-12-09T12:05:19Z","author_association":"OWNER","body":"Need full stack trace.","reactions":{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563207862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"guotong1988","id":4702353,"node_id":"MDQ6VXNlcjQ3MDIzNTM=","avatar_url":"https://avatars.githubusercontent.com/u/4702353?v=4","gravatar_id":"","url":"https://api.github.com/users/guotong1988","html_url":"https://github.com/guotong1988","followers_url":"https://api.github.com/users/guotong1988/followers","following_url":"https://api.github.com/users/guotong1988/following{/other_user}","gists_url":"https://api.github.com/users/guotong1988/gists{/gist_id}","starred_url":"https://api.github.com/users/guotong1988/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guotong1988/subscriptions","organizations_url":"https://api.github.com/users/guotong1988/orgs","repos_url":"https://api.github.com/users/guotong1988/repos","events_url":"https://api.github.com/users/guotong1988/events{/privacy}","received_events_url":"https://api.github.com/users/guotong1988/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563207959","html_url":"https://github.com/guotong1988/BERT-GPU/issues/20#issuecomment-563207959","issue_url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/20","id":563207959,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MzIwNzk1OQ==","user":{"login":"guotong1988","id":4702353,"node_id":"MDQ6VXNlcjQ3MDIzNTM=","avatar_url":"https://avatars.githubusercontent.com/u/4702353?v=4","gravatar_id":"","url":"https://api.github.com/users/guotong1988","html_url":"https://github.com/guotong1988","followers_url":"https://api.github.com/users/guotong1988/followers","following_url":"https://api.github.com/users/guotong1988/following{/other_user}","gists_url":"https://api.github.com/users/guotong1988/gists{/gist_id}","starred_url":"https://api.github.com/users/guotong1988/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guotong1988/subscriptions","organizations_url":"https://api.github.com/users/guotong1988/orgs","repos_url":"https://api.github.com/users/guotong1988/repos","events_url":"https://api.github.com/users/guotong1988/events{/privacy}","received_events_url":"https://api.github.com/users/guotong1988/received_events","type":"User","site_admin":false},"created_at":"2019-12-09T12:05:34Z","updated_at":"2019-12-09T12:05:34Z","author_association":"OWNER","body":"Upgrade to TF 1.14","reactions":{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563207959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"guotong1988","id":4702353,"node_id":"MDQ6VXNlcjQ3MDIzNTM=","avatar_url":"https://avatars.githubusercontent.com/u/4702353?v=4","gravatar_id":"","url":"https://api.github.com/users/guotong1988","html_url":"https://github.com/guotong1988","followers_url":"https://api.github.com/users/guotong1988/followers","following_url":"https://api.github.com/users/guotong1988/following{/other_user}","gists_url":"https://api.github.com/users/guotong1988/gists{/gist_id}","starred_url":"https://api.github.com/users/guotong1988/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guotong1988/subscriptions","organizations_url":"https://api.github.com/users/guotong1988/orgs","repos_url":"https://api.github.com/users/guotong1988/repos","events_url":"https://api.github.com/users/guotong1988/events{/privacy}","received_events_url":"https://api.github.com/users/guotong1988/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563208891","html_url":"https://github.com/guotong1988/BERT-GPU/issues/20#issuecomment-563208891","issue_url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/20","id":563208891,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MzIwODg5MQ==","user":{"login":"shuxiaobo","id":11539889,"node_id":"MDQ6VXNlcjExNTM5ODg5","avatar_url":"https://avatars.githubusercontent.com/u/11539889?v=4","gravatar_id":"","url":"https://api.github.com/users/shuxiaobo","html_url":"https://github.com/shuxiaobo","followers_url":"https://api.github.com/users/shuxiaobo/followers","following_url":"https://api.github.com/users/shuxiaobo/following{/other_user}","gists_url":"https://api.github.com/users/shuxiaobo/gists{/gist_id}","starred_url":"https://api.github.com/users/shuxiaobo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shuxiaobo/subscriptions","organizations_url":"https://api.github.com/users/shuxiaobo/orgs","repos_url":"https://api.github.com/users/shuxiaobo/repos","events_url":"https://api.github.com/users/shuxiaobo/events{/privacy}","received_events_url":"https://api.github.com/users/shuxiaobo/received_events","type":"User","site_admin":false},"created_at":"2019-12-09T12:08:05Z","updated_at":"2019-12-09T12:08:05Z","author_association":"NONE","body":"Yes, tensorflow ==1.14 and the full trace:\r\n\r\n```python\r\n\r\nI1209 19:40:33.324634 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_5/attention/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_5/intermediate/dense/kernel:0, shape = (768, 3072), *INIT_FROM_CKPT*\r\nI1209 19:40:33.324860 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_5/intermediate/dense/kernel:0, shape = (768, 3072), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_5/intermediate/dense/bias:0, shape = (3072,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.325103 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_5/intermediate/dense/bias:0, shape = (3072,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_5/output/dense/kernel:0, shape = (3072, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.325333 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_5/output/dense/kernel:0, shape = (3072, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_5/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.325585 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_5/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_5/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.325816 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_5/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_5/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.326046 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_5/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/attention/self/query/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.326277 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/attention/self/query/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/attention/self/query/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.326528 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/attention/self/query/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/attention/self/key/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.326762 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/attention/self/key/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/attention/self/key/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.327003 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/attention/self/key/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/attention/self/value/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.327236 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/attention/self/value/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/attention/self/value/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.327488 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/attention/self/value/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/attention/output/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.327719 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/attention/output/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/attention/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.327962 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/attention/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/attention/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.328192 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/attention/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/attention/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.328415 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/attention/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/intermediate/dense/kernel:0, shape = (768, 3072), *INIT_FROM_CKPT*\r\nI1209 19:40:33.328659 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/intermediate/dense/kernel:0, shape = (768, 3072), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/intermediate/dense/bias:0, shape = (3072,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.328895 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/intermediate/dense/bias:0, shape = (3072,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/output/dense/kernel:0, shape = (3072, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.329134 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/output/dense/kernel:0, shape = (3072, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.329376 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.329592 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_6/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.329800 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_6/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/attention/self/query/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.330018 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/attention/self/query/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/attention/self/query/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.330240 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/attention/self/query/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/attention/self/key/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.330461 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/attention/self/key/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/attention/self/key/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.330687 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/attention/self/key/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/attention/self/value/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.330904 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/attention/self/value/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/attention/self/value/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.331131 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/attention/self/value/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/attention/output/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.331343 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/attention/output/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/attention/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.331578 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/attention/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/attention/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.331790 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/attention/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/attention/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.332001 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/attention/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/intermediate/dense/kernel:0, shape = (768, 3072), *INIT_FROM_CKPT*\r\nI1209 19:40:33.332210 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/intermediate/dense/kernel:0, shape = (768, 3072), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/intermediate/dense/bias:0, shape = (3072,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.332444 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/intermediate/dense/bias:0, shape = (3072,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/output/dense/kernel:0, shape = (3072, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.332658 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/output/dense/kernel:0, shape = (3072, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.332886 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.333094 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_7/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.333303 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_7/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/attention/self/query/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.333528 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/attention/self/query/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/attention/self/query/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.333754 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/attention/self/query/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/attention/self/key/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.333970 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/attention/self/key/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/attention/self/key/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.334192 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/attention/self/key/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/attention/self/value/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.334407 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/attention/self/value/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/attention/self/value/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.334646 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/attention/self/value/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/attention/output/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.334859 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/attention/output/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/attention/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.335081 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/attention/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/attention/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.335297 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/attention/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/attention/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.335515 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/attention/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/intermediate/dense/kernel:0, shape = (768, 3072), *INIT_FROM_CKPT*\r\nI1209 19:40:33.335725 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/intermediate/dense/kernel:0, shape = (768, 3072), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/intermediate/dense/bias:0, shape = (3072,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.335944 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/intermediate/dense/bias:0, shape = (3072,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/output/dense/kernel:0, shape = (3072, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.336178 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/output/dense/kernel:0, shape = (3072, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.336403 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.336619 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_8/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.336827 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_8/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/attention/self/query/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.337044 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/attention/self/query/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/attention/self/query/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.337268 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/attention/self/query/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/attention/self/key/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.337491 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/attention/self/key/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/attention/self/key/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.337710 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/attention/self/key/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/attention/self/value/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.337929 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/attention/self/value/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/attention/self/value/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.338150 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/attention/self/value/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/attention/output/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.338362 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/attention/output/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/attention/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.338592 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/attention/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/attention/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.338804 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/attention/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/attention/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.339011 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/attention/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/intermediate/dense/kernel:0, shape = (768, 3072), *INIT_FROM_CKPT*\r\nI1209 19:40:33.339223 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/intermediate/dense/kernel:0, shape = (768, 3072), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/intermediate/dense/bias:0, shape = (3072,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.339454 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/intermediate/dense/bias:0, shape = (3072,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/output/dense/kernel:0, shape = (3072, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.339662 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/output/dense/kernel:0, shape = (3072, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.339871 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.340068 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_9/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.340259 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_9/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/attention/self/query/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.340462 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/attention/self/query/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/attention/self/query/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.340672 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/attention/self/query/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/attention/self/key/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.340872 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/attention/self/key/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/attention/self/key/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.341082 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/attention/self/key/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/attention/self/value/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.341281 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/attention/self/value/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/attention/self/value/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.341506 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/attention/self/value/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/attention/output/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.341710 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/attention/output/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/attention/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.341921 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/attention/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/attention/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.342117 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/attention/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/attention/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.342328 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/attention/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/intermediate/dense/kernel:0, shape = (768, 3072), *INIT_FROM_CKPT*\r\nI1209 19:40:33.342533 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/intermediate/dense/kernel:0, shape = (768, 3072), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/intermediate/dense/bias:0, shape = (3072,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.342742 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/intermediate/dense/bias:0, shape = (3072,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/output/dense/kernel:0, shape = (3072, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.342943 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/output/dense/kernel:0, shape = (3072, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.343151 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.343347 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_10/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.343556 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_10/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/attention/self/query/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.343757 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/attention/self/query/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/attention/self/query/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.343960 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/attention/self/query/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/attention/self/key/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.344160 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/attention/self/key/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/attention/self/key/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.344367 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/attention/self/key/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/attention/self/value/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.344584 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/attention/self/value/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/attention/self/value/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.344799 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/attention/self/value/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/attention/output/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.345004 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/attention/output/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/attention/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.345210 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/attention/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/attention/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.345407 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/attention/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/attention/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.345617 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/attention/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/intermediate/dense/kernel:0, shape = (768, 3072), *INIT_FROM_CKPT*\r\nI1209 19:40:33.345813 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/intermediate/dense/kernel:0, shape = (768, 3072), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/intermediate/dense/bias:0, shape = (3072,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.346021 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/intermediate/dense/bias:0, shape = (3072,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/output/dense/kernel:0, shape = (3072, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.346211 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/output/dense/kernel:0, shape = (3072, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.346419 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/output/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.346625 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/output/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/encoder/layer_11/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.346820 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/encoder/layer_11/output/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/pooler/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.347020 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/pooler/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = bert/pooler/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.347229 140591702722304 run_pretraining_gpu_v2.py:186]   name = bert/pooler/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = cls/predictions/transform/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.347424 140591702722304 run_pretraining_gpu_v2.py:186]   name = cls/predictions/transform/dense/kernel:0, shape = (768, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = cls/predictions/transform/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.347643 140591702722304 run_pretraining_gpu_v2.py:186]   name = cls/predictions/transform/dense/bias:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = cls/predictions/transform/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.347839 140591702722304 run_pretraining_gpu_v2.py:186]   name = cls/predictions/transform/LayerNorm/beta:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = cls/predictions/transform/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.348041 140591702722304 run_pretraining_gpu_v2.py:186]   name = cls/predictions/transform/LayerNorm/gamma:0, shape = (768,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = cls/predictions/output_bias:0, shape = (30522,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.348239 140591702722304 run_pretraining_gpu_v2.py:186]   name = cls/predictions/output_bias:0, shape = (30522,), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = cls/seq_relationship/output_weights:0, shape = (2, 768), *INIT_FROM_CKPT*\r\nI1209 19:40:33.348448 140591702722304 run_pretraining_gpu_v2.py:186]   name = cls/seq_relationship/output_weights:0, shape = (2, 768), *INIT_FROM_CKPT*\r\nINFO:tensorflow:  name = cls/seq_relationship/output_bias:0, shape = (2,), *INIT_FROM_CKPT*\r\nI1209 19:40:33.348661 140591702722304 run_pretraining_gpu_v2.py:186]   name = cls/seq_relationship/output_bias:0, shape = (2,), *INIT_FROM_CKPT*\r\nWARNING:tensorflow:Efficient allreduce is not supported for 1 IndexedSlices\r\nW1209 19:40:37.624574 140602746058560 cross_device_ops.py:751] Efficient allreduce is not supported for 1 IndexedSlices\r\nINFO:tensorflow:Reduce to /replica:0/task:0/device:GPU:0 then broadcast to ('/replica:0/task:0/device:GPU:0', '/replica:0/task:0/device:GPU:1', '/replica:0/task:0/device:GPU:2', '/replica:0/task:0/device:GPU:3', '/replica:0/task:0/device:GPU:4', '/replica:0/task:0/device:GPU:5').\r\nI1209 19:40:37.625795 140602746058560 cross_device_ops.py:393] Reduce to /replica:0/task:0/device:GPU:0 then broadcast to ('/replica:0/task:0/device:GPU:0', '/replica:0/task:0/device:GPU:1', '/replica:0/task:0/device:GPU:2', '/replica:0/task:0/device:GPU:3', '/replica:0/task:0/device:GPU:4', '/replica:0/task:0/device:GPU:5').\r\nINFO:tensorflow:batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nI1209 19:40:37.654547 140602746058560 cross_device_ops.py:720] batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nINFO:tensorflow:batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nI1209 19:40:37.778326 140602746058560 cross_device_ops.py:720] batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nINFO:tensorflow:batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nI1209 19:40:37.871515 140602746058560 cross_device_ops.py:720] batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nINFO:tensorflow:batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nI1209 19:40:37.965023 140602746058560 cross_device_ops.py:720] batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nINFO:tensorflow:batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nI1209 19:40:38.058165 140602746058560 cross_device_ops.py:720] batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nINFO:tensorflow:batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nI1209 19:40:38.152199 140602746058560 cross_device_ops.py:720] batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nINFO:tensorflow:batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nI1209 19:40:38.245916 140602746058560 cross_device_ops.py:720] batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nINFO:tensorflow:batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nI1209 19:40:38.339321 140602746058560 cross_device_ops.py:720] batch_all_reduce: 1 all-reduces with algorithm = nccl,num_packs = 6, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nINFO:tensorflow:Done calling model_fn.\r\nI1209 19:41:30.312126 140592222807808 estimator.py:1147] Done calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nI1209 19:41:30.315484 140592214415104 estimator.py:1147] Done calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nI1209 19:41:30.318616 140591727900416 estimator.py:1147] Done calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nI1209 19:41:30.322615 140591719507712 estimator.py:1147] Done calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nI1209 19:41:30.325594 140591711115008 estimator.py:1147] Done calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nI1209 19:41:30.328356 140591702722304 estimator.py:1147] Done calling model_fn.\r\nINFO:tensorflow:Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).\r\nI1209 19:41:30.330210 140602746058560 cross_device_ops.py:393] Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).\r\nINFO:tensorflow:Create CheckpointSaverHook.\r\nI1209 19:41:33.816081 140602746058560 basic_session_run_hooks.py:541] Create CheckpointSaverHook.\r\nINFO:tensorflow:Graph was finalized.\r\nI1209 19:42:06.394142 140602746058560 monitored_session.py:240] Graph was finalized.\r\nTraceback (most recent call last):\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1356, in _do_call\r\n    return fn(*args)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1339, in _run_fn\r\n    self._extend_graph()\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1374, in _extend_graph\r\n    tf_session.ExtendSession(self._session)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: No OpKernel was registered to support Op 'NcclAllReduce' used by {{node NcclAllReduce}}with these attrs: [num_devices=6, reduction=\"sum\", shared_name=\"c0\", T=DT_FLOAT]\r\nRegistered devices: [CPU, XLA_CPU]\r\nRegistered kernels:\r\n  <no registered kernels>\r\n\r\n\t [[NcclAllReduce]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/data/shuxiaobo/BERT-multi-gpu/run_pretraining_gpu_v2.py\", line 504, in <module>\r\n    tf.app.run()\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/data/shuxiaobo/BERT-multi-gpu/run_pretraining_gpu_v2.py\", line 480, in main\r\n    estimator.train(input_fn = train_input_fn, max_steps = FLAGS.num_train_steps)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 367, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1156, in _train_model\r\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1219, in _train_model_distributed\r\n    self._config._train_distribute, input_fn, hooks, saving_listeners)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1329, in _actual_train_model_distributed\r\n    saving_listeners)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1480, in _train_with_estimator_spec\r\n    log_step_count_steps=log_step_count_steps) as mon_sess:\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 584, in MonitoredTrainingSession\r\n    stop_grace_period_secs=stop_grace_period_secs)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1007, in __init__\r\n    stop_grace_period_secs=stop_grace_period_secs)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 725, in __init__\r\n    self._sess = _RecoverableSession(self._coordinated_creator)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1200, in __init__\r\n    _WrappedSession.__init__(self, self._create_session())\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1205, in _create_session\r\n    return self._sess_creator.create_session()\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 871, in create_session\r\n    self.tf_sess = self._session_creator.create_session()\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 647, in create_session\r\n    init_fn=self._scaffold.init_fn)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/session_manager.py\", line 296, in prepare_session\r\n    sess.run(init_op, feed_dict=init_feed_dict)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 950, in run\r\n    run_metadata_ptr)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1173, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1350, in _do_run\r\n    run_metadata)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1370, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: No OpKernel was registered to support Op 'NcclAllReduce' used by node NcclAllReduce (defined at data/shuxiaobo/BERT-multi-gpu/run_pretraining_gpu_v2.py:480) with these attrs: [num_devices=6, reduction=\"sum\", shared_name=\"c0\", T=DT_FLOAT]\r\nRegistered devices: [CPU, XLA_CPU]\r\nRegistered kernels:\r\n  <no registered kernels>\r\n\r\n\t [[NcclAllReduce]]\r\n```\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563208891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shuxiaobo","id":11539889,"node_id":"MDQ6VXNlcjExNTM5ODg5","avatar_url":"https://avatars.githubusercontent.com/u/11539889?v=4","gravatar_id":"","url":"https://api.github.com/users/shuxiaobo","html_url":"https://github.com/shuxiaobo","followers_url":"https://api.github.com/users/shuxiaobo/followers","following_url":"https://api.github.com/users/shuxiaobo/following{/other_user}","gists_url":"https://api.github.com/users/shuxiaobo/gists{/gist_id}","starred_url":"https://api.github.com/users/shuxiaobo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shuxiaobo/subscriptions","organizations_url":"https://api.github.com/users/shuxiaobo/orgs","repos_url":"https://api.github.com/users/shuxiaobo/repos","events_url":"https://api.github.com/users/shuxiaobo/events{/privacy}","received_events_url":"https://api.github.com/users/shuxiaobo/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563217654","html_url":"https://github.com/guotong1988/BERT-GPU/issues/20#issuecomment-563217654","issue_url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/20","id":563217654,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MzIxNzY1NA==","user":{"login":"guotong1988","id":4702353,"node_id":"MDQ6VXNlcjQ3MDIzNTM=","avatar_url":"https://avatars.githubusercontent.com/u/4702353?v=4","gravatar_id":"","url":"https://api.github.com/users/guotong1988","html_url":"https://github.com/guotong1988","followers_url":"https://api.github.com/users/guotong1988/followers","following_url":"https://api.github.com/users/guotong1988/following{/other_user}","gists_url":"https://api.github.com/users/guotong1988/gists{/gist_id}","starred_url":"https://api.github.com/users/guotong1988/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guotong1988/subscriptions","organizations_url":"https://api.github.com/users/guotong1988/orgs","repos_url":"https://api.github.com/users/guotong1988/repos","events_url":"https://api.github.com/users/guotong1988/events{/privacy}","received_events_url":"https://api.github.com/users/guotong1988/received_events","type":"User","site_admin":false},"created_at":"2019-12-09T12:33:18Z","updated_at":"2019-12-09T12:33:18Z","author_association":"OWNER","body":"You use CPU to train?","reactions":{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563217654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"guotong1988","id":4702353,"node_id":"MDQ6VXNlcjQ3MDIzNTM=","avatar_url":"https://avatars.githubusercontent.com/u/4702353?v=4","gravatar_id":"","url":"https://api.github.com/users/guotong1988","html_url":"https://github.com/guotong1988","followers_url":"https://api.github.com/users/guotong1988/followers","following_url":"https://api.github.com/users/guotong1988/following{/other_user}","gists_url":"https://api.github.com/users/guotong1988/gists{/gist_id}","starred_url":"https://api.github.com/users/guotong1988/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guotong1988/subscriptions","organizations_url":"https://api.github.com/users/guotong1988/orgs","repos_url":"https://api.github.com/users/guotong1988/repos","events_url":"https://api.github.com/users/guotong1988/events{/privacy}","received_events_url":"https://api.github.com/users/guotong1988/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563224301","html_url":"https://github.com/guotong1988/BERT-GPU/issues/20#issuecomment-563224301","issue_url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/20","id":563224301,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MzIyNDMwMQ==","user":{"login":"shuxiaobo","id":11539889,"node_id":"MDQ6VXNlcjExNTM5ODg5","avatar_url":"https://avatars.githubusercontent.com/u/11539889?v=4","gravatar_id":"","url":"https://api.github.com/users/shuxiaobo","html_url":"https://github.com/shuxiaobo","followers_url":"https://api.github.com/users/shuxiaobo/followers","following_url":"https://api.github.com/users/shuxiaobo/following{/other_user}","gists_url":"https://api.github.com/users/shuxiaobo/gists{/gist_id}","starred_url":"https://api.github.com/users/shuxiaobo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shuxiaobo/subscriptions","organizations_url":"https://api.github.com/users/shuxiaobo/orgs","repos_url":"https://api.github.com/users/shuxiaobo/repos","events_url":"https://api.github.com/users/shuxiaobo/events{/privacy}","received_events_url":"https://api.github.com/users/shuxiaobo/received_events","type":"User","site_admin":false},"created_at":"2019-12-09T12:51:23Z","updated_at":"2019-12-09T12:51:23Z","author_association":"NONE","body":"```python\r\nI1209 21:02:09.292431 140486286108480 basic_session_run_hooks.py:541] Create CheckpointSaverHook.\r\nINFO:tensorflow:Graph was finalized.\r\nI1209 21:02:40.306236 140486286108480 monitored_session.py:240] Graph was finalized.\r\n2019-12-09 21:02:40.310599: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: \r\nname: Tesla V100-PCIE-16GB-LS major: 7 minor: 0 memoryClockRate(GHz): 1.297\r\npciBusID: 0000:02:00.0\r\n2019-12-09 21:02:40.311754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 1 with properties: \r\nname: Tesla V100-PCIE-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.38\r\npciBusID: 0000:03:00.0\r\n2019-12-09 21:02:40.312856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 2 with properties: \r\nname: Tesla V100-PCIE-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.38\r\npciBusID: 0000:83:00.0\r\n2019-12-09 21:02:40.313949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 3 with properties: \r\nname: Tesla V100-PCIE-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.38\r\npciBusID: 0000:84:00.0\r\n2019-12-09 21:02:40.314131: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Could not dlopen library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-9.0/lib64\r\n2019-12-09 21:02:40.314214: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Could not dlopen library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-9.0/lib64\r\n2019-12-09 21:02:40.314286: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Could not dlopen library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-9.0/lib64\r\n2019-12-09 21:02:40.314356: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Could not dlopen library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-9.0/lib64\r\n2019-12-09 21:02:40.314422: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Could not dlopen library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-9.0/lib64\r\n2019-12-09 21:02:40.314488: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Could not dlopen library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-9.0/lib64\r\n2019-12-09 21:02:40.314517: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7\r\n2019-12-09 21:02:40.314532: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1663] Cannot dlopen some GPU libraries. Skipping registering GPU devices...\r\n2019-12-09 21:02:40.314654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-12-09 21:02:40.314672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 1 2 3 \r\n2019-12-09 21:02:40.314686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N Y N N \r\n2019-12-09 21:02:40.314697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 1:   Y N N N \r\n2019-12-09 21:02:40.314709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 2:   N N N Y \r\n2019-12-09 21:02:40.314719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 3:   N N Y N \r\nTraceback (most recent call last):\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1356, in _do_call\r\n    return fn(*args)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1339, in _run_fn\r\n    self._extend_graph()\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1374, in _extend_graph\r\n    tf_session.ExtendSession(self._session)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: No OpKernel was registered to support Op 'NcclAllReduce' used by {{node NcclAllReduce}}with these attrs: [num_devices=6, reduction=\"sum\", shared_name=\"c0\", T=DT_FLOAT]\r\nRegistered devices: [CPU, XLA_CPU, XLA_GPU]\r\nRegistered kernels:\r\n  device='GPU'\r\n\r\n\t [[NcclAllReduce]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/shuxiaobo/BERT-multi-gpu/run_pretraining_gpu_v2.py\", line 504, in <module>\r\n    tf.app.run()\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/home/shuxiaobo/BERT-multi-gpu/run_pretraining_gpu_v2.py\", line 480, in main\r\n    estimator.train(input_fn = train_input_fn, max_steps = FLAGS.num_train_steps)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 367, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1156, in _train_model\r\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1219, in _train_model_distributed\r\n    self._config._train_distribute, input_fn, hooks, saving_listeners)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1329, in _actual_train_model_distributed\r\n    saving_listeners)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1480, in _train_with_estimator_spec\r\n    log_step_count_steps=log_step_count_steps) as mon_sess:\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 584, in MonitoredTrainingSession\r\n    stop_grace_period_secs=stop_grace_period_secs)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1007, in __init__\r\n    stop_grace_period_secs=stop_grace_period_secs)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 725, in __init__\r\n    self._sess = _RecoverableSession(self._coordinated_creator)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1200, in __init__\r\n    _WrappedSession.__init__(self, self._create_session())\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 1205, in _create_session\r\n    return self._sess_creator.create_session()\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 871, in create_session\r\n    self.tf_sess = self._session_creator.create_session()\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py\", line 647, in create_session\r\n    init_fn=self._scaffold.init_fn)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/session_manager.py\", line 296, in prepare_session\r\n    sess.run(init_op, feed_dict=init_feed_dict)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 950, in run\r\n    run_metadata_ptr)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1173, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1350, in _do_run\r\n    run_metadata)\r\n  File \"/home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1370, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: No OpKernel was registered to support Op 'NcclAllReduce' used by node NcclAllReduce (defined at /BERT-multi-gpu/run_pretraining_gpu_v2.py:480) with these attrs: [num_devices=6, reduction=\"sum\", shared_name=\"c0\", T=DT_FLOAT]\r\nRegistered devices: [CPU, XLA_CPU, XLA_GPU]\r\nRegistered kernels:\r\n  device='GPU'\r\n\r\n\t [[NcclAllReduce]]\r\n```\r\n\r\nNo, I just transfer to another server, I test the tensorflow-gpu with another project, it runs well. but this one still raise Error.","reactions":{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563224301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shuxiaobo","id":11539889,"node_id":"MDQ6VXNlcjExNTM5ODg5","avatar_url":"https://avatars.githubusercontent.com/u/11539889?v=4","gravatar_id":"","url":"https://api.github.com/users/shuxiaobo","html_url":"https://github.com/shuxiaobo","followers_url":"https://api.github.com/users/shuxiaobo/followers","following_url":"https://api.github.com/users/shuxiaobo/following{/other_user}","gists_url":"https://api.github.com/users/shuxiaobo/gists{/gist_id}","starred_url":"https://api.github.com/users/shuxiaobo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shuxiaobo/subscriptions","organizations_url":"https://api.github.com/users/shuxiaobo/orgs","repos_url":"https://api.github.com/users/shuxiaobo/repos","events_url":"https://api.github.com/users/shuxiaobo/events{/privacy}","received_events_url":"https://api.github.com/users/shuxiaobo/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563225370","html_url":"https://github.com/guotong1988/BERT-GPU/issues/20#issuecomment-563225370","issue_url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/20","id":563225370,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MzIyNTM3MA==","user":{"login":"guotong1988","id":4702353,"node_id":"MDQ6VXNlcjQ3MDIzNTM=","avatar_url":"https://avatars.githubusercontent.com/u/4702353?v=4","gravatar_id":"","url":"https://api.github.com/users/guotong1988","html_url":"https://github.com/guotong1988","followers_url":"https://api.github.com/users/guotong1988/followers","following_url":"https://api.github.com/users/guotong1988/following{/other_user}","gists_url":"https://api.github.com/users/guotong1988/gists{/gist_id}","starred_url":"https://api.github.com/users/guotong1988/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guotong1988/subscriptions","organizations_url":"https://api.github.com/users/guotong1988/orgs","repos_url":"https://api.github.com/users/guotong1988/repos","events_url":"https://api.github.com/users/guotong1988/events{/privacy}","received_events_url":"https://api.github.com/users/guotong1988/received_events","type":"User","site_admin":false},"created_at":"2019-12-09T12:54:23Z","updated_at":"2019-12-09T12:54:23Z","author_association":"OWNER","body":"I know this error. Not the problem of my code.\nYou should install cuda 10 right.","reactions":{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563225370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"guotong1988","id":4702353,"node_id":"MDQ6VXNlcjQ3MDIzNTM=","avatar_url":"https://avatars.githubusercontent.com/u/4702353?v=4","gravatar_id":"","url":"https://api.github.com/users/guotong1988","html_url":"https://github.com/guotong1988","followers_url":"https://api.github.com/users/guotong1988/followers","following_url":"https://api.github.com/users/guotong1988/following{/other_user}","gists_url":"https://api.github.com/users/guotong1988/gists{/gist_id}","starred_url":"https://api.github.com/users/guotong1988/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guotong1988/subscriptions","organizations_url":"https://api.github.com/users/guotong1988/orgs","repos_url":"https://api.github.com/users/guotong1988/repos","events_url":"https://api.github.com/users/guotong1988/events{/privacy}","received_events_url":"https://api.github.com/users/guotong1988/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563225901","html_url":"https://github.com/guotong1988/BERT-GPU/issues/20#issuecomment-563225901","issue_url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/20","id":563225901,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MzIyNTkwMQ==","user":{"login":"guotong1988","id":4702353,"node_id":"MDQ6VXNlcjQ3MDIzNTM=","avatar_url":"https://avatars.githubusercontent.com/u/4702353?v=4","gravatar_id":"","url":"https://api.github.com/users/guotong1988","html_url":"https://github.com/guotong1988","followers_url":"https://api.github.com/users/guotong1988/followers","following_url":"https://api.github.com/users/guotong1988/following{/other_user}","gists_url":"https://api.github.com/users/guotong1988/gists{/gist_id}","starred_url":"https://api.github.com/users/guotong1988/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guotong1988/subscriptions","organizations_url":"https://api.github.com/users/guotong1988/orgs","repos_url":"https://api.github.com/users/guotong1988/repos","events_url":"https://api.github.com/users/guotong1988/events{/privacy}","received_events_url":"https://api.github.com/users/guotong1988/received_events","type":"User","site_admin":false},"created_at":"2019-12-09T12:55:59Z","updated_at":"2019-12-09T12:55:59Z","author_association":"OWNER","body":"TensorFlow is using CPU because it can not use cuda.","reactions":{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563225901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"guotong1988","id":4702353,"node_id":"MDQ6VXNlcjQ3MDIzNTM=","avatar_url":"https://avatars.githubusercontent.com/u/4702353?v=4","gravatar_id":"","url":"https://api.github.com/users/guotong1988","html_url":"https://github.com/guotong1988","followers_url":"https://api.github.com/users/guotong1988/followers","following_url":"https://api.github.com/users/guotong1988/following{/other_user}","gists_url":"https://api.github.com/users/guotong1988/gists{/gist_id}","starred_url":"https://api.github.com/users/guotong1988/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guotong1988/subscriptions","organizations_url":"https://api.github.com/users/guotong1988/orgs","repos_url":"https://api.github.com/users/guotong1988/repos","events_url":"https://api.github.com/users/guotong1988/events{/privacy}","received_events_url":"https://api.github.com/users/guotong1988/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563230100","html_url":"https://github.com/guotong1988/BERT-GPU/issues/20#issuecomment-563230100","issue_url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/20","id":563230100,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MzIzMDEwMA==","user":{"login":"shuxiaobo","id":11539889,"node_id":"MDQ6VXNlcjExNTM5ODg5","avatar_url":"https://avatars.githubusercontent.com/u/11539889?v=4","gravatar_id":"","url":"https://api.github.com/users/shuxiaobo","html_url":"https://github.com/shuxiaobo","followers_url":"https://api.github.com/users/shuxiaobo/followers","following_url":"https://api.github.com/users/shuxiaobo/following{/other_user}","gists_url":"https://api.github.com/users/shuxiaobo/gists{/gist_id}","starred_url":"https://api.github.com/users/shuxiaobo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shuxiaobo/subscriptions","organizations_url":"https://api.github.com/users/shuxiaobo/orgs","repos_url":"https://api.github.com/users/shuxiaobo/repos","events_url":"https://api.github.com/users/shuxiaobo/events{/privacy}","received_events_url":"https://api.github.com/users/shuxiaobo/received_events","type":"User","site_admin":false},"created_at":"2019-12-09T13:07:40Z","updated_at":"2019-12-09T13:07:40Z","author_association":"NONE","body":"```python\r\n2019-12-09 21:16:39.061066: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0\r\n2019-12-09 21:16:39.061106: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0\r\n2019-12-09 21:16:39.061129: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10.0\r\n2019-12-09 21:16:39.061149: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10.0\r\n2019-12-09 21:16:39.061178: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10.0\r\n2019-12-09 21:16:39.061217: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10.0\r\n2019-12-09 21:16:39.061254: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7\r\n2019-12-09 21:16:39.069434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0, 1, 2, 3\r\n2019-12-09 21:16:39.069589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-12-09 21:16:39.069609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 1 2 3 \r\n2019-12-09 21:16:39.069621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N Y N N \r\n2019-12-09 21:16:39.069641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 1:   Y N N N \r\n2019-12-09 21:16:39.069651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 2:   N N N Y \r\n2019-12-09 21:16:39.069660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 3:   N N Y N \r\n2019-12-09 21:16:39.076271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14925 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB-LS, pci bus id: 0000:02:00.0, compute capability: 7.0)\r\n2019-12-09 21:16:39.077359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 30458 MB memory) -> physical GPU (device: 1, name: Tesla V100-PCIE-32GB, pci bus id: 0000:03:00.0, compute capability: 7.0)\r\n2019-12-09 21:16:39.078469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 30458 MB memory) -> physical GPU (device: 2, name: Tesla V100-PCIE-32GB, pci bus id: 0000:83:00.0, compute capability: 7.0)\r\n2019-12-09 21:16:39.079576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 30458 MB memory) -> physical GPU (device: 3, name: Tesla V100-PCIE-32GB, pci bus id: 0000:84:00.0, compute capability: 7.0)\r\nWARNING:tensorflow:From /home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse standard file APIs to check for files with this prefix.\r\nW1209 21:16:39.080965 140300370384704 deprecation.py:323] From /home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse standard file APIs to check for files with this prefix.\r\nINFO:tensorflow:Restoring parameters from output2/model.ckpt-0\r\nI1209 21:16:39.082738 140300370384704 saver.py:1280] Restoring parameters from output2/model.ckpt-0\r\n2019-12-09 21:16:46.355335: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.\r\nWARNING:tensorflow:From /home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1066: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse standard file utilities to get mtimes.\r\nW1209 21:16:52.061076 140300370384704 deprecation.py:323] From /home/shuxiaobo/python3/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1066: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse standard file utilities to get mtimes.\r\nINFO:tensorflow:Running local_init_op.\r\nI1209 21:16:55.574278 140300370384704 session_manager.py:500] Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nI1209 21:16:56.657786 140300370384704 session_manager.py:502] Done running local_init_op.\r\nINFO:tensorflow:Saving checkpoints for 0 into output2/model.ckpt.\r\nI1209 21:17:39.632050 140300370384704 basic_session_run_hooks.py:606] Saving checkpoints for 0 into output2/model.ckpt.\r\n2019-12-09 21:18:34.684387: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0\r\nINFO:tensorflow:loss = 74.11139, step = 0\r\nI1209 21:18:38.587360 140300370384704 basic_session_run_hooks.py:262] loss = 74.11139, step = 0\r\nINFO:tensorflow:global_step/sec: 0.246814\r\nI1209 21:19:19.102671 140300370384704 basic_session_run_hooks.py:692] global_step/sec: 0.246814\r\n```\r\nThanks ! I've run this code well, It seem like I need reinstall my cuda on server.","reactions":{"url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/comments/563230100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shuxiaobo","id":11539889,"node_id":"MDQ6VXNlcjExNTM5ODg5","avatar_url":"https://avatars.githubusercontent.com/u/11539889?v=4","gravatar_id":"","url":"https://api.github.com/users/shuxiaobo","html_url":"https://github.com/shuxiaobo","followers_url":"https://api.github.com/users/shuxiaobo/followers","following_url":"https://api.github.com/users/shuxiaobo/following{/other_user}","gists_url":"https://api.github.com/users/shuxiaobo/gists{/gist_id}","starred_url":"https://api.github.com/users/shuxiaobo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shuxiaobo/subscriptions","organizations_url":"https://api.github.com/users/shuxiaobo/orgs","repos_url":"https://api.github.com/users/shuxiaobo/repos","events_url":"https://api.github.com/users/shuxiaobo/events{/privacy}","received_events_url":"https://api.github.com/users/shuxiaobo/received_events","type":"User","site_admin":false}},{"id":2866246089,"node_id":"MDExOkNsb3NlZEV2ZW50Mjg2NjI0NjA4OQ==","url":"https://api.github.com/repos/guotong1988/BERT-GPU/issues/events/2866246089","actor":{"login":"guotong1988","id":4702353,"node_id":"MDQ6VXNlcjQ3MDIzNTM=","avatar_url":"https://avatars.githubusercontent.com/u/4702353?v=4","gravatar_id":"","url":"https://api.github.com/users/guotong1988","html_url":"https://github.com/guotong1988","followers_url":"https://api.github.com/users/guotong1988/followers","following_url":"https://api.github.com/users/guotong1988/following{/other_user}","gists_url":"https://api.github.com/users/guotong1988/gists{/gist_id}","starred_url":"https://api.github.com/users/guotong1988/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guotong1988/subscriptions","organizations_url":"https://api.github.com/users/guotong1988/orgs","repos_url":"https://api.github.com/users/guotong1988/repos","events_url":"https://api.github.com/users/guotong1988/events{/privacy}","received_events_url":"https://api.github.com/users/guotong1988/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-12-09T13:10:00Z","state_reason":null,"performed_via_github_app":null}]