{"url":"https://api.github.com/repos/nikitakit/self-attentive-parser/issues/92","repository_url":"https://api.github.com/repos/nikitakit/self-attentive-parser","labels_url":"https://api.github.com/repos/nikitakit/self-attentive-parser/issues/92/labels{/name}","comments_url":"https://api.github.com/repos/nikitakit/self-attentive-parser/issues/92/comments","events_url":"https://api.github.com/repos/nikitakit/self-attentive-parser/issues/92/events","html_url":"https://github.com/nikitakit/self-attentive-parser/issues/92","id":1244403171,"node_id":"I_kwDOB9LuEc5KLBXj","number":92,"title":"Serializing the output","user":{"login":"veronica320","id":41122420,"node_id":"MDQ6VXNlcjQxMTIyNDIw","avatar_url":"https://avatars.githubusercontent.com/u/41122420?v=4","gravatar_id":"","url":"https://api.github.com/users/veronica320","html_url":"https://github.com/veronica320","followers_url":"https://api.github.com/users/veronica320/followers","following_url":"https://api.github.com/users/veronica320/following{/other_user}","gists_url":"https://api.github.com/users/veronica320/gists{/gist_id}","starred_url":"https://api.github.com/users/veronica320/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/veronica320/subscriptions","organizations_url":"https://api.github.com/users/veronica320/orgs","repos_url":"https://api.github.com/users/veronica320/repos","events_url":"https://api.github.com/users/veronica320/events{/privacy}","received_events_url":"https://api.github.com/users/veronica320/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-05-22T23:51:13Z","updated_at":"2022-05-22T23:51:13Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi there, thanks for putting together this awesome repo!\r\n\r\nI'm wondering if it's possible to save the output somewhere on the disk (e.g., with `pickle` or `spacy` serialization methods).\r\n\r\nFor example:\r\n\r\n```\r\nimport benepar, spacy\r\n\r\nnlp = spacy.load('en_core_web_md')\r\nnlp.add_pipe(\"benepar\", config={\"model\": \"benepar_en3\"})\r\n\r\ndoc = nlp(\"The time for action is now. It's never too late to do something.\")\r\n\r\nfwn = \"output.spacy\"\r\ndoc.to_disk(fwn)\r\n```\r\n\r\nwould yield the error:\r\n```\r\n/envs/lib/python3.7/site-packages/torch/distributions/distribution.py:46: UserWarning: <class 'torch_struct.distributions.TreeCRF'> does not define `arg_constraints`. Please set `arg_constraints = {}` or initialize the distribution with `validate_args=False` to turn off validation.\r\n  'with `validate_args=False` to turn off validation.')\r\nTraceback (most recent call last):\r\n  File \"/envs/lib/python3.7/site-packages/IPython/core/interactiveshell.py\", line 3552, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-2-acc55f65a9e7>\", line 1, in <module>\r\n    runfile('/parsing/serialization.py', wdir='/parsing')\r\n  File \"/home//.pycharm_helpers/pydev/_pydev_bundle/pydev_umd.py\", line 198, in runfile\r\n    pydev_imports.execfile(filename, global_vars, local_vars)  # execute the script\r\n  File \"/home//.pycharm_helpers/pydev/_pydev_imps/_pydev_execfile.py\", line 18, in execfile\r\n    exec(compile(contents+\"\\n\", file, 'exec'), glob, loc)\r\n  File \"/parsing/serialization.py\", line 15, in <module>\r\n    doc.to_disk(fwn)\r\n  File \"spacy/tokens/doc.pyx\", line 1270, in spacy.tokens.doc.Doc.to_disk\r\n  File \"spacy/tokens/doc.pyx\", line 1271, in spacy.tokens.doc.Doc.to_disk\r\n  File \"spacy/tokens/doc.pyx\", line 1298, in spacy.tokens.doc.Doc.to_bytes\r\n  File \"spacy/tokens/doc.pyx\", line 1357, in spacy.tokens.doc.Doc.to_dict\r\n  File \"/envs/lib/python3.7/site-packages/spacy/util.py\", line 1263, in to_dict\r\n    serialized[key] = getter()\r\n  File \"spacy/tokens/doc.pyx\", line 1354, in spacy.tokens.doc.Doc.to_dict.lambda19\r\n  File \"/envs/lib/python3.7/site-packages/srsly/_msgpack_api.py\", line 14, in msgpack_dumps\r\n    return msgpack.dumps(data, use_bin_type=True)\r\n  File \"/envs/lib/python3.7/site-packages/srsly/msgpack/__init__.py\", line 55, in packb\r\n    return Packer(**kwargs).pack(o)\r\n  File \"srsly/msgpack/_packer.pyx\", line 285, in srsly.msgpack._packer.Packer.pack\r\n  File \"srsly/msgpack/_packer.pyx\", line 291, in srsly.msgpack._packer.Packer.pack\r\n  File \"srsly/msgpack/_packer.pyx\", line 288, in srsly.msgpack._packer.Packer.pack\r\n  File \"srsly/msgpack/_packer.pyx\", line 264, in srsly.msgpack._packer.Packer._pack\r\n  File \"srsly/msgpack/_packer.pyx\", line 282, in srsly.msgpack._packer.Packer._pack\r\nTypeError: can not serialize 'ConstituentData' object\r\n```\r\n\r\nIs there any workaround? This would be really useful when dealing with large datasets. Thanks for any guidance!\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/nikitakit/self-attentive-parser/issues/92/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/nikitakit/self-attentive-parser/issues/92/timeline","performed_via_github_app":null,"state_reason":null}