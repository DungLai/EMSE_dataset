{"url":"https://api.github.com/repos/nikitakit/self-attentive-parser/issues/56","repository_url":"https://api.github.com/repos/nikitakit/self-attentive-parser","labels_url":"https://api.github.com/repos/nikitakit/self-attentive-parser/issues/56/labels{/name}","comments_url":"https://api.github.com/repos/nikitakit/self-attentive-parser/issues/56/comments","events_url":"https://api.github.com/repos/nikitakit/self-attentive-parser/issues/56/events","html_url":"https://github.com/nikitakit/self-attentive-parser/issues/56","id":558992697,"node_id":"MDU6SXNzdWU1NTg5OTI2OTc=","number":56,"title":"RuntimeError in training: Sizes of tensors must match except in dimension 1","user":{"login":"thorunna","id":50205919,"node_id":"MDQ6VXNlcjUwMjA1OTE5","avatar_url":"https://avatars.githubusercontent.com/u/50205919?v=4","gravatar_id":"","url":"https://api.github.com/users/thorunna","html_url":"https://github.com/thorunna","followers_url":"https://api.github.com/users/thorunna/followers","following_url":"https://api.github.com/users/thorunna/following{/other_user}","gists_url":"https://api.github.com/users/thorunna/gists{/gist_id}","starred_url":"https://api.github.com/users/thorunna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thorunna/subscriptions","organizations_url":"https://api.github.com/users/thorunna/orgs","repos_url":"https://api.github.com/users/thorunna/repos","events_url":"https://api.github.com/users/thorunna/events{/privacy}","received_events_url":"https://api.github.com/users/thorunna/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-02-03T10:37:03Z","updated_at":"2021-02-06T05:00:58Z","closed_at":"2021-02-06T05:00:58Z","author_association":"NONE","active_lock_reason":null,"body":"When I run `python3 src/main.py train --model-path-base models/ --train-path data/gamalt_icepahc/train_random.clean --dev-path data/gamalt_icepahc/dev_random.clean --predict-tags --epochs 20 --use-words` the following error occurs:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"src/main.py\", line 613, in <module>\r\n    main()\r\n  File \"src/main.py\", line 609, in main\r\n    args.callback(args)\r\n  File \"src/main.py\", line 565, in <lambda>\r\n    subparser.set_defaults(callback=lambda args: run_train(args, hparams))\r\n  File \"src/main.py\", line 313, in run_train\r\n    _, loss = parser.parse_batch(subbatch_sentences, subbatch_trees)\r\n  File \"/users/home/tha86/berk/self-attentive-parser-copy/src/parse_nk.py\", line 1028, in parse_batch\r\n    annotations, _ = self.encoder(emb_idxs, batch_idxs, extra_content_annotations=extra_content_annotations)\r\n  File \"/opt/share/python/3.6.1/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/users/home/tha86/berk/self-attentive-parser-copy/src/parse_nk.py\", line 612, in forward\r\n    res, timing_signal, batch_idxs = emb(xs, batch_idxs, extra_content_annotations=extra_content_annotations)\r\n  File \"/opt/share/python/3.6.1/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/users/home/tha86/berk/self-attentive-parser-copy/src/parse_nk.py\", line 505, in forward\r\n    annotations = torch.cat([content_annotations, timing_signal], 1)\r\nRuntimeError: invalid argument 0: Sizes of tensors must match except in dimension 1. Got 627 and 645 in dimension 0 at /pytorch/aten/src/THC/generic/THCTensorMath.cu:83\r\n```\r\n\r\nI am using a Mac with python 3.6, pytorch 1.0.0 and Cython 0.29.14. Training is successful when the number of input sentences for training is small but this error comes up quickly when the number is increased.\r\n\r\nDoes anyone know why this error occurs and how it can be fixed?","closed_by":{"login":"nikitakit","id":252225,"node_id":"MDQ6VXNlcjI1MjIyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/252225?v=4","gravatar_id":"","url":"https://api.github.com/users/nikitakit","html_url":"https://github.com/nikitakit","followers_url":"https://api.github.com/users/nikitakit/followers","following_url":"https://api.github.com/users/nikitakit/following{/other_user}","gists_url":"https://api.github.com/users/nikitakit/gists{/gist_id}","starred_url":"https://api.github.com/users/nikitakit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nikitakit/subscriptions","organizations_url":"https://api.github.com/users/nikitakit/orgs","repos_url":"https://api.github.com/users/nikitakit/repos","events_url":"https://api.github.com/users/nikitakit/events{/privacy}","received_events_url":"https://api.github.com/users/nikitakit/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/nikitakit/self-attentive-parser/issues/56/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/nikitakit/self-attentive-parser/issues/56/timeline","performed_via_github_app":null,"state_reason":"completed"}