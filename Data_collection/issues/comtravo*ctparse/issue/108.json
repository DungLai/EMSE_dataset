{"url":"https://api.github.com/repos/comtravo/ctparse/issues/108","repository_url":"https://api.github.com/repos/comtravo/ctparse","labels_url":"https://api.github.com/repos/comtravo/ctparse/issues/108/labels{/name}","comments_url":"https://api.github.com/repos/comtravo/ctparse/issues/108/comments","events_url":"https://api.github.com/repos/comtravo/ctparse/issues/108/events","html_url":"https://github.com/comtravo/ctparse/issues/108","id":840190789,"node_id":"MDU6SXNzdWU4NDAxOTA3ODk=","number":108,"title":"[Question] adding new attribute to Time object ","user":{"login":"inferense","id":49389495,"node_id":"MDQ6VXNlcjQ5Mzg5NDk1","avatar_url":"https://avatars.githubusercontent.com/u/49389495?v=4","gravatar_id":"","url":"https://api.github.com/users/inferense","html_url":"https://github.com/inferense","followers_url":"https://api.github.com/users/inferense/followers","following_url":"https://api.github.com/users/inferense/following{/other_user}","gists_url":"https://api.github.com/users/inferense/gists{/gist_id}","starred_url":"https://api.github.com/users/inferense/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/inferense/subscriptions","organizations_url":"https://api.github.com/users/inferense/orgs","repos_url":"https://api.github.com/users/inferense/repos","events_url":"https://api.github.com/users/inferense/events{/privacy}","received_events_url":"https://api.github.com/users/inferense/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-03-24T21:48:38Z","updated_at":"2021-03-25T12:19:52Z","closed_at":"2021-03-25T12:19:52Z","author_association":"NONE","active_lock_reason":null,"body":"I'm trying to add a new attribute called `period` to the Time object in `types.py` which will hold a string \"am\" or \"pm\" if it's specified in the input (\"5am\"). This is so I can make some further modifications based on it to the logic of some rules. For this, I've modified the `_maybe_apply_am_pm` in `rules.py` as below:\r\n\r\n```python \r\nif ampm_match.lower().startswith(\"a\") and t.hour <= 12:\r\n    t.period = \"am\"\r\n    return t\r\nif ampm_match.lower().startswith(\"p\") and t.hour < 12:\r\n    return Time(hour=t.hour + 12, minute=t.minute, period='pm')\r\n```\r\n\r\nInitially, this worked but disabled much of the other applicable rules in the pipeline and resulted in latent incomplete outputs (for \"5am\" I'd get a latent datetime X-X-X with 05:00 instead of a complete datetime for today / tomorrow etc.)\r\n\r\nI figured I had to modify Time property `isTOD` to \r\n\r\n```python\r\n@property\r\ndef isTOD(self) -> bool:\r\n   \"\"\"isTimeOfDay - only a time, not date\"\"\"\r\n    return self._hasOnly(\"hour\") or self._hasOnly(\"hour\", \"minute\") or self._hasOnly(\"hour\", \"period\") or self._hasOnly(\"hour\", \"minute\", \"period\")\r\n```\r\n\r\nthis enabled the previously latent datetime completion, intervals etc. However, my new attribute got somehow lost in the pipeline of rules and is not propagated to the resulting production. I've spent hours debugging and experimenting with this but I'm really not sure what else to change to make this work?\r\n\r\nWhen testing the simple \"5pm\", I tried to look into `latentDOM` rule but the attribute is not propagated to it from the `HHMM` where its present. When debugging I used the logging as you described in the documentation but it hardly gives me all the rules that are applied, or I'm missing something somewhere else?\r\n\r\nThank you\r\n\r\n","closed_by":{"login":"sebastianmika","id":7964253,"node_id":"MDQ6VXNlcjc5NjQyNTM=","avatar_url":"https://avatars.githubusercontent.com/u/7964253?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianmika","html_url":"https://github.com/sebastianmika","followers_url":"https://api.github.com/users/sebastianmika/followers","following_url":"https://api.github.com/users/sebastianmika/following{/other_user}","gists_url":"https://api.github.com/users/sebastianmika/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianmika/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianmika/subscriptions","organizations_url":"https://api.github.com/users/sebastianmika/orgs","repos_url":"https://api.github.com/users/sebastianmika/repos","events_url":"https://api.github.com/users/sebastianmika/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianmika/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/comtravo/ctparse/issues/108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/comtravo/ctparse/issues/108/timeline","performed_via_github_app":null,"state_reason":"completed"}