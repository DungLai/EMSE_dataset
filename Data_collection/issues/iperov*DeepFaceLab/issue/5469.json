{"url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5469","repository_url":"https://api.github.com/repos/iperov/DeepFaceLab","labels_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5469/labels{/name}","comments_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5469/comments","events_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5469/events","html_url":"https://github.com/iperov/DeepFaceLab/issues/5469","id":1122616429,"node_id":"I_kwDOCBuapc5C6cRt","number":5469,"title":"I can't run seahd on the gpu! it only runs on the cpu","user":{"login":"alan9455","id":98932376,"node_id":"U_kgDOBeWWmA","avatar_url":"https://avatars.githubusercontent.com/u/98932376?v=4","gravatar_id":"","url":"https://api.github.com/users/alan9455","html_url":"https://github.com/alan9455","followers_url":"https://api.github.com/users/alan9455/followers","following_url":"https://api.github.com/users/alan9455/following{/other_user}","gists_url":"https://api.github.com/users/alan9455/gists{/gist_id}","starred_url":"https://api.github.com/users/alan9455/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alan9455/subscriptions","organizations_url":"https://api.github.com/users/alan9455/orgs","repos_url":"https://api.github.com/users/alan9455/repos","events_url":"https://api.github.com/users/alan9455/events{/privacy}","received_events_url":"https://api.github.com/users/alan9455/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-02-03T03:34:42Z","updated_at":"2022-02-15T21:50:24Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Initializing models: 80%|######################################## ######4 | 4/5 [00:28<00:07, 7.18s/it]\r\nError: OOM when allocating tensor of shape [3,3,512,2048] and type float\r\n         [[node src_dst_opt/vs_inter_B/upscale1/conv1/weight_0/Initializer/Const (defined at D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\DeepFaceLab\\core\\leras\\optimizers\\AdaBelief.py:38) ]]\r\n\r\nCaused by op 'src_dst_opt/vs_inter_B/upscale1/conv1/weight_0/Initializer/Const', defined at:\r\n  File \"threading.py\", line 884, in _bootstrap\r\n  File \"threading.py\", line 916, in _bootstrap_inner\r\n  File \"threading.py\", line 864, in run\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\DeepFaceLab\\mainscripts\\Trainer.py\", line 58, in trainerThread\r\n    debug=debug)\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\DeepFaceLab\\models\\ModelBase.py\", line 193, in __init__\r\n    self.on_initialize()\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\DeepFaceLab\\models\\Model_SAEHD\\Model.py\", line 341, in on_initialize\r\n    self.src_dst_opt.initialize_variables (self.src_dst_saveable_weights, vars_on_cpu=optimizer_vars_on_cpu, lr_dropout_on_cpu=self.options['lr_dropout']=='cpu')\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\DeepFaceLab\\core\\leras\\optimizers\\AdaBelief.py\", line 38, in initialize_variables\r\n    vs = { v.name : tf.get_variable ( f'vs_{v.name}'.replace(':','_'), v.shape, dtype=v.dtype, initializer=tf.initializers.constant( 0.0), trainable=False) for v in trainable_weights }\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\DeepFaceLab\\core\\leras\\optimizers\\AdaBelief.py\", line 38, in <dictcomp>\r\n    vs = { v.name : tf.get_variable ( f'vs_{v.name}'.replace(':','_'), v.shape, dtype=v.dtype, initializer=tf.initializers.constant( 0.0), trainable=False) for v in trainable_weights }\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variable_scope.py\", line 1479, in get_variable\r\n    aggregation=aggregation)\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variable_scope.py\", line 1220, in get_variable\r\n    aggregation=aggregation)\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variable_scope.py\", line 547, in get_variable\r\n    aggregation=aggregation)\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variable_scope.py\", line 499, in _true_getter\r\n    aggregation=aggregation)\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variable_scope.py\", line 911, in _get_single_variable\r\n    aggregation=aggregation)\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variables.py\", line 213, in __call__\r\n    return cls._variable_v1_call(*args, **kwargs)\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variables.py\", line 176, in _variable_v1_call\r\n    aggregation=aggregation)\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variables.py\", line 155, in <lambda>\r\n    previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variable_scope.py\", line 2495, in default_variable_creator\r\n    expected_shape=expected_shape, import_scope=import_scope)\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variables.py\", line 217, in __call__\r\n    return super(VariableMetaclass, cls).__call__(*args, **kwargs)\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variables.py\", line 1395, in __init__\r\n    constraint=constraint)\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variables.py\", line 1503, in _init_from_args\r\n    initial_value(), name=\"initial_value\", dtype=dtype)\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variable_scope.py\", line 883, in <lambda>\r\n    shape.as_list(), dtype=dtype, partition_info=partition_info)\r\n  File \"D:\\deepfake\\DeepFaceLab\\DeepFaceLab_NVIDIA_up_to_RTX2080Ti\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\init_ops.py\", line 230, in __call__\r\n    self.value, dtype=dtype, shape=shape\r\n\r\n\r\n\r\n\r\n============ Model Summary ============\r\n==                                   ==\r\n==            Model name: new_SAEHD  ==\r\n==                                   ==\r\n==     Current iteration: 564        ==\r\n==                                   ==\r\n==---------- Model Options ----------==\r\n==                                   ==\r\n==            resolution: 320        ==\r\n==             face_type: f          ==\r\n==     models_opt_on_gpu: True       ==\r\n==                 archi: liae-ud    ==\r\n==               ae_dims: 256        ==\r\n==                e_dims: 64         ==\r\n==                d_dims: 64         ==\r\n==           d_mask_dims: 22         ==\r\n==       masked_training: True       ==\r\n==       eyes_mouth_prio: False      ==\r\n==           uniform_yaw: False      ==\r\n==         blur_out_mask: False      ==\r\n==             adabelief: True       ==\r\n==            lr_dropout: n          ==\r\n==           random_warp: True       ==\r\n==      random_hsv_power: 0.0        ==\r\n==       true_face_power: 0.0        ==\r\n==      face_style_power: 0.0        ==\r\n==        bg_style_power: 0.0        ==\r\n==               ct_mode: none       ==\r\n==              clipgrad: False      ==\r\n==              pretrain: False      ==\r\n==       autobackup_hour: 0          ==\r\n== write_preview_history: False      ==\r\n==           target_iter: 3000000000 ==\r\n==       random_src_flip: False      ==\r\n==       random_dst_flip: True       ==\r\n==            batch_size: 4          ==\r\n==             gan_power: 0.0        ==\r\n==        gan_patch_size: 40         ==\r\n==              gan_dims: 16         ==\r\n==                                   ==\r\n==----------- Running On ------------==\r\n==                                   ==\r\n==          Using device: CPU        ==\r\n==                                   ==\r\n=======================================\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5469/timeline","performed_via_github_app":null,"state_reason":null}