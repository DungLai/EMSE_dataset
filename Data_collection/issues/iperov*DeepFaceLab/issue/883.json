{"url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/883","repository_url":"https://api.github.com/repos/iperov/DeepFaceLab","labels_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/883/labels{/name}","comments_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/883/comments","events_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/883/events","html_url":"https://github.com/iperov/DeepFaceLab/issues/883","id":692780077,"node_id":"MDU6SXNzdWU2OTI3ODAwNzc=","number":883,"title":"Error when applying XSeg Mask. Help would be appreciated ASAP","user":{"login":"Xlectron","id":31381272,"node_id":"MDQ6VXNlcjMxMzgxMjcy","avatar_url":"https://avatars.githubusercontent.com/u/31381272?v=4","gravatar_id":"","url":"https://api.github.com/users/Xlectron","html_url":"https://github.com/Xlectron","followers_url":"https://api.github.com/users/Xlectron/followers","following_url":"https://api.github.com/users/Xlectron/following{/other_user}","gists_url":"https://api.github.com/users/Xlectron/gists{/gist_id}","starred_url":"https://api.github.com/users/Xlectron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Xlectron/subscriptions","organizations_url":"https://api.github.com/users/Xlectron/orgs","repos_url":"https://api.github.com/users/Xlectron/repos","events_url":"https://api.github.com/users/Xlectron/events{/privacy}","received_events_url":"https://api.github.com/users/Xlectron/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2020-09-04T06:30:57Z","updated_at":"2021-01-06T20:59:04Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Full terminal window & error message:\r\n\r\nApplying trained XSeg model to aligned/ folder.\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1334, in _do_call\r\n    return fn(*args)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1317, in _run_fn\r\n    self._extend_graph()\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1352, in _extend_graph\r\n    tf_session.ExtendSession(self._session)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation XSeg/conv01/conv/weight: {{node XSeg/conv01/conv/weight}}was explicitly assigned to /device:GPU:0 but available devices are [ /job:localhost/replica:0/task:0/device:CPU:0 ]. Make sure the device specification refers to a valid device. The requested device appears to be a GPU, but CUDA is not enabled.\r\n         [[{{node XSeg/conv01/conv/weight}}]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\main.py\", line 324, in <module>\r\n    arguments.func(arguments)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\main.py\", line 285, in process_xsegapply\r\n    XSegUtil.apply_xseg (Path(arguments.input_dir), Path(arguments.model_dir))\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\mainscripts\\XSegUtil.py\", line 32, in apply_xseg\r\n    raise_on_no_model_files=True)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\facelib\\XSegNet.py\", line 68, in __init__\r\n    do_init = not model.load_weights( model_file_path )\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\core\\leras\\layers\\Saveable.py\", line 96, in load_weights\r\n    nn.batch_set_value(tuples)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\core\\leras\\ops\\__init__.py\", line 29, in batch_set_value\r\n    nn.tf_sess.run(assign_ops, feed_dict=feed_dict)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 929, in run\r\n    run_metadata_ptr)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1152, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1328, in _do_run\r\n    run_metadata)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1348, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation XSeg/conv01/conv/weight: node XSeg/conv01/conv/weight (defined at C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\core\\leras\\layers\\Conv2D.py:76) was explicitly assigned to /device:GPU:0 but available devices are [ /job:localhost/replica:0/task:0/device:CPU:0 ]. Make sure the device specification refers to a valid device. The requested device appears to be a GPU, but CUDA is not enabled.\r\n         [[node XSeg/conv01/conv/weight (defined at C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\core\\leras\\layers\\Conv2D.py:76) ]]\r\n\r\nCaused by op 'XSeg/conv01/conv/weight', defined at:\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\main.py\", line 324, in <module>\r\n    arguments.func(arguments)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\main.py\", line 285, in process_xsegapply\r\n    XSegUtil.apply_xseg (Path(arguments.input_dir), Path(arguments.model_dir))\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\mainscripts\\XSegUtil.py\", line 32, in apply_xseg\r\n    raise_on_no_model_files=True)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\facelib\\XSegNet.py\", line 41, in __init__\r\n    self.model_weights = self.model.get_weights()\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\core\\leras\\models\\ModelBase.py\", line 77, in get_weights\r\n    self.build()\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\core\\leras\\models\\ModelBase.py\", line 65, in build\r\n    self._build_sub(v[name],name)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\core\\leras\\models\\ModelBase.py\", line 35, in _build_sub\r\n    layer.build()\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\core\\leras\\models\\ModelBase.py\", line 65, in build\r\n    self._build_sub(v[name],name)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\core\\leras\\models\\ModelBase.py\", line 33, in _build_sub\r\n    layer.build_weights()\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\core\\leras\\layers\\Conv2D.py\", line 76, in build_weights\r\n    self.weight = tf.get_variable(\"weight\", (self.kernel_size,self.kernel_size,self.in_ch,self.out_ch), dtype=self.dtype, initializer=kernel_initializer, trainable=self.trainable )\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variable_scope.py\", line 1479, in get_variable\r\n    aggregation=aggregation)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variable_scope.py\", line 1220, in get_variable\r\n    aggregation=aggregation)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variable_scope.py\", line 547, in get_variable\r\n    aggregation=aggregation)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variable_scope.py\", line 499, in _true_getter\r\n    aggregation=aggregation)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variable_scope.py\", line 911, in _get_single_variable\r\n    aggregation=aggregation)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variables.py\", line 213, in __call__\r\n    return cls._variable_v1_call(*args, **kwargs)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variables.py\", line 176, in _variable_v1_call\r\n    aggregation=aggregation)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variables.py\", line 155, in <lambda>\r\n    previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variable_scope.py\", line 2495, in default_variable_creator\r\n    expected_shape=expected_shape, import_scope=import_scope)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variables.py\", line 217, in __call__\r\n    return super(VariableMetaclass, cls).__call__(*args, **kwargs)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variables.py\", line 1395, in __init__\r\n    constraint=constraint)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\variables.py\", line 1509, in _init_from_args\r\n    name=name)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\state_ops.py\", line 79, in variable_op_v2\r\n    shared_name=shared_name)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\ops\\gen_state_ops.py\", line 1424, in variable_v2\r\n    shared_name=shared_name, name=name)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 788, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\util\\deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3300, in create_op\r\n    op_def=op_def)\r\n  File \"C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\python-3.6.8\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1801, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): Cannot assign a device for operation XSeg/conv01/conv/weight: node XSeg/conv01/conv/weight (defined at C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\core\\leras\\layers\\Conv2D.py:76) was explicitly assigned to /device:GPU:0 but available devices are [ /job:localhost/replica:0/task:0/device:CPU:0 ]. Make sure the device specification refers to a valid device. The requested device appears to be a GPU, but CUDA is not enabled.\r\n         [[node XSeg/conv01/conv/weight (defined at C:\\Users\\Joshua Waghorn\\Documents\\DeepFaceLab_NVIDIA\\_internal\\DeepFaceLab\\core\\leras\\layers\\Conv2D.py:76) ]]\r\n\r\n\r\nPlease send help ASAP. I really need to learn how to do a full head deepfake for my English Assessment. Thanks","closed_by":null,"reactions":{"url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/883/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/883/timeline","performed_via_github_app":null,"state_reason":null}