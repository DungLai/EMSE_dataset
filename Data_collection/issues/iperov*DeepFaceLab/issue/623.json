{"url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/623","repository_url":"https://api.github.com/repos/iperov/DeepFaceLab","labels_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/623/labels{/name}","comments_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/623/comments","events_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/623/events","html_url":"https://github.com/iperov/DeepFaceLab/issues/623","id":565902910,"node_id":"MDU6SXNzdWU1NjU5MDI5MTA=","number":623,"title":"Model Collapse with LIAEHD on Multi-GPU, Win 10","user":{"login":"MrWig","id":56610223,"node_id":"MDQ6VXNlcjU2NjEwMjIz","avatar_url":"https://avatars.githubusercontent.com/u/56610223?v=4","gravatar_id":"","url":"https://api.github.com/users/MrWig","html_url":"https://github.com/MrWig","followers_url":"https://api.github.com/users/MrWig/followers","following_url":"https://api.github.com/users/MrWig/following{/other_user}","gists_url":"https://api.github.com/users/MrWig/gists{/gist_id}","starred_url":"https://api.github.com/users/MrWig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MrWig/subscriptions","organizations_url":"https://api.github.com/users/MrWig/orgs","repos_url":"https://api.github.com/users/MrWig/repos","events_url":"https://api.github.com/users/MrWig/events{/privacy}","received_events_url":"https://api.github.com/users/MrWig/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2020-02-16T13:10:41Z","updated_at":"2020-02-17T03:48:40Z","closed_at":"2020-02-17T03:48:40Z","author_association":"NONE","active_lock_reason":null,"body":"## Expected behavior\r\n\r\nDFL 2.0 Multi-GPU fake on windows 10\r\n\r\n## Actual behavior\r\nModel collapse has become inevitable on an LIAEHD model after ~340,000 iterations. Several datasets were used to pretrain the model and bias it towards the intended results\r\n\r\n## Steps to reproduce\r\nModel first collapsed around 450,000 iterations. I reverted to a backup of the model from 340,000 iterations and collapse started to occur after a further 20,000 iterations.\r\n\r\n*Describe, in some detail, the steps you tried that resulted in the behavior described above.*\r\nAfter noticing collapse in the model around 440,000 iterations I stopped training and attempted to resolve the issue by running both BG and Face Style at 100% for several iterations. This did not work and resulted in the final two screenshots below.\r\n\r\nI then reverted to a backup of the model at 340,000 iterations but the collapse returned again after about 20,000 iterations. This has occurred now on three different src/dst datasets.\r\n\r\n## Other relevant information\r\n- Model settings:\r\n============= Model Summary =============\r\n==                                     ==\r\n==            Model name: LIAEHD_SAEHD ==\r\n==                                     ==\r\n==     Current iteration: 444902       ==\r\n==                                     ==\r\n==----------- Model Options -----------==\r\n==                                     ==\r\n==            resolution: 192          ==\r\n==             face_type: f            ==\r\n==     models_opt_on_gpu: True         ==\r\n==                 archi: liaehd       ==\r\n==               ae_dims: 512          ==\r\n==                e_dims: 80           ==\r\n==                d_dims: 80           ==\r\n==           d_mask_dims: 16           ==\r\n==           use_float16: False        ==\r\n==            learn_mask: False        ==\r\n==            lr_dropout: False        ==\r\n==           random_warp: False        ==\r\n==       true_face_power: 0.0          ==\r\n==      face_style_power: 0.0        ==\r\n==        bg_style_power: 0.0        ==\r\n==               ct_mode: none         ==\r\n==              clipgrad: True         ==\r\n==              pretrain: False        ==\r\n==            autobackup: True         ==\r\n== write_preview_history: False        ==\r\n==           target_iter: 0            ==\r\n==           random_flip: True         ==\r\n==            batch_size: 16            ==\r\n==             gan_power: 0.0          ==\r\n==       autobackup_hour: 2            ==\r\n==                                     ==\r\n==------------ Running On -------------==\r\n==                                     ==\r\n==          Device index: 0            ==\r\n==                  Name: TITAN RTX    ==\r\n==                  VRAM: 23.76GB      ==\r\n==          Device index: 1            ==\r\n==                  Name: TITAN RTX    ==\r\n==                  VRAM: 23.76GB      ==\r\n==                                     ==\r\n=========================================\r\n\r\nWindows 10, prebuilt binary\r\n\r\n![Screenshot 2020-02-13 13 00 01](https://user-images.githubusercontent.com/56610223/74605118-dcea2080-5092-11ea-9abb-59a14f28b400.png)\r\n![Screenshot 2020-02-15 13 50 51](https://user-images.githubusercontent.com/56610223/74605108-be842500-5092-11ea-8016-4252780f8972.png)\r\n![Screenshot 2020-02-15 13 51 03](https://user-images.githubusercontent.com/56610223/74605109-bf1cbb80-5092-11ea-8f78-33ec50208f83.png)\r\n\r\nAlso with the earlier commits of DFL 2.0 I was able to train this multi-gpu model at BS 22, in the more recent commits I've had to lower batch size to 16 to prevent OOM","closed_by":{"login":"MrWig","id":56610223,"node_id":"MDQ6VXNlcjU2NjEwMjIz","avatar_url":"https://avatars.githubusercontent.com/u/56610223?v=4","gravatar_id":"","url":"https://api.github.com/users/MrWig","html_url":"https://github.com/MrWig","followers_url":"https://api.github.com/users/MrWig/followers","following_url":"https://api.github.com/users/MrWig/following{/other_user}","gists_url":"https://api.github.com/users/MrWig/gists{/gist_id}","starred_url":"https://api.github.com/users/MrWig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MrWig/subscriptions","organizations_url":"https://api.github.com/users/MrWig/orgs","repos_url":"https://api.github.com/users/MrWig/repos","events_url":"https://api.github.com/users/MrWig/events{/privacy}","received_events_url":"https://api.github.com/users/MrWig/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/623/timeline","performed_via_github_app":null,"state_reason":"completed"}