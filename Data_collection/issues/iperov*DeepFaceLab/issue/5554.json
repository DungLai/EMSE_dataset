{"url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5554","repository_url":"https://api.github.com/repos/iperov/DeepFaceLab","labels_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5554/labels{/name}","comments_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5554/comments","events_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5554/events","html_url":"https://github.com/iperov/DeepFaceLab/issues/5554","id":1360368038,"node_id":"I_kwDOCBuapc5RFZGm","number":5554,"title":"Fail to start training with numpy import error","user":{"login":"okingjo","id":25336857,"node_id":"MDQ6VXNlcjI1MzM2ODU3","avatar_url":"https://avatars.githubusercontent.com/u/25336857?v=4","gravatar_id":"","url":"https://api.github.com/users/okingjo","html_url":"https://github.com/okingjo","followers_url":"https://api.github.com/users/okingjo/followers","following_url":"https://api.github.com/users/okingjo/following{/other_user}","gists_url":"https://api.github.com/users/okingjo/gists{/gist_id}","starred_url":"https://api.github.com/users/okingjo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/okingjo/subscriptions","organizations_url":"https://api.github.com/users/okingjo/orgs","repos_url":"https://api.github.com/users/okingjo/repos","events_url":"https://api.github.com/users/okingjo/events{/privacy}","received_events_url":"https://api.github.com/users/okingjo/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-09-02T15:53:18Z","updated_at":"2022-10-12T21:05:34Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"So, the same \"ImportError: numpy.core.multiarray failed to import\" message appears everytime when training with SAEHD. Tried updating pip, numpy and tensorflow but the issue still exists. AMP shares the same issue, but Quick96 works perfectly.\r\n\r\nMy rig is: AMD 5950X, 128G RAM, dual RTX3090. Win10 19044.1889. No WSL nor local Python installed.\r\n\r\nThe error message is:\r\n`Initializing models: 100%|###############################################################| 5/5 [00:01<00:00,  3.12it/s]\r\nLoading samples: 100%|##############################################################| 654/654 [00:01<00:00, 478.71it/s]\r\nSort by yaw: 100%|#################################################################| 128/128 [00:00<00:00, 8525.55it/s]\r\nLoading samples: 100%|############################################################| 1619/1619 [00:03<00:00, 488.73it/s]\r\nSort by yaw: 100%|#################################################################| 128/128 [00:00<00:00, 3119.13it/s]\r\nImportError: numpy.core.multiarray failed to import\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"multiprocessing\\spawn.py\", line 105, in spawn_main\r\n  File \"multiprocessing\\spawn.py\", line 115, in _main\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\__init__.py\", line 1, in <module>\r\n    from .SubprocessorBase import Subprocessor\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\SubprocessorBase.py\", line 5, in <module>\r\n    from core.interact import interact as io\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\__init__.py\", line 1, in <module>\r\n    from .interact import interact\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\interact.py\", line 9, in <module>\r\n    import cv2\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\python-3.6.8\\lib\\site-packages\\cv2\\__init__.py\", line 3, in <module>\r\n    from .cv2 import *\r\nImportError: numpy.core.multiarray failed to import\r\nImportError: numpy.core.multiarray failed to import\r\nImportError: numpy.core.multiarray failed to import\r\nTraceback (most recent call last):\r\nImportError: numpy.core.multiarray failed to import\r\nImportError: numpy.core.multiarray failed to import\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\nTraceback (most recent call last):\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\nImportError: numpy.core.multiarray failed to import\r\nImportError: numpy.core.multiarray failed to import\r\n  File \"multiprocessing\\spawn.py\", line 105, in spawn_main\r\n  File \"<string>\", line 1, in <module>\r\n  File \"<string>\", line 1, in <module>\r\nImportError: numpy.core.multiarray failed to import\r\nImportError: numpy.core.multiarray failed to import\r\nImportError: numpy.core.multiarray failed to import\r\nImportError: numpy.core.multiarray failed to import\r\nTraceback (most recent call last):\r\nTraceback (most recent call last):\r\nImportError: numpy.core.multiarray failed to import\r\n  File \"multiprocessing\\spawn.py\", line 115, in _main\r\n  File \"multiprocessing\\spawn.py\", line 105, in spawn_main\r\n  File \"multiprocessing\\spawn.py\", line 105, in spawn_main\r\n  File \"multiprocessing\\spawn.py\", line 105, in spawn_main\r\nTraceback (most recent call last):\r\nTraceback (most recent call last):\r\nTraceback (most recent call last):\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"<string>\", line 1, in <module>\r\nTraceback (most recent call last):\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\__init__.py\", line 1, in <module>\r\n  File \"multiprocessing\\spawn.py\", line 115, in _main\r\n  File \"multiprocessing\\spawn.py\", line 115, in _main\r\nImportError: numpy.core.multiarray failed to import\r\n  File \"multiprocessing\\spawn.py\", line 115, in _main\r\n  File \"<string>\", line 1, in <module>\r\n  File \"<string>\", line 1, in <module>\r\n  File \"<string>\", line 1, in <module>\r\n  File \"<string>\", line 1, in <module>\r\n  File \"multiprocessing\\spawn.py\", line 105, in spawn_main\r\n  File \"multiprocessing\\spawn.py\", line 105, in spawn_main\r\n  File \"<string>\", line 1, in <module>\r\n    from .SubprocessorBase import Subprocessor\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\__init__.py\", line 1, in <module>\r\nTraceback (most recent call last):\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\__init__.py\", line 1, in <module>\r\n  File \"multiprocessing\\spawn.py\", line 105, in spawn_main\r\n  File \"multiprocessing\\spawn.py\", line 105, in spawn_main\r\n  File \"multiprocessing\\spawn.py\", line 105, in spawn_main\r\n  File \"multiprocessing\\spawn.py\", line 105, in spawn_main\r\n  File \"multiprocessing\\spawn.py\", line 115, in _main\r\n  File \"multiprocessing\\spawn.py\", line 115, in _main\r\n  File \"multiprocessing\\spawn.py\", line 105, in spawn_main\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\SubprocessorBase.py\", line 5, in <module>\r\n    from .SubprocessorBase import Subprocessor\r\n    from .SubprocessorBase import Subprocessor\r\n  File \"<string>\", line 1, in <module>\r\n    from .SubprocessorBase import Subprocessor\r\n  File \"multiprocessing\\spawn.py\", line 115, in _main\r\n  File \"multiprocessing\\spawn.py\", line 115, in _main\r\n  File \"multiprocessing\\spawn.py\", line 115, in _main\r\n  File \"multiprocessing\\spawn.py\", line 115, in _main\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\__init__.py\", line 1, in <module>\r\n  File \"multiprocessing\\spawn.py\", line 115, in _main\r\n    from core.interact import interact as io\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\SubprocessorBase.py\", line 5, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\SubprocessorBase.py\", line 5, in <module>\r\n  File \"multiprocessing\\spawn.py\", line 105, in spawn_main\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\SubprocessorBase.py\", line 5, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\__init__.py\", line 1, in <module>\r\n    from .SubprocessorBase import Subprocessor\r\n    from .SubprocessorBase import Subprocessor\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\__init__.py\", line 1, in <module>\r\n    from core.interact import interact as io\r\n    from core.interact import interact as io\r\n  File \"multiprocessing\\spawn.py\", line 115, in _main\r\n    from core.interact import interact as io\r\n    from .SubprocessorBase import Subprocessor\r\n    from .SubprocessorBase import Subprocessor\r\n    from .SubprocessorBase import Subprocessor\r\n    from .SubprocessorBase import Subprocessor\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\SubprocessorBase.py\", line 5, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\SubprocessorBase.py\", line 5, in <module>\r\n    from .SubprocessorBase import Subprocessor\r\n    from .interact import interact\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\SubprocessorBase.py\", line 5, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\SubprocessorBase.py\", line 5, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\SubprocessorBase.py\", line 5, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\SubprocessorBase.py\", line 5, in <module>\r\n    from core.interact import interact as io\r\n    from core.interact import interact as io\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\SubprocessorBase.py\", line 5, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\interact.py\", line 9, in <module>\r\n    from .interact import interact\r\n    from .interact import interact\r\n    from .SubprocessorBase import Subprocessor\r\n    from .interact import interact\r\n    from core.interact import interact as io\r\n    from core.interact import interact as io\r\n    from core.interact import interact as io\r\n    from core.interact import interact as io\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\__init__.py\", line 1, in <module>\r\n    from core.interact import interact as io\r\n    import cv2\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\interact.py\", line 9, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\interact.py\", line 9, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\joblib\\SubprocessorBase.py\", line 5, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\interact.py\", line 9, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\__init__.py\", line 1, in <module>\r\n    from .interact import interact\r\n    from .interact import interact\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\python-3.6.8\\lib\\site-packages\\cv2\\__init__.py\", line 3, in <module>\r\n    import cv2\r\n    import cv2\r\n    from core.interact import interact as io\r\n    import cv2\r\n    from .interact import interact\r\n    from .interact import interact\r\n    from .interact import interact\r\n    from .interact import interact\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\interact.py\", line 9, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\interact.py\", line 9, in <module>\r\n    from .interact import interact\r\n    from .cv2 import *\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\python-3.6.8\\lib\\site-packages\\cv2\\__init__.py\", line 3, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\python-3.6.8\\lib\\site-packages\\cv2\\__init__.py\", line 3, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\__init__.py\", line 1, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\python-3.6.8\\lib\\site-packages\\cv2\\__init__.py\", line 3, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\interact.py\", line 9, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\interact.py\", line 9, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\interact.py\", line 9, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\interact.py\", line 9, in <module>\r\n    import cv2\r\n    import cv2\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\interact.py\", line 9, in <module>\r\nImportError: numpy.core.multiarray failed to import\r\n    from .cv2 import *\r\n    from .cv2 import *\r\n    from .interact import interact\r\n    from .cv2 import *\r\n    import cv2\r\n    import cv2\r\n    import cv2\r\n    import cv2\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\python-3.6.8\\lib\\site-packages\\cv2\\__init__.py\", line 3, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\python-3.6.8\\lib\\site-packages\\cv2\\__init__.py\", line 3, in <module>\r\n    import cv2\r\nImportError: numpy.core.multiarray failed to import\r\nImportError: numpy.core.multiarray failed to import\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\DeepFaceLab\\core\\interact\\interact.py\", line 9, in <module>\r\nImportError: numpy.core.multiarray failed to import\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\python-3.6.8\\lib\\site-packages\\cv2\\__init__.py\", line 3, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\python-3.6.8\\lib\\site-packages\\cv2\\__init__.py\", line 3, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\python-3.6.8\\lib\\site-packages\\cv2\\__init__.py\", line 3, in <module>\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\python-3.6.8\\lib\\site-packages\\cv2\\__init__.py\", line 3, in <module>\r\n    from .cv2 import *\r\n    from .cv2 import *\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\python-3.6.8\\lib\\site-packages\\cv2\\__init__.py\", line 3, in <module>\r\n    import cv2\r\n    from .cv2 import *\r\n    from .cv2 import *\r\n    from .cv2 import *\r\n    from .cv2 import *\r\nImportError: numpy.core.multiarray failed to import\r\nImportError: numpy.core.multiarray failed to import\r\n    from .cv2 import *\r\n  File \"E:\\DeepFaceLab_NVIDIA_RTX3000_series\\_internal\\python-3.6.8\\lib\\site-packages\\cv2\\__init__.py\", line 3, in <module>\r\nImportError: numpy.core.multiarray failed to import\r\nImportError: numpy.core.multiarray failed to import\r\nImportError: numpy.core.multiarray failed to import\r\nImportError: numpy.core.multiarray failed to import\r\nImportError: numpy.core.multiarray failed to import\r\n    from .cv2 import *\r\nImportError: numpy.core.multiarray failed to import`\r\n\r\nWhat I have tried:\r\n- Upgrade pip, numpy to the latest version (here is also another thing I found weird: pip list numpy ver is 1.19.5, but what in the folder is 1.19.3)\r\n- import CV2 and numpy.core.multiarray directly with python_console.bat, no error message\r\n- run training through the python_console.bat directly, same error message.\r\n- Clean workspace folder and start from zero\r\n- redownload the file and run with the original Ironman vs Musk file.","closed_by":null,"reactions":{"url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5554/timeline","performed_via_github_app":null,"state_reason":null}