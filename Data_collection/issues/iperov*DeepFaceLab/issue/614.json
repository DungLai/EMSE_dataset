{"url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/614","repository_url":"https://api.github.com/repos/iperov/DeepFaceLab","labels_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/614/labels{/name}","comments_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/614/comments","events_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/614/events","html_url":"https://github.com/iperov/DeepFaceLab/issues/614","id":562666825,"node_id":"MDU6SXNzdWU1NjI2NjY4MjU=","number":614,"title":"cannot reshape array of size 884736 into shape (3,3,128,2048) errors + errors when attempting model name change","user":{"login":"ThomasBardem","id":57501789,"node_id":"MDQ6VXNlcjU3NTAxNzg5","avatar_url":"https://avatars.githubusercontent.com/u/57501789?v=4","gravatar_id":"","url":"https://api.github.com/users/ThomasBardem","html_url":"https://github.com/ThomasBardem","followers_url":"https://api.github.com/users/ThomasBardem/followers","following_url":"https://api.github.com/users/ThomasBardem/following{/other_user}","gists_url":"https://api.github.com/users/ThomasBardem/gists{/gist_id}","starred_url":"https://api.github.com/users/ThomasBardem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ThomasBardem/subscriptions","organizations_url":"https://api.github.com/users/ThomasBardem/orgs","repos_url":"https://api.github.com/users/ThomasBardem/repos","events_url":"https://api.github.com/users/ThomasBardem/events{/privacy}","received_events_url":"https://api.github.com/users/ThomasBardem/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-02-10T16:12:36Z","updated_at":"2020-02-12T19:32:32Z","closed_at":"2020-02-12T19:32:32Z","author_association":"NONE","active_lock_reason":null,"body":"**Expected behavior:**\r\n\r\nModels trained on the same version of DFL are being pretrained with the same data_src and data_dst dataset, training is saved, stopped and later user should be able to start it again without any issues, no matter if the files remained in folder or were moved to another folder and then brought back into the model folder. Files are being moved all, except for SAEHD_default_options file which is left in the folder.\r\n\r\n----------\r\n\r\n**Actual behavior:**\r\n\r\nSometimes models will start, get to 2/5 initialization and crash, outputing this error:\r\n\r\nInitializing models:  40%|#########################2                                     | 2/5 [00:00<00:00,  6.40it/s]Error: cannot reshape array of size 884736 into shape (3,3,128,2048)\r\nTraceback (most recent call last):\r\n  File \"F:\\DF\\DFL 2.0\\_internal\\DeepFaceLab\\mainscripts\\Trainer.py\", line 57, in trainerThread\r\n    debug=debug,\r\n  File \"F:\\DF\\DFL 2.0\\_internal\\DeepFaceLab\\models\\ModelBase.py\", line 173, in __init__\r\n    self.on_initialize()\r\n  File \"F:\\DF\\DFL 2.0\\_internal\\DeepFaceLab\\models\\Model_SAEHD\\Model.py\", line 692, in on_initialize\r\n    do_init = not model.load_weights( self.get_strpath_storage_for_file(filename) )\r\n  File \"F:\\DF\\DFL 2.0\\_internal\\DeepFaceLab\\core\\leras\\layers.py\", line 67, in load_weights\r\n    w_val = np.reshape( w_val, w.shape.as_list() )\r\n  File \"<__array_function__ internals>\", line 6, in reshape\r\n  File \"F:\\DF\\DFL 2.0\\_internal\\python-3.6.8\\lib\\site-packages\\numpy\\core\\fromnumeric.py\", line 301, in reshape\r\n    return _wrapfunc(a, 'reshape', newshape, order=order)\r\n  File \"F:\\DF\\DFL 2.0\\_internal\\python-3.6.8\\lib\\site-packages\\numpy\\core\\fromnumeric.py\", line 61, in _wrapfunc\r\n    return bound(*args, **kwds)\r\nValueError: cannot reshape array of size 884736 into shape (3,3,128,2048)\r\n\r\n-----\r\n\r\n**Steps to reproduce:**\r\n\r\nStart training, save/stop it, do nothing or move models, sometimes it works, sometimes it does not.\r\n\r\nOn one occasion I managed to fix this error by restoring SAEHD_default_options file from Model folder which I thought was irrelevant, this fixed the issue but few hours later I again cannot start training of the model that I was training few hours ago, no updates in the meantime, no changes to OS, app, no restarts of the pc, suddenly models don't want to train, new models start training and work normally. I suspect it might be happening when model is moved to another folder and then copied back to the model folder (SAEHD_default_options file is left in place).\r\n\r\nOn another occasion (just now when I'm editing) I thought that maybe when you move the model files into another folder (instead of leaving them in the model folder and just letting multiple models be there) then starting a new one (that also generate new SAEHD_default_options file) and then bringing one of the previous models back into the model folder it might cause issues but I did just that and now it works so it's really hard to tell exactly why this happens...\r\n\r\nI also tested if changing dfl folder name doesn't have any effect because I changed it - it does not, reverted to the old name (which was DFL 2.0 as opposed to new DFL2.0) and error still happening, fresh model I just started works without issues even after change so that's probably not the case.\r\n\r\nNames of the individual model files weren't changed, also noticed that trying to change a name (in this example I named model 256test1) results in error, example:\r\n\r\nEnter the name of the model you want to rename : 256test1\r\n256test1\r\nEnter new name of the model : test2\r\ntest2\r\nError: not enough values to unpack (expected 2, got 1)\r\nTraceback (most recent call last):\r\n  File \"F:\\DF\\DFL2.0\\_internal\\DeepFaceLab\\mainscripts\\Trainer.py\", line 57, in trainerThread\r\n    debug=debug,\r\n  File \"F:\\DF\\DFL2.0\\_internal\\DeepFaceLab\\models\\ModelBase.py\", line 101, in __init__\r\n    model_filename, remain_filename = filepath_name.split('_', 1)\r\nValueError: not enough values to unpack (expected 2, got 1)\r\n\r\n----------\r\n\r\n**Other relevant information:**\r\nWindows 10 Pro\r\nGTX 1060 6GB\r\ndrivers up to dates (no updates or new installations done before the error started showing up)\r\nDFL 2.0, google drive stable release from February 3rd 2020.\r\n\r\nI hope this can be fixed as it's really annoying and I never know if it's just a random bug or if some update now requires model retraining as the \"cannot reshape array of size 884736 into shape (3,3,128,2048)\" error seems to be typical of situations where models are incompatible. I could also mention issues with odd/broken results of using TrueFace but that's for another issue.","closed_by":{"login":"ThomasBardem","id":57501789,"node_id":"MDQ6VXNlcjU3NTAxNzg5","avatar_url":"https://avatars.githubusercontent.com/u/57501789?v=4","gravatar_id":"","url":"https://api.github.com/users/ThomasBardem","html_url":"https://github.com/ThomasBardem","followers_url":"https://api.github.com/users/ThomasBardem/followers","following_url":"https://api.github.com/users/ThomasBardem/following{/other_user}","gists_url":"https://api.github.com/users/ThomasBardem/gists{/gist_id}","starred_url":"https://api.github.com/users/ThomasBardem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ThomasBardem/subscriptions","organizations_url":"https://api.github.com/users/ThomasBardem/orgs","repos_url":"https://api.github.com/users/ThomasBardem/repos","events_url":"https://api.github.com/users/ThomasBardem/events{/privacy}","received_events_url":"https://api.github.com/users/ThomasBardem/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/614/timeline","performed_via_github_app":null,"state_reason":"completed"}