{"url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5245","repository_url":"https://api.github.com/repos/iperov/DeepFaceLab","labels_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5245/labels{/name}","comments_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5245/comments","events_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5245/events","html_url":"https://github.com/iperov/DeepFaceLab/issues/5245","id":786159918,"node_id":"MDU6SXNzdWU3ODYxNTk5MTg=","number":5245,"title":"Training crashes during pretraining","user":{"login":"nalhilal","id":227337,"node_id":"MDQ6VXNlcjIyNzMzNw==","avatar_url":"https://avatars.githubusercontent.com/u/227337?v=4","gravatar_id":"","url":"https://api.github.com/users/nalhilal","html_url":"https://github.com/nalhilal","followers_url":"https://api.github.com/users/nalhilal/followers","following_url":"https://api.github.com/users/nalhilal/following{/other_user}","gists_url":"https://api.github.com/users/nalhilal/gists{/gist_id}","starred_url":"https://api.github.com/users/nalhilal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nalhilal/subscriptions","organizations_url":"https://api.github.com/users/nalhilal/orgs","repos_url":"https://api.github.com/users/nalhilal/repos","events_url":"https://api.github.com/users/nalhilal/events{/privacy}","received_events_url":"https://api.github.com/users/nalhilal/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-01-14T17:05:22Z","updated_at":"2021-01-14T17:05:22Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"\r\nAfter extracting the version 01_04_2021, I immediately ran the pretraining with default options.\r\n\r\nI set the target iterations to 500,000.\r\n\r\nAfter loading and training for a while it crashes, I restarted it each time reducing batch size and it still crashes.\r\n\r\nThe final output:\r\n\r\n    Initializing models: 100%|#############################################| 5/5 [00:03<00:00,  1.64it/s]\r\n    Loaded 15843 packed faces from D:\\DeepFaceLab_NVIDIA_01_04_2021\\_internal\\pretrain_CelebA\r\n    Sort by yaw: 100%|################################################| 128/128 [00:00<00:00, 295.61it/s]\r\n    Sort by yaw: 100%|################################################| 128/128 [00:00<00:00, 289.58it/s]\r\n\r\n    =============== Model Summary ===============\r\n    ==                                         ==\r\n    ==            Model name: basic_SAEHD      ==\r\n    ==                                         ==\r\n    ==     Current iteration: 91392            ==\r\n    ==                                         ==\r\n    ==------------- Model Options -------------==\r\n    ==                                         ==\r\n    ==            resolution: 128              ==\r\n    ==             face_type: wf               ==\r\n    ==     models_opt_on_gpu: True             ==\r\n    ==                 archi: liae-ud          ==\r\n    ==               ae_dims: 256              ==\r\n    ==                e_dims: 64               ==\r\n    ==                d_dims: 64               ==\r\n    ==           d_mask_dims: 22               ==\r\n    ==       masked_training: True             ==\r\n    ==       eyes_mouth_prio: False            ==\r\n    ==           uniform_yaw: True             ==\r\n    ==             adabelief: True             ==\r\n    ==            lr_dropout: n                ==\r\n    ==           random_warp: False            ==\r\n    ==       true_face_power: 0.0              ==\r\n    ==      face_style_power: 0.0              ==\r\n    ==        bg_style_power: 0.0              ==\r\n    ==               ct_mode: rct              ==\r\n    ==              clipgrad: True             ==\r\n    ==              pretrain: True             ==\r\n    ==       autobackup_hour: 1                ==\r\n    == write_preview_history: False            ==\r\n    ==           target_iter: 500000           ==\r\n    ==           random_flip: True             ==\r\n    ==            batch_size: 4                ==\r\n    ==             gan_power: 0.0              ==\r\n    ==        gan_patch_size: 16               ==\r\n    ==              gan_dims: 16               ==\r\n    ==                                         ==\r\n    ==-------------- Running On ---------------==\r\n    ==                                         ==\r\n    ==          Device index: 0                ==\r\n    ==                  Name: GeForce RTX 2060 ==\r\n    ==                  VRAM: 6.00GB           ==\r\n    ==                                         ==\r\n    =============================================\r\n    Starting. Target iteration: 500000. Press \"Enter\" to stop training and save model.\r\n    [18:32:21][#094491][0288ms][0.4154][0.3854]\r\n    [18:47:21][#097587][0281ms][0.4149][0.3843]\r\n    [19:02:21][#100685][0300ms][0.4120][0.3807]\r\n    [19:17:22][#103782][0305ms][0.4106][0.3801]\r\n    Error: 46][#104277][0275ms][0.4674][0.3715]\r\n    Traceback (most recent call last):\r\n      File \"D:\\DeepFaceLab_NVIDIA_01_04_2021\\_internal\\DeepFaceLab\\mainscripts\\Trainer.py\", line 130, in trainerThread\r\n        iter, iter_time = model.train_one_iter()\r\n      File \"D:\\DeepFaceLab_NVIDIA_01_04_2021\\_internal\\DeepFaceLab\\models\\ModelBase.py\", line 462, in train_one_iter\r\n        losses = self.onTrainOneIter()\r\n      File \"D:\\DeepFaceLab_NVIDIA_01_04_2021\\_internal\\DeepFaceLab\\models\\Model_SAEHD\\Model.py\", line 676, in onTrainOneIter\r\n        (warped_dst, target_dst, target_dstm, target_dstm_em) ) = self.generate_next_samples()\r\n      File \"D:\\DeepFaceLab_NVIDIA_01_04_2021\\_internal\\DeepFaceLab\\models\\ModelBase.py\", line 449, in generate_next_samples\r\n        sample.append ( generator.generate_next() )\r\n      File \"D:\\DeepFaceLab_NVIDIA_01_04_2021\\_internal\\DeepFaceLab\\samplelib\\SampleGeneratorBase.py\", line 21, in generate_next\r\n        self.last_generation = next(self)\r\n      File \"D:\\DeepFaceLab_NVIDIA_01_04_2021\\_internal\\DeepFaceLab\\samplelib\\SampleGeneratorFace.py\", line 112, in __next__\r\n        return next(generator)\r\n      File \"D:\\DeepFaceLab_NVIDIA_01_04_2021\\_internal\\DeepFaceLab\\core\\joblib\\SubprocessGenerator.py\", line 73, in __next__\r\n        gen_data = self.cs_queue.get()\r\n      File \"multiprocessing\\queues.py\", line 94, in get\r\n      File \"multiprocessing\\connection.py\", line 216, in recv_bytes\r\n      File \"multiprocessing\\connection.py\", line 318, in _recv_bytes\r\n      File \"multiprocessing\\connection.py\", line 340, in _get_more_data\r\n    MemoryError\r\n   \r\n\r\nSystem Information:\r\n\r\n    Edition\tWindows 10 Home\r\n    Version\t20H2\r\n    Installed on\t‎7/‎21/‎2020\r\n    OS build\t19042.746\r\n    Experience\tWindows Feature Experience Pack 120.2212.551.0\r\n    Processor\tAMD Ryzen 7 4800H with Radeon Graphics            2.90 GHz\r\n    Installed RAM\t16.0 GB (15.4 GB usable)\r\n\r\nnvcc output:\r\n\r\n    nvcc: NVIDIA (R) Cuda compiler driver\r\n    Copyright (c) 2005-2020 NVIDIA Corporation\r\n    Built on Mon_Oct_12_20:54:10_Pacific_Daylight_Time_2020\r\n    Cuda compilation tools, release 11.1, V11.1.105\r\n    Build cuda_11.1.relgpu_drvr455TC455_06.29190527_0\r\n\r\nnvidia-smi output:\r\n\r\n    Thu Jan 14 19:53:32 2021\r\n    +-----------------------------------------------------------------------------+\r\n    | NVIDIA-SMI 460.89       Driver Version: 460.89       CUDA Version: 11.2     |\r\n    |-------------------------------+----------------------+----------------------+\r\n    | GPU  Name            TCC/WDDM | Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n    | Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n    |                               |                      |               MIG M. |\r\n    |===============================+======================+======================|\r\n    |   0  GeForce RTX 2060   WDDM  | 00000000:01:00.0 Off |                  N/A |\r\n    | N/A   44C    P8     9W /  N/A |    164MiB /  6144MiB |      0%      Default |\r\n    |                               |                      |                  N/A |\r\n    +-------------------------------+----------------------+----------------------+\r\n    \r\n    +-----------------------------------------------------------------------------+\r\n    | Processes:                                                                  |\r\n    |  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\r\n    |        ID   ID                                                   Usage      |\r\n    |=============================================================================|\r\n    |  No running processes found                                                 |\r\n    +-----------------------------------------------------------------------------+\r\n\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5245/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/iperov/DeepFaceLab/issues/5245/timeline","performed_via_github_app":null,"state_reason":null}