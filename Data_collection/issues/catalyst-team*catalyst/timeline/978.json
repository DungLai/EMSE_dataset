[{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/comments/735841550","html_url":"https://github.com/catalyst-team/catalyst/issues/978#issuecomment-735841550","issue_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/978","id":735841550,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTg0MTU1MA==","user":{"login":"Dokholyan","id":37542142,"node_id":"MDQ6VXNlcjM3NTQyMTQy","avatar_url":"https://avatars.githubusercontent.com/u/37542142?v=4","gravatar_id":"","url":"https://api.github.com/users/Dokholyan","html_url":"https://github.com/Dokholyan","followers_url":"https://api.github.com/users/Dokholyan/followers","following_url":"https://api.github.com/users/Dokholyan/following{/other_user}","gists_url":"https://api.github.com/users/Dokholyan/gists{/gist_id}","starred_url":"https://api.github.com/users/Dokholyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Dokholyan/subscriptions","organizations_url":"https://api.github.com/users/Dokholyan/orgs","repos_url":"https://api.github.com/users/Dokholyan/repos","events_url":"https://api.github.com/users/Dokholyan/events{/privacy}","received_events_url":"https://api.github.com/users/Dokholyan/received_events","type":"User","site_admin":false},"created_at":"2020-11-30T15:05:41Z","updated_at":"2020-11-30T15:08:19Z","author_association":"CONTRIBUTOR","body":"Let's say we train a segmentation model, we want to teach it using a sum of Dice and BCE losses, after it, we would like to fine tuner model using Lovasz loss. It is better to do it smoothly. Example\r\n```\r\ndef metric_aggregation(metrics: Dict[srt, torch.Tensor], runner: 'IRunner') -> torch.Tensor:\r\n    \"\"\"\r\n    If epoch < 50, the weighted sum of base loss and finetuning loss will be used\r\n    If epoch >=50, only finetuning loss will be used\r\n    \"\"\"\r\n    epoch = runner.epoch\r\n    \r\n    # base training\r\n    if epoch < 50:\r\n        base_loss = 1 * metrics['loss_dice'] + 0.8 * metrics['loss_bce']\r\n        finetuning_loss = metrics['loss_lovasz']\r\n        loss = (1 - epoch / 50) * base_loss + (epoch / 50) * finetuning_loss\r\n    # finetuning\r\n    else:\r\n        loss = metrics['loss_lovasz']\r\n    return loss\r\n\r\nMetricAggregationCallback(\r\n    prefix=\"loss\",\r\n    mode=metric_aggregation,\r\n    metrics=[\"loss_dice\", 'loss_bce', 'loss_lovasz']\r\n)\r\n```","reactions":{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/comments/735841550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Dokholyan","id":37542142,"node_id":"MDQ6VXNlcjM3NTQyMTQy","avatar_url":"https://avatars.githubusercontent.com/u/37542142?v=4","gravatar_id":"","url":"https://api.github.com/users/Dokholyan","html_url":"https://github.com/Dokholyan","followers_url":"https://api.github.com/users/Dokholyan/followers","following_url":"https://api.github.com/users/Dokholyan/following{/other_user}","gists_url":"https://api.github.com/users/Dokholyan/gists{/gist_id}","starred_url":"https://api.github.com/users/Dokholyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Dokholyan/subscriptions","organizations_url":"https://api.github.com/users/Dokholyan/orgs","repos_url":"https://api.github.com/users/Dokholyan/repos","events_url":"https://api.github.com/users/Dokholyan/events{/privacy}","received_events_url":"https://api.github.com/users/Dokholyan/received_events","type":"User","site_admin":false}},{"id":4055727301,"node_id":"MDExOkNsb3NlZEV2ZW50NDA1NTcyNzMwMQ==","url":"https://api.github.com/repos/catalyst-team/catalyst/issues/events/4055727301","actor":{"login":"KirillTushin","id":14799581,"node_id":"MDQ6VXNlcjE0Nzk5NTgx","avatar_url":"https://avatars.githubusercontent.com/u/14799581?v=4","gravatar_id":"","url":"https://api.github.com/users/KirillTushin","html_url":"https://github.com/KirillTushin","followers_url":"https://api.github.com/users/KirillTushin/followers","following_url":"https://api.github.com/users/KirillTushin/following{/other_user}","gists_url":"https://api.github.com/users/KirillTushin/gists{/gist_id}","starred_url":"https://api.github.com/users/KirillTushin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KirillTushin/subscriptions","organizations_url":"https://api.github.com/users/KirillTushin/orgs","repos_url":"https://api.github.com/users/KirillTushin/repos","events_url":"https://api.github.com/users/KirillTushin/events{/privacy}","received_events_url":"https://api.github.com/users/KirillTushin/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-12-01T08:11:38Z","state_reason":null,"performed_via_github_app":null}]