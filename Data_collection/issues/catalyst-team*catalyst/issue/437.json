{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/437","repository_url":"https://api.github.com/repos/catalyst-team/catalyst","labels_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/437/labels{/name}","comments_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/437/comments","events_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/437/events","html_url":"https://github.com/catalyst-team/catalyst/issues/437","id":505743295,"node_id":"MDU6SXNzdWU1MDU3NDMyOTU=","number":437,"title":"segmentation-tutorial.ipynb crashes without Apex","user":{"login":"kormalev","id":48528004,"node_id":"MDQ6VXNlcjQ4NTI4MDA0","avatar_url":"https://avatars.githubusercontent.com/u/48528004?v=4","gravatar_id":"","url":"https://api.github.com/users/kormalev","html_url":"https://github.com/kormalev","followers_url":"https://api.github.com/users/kormalev/followers","following_url":"https://api.github.com/users/kormalev/following{/other_user}","gists_url":"https://api.github.com/users/kormalev/gists{/gist_id}","starred_url":"https://api.github.com/users/kormalev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kormalev/subscriptions","organizations_url":"https://api.github.com/users/kormalev/orgs","repos_url":"https://api.github.com/users/kormalev/repos","events_url":"https://api.github.com/users/kormalev/events{/privacy}","received_events_url":"https://api.github.com/users/kormalev/received_events","type":"User","site_admin":false},"labels":[{"id":1029400270,"node_id":"MDU6TGFiZWwxMDI5NDAwMjcw","url":"https://api.github.com/repos/catalyst-team/catalyst/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"Scitator","id":7606451,"node_id":"MDQ6VXNlcjc2MDY0NTE=","avatar_url":"https://avatars.githubusercontent.com/u/7606451?v=4","gravatar_id":"","url":"https://api.github.com/users/Scitator","html_url":"https://github.com/Scitator","followers_url":"https://api.github.com/users/Scitator/followers","following_url":"https://api.github.com/users/Scitator/following{/other_user}","gists_url":"https://api.github.com/users/Scitator/gists{/gist_id}","starred_url":"https://api.github.com/users/Scitator/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Scitator/subscriptions","organizations_url":"https://api.github.com/users/Scitator/orgs","repos_url":"https://api.github.com/users/Scitator/repos","events_url":"https://api.github.com/users/Scitator/events{/privacy}","received_events_url":"https://api.github.com/users/Scitator/received_events","type":"User","site_admin":false},"assignees":[{"login":"TezRomacH","id":7549587,"node_id":"MDQ6VXNlcjc1NDk1ODc=","avatar_url":"https://avatars.githubusercontent.com/u/7549587?v=4","gravatar_id":"","url":"https://api.github.com/users/TezRomacH","html_url":"https://github.com/TezRomacH","followers_url":"https://api.github.com/users/TezRomacH/followers","following_url":"https://api.github.com/users/TezRomacH/following{/other_user}","gists_url":"https://api.github.com/users/TezRomacH/gists{/gist_id}","starred_url":"https://api.github.com/users/TezRomacH/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TezRomacH/subscriptions","organizations_url":"https://api.github.com/users/TezRomacH/orgs","repos_url":"https://api.github.com/users/TezRomacH/repos","events_url":"https://api.github.com/users/TezRomacH/events{/privacy}","received_events_url":"https://api.github.com/users/TezRomacH/received_events","type":"User","site_admin":false},{"login":"Scitator","id":7606451,"node_id":"MDQ6VXNlcjc2MDY0NTE=","avatar_url":"https://avatars.githubusercontent.com/u/7606451?v=4","gravatar_id":"","url":"https://api.github.com/users/Scitator","html_url":"https://github.com/Scitator","followers_url":"https://api.github.com/users/Scitator/followers","following_url":"https://api.github.com/users/Scitator/following{/other_user}","gists_url":"https://api.github.com/users/Scitator/gists{/gist_id}","starred_url":"https://api.github.com/users/Scitator/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Scitator/subscriptions","organizations_url":"https://api.github.com/users/Scitator/orgs","repos_url":"https://api.github.com/users/Scitator/repos","events_url":"https://api.github.com/users/Scitator/events{/privacy}","received_events_url":"https://api.github.com/users/Scitator/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2019-10-11T09:30:34Z","updated_at":"2019-10-15T11:38:03Z","closed_at":"2019-10-15T11:38:03Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nIn `examples/notebooks/segmentation-tutorial.ipynb`, if you skip NVIDIA Apex installation (as per the comment in the first code cell saying `if Your machine doesn't support FP16, comment this lines`),  the notebook will crash on `runner.train(...)`.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Comment out\r\n```\r\n!git clone https://github.com/NVIDIA/apex\r\n!pip install -v --no-cache-dir --global-option=\"--cpp_ext\" --global-option=\"--cuda_ext\" ./apex\r\n```\r\n2. Run all cells.\r\n\r\n**Expected behavior**\r\nSuccessful execution.\r\n\r\n**Additional context**\r\nTraceback (tested on a Colab instance with K80):\r\n```\r\n---------------------------------------------------------------------------\r\n\r\nModuleNotFoundError                       Traceback (most recent call last)\r\n\r\n/usr/local/lib/python3.6/dist-packages/catalyst/utils/torch.py in assert_fp16_available()\r\n    105     try:\r\n--> 106         __import__(\"apex\")\r\n    107     except ImportError:\r\n\r\nModuleNotFoundError: No module named 'apex'\r\n\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nAssertionError                            Traceback (most recent call last)\r\n\r\n8 frames\r\n\r\n/usr/local/lib/python3.6/dist-packages/catalyst/dl/core/runner.py in run_experiment(self, experiment, check)\r\n    227             for stage in self.experiment.stages:\r\n--> 228                 self._run_stage(stage)\r\n    229         except (Exception, KeyboardInterrupt) as ex:\r\n\r\n/usr/local/lib/python3.6/dist-packages/catalyst/dl/core/runner.py in _run_stage(self, stage)\r\n    191     def _run_stage(self, stage: str):\r\n--> 192         self._prepare_for_stage(stage)\r\n    193         loaders = self.experiment.get_loaders(stage)\r\n\r\n/usr/local/lib/python3.6/dist-packages/catalyst/dl/core/runner.py in _prepare_for_stage(self, stage)\r\n     78         self.model, criterion, optimizer, scheduler, self.device = \\\r\n---> 79             self._get_experiment_components(stage)\r\n     80 \r\n\r\n/usr/local/lib/python3.6/dist-packages/catalyst/dl/core/runner.py in _get_experiment_components(self, stage)\r\n     61                 scheduler=scheduler,\r\n---> 62                 distributed_params=self.experiment.distributed_params\r\n     63             )\r\n\r\n/usr/local/lib/python3.6/dist-packages/catalyst/dl/utils/torch.py in process_components(model, criterion, optimizer, scheduler, distributed_params)\r\n     34         assert isinstance(model, nn.Module)\r\n---> 35         utils.assert_fp16_available()\r\n     36         from apex import amp\r\n\r\n/usr/local/lib/python3.6/dist-packages/catalyst/utils/torch.py in assert_fp16_available()\r\n    108         assert False, \\\r\n--> 109             \"NVidia Apex package must be installed. \" \\\r\n    110             \"See https://github.com/NVIDIA/apex.\"\r\n\r\nAssertionError: NVidia Apex package must be installed. See https://github.com/NVIDIA/apex.\r\n\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nAttributeError                            Traceback (most recent call last)\r\n\r\n<ipython-input-25-ee9db9bd610d> in <module>()\r\n     54 \r\n     55     # prints train logs\r\n---> 56     verbose=True\r\n     57 )\r\n\r\n/usr/local/lib/python3.6/dist-packages/catalyst/dl/runner/supervised.py in train(self, model, criterion, optimizer, loaders, logdir, callbacks, scheduler, resume, num_epochs, valid_loader, main_metric, minimize_metric, verbose, state_kwargs, checkpoint_data, fp16, monitoring_params, check)\r\n    195             monitoring_params=monitoring_params\r\n    196         )\r\n--> 197         self.run_experiment(experiment, check=check)\r\n    198 \r\n    199     def infer(\r\n\r\n/usr/local/lib/python3.6/dist-packages/catalyst/dl/core/runner.py in run_experiment(self, experiment, check)\r\n    228                 self._run_stage(stage)\r\n    229         except (Exception, KeyboardInterrupt) as ex:\r\n--> 230             self.state.exception = ex\r\n    231             self._run_event(\"exception\")\r\n    232 \r\n\r\nAttributeError: 'NoneType' object has no attribute 'exception'\r\n```","closed_by":{"login":"TezRomacH","id":7549587,"node_id":"MDQ6VXNlcjc1NDk1ODc=","avatar_url":"https://avatars.githubusercontent.com/u/7549587?v=4","gravatar_id":"","url":"https://api.github.com/users/TezRomacH","html_url":"https://github.com/TezRomacH","followers_url":"https://api.github.com/users/TezRomacH/followers","following_url":"https://api.github.com/users/TezRomacH/following{/other_user}","gists_url":"https://api.github.com/users/TezRomacH/gists{/gist_id}","starred_url":"https://api.github.com/users/TezRomacH/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TezRomacH/subscriptions","organizations_url":"https://api.github.com/users/TezRomacH/orgs","repos_url":"https://api.github.com/users/TezRomacH/repos","events_url":"https://api.github.com/users/TezRomacH/events{/privacy}","received_events_url":"https://api.github.com/users/TezRomacH/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/437/timeline","performed_via_github_app":null,"state_reason":"completed"}