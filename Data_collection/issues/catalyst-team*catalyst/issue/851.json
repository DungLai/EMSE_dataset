{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/851","repository_url":"https://api.github.com/repos/catalyst-team/catalyst","labels_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/851/labels{/name}","comments_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/851/comments","events_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/851/events","html_url":"https://github.com/catalyst-team/catalyst/issues/851","id":643254805,"node_id":"MDU6SXNzdWU2NDMyNTQ4MDU=","number":851,"title":"OneCycleLRWithWarmup does not starts with init_lr","user":{"login":"lokeshkvn","id":16884938,"node_id":"MDQ6VXNlcjE2ODg0OTM4","avatar_url":"https://avatars.githubusercontent.com/u/16884938?v=4","gravatar_id":"","url":"https://api.github.com/users/lokeshkvn","html_url":"https://github.com/lokeshkvn","followers_url":"https://api.github.com/users/lokeshkvn/followers","following_url":"https://api.github.com/users/lokeshkvn/following{/other_user}","gists_url":"https://api.github.com/users/lokeshkvn/gists{/gist_id}","starred_url":"https://api.github.com/users/lokeshkvn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lokeshkvn/subscriptions","organizations_url":"https://api.github.com/users/lokeshkvn/orgs","repos_url":"https://api.github.com/users/lokeshkvn/repos","events_url":"https://api.github.com/users/lokeshkvn/events{/privacy}","received_events_url":"https://api.github.com/users/lokeshkvn/received_events","type":"User","site_admin":false},"labels":[{"id":1029400270,"node_id":"MDU6TGFiZWwxMDI5NDAwMjcw","url":"https://api.github.com/repos/catalyst-team/catalyst/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1029400273,"node_id":"MDU6TGFiZWwxMDI5NDAwMjcz","url":"https://api.github.com/repos/catalyst-team/catalyst/labels/help%20wanted","name":"help wanted","color":"008672","default":true,"description":"Extra attention is needed"}],"state":"closed","locked":false,"assignee":{"login":"Scitator","id":7606451,"node_id":"MDQ6VXNlcjc2MDY0NTE=","avatar_url":"https://avatars.githubusercontent.com/u/7606451?v=4","gravatar_id":"","url":"https://api.github.com/users/Scitator","html_url":"https://github.com/Scitator","followers_url":"https://api.github.com/users/Scitator/followers","following_url":"https://api.github.com/users/Scitator/following{/other_user}","gists_url":"https://api.github.com/users/Scitator/gists{/gist_id}","starred_url":"https://api.github.com/users/Scitator/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Scitator/subscriptions","organizations_url":"https://api.github.com/users/Scitator/orgs","repos_url":"https://api.github.com/users/Scitator/repos","events_url":"https://api.github.com/users/Scitator/events{/privacy}","received_events_url":"https://api.github.com/users/Scitator/received_events","type":"User","site_admin":false},"assignees":[{"login":"Scitator","id":7606451,"node_id":"MDQ6VXNlcjc2MDY0NTE=","avatar_url":"https://avatars.githubusercontent.com/u/7606451?v=4","gravatar_id":"","url":"https://api.github.com/users/Scitator","html_url":"https://github.com/Scitator","followers_url":"https://api.github.com/users/Scitator/followers","following_url":"https://api.github.com/users/Scitator/following{/other_user}","gists_url":"https://api.github.com/users/Scitator/gists{/gist_id}","starred_url":"https://api.github.com/users/Scitator/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Scitator/subscriptions","organizations_url":"https://api.github.com/users/Scitator/orgs","repos_url":"https://api.github.com/users/Scitator/repos","events_url":"https://api.github.com/users/Scitator/events{/privacy}","received_events_url":"https://api.github.com/users/Scitator/received_events","type":"User","site_admin":false}],"milestone":null,"comments":6,"created_at":"2020-06-22T17:46:12Z","updated_at":"2020-07-06T04:09:19Z","closed_at":"2020-07-06T04:09:19Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"## üêõ Bug Report\r\n<!-- A clear and concise description of what the bug is. -->\r\nOneCycleLRWithWarmup starts ahead of initial LR (does not start with init_lr)\r\n\r\nIf the number of steps is 6 and warmup_fraction = 0.5 and init_lr = 1e-3 and lr_range=(2e-3,1e-3),\r\nThe lr starts with 1.36-3 excutes two steps and starts cooling down from 2e-3\r\n\r\n### How To Reproduce\r\nSteps to reproduce the behavior:\r\n1. Go to https://colab.research.google.com/github/catalyst-team/catalyst/blob/master/examples/notebooks/segmentation-tutorial.ipynb#scrollTo=OG6_pgmkxk_b\r\n2.\r\n```\r\nbatch_size = 8\r\nloaders = get_loaders(\r\n    images=ALL_IMAGES[:200],\r\n    masks=ALL_MASKS[:200],\r\n    random_state=SEED,\r\n    train_transforms_fn=train_transforms,\r\n    valid_transforms_fn=valid_transforms,\r\n    batch_size=batch_size\r\n) \r\n```\r\n3. set epochs to 10 \r\n4. replace scheduler with \r\n```from catalyst.contrib.nn.schedulers.onecycle import OneCycleLRWithWarmup\r\nscheduler = OneCycleLRWithWarmup(optimizer, num_steps = 6,lr_range=(2e-3,1e-3), init_lr = 1e-3, warmup_fraction = 0.5)\r\n```\r\n5. Run \r\n\r\n<!-- If you have a code sample, error messages, stack traces, please provide it here as well --> \r\n\r\n\r\n\r\n\r\n#### Screenshots\r\n<!-- If applicable, add screenshots to help explain your problem.  -->\r\n\r\n<img width=\"849\" alt=\"Screenshot 2020-06-23 at 1 44 42 AM\" src=\"https://user-images.githubusercontent.com/16884938/85318756-20e2ab80-b4f3-11ea-8589-40039d7a056f.png\">\r\n\r\n\r\n### Expected behavior\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\nOneCycleLRWithWarmup should start with lr = init_lr\r\n(Pardon me if I am wrong, please advise me if this is the correct behavior of OneCycleLRWithWarmup as I am new to DL)\r\n\r\n\r\n### Environment\r\n\r\nGoogle Colab\r\n\r\n\r\n","closed_by":{"login":"Scitator","id":7606451,"node_id":"MDQ6VXNlcjc2MDY0NTE=","avatar_url":"https://avatars.githubusercontent.com/u/7606451?v=4","gravatar_id":"","url":"https://api.github.com/users/Scitator","html_url":"https://github.com/Scitator","followers_url":"https://api.github.com/users/Scitator/followers","following_url":"https://api.github.com/users/Scitator/following{/other_user}","gists_url":"https://api.github.com/users/Scitator/gists{/gist_id}","starred_url":"https://api.github.com/users/Scitator/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Scitator/subscriptions","organizations_url":"https://api.github.com/users/Scitator/orgs","repos_url":"https://api.github.com/users/Scitator/repos","events_url":"https://api.github.com/users/Scitator/events{/privacy}","received_events_url":"https://api.github.com/users/Scitator/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/851/timeline","performed_via_github_app":null,"state_reason":"completed"}