{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/805","repository_url":"https://api.github.com/repos/catalyst-team/catalyst","labels_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/805/labels{/name}","comments_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/805/comments","events_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/805/events","html_url":"https://github.com/catalyst-team/catalyst/issues/805","id":618564393,"node_id":"MDU6SXNzdWU2MTg1NjQzOTM=","number":805,"title":"NLP Datasets and runner","user":{"login":"elephantmipt","id":37884009,"node_id":"MDQ6VXNlcjM3ODg0MDA5","avatar_url":"https://avatars.githubusercontent.com/u/37884009?v=4","gravatar_id":"","url":"https://api.github.com/users/elephantmipt","html_url":"https://github.com/elephantmipt","followers_url":"https://api.github.com/users/elephantmipt/followers","following_url":"https://api.github.com/users/elephantmipt/following{/other_user}","gists_url":"https://api.github.com/users/elephantmipt/gists{/gist_id}","starred_url":"https://api.github.com/users/elephantmipt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elephantmipt/subscriptions","organizations_url":"https://api.github.com/users/elephantmipt/orgs","repos_url":"https://api.github.com/users/elephantmipt/repos","events_url":"https://api.github.com/users/elephantmipt/events{/privacy}","received_events_url":"https://api.github.com/users/elephantmipt/received_events","type":"User","site_admin":false},"labels":[{"id":1029400272,"node_id":"MDU6TGFiZWwxMDI5NDAwMjcy","url":"https://api.github.com/repos/catalyst-team/catalyst/labels/enhancement","name":"enhancement","color":"a2eeef","default":true,"description":"New feature or request"},{"id":1029400273,"node_id":"MDU6TGFiZWwxMDI5NDAwMjcz","url":"https://api.github.com/repos/catalyst-team/catalyst/labels/help%20wanted","name":"help wanted","color":"008672","default":true,"description":"Extra attention is needed"},{"id":1029400277,"node_id":"MDU6TGFiZWwxMDI5NDAwMjc3","url":"https://api.github.com/repos/catalyst-team/catalyst/labels/wontfix","name":"wontfix","color":"ffffff","default":true,"description":"This will not be worked on"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-05-14T22:06:16Z","updated_at":"2020-07-27T22:59:09Z","closed_at":"2020-07-27T22:59:09Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"## ðŸš€ Feature Request\r\n\r\nHi, I would like to see more NLP in catalyst. Here is a plan\r\n\r\n### Motivation\r\n\r\nThere are a lot of possible pipelines for CV but almost nothing for NLP in catalyst so far. There is simple classification dataset with non-effective pad sequence to `max_len`\r\nhttps://github.com/catalyst-team/catalyst/blob/master/catalyst/contrib/data/nlp/classification/dataset.py\r\nand there is classification model:\r\nhttps://github.com/catalyst-team/catalyst/blob/master/catalyst/contrib/models/nlp/classification/bert.py\r\nI think that logic in `forward` method here can be moved to a runner's `_handle_batch()` method.\r\n\r\nSo if we want to write, for example, MLM pipeline now, we need to write custom runner, model, dataset, dataloader with effective sorting and padding. I think this would be very boring.\r\n### Proposal\r\n<!-- A clear and concise description of what you want to happen. -->\r\nI would like to see several datasets, maybe with dataloaders like `ClassificationDataset`, `NERDataset`, `QADataset`, `MLMDataset` ... Also I think that we shouldn't create some custom\r\nwrapper for huggingface model, instead of this I would like to use huggingface model directly. In my opinion all logic with aggregating output should be in runner. I would like to see one `HuggingfaceRunner`. All pipeline would look like:\r\n```python\r\nfrom catalyst.dl import HuggingfaceRunner\r\nfrom catalyst.data.nlp import ClassificationDataset, ClassificationDataloader\r\nimport transformers\r\n\r\nmodel = transformers.BertForSequenceClassification()\r\ndataset = ClassificationDataset(df[\"text\"], df[\"labels\"], tokenizer=\"\")  # also can sort by length\r\ndataloader = ClassificationDataloader(dataset)  # effective padding etc\r\n\r\nrunner = HuggingfaceRunner()\r\n\r\nrunner.train(   # behavior depends on model (classification, NER, etc)\r\n  model=model,\r\n  loaders=...\r\n)\r\n```\r\nsame for other tasks.\r\n### Alternatives\r\n<!-- A clear and concise description of any alternative solutions or features you've considered. -->\r\nMay be we should separate runner into `ClassificationRunner` `NERRunner` and so on. But I'm sure that Datasets especially `MLMDataset` would be very convenient.\r\n\r\n### Additional context\r\nWe also can use data collators from here in datasets\r\nhttps://github.com/huggingface/transformers/blob/30e343862f0f78512faae0374fc39898bd00ce95/src/transformers/data/data_collator.py#L79\r\n\r\nI can open PR.\r\n","closed_by":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/805/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/805/timeline","performed_via_github_app":null,"state_reason":"completed"}