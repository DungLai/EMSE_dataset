{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/1435","repository_url":"https://api.github.com/repos/catalyst-team/catalyst","labels_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/1435/labels{/name}","comments_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/1435/comments","events_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/1435/events","html_url":"https://github.com/catalyst-team/catalyst/issues/1435","id":1419382578,"node_id":"I_kwDOCKpmxM5Umg8y","number":1435,"title":"Multi Criterion Training","user":{"login":"GirinChutia","id":71626493,"node_id":"MDQ6VXNlcjcxNjI2NDkz","avatar_url":"https://avatars.githubusercontent.com/u/71626493?v=4","gravatar_id":"","url":"https://api.github.com/users/GirinChutia","html_url":"https://github.com/GirinChutia","followers_url":"https://api.github.com/users/GirinChutia/followers","following_url":"https://api.github.com/users/GirinChutia/following{/other_user}","gists_url":"https://api.github.com/users/GirinChutia/gists{/gist_id}","starred_url":"https://api.github.com/users/GirinChutia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GirinChutia/subscriptions","organizations_url":"https://api.github.com/users/GirinChutia/orgs","repos_url":"https://api.github.com/users/GirinChutia/repos","events_url":"https://api.github.com/users/GirinChutia/events{/privacy}","received_events_url":"https://api.github.com/users/GirinChutia/received_events","type":"User","site_admin":false},"labels":[{"id":1029400273,"node_id":"MDU6TGFiZWwxMDI5NDAwMjcz","url":"https://api.github.com/repos/catalyst-team/catalyst/labels/help%20wanted","name":"help wanted","color":"008672","default":true,"description":"Extra attention is needed"},{"id":1029400276,"node_id":"MDU6TGFiZWwxMDI5NDAwMjc2","url":"https://api.github.com/repos/catalyst-team/catalyst/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"}],"state":"open","locked":false,"assignee":{"login":"Scitator","id":7606451,"node_id":"MDQ6VXNlcjc2MDY0NTE=","avatar_url":"https://avatars.githubusercontent.com/u/7606451?v=4","gravatar_id":"","url":"https://api.github.com/users/Scitator","html_url":"https://github.com/Scitator","followers_url":"https://api.github.com/users/Scitator/followers","following_url":"https://api.github.com/users/Scitator/following{/other_user}","gists_url":"https://api.github.com/users/Scitator/gists{/gist_id}","starred_url":"https://api.github.com/users/Scitator/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Scitator/subscriptions","organizations_url":"https://api.github.com/users/Scitator/orgs","repos_url":"https://api.github.com/users/Scitator/repos","events_url":"https://api.github.com/users/Scitator/events{/privacy}","received_events_url":"https://api.github.com/users/Scitator/received_events","type":"User","site_admin":false},"assignees":[{"login":"Scitator","id":7606451,"node_id":"MDQ6VXNlcjc2MDY0NTE=","avatar_url":"https://avatars.githubusercontent.com/u/7606451?v=4","gravatar_id":"","url":"https://api.github.com/users/Scitator","html_url":"https://github.com/Scitator","followers_url":"https://api.github.com/users/Scitator/followers","following_url":"https://api.github.com/users/Scitator/following{/other_user}","gists_url":"https://api.github.com/users/Scitator/gists{/gist_id}","starred_url":"https://api.github.com/users/Scitator/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Scitator/subscriptions","organizations_url":"https://api.github.com/users/Scitator/orgs","repos_url":"https://api.github.com/users/Scitator/repos","events_url":"https://api.github.com/users/Scitator/events{/privacy}","received_events_url":"https://api.github.com/users/Scitator/received_events","type":"User","site_admin":false},{"login":"bagxi","id":19803638,"node_id":"MDQ6VXNlcjE5ODAzNjM4","avatar_url":"https://avatars.githubusercontent.com/u/19803638?v=4","gravatar_id":"","url":"https://api.github.com/users/bagxi","html_url":"https://github.com/bagxi","followers_url":"https://api.github.com/users/bagxi/followers","following_url":"https://api.github.com/users/bagxi/following{/other_user}","gists_url":"https://api.github.com/users/bagxi/gists{/gist_id}","starred_url":"https://api.github.com/users/bagxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagxi/subscriptions","organizations_url":"https://api.github.com/users/bagxi/orgs","repos_url":"https://api.github.com/users/bagxi/repos","events_url":"https://api.github.com/users/bagxi/events{/privacy}","received_events_url":"https://api.github.com/users/bagxi/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2022-10-22T16:15:22Z","updated_at":"2022-11-24T22:36:22Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"## Error in Multi Criterion Training\r\n\r\n< \r\n\r\n    weights = [0.2,0.3]\r\n    class_weights = torch.FloatTensor(weights).to(device) #.cuda()\r\n    criterion = {\"CE_Loss1\": nn.CrossEntropyLoss(weight=class_weights),\"CE_Loss2\": nn.CrossEntropyLoss()} \r\n    ....\r\n    ....\r\n    loss1 = self.criterion[\"CE_Loss1\"](self.batch[\"logits1\"], self.batch[\"targets1\"])\r\n    loss2 = self.criterion[\"CE_Loss2\"](self.batch[\"logits2\"], self.batch[\"targets2\"])\r\n    loss_ce1ce2 = loss1 + loss2\r\n    self.batch_metrics.update({\"loss_ce1\": loss1, \r\n                               \"loss_ce2\": loss2, \r\n                               \"loss_ce1ce2\": loss_ce1ce2})\r\n    \r\n    for key in [\"loss_ce1\", \"loss_ce2\", \"loss_ce1ce2\"]:\r\n            self.meters[key].update(self.batch_metrics[key].item(), self.batch_size)\r\n   \r\n    if self.is_train_loader:\r\n        self.engine.backward(loss_ce1ce2) #causing problem\r\n        self.optimizer.step()\r\n        self.optimizer.zero_grad()\r\n>\r\n\r\n\r\n#### Hi, I am trying to train a model using multi-criterion. Part of code for computing the loss is shown above. Doing so I am getting the following error. \r\n\r\n_\r\n\r\n> RuntimeError: Trying to backward through the graph a second time (or directly access saved tensors after they have already been freed). Saved intermediate values of the graph are freed when you call .backward() or autograd.grad(). Specify retain_graph=True if you need to backward through the graph a second time or if you need to access saved tensors after calling backward.\r\n\r\n_\r\n\r\nCan anyone please check if I am doing the correct way?\r\n\r\n\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/1435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/1435/timeline","performed_via_github_app":null,"state_reason":null}