{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/993","repository_url":"https://api.github.com/repos/catalyst-team/catalyst","labels_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/993/labels{/name}","comments_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/993/comments","events_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/993/events","html_url":"https://github.com/catalyst-team/catalyst/issues/993","id":739407426,"node_id":"MDU6SXNzdWU3Mzk0MDc0MjY=","number":993,"title":"basic MNIST examples fail with wrong shape","user":{"login":"geoHeil","id":1694964,"node_id":"MDQ6VXNlcjE2OTQ5NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1694964?v=4","gravatar_id":"","url":"https://api.github.com/users/geoHeil","html_url":"https://github.com/geoHeil","followers_url":"https://api.github.com/users/geoHeil/followers","following_url":"https://api.github.com/users/geoHeil/following{/other_user}","gists_url":"https://api.github.com/users/geoHeil/gists{/gist_id}","starred_url":"https://api.github.com/users/geoHeil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/geoHeil/subscriptions","organizations_url":"https://api.github.com/users/geoHeil/orgs","repos_url":"https://api.github.com/users/geoHeil/repos","events_url":"https://api.github.com/users/geoHeil/events{/privacy}","received_events_url":"https://api.github.com/users/geoHeil/received_events","type":"User","site_admin":false},"labels":[{"id":1029400270,"node_id":"MDU6TGFiZWwxMDI5NDAwMjcw","url":"https://api.github.com/repos/catalyst-team/catalyst/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1029400273,"node_id":"MDU6TGFiZWwxMDI5NDAwMjcz","url":"https://api.github.com/repos/catalyst-team/catalyst/labels/help%20wanted","name":"help wanted","color":"008672","default":true,"description":"Extra attention is needed"}],"state":"closed","locked":false,"assignee":{"login":"bagxi","id":19803638,"node_id":"MDQ6VXNlcjE5ODAzNjM4","avatar_url":"https://avatars.githubusercontent.com/u/19803638?v=4","gravatar_id":"","url":"https://api.github.com/users/bagxi","html_url":"https://github.com/bagxi","followers_url":"https://api.github.com/users/bagxi/followers","following_url":"https://api.github.com/users/bagxi/following{/other_user}","gists_url":"https://api.github.com/users/bagxi/gists{/gist_id}","starred_url":"https://api.github.com/users/bagxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagxi/subscriptions","organizations_url":"https://api.github.com/users/bagxi/orgs","repos_url":"https://api.github.com/users/bagxi/repos","events_url":"https://api.github.com/users/bagxi/events{/privacy}","received_events_url":"https://api.github.com/users/bagxi/received_events","type":"User","site_admin":false},"assignees":[{"login":"ditwoo","id":7264490,"node_id":"MDQ6VXNlcjcyNjQ0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/7264490?v=4","gravatar_id":"","url":"https://api.github.com/users/ditwoo","html_url":"https://github.com/ditwoo","followers_url":"https://api.github.com/users/ditwoo/followers","following_url":"https://api.github.com/users/ditwoo/following{/other_user}","gists_url":"https://api.github.com/users/ditwoo/gists{/gist_id}","starred_url":"https://api.github.com/users/ditwoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ditwoo/subscriptions","organizations_url":"https://api.github.com/users/ditwoo/orgs","repos_url":"https://api.github.com/users/ditwoo/repos","events_url":"https://api.github.com/users/ditwoo/events{/privacy}","received_events_url":"https://api.github.com/users/ditwoo/received_events","type":"User","site_admin":false},{"login":"Scitator","id":7606451,"node_id":"MDQ6VXNlcjc2MDY0NTE=","avatar_url":"https://avatars.githubusercontent.com/u/7606451?v=4","gravatar_id":"","url":"https://api.github.com/users/Scitator","html_url":"https://github.com/Scitator","followers_url":"https://api.github.com/users/Scitator/followers","following_url":"https://api.github.com/users/Scitator/following{/other_user}","gists_url":"https://api.github.com/users/Scitator/gists{/gist_id}","starred_url":"https://api.github.com/users/Scitator/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Scitator/subscriptions","organizations_url":"https://api.github.com/users/Scitator/orgs","repos_url":"https://api.github.com/users/Scitator/repos","events_url":"https://api.github.com/users/Scitator/events{/privacy}","received_events_url":"https://api.github.com/users/Scitator/received_events","type":"User","site_admin":false},{"login":"bagxi","id":19803638,"node_id":"MDQ6VXNlcjE5ODAzNjM4","avatar_url":"https://avatars.githubusercontent.com/u/19803638?v=4","gravatar_id":"","url":"https://api.github.com/users/bagxi","html_url":"https://github.com/bagxi","followers_url":"https://api.github.com/users/bagxi/followers","following_url":"https://api.github.com/users/bagxi/following{/other_user}","gists_url":"https://api.github.com/users/bagxi/gists{/gist_id}","starred_url":"https://api.github.com/users/bagxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagxi/subscriptions","organizations_url":"https://api.github.com/users/bagxi/orgs","repos_url":"https://api.github.com/users/bagxi/repos","events_url":"https://api.github.com/users/bagxi/events{/privacy}","received_events_url":"https://api.github.com/users/bagxi/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2020-11-09T22:24:21Z","updated_at":"2020-11-12T07:14:39Z","closed_at":"2020-11-12T07:14:39Z","author_association":"NONE","active_lock_reason":null,"body":"When trying to execute the basic classification tutorials of MNIST - it fails with tensors of a wrong shape:\r\n\r\n```\r\nview size is not compatible with input tensor's size and stride (at least one dimension spans across two contiguous subspaces). Use .reshape(...) instead.\r\n\r\n```\r\n\r\nto reproduce:\r\n\r\n```\r\nconda create --name torch\r\nconda activate torch\r\nconda install -y jupyter pytorch torchvision torchaudio python=3.8 -c pytorch -c conda-forge\r\n\r\n```\r\n\r\nand the nexecute in the notebook:\r\n\r\n```\r\nimport os\r\nimport torch\r\nfrom torch.nn import functional as F\r\nfrom torch.utils.data import DataLoader\r\nfrom catalyst import dl, metrics\r\nfrom catalyst.data.cv import ToTensor\r\nfrom catalyst.contrib.datasets import MNIST\r\n\r\nmodel = torch.nn.Linear(28 * 28, 10)\r\noptimizer = torch.optim.Adam(model.parameters(), lr=0.02)\r\n\r\nloaders = {\r\n    \"train\": DataLoader(MNIST(os.getcwd(), train=True, download=True, transform=ToTensor()), batch_size=32),\r\n    \"valid\": DataLoader(MNIST(os.getcwd(), train=False, download=True, transform=ToTensor()), batch_size=32),\r\n}\r\n\r\nclass CustomRunner(dl.Runner):\r\n\r\n    def _handle_batch(self, batch):\r\n        x, y = batch\r\n        y_hat = self.model(x.view(x.size(0), -1))\r\n\r\n        loss = F.cross_entropy(y_hat, y)\r\n        accuracy01, accuracy03, accuracy05 = metrics.accuracy(y_hat, y, topk=(1, 3, 5))\r\n        self.batch_metrics = {\r\n            \"loss\": loss,\r\n            \"accuracy01\": accuracy01,\r\n            \"accuracy03\": accuracy03,\r\n            \"accuracy05\": accuracy05,\r\n        }\r\n        \r\n        if self.is_train_loader:\r\n            loss.backward()\r\n            self.optimizer.step()\r\n            self.optimizer.zero_grad()\r\n\r\nrunner = CustomRunner()\r\nrunner.train(\r\n    model=model, \r\n    optimizer=optimizer, \r\n    loaders=loaders, \r\n    verbose=True,\r\n)\r\n```\r\n\r\nAfter the download & extraction I see the following warning:\r\n\r\n```\r\n/usr/local/Caskroom/miniconda/base/envs/torch/lib/python3.8/site-packages/catalyst/contrib/datasets/functional.py:205: UserWarning:\r\n\r\nThe given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /Users/distiller/project/conda/conda-bld/pytorch_1603740477510/work/torch/csrc/utils/tensor_numpy.cpp:141.)\r\n```","closed_by":{"login":"Scitator","id":7606451,"node_id":"MDQ6VXNlcjc2MDY0NTE=","avatar_url":"https://avatars.githubusercontent.com/u/7606451?v=4","gravatar_id":"","url":"https://api.github.com/users/Scitator","html_url":"https://github.com/Scitator","followers_url":"https://api.github.com/users/Scitator/followers","following_url":"https://api.github.com/users/Scitator/following{/other_user}","gists_url":"https://api.github.com/users/Scitator/gists{/gist_id}","starred_url":"https://api.github.com/users/Scitator/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Scitator/subscriptions","organizations_url":"https://api.github.com/users/Scitator/orgs","repos_url":"https://api.github.com/users/Scitator/repos","events_url":"https://api.github.com/users/Scitator/events{/privacy}","received_events_url":"https://api.github.com/users/Scitator/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/993/timeline","performed_via_github_app":null,"state_reason":"completed"}