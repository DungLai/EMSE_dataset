{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/1068","repository_url":"https://api.github.com/repos/catalyst-team/catalyst","labels_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/1068/labels{/name}","comments_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/1068/comments","events_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/1068/events","html_url":"https://github.com/catalyst-team/catalyst/issues/1068","id":811340698,"node_id":"MDU6SXNzdWU4MTEzNDA2OTg=","number":1068,"title":"Way to use weighted loss in config","user":{"login":"v-goncharenko","id":19154289,"node_id":"MDQ6VXNlcjE5MTU0Mjg5","avatar_url":"https://avatars.githubusercontent.com/u/19154289?v=4","gravatar_id":"","url":"https://api.github.com/users/v-goncharenko","html_url":"https://github.com/v-goncharenko","followers_url":"https://api.github.com/users/v-goncharenko/followers","following_url":"https://api.github.com/users/v-goncharenko/following{/other_user}","gists_url":"https://api.github.com/users/v-goncharenko/gists{/gist_id}","starred_url":"https://api.github.com/users/v-goncharenko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/v-goncharenko/subscriptions","organizations_url":"https://api.github.com/users/v-goncharenko/orgs","repos_url":"https://api.github.com/users/v-goncharenko/repos","events_url":"https://api.github.com/users/v-goncharenko/events{/privacy}","received_events_url":"https://api.github.com/users/v-goncharenko/received_events","type":"User","site_admin":false},"labels":[{"id":1029400272,"node_id":"MDU6TGFiZWwxMDI5NDAwMjcy","url":"https://api.github.com/repos/catalyst-team/catalyst/labels/enhancement","name":"enhancement","color":"a2eeef","default":true,"description":"New feature or request"},{"id":1029400273,"node_id":"MDU6TGFiZWwxMDI5NDAwMjcz","url":"https://api.github.com/repos/catalyst-team/catalyst/labels/help%20wanted","name":"help wanted","color":"008672","default":true,"description":"Extra attention is needed"}],"state":"closed","locked":false,"assignee":{"login":"bagxi","id":19803638,"node_id":"MDQ6VXNlcjE5ODAzNjM4","avatar_url":"https://avatars.githubusercontent.com/u/19803638?v=4","gravatar_id":"","url":"https://api.github.com/users/bagxi","html_url":"https://github.com/bagxi","followers_url":"https://api.github.com/users/bagxi/followers","following_url":"https://api.github.com/users/bagxi/following{/other_user}","gists_url":"https://api.github.com/users/bagxi/gists{/gist_id}","starred_url":"https://api.github.com/users/bagxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagxi/subscriptions","organizations_url":"https://api.github.com/users/bagxi/orgs","repos_url":"https://api.github.com/users/bagxi/repos","events_url":"https://api.github.com/users/bagxi/events{/privacy}","received_events_url":"https://api.github.com/users/bagxi/received_events","type":"User","site_admin":false},"assignees":[{"login":"ditwoo","id":7264490,"node_id":"MDQ6VXNlcjcyNjQ0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/7264490?v=4","gravatar_id":"","url":"https://api.github.com/users/ditwoo","html_url":"https://github.com/ditwoo","followers_url":"https://api.github.com/users/ditwoo/followers","following_url":"https://api.github.com/users/ditwoo/following{/other_user}","gists_url":"https://api.github.com/users/ditwoo/gists{/gist_id}","starred_url":"https://api.github.com/users/ditwoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ditwoo/subscriptions","organizations_url":"https://api.github.com/users/ditwoo/orgs","repos_url":"https://api.github.com/users/ditwoo/repos","events_url":"https://api.github.com/users/ditwoo/events{/privacy}","received_events_url":"https://api.github.com/users/ditwoo/received_events","type":"User","site_admin":false},{"login":"Scitator","id":7606451,"node_id":"MDQ6VXNlcjc2MDY0NTE=","avatar_url":"https://avatars.githubusercontent.com/u/7606451?v=4","gravatar_id":"","url":"https://api.github.com/users/Scitator","html_url":"https://github.com/Scitator","followers_url":"https://api.github.com/users/Scitator/followers","following_url":"https://api.github.com/users/Scitator/following{/other_user}","gists_url":"https://api.github.com/users/Scitator/gists{/gist_id}","starred_url":"https://api.github.com/users/Scitator/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Scitator/subscriptions","organizations_url":"https://api.github.com/users/Scitator/orgs","repos_url":"https://api.github.com/users/Scitator/repos","events_url":"https://api.github.com/users/Scitator/events{/privacy}","received_events_url":"https://api.github.com/users/Scitator/received_events","type":"User","site_admin":false},{"login":"bagxi","id":19803638,"node_id":"MDQ6VXNlcjE5ODAzNjM4","avatar_url":"https://avatars.githubusercontent.com/u/19803638?v=4","gravatar_id":"","url":"https://api.github.com/users/bagxi","html_url":"https://github.com/bagxi","followers_url":"https://api.github.com/users/bagxi/followers","following_url":"https://api.github.com/users/bagxi/following{/other_user}","gists_url":"https://api.github.com/users/bagxi/gists{/gist_id}","starred_url":"https://api.github.com/users/bagxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bagxi/subscriptions","organizations_url":"https://api.github.com/users/bagxi/orgs","repos_url":"https://api.github.com/users/bagxi/repos","events_url":"https://api.github.com/users/bagxi/events{/privacy}","received_events_url":"https://api.github.com/users/bagxi/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2021-02-18T18:10:27Z","updated_at":"2021-02-19T10:44:35Z","closed_at":"2021-02-19T10:40:50Z","author_association":"NONE","active_lock_reason":null,"body":"I use configs to train my nets and now I've faced imbalanced classification problem. It could be solved by training classifier with weighted loss and `pytorch` losses support weighting out of the box.\r\n\r\nBut I couldn't use them because they accept only tensor input. If I provide a list of desired weights via config it get parsed to regular python list, so loss constructor fails.\r\n\r\nTo solve this I've written own wrapper class that constructs tensor and passes it to loss:\r\n\r\n```python\r\nclass WrappedCrossEntropyLoss(nn.CrossEntropyLoss):\r\n    '''Implements standard CrossEntropyLoss, where weight param can be list, not tensor'''\r\n\r\n    def __init__(self, weights: Optional[List] = None):\r\n        weights_tensor = torch.tensor(weights) if weights is not None else None\r\n        super().__init__(weights_tensor)\r\n```\r\n\r\nThen regular config works fine:\r\n\r\n```yaml\r\n    criterion_params:\r\n        criterion: WrappedCrossEntropyLoss\r\n        weights: [0.2491, 1.0]\r\n```\r\n\r\nIs is intentional behaviour and could `catalyst` somehow cast such arguments automatically?\r\n\r\nI guess it could be solved by enhancing config parsing algorithm. In case you are interested in solving this I could create some PR.","closed_by":{"login":"v-goncharenko","id":19154289,"node_id":"MDQ6VXNlcjE5MTU0Mjg5","avatar_url":"https://avatars.githubusercontent.com/u/19154289?v=4","gravatar_id":"","url":"https://api.github.com/users/v-goncharenko","html_url":"https://github.com/v-goncharenko","followers_url":"https://api.github.com/users/v-goncharenko/followers","following_url":"https://api.github.com/users/v-goncharenko/following{/other_user}","gists_url":"https://api.github.com/users/v-goncharenko/gists{/gist_id}","starred_url":"https://api.github.com/users/v-goncharenko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/v-goncharenko/subscriptions","organizations_url":"https://api.github.com/users/v-goncharenko/orgs","repos_url":"https://api.github.com/users/v-goncharenko/repos","events_url":"https://api.github.com/users/v-goncharenko/events{/privacy}","received_events_url":"https://api.github.com/users/v-goncharenko/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/1068/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/1068/timeline","performed_via_github_app":null,"state_reason":"completed"}