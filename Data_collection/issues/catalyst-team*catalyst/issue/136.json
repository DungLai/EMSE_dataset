{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/136","repository_url":"https://api.github.com/repos/catalyst-team/catalyst","labels_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/136/labels{/name}","comments_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/136/comments","events_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/136/events","html_url":"https://github.com/catalyst-team/catalyst/issues/136","id":428729156,"node_id":"MDU6SXNzdWU0Mjg3MjkxNTY=","number":136,"title":"Bug: ZeroDivisionError while computing FPS counter","user":{"login":"BloodAxe","id":532320,"node_id":"MDQ6VXNlcjUzMjMyMA==","avatar_url":"https://avatars.githubusercontent.com/u/532320?v=4","gravatar_id":"","url":"https://api.github.com/users/BloodAxe","html_url":"https://github.com/BloodAxe","followers_url":"https://api.github.com/users/BloodAxe/followers","following_url":"https://api.github.com/users/BloodAxe/following{/other_user}","gists_url":"https://api.github.com/users/BloodAxe/gists{/gist_id}","starred_url":"https://api.github.com/users/BloodAxe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BloodAxe/subscriptions","organizations_url":"https://api.github.com/users/BloodAxe/orgs","repos_url":"https://api.github.com/users/BloodAxe/repos","events_url":"https://api.github.com/users/BloodAxe/events{/privacy}","received_events_url":"https://api.github.com/users/BloodAxe/received_events","type":"User","site_admin":false},"labels":[{"id":1029400270,"node_id":"MDU6TGFiZWwxMDI5NDAwMjcw","url":"https://api.github.com/repos/catalyst-team/catalyst/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"hexfaker","id":4684868,"node_id":"MDQ6VXNlcjQ2ODQ4Njg=","avatar_url":"https://avatars.githubusercontent.com/u/4684868?v=4","gravatar_id":"","url":"https://api.github.com/users/hexfaker","html_url":"https://github.com/hexfaker","followers_url":"https://api.github.com/users/hexfaker/followers","following_url":"https://api.github.com/users/hexfaker/following{/other_user}","gists_url":"https://api.github.com/users/hexfaker/gists{/gist_id}","starred_url":"https://api.github.com/users/hexfaker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hexfaker/subscriptions","organizations_url":"https://api.github.com/users/hexfaker/orgs","repos_url":"https://api.github.com/users/hexfaker/repos","events_url":"https://api.github.com/users/hexfaker/events{/privacy}","received_events_url":"https://api.github.com/users/hexfaker/received_events","type":"User","site_admin":false},"assignees":[{"login":"hexfaker","id":4684868,"node_id":"MDQ6VXNlcjQ2ODQ4Njg=","avatar_url":"https://avatars.githubusercontent.com/u/4684868?v=4","gravatar_id":"","url":"https://api.github.com/users/hexfaker","html_url":"https://github.com/hexfaker","followers_url":"https://api.github.com/users/hexfaker/followers","following_url":"https://api.github.com/users/hexfaker/following{/other_user}","gists_url":"https://api.github.com/users/hexfaker/gists{/gist_id}","starred_url":"https://api.github.com/users/hexfaker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hexfaker/subscriptions","organizations_url":"https://api.github.com/users/hexfaker/orgs","repos_url":"https://api.github.com/users/hexfaker/repos","events_url":"https://api.github.com/users/hexfaker/events{/privacy}","received_events_url":"https://api.github.com/users/hexfaker/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2019-04-03T12:05:02Z","updated_at":"2019-05-12T10:14:36Z","closed_at":"2019-05-12T10:14:36Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Hi.\r\n\r\nI've got some weird unhanded exception during simple train run:\r\n```\r\n  File \"C:/Develop/pytorch-toolbelt/examples/canny-edge-detector-in-cnn/example_canny_cnn.py\", line 127, in <module>\r\n    #     metrics=[\"loss\", \"precision01\", \"precision03\", \"base/lr\"])\r\n  File \"C:/Develop/pytorch-toolbelt/examples/canny-edge-detector-in-cnn/example_canny_cnn.py\", line 117, in main\r\n    ],\r\n  File \"C:\\Anaconda3\\envs\\kaggle\\lib\\site-packages\\catalyst\\dl\\experiments\\runner.py\", line 271, in train\r\n    self.run_experiment(experiment, check=check)\r\n  File \"C:\\Anaconda3\\envs\\kaggle\\lib\\site-packages\\catalyst\\dl\\experiments\\runner.py\", line 194, in run_experiment\r\n    self._run_stage(stage)\r\n  File \"C:\\Anaconda3\\envs\\kaggle\\lib\\site-packages\\catalyst\\dl\\experiments\\runner.py\", line 175, in _run_stage\r\n    self._run_epoch(loaders)\r\n  File \"C:\\Anaconda3\\envs\\kaggle\\lib\\site-packages\\catalyst\\dl\\experiments\\runner.py\", line 160, in _run_epoch\r\n    self._run_loader(loaders[loader_name])\r\n  File \"C:\\Anaconda3\\envs\\kaggle\\lib\\site-packages\\catalyst\\dl\\experiments\\runner.py\", line 132, in _run_loader\r\n    self._run_event(\"batch_end\")\r\n  File \"C:\\Anaconda3\\envs\\kaggle\\lib\\site-packages\\catalyst\\dl\\experiments\\runner.py\", line 97, in _run_event\r\n    getattr(self.state, f\"on_{event}_post\")()\r\n  File \"C:\\Anaconda3\\envs\\kaggle\\lib\\site-packages\\catalyst\\dl\\state.py\", line 153, in on_batch_end_post\r\n    self._handle_runner_metrics()\r\n  File \"C:\\Anaconda3\\envs\\kaggle\\lib\\site-packages\\catalyst\\dl\\state.py\", line 114, in _handle_runner_metrics\r\n    self.batch_size / self.timer.elapsed[\"base/batch_time\"]\r\nZeroDivisionError: float division by zero\r\n```\r\n\r\nBefore it happened, training logs looked totally fine:\r\n```\r\nC:\\Anaconda3\\envs\\kaggle\\python.exe C:/Develop/pytorch-toolbelt/examples/canny-edge-detector-in-cnn/example_canny_cnn.py\r\n0/100 * Epoch (train): 100% 87/87 [01:37<00:00,  2.28it/s, _fps=16383.000, jaccard=0.000, loss=0.068]\r\n0/100 * Epoch (valid): 100% 10/10 [00:39<00:00,  4.53s/it, _fps=240.926, jaccard=0.000, loss=0.085]\r\n[2019-04-03 14:35:00,371] \r\n0/100 * Epoch (train): _fps=13657.5198 | base/batch_time=0.7826 | base/data_time=0.7441 | base/lr=0.0010 | base/model_time=0.0385 | base/momentum=0.9000 | jaccard=0.0074 | loss=0.0802\r\n0/100 * Epoch (valid): _fps=8236.0160 | base/batch_time=3.8731 | base/data_time=3.7668 | base/lr=0.0010 | base/model_time=0.1063 | base/momentum=0.9000 | jaccard=0.0001 | loss=0.0837\r\n1/100 * Epoch (train): 100% 87/87 [01:36<00:00,  2.72it/s, _fps=16395.258, jaccard=0.001, loss=0.061]\r\n1/100 * Epoch (valid): 100% 10/10 [00:37<00:00,  3.78s/it, _fps=16383.000, jaccard=0.004, loss=0.077]\r\n[2019-04-03 14:37:15,192] \r\n1/100 * Epoch (train): _fps=13985.1989 | base/batch_time=0.8083 | base/data_time=0.8061 | base/lr=0.0010 | base/model_time=0.0022 | base/momentum=0.9000 | jaccard=0.0001 | loss=0.0642\r\n1/100 * Epoch (valid): _fps=6082.4207 | base/batch_time=3.6415 | base/data_time=3.6382 | base/lr=0.0010 | base/model_time=0.0032 | base/momentum=0.9000 | jaccard=0.0033 | loss=0.0761\r\n2/100 * Epoch (train): 100% 87/87 [01:34<00:00,  2.51it/s, _fps=16382.500, jaccard=0.186, loss=0.049]\r\n2/100 * Epoch (valid): 100% 10/10 [00:37<00:00,  6.22s/it, _fps=16382.000, jaccard=0.188, loss=0.064]\r\n[2019-04-03 14:39:29,013] \r\n2/100 * Epoch (train): _fps=13115.4018 | base/batch_time=0.7891 | base/data_time=0.7886 | base/lr=0.0010 | base/model_time=0.0005 | base/momentum=0.9000 | jaccard=0.0762 | loss=0.0538\r\n2/100 * Epoch (valid): _fps=12309.1793 | base/batch_time=3.6892 | base/data_time=3.6892 | base/lr=0.0010 | base/model_time=0.0000 | base/momentum=0.9000 | jaccard=0.1834 | loss=0.0630\r\n3/100 * Epoch (train): 100% 87/87 [01:35<00:00,  2.46it/s, _fps=16387.001, jaccard=0.267, loss=0.043]\r\n3/100 * Epoch (valid): 100% 10/10 [00:37<00:00,  3.76s/it, _fps=16382.750, jaccard=0.273, loss=0.056]\r\n[2019-04-03 14:41:42,811] \r\n3/100 * Epoch (train): _fps=13093.6248 | base/batch_time=0.7970 | base/data_time=0.7961 | base/lr=0.0010 | base/model_time=0.0009 | base/momentum=0.9000 | jaccard=0.2246 | loss=0.0447\r\n3/100 * Epoch (valid): _fps=13118.9414 | base/batch_time=3.6233 | base/data_time=3.6233 | base/lr=0.0010 | base/model_time=0.0000 | base/momentum=0.9000 | jaccard=0.2659 | loss=0.0549\r\n4/100 * Epoch (train): 100% 87/87 [01:36<00:00,  2.62it/s, _fps=16249.120, jaccard=0.354, loss=0.038]\r\n4/100 * Epoch (valid): 100% 10/10 [00:39<00:00,  3.93s/it, _fps=16383.000, jaccard=0.356, loss=0.049]\r\n[2019-04-03 14:43:58,902] \r\n4/100 * Epoch (train): _fps=13008.1172 | base/batch_time=0.8044 | base/data_time=0.8031 | base/lr=0.0010 | base/model_time=0.0014 | base/momentum=0.9000 | jaccard=0.3206 | loss=0.0382\r\n4/100 * Epoch (valid): _fps=13161.2595 | base/batch_time=3.7907 | base/data_time=3.7907 | base/lr=0.0010 | base/model_time=0.0000 | base/momentum=0.9000 | jaccard=0.3512 | loss=0.0484\r\n5/100 * Epoch (train): 100% 87/87 [01:36<00:00,  2.57it/s, _fps=16387.001, jaccard=0.437, loss=0.032]\r\n5/100 * Epoch (valid): 100% 10/10 [00:37<00:00,  3.78s/it, _fps=16384.000, jaccard=0.431, loss=0.044]\r\n[2019-04-03 14:46:13,698] \r\n5/100 * Epoch (train): _fps=14208.6617 | base/batch_time=0.8076 | base/data_time=0.8067 | base/lr=0.0010 | base/model_time=0.0009 | base/momentum=0.9000 | jaccard=0.4012 | loss=0.0333\r\n5/100 * Epoch (valid): _fps=11602.1947 | base/batch_time=3.6362 | base/data_time=3.6362 | base/lr=0.0010 | base/model_time=0.0000 | base/momentum=0.9000 | jaccard=0.4264 | loss=0.0436\r\n6/100 * Epoch (train): 100% 87/87 [01:36<00:00,  2.82it/s, _fps=16382.750, jaccard=0.477, loss=0.030]\r\n6/100 * Epoch (valid): 100% 10/10 [00:37<00:00,  4.33s/it, _fps=19348.791, jaccard=0.481, loss=0.041]\r\n[2019-04-03 14:48:28,650] \r\n6/100 * Epoch (train): _fps=14899.4017 | base/batch_time=0.8033 | base/data_time=0.8029 | base/lr=0.0010 | base/model_time=0.0004 | base/momentum=0.9000 | jaccard=0.4614 | loss=0.0299\r\n6/100 * Epoch (valid): _fps=10905.9308 | base/batch_time=3.6788 | base/data_time=3.6784 | base/lr=0.0010 | base/model_time=0.0003 | base/momentum=0.9000 | jaccard=0.4788 | loss=0.0399\r\n7/100 * Epoch (train): 100% 87/87 [01:37<00:00,  2.58it/s, _fps=16387.001, jaccard=0.509, loss=0.030]\r\n7/100 * Epoch (valid): 100% 10/10 [00:38<00:00,  4.41s/it, _fps=16382.500, jaccard=0.506, loss=0.039]\r\n[2019-04-03 14:50:45,999] \r\n7/100 * Epoch (train): _fps=14034.5155 | base/batch_time=0.8213 | base/data_time=0.8204 | base/lr=0.0010 | base/model_time=0.0009 | base/momentum=0.9000 | jaccard=0.5000 | loss=0.0278\r\n7/100 * Epoch (valid): _fps=10034.7244 | base/batch_time=3.7788 | base/data_time=3.7787 | base/lr=0.0010 | base/model_time=0.0001 | base/momentum=0.9000 | jaccard=0.5043 | loss=0.0382\r\n8/100 * Epoch (train): 100% 87/87 [01:36<00:00,  2.66it/s, _fps=16351.813, jaccard=0.533, loss=0.028]\r\n8/100 * Epoch (valid): 100% 10/10 [00:40<00:00,  4.00s/it, _fps=16210.115, jaccard=0.527, loss=0.038]\r\n[2019-04-03 14:53:03,136] \r\n8/100 * Epoch (train): _fps=13962.9568 | base/batch_time=0.8072 | base/data_time=0.8066 | base/lr=0.0010 | base/model_time=0.0006 | base/momentum=0.9000 | jaccard=0.5228 | loss=0.0264\r\n8/100 * Epoch (valid): _fps=11596.8021 | base/batch_time=3.8571 | base/data_time=3.8570 | base/lr=0.0010 | base/model_time=0.0001 | base/momentum=0.9000 | jaccard=0.5253 | loss=0.0369\r\n9/100 * Epoch (train): 100% 87/87 [01:36<00:00,  2.50it/s, _fps=16382.750, jaccard=0.535, loss=0.025]\r\n9/100 * Epoch (valid): 100% 10/10 [00:37<00:00,  3.08s/it, _fps=16382.750, jaccard=0.541, loss=0.037]\r\n[2019-04-03 14:55:18,959] \r\n9/100 * Epoch (train): _fps=13944.8145 | base/batch_time=0.8145 | base/data_time=0.8135 | base/lr=0.0010 | base/model_time=0.0008 | base/momentum=0.9000 | jaccard=0.5375 | loss=0.0256\r\n9/100 * Epoch (valid): _fps=9995.8059 | base/batch_time=3.6704 | base/data_time=3.6704 | base/lr=0.0010 | base/model_time=0.0000 | base/momentum=0.9000 | jaccard=0.5390 | loss=0.0359\r\n10/100 * Epoch (train): 100% 87/87 [01:35<00:00,  2.55it/s, _fps=16382.750, jaccard=0.560, loss=0.024]\r\n10/100 * Epoch (valid):  80% 8/10 [00:37<00:12,  6.05s/it, _fps=16383.000, jaccard=0.552, loss=0.036]\r\n```\r\n\r\nFor reference, train script: https://github.com/BloodAxe/pytorch-toolbelt/blob/feature/example-canny-cnn/examples/canny-edge-detector-in-cnn/example_canny_cnn.py\r\n\r\nEnvironment:\r\nOS: Windows 10\r\nPython: 3.6\r\nCatalyst: 19.3\r\nPyTorch: 1.0.1","closed_by":{"login":"BloodAxe","id":532320,"node_id":"MDQ6VXNlcjUzMjMyMA==","avatar_url":"https://avatars.githubusercontent.com/u/532320?v=4","gravatar_id":"","url":"https://api.github.com/users/BloodAxe","html_url":"https://github.com/BloodAxe","followers_url":"https://api.github.com/users/BloodAxe/followers","following_url":"https://api.github.com/users/BloodAxe/following{/other_user}","gists_url":"https://api.github.com/users/BloodAxe/gists{/gist_id}","starred_url":"https://api.github.com/users/BloodAxe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BloodAxe/subscriptions","organizations_url":"https://api.github.com/users/BloodAxe/orgs","repos_url":"https://api.github.com/users/BloodAxe/repos","events_url":"https://api.github.com/users/BloodAxe/events{/privacy}","received_events_url":"https://api.github.com/users/BloodAxe/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/catalyst-team/catalyst/issues/136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/catalyst-team/catalyst/issues/136/timeline","performed_via_github_app":null,"state_reason":"completed"}