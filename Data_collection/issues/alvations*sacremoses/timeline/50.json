[{"url":"https://api.github.com/repos/alvations/sacremoses/issues/comments/492452935","html_url":"https://github.com/alvations/sacremoses/issues/50#issuecomment-492452935","issue_url":"https://api.github.com/repos/alvations/sacremoses/issues/50","id":492452935,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjQ1MjkzNQ==","user":{"login":"alvations","id":1050316,"node_id":"MDQ6VXNlcjEwNTAzMTY=","avatar_url":"https://avatars.githubusercontent.com/u/1050316?v=4","gravatar_id":"","url":"https://api.github.com/users/alvations","html_url":"https://github.com/alvations","followers_url":"https://api.github.com/users/alvations/followers","following_url":"https://api.github.com/users/alvations/following{/other_user}","gists_url":"https://api.github.com/users/alvations/gists{/gist_id}","starred_url":"https://api.github.com/users/alvations/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alvations/subscriptions","organizations_url":"https://api.github.com/users/alvations/orgs","repos_url":"https://api.github.com/users/alvations/repos","events_url":"https://api.github.com/users/alvations/events{/privacy}","received_events_url":"https://api.github.com/users/alvations/received_events","type":"User","site_admin":false},"created_at":"2019-05-14T23:56:40Z","updated_at":"2019-05-14T23:57:37Z","author_association":"OWNER","body":"@loretoparisi Sorry for the lack of documentation. \r\n\r\nIt's because `protected_patterns` is of string type. This should work:\r\n\r\n```python\r\nimport re\r\nfrom sacremoses import MosesTokenizer, MosesPunctNormalizer\r\n\r\ntext = \"Don't let me find that\"\r\nlang = \"en\"\r\n\r\nmpn = MosesPunctNormalizer(lang = lang)\r\nmtok = MosesTokenizer(lang = lang)\r\n\r\npatterns =  MosesTokenizer.BASIC_PROTECTED_PATTERNS\r\ncontractionRegex = r\"^[a-zA-Z]+\\'t\"\r\npatterns.append( contractionRegex )\r\n\r\n# normalize\r\ntext =  mpn.normalize(text.lower())\r\n# tokenize\r\ntokens = mtok.tokenize(text, escape=False, return_str=False, aggressive_dash_splits=False, protected_patterns=patterns)\r\n```\r\n\r\n[out]:\r\n\r\n```\r\n[\"don't\", 'let', 'me', 'find', 'that']\r\n```\r\n\r\n\r\nBTW, are the `re.IGNORECASE|re.UNICODE|re.VERBOSE` flags necessary for the regex to work, currently, it's only doing `re.IGNORECASE` in code https://github.com/alvations/sacremoses/blob/master/sacremoses/tokenize.py#L326\r\n\r\nAssuming that we're all in Python3, `re.UNICODE` would have been the default =)\r\n\r\nAs for verbose, I think using the literal strings as regex would help, e.g. `r\"^[a-zA-Z]+\\'t\"`","reactions":{"url":"https://api.github.com/repos/alvations/sacremoses/issues/comments/492452935/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"alvations","id":1050316,"node_id":"MDQ6VXNlcjEwNTAzMTY=","avatar_url":"https://avatars.githubusercontent.com/u/1050316?v=4","gravatar_id":"","url":"https://api.github.com/users/alvations","html_url":"https://github.com/alvations","followers_url":"https://api.github.com/users/alvations/followers","following_url":"https://api.github.com/users/alvations/following{/other_user}","gists_url":"https://api.github.com/users/alvations/gists{/gist_id}","starred_url":"https://api.github.com/users/alvations/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alvations/subscriptions","organizations_url":"https://api.github.com/users/alvations/orgs","repos_url":"https://api.github.com/users/alvations/repos","events_url":"https://api.github.com/users/alvations/events{/privacy}","received_events_url":"https://api.github.com/users/alvations/received_events","type":"User","site_admin":false}},{"id":2341748452,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjM0MTc0ODQ1Mg==","url":"https://api.github.com/repos/alvations/sacremoses/issues/events/2341748452","actor":{"login":"loretoparisi","id":163333,"node_id":"MDQ6VXNlcjE2MzMzMw==","avatar_url":"https://avatars.githubusercontent.com/u/163333?v=4","gravatar_id":"","url":"https://api.github.com/users/loretoparisi","html_url":"https://github.com/loretoparisi","followers_url":"https://api.github.com/users/loretoparisi/followers","following_url":"https://api.github.com/users/loretoparisi/following{/other_user}","gists_url":"https://api.github.com/users/loretoparisi/gists{/gist_id}","starred_url":"https://api.github.com/users/loretoparisi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/loretoparisi/subscriptions","organizations_url":"https://api.github.com/users/loretoparisi/orgs","repos_url":"https://api.github.com/users/loretoparisi/repos","events_url":"https://api.github.com/users/loretoparisi/events{/privacy}","received_events_url":"https://api.github.com/users/loretoparisi/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-14T23:56:40Z","performed_via_github_app":null},{"id":2341748453,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzNDE3NDg0NTM=","url":"https://api.github.com/repos/alvations/sacremoses/issues/events/2341748453","actor":{"login":"loretoparisi","id":163333,"node_id":"MDQ6VXNlcjE2MzMzMw==","avatar_url":"https://avatars.githubusercontent.com/u/163333?v=4","gravatar_id":"","url":"https://api.github.com/users/loretoparisi","html_url":"https://github.com/loretoparisi","followers_url":"https://api.github.com/users/loretoparisi/followers","following_url":"https://api.github.com/users/loretoparisi/following{/other_user}","gists_url":"https://api.github.com/users/loretoparisi/gists{/gist_id}","starred_url":"https://api.github.com/users/loretoparisi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/loretoparisi/subscriptions","organizations_url":"https://api.github.com/users/loretoparisi/orgs","repos_url":"https://api.github.com/users/loretoparisi/repos","events_url":"https://api.github.com/users/loretoparisi/events{/privacy}","received_events_url":"https://api.github.com/users/loretoparisi/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-14T23:56:40Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/alvations/sacremoses/issues/comments/492557455","html_url":"https://github.com/alvations/sacremoses/issues/50#issuecomment-492557455","issue_url":"https://api.github.com/repos/alvations/sacremoses/issues/50","id":492557455,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjU1NzQ1NQ==","user":{"login":"loretoparisi","id":163333,"node_id":"MDQ6VXNlcjE2MzMzMw==","avatar_url":"https://avatars.githubusercontent.com/u/163333?v=4","gravatar_id":"","url":"https://api.github.com/users/loretoparisi","html_url":"https://github.com/loretoparisi","followers_url":"https://api.github.com/users/loretoparisi/followers","following_url":"https://api.github.com/users/loretoparisi/following{/other_user}","gists_url":"https://api.github.com/users/loretoparisi/gists{/gist_id}","starred_url":"https://api.github.com/users/loretoparisi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/loretoparisi/subscriptions","organizations_url":"https://api.github.com/users/loretoparisi/orgs","repos_url":"https://api.github.com/users/loretoparisi/repos","events_url":"https://api.github.com/users/loretoparisi/events{/privacy}","received_events_url":"https://api.github.com/users/loretoparisi/received_events","type":"User","site_admin":false},"created_at":"2019-05-15T08:24:29Z","updated_at":"2019-05-15T08:24:29Z","author_association":"NONE","body":"@alvations thank you very much, it works now!\r\nBy the way I have also added more regex to handle contractions of quotes / accents like\r\n\r\n```python\r\npatterns =  MosesTokenizer.BASIC_PROTECTED_PATTERNS\r\n        \r\n        # don't | it's | ain't | \r\n        contractionRegex = r\"[a-zA-Z]+['’‘][a-zA-Z]+\"\r\n        patterns.append(contractionRegex)\r\n        # 'cause\r\n        contractionRegex = r\"['’‘][a-zA-Z]+\"\r\n        patterns.append(contractionRegex)\r\n        # goin'\r\n        contractionRegex = r\"[a-zA-Z]+['’‘]\"\r\n        patterns.append(contractionRegex)\r\n```\r\n\r\nall works doing\r\n\r\n```python\r\ntokenized = []\r\n        for line in lines:\r\n        \r\n            # Aggressive Tokenizer\r\n            #tokens = re.split(r'\\s+', line)\r\n\r\n            # CoreNLP Tokenizer\r\n            # doc = nlp(line)\r\n            # tokens = []\r\n            # for sentence in doc.sentences:\r\n            #     for token in sentence.tokens:\r\n            #         word=token.words[0]\r\n            #         tokens.append( word.text )\r\n            \r\n            # Moses Tokenizer\r\n            tokens = mtok.tokenize(line, escape=False, return_str=False, aggressive_dash_splits=False, protected_patterns=patterns)\r\n            tokenized.append(tokens)\r\n```","reactions":{"url":"https://api.github.com/repos/alvations/sacremoses/issues/comments/492557455/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"loretoparisi","id":163333,"node_id":"MDQ6VXNlcjE2MzMzMw==","avatar_url":"https://avatars.githubusercontent.com/u/163333?v=4","gravatar_id":"","url":"https://api.github.com/users/loretoparisi","html_url":"https://github.com/loretoparisi","followers_url":"https://api.github.com/users/loretoparisi/followers","following_url":"https://api.github.com/users/loretoparisi/following{/other_user}","gists_url":"https://api.github.com/users/loretoparisi/gists{/gist_id}","starred_url":"https://api.github.com/users/loretoparisi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/loretoparisi/subscriptions","organizations_url":"https://api.github.com/users/loretoparisi/orgs","repos_url":"https://api.github.com/users/loretoparisi/repos","events_url":"https://api.github.com/users/loretoparisi/events{/privacy}","received_events_url":"https://api.github.com/users/loretoparisi/received_events","type":"User","site_admin":false}},{"id":2342492514,"node_id":"MDExOkNsb3NlZEV2ZW50MjM0MjQ5MjUxNA==","url":"https://api.github.com/repos/alvations/sacremoses/issues/events/2342492514","actor":{"login":"loretoparisi","id":163333,"node_id":"MDQ6VXNlcjE2MzMzMw==","avatar_url":"https://avatars.githubusercontent.com/u/163333?v=4","gravatar_id":"","url":"https://api.github.com/users/loretoparisi","html_url":"https://github.com/loretoparisi","followers_url":"https://api.github.com/users/loretoparisi/followers","following_url":"https://api.github.com/users/loretoparisi/following{/other_user}","gists_url":"https://api.github.com/users/loretoparisi/gists{/gist_id}","starred_url":"https://api.github.com/users/loretoparisi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/loretoparisi/subscriptions","organizations_url":"https://api.github.com/users/loretoparisi/orgs","repos_url":"https://api.github.com/users/loretoparisi/repos","events_url":"https://api.github.com/users/loretoparisi/events{/privacy}","received_events_url":"https://api.github.com/users/loretoparisi/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-05-15T08:24:29Z","state_reason":null,"performed_via_github_app":null},{"id":2342492520,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjM0MjQ5MjUyMA==","url":"https://api.github.com/repos/alvations/sacremoses/issues/events/2342492520","actor":{"login":"alvations","id":1050316,"node_id":"MDQ6VXNlcjEwNTAzMTY=","avatar_url":"https://avatars.githubusercontent.com/u/1050316?v=4","gravatar_id":"","url":"https://api.github.com/users/alvations","html_url":"https://github.com/alvations","followers_url":"https://api.github.com/users/alvations/followers","following_url":"https://api.github.com/users/alvations/following{/other_user}","gists_url":"https://api.github.com/users/alvations/gists{/gist_id}","starred_url":"https://api.github.com/users/alvations/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alvations/subscriptions","organizations_url":"https://api.github.com/users/alvations/orgs","repos_url":"https://api.github.com/users/alvations/repos","events_url":"https://api.github.com/users/alvations/events{/privacy}","received_events_url":"https://api.github.com/users/alvations/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-15T08:24:29Z","performed_via_github_app":null},{"id":2342492521,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzNDI0OTI1MjE=","url":"https://api.github.com/repos/alvations/sacremoses/issues/events/2342492521","actor":{"login":"alvations","id":1050316,"node_id":"MDQ6VXNlcjEwNTAzMTY=","avatar_url":"https://avatars.githubusercontent.com/u/1050316?v=4","gravatar_id":"","url":"https://api.github.com/users/alvations","html_url":"https://github.com/alvations","followers_url":"https://api.github.com/users/alvations/followers","following_url":"https://api.github.com/users/alvations/following{/other_user}","gists_url":"https://api.github.com/users/alvations/gists{/gist_id}","starred_url":"https://api.github.com/users/alvations/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alvations/subscriptions","organizations_url":"https://api.github.com/users/alvations/orgs","repos_url":"https://api.github.com/users/alvations/repos","events_url":"https://api.github.com/users/alvations/events{/privacy}","received_events_url":"https://api.github.com/users/alvations/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-15T08:24:29Z","performed_via_github_app":null}]