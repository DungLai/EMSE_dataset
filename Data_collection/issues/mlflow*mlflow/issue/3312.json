{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3312","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/3312/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/3312/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/3312/events","html_url":"https://github.com/mlflow/mlflow/issues/3312","id":684078555,"node_id":"MDU6SXNzdWU2ODQwNzg1NTU=","number":3312,"title":"MLFlow on AWS : mlflow.start_run() throws error","user":{"login":"MaddyThakker","id":23390805,"node_id":"MDQ6VXNlcjIzMzkwODA1","avatar_url":"https://avatars.githubusercontent.com/u/23390805?v=4","gravatar_id":"","url":"https://api.github.com/users/MaddyThakker","html_url":"https://github.com/MaddyThakker","followers_url":"https://api.github.com/users/MaddyThakker/followers","following_url":"https://api.github.com/users/MaddyThakker/following{/other_user}","gists_url":"https://api.github.com/users/MaddyThakker/gists{/gist_id}","starred_url":"https://api.github.com/users/MaddyThakker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaddyThakker/subscriptions","organizations_url":"https://api.github.com/users/MaddyThakker/orgs","repos_url":"https://api.github.com/users/MaddyThakker/repos","events_url":"https://api.github.com/users/MaddyThakker/events{/privacy}","received_events_url":"https://api.github.com/users/MaddyThakker/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2020-08-22T22:34:02Z","updated_at":"2020-08-23T15:43:12Z","closed_at":"2020-08-23T15:42:52Z","author_association":"NONE","active_lock_reason":null,"body":"### System information\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 18.04\r\n- **MLflow installed from (source or binary)**: binary\r\n- **MLflow version (run ``mlflow --version``)**: 1.7.2\r\n- **Python version**: Python 2.7.18\r\n- **Exact command to reproduce**:  mlflow.start_run()\r\n\r\n### Describe the problem\r\nI was trying to set-up the remote MLFlow server on AWS to store artifacts, parameters and logs. I was following the Medium [tutorial](https://medium.com/@alexanderneshitov/how-to-run-an-mlflow-tracking-server-on-aws-ec2-d7afd0ac8008) and encountered the error on step-15. \r\n\r\nTo reiterate, I have set up the AWS instance and the S3 bucket, I am able to see the graphical window for the runs. \r\nI am facing the error when creating a new run on the remote server.\r\n\r\n\r\n\r\n### Other info / logs\r\n```\r\nLocationParseError                        Traceback (most recent call last)\r\n/usr/lib/python3/dist-packages/requests/models.py in prepare_url(self, url, params)\r\n    378         try:\r\n--> 379             scheme, auth, host, port, path, query, fragment = parse_url(url)\r\n    380         except LocationParseError as e:\r\n\r\n/usr/lib/python3/dist-packages/urllib3/util/url.py in parse_url(url)\r\n    391     except (ValueError, AttributeError):\r\n--> 392         return six.raise_from(LocationParseError(source_url), None)\r\n    393 \r\n\r\n~/.local/lib/python3.8/site-packages/six.py in raise_from(value, from_value)\r\n\r\nLocationParseError: Failed to parse: http://testuser:testuser@ec2-100-26-165-170.compute-1.amazonaws.com/api/2.0/mlflow/runs/create\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nInvalidURL                                Traceback (most recent call last)\r\n<ipython-input-14-45b8f594dec1> in <module>\r\n     13 plt.savefig('./test_picture.png')\r\n     14 ''' log parameters, metrics and artifacts on server '''\r\n---> 15 with mlflow.start_run():\r\n     16     mlflow.log_param('parameter', 1)\r\n     17     mlflow.log_metric('metric', 2)\r\n\r\n~/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py in start_run(run_id, experiment_id, run_name, nested)\r\n    146         tags = context_registry.resolve_tags(user_specified_tags)\r\n    147 \r\n--> 148         active_run_obj = MlflowClient().create_run(\r\n    149             experiment_id=exp_id_for_run,\r\n    150             tags=tags\r\n\r\n~/.local/lib/python3.8/site-packages/mlflow/tracking/client.py in create_run(self, experiment_id, start_time, tags)\r\n    121         :return: :py:class:`mlflow.entities.Run` that was created.\r\n    122         \"\"\"\r\n--> 123         return self._tracking_client.create_run(experiment_id, start_time, tags)\r\n    124 \r\n    125     def list_run_infos(self, experiment_id, run_view_type=ViewType.ACTIVE_ONLY):\r\n\r\n~/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py in create_run(self, experiment_id, start_time, tags)\r\n     82         user_id = tags.get(MLFLOW_USER, \"unknown\")\r\n     83 \r\n---> 84         return self.store.create_run(\r\n     85             experiment_id=experiment_id,\r\n     86             user_id=user_id,\r\n\r\n~/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py in create_run(self, experiment_id, user_id, start_time, tags)\r\n    115             experiment_id=str(experiment_id), user_id=user_id,\r\n    116             start_time=start_time, tags=tag_protos))\r\n--> 117         response_proto = self._call_endpoint(CreateRun, req_body)\r\n    118         run = Run.from_proto(response_proto.run)\r\n    119         return run\r\n\r\n~/.local/lib/python3.8/site-packages/mlflow/store/tracking/rest_store.py in _call_endpoint(self, api, json_body)\r\n     30         endpoint, method = _METHOD_TO_INFO[api]\r\n     31         response_proto = api.Response()\r\n---> 32         return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)\r\n     33 \r\n     34     def list_experiments(self, view_type=ViewType.ACTIVE_ONLY):\r\n\r\n~/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py in call_endpoint(host_creds, endpoint, method, json_body, response_proto)\r\n    140             host_creds=host_creds, endpoint=endpoint, method=method, params=json_body)\r\n    141     else:\r\n--> 142         response = http_request(\r\n    143             host_creds=host_creds, endpoint=endpoint, method=method, json=json_body)\r\n    144     response = verify_rest_response(response, endpoint)\r\n\r\n~/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py in http_request(host_creds, endpoint, retries, retry_interval, max_rate_limit_interval, **kwargs)\r\n     74     url = \"%s%s\" % (cleaned_hostname, endpoint)\r\n     75     for i in range(retries):\r\n---> 76         response = request_with_ratelimit_retries(max_rate_limit_interval,\r\n     77                                                   url=url, headers=headers, verify=verify, **kwargs)\r\n     78         if response.status_code >= 200 and response.status_code < 500:\r\n\r\n~/.local/lib/python3.8/site-packages/mlflow/utils/rest_utils.py in request_with_ratelimit_retries(max_rate_limit_interval, **kwargs)\r\n     56 \r\n     57     def request_with_ratelimit_retries(max_rate_limit_interval, **kwargs):\r\n---> 58         response = requests.request(**kwargs)\r\n     59         time_left = max_rate_limit_interval\r\n     60         sleep = 1\r\n\r\n/usr/lib/python3/dist-packages/requests/api.py in request(method, url, **kwargs)\r\n     58     # cases, and look like a memory leak in others.\r\n     59     with sessions.Session() as session:\r\n---> 60         return session.request(method=method, url=url, **kwargs)\r\n     61 \r\n     62 \r\n\r\n/usr/lib/python3/dist-packages/requests/sessions.py in request(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)\r\n    517             hooks=hooks,\r\n    518         )\r\n--> 519         prep = self.prepare_request(req)\r\n    520 \r\n    521         proxies = proxies or {}\r\n\r\n/usr/lib/python3/dist-packages/requests/sessions.py in prepare_request(self, request)\r\n    450 \r\n    451         p = PreparedRequest()\r\n--> 452         p.prepare(\r\n    453             method=request.method.upper(),\r\n    454             url=request.url,\r\n\r\n/usr/lib/python3/dist-packages/requests/models.py in prepare(self, method, url, headers, files, data, params, auth, cookies, hooks, json)\r\n    311 \r\n    312         self.prepare_method(method)\r\n--> 313         self.prepare_url(url, params)\r\n    314         self.prepare_headers(headers)\r\n    315         self.prepare_cookies(cookies)\r\n\r\n/usr/lib/python3/dist-packages/requests/models.py in prepare_url(self, url, params)\r\n    379             scheme, auth, host, port, path, query, fragment = parse_url(url)\r\n    380         except LocationParseError as e:\r\n--> 381             raise InvalidURL(*e.args)\r\n    382 \r\n    383         if not scheme:\r\n\r\nInvalidURL: Failed to parse: http://testuser:testuser@ec2-100-26-165-170.compute-1.amazonaws.com/api/2.0/mlflow/runs/create\r\n```","closed_by":{"login":"MaddyThakker","id":23390805,"node_id":"MDQ6VXNlcjIzMzkwODA1","avatar_url":"https://avatars.githubusercontent.com/u/23390805?v=4","gravatar_id":"","url":"https://api.github.com/users/MaddyThakker","html_url":"https://github.com/MaddyThakker","followers_url":"https://api.github.com/users/MaddyThakker/followers","following_url":"https://api.github.com/users/MaddyThakker/following{/other_user}","gists_url":"https://api.github.com/users/MaddyThakker/gists{/gist_id}","starred_url":"https://api.github.com/users/MaddyThakker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaddyThakker/subscriptions","organizations_url":"https://api.github.com/users/MaddyThakker/orgs","repos_url":"https://api.github.com/users/MaddyThakker/repos","events_url":"https://api.github.com/users/MaddyThakker/events{/privacy}","received_events_url":"https://api.github.com/users/MaddyThakker/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3312/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/3312/timeline","performed_via_github_app":null,"state_reason":"completed"}