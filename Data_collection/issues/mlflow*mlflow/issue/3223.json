{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3223","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/3223/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/3223/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/3223/events","html_url":"https://github.com/mlflow/mlflow/issues/3223","id":672443809,"node_id":"MDU6SXNzdWU2NzI0NDM4MDk=","number":3223,"title":"Failed to start sparklyr backend: there is no package called ‘SparR\"","user":{"login":"saroup","id":34381225,"node_id":"MDQ6VXNlcjM0MzgxMjI1","avatar_url":"https://avatars.githubusercontent.com/u/34381225?v=4","gravatar_id":"","url":"https://api.github.com/users/saroup","html_url":"https://github.com/saroup","followers_url":"https://api.github.com/users/saroup/followers","following_url":"https://api.github.com/users/saroup/following{/other_user}","gists_url":"https://api.github.com/users/saroup/gists{/gist_id}","starred_url":"https://api.github.com/users/saroup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/saroup/subscriptions","organizations_url":"https://api.github.com/users/saroup/orgs","repos_url":"https://api.github.com/users/saroup/repos","events_url":"https://api.github.com/users/saroup/events{/privacy}","received_events_url":"https://api.github.com/users/saroup/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":968461607,"node_id":"MDU6TGFiZWw5Njg0NjE2MDc=","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/windows","name":"area/windows","color":"ede978","default":false,"description":"Issue is unique to windows."},{"id":1041183632,"node_id":"MDU6TGFiZWwxMDQxMTgzNjMy","url":"https://api.github.com/repos/mlflow/mlflow/labels/language/r","name":"language/r","color":"349cd8","default":false,"description":"R APIs and clients"},{"id":2114036915,"node_id":"MDU6TGFiZWwyMTE0MDM2OTE1","url":"https://api.github.com/repos/mlflow/mlflow/labels/integrations/databricks","name":"integrations/databricks","color":"ffbce5","default":false,"description":"Databricks integrations"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-08-04T01:45:41Z","updated_at":"2021-08-27T16:42:52Z","closed_at":"2021-08-27T16:42:52Z","author_association":"NONE","active_lock_reason":null,"body":"Thank you for submitting an issue. Please refer to our [issue policy](https://www.github.com/mlflow/mlflow/blob/master/ISSUE_POLICY.md) for additional information about bug reports. For help with debugging your code, please refer to [Stack Overflow](https://stackoverflow.com/questions/tagged/mlflow).\r\n\r\n**Please fill in this bug report template to ensure a timely and thorough response.**\r\n\r\n### System information\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Windows\r\n- **MLflow installed from (source or binary)**: source\r\n- **MLflow version (run ``mlflow --version``)**: r-mlflow-1.10.0\r\n- **Python version**:  python=3.6\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Include descriptions of the expected behavior and the actual behavior.\r\nI am using MLFlow project to submit an (R script that uses sparklyr) to databricks.\r\n\r\n1. Installing sparklyr in .yaml: \r\n---\r\nname: training\r\nchannels:\r\n  - defaults\r\n  - anaconda\r\n  - conda-forge\r\ndependencies:\r\n  - r-mlflow\r\n  - r-sparklyr\r\n\r\nIn Train.R:\r\nsuppressPackageStartupMessages(library(sparklyr))\r\nsuppressPackageStartupMessages(library(mlflow))\r\n\r\nspark_install()\r\n\r\nsc <- spark_connect(method = \"databricks\")\r\n\r\nWhen I run the code, I am able to create an experiment and an associated run but I am getting this error: \r\n\r\n\"Failed to start sparklyr backend: there is no package called ‘SparkR'\r\n\r\nThen I tried installing sparkR by doing:\r\ninstall.packages(\"/databricks/spark/R/pkg\", repos = NULL)\r\nand in train.r\r\nlibrary(SparkR)\r\n\r\nand now I get \r\n'Failed to start sparklyr backend: object 'DATABRICKS_GUID' not found'\r\n\r\nI don't fully understand how mlflow works underneath but all documentation pointing to databricks-connect and sparklyr doesn't mention the need to have sparkR installed and when installed not sure what additional steps should be taken to allow my mlproject to execute succesfully. \r\n\r\n**Additional logs**\r\n2020/07/30 19:42:40 INFO mlflow.projects: === Created directory /tmp/tmp8a5ydb64 for downloading remote URIs passed to arguments of type 'path' ===\r\n2020/07/30 19:42:40 INFO mlflow.projects: === Running command 'source /databricks/conda/bin/../etc/profile.d/conda.sh && conda activate mlflow-11e11553c770f6c418479994ab90c0af35012a2b 1>&2 && Rscript utils/install.R && Rscript predict/predict.R data.csv model.rds 1 output.csv && Rscript utils/spark_save_predictions_to_db.R output.csv predict85475' in run with ID 'dcff5844dd2c4bc8863643e89d4edb1f' === \r\nRegistered S3 method overwritten by 'openssl':\r\n  method      from\r\n  print.bytes Rcpp\r\nWarning message:\r\npackage ‘mlflow’ was built under R version 3.6.3 \r\nCreating conda environment r-mlflow-1.10.0\r\n\r\n\r\n==> WARNING: A newer version of conda exists. <==\r\n  current version: 4.8.2\r\n  latest version: 4.8.3\r\n\r\nPlease update conda by running\r\n\r\n    $ conda update -n base -c defaults conda\r\n\r\n\r\nInstalling package into ‘/databricks/spark/R/lib’\r\n(as ‘lib’ is unspecified)\r\n* installing *source* package ‘SparkR’ ...\r\n** using staged installation\r\n** R\r\n** inst\r\n** byte-compile and prepare package for lazy loading\r\n** help\r\n*** installing help indices\r\n** building package indices\r\n** installing vignettes\r\n** testing if installed package can be loaded from temporary location\r\n** testing if installed package can be loaded from final location\r\n** testing if installed package keeps a record of temporary installation path\r\n* DONE (SparkR)\r\nWarning message:\r\npackage ‘mlflow’ was built under R version 3.6.3 \r\n\r\nAttaching package: ‘SparkR’\r\n\r\nThe following objects are masked from ‘package:stats’:\r\n\r\n    cov, filter, lag, na.omit, predict, sd, var, window\r\n\r\nThe following objects are masked from ‘package:base’:\r\n\r\n    as.data.frame, colnames, colnames<-, drop, endsWith, intersect,\r\n    rank, rbind, sample, startsWith, subset, summary, transform, union\r\n\r\n\r\nAttaching package: ‘sparklyr’\r\n\r\nThe following object is masked from ‘package:SparkR’:\r\n\r\n    collect\r\n\r\nError in value[[3L]](cond) : \r\n  Failed to start sparklyr backend: object 'DATABRICKS_GUID' not found\r\nCalls: spark_connect ... tryCatch -> tryCatchList -> tryCatchOne -> <Anonymous>\r\nExecution halted\r\n2020/07/30 19:43:49 ERROR mlflow.cli: === Run (ID 'dcff5844dd2c4bc8863643e89d4edb1f') failed ===\r\n\r\n\r\nInterface \r\n- [X ] `area/windows`: Windows support\r\n\r\nLanguage \r\n- [X ] `language/r`: R APIs and clients\r\nIntegrations\r\n- [X] `integrations/databricks`: Databricks integrations\r\n","closed_by":{"login":"AveshCSingh","id":1208791,"node_id":"MDQ6VXNlcjEyMDg3OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1208791?v=4","gravatar_id":"","url":"https://api.github.com/users/AveshCSingh","html_url":"https://github.com/AveshCSingh","followers_url":"https://api.github.com/users/AveshCSingh/followers","following_url":"https://api.github.com/users/AveshCSingh/following{/other_user}","gists_url":"https://api.github.com/users/AveshCSingh/gists{/gist_id}","starred_url":"https://api.github.com/users/AveshCSingh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AveshCSingh/subscriptions","organizations_url":"https://api.github.com/users/AveshCSingh/orgs","repos_url":"https://api.github.com/users/AveshCSingh/repos","events_url":"https://api.github.com/users/AveshCSingh/events{/privacy}","received_events_url":"https://api.github.com/users/AveshCSingh/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/3223/timeline","performed_via_github_app":null,"state_reason":"completed"}