{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2381","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/2381/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/2381/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/2381/events","html_url":"https://github.com/mlflow/mlflow/issues/2381","id":559089983,"node_id":"MDU6SXNzdWU1NTkwODk5ODM=","number":2381,"title":"[BUG] Cannot create Mllfow tracking Server Database on Linux - Ubuntu 16.04 Error: (1071, 'Specified key was too long; max key length is 767 bytes')","user":{"login":"SaadEphlux","id":56433390,"node_id":"MDQ6VXNlcjU2NDMzMzkw","avatar_url":"https://avatars.githubusercontent.com/u/56433390?v=4","gravatar_id":"","url":"https://api.github.com/users/SaadEphlux","html_url":"https://github.com/SaadEphlux","followers_url":"https://api.github.com/users/SaadEphlux/followers","following_url":"https://api.github.com/users/SaadEphlux/following{/other_user}","gists_url":"https://api.github.com/users/SaadEphlux/gists{/gist_id}","starred_url":"https://api.github.com/users/SaadEphlux/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SaadEphlux/subscriptions","organizations_url":"https://api.github.com/users/SaadEphlux/orgs","repos_url":"https://api.github.com/users/SaadEphlux/repos","events_url":"https://api.github.com/users/SaadEphlux/events{/privacy}","received_events_url":"https://api.github.com/users/SaadEphlux/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":2022849295,"node_id":"MDU6TGFiZWwyMDIyODQ5Mjk1","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/tracking","name":"area/tracking","color":"48eabc","default":false,"description":"Tracking service, tracking client APIs, autologging"},{"id":2022866842,"node_id":"MDU6TGFiZWwyMDIyODY2ODQy","url":"https://api.github.com/repos/mlflow/mlflow/labels/priority/awaiting-more-evidence","name":"priority/awaiting-more-evidence","color":"534cb5","default":false,"description":"Lowest priority. Possibly useful, but not yet enough support to actually get it done."}],"state":"open","locked":false,"assignee":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false},"assignees":[{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false}],"milestone":null,"comments":10,"created_at":"2020-02-03T13:38:42Z","updated_at":"2021-02-08T12:19:00Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in MLflow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04\r\n- **MLflow installed from (source or binary)**: Source\r\n- **MLflow version (run ``mlflow --version``)**: latest 1.6\r\n- **Python version**:3.7\r\n- **npm version, if running the dev UI**:-\r\n- **Exact command to reproduce**: `mlflow.log_metric(\"dummy_metric\", 12)`\r\n\r\n### Describe the problem\r\nHey guys I am facing difficulty in creating a database tables using mlflow.  So I was doing my development on windows where I had no issues with the Database. The issue occurred when I **shifted** to **Linux** and installed **MariaDB** directly from the command line where as in windows I was using Xammp and the **MariaDB** version in that was **10.1.39**. On my Ubuntu VM the MariaDB version is 10.0.38 and I suspect this is the reason for the problem however I dont want to install a newer version on my Linux system at this time. Any help would be appreciated. \r\n\r\n### Code to reproduce issue\r\n1- open MariaDB terminal and create a new Database:  `CREATE DATABASE mlflow`\r\n2- Open python terminal\r\n3- `import mlflow`\r\n4- `mlflow.set_tracking_uri(\"mysql+pymysql://root@localhost/mlflow\")`\r\n5- `mlflow.log_metric(\"dummy_metric\",12)`\r\n### `And boom I get this error!`\r\n\r\n### Error Logs\r\n`020/02/03 17:54:13 INFO mlflow.store.db.utils: Creating initial MLflow database tables...\r\nTraceback (most recent call last):\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1246, in _execute_context\r\n    cursor, statement, parameters, context\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 581, in do_execute\r\n    cursor.execute(statement, parameters)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/cursors.py\", line 170, in execute\r\n    result = self._query(query)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/cursors.py\", line 328, in _query\r\n    conn.query(q)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/connections.py\", line 517, in query\r\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/connections.py\", line 732, in _read_query_result\r\n    result.read()\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/connections.py\", line 1075, in read\r\n    first_packet = self.connection._read_packet()\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/connections.py\", line 684, in _read_packet\r\n    packet.check_error()\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/protocol.py\", line 220, in check_error\r\n    err.raise_mysql_exception(self._data)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/err.py\", line 109, in raise_mysql_exception\r\n    raise errorclass(errno, errval)\r\npymysql.err.InternalError: (1071, 'Specified key was too long; max key length is 767 bytes')\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/mlflow/tracking/fluent.py\", line 251, in log_metric\r\n    run_id = _get_or_start_run().info.run_id\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/mlflow/tracking/fluent.py\", line 506, in _get_or_start_run\r\n    return start_run()\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/mlflow/tracking/fluent.py\", line 151, in start_run\r\n    active_run_obj = MlflowClient().create_run(\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/mlflow/tracking/client.py\", line 37, in __init__\r\n    self._tracking_client = TrackingServiceClient(final_tracking_uri)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py\", line 31, in __init__\r\n    self.store = utils._get_store(self.tracking_uri)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/utils.py\", line 114, in _get_store\r\n    return _tracking_store_registry.get_store(store_uri, artifact_uri)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/registry.py\", line 37, in get_store\r\n    return builder(store_uri=store_uri, artifact_uri=artifact_uri)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/utils.py\", line 78, in _get_sqlalchemy_store\r\n    return SqlAlchemyStore(store_uri, artifact_uri)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/mlflow/store/tracking/sqlalchemy_store.py\", line 97, in __init__\r\n    mlflow.store.db.utils._initialize_tables(self.engine)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/mlflow/store/db/utils.py\", line 29, in _initialize_tables\r\n    InitialBase.metadata.create_all(engine)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 4316, in create_all\r\n    ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2049, in _run_visitor\r\n    conn._run_visitor(visitorcallable, element, **kwargs)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1618, in _run_visitor\r\n    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/sql/visitors.py\", line 138, in traverse_single\r\n    return meth(obj, **kw)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/sql/ddl.py\", line 781, in visit_metadata\r\n    _is_metadata_operation=True,\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/sql/visitors.py\", line 138, in traverse_single\r\n    return meth(obj, **kw)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/sql/ddl.py\", line 826, in visit_table\r\n    include_foreign_key_constraints,\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 982, in execute\r\n    return meth(self, multiparams, params)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/sql/ddl.py\", line 72, in _execute_on_connection\r\n    return connection._execute_ddl(self, multiparams, params)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1044, in _execute_ddl\r\n    compiled,\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1250, in _execute_context\r\n    e, statement, parameters, cursor, context\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1476, in _handle_dbapi_exception\r\n    util.raise_from_cause(sqlalchemy_exception, exc_info)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 398, in raise_from_cause\r\n    reraise(type(exception), exception, tb=exc_tb, cause=cause)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 152, in reraise\r\n    raise value.with_traceback(tb)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1246, in _execute_context\r\n    cursor, statement, parameters, context\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 581, in do_execute\r\n    cursor.execute(statement, parameters)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/cursors.py\", line 170, in execute\r\n    result = self._query(query)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/cursors.py\", line 328, in _query\r\n    conn.query(q)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/connections.py\", line 517, in query\r\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/connections.py\", line 732, in _read_query_result\r\n    result.read()\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/connections.py\", line 1075, in read\r\n    first_packet = self.connection._read_packet()\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/connections.py\", line 684, in _read_packet\r\n    packet.check_error()\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/protocol.py\", line 220, in check_error\r\n    err.raise_mysql_exception(self._data)\r\n  File \"/home/saad/miniconda3/envs/pxml/lib/python3.7/site-packages/pymysql/err.py\", line 109, in raise_mysql_exception\r\n    raise errorclass(errno, errval)\r\nsqlalchemy.exc.InternalError: (pymysql.err.InternalError) (1071, 'Specified key was too long; max key length is 767 bytes')\r\n[SQL: \r\nCREATE TABLE experiments (\r\n        experiment_id INTEGER NOT NULL AUTO_INCREMENT, \r\n        name VARCHAR(256) NOT NULL, \r\n        artifact_location VARCHAR(256), \r\n        lifecycle_stage VARCHAR(32), \r\n        CONSTRAINT experiment_pk PRIMARY KEY (experiment_id), \r\n        CONSTRAINT experiments_lifecycle_stage CHECK (lifecycle_stage IN ('active', 'deleted')), \r\n        UNIQUE (name)\r\n)\r\n\r\n]\r\n(Background on this error at: http://sqlalche.me/e/2j85)","closed_by":null,"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/2381/timeline","performed_via_github_app":null,"state_reason":null}