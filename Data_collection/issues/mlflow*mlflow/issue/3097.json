{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3097","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/3097/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/3097/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/3097/events","html_url":"https://github.com/mlflow/mlflow/issues/3097","id":656359252,"node_id":"MDU6SXNzdWU2NTYzNTkyNTI=","number":3097,"title":"[FR] Save logs to artifact store when running in Kuberentes","user":{"login":"catapulta","id":34013890,"node_id":"MDQ6VXNlcjM0MDEzODkw","avatar_url":"https://avatars.githubusercontent.com/u/34013890?v=4","gravatar_id":"","url":"https://api.github.com/users/catapulta","html_url":"https://github.com/catapulta","followers_url":"https://api.github.com/users/catapulta/followers","following_url":"https://api.github.com/users/catapulta/following{/other_user}","gists_url":"https://api.github.com/users/catapulta/gists{/gist_id}","starred_url":"https://api.github.com/users/catapulta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/catapulta/subscriptions","organizations_url":"https://api.github.com/users/catapulta/orgs","repos_url":"https://api.github.com/users/catapulta/repos","events_url":"https://api.github.com/users/catapulta/events{/privacy}","received_events_url":"https://api.github.com/users/catapulta/received_events","type":"User","site_admin":false},"labels":[{"id":955449434,"node_id":"MDU6TGFiZWw5NTU0NDk0MzQ=","url":"https://api.github.com/repos/mlflow/mlflow/labels/enhancement","name":"enhancement","color":"a2eeef","default":true,"description":"New feature or request"},{"id":2022848510,"node_id":"MDU6TGFiZWwyMDIyODQ4NTEw","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/projects","name":"area/projects","color":"48eabc","default":false,"description":"MLproject format, project running backends"},{"id":2022865338,"node_id":"MDU6TGFiZWwyMDIyODY1MzM4","url":"https://api.github.com/repos/mlflow/mlflow/labels/priority/important-longterm","name":"priority/important-longterm","color":"534cb5","default":false,"description":"Important over the long term, but may not be staffed or may need multiple releases to complete."}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-07-14T06:20:00Z","updated_at":"2020-07-20T21:19:40Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Hello. I'd love to be able to run experiments using `mlflow run --backend kubernetes` and have the container logs saved as an artifact in the artifact store. Today, I find myself having to search through pod logs through `kubectl`, which is a painstaking and highly technical task. Being able to read those logs from MLFlow UI would be of great help -- it'd help tremendously in debugging and tracking. \r\n\r\n## Willingness to contribute\r\nThe MLflow Community encourages new feature contributions. Would you or another member of your organization be willing to contribute an implementation of this feature (either as an MLflow Plugin or an enhancement to the MLflow code base)?\r\n\r\n- [x] Yes. I can contribute this feature independently.\r\n- [ ] Yes. I would be willing to contribute this feature with guidance from the MLflow community.\r\n- [ ] No. I cannot contribute this feature at this time.\r\n\r\n## Proposal Summary\r\n\r\nUpon spinning up the container in the Kubernetes pod, start capturing stderr, stdout (or log). Then, store that log as an artifact (and send it along to the MLFlow UI server). The feature would save a lot of time and issues.\r\n\r\n## Motivation\r\n- What is the use case for this feature?\r\n-- Great for better debugging and tracking of experiments. Today, I find myself having to search through pod logs through `kubectl`, which is a painstaking task. Being able to read those logs from MLFlow UI would be of great help -- it'd help tremendously in debugging and tracking.\r\n- Why is this use case valuable to support for MLflow users in general?\r\n-- It is very likely that every user of MLFlow in K8s needs to go through logs, which is usually done through `kubectl`. This is a highly technical and time consuming task which would be greatly improved with MLFlow's capabilities.\r\n- Why is this use case valuable to support for your project(s) or organization?\r\n-- A lot of Data Scientists in my organization don't have the permissions/technical abilities to check logs through `kubectl`. Having the ability to view logs within the MLFlow UI would be game-changer in using MLFlow within Kubernetes.\r\n- Why is it currently difficult to achieve this use case? (please be as specific as possible about why related MLflow features and components are insufficient)\r\n-- As far as I know, there is no capability within MLFlow to easily check logs. The most informative approach is to check the K8s pod logs by using `kubectl` commands, which is technical and requires additional permissions. Another alternative I can think of is to do heavy logging of the process -- also painful for the user. The ability to save the logs as artifacts would make the process a breeze.\r\n\r\n### What component(s), interfaces, languages, and integrations does this feature affect?\r\nComponents \r\n- [ ] `area/artifacts`: Artifact stores and artifact logging\r\n- [ ] `area/build`: Build and test infrastructure for MLflow\r\n- [ ] `area/docs`: MLflow documentation pages\r\n- [ ] `area/examples`: Example code\r\n- [ ] `area/model-registry`: Model Registry service, APIs, and the fluent client calls for\r\nModel Registry\r\n- [ ] `area/models`: MLmodel format, model serialization/deserialization, flavors\r\n- [x] `area/projects`: MLproject format, project running backends\r\n- [ ] `area/scoring`: Local serving, model deployment tools, spark UDFs\r\n- [ ] `area/tracking`: Tracking Service, tracking client APIs, autologging\r\n\r\nInterfaces\r\n- [ ] `area/uiux`: Front-end, user experience, JavaScript, plotting\r\n- [ ] `area/docker`: Docker use across MLflow's components, such as MLflow Projects and MLflow Models\r\n- [ ] `area/sqlalchemy`: Use of SQLAlchemy in the Tracking Service or Model Registry\r\n- [ ] `area/windows`: Windows support\r\n\r\nLanguages \r\n- [ ] `language/r`: R APIs and clients\r\n- [ ] `language/java`: Java APIs and clients\r\n\r\nIntegrations\r\n- [ ] `integrations/azure`: Azure and Azure ML integrations\r\n- [ ] `integrations/sagemaker`: SageMaker integrations\r\n\r\n## Details\r\n\r\nUpon spinning up the container in the Kubernetes pod, start capturing stderr, stdout (or log) of the entry point described in MLProject (or the entire container run if possible). Then, store that log as an artifact and send it along to the MLFlow UI server, under the experiment and run_id.\r\n\r\nThe option could be implemented as a flag within `mlflow run` or as an env variable.\r\n\r\nI can foresee some difficulty in runs that log more than one run_id. Perhaps save the log to all of them?\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/3097/timeline","performed_via_github_app":null,"state_reason":null}