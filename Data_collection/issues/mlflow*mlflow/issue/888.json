{"url":"https://api.github.com/repos/mlflow/mlflow/issues/888","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/888/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/888/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/888/events","html_url":"https://github.com/mlflow/mlflow/issues/888","id":408757629,"node_id":"MDU6SXNzdWU0MDg3NTc2Mjk=","number":888,"title":"Tracking UI cannot show experiment if a run contains an empty parameter value","user":{"login":"dstine","id":634688,"node_id":"MDQ6VXNlcjYzNDY4OA==","avatar_url":"https://avatars.githubusercontent.com/u/634688?v=4","gravatar_id":"","url":"https://api.github.com/users/dstine","html_url":"https://github.com/dstine","followers_url":"https://api.github.com/users/dstine/followers","following_url":"https://api.github.com/users/dstine/following{/other_user}","gists_url":"https://api.github.com/users/dstine/gists{/gist_id}","starred_url":"https://api.github.com/users/dstine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dstine/subscriptions","organizations_url":"https://api.github.com/users/dstine/orgs","repos_url":"https://api.github.com/users/dstine/repos","events_url":"https://api.github.com/users/dstine/events{/privacy}","received_events_url":"https://api.github.com/users/dstine/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-02-11T12:23:14Z","updated_at":"2019-03-12T02:13:33Z","closed_at":"2019-03-11T23:26:30Z","author_association":"NONE","active_lock_reason":null,"body":"### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in MLflow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: mlflow server ubuntu 16.04, client Win 7\r\n- **MLflow installed from (source or binary)**: binary\r\n- **MLflow version (run ``mlflow --version``)**: 0.8.2\r\n- **Python version**: mlflow server 3.5.2, client 3.5.4\r\n- **npm version (if running the dev UI):\r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nFrom my client python program, I attempt to log a parameter whose value is the empty string. (This was not intentional, but it happened.) The client eventually times out with `failed to return code 200 after 3 tries` (see traceback below). This is probably expected behavior.\r\n\r\nThe problem is that then viewing the experiment for the run is not possible. The server log shows `Param 'sys.env.CUDA_VISIBLE_DEVICES' is malformed. No data found` (see traceback below). Upon inspecting the filesystem, there is an empty file for this parameter. So there seems to be a mismatch between the client API validation and the UI validation. Only the one experiment is affected; other experiments are still viewable. Removing the empty parameter file on the server restores expected behavior.\r\n\r\n### Source code / logs\r\n\r\n*Client program*\r\nSimple invocation of tracking API:\r\n```\r\nmlflow.log_param('sys.env.CUDA_VISIBLE_DEVICES', '')\r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n...\r\n    mlflow.log_param(key, value)\r\n  File \"C:\\Users\\dstine\\.virtualenvs\\labs_nlp_topic_model-C2Cdqh84\\lib\\site-packages\\mlflow\\tracking\\fluent.py\", line 179, in log_param\r\n    MlflowClient().log_param(run_id, key, value)\r\n  File \"C:\\Users\\dstine\\.virtualenvs\\labs_nlp_topic_model-C2Cdqh84\\lib\\site-packages\\mlflow\\tracking\\client.py\", line 144, in log_param\r\n    self.store.log_param(run_id, param)\r\n  File \"C:\\Users\\dstine\\.virtualenvs\\labs_nlp_topic_model-C2Cdqh84\\lib\\site-packages\\mlflow\\store\\rest_store.py\", line 173, in log_param\r\n    self._call_endpoint(LogParam, req_body)\r\n  File \"C:\\Users\\dstine\\.virtualenvs\\labs_nlp_topic_model-C2Cdqh84\\lib\\site-packages\\mlflow\\store\\rest_store.py\", line 58, in _call_endpoint\r\n    host_creds=host_creds, endpoint=endpoint, method=method, json=json_body)\r\n  File \"C:\\Users\\dstine\\.virtualenvs\\labs_nlp_topic_model-C2Cdqh84\\lib\\site-packages\\mlflow\\utils\\rest_utils.py\", line 73, in http_request_safe\r\n    response = http_request(host_creds=host_creds, endpoint=endpoint, **kwargs)\r\n  File \"C:\\Users\\dstine\\.virtualenvs\\labs_nlp_topic_model-C2Cdqh84\\lib\\site-packages\\mlflow\\utils\\rest_utils.py\", line 58, in http_request\r\n    (url, retries))\r\nmlflow.exceptions.MlflowException: API request to http://10.53.36.24:5000/api/2.0/preview/mlflow/runs/log-parameter failed to return code 200 after 3 tries\r\nError in atexit._run_exitfuncs:\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\dstine\\.virtualenvs\\labs_nlp_topic_model-C2Cdqh84\\lib\\site-packages\\mlflow\\tracking\\fluent.py\", line 157, in end_run\r\n    MlflowClient().set_terminated(_active_run_stack[-1].info.run_uuid, status)\r\n  File \"C:\\Users\\dstine\\.virtualenvs\\labs_nlp_topic_model-C2Cdqh84\\lib\\site-packages\\mlflow\\tracking\\client.py\", line 213, in set_terminated\r\n    end_time=end_time)\r\n  File \"C:\\Users\\dstine\\.virtualenvs\\labs_nlp_topic_model-C2Cdqh84\\lib\\site-packages\\mlflow\\store\\rest_store.py\", line 130, in update_run_info\r\n    response_proto = self._call_endpoint(UpdateRun, req_body)\r\n  File \"C:\\Users\\dstine\\.virtualenvs\\labs_nlp_topic_model-C2Cdqh84\\lib\\site-packages\\mlflow\\store\\rest_store.py\", line 58, in _call_endpoint\r\n    host_creds=host_creds, endpoint=endpoint, method=method, json=json_body)\r\n  File \"C:\\Users\\dstine\\.virtualenvs\\labs_nlp_topic_model-C2Cdqh84\\lib\\site-packages\\mlflow\\utils\\rest_utils.py\", line 73, in http_request_safe\r\n    response = http_request(host_creds=host_creds, endpoint=endpoint, **kwargs)\r\n  File \"C:\\Users\\dstine\\.virtualenvs\\labs_nlp_topic_model-C2Cdqh84\\lib\\site-packages\\mlflow\\utils\\rest_utils.py\", line 58, in http_request\r\n    (url, retries))\r\nmlflow.exceptions.MlflowException: API request to http://10.53.36.24:5000/api/2.0/preview/mlflow/runs/update failed to return code 200 after 3 tries\r\n```\r\n\r\n*Server log*\r\n```\r\n[2019-02-10 05:07:24,010] ERROR in app: Exception on /ajax-api/2.0/preview/mlflow/runs/search [POST]\r\nTraceback (most recent call last):\r\n  File \"/home/ubuntu/.local/share/virtualenvs/mlflow-exp-KEZxtoN-/lib/python3.5/site-packages/flask/app.py\", line 2292, in wsgi_app\r\n    response = self.full_dispatch_request()\r\n  File \"/home/ubuntu/.local/share/virtualenvs/mlflow-exp-KEZxtoN-/lib/python3.5/site-packages/flask/app.py\", line 1815, in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\n  File \"/home/ubuntu/.local/share/virtualenvs/mlflow-exp-KEZxtoN-/lib/python3.5/site-packages/flask/app.py\", line 1718, in handle_user_exception\r\n    reraise(exc_type, exc_value, tb)\r\n  File \"/home/ubuntu/.local/share/virtualenvs/mlflow-exp-KEZxtoN-/lib/python3.5/site-packages/flask/_compat.py\", line 35, in reraise\r\n    raise value\r\n  File \"/home/ubuntu/.local/share/virtualenvs/mlflow-exp-KEZxtoN-/lib/python3.5/site-packages/flask/app.py\", line 1813, in full_dispatch_request\r\n    rv = self.dispatch_request()\r\n  File \"/home/ubuntu/.local/share/virtualenvs/mlflow-exp-KEZxtoN-/lib/python3.5/site-packages/flask/app.py\", line 1799, in dispatch_request\r\n    return self.view_functions[rule.endpoint](**req.view_args)\r\n  File \"/home/ubuntu/.local/share/virtualenvs/mlflow-exp-KEZxtoN-/lib/python3.5/site-packages/mlflow/server/handlers.py\", line 68, in wrapper\r\n    return func(*args, **kwargs)\r\n  File \"/home/ubuntu/.local/share/virtualenvs/mlflow-exp-KEZxtoN-/lib/python3.5/site-packages/mlflow/server/handlers.py\", line 272, in _search_runs\r\n    run_view_type)\r\n  File \"/home/ubuntu/.local/share/virtualenvs/mlflow-exp-KEZxtoN-/lib/python3.5/site-packages/mlflow/store/file_store.py\", line 519, in search_runs\r\n    runs.extend(self.get_run(r.run_uuid) for r in run_infos)\r\n  File \"/home/ubuntu/.local/share/virtualenvs/mlflow-exp-KEZxtoN-/lib/python3.5/site-packages/mlflow/store/file_store.py\", line 519, in <genexpr>\r\n    runs.extend(self.get_run(r.run_uuid) for r in run_infos)\r\n  File \"/home/ubuntu/.local/share/virtualenvs/mlflow-exp-KEZxtoN-/lib/python3.5/site-packages/mlflow/store/file_store.py\", line 355, in get_run\r\n    params = self.get_all_params(run_uuid)\r\n  File \"/home/ubuntu/.local/share/virtualenvs/mlflow-exp-KEZxtoN-/lib/python3.5/site-packages/mlflow/store/file_store.py\", line 474, in get_all_params\r\n    params.append(self._get_param_from_file(parent_path, param_file))\r\n  File \"/home/ubuntu/.local/share/virtualenvs/mlflow-exp-KEZxtoN-/lib/python3.5/site-packages/mlflow/store/file_store.py\", line 449, in _get_param_from_file\r\n    raise Exception(\"Param '%s' is malformed. No data found.\" % param_name)\r\nException: Param 'sys.env.CUDA_VISIBLE_DEVICES' is malformed. No data found.\r\n```","closed_by":{"login":"mateiz","id":228859,"node_id":"MDQ6VXNlcjIyODg1OQ==","avatar_url":"https://avatars.githubusercontent.com/u/228859?v=4","gravatar_id":"","url":"https://api.github.com/users/mateiz","html_url":"https://github.com/mateiz","followers_url":"https://api.github.com/users/mateiz/followers","following_url":"https://api.github.com/users/mateiz/following{/other_user}","gists_url":"https://api.github.com/users/mateiz/gists{/gist_id}","starred_url":"https://api.github.com/users/mateiz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mateiz/subscriptions","organizations_url":"https://api.github.com/users/mateiz/orgs","repos_url":"https://api.github.com/users/mateiz/repos","events_url":"https://api.github.com/users/mateiz/events{/privacy}","received_events_url":"https://api.github.com/users/mateiz/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/888/timeline","performed_via_github_app":null,"state_reason":"completed"}