{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1006","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/1006/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/1006/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/1006/events","html_url":"https://github.com/mlflow/mlflow/issues/1006","id":421882201,"node_id":"MDU6SXNzdWU0MjE4ODIyMDE=","number":1006,"title":"UserWarning and YAMLLoadWarning messages appear when running example code in mlflow Docker Container","user":{"login":"jimthompson5802","id":1425269,"node_id":"MDQ6VXNlcjE0MjUyNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1425269?v=4","gravatar_id":"","url":"https://api.github.com/users/jimthompson5802","html_url":"https://github.com/jimthompson5802","followers_url":"https://api.github.com/users/jimthompson5802/followers","following_url":"https://api.github.com/users/jimthompson5802/following{/other_user}","gists_url":"https://api.github.com/users/jimthompson5802/gists{/gist_id}","starred_url":"https://api.github.com/users/jimthompson5802/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimthompson5802/subscriptions","organizations_url":"https://api.github.com/users/jimthompson5802/orgs","repos_url":"https://api.github.com/users/jimthompson5802/repos","events_url":"https://api.github.com/users/jimthompson5802/events{/privacy}","received_events_url":"https://api.github.com/users/jimthompson5802/received_events","type":"User","site_admin":false},"labels":[{"id":1554650079,"node_id":"MDU6TGFiZWwxNTU0NjUwMDc5","url":"https://api.github.com/repos/mlflow/mlflow/labels/stale","name":"stale","color":"828282","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-03-17T04:55:04Z","updated_at":"2019-11-12T22:50:08Z","closed_at":"2019-11-12T22:50:08Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in MLflow)**: examples/sklearn_elasticnet_wine/\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: MacOS 10.14.3 \r\n- **MLflow installed from (source or binary)**: Docker Image built from mlflow master sha1 c172fcbd\r\n- **MLflow version (run ``mlflow --version``)**: mlflow, version 0.8.3.dev0\r\n- **Python version**: Python 2.7.15 :: Anaconda, Inc.\r\n- **npm version (if running the dev UI): N/A\r\n- **Exact command to reproduce**:\r\n```\r\ncd examples/sklearn_elasticnet_wine\r\nmlflow run . -P alpha=0.5\r\n```\r\n\r\n### Describe the problem\r\nWarning messages now appear when parsing yaml files.  \r\n```\r\n/app/mlflow/tracking/context.py:181: UserWarning: Failure attempting to register context provider \"unused\": 'module' object has no attribute 'PluginRunContextProvider'\r\n  _run_context_provider_registry.register_entrypoints()\r\n/app/mlflow/utils/environment.py:26: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.\r\n  env = yaml.load(_conda_header)\r\n```\r\n\r\nThe `mlflow run` itself completes successfully.\r\n\r\n### Source code / logs\r\n\r\n```\r\n(base) root@91486e3414f1:/app/examples/sklearn_elasticnet_wine# mlflow run . -P alpha=0.5\r\n/app/mlflow/tracking/context.py:181: UserWarning: Failure attempting to register context provider \"unused\": 'module' object has no attribute 'PluginRunContextProvider'\r\n  _run_context_provider_registry.register_entrypoints()\r\n/app/mlflow/utils/environment.py:26: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.\r\n  env = yaml.load(_conda_header)\r\n2019/03/17 04:35:12 INFO mlflow.projects: === Created directory /tmp/tmpJWHu8P for downloading remote URIs passed to arguments of type 'path' ===\r\n2019/03/17 04:35:12 INFO mlflow.projects: === Running command 'source activate mlflow-b93852916f9be8ee2359db52b5dfab5589743459 && python train.py 0.5 0.1' in run with ID '0eb8582e9b7748fcbcd14f9668db7db7' ===\r\n/opt/conda/envs/mlflow-b93852916f9be8ee2359db52b5dfab5589743459/lib/python3.6/site-packages/mlflow/utils/environment.py:26: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.\r\n  env = yaml.load(_conda_header)\r\nElasticnet model (alpha=0.500000, l1_ratio=0.100000):\r\n  RMSE: 0.7947931019036529\r\n  MAE: 0.6189130834228138\r\n  R2: 0.18411668718221819\r\n2019/03/17 04:35:13 INFO mlflow.projects: === Run (ID '0eb8582e9b7748fcbcd14f9668db7db7') succeeded ===\r\n```\r\n\r\n**Root Cause Analysis**\r\nIt appears the `PyYAML` package was updated on pypi.org a few days ago. When the Docker image is built, the current version (5.1) from pypi.org is pulled.  \r\n```\r\nmlflow --version\r\n/app/mlflow/tracking/context.py:181: UserWarning: Failure attempting to register context provider \"unused\": 'module' object has no attribute 'PluginRunContextProvider'\r\n  _run_context_provider_registry.register_entrypoints()\r\n/app/mlflow/utils/environment.py:26: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.\r\n  env = yaml.load(_conda_header)\r\nmlflow, version 0.8.3.dev0\r\n(base) root@91486e3414f1:/app/examples/sklearn_elasticnet_wine# python\r\nPython 2.7.15 |Anaconda, Inc.| (default, Dec 14 2018, 19:04:19)\r\n[GCC 7.3.0] on linux2\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import yaml\r\n>>> yaml.__version__\r\n'5.1'\r\n>>>\r\n```\r\nThis [page](https://msg.pyyaml.org/load) describes the condition for the warning messages and corrective actions to take.\r\n\r\nPrior to the recent update, the version of PyYAML installed during Docker build was 3.13.\r\n```\r\n(base) root@a059a95f3dbe:/# mlflow --version\r\nmlflow, version 0.8.2\r\n(base) root@a059a95f3dbe:/# python\r\nPython 3.7.2 (default, Dec 29 2018, 06:19:36)\r\n[GCC 7.3.0] :: Anaconda, Inc. on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import yaml\r\n>>> yaml.__version__\r\n'3.13'\r\n>>>\r\n```\r\n\r\nThe short-term fix for this might be to pin PyYAML==3.13 in the test-requirements.txt file and/or setup.py.  The long-term fix is to revise invoking the yaml api to parse the conda.yaml files.  \r\n\r\nI'm willing to help resolve this issue.  I just need guidance on the approach I should take.\r\n\r\nUpdated: 2019-03-17 with explanation for user warning.","closed_by":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1006/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/1006/timeline","performed_via_github_app":null,"state_reason":"completed"}