{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3362","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/3362/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/3362/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/3362/events","html_url":"https://github.com/mlflow/mlflow/issues/3362","id":688565598,"node_id":"MDU6SXNzdWU2ODg1NjU1OTg=","number":3362,"title":"Exception using infer_signature from mlflow.models.signature","user":{"login":"pycaret","id":58118658,"node_id":"MDEyOk9yZ2FuaXphdGlvbjU4MTE4NjU4","avatar_url":"https://avatars.githubusercontent.com/u/58118658?v=4","gravatar_id":"","url":"https://api.github.com/users/pycaret","html_url":"https://github.com/pycaret","followers_url":"https://api.github.com/users/pycaret/followers","following_url":"https://api.github.com/users/pycaret/following{/other_user}","gists_url":"https://api.github.com/users/pycaret/gists{/gist_id}","starred_url":"https://api.github.com/users/pycaret/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pycaret/subscriptions","organizations_url":"https://api.github.com/users/pycaret/orgs","repos_url":"https://api.github.com/users/pycaret/repos","events_url":"https://api.github.com/users/pycaret/events{/privacy}","received_events_url":"https://api.github.com/users/pycaret/received_events","type":"Organization","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":2022848043,"node_id":"MDU6TGFiZWwyMDIyODQ4MDQz","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/models","name":"area/models","color":"48eabc","default":false,"description":"MLmodel format, model serialization/deserialization, flavors"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-08-29T16:43:34Z","updated_at":"2022-02-16T08:16:11Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"## System Details\r\npython_version: 3.6.10\r\npython_build: ('default', 'May  7 2020 19:46:08')\r\nmachine: AMD64\r\nplatform: Windows-10-10.0.18362-SP0\r\nmlflow==1.10.0\r\n\r\n## Issue\r\nWhen using `infer_signature` from `mlflow.models.signature` facing this error (see below traceback). Here is how you can reproduce the error.\r\n\r\n```\r\nimport pandas as pd\r\ndata = pd.read_csv('train.csv') \r\nfrom mlflow.models.signature import infer_signature\r\ninfer_signature(data)\r\n```\r\nDataset: https://www.kaggle.com/c/titanic/data?select=train.csv\r\n\r\n**The exception is only thrown when there are `NULL` values in the dataset. Should it really matter for `infer_signature`? Can this function be edited to tolerate missing values?**\r\n\r\n**Traceback**\r\n----> 1 infer_signature(data)\r\n\r\n~\\Anaconda3\\envs\\pycaret21\\lib\\site-packages\\mlflow\\models\\signature.py in infer_signature(model_input, model_output)\r\n    109     :return: ModelSignature\r\n    110     \"\"\"\r\n--> 111     inputs = _infer_schema(model_input)\r\n    112     outputs = _infer_schema(model_output) if model_output is not None else None\r\n    113     return ModelSignature(inputs, outputs)\r\n\r\n~\\Anaconda3\\envs\\pycaret21\\lib\\site-packages\\mlflow\\types\\utils.py in _infer_schema(data)\r\n     57     elif isinstance(data, pd.DataFrame):\r\n     58         return Schema([ColSpec(type=_infer_numpy_array(data[col].values), name=col)\r\n---> 59                        for col in data.columns])\r\n     60     elif isinstance(data, np.ndarray):\r\n     61         if len(data.shape) > 2:\r\n\r\n~\\Anaconda3\\envs\\pycaret21\\lib\\site-packages\\mlflow\\types\\utils.py in <listcomp>(.0)\r\n     57     elif isinstance(data, pd.DataFrame):\r\n     58         return Schema([ColSpec(type=_infer_numpy_array(data[col].values), name=col)\r\n---> 59                        for col in data.columns])\r\n     60     elif isinstance(data, np.ndarray):\r\n     61         if len(data.shape) > 2:\r\n\r\n~\\Anaconda3\\envs\\pycaret21\\lib\\site-packages\\mlflow\\types\\utils.py in _infer_numpy_array(col)\r\n    143             return DataType.double\r\n    144         else:\r\n--> 145             raise MlflowException(\"Unable to map 'np.object' type to MLflow DataType. np.object can\"\r\n    146                                   \"be mapped iff all values have identical data type which is one \"\r\n    147                                   \"of (string, (bytes or byterray),  int, float).\")\r\n\r\nMlflowException: Unable to map 'np.object' type to MLflow DataType. np.object canbe mapped iff all values have identical data type which is one of (string, (bytes or byterray),  int, float).","closed_by":null,"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3362/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/3362/timeline","performed_via_github_app":null,"state_reason":null}