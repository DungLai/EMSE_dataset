{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1545","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/1545/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/1545/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/1545/events","html_url":"https://github.com/mlflow/mlflow/issues/1545","id":463742230,"node_id":"MDU6SXNzdWU0NjM3NDIyMzA=","number":1545,"title":"when i set default-artifact-root , exceptions happend like this","user":{"login":"finelycheng","id":6984066,"node_id":"MDQ6VXNlcjY5ODQwNjY=","avatar_url":"https://avatars.githubusercontent.com/u/6984066?v=4","gravatar_id":"","url":"https://api.github.com/users/finelycheng","html_url":"https://github.com/finelycheng","followers_url":"https://api.github.com/users/finelycheng/followers","following_url":"https://api.github.com/users/finelycheng/following{/other_user}","gists_url":"https://api.github.com/users/finelycheng/gists{/gist_id}","starred_url":"https://api.github.com/users/finelycheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/finelycheng/subscriptions","organizations_url":"https://api.github.com/users/finelycheng/orgs","repos_url":"https://api.github.com/users/finelycheng/repos","events_url":"https://api.github.com/users/finelycheng/events{/privacy}","received_events_url":"https://api.github.com/users/finelycheng/received_events","type":"User","site_admin":false},"labels":[{"id":1554650079,"node_id":"MDU6TGFiZWwxNTU0NjUwMDc5","url":"https://api.github.com/repos/mlflow/mlflow/labels/stale","name":"stale","color":"828282","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-07-03T13:05:56Z","updated_at":"2019-11-12T19:49:51Z","closed_at":"2019-11-12T19:49:50Z","author_association":"NONE","active_lock_reason":null,"body":"### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in MLflow)**:\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\n- **MLflow installed from (source or binary)**:  \r\n- **MLflow version (run ``mlflow --version``)**: 1.0\r\n- **Python version**:  3.6\r\n- **npm version (if running the dev UI):\r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in MLflow or a feature request.\r\ni started the server like this:\r\nmlflow server  --backend-store-uri \"/home/experiment_data/\"  -h 0.0.0.0 -p 5000  --default-\r\nartifact-root \"hdfs://finely:9000\"\r\nwhen i run the example with \r\n root@finely:/home/finely/PycharmProjects/mlflow/examples# python ./sklearn_elasticnet_wine/train.py \r\n\r\nan exception happened \r\n\r\n2019-07-03 21:05:38,894 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\r\nhdfsExists: invokeMethod((Lorg/apache/hadoop/fs/Path;)Z) error:\r\nClassCastException: org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$GetFileInfoRequestProto cannot be cast to com.google.protobuf.Messagejava.lang.ClassCastException: org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$GetFileInfoRequestProto cannot be cast to com.google.protobuf.Message\r\n        at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:225)\r\n        at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:116)\r\n        at com.sun.proxy.$Proxy9.getFileInfo(Unknown Source)\r\n        at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.getFileInfo(ClientNamenodeProtocolTranslatorPB.java:900)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:422)\r\n        at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeMethod(RetryInvocationHandler.java:165)\r\n        at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invoke(RetryInvocationHandler.java:157)\r\n        at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeOnce(RetryInvocationHandler.java:95)\r\n        at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:359)\r\n        at com.sun.proxy.$Proxy10.getFileInfo(Unknown Source)\r\n        at org.apache.hadoop.hdfs.DFSClient.getFileInfo(DFSClient.java:1660)\r\n        at org.apache.hadoop.hdfs.DistributedFileSystem$29.doCall(DistributedFileSystem.java:1583)\r\n        at org.apache.hadoop.hdfs.DistributedFileSystem$29.doCall(DistributedFileSystem.java:1580)\r\n        at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)\r\n        at org.apache.hadoop.hdfs.DistributedFileSystem.getFileStatus(DistributedFileSystem.java:1595)\r\n        at org.apache.hadoop.fs.FileSystem.exists(FileSystem.java:1683)\r\nhdfsCreateDirectory(/0/6fe34c6d6753471ebbcbfb3e86f64c2b/artifacts/wine): FileSystem#mkdirs error:\r\nIllegalStateException: java.lang.IllegalStateException\r\n        at com.google.common.base.Preconditions.checkState(Preconditions.java:129)\r\n        at org.apache.hadoop.ipc.Client.setCallIdAndRetryCount(Client.java:118)\r\n        at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeMethod(RetryInvocationHandler.java:162)\r\n        at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invoke(RetryInvocationHandler.java:157)\r\n        at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeOnce(RetryInvocationHandler.java:95)\r\n        at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:359)\r\n        at com.sun.proxy.$Proxy10.mkdirs(Unknown Source)\r\n        at org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:2419)\r\n        at org.apache.hadoop.hdfs.DFSClient.mkdirs(DFSClient.java:2395)\r\n        at org.apache.hadoop.hdfs.DistributedFileSystem$27.doCall(DistributedFileSystem.java:1325)\r\n        at org.apache.hadoop.hdfs.DistributedFileSystem$27.doCall(DistributedFileSystem.java:1322)\r\n        at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)\r\n        at org.apache.hadoop.hdfs.DistributedFileSystem.mkdirsInternal(DistributedFileSystem.java:1339)\r\n        at org.apache.hadoop.hdfs.DistributedFileSystem.mkdirs(DistributedFileSystem.java:1314)\r\n        at org.apache.hadoop.fs.FileSystem.mkdirs(FileSystem.java:2275)\r\nTraceback (most recent call last):\r\n  File \"./sklearn_elasticnet_wine/train.py\", line 71, in <module>\r\n    mlflow.sklearn.log_model(lr, \"wine\")\r\n  File \"/opt/anaconda3/envs/gluon/lib/python3.6/site-packages/mlflow/sklearn.py\", line 195, in log_model\r\n    serialization_format=serialization_format)\r\n  File \"/opt/anaconda3/envs/gluon/lib/python3.6/site-packages/mlflow/models/__init__.py\", line 78, in log\r\n    mlflow.tracking.fluent.log_artifacts(local_path, artifact_path)\r\n  File \"/opt/anaconda3/envs/gluon/lib/python3.6/site-packages/mlflow/tracking/fluent.py\", line 255, in log_artifacts\r\n    MlflowClient().log_artifacts(run_id, local_dir, artifact_path)\r\n  File \"/opt/anaconda3/envs/gluon/lib/python3.6/site-packages/mlflow/tracking/client.py\", line 221, in log_artifacts\r\n    artifact_repo.log_artifacts(local_dir, artifact_path)\r\n  File \"/opt/anaconda3/envs/gluon/lib/python3.6/site-packages/mlflow/store/hdfs_artifact_repo.py\", line 52, in log_artifacts\r\n    hdfs.mkdir(hdfs_base_path)\r\n  File \"/opt/anaconda3/envs/gluon/lib/python3.6/site-packages/pyarrow/hdfs.py\", line 77, in mkdir\r\n    return super(HadoopFileSystem, self).mkdir(path)\r\n  File \"pyarrow/io-hdfs.pxi\", line 363, in pyarrow.lib.HadoopFileSystem.mkdir\r\n  File \"pyarrow/error.pxi\", line 83, in pyarrow.lib.check_status\r\npyarrow.lib.ArrowIOError: HDFS create directory failed, errno: 255 (Unknown error 255) Please check that you are connecting to the correct HDFS RPC port\r\n\r\n\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks,\r\nplease include the full traceback. Large logs and files should be attached.\r\nTry to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n","closed_by":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/1545/timeline","performed_via_github_app":null,"state_reason":"completed"}