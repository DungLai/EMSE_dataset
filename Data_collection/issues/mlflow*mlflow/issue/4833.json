{"url":"https://api.github.com/repos/mlflow/mlflow/issues/4833","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/4833/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/4833/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/4833/events","html_url":"https://github.com/mlflow/mlflow/issues/4833","id":1001447679,"node_id":"I_kwDOCB5Jx847sOD_","number":4833,"title":"[BUG] examples/docker no longer runs","user":{"login":"ksaur","id":1703543,"node_id":"MDQ6VXNlcjE3MDM1NDM=","avatar_url":"https://avatars.githubusercontent.com/u/1703543?v=4","gravatar_id":"","url":"https://api.github.com/users/ksaur","html_url":"https://github.com/ksaur","followers_url":"https://api.github.com/users/ksaur/followers","following_url":"https://api.github.com/users/ksaur/following{/other_user}","gists_url":"https://api.github.com/users/ksaur/gists{/gist_id}","starred_url":"https://api.github.com/users/ksaur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ksaur/subscriptions","organizations_url":"https://api.github.com/users/ksaur/orgs","repos_url":"https://api.github.com/users/ksaur/repos","events_url":"https://api.github.com/users/ksaur/events{/privacy}","received_events_url":"https://api.github.com/users/ksaur/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":2022847277,"node_id":"MDU6TGFiZWwyMDIyODQ3Mjc3","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/examples","name":"area/examples","color":"48eabc","default":false,"description":"Example code"},{"id":2022851725,"node_id":"MDU6TGFiZWwyMDIyODUxNzI1","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/docker","name":"area/docker","color":"ede978","default":false,"description":"Docker use anywhere, such as MLprojects and MLmodels"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-09-20T21:35:50Z","updated_at":"2021-09-21T21:31:19Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Thank you for submitting an issue. Please refer to our [issue policy](https://www.github.com/mlflow/mlflow/blob/master/ISSUE_POLICY.md) for additional information about bug reports. For help with debugging your code, please refer to [Stack Overflow](https://stackoverflow.com/questions/tagged/mlflow).\r\n\r\n**Please fill in this bug report template to ensure a timely and thorough response.**\r\n\r\n### Willingness to contribute\r\nThe MLflow Community encourages bug fix contributions. Would you or another member of your organization be willing to contribute a fix for this bug to the MLflow code base?\r\n\r\n- [ X] Yes. I can contribute a fix for this bug independently.\r\n\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in MLflow)**: no\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: linux\r\n- **MLflow installed from (source or binary)**: source\r\n- **MLflow version (run ``mlflow --version``)**:   1.19.0\r\n- **Python version**: 3.8\r\n- **npm version, if running the dev UI**:\r\n- **Exact command to reproduce**:\r\n\r\n```\r\ndocker build -t mlflow-docker-example -f Dockerfile .\r\nmlflow run examples/docker -P alpha=0.5\r\n```\r\n\r\n### Describe the problem\r\n\r\nThe example in `examples/docker` has become out of date and no longer runs. The base image (`miniconda:4.5.4`) in the dockerfile is pinned to Python 2.7, and several of the other python packages are also broken.\r\n\r\n### Code to reproduce issue\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n```\r\n$ docker build -t mlflow-docker-example -f Dockerfile .\r\nSending build context to Docker daemon  278.5kB\r\nStep 1/2 : FROM continuumio/miniconda:4.5.4\r\n4.5.4: Pulling from continuumio/miniconda\r\ncc1a78bfd46b: Pull complete\r\n420ea9ce27d9: Pull complete\r\n1b219c050547: Pull complete\r\n1c177edca126: Pull complete\r\nDigest: sha256:19d3eedab8b6301a0e1819476cfc50d53399881612183cf65208d7d43db99cd9\r\nStatus: Downloaded newer image for continuumio/miniconda:4.5.4\r\n ---> 16e4fbac86ce\r\n...\r\nRemoving intermediate container 977134a62fa9\r\n ---> 683df65a5751\r\nSuccessfully built 683df65a5751\r\nSuccessfully tagged mlflow-docker-example:latest\r\n\r\n$ mlflow run examples/docker -P alpha=0.5\r\n2021/09/20 21:30:59 INFO mlflow.projects.docker: === Building docker image docker-example:94891da ===\r\n2021/09/20 21:31:02 INFO mlflow.projects.utils: === Created directory /tmp/tmpnk6qb3_7 for downloading remote URIs passed to arguments of type 'path' ===\r\n2021/09/20 21:31:02 INFO mlflow.projects.backend.local: === Running command 'docker run --rm -v /home/osdi-eval/mlflow/mlruns:/mlflow/tmp/mlruns -v /home/osdi-eval/mlflow/mlruns/0/1db9353955c74803bbe8f9f2245070b3/artifacts:/home/osdi-eval/mlflow/mlruns/0/1db9353955c74803bbe8f9f2245070b3/artifacts -e MLFLOW_RUN_ID=1db9353955c74803bbe8f9f2245070b3 -e MLFLOW_TRACKING_URI=file:///mlflow/tmp/mlruns -e MLFLOW_EXPERIMENT_ID=0 docker-example:94891da python train.py --alpha 0.5 --l1-ratio 0.1' in run with ID '1db9353955c74803bbe8f9f2245070b3' ===\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 16, in <module>\r\n    import mlflow\r\n  File \"/opt/conda/lib/python2.7/site-packages/mlflow/__init__.py\", line 31, in <module>\r\n    import mlflow.tracking._model_registry.fluent\r\n  File \"/opt/conda/lib/python2.7/site-packages/mlflow/tracking/__init__.py\", line 8, in <module>\r\n    from mlflow.tracking.client import MlflowClient\r\n  File \"/opt/conda/lib/python2.7/site-packages/mlflow/tracking/client.py\", line 8, in <module>\r\n    from mlflow.entities import ViewType\r\n  File \"/opt/conda/lib/python2.7/site-packages/mlflow/entities/__init__.py\", line 6, in <module>\r\n    from mlflow.entities.experiment import Experiment\r\n  File \"/opt/conda/lib/python2.7/site-packages/mlflow/entities/experiment.py\", line 2, in <module>\r\n    from mlflow.entities.experiment_tag import ExperimentTag\r\n  File \"/opt/conda/lib/python2.7/site-packages/mlflow/entities/experiment_tag.py\", line 2, in <module>\r\n    from mlflow.protos.service_pb2 import ExperimentTag as ProtoExperimentTag\r\n  File \"/opt/conda/lib/python2.7/site-packages/mlflow/protos/service_pb2.py\", line 7, in <module>\r\n    from google.protobuf import descriptor as _descriptor\r\n  File \"/opt/conda/lib/python2.7/site-packages/google/protobuf/descriptor.py\", line 113\r\n    class DescriptorBase(metaclass=DescriptorMetaclass):\r\n                                  ^\r\nSyntaxError: invalid syntax\r\n2021/09/20 21:31:03 ERROR mlflow.cli: === Run (ID '1db9353955c74803bbe8f9f2245070b3') failed ===\r\n```\r\n\r\n### Other info / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\n\r\n### What component(s), interfaces, languages, and integrations does this bug affect?\r\nComponents \r\n- [ X ] `area/examples`: Example code\r\n\r\nInterface \r\n\r\n- [ X] `area/docker`: Docker use across MLflow's components, such as MLflow Projects and MLflow Models\r\n\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/4833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/4833/timeline","performed_via_github_app":null,"state_reason":null}