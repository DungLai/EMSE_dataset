{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1867","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/1867/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/1867/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/1867/events","html_url":"https://github.com/mlflow/mlflow/issues/1867","id":496650463,"node_id":"MDU6SXNzdWU0OTY2NTA0NjM=","number":1867,"title":"[FR] When using HTTPS tracking server, keep connection alive to reduce latency when submitting many metrics","user":{"login":"iver56","id":1470603,"node_id":"MDQ6VXNlcjE0NzA2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/1470603?v=4","gravatar_id":"","url":"https://api.github.com/users/iver56","html_url":"https://github.com/iver56","followers_url":"https://api.github.com/users/iver56/followers","following_url":"https://api.github.com/users/iver56/following{/other_user}","gists_url":"https://api.github.com/users/iver56/gists{/gist_id}","starred_url":"https://api.github.com/users/iver56/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iver56/subscriptions","organizations_url":"https://api.github.com/users/iver56/orgs","repos_url":"https://api.github.com/users/iver56/repos","events_url":"https://api.github.com/users/iver56/events{/privacy}","received_events_url":"https://api.github.com/users/iver56/received_events","type":"User","site_admin":false},"labels":[{"id":955449434,"node_id":"MDU6TGFiZWw5NTU0NDk0MzQ=","url":"https://api.github.com/repos/mlflow/mlflow/labels/enhancement","name":"enhancement","color":"a2eeef","default":true,"description":"New feature or request"},{"id":2022849295,"node_id":"MDU6TGFiZWwyMDIyODQ5Mjk1","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/tracking","name":"area/tracking","color":"48eabc","default":false,"description":"Tracking service, tracking client APIs, autologging"},{"id":2022866842,"node_id":"MDU6TGFiZWwyMDIyODY2ODQy","url":"https://api.github.com/repos/mlflow/mlflow/labels/priority/awaiting-more-evidence","name":"priority/awaiting-more-evidence","color":"534cb5","default":false,"description":"Lowest priority. Possibly useful, but not yet enough support to actually get it done."}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-09-21T12:23:52Z","updated_at":"2020-07-08T21:58:33Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"## Describe the proposal\r\n\r\nWhen I log 50 metrics (one for each epoch in 50 epochs) using MLflow's experimental keras autolog, the time it takes to perform each request quickly adds up. It takes around 14 seconds in total my case, when communicating with an MLflow tracking server (hosted on [MFlux.ai](https://www.mflux.ai)) over HTTPS. The main reason for the slowness is that for each log_metric, a full 3-way handshake is currently performed, and this takes time. The following article explains why: https://blog.insightdatascience.com/learning-about-the-http-connection-keep-alive-header-7ebe0efa209d\r\n\r\nWhat I would do is initialize an instance of requests's `Session` class when an mlflow run starts. This instance is used to keep the HTTP connection with the MLflow server alive.\r\n\r\nExample with session, keeping the connection alive (fast):\r\n\r\n```\r\ns = requests.Session()\r\ns.post(\"https://example.com/path/to/endpoint\")\r\ns.post(\"https://example.com/path/to/endpoint\")\r\n```\r\n\r\nExample without session (slow):\r\n\r\n```\r\nrequests.post(\"https://example.com/path/to/endpoint\")\r\nrequests.post(\"https://example.com/path/to/endpoint\")\r\n```\r\n\r\n### Motivation\r\n\r\nThe time spent waiting for metrics to be submitted to the server can be reduced by around 70%. Wouldn't it be nice to wait only 4 seconds instead of 14?\r\n\r\n### Proposed Changes\r\n\r\nNo user-facing API changes. Only internal changes","closed_by":null,"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/1867/timeline","performed_via_github_app":null,"state_reason":null}