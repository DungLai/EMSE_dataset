{"url":"https://api.github.com/repos/mlflow/mlflow/issues/7367","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/7367/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/7367/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/7367/events","html_url":"https://github.com/mlflow/mlflow/issues/7367","id":1456545729,"node_id":"I_kwDOCB5Jx85W0R_B","number":7367,"title":"[SETUP-BUG] - MLFlow / Google Colab compatibility issues.","user":{"login":"ramsey-superpedestrian","id":61248250,"node_id":"MDQ6VXNlcjYxMjQ4MjUw","avatar_url":"https://avatars.githubusercontent.com/u/61248250?v=4","gravatar_id":"","url":"https://api.github.com/users/ramsey-superpedestrian","html_url":"https://github.com/ramsey-superpedestrian","followers_url":"https://api.github.com/users/ramsey-superpedestrian/followers","following_url":"https://api.github.com/users/ramsey-superpedestrian/following{/other_user}","gists_url":"https://api.github.com/users/ramsey-superpedestrian/gists{/gist_id}","starred_url":"https://api.github.com/users/ramsey-superpedestrian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ramsey-superpedestrian/subscriptions","organizations_url":"https://api.github.com/users/ramsey-superpedestrian/orgs","repos_url":"https://api.github.com/users/ramsey-superpedestrian/repos","events_url":"https://api.github.com/users/ramsey-superpedestrian/events{/privacy}","received_events_url":"https://api.github.com/users/ramsey-superpedestrian/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-11-19T15:35:30Z","updated_at":"2022-11-21T13:09:42Z","closed_at":"2022-11-21T13:09:41Z","author_association":"NONE","active_lock_reason":null,"body":"### System information\r\n\r\n- ** Google Colab\r\n```\r\n> cat /etc/*release \r\nDISTRIB_ID=Ubuntu\r\nDISTRIB_RELEASE=18.04\r\nDISTRIB_CODENAME=bionic\r\nDISTRIB_DESCRIPTION=\"Ubuntu 18.04.6 LTS\"\r\nNAME=\"Ubuntu\"\r\nVERSION=\"18.04.6 LTS (Bionic Beaver)\"\r\nID=ubuntu\r\nID_LIKE=debian\r\nPRETTY_NAME=\"Ubuntu 18.04.6 LTS\"\r\nVERSION_ID=\"18.04\"\r\nHOME_URL=\"https://www.ubuntu.com/\"\r\nSUPPORT_URL=\"https://help.ubuntu.com/\"\r\nBUG_REPORT_URL=\"https://bugs.launchpad.net/ubuntu/\"\r\nPRIVACY_POLICY_URL=\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\"\r\nVERSION_CODENAME=bionic\r\nUBUNTU_CODENAME=bionic\r\n```\r\n\r\n- **MLflow installed from (source or binary)**: binary: aka `pip install mlflow==2.0.1`\r\n- **MLflow version (run ``mlflow --version``)**:  `ERROR: Could not find a version that satisfies the requirement mlflow==2.0.1`\r\n- **Python version**: 3.7\r\n\r\n\r\n\r\n\r\n### Code to reproduce issue\r\n\r\n```bash\r\npip install mlflow==2.0.1\r\n```\r\n\r\n### Describe the problem\r\n\r\nIt looks like about 3 weeks ago, mlflow 2.0.1 was released and this PR https://github.com/mlflow/mlflow/pull/7161\r\n\r\nBut it's not clear why MLFlow (client) stopped supporting 3.7 and the Google Colab platform is locked to 3.7\r\n\r\nBy locking MLFlow 2.0.1 to python 3.8, mlflow constrains Google Colab users to MLFlow 1.3.0.  And because the MLFlow 2.0.1 server does not appear to be compatible with mlflow 1.3.0, this constrains organizations which use Google Colab to also use mlflow server 1.3.0.\r\n\r\nIt's possible that you intended for mlflow server 2.0.1 to be backwards compatible.  In which case I will submit a bug regarding an incompatibility between mlflow client 1.30.0 and and mlflow server 2.0.1, but it's not clear whether this should be addressed by providing a patch to the client or a patch to the server.\r\n\r\n### Other info / logs\r\n\r\nWhen running mlflow server 2.0.1 and using mlflow client 1.3.0\r\n\r\nFollowing the instructiongs here: https://www.mlflow.org/docs/1.30.0/model-registry.html#adding-an-mlflow-model-to-the-model-registry\r\n\r\n```python\r\nimport mlflow\r\nmlflow.set_tracking_uri(\"https://my.remote.server\")  # Running mlflow 2.0.1 server\r\nmlflow.set_registry_uri(\"https://my.remote.server\")\r\n```\r\n\r\n```python\r\nfrom mlflow import MlflowClient\r\n\r\nclient = MlflowClient()\r\nclient.create_registered_model(\"test\")\r\n```\r\n\r\nThis results in the stack trace:\r\n\r\n```\r\n[/usr/local/lib/python3.7/dist-packages/mlflow/tracking/client.py](https://localhost:8080/#) in create_registered_model(self, name, tags, description)\r\n   1845             description: This sentiment analysis model classifies the tone-happy, sad, angry.\r\n   1846         \"\"\"\r\n-> 1847         return self._get_registry_client().create_registered_model(name, tags, description)\r\n   1848 \r\n   1849     def rename_registered_model(self, name: str, new_name: str) -> RegisteredModel:\r\n\r\n[/usr/local/lib/python3.7/dist-packages/mlflow/tracking/_model_registry/client.py](https://localhost:8080/#) in create_registered_model(self, name, tags, description)\r\n     57         tags = tags if tags else {}\r\n     58         tags = [RegisteredModelTag(key, str(value)) for key, value in tags.items()]\r\n---> 59         return self.store.create_registered_model(name, tags, description)\r\n     60 \r\n     61     def update_registered_model(self, name, description):\r\n\r\n[/usr/local/lib/python3.7/dist-packages/mlflow/store/model_registry/rest_store.py](https://localhost:8080/#) in create_registered_model(self, name, tags, description)\r\n     81             CreateRegisteredModel(name=name, tags=proto_tags, description=description)\r\n     82         )\r\n---> 83         response_proto = self._call_endpoint(CreateRegisteredModel, req_body)\r\n     84         return RegisteredModel.from_proto(response_proto.registered_model)\r\n     85 \r\n\r\n[/usr/local/lib/python3.7/dist-packages/mlflow/store/model_registry/rest_store.py](https://localhost:8080/#) in _call_endpoint(self, api, json_body, call_all_endpoints)\r\n     62         else:\r\n     63             endpoint, method = _METHOD_TO_INFO[api]\r\n---> 64             return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)\r\n     65 \r\n     66     # CRUD API for RegisteredModel objects\r\n\r\n[/usr/local/lib/python3.7/dist-packages/mlflow/utils/rest_utils.py](https://localhost:8080/#) in call_endpoint(host_creds, endpoint, method, json_body, response_proto)\r\n    278             host_creds=host_creds, endpoint=endpoint, method=method, json=json_body\r\n    279         )\r\n--> 280     response = verify_rest_response(response, endpoint)\r\n    281     js_dict = json.loads(response.text)\r\n    282     parse_dict(js_dict=js_dict, message=response_proto)\r\n\r\n[/usr/local/lib/python3.7/dist-packages/mlflow/utils/rest_utils.py](https://localhost:8080/#) in verify_rest_response(response, endpoint)\r\n    212             raise MlflowException(\r\n    213                 \"%s. Response body: '%s'\" % (base_msg, response.text),\r\n--> 214                 error_code=get_error_code(response.status_code),\r\n    215             )\r\n    216 \r\n\r\nMlflowException: API request to endpoint /api/2.0/preview/mlflow/registered-models/create failed with error code 404 != 200. Response body: '<!doctype html>\r\n<html lang=en>\r\n<title>404 Not Found</title>\r\n<h1>Not Found</h1>\r\n<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>\r\n```\r\n\r\nWhich seems to indicate that the mlflow 1.3.0 client expects a url that the mlflow 2.0.1 server doesn't support.\r\n\r\nNormally I would solve this by upgrading the client, but the new constraint of using python 3.8 means that I can't do this if I want to use Google Colab as a jupyter notebook platform.","closed_by":{"login":"ramsey-superpedestrian","id":61248250,"node_id":"MDQ6VXNlcjYxMjQ4MjUw","avatar_url":"https://avatars.githubusercontent.com/u/61248250?v=4","gravatar_id":"","url":"https://api.github.com/users/ramsey-superpedestrian","html_url":"https://github.com/ramsey-superpedestrian","followers_url":"https://api.github.com/users/ramsey-superpedestrian/followers","following_url":"https://api.github.com/users/ramsey-superpedestrian/following{/other_user}","gists_url":"https://api.github.com/users/ramsey-superpedestrian/gists{/gist_id}","starred_url":"https://api.github.com/users/ramsey-superpedestrian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ramsey-superpedestrian/subscriptions","organizations_url":"https://api.github.com/users/ramsey-superpedestrian/orgs","repos_url":"https://api.github.com/users/ramsey-superpedestrian/repos","events_url":"https://api.github.com/users/ramsey-superpedestrian/events{/privacy}","received_events_url":"https://api.github.com/users/ramsey-superpedestrian/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/7367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/7367/timeline","performed_via_github_app":null,"state_reason":"completed"}