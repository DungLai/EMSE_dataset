{"url":"https://api.github.com/repos/mlflow/mlflow/issues/545","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/545/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/545/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/545/events","html_url":"https://github.com/mlflow/mlflow/issues/545","id":363270942,"node_id":"MDU6SXNzdWUzNjMyNzA5NDI=","number":545,"title":"MLflow remote Tracking server not receiving information","user":{"login":"dudgnskim","id":14118503,"node_id":"MDQ6VXNlcjE0MTE4NTAz","avatar_url":"https://avatars.githubusercontent.com/u/14118503?v=4","gravatar_id":"","url":"https://api.github.com/users/dudgnskim","html_url":"https://github.com/dudgnskim","followers_url":"https://api.github.com/users/dudgnskim/followers","following_url":"https://api.github.com/users/dudgnskim/following{/other_user}","gists_url":"https://api.github.com/users/dudgnskim/gists{/gist_id}","starred_url":"https://api.github.com/users/dudgnskim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dudgnskim/subscriptions","organizations_url":"https://api.github.com/users/dudgnskim/orgs","repos_url":"https://api.github.com/users/dudgnskim/repos","events_url":"https://api.github.com/users/dudgnskim/events{/privacy}","received_events_url":"https://api.github.com/users/dudgnskim/received_events","type":"User","site_admin":false},"labels":[{"id":1554650079,"node_id":"MDU6TGFiZWwxNTU0NjUwMDc5","url":"https://api.github.com/repos/mlflow/mlflow/labels/stale","name":"stale","color":"828282","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":23,"created_at":"2018-09-24T18:38:58Z","updated_at":"2022-09-18T08:37:44Z","closed_at":"2019-11-12T23:49:59Z","author_association":"NONE","active_lock_reason":null,"body":"### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in MLflow)**:\r\nI am experimenting with MLflow tracking server with very simple examples.\r\n- Node A: where I write codes and run / Node B: where mlflow server is running\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Node A: Ubuntu 18.04 / Node B: CentOS 6\r\n- **MLflow installed from (source or binary)**:  using pip\r\n- **MLflow version (run ``mlflow --version``)**: both 0.6.0\r\n- **Python version**: Node A: 3.6 / Node B: 2.7\r\n- **npm version (if running the dev UI): Node A: not installed / Node B: 3.10.10\r\n\r\n- **Exact command to reproduce**:\r\nNode A:\r\n```\r\nimport mlflow\r\nfrom mlflow.tracking import set_tracking_uri as uri\r\nuri('http://x.x.x.x:5000')\r\n\r\nwith mlflow.start_run():\r\n    mlflow.log_param('a', 1)\r\n    mlflow.log_param('b', 2)\r\n```\r\n\r\n**Tracking Server command**\r\nNode B:\r\n`mlflow server --file-store /file/store/location --default-artifact-root /default/artifact/root --host x.x.x.x`\r\n\r\n### Describe the problem\r\nAbove simple code should not produce any error. However, when I run the code from node A, it keeps running for like 2 minutes, and shows the error message saying:\r\n\r\n```\r\nAPI request to http://x.x.x.x:5000/api/2.0/preview/mlflow/runs/create failed with code 504 != 200, retrying up to 2 more times. API response body: <!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\"\r\n\"http://www.w3.org/TR/html4/loose.dtd\">\r\n<html>\r\n<head>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\r\n<title>Notification: Gateway Timeout</title>\r\n<style type=\"text/css\">\r\n<!--\r\nbody {\r\n    margin-left: 2%;\r\n    margin-right: 2%;\r\n}\r\np {\r\n    font-family: verdana, Arial, Helvetica, sans-serif;\r\n    font-size: 12px;\r\n    top: 0px;\r\n    margin-top: 6px;\r\n    margin-bottom: 6px;\r\n}\r\ntd {\r\n    font-family: verdana, Arial, Helvetica, sans-serif;\r\n    font-size: 12px;\r\n    top: 0px;\r\n}\r\n.code {\r\n    font-family: courier;\r\n    font-size: 12px;\r\n    top: 0px;\r\n}\r\nh1 {\r\n    font-family: verdana, Arial, Helvetica, sans-serif;\r\n    font-size: 16px;\r\n    margin-top: 24px;\r\n    margin-bottom: 8px;\r\n}\r\nhr {\r\n    margin-top: 2px;\r\n    margin-bottom: 2px;\r\n}\r\n-->\r\n</style>\r\n</head>\r\n\r\n<body>\r\n\r\n<h1>This Page Cannot Be Displayed</h1>\r\n<hr>\r\n\r\n<p>\r\nThe system cannot communicate with the external server (&nbsp;x.x.x.x&nbsp;).\r\nThe Internet server may be busy, may be permanently down, or may be\r\nunreachable because of network problems.\r\n</p>\r\n\r\n<p>\r\nPlease check the spelling of the Internet address entered.\r\nIf it is correct, try this request later.\r\n</p>\r\n\r\n\r\n\r\n<p>\r\nIf you have questions, or feel this is an error, please contact\r\nyour organization's network administrator \r\nand provide the codes shown below.\r\n</p>\r\n\r\n<hr>\r\n<table>\r\n  <tr valign=\"top\">\r\n    <td valign=\"top\" width=\"10%\">Notification&nbsp;codes:&nbsp;</td>\r\n    <td valign=\"top\" class=\"code\" width=\"90%\">(1, GATEWAY_TIMEOUT, x.x.x.x)</td>\r\n  </tr>\r\n</table>\r\n\r\n</body>\r\n</html>\r\n```\r\n\r\n*** x.x.x.x is the ip address of Node B\r\n\r\nI tried\r\n\r\n1. Reinstalling mlflow on both nodes\r\n2. Checking internet connection of both nodes as well as the communications between the nodes\r\n3. Checking if running from Node B itself with the same format of codes would work (Same problem)\r\n4. Changing the location of the mlflow tracking server storage\r\n5. Using HDFS as mlflow tracking server storage\r\n6. Checking if logging is possible from windows based machine\r\n7. Checking if hosting mlflow server on Node A works (Same problem with Node A ip)\r\n\r\nNo luck on all the attempts. Address for the tracking server was correct and no internet problem on either nodes. Other applications / softwares on both Node A and B are running without any issues, so I can only imagine that this has to do with mlflow server issue. Please help me resolve this issue..! Let me know if you need any more information from me to resolve this issue!\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks,\r\nplease include the full traceback. Large logs and files should be attached.\r\nTry to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n```\r\nTraceback:\r\n---------------------------------------------------------------------------\r\nMlflowException                           Traceback (most recent call last)\r\n<ipython-input-6-af1864c9f8ff> in <module>()\r\n      2 uri(\"http://x.x.x.x:5000\")\r\n      3 \r\n----> 4 with mlflow.start_run():\r\n      5     mlflow.log_param('a', 1)\r\n      6     mlflow.log_param('b', 2)\r\n\r\n/usr/local/lib/python3.6/dist-packages/mlflow/tracking/fluent.py in start_run(run_uuid, experiment_id, source_name, source_version, entry_point_name, source_type, run_name)\r\n    107                 source_version=source_version or _get_source_version(),\r\n    108                 entry_point_name=entry_point_name,\r\n--> 109                 source_type=source_type or _get_source_type())\r\n    110     _active_run = ActiveRun(active_run_obj)\r\n    111     return _active_run\r\n\r\n/usr/local/lib/python3.6/dist-packages/mlflow/tracking/client.py in create_run(self, experiment_id, user_id, run_name, source_type, source_name, entry_point_name, start_time, source_version, tags)\r\n     63             start_time=start_time or int(time.time() * 1000),\r\n     64             source_version=source_version,\r\n---> 65             tags=[RunTag(key, value) for (key, value) in iteritems(tags)],\r\n     66         )\r\n     67 \r\n\r\n/usr/local/lib/python3.6/dist-packages/mlflow/store/rest_store.py in create_run(self, experiment_id, user_id, run_name, source_type, source_name, entry_point_name, start_time, source_version, tags)\r\n    147             source_type=source_type, source_name=source_name, entry_point_name=entry_point_name,\r\n    148             start_time=start_time, source_version=source_version, tags=tag_protos))\r\n--> 149         response_proto = self._call_endpoint(CreateRun, req_body)\r\n    150         run = Run.from_proto(response_proto.run)\r\n    151         if run_name:\r\n\r\n/usr/local/lib/python3.6/dist-packages/mlflow/store/rest_store.py in _call_endpoint(self, api, json_body)\r\n     65         host_creds = self.get_host_creds()\r\n     66         response = http_request(host_creds=host_creds, endpoint=endpoint, method=method,\r\n---> 67                                 json=json_body)\r\n     68         js_dict = json.loads(response.text)\r\n     69 \r\n\r\n/usr/local/lib/python3.6/dist-packages/mlflow/utils/rest_utils.py in http_request(host_creds, endpoint, retries, retry_interval, **kwargs)\r\n     51             time.sleep(retry_interval)\r\n     52     raise MlflowException(\"API request to %s failed to return code 200 after %s tries\" %\r\n---> 53                           (url, retries))\r\n     54 \r\n     55 \r\n\r\nMlflowException: API request to http://x.x.x.x:5000/api/2.0/preview/mlflow/runs/create failed to return code 200 after 3 tries\r\n```\r\n","closed_by":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/545/timeline","performed_via_github_app":null,"state_reason":"completed"}