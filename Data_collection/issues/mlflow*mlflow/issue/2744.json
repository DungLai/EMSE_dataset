{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2744","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/2744/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/2744/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/2744/events","html_url":"https://github.com/mlflow/mlflow/issues/2744","id":605391231,"node_id":"MDU6SXNzdWU2MDUzOTEyMzE=","number":2744,"title":"[BUG]Unable to write artifact to a http server","user":{"login":"ulorentz","id":18531095,"node_id":"MDQ6VXNlcjE4NTMxMDk1","avatar_url":"https://avatars.githubusercontent.com/u/18531095?v=4","gravatar_id":"","url":"https://api.github.com/users/ulorentz","html_url":"https://github.com/ulorentz","followers_url":"https://api.github.com/users/ulorentz/followers","following_url":"https://api.github.com/users/ulorentz/following{/other_user}","gists_url":"https://api.github.com/users/ulorentz/gists{/gist_id}","starred_url":"https://api.github.com/users/ulorentz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulorentz/subscriptions","organizations_url":"https://api.github.com/users/ulorentz/orgs","repos_url":"https://api.github.com/users/ulorentz/repos","events_url":"https://api.github.com/users/ulorentz/events{/privacy}","received_events_url":"https://api.github.com/users/ulorentz/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-04-23T09:43:38Z","updated_at":"2020-05-01T22:47:38Z","closed_at":"2020-05-01T22:47:38Z","author_association":"NONE","active_lock_reason":null,"body":"## System information\r\n\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Debian 10.3\r\n- **MLflow installed from (source or binary)**: pip\r\n- **MLflow version (run ``mlflow --version``)**: 1.8.0\r\n- **Python version**: 3.7.3\r\n\r\n### Describe the problem\r\nI am running a mlflow server on a machine that has a reverse proxy via https (using apache). A client runs experiment and logs to the server via ``mlflow.set_tracking_uri(\"https://url\") ``. It manages to write metrics, but when I do ``mlflow.log_artifact(hist_path+\".txt\")`` it tries to write the artifacts to a local path and not to the server. The local path is the one set via server ``--default-artifact-root``, that I would expect to be the path on the server, and not local one. \r\n\r\n### Code to reproduce issue\r\nThe server is launched with ``mlflow server --backend-store-uri file:///media/server-data/mlflow --default-artifact-root file:///media/slow-data/mlflow_artifacts``\r\nThe client sets the tracking uri with ``mlflow.set_tracking_uri(\"https://url\")`` (where ``url`` is the address of the server) and logs artifacts and model with ``mlflow.log_artifact(hist_path)`` and ``mlflow.pytorch.log_model(fitter.best_model, \"models\")``. \r\n\r\n### Other info / logs\r\n\r\n```Traceback (most recent call last):\r\n  File \"tiny_linknet/extern.py\", line 266, in <module>\r\n    main(args)\r\n  File \"tiny_linknet/extern.py\", line 201, in main\r\n    mlflow.log_artifact(hist_path+\".txt\")\r\n  File \"/home/lorenzo/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py\", line 311, in log_artifact\r\n    MlflowClient().log_artifact(run_id, local_path, artifact_path)\r\n  File \"/home/lorenzo/.local/lib/python3.8/site-packages/mlflow/tracking/client.py\", line 257, in log_artifact\r\n    self._tracking_client.log_artifact(run_id, local_path, artifact_path)\r\n  File \"/home/lorenzo/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py\", line 257, in log_artifact\r\n    artifact_repo.log_artifact(local_path, artifact_path)\r\n  File \"/home/lorenzo/.local/lib/python3.8/site-packages/mlflow/store/artifact/local_artifact_repo.py\", line 31, in log_artifact\r\n    mkdir(artifact_dir)\r\n  File \"/home/lorenzo/.local/lib/python3.8/site-packages/mlflow/utils/file_utils.py\", line 106, in mkdir\r\n    raise e\r\n  File \"/home/lorenzo/.local/lib/python3.8/site-packages/mlflow/utils/file_utils.py\", line 103, in mkdir\r\n    os.makedirs(target)\r\n  File \"/usr/lib/python3.8/os.py\", line 213, in makedirs\r\n    makedirs(head, exist_ok=exist_ok)\r\n  File \"/usr/lib/python3.8/os.py\", line 213, in makedirs\r\n    makedirs(head, exist_ok=exist_ok)\r\n  File \"/usr/lib/python3.8/os.py\", line 213, in makedirs\r\n    makedirs(head, exist_ok=exist_ok)\r\n  [Previous line repeated 2 more times]\r\n  File \"/usr/lib/python3.8/os.py\", line 223, in makedirs\r\n    mkdir(name, mode)\r\nPermissionError: [Errno 13] Permission denied: '/media'\r\n```\r\n","closed_by":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2744/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/2744/timeline","performed_via_github_app":null,"state_reason":"completed"}