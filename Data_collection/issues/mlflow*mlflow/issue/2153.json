{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2153","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/2153/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/2153/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/2153/events","html_url":"https://github.com/mlflow/mlflow/issues/2153","id":530512176,"node_id":"MDU6SXNzdWU1MzA1MTIxNzY=","number":2153,"title":"[HELP WANTED] ConnectionReset Error [BUG]","user":{"login":"gbmarc1","id":29891099,"node_id":"MDQ6VXNlcjI5ODkxMDk5","avatar_url":"https://avatars.githubusercontent.com/u/29891099?v=4","gravatar_id":"","url":"https://api.github.com/users/gbmarc1","html_url":"https://github.com/gbmarc1","followers_url":"https://api.github.com/users/gbmarc1/followers","following_url":"https://api.github.com/users/gbmarc1/following{/other_user}","gists_url":"https://api.github.com/users/gbmarc1/gists{/gist_id}","starred_url":"https://api.github.com/users/gbmarc1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gbmarc1/subscriptions","organizations_url":"https://api.github.com/users/gbmarc1/orgs","repos_url":"https://api.github.com/users/gbmarc1/repos","events_url":"https://api.github.com/users/gbmarc1/events{/privacy}","received_events_url":"https://api.github.com/users/gbmarc1/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1893072438,"node_id":"MDU6TGFiZWwxODkzMDcyNDM4","url":"https://api.github.com/repos/mlflow/mlflow/labels/help%20wanted","name":"help wanted","color":"c5def5","default":true,"description":"We would like help from the community to add this support"},{"id":2022848510,"node_id":"MDU6TGFiZWwyMDIyODQ4NTEw","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/projects","name":"area/projects","color":"48eabc","default":false,"description":"MLproject format, project running backends"},{"id":2022851725,"node_id":"MDU6TGFiZWwyMDIyODUxNzI1","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/docker","name":"area/docker","color":"ede978","default":false,"description":"Docker use anywhere, such as MLprojects and MLmodels"},{"id":2022865338,"node_id":"MDU6TGFiZWwyMDIyODY1MzM4","url":"https://api.github.com/repos/mlflow/mlflow/labels/priority/important-longterm","name":"priority/important-longterm","color":"534cb5","default":false,"description":"Important over the long term, but may not be staffed or may need multiple releases to complete."}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-11-30T00:14:45Z","updated_at":"2020-07-06T23:32:19Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I have this issue when I have a project with a docker Image:\r\n\r\n```\r\nBuilding docker image Employee Experience Categorisation:d9f321a ===\r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/urllib3/connectionpool.py\", line 672, in urlopen  chunked=chunked,\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/urllib3/connectionpool.py\", line 387, in _make_requestconn.request(method, url, **httplib_request_kw)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/http/client.py\", line 1252, in request  self._send_request(method, url, body, headers, encode_chunked)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/http/client.py\", line 1298, in _send_requestself.endheaders(body, encode_chunked=encode_chunked)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/http/client.py\", line 1247, in endheaders   self._send_output(message_body, encode_chunked=encode_chunked)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/http/client.py\", line 1065, in _send_output self.send(chunk)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/http/client.py\", line 987, in send  self.sock.sendall(data)\r\nConnectionResetError: [Errno 104] Connection reset by peer\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/requests/adapters.py\", line 449, in send  timeout=timeout\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/urllib3/connectionpool.py\", line 720, in urlopen  method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/urllib3/util/retry.py\", line 400, in incrementraise six.reraise(type(error), error, _stacktrace)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/urllib3/packages/six.py\", line 734, in reraiseraise value.with_traceback(tb)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/urllib3/connectionpool.py\", line 672, in urlopen  chunked=chunked,\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/urllib3/connectionpool.py\", line 387, in _make_requestconn.request(method, url, **httplib_request_kw)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/http/client.py\", line 1252, in request  self._send_request(method, url, body, headers, encode_chunked)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/http/client.py\", line 1298, in _send_requestself.endheaders(body, encode_chunked=encode_chunked)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/http/client.py\", line 1247, in endheaders   self._send_output(message_body, encode_chunked=encode_chunked)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/http/client.py\", line 1065, in _send_output self.send(chunk)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/http/client.py\", line 987, in send  self.sock.sendall(data)\r\nurllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer'))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n File \"/workspace/marc/miniconda3/envs/mlflow/bin/mlflow\", line 8, in <module>  sys.exit(cli())\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/click/core.py\", line 764, in __call__ return self.main(*args, **kwargs)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/click/core.py\", line 717, in main rv = self.invoke(ctx)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/click/core.py\", line 1137, in invoke  return _process_result(sub_ctx.command.invoke(sub_ctx))\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/click/core.py\", line 956, in invoke   return ctx.invoke(self.callback, **ctx.params)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/click/core.py\", line 555, in invoke   return callback(*args, **kwargs)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/mlflow/cli.py\", line 134, in run  run_id=run_id\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/mlflow/projects/__init__.py\", line 285, in runuse_conda=use_conda, storage_dir=storage_dir, synchronous=synchronous, run_id=run_id)  File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/mlflow/projects/__init__.py\", line 154, in _run   run_id=active_run.info.run_id)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/mlflow/projects/__init__.py\", line 818, in _build_docker_imagefileobj=docker_build_ctx, custom_context=True, encoding=\"gzip\")\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/docker/models/images.py\", line 279, in build  resp = self.client.api.build(**kwargs)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/docker/api/build.py\", line 269, in build  timeout=timeout,\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/docker/utils/decorators.py\", line 46, in innerreturn f(self, *args, **kwargs)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/docker/api/client.py\", line 226, in _post return self.post(url, **self._set_request_timeout(kwargs))\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/requests/sessions.py\", line 581, in post  return self.request('POST', url, data=data, json=json, **kwargs)   File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/requests/sessions.py\", line 533, in request   resp = self.send(prep, **send_kwargs)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/requests/sessions.py\", line 646, in send  r = adapter.send(request, **kwargs)\r\n File \"/workspace/marc/miniconda3/envs/mlflow/lib/python3.7/site-packages/requests/adapters.py\", line 498, in send  raise ConnectionError(err, request=request)\r\nrequests.exceptions.ConnectionError: ('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer'))\r\n```\r\n\r\nMy docker image is correctly built on my system. Is it because it does not find it on the machine and tries to find it somehwere else?\r\n\r\nMy MLproject file:\r\n```yaml\r\n\r\nname: Employee Experience Categorisation\r\n\r\ndocker_env:\r\n  image: mlflow-docker\r\n\r\nentry_points:\r\n  train:\r\n    parameters:\r\n      data_file: path\r\n      regularization: {type: float, default: 0.1}\r\n    command: \"python src/train.py -r {regularization} {data_file}\"\r\n  encode:\r\n    parameters:\r\n      save_path: path\r\n      threshold: {type: int, default: 100}\r\n    command: \"python src/label_encoder.py --save_path {save_path} --map {map} --threshold {threshold} --log\"\r\n```\r\n\r\n\r\nI verified that my docker image was on the system:\r\n\r\n```\r\ndocker images mlflow-docker\r\n\r\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\r\nmlflow-docker       latest              245f9ddbbb75        45 minutes ago      4.47GB\r\n```\r\n\r\n\r\nAny idea?\r\n\r\n\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2153/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/2153/timeline","performed_via_github_app":null,"state_reason":null}