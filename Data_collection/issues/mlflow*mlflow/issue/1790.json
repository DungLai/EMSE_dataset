{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1790","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/1790/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/1790/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/1790/events","html_url":"https://github.com/mlflow/mlflow/issues/1790","id":486186936,"node_id":"MDU6SXNzdWU0ODYxODY5MzY=","number":1790,"title":"mlflow tracking server","user":{"login":"ghost","id":10137,"node_id":"MDQ6VXNlcjEwMTM3","avatar_url":"https://avatars.githubusercontent.com/u/10137?v=4","gravatar_id":"","url":"https://api.github.com/users/ghost","html_url":"https://github.com/ghost","followers_url":"https://api.github.com/users/ghost/followers","following_url":"https://api.github.com/users/ghost/following{/other_user}","gists_url":"https://api.github.com/users/ghost/gists{/gist_id}","starred_url":"https://api.github.com/users/ghost/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghost/subscriptions","organizations_url":"https://api.github.com/users/ghost/orgs","repos_url":"https://api.github.com/users/ghost/repos","events_url":"https://api.github.com/users/ghost/events{/privacy}","received_events_url":"https://api.github.com/users/ghost/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-08-28T06:37:38Z","updated_at":"2019-08-29T21:04:21Z","closed_at":"2019-08-29T21:04:21Z","author_association":"NONE","active_lock_reason":null,"body":"I'm trying to setup a central MLFlow server and artifact store for our team to log and store models and their artifact. Is this possible with MLFlow? Eventually this will be run on a Kubernetes cluster and a shared NAS drive will be mounted for the server to write to...\r\n\r\n### System information\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 18.04\r\n- **MLflow installed from (source or binary)**: binary\r\n- **MLflow version (run ``mlflow --version``)**:1.2.0\r\n- **Python version**: 3.6.8\r\n- **Exact command to reproduce**: \r\n\r\n```\r\nversion:  '3'\r\nservices:\r\n  # docker-compose run mlflow\r\n  mlflow:\r\n    image: 192.168.1.84:6666/mlflow-server\r\n    command: mlflow server --host 0.0.0.0\r\n    ports:\r\n      - \"5000:5000\"\r\n    container_name: mlflow-server\r\n\r\n    command: >\r\n      mlflow server \r\n        --backend-store-uri sqlite:///app/mlflow.db\r\n        --default-artifact-root sftp://mlflowuser:mlflowuser@192.168.1.25/\r\n        --host 0.0.0.0\r\n    volumes:\r\n       - /home/alex/dev/mlflow:/app\r\n```\r\nthen `docker-compose up`\r\n\r\nAlso set `MLFLOW_TRACKING_URI=127.0.0.1:5000`\r\n\r\nthen when i run the example:\r\n\r\n` python remote_store/remote_server.py`\r\n\r\n### Describe the problem\r\n\r\n```\r\n18:15 $ python remote_store/remote_server.py\r\nRunning remote_store/remote_server.py with tracking URI 127.0.0.1:5000\r\nMetadata & data for run with UUID 564c1263e0a7490c946d1acf991186a6: <Run: data=<RunData: metrics={'foo': 7.0, 'random_int': 11.0}, params={'param1': '5'}, tags={'mlflow.source.git.commit': 'cf248098793bd1d750830a58c9ec8bfbdefed89f',\r\n 'mlflow.source.name': 'remote_store/remote_server.py',\r\n 'mlflow.source.type': 'LOCAL',\r\n 'mlflow.user': 'alex'}>, info=<RunInfo: artifact_uri='127.0.0.1:5000/0/564c1263e0a7490c946d1acf991186a6/artifacts', end_time=None, experiment_id='0', lifecycle_stage='active', run_id='564c1263e0a7490c946d1acf991186a6', run_uuid='564c1263e0a7490c946d1acf991186a6', start_time=1566973136383, status='RUNNING', user_id='alex'>>\r\nTraceback (most recent call last):\r\n  File \"remote_store/remote_server.py\", line 32, in <module>\r\n    log_artifacts(local_dir, \"some_subdir\")\r\n  File \"/home/alex/dev/mlflow/__modules__/lib/python3.6/site-packages/mlflow/tracking/fluent.py\", line 277, in log_artifacts\r\n    MlflowClient().log_artifacts(run_id, local_dir, artifact_path)\r\n  File \"/home/alex/dev/mlflow/__modules__/lib/python3.6/site-packages/mlflow/tracking/client.py\", line 253, in log_artifacts\r\n    artifact_repo = get_artifact_repository(run.info.artifact_uri)\r\n  File \"/home/alex/dev/mlflow/__modules__/lib/python3.6/site-packages/mlflow/store/artifact_repository_registry.py\", line 100, in get_artifact_repository\r\n    return _artifact_repository_registry.get_artifact_repository(artifact_uri)\r\n  File \"/home/alex/dev/mlflow/__modules__/lib/python3.6/site-packages/mlflow/store/artifact_repository_registry.py\", line 68, in get_artifact_repository\r\n    artifact_uri, list(self._registry.keys())\r\nmlflow.exceptions.MlflowException: Could not find a registered artifact repository for: 127.0.0.1:5000/0/564c1263e0a7490c946d1acf991186a6/artifacts. Currently registered schemes are: ['', 'file', 's3', 'gs', 'wasbs', 'ftp', 'sftp', 'dbfs', 'hdfs', 'runs']\r\n```\r\nI've also tried \r\n`--default-artifact-root /someplace` and `--default-artifact-root file:/someplace` and I'm getting the same error on the client.\r\n\r\nI don't understand the note in the docs:\r\n> If you do not specify a --default-artifact-root or an artifact URI when creating the experiment ...  the artifact root is a path inside the file store. Typically this is not an appropriate location, as the client and server probably refer to different physical locations (that is, the same path on different disks).\r\n\r\nParticularly \"client and server probably refer to different physical locations\"? I thought the client would send the artifacts to the server and it would take care of storing it? Or is the client supposed to write to the same location that is shared by the server? If so, how am I supposed to configure this to do that?","closed_by":null,"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/1790/timeline","performed_via_github_app":null,"state_reason":"completed"}