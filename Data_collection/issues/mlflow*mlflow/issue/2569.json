{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2569","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/2569/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/2569/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/2569/events","html_url":"https://github.com/mlflow/mlflow/issues/2569","id":579136976,"node_id":"MDU6SXNzdWU1NzkxMzY5NzY=","number":2569,"title":"[BUG] Sqlite in-memory is not working as backend store","user":{"login":"BharathiRajagopal","id":30861320,"node_id":"MDQ6VXNlcjMwODYxMzIw","avatar_url":"https://avatars.githubusercontent.com/u/30861320?v=4","gravatar_id":"","url":"https://api.github.com/users/BharathiRajagopal","html_url":"https://github.com/BharathiRajagopal","followers_url":"https://api.github.com/users/BharathiRajagopal/followers","following_url":"https://api.github.com/users/BharathiRajagopal/following{/other_user}","gists_url":"https://api.github.com/users/BharathiRajagopal/gists{/gist_id}","starred_url":"https://api.github.com/users/BharathiRajagopal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BharathiRajagopal/subscriptions","organizations_url":"https://api.github.com/users/BharathiRajagopal/orgs","repos_url":"https://api.github.com/users/BharathiRajagopal/repos","events_url":"https://api.github.com/users/BharathiRajagopal/events{/privacy}","received_events_url":"https://api.github.com/users/BharathiRajagopal/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1893057631,"node_id":"MDU6TGFiZWwxODkzMDU3NjMx","url":"https://api.github.com/repos/mlflow/mlflow/labels/Acknowledged","name":"Acknowledged","color":"f9d0c4","default":false,"description":"This issue has been read and acknowledged by the MLflow admins."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-03-11T09:55:07Z","updated_at":"2020-04-04T09:46:37Z","closed_at":"2020-04-04T09:46:37Z","author_association":"NONE","active_lock_reason":null,"body":"Thank you for submitting an issue. Please refer to our [issue policy](https://www.github.com/mlflow/mlflow/blob/master/ISSUE_POLICY.md)\r\nfor information on what types of issues we address. For help with debugging your code, please refer to [Stack Overflow](https://stackoverflow.com/questions/tagged/mlflow).\r\n\r\nPlease fill in this template and do not delete it unless you are sure your issue is outside its scope.\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in MLflow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Windows, Linux Ubuntu 16.04\r\n- **MLflow installed from (source or binary)**: pip install\r\n- **MLflow version (run ``mlflow --version``)**: 1.7.0\r\n- **Python version**: 3.8. \r\n- **npm version, if running the dev UI**: NA\r\n- **Exact command to reproduce**: \r\n\r\n- mlflow server --backend-store-uri sqlite:// --default-artifact-root ./\r\n- **mlflow server --backend-store-uri sqlite:///:memory: --default-artifact-root ./**\r\n\r\n### Describe the problem\r\nWe have a requirement, where we have to use in-memory sqlite with mlflow.\r\nInstantiating mlflow server with sqlite in-memory backend store, stops the server abruptly without throwing any error.\r\nOn further investigation found out that it happens because of the db upgrade. On instantiation mlflow server creates a connection to sqlite in-memory(spawn) and during the upgrade, it doesn't use the same connection which throws error table not found(not able to find the tables which were created during instantiation).\r\n\r\nIs there any way to disable the upgrade? For example, if we are instantiating with 1.6, directly create tables schema specific to that version, instead of step upgrades(creating the schema of initial version and executing version upgrade scripts one by one).\r\nOr is there any other workaround for this?\r\n\r\n### Code to reproduce issue\r\n**Command to reproduce**\r\n**mlflow server --backend-store-uri sqlite:// --default-artifact-root ./**\r\n**mlflow server --backend-store-uri sqlite:///:memory: --default-artifact-root ./**\r\n\r\n### Other info / logs\r\n\r\n2020/03/11 15:23:34 INFO mlflow.store.db.utils: Creating initial MLflow database tables...\r\n2020/03/11 15:23:34 INFO mlflow.store.db.utils: Updating database tables at sqlite://\r\nINFO  [alembic.runtime.migration] Context impl SQLiteImpl.\r\nINFO  [alembic.runtime.migration] Will assume non-transactional DDL.\r\nINFO  [alembic.runtime.migration] Running upgrade  -> 451aebb31d03, add metric step\r\n","closed_by":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/2569/timeline","performed_via_github_app":null,"state_reason":"completed"}