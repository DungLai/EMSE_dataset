{"url":"https://api.github.com/repos/mlflow/mlflow/issues/5936","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/5936/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/5936/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/5936/events","html_url":"https://github.com/mlflow/mlflow/issues/5936","id":1245101209,"node_id":"I_kwDOCB5Jx85KNryZ","number":5936,"title":"Multiple plugins need in_context each; doing so causes error","user":{"login":"anupash147","id":8271182,"node_id":"MDQ6VXNlcjgyNzExODI=","avatar_url":"https://avatars.githubusercontent.com/u/8271182?v=4","gravatar_id":"","url":"https://api.github.com/users/anupash147","html_url":"https://github.com/anupash147","followers_url":"https://api.github.com/users/anupash147/followers","following_url":"https://api.github.com/users/anupash147/following{/other_user}","gists_url":"https://api.github.com/users/anupash147/gists{/gist_id}","starred_url":"https://api.github.com/users/anupash147/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anupash147/subscriptions","organizations_url":"https://api.github.com/users/anupash147/orgs","repos_url":"https://api.github.com/users/anupash147/repos","events_url":"https://api.github.com/users/anupash147/events{/privacy}","received_events_url":"https://api.github.com/users/anupash147/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-05-23T12:36:01Z","updated_at":"2022-05-24T18:04:13Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hello,\r\n\r\nI have below code \r\n```\r\n    with mlflow.start_run():\r\n        params = {\r\n            \"n-estimators\": args.n_estimators,\r\n            \"min-samples-leaf\": args.min_samples_leaf,\r\n            \"features\": args.features\r\n        }\r\n        mlflow.log_params(params)\r\n\r\n        # TRAIN\r\n        logging.info('training model')\r\n        model = RandomForestRegressor(\r\n            n_estimators=args.n_estimators,\r\n            min_samples_leaf=args.min_samples_leaf,\r\n            n_jobs=-1\r\n        )\r\n\r\n        model.fit(X_train, y_train)\r\n\r\n        # ABS ERROR AND LOG COUPLE PERF METRICS\r\n        logging.info('evaluating model')\r\n        abs_err = np.abs(model.predict(X_test) - y_test)\r\n\r\n        for q in [10, 50, 90]:\r\n            logging.info(f'AE-at-{q}th-percentile: {np.percentile(a=abs_err, q=q)}')\r\n            mlflow.log_metric(f'AE-at-{str(q)}th-percentile', np.percentile(a=abs_err, q=q))\r\n\r\n        # SAVE MODEL\r\n        logging.info('saving model in MLflow')\r\n        mlflow.sklearn.log_model(model, \"model\")\r\n```\r\n\r\nAlso have a usecase that implements 2 mlflow plugins, as in 1 plugin named mlflow_plugin and tries to override the RequestHeaderProvider & RunContextProvider, so the setup.py looks something like this\r\n```\r\n    entry_points={\r\n        \"mlflow.request_header_provider\": \"file-plugin=mlflow_plugin.request_header_provider:PluginRequestHeaderProvider\",\r\n        \"mlflow.run_context_provider\": \"file-plugin=mlflow_plugin.run_context_provider:PluginRunContextProvider\"\r\n    },\r\n```\r\n\r\nWhen i run this plugin, i can clearly see the the runContext gets activated but does not cover the RequestHeaderProvider; only one can work at a time. My setup.py is create per this example so i believe it should work (https://mlflow.org/docs/latest/plugins.html#defining-a-plugin). Any bites..\r\n\r\nThe error i get is\r\n<img width=\"1034\" alt=\"image\" src=\"https://user-images.githubusercontent.com/8271182/169820836-993eac9e-985a-472f-ab18-7589a8de2d2f.png\">\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/5936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/5936/timeline","performed_via_github_app":null,"state_reason":null}