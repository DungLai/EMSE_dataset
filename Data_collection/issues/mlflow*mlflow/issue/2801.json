{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2801","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/2801/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/2801/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/2801/events","html_url":"https://github.com/mlflow/mlflow/issues/2801","id":614859734,"node_id":"MDU6SXNzdWU2MTQ4NTk3MzQ=","number":2801,"title":"[BUG] mlflow R client doesn't work with databricks tracking server","user":{"login":"blairj09","id":10444878,"node_id":"MDQ6VXNlcjEwNDQ0ODc4","avatar_url":"https://avatars.githubusercontent.com/u/10444878?v=4","gravatar_id":"","url":"https://api.github.com/users/blairj09","html_url":"https://github.com/blairj09","followers_url":"https://api.github.com/users/blairj09/followers","following_url":"https://api.github.com/users/blairj09/following{/other_user}","gists_url":"https://api.github.com/users/blairj09/gists{/gist_id}","starred_url":"https://api.github.com/users/blairj09/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blairj09/subscriptions","organizations_url":"https://api.github.com/users/blairj09/orgs","repos_url":"https://api.github.com/users/blairj09/repos","events_url":"https://api.github.com/users/blairj09/events{/privacy}","received_events_url":"https://api.github.com/users/blairj09/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1041183632,"node_id":"MDU6TGFiZWwxMDQxMTgzNjMy","url":"https://api.github.com/repos/mlflow/mlflow/labels/language/r","name":"language/r","color":"349cd8","default":false,"description":"R APIs and clients"},{"id":2022849295,"node_id":"MDU6TGFiZWwyMDIyODQ5Mjk1","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/tracking","name":"area/tracking","color":"48eabc","default":false,"description":"Tracking service, tracking client APIs, autologging"}],"state":"closed","locked":false,"assignee":{"login":"tomasatdatabricks","id":33237569,"node_id":"MDQ6VXNlcjMzMjM3NTY5","avatar_url":"https://avatars.githubusercontent.com/u/33237569?v=4","gravatar_id":"","url":"https://api.github.com/users/tomasatdatabricks","html_url":"https://github.com/tomasatdatabricks","followers_url":"https://api.github.com/users/tomasatdatabricks/followers","following_url":"https://api.github.com/users/tomasatdatabricks/following{/other_user}","gists_url":"https://api.github.com/users/tomasatdatabricks/gists{/gist_id}","starred_url":"https://api.github.com/users/tomasatdatabricks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomasatdatabricks/subscriptions","organizations_url":"https://api.github.com/users/tomasatdatabricks/orgs","repos_url":"https://api.github.com/users/tomasatdatabricks/repos","events_url":"https://api.github.com/users/tomasatdatabricks/events{/privacy}","received_events_url":"https://api.github.com/users/tomasatdatabricks/received_events","type":"User","site_admin":false},"assignees":[{"login":"tomasatdatabricks","id":33237569,"node_id":"MDQ6VXNlcjMzMjM3NTY5","avatar_url":"https://avatars.githubusercontent.com/u/33237569?v=4","gravatar_id":"","url":"https://api.github.com/users/tomasatdatabricks","html_url":"https://github.com/tomasatdatabricks","followers_url":"https://api.github.com/users/tomasatdatabricks/followers","following_url":"https://api.github.com/users/tomasatdatabricks/following{/other_user}","gists_url":"https://api.github.com/users/tomasatdatabricks/gists{/gist_id}","starred_url":"https://api.github.com/users/tomasatdatabricks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomasatdatabricks/subscriptions","organizations_url":"https://api.github.com/users/tomasatdatabricks/orgs","repos_url":"https://api.github.com/users/tomasatdatabricks/repos","events_url":"https://api.github.com/users/tomasatdatabricks/events{/privacy}","received_events_url":"https://api.github.com/users/tomasatdatabricks/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2020-05-08T16:52:20Z","updated_at":"2020-07-08T17:16:34Z","closed_at":"2020-07-08T17:16:34Z","author_association":"NONE","active_lock_reason":null,"body":"### Willingness to contribute\r\nThe MLflow Community encourages bug fix contributions. Would you or another member of your organization be willing to contribute a fix\r\nfor this bug to the MLflow code base?\r\n\r\n- [ ] Yes. I can contribute a fix for this bug independently.\r\n- [ ] Yes. I would be willing to contribute a fix for this bug with guidance from the MLflow community.\r\n- [x] No. I cannot contribute a bug fix at this time.\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in MLflow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:  CentOS Linux 7 (Core)\r\n- **MLflow installed from (source or binary)**: From source\r\n- **MLflow version (run ``mlflow --version``)**: mlflow, version 1.8.1.dev0\r\n- **Python version**: Python 3.8.2\r\n- **npm version, if running the dev UI**:\r\n- **Exact command to reproduce**: See below\r\n\r\n### Describe the problem\r\nI have connected to the databricks tracking server following the instructions [here](https://docs.databricks.com/applications/mlflow/access-hosted-tracking-server.html) by supplying the necessary environment variables. I know  I've successfully connected because I can query available experiments. However, anytime I try to interact with the tracking server in any way, such as creating an experiment or logging a parameter / artifact, I get a JSON parsing error.\r\n\r\nThis behavior **does not** happen when I'm connected to mlflow locally and not trying to use databricks.\r\n\r\n### Code to reproduce issue\r\n``` r\r\nlibrary(mlflow)\r\npackageVersion(\"mlflow\")\r\n#> [1] '1.8.1'\r\n\r\n\r\nmlflow_get_tracking_uri()\r\n#> [1] \"databricks\"\r\nmlflow_list_experiments()\r\n#> # A tibble: 1 x 6\r\n#>   experiment_id name  artifact_locati… lifecycle_stage last_update_time\r\n#>   <chr>         <chr> <chr>            <chr>                      <dbl>\r\n#> 1 389355324957… /Use… dbfs:/mlflow/db… active             1588803273786\r\n#> # … with 1 more variable: creation_time <dbl>\r\n\r\nhttr::with_verbose(mlflow_create_experiment(\"foo\"))\r\n#> -> POST //api/2.0/mlflow/experiments/create HTTP/1.1\r\n#> -> Host: dbc-590dadb5-af33.cloud.databricks.com\r\n#> -> Accept-Encoding: deflate, gzip\r\n#> -> Accept: application/json, text/xml, application/xml, */*\r\n#> -> Content-Type: application/json\r\n#> -> Authorization: Bearer dapib8aed1fa9bfc0ddd6b9cb95123f73ebe\r\n#> -> User-Agent: mlflow-r-client/1.8.1\r\n#> -> Content-Length: 14\r\n#> -> \r\n#> >> {\"name\":\"foo\"}\r\n#> \r\n#> <- HTTP/1.1 303 See Other\r\n#> <- location: https://dbc-590dadb5-af33.cloud.databricks.com/login.html\r\n#> <- content-length: 0\r\n#> <- date: Fri, 08 May 2020 16:49:24 GMT\r\n#> <- server: databricks\r\n#> <- \r\n#> -> GET /login.html HTTP/1.1\r\n#> -> Host: dbc-590dadb5-af33.cloud.databricks.com\r\n#> -> Accept-Encoding: deflate, gzip\r\n#> -> Accept: application/json, text/xml, application/xml, */*\r\n#> -> Content-Type: application/json\r\n#> -> Authorization: Bearer dapib8aed1fa9bfc0ddd6b9cb95123f73ebe\r\n#> -> User-Agent: mlflow-r-client/1.8.1\r\n#> -> \r\n#> <- HTTP/1.1 200 OK\r\n#> <- server: databricks\r\n#> <- content-type: text/html\r\n#> <- x-databricks-reason-phrase: OK\r\n#> <- vary: Accept-Encoding, User-Agent\r\n#> <- cache-control: no-store,no-cache,must-revalidate\r\n#> <- x-xss-protection: 1; mode=block\r\n#> <- date: Fri, 08 May 2020 16:49:24 GMT\r\n#> <- x-frame-options: SAMEORIGIN\r\n#> <- strict-transport-security: max-age=31536000; includeSubDomains; preload\r\n#> <- x-content-type-options: nosniff\r\n#> <- content-encoding: gzip\r\n#> <- transfer-encoding: chunked\r\n#> <- \r\n#> Error: lexical error: invalid char in json text.\r\n#>                                        <!DOCTYPE html>  <html> <head> \r\n#>                      (right here) ------^\r\n```\r\n\r\n<sup>Created on 2020-05-08 by the [reprex package](https://reprex.tidyverse.org) (v0.3.0)</sup>\r\n\r\n<details>\r\n\r\n<summary>Session info</summary>\r\n\r\n``` r\r\nsessionInfo()\r\n#> R version 3.6.2 (2019-12-12)\r\n#> Platform: x86_64-pc-linux-gnu (64-bit)\r\n#> Running under: CentOS Linux 7 (Core)\r\n#> \r\n#> Matrix products: default\r\n#> BLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.3.so\r\n#> \r\n#> locale:\r\n#>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \r\n#>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \r\n#>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \r\n#>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \r\n#>  [9] LC_ADDRESS=C               LC_TELEPHONE=C            \r\n#> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \r\n#> \r\n#> attached base packages:\r\n#> [1] stats     graphics  grDevices datasets  utils     methods   base     \r\n#> \r\n#> other attached packages:\r\n#> [1] mlflow_1.8.1\r\n#> \r\n#> loaded via a namespace (and not attached):\r\n#>  [1] Rcpp_1.0.4.6     pillar_1.4.4     compiler_3.6.2   later_1.0.0     \r\n#>  [5] highr_0.8        base64enc_0.1-3  tools_3.6.2      zeallot_0.1.0   \r\n#>  [9] digest_0.6.25    jsonlite_1.6.1   evaluate_0.14    tibble_3.0.1    \r\n#> [13] lifecycle_0.2.0  lattice_0.20-40  pkgconfig_2.0.3  rlang_0.4.6     \r\n#> [17] Matrix_1.2-18    cli_2.0.2        curl_4.3         yaml_2.2.1      \r\n#> [21] xfun_0.12        swagger_3.9.2    withr_2.2.0      httr_1.4.1      \r\n#> [25] stringr_1.4.0    knitr_1.28       vctrs_0.2.4      askpass_1.1     \r\n#> [29] grid_3.6.2       glue_1.4.0       reticulate_1.15  forge_0.2.0     \r\n#> [33] R6_2.4.1         processx_3.4.2   fansi_0.4.1      rmarkdown_2.1   \r\n#> [37] purrr_0.3.4      magrittr_1.5     promises_1.1.0   ps_1.3.3        \r\n#> [41] htmltools_0.4.0  ellipsis_0.3.0   assertthat_0.2.1 renv_0.9.3-58   \r\n#> [45] httpuv_1.5.2     utf8_1.1.4       stringi_1.4.6    ini_0.3.1       \r\n#> [49] openssl_1.4.1    crayon_1.3.4\r\n```\r\n\r\n</details>\r\n\r\n\r\n### Other info / logs\r\nN/A\r\n\r\n### What component(s), interfaces, languages, and integrations does this bug affect?\r\nComponents \r\n- [x] `area/artifacts`: Artifact stores and artifact logging\r\n- [x] `area/build`: Build and test infrastructure for MLflow\r\n- [ ] `area/docs`: MLflow documentation pages\r\n- [ ] `area/examples`: Example code\r\n- [x] `area/model-registry`: Model Registry service, APIs, and the fluent client calls for\r\nModel Registry\r\n- [ ] `area/models`: MLmodel format, model serialization/deserialization, flavors\r\n- [ ] `area/projects`: MLproject format, project running backends\r\n- [ ] `area/scoring`: Local serving, model deployment tools, spark UDFs\r\n- [x] `area/tracking`: Tracking Service, tracking client APIs, autologging\r\n\r\nInterface \r\n- [ ] `area/uiux`: Front-end, user experience, JavaScript, plotting\r\n- [ ] `area/docker`: Docker use across MLflow's components, such as MLflow Projects and MLflow Models\r\n- [ ] `area/sqlalchemy`: Use of SQLAlchemy in the Tracking Service or Model Registry\r\n- [ ] `area/windows`: Windows support\r\n\r\nLanguage \r\n- [x] `language/r`: R APIs and clients\r\n- [ ] `language/java`: Java APIs and clients\r\n","closed_by":{"login":"AveshCSingh","id":1208791,"node_id":"MDQ6VXNlcjEyMDg3OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1208791?v=4","gravatar_id":"","url":"https://api.github.com/users/AveshCSingh","html_url":"https://github.com/AveshCSingh","followers_url":"https://api.github.com/users/AveshCSingh/followers","following_url":"https://api.github.com/users/AveshCSingh/following{/other_user}","gists_url":"https://api.github.com/users/AveshCSingh/gists{/gist_id}","starred_url":"https://api.github.com/users/AveshCSingh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AveshCSingh/subscriptions","organizations_url":"https://api.github.com/users/AveshCSingh/orgs","repos_url":"https://api.github.com/users/AveshCSingh/repos","events_url":"https://api.github.com/users/AveshCSingh/events{/privacy}","received_events_url":"https://api.github.com/users/AveshCSingh/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2801/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/2801/timeline","performed_via_github_app":null,"state_reason":"completed"}