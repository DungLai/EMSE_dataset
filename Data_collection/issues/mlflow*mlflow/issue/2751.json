{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2751","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/2751/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/2751/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/2751/events","html_url":"https://github.com/mlflow/mlflow/issues/2751","id":607112035,"node_id":"MDU6SXNzdWU2MDcxMTIwMzU=","number":2751,"title":"[FR] API for querying JSON to support custom plots via Vega-Lite","user":{"login":"tbenst","id":863327,"node_id":"MDQ6VXNlcjg2MzMyNw==","avatar_url":"https://avatars.githubusercontent.com/u/863327?v=4","gravatar_id":"","url":"https://api.github.com/users/tbenst","html_url":"https://github.com/tbenst","followers_url":"https://api.github.com/users/tbenst/followers","following_url":"https://api.github.com/users/tbenst/following{/other_user}","gists_url":"https://api.github.com/users/tbenst/gists{/gist_id}","starred_url":"https://api.github.com/users/tbenst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbenst/subscriptions","organizations_url":"https://api.github.com/users/tbenst/orgs","repos_url":"https://api.github.com/users/tbenst/repos","events_url":"https://api.github.com/users/tbenst/events{/privacy}","received_events_url":"https://api.github.com/users/tbenst/received_events","type":"User","site_admin":false},"labels":[{"id":955449434,"node_id":"MDU6TGFiZWw5NTU0NDk0MzQ=","url":"https://api.github.com/repos/mlflow/mlflow/labels/enhancement","name":"enhancement","color":"a2eeef","default":true,"description":"New feature or request"},{"id":1470945519,"node_id":"MDU6TGFiZWwxNDcwOTQ1NTE5","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/uiux","name":"area/uiux","color":"ede978","default":false,"description":"Front-end, user experience, plotting, JavaScript, JavaScript dev server"},{"id":1893057631,"node_id":"MDU6TGFiZWwxODkzMDU3NjMx","url":"https://api.github.com/repos/mlflow/mlflow/labels/Acknowledged","name":"Acknowledged","color":"f9d0c4","default":false,"description":"This issue has been read and acknowledged by the MLflow admins."},{"id":2022849295,"node_id":"MDU6TGFiZWwyMDIyODQ5Mjk1","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/tracking","name":"area/tracking","color":"48eabc","default":false,"description":"Tracking service, tracking client APIs, autologging"},{"id":2022865338,"node_id":"MDU6TGFiZWwyMDIyODY1MzM4","url":"https://api.github.com/repos/mlflow/mlflow/labels/priority/important-longterm","name":"priority/important-longterm","color":"534cb5","default":false,"description":"Important over the long term, but may not be staffed or may need multiple releases to complete."}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-04-26T20:59:23Z","updated_at":"2022-11-25T07:31:59Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"## Willingness to contribute\r\nThe MLflow Community encourages new feature contributions. Would you or another member of your organization be willing to contribute an implementation of this feature (either as an MLflow Plugin or an enhancement to the MLflow code base)?\r\n\r\n- [ ] Yes. I can contribute this feature independently.\r\n- [X] Yes. I would be willing to contribute this feature with guidance from the MLflow community.\r\n- [ ] No. I cannot contribute this feature at this time.\r\n\r\n## Proposal Summary\r\n\r\n[Vega-lite](https://vega.github.io/vega-lite/) is rapidly becoming the de-facto standard for cross-language graphing, and it's spec is ideal for the frontend as it is just JSON.\r\n\r\nI propose that MLFlow add support for the following:\r\n1. API to obtain JSON containing metrics / parameters for runs in tabular form that is compatible with [Vega-Lite datasets](https://vega.github.io/vega-lite/docs/data.html)\r\n2. custom plots in the UI via a Vega-Lite _template_. This builds on the previous bullet to allow the user to write standard Vega-Lite and produce a vast array of possible plots.\r\n\r\n## Motivation\r\n- What is the use case for this feature? **To allow users to customize the UI through custom plots of metrics/parameters/comparisons**\r\n- Why is this use case valuable to support for MLflow users in general? **Many users would benefit from seeing a plot that is important to their use case but too specific for the general userbase to be included as a standard feature.**\r\n- Why is this use case valuable to support for your project(s) or organization? **Rapid creation of visualizations is a crucial component for Data Science. Right now, producing custom charts requires multiple API calls + lots of data munging.**\r\n- Why is it currently difficult to achieve this use case? (please be as specific as possible about why related MLflow features and components are insufficient) **Currently, producing custom plots in the UI requires forking MLflow**\r\n\r\n## Which MLflow component(s) does this feature affect?\r\n\r\n- [X] UI\r\n- [ ] Command Line Interface\r\n- [X] API\r\n- [ ] Examples\r\n- [ ] Docs\r\n- [ ] Tracking\r\n- [ ] Projects\r\n- [ ] Artifacts\r\n- [ ] Models\r\n- [ ] Model Registry\r\n- [ ] Scoring\r\n- [ ] R\r\n- [ ] Java\r\n- [ ] Python\r\n\r\n## Details\r\n### Request\r\nendpoint: `2.0/mlflow/data/get` HTTP Method: `GET`\r\n\r\n| Field Name  | Type                   | Description                        |\r\n|-------------|------------------------|------------------------------------|\r\n| experiments | An array of Experiment | Pass the run_ids you want data for |\r\n\r\n### Response\r\nJSON array of each observation (per [Tidy Data](https://vita.had.co.nz/papers/tidy-data.pdf)): [example response](https://gist.githubusercontent.com/tbenst/b03a5abc3d728aaf19cb520c03e94812/raw/6dc8e2acfc5d72ba6f450d8e725ab34d76af0b76/two-mlflow-runs.json).\r\n\r\n\r\n### Example plot template\r\n```json\r\n{\r\n  \"data\": {\r\n    \"url\": \"https://gist.githubusercontent.com/tbenst/b03a5abc3d728aaf19cb520c03e94812/raw/6dc8e2acfc5d72ba6f450d8e725ab34d76af0b76/two-mlflow-runs.json\"  \r\n},\r\n  \"mark\": {\r\n    \"type\": \"line\",\r\n    \"point\": true\r\n  },\r\n  \"encoding\": {\r\n    \"x\": {\"field\": \"step\", \"type\": \"quantitative\"},\r\n    \"y\": {\"field\": \"value\", \"type\": \"quantitative\"},\r\n    \"column\": {\"field\": \"metric\", \"type\": \"nominal\"},\r\n    \"color\": {\"field\": \"name\", \"type\": \"nominal\"}\r\n  }\r\n}\r\n```\r\n![visualization (1)](https://user-images.githubusercontent.com/863327/80319066-37a2a580-87c3-11ea-9f07-bbc2d5af5a92.png)\r\n\r\n### Response spec\r\n- each observation of a metric is its own row\r\n- each row contains all `run` parameters\r\n\r\nWhile this duplicates information, it vastly simplifies plotting. Suppose I want to plot by batch_size instead. It's a one-word switch: [try vega online editor](https://vega.github.io/editor/#/url/vega-lite/N4KABGBEAmCGAutIC4yghSBXATgGxSgAt54AHAZ2QHpqBzASwvgDpH4isAjLCgUxwBjAPYA7eH3EsRAW2rwuk5tS4AGAMywArLC6D10AOwAmAByxYAMwCMATkFctx1YI19bAFlPXj1HLAB3anVTLlszLS4uaHVbaw1oaAA2Y2S+U0NYPnctWNtoLVUuUK5LeQDhAFoZPEs8YQDKnCxRChYAKwoxSHAwAF8AGl7IGVgcAGtCdAxIeABPMj5CSDwGUSWhjCgyYTX4Qnhmvl7B4ckRaDW6Kd7MAA8pyEsGPjxoZeY+MkgBqHnF5YARywsHEDEQ8AYADclqctpA5o9nq93qhIFDYHgsBs-gslmjgaDIRDobDNjMRFiZKIkS83ssZHxDgxBD9cQC0aJhDI1pjIHCKcJ6jhaSjllwEIIiAB9CgMABeONmeOWXJ5oj5fROIC1QA).\r\n\r\n### But mlflow can already do these plots!\r\nFirst of all, can only do one at a time not Facet plots and also there's far more customization available in Vega-Lite. Furthermore, there are [many more plots that vega-lite would enable](https://vega.github.io/vega-lite/examples/).\r\n\r\n## Related issues that this solves or partially solves\r\nhttps://github.com/mlflow/mlflow/issues/2440 https://github.com/mlflow/mlflow/issues/1806 https://github.com/mlflow/mlflow/issues/2719 https://github.com/mlflow/mlflow/issues/2279 ","closed_by":null,"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2751/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/2751/timeline","performed_via_github_app":null,"state_reason":null}