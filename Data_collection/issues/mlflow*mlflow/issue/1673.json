{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1673","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/1673/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/1673/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/1673/events","html_url":"https://github.com/mlflow/mlflow/issues/1673","id":473752406,"node_id":"MDU6SXNzdWU0NzM3NTI0MDY=","number":1673,"title":"[BUG]There is no problem with data input, but why is it wrong with \"ValueError: setting an array element with a sequence\" ?","user":{"login":"lyw615","id":32604809,"node_id":"MDQ6VXNlcjMyNjA0ODA5","avatar_url":"https://avatars.githubusercontent.com/u/32604809?v=4","gravatar_id":"","url":"https://api.github.com/users/lyw615","html_url":"https://github.com/lyw615","followers_url":"https://api.github.com/users/lyw615/followers","following_url":"https://api.github.com/users/lyw615/following{/other_user}","gists_url":"https://api.github.com/users/lyw615/gists{/gist_id}","starred_url":"https://api.github.com/users/lyw615/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lyw615/subscriptions","organizations_url":"https://api.github.com/users/lyw615/orgs","repos_url":"https://api.github.com/users/lyw615/repos","events_url":"https://api.github.com/users/lyw615/events{/privacy}","received_events_url":"https://api.github.com/users/lyw615/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1554650079,"node_id":"MDU6TGFiZWwxNTU0NjUwMDc5","url":"https://api.github.com/repos/mlflow/mlflow/labels/stale","name":"stale","color":"828282","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-07-28T14:53:25Z","updated_at":"2019-11-12T18:49:44Z","closed_at":"2019-11-12T18:49:44Z","author_association":"NONE","active_lock_reason":null,"body":"Please do not delete this template unless you are sure your issue is outside its scope.\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in MLflow)**:\r\n- **OS Platform and Distribution :  docker of Linux Ubuntu 16.04)\r\n- **MLflow installed from (source or binary)**: \r\n- **MLflow version (run ``mlflow --version``)**:1.0.0\r\n- **Python version**: 3.7\r\n- **npm version, if running the dev UI**:\r\n- **Exact command to reproduce**: curl -XPOST -H 'Content-Type:application/json; format=pandas-records' http://127.0.0.1:8080/invocations -d@/usr/share/sig.json\r\n\r\n### Describe the problem\r\nAfter deploying the trained model as docker, input the data into the model through the above curl command, but get an error.I have checked this error as if the shape of the input data is wrong, but I checked that the input and output of the model is the same as what I set, and the input data is as expected.\r\n### Code to reproduce issue\r\nThere is no code only command, because I haven't found mlflow in the docker to predict how to call with code. If you can teach how to call this, that would be great.\r\n`Command:curl -XPOST -H 'Content-Type:application/json; format=pandas-records' http://127.0.0.1:8080/invocations -d@/usr/share/sig.json`\r\n### Other info / logs\r\nThe shape of the input data is consistent with the input of the model.\r\n`\r\n>>> import numpy as np\r\n>>> import json\r\n>>> with open('/usr/share/sig.json','r') as load_f:\r\n...     load_r=json.load(load_f)\r\n... \r\n>>> load_dic=np.array(load_r[\"input_x\"])\r\n>>> print(load_dic.shape)\r\n(1, 512, 512, 3)\r\n`\r\n\r\nFull traceback:\r\n\r\n`root@39e0d98bf26a:/opt/mlflow# curl -XPOST -H 'Content-Type:application/json; format=pandas-records' http://127.0.0.1:8080/invocations -d@/usr/share/sig.json\r\n{\"error_code\": \"BAD_REQUEST\", \"message\": \"Encountered an unexpected error while evaluating the model. Verify that the serialized input Dataframe is compatible with the model for inference.\", \"stack_trace\": \"Traceback (most recent call last):\\n  File \\\"/miniconda/envs/custom_env/lib/python3.6/site-packages/mlflow/pyfunc/scoring_server/__init__.py\\\", line 169, in transformation\\n    raw_predictions = model.predict(data)\\n  File \\\"/miniconda/envs/custom_env/lib/python3.6/site-packages/mlflow/tensorflow.py\\\", line 333, in predict\\n    raw_preds = self.tf_sess.run(self.output_tensors, feed_dict=feed_dict)\\n  File \\\"/miniconda/envs/custom_env/lib/python3.6/site-packages/tensorflow/python/client/session.py\\\", line 895, in run\\n    run_metadata_ptr)\\n  File \\\"/miniconda/envs/custom_env/lib/python3.6/site-packages/tensorflow/python/client/session.py\\\", line 1093, in _run\\n    np_val = np.asarray(subfeed_val, dtype=subfeed_dtype)\\n  File \\\"/miniconda/envs/custom_env/lib/python3.6/site-packages/numpy/core/numeric.py\\\", line 538, in asarray\\n    return array(a, dtype, copy=False, order=order)\\nValueError: setting an array element with a sequence.\\n\"}root@39e0d98bf26a:/opt/mlflow# \r\n`\r\n\r\n","closed_by":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1673/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/1673/timeline","performed_via_github_app":null,"state_reason":"completed"}