{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2887","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/2887/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/2887/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/2887/events","html_url":"https://github.com/mlflow/mlflow/issues/2887","id":626396564,"node_id":"MDU6SXNzdWU2MjYzOTY1NjQ=","number":2887,"title":"[BUG] Run fails if set_experiment() is used in the code","user":{"login":"egusev","id":19807725,"node_id":"MDQ6VXNlcjE5ODA3NzI1","avatar_url":"https://avatars.githubusercontent.com/u/19807725?v=4","gravatar_id":"","url":"https://api.github.com/users/egusev","html_url":"https://github.com/egusev","followers_url":"https://api.github.com/users/egusev/followers","following_url":"https://api.github.com/users/egusev/following{/other_user}","gists_url":"https://api.github.com/users/egusev/gists{/gist_id}","starred_url":"https://api.github.com/users/egusev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/egusev/subscriptions","organizations_url":"https://api.github.com/users/egusev/orgs","repos_url":"https://api.github.com/users/egusev/repos","events_url":"https://api.github.com/users/egusev/events{/privacy}","received_events_url":"https://api.github.com/users/egusev/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-05-28T10:25:11Z","updated_at":"2020-05-28T23:52:18Z","closed_at":"2020-05-28T23:52:18Z","author_association":"NONE","active_lock_reason":null,"body":"**Please fill in this bug report template to ensure a timely and thorough response.**\r\n\r\n### Willingness to contribute\r\nThe MLflow Community encourages bug fix contributions. Would you or another member of your organization be willing to contribute a fix for this bug to the MLflow code base?\r\n\r\n- [ ] Yes. I can contribute a fix for this bug independently.\r\n- [ ] Yes. I would be willing to contribute a fix for this bug with guidance from the MLflow community.\r\n- [*] No. I cannot contribute a bug fix at this time.\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in MLflow)**: no + use the provided example from `examples/tensorflow/tf2`\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: `Ubuntu 18.04.4 LTS` `Linux gpu-host1 4.15.0-91-generic #92-Ubuntu SMP Fri Feb 28 11:09:48 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux`\r\n- **MLflow installed from (source or binary)**: binary\r\n- **MLflow version (run ``mlflow --version``)**:  `mlflow, version 1.8.0`\r\n- **Python version**: `Python 3.7.7`\r\n- **npm version, if running the dev UI**: n/a\r\n- **Exact command to reproduce**: `mlflow run .`\r\n\r\n### Describe the problem\r\nmlflow cli run starts failing once I have set an experiment name in the code\r\n\r\n### Code to reproduce issue\r\nI have used example for tensorflow 2 by adding this line: \r\n`mlflow.set_experiment(\"test\")`\r\ntried before and after `mlflow.tensorflow.autolog()` -- the same result\r\n\r\n\r\n### Other info / logs\r\nError message:\r\n\r\n```\r\nINFO: 'test' does not exist. Creating a new experiment\r\nTraceback (most recent call last):\r\n  File \"train_predict_2.py\", line 172, in <module>\r\n    main(sys.argv)\r\n  File \"train_predict_2.py\", line 75, in main\r\n    with mlflow.start_run():\r\n  File \"/home/users/eugene/.conda/envs/mlflow-abcd0c6f7d0b18ba2cbd2defa219b14e8100f8a8/lib/python3.6/site-packages/mlflow/tracking/fluent.py\", line 130, in start_run\r\n    \"arguments\".format(existing_run_id))\r\nmlflow.exceptions.MlflowException: Cannot start run with ID 49e3c3217f274f40837484841e794090 because active run ID does not match environment run ID. Make sure --experiment-name or --experiment-id matches experiment set with set_experiment(), or just use command-line arguments\r\n2020/05/28 13:12:42 ERROR mlflow.cli: === Run (ID '49e3c3217f274f40837484841e794090') failed ===\r\n```\r\n\r\nActually it would be awesome to have a priority list for the experiment name something like that:\r\n1. run parameter (-experiment-name)\r\n2. (it seems it is a feature request) a parameter of entry_point in MLproject\r\n3. environment variable (MLFLOW_EXPERIMENT_NAME)\r\n4. `mlflow.set_experiment` method","closed_by":{"login":"dmatrix","id":1117597,"node_id":"MDQ6VXNlcjExMTc1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1117597?v=4","gravatar_id":"","url":"https://api.github.com/users/dmatrix","html_url":"https://github.com/dmatrix","followers_url":"https://api.github.com/users/dmatrix/followers","following_url":"https://api.github.com/users/dmatrix/following{/other_user}","gists_url":"https://api.github.com/users/dmatrix/gists{/gist_id}","starred_url":"https://api.github.com/users/dmatrix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmatrix/subscriptions","organizations_url":"https://api.github.com/users/dmatrix/orgs","repos_url":"https://api.github.com/users/dmatrix/repos","events_url":"https://api.github.com/users/dmatrix/events{/privacy}","received_events_url":"https://api.github.com/users/dmatrix/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/2887/timeline","performed_via_github_app":null,"state_reason":"completed"}