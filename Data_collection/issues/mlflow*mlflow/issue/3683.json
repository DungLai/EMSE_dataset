{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3683","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/3683/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/3683/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/3683/events","html_url":"https://github.com/mlflow/mlflow/issues/3683","id":742356847,"node_id":"MDU6SXNzdWU3NDIzNTY4NDc=","number":3683,"title":"Served Scikit-learn mlflow pyfunc model not consumable for arbitrary number of rows in the input via the served endpoint","user":{"login":"KarimSamehSadek","id":6054368,"node_id":"MDQ6VXNlcjYwNTQzNjg=","avatar_url":"https://avatars.githubusercontent.com/u/6054368?v=4","gravatar_id":"","url":"https://api.github.com/users/KarimSamehSadek","html_url":"https://github.com/KarimSamehSadek","followers_url":"https://api.github.com/users/KarimSamehSadek/followers","following_url":"https://api.github.com/users/KarimSamehSadek/following{/other_user}","gists_url":"https://api.github.com/users/KarimSamehSadek/gists{/gist_id}","starred_url":"https://api.github.com/users/KarimSamehSadek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KarimSamehSadek/subscriptions","organizations_url":"https://api.github.com/users/KarimSamehSadek/orgs","repos_url":"https://api.github.com/users/KarimSamehSadek/repos","events_url":"https://api.github.com/users/KarimSamehSadek/events{/privacy}","received_events_url":"https://api.github.com/users/KarimSamehSadek/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":2022848043,"node_id":"MDU6TGFiZWwyMDIyODQ4MDQz","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/models","name":"area/models","color":"48eabc","default":false,"description":"MLmodel format, model serialization/deserialization, flavors"},{"id":2022848902,"node_id":"MDU6TGFiZWwyMDIyODQ4OTAy","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/scoring","name":"area/scoring","color":"48eabc","default":false,"description":"MLflow Model server, model deployment tools, Spark UDFs"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-11-13T10:47:55Z","updated_at":"2021-07-30T17:36:05Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Model serving for a Scikit-learn Linear Regression Model deployed through MLFLOW'S PyFunc works normally only for up to 75 records per request. If the input exceeds this threshold, we receive an empty reply from server, with error code 52. The error is based on the size of the request and not on a specific data/data quality.\r\n\r\n# Expected behavior\r\n\r\nThe served model implementation does not make any assumptions about input size and thus mlflow should allow to process an arbitrary number of rows in the input via the served endpoint.\r\n\r\n## How to reproduce?\r\n\r\n```\r\nHOSTNAME=localhost\r\n\r\n## prepare model (See attached python script prepare_mlflow_model.py)\r\nexport MODEL_NAME=test_model\r\npython3 prepare_mlflow_model.py\r\n\r\n## Serve the model\r\nmlflow models serve -m ${MODEL_NAME} --host 0.0.0.0 --port 5110  &\r\n\r\n## Consume the model with a simple one-row record \r\ncurl http://${HOSTNAME}:5110/invocations -H 'Content-Type: application/json' -d '{\"columns\":[\"Operation\",\"-7\",\"-6\",\"-5\",\"-4\",\"-3\",\"-2\",\"-1\",\"0\"],\"data\":[[\"A0208\",24.0,24.0,24.0,24.0,24.0,24.0,24.0,4.6]]}'\r\n\r\n## consume same model but with many records --> this fails\r\ncat 480_api_record_example.json | curl http://${HOSTNAME}:5110/invocations -H 'Content-Type: application/json' -d @-\r\n```\r\n\r\n### What component(s), interfaces, languages, and integrations does this bug affect?\r\n\r\n- [x] `area/models`: MLmodel format, model serialization/deserialization, flavors\r\n- [x] `area/scoring`: Local serving, model deployment tools, spark UDFs\r\n\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in MLflow)**:\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 20.04 LTS\r\n- **MLflow installed from (source or binary)**: source\r\n\r\n\r\n\r\n- **MLflow version (run ``mlflow --version``)**: 1.10\r\n- **Python version**: 3.8.5\r\n[JSON INPUT.txt](https://github.com/mlflow/mlflow/files/5536400/JSON.INPUT.txt)\r\n[mlflow model py script.txt](https://github.com/mlflow/mlflow/files/5536407/mlflow.model.py.script.txt)\r\n\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/3683/timeline","performed_via_github_app":null,"state_reason":null}