{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3734","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/3734/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/3734/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/3734/events","html_url":"https://github.com/mlflow/mlflow/issues/3734","id":749904841,"node_id":"MDU6SXNzdWU3NDk5MDQ4NDE=","number":3734,"title":"[Help] Putting model dependent mlflow code into the model class","user":{"login":"pietz","id":13137132,"node_id":"MDQ6VXNlcjEzMTM3MTMy","avatar_url":"https://avatars.githubusercontent.com/u/13137132?v=4","gravatar_id":"","url":"https://api.github.com/users/pietz","html_url":"https://github.com/pietz","followers_url":"https://api.github.com/users/pietz/followers","following_url":"https://api.github.com/users/pietz/following{/other_user}","gists_url":"https://api.github.com/users/pietz/gists{/gist_id}","starred_url":"https://api.github.com/users/pietz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pietz/subscriptions","organizations_url":"https://api.github.com/users/pietz/orgs","repos_url":"https://api.github.com/users/pietz/repos","events_url":"https://api.github.com/users/pietz/events{/privacy}","received_events_url":"https://api.github.com/users/pietz/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-11-24T17:29:36Z","updated_at":"2020-11-25T19:47:21Z","closed_at":"2020-11-25T19:24:48Z","author_association":"NONE","active_lock_reason":null,"body":"_I'm starting a discussion here because the databricks mlflow forum doesn't seem to be very active._\r\n\r\nI'm working with a large hierarchy of different models and parameters, which all extend a `BaseModel` class that I defined. I want to put as much mlflow related code into the specific model classes, so I don't have to deal with it from the outside. It seems to me this is an approach that mlflow doesn't really motivate. All examples I've looked at do all their `mlflow.log...` calls from the outside.\r\n\r\nWhy is that?\r\n\r\nThe OCD programmer voice in my head wants to put logging calls related to a model into the model definition. No matter how helpful mlflow is, I want to deal with it as little as possible. Looking at the examples mlflow encourages this code style:\r\n\r\n```\r\nexp_id = mlflow.create_experiment('Test')\r\np = Prophet()\r\nmlflow.start_run(experiment_id=exp_id)\r\nmlflow.log_param('ProphetModel')\r\nmlflow.log_param('log_scale', log_scale)\r\np.fit(df1)\r\nmae = calc_mae(gt, p.predict(df2)\r\nmlflow.log_metric('MAE', mae)\r\nmlflow.pyfunc.log_model('Prophet' python_model=ProphetWrapper(p))\r\nmlflow.end_run()\r\n# do this for all other models\r\n```\r\n\r\nFrom the outside it seems much nicer to do:\r\n\r\n```\r\nexp_id = mlflow.create_experiment('Test')\r\nProphetModel(exp_id, log_scale).fit_evaluate(df, tr_cutoff)\r\n# do this for all other models\r\n```\r\n\r\nI mean, my version doesn't get rid of the code but it places the model dependent code where the model is.\r\n\r\nWhat would be downsides of my approach and do you know any reference projects that support this style of code structure?\r\n\r\nThank you","closed_by":{"login":"pietz","id":13137132,"node_id":"MDQ6VXNlcjEzMTM3MTMy","avatar_url":"https://avatars.githubusercontent.com/u/13137132?v=4","gravatar_id":"","url":"https://api.github.com/users/pietz","html_url":"https://github.com/pietz","followers_url":"https://api.github.com/users/pietz/followers","following_url":"https://api.github.com/users/pietz/following{/other_user}","gists_url":"https://api.github.com/users/pietz/gists{/gist_id}","starred_url":"https://api.github.com/users/pietz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pietz/subscriptions","organizations_url":"https://api.github.com/users/pietz/orgs","repos_url":"https://api.github.com/users/pietz/repos","events_url":"https://api.github.com/users/pietz/events{/privacy}","received_events_url":"https://api.github.com/users/pietz/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/3734/timeline","performed_via_github_app":null,"state_reason":"completed"}