{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1262","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/1262/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/1262/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/1262/events","html_url":"https://github.com/mlflow/mlflow/issues/1262","id":443745440,"node_id":"MDU6SXNzdWU0NDM3NDU0NDA=","number":1262,"title":"MLFlow runs are not recorded in database and artifact location ?","user":{"login":"asraful","id":284564,"node_id":"MDQ6VXNlcjI4NDU2NA==","avatar_url":"https://avatars.githubusercontent.com/u/284564?v=4","gravatar_id":"","url":"https://api.github.com/users/asraful","html_url":"https://github.com/asraful","followers_url":"https://api.github.com/users/asraful/followers","following_url":"https://api.github.com/users/asraful/following{/other_user}","gists_url":"https://api.github.com/users/asraful/gists{/gist_id}","starred_url":"https://api.github.com/users/asraful/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asraful/subscriptions","organizations_url":"https://api.github.com/users/asraful/orgs","repos_url":"https://api.github.com/users/asraful/repos","events_url":"https://api.github.com/users/asraful/events{/privacy}","received_events_url":"https://api.github.com/users/asraful/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-05-14T07:08:10Z","updated_at":"2019-05-20T12:04:36Z","closed_at":"2019-05-20T12:04:35Z","author_association":"NONE","active_lock_reason":null,"body":"\r\nSetup # OS : ubuntu 18.04 LTS\r\n\r\nmysql Ver 14.14 Distrib 5.7.26, for Linux (x86_64) using EditLine wrapper\r\n\r\n(Installed bellow dependency also : sudo apt-get install libmysqlclient-dev sudo pip3 install mysqlclient conda install -c anaconda sqlalchemy )\r\n\r\nPython 3.7.3\r\n\r\nSteps i followed #\r\n\r\nCreated database there named # mlflow_tracker\r\n\r\nNow i tried to start MlFlow server as \"\r\n\r\n(base) asraful@asraful:~$ conda activate my_env\r\n\r\n(my_env) asraful@asraful:~$ mlflow server  --backend-store-uri \"mysql://mlflow:password@localhost:3306/mlflow_tracker\"  --default-artifact-root /mnt/mlflow_bucket  --host 0.0.0.0\r\nThis is giving output as #\r\n\r\n[2019-05-14 01:49:56 +0600] [9976] [INFO] Starting gunicorn 19.9.0\r\n[2019-05-14 01:49:56 +0600] [9976] [INFO] Listening at: http://0.0.0.0:5000 (9976)\r\n[2019-05-14 01:49:56 +0600] [9976] [INFO] Using worker: sync\r\n[2019-05-14 01:49:56 +0600] [9979] [INFO] Booting worker with pid: 9979\r\n[2019-05-14 01:49:56 +0600] [9980] [INFO] Booting worker with pid: 9980\r\n[2019-05-14 01:49:56 +0600] [9981] [INFO] Booting worker with pid: 9981\r\n[2019-05-14 01:49:56 +0600] [9989] [INFO] Booting worker with pid: 9989\r\nTherefor i tried to do one test run using bellow script #\r\n\r\n```\r\nimport os\r\nfrom mlflow import log_metric, log_param, log_artifact\r\n\r\nif __name__ == \"__main__\":\r\n    # Log a parameter (key-value pair)\r\n    log_param(\"param1\", 5)\r\n\r\n    # Log a metric; metrics can be updated throughout the run\r\n    log_metric(\"foo\", 1)\r\n    log_metric(\"foo\", 2)\r\n    log_metric(\"foo\", 3)\r\n\r\n    # Log an artifact (output file)\r\n    with open(\"output.txt\", \"w\") as f:\r\n        f.write(\"Hello world!\")\r\n    log_artifact(\"output.txt\")\r\nThis code runs perfectly .\r\n```\r\n\r\nTherefor my expectation is :\r\n\r\nMetric will be saved in mlflow_tracker database . Other data will be saved under /mnt/mlflow_bucket\r\n\r\nAs i configured backend-store-uri as : mlflow_tracker database And default-artifact-root : /mnt/mlflow_bucket\r\n\r\nBut facing issues as #\r\n\r\nall metric and metadata are writing under default mlflow location : /~/mlFlow/mlruns/0\r\n\r\nAnd, if i try to access mlflow ui from brower getting defualt image and bellow stack trace .\r\n\r\nTraceback (most recent call last):\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2262, in _wrap_pool_connect\r\nreturn fn()\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 363, in connect\r\nreturn _ConnectionFairy._checkout(self)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 760, in _checkout\r\nfairy = _ConnectionRecord.checkout(pool)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 492, in checkout\r\nrec = pool._do_get()\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/impl.py\", line 139, in _do_get\r\nself._dec_overflow()\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 68, in __exit__\r\ncompat.reraise(exc_type, exc_value, exc_tb)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 129, in reraise\r\nraise value\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/impl.py\", line 136, in _do_get\r\nreturn self._create_connection()\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 308, in _create_connection\r\nreturn _ConnectionRecord(self)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 437, in __init__\r\nself.__connect(first_connect_check=True)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 639, in __connect\r\nconnection = pool._invoke_creator(self)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py\", line 114, in connect\r\nreturn dialect.connect(*cargs, **cparams)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 453, in connect\r\nreturn self.dbapi.connect(*cargs, **cparams)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/MySQLdb/__init__.py\", line 84, in Connect\r\nreturn Connection(*args, **kwargs)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/MySQLdb/connections.py\", line 164, in __init__\r\nsuper(Connection, self).__init__(*args, **kwargs2)\r\nMySQLdb._exceptions.OperationalError: (2002, \"Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2)\")\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/flask/app.py\", line 2292, in wsgi_app\r\nresponse = self.full_dispatch_request()\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/flask/app.py\", line 1815, in full_dispatch_request\r\nrv = self.handle_user_exception(e)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/flask/app.py\", line 1718, in handle_user_exception\r\nreraise(exc_type, exc_value, tb)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/flask/_compat.py\", line 35, in reraise\r\nraise value\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/flask/app.py\", line 1813, in full_dispatch_request\r\nrv = self.dispatch_request()\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/flask/app.py\", line 1799, in dispatch_request\r\nreturn self.view_functions[rule.endpoint](**req.view_args)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/mlflow/server/handlers.py\", line 81, in wrapper\r\nreturn func(*args, **kwargs)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/mlflow/server/handlers.py\", line 326, in _list_experiments\r\nexperiment_entities = _get_store().list_experiments(request_message.view_type)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/mlflow/server/handlers.py\", line 35, in _get_store\r\nreturn SqlAlchemyStore(store_dir, artifact_root)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/mlflow/store/sqlalchemy_store.py\", line 58, in __init__\r\nBase.metadata.create_all(self.engine)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/sql/schema.py\", line 4287, in create_all\r\nddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2032, in _run_visitor\r\nwith self._optional_conn_ctx_manager(connection) as conn:\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/contextlib.py\", line 112, in __enter__\r\nreturn next(self.gen)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2024, in _optional_conn_ctx_manager\r\nwith self._contextual_connect() as conn:\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2226, in _contextual_connect\r\nself._wrap_pool_connect(self.pool.connect, None),\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2266, in _wrap_pool_connect\r\ne, dialect, self\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1536, in _handle_dbapi_exception_noconnection\r\nutil.raise_from_cause(sqlalchemy_exception, exc_info)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 383, in raise_from_cause\r\nreraise(type(exception), exception, tb=exc_tb, cause=cause)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 128, in reraise\r\nraise value.with_traceback(tb)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2262, in _wrap_pool_connect\r\nreturn fn()\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 363, in connect\r\nreturn _ConnectionFairy._checkout(self)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 760, in _checkout\r\nfairy = _ConnectionRecord.checkout(pool)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 492, in checkout\r\nrec = pool._do_get()\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/impl.py\", line 139, in _do_get\r\nself._dec_overflow()\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 68, in __exit__\r\ncompat.reraise(exc_type, exc_value, exc_tb)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 129, in reraise\r\nraise value\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/impl.py\", line 136, in _do_get\r\nreturn self._create_connection()\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 308, in _create_connection\r\nreturn _ConnectionRecord(self)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 437, in __init__\r\nself.__connect(first_connect_check=True)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 639, in __connect\r\nconnection = pool._invoke_creator(self)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py\", line 114, in connect\r\nreturn dialect.connect(*cargs, **cparams)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 453, in connect\r\nreturn self.dbapi.connect(*cargs, **cparams)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/MySQLdb/__init__.py\", line 84, in Connect\r\nreturn Connection(*args, **kwargs)\r\nFile \"/home/asraful/anaconda3/envs/my_env/lib/python3.7/site-packages/MySQLdb/connections.py\", line 164, in __init__\r\nsuper(Connection, self).__init__(*args, **kwargs2)\r\nsqlalchemy.exc.OperationalError: (MySQLdb._exceptions.OperationalError) (2002, \"Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2)\")\r\n(Background on this error at: http://sqlalche.me/e/e3q8)\r\nMy question is :\r\n\r\nWhat i am missing here ? What could be the possible solution for this ?","closed_by":{"login":"asraful","id":284564,"node_id":"MDQ6VXNlcjI4NDU2NA==","avatar_url":"https://avatars.githubusercontent.com/u/284564?v=4","gravatar_id":"","url":"https://api.github.com/users/asraful","html_url":"https://github.com/asraful","followers_url":"https://api.github.com/users/asraful/followers","following_url":"https://api.github.com/users/asraful/following{/other_user}","gists_url":"https://api.github.com/users/asraful/gists{/gist_id}","starred_url":"https://api.github.com/users/asraful/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asraful/subscriptions","organizations_url":"https://api.github.com/users/asraful/orgs","repos_url":"https://api.github.com/users/asraful/repos","events_url":"https://api.github.com/users/asraful/events{/privacy}","received_events_url":"https://api.github.com/users/asraful/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1262/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/1262/timeline","performed_via_github_app":null,"state_reason":"completed"}