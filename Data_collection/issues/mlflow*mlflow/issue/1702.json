{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1702","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/1702/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/1702/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/1702/events","html_url":"https://github.com/mlflow/mlflow/issues/1702","id":477355376,"node_id":"MDU6SXNzdWU0NzczNTUzNzY=","number":1702,"title":"[Question] Question regarding the implementation of PyTorchWrapper","user":{"login":"thomasryck","id":37658138,"node_id":"MDQ6VXNlcjM3NjU4MTM4","avatar_url":"https://avatars.githubusercontent.com/u/37658138?v=4","gravatar_id":"","url":"https://api.github.com/users/thomasryck","html_url":"https://github.com/thomasryck","followers_url":"https://api.github.com/users/thomasryck/followers","following_url":"https://api.github.com/users/thomasryck/following{/other_user}","gists_url":"https://api.github.com/users/thomasryck/gists{/gist_id}","starred_url":"https://api.github.com/users/thomasryck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomasryck/subscriptions","organizations_url":"https://api.github.com/users/thomasryck/orgs","repos_url":"https://api.github.com/users/thomasryck/repos","events_url":"https://api.github.com/users/thomasryck/events{/privacy}","received_events_url":"https://api.github.com/users/thomasryck/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1554650079,"node_id":"MDU6TGFiZWwxNTU0NjUwMDc5","url":"https://api.github.com/repos/mlflow/mlflow/labels/stale","name":"stale","color":"828282","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"smurching","id":2358483,"node_id":"MDQ6VXNlcjIzNTg0ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2358483?v=4","gravatar_id":"","url":"https://api.github.com/users/smurching","html_url":"https://github.com/smurching","followers_url":"https://api.github.com/users/smurching/followers","following_url":"https://api.github.com/users/smurching/following{/other_user}","gists_url":"https://api.github.com/users/smurching/gists{/gist_id}","starred_url":"https://api.github.com/users/smurching/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smurching/subscriptions","organizations_url":"https://api.github.com/users/smurching/orgs","repos_url":"https://api.github.com/users/smurching/repos","events_url":"https://api.github.com/users/smurching/events{/privacy}","received_events_url":"https://api.github.com/users/smurching/received_events","type":"User","site_admin":false},"assignees":[{"login":"smurching","id":2358483,"node_id":"MDQ6VXNlcjIzNTg0ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2358483?v=4","gravatar_id":"","url":"https://api.github.com/users/smurching","html_url":"https://github.com/smurching","followers_url":"https://api.github.com/users/smurching/followers","following_url":"https://api.github.com/users/smurching/following{/other_user}","gists_url":"https://api.github.com/users/smurching/gists{/gist_id}","starred_url":"https://api.github.com/users/smurching/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smurching/subscriptions","organizations_url":"https://api.github.com/users/smurching/orgs","repos_url":"https://api.github.com/users/smurching/repos","events_url":"https://api.github.com/users/smurching/events{/privacy}","received_events_url":"https://api.github.com/users/smurching/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2019-08-06T12:37:23Z","updated_at":"2019-11-12T18:49:46Z","closed_at":"2019-11-12T18:49:46Z","author_association":"NONE","active_lock_reason":null,"body":"I have a question regarding the following line of code\r\n\r\n```\r\npredicted.index = data.index\r\n```\r\nwhich is in the init file of the pytorch module.\r\n\r\n```\r\nclass _PyTorchWrapper(object):\r\n    \"\"\"\r\n    Wrapper class that creates a predict function such that\r\n    predict(data: pd.DataFrame) -> model's output as pd.DataFrame (pandas DataFrame)\r\n    \"\"\"\r\n    def __init__(self, pytorch_model):\r\n        self.pytorch_model = pytorch_model\r\n\r\n    def predict(self, data, device='cpu'):\r\n        import torch\r\n\r\n        if not isinstance(data, pd.DataFrame):\r\n            raise TypeError(\"Input data should be pandas.DataFrame\")\r\n        self.pytorch_model.to(device)\r\n        self.pytorch_model.eval()\r\n        with torch.no_grad():\r\n            input_tensor = torch.from_numpy(data.values.astype(np.float32)).to(device)\r\n            preds = self.pytorch_model(input_tensor)\r\n            if not isinstance(preds, torch.Tensor):\r\n                raise TypeError(\"Expected PyTorch model to output a single output tensor, \"\r\n                                \"but got output of type '{}'\".format(type(preds)))\r\n            predicted = pd.DataFrame(preds.numpy())\r\n            predicted.index = data.index\r\n            return predicted\r\n\r\n```\r\n\r\nThis line of code shows implies that the input data and the output data of the network have the same indexes. However in my opinion is not the main case and the index of the prediction dataframe should be the indexes from the dataframe creation. \r\n\r\nThis line of code is not compatible with my use case. My input shape is (3, X) and output is (2, X) .\r\n\r\nCan someone explain me why the indexes are pass from input data to prediction ?","closed_by":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/1702/timeline","performed_via_github_app":null,"state_reason":"completed"}