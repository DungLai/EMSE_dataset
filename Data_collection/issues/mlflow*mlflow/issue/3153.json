{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3153","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/3153/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/3153/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/3153/events","html_url":"https://github.com/mlflow/mlflow/issues/3153","id":663645541,"node_id":"MDU6SXNzdWU2NjM2NDU1NDE=","number":3153,"title":"Problems encountered in multistep running under docker","user":{"login":"yzz-cver","id":53545589,"node_id":"MDQ6VXNlcjUzNTQ1NTg5","avatar_url":"https://avatars.githubusercontent.com/u/53545589?v=4","gravatar_id":"","url":"https://api.github.com/users/yzz-cver","html_url":"https://github.com/yzz-cver","followers_url":"https://api.github.com/users/yzz-cver/followers","following_url":"https://api.github.com/users/yzz-cver/following{/other_user}","gists_url":"https://api.github.com/users/yzz-cver/gists{/gist_id}","starred_url":"https://api.github.com/users/yzz-cver/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yzz-cver/subscriptions","organizations_url":"https://api.github.com/users/yzz-cver/orgs","repos_url":"https://api.github.com/users/yzz-cver/repos","events_url":"https://api.github.com/users/yzz-cver/events{/privacy}","received_events_url":"https://api.github.com/users/yzz-cver/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":2022851725,"node_id":"MDU6TGFiZWwyMDIyODUxNzI1","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/docker","name":"area/docker","color":"ede978","default":false,"description":"Docker use anywhere, such as MLprojects and MLmodels"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-07-22T10:16:48Z","updated_at":"2020-07-23T01:14:25Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"The following problem occurs when running the  mlflow run .   command.\r\n\r\n2020/07/22 18:07:31 INFO mlflow.projects: === Building docker image docker-example ===\r\n2020/07/22 18:07:31 INFO mlflow.projects: === Created directory /tmp/tmp20yr16p3 for downloading remote URIs passed to arguments of type 'path' ===\r\n2020/07/22 18:07:31 INFO mlflow.projects: === Running command 'docker run --rm -v /home/zyz/cphm_mlflow_sklearn_docker/mlruns:/mlflow/tmp/mlruns -v /home/zyz/cphm_mlflow_sklearn_docker/mlruns/0/3d6b35ed5605417f9cbb18311944eede/artifacts:/home/zyz/cphm_mlflow_sklearn_docker/mlruns/0/3d6b35ed5605417f9cbb18311944eede/artifacts -e MLFLOW_RUN_ID=3d6b35ed5605417f9cbb18311944eede -e MLFLOW_TRACKING_URI=file:///mlflow/tmp/mlruns -e MLFLOW_EXPERIMENT_ID=0 docker-example:latest python main.py --cphm-csv ./datasets/cd5_3x_curve_feayute_fixed.csv --split-prop 0.8 --n-neighbors 2' in run with ID '3d6b35ed5605417f9cbb18311944eede' === \r\nNo matching run has been found.\r\nLaunching new run for entrypoint=load_data and parameters={'cphm_csv': './datasets/cd5_3x_curve_feayute_fixed.csv'}\r\nTraceback (most recent call last):\r\n  File \"/opt/conda/lib/python3.6/site-packages/mlflow/projects/__init__.py\", line 578, in _validate_docker_installation\r\n    process.exec_cmd([docker_path, \"--help\"], throw_on_error=False)\r\n  File \"/opt/conda/lib/python3.6/site-packages/mlflow/utils/process.py\", line 43, in exec_cmd\r\n    cwd=cwd, universal_newlines=True, **kwargs)\r\n  File \"/opt/conda/lib/python3.6/subprocess.py\", line 709, in __init__\r\n    restore_signals, start_new_session)\r\n  File \"/opt/conda/lib/python3.6/subprocess.py\", line 1344, in _execute_child\r\n    raise child_exception_type(errno_num, err_msg, err_filename)\r\nFileNotFoundError: [Errno 2] No such file or directory: 'docker': 'docker'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"main.py\", line 98, in <module>\r\n    workflow(cphm_csv, split_prop, n_neighbors)\r\n  File \"main.py\", line 86, in workflow\r\n    load_data_run = _get_or_run(\"load_data\", {\"cphm_csv\": cphm_csv}, git_commit)\r\n  File \"main.py\", line 62, in _get_or_run\r\n    submitted_run = mlflow.run(\".\", entrypoint, parameters=parameters)\r\n  File \"/opt/conda/lib/python3.6/site-packages/mlflow/projects/__init__.py\", line 281, in run\r\n    synchronous=synchronous)\r\n  File \"/opt/conda/lib/python3.6/site-packages/mlflow/projects/__init__.py\", line 134, in _run\r\n    _validate_docker_installation()\r\n  File \"/opt/conda/lib/python3.6/site-packages/mlflow/projects/__init__.py\", line 580, in _validate_docker_installation\r\n    raise ExecutionException(\"Could not find Docker executable. \"\r\nmlflow.exceptions.ExecutionException: Could not find Docker executable. Ensure Docker is installed as per the instructions at https://docs.docker.com/install/overview/.\r\n2020/07/22 18:07:33 ERROR mlflow.cli: === Run (ID '3d6b35ed5605417f9cbb18311944eede') failed ===\r\n\r\nThen I solved the above problem with docker -v commandï¼Œbut the following problems occurred when running the mlflow run . command again\r\n\r\n2020/07/22 18:16:06 INFO mlflow.projects: === Building docker image docker-example ===\r\n2020/07/22 18:16:07 INFO mlflow.projects: === Created directory /tmp/tmpj8pfnsvn for downloading remote URIs passed to arguments of type 'path' ===\r\n2020/07/22 18:16:07 INFO mlflow.projects: === Running command 'docker run --rm -v /home/zyz/cphm_mlflow_sklearn_docker/mlruns:/mlflow/tmp/mlruns -v /home/zyz/cphm_mlflow_sklearn_docker/mlruns/0/54904d42eefb4c5089371cc255a6009e/artifacts:/home/zyz/cphm_mlflow_sklearn_docker/mlruns/0/54904d42eefb4c5089371cc255a6009e/artifacts -v /usr/bin/docker:/usr/bin/docker -v /var/run/docker.sock:/var/run/docker.sock -e MLFLOW_RUN_ID=54904d42eefb4c5089371cc255a6009e -e MLFLOW_TRACKING_URI=file:///mlflow/tmp/mlruns -e MLFLOW_EXPERIMENT_ID=0 docker-example:latest python main.py --cphm-csv ./datasets/cd5_3x_curve_feayute_fixed.csv --split-prop 0.8 --n-neighbors 2' in run with ID '54904d42eefb4c5089371cc255a6009e' === \r\nNo matching run has been found.\r\n2020/07/22 10:16:08 INFO mlflow.projects: === Building docker image docker-example ===\r\n2020/07/22 10:16:08 INFO mlflow.projects: === Created directory /tmp/tmp5__scuob for downloading remote URIs passed to arguments of type 'path' ===\r\n2020/07/22 10:16:08 INFO mlflow.projects: === Running command 'docker run --rm -v /mlflow/tmp/mlruns:/mlflow/tmp/mlruns -v /home/zyz/cphm_mlflow_sklearn_docker/mlruns/0/f4854d7936704a66bc4633e4d3035f2d/artifacts:/home/zyz/cphm_mlflow_sklearn_docker/mlruns/0/f4854d7936704a66bc4633e4d3035f2d/artifacts -v /usr/bin/docker:/usr/bin/docker -v /var/run/docker.sock:/var/run/docker.sock -e MLFLOW_RUN_ID=f4854d7936704a66bc4633e4d3035f2d -e MLFLOW_TRACKING_URI=file:///mlflow/tmp/mlruns -e MLFLOW_EXPERIMENT_ID=0 docker-example:latest python load_data.py --cphm-csv ./datasets/cd5_3x_curve_feayute_fixed.csv' in run with ID 'f4854d7936704a66bc4633e4d3035f2d' === \r\nTraceback (most recent call last):\r\n  File \"load_data.py\", line 41, in <module>\r\n    load_data(cphm_csv)\r\n  File \"load_data.py\", line 30, in load_data\r\n    with mlflow.start_run() as mlrun:\r\n  File \"/opt/conda/lib/python3.6/site-packages/mlflow/tracking/fluent.py\", line 119, in start_run\r\n    active_run_obj = MlflowClient().get_run(existing_run_id)\r\n  File \"/opt/conda/lib/python3.6/site-packages/mlflow/tracking/client.py\", line 96, in get_run\r\n    return self._tracking_client.get_run(run_id)\r\n  File \"/opt/conda/lib/python3.6/site-packages/mlflow/tracking/_tracking_service/client.py\", line 49, in get_run\r\n    return self.store.get_run(run_id)\r\n  File \"/opt/conda/lib/python3.6/site-packages/mlflow/store/tracking/file_store.py\", line 423, in get_run\r\n    run_info = self._get_run_info(run_id)\r\n  File \"/opt/conda/lib/python3.6/site-packages/mlflow/store/tracking/file_store.py\", line 442, in _get_run_info\r\n    databricks_pb2.RESOURCE_DOES_NOT_EXIST)\r\nmlflow.exceptions.MlflowException: Run 'f4854d7936704a66bc4633e4d3035f2d' not found\r\nLaunching new run for entrypoint=load_data and parameters={'cphm_csv': './datasets/cd5_3x_curve_feayute_fixed.csv'}\r\nTraceback (most recent call last):\r\n  File \"main.py\", line 98, in <module>\r\n    workflow(cphm_csv, split_prop, n_neighbors)\r\n  File \"main.py\", line 86, in workflow\r\n    load_data_run = _get_or_run(\"load_data\", {\"cphm_csv\": cphm_csv}, git_commit)\r\n  File \"main.py\", line 62, in _get_or_run\r\n    submitted_run = mlflow.run(\".\", entrypoint, parameters=parameters)\r\n  File \"/opt/conda/lib/python3.6/site-packages/mlflow/projects/__init__.py\", line 283, in run\r\n    _wait_for(submitted_run_obj)\r\n  File \"/opt/conda/lib/python3.6/site-packages/mlflow/projects/__init__.py\", line 300, in _wait_for\r\n    raise ExecutionException(\"Run (ID '%s') failed\" % run_id)\r\nmlflow.exceptions.ExecutionException: Run (ID 'f4854d7936704a66bc4633e4d3035f2d') failed\r\n2020/07/22 18:16:10 ERROR mlflow.cli: === Run (ID '54904d42eefb4c5089371cc255a6009e') failed ===\r\n\r\nCan you help me to solve this question?  Thanks!","closed_by":null,"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/3153/timeline","performed_via_github_app":null,"state_reason":null}