{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1470","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/1470/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/1470/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/1470/events","html_url":"https://github.com/mlflow/mlflow/issues/1470","id":457767595,"node_id":"MDU6SXNzdWU0NTc3Njc1OTU=","number":1470,"title":"AzureML Model Build Image Failure: ResolvePackageNotFound:- pyspark=2.4.3.dev0","user":{"login":"joshuafennessy","id":7947679,"node_id":"MDQ6VXNlcjc5NDc2Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/7947679?v=4","gravatar_id":"","url":"https://api.github.com/users/joshuafennessy","html_url":"https://github.com/joshuafennessy","followers_url":"https://api.github.com/users/joshuafennessy/followers","following_url":"https://api.github.com/users/joshuafennessy/following{/other_user}","gists_url":"https://api.github.com/users/joshuafennessy/gists{/gist_id}","starred_url":"https://api.github.com/users/joshuafennessy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshuafennessy/subscriptions","organizations_url":"https://api.github.com/users/joshuafennessy/orgs","repos_url":"https://api.github.com/users/joshuafennessy/repos","events_url":"https://api.github.com/users/joshuafennessy/events{/privacy}","received_events_url":"https://api.github.com/users/joshuafennessy/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1554650079,"node_id":"MDU6TGFiZWwxNTU0NjUwMDc5","url":"https://api.github.com/repos/mlflow/mlflow/labels/stale","name":"stale","color":"828282","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2019-06-19T01:47:22Z","updated_at":"2020-04-24T16:48:17Z","closed_at":"2019-11-12T19:50:02Z","author_association":"NONE","active_lock_reason":null,"body":"### System information\r\n\r\n- Azure Databricks Runtime 5.3 and 5.4:\r\n- MLflow installed from PyPi: \r\n- MLflow version 1.0.0:\r\n- Python version 3.5.2: \r\n\r\n### Describe the problem\r\n- I am adopting the code found in the [MLFlow Quickstart Part 2](https://docs.azuredatabricks.net/_static/notebooks/mlflow/mlflow-quick-start-deployment-azure.html) tutorial for instructional and demonstration purposes.\r\n\r\nAttempting to create the model image \r\n\r\n```\r\nmodel_image, azure_model = mlflow.azureml.build_image(model_uri=model_uri, \r\n                                                      workspace=workspace,\r\n                                                      model_name=\"model\",\r\n                                                      image_name=\"model\",\r\n                                                      description=\"ALS product recomendation engine\",\r\n                                                      synchronous=False)\r\n\r\nmodel_image.wait_for_creation(show_output=True)\r\n```\r\n\r\nresults in error shown below\r\n```\r\nStep 11/14 : RUN sed -i '/^\\s*-\\s*python\\s*[<>=]/d' '/var/azureml-app/conda.yaml' && cat '/var/azureml-app/conda.yaml'\r\n ---> Running in f4458dd2fa6b\r\nchannels:\r\n- defaults\r\ndependencies:\r\n- pyspark=2.4.3.dev0\r\n- pip:\r\n  - mlflow\r\nname: mlflow-env\r\nRemoving intermediate container f4458dd2fa6b\r\n ---> 75e7450423f8\r\nStep 12/14 : RUN CONDA_ROOT_DIR=$(conda info --root) && if [ -n \"$AZUREML_CONDA_ENVIRONMENT_PATH\" ]; then conda env update -p \"$AZUREML_CONDA_ENVIRONMENT_PATH\" -f '/var/azureml-app/conda.yaml'; else conda env update -n base -f '/var/azureml-app/conda.yaml'; fi && conda clean -aqy && rm -rf /root/.cache/pip && rm -rf \"$CONDA_ROOT_DIR/pkgs\" && find \"$CONDA_ROOT_DIR\" -type d -name __pycache__ -exec rm -rf {} +\r\n ---> Running in 862f157747b0\r\nWarning: you have pip-installed dependencies in your environment file, but you do not list pip itself as one of your conda dependencies.  Conda may not use the correct pip to install your packages, and they may end up in the wrong place.  Please add an explicit pip dependency.  I'm adding one for you, but still nagging you.\r\nCollecting package metadata: ...working... done\r\nSolving environment: ...working... failed\r\n[91m\r\nResolvePackageNotFound: \r\n  - pyspark=2.4.3.dev0\r\n```\r\n\r\n\r\n\r\n### Source code / logs\r\n[Model Image Build Log](https://github.com/mlflow/mlflow/files/3304056/build.3.log)\r\n[Model Training and Deployment Code](https://github.com/mlflow/mlflow/files/3304072/mflow_azureml_sample.txt)\r\n\r\n","closed_by":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1470/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/1470/timeline","performed_via_github_app":null,"state_reason":"completed"}