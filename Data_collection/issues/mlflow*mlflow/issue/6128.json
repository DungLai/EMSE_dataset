{"url":"https://api.github.com/repos/mlflow/mlflow/issues/6128","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/6128/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/6128/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/6128/events","html_url":"https://github.com/mlflow/mlflow/issues/6128","id":1283323315,"node_id":"I_kwDOCB5Jx85MffWz","number":6128,"title":"[FR] Run `mlflow gc` based on time since last deletion","user":{"login":"Jason-CKY","id":27609953,"node_id":"MDQ6VXNlcjI3NjA5OTUz","avatar_url":"https://avatars.githubusercontent.com/u/27609953?v=4","gravatar_id":"","url":"https://api.github.com/users/Jason-CKY","html_url":"https://github.com/Jason-CKY","followers_url":"https://api.github.com/users/Jason-CKY/followers","following_url":"https://api.github.com/users/Jason-CKY/following{/other_user}","gists_url":"https://api.github.com/users/Jason-CKY/gists{/gist_id}","starred_url":"https://api.github.com/users/Jason-CKY/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jason-CKY/subscriptions","organizations_url":"https://api.github.com/users/Jason-CKY/orgs","repos_url":"https://api.github.com/users/Jason-CKY/repos","events_url":"https://api.github.com/users/Jason-CKY/events{/privacy}","received_events_url":"https://api.github.com/users/Jason-CKY/received_events","type":"User","site_admin":false},"labels":[{"id":955449434,"node_id":"MDU6TGFiZWw5NTU0NDk0MzQ=","url":"https://api.github.com/repos/mlflow/mlflow/labels/enhancement","name":"enhancement","color":"a2eeef","default":true,"description":"New feature or request"},{"id":2022852620,"node_id":"MDU6TGFiZWwyMDIyODUyNjIw","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/sqlalchemy","name":"area/sqlalchemy","color":"ede978","default":false,"description":"Use of SQL alchemy in tracking service or model registry"},{"id":4300304016,"node_id":"LA_kwDOCB5Jx88AAAABAFFukA","url":"https://api.github.com/repos/mlflow/mlflow/labels/has-closing-pr","name":"has-closing-pr","color":"fef2c0","default":false,"description":"This issue has a closing PR"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-06-24T06:33:18Z","updated_at":"2022-08-04T07:55:54Z","closed_at":"2022-08-04T07:55:54Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"### Willingness to contribute\r\n\r\nYes. I would be willing to contribute this feature with guidance from the MLflow community.\r\n\r\n### Proposal Summary\r\n\r\nAdding more functionality to `mlflow gc`, where administrators can delete runs based on time criteria (e.g. delete runs that have been tagged as `deleted` > 1 month ago). This could be done by adding a `delete_date` column into `runs` table in the sqlstore.\r\n\r\n### Motivation\r\n\r\n> #### What is the use case for this feature?\r\nSometimes developers would want to restore their runs that they previously deleted, so just running `mlflow gc` to delete all `deleted` runs periodically might cause developers to lose their data. By being able to delete runs that have been deleted for some time, we can be more sure that the deleted run is no longer needed.\r\n\r\n> #### Why is this use case valuable to support for MLflow users in general?\r\nSometimes developers would want to restore their runs that they previously deleted, so just running `mlflow gc` to delete all `deleted` runs periodically might cause developers to lose their data. By being able to delete runs that have been deleted for some time, we can be more sure that the deleted run is no longer needed.\r\n\r\n> #### Why is this use case valuable to support for your project(s) or organization?\r\nSometimes developers would want to restore their runs that they previously deleted, so just running `mlflow gc` to delete all `deleted` runs periodically might cause developers to lose their data. By being able to delete runs that have been deleted for some time, we can be more sure that the deleted run is no longer needed.\r\n\r\n> #### Why is it currently difficult to achieve this use case?\r\n`runs` table only have `start_time` and `end_time` column that tracks when the run is created and finished. However, it does not track when the run is deleted so it is impossible to delete based on this criteria.\r\n\r\n### Details\r\n\r\n_No response_\r\n\r\n### What component(s) does this bug affect?\r\n\r\n- [ ] `area/artifacts`: Artifact stores and artifact logging\r\n- [ ] `area/build`: Build and test infrastructure for MLflow\r\n- [ ] `area/docs`: MLflow documentation pages\r\n- [ ] `area/examples`: Example code\r\n- [ ] `area/model-registry`: Model Registry service, APIs, and the fluent client calls for Model Registry\r\n- [ ] `area/models`: MLmodel format, model serialization/deserialization, flavors\r\n- [ ] `area/projects`: MLproject format, project running backends\r\n- [ ] `area/scoring`: MLflow Model server, model deployment tools, Spark UDFs\r\n- [ ] `area/server-infra`: MLflow Tracking server backend\r\n- [ ] `area/tracking`: Tracking Service, tracking client APIs, autologging\r\n\r\n### What interface(s) does this bug affect?\r\n\r\n- [ ] `area/uiux`: Front-end, user experience, plotting, JavaScript, JavaScript dev server\r\n- [ ] `area/docker`: Docker use across MLflow's components, such as MLflow Projects and MLflow Models\r\n- [X] `area/sqlalchemy`: Use of SQLAlchemy in the Tracking Service or Model Registry\r\n- [ ] `area/windows`: Windows support\r\n\r\n### What language(s) does this bug affect?\r\n\r\n- [ ] `language/r`: R APIs and clients\r\n- [ ] `language/java`: Java APIs and clients\r\n- [ ] `language/new`: Proposals for new client languages\r\n\r\n### What integration(s) does this bug affect?\r\n\r\n- [ ] `integrations/azure`: Azure and Azure ML integrations\r\n- [ ] `integrations/sagemaker`: SageMaker integrations\r\n- [ ] `integrations/databricks`: Databricks integrations","closed_by":{"login":"harupy","id":17039389,"node_id":"MDQ6VXNlcjE3MDM5Mzg5","avatar_url":"https://avatars.githubusercontent.com/u/17039389?v=4","gravatar_id":"","url":"https://api.github.com/users/harupy","html_url":"https://github.com/harupy","followers_url":"https://api.github.com/users/harupy/followers","following_url":"https://api.github.com/users/harupy/following{/other_user}","gists_url":"https://api.github.com/users/harupy/gists{/gist_id}","starred_url":"https://api.github.com/users/harupy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harupy/subscriptions","organizations_url":"https://api.github.com/users/harupy/orgs","repos_url":"https://api.github.com/users/harupy/repos","events_url":"https://api.github.com/users/harupy/events{/privacy}","received_events_url":"https://api.github.com/users/harupy/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/6128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/6128/timeline","performed_via_github_app":null,"state_reason":"completed"}