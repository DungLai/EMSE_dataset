{"url":"https://api.github.com/repos/mlflow/mlflow/issues/4584","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/4584/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/4584/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/4584/events","html_url":"https://github.com/mlflow/mlflow/issues/4584","id":949858948,"node_id":"MDU6SXNzdWU5NDk4NTg5NDg=","number":4584,"title":"MLFlow hosted in AWS cannot write to a different bucket?","user":{"login":"daimonie","id":10976353,"node_id":"MDQ6VXNlcjEwOTc2MzUz","avatar_url":"https://avatars.githubusercontent.com/u/10976353?v=4","gravatar_id":"","url":"https://api.github.com/users/daimonie","html_url":"https://github.com/daimonie","followers_url":"https://api.github.com/users/daimonie/followers","following_url":"https://api.github.com/users/daimonie/following{/other_user}","gists_url":"https://api.github.com/users/daimonie/gists{/gist_id}","starred_url":"https://api.github.com/users/daimonie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/daimonie/subscriptions","organizations_url":"https://api.github.com/users/daimonie/orgs","repos_url":"https://api.github.com/users/daimonie/repos","events_url":"https://api.github.com/users/daimonie/events{/privacy}","received_events_url":"https://api.github.com/users/daimonie/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-07-21T15:46:16Z","updated_at":"2021-07-22T09:50:24Z","closed_at":"2021-07-22T09:50:24Z","author_association":"NONE","active_lock_reason":null,"body":"In my setup, the MLFlow service is hosted in the AWS cloud. It has a bucket, `s3://***-mlflow/` where it stores its own files. However, that bucket is not the bucket where the service/devops team wants me to actually save the artifacts. However, whenever I try to use the experiment creation to change the S3 bucket where the files are changed, I run into issues.\r\n\r\nA fragment of code:\r\n\r\n    client = MlflowClient(\r\n        tracking_uri=client_address\r\n    )\r\n    experiment_obj = client.get_experiment_by_name(\r\n        experiment_name\r\n    )\r\n    experiment_id = experiment_obj.experiment_id\r\n    mlflow.set_experiment(experiment_name)\r\n    for experiment in client.list_experiments():\r\n        exp_info = str(experiment)\r\n        logging.info(f\"\\t-{exp_info}\")\r\n    with mlflow.start_run(\r\n            run_name=run_name,\r\n            experiment_id=experiment_id\r\n        ) as run:\r\n        # It crashes before it gets here\r\n        pass\r\n\r\nThis gives an error. Note that I have included the logging of `list_experiments` : \r\n\r\n    [train] 2021-07-21 15:33:13,537 - Setting up mlflow.\r\n    [train] 2021-07-21 15:33:13,537 - Experiment name test_experiment.\r\n    [train] 2021-07-21 15:33:13,537 - https://de-mlflow.***.***:5000\r\n    [train] 2021-07-21 15:33:13,586 - Found experiment 54.\r\n    [train] 2021-07-21 15:33:13,641 - Experiment test_experiment(54)\r\n    [train] 2021-07-21 15:33:13,642 - Experiments found:\r\n    [train] 2021-07-21 15:33:13,667 -   -<Experiment: artifact_location='s3://*-mlflow/mlflow-artifacts/0', experiment_id='0', lifecycle_stage='active', name='Default', tags={}>\r\n    [train] 2021-07-21 15:33:13,668 -   -<Experiment: artifact_location='s3://*-projects/myteam', experiment_id='51', lifecycle_stage='active', name='test_model_sagemaker_v2_v2_v2_v2_v2_v2', tags={}>\r\n    [train] 2021-07-21 15:33:13,668 -   -<Experiment: artifact_location='s3://*-projects/myteam', experiment_id='54', lifecycle_stage='active', name='test_experiment', tags={}>\r\n    Traceback (most recent call last):\r\n      File \"train.py\", line 125, in <module>\r\n        train_and_deploy()\r\n      File \"train.py\", line 77, in train_and_deploy\r\n        experiment_id=experiment_id\r\n      File \"/usr/local/lib/python3.7/site-packages/mlflow/tracking/fluent.py\", line 250, in start_run\r\n        active_run_obj = client.create_run(experiment_id=exp_id_for_run, tags=tags)\r\n      File \"/usr/local/lib/python3.7/site-packages/mlflow/tracking/client.py\", line 266, in create_run\r\n        return self._tracking_client.create_run(experiment_id, start_time, tags)\r\n      File \"/usr/local/lib/python3.7/site-packages/mlflow/tracking/_tracking_service/client.py\", line 96, in create_run\r\n        tags=[RunTag(key, value) for (key, value) in tags.items()],\r\n      File \"/usr/local/lib/python3.7/site-packages/mlflow/store/tracking/file_store.py\", line 482, in create_run\r\n        experiment = self.get_experiment(experiment_id)\r\n      File \"/usr/local/lib/python3.7/site-packages/mlflow/store/tracking/file_store.py\", line 363, in get_experiment\r\n        experiment = self._get_experiment(experiment_id)\r\n      File \"/usr/local/lib/python3.7/site-packages/mlflow/store/tracking/file_store.py\", line 334, in _get_experiment\r\n        databricks_pb2.RESOURCE_DOES_NOT_EXIST,\r\n    mlflow.exceptions.MlflowException: Could not find experiment with ID 54\r\n    make: *** [train] Error 1\r\n\r\nAs you can see in the log-above, it found experiment `54`, which is set to use the `-projects` bucket, but throws a RESOURCE DOES NOT EXIST whenever I try to start a run with the experiment set. ","closed_by":{"login":"daimonie","id":10976353,"node_id":"MDQ6VXNlcjEwOTc2MzUz","avatar_url":"https://avatars.githubusercontent.com/u/10976353?v=4","gravatar_id":"","url":"https://api.github.com/users/daimonie","html_url":"https://github.com/daimonie","followers_url":"https://api.github.com/users/daimonie/followers","following_url":"https://api.github.com/users/daimonie/following{/other_user}","gists_url":"https://api.github.com/users/daimonie/gists{/gist_id}","starred_url":"https://api.github.com/users/daimonie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/daimonie/subscriptions","organizations_url":"https://api.github.com/users/daimonie/orgs","repos_url":"https://api.github.com/users/daimonie/repos","events_url":"https://api.github.com/users/daimonie/events{/privacy}","received_events_url":"https://api.github.com/users/daimonie/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/4584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/4584/timeline","performed_via_github_app":null,"state_reason":"completed"}