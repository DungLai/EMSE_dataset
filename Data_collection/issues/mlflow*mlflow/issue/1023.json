{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1023","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/1023/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/1023/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/1023/events","html_url":"https://github.com/mlflow/mlflow/issues/1023","id":423833780,"node_id":"MDU6SXNzdWU0MjM4MzM3ODA=","number":1023,"title":"MLFlow Azure ML Build Image Failing: xgboost package not found","user":{"login":"brijenshah","id":2092359,"node_id":"MDQ6VXNlcjIwOTIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/2092359?v=4","gravatar_id":"","url":"https://api.github.com/users/brijenshah","html_url":"https://github.com/brijenshah","followers_url":"https://api.github.com/users/brijenshah/followers","following_url":"https://api.github.com/users/brijenshah/following{/other_user}","gists_url":"https://api.github.com/users/brijenshah/gists{/gist_id}","starred_url":"https://api.github.com/users/brijenshah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brijenshah/subscriptions","organizations_url":"https://api.github.com/users/brijenshah/orgs","repos_url":"https://api.github.com/users/brijenshah/repos","events_url":"https://api.github.com/users/brijenshah/events{/privacy}","received_events_url":"https://api.github.com/users/brijenshah/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-03-21T16:47:41Z","updated_at":"2020-08-05T11:43:54Z","closed_at":"2019-03-21T20:40:32Z","author_association":"NONE","active_lock_reason":null,"body":"### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in MLflow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Databricks 5.2, Spark 2.4.0\r\n- **MLflow installed from (source or binary): binary\r\n- **MLflow version (run ``mlflow --version``)**: 0.8.2\r\n- **Python version**: 3\r\n- **npm version (if running the dev UI): NA\r\n- **Exact command to reproduce**:mlflow.azureml.build_image\r\n\r\n### Describe the problem\r\nI am trying to deploy the model to Azure Machine Learning Service from Azure Databricks using mlflow.azureml apis but it's failing at image creation\r\n\r\n### Source code / logs\r\nmodel_path=\"sk_models\"\r\n\r\nmodel_image, azure_model = mlflow.azureml.build_image(model_path=model_path, \r\n                                                      workspace=ws, \r\n                                                      run_id=run_id,\r\n                                                      model_name=\"model\",\r\n                                                      image_name=\"model\",\r\n                                                      description=\"Model Deployment\",\r\n                                                      synchronous=False)\r\n### conda.yaml\r\nchannels:\r\n- defaults\r\ndependencies:\r\n- python=3.5.2\r\n- scikit-learn=0.18.1\r\n- cloudpickle==0.8.0\r\n- xgboost\r\nname: mlflow-env\r\n\r\n### Error\r\nFailedImage creation operation finished for image model:6, operation \"Failed\"\r\nImage creation failed with\r\nStatusCode: 400\r\nMessage: Docker image build failed.\r\n\r\n### Logs \r\nStep 11/14 : RUN sed -i '/^\\s*-\\s*python\\s*[<>=]/d' '/var/azureml-app/conda.yaml' && cat '/var/azureml-app/conda.yaml'\r\n ---> Running in 4b6dba625481\r\nchannels:\r\n- defaults\r\ndependencies:\r\n- scikit-learn=0.18.1\r\n- cloudpickle==0.8.0\r\n- xgboost\r\nname: mlflow-env\r\nRemoving intermediate container 4b6dba625481\r\n ---> 73c983a5af9e\r\nStep 12/14 : RUN CONDA_ROOT_DIR=$(conda info --root) && if [ -n \"$CONDA_ENV_PATH\" ]; then conda env update -p \"$CONDA_ENV_PATH\" -f '/var/azureml-app/conda.yaml'; else conda env update -n base -f '/var/azureml-app/conda.yaml'; fi && conda clean -aqy && rm -rf /root/.cache/pip && rm -rf \"$CONDA_ROOT_DIR/pkgs\" && find \"$CONDA_ROOT_DIR\" -type d -name __pycache__ -exec rm -rf {} +\r\n ---> Running in dbdcbb6a6f5a\r\nCollecting package metadata: ...working... done\r\nSolving environment: ...working... failed\r\n\u001B[91m\r\nResolvePackageNotFound: \r\n  - xgboost\r\n\r\nI also tried removing XGBoost from conda.yaml and image was successfully but it was failing at Webservice.deploy_from_image. It's not able to find XGBoost dependency or load package. ","closed_by":{"login":"brijenshah","id":2092359,"node_id":"MDQ6VXNlcjIwOTIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/2092359?v=4","gravatar_id":"","url":"https://api.github.com/users/brijenshah","html_url":"https://github.com/brijenshah","followers_url":"https://api.github.com/users/brijenshah/followers","following_url":"https://api.github.com/users/brijenshah/following{/other_user}","gists_url":"https://api.github.com/users/brijenshah/gists{/gist_id}","starred_url":"https://api.github.com/users/brijenshah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brijenshah/subscriptions","organizations_url":"https://api.github.com/users/brijenshah/orgs","repos_url":"https://api.github.com/users/brijenshah/repos","events_url":"https://api.github.com/users/brijenshah/events{/privacy}","received_events_url":"https://api.github.com/users/brijenshah/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1023/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/1023/timeline","performed_via_github_app":null,"state_reason":"completed"}