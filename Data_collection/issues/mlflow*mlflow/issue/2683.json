{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2683","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/2683/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/2683/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/2683/events","html_url":"https://github.com/mlflow/mlflow/issues/2683","id":596984853,"node_id":"MDU6SXNzdWU1OTY5ODQ4NTM=","number":2683,"title":"[BUG] https://repo.continuum.io/miniconda/ moved to https://repo.anaconda.com/miniconda/ build-docker is broken","user":{"login":"sstolpovskiy","id":1834025,"node_id":"MDQ6VXNlcjE4MzQwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/1834025?v=4","gravatar_id":"","url":"https://api.github.com/users/sstolpovskiy","html_url":"https://github.com/sstolpovskiy","followers_url":"https://api.github.com/users/sstolpovskiy/followers","following_url":"https://api.github.com/users/sstolpovskiy/following{/other_user}","gists_url":"https://api.github.com/users/sstolpovskiy/gists{/gist_id}","starred_url":"https://api.github.com/users/sstolpovskiy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sstolpovskiy/subscriptions","organizations_url":"https://api.github.com/users/sstolpovskiy/orgs","repos_url":"https://api.github.com/users/sstolpovskiy/repos","events_url":"https://api.github.com/users/sstolpovskiy/events{/privacy}","received_events_url":"https://api.github.com/users/sstolpovskiy/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-04-09T02:56:31Z","updated_at":"2020-04-11T23:54:06Z","closed_at":"2020-04-11T23:54:05Z","author_association":"NONE","active_lock_reason":null,"body":"### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in MLflow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Debian 9\r\n- **MLflow installed from (source or binary)**: Source\r\n- **MLflow version (run ``mlflow --version``)**: 1.7.2\r\n- **Python version**: 3.6\r\n- **npm version, if running the dev UI**: No\r\n- **Exact command to reproduce**: `mlflow models build-docker -m gs://backet/1/runid/artifacts/pyfunc-model -n \"docker_model:latest\"`\r\n\r\n### Describe the problem\r\nDuring docker creation command:\r\n```\r\nRUN curl https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh >> miniconda.sh\r\n```\r\nIs not downloading miniconda.sh\r\nAs a result build is failed. \r\n\r\n### Code to reproduce issue\r\nRun any build docker command.\r\n `mlflow models build-docker -m gs://backet/1/runid/artifacts/pyfunc-model -n \"docker_model:latest\"`\r\n\r\n### Other info / logs\r\nhttps://repo.continuum.io/ was permanently moved to https://repo.anaconda.com\r\nWe need to replace this url in code. \r\n\r\n```\r\ncurl -kv https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh >> miniconda.sh\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying 104.18.200.79...\r\n* TCP_NODELAY set\r\n* Connected to repo.continuum.io (104.18.200.79) port 443 (#0)\r\n* ALPN, offering h2\r\n* ALPN, offering http/1.1\r\n* Cipher selection: ALL:!EXPORT:!EXPORT40:!EXPORT56:!aNULL:!LOW:!RC4:@STRENGTH\r\n* successfully set certificate verify locations:\r\n*   CAfile: /etc/ssl/certs/ca-certificates.crt\r\n  CApath: /etc/ssl/certs\r\n* TLSv1.2 (OUT), TLS header, Certificate Status (22):\r\n} [5 bytes data]\r\n* TLSv1.2 (OUT), TLS handshake, Client hello (1):\r\n} [512 bytes data]\r\n* TLSv1.2 (IN), TLS handshake, Server hello (2):\r\n{ [100 bytes data]\r\n* TLSv1.2 (IN), TLS handshake, Certificate (11):\r\n{ [2206 bytes data]\r\n* TLSv1.2 (IN), TLS handshake, Server key exchange (12):\r\n{ [147 bytes data]\r\n* TLSv1.2 (IN), TLS handshake, Server finished (14):\r\n{ [4 bytes data]\r\n* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):\r\n} [70 bytes data]\r\n* TLSv1.2 (OUT), TLS change cipher, Client hello (1):\r\n} [1 bytes data]\r\n* TLSv1.2 (OUT), TLS handshake, Finished (20):\r\n} [16 bytes data]\r\n* TLSv1.2 (IN), TLS change cipher, Client hello (1):\r\n{ [1 bytes data]\r\n* TLSv1.2 (IN), TLS handshake, Finished (20):\r\n{ [16 bytes data]\r\n* SSL connection using TLSv1.2 / ECDHE-ECDSA-AES128-GCM-SHA256\r\n* ALPN, server accepted to use h2\r\n* Server certificate:\r\n*  subject: C=US; ST=CA; L=San Francisco; O=Cloudflare, Inc.; CN=sni.cloudflaressl.com\r\n*  start date: Apr  6 00:00:00 2020 GMT\r\n*  expire date: Oct  9 12:00:00 2020 GMT\r\n*  issuer: C=US; ST=CA; L=San Francisco; O=CloudFlare, Inc.; CN=CloudFlare Inc ECC CA-2\r\n*  SSL certificate verify ok.\r\n* Using HTTP2, server supports multi-use\r\n* Connection state changed (HTTP/2 confirmed)\r\n* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0\r\n} [5 bytes data]\r\n* Using Stream ID: 1 (easy handle 0x55b3037edea0)\r\n} [5 bytes data]\r\n> GET /miniconda/Miniconda3-latest-Linux-x86_64.sh HTTP/1.1\r\n> Host: repo.continuum.io\r\n> User-Agent: curl/7.52.1\r\n> Accept: */*\r\n> \r\n{ [5 bytes data]\r\n* Connection state changed (MAX_CONCURRENT_STREAMS updated)!\r\n} [5 bytes data]\r\n< **HTTP/2 301** \r\n< date: Thu, 09 Apr 2020 02:45:53 GMT\r\n< cache-control: max-age=3600\r\n< expires: Thu, 09 Apr 2020 03:45:53 GMT\r\n< location: https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh\r\n< expect-ct: max-age=604800, report-uri=\"https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct\"\r\n< server: cloudflare\r\n< cf-ray: 5810e5032a67fdd1-ORD\r\n< \r\n{ [0 bytes data]\r\n* Curl_http_done: called premature == 0\r\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r\n* Connection #0 to host repo.continuum.io left intact```\r\n","closed_by":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/2683/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/2683/timeline","performed_via_github_app":null,"state_reason":"completed"}