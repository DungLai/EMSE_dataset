{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3199","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/3199/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/3199/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/3199/events","html_url":"https://github.com/mlflow/mlflow/issues/3199","id":669122064,"node_id":"MDU6SXNzdWU2NjkxMjIwNjQ=","number":3199,"title":"Unable to log pytorch models","user":{"login":"Dhaval08","id":9162393,"node_id":"MDQ6VXNlcjkxNjIzOTM=","avatar_url":"https://avatars.githubusercontent.com/u/9162393?v=4","gravatar_id":"","url":"https://api.github.com/users/Dhaval08","html_url":"https://github.com/Dhaval08","followers_url":"https://api.github.com/users/Dhaval08/followers","following_url":"https://api.github.com/users/Dhaval08/following{/other_user}","gists_url":"https://api.github.com/users/Dhaval08/gists{/gist_id}","starred_url":"https://api.github.com/users/Dhaval08/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Dhaval08/subscriptions","organizations_url":"https://api.github.com/users/Dhaval08/orgs","repos_url":"https://api.github.com/users/Dhaval08/repos","events_url":"https://api.github.com/users/Dhaval08/events{/privacy}","received_events_url":"https://api.github.com/users/Dhaval08/received_events","type":"User","site_admin":false},"labels":[{"id":955449428,"node_id":"MDU6TGFiZWw5NTU0NDk0Mjg=","url":"https://api.github.com/repos/mlflow/mlflow/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":2022848043,"node_id":"MDU6TGFiZWwyMDIyODQ4MDQz","url":"https://api.github.com/repos/mlflow/mlflow/labels/area/models","name":"area/models","color":"48eabc","default":false,"description":"MLmodel format, model serialization/deserialization, flavors"},{"id":2022863969,"node_id":"MDU6TGFiZWwyMDIyODYzOTY5","url":"https://api.github.com/repos/mlflow/mlflow/labels/priority/important-soon","name":"priority/important-soon","color":"534cb5","default":false,"description":"The issue is worked on by the community currently or will be very soon, ideally in time for the"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2020-07-30T19:36:04Z","updated_at":"2020-07-31T17:37:11Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Thank you for submitting an issue. Please refer to our [issue policy](https://www.github.com/mlflow/mlflow/blob/master/ISSUE_POLICY.md) for additional information about bug reports. For help with debugging your code, please refer to [Stack Overflow](https://stackoverflow.com/questions/tagged/mlflow).\r\n\r\n**Please fill in this bug report template to ensure a timely and thorough response.**\r\n\r\n### Describe the problem\r\nI am training a pytorch model and trying to log it towards the end using the following command\r\n```\r\nmlflow.pytorch.log_model(model, \"model\")\r\n```\r\n\r\n### Code to reproduce issue\r\nhttps://github.com/mlflow/mlflow/tree/master/examples/pytorch\r\nI am using the exact same code by adding the log_model line at the bottom\r\n\r\n### Other info / logs\r\n```\r\nTraceback (most recent call last):\r\n  File \"mnist_tensorboard_artifact.py\", line 172, in <module>\r\n    mlflow.pytorch.log_model(model, \"model\")\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/site-packages/mlflow/pytorch/__init__.py\", line 179, in log_model\r\n    signature=signature, input_example=input_example, **kwargs)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/site-packages/mlflow/models/model.py\", line 154, in log\r\n    **kwargs)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/site-packages/mlflow/pytorch/__init__.py\", line 300, in save_model\r\n    torch.save(pytorch_model, model_path, pickle_module=pickle_module, **kwargs)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/site-packages/torch/serialization.py\", line 328, in save\r\n    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/site-packages/torch/serialization.py\", line 401, in _legacy_save\r\n    pickler.dump(obj)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/site-packages/cloudpickle/cloudpickle_fast.py\", line 540, in dump\r\n    return Pickler.dump(self, obj)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 409, in dump\r\n    self.save(obj)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 521, in save\r\n    self.save_reduce(obj=obj, *rv)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 605, in save_reduce\r\n    save(cls)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 463, in save\r\n    self.save_pers(pid)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 530, in save_pers\r\n    self.save(pid, save_persistent_id=False)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 476, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 751, in save_tuple\r\n    save(element)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 476, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/site-packages/cloudpickle/cloudpickle_fast.py\", line 705, in save_global\r\n    self._save_reduce_pickle5(*_dynamic_class_reduce(obj), obj=obj)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/site-packages/cloudpickle/cloudpickle_fast.py\", line 664, in _save_reduce_pickle5\r\n    save(state)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 476, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 736, in save_tuple\r\n    save(element)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 476, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 821, in save_dict\r\n    self._batch_setitems(obj.items())\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 847, in _batch_setitems\r\n    save(v)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 476, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/site-packages/cloudpickle/cloudpickle_fast.py\", line 722, in save_function\r\n    *self._dynamic_function_reduce(obj), obj=obj\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/site-packages/cloudpickle/cloudpickle_fast.py\", line 664, in _save_reduce_pickle5\r\n    save(state)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 476, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 736, in save_tuple\r\n    save(element)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 476, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 821, in save_dict\r\n    self._batch_setitems(obj.items())\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 847, in _batch_setitems\r\n    save(v)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 476, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 821, in save_dict\r\n    self._batch_setitems(obj.items())\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 847, in _batch_setitems\r\n    save(v)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 521, in save\r\n    self.save_reduce(obj=obj, *rv)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 634, in save_reduce\r\n    save(state)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 476, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 821, in save_dict\r\n    self._batch_setitems(obj.items())\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 847, in _batch_setitems\r\n    save(v)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 521, in save\r\n    self.save_reduce(obj=obj, *rv)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 634, in save_reduce\r\n    save(state)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 476, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 821, in save_dict\r\n    self._batch_setitems(obj.items())\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 852, in _batch_setitems\r\n    save(v)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 521, in save\r\n    self.save_reduce(obj=obj, *rv)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 634, in save_reduce\r\n    save(state)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 476, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 821, in save_dict\r\n    self._batch_setitems(obj.items())\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 847, in _batch_setitems\r\n    save(v)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/pickle.py\", line 496, in save\r\n    rv = reduce(self.proto)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/multiprocessing/queues.py\", line 58, in __getstate__\r\n    context.assert_spawning(self)\r\n  File \"/Users/dshah/Desktop/local/miniconda/envs/mlflow-3c24da0bdd94369e854abcee14bf75d1ad29c419/lib/python3.6/multiprocessing/context.py\", line 356, in assert_spawning\r\n    ' through inheritance' % type(obj).__name__\r\nRuntimeError: Queue objects should only be shared between processes through inheritance\r\n2020/07/30 12:23:42 ERROR mlflow.cli: === Run (ID 'b7a5eed7f3a74219ac3d72c376f3edac') failed ===\r\n```\r\n\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/3199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/3199/timeline","performed_via_github_app":null,"state_reason":null}