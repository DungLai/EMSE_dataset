{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1549","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/1549/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/1549/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/1549/events","html_url":"https://github.com/mlflow/mlflow/issues/1549","id":464287360,"node_id":"MDU6SXNzdWU0NjQyODczNjA=","number":1549,"title":"run project inside docker doesn't save artifacts","user":{"login":"ankxyz","id":21148145,"node_id":"MDQ6VXNlcjIxMTQ4MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/21148145?v=4","gravatar_id":"","url":"https://api.github.com/users/ankxyz","html_url":"https://github.com/ankxyz","followers_url":"https://api.github.com/users/ankxyz/followers","following_url":"https://api.github.com/users/ankxyz/following{/other_user}","gists_url":"https://api.github.com/users/ankxyz/gists{/gist_id}","starred_url":"https://api.github.com/users/ankxyz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ankxyz/subscriptions","organizations_url":"https://api.github.com/users/ankxyz/orgs","repos_url":"https://api.github.com/users/ankxyz/repos","events_url":"https://api.github.com/users/ankxyz/events{/privacy}","received_events_url":"https://api.github.com/users/ankxyz/received_events","type":"User","site_admin":false},"labels":[{"id":1554650079,"node_id":"MDU6TGFiZWwxNTU0NjUwMDc5","url":"https://api.github.com/repos/mlflow/mlflow/labels/stale","name":"stale","color":"828282","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-07-04T14:10:43Z","updated_at":"2019-11-12T20:50:15Z","closed_at":"2019-11-12T20:50:15Z","author_association":"NONE","active_lock_reason":null,"body":"### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in MLflow)**: example https://github.com/mlflow/mlflow/tree/master/examples/docker\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04 \r\n- **MLflow installed from (source or binary)**: pip\r\n- **MLflow version (run ``mlflow --version``)**: 1.0.0\r\n- **Python version**: 3.7.3\r\n- **npm version (if running the dev UI): None\r\n- **Exact command to reproduce**: mlflow run examples/docker\r\n\r\n### Describe the problem\r\nIf I run example https://github.com/mlflow/mlflow/tree/master/examples/docker, I get folder _mlruns_, where metrics and parameters are stored.\r\n\r\nBut there is no some artifacts. In the example sklearn logs model. But folder mlruns/<experiments_id>/<run_id>/artifacts is always empty. \r\n\r\n### Source code / logs\r\n```python\r\n# The data set used in this example is from http://archive.ics.uci.edu/ml/datasets/Wine+Quality\r\n# P. Cortez, A. Cerdeira, F. Almeida, T. Matos and J. Reis.\r\n# Modeling wine preferences by data mining from physicochemical properties. In Decision Support Systems, Elsevier, 47(4):547-553, 2009.\r\n\r\nimport os\r\nimport warnings\r\nimport sys\r\nimport argparse\r\n\r\nimport pandas as pd\r\nimport numpy as np\r\nfrom sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score\r\nfrom sklearn.model_selection import train_test_split\r\nfrom sklearn.linear_model import ElasticNet\r\n\r\nimport mlflow\r\nimport mlflow.sklearn\r\n\r\n\r\ndef eval_metrics(actual, pred):\r\n    rmse = np.sqrt(mean_squared_error(actual, pred))\r\n    mae = mean_absolute_error(actual, pred)\r\n    r2 = r2_score(actual, pred)\r\n    return rmse, mae, r2\r\n\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    warnings.filterwarnings(\"ignore\")\r\n    np.random.seed(40)\r\n\r\n    parser = argparse.ArgumentParser()\r\n    parser.add_argument('--alpha')\r\n    parser.add_argument('--l1-ratio')\r\n    args = parser.parse_args()\r\n\r\n    # Read the wine-quality csv file (make sure you're running this from the root of MLflow!)\r\n    wine_path = os.path.join(os.path.dirname(os.path.abspath(__file__)), \"wine-quality.csv\")\r\n    data = pd.read_csv(wine_path)\r\n\r\n    # Split the data into training and test sets. (0.75, 0.25) split.\r\n    train, test = train_test_split(data)\r\n\r\n    # The predicted column is \"quality\" which is a scalar from [3, 9]\r\n    train_x = train.drop([\"quality\"], axis=1)\r\n    test_x = test.drop([\"quality\"], axis=1)\r\n    train_y = train[[\"quality\"]]\r\n    test_y = test[[\"quality\"]]\r\n\r\n    alpha = float(args.alpha)\r\n    l1_ratio = float(args.l1_ratio)\r\n\r\n    with mlflow.start_run():\r\n        lr = ElasticNet(alpha=alpha, l1_ratio=l1_ratio, random_state=42)\r\n        lr.fit(train_x, train_y)\r\n\r\n        predicted_qualities = lr.predict(test_x)\r\n\r\n        (rmse, mae, r2) = eval_metrics(test_y, predicted_qualities)\r\n\r\n        print(\"Elasticnet model (alpha=%f, l1_ratio=%f):\" % (alpha, l1_ratio))\r\n        print(\"  RMSE: %s\" % rmse)\r\n        print(\"  MAE: %s\" % mae)\r\n        print(\"  R2: %s\" % r2)\r\n\r\n        mlflow.log_param(\"alpha\", alpha)\r\n        mlflow.log_param(\"l1_ratio\", l1_ratio)\r\n        mlflow.log_metric(\"rmse\", rmse)\r\n        mlflow.log_metric(\"r2\", r2)\r\n        mlflow.log_metric(\"mae\", mae)\r\n        mlflow.sklearn.log_model(lr, \"model\")\r\n```\r\n","closed_by":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1549/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/1549/timeline","performed_via_github_app":null,"state_reason":"completed"}