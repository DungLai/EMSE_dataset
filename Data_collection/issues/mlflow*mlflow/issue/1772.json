{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1772","repository_url":"https://api.github.com/repos/mlflow/mlflow","labels_url":"https://api.github.com/repos/mlflow/mlflow/issues/1772/labels{/name}","comments_url":"https://api.github.com/repos/mlflow/mlflow/issues/1772/comments","events_url":"https://api.github.com/repos/mlflow/mlflow/issues/1772/events","html_url":"https://github.com/mlflow/mlflow/issues/1772","id":484337387,"node_id":"MDU6SXNzdWU0ODQzMzczODc=","number":1772,"title":"[FR] Add GetExperimentByName REST API endpoint, call it in MlflowClient.get_experiment_by_name","user":{"login":"smurching","id":2358483,"node_id":"MDQ6VXNlcjIzNTg0ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2358483?v=4","gravatar_id":"","url":"https://api.github.com/users/smurching","html_url":"https://github.com/smurching","followers_url":"https://api.github.com/users/smurching/followers","following_url":"https://api.github.com/users/smurching/following{/other_user}","gists_url":"https://api.github.com/users/smurching/gists{/gist_id}","starred_url":"https://api.github.com/users/smurching/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smurching/subscriptions","organizations_url":"https://api.github.com/users/smurching/orgs","repos_url":"https://api.github.com/users/smurching/repos","events_url":"https://api.github.com/users/smurching/events{/privacy}","received_events_url":"https://api.github.com/users/smurching/received_events","type":"User","site_admin":false},"labels":[{"id":955449434,"node_id":"MDU6TGFiZWw5NTU0NDk0MzQ=","url":"https://api.github.com/repos/mlflow/mlflow/labels/enhancement","name":"enhancement","color":"a2eeef","default":true,"description":"New feature or request"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-08-23T05:26:50Z","updated_at":"2020-07-01T23:06:04Z","closed_at":"2020-07-01T23:06:04Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"## Describe the proposal\r\n### Motivation\r\nCurrently, `MlflowClient.get_experiment_by_name` (called by the oft-used `mlflow.set_experiment`) is implemented by hitting the ListExperiment endpoint & filtering the result to the experiment with the desired name. ListExperiments is expensive to satisfy when there are many experiments, so this places significant load on the server - e.g. calling `mlflow.set_experiment` in parallel at the start of a hyperparam tuning job may actually DOS the server as it handles the ListExperiment requests. We want people to be able to use MLflow at scale, so we should remove this bottleneck from users' critical path.\r\n\r\n### Proposed Changes\r\nWe propose adding a new GetExperimentByName REST API endpoint at `/api/2.0/mlflow/experiments/get-by-name` (analogous to `/api/2.0/mlflow/experiments/get`), that expects a single `experiment_path` field in the request body & responds with experiment data or errors for non-existent experiments. In particular, we'd add the following proto definition:\r\n\r\n```\r\n  // Get metadata for an experiment and a list of runs for the experiment.\r\n  // This endpoint will return deleted experiments. The server will respond with an error if no\r\n  // experiment with the specified name exists.\r\n  rpc getExperimentByName (GetExperimentByName) returns (GetExperimentByName.Response) {\r\n    option (rpc) = {\r\n      endpoints: [{\r\n        method: \"GET\",\r\n        path: \"/mlflow/experiments/get-by-name\",\r\n        since { major: 2, minor: 0 },\r\n      }],\r\n      visibility: PUBLIC,\r\n      rpc_doc_title: \"Get Experiment By Name\",\r\n    };\r\n  }\r\n\r\nmessage GetExperimentByName {\r\n  // Name of the associated experiment.\r\n  optional string experiment_name = 1 [(validate_required) = true];\r\n\r\n  message Response {\r\n    // Experiment details.\r\n    optional Experiment experiment = 1;\r\n  }\r\n}\r\n```\r\n\r\nTo ensure one-version backwards compatibility & to allow REST API implementors time to expose the new API, we propose updating `MlflowClient.get_experiment_by_name` in MLflow 1.3 to use `GetExperimentByName` & fall back using ListExperiments if that fails. We may then remove the fallback behavior in a future release (e.g. MLflow 1.4).\r\n\r\nNote that the AbstractStore also contains a default implementation of `get_experiment_by_name` that filters the result of AbstractStore.list_experiments. We'll keep this default implementation as is, but override the implementation in the FileStore, SQLAlchemyStore, and RestStore to more efficient implementations in 1.3.\r\n","closed_by":{"login":"sueann","id":4411489,"node_id":"MDQ6VXNlcjQ0MTE0ODk=","avatar_url":"https://avatars.githubusercontent.com/u/4411489?v=4","gravatar_id":"","url":"https://api.github.com/users/sueann","html_url":"https://github.com/sueann","followers_url":"https://api.github.com/users/sueann/followers","following_url":"https://api.github.com/users/sueann/following{/other_user}","gists_url":"https://api.github.com/users/sueann/gists{/gist_id}","starred_url":"https://api.github.com/users/sueann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sueann/subscriptions","organizations_url":"https://api.github.com/users/sueann/orgs","repos_url":"https://api.github.com/users/sueann/repos","events_url":"https://api.github.com/users/sueann/events{/privacy}","received_events_url":"https://api.github.com/users/sueann/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/1772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mlflow/mlflow/issues/1772/timeline","performed_via_github_app":null,"state_reason":"completed"}