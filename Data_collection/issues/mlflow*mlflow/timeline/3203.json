[{"id":3606399569,"node_id":"MDEyOkxhYmVsZWRFdmVudDM2MDYzOTk1Njk=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3606399569","actor":{"login":"murphycj","id":3837196,"node_id":"MDQ6VXNlcjM4MzcxOTY=","avatar_url":"https://avatars.githubusercontent.com/u/3837196?v=4","gravatar_id":"","url":"https://api.github.com/users/murphycj","html_url":"https://github.com/murphycj","followers_url":"https://api.github.com/users/murphycj/followers","following_url":"https://api.github.com/users/murphycj/following{/other_user}","gists_url":"https://api.github.com/users/murphycj/gists{/gist_id}","starred_url":"https://api.github.com/users/murphycj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/murphycj/subscriptions","organizations_url":"https://api.github.com/users/murphycj/orgs","repos_url":"https://api.github.com/users/murphycj/repos","events_url":"https://api.github.com/users/murphycj/events{/privacy}","received_events_url":"https://api.github.com/users/murphycj/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-07-31T00:58:17Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"id":3607178342,"node_id":"MDEyOkxhYmVsZWRFdmVudDM2MDcxNzgzNDI=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3607178342","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-07-31T07:06:31Z","label":{"name":"area/sqlalchemy","color":"ede978"},"performed_via_github_app":null},{"id":3607178343,"node_id":"MDEyOkxhYmVsZWRFdmVudDM2MDcxNzgzNDM=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3607178343","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-07-31T07:06:31Z","label":{"name":"area/tracking","color":"48eabc"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/667214097","html_url":"https://github.com/mlflow/mlflow/issues/3203#issuecomment-667214097","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/3203","id":667214097,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NzIxNDA5Nw==","user":{"login":"dmatrix","id":1117597,"node_id":"MDQ6VXNlcjExMTc1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1117597?v=4","gravatar_id":"","url":"https://api.github.com/users/dmatrix","html_url":"https://github.com/dmatrix","followers_url":"https://api.github.com/users/dmatrix/followers","following_url":"https://api.github.com/users/dmatrix/following{/other_user}","gists_url":"https://api.github.com/users/dmatrix/gists{/gist_id}","starred_url":"https://api.github.com/users/dmatrix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmatrix/subscriptions","organizations_url":"https://api.github.com/users/dmatrix/orgs","repos_url":"https://api.github.com/users/dmatrix/repos","events_url":"https://api.github.com/users/dmatrix/events{/privacy}","received_events_url":"https://api.github.com/users/dmatrix/received_events","type":"User","site_admin":false},"created_at":"2020-07-31T16:29:29Z","updated_at":"2020-07-31T16:29:29Z","author_association":"CONTRIBUTOR","body":"@murphycj thanks for filing this issue and detailed explanation and reproducible code.\r\n\r\nCan you try using [mlflow.log_batch()](https://www.mlflow.org/docs/latest/python_api/mlflow.tracking.html#mlflow.tracking.MlflowClient.log_batch)? to see if that helps mitigate?\r\nYour changed code would like as follows:\r\n\r\n```\r\nwith mlflow.start_run(experiment_id='9') as run:\r\n    run_id = run.info.run_uuid\r\n   ...\r\n   mlflow.log_batch(...)\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/667214097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dmatrix","id":1117597,"node_id":"MDQ6VXNlcjExMTc1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1117597?v=4","gravatar_id":"","url":"https://api.github.com/users/dmatrix","html_url":"https://github.com/dmatrix","followers_url":"https://api.github.com/users/dmatrix/followers","following_url":"https://api.github.com/users/dmatrix/following{/other_user}","gists_url":"https://api.github.com/users/dmatrix/gists{/gist_id}","starred_url":"https://api.github.com/users/dmatrix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmatrix/subscriptions","organizations_url":"https://api.github.com/users/dmatrix/orgs","repos_url":"https://api.github.com/users/dmatrix/repos","events_url":"https://api.github.com/users/dmatrix/events{/privacy}","received_events_url":"https://api.github.com/users/dmatrix/received_events","type":"User","site_admin":false}},{"id":3609306261,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzYwOTMwNjI2MQ==","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3609306261","actor":{"login":"murphycj","id":3837196,"node_id":"MDQ6VXNlcjM4MzcxOTY=","avatar_url":"https://avatars.githubusercontent.com/u/3837196?v=4","gravatar_id":"","url":"https://api.github.com/users/murphycj","html_url":"https://github.com/murphycj","followers_url":"https://api.github.com/users/murphycj/followers","following_url":"https://api.github.com/users/murphycj/following{/other_user}","gists_url":"https://api.github.com/users/murphycj/gists{/gist_id}","starred_url":"https://api.github.com/users/murphycj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/murphycj/subscriptions","organizations_url":"https://api.github.com/users/murphycj/orgs","repos_url":"https://api.github.com/users/murphycj/repos","events_url":"https://api.github.com/users/murphycj/events{/privacy}","received_events_url":"https://api.github.com/users/murphycj/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-07-31T16:29:29Z","performed_via_github_app":null},{"id":3609306265,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM2MDkzMDYyNjU=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3609306265","actor":{"login":"murphycj","id":3837196,"node_id":"MDQ6VXNlcjM4MzcxOTY=","avatar_url":"https://avatars.githubusercontent.com/u/3837196?v=4","gravatar_id":"","url":"https://api.github.com/users/murphycj","html_url":"https://github.com/murphycj","followers_url":"https://api.github.com/users/murphycj/followers","following_url":"https://api.github.com/users/murphycj/following{/other_user}","gists_url":"https://api.github.com/users/murphycj/gists{/gist_id}","starred_url":"https://api.github.com/users/murphycj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/murphycj/subscriptions","organizations_url":"https://api.github.com/users/murphycj/orgs","repos_url":"https://api.github.com/users/murphycj/repos","events_url":"https://api.github.com/users/murphycj/events{/privacy}","received_events_url":"https://api.github.com/users/murphycj/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-07-31T16:29:29Z","performed_via_github_app":null},{"id":3609307072,"node_id":"MDEyOkxhYmVsZWRFdmVudDM2MDkzMDcwNzI=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3609307072","actor":{"login":"dmatrix","id":1117597,"node_id":"MDQ6VXNlcjExMTc1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1117597?v=4","gravatar_id":"","url":"https://api.github.com/users/dmatrix","html_url":"https://github.com/dmatrix","followers_url":"https://api.github.com/users/dmatrix/followers","following_url":"https://api.github.com/users/dmatrix/following{/other_user}","gists_url":"https://api.github.com/users/dmatrix/gists{/gist_id}","starred_url":"https://api.github.com/users/dmatrix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmatrix/subscriptions","organizations_url":"https://api.github.com/users/dmatrix/orgs","repos_url":"https://api.github.com/users/dmatrix/repos","events_url":"https://api.github.com/users/dmatrix/events{/privacy}","received_events_url":"https://api.github.com/users/dmatrix/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-07-31T16:29:41Z","label":{"name":"needs author feedback","color":"fef2c0"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/667580491","html_url":"https://github.com/mlflow/mlflow/issues/3203#issuecomment-667580491","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/3203","id":667580491,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NzU4MDQ5MQ==","user":{"login":"murphycj","id":3837196,"node_id":"MDQ6VXNlcjM4MzcxOTY=","avatar_url":"https://avatars.githubusercontent.com/u/3837196?v=4","gravatar_id":"","url":"https://api.github.com/users/murphycj","html_url":"https://github.com/murphycj","followers_url":"https://api.github.com/users/murphycj/followers","following_url":"https://api.github.com/users/murphycj/following{/other_user}","gists_url":"https://api.github.com/users/murphycj/gists{/gist_id}","starred_url":"https://api.github.com/users/murphycj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/murphycj/subscriptions","organizations_url":"https://api.github.com/users/murphycj/orgs","repos_url":"https://api.github.com/users/murphycj/repos","events_url":"https://api.github.com/users/murphycj/events{/privacy}","received_events_url":"https://api.github.com/users/murphycj/received_events","type":"User","site_admin":false},"created_at":"2020-08-01T20:04:43Z","updated_at":"2020-08-01T20:06:07Z","author_association":"NONE","body":"@dmatrix Thanks for your reply. I did made your suggested modifications (see the code below), but I still get the same issue.\r\n\r\nI should also add I do have a MetricCallback class defined that gets called during training and I do have metrics being logged to mlflow. I thought that that might be part of the issue, but when I removed the callback it made no apparent difference.\r\n\r\n\r\n<details><summary>Click for my updated code</summary>\r\n<p>\r\n\r\n```python\r\nimport json\r\n\r\nfrom sklearn.model_selection import train_test_split\r\nimport tensorflow as tf\r\nimport mlflow\r\nfrom mlflow import tensorflow as mlt\r\nfrom mlflow.entities import Metric, Param\r\nfrom mlflow.tracking import MlflowClient\r\nimport talos\r\n\r\ntf.config.threading.set_intra_op_parallelism_threads(8)\r\ntf.config.threading.set_inter_op_parallelism_threads(8)\r\nAUTOTUNE = tf.data.experimental.AUTOTUNE\r\n\r\nconfig = json.load(open('config.json'))\r\n\r\nmlflow.set_tracking_uri(\r\n    'postgresql://{}:{}@{}:{}/mlflow'.format(\r\n        config['db']['USER'],\r\n        config['db']['PASSWORD'],\r\n        config['db']['HOST'],\r\n        config['db']['PORT']\r\n    ))\r\nmlt.autolog(1)\r\n\r\nclass MetricCallback(tf.keras.callbacks.Callback):\r\n\r\n    def __init__(self, mlflow_client, run_id):\r\n        self.mlflow_client=mlflow_client\r\n        self.run_id=run_id\r\n\r\n    def on_epoch_end(self, epoch, logs=None):\r\n\r\n        if not logs:\r\n            return\r\n\r\n        metrics = []\r\n\r\n        if logs.get('accuracy'):\r\n            metrics.append(\r\n                Metric(\r\n                    key='accuracy',\r\n                    value=float(logs['accuracy']),\r\n                    timestamp=0,\r\n                    step=epoch\r\n                    )\r\n            )\r\n\r\n        if logs.get('val_loss'):\r\n            metrics.append(\r\n                Metric(\r\n                    key='val_loss',\r\n                    value=float(logs['val_loss']),\r\n                    timestamp=0,\r\n                    step=epoch\r\n                    )\r\n            )\r\n\r\n        if logs.get('val_accuracy'):\r\n            metrics.append(\r\n                Metric(\r\n                    key='val_accuracy',\r\n                    value=float(logs['val_accuracy']),\r\n                    timestamp=0,\r\n                    step=epoch\r\n                    )\r\n            )\r\n\r\n        if metrics:\r\n            self.mlflow_client.log_batch(self.run_id, metrics=metrics)\r\n\r\n\r\ndef model_scan(x_train, y_train, x_val, y_val, params):\r\n\r\n    with mlflow.start_run(experiment_id='9', run_name='v3') as run:\r\n        mlflow_client = MlflowClient()\r\n        run_id = run.info.run_uuid\r\n\r\n        params_list = [Param(i[0], str(i[1])) for i in params.items()]\r\n        mlflow_client.log_batch(run_id, params=params_list)\r\n\r\n        dataset = load_data(x_train, y_train, params)\r\n        dataset_test = load_data(x_val, y_val, params)\r\n\r\n        dataset = dataset.prefetch(buffer_size=AUTOTUNE)\r\n        dataset_test = dataset_test.prefetch(buffer_size=AUTOTUNE)\r\n\r\n        print('fitting')\r\n        with tf.device('/CPU:0'):\r\n            model = model1(params)\r\n            model_history = model.fit(\r\n                dataset.repeat().batch(params['batch_size']),\r\n                epochs=params['epochs'],\r\n                steps_per_epoch=params['steps_per_epoch'],\r\n                validation_data=dataset_val.batch(params['batch_size']),\r\n                validation_freq=params['validation_freq'],\r\n                callbacks=[\r\n                    MetricCallback(mlflow_client=mlflow_client,run_id=run_id),\r\n                    talos.utils.early_stopper(params['epochs'])])\r\n\r\n        metrics = mlfow_finish(run_id, model, dataset_test, dataset_val, params, data)\r\n\r\n        mlflow_client.log_batch(run_id, metrics=metrics)\r\n\r\n    return model_history, model\r\n\r\nx_train, x_val, y_train, y_val = train_test_split(X, y, test_size=0.1)\r\n\r\nscan_object = talos.Scan(\r\n    x=x_train,\r\n    y=y_train,\r\n    model=model_scan,\r\n    params=params,\r\n    fraction_limit=0.1,\r\n    x_val=x_val,\r\n    y_val=y_val,\r\n    experiment_name='',\r\n    random_method='quantum')\r\n\r\n```\r\n</p>\r\n</details>","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/667580491/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"murphycj","id":3837196,"node_id":"MDQ6VXNlcjM4MzcxOTY=","avatar_url":"https://avatars.githubusercontent.com/u/3837196?v=4","gravatar_id":"","url":"https://api.github.com/users/murphycj","html_url":"https://github.com/murphycj","followers_url":"https://api.github.com/users/murphycj/followers","following_url":"https://api.github.com/users/murphycj/following{/other_user}","gists_url":"https://api.github.com/users/murphycj/gists{/gist_id}","starred_url":"https://api.github.com/users/murphycj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/murphycj/subscriptions","organizations_url":"https://api.github.com/users/murphycj/orgs","repos_url":"https://api.github.com/users/murphycj/repos","events_url":"https://api.github.com/users/murphycj/events{/privacy}","received_events_url":"https://api.github.com/users/murphycj/received_events","type":"User","site_admin":false}},{"id":3612411853,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzYxMjQxMTg1Mw==","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3612411853","actor":{"login":"dmatrix","id":1117597,"node_id":"MDQ6VXNlcjExMTc1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1117597?v=4","gravatar_id":"","url":"https://api.github.com/users/dmatrix","html_url":"https://github.com/dmatrix","followers_url":"https://api.github.com/users/dmatrix/followers","following_url":"https://api.github.com/users/dmatrix/following{/other_user}","gists_url":"https://api.github.com/users/dmatrix/gists{/gist_id}","starred_url":"https://api.github.com/users/dmatrix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmatrix/subscriptions","organizations_url":"https://api.github.com/users/dmatrix/orgs","repos_url":"https://api.github.com/users/dmatrix/repos","events_url":"https://api.github.com/users/dmatrix/events{/privacy}","received_events_url":"https://api.github.com/users/dmatrix/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-08-01T20:04:43Z","performed_via_github_app":null},{"id":3612411855,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM2MTI0MTE4NTU=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3612411855","actor":{"login":"dmatrix","id":1117597,"node_id":"MDQ6VXNlcjExMTc1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1117597?v=4","gravatar_id":"","url":"https://api.github.com/users/dmatrix","html_url":"https://github.com/dmatrix","followers_url":"https://api.github.com/users/dmatrix/followers","following_url":"https://api.github.com/users/dmatrix/following{/other_user}","gists_url":"https://api.github.com/users/dmatrix/gists{/gist_id}","starred_url":"https://api.github.com/users/dmatrix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmatrix/subscriptions","organizations_url":"https://api.github.com/users/dmatrix/orgs","repos_url":"https://api.github.com/users/dmatrix/repos","events_url":"https://api.github.com/users/dmatrix/events{/privacy}","received_events_url":"https://api.github.com/users/dmatrix/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-08-01T20:04:43Z","performed_via_github_app":null},{"id":3612411910,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50MzYxMjQxMTkxMA==","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3612411910","actor":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2020-08-01T20:04:46Z","label":{"name":"needs author feedback","color":"fef2c0"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/668121232","html_url":"https://github.com/mlflow/mlflow/issues/3203#issuecomment-668121232","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/3203","id":668121232,"node_id":"MDEyOklzc3VlQ29tbWVudDY2ODEyMTIzMg==","user":{"login":"dmatrix","id":1117597,"node_id":"MDQ6VXNlcjExMTc1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1117597?v=4","gravatar_id":"","url":"https://api.github.com/users/dmatrix","html_url":"https://github.com/dmatrix","followers_url":"https://api.github.com/users/dmatrix/followers","following_url":"https://api.github.com/users/dmatrix/following{/other_user}","gists_url":"https://api.github.com/users/dmatrix/gists{/gist_id}","starred_url":"https://api.github.com/users/dmatrix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmatrix/subscriptions","organizations_url":"https://api.github.com/users/dmatrix/orgs","repos_url":"https://api.github.com/users/dmatrix/repos","events_url":"https://api.github.com/users/dmatrix/events{/privacy}","received_events_url":"https://api.github.com/users/dmatrix/received_events","type":"User","site_admin":false},"created_at":"2020-08-03T16:36:36Z","updated_at":"2020-08-03T16:36:36Z","author_association":"CONTRIBUTOR","body":"I suspect the issue might be your [limited default connection pool ](https://stackoverflow.com/questions/30778015/how-to-increase-the-max-connections-in-postgres)is exhausted. A similar issue wrt to [SQLALchemy DB](https://github.com/mlflow/mlflow/issues/1452) was resolved. \r\n\r\nDo you want to try[ expanding connections pool](https://mlflow.org/docs/latest/tracking.html#sqlalchemy-options) and setting these environment variables?","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/668121232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dmatrix","id":1117597,"node_id":"MDQ6VXNlcjExMTc1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1117597?v=4","gravatar_id":"","url":"https://api.github.com/users/dmatrix","html_url":"https://github.com/dmatrix","followers_url":"https://api.github.com/users/dmatrix/followers","following_url":"https://api.github.com/users/dmatrix/following{/other_user}","gists_url":"https://api.github.com/users/dmatrix/gists{/gist_id}","starred_url":"https://api.github.com/users/dmatrix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmatrix/subscriptions","organizations_url":"https://api.github.com/users/dmatrix/orgs","repos_url":"https://api.github.com/users/dmatrix/repos","events_url":"https://api.github.com/users/dmatrix/events{/privacy}","received_events_url":"https://api.github.com/users/dmatrix/received_events","type":"User","site_admin":false}},{"id":3616714345,"node_id":"MDEyOkxhYmVsZWRFdmVudDM2MTY3MTQzNDU=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3616714345","actor":{"login":"dmatrix","id":1117597,"node_id":"MDQ6VXNlcjExMTc1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1117597?v=4","gravatar_id":"","url":"https://api.github.com/users/dmatrix","html_url":"https://github.com/dmatrix","followers_url":"https://api.github.com/users/dmatrix/followers","following_url":"https://api.github.com/users/dmatrix/following{/other_user}","gists_url":"https://api.github.com/users/dmatrix/gists{/gist_id}","starred_url":"https://api.github.com/users/dmatrix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmatrix/subscriptions","organizations_url":"https://api.github.com/users/dmatrix/orgs","repos_url":"https://api.github.com/users/dmatrix/repos","events_url":"https://api.github.com/users/dmatrix/events{/privacy}","received_events_url":"https://api.github.com/users/dmatrix/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-08-03T16:36:46Z","label":{"name":"needs author feedback","color":"fef2c0"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/676838346","html_url":"https://github.com/mlflow/mlflow/issues/3203#issuecomment-676838346","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/3203","id":676838346,"node_id":"MDEyOklzc3VlQ29tbWVudDY3NjgzODM0Ng==","user":{"login":"murphycj","id":3837196,"node_id":"MDQ6VXNlcjM4MzcxOTY=","avatar_url":"https://avatars.githubusercontent.com/u/3837196?v=4","gravatar_id":"","url":"https://api.github.com/users/murphycj","html_url":"https://github.com/murphycj","followers_url":"https://api.github.com/users/murphycj/followers","following_url":"https://api.github.com/users/murphycj/following{/other_user}","gists_url":"https://api.github.com/users/murphycj/gists{/gist_id}","starred_url":"https://api.github.com/users/murphycj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/murphycj/subscriptions","organizations_url":"https://api.github.com/users/murphycj/orgs","repos_url":"https://api.github.com/users/murphycj/repos","events_url":"https://api.github.com/users/murphycj/events{/privacy}","received_events_url":"https://api.github.com/users/murphycj/received_events","type":"User","site_admin":false},"created_at":"2020-08-20T01:10:13Z","updated_at":"2020-08-20T01:10:13Z","author_association":"NONE","body":"@dmatrix Sorry for belated reply, just been busy. I tried your new suggestion via the following:\r\n\r\n```\r\nexport MLFLOW_SQLALCHEMYSTORE_POOL_SIZE=1\r\nexport MLFLOW_SQLALCHEMYSTORE_MAX_OVERFLOW=1\r\n```\r\n\r\nMlflow does seem to recognize that I set those options because before each epoch it prints out this message:\r\n\r\n```\r\n2020/08/20 01:00:58 INFO mlflow.store.db.utils: Create SQLAlchemy engine with pool options {'pool_size': 1, 'max_overflow': 1}\r\n```\r\n\r\nHowever, that still does not seem to work. I am still getting the number of connections going up to ~15-20. It seems that it creates a new connection for each epoch, but after a dozen or two epochs it resets the number of connections.","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/676838346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"murphycj","id":3837196,"node_id":"MDQ6VXNlcjM4MzcxOTY=","avatar_url":"https://avatars.githubusercontent.com/u/3837196?v=4","gravatar_id":"","url":"https://api.github.com/users/murphycj","html_url":"https://github.com/murphycj","followers_url":"https://api.github.com/users/murphycj/followers","following_url":"https://api.github.com/users/murphycj/following{/other_user}","gists_url":"https://api.github.com/users/murphycj/gists{/gist_id}","starred_url":"https://api.github.com/users/murphycj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/murphycj/subscriptions","organizations_url":"https://api.github.com/users/murphycj/orgs","repos_url":"https://api.github.com/users/murphycj/repos","events_url":"https://api.github.com/users/murphycj/events{/privacy}","received_events_url":"https://api.github.com/users/murphycj/received_events","type":"User","site_admin":false}},{"id":3673120533,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzY3MzEyMDUzMw==","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3673120533","actor":{"login":"dmatrix","id":1117597,"node_id":"MDQ6VXNlcjExMTc1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1117597?v=4","gravatar_id":"","url":"https://api.github.com/users/dmatrix","html_url":"https://github.com/dmatrix","followers_url":"https://api.github.com/users/dmatrix/followers","following_url":"https://api.github.com/users/dmatrix/following{/other_user}","gists_url":"https://api.github.com/users/dmatrix/gists{/gist_id}","starred_url":"https://api.github.com/users/dmatrix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmatrix/subscriptions","organizations_url":"https://api.github.com/users/dmatrix/orgs","repos_url":"https://api.github.com/users/dmatrix/repos","events_url":"https://api.github.com/users/dmatrix/events{/privacy}","received_events_url":"https://api.github.com/users/dmatrix/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-08-20T01:10:13Z","performed_via_github_app":null},{"id":3673120534,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM2NzMxMjA1MzQ=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3673120534","actor":{"login":"dmatrix","id":1117597,"node_id":"MDQ6VXNlcjExMTc1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1117597?v=4","gravatar_id":"","url":"https://api.github.com/users/dmatrix","html_url":"https://github.com/dmatrix","followers_url":"https://api.github.com/users/dmatrix/followers","following_url":"https://api.github.com/users/dmatrix/following{/other_user}","gists_url":"https://api.github.com/users/dmatrix/gists{/gist_id}","starred_url":"https://api.github.com/users/dmatrix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmatrix/subscriptions","organizations_url":"https://api.github.com/users/dmatrix/orgs","repos_url":"https://api.github.com/users/dmatrix/repos","events_url":"https://api.github.com/users/dmatrix/events{/privacy}","received_events_url":"https://api.github.com/users/dmatrix/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-08-20T01:10:13Z","performed_via_github_app":null},{"id":3673120592,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50MzY3MzEyMDU5Mg==","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3673120592","actor":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2020-08-20T01:10:14Z","label":{"name":"needs author feedback","color":"fef2c0"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/676838757","html_url":"https://github.com/mlflow/mlflow/issues/3203#issuecomment-676838757","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/3203","id":676838757,"node_id":"MDEyOklzc3VlQ29tbWVudDY3NjgzODc1Nw==","user":{"login":"murphycj","id":3837196,"node_id":"MDQ6VXNlcjM4MzcxOTY=","avatar_url":"https://avatars.githubusercontent.com/u/3837196?v=4","gravatar_id":"","url":"https://api.github.com/users/murphycj","html_url":"https://github.com/murphycj","followers_url":"https://api.github.com/users/murphycj/followers","following_url":"https://api.github.com/users/murphycj/following{/other_user}","gists_url":"https://api.github.com/users/murphycj/gists{/gist_id}","starred_url":"https://api.github.com/users/murphycj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/murphycj/subscriptions","organizations_url":"https://api.github.com/users/murphycj/orgs","repos_url":"https://api.github.com/users/murphycj/repos","events_url":"https://api.github.com/users/murphycj/events{/privacy}","received_events_url":"https://api.github.com/users/murphycj/received_events","type":"User","site_admin":false},"created_at":"2020-08-20T01:11:44Z","updated_at":"2020-08-20T01:11:44Z","author_association":"NONE","body":"I should also add that I did try setting those values to something else like below and it also did not help:\r\n\r\n```\r\nexport MLFLOW_SQLALCHEMYSTORE_POOL_SIZE=10\r\nexport MLFLOW_SQLALCHEMYSTORE_MAX_OVERFLOW=10\r\n```","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/676838757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"murphycj","id":3837196,"node_id":"MDQ6VXNlcjM4MzcxOTY=","avatar_url":"https://avatars.githubusercontent.com/u/3837196?v=4","gravatar_id":"","url":"https://api.github.com/users/murphycj","html_url":"https://github.com/murphycj","followers_url":"https://api.github.com/users/murphycj/followers","following_url":"https://api.github.com/users/murphycj/following{/other_user}","gists_url":"https://api.github.com/users/murphycj/gists{/gist_id}","starred_url":"https://api.github.com/users/murphycj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/murphycj/subscriptions","organizations_url":"https://api.github.com/users/murphycj/orgs","repos_url":"https://api.github.com/users/murphycj/repos","events_url":"https://api.github.com/users/murphycj/events{/privacy}","received_events_url":"https://api.github.com/users/murphycj/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/920348704","html_url":"https://github.com/mlflow/mlflow/issues/3203#issuecomment-920348704","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/3203","id":920348704,"node_id":"IC_kwDOCB5Jx84222gg","user":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false},"created_at":"2021-09-15T20:21:16Z","updated_at":"2021-09-15T20:21:16Z","author_association":"COLLABORATOR","body":"Resolved by https://github.com/mlflow/mlflow/pull/4663.","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/920348704/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false}},{"id":5308355763,"node_id":"CE_lADOCB5Jx84n5OCrzwAAAAE8ZxSz","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/5308355763","actor":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-09-15T20:21:17Z","state_reason":null,"performed_via_github_app":null}]