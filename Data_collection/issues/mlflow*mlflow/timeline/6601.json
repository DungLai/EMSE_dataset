[{"id":7264172500,"node_id":"LE_lADOCB5Jx85QkRjNzwAAAAGw-nnU","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7264172500","actor":{"login":"stobias123","id":590677,"node_id":"MDQ6VXNlcjU5MDY3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/590677?v=4","gravatar_id":"","url":"https://api.github.com/users/stobias123","html_url":"https://github.com/stobias123","followers_url":"https://api.github.com/users/stobias123/followers","following_url":"https://api.github.com/users/stobias123/following{/other_user}","gists_url":"https://api.github.com/users/stobias123/gists{/gist_id}","starred_url":"https://api.github.com/users/stobias123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stobias123/subscriptions","organizations_url":"https://api.github.com/users/stobias123/orgs","repos_url":"https://api.github.com/users/stobias123/repos","events_url":"https://api.github.com/users/stobias123/events{/privacy}","received_events_url":"https://api.github.com/users/stobias123/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-08-26T03:08:55Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"id":7264173529,"node_id":"LE_lADOCB5Jx85QkRjNzwAAAAGw-n3Z","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7264173529","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-08-26T03:09:15Z","label":{"name":"area/docker","color":"ede978"},"performed_via_github_app":null},{"id":7264173530,"node_id":"LE_lADOCB5Jx85QkRjNzwAAAAGw-n3a","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7264173530","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-08-26T03:09:15Z","label":{"name":"area/models","color":"48eabc"},"performed_via_github_app":null},{"id":7264173532,"node_id":"LE_lADOCB5Jx85QkRjNzwAAAAGw-n3c","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7264173532","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-08-26T03:09:15Z","label":{"name":"integrations/sagemaker","color":"ffbce5"},"performed_via_github_app":null},{"id":7264173593,"node_id":"UNLE_lADOCB5Jx85QkRjNzwAAAAGw-n4Z","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7264173593","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2022-08-26T03:09:17Z","label":{"name":"integrations/sagemaker","color":"ffbce5"},"performed_via_github_app":null},{"id":7269506352,"node_id":"RTE_lADOCB5Jx85QkRjNzwAAAAGxS90w","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7269506352","actor":{"login":"stobias123","id":590677,"node_id":"MDQ6VXNlcjU5MDY3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/590677?v=4","gravatar_id":"","url":"https://api.github.com/users/stobias123","html_url":"https://github.com/stobias123","followers_url":"https://api.github.com/users/stobias123/followers","following_url":"https://api.github.com/users/stobias123/following{/other_user}","gists_url":"https://api.github.com/users/stobias123/gists{/gist_id}","starred_url":"https://api.github.com/users/stobias123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stobias123/subscriptions","organizations_url":"https://api.github.com/users/stobias123/orgs","repos_url":"https://api.github.com/users/stobias123/repos","events_url":"https://api.github.com/users/stobias123/events{/privacy}","received_events_url":"https://api.github.com/users/stobias123/received_events","type":"User","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2022-08-26T18:10:16Z","rename":{"from":"[BUG]","to":"[BUG] - Can't deploy pytorch trained on GPU"},"performed_via_github_app":null},{"id":7269507232,"node_id":"RTE_lADOCB5Jx85QkRjNzwAAAAGxS-Cg","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7269507232","actor":{"login":"stobias123","id":590677,"node_id":"MDQ6VXNlcjU5MDY3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/590677?v=4","gravatar_id":"","url":"https://api.github.com/users/stobias123","html_url":"https://github.com/stobias123","followers_url":"https://api.github.com/users/stobias123/followers","following_url":"https://api.github.com/users/stobias123/following{/other_user}","gists_url":"https://api.github.com/users/stobias123/gists{/gist_id}","starred_url":"https://api.github.com/users/stobias123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stobias123/subscriptions","organizations_url":"https://api.github.com/users/stobias123/orgs","repos_url":"https://api.github.com/users/stobias123/repos","events_url":"https://api.github.com/users/stobias123/events{/privacy}","received_events_url":"https://api.github.com/users/stobias123/received_events","type":"User","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2022-08-26T18:10:27Z","rename":{"from":"[BUG] - Can't deploy pytorch trained on GPU","to":"[BUG] - Sagemaker - Can't deploy CPU pytorch trained on GPU"},"performed_via_github_app":null},{"id":7269508196,"node_id":"LE_lADOCB5Jx85QkRjNzwAAAAGxS-Rk","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7269508196","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-08-26T18:10:37Z","label":{"name":"integrations/sagemaker","color":"ffbce5"},"performed_via_github_app":null},{"id":7269508208,"node_id":"RTE_lADOCB5Jx85QkRjNzwAAAAGxS-Rw","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7269508208","actor":{"login":"stobias123","id":590677,"node_id":"MDQ6VXNlcjU5MDY3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/590677?v=4","gravatar_id":"","url":"https://api.github.com/users/stobias123","html_url":"https://github.com/stobias123","followers_url":"https://api.github.com/users/stobias123/followers","following_url":"https://api.github.com/users/stobias123/following{/other_user}","gists_url":"https://api.github.com/users/stobias123/gists{/gist_id}","starred_url":"https://api.github.com/users/stobias123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stobias123/subscriptions","organizations_url":"https://api.github.com/users/stobias123/orgs","repos_url":"https://api.github.com/users/stobias123/repos","events_url":"https://api.github.com/users/stobias123/events{/privacy}","received_events_url":"https://api.github.com/users/stobias123/received_events","type":"User","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2022-08-26T18:10:37Z","rename":{"from":"[BUG] - Sagemaker - Can't deploy CPU pytorch trained on GPU","to":"[BUG] - Sagemaker - Can't deploy pytorch model trained on GPU to CPU"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1231143569","html_url":"https://github.com/mlflow/mlflow/issues/6601#issuecomment-1231143569","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/6601","id":1231143569,"node_id":"IC_kwDOCB5Jx85JYcKR","user":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false},"created_at":"2022-08-30T05:01:51Z","updated_at":"2022-08-30T05:01:51Z","author_association":"COLLABORATOR","body":"Hi @stobias123, thank you for raising this issue. The best solution available at the moment is to create a custom python model with custom loading logic as follows:\r\n\r\n```\r\nimport mlflow.pyfunc\r\n\r\nclass CPUCompatibleModel(mlflow.pyfunc.PythonModel):\r\n    def load_context(self, context):\r\n        import torch\r\n        import mlflow.pytorch\r\n        \r\n        if torch.cuda.is_available():\r\n            self.torch_model = mlflow.pytorch._load_pyfunc(context.artifacts[\"torch_model\"])\r\n        else:\r\n            self.torch_model = mlflow.pytorch._load_pyfunc(\r\n                context.artifacts[\"torch_model\"],\r\n                map_location=torch.device('cpu')\r\n            )\r\n\r\n    def predict(self, context, model_input):\r\n        return self.torch_model.predict(model_input)\r\n\r\ncompatible_model = mlflow.pyfunc.log_model(\r\n    python_model=CPUCompatibleModel(),\r\n    artifacts={\r\n        \"torch_model\": \"models:/Multi-Vehicle/1\"\r\n    },\r\n)\r\n\r\nprint(compatible_model.model_uri)\r\n```\r\n\r\nThen, you should be able to run `mlflow sagemaker run-local` with the model URI output by the above script. Please let me know if this helps and feel free to reopen the issue if this solution does not resolve the problem. Thank you for using MLflow!","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1231143569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false}},{"id":7283907184,"node_id":"CE_lADOCB5Jx85QkRjNzwAAAAGyJ5pw","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7283907184","actor":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-08-30T05:01:51Z","state_reason":null,"performed_via_github_app":null},{"id":7283907203,"node_id":"MEE_lADOCB5Jx85QkRjNzwAAAAGyJ5qD","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7283907203","actor":{"login":"stobias123","id":590677,"node_id":"MDQ6VXNlcjU5MDY3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/590677?v=4","gravatar_id":"","url":"https://api.github.com/users/stobias123","html_url":"https://github.com/stobias123","followers_url":"https://api.github.com/users/stobias123/followers","following_url":"https://api.github.com/users/stobias123/following{/other_user}","gists_url":"https://api.github.com/users/stobias123/gists{/gist_id}","starred_url":"https://api.github.com/users/stobias123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stobias123/subscriptions","organizations_url":"https://api.github.com/users/stobias123/orgs","repos_url":"https://api.github.com/users/stobias123/repos","events_url":"https://api.github.com/users/stobias123/events{/privacy}","received_events_url":"https://api.github.com/users/stobias123/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-08-30T05:01:52Z","performed_via_github_app":null},{"id":7283907211,"node_id":"SE_lADOCB5Jx85QkRjNzwAAAAGyJ5qL","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7283907211","actor":{"login":"stobias123","id":590677,"node_id":"MDQ6VXNlcjU5MDY3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/590677?v=4","gravatar_id":"","url":"https://api.github.com/users/stobias123","html_url":"https://github.com/stobias123","followers_url":"https://api.github.com/users/stobias123/followers","following_url":"https://api.github.com/users/stobias123/following{/other_user}","gists_url":"https://api.github.com/users/stobias123/gists{/gist_id}","starred_url":"https://api.github.com/users/stobias123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stobias123/subscriptions","organizations_url":"https://api.github.com/users/stobias123/orgs","repos_url":"https://api.github.com/users/stobias123/repos","events_url":"https://api.github.com/users/stobias123/events{/privacy}","received_events_url":"https://api.github.com/users/stobias123/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-08-30T05:01:52Z","performed_via_github_app":null}]