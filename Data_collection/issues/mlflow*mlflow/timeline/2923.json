[{"id":3434026748,"node_id":"MDEyOkxhYmVsZWRFdmVudDM0MzQwMjY3NDg=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3434026748","actor":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-06-11T12:58:05Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"id":3475214713,"node_id":"MDEyOkxhYmVsZWRFdmVudDM0NzUyMTQ3MTM=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3475214713","actor":{"login":"pogil","id":595774,"node_id":"MDQ6VXNlcjU5NTc3NA==","avatar_url":"https://avatars.githubusercontent.com/u/595774?v=4","gravatar_id":"","url":"https://api.github.com/users/pogil","html_url":"https://github.com/pogil","followers_url":"https://api.github.com/users/pogil/followers","following_url":"https://api.github.com/users/pogil/following{/other_user}","gists_url":"https://api.github.com/users/pogil/gists{/gist_id}","starred_url":"https://api.github.com/users/pogil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pogil/subscriptions","organizations_url":"https://api.github.com/users/pogil/orgs","repos_url":"https://api.github.com/users/pogil/repos","events_url":"https://api.github.com/users/pogil/events{/privacy}","received_events_url":"https://api.github.com/users/pogil/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-06-23T23:48:59Z","label":{"name":"area/sqlalchemy","color":"ede978"},"performed_via_github_app":null},{"id":3475214715,"node_id":"MDEyOkxhYmVsZWRFdmVudDM0NzUyMTQ3MTU=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3475214715","actor":{"login":"pogil","id":595774,"node_id":"MDQ6VXNlcjU5NTc3NA==","avatar_url":"https://avatars.githubusercontent.com/u/595774?v=4","gravatar_id":"","url":"https://api.github.com/users/pogil","html_url":"https://github.com/pogil","followers_url":"https://api.github.com/users/pogil/followers","following_url":"https://api.github.com/users/pogil/following{/other_user}","gists_url":"https://api.github.com/users/pogil/gists{/gist_id}","starred_url":"https://api.github.com/users/pogil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pogil/subscriptions","organizations_url":"https://api.github.com/users/pogil/orgs","repos_url":"https://api.github.com/users/pogil/repos","events_url":"https://api.github.com/users/pogil/events{/privacy}","received_events_url":"https://api.github.com/users/pogil/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-06-23T23:48:59Z","label":{"name":"area/tracking","color":"48eabc"},"performed_via_github_app":null},{"id":3526191574,"node_id":"MDEyOkxhYmVsZWRFdmVudDM1MjYxOTE1NzQ=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3526191574","actor":{"login":"AveshCSingh","id":1208791,"node_id":"MDQ6VXNlcjEyMDg3OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1208791?v=4","gravatar_id":"","url":"https://api.github.com/users/AveshCSingh","html_url":"https://github.com/AveshCSingh","followers_url":"https://api.github.com/users/AveshCSingh/followers","following_url":"https://api.github.com/users/AveshCSingh/following{/other_user}","gists_url":"https://api.github.com/users/AveshCSingh/gists{/gist_id}","starred_url":"https://api.github.com/users/AveshCSingh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AveshCSingh/subscriptions","organizations_url":"https://api.github.com/users/AveshCSingh/orgs","repos_url":"https://api.github.com/users/AveshCSingh/repos","events_url":"https://api.github.com/users/AveshCSingh/events{/privacy}","received_events_url":"https://api.github.com/users/AveshCSingh/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-07-08T17:04:50Z","label":{"name":"priority/backlog","color":"534cb5"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/679321747","html_url":"https://github.com/mlflow/mlflow/issues/2923#issuecomment-679321747","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/2923","id":679321747,"node_id":"MDEyOklzc3VlQ29tbWVudDY3OTMyMTc0Nw==","user":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false},"created_at":"2020-08-24T19:29:52Z","updated_at":"2020-08-25T07:46:16Z","author_association":"NONE","body":"Update: have been ignoring this issue for some time thanks to containers that make it easy to rollback to a last working version. \r\n\r\nBut now after upgrading MariaDB database used by MLflow Tracking from v10.3 (via v10.4) to v10.5 (using its dedicated tool `mysql_upgrade`) I've found that only the original container with `mlflow==1.3` (`mirekphd/ml-mlflow:20191024`) and `SQLalchemy==1.3.10` works correctly with the upgraded database. Newer containers (e.g. `mirekphd/ml-mlflow:20200824`) with newer `mlflow==1.10.0` and `SQLAlchemy==1.3.13`) do not, still raising the \"Detected out-of-date database schema\" error:\r\n\r\n```\r\n2020/08/24 19:25:53 ERROR mlflow.cli: Error initializing backend store\r\n2020/08/24 19:25:53 ERROR mlflow.cli: Detected out-of-date database schema (found version 89d4b8295536, but expected 27a6a02d2cf1). Take a backup of your database, then run 'mlflow db upgrade <database_uri>' to migrate your database to the latest schema. NOTE: schema migration may result in database downtime - please consult your database's documentation for more detail.\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.8/dist-packages/mlflow/cli.py\", line 291, in server\r\n    initialize_backend_stores(backend_store_uri, default_artifact_root)\r\n  File \"/usr/local/lib/python3.8/dist-packages/mlflow/server/handlers.py\", line 105, in initialize_backend_stores\r\n    _get_tracking_store(backend_store_uri, default_artifact_root)\r\n  File \"/usr/local/lib/python3.8/dist-packages/mlflow/server/handlers.py\", line 91, in _get_tracking_store\r\n    _tracking_store = _tracking_store_registry.get_store(store_uri, artifact_root)\r\n  File \"/usr/local/lib/python3.8/dist-packages/mlflow/tracking/_tracking_service/registry.py\", line 37, in get_store\r\n    return builder(store_uri=store_uri, artifact_uri=artifact_uri)\r\n  File \"/usr/local/lib/python3.8/dist-packages/mlflow/server/handlers.py\", line 64, in _get_sqlalchemy_store\r\n    return SqlAlchemyStore(store_uri, artifact_uri)\r\n  File \"/usr/local/lib/python3.8/dist-packages/mlflow/store/tracking/sqlalchemy_store.py\", line 104, in __init__\r\n    mlflow.store.db.utils._verify_schema(self.engine)\r\n  File \"/usr/local/lib/python3.8/dist-packages/mlflow/store/db/utils.py\", line 51, in _verify_schema\r\n    raise MlflowException(\r\nmlflow.exceptions.MlflowException: Detected out-of-date database schema (found version 89d4b8295536, but expected 27a6a02d2cf1). Take a backup of your database, then run 'mlflow db upgrade <database_uri>' to migrate your database to the latest schema. NOTE: schema migration may result in database downtime - please consult your database's documentation for more detail.\r\n```\r\n\r\nThis problem is not restricted to mlflow, but extends to other packages using SQLAlchemy - such as Optuna - it too cannot access this particular MariaDB database that MLflow has still problems with, giving me the following error:\r\n```\r\nRuntimeError: The runtime optuna version 2.0.0 is no longer compatible with the table schema (set up by optuna 2.0.0). Please try updating optuna to the latest version by `$ pip install -U optuna`.\r\n```\r\n\r\nIt is not even due to a versions mismatch, because precisely the same database version (10.5.5) works when created from scratch (rather than going through a database migration process from v10.3 used by MLflow), i.e. it can be correctly accessed by Optuna through the latest SQLAlchemy (1.3.19). \r\n\r\nSo may be an SQLAlchemy bug introduced after version 1.3.10, but it manifests itself only after database version upgrade (edit: downgrading SQLAlchemy to 1.3.10 did not help - see below).\r\n","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/679321747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/679327795","html_url":"https://github.com/mlflow/mlflow/issues/2923#issuecomment-679327795","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/2923","id":679327795,"node_id":"MDEyOklzc3VlQ29tbWVudDY3OTMyNzc5NQ==","user":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false},"created_at":"2020-08-24T19:43:05Z","updated_at":"2020-08-24T21:09:08Z","author_association":"NONE","body":"I've gone through the docker build logs of the errorring container (`mirekphd:ml-mlflow:20200824`) and found this strange condition in `pip install` output (notice the inequality in the incorrect direction!) that sets back SQLAlchemy by 7 months from its latest version `1.3.19` (and I do not pin anything apart from `mlflow==1.10.0` in this container):\r\n```\r\nCollecting sqlalchemy<=1.3.13\r\n  Downloading SQLAlchemy-1.3.13.tar.gz (6.0 MB)\r\n```\r\nBut either downgrading SQLAlchemy to 1.3.10 or upgrading it to the latest 1.3.19 did not resolve the issue (the latter was expected, given that the bug occurs also for the latest version in case of Optuna).","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/679327795/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/679879389","html_url":"https://github.com/mlflow/mlflow/issues/2923#issuecomment-679879389","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/2923","id":679879389,"node_id":"MDEyOklzc3VlQ29tbWVudDY3OTg3OTM4OQ==","user":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false},"created_at":"2020-08-25T08:19:25Z","updated_at":"2020-08-25T08:19:25Z","author_association":"NONE","body":"Let us find the newest working version of mlflow then. \r\n\r\nI rebuilt the `mirekphd/ml-mlflow` container using the code from the last working version (container tag 20191024), where mlflow was pinned at 1.3.0. It works OK (recognizes MariaDB database upgrade from 1.3 via 1.4 to 1.5). Now for other versions.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/679879389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/679906307","html_url":"https://github.com/mlflow/mlflow/issues/2923#issuecomment-679906307","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/2923","id":679906307,"node_id":"MDEyOklzc3VlQ29tbWVudDY3OTkwNjMwNw==","user":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false},"created_at":"2020-08-25T09:12:57Z","updated_at":"2020-08-25T10:31:31Z","author_association":"NONE","body":"So even a minor version upgrade of mlflow causes the \"out-of-date database schema\" error, and in the error message the \"expected version\" stays the same, while the \"found version\" changes with each mlflow version. The hashes corresponding to mlflow versions that are displayed in the error message (instead of mlflow versions for example...) are hard-coded in mflow [here](https://github.com/mlflow/mlflow/tree/master/mlflow/store/db_migrations/versions).\r\n\r\nSo as long as you keep mlflow version constant (pinned), it would continue to work through any database upgrade (at least by two series / minor versions). The need to \"migrate database schema\" using `mlflow db upgrade` is completely independent from the need to migrate the database itself (upgrade it using its dedicated tool such as `mysql_upgrade`).\r\n\r\nCould someone please add this or similar explanation to the docs, @harupy, @AveshCSingh?\r\n","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/679906307/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/679941760","html_url":"https://github.com/mlflow/mlflow/issues/2923#issuecomment-679941760","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/2923","id":679941760,"node_id":"MDEyOklzc3VlQ29tbWVudDY3OTk0MTc2MA==","user":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false},"created_at":"2020-08-25T10:27:05Z","updated_at":"2020-08-25T10:30:01Z","author_association":"NONE","body":"So I finally modified the container template to replace the entrypoint so as to run `mlflow db upgrade <sqlalchemy_db_conn_str>` instead of `mlflow server <params>`, using the desired new version of `mlflow==1.10.0`, \r\n\r\nIt printed this message (which is [apparently](https://docs.openstack.org/networking-sfc/ocata/alembic_migration.html) normal): \r\n```\r\n2020/08/25 10:07:33 INFO mlflow.store.db.utils: Updating database tables\r\nINFO  [alembic.runtime.migration] Context impl MySQLImpl.\r\nINFO  [alembic.runtime.migration] Will assume non-transactional DDL.\r\n```\r\n\r\n... and then I was eventually able to run the standard MLflow container (`mirekphd/ml-mlflow:20200825`), and display all previously archived metrics and params data (served by MariaDB migrated earlier independently to 10.5) in this new mlflow version.\r\n\r\nCaution: please be aware that I performed database upgrade independently (using dedicated tool, `mysql_upgrade`) before trying this migration using `mlflow db upgrade`, so if you skip the former step, a new database version will most likely refuse to recognize existing data committed using an older database version.","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/679941760/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false}},{"id":3689423060,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzY4OTQyMzA2MA==","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3689423060","actor":{"login":"harupy","id":17039389,"node_id":"MDQ6VXNlcjE3MDM5Mzg5","avatar_url":"https://avatars.githubusercontent.com/u/17039389?v=4","gravatar_id":"","url":"https://api.github.com/users/harupy","html_url":"https://github.com/harupy","followers_url":"https://api.github.com/users/harupy/followers","following_url":"https://api.github.com/users/harupy/following{/other_user}","gists_url":"https://api.github.com/users/harupy/gists{/gist_id}","starred_url":"https://api.github.com/users/harupy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harupy/subscriptions","organizations_url":"https://api.github.com/users/harupy/orgs","repos_url":"https://api.github.com/users/harupy/repos","events_url":"https://api.github.com/users/harupy/events{/privacy}","received_events_url":"https://api.github.com/users/harupy/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-08-25T10:31:32Z","performed_via_github_app":null},{"id":3689423067,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM2ODk0MjMwNjc=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3689423067","actor":{"login":"harupy","id":17039389,"node_id":"MDQ6VXNlcjE3MDM5Mzg5","avatar_url":"https://avatars.githubusercontent.com/u/17039389?v=4","gravatar_id":"","url":"https://api.github.com/users/harupy","html_url":"https://github.com/harupy","followers_url":"https://api.github.com/users/harupy/followers","following_url":"https://api.github.com/users/harupy/following{/other_user}","gists_url":"https://api.github.com/users/harupy/gists{/gist_id}","starred_url":"https://api.github.com/users/harupy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harupy/subscriptions","organizations_url":"https://api.github.com/users/harupy/orgs","repos_url":"https://api.github.com/users/harupy/repos","events_url":"https://api.github.com/users/harupy/events{/privacy}","received_events_url":"https://api.github.com/users/harupy/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-08-25T10:31:32Z","performed_via_github_app":null},{"id":3689423070,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzY4OTQyMzA3MA==","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3689423070","actor":{"login":"AveshCSingh","id":1208791,"node_id":"MDQ6VXNlcjEyMDg3OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1208791?v=4","gravatar_id":"","url":"https://api.github.com/users/AveshCSingh","html_url":"https://github.com/AveshCSingh","followers_url":"https://api.github.com/users/AveshCSingh/followers","following_url":"https://api.github.com/users/AveshCSingh/following{/other_user}","gists_url":"https://api.github.com/users/AveshCSingh/gists{/gist_id}","starred_url":"https://api.github.com/users/AveshCSingh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AveshCSingh/subscriptions","organizations_url":"https://api.github.com/users/AveshCSingh/orgs","repos_url":"https://api.github.com/users/AveshCSingh/repos","events_url":"https://api.github.com/users/AveshCSingh/events{/privacy}","received_events_url":"https://api.github.com/users/AveshCSingh/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-08-25T10:31:32Z","performed_via_github_app":null},{"id":3689423071,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM2ODk0MjMwNzE=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3689423071","actor":{"login":"AveshCSingh","id":1208791,"node_id":"MDQ6VXNlcjEyMDg3OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1208791?v=4","gravatar_id":"","url":"https://api.github.com/users/AveshCSingh","html_url":"https://github.com/AveshCSingh","followers_url":"https://api.github.com/users/AveshCSingh/followers","following_url":"https://api.github.com/users/AveshCSingh/following{/other_user}","gists_url":"https://api.github.com/users/AveshCSingh/gists{/gist_id}","starred_url":"https://api.github.com/users/AveshCSingh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AveshCSingh/subscriptions","organizations_url":"https://api.github.com/users/AveshCSingh/orgs","repos_url":"https://api.github.com/users/AveshCSingh/repos","events_url":"https://api.github.com/users/AveshCSingh/events{/privacy}","received_events_url":"https://api.github.com/users/AveshCSingh/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-08-25T10:31:32Z","performed_via_github_app":null},{"id":3689423270,"node_id":"MDExOkNsb3NlZEV2ZW50MzY4OTQyMzI3MA==","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/3689423270","actor":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-08-25T10:31:36Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/684808578","html_url":"https://github.com/mlflow/mlflow/issues/2923#issuecomment-684808578","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/2923","id":684808578,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NDgwODU3OA==","user":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false},"created_at":"2020-09-01T12:15:01Z","updated_at":"2020-09-01T12:15:01Z","author_association":"NONE","body":"I've also found the reason why optuna clashes with mlflow, raising this error (in its latest stable version of 2.0.0):\r\n```\r\nRuntimeError: The runtime optuna version 2.0.0 is no longer compatible with the table schema (set up by optuna 2.0.0). Please try updating optuna to the latest version by `$ pip install -U optuna`.\r\n```\r\n\r\nThe reason is that both mlflow and optuna store their database schema versions (courtesy of Alembic) in the same database table named `alembic_version`, overwriting each other's versions and making it impossible to use them together (at least in the same database).\r\n\r\nHere's the database \"claimed\" by MLflow (where Optuna won't work - raising the avove error - and won't permit a db schema upgrade - raising the below error - with MLflow db upgrade causing data loss for most Optuna users unless they can manually patch the version to one of the versions recognized by Optuna, e.g. v1.3.0.a):\r\n\r\n```\r\nMariaDB [mariadb]> select * from alembic_version;\r\n+--------------+\r\n| version_num  |\r\n+--------------+\r\n| 27a6a02d2cf1 |\r\n+--------------+\r\n```\r\n\r\nRunning `get_all_versions()` from Optuna's [_StorageUpgrade class](https://github.com/optuna/optuna/blob/master/optuna/cli.py#L318) reveals versions expected by Optuna:\r\n```\r\nknown_versions: ['v1.3.0.a', 'v1.2.0.a', 'v0.9.0.a']\r\n```\r\n\r\nAnd indeed the identical version of MariaDB database (10.5.5) where Optuna does work, has this value of the `version_num` in `alembic_version` table:\r\n```\r\nMariaDB [mariadb]> select * from alembic_version;\r\n+-------------+\r\n| version_num |\r\n+-------------+\r\n| v1.3.0.a    |\r\n+-------------+\r\n```\r\n\r\nSo a warning for all MLflow users that store their numerical data in an SQL database (which is recommended for performance reasons): you should **create a separate database (e.g. mlflow) to avoid overwriting Alembic version data for other applications** such as Optuna. I think this recommendation should find its way to MLflow docs (or become more prominent if it is already there).\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/684808578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false}},{"id":6822498136,"node_id":"REFE_lADOCB5Jx84l97zAzwAAAAGWpw9Y","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/6822498136","actor":{"login":"tanlin2013","id":24889824,"node_id":"MDQ6VXNlcjI0ODg5ODI0","avatar_url":"https://avatars.githubusercontent.com/u/24889824?v=4","gravatar_id":"","url":"https://api.github.com/users/tanlin2013","html_url":"https://github.com/tanlin2013","followers_url":"https://api.github.com/users/tanlin2013/followers","following_url":"https://api.github.com/users/tanlin2013/following{/other_user}","gists_url":"https://api.github.com/users/tanlin2013/gists{/gist_id}","starred_url":"https://api.github.com/users/tanlin2013/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tanlin2013/subscriptions","organizations_url":"https://api.github.com/users/tanlin2013/orgs","repos_url":"https://api.github.com/users/tanlin2013/repos","events_url":"https://api.github.com/users/tanlin2013/events{/privacy}","received_events_url":"https://api.github.com/users/tanlin2013/received_events","type":"User","site_admin":false},"event":"referenced","commit_id":"654d76e96b2d62a7fcd9cc87e2290bed99c09b60","commit_url":"https://api.github.com/repos/tanlin2013/mbl/commits/654d76e96b2d62a7fcd9cc87e2290bed99c09b60","created_at":"2022-06-16T16:30:04Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1158628837","html_url":"https://github.com/mlflow/mlflow/issues/2923#issuecomment-1158628837","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/2923","id":1158628837,"node_id":"IC_kwDOCB5Jx85FD0Xl","user":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false},"created_at":"2022-06-17T08:26:17Z","updated_at":"2022-06-17T08:34:38Z","author_association":"NONE","body":"@[tanlin2013](https://github.com/tanlin2013) are you sure you want to run an auto-upgrade of db schema [here](https://github.com/tanlin2013/mbl/commit/654d76e96b2d62a7fcd9cc87e2290bed99c09b60#diff-b80bfcff5418fdc7e455376e9269d3741cc6cf7860940222b799b5107c19c214R81)? Unconditionally, without any backups or checks? \r\n\r\nPeople can have thousands of MLflow runs with dozens of metrics and hundreds of parameters stored in such tables and also hundreds of Optuna studies with dozens of hyperparameters and the access to all this data is hanging on this single identifier `version_num`, so please be very careful here.\r\n\r\nOverwriting an identifier value like this is a destructive operation, and will cause data loss for other apps that also use `version_num` from the `alembic_version` table, as show for Optuna [above](https://github.com/mlflow/mlflow/issues/2923#issuecomment-684808578). I would instead raise a warning that using a dedicated database e.g. named `mlflow` is strongly recommended and because db is named differently, it requires a manual schema update. And only if such a \"characteristically\" named database was being used, I would attempt an auto-update, of course asking the user first before overwriting data (if `version_number` already exists) and would proceed only if granted such permission by the user, in all cases backing it up e.g. to a `version_num_copy`. \r\n","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1158628837/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1158808892","html_url":"https://github.com/mlflow/mlflow/issues/2923#issuecomment-1158808892","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/2923","id":1158808892,"node_id":"IC_kwDOCB5Jx85FEgU8","user":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false},"created_at":"2022-06-17T12:10:39Z","updated_at":"2022-06-17T12:32:52Z","author_association":"NONE","body":"@[tanlin2013](https://github.com/tanlin2013) an example of an arguably safer MariaDB auto-migration, preceded by a backup of system tables (using [docker_mariadb_backup_system](https://github.com/MariaDB/mariadb-docker/blob/master/docker-entrypoint.sh#L367)) and a check if such upgrade would be needed (performed in [_check_if_upgrade_is_needed](https://github.com/MariaDB/mariadb-docker/blob/master/docker-entrypoint.sh#L419)), can be found in the [docker_mariadb_upgrade](https://github.com/MariaDB/mariadb-docker/blob/master/docker-entrypoint.sh#L392) function in the official MariaDB container.\r\n","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1158808892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mirekphd","id":36706320,"node_id":"MDQ6VXNlcjM2NzA2MzIw","avatar_url":"https://avatars.githubusercontent.com/u/36706320?v=4","gravatar_id":"","url":"https://api.github.com/users/mirekphd","html_url":"https://github.com/mirekphd","followers_url":"https://api.github.com/users/mirekphd/followers","following_url":"https://api.github.com/users/mirekphd/following{/other_user}","gists_url":"https://api.github.com/users/mirekphd/gists{/gist_id}","starred_url":"https://api.github.com/users/mirekphd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirekphd/subscriptions","organizations_url":"https://api.github.com/users/mirekphd/orgs","repos_url":"https://api.github.com/users/mirekphd/repos","events_url":"https://api.github.com/users/mirekphd/events{/privacy}","received_events_url":"https://api.github.com/users/mirekphd/received_events","type":"User","site_admin":false}}]