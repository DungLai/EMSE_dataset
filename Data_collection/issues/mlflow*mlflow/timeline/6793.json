[{"id":7384404491,"node_id":"LE_lADOCB5Jx85R0lnNzwAAAAG4JRIL","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7384404491","actor":{"login":"anneadb","id":46241952,"node_id":"MDQ6VXNlcjQ2MjQxOTUy","avatar_url":"https://avatars.githubusercontent.com/u/46241952?v=4","gravatar_id":"","url":"https://api.github.com/users/anneadb","html_url":"https://github.com/anneadb","followers_url":"https://api.github.com/users/anneadb/followers","following_url":"https://api.github.com/users/anneadb/following{/other_user}","gists_url":"https://api.github.com/users/anneadb/gists{/gist_id}","starred_url":"https://api.github.com/users/anneadb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anneadb/subscriptions","organizations_url":"https://api.github.com/users/anneadb/orgs","repos_url":"https://api.github.com/users/anneadb/repos","events_url":"https://api.github.com/users/anneadb/events{/privacy}","received_events_url":"https://api.github.com/users/anneadb/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-09-14T10:25:15Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"id":7384406652,"node_id":"LE_lADOCB5Jx85R0lnNzwAAAAG4JRp8","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7384406652","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-09-14T10:25:29Z","label":{"name":"area/artifacts","color":"48eabc"},"performed_via_github_app":null},{"id":7384406656,"node_id":"LE_lADOCB5Jx85R0lnNzwAAAAG4JRqA","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7384406656","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-09-14T10:25:29Z","label":{"name":"area/tracking","color":"48eabc"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1246916734","html_url":"https://github.com/mlflow/mlflow/issues/6793#issuecomment-1246916734","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/6793","id":1246916734,"node_id":"IC_kwDOCB5Jx85KUnB-","user":{"login":"BenWilson2","id":39283302,"node_id":"MDQ6VXNlcjM5MjgzMzAy","avatar_url":"https://avatars.githubusercontent.com/u/39283302?v=4","gravatar_id":"","url":"https://api.github.com/users/BenWilson2","html_url":"https://github.com/BenWilson2","followers_url":"https://api.github.com/users/BenWilson2/followers","following_url":"https://api.github.com/users/BenWilson2/following{/other_user}","gists_url":"https://api.github.com/users/BenWilson2/gists{/gist_id}","starred_url":"https://api.github.com/users/BenWilson2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BenWilson2/subscriptions","organizations_url":"https://api.github.com/users/BenWilson2/orgs","repos_url":"https://api.github.com/users/BenWilson2/repos","events_url":"https://api.github.com/users/BenWilson2/events{/privacy}","received_events_url":"https://api.github.com/users/BenWilson2/received_events","type":"User","site_admin":false},"created_at":"2022-09-14T15:11:38Z","updated_at":"2022-09-14T15:11:38Z","author_association":"COLLABORATOR","body":"Hi @anneadb the error that you're getting isn't an MLflow exception. It's an exception from Keras. \r\nPlease see: https://github.com/tensorflow/tensorflow/issues/45231#issuecomment-799268188\r\nand https://stackoverflow.com/questions/65050132/unable-to-restore-a-layer-of-class-textvectorization-text-classification\r\nfor guidance on correcting the issue. ","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1246916734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"BenWilson2","id":39283302,"node_id":"MDQ6VXNlcjM5MjgzMzAy","avatar_url":"https://avatars.githubusercontent.com/u/39283302?v=4","gravatar_id":"","url":"https://api.github.com/users/BenWilson2","html_url":"https://github.com/BenWilson2","followers_url":"https://api.github.com/users/BenWilson2/followers","following_url":"https://api.github.com/users/BenWilson2/following{/other_user}","gists_url":"https://api.github.com/users/BenWilson2/gists{/gist_id}","starred_url":"https://api.github.com/users/BenWilson2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BenWilson2/subscriptions","organizations_url":"https://api.github.com/users/BenWilson2/orgs","repos_url":"https://api.github.com/users/BenWilson2/repos","events_url":"https://api.github.com/users/BenWilson2/events{/privacy}","received_events_url":"https://api.github.com/users/BenWilson2/received_events","type":"User","site_admin":false}},{"id":7386888042,"node_id":"CE_lADOCB5Jx85R0lnNzwAAAAG4Svdq","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7386888042","actor":{"login":"BenWilson2","id":39283302,"node_id":"MDQ6VXNlcjM5MjgzMzAy","avatar_url":"https://avatars.githubusercontent.com/u/39283302?v=4","gravatar_id":"","url":"https://api.github.com/users/BenWilson2","html_url":"https://github.com/BenWilson2","followers_url":"https://api.github.com/users/BenWilson2/followers","following_url":"https://api.github.com/users/BenWilson2/following{/other_user}","gists_url":"https://api.github.com/users/BenWilson2/gists{/gist_id}","starred_url":"https://api.github.com/users/BenWilson2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BenWilson2/subscriptions","organizations_url":"https://api.github.com/users/BenWilson2/orgs","repos_url":"https://api.github.com/users/BenWilson2/repos","events_url":"https://api.github.com/users/BenWilson2/events{/privacy}","received_events_url":"https://api.github.com/users/BenWilson2/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-09-14T15:11:38Z","state_reason":null,"performed_via_github_app":null},{"id":7386888072,"node_id":"MEE_lADOCB5Jx85R0lnNzwAAAAG4SveI","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7386888072","actor":{"login":"anneadb","id":46241952,"node_id":"MDQ6VXNlcjQ2MjQxOTUy","avatar_url":"https://avatars.githubusercontent.com/u/46241952?v=4","gravatar_id":"","url":"https://api.github.com/users/anneadb","html_url":"https://github.com/anneadb","followers_url":"https://api.github.com/users/anneadb/followers","following_url":"https://api.github.com/users/anneadb/following{/other_user}","gists_url":"https://api.github.com/users/anneadb/gists{/gist_id}","starred_url":"https://api.github.com/users/anneadb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anneadb/subscriptions","organizations_url":"https://api.github.com/users/anneadb/orgs","repos_url":"https://api.github.com/users/anneadb/repos","events_url":"https://api.github.com/users/anneadb/events{/privacy}","received_events_url":"https://api.github.com/users/anneadb/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-09-14T15:11:39Z","performed_via_github_app":null},{"id":7386888084,"node_id":"SE_lADOCB5Jx85R0lnNzwAAAAG4SveU","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7386888084","actor":{"login":"anneadb","id":46241952,"node_id":"MDQ6VXNlcjQ2MjQxOTUy","avatar_url":"https://avatars.githubusercontent.com/u/46241952?v=4","gravatar_id":"","url":"https://api.github.com/users/anneadb","html_url":"https://github.com/anneadb","followers_url":"https://api.github.com/users/anneadb/followers","following_url":"https://api.github.com/users/anneadb/following{/other_user}","gists_url":"https://api.github.com/users/anneadb/gists{/gist_id}","starred_url":"https://api.github.com/users/anneadb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anneadb/subscriptions","organizations_url":"https://api.github.com/users/anneadb/orgs","repos_url":"https://api.github.com/users/anneadb/repos","events_url":"https://api.github.com/users/anneadb/events{/privacy}","received_events_url":"https://api.github.com/users/anneadb/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-09-14T15:11:39Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1252264894","html_url":"https://github.com/mlflow/mlflow/issues/6793#issuecomment-1252264894","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/6793","id":1252264894,"node_id":"IC_kwDOCB5Jx85KpAu-","user":{"login":"anneadb","id":46241952,"node_id":"MDQ6VXNlcjQ2MjQxOTUy","avatar_url":"https://avatars.githubusercontent.com/u/46241952?v=4","gravatar_id":"","url":"https://api.github.com/users/anneadb","html_url":"https://github.com/anneadb","followers_url":"https://api.github.com/users/anneadb/followers","following_url":"https://api.github.com/users/anneadb/following{/other_user}","gists_url":"https://api.github.com/users/anneadb/gists{/gist_id}","starred_url":"https://api.github.com/users/anneadb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anneadb/subscriptions","organizations_url":"https://api.github.com/users/anneadb/orgs","repos_url":"https://api.github.com/users/anneadb/repos","events_url":"https://api.github.com/users/anneadb/events{/privacy}","received_events_url":"https://api.github.com/users/anneadb/received_events","type":"User","site_admin":false},"created_at":"2022-09-20T12:11:10Z","updated_at":"2022-09-20T12:11:10Z","author_association":"NONE","body":"Hi @BenWilson2,\r\nthanks for the helpful links but the solution displayed there is not working for my code with mlflow. As long as I do not integrate `mlflow.tensorflow.autolog` it runs fine, the source of the error appears to be `mlflow.pyfunc.load_model(model_path)`. After registering the custom function with the decorator the error message remains the same.\r\n\r\nMy error message is also slightly different than the given examples:\r\n`ValueError: Unkown value for `standardize` argument of layer TextVectorization.` instead of `RuntimeError: Unable to restore a layer of class TextVectorization.`.\r\n\r\nSince I am not that familiar with mlflow yet I'm having a really hard time debugging this. Do you have any other suggestions on what I could try?","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1252264894/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"anneadb","id":46241952,"node_id":"MDQ6VXNlcjQ2MjQxOTUy","avatar_url":"https://avatars.githubusercontent.com/u/46241952?v=4","gravatar_id":"","url":"https://api.github.com/users/anneadb","html_url":"https://github.com/anneadb","followers_url":"https://api.github.com/users/anneadb/followers","following_url":"https://api.github.com/users/anneadb/following{/other_user}","gists_url":"https://api.github.com/users/anneadb/gists{/gist_id}","starred_url":"https://api.github.com/users/anneadb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anneadb/subscriptions","organizations_url":"https://api.github.com/users/anneadb/orgs","repos_url":"https://api.github.com/users/anneadb/repos","events_url":"https://api.github.com/users/anneadb/events{/privacy}","received_events_url":"https://api.github.com/users/anneadb/received_events","type":"User","site_admin":false}},{"id":7421654116,"node_id":"MEE_lADOCB5Jx85R0lnNzwAAAAG6XXRk","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7421654116","actor":{"login":"BenWilson2","id":39283302,"node_id":"MDQ6VXNlcjM5MjgzMzAy","avatar_url":"https://avatars.githubusercontent.com/u/39283302?v=4","gravatar_id":"","url":"https://api.github.com/users/BenWilson2","html_url":"https://github.com/BenWilson2","followers_url":"https://api.github.com/users/BenWilson2/followers","following_url":"https://api.github.com/users/BenWilson2/following{/other_user}","gists_url":"https://api.github.com/users/BenWilson2/gists{/gist_id}","starred_url":"https://api.github.com/users/BenWilson2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BenWilson2/subscriptions","organizations_url":"https://api.github.com/users/BenWilson2/orgs","repos_url":"https://api.github.com/users/BenWilson2/repos","events_url":"https://api.github.com/users/BenWilson2/events{/privacy}","received_events_url":"https://api.github.com/users/BenWilson2/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-09-20T12:11:10Z","performed_via_github_app":null},{"id":7421654128,"node_id":"SE_lADOCB5Jx85R0lnNzwAAAAG6XXRw","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7421654128","actor":{"login":"BenWilson2","id":39283302,"node_id":"MDQ6VXNlcjM5MjgzMzAy","avatar_url":"https://avatars.githubusercontent.com/u/39283302?v=4","gravatar_id":"","url":"https://api.github.com/users/BenWilson2","html_url":"https://github.com/BenWilson2","followers_url":"https://api.github.com/users/BenWilson2/followers","following_url":"https://api.github.com/users/BenWilson2/following{/other_user}","gists_url":"https://api.github.com/users/BenWilson2/gists{/gist_id}","starred_url":"https://api.github.com/users/BenWilson2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BenWilson2/subscriptions","organizations_url":"https://api.github.com/users/BenWilson2/orgs","repos_url":"https://api.github.com/users/BenWilson2/repos","events_url":"https://api.github.com/users/BenWilson2/events{/privacy}","received_events_url":"https://api.github.com/users/BenWilson2/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-09-20T12:11:10Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1252865647","html_url":"https://github.com/mlflow/mlflow/issues/6793#issuecomment-1252865647","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/6793","id":1252865647,"node_id":"IC_kwDOCB5Jx85KrTZv","user":{"login":"BenWilson2","id":39283302,"node_id":"MDQ6VXNlcjM5MjgzMzAy","avatar_url":"https://avatars.githubusercontent.com/u/39283302?v=4","gravatar_id":"","url":"https://api.github.com/users/BenWilson2","html_url":"https://github.com/BenWilson2","followers_url":"https://api.github.com/users/BenWilson2/followers","following_url":"https://api.github.com/users/BenWilson2/following{/other_user}","gists_url":"https://api.github.com/users/BenWilson2/gists{/gist_id}","starred_url":"https://api.github.com/users/BenWilson2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BenWilson2/subscriptions","organizations_url":"https://api.github.com/users/BenWilson2/orgs","repos_url":"https://api.github.com/users/BenWilson2/repos","events_url":"https://api.github.com/users/BenWilson2/events{/privacy}","received_events_url":"https://api.github.com/users/BenWilson2/received_events","type":"User","site_admin":false},"created_at":"2022-09-20T20:16:49Z","updated_at":"2022-09-20T20:16:49Z","author_association":"COLLABORATOR","body":"It looks like you're trying to implement a partial function approach for this model, right?\r\nIs `standardize` a function that you're trying to pass in?\r\nIf the model you're building requires such an input then the standard flavor for TF in MLflow won't work since there are a limited set of types supported for input into the pyfunc implementation. \r\nHow does this work without using autolog?","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1252865647/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"BenWilson2","id":39283302,"node_id":"MDQ6VXNlcjM5MjgzMzAy","avatar_url":"https://avatars.githubusercontent.com/u/39283302?v=4","gravatar_id":"","url":"https://api.github.com/users/BenWilson2","html_url":"https://github.com/BenWilson2","followers_url":"https://api.github.com/users/BenWilson2/followers","following_url":"https://api.github.com/users/BenWilson2/following{/other_user}","gists_url":"https://api.github.com/users/BenWilson2/gists{/gist_id}","starred_url":"https://api.github.com/users/BenWilson2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BenWilson2/subscriptions","organizations_url":"https://api.github.com/users/BenWilson2/orgs","repos_url":"https://api.github.com/users/BenWilson2/repos","events_url":"https://api.github.com/users/BenWilson2/events{/privacy}","received_events_url":"https://api.github.com/users/BenWilson2/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1253314740","html_url":"https://github.com/mlflow/mlflow/issues/6793#issuecomment-1253314740","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/6793","id":1253314740,"node_id":"IC_kwDOCB5Jx85KtBC0","user":{"login":"anneadb","id":46241952,"node_id":"MDQ6VXNlcjQ2MjQxOTUy","avatar_url":"https://avatars.githubusercontent.com/u/46241952?v=4","gravatar_id":"","url":"https://api.github.com/users/anneadb","html_url":"https://github.com/anneadb","followers_url":"https://api.github.com/users/anneadb/followers","following_url":"https://api.github.com/users/anneadb/following{/other_user}","gists_url":"https://api.github.com/users/anneadb/gists{/gist_id}","starred_url":"https://api.github.com/users/anneadb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anneadb/subscriptions","organizations_url":"https://api.github.com/users/anneadb/orgs","repos_url":"https://api.github.com/users/anneadb/repos","events_url":"https://api.github.com/users/anneadb/events{/privacy}","received_events_url":"https://api.github.com/users/anneadb/received_events","type":"User","site_admin":false},"created_at":"2022-09-21T07:28:53Z","updated_at":"2022-09-21T07:28:53Z","author_association":"NONE","body":"The training code looks like this:\r\n\r\n```\r\n@keras.utils.register_keras_serializable()\r\ndef custom_standardization(input_data):\r\n    lowercase = tf.strings.lower(input_data)\r\n    stripped_html = tf.strings.regex_replace(lowercase, \"<br />\", \" \")\r\n    return tf.strings.regex_replace(stripped_html, \"[%s]\" % re.escape(string.punctuation), \"\")\r\n\r\n\r\ndef create_vectorizer(raw_train_ds) -> keras.layers.TextVectorization:\r\n    sequence_length = 250\r\n\r\n    vectorizer = keras.layers.TextVectorization(\r\n        standardize=custom_standardization,\r\n        max_tokens=MAX_FEATURES,\r\n        output_mode=\"int\",\r\n        output_sequence_length=sequence_length,\r\n    )\r\n\r\n    # Make a text-only dataset (without labels), then call adapt\r\n    # It's important to only use your training data when calling adapt (using the test set would leak information).\r\n    train_text = raw_train_ds.map(lambda x, y: x)\r\n    vectorizer.adapt(train_text)  # create the vocabulary\r\n    print(\"Vocabulary sample: {}\".format(vectorizer.get_vocabulary()[:20]))\r\n\r\n    return vectorizer\r\n\r\ndef create_model(vectorizer: keras.layers.TextVectorization) -> keras.Sequential:\r\n    embedding_dim = 16\r\n\r\n    model = keras.Sequential(\r\n        [\r\n            keras.Input(shape=(1,), dtype=tf.string),\r\n            vectorizer,\r\n            keras.layers.Embedding(MAX_FEATURES + 1, embedding_dim),\r\n            keras.layers.Dropout(0.2),\r\n            keras.layers.GlobalAveragePooling1D(),\r\n            keras.layers.Dropout(0.2),\r\n            keras.layers.Dense(1),\r\n        ]\r\n    )\r\n\r\n    print(model.summary())\r\n\r\n    model.compile(\r\n        loss=keras.losses.BinaryCrossentropy(from_logits=True),\r\n        optimizer=\"adam\",\r\n        metrics=keras.metrics.BinaryAccuracy(threshold=0.0),\r\n    )\r\n\r\n    return model\r\n\r\ndef train_and_save_model(model_name, model: keras.Sequential, train_ds, val_ds) -> keras.callbacks.History:\r\n    epochs = 10\r\n\r\n    model.fit(\r\n        train_ds,\r\n        validation_data=val_ds,\r\n        epochs=epochs,\r\n    )\r\n    model.save(os.path.join(MODEL_DIR, model_name), save_format=\"tf\")\r\n\r\nvectorizer = create_vectorizer(raw_train_ds)\r\nmodel = create_model(vectorizer)\r\ntrain_and_save_model(MODEL_NAME, model, raw_train_ds, raw_val_ds)\r\n```\r\n\r\nAnd then I can load it like this:\r\n\r\n```\r\ncustom_objects = {\"custom_standardization\": custom_standardization}\r\nmodel: keras.Sequential = keras.models.load_model(\r\n    os.path.join(MODEL_DIR, MODEL_NAME),\r\n    custom_objects=custom_objects,\r\n)\r\n# predict\r\nexamples = [\r\n    \"The movie was great!\",\r\n    \"The movie was okay.\",\r\n    \"The movie was terrible...\",\r\n    \"The movie was amazing\",\r\n]\r\npredictions = model.predict(examples)\r\n```\r\n\r\nSo I need to tell the `load_model` function which `custom_objects` to integrate.","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1253314740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"anneadb","id":46241952,"node_id":"MDQ6VXNlcjQ2MjQxOTUy","avatar_url":"https://avatars.githubusercontent.com/u/46241952?v=4","gravatar_id":"","url":"https://api.github.com/users/anneadb","html_url":"https://github.com/anneadb","followers_url":"https://api.github.com/users/anneadb/followers","following_url":"https://api.github.com/users/anneadb/following{/other_user}","gists_url":"https://api.github.com/users/anneadb/gists{/gist_id}","starred_url":"https://api.github.com/users/anneadb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anneadb/subscriptions","organizations_url":"https://api.github.com/users/anneadb/orgs","repos_url":"https://api.github.com/users/anneadb/repos","events_url":"https://api.github.com/users/anneadb/events{/privacy}","received_events_url":"https://api.github.com/users/anneadb/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1253845490","html_url":"https://github.com/mlflow/mlflow/issues/6793#issuecomment-1253845490","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/6793","id":1253845490,"node_id":"IC_kwDOCB5Jx85KvCny","user":{"login":"BenWilson2","id":39283302,"node_id":"MDQ6VXNlcjM5MjgzMzAy","avatar_url":"https://avatars.githubusercontent.com/u/39283302?v=4","gravatar_id":"","url":"https://api.github.com/users/BenWilson2","html_url":"https://github.com/BenWilson2","followers_url":"https://api.github.com/users/BenWilson2/followers","following_url":"https://api.github.com/users/BenWilson2/following{/other_user}","gists_url":"https://api.github.com/users/BenWilson2/gists{/gist_id}","starred_url":"https://api.github.com/users/BenWilson2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BenWilson2/subscriptions","organizations_url":"https://api.github.com/users/BenWilson2/orgs","repos_url":"https://api.github.com/users/BenWilson2/repos","events_url":"https://api.github.com/users/BenWilson2/events{/privacy}","received_events_url":"https://api.github.com/users/BenWilson2/received_events","type":"User","site_admin":false},"created_at":"2022-09-21T15:06:49Z","updated_at":"2022-09-21T15:06:49Z","author_association":"COLLABORATOR","body":"Ah, I see. Pickling will fail here since the function reference is external to the generated object. Could you try refactoring to ensure that those functions become wrapped and encapsulated within the generated object and utilize the pyfunc flavor to ensure that all references are included?","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1253845490/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"BenWilson2","id":39283302,"node_id":"MDQ6VXNlcjM5MjgzMzAy","avatar_url":"https://avatars.githubusercontent.com/u/39283302?v=4","gravatar_id":"","url":"https://api.github.com/users/BenWilson2","html_url":"https://github.com/BenWilson2","followers_url":"https://api.github.com/users/BenWilson2/followers","following_url":"https://api.github.com/users/BenWilson2/following{/other_user}","gists_url":"https://api.github.com/users/BenWilson2/gists{/gist_id}","starred_url":"https://api.github.com/users/BenWilson2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BenWilson2/subscriptions","organizations_url":"https://api.github.com/users/BenWilson2/orgs","repos_url":"https://api.github.com/users/BenWilson2/repos","events_url":"https://api.github.com/users/BenWilson2/events{/privacy}","received_events_url":"https://api.github.com/users/BenWilson2/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1260971177","html_url":"https://github.com/mlflow/mlflow/issues/6793#issuecomment-1260971177","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/6793","id":1260971177,"node_id":"IC_kwDOCB5Jx85LKOSp","user":{"login":"anneadb","id":46241952,"node_id":"MDQ6VXNlcjQ2MjQxOTUy","avatar_url":"https://avatars.githubusercontent.com/u/46241952?v=4","gravatar_id":"","url":"https://api.github.com/users/anneadb","html_url":"https://github.com/anneadb","followers_url":"https://api.github.com/users/anneadb/followers","following_url":"https://api.github.com/users/anneadb/following{/other_user}","gists_url":"https://api.github.com/users/anneadb/gists{/gist_id}","starred_url":"https://api.github.com/users/anneadb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anneadb/subscriptions","organizations_url":"https://api.github.com/users/anneadb/orgs","repos_url":"https://api.github.com/users/anneadb/repos","events_url":"https://api.github.com/users/anneadb/events{/privacy}","received_events_url":"https://api.github.com/users/anneadb/received_events","type":"User","site_admin":false},"created_at":"2022-09-28T14:07:36Z","updated_at":"2022-09-28T14:07:36Z","author_association":"NONE","body":"Hi Ben,\r\nI'm sorry to say that I am not proficient enough with tensorflow and mlflow to follow your suggestion.\r\n\r\nRegarding `functions become wrapped and encapsulated within the generated object`: Does this mean I would somehow have to add the custom function to my `create_model` function so that it is part of the model object? I thought it was already part of it because the vectorizer layer is a part of the model.\r\n\r\nRegarding `utilize the pyfunc flavor`: Isn't the `autolog` function taking care of everything for mlflow? The following MLmodel is created:\r\n\r\n```\r\nartifact_path: model\r\nflavors:\r\n  keras:\r\n    code: null\r\n    data: data\r\n    keras_module: tensorflow.keras\r\n    keras_version: 2.9.0\r\n    save_format: tf\r\n  python_function:\r\n    data: data\r\n    env: conda.yaml\r\n    loader_module: mlflow.keras\r\n    python_version: 3.10.6\r\nmlflow_version: 1.29.0\r\nmodel_uuid: 21e33cde572648afad91abe1403b562b\r\nrun_id: 1ad0cc83a12042c0b6bf4151382dcd14\r\nutc_time_created: '2022-09-27 10:32:27.314312'\r\n```","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1260971177/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"anneadb","id":46241952,"node_id":"MDQ6VXNlcjQ2MjQxOTUy","avatar_url":"https://avatars.githubusercontent.com/u/46241952?v=4","gravatar_id":"","url":"https://api.github.com/users/anneadb","html_url":"https://github.com/anneadb","followers_url":"https://api.github.com/users/anneadb/followers","following_url":"https://api.github.com/users/anneadb/following{/other_user}","gists_url":"https://api.github.com/users/anneadb/gists{/gist_id}","starred_url":"https://api.github.com/users/anneadb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anneadb/subscriptions","organizations_url":"https://api.github.com/users/anneadb/orgs","repos_url":"https://api.github.com/users/anneadb/repos","events_url":"https://api.github.com/users/anneadb/events{/privacy}","received_events_url":"https://api.github.com/users/anneadb/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1261064767","html_url":"https://github.com/mlflow/mlflow/issues/6793#issuecomment-1261064767","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/6793","id":1261064767,"node_id":"IC_kwDOCB5Jx85LKlI_","user":{"login":"BenWilson2","id":39283302,"node_id":"MDQ6VXNlcjM5MjgzMzAy","avatar_url":"https://avatars.githubusercontent.com/u/39283302?v=4","gravatar_id":"","url":"https://api.github.com/users/BenWilson2","html_url":"https://github.com/BenWilson2","followers_url":"https://api.github.com/users/BenWilson2/followers","following_url":"https://api.github.com/users/BenWilson2/following{/other_user}","gists_url":"https://api.github.com/users/BenWilson2/gists{/gist_id}","starred_url":"https://api.github.com/users/BenWilson2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BenWilson2/subscriptions","organizations_url":"https://api.github.com/users/BenWilson2/orgs","repos_url":"https://api.github.com/users/BenWilson2/repos","events_url":"https://api.github.com/users/BenWilson2/events{/privacy}","received_events_url":"https://api.github.com/users/BenWilson2/received_events","type":"User","site_admin":false},"created_at":"2022-09-28T15:14:37Z","updated_at":"2022-09-28T15:14:58Z","author_association":"COLLABORATOR","body":"Autolog doesn't support the custom_objects that you'll need to supply to ensure that deserialization functions correctly. \r\nCould you try using \r\n```python \r\nmlflow.keras.log_model(<your model>, <your model name>, custom_objects={\"custom_standardization\": custom_standardization}) \r\n```\r\nand see if that allows you to load the model correctly?","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1261064767/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"BenWilson2","id":39283302,"node_id":"MDQ6VXNlcjM5MjgzMzAy","avatar_url":"https://avatars.githubusercontent.com/u/39283302?v=4","gravatar_id":"","url":"https://api.github.com/users/BenWilson2","html_url":"https://github.com/BenWilson2","followers_url":"https://api.github.com/users/BenWilson2/followers","following_url":"https://api.github.com/users/BenWilson2/following{/other_user}","gists_url":"https://api.github.com/users/BenWilson2/gists{/gist_id}","starred_url":"https://api.github.com/users/BenWilson2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BenWilson2/subscriptions","organizations_url":"https://api.github.com/users/BenWilson2/orgs","repos_url":"https://api.github.com/users/BenWilson2/repos","events_url":"https://api.github.com/users/BenWilson2/events{/privacy}","received_events_url":"https://api.github.com/users/BenWilson2/received_events","type":"User","site_admin":false}}]