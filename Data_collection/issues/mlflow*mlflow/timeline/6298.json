[{"id":7042045247,"node_id":"LE_lADOCB5Jx85OUQK8zwAAAAGjvRU_","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7042045247","actor":{"login":"jerrylian-db","id":66143562,"node_id":"MDQ6VXNlcjY2MTQzNTYy","avatar_url":"https://avatars.githubusercontent.com/u/66143562?v=4","gravatar_id":"","url":"https://api.github.com/users/jerrylian-db","html_url":"https://github.com/jerrylian-db","followers_url":"https://api.github.com/users/jerrylian-db/followers","following_url":"https://api.github.com/users/jerrylian-db/following{/other_user}","gists_url":"https://api.github.com/users/jerrylian-db/gists{/gist_id}","starred_url":"https://api.github.com/users/jerrylian-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerrylian-db/subscriptions","organizations_url":"https://api.github.com/users/jerrylian-db/orgs","repos_url":"https://api.github.com/users/jerrylian-db/repos","events_url":"https://api.github.com/users/jerrylian-db/events{/privacy}","received_events_url":"https://api.github.com/users/jerrylian-db/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-07-21T23:26:35Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"id":7042046050,"node_id":"LE_lADOCB5Jx85OUQK8zwAAAAGjvRhi","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7042046050","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-07-21T23:26:50Z","label":{"name":"area/scoring","color":"48eabc"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1192033496","html_url":"https://github.com/mlflow/mlflow/issues/6298#issuecomment-1192033496","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/6298","id":1192033496,"node_id":"IC_kwDOCB5Jx85HDPzY","user":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false},"created_at":"2022-07-21T23:44:54Z","updated_at":"2022-07-21T23:44:54Z","author_association":"COLLABORATOR","body":"Thanks @jerrylian-db. Is there any additional stack trace information for:\r\n\r\n```\r\nAn error occurred while calling o90.collectToPython.\r\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 0.0 failed 1 times, most recent failure: Lost task 0.0 in stage 0.0 (TID 0) (10.0.0.30 executor driver): org.apache.spark.SparkException: Python worker exited unexpectedly (crashed)\r\n```\r\n\r\n?","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1192033496/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false}},{"id":7042100828,"node_id":"MEE_lADOCB5Jx85OUQK8zwAAAAGjve5c","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7042100828","actor":{"login":"jerrylian-db","id":66143562,"node_id":"MDQ6VXNlcjY2MTQzNTYy","avatar_url":"https://avatars.githubusercontent.com/u/66143562?v=4","gravatar_id":"","url":"https://api.github.com/users/jerrylian-db","html_url":"https://github.com/jerrylian-db","followers_url":"https://api.github.com/users/jerrylian-db/followers","following_url":"https://api.github.com/users/jerrylian-db/following{/other_user}","gists_url":"https://api.github.com/users/jerrylian-db/gists{/gist_id}","starred_url":"https://api.github.com/users/jerrylian-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerrylian-db/subscriptions","organizations_url":"https://api.github.com/users/jerrylian-db/orgs","repos_url":"https://api.github.com/users/jerrylian-db/repos","events_url":"https://api.github.com/users/jerrylian-db/events{/privacy}","received_events_url":"https://api.github.com/users/jerrylian-db/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-21T23:44:54Z","performed_via_github_app":null},{"id":7042100831,"node_id":"SE_lADOCB5Jx85OUQK8zwAAAAGjve5f","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7042100831","actor":{"login":"jerrylian-db","id":66143562,"node_id":"MDQ6VXNlcjY2MTQzNTYy","avatar_url":"https://avatars.githubusercontent.com/u/66143562?v=4","gravatar_id":"","url":"https://api.github.com/users/jerrylian-db","html_url":"https://github.com/jerrylian-db","followers_url":"https://api.github.com/users/jerrylian-db/followers","following_url":"https://api.github.com/users/jerrylian-db/following{/other_user}","gists_url":"https://api.github.com/users/jerrylian-db/gists{/gist_id}","starred_url":"https://api.github.com/users/jerrylian-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerrylian-db/subscriptions","organizations_url":"https://api.github.com/users/jerrylian-db/orgs","repos_url":"https://api.github.com/users/jerrylian-db/repos","events_url":"https://api.github.com/users/jerrylian-db/events{/privacy}","received_events_url":"https://api.github.com/users/jerrylian-db/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-07-21T23:44:54Z","performed_via_github_app":null},{"id":7042102144,"node_id":"AE_lADOCB5Jx85OUQK8zwAAAAGjvfOA","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7042102144","actor":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2022-07-21T23:45:22Z","assignee":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1192044612","html_url":"https://github.com/mlflow/mlflow/issues/6298#issuecomment-1192044612","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/6298","id":1192044612,"node_id":"IC_kwDOCB5Jx85HDShE","user":{"login":"jerrylian-db","id":66143562,"node_id":"MDQ6VXNlcjY2MTQzNTYy","avatar_url":"https://avatars.githubusercontent.com/u/66143562?v=4","gravatar_id":"","url":"https://api.github.com/users/jerrylian-db","html_url":"https://github.com/jerrylian-db","followers_url":"https://api.github.com/users/jerrylian-db/followers","following_url":"https://api.github.com/users/jerrylian-db/following{/other_user}","gists_url":"https://api.github.com/users/jerrylian-db/gists{/gist_id}","starred_url":"https://api.github.com/users/jerrylian-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerrylian-db/subscriptions","organizations_url":"https://api.github.com/users/jerrylian-db/orgs","repos_url":"https://api.github.com/users/jerrylian-db/repos","events_url":"https://api.github.com/users/jerrylian-db/events{/privacy}","received_events_url":"https://api.github.com/users/jerrylian-db/received_events","type":"User","site_admin":false},"created_at":"2022-07-22T00:05:57Z","updated_at":"2022-07-22T00:05:57Z","author_association":"COLLABORATOR","body":"Here's the full stack trace:\r\n```\r\n2022/07/21 16:13:52 INFO mlflow.pyfunc: This UDF will use Conda to recreate the model's software environment for inference. This may take extra time during execution.\r\n2022/07/21 16:13:52 WARNING mlflow.pyfunc: In order to run inference code in restored python environment, PySpark UDF processes spawn MLflow Model servers as child processes. Due to system limitations with handling SIGKILL signals, these MLflow Model server child processes cannot be cleaned up if the Spark Job is canceled.\r\n2022/07/21 16:13:53 INFO mlflow.models.cli: Selected backend for flavor 'python_function'\r\n2022/07/21 16:13:54 INFO mlflow.utils.conda: === Creating conda environment /var/folders/qw/z137wp9572vd__7v3jmd1stc0000gp/T/tmpcdhyhv5p/envs/conda_envs/mlflow-9c9dd60098d21433615a854e1a7491b91ed5775c-a6884002b2a4e8ca80a4e9d29b7b062a11125029 ===\r\nCollecting package metadata (repodata.json): ...working... done\r\nSolving environment: ...working... done\r\n\r\nDownloading and Extracting Packages\r\ntk-8.6.12            | 3.4 MB    | ########## | 100% \r\nca-certificates-2022 | 149 KB    | ########## | 100% \r\nncurses-6.3          | 915 KB    | ########## | 100% \r\nsqlite-3.39.1        | 1.8 MB    | ########## | 100% \r\npython-3.7.13        | 20.3 MB   | ########## | 100% \r\nxz-5.2.5             | 228 KB    | ########## | 100% \r\npip-22.1.2           | 1.5 MB    | ########## | 100% \r\nopenssl-1.1.1q       | 1.9 MB    | ########## | 100% \r\nsetuptools-63.2.0    | 1.3 MB    | ########## | 100% \r\npython_abi-3.7       | 4 KB      | ########## | 100% \r\nlibzlib-1.2.12       | 63 KB     | ########## | 100% \r\nreadline-8.1.2       | 266 KB    | ########## | 100% \r\nzlib-1.2.12          | 93 KB     | ########## | 100% \r\nwheel-0.37.1         | 31 KB     | ########## | 100% \r\nlibcxx-14.0.6        | 1.3 MB    | ########## | 100% \r\nlibffi-3.3           | 45 KB     | ########## | 100% \r\nPreparing transaction: ...working... done\r\nVerifying transaction: ...working... done\r\nExecuting transaction: ...working... done\r\nInstalling pip dependencies: ...working... Ran pip subprocess with arguments:\r\n['/var/folders/qw/z137wp9572vd__7v3jmd1stc0000gp/T/tmpcdhyhv5p/envs/conda_envs/mlflow-9c9dd60098d21433615a854e1a7491b91ed5775c-a6884002b2a4e8ca80a4e9d29b7b062a11125029/bin/python', '-m', 'pip', 'install', '-U', '-r', '/var/folders/qw/z137wp9572vd__7v3jmd1stc0000gp/T/tmpcdhyhv5p/models/tmpnn91rpzw/model/condaenv.w3rq4i9l.requirements.txt']\r\nPip subprocess output:\r\nCollecting mlflow\r\n  Downloading mlflow-1.27.0-py3-none-any.whl (17.9 MB)\r\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 17.9/17.9 MB 37.9 MB/s eta 0:00:00\r\nCollecting cloudpickle==2.1.0\r\n  Downloading cloudpickle-2.1.0-py3-none-any.whl (25 kB)\r\nCollecting psutil==5.9.1\r\n  Downloading psutil-5.9.1-cp37-cp37m-macosx_10_9_x86_64.whl (238 kB)\r\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 239.0/239.0 kB 8.1 MB/s eta 0:00:00\r\nCollecting scikit-learn==1\r\n\r\n\r\n==> WARNING: A newer version of conda exists. <==\r\n  current version: 4.10.1\r\n  latest version: 4.13.0\r\n\r\nPlease update conda by running\r\n\r\n    $ conda update -n base -c defaults conda\r\n\r\n\r\n2022/07/21 16:15:32 INFO mlflow.pyfunc.backend: === Running command 'source /Users/jerry.liang/opt/anaconda3/bin/../etc/profile.d/conda.sh && conda activate mlflow-9c9dd60098d21433615a854e1a7491b91ed5775c-a6884002b2a4e8ca80a4e9d29b7b062a11125029 1>&2 && python -c \"\"'\r\n2022/07/21 16:15:37 INFO mlflow.models.cli: Selected backend for flavor 'python_function'\r\n2022/07/21 16:15:39 INFO mlflow.utils.conda: Conda environment /var/folders/qw/z137wp9572vd__7v3jmd1stc0000gp/T/tmpcdhyhv5p/envs/conda_envs/mlflow-9c9dd60098d21433615a854e1a7491b91ed5775c-a6884002b2a4e8ca80a4e9d29b7b062a11125029 already exists.\r\n2022/07/21 16:15:39 INFO mlflow.pyfunc.backend: === Running command 'source /Users/jerry.liang/opt/anaconda3/bin/../etc/profile.d/conda.sh && conda activate mlflow-9c9dd60098d21433615a854e1a7491b91ed5775c-a6884002b2a4e8ca80a4e9d29b7b062a11125029 1>&2 && exec gunicorn --timeout=60 -b 127.0.0.1:65280 -w 1 ${GUNICORN_CMD_ARGS} -- mlflow.pyfunc.scoring_server.wsgi:app'\r\nobjc[19262]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called.\r\nobjc[19262]: +[__NSCFConstantString initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.\r\n---------------------------------------------------------------------------\r\nPy4JJavaError                             Traceback (most recent call last)\r\n/var/folders/qw/z137wp9572vd__7v3jmd1stc0000gp/T/ipykernel_19116/1022720443.py in <module>\r\n      2 predict = mlflow.pyfunc.spark_udf(spark, model_uri, env_manager=\"conda\")\r\n      3 scored_sdf = input_sdf.withColumn(\"prediction\", predict(struct(*input_sdf.columns)))\r\n----> 4 scored_sdf.head(1)\r\n\r\n~/mlflow/.venvs/mlflow-dev/lib/python3.7/site-packages/pyspark/sql/dataframe.py in head(self, n)\r\n   1924             rs = self.head(1)\r\n   1925             return rs[0] if rs else None\r\n-> 1926         return self.take(n)\r\n   1927 \r\n   1928     def first(self) -> Optional[Row]:\r\n\r\n~/mlflow/.venvs/mlflow-dev/lib/python3.7/site-packages/pyspark/sql/dataframe.py in take(self, num)\r\n    866         [Row(age=2, name='Alice'), Row(age=5, name='Bob')]\r\n    867         \"\"\"\r\n--> 868         return self.limit(num).collect()\r\n    869 \r\n    870     def tail(self, num: int) -> List[Row]:\r\n\r\n~/mlflow/.venvs/mlflow-dev/lib/python3.7/site-packages/pyspark/sql/dataframe.py in collect(self)\r\n    815         \"\"\"\r\n    816         with SCCallSiteSync(self._sc):\r\n--> 817             sock_info = self._jdf.collectToPython()\r\n    818         return list(_load_from_socket(sock_info, BatchedSerializer(CPickleSerializer())))\r\n    819 \r\n\r\n~/mlflow/.venvs/mlflow-dev/lib/python3.7/site-packages/py4j/java_gateway.py in __call__(self, *args)\r\n   1320         answer = self.gateway_client.send_command(command)\r\n   1321         return_value = get_return_value(\r\n-> 1322             answer, self.gateway_client, self.target_id, self.name)\r\n   1323 \r\n   1324         for temp_arg in temp_args:\r\n\r\n~/mlflow/.venvs/mlflow-dev/lib/python3.7/site-packages/pyspark/sql/utils.py in deco(*a, **kw)\r\n    188     def deco(*a: Any, **kw: Any) -> Any:\r\n    189         try:\r\n--> 190             return f(*a, **kw)\r\n    191         except Py4JJavaError as e:\r\n    192             converted = convert_exception(e.java_exception)\r\n\r\n~/mlflow/.venvs/mlflow-dev/lib/python3.7/site-packages/py4j/protocol.py in get_return_value(answer, gateway_client, target_id, name)\r\n    326                 raise Py4JJavaError(\r\n    327                     \"An error occurred while calling {0}{1}{2}.\\n\".\r\n--> 328                     format(target_id, \".\", name), value)\r\n    329             else:\r\n    330                 raise Py4JError(\r\n\r\nPy4JJavaError: An error occurred while calling o90.collectToPython.\r\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 0.0 failed 1 times, most recent failure: Lost task 0.0 in stage 0.0 (TID 0) (10.0.0.30 executor driver): org.apache.spark.SparkException: Python worker exited unexpectedly (crashed)\r\n\tat org.apache.spark.api.python.BasePythonRunner$ReaderIterator$$anonfun$1.applyOrElse(PythonRunner.scala:599)\r\n\tat org.apache.spark.api.python.BasePythonRunner$ReaderIterator$$anonfun$1.applyOrElse(PythonRunner.scala:581)\r\n\tat scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:38)\r\n\tat org.apache.spark.sql.execution.python.PythonArrowOutput$$anon$1.read(PythonArrowOutput.scala:107)\r\n\tat org.apache.spark.sql.execution.python.PythonArrowOutput$$anon$1.read(PythonArrowOutput.scala:50)\r\n\tat org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:512)\r\n\tat org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)\r\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)\r\n\tat scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.processNext(Unknown Source)\r\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\r\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:760)\r\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:364)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:890)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:890)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:365)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:329)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:136)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:548)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1504)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:551)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: java.io.EOFException\r\n\tat java.io.DataInputStream.readInt(DataInputStream.java:392)\r\n\tat org.apache.spark.sql.execution.python.PythonArrowOutput$$anon$1.read(PythonArrowOutput.scala:88)\r\n\t... 22 more\r\n\r\nDriver stacktrace:\r\n\tat org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2672)\r\n\tat org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2608)\r\n\tat org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2607)\r\n\tat scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)\r\n\tat scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)\r\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)\r\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2607)\r\n\tat org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1182)\r\n\tat org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1182)\r\n\tat scala.Option.foreach(Option.scala:407)\r\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1182)\r\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:2860)\r\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2802)\r\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2791)\r\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)\r\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:952)\r\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2228)\r\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2249)\r\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2268)\r\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:506)\r\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:459)\r\n\tat org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:48)\r\n\tat org.apache.spark.sql.Dataset.$anonfun$collectToPython$1(Dataset.scala:3688)\r\n\tat org.apache.spark.sql.Dataset.$anonfun$withAction$2(Dataset.scala:3858)\r\n\tat org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:510)\r\n\tat org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:3856)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:109)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:169)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:95)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\r\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:3856)\r\n\tat org.apache.spark.sql.Dataset.collectToPython(Dataset.scala:3685)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\r\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\r\n\tat py4j.Gateway.invoke(Gateway.java:282)\r\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\r\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\r\n\tat py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\r\n\tat py4j.ClientServerConnection.run(ClientServerConnection.java:106)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: org.apache.spark.SparkException: Python worker exited unexpectedly (crashed)\r\n\tat org.apache.spark.api.python.BasePythonRunner$ReaderIterator$$anonfun$1.applyOrElse(PythonRunner.scala:599)\r\n\tat org.apache.spark.api.python.BasePythonRunner$ReaderIterator$$anonfun$1.applyOrElse(PythonRunner.scala:581)\r\n\tat scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:38)\r\n\tat org.apache.spark.sql.execution.python.PythonArrowOutput$$anon$1.read(PythonArrowOutput.scala:107)\r\n\tat org.apache.spark.sql.execution.python.PythonArrowOutput$$anon$1.read(PythonArrowOutput.scala:50)\r\n\tat org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:512)\r\n\tat org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)\r\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)\r\n\tat scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.processNext(Unknown Source)\r\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\r\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:760)\r\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:364)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:890)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:890)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:365)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:329)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:136)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:548)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1504)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:551)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n\t... 1 more\r\nCaused by: java.io.EOFException\r\n\tat java.io.DataInputStream.readInt(DataInputStream.java:392)\r\n\tat org.apache.spark.sql.execution.python.PythonArrowOutput$$anon$1.read(PythonArrowOutput.scala:88)\r\n\t... 22 more\r\n```","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1192044612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jerrylian-db","id":66143562,"node_id":"MDQ6VXNlcjY2MTQzNTYy","avatar_url":"https://avatars.githubusercontent.com/u/66143562?v=4","gravatar_id":"","url":"https://api.github.com/users/jerrylian-db","html_url":"https://github.com/jerrylian-db","followers_url":"https://api.github.com/users/jerrylian-db/followers","following_url":"https://api.github.com/users/jerrylian-db/following{/other_user}","gists_url":"https://api.github.com/users/jerrylian-db/gists{/gist_id}","starred_url":"https://api.github.com/users/jerrylian-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerrylian-db/subscriptions","organizations_url":"https://api.github.com/users/jerrylian-db/orgs","repos_url":"https://api.github.com/users/jerrylian-db/repos","events_url":"https://api.github.com/users/jerrylian-db/events{/privacy}","received_events_url":"https://api.github.com/users/jerrylian-db/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1192055958","html_url":"https://github.com/mlflow/mlflow/issues/6298#issuecomment-1192055958","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/6298","id":1192055958,"node_id":"IC_kwDOCB5Jx85HDVSW","user":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false},"created_at":"2022-07-22T00:26:03Z","updated_at":"2022-07-22T00:26:03Z","author_association":"COLLABORATOR","body":"@jerrylian-db This looks like an OSX-specific multithreading security issue; looks like it can be remedied as follows:  https://stackoverflow.com/a/52230415. Here's another StackOverflow issue that mentions Spark UDFs specifically: https://stackoverflow.com/questions/55379298/how-to-use-pandas-udfs-on-macos-mojave-that-fails-due-to-nsplaceholderdicti.\r\n\r\nIn summary, this isn't an MLflow issue and seems to be a MacOS-specific issue introduced by security-related changes in High Sierra and above.","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/1192055958/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false}},{"id":7042223313,"node_id":"CE_lADOCB5Jx85OUQK8zwAAAAGjv8zR","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7042223313","actor":{"login":"dbczumar","id":39497902,"node_id":"MDQ6VXNlcjM5NDk3OTAy","avatar_url":"https://avatars.githubusercontent.com/u/39497902?v=4","gravatar_id":"","url":"https://api.github.com/users/dbczumar","html_url":"https://github.com/dbczumar","followers_url":"https://api.github.com/users/dbczumar/followers","following_url":"https://api.github.com/users/dbczumar/following{/other_user}","gists_url":"https://api.github.com/users/dbczumar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbczumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbczumar/subscriptions","organizations_url":"https://api.github.com/users/dbczumar/orgs","repos_url":"https://api.github.com/users/dbczumar/repos","events_url":"https://api.github.com/users/dbczumar/events{/privacy}","received_events_url":"https://api.github.com/users/dbczumar/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-07-22T00:26:03Z","state_reason":null,"performed_via_github_app":null},{"id":7042223324,"node_id":"MEE_lADOCB5Jx85OUQK8zwAAAAGjv8zc","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7042223324","actor":{"login":"jerrylian-db","id":66143562,"node_id":"MDQ6VXNlcjY2MTQzNTYy","avatar_url":"https://avatars.githubusercontent.com/u/66143562?v=4","gravatar_id":"","url":"https://api.github.com/users/jerrylian-db","html_url":"https://github.com/jerrylian-db","followers_url":"https://api.github.com/users/jerrylian-db/followers","following_url":"https://api.github.com/users/jerrylian-db/following{/other_user}","gists_url":"https://api.github.com/users/jerrylian-db/gists{/gist_id}","starred_url":"https://api.github.com/users/jerrylian-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerrylian-db/subscriptions","organizations_url":"https://api.github.com/users/jerrylian-db/orgs","repos_url":"https://api.github.com/users/jerrylian-db/repos","events_url":"https://api.github.com/users/jerrylian-db/events{/privacy}","received_events_url":"https://api.github.com/users/jerrylian-db/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-22T00:26:03Z","performed_via_github_app":null},{"id":7042223327,"node_id":"SE_lADOCB5Jx85OUQK8zwAAAAGjv8zf","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/7042223327","actor":{"login":"jerrylian-db","id":66143562,"node_id":"MDQ6VXNlcjY2MTQzNTYy","avatar_url":"https://avatars.githubusercontent.com/u/66143562?v=4","gravatar_id":"","url":"https://api.github.com/users/jerrylian-db","html_url":"https://github.com/jerrylian-db","followers_url":"https://api.github.com/users/jerrylian-db/followers","following_url":"https://api.github.com/users/jerrylian-db/following{/other_user}","gists_url":"https://api.github.com/users/jerrylian-db/gists{/gist_id}","starred_url":"https://api.github.com/users/jerrylian-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerrylian-db/subscriptions","organizations_url":"https://api.github.com/users/jerrylian-db/orgs","repos_url":"https://api.github.com/users/jerrylian-db/repos","events_url":"https://api.github.com/users/jerrylian-db/events{/privacy}","received_events_url":"https://api.github.com/users/jerrylian-db/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-07-22T00:26:04Z","performed_via_github_app":null}]