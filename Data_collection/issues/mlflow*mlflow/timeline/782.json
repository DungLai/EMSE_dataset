[{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/531420375","html_url":"https://github.com/mlflow/mlflow/issues/782#issuecomment-531420375","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/782","id":531420375,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMTQyMDM3NQ==","user":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"created_at":"2019-09-13T23:25:05Z","updated_at":"2019-09-13T23:25:05Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.\n","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/531420375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false}},{"id":2633776408,"node_id":"MDEyOkxhYmVsZWRFdmVudDI2MzM3NzY0MDg=","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/2633776408","actor":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-09-13T23:25:35Z","label":{"name":"stale","color":"828282"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/553170725","html_url":"https://github.com/mlflow/mlflow/issues/782#issuecomment-553170725","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/782","id":553170725,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzE3MDcyNQ==","user":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"created_at":"2019-11-12T23:49:45Z","updated_at":"2019-11-12T23:49:45Z","author_association":"NONE","body":"This issue has not been interacted with for 60 days since it was marked as stale! As such, the issue is now closed. If you have this issue or more information, please re-open the issue!\n","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/553170725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false}},{"id":2793416098,"node_id":"MDExOkNsb3NlZEV2ZW50Mjc5MzQxNjA5OA==","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/2793416098","actor":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-11-12T23:50:11Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/555289910","html_url":"https://github.com/mlflow/mlflow/issues/782#issuecomment-555289910","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/782","id":555289910,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NTI4OTkxMA==","user":{"login":"KobaKhit","id":4805827,"node_id":"MDQ6VXNlcjQ4MDU4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4805827?v=4","gravatar_id":"","url":"https://api.github.com/users/KobaKhit","html_url":"https://github.com/KobaKhit","followers_url":"https://api.github.com/users/KobaKhit/followers","following_url":"https://api.github.com/users/KobaKhit/following{/other_user}","gists_url":"https://api.github.com/users/KobaKhit/gists{/gist_id}","starred_url":"https://api.github.com/users/KobaKhit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KobaKhit/subscriptions","organizations_url":"https://api.github.com/users/KobaKhit/orgs","repos_url":"https://api.github.com/users/KobaKhit/repos","events_url":"https://api.github.com/users/KobaKhit/events{/privacy}","received_events_url":"https://api.github.com/users/KobaKhit/received_events","type":"User","site_admin":false},"created_at":"2019-11-19T01:31:43Z","updated_at":"2019-11-19T01:32:42Z","author_association":"NONE","body":"Are there plans on resolving this issue? [I found a line where pandas dataframe is being passed to `model.predict` in `mlflow.pyspark.spark_udf`](https://github.com/mlflow/mlflow/blob/18d9778376ae4863832370c0f958d3e6d5268a77/mlflow/pyfunc/__init__.py#L467)[1]  and [a line where spark is trying to create the Spark DataFrame](https://github.com/mlflow/mlflow/blob/fdcf3402123bccfa88b376a5efcf13be4a65fd2f/mlflow/spark.py#L455)[2]\r\n\r\nI was able to make it work with your example above by replacing the predict method in [2].  \r\n\r\nThis problem prevents me from tracking my models which heavily use vector inputs.\r\n\r\n**original**\r\n``` python\r\ndef predict(self, pandas_df):\r\n        \"\"\"\r\n        Generate predictions given input data in a pandas DataFrame.\r\n        :param pandas_df: pandas DataFrame containing input data.\r\n        :return: List with model predictions.\r\n        \"\"\"\r\n        spark_df = self.spark.createDataFrame(pandas_df)\r\n        return [x.prediction for x in\r\n                self.spark_model.transform(spark_df).select(\"prediction\").collect()]\r\n```\r\n\r\n**new** - added `applymap` and `x.prediction.values`\r\n```python\r\ndef predict(self, pandas_df):\r\n        \"\"\"\r\n        Generate predictions given input data in a pandas DataFrame.\r\n\r\n        :param pandas_df: pandas DataFrame containing input data.\r\n        :return: List with model predictions.\r\n        \"\"\"\r\n        # raise Exception(type(pandas_df[pandas_df.columns[0]][0]))\r\n        # raise Exception(pandas_df.columns)\r\n        pandas_df = pandas_df.applymap(lambda x: x.tolist()) # new operation\r\n        spark_df = self.spark.createDataFrame(pandas_df)\r\n        return [x.prediction.values for x in\r\n                self.spark_model.transform(spark_df).select(\"prediction\").collect()]\r\n```\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/555289910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"KobaKhit","id":4805827,"node_id":"MDQ6VXNlcjQ4MDU4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4805827?v=4","gravatar_id":"","url":"https://api.github.com/users/KobaKhit","html_url":"https://github.com/KobaKhit","followers_url":"https://api.github.com/users/KobaKhit/followers","following_url":"https://api.github.com/users/KobaKhit/following{/other_user}","gists_url":"https://api.github.com/users/KobaKhit/gists{/gist_id}","starred_url":"https://api.github.com/users/KobaKhit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KobaKhit/subscriptions","organizations_url":"https://api.github.com/users/KobaKhit/orgs","repos_url":"https://api.github.com/users/KobaKhit/repos","events_url":"https://api.github.com/users/KobaKhit/events{/privacy}","received_events_url":"https://api.github.com/users/KobaKhit/received_events","type":"User","site_admin":false}}]