[{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/492957536","html_url":"https://github.com/mlflow/mlflow/issues/1281#issuecomment-492957536","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/1281","id":492957536,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Mjk1NzUzNg==","user":{"login":"jason-huling","id":7820042,"node_id":"MDQ6VXNlcjc4MjAwNDI=","avatar_url":"https://avatars.githubusercontent.com/u/7820042?v=4","gravatar_id":"","url":"https://api.github.com/users/jason-huling","html_url":"https://github.com/jason-huling","followers_url":"https://api.github.com/users/jason-huling/followers","following_url":"https://api.github.com/users/jason-huling/following{/other_user}","gists_url":"https://api.github.com/users/jason-huling/gists{/gist_id}","starred_url":"https://api.github.com/users/jason-huling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jason-huling/subscriptions","organizations_url":"https://api.github.com/users/jason-huling/orgs","repos_url":"https://api.github.com/users/jason-huling/repos","events_url":"https://api.github.com/users/jason-huling/events{/privacy}","received_events_url":"https://api.github.com/users/jason-huling/received_events","type":"User","site_admin":false},"created_at":"2019-05-16T07:46:39Z","updated_at":"2019-05-16T07:57:53Z","author_association":"CONTRIBUTOR","body":"I think I found where the bug is... I've walked through the `log_model` code here: https://github.com/mlflow/mlflow/blob/9fcd5caef9f73a9d1ded4e24467b27265f6720e6/mlflow/pyfunc/__init__.py#L640-L646\r\n\r\n...and have verified that the staging of the files with `save_model` is working correctly.\r\n\r\nI went on to look at `log_artifacts` which eventually took me to this line:\r\nhttps://github.com/mlflow/mlflow/blob/fa51dafc69a5dffe66781a8c51dc6c95977ee774/mlflow/store/gcs_artifact_repo.py#L59\r\nIt seems as though they just need to be swapped:\r\n```\r\nrel_path = os.path.relpath(root, local_dir) \r\n```\r\nWhere `local_dir` is the `'model'` save location, something like `'/mlflow/model'` and `root` will be the `artifacts` subdirectory `'/mlflow/model/artifacts'` in the second iteration of the main loop.\r\n\r\nHere is the original with those examples:\r\n```\r\nos.path.relpath('mlflow/model', 'mlflow/model/artifacts')\r\n> '..'\r\n```\r\nAnd the corrected version:\r\n```\r\nos.path.relpath('mlflow/model/artifacts', 'mlflow/model')\r\n> 'artifacts'\r\n```\r\n\r\nDoes this sound correct?","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/492957536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jason-huling","id":7820042,"node_id":"MDQ6VXNlcjc4MjAwNDI=","avatar_url":"https://avatars.githubusercontent.com/u/7820042?v=4","gravatar_id":"","url":"https://api.github.com/users/jason-huling","html_url":"https://github.com/jason-huling","followers_url":"https://api.github.com/users/jason-huling/followers","following_url":"https://api.github.com/users/jason-huling/following{/other_user}","gists_url":"https://api.github.com/users/jason-huling/gists{/gist_id}","starred_url":"https://api.github.com/users/jason-huling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jason-huling/subscriptions","organizations_url":"https://api.github.com/users/jason-huling/orgs","repos_url":"https://api.github.com/users/jason-huling/repos","events_url":"https://api.github.com/users/jason-huling/events{/privacy}","received_events_url":"https://api.github.com/users/jason-huling/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/493519101","html_url":"https://github.com/mlflow/mlflow/issues/1281#issuecomment-493519101","issue_url":"https://api.github.com/repos/mlflow/mlflow/issues/1281","id":493519101,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzUxOTEwMQ==","user":{"login":"jason-huling","id":7820042,"node_id":"MDQ6VXNlcjc4MjAwNDI=","avatar_url":"https://avatars.githubusercontent.com/u/7820042?v=4","gravatar_id":"","url":"https://api.github.com/users/jason-huling","html_url":"https://github.com/jason-huling","followers_url":"https://api.github.com/users/jason-huling/followers","following_url":"https://api.github.com/users/jason-huling/following{/other_user}","gists_url":"https://api.github.com/users/jason-huling/gists{/gist_id}","starred_url":"https://api.github.com/users/jason-huling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jason-huling/subscriptions","organizations_url":"https://api.github.com/users/jason-huling/orgs","repos_url":"https://api.github.com/users/jason-huling/repos","events_url":"https://api.github.com/users/jason-huling/events{/privacy}","received_events_url":"https://api.github.com/users/jason-huling/received_events","type":"User","site_admin":false},"created_at":"2019-05-17T16:39:07Z","updated_at":"2019-05-17T16:39:07Z","author_association":"CONTRIBUTOR","body":"This has been resolved with https://github.com/mlflow/mlflow/pull/1285","reactions":{"url":"https://api.github.com/repos/mlflow/mlflow/issues/comments/493519101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jason-huling","id":7820042,"node_id":"MDQ6VXNlcjc4MjAwNDI=","avatar_url":"https://avatars.githubusercontent.com/u/7820042?v=4","gravatar_id":"","url":"https://api.github.com/users/jason-huling","html_url":"https://github.com/jason-huling","followers_url":"https://api.github.com/users/jason-huling/followers","following_url":"https://api.github.com/users/jason-huling/following{/other_user}","gists_url":"https://api.github.com/users/jason-huling/gists{/gist_id}","starred_url":"https://api.github.com/users/jason-huling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jason-huling/subscriptions","organizations_url":"https://api.github.com/users/jason-huling/orgs","repos_url":"https://api.github.com/users/jason-huling/repos","events_url":"https://api.github.com/users/jason-huling/events{/privacy}","received_events_url":"https://api.github.com/users/jason-huling/received_events","type":"User","site_admin":false}},{"id":2349881604,"node_id":"MDExOkNsb3NlZEV2ZW50MjM0OTg4MTYwNA==","url":"https://api.github.com/repos/mlflow/mlflow/issues/events/2349881604","actor":{"login":"jason-huling","id":7820042,"node_id":"MDQ6VXNlcjc4MjAwNDI=","avatar_url":"https://avatars.githubusercontent.com/u/7820042?v=4","gravatar_id":"","url":"https://api.github.com/users/jason-huling","html_url":"https://github.com/jason-huling","followers_url":"https://api.github.com/users/jason-huling/followers","following_url":"https://api.github.com/users/jason-huling/following{/other_user}","gists_url":"https://api.github.com/users/jason-huling/gists{/gist_id}","starred_url":"https://api.github.com/users/jason-huling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jason-huling/subscriptions","organizations_url":"https://api.github.com/users/jason-huling/orgs","repos_url":"https://api.github.com/users/jason-huling/repos","events_url":"https://api.github.com/users/jason-huling/events{/privacy}","received_events_url":"https://api.github.com/users/jason-huling/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-05-17T16:39:08Z","state_reason":null,"performed_via_github_app":null}]