{"url":"https://api.github.com/repos/microsoft/graspologic/issues/655","repository_url":"https://api.github.com/repos/microsoft/graspologic","labels_url":"https://api.github.com/repos/microsoft/graspologic/issues/655/labels{/name}","comments_url":"https://api.github.com/repos/microsoft/graspologic/issues/655/comments","events_url":"https://api.github.com/repos/microsoft/graspologic/issues/655/events","html_url":"https://github.com/microsoft/graspologic/issues/655","id":803016899,"node_id":"MDU6SXNzdWU4MDMwMTY4OTk=","number":655,"title":"[BUG] Layouts fail for directed graphs","user":{"login":"bdpedigo","id":25714207,"node_id":"MDQ6VXNlcjI1NzE0MjA3","avatar_url":"https://avatars.githubusercontent.com/u/25714207?v=4","gravatar_id":"","url":"https://api.github.com/users/bdpedigo","html_url":"https://github.com/bdpedigo","followers_url":"https://api.github.com/users/bdpedigo/followers","following_url":"https://api.github.com/users/bdpedigo/following{/other_user}","gists_url":"https://api.github.com/users/bdpedigo/gists{/gist_id}","starred_url":"https://api.github.com/users/bdpedigo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdpedigo/subscriptions","organizations_url":"https://api.github.com/users/bdpedigo/orgs","repos_url":"https://api.github.com/users/bdpedigo/repos","events_url":"https://api.github.com/users/bdpedigo/events{/privacy}","received_events_url":"https://api.github.com/users/bdpedigo/received_events","type":"User","site_admin":false},"labels":[{"id":1048646805,"node_id":"MDU6TGFiZWwxMDQ4NjQ2ODA1","url":"https://api.github.com/repos/microsoft/graspologic/labels/bug","name":"bug","color":"cded2d","default":true,"description":"Something isn't working"},{"id":2449973732,"node_id":"MDU6TGFiZWwyNDQ5OTczNzMy","url":"https://api.github.com/repos/microsoft/graspologic/labels/discussion","name":"discussion","color":"4267b7","default":false,"description":"graspologic team discussion"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2021-02-07T18:11:33Z","updated_at":"2021-08-12T17:02:39Z","closed_at":"2021-08-12T17:02:39Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"## Expected Behavior\r\nLayouts should work with directed graphs (IMO)\r\nPerhaps not a bug in the sense that I'm not sure we promise this works for directed, but still. If we decided to only support undirected maybe a clearer error is warranted. \r\n\r\n## Actual Behavior\r\n``NetworkXNotImplemented: not implemented for directed type``\r\n\r\n## Example Code\r\n```python\r\nimport networkx as nx\r\nfrom graspologic.layouts import layout_umap\r\n\r\ng = nx.erdos_renyi_graph(10, 0.7, directed=True)\r\nlayout_umap(g)\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\n---------------------------------------------------------------------------\r\nNetworkXNotImplemented                    Traceback (most recent call last)\r\n~/JHU_code/maggot/maggot_connectome/scripts/what_is_flow_rank.py in \r\n      3 \r\n      4 g = nx.erdos_renyi_graph(10, 0.7, directed=True)\r\n----> 5 layout_umap(g)\r\n\r\n~/miniconda3/envs/maggot-revamp/lib/python3.8/site-packages/graspologic/layouts/auto.py in layout_umap(graph, min_dist, n_neighbors, max_edges, random_seed)\r\n    173     \"\"\"\r\n    174 \r\n--> 175     lcc_graph, tensors, labels = _node2vec_for_layout(graph, max_edges, random_seed)\r\n    176     points = umap.UMAP(\r\n    177         min_dist=min_dist, n_neighbors=n_neighbors, random_state=random_seed\r\n\r\n~/miniconda3/envs/maggot-revamp/lib/python3.8/site-packages/graspologic/layouts/auto.py in _node2vec_for_layout(graph, max_edges, random_seed)\r\n    214 ) -> Tuple[nx.Graph, np.ndarray, np.ndarray]:\r\n    215     graph = _approximate_prune(graph, max_edges)\r\n--> 216     graph = _largest_connected_component(graph)\r\n    217 \r\n    218     start = time.time()\r\n\r\n~/miniconda3/envs/maggot-revamp/lib/python3.8/site-packages/graspologic/layouts/auto.py in _largest_connected_component(graph)\r\n    182 \r\n    183 def _largest_connected_component(graph: nx.Graph) -> nx.Graph:\r\n--> 184     largest_component = max(nx.connected_components(graph), key=len)\r\n    185     return graph.subgraph(largest_component).copy()\r\n    186 \r\n\r\n in connected_components(G)\r\n\r\n~/miniconda3/envs/maggot-revamp/lib/python3.8/site-packages/networkx/utils/decorators.py in _not_implemented_for(not_implement_for_func, *args, **kwargs)\r\n     74         if match:\r\n     75             msg = f\"not implemented for {' '.join(graph_types)} type\"\r\n---> 76             raise nx.NetworkXNotImplemented(msg)\r\n     77         else:\r\n     78             return not_implement_for_func(*args, **kwargs)\r\n\r\nNetworkXNotImplemented: not implemented for directed type\r\n```\r\n\r\n## Your Environment\r\n* Python version: 3.8\r\n* graspologic version: dev\r\n\r\n## Additional Details\r\n```pytb\r\n183 def _largest_connected_component(graph: nx.Graph) -> nx.Graph:\r\n--> 184     largest_component = max(nx.connected_components(graph), key=len)\r\n```\r\nJust from these 2 lines on the traceback, I suspect this just needs to be adapted to check for weakly connected components. Or, use `graspologic.utils.is_fully_connected` from our own codebase. However in #112 we are talking about replacing the networkx-based check with a faster one from scipy. Not sure if the layouts code will always assume networkx input going forward. AFAIK there is nothing that inherently needs to be undirected for the layouts process, or am I missing something? \r\n","closed_by":{"login":"bdpedigo","id":25714207,"node_id":"MDQ6VXNlcjI1NzE0MjA3","avatar_url":"https://avatars.githubusercontent.com/u/25714207?v=4","gravatar_id":"","url":"https://api.github.com/users/bdpedigo","html_url":"https://github.com/bdpedigo","followers_url":"https://api.github.com/users/bdpedigo/followers","following_url":"https://api.github.com/users/bdpedigo/following{/other_user}","gists_url":"https://api.github.com/users/bdpedigo/gists{/gist_id}","starred_url":"https://api.github.com/users/bdpedigo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdpedigo/subscriptions","organizations_url":"https://api.github.com/users/bdpedigo/orgs","repos_url":"https://api.github.com/users/bdpedigo/repos","events_url":"https://api.github.com/users/bdpedigo/events{/privacy}","received_events_url":"https://api.github.com/users/bdpedigo/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/microsoft/graspologic/issues/655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/microsoft/graspologic/issues/655/timeline","performed_via_github_app":null,"state_reason":"completed"}