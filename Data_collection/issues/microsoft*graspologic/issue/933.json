{"url":"https://api.github.com/repos/microsoft/graspologic/issues/933","repository_url":"https://api.github.com/repos/microsoft/graspologic","labels_url":"https://api.github.com/repos/microsoft/graspologic/issues/933/labels{/name}","comments_url":"https://api.github.com/repos/microsoft/graspologic/issues/933/comments","events_url":"https://api.github.com/repos/microsoft/graspologic/issues/933/events","html_url":"https://github.com/microsoft/graspologic/issues/933","id":1169694507,"node_id":"I_kwDOCM7Erc5FuB8r","number":933,"title":"[BUG] When you have inner and outer hierarchical labels, plotting fails if something in the cartesian product is empty","user":{"login":"ebridge2","id":8883547,"node_id":"MDQ6VXNlcjg4ODM1NDc=","avatar_url":"https://avatars.githubusercontent.com/u/8883547?v=4","gravatar_id":"","url":"https://api.github.com/users/ebridge2","html_url":"https://github.com/ebridge2","followers_url":"https://api.github.com/users/ebridge2/followers","following_url":"https://api.github.com/users/ebridge2/following{/other_user}","gists_url":"https://api.github.com/users/ebridge2/gists{/gist_id}","starred_url":"https://api.github.com/users/ebridge2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ebridge2/subscriptions","organizations_url":"https://api.github.com/users/ebridge2/orgs","repos_url":"https://api.github.com/users/ebridge2/repos","events_url":"https://api.github.com/users/ebridge2/events{/privacy}","received_events_url":"https://api.github.com/users/ebridge2/received_events","type":"User","site_admin":false},"labels":[{"id":1048646805,"node_id":"MDU6TGFiZWwxMDQ4NjQ2ODA1","url":"https://api.github.com/repos/microsoft/graspologic/labels/bug","name":"bug","color":"cded2d","default":true,"description":"Something isn't working"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-03-15T13:43:05Z","updated_at":"2022-03-15T13:44:48Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"## Expected Behavior\r\n\r\nThe empty communities are omitted entirely.\r\n\r\n## Actual Behavior\r\n\r\nError.\r\n\r\n```\r\nValueError: The number of FixedLocator locations (4), usually from a call to set_ticks, does not match the number of ticklabels (6).\r\n```\r\n\r\n## Example Code\r\n\r\n```\r\nimport numpy as np\r\nimport graspologic as gp\r\n\r\nn1 = 50; n2 = 50\r\nBaff = [[0.5, 0.2], [0.2, 0.5]]\r\n\r\nzvecaff = np.array([\"C1\" for i in range(0, n1)] + [\"C2\" for i in range(0, n2)])\r\n\r\n# the probability matrix\r\nzvecaff_ohe = np.vstack([[1, 0] for i in range(0, n1)] + [[0, 1] for i in range(0, n2)])\r\nPaff = zvecaff_ohe @ Baff @ zvecaff_ohe.T\r\n\r\nnp1 = 15; nc = 70; np2 = 15\r\nBcp = [[0.2, 0.2, 0.05],\r\n      [0.2, 0.5, 0.2],\r\n      [0.05, 0.2, 0.2]]\r\n\r\n\r\nzveccp = np.array([\"P1\" for i in range(0, np1)] +\r\n                  [\"Core\" for i in range(0, nc)] +\r\n                  [\"P2\" for i in range(0, np2)])\r\n\r\n# the probability matrix\r\nzveccp_ohe = np.vstack([[1, 0, 0] for i in range(0, np1)] + \r\n                       [[0, 1, 0] for i in range(0, nc)] +\r\n                       [[0, 0, 1] for i in range(0, np2)])\r\nPcp = zveccp_ohe @ Bcp @ zveccp_ohe.T\r\n\r\nPcp_and_aff = (Paff + Pcp)/2\r\nAcp_and_aff = gp.simulations.sample_edges(Pcp_and_aff, directed=False, loops=False)\r\n\r\n\r\ngp.plot.heatmap(Pcp, inner_hier_labels=zveccp, outer_hier_labels=zvecaff,\r\n                title=\"Core-periphery and affinity prob. P^{(cp + a)}$\", vmin=0, vmax=1, cmap=cmaps[\"sequential\"]);\r\n```\r\n\r\n## Full Traceback\r\n\r\n```pytb\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-63-9fa6c510a0a5> in <module>\r\n      1 fig, axs = plt.subplots(1,2, figsize=(10,4))\r\n      2 \r\n----> 3 gp.plot.heatmap(Pcp, ax=axs[0], inner_hier_labels=zveccp, outer_hier_labels=zvecaff,\r\n      4                 title=\"Core-periphery and affinity prob. P^{(cp + a)}$\", vmin=0, vmax=1, cmap=cmaps[\"sequential\"]);\r\n      5 gp.plot.heatmap(Acp, ax=axs[1], inner_hier_labels=zveccp, outer_hier_labels=zvecaff,\r\n\r\n~/.virtualenvs/graph-book/lib/python3.8/site-packages/graspologic/plot/plot.py in heatmap(X, transform, figsize, title, context, font_scale, xticklabels, yticklabels, cmap, vmin, vmax, center, cbar, inner_hier_labels, outer_hier_labels, hier_label_fontsize, ax, title_pad, sort_nodes, **kwargs)\r\n    353                 plot.set_yticklabels([])\r\n    354                 plot.set_xticklabels([])\r\n--> 355                 _plot_groups(\r\n    356                     plot,\r\n    357                     arr,\r\n\r\n~/.virtualenvs/graph-book/lib/python3.8/site-packages/graspologic/plot/plot.py in _plot_groups(ax, graph, inner_labels, outer_labels, fontsize)\r\n   1611     ax_x = divider.new_vertical(size=\"5%\", pad=0.0, pack_start=False)\r\n   1612     ax.figure.add_axes(ax_x)\r\n-> 1613     _plot_brackets(\r\n   1614         ax_x,\r\n   1615         np.tile(inner_unique, len(outer_unique)),\r\n\r\n~/.virtualenvs/graph-book/lib/python3.8/site-packages/graspologic/plot/plot.py in _plot_brackets(ax, group_names, tick_loc, tick_width, curve, level, axis, max_size, fontsize)\r\n   1696     if axis == \"x\":\r\n   1697         ax.set_xticks(tick_loc)\r\n-> 1698         ax.set_xticklabels(group_names, fontsize=fontsize, verticalalignment=\"center\")\r\n   1699         ax.xaxis.set_label_position(\"top\")\r\n   1700         ax.xaxis.tick_top()\r\n\r\n~/.virtualenvs/graph-book/lib/python3.8/site-packages/matplotlib/axes/_base.py in wrapper(self, *args, **kwargs)\r\n     73 \r\n     74         def wrapper(self, *args, **kwargs):\r\n---> 75             return get_method(self)(*args, **kwargs)\r\n     76 \r\n     77         wrapper.__module__ = owner.__module__\r\n\r\n~/.virtualenvs/graph-book/lib/python3.8/site-packages/matplotlib/axis.py in _set_ticklabels(self, labels, fontdict, minor, **kwargs)\r\n   1796         if fontdict is not None:\r\n   1797             kwargs.update(fontdict)\r\n-> 1798         return self.set_ticklabels(labels, minor=minor, **kwargs)\r\n   1799 \r\n   1800     def _set_tick_locations(self, ticks, *, minor=False):\r\n\r\n~/.virtualenvs/graph-book/lib/python3.8/site-packages/matplotlib/axis.py in set_ticklabels(self, ticklabels, minor, **kwargs)\r\n   1718             # remove all tick labels, so only error for > 0 ticklabels\r\n   1719             if len(locator.locs) != len(ticklabels) and len(ticklabels) != 0:\r\n-> 1720                 raise ValueError(\r\n   1721                     \"The number of FixedLocator locations\"\r\n   1722                     f\" ({len(locator.locs)}), usually from a call to\"\r\n\r\nValueError: The number of FixedLocator locations (4), usually from a call to set_ticks, does not match the number of ticklabels (6).\r\n```\r\n\r\n## Your Environment\r\n* Python version: 3.8\r\n* graspologic version: 1.0.1\r\n\r\n## Additional Details\r\nAny other contextual information you might feel is important.\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/microsoft/graspologic/issues/933/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/microsoft/graspologic/issues/933/timeline","performed_via_github_app":null,"state_reason":null}