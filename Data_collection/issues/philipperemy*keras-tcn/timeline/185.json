[{"id":4340421367,"node_id":"MDEyOkxhYmVsZWRFdmVudDQzNDA0MjEzNjc=","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/4340421367","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-02-17T09:46:15Z","label":{"name":"enhancement","color":"a2eeef"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/794908033","html_url":"https://github.com/philipperemy/keras-tcn/issues/185#issuecomment-794908033","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/185","id":794908033,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDkwODAzMw==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2021-03-10T05:30:37Z","updated_at":"2021-03-10T05:30:37Z","author_association":"OWNER","body":"@mimxrt not sure exactly why it does not work. This should work in theory:\r\n\r\n```python\r\nm_in = K.Input(shape=(None, 2), batch_size=batch_size, ragged=True)\r\n```\r\n\r\nRef: https://github.com/tensorflow/tensorflow/issues/27170","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/794908033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"id":4433571207,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDQzMzU3MTIwNw==","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/4433571207","actor":{"login":"mimxrt","id":53339396,"node_id":"MDQ6VXNlcjUzMzM5Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/53339396?v=4","gravatar_id":"","url":"https://api.github.com/users/mimxrt","html_url":"https://github.com/mimxrt","followers_url":"https://api.github.com/users/mimxrt/followers","following_url":"https://api.github.com/users/mimxrt/following{/other_user}","gists_url":"https://api.github.com/users/mimxrt/gists{/gist_id}","starred_url":"https://api.github.com/users/mimxrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mimxrt/subscriptions","organizations_url":"https://api.github.com/users/mimxrt/orgs","repos_url":"https://api.github.com/users/mimxrt/repos","events_url":"https://api.github.com/users/mimxrt/events{/privacy}","received_events_url":"https://api.github.com/users/mimxrt/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-10T05:30:37Z","performed_via_github_app":null},{"id":4433571217,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ0MzM1NzEyMTc=","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/4433571217","actor":{"login":"mimxrt","id":53339396,"node_id":"MDQ6VXNlcjUzMzM5Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/53339396?v=4","gravatar_id":"","url":"https://api.github.com/users/mimxrt","html_url":"https://github.com/mimxrt","followers_url":"https://api.github.com/users/mimxrt/followers","following_url":"https://api.github.com/users/mimxrt/following{/other_user}","gists_url":"https://api.github.com/users/mimxrt/gists{/gist_id}","starred_url":"https://api.github.com/users/mimxrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mimxrt/subscriptions","organizations_url":"https://api.github.com/users/mimxrt/orgs","repos_url":"https://api.github.com/users/mimxrt/repos","events_url":"https://api.github.com/users/mimxrt/events{/privacy}","received_events_url":"https://api.github.com/users/mimxrt/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-10T05:30:37Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/795176172","html_url":"https://github.com/philipperemy/keras-tcn/issues/185#issuecomment-795176172","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/185","id":795176172,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NTE3NjE3Mg==","user":{"login":"mimxrt","id":53339396,"node_id":"MDQ6VXNlcjUzMzM5Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/53339396?v=4","gravatar_id":"","url":"https://api.github.com/users/mimxrt","html_url":"https://github.com/mimxrt","followers_url":"https://api.github.com/users/mimxrt/followers","following_url":"https://api.github.com/users/mimxrt/following{/other_user}","gists_url":"https://api.github.com/users/mimxrt/gists{/gist_id}","starred_url":"https://api.github.com/users/mimxrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mimxrt/subscriptions","organizations_url":"https://api.github.com/users/mimxrt/orgs","repos_url":"https://api.github.com/users/mimxrt/repos","events_url":"https://api.github.com/users/mimxrt/events{/privacy}","received_events_url":"https://api.github.com/users/mimxrt/received_events","type":"User","site_admin":false},"created_at":"2021-03-10T09:55:57Z","updated_at":"2021-03-10T09:55:57Z","author_association":"NONE","body":"I'm not sure why but it doesn't work for me. I also made sure to get the latest version of TensorFlow this time! Can you try and run this example?\r\n```\r\nimport sys\r\nimport tcn\r\nimport numpy as np\r\nimport tensorflow as tf\r\nimport tensorflow.keras as K\r\n\r\nbatch_size=2\r\n\r\nprint(f\"sys.version: {sys.version}\")\r\nprint(f\"tf.__version__: {tf.__version__}\")\r\n\r\nX = [\r\n    np.array([[1, 1], [2, 2], [3, 3], [4, 4], [5, 5]]),\r\n    np.array([[1, 1], [2, 2], [3, 3]]),\r\n    np.array([[1, 1]]),\r\n    np.array([[1, 1], [2, 2], [3, 3], [4, 4], [5, 5], [6, 6]]),\r\n]\r\nY = np.array([6, 1, 2, 4])\r\n\r\nds_raw_X = tf.data.Dataset.from_tensor_slices(tf.ragged.constant(X, inner_shape=(2,)))\r\nds_raw_Y = tf.data.Dataset.from_tensor_slices(Y)\r\n\r\nds_raw = tf.data.Dataset.zip((ds_raw_X, ds_raw_Y))\r\n\r\nprint(\"Raw dataset:\")\r\nfor e in ds_raw.take(2):\r\n    print(f\"{(e[0].shape, e[1].shape)}\")\r\nprint(\"...\\n\")\r\n\r\nds = ds_raw.batch(batch_size)\r\n\r\nprint(\"Final dataset:\")\r\nfor e in ds.take(2):\r\n    print(f\"{(e[0].shape, e[1].shape)}\")\r\nprint(\"...\\n\")\r\n\r\nm_in = K.Input(shape=(None, 2), batch_size=batch_size, ragged=True) # note the added ragged=True parameter\r\nm_out = tcn.TCN(\r\n    nb_filters=32,\r\n    return_sequences=False\r\n)(m_in)\r\nm_out = K.layers.Dense(1)(m_out)\r\n\r\nmodel = K.Model([m_in], m_out)\r\nprint(model.summary(), end=\"\\n\\n\")\r\n\r\nmodel.compile(optimizer=K.optimizers.Adam(), loss=K.losses.MeanSquaredError())\r\n\r\nmodel.fit(ds, epochs=1)\r\n```\r\nOutput for me:\r\n```\r\nsys.version: 3.7.10 (default, Feb 26 2021, 13:06:18) [MSC v.1916 64 bit (AMD64)]\r\ntf.__version__: 2.4.1\r\nRaw dataset:\r\n(TensorShape([5, 2]), TensorShape([]))\r\n(TensorShape([3, 2]), TensorShape([]))\r\n...\r\n\r\nFinal dataset:\r\n(TensorShape([2, None, 2]), TensorShape([2]))\r\n(TensorShape([2, None, 2]), TensorShape([2]))\r\n...\r\n\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-2-c63b87df74e5> in <module>\r\n     39     nb_filters=32,\r\n     40     return_sequences=False\r\n---> 41 )(m_in)\r\n     42 m_out = K.layers.Dense(1)(m_out)\r\n     43 \r\n\r\n~\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\base_layer.py in __call__(self, *args, **kwargs)\r\n    950     if _in_functional_construction_mode(self, inputs, args, kwargs, input_list):\r\n    951       return self._functional_construction_call(inputs, args, kwargs,\r\n--> 952                                                 input_list)\r\n    953 \r\n    954     # Maintains info about the `Layer.call` stack.\r\n\r\n~\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\base_layer.py in _functional_construction_call(self, inputs, args, kwargs, input_list)\r\n   1089         # Check input assumptions set after layer building, e.g. input shape.\r\n   1090         outputs = self._keras_tensor_symbolic_call(\r\n-> 1091             inputs, input_masks, args, kwargs)\r\n   1092 \r\n   1093         if outputs is None:\r\n\r\n~\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\base_layer.py in _keras_tensor_symbolic_call(self, inputs, input_masks, args, kwargs)\r\n    820       return nest.map_structure(keras_tensor.KerasTensor, output_signature)\r\n    821     else:\r\n--> 822       return self._infer_output_signature(inputs, args, kwargs, input_masks)\r\n    823 \r\n    824   def _infer_output_signature(self, inputs, args, kwargs, input_masks):\r\n\r\n~\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\base_layer.py in _infer_output_signature(self, inputs, args, kwargs, input_masks)\r\n    861           # TODO(kaftan): do we maybe_build here, or have we already done it?\r\n    862           self._maybe_build(inputs)\r\n--> 863           outputs = call_fn(inputs, *args, **kwargs)\r\n    864 \r\n    865         self._handle_activity_regularization(inputs, outputs)\r\n\r\n~\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\autograph\\impl\\api.py in wrapper(*args, **kwargs)\r\n    668       except Exception as e:  # pylint:disable=broad-except\r\n    669         if hasattr(e, 'ag_error_metadata'):\r\n--> 670           raise e.ag_error_metadata.to_exception(e)\r\n    671         else:\r\n    672           raise\r\n\r\nTypeError: in user code:\r\n\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tcn\\tcn.py:319 call  *\r\n        x, skip_out = layer(K.cast(x, 'float32'), training=training)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tcn\\tcn.py:155 call  *\r\n        x = layer(x, training=training) if training_flag else layer(x)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\base_layer.py:1012 __call__  **\r\n        outputs = call_fn(inputs, *args, **kwargs)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\keras\\layers\\convolutional.py:246 call\r\n        inputs = array_ops.pad(inputs, self._compute_causal_padding(inputs))\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\util\\dispatch.py:201 wrapper\r\n        return target(*args, **kwargs)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\ops\\array_ops.py:3422 pad\r\n        result = gen_array_ops.pad(tensor, paddings, name=name)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\ops\\gen_array_ops.py:6484 pad\r\n        \"Pad\", input=input, paddings=paddings, name=name)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py:525 _apply_op_helper\r\n        raise err\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py:522 _apply_op_helper\r\n        preferred_dtype=default_dtype)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\profiler\\trace.py:163 wrapped\r\n        return func(*args, **kwargs)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py:1540 convert_to_tensor\r\n        ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\framework\\constant_op.py:339 _constant_tensor_conversion_function\r\n        return constant(v, dtype=dtype, name=name)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\framework\\constant_op.py:265 constant\r\n        allow_broadcast=True)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\framework\\constant_op.py:283 _constant_impl\r\n        allow_broadcast=allow_broadcast))\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\framework\\tensor_util.py:553 make_tensor_proto\r\n        \"supported type.\" % (type(values), values))\r\n\r\n    TypeError: Failed to convert object of type <class 'tensorflow.python.ops.ragged.ragged_tensor.RaggedTensor'> to Tensor. Contents: tf.RaggedTensor(values=Tensor(\"Placeholder:0\", shape=(None, 2), dtype=float32), row_splits=Tensor(\"Placeholder_1:0\", shape=(3,), dtype=int64)). Consider casting elements to a supported type.\r\n```","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/795176172/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mimxrt","id":53339396,"node_id":"MDQ6VXNlcjUzMzM5Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/53339396?v=4","gravatar_id":"","url":"https://api.github.com/users/mimxrt","html_url":"https://github.com/mimxrt","followers_url":"https://api.github.com/users/mimxrt/followers","following_url":"https://api.github.com/users/mimxrt/following{/other_user}","gists_url":"https://api.github.com/users/mimxrt/gists{/gist_id}","starred_url":"https://api.github.com/users/mimxrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mimxrt/subscriptions","organizations_url":"https://api.github.com/users/mimxrt/orgs","repos_url":"https://api.github.com/users/mimxrt/repos","events_url":"https://api.github.com/users/mimxrt/events{/privacy}","received_events_url":"https://api.github.com/users/mimxrt/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/796310086","html_url":"https://github.com/philipperemy/keras-tcn/issues/185#issuecomment-796310086","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/185","id":796310086,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjMxMDA4Ng==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2021-03-11T00:11:24Z","updated_at":"2021-03-11T00:11:24Z","author_association":"OWNER","body":"@mimxrt yes it does not work for me too. But seems like it's a Keras issue here.","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/796310086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"id":4440174761,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDQ0MDE3NDc2MQ==","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/4440174761","actor":{"login":"mimxrt","id":53339396,"node_id":"MDQ6VXNlcjUzMzM5Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/53339396?v=4","gravatar_id":"","url":"https://api.github.com/users/mimxrt","html_url":"https://github.com/mimxrt","followers_url":"https://api.github.com/users/mimxrt/followers","following_url":"https://api.github.com/users/mimxrt/following{/other_user}","gists_url":"https://api.github.com/users/mimxrt/gists{/gist_id}","starred_url":"https://api.github.com/users/mimxrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mimxrt/subscriptions","organizations_url":"https://api.github.com/users/mimxrt/orgs","repos_url":"https://api.github.com/users/mimxrt/repos","events_url":"https://api.github.com/users/mimxrt/events{/privacy}","received_events_url":"https://api.github.com/users/mimxrt/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-11T00:11:24Z","performed_via_github_app":null},{"id":4440174766,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ0NDAxNzQ3NjY=","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/4440174766","actor":{"login":"mimxrt","id":53339396,"node_id":"MDQ6VXNlcjUzMzM5Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/53339396?v=4","gravatar_id":"","url":"https://api.github.com/users/mimxrt","html_url":"https://github.com/mimxrt","followers_url":"https://api.github.com/users/mimxrt/followers","following_url":"https://api.github.com/users/mimxrt/following{/other_user}","gists_url":"https://api.github.com/users/mimxrt/gists{/gist_id}","starred_url":"https://api.github.com/users/mimxrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mimxrt/subscriptions","organizations_url":"https://api.github.com/users/mimxrt/orgs","repos_url":"https://api.github.com/users/mimxrt/repos","events_url":"https://api.github.com/users/mimxrt/events{/privacy}","received_events_url":"https://api.github.com/users/mimxrt/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-11T00:11:24Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/796645206","html_url":"https://github.com/philipperemy/keras-tcn/issues/185#issuecomment-796645206","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/185","id":796645206,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjY0NTIwNg==","user":{"login":"mimxrt","id":53339396,"node_id":"MDQ6VXNlcjUzMzM5Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/53339396?v=4","gravatar_id":"","url":"https://api.github.com/users/mimxrt","html_url":"https://github.com/mimxrt","followers_url":"https://api.github.com/users/mimxrt/followers","following_url":"https://api.github.com/users/mimxrt/following{/other_user}","gists_url":"https://api.github.com/users/mimxrt/gists{/gist_id}","starred_url":"https://api.github.com/users/mimxrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mimxrt/subscriptions","organizations_url":"https://api.github.com/users/mimxrt/orgs","repos_url":"https://api.github.com/users/mimxrt/repos","events_url":"https://api.github.com/users/mimxrt/events{/privacy}","received_events_url":"https://api.github.com/users/mimxrt/received_events","type":"User","site_admin":false},"created_at":"2021-03-11T10:46:19Z","updated_at":"2021-03-11T10:46:19Z","author_association":"NONE","body":"Thanks for testing! I created another script that shows that it works by simply using `tf.keras.layers.LSTM` instead of `TCN` (only one line difference):\r\n```\r\nimport sys\r\nimport tcn\r\nimport numpy as np\r\nimport tensorflow as tf\r\nimport tensorflow.keras as K\r\n\r\nbatch_size=2\r\n\r\nprint(f\"sys.version: {sys.version}\")\r\nprint(f\"tf.__version__: {tf.__version__}\")\r\n\r\nX = [\r\n    np.array([[1, 1], [2, 2], [3, 3], [4, 4], [5, 5]]),\r\n    np.array([[1, 1], [2, 2], [3, 3]]),\r\n    np.array([[1, 1]]),\r\n    np.array([[1, 1], [2, 2], [3, 3], [4, 4], [5, 5], [6, 6]]),\r\n]\r\nY = np.array([6, 1, 2, 4])\r\n\r\nds_raw_X = tf.data.Dataset.from_tensors(tf.ragged.constant(X, inner_shape=(2,)))\r\nds_raw_Y = tf.data.Dataset.from_tensors(tf.constant(Y))\r\n\r\nds_raw = tf.data.Dataset.zip((ds_raw_X, ds_raw_Y))\r\nds = ds_raw\r\nds = ds.unbatch().batch(batch_size)\r\n\r\nprint(\"\\n\\n===========================\")\r\nprint(\"===== Works with LSTM =====\")\r\nprint(\"===========================\\n\")\r\n\r\nm_in = K.Input(shape=[None, 2], batch_size=batch_size, ragged=True)\r\nm_out = K.layers.LSTM(32)(m_in)\r\nm_out = K.layers.Dense(1)(m_out)\r\nmodel = K.Model([m_in], m_out)\r\nprint(model.summary(), end=\"\\n\\n\")\r\nmodel.compile(optimizer=K.optimizers.Adam(), loss=K.losses.MeanSquaredError())\r\nmodel.fit(ds, epochs=5)\r\n\r\nprint(\"\\n\\n===========================\")\r\nprint(\"===== Fails with TCN ======\")\r\nprint(\"===========================\\n\")\r\n\r\nm_in = K.Input(shape=[None, 2], batch_size=batch_size, ragged=True)\r\nm_out = tcn.TCN(32)(m_in)\r\nm_out = K.layers.Dense(1)(m_out)\r\nmodel = K.Model([m_in], m_out)\r\nprint(model.summary(), end=\"\\n\\n\")\r\nmodel.compile(optimizer=K.optimizers.Adam(), loss=K.losses.MeanSquaredError())\r\nmodel.fit(ds, epochs=5)\r\n```\r\nOutput:\r\n```\r\nsys.version: 3.7.10 (default, Feb 26 2021, 13:06:18) [MSC v.1916 64 bit (AMD64)]\r\ntf.__version__: 2.4.1\r\n\r\n\r\n===========================\r\n===== Works with LSTM =====\r\n===========================\r\n\r\nModel: \"model\"\r\n_________________________________________________________________\r\nLayer (type)                 Output Shape              Param #   \r\n=================================================================\r\ninput_1 (InputLayer)         [(2, None, 2)]            0         \r\n_________________________________________________________________\r\nlstm (LSTM)                  (2, 32)                   4480      \r\n_________________________________________________________________\r\ndense (Dense)                (2, 1)                    33        \r\n=================================================================\r\nTotal params: 4,513\r\nTrainable params: 4,513\r\nNon-trainable params: 0\r\n_________________________________________________________________\r\nNone\r\n\r\nEpoch 1/5\r\n2/2 [==============================] - 1s 5ms/step - loss: 15.8364\r\nEpoch 2/5\r\n2/2 [==============================] - 0s 4ms/step - loss: 15.1551\r\nEpoch 3/5\r\n2/2 [==============================] - 0s 5ms/step - loss: 14.4901\r\nEpoch 4/5\r\n2/2 [==============================] - 0s 5ms/step - loss: 13.8392\r\nEpoch 5/5\r\n2/2 [==============================] - 0s 5ms/step - loss: 13.2030\r\n\r\n\r\n===========================\r\n===== Fails with TCN ======\r\n===========================\r\n\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-1-aef4100541a3> in <module>\r\n     42 \r\n     43 m_in = K.Input(shape=[None, 2], batch_size=batch_size, ragged=True)\r\n---> 44 m_out = tcn.TCN(32)(m_in)\r\n     45 m_out = K.layers.Dense(1)(m_out)\r\n     46 model = K.Model([m_in], m_out)\r\n\r\n~\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\base_layer.py in __call__(self, *args, **kwargs)\r\n    950     if _in_functional_construction_mode(self, inputs, args, kwargs, input_list):\r\n    951       return self._functional_construction_call(inputs, args, kwargs,\r\n--> 952                                                 input_list)\r\n    953 \r\n    954     # Maintains info about the `Layer.call` stack.\r\n\r\n~\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\base_layer.py in _functional_construction_call(self, inputs, args, kwargs, input_list)\r\n   1089         # Check input assumptions set after layer building, e.g. input shape.\r\n   1090         outputs = self._keras_tensor_symbolic_call(\r\n-> 1091             inputs, input_masks, args, kwargs)\r\n   1092 \r\n   1093         if outputs is None:\r\n\r\n~\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\base_layer.py in _keras_tensor_symbolic_call(self, inputs, input_masks, args, kwargs)\r\n    820       return nest.map_structure(keras_tensor.KerasTensor, output_signature)\r\n    821     else:\r\n--> 822       return self._infer_output_signature(inputs, args, kwargs, input_masks)\r\n    823 \r\n    824   def _infer_output_signature(self, inputs, args, kwargs, input_masks):\r\n\r\n~\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\base_layer.py in _infer_output_signature(self, inputs, args, kwargs, input_masks)\r\n    861           # TODO(kaftan): do we maybe_build here, or have we already done it?\r\n    862           self._maybe_build(inputs)\r\n--> 863           outputs = call_fn(inputs, *args, **kwargs)\r\n    864 \r\n    865         self._handle_activity_regularization(inputs, outputs)\r\n\r\n~\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\autograph\\impl\\api.py in wrapper(*args, **kwargs)\r\n    668       except Exception as e:  # pylint:disable=broad-except\r\n    669         if hasattr(e, 'ag_error_metadata'):\r\n--> 670           raise e.ag_error_metadata.to_exception(e)\r\n    671         else:\r\n    672           raise\r\n\r\nTypeError: in user code:\r\n\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tcn\\tcn.py:319 call  *\r\n        x, skip_out = layer(K.cast(x, 'float32'), training=training)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tcn\\tcn.py:155 call  *\r\n        x = layer(x, training=training) if training_flag else layer(x)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\base_layer.py:1012 __call__  **\r\n        outputs = call_fn(inputs, *args, **kwargs)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\keras\\layers\\convolutional.py:246 call\r\n        inputs = array_ops.pad(inputs, self._compute_causal_padding(inputs))\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\util\\dispatch.py:201 wrapper\r\n        return target(*args, **kwargs)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\ops\\array_ops.py:3422 pad\r\n        result = gen_array_ops.pad(tensor, paddings, name=name)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\ops\\gen_array_ops.py:6484 pad\r\n        \"Pad\", input=input, paddings=paddings, name=name)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py:525 _apply_op_helper\r\n        raise err\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py:522 _apply_op_helper\r\n        preferred_dtype=default_dtype)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\profiler\\trace.py:163 wrapped\r\n        return func(*args, **kwargs)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py:1540 convert_to_tensor\r\n        ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\framework\\constant_op.py:339 _constant_tensor_conversion_function\r\n        return constant(v, dtype=dtype, name=name)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\framework\\constant_op.py:265 constant\r\n        allow_broadcast=True)\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\framework\\constant_op.py:283 _constant_impl\r\n        allow_broadcast=allow_broadcast))\r\n    C:\\Users\\user\\Anaconda3\\envs\\tf2\\lib\\site-packages\\tensorflow\\python\\framework\\tensor_util.py:553 make_tensor_proto\r\n        \"supported type.\" % (type(values), values))\r\n\r\n    TypeError: Failed to convert object of type <class 'tensorflow.python.ops.ragged.ragged_tensor.RaggedTensor'> to Tensor. Contents: tf.RaggedTensor(values=Tensor(\"Placeholder:0\", shape=(None, 2), dtype=float32), row_splits=Tensor(\"Placeholder_1:0\", shape=(3,), dtype=int64)). Consider casting elements to a supported type.\r\n```\r\nIs there anything that I need to configure properly to make it work with TCNs?","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/796645206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mimxrt","id":53339396,"node_id":"MDQ6VXNlcjUzMzM5Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/53339396?v=4","gravatar_id":"","url":"https://api.github.com/users/mimxrt","html_url":"https://github.com/mimxrt","followers_url":"https://api.github.com/users/mimxrt/followers","following_url":"https://api.github.com/users/mimxrt/following{/other_user}","gists_url":"https://api.github.com/users/mimxrt/gists{/gist_id}","starred_url":"https://api.github.com/users/mimxrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mimxrt/subscriptions","organizations_url":"https://api.github.com/users/mimxrt/orgs","repos_url":"https://api.github.com/users/mimxrt/repos","events_url":"https://api.github.com/users/mimxrt/events{/privacy}","received_events_url":"https://api.github.com/users/mimxrt/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/796740200","html_url":"https://github.com/philipperemy/keras-tcn/issues/185#issuecomment-796740200","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/185","id":796740200,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Njc0MDIwMA==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2021-03-11T13:36:24Z","updated_at":"2021-03-11T13:36:24Z","author_association":"OWNER","body":"I'd say it's because we have a custom function to build() the network. The support for RaggedTensor should be about updating this function. That's my gut feeling.","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/796740200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/796757710","html_url":"https://github.com/philipperemy/keras-tcn/issues/185#issuecomment-796757710","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/185","id":796757710,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Njc1NzcxMA==","user":{"login":"mimxrt","id":53339396,"node_id":"MDQ6VXNlcjUzMzM5Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/53339396?v=4","gravatar_id":"","url":"https://api.github.com/users/mimxrt","html_url":"https://github.com/mimxrt","followers_url":"https://api.github.com/users/mimxrt/followers","following_url":"https://api.github.com/users/mimxrt/following{/other_user}","gists_url":"https://api.github.com/users/mimxrt/gists{/gist_id}","starred_url":"https://api.github.com/users/mimxrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mimxrt/subscriptions","organizations_url":"https://api.github.com/users/mimxrt/orgs","repos_url":"https://api.github.com/users/mimxrt/repos","events_url":"https://api.github.com/users/mimxrt/events{/privacy}","received_events_url":"https://api.github.com/users/mimxrt/received_events","type":"User","site_admin":false},"created_at":"2021-03-11T14:02:35Z","updated_at":"2021-03-11T14:02:35Z","author_association":"NONE","body":"Maybe it also has something todo with this issue: https://github.com/tensorflow/tensorflow/issues/42417?\r\n\r\nHowever, I also don't really know what's the technical difficulty as in my understanding everything that supports `tf.keras.layers.Masking`, should also be able to support `tf.RaggedTensor`. In the worst case you would have to manually pad the ragged tensor data to the maximum length and mask the padded values (granted, you would have to know / compute the length in advance).","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/796757710/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mimxrt","id":53339396,"node_id":"MDQ6VXNlcjUzMzM5Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/53339396?v=4","gravatar_id":"","url":"https://api.github.com/users/mimxrt","html_url":"https://github.com/mimxrt","followers_url":"https://api.github.com/users/mimxrt/followers","following_url":"https://api.github.com/users/mimxrt/following{/other_user}","gists_url":"https://api.github.com/users/mimxrt/gists{/gist_id}","starred_url":"https://api.github.com/users/mimxrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mimxrt/subscriptions","organizations_url":"https://api.github.com/users/mimxrt/orgs","repos_url":"https://api.github.com/users/mimxrt/repos","events_url":"https://api.github.com/users/mimxrt/events{/privacy}","received_events_url":"https://api.github.com/users/mimxrt/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/796758843","html_url":"https://github.com/philipperemy/keras-tcn/issues/185#issuecomment-796758843","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/185","id":796758843,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Njc1ODg0Mw==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2021-03-11T14:04:05Z","updated_at":"2021-03-11T14:04:05Z","author_association":"OWNER","body":"Yes, I think you are right here. It's related. I'll see what I can do ;)","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/796758843/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/824334119","html_url":"https://github.com/philipperemy/keras-tcn/issues/185#issuecomment-824334119","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/185","id":824334119,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNDMzNDExOQ==","user":{"login":"maximgeller","id":57017700,"node_id":"MDQ6VXNlcjU3MDE3NzAw","avatar_url":"https://avatars.githubusercontent.com/u/57017700?v=4","gravatar_id":"","url":"https://api.github.com/users/maximgeller","html_url":"https://github.com/maximgeller","followers_url":"https://api.github.com/users/maximgeller/followers","following_url":"https://api.github.com/users/maximgeller/following{/other_user}","gists_url":"https://api.github.com/users/maximgeller/gists{/gist_id}","starred_url":"https://api.github.com/users/maximgeller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maximgeller/subscriptions","organizations_url":"https://api.github.com/users/maximgeller/orgs","repos_url":"https://api.github.com/users/maximgeller/repos","events_url":"https://api.github.com/users/maximgeller/events{/privacy}","received_events_url":"https://api.github.com/users/maximgeller/received_events","type":"User","site_admin":false},"created_at":"2021-04-21T20:23:54Z","updated_at":"2021-04-21T20:24:02Z","author_association":"NONE","body":"> However, I also don't really know what's the technical difficulty as in my understanding everything that supports `tf.keras.layers.Masking`, should also be able to support `tf.RaggedTensor`. In the worst case you would have to manually pad the ragged tensor data to the maximum length and mask the padded values (granted, you would have to know / compute the length in advance).\r\n\r\n@mimxrt \r\nUnfortunately I do not think this is true since in the issue that you mentioned it appears that convolutions cannot be applied to tensors with variable length. I've experienced this with ConvLSTM2D as well here: https://github.com/tensorflow/tensorflow/issues/48678","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/824334119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"maximgeller","id":57017700,"node_id":"MDQ6VXNlcjU3MDE3NzAw","avatar_url":"https://avatars.githubusercontent.com/u/57017700?v=4","gravatar_id":"","url":"https://api.github.com/users/maximgeller","html_url":"https://github.com/maximgeller","followers_url":"https://api.github.com/users/maximgeller/followers","following_url":"https://api.github.com/users/maximgeller/following{/other_user}","gists_url":"https://api.github.com/users/maximgeller/gists{/gist_id}","starred_url":"https://api.github.com/users/maximgeller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maximgeller/subscriptions","organizations_url":"https://api.github.com/users/maximgeller/orgs","repos_url":"https://api.github.com/users/maximgeller/repos","events_url":"https://api.github.com/users/maximgeller/events{/privacy}","received_events_url":"https://api.github.com/users/maximgeller/received_events","type":"User","site_admin":false}},{"id":4627111610,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDYyNzExMTYxMA==","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/4627111610","actor":{"login":"mimxrt","id":53339396,"node_id":"MDQ6VXNlcjUzMzM5Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/53339396?v=4","gravatar_id":"","url":"https://api.github.com/users/mimxrt","html_url":"https://github.com/mimxrt","followers_url":"https://api.github.com/users/mimxrt/followers","following_url":"https://api.github.com/users/mimxrt/following{/other_user}","gists_url":"https://api.github.com/users/mimxrt/gists{/gist_id}","starred_url":"https://api.github.com/users/mimxrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mimxrt/subscriptions","organizations_url":"https://api.github.com/users/mimxrt/orgs","repos_url":"https://api.github.com/users/mimxrt/repos","events_url":"https://api.github.com/users/mimxrt/events{/privacy}","received_events_url":"https://api.github.com/users/mimxrt/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-21T20:23:54Z","performed_via_github_app":null},{"id":4627111612,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ2MjcxMTE2MTI=","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/4627111612","actor":{"login":"mimxrt","id":53339396,"node_id":"MDQ6VXNlcjUzMzM5Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/53339396?v=4","gravatar_id":"","url":"https://api.github.com/users/mimxrt","html_url":"https://github.com/mimxrt","followers_url":"https://api.github.com/users/mimxrt/followers","following_url":"https://api.github.com/users/mimxrt/following{/other_user}","gists_url":"https://api.github.com/users/mimxrt/gists{/gist_id}","starred_url":"https://api.github.com/users/mimxrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mimxrt/subscriptions","organizations_url":"https://api.github.com/users/mimxrt/orgs","repos_url":"https://api.github.com/users/mimxrt/repos","events_url":"https://api.github.com/users/mimxrt/events{/privacy}","received_events_url":"https://api.github.com/users/mimxrt/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-21T20:23:54Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/824936586","html_url":"https://github.com/philipperemy/keras-tcn/issues/185#issuecomment-824936586","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/185","id":824936586,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNDkzNjU4Ng==","user":{"login":"mimxrt","id":53339396,"node_id":"MDQ6VXNlcjUzMzM5Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/53339396?v=4","gravatar_id":"","url":"https://api.github.com/users/mimxrt","html_url":"https://github.com/mimxrt","followers_url":"https://api.github.com/users/mimxrt/followers","following_url":"https://api.github.com/users/mimxrt/following{/other_user}","gists_url":"https://api.github.com/users/mimxrt/gists{/gist_id}","starred_url":"https://api.github.com/users/mimxrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mimxrt/subscriptions","organizations_url":"https://api.github.com/users/mimxrt/orgs","repos_url":"https://api.github.com/users/mimxrt/repos","events_url":"https://api.github.com/users/mimxrt/events{/privacy}","received_events_url":"https://api.github.com/users/mimxrt/received_events","type":"User","site_admin":false},"created_at":"2021-04-22T15:20:52Z","updated_at":"2021-04-22T15:21:42Z","author_association":"NONE","body":"@maximgeller I think you might have misunderstood my statement: I meant _if_ masking is supported (i.e., everything that supports `tf.keras.layers.Masking`) _then_ it should technically be possible to support ragged tensors. The latter still means that someone has to implement it.","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/824936586/reactions","total_count":2,"+1":1,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mimxrt","id":53339396,"node_id":"MDQ6VXNlcjUzMzM5Mzk2","avatar_url":"https://avatars.githubusercontent.com/u/53339396?v=4","gravatar_id":"","url":"https://api.github.com/users/mimxrt","html_url":"https://github.com/mimxrt","followers_url":"https://api.github.com/users/mimxrt/followers","following_url":"https://api.github.com/users/mimxrt/following{/other_user}","gists_url":"https://api.github.com/users/mimxrt/gists{/gist_id}","starred_url":"https://api.github.com/users/mimxrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mimxrt/subscriptions","organizations_url":"https://api.github.com/users/mimxrt/orgs","repos_url":"https://api.github.com/users/mimxrt/repos","events_url":"https://api.github.com/users/mimxrt/events{/privacy}","received_events_url":"https://api.github.com/users/mimxrt/received_events","type":"User","site_admin":false}},{"id":4631573516,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDYzMTU3MzUxNg==","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/4631573516","actor":{"login":"maximgeller","id":57017700,"node_id":"MDQ6VXNlcjU3MDE3NzAw","avatar_url":"https://avatars.githubusercontent.com/u/57017700?v=4","gravatar_id":"","url":"https://api.github.com/users/maximgeller","html_url":"https://github.com/maximgeller","followers_url":"https://api.github.com/users/maximgeller/followers","following_url":"https://api.github.com/users/maximgeller/following{/other_user}","gists_url":"https://api.github.com/users/maximgeller/gists{/gist_id}","starred_url":"https://api.github.com/users/maximgeller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maximgeller/subscriptions","organizations_url":"https://api.github.com/users/maximgeller/orgs","repos_url":"https://api.github.com/users/maximgeller/repos","events_url":"https://api.github.com/users/maximgeller/events{/privacy}","received_events_url":"https://api.github.com/users/maximgeller/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-22T15:20:52Z","performed_via_github_app":null},{"id":4631573523,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ2MzE1NzM1MjM=","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/4631573523","actor":{"login":"maximgeller","id":57017700,"node_id":"MDQ6VXNlcjU3MDE3NzAw","avatar_url":"https://avatars.githubusercontent.com/u/57017700?v=4","gravatar_id":"","url":"https://api.github.com/users/maximgeller","html_url":"https://github.com/maximgeller","followers_url":"https://api.github.com/users/maximgeller/followers","following_url":"https://api.github.com/users/maximgeller/following{/other_user}","gists_url":"https://api.github.com/users/maximgeller/gists{/gist_id}","starred_url":"https://api.github.com/users/maximgeller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maximgeller/subscriptions","organizations_url":"https://api.github.com/users/maximgeller/orgs","repos_url":"https://api.github.com/users/maximgeller/repos","events_url":"https://api.github.com/users/maximgeller/events{/privacy}","received_events_url":"https://api.github.com/users/maximgeller/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-22T15:20:52Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1123247476","html_url":"https://github.com/philipperemy/keras-tcn/issues/185#issuecomment-1123247476","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/185","id":1123247476,"node_id":"IC_kwDOB4a3hs5C82V0","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2022-05-11T06:44:30Z","updated_at":"2022-09-25T15:13:56Z","author_association":"OWNER","body":"The correct way to do that is here: https://www.tensorflow.org/guide/keras/masking_and_padding\r\n\r\nDoc: https://stackoverflow.com/questions/55176818/how-to-support-masking-in-custom-tf-keras-layers-layer","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1123247476/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2022-07-20T11:31:37Z","updated_at":"2022-07-20T11:31:37Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/234","repository_url":"https://api.github.com/repos/philipperemy/keras-tcn","labels_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/234/labels{/name}","comments_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/234/comments","events_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/234/events","html_url":"https://github.com/philipperemy/keras-tcn/issues/234","id":1300814890,"node_id":"I_kwDOB4a3hs5NiNwq","number":234,"title":"How do I use a masking layer for TCN? I want to mask certain time steps which are missing.","user":{"login":"arvind267","id":41867518,"node_id":"MDQ6VXNlcjQxODY3NTE4","avatar_url":"https://avatars.githubusercontent.com/u/41867518?v=4","gravatar_id":"","url":"https://api.github.com/users/arvind267","html_url":"https://github.com/arvind267","followers_url":"https://api.github.com/users/arvind267/followers","following_url":"https://api.github.com/users/arvind267/following{/other_user}","gists_url":"https://api.github.com/users/arvind267/gists{/gist_id}","starred_url":"https://api.github.com/users/arvind267/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arvind267/subscriptions","organizations_url":"https://api.github.com/users/arvind267/orgs","repos_url":"https://api.github.com/users/arvind267/repos","events_url":"https://api.github.com/users/arvind267/events{/privacy}","received_events_url":"https://api.github.com/users/arvind267/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-07-11T14:43:27Z","updated_at":"2022-10-03T06:26:05Z","closed_at":"2022-09-25T15:37:34Z","author_association":"NONE","active_lock_reason":null,"repository":{"id":126269318,"node_id":"MDEwOlJlcG9zaXRvcnkxMjYyNjkzMTg=","name":"keras-tcn","full_name":"philipperemy/keras-tcn","private":false,"owner":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"html_url":"https://github.com/philipperemy/keras-tcn","description":"Keras Temporal Convolutional Network.","fork":false,"url":"https://api.github.com/repos/philipperemy/keras-tcn","forks_url":"https://api.github.com/repos/philipperemy/keras-tcn/forks","keys_url":"https://api.github.com/repos/philipperemy/keras-tcn/keys{/key_id}","collaborators_url":"https://api.github.com/repos/philipperemy/keras-tcn/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/philipperemy/keras-tcn/teams","hooks_url":"https://api.github.com/repos/philipperemy/keras-tcn/hooks","issue_events_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events{/number}","events_url":"https://api.github.com/repos/philipperemy/keras-tcn/events","assignees_url":"https://api.github.com/repos/philipperemy/keras-tcn/assignees{/user}","branches_url":"https://api.github.com/repos/philipperemy/keras-tcn/branches{/branch}","tags_url":"https://api.github.com/repos/philipperemy/keras-tcn/tags","blobs_url":"https://api.github.com/repos/philipperemy/keras-tcn/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/philipperemy/keras-tcn/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/philipperemy/keras-tcn/git/refs{/sha}","trees_url":"https://api.github.com/repos/philipperemy/keras-tcn/git/trees{/sha}","statuses_url":"https://api.github.com/repos/philipperemy/keras-tcn/statuses/{sha}","languages_url":"https://api.github.com/repos/philipperemy/keras-tcn/languages","stargazers_url":"https://api.github.com/repos/philipperemy/keras-tcn/stargazers","contributors_url":"https://api.github.com/repos/philipperemy/keras-tcn/contributors","subscribers_url":"https://api.github.com/repos/philipperemy/keras-tcn/subscribers","subscription_url":"https://api.github.com/repos/philipperemy/keras-tcn/subscription","commits_url":"https://api.github.com/repos/philipperemy/keras-tcn/commits{/sha}","git_commits_url":"https://api.github.com/repos/philipperemy/keras-tcn/git/commits{/sha}","comments_url":"https://api.github.com/repos/philipperemy/keras-tcn/comments{/number}","issue_comment_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments{/number}","contents_url":"https://api.github.com/repos/philipperemy/keras-tcn/contents/{+path}","compare_url":"https://api.github.com/repos/philipperemy/keras-tcn/compare/{base}...{head}","merges_url":"https://api.github.com/repos/philipperemy/keras-tcn/merges","archive_url":"https://api.github.com/repos/philipperemy/keras-tcn/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/philipperemy/keras-tcn/downloads","issues_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues{/number}","pulls_url":"https://api.github.com/repos/philipperemy/keras-tcn/pulls{/number}","milestones_url":"https://api.github.com/repos/philipperemy/keras-tcn/milestones{/number}","notifications_url":"https://api.github.com/repos/philipperemy/keras-tcn/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/philipperemy/keras-tcn/labels{/name}","releases_url":"https://api.github.com/repos/philipperemy/keras-tcn/releases{/id}","deployments_url":"https://api.github.com/repos/philipperemy/keras-tcn/deployments","created_at":"2018-03-22T02:40:06Z","updated_at":"2023-01-18T09:24:51Z","pushed_at":"2022-09-26T01:56:47Z","git_url":"git://github.com/philipperemy/keras-tcn.git","ssh_url":"git@github.com:philipperemy/keras-tcn.git","clone_url":"https://github.com/philipperemy/keras-tcn.git","svn_url":"https://github.com/philipperemy/keras-tcn","homepage":"","size":6015,"stargazers_count":1593,"watchers_count":1593,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":429,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":4,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["deep-learning","keras","machine-learning","recurrent-neural-networks","tcn"],"visibility":"public","forks":429,"open_issues":4,"watchers":1593,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":null,"reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/234/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"}]