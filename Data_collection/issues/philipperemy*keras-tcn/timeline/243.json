[{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1373117097","html_url":"https://github.com/philipperemy/keras-tcn/issues/243#issuecomment-1373117097","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/243","id":1373117097,"node_id":"IC_kwDOB4a3hs5R2Bqp","user":{"login":"krzim","id":44442910,"node_id":"MDQ6VXNlcjQ0NDQyOTEw","avatar_url":"https://avatars.githubusercontent.com/u/44442910?v=4","gravatar_id":"","url":"https://api.github.com/users/krzim","html_url":"https://github.com/krzim","followers_url":"https://api.github.com/users/krzim/followers","following_url":"https://api.github.com/users/krzim/following{/other_user}","gists_url":"https://api.github.com/users/krzim/gists{/gist_id}","starred_url":"https://api.github.com/users/krzim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krzim/subscriptions","organizations_url":"https://api.github.com/users/krzim/orgs","repos_url":"https://api.github.com/users/krzim/repos","events_url":"https://api.github.com/users/krzim/events{/privacy}","received_events_url":"https://api.github.com/users/krzim/received_events","type":"User","site_admin":false},"created_at":"2023-01-06T04:06:45Z","updated_at":"2023-01-06T04:06:45Z","author_association":"CONTRIBUTOR","body":"The residual blocks are programmatically named in the TCN and I'm assuming those are the layers you're concerned with. They're all named under `tf.name_scopes` which is used to add a prefix to all ops under the scope. The unique name of each TCN means that even those programmatically generated names for the residual blocks fall under different scope trees (is that the right term?).\r\n\r\nYou would need to explicitly tell Tensorflow to reuse variables/share weights with something like a  `tf.variable_scope(\"some_name\", reuse=True)` context. There's a pretty great StackOverflow answer covering this topic [here](https://stackoverflow.com/a/49660916).\r\n\r\ntl;dr: Not a stupid question and the weights should be unique.","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1373117097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"krzim","id":44442910,"node_id":"MDQ6VXNlcjQ0NDQyOTEw","avatar_url":"https://avatars.githubusercontent.com/u/44442910?v=4","gravatar_id":"","url":"https://api.github.com/users/krzim","html_url":"https://github.com/krzim","followers_url":"https://api.github.com/users/krzim/followers","following_url":"https://api.github.com/users/krzim/following{/other_user}","gists_url":"https://api.github.com/users/krzim/gists{/gist_id}","starred_url":"https://api.github.com/users/krzim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krzim/subscriptions","organizations_url":"https://api.github.com/users/krzim/orgs","repos_url":"https://api.github.com/users/krzim/repos","events_url":"https://api.github.com/users/krzim/events{/privacy}","received_events_url":"https://api.github.com/users/krzim/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1373632640","html_url":"https://github.com/philipperemy/keras-tcn/issues/243#issuecomment-1373632640","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/243","id":1373632640,"node_id":"IC_kwDOB4a3hs5R3_iA","user":{"login":"vlawhern","id":1211077,"node_id":"MDQ6VXNlcjEyMTEwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1211077?v=4","gravatar_id":"","url":"https://api.github.com/users/vlawhern","html_url":"https://github.com/vlawhern","followers_url":"https://api.github.com/users/vlawhern/followers","following_url":"https://api.github.com/users/vlawhern/following{/other_user}","gists_url":"https://api.github.com/users/vlawhern/gists{/gist_id}","starred_url":"https://api.github.com/users/vlawhern/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vlawhern/subscriptions","organizations_url":"https://api.github.com/users/vlawhern/orgs","repos_url":"https://api.github.com/users/vlawhern/repos","events_url":"https://api.github.com/users/vlawhern/events{/privacy}","received_events_url":"https://api.github.com/users/vlawhern/received_events","type":"User","site_admin":false},"created_at":"2023-01-06T13:35:55Z","updated_at":"2023-01-06T13:35:55Z","author_association":"NONE","body":"That explanation makes sense.. I did see that the weights were being assigned under a name_scope (see https://github.com/philipperemy/keras-tcn/blob/master/tcn/tcn.py#L87) but was thrown off a bit since in the model summary some of the layer names matched. \r\n\r\nAfter I posted my issue I did some further checking of the weights directly to confirm that they are all different and in fact they are. So yes all the weights/layers are unique.\r\n\r\nThanks for the help... will close the thread. ","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1373632640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vlawhern","id":1211077,"node_id":"MDQ6VXNlcjEyMTEwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1211077?v=4","gravatar_id":"","url":"https://api.github.com/users/vlawhern","html_url":"https://github.com/vlawhern","followers_url":"https://api.github.com/users/vlawhern/followers","following_url":"https://api.github.com/users/vlawhern/following{/other_user}","gists_url":"https://api.github.com/users/vlawhern/gists{/gist_id}","starred_url":"https://api.github.com/users/vlawhern/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vlawhern/subscriptions","organizations_url":"https://api.github.com/users/vlawhern/orgs","repos_url":"https://api.github.com/users/vlawhern/repos","events_url":"https://api.github.com/users/vlawhern/events{/privacy}","received_events_url":"https://api.github.com/users/vlawhern/received_events","type":"User","site_admin":false}},{"id":8169383078,"node_id":"CE_lADOB4a3hs5ajY4YzwAAAAHm7uSm","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/8169383078","actor":{"login":"vlawhern","id":1211077,"node_id":"MDQ6VXNlcjEyMTEwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1211077?v=4","gravatar_id":"","url":"https://api.github.com/users/vlawhern","html_url":"https://github.com/vlawhern","followers_url":"https://api.github.com/users/vlawhern/followers","following_url":"https://api.github.com/users/vlawhern/following{/other_user}","gists_url":"https://api.github.com/users/vlawhern/gists{/gist_id}","starred_url":"https://api.github.com/users/vlawhern/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vlawhern/subscriptions","organizations_url":"https://api.github.com/users/vlawhern/orgs","repos_url":"https://api.github.com/users/vlawhern/repos","events_url":"https://api.github.com/users/vlawhern/events{/privacy}","received_events_url":"https://api.github.com/users/vlawhern/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2023-01-06T13:35:55Z","state_reason":null,"performed_via_github_app":null}]