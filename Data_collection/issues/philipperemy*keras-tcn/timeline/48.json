[{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/481073683","html_url":"https://github.com/philipperemy/keras-tcn/issues/48#issuecomment-481073683","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/48","id":481073683,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTA3MzY4Mw==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2019-04-09T02:09:53Z","updated_at":"2019-04-09T02:09:53Z","author_association":"OWNER","body":"@diegovargasf ok I found what it came from: I defined the classification loss as: sparse_categorical_crossentropy and not categorical_crossentropy.\r\n\r\nExample:\r\nMNIST\r\ntargets = [1, 0,0, ...] => use categorical_crossentropy\r\ntargets = 0 => use sparse_categorical_crossentropy","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/481073683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"id":2261457930,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI2MTQ1NzkzMA==","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/2261457930","actor":{"login":"diegovargasf","id":14860453,"node_id":"MDQ6VXNlcjE0ODYwNDUz","avatar_url":"https://avatars.githubusercontent.com/u/14860453?v=4","gravatar_id":"","url":"https://api.github.com/users/diegovargasf","html_url":"https://github.com/diegovargasf","followers_url":"https://api.github.com/users/diegovargasf/followers","following_url":"https://api.github.com/users/diegovargasf/following{/other_user}","gists_url":"https://api.github.com/users/diegovargasf/gists{/gist_id}","starred_url":"https://api.github.com/users/diegovargasf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diegovargasf/subscriptions","organizations_url":"https://api.github.com/users/diegovargasf/orgs","repos_url":"https://api.github.com/users/diegovargasf/repos","events_url":"https://api.github.com/users/diegovargasf/events{/privacy}","received_events_url":"https://api.github.com/users/diegovargasf/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-09T02:09:53Z","performed_via_github_app":null},{"id":2261457931,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyNjE0NTc5MzE=","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/2261457931","actor":{"login":"diegovargasf","id":14860453,"node_id":"MDQ6VXNlcjE0ODYwNDUz","avatar_url":"https://avatars.githubusercontent.com/u/14860453?v=4","gravatar_id":"","url":"https://api.github.com/users/diegovargasf","html_url":"https://github.com/diegovargasf","followers_url":"https://api.github.com/users/diegovargasf/followers","following_url":"https://api.github.com/users/diegovargasf/following{/other_user}","gists_url":"https://api.github.com/users/diegovargasf/gists{/gist_id}","starred_url":"https://api.github.com/users/diegovargasf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diegovargasf/subscriptions","organizations_url":"https://api.github.com/users/diegovargasf/orgs","repos_url":"https://api.github.com/users/diegovargasf/repos","events_url":"https://api.github.com/users/diegovargasf/events{/privacy}","received_events_url":"https://api.github.com/users/diegovargasf/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-09T02:09:53Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/481073950","html_url":"https://github.com/philipperemy/keras-tcn/issues/48#issuecomment-481073950","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/48","id":481073950,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTA3Mzk1MA==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2019-04-09T02:11:23Z","updated_at":"2019-04-09T02:11:29Z","author_association":"OWNER","body":"https://www.dlology.com/blog/how-to-use-keras-sparse_categorical_crossentropy/\r\n\r\nThat's why it expects output shape of (1,). Instead of having [0, 0, 1, 0], you should input 3.\r\njust do `np.argmax(y, axis=1)` and it will work!","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/481073950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/481073986","html_url":"https://github.com/philipperemy/keras-tcn/issues/48#issuecomment-481073986","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/48","id":481073986,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTA3Mzk4Ng==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2019-04-09T02:11:36Z","updated_at":"2019-04-09T02:11:36Z","author_association":"OWNER","body":"```\r\nimport numpy as np\r\n\r\nfrom tcn import compiled_tcn\r\n\r\ntrain_X = np.random.uniform(size=(10540, 80, 26))\r\ntrain_y = np.random.uniform(size=(10540, 4))\r\ntest_X = np.random.uniform(size=(555, 80, 26))\r\ntest_y = np.random.uniform(size=(555, 4))\r\n\r\ntrain_y = np.argmax(train_y, axis=1)\r\ntest_y = np.argmax(test_y, axis=1)\r\n\r\nclassifier = compiled_tcn(num_feat=train_X.shape[2],\r\n                          num_classes=4,\r\n                          nb_filters=train_X.shape[1],\r\n                          kernel_size=3 * train_X.shape[2],\r\n                          dilations=[2 ** i for i in range(9)],\r\n                          nb_stacks=1,\r\n                          max_len=train_X.shape[1],\r\n                          use_skip_connections=True,\r\n                          opt='rmsprop',\r\n                          lr=5e-4,\r\n                          regression=False,\r\n                          return_sequences=False)\r\n\r\nepochs = 1\r\nbatch_size = 2\r\nclassifier.fit(train_X, train_y, validation_data=(test_X, test_y), epochs=epochs, batch_size=batch_size)\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/481073986/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/481074002","html_url":"https://github.com/philipperemy/keras-tcn/issues/48#issuecomment-481074002","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/48","id":481074002,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTA3NDAwMg==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2019-04-09T02:11:44Z","updated_at":"2019-04-09T02:11:44Z","author_association":"OWNER","body":"```\r\nTrain on 10540 samples, validate on 555 samples\r\nEpoch 1/1\r\n2019-04-09 11:11:20.324130: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n\r\n    2/10540 [..............................] - ETA: 6:37:21 - loss: 1.1396 - accuracy: 0.5000\r\n    4/10540 [..............................] - ETA: 3:42:35 - loss: 8.6288 - accuracy: 0.2500\r\n    6/10540 [..............................] - ETA: 2:58:11 - loss: 11.1253 - accuracy: 0.1667\r\n    8/10540 [..............................] - ETA: 2:32:44 - loss: 12.3735 - accuracy: 0.1250\r\n   10/10540 [..............................] - ETA: 2:15:49 - loss: 11.5106 - accuracy: 0.2000\r\n   12/10540 [..............................] - ETA: 2:04:48 - loss: 12.2785 - accuracy: 0.1667\r\n```","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/481074002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/481075457","html_url":"https://github.com/philipperemy/keras-tcn/issues/48#issuecomment-481075457","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/48","id":481075457,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTA3NTQ1Nw==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2019-04-09T02:19:16Z","updated_at":"2019-04-09T02:19:16Z","author_association":"OWNER","body":"https://github.com/philipperemy/keras-tcn/commit/822a731aa79daf0f2dc2be474d04b5b1b43e2a06","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/481075457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"id":2261469099,"node_id":"MDExOkNsb3NlZEV2ZW50MjI2MTQ2OTA5OQ==","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/2261469099","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-04-09T02:19:16Z","state_reason":null,"performed_via_github_app":null}]