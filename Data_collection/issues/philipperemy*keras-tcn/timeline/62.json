[{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/510858164","html_url":"https://github.com/philipperemy/keras-tcn/issues/62#issuecomment-510858164","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/62","id":510858164,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMDg1ODE2NA==","user":{"login":"Luux","id":15156652,"node_id":"MDQ6VXNlcjE1MTU2NjUy","avatar_url":"https://avatars.githubusercontent.com/u/15156652?v=4","gravatar_id":"","url":"https://api.github.com/users/Luux","html_url":"https://github.com/Luux","followers_url":"https://api.github.com/users/Luux/followers","following_url":"https://api.github.com/users/Luux/following{/other_user}","gists_url":"https://api.github.com/users/Luux/gists{/gist_id}","starred_url":"https://api.github.com/users/Luux/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Luux/subscriptions","organizations_url":"https://api.github.com/users/Luux/orgs","repos_url":"https://api.github.com/users/Luux/repos","events_url":"https://api.github.com/users/Luux/events{/privacy}","received_events_url":"https://api.github.com/users/Luux/received_events","type":"User","site_admin":false},"created_at":"2019-07-12T11:52:03Z","updated_at":"2019-07-12T18:01:35Z","author_association":"NONE","body":"If someone ever wants to look into #33, this question here (#62) could be a starting point for doing something like #33, too, if I understand that correctly. So I'll leave this link here.","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/510858164/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Luux","id":15156652,"node_id":"MDQ6VXNlcjE1MTU2NjUy","avatar_url":"https://avatars.githubusercontent.com/u/15156652?v=4","gravatar_id":"","url":"https://api.github.com/users/Luux","html_url":"https://github.com/Luux","followers_url":"https://api.github.com/users/Luux/followers","following_url":"https://api.github.com/users/Luux/following{/other_user}","gists_url":"https://api.github.com/users/Luux/gists{/gist_id}","starred_url":"https://api.github.com/users/Luux/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Luux/subscriptions","organizations_url":"https://api.github.com/users/Luux/orgs","repos_url":"https://api.github.com/users/Luux/repos","events_url":"https://api.github.com/users/Luux/events{/privacy}","received_events_url":"https://api.github.com/users/Luux/received_events","type":"User","site_admin":false}},{"id":2815177043,"node_id":"MDEyOkxhYmVsZWRFdmVudDI4MTUxNzcwNDM=","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/2815177043","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-11-20T13:05:13Z","label":{"name":"question","color":"d876e3"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/570434814","html_url":"https://github.com/philipperemy/keras-tcn/issues/62#issuecomment-570434814","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/62","id":570434814,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDQzNDgxNA==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2020-01-03T02:05:33Z","updated_at":"2020-01-03T02:05:33Z","author_association":"OWNER","body":"@beasteers hey, sorry for the (very) late reply! You can use [keract](https://github.com/philipperemy/keract) to get the activations of each layer in a Keras model. The only problem here is that we merge all the TCN into one single layer so at the moment it's not possible to get the activations of each sub-layer inside. I'll try to find a way around it.","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/570434814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"id":2919259045,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjkxOTI1OTA0NQ==","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/2919259045","actor":{"login":"beasteers","id":6741720,"node_id":"MDQ6VXNlcjY3NDE3MjA=","avatar_url":"https://avatars.githubusercontent.com/u/6741720?v=4","gravatar_id":"","url":"https://api.github.com/users/beasteers","html_url":"https://github.com/beasteers","followers_url":"https://api.github.com/users/beasteers/followers","following_url":"https://api.github.com/users/beasteers/following{/other_user}","gists_url":"https://api.github.com/users/beasteers/gists{/gist_id}","starred_url":"https://api.github.com/users/beasteers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beasteers/subscriptions","organizations_url":"https://api.github.com/users/beasteers/orgs","repos_url":"https://api.github.com/users/beasteers/repos","events_url":"https://api.github.com/users/beasteers/events{/privacy}","received_events_url":"https://api.github.com/users/beasteers/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-01-03T02:05:33Z","performed_via_github_app":null},{"id":2919259046,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI5MTkyNTkwNDY=","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/2919259046","actor":{"login":"beasteers","id":6741720,"node_id":"MDQ6VXNlcjY3NDE3MjA=","avatar_url":"https://avatars.githubusercontent.com/u/6741720?v=4","gravatar_id":"","url":"https://api.github.com/users/beasteers","html_url":"https://github.com/beasteers","followers_url":"https://api.github.com/users/beasteers/followers","following_url":"https://api.github.com/users/beasteers/following{/other_user}","gists_url":"https://api.github.com/users/beasteers/gists{/gist_id}","starred_url":"https://api.github.com/users/beasteers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beasteers/subscriptions","organizations_url":"https://api.github.com/users/beasteers/orgs","repos_url":"https://api.github.com/users/beasteers/repos","events_url":"https://api.github.com/users/beasteers/events{/privacy}","received_events_url":"https://api.github.com/users/beasteers/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-01-03T02:05:33Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/570436317","html_url":"https://github.com/philipperemy/keras-tcn/issues/62#issuecomment-570436317","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/62","id":570436317,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDQzNjMxNw==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2020-01-03T02:15:06Z","updated_at":"2020-01-03T02:15:06Z","author_association":"OWNER","body":"But at the moment, you can get exactly what you want with the previous version of keras-tcn: 2.8.3.\r\n\r\nSo consider doing something like:\r\n\r\n```\r\npip install keras-tcn==2.8.3 tensorflow keract\r\n```\r\n\r\n```python\r\n\"\"\"\r\n#Trains a TCN on the IMDB sentiment classification task.\r\nOutput after 1 epochs on CPU: ~0.8611\r\nTime per epoch on CPU (Core i7): ~64s.\r\nBased on: https://github.com/keras-team/keras/blob/master/examples/imdb_bidirectional_lstm.py\r\n\"\"\"\r\nimport numpy as np\r\nfrom keras import Model, Input\r\nfrom keras.datasets import imdb\r\nfrom keras.layers import Dense, Dropout, Embedding\r\nfrom keras.preprocessing import sequence\r\nimport keract\r\n\r\nfrom tcn import TCN\r\n\r\nmax_features = 20000\r\n# cut texts after this number of words\r\n# (among top max_features most common words)\r\nmaxlen = 100\r\nbatch_size = 32\r\n\r\nprint('Loading data...')\r\n(x_train, y_train), (x_test, y_test) = imdb.load_data(num_words=max_features)\r\nprint(len(x_train), 'train sequences')\r\nprint(len(x_test), 'test sequences')\r\n\r\nprint('Pad sequences (samples x time)')\r\nx_train = sequence.pad_sequences(x_train, maxlen=maxlen)\r\nx_test = sequence.pad_sequences(x_test, maxlen=maxlen)\r\nprint('x_train shape:', x_train.shape)\r\nprint('x_test shape:', x_test.shape)\r\ny_train = np.array(y_train)\r\ny_test = np.array(y_test)\r\n\r\ni = Input(shape=(maxlen,))\r\nx = Embedding(max_features, 128)(i)\r\nx = TCN(nb_filters=64,\r\n        kernel_size=6,\r\n        dilations=[1, 2, 4, 8, 16, 32, 64])(x)\r\nx = Dropout(0.5)(x)\r\nx = Dense(1, activation='sigmoid')(x)\r\n\r\nmodel = Model(inputs=[i], outputs=[x])\r\n\r\nmodel.summary()\r\n\r\n# try using different optimizers and different optimizer configs\r\nmodel.compile('adam', 'binary_crossentropy', metrics=['accuracy'])\r\n\r\nactivations = keract.get_activations(model, x_train[0:1])\r\n\r\nprint('Train...')\r\nmodel.fit(x_train, y_train,\r\n          batch_size=batch_size,\r\n          epochs=1,\r\n          validation_data=[x_test, y_test])\r\n```\r\n\r\nI added `activations = keract.get_activations(model, x_train[0:1])`\r\n\r\nThen you should get something like this:\r\n\r\n![image](https://user-images.githubusercontent.com/4516927/71703839-403d2d80-2e1a-11ea-960a-93be9a9af3e5.png)\r\n\r\nLet me know if it helps :)\r\n","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/570436317/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"id":3409366223,"node_id":"MDExOkNsb3NlZEV2ZW50MzQwOTM2NjIyMw==","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/3409366223","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-06-05T01:56:09Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/639211988","html_url":"https://github.com/philipperemy/keras-tcn/issues/62#issuecomment-639211988","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/62","id":639211988,"node_id":"MDEyOklzc3VlQ29tbWVudDYzOTIxMTk4OA==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2020-06-05T01:56:32Z","updated_at":"2020-06-05T01:56:32Z","author_association":"OWNER","body":"Issue resolved. I think thereâ€™s an example with keract in the examples folder","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/639211988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}}]