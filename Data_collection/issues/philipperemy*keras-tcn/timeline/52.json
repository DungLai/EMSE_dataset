[{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/491194431","html_url":"https://github.com/philipperemy/keras-tcn/issues/52#issuecomment-491194431","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/52","id":491194431,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTE5NDQzMQ==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2019-05-10T07:50:43Z","updated_at":"2019-05-10T07:50:43Z","author_association":"OWNER","body":"@jmrichardson Hum it means that the network does not learn anything if the classes are well-balanced (50% chance of having 0, and 50% of having 1). Why don't you try another simple model? Are your features spatially correlated like an image? Because TCN is based on convolutions.","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/491194431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"id":2332339567,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjMzMjMzOTU2Nw==","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/2332339567","actor":{"login":"jmrichardson","id":6565528,"node_id":"MDQ6VXNlcjY1NjU1Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/6565528?v=4","gravatar_id":"","url":"https://api.github.com/users/jmrichardson","html_url":"https://github.com/jmrichardson","followers_url":"https://api.github.com/users/jmrichardson/followers","following_url":"https://api.github.com/users/jmrichardson/following{/other_user}","gists_url":"https://api.github.com/users/jmrichardson/gists{/gist_id}","starred_url":"https://api.github.com/users/jmrichardson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmrichardson/subscriptions","organizations_url":"https://api.github.com/users/jmrichardson/orgs","repos_url":"https://api.github.com/users/jmrichardson/repos","events_url":"https://api.github.com/users/jmrichardson/events{/privacy}","received_events_url":"https://api.github.com/users/jmrichardson/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-10T07:50:43Z","performed_via_github_app":null},{"id":2332339568,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzMzIzMzk1Njg=","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/2332339568","actor":{"login":"jmrichardson","id":6565528,"node_id":"MDQ6VXNlcjY1NjU1Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/6565528?v=4","gravatar_id":"","url":"https://api.github.com/users/jmrichardson","html_url":"https://github.com/jmrichardson","followers_url":"https://api.github.com/users/jmrichardson/followers","following_url":"https://api.github.com/users/jmrichardson/following{/other_user}","gists_url":"https://api.github.com/users/jmrichardson/gists{/gist_id}","starred_url":"https://api.github.com/users/jmrichardson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmrichardson/subscriptions","organizations_url":"https://api.github.com/users/jmrichardson/orgs","repos_url":"https://api.github.com/users/jmrichardson/repos","events_url":"https://api.github.com/users/jmrichardson/events{/privacy}","received_events_url":"https://api.github.com/users/jmrichardson/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-10T07:50:43Z","performed_via_github_app":null},{"id":2332339772,"node_id":"MDEyOkxhYmVsZWRFdmVudDIzMzIzMzk3NzI=","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/2332339772","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-05-10T07:50:49Z","label":{"name":"question","color":"d876e3"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/491319062","html_url":"https://github.com/philipperemy/keras-tcn/issues/52#issuecomment-491319062","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/52","id":491319062,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTMxOTA2Mg==","user":{"login":"jmrichardson","id":6565528,"node_id":"MDQ6VXNlcjY1NjU1Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/6565528?v=4","gravatar_id":"","url":"https://api.github.com/users/jmrichardson","html_url":"https://github.com/jmrichardson","followers_url":"https://api.github.com/users/jmrichardson/followers","following_url":"https://api.github.com/users/jmrichardson/following{/other_user}","gists_url":"https://api.github.com/users/jmrichardson/gists{/gist_id}","starred_url":"https://api.github.com/users/jmrichardson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmrichardson/subscriptions","organizations_url":"https://api.github.com/users/jmrichardson/orgs","repos_url":"https://api.github.com/users/jmrichardson/repos","events_url":"https://api.github.com/users/jmrichardson/events{/privacy}","received_events_url":"https://api.github.com/users/jmrichardson/received_events","type":"User","site_admin":false},"created_at":"2019-05-10T14:57:06Z","updated_at":"2019-05-10T14:57:06Z","author_association":"NONE","body":"Sorry, I assumed that we could use keras-tcn for multivariate tabular data since I saw an example in your repo for a univariate data set.  I am learning more about CNNs and see that the filters convolve around image data to detect things like edges for images.  Since my data set features are temporal (not IID) but not images I don't think I can use keras-tcn correct?","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/491319062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmrichardson","id":6565528,"node_id":"MDQ6VXNlcjY1NjU1Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/6565528?v=4","gravatar_id":"","url":"https://api.github.com/users/jmrichardson","html_url":"https://github.com/jmrichardson","followers_url":"https://api.github.com/users/jmrichardson/followers","following_url":"https://api.github.com/users/jmrichardson/following{/other_user}","gists_url":"https://api.github.com/users/jmrichardson/gists{/gist_id}","starred_url":"https://api.github.com/users/jmrichardson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmrichardson/subscriptions","organizations_url":"https://api.github.com/users/jmrichardson/orgs","repos_url":"https://api.github.com/users/jmrichardson/repos","events_url":"https://api.github.com/users/jmrichardson/events{/privacy}","received_events_url":"https://api.github.com/users/jmrichardson/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/491564507","html_url":"https://github.com/philipperemy/keras-tcn/issues/52#issuecomment-491564507","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/52","id":491564507,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTU2NDUwNw==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2019-05-12T04:52:26Z","updated_at":"2019-05-12T04:52:53Z","author_association":"OWNER","body":"@jmrichardson no you can here. If your data has shape (batch-size, timestep, input-dim), you can use a TCN. For example if you have 64 time series with 1000 time steps, you can use TCN. Your input will be (batch-size, 1000, 64). TCN uses 1-D convolutions.","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/491564507/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"id":2335070295,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjMzNTA3MDI5NQ==","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/2335070295","actor":{"login":"jmrichardson","id":6565528,"node_id":"MDQ6VXNlcjY1NjU1Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/6565528?v=4","gravatar_id":"","url":"https://api.github.com/users/jmrichardson","html_url":"https://github.com/jmrichardson","followers_url":"https://api.github.com/users/jmrichardson/followers","following_url":"https://api.github.com/users/jmrichardson/following{/other_user}","gists_url":"https://api.github.com/users/jmrichardson/gists{/gist_id}","starred_url":"https://api.github.com/users/jmrichardson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmrichardson/subscriptions","organizations_url":"https://api.github.com/users/jmrichardson/orgs","repos_url":"https://api.github.com/users/jmrichardson/repos","events_url":"https://api.github.com/users/jmrichardson/events{/privacy}","received_events_url":"https://api.github.com/users/jmrichardson/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-12T04:52:26Z","performed_via_github_app":null},{"id":2335070296,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzMzUwNzAyOTY=","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/2335070296","actor":{"login":"jmrichardson","id":6565528,"node_id":"MDQ6VXNlcjY1NjU1Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/6565528?v=4","gravatar_id":"","url":"https://api.github.com/users/jmrichardson","html_url":"https://github.com/jmrichardson","followers_url":"https://api.github.com/users/jmrichardson/followers","following_url":"https://api.github.com/users/jmrichardson/following{/other_user}","gists_url":"https://api.github.com/users/jmrichardson/gists{/gist_id}","starred_url":"https://api.github.com/users/jmrichardson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmrichardson/subscriptions","organizations_url":"https://api.github.com/users/jmrichardson/orgs","repos_url":"https://api.github.com/users/jmrichardson/repos","events_url":"https://api.github.com/users/jmrichardson/events{/privacy}","received_events_url":"https://api.github.com/users/jmrichardson/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-12T04:52:26Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/491600772","html_url":"https://github.com/philipperemy/keras-tcn/issues/52#issuecomment-491600772","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/52","id":491600772,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTYwMDc3Mg==","user":{"login":"jmrichardson","id":6565528,"node_id":"MDQ6VXNlcjY1NjU1Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/6565528?v=4","gravatar_id":"","url":"https://api.github.com/users/jmrichardson","html_url":"https://github.com/jmrichardson","followers_url":"https://api.github.com/users/jmrichardson/followers","following_url":"https://api.github.com/users/jmrichardson/following{/other_user}","gists_url":"https://api.github.com/users/jmrichardson/gists{/gist_id}","starred_url":"https://api.github.com/users/jmrichardson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmrichardson/subscriptions","organizations_url":"https://api.github.com/users/jmrichardson/orgs","repos_url":"https://api.github.com/users/jmrichardson/repos","events_url":"https://api.github.com/users/jmrichardson/events{/privacy}","received_events_url":"https://api.github.com/users/jmrichardson/received_events","type":"User","site_admin":false},"created_at":"2019-05-12T14:30:49Z","updated_at":"2019-05-12T14:30:49Z","author_association":"NONE","body":"I think I have the right data shape...  I have 83 time series with 31K rows.   I used the following code to create a rolling window of 20 sequences/timesteps similar to your milk task example:\r\n\r\n```\r\nlookback_window = 20\r\n\r\n# Get training data\r\nX_train = np.array(X_train_split)\r\ny_train = np.array(y_train_split)\r\nx, y = [], []\r\nfor i in range(lookback_window, len(X_train)):\r\n    x.append(X_train[i - lookback_window:i])\r\n    y.append(y_train[i])\r\nX_train = np.array(x)\r\ny_train = np.array(y)\r\n\r\n# Get validation data\r\nX_val = np.array(X_val_split)\r\ny_val = np.array(y_val_split)\r\nx, y = [], []\r\nfor i in range(lookback_window, len(X_val)):\r\n    x.append(X_val[i - lookback_window:i])\r\n    y.append(y_val[i])\r\nX_val = np.array(x)\r\ny_val = np.array(y)\r\n```\r\n\r\nHere is the shape X_train shape:\r\n\r\n```\r\nprint(X_train.shape)\r\nprint(y_train.shape)\r\n(31066, 20, 83)\r\n(31066,)\r\n```\r\n\r\nHere is the model code:\r\n\r\n```\r\nmodel = compiled_tcn(return_sequences=False,\r\n                     num_feat=X_train.shape[2],\r\n                     num_classes=2,\r\n                     nb_filters=24,\r\n                     kernel_size=8,\r\n                     dilations=[2 ** i for i in range(9)],\r\n                     nb_stacks=1,\r\n                     max_len=X_train.shape[1],\r\n                     use_skip_connections=True,\r\n                     )\r\n\r\nmodel.fit(X_train, y_train, validation_data=(X_val, y_val), epochs=1, batch_size=256)\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/491600772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmrichardson","id":6565528,"node_id":"MDQ6VXNlcjY1NjU1Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/6565528?v=4","gravatar_id":"","url":"https://api.github.com/users/jmrichardson","html_url":"https://github.com/jmrichardson","followers_url":"https://api.github.com/users/jmrichardson/followers","following_url":"https://api.github.com/users/jmrichardson/following{/other_user}","gists_url":"https://api.github.com/users/jmrichardson/gists{/gist_id}","starred_url":"https://api.github.com/users/jmrichardson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmrichardson/subscriptions","organizations_url":"https://api.github.com/users/jmrichardson/orgs","repos_url":"https://api.github.com/users/jmrichardson/repos","events_url":"https://api.github.com/users/jmrichardson/events{/privacy}","received_events_url":"https://api.github.com/users/jmrichardson/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/493295284","html_url":"https://github.com/philipperemy/keras-tcn/issues/52#issuecomment-493295284","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/52","id":493295284,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzI5NTI4NA==","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2019-05-17T02:23:57Z","updated_at":"2019-05-17T02:23:57Z","author_association":"OWNER","body":"Sorry I don't have much time to look at code snippets. I don't see any errors here. Don't hesitate to post your question on a machine learning forum. I'll close this issue as I don't see any bugs here. Thanks!","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/493295284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"id":2348140529,"node_id":"MDExOkNsb3NlZEV2ZW50MjM0ODE0MDUyOQ==","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/2348140529","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-05-17T02:23:57Z","state_reason":null,"performed_via_github_app":null}]