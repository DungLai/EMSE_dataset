[{"id":7028486799,"node_id":"MEE_lADOB4a3hs5NiNwqzwAAAAGi7jKP","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/7028486799","actor":{"login":"arvind267","id":41867518,"node_id":"MDQ6VXNlcjQxODY3NTE4","avatar_url":"https://avatars.githubusercontent.com/u/41867518?v=4","gravatar_id":"","url":"https://api.github.com/users/arvind267","html_url":"https://github.com/arvind267","followers_url":"https://api.github.com/users/arvind267/followers","following_url":"https://api.github.com/users/arvind267/following{/other_user}","gists_url":"https://api.github.com/users/arvind267/gists{/gist_id}","starred_url":"https://api.github.com/users/arvind267/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arvind267/subscriptions","organizations_url":"https://api.github.com/users/arvind267/orgs","repos_url":"https://api.github.com/users/arvind267/repos","events_url":"https://api.github.com/users/arvind267/events{/privacy}","received_events_url":"https://api.github.com/users/arvind267/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-20T11:31:37Z","performed_via_github_app":null},{"id":7028486804,"node_id":"SE_lADOB4a3hs5NiNwqzwAAAAGi7jKU","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/7028486804","actor":{"login":"arvind267","id":41867518,"node_id":"MDQ6VXNlcjQxODY3NTE4","avatar_url":"https://avatars.githubusercontent.com/u/41867518?v=4","gravatar_id":"","url":"https://api.github.com/users/arvind267","html_url":"https://github.com/arvind267","followers_url":"https://api.github.com/users/arvind267/followers","following_url":"https://api.github.com/users/arvind267/following{/other_user}","gists_url":"https://api.github.com/users/arvind267/gists{/gist_id}","starred_url":"https://api.github.com/users/arvind267/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arvind267/subscriptions","organizations_url":"https://api.github.com/users/arvind267/orgs","repos_url":"https://api.github.com/users/arvind267/repos","events_url":"https://api.github.com/users/arvind267/events{/privacy}","received_events_url":"https://api.github.com/users/arvind267/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-07-20T11:31:37Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1257219648","html_url":"https://github.com/philipperemy/keras-tcn/issues/234#issuecomment-1257219648","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/234","id":1257219648,"node_id":"IC_kwDOB4a3hs5K76ZA","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2022-09-25T15:36:29Z","updated_at":"2022-09-25T15:36:29Z","author_association":"OWNER","body":"Like this: https://keras.io/api/layers/core_layers/masking\r\n\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nfrom tcn import TCN\r\n\r\nsamples, timesteps, features = 32, 10, 8\r\ninputs = np.random.random([samples, timesteps, features]).astype(np.float32)\r\n\r\nmodel = tf.keras.models.Sequential()\r\nmodel.add(tf.keras.layers.Masking(mask_value=0., input_shape=(timesteps, features)))\r\nmodel.add(TCN(32))\r\n\r\noutput = model(inputs)\r\nprint(output)\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1257219648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1257219816","html_url":"https://github.com/philipperemy/keras-tcn/issues/234#issuecomment-1257219816","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/234","id":1257219816,"node_id":"IC_kwDOB4a3hs5K76bo","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2022-09-25T15:37:32Z","updated_at":"2022-09-25T15:37:32Z","author_association":"OWNER","body":"I'm adding more comments here. Might be useful for later. It seems to work correctly because:\r\n\r\n```python\r\ninputs[:, :, :] = 1.\r\nmodel = tf.keras.models.Sequential()\r\nmodel.add(tf.keras.layers.Masking(mask_value=1., input_shape=(timesteps, features)))\r\n```\r\nThe model will output only zeros. If we change it to `inputs[:, :, :] = 2.`, the model will output different values.\r\n\r\nAnother example:\r\n\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nfrom tcn import TCN\r\n\r\nsamples, timesteps, features = 32, 10, 8\r\ninputs = np.random.random([samples, timesteps, features]).astype(np.float32)\r\ninputs[:, :-1, :] = 1.\r\n\r\nmodel = tf.keras.models.Sequential()\r\nmodel.add(tf.keras.layers.Masking(mask_value=1., input_shape=(timesteps, features)))\r\nmodel.add(TCN(16, return_sequences=True))\r\n\r\noutput = model(inputs)\r\nprint(output.shape)\r\nprint(np.mean(np.abs(output[:, :-1, :]))) # 0.0 EXPECTED (EQUAL TO 0, due to masking).\r\nprint(np.mean(np.abs(output[:, -1:, :]))) # 0.8137888 EXPECTED (DIFFERENT THAN 0).\r\n```","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1257219816/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"id":7453617210,"node_id":"CE_lADOB4a3hs5NiNwqzwAAAAG8RSw6","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/7453617210","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-09-25T15:37:34Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1264978054","html_url":"https://github.com/philipperemy/keras-tcn/issues/234#issuecomment-1264978054","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/234","id":1264978054,"node_id":"IC_kwDOB4a3hs5LZgiG","user":{"login":"arvind267","id":41867518,"node_id":"MDQ6VXNlcjQxODY3NTE4","avatar_url":"https://avatars.githubusercontent.com/u/41867518?v=4","gravatar_id":"","url":"https://api.github.com/users/arvind267","html_url":"https://github.com/arvind267","followers_url":"https://api.github.com/users/arvind267/followers","following_url":"https://api.github.com/users/arvind267/following{/other_user}","gists_url":"https://api.github.com/users/arvind267/gists{/gist_id}","starred_url":"https://api.github.com/users/arvind267/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arvind267/subscriptions","organizations_url":"https://api.github.com/users/arvind267/orgs","repos_url":"https://api.github.com/users/arvind267/repos","events_url":"https://api.github.com/users/arvind267/events{/privacy}","received_events_url":"https://api.github.com/users/arvind267/received_events","type":"User","site_admin":false},"created_at":"2022-10-03T06:10:25Z","updated_at":"2022-10-03T06:10:25Z","author_association":"NONE","body":"Thank you so much @philipperemy!  ","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1264978054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"arvind267","id":41867518,"node_id":"MDQ6VXNlcjQxODY3NTE4","avatar_url":"https://avatars.githubusercontent.com/u/41867518?v=4","gravatar_id":"","url":"https://api.github.com/users/arvind267","html_url":"https://github.com/arvind267","followers_url":"https://api.github.com/users/arvind267/followers","following_url":"https://api.github.com/users/arvind267/following{/other_user}","gists_url":"https://api.github.com/users/arvind267/gists{/gist_id}","starred_url":"https://api.github.com/users/arvind267/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arvind267/subscriptions","organizations_url":"https://api.github.com/users/arvind267/orgs","repos_url":"https://api.github.com/users/arvind267/repos","events_url":"https://api.github.com/users/arvind267/events{/privacy}","received_events_url":"https://api.github.com/users/arvind267/received_events","type":"User","site_admin":false}},{"id":7504037238,"node_id":"MEE_lADOB4a3hs5NiNwqzwAAAAG_RoV2","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/7504037238","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-10-03T06:10:25Z","performed_via_github_app":null},{"id":7504037243,"node_id":"SE_lADOB4a3hs5NiNwqzwAAAAG_RoV7","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/7504037243","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-10-03T06:10:25Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1264990218","html_url":"https://github.com/philipperemy/keras-tcn/issues/234#issuecomment-1264990218","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/234","id":1264990218,"node_id":"IC_kwDOB4a3hs5LZjgK","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2022-10-03T06:26:05Z","updated_at":"2022-10-03T06:26:05Z","author_association":"OWNER","body":"@arvind267 happy I could help!","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1264990218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"id":7504117231,"node_id":"MEE_lADOB4a3hs5NiNwqzwAAAAG_R73v","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/7504117231","actor":{"login":"arvind267","id":41867518,"node_id":"MDQ6VXNlcjQxODY3NTE4","avatar_url":"https://avatars.githubusercontent.com/u/41867518?v=4","gravatar_id":"","url":"https://api.github.com/users/arvind267","html_url":"https://github.com/arvind267","followers_url":"https://api.github.com/users/arvind267/followers","following_url":"https://api.github.com/users/arvind267/following{/other_user}","gists_url":"https://api.github.com/users/arvind267/gists{/gist_id}","starred_url":"https://api.github.com/users/arvind267/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arvind267/subscriptions","organizations_url":"https://api.github.com/users/arvind267/orgs","repos_url":"https://api.github.com/users/arvind267/repos","events_url":"https://api.github.com/users/arvind267/events{/privacy}","received_events_url":"https://api.github.com/users/arvind267/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-10-03T06:26:05Z","performed_via_github_app":null},{"id":7504117235,"node_id":"SE_lADOB4a3hs5NiNwqzwAAAAG_R73z","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/7504117235","actor":{"login":"arvind267","id":41867518,"node_id":"MDQ6VXNlcjQxODY3NTE4","avatar_url":"https://avatars.githubusercontent.com/u/41867518?v=4","gravatar_id":"","url":"https://api.github.com/users/arvind267","html_url":"https://github.com/arvind267","followers_url":"https://api.github.com/users/arvind267/followers","following_url":"https://api.github.com/users/arvind267/following{/other_user}","gists_url":"https://api.github.com/users/arvind267/gists{/gist_id}","starred_url":"https://api.github.com/users/arvind267/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arvind267/subscriptions","organizations_url":"https://api.github.com/users/arvind267/orgs","repos_url":"https://api.github.com/users/arvind267/repos","events_url":"https://api.github.com/users/arvind267/events{/privacy}","received_events_url":"https://api.github.com/users/arvind267/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-10-03T06:26:05Z","performed_via_github_app":null},{"actor":{"login":"fsbashiri","id":27236086,"node_id":"MDQ6VXNlcjI3MjM2MDg2","avatar_url":"https://avatars.githubusercontent.com/u/27236086?v=4","gravatar_id":"","url":"https://api.github.com/users/fsbashiri","html_url":"https://github.com/fsbashiri","followers_url":"https://api.github.com/users/fsbashiri/followers","following_url":"https://api.github.com/users/fsbashiri/following{/other_user}","gists_url":"https://api.github.com/users/fsbashiri/gists{/gist_id}","starred_url":"https://api.github.com/users/fsbashiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fsbashiri/subscriptions","organizations_url":"https://api.github.com/users/fsbashiri/orgs","repos_url":"https://api.github.com/users/fsbashiri/repos","events_url":"https://api.github.com/users/fsbashiri/events{/privacy}","received_events_url":"https://api.github.com/users/fsbashiri/received_events","type":"User","site_admin":false},"created_at":"2022-10-17T21:22:42Z","updated_at":"2022-10-17T21:22:42Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/240","repository_url":"https://api.github.com/repos/philipperemy/keras-tcn","labels_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/240/labels{/name}","comments_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/240/comments","events_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/240/events","html_url":"https://github.com/philipperemy/keras-tcn/issues/240","id":1412244373,"node_id":"I_kwDOB4a3hs5ULSOV","number":240,"title":"Masking time steps in order to use TCN for variable length sequences","user":{"login":"fsbashiri","id":27236086,"node_id":"MDQ6VXNlcjI3MjM2MDg2","avatar_url":"https://avatars.githubusercontent.com/u/27236086?v=4","gravatar_id":"","url":"https://api.github.com/users/fsbashiri","html_url":"https://github.com/fsbashiri","followers_url":"https://api.github.com/users/fsbashiri/followers","following_url":"https://api.github.com/users/fsbashiri/following{/other_user}","gists_url":"https://api.github.com/users/fsbashiri/gists{/gist_id}","starred_url":"https://api.github.com/users/fsbashiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fsbashiri/subscriptions","organizations_url":"https://api.github.com/users/fsbashiri/orgs","repos_url":"https://api.github.com/users/fsbashiri/repos","events_url":"https://api.github.com/users/fsbashiri/events{/privacy}","received_events_url":"https://api.github.com/users/fsbashiri/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-10-17T21:22:42Z","updated_at":"2022-11-07T07:34:48Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"repository":{"id":126269318,"node_id":"MDEwOlJlcG9zaXRvcnkxMjYyNjkzMTg=","name":"keras-tcn","full_name":"philipperemy/keras-tcn","private":false,"owner":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"html_url":"https://github.com/philipperemy/keras-tcn","description":"Keras Temporal Convolutional Network.","fork":false,"url":"https://api.github.com/repos/philipperemy/keras-tcn","forks_url":"https://api.github.com/repos/philipperemy/keras-tcn/forks","keys_url":"https://api.github.com/repos/philipperemy/keras-tcn/keys{/key_id}","collaborators_url":"https://api.github.com/repos/philipperemy/keras-tcn/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/philipperemy/keras-tcn/teams","hooks_url":"https://api.github.com/repos/philipperemy/keras-tcn/hooks","issue_events_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events{/number}","events_url":"https://api.github.com/repos/philipperemy/keras-tcn/events","assignees_url":"https://api.github.com/repos/philipperemy/keras-tcn/assignees{/user}","branches_url":"https://api.github.com/repos/philipperemy/keras-tcn/branches{/branch}","tags_url":"https://api.github.com/repos/philipperemy/keras-tcn/tags","blobs_url":"https://api.github.com/repos/philipperemy/keras-tcn/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/philipperemy/keras-tcn/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/philipperemy/keras-tcn/git/refs{/sha}","trees_url":"https://api.github.com/repos/philipperemy/keras-tcn/git/trees{/sha}","statuses_url":"https://api.github.com/repos/philipperemy/keras-tcn/statuses/{sha}","languages_url":"https://api.github.com/repos/philipperemy/keras-tcn/languages","stargazers_url":"https://api.github.com/repos/philipperemy/keras-tcn/stargazers","contributors_url":"https://api.github.com/repos/philipperemy/keras-tcn/contributors","subscribers_url":"https://api.github.com/repos/philipperemy/keras-tcn/subscribers","subscription_url":"https://api.github.com/repos/philipperemy/keras-tcn/subscription","commits_url":"https://api.github.com/repos/philipperemy/keras-tcn/commits{/sha}","git_commits_url":"https://api.github.com/repos/philipperemy/keras-tcn/git/commits{/sha}","comments_url":"https://api.github.com/repos/philipperemy/keras-tcn/comments{/number}","issue_comment_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments{/number}","contents_url":"https://api.github.com/repos/philipperemy/keras-tcn/contents/{+path}","compare_url":"https://api.github.com/repos/philipperemy/keras-tcn/compare/{base}...{head}","merges_url":"https://api.github.com/repos/philipperemy/keras-tcn/merges","archive_url":"https://api.github.com/repos/philipperemy/keras-tcn/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/philipperemy/keras-tcn/downloads","issues_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues{/number}","pulls_url":"https://api.github.com/repos/philipperemy/keras-tcn/pulls{/number}","milestones_url":"https://api.github.com/repos/philipperemy/keras-tcn/milestones{/number}","notifications_url":"https://api.github.com/repos/philipperemy/keras-tcn/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/philipperemy/keras-tcn/labels{/name}","releases_url":"https://api.github.com/repos/philipperemy/keras-tcn/releases{/id}","deployments_url":"https://api.github.com/repos/philipperemy/keras-tcn/deployments","created_at":"2018-03-22T02:40:06Z","updated_at":"2023-01-18T09:24:51Z","pushed_at":"2022-09-26T01:56:47Z","git_url":"git://github.com/philipperemy/keras-tcn.git","ssh_url":"git@github.com:philipperemy/keras-tcn.git","clone_url":"https://github.com/philipperemy/keras-tcn.git","svn_url":"https://github.com/philipperemy/keras-tcn","homepage":"","size":6015,"stargazers_count":1593,"watchers_count":1593,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":429,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":4,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["deep-learning","keras","machine-learning","recurrent-neural-networks","tcn"],"visibility":"public","forks":429,"open_issues":4,"watchers":1593,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"**Describe the bug**\r\nIn my project, I am using TCN for sequence-to-sequence analysis of time series data that have variable lengths. I have defined a subclass of the Sequence class that pads each batch of data to its maximum sequence length (similar to what is suggested [here](https://stanford.edu/~shervine/blog/keras-how-to-generate-data-on-the-fly#data-generator)). As for the model, I use a masking layer to compute and pass a mask to TCN (as suggested [here issue #234](https://github.com/philipperemy/keras-tcn/issues/234)). Supposedly, layers that support masking will automatically propagate the mask to the next layer. In the simplest form of my model, I have a masking layer, followed by a TCN, and a Dense layer with 1 unit.\r\n\r\nHere are two issues that I've got:\r\n1. when I try to access the propagated mask from the output of the TCN layer, I get an error that says the object has no attribute `_keras_mask`.\r\n2. Apparently, it matters if a sequence is padded from the beginning of the sequence or a the end (whether to set padding argument of the [pad_sequences](https://www.tensorflow.org/api_docs/python/tf/keras/utils/pad_sequences) 'pre' or 'post'). If it's padded from the beginning, the output of the TCN at those padded time steps is equal to zero. But you cannot expect zero output if it's padded at the end of the sequence. \r\n\r\n**Paste a snippet**\r\nPlease see the following simple code:\r\n\r\n```python\r\nmask_value = 1.0\r\nx = np.random.rand(1, 3, 8)  # 1 sample, 3 time steps, 8 features\r\nx_pre = np.append(mask_value * np.ones((1, 2, 8)), x, axis=1)  # append (pre-padding) 2 time steps with mask_value\r\nx_post = np.append(x, mask_value * np.ones((1, 2, 8)), axis=1)  # append (post-padding) 2 time steps with mask_value\r\nprint(f\"x_pre: \\n{x_pre}\")\r\n\r\n# Sequential modeling\r\nmodel = Sequential()\r\nmodel.add(Masking(mask_value=mask_value))\r\nmodel.add(TCN(nb_filters=64,\r\n              nb_stacks=1,\r\n              kernel_size=3,\r\n              dilations=[1, 2],\r\n              padding='causal',\r\n              return_sequences=True))\r\nmodel.add(TimeDistributed(Dense(1)))\r\n\r\nout_pre = model(x_pre)\r\nout_post = model(x_post)\r\nprint(f\"out_pre: \\n{out_pre}\")\r\nprint(f\"out_post: \\n{out_post}\")\r\nprint(f\"out_pre._keras_mask: \\n{out_pre._keras_mask}\")\r\n```\r\n\r\nThe output of the code:\r\n\r\n```\r\nx_pre: \r\n[[[1.         1.         1.         1.         1.         1.\r\n   1.         1.        ]\r\n  [1.         1.         1.         1.         1.         1.\r\n   1.         1.        ]\r\n  [0.66743025 0.3803879  0.06403598 0.6146936  0.34356068 0.08322509\r\n   0.97064031 0.67479811]\r\n  [0.38705443 0.18246054 0.17536628 0.8973423  0.63538071 0.35077733\r\n   0.33901726 0.35183449]\r\n  [0.10048297 0.33713389 0.61988985 0.74523683 0.48507557 0.21914819\r\n   0.86720421 0.66290713]]]\r\nout_pre: \r\n[[[ 0.        ]\r\n  [ 0.        ]\r\n  [-0.28437746]\r\n  [-0.29050288]\r\n  [-0.84733   ]]]\r\nout_post: \r\n[[[-0.28437746]\r\n  [-0.29050288]\r\n  [-0.84733   ]\r\n  [-0.05684387]\r\n  [-0.7985336 ]]]\r\nTraceback (most recent call last):\r\n  File \"/Applications/PyCharm CE.app/Contents/plugins/python-ce/helpers/pydev/pydevd.py\", line 1491, in _exec\r\n    pydev_imports.execfile(file, globals, locals)  # execute the script\r\n  File \"/Applications/PyCharm CE.app/Contents/plugins/python-ce/helpers/pydev/_pydev_imps/_pydev_execfile.py\", line 18, in execfile\r\n    exec(compile(contents+\"\\n\", file, 'exec'), glob, loc)\r\n  File \"/Users/fbashiri/Documents/Projects/MGP-AttTCN-master/src/loss_n_eval/Azi_test_loss.py\", line 132, in <module>\r\n    print(f\"out_pre._keras_mask: \\n{out_pre._keras_mask}\")\r\nAttributeError: 'tensorflow.python.framework.ops.EagerTensor' object has no attribute '_keras_mask'\r\n```\r\n\r\n**Dependencies**\r\nI am using:\r\nkeras 2.4.3\r\nkeras-tan 3.1.1\r\nTensorflow-gpu 2.3.1\r\n","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/240/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"}]