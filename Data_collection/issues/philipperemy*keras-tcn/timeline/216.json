[{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/896043226","html_url":"https://github.com/philipperemy/keras-tcn/issues/216#issuecomment-896043226","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/216","id":896043226,"node_id":"IC_kwDOB4a3hs41aIja","user":{"login":"mmawwxx","id":57813537,"node_id":"MDQ6VXNlcjU3ODEzNTM3","avatar_url":"https://avatars.githubusercontent.com/u/57813537?v=4","gravatar_id":"","url":"https://api.github.com/users/mmawwxx","html_url":"https://github.com/mmawwxx","followers_url":"https://api.github.com/users/mmawwxx/followers","following_url":"https://api.github.com/users/mmawwxx/following{/other_user}","gists_url":"https://api.github.com/users/mmawwxx/gists{/gist_id}","starred_url":"https://api.github.com/users/mmawwxx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmawwxx/subscriptions","organizations_url":"https://api.github.com/users/mmawwxx/orgs","repos_url":"https://api.github.com/users/mmawwxx/repos","events_url":"https://api.github.com/users/mmawwxx/events{/privacy}","received_events_url":"https://api.github.com/users/mmawwxx/received_events","type":"User","site_admin":false},"created_at":"2021-08-10T13:47:29Z","updated_at":"2021-08-10T13:47:29Z","author_association":"NONE","body":"btw, I compared the training time of TCN and CNN-LSTM. I set up them to have similar parameter scales. The results show that both of them takes about 5-10min to finish training, and in many cases CNN-LSTM is even faster...So I thought if this is because I didn't set up the parallel computation correctly...","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/896043226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mmawwxx","id":57813537,"node_id":"MDQ6VXNlcjU3ODEzNTM3","avatar_url":"https://avatars.githubusercontent.com/u/57813537?v=4","gravatar_id":"","url":"https://api.github.com/users/mmawwxx","html_url":"https://github.com/mmawwxx","followers_url":"https://api.github.com/users/mmawwxx/followers","following_url":"https://api.github.com/users/mmawwxx/following{/other_user}","gists_url":"https://api.github.com/users/mmawwxx/gists{/gist_id}","starred_url":"https://api.github.com/users/mmawwxx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmawwxx/subscriptions","organizations_url":"https://api.github.com/users/mmawwxx/orgs","repos_url":"https://api.github.com/users/mmawwxx/repos","events_url":"https://api.github.com/users/mmawwxx/events{/privacy}","received_events_url":"https://api.github.com/users/mmawwxx/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1017306337","html_url":"https://github.com/philipperemy/keras-tcn/issues/216#issuecomment-1017306337","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/216","id":1017306337,"node_id":"IC_kwDOB4a3hs48otzh","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2022-01-20T10:01:45Z","updated_at":"2022-01-20T10:01:45Z","author_association":"OWNER","body":"@mmawwxx good point. Some parts were discussed in this issue: https://github.com/philipperemy/keras-tcn/issues/69","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1017306337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"id":5923569626,"node_id":"MEE_lADOB4a3hs45fiaDzwAAAAFhEn_a","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/5923569626","actor":{"login":"mmawwxx","id":57813537,"node_id":"MDQ6VXNlcjU3ODEzNTM3","avatar_url":"https://avatars.githubusercontent.com/u/57813537?v=4","gravatar_id":"","url":"https://api.github.com/users/mmawwxx","html_url":"https://github.com/mmawwxx","followers_url":"https://api.github.com/users/mmawwxx/followers","following_url":"https://api.github.com/users/mmawwxx/following{/other_user}","gists_url":"https://api.github.com/users/mmawwxx/gists{/gist_id}","starred_url":"https://api.github.com/users/mmawwxx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmawwxx/subscriptions","organizations_url":"https://api.github.com/users/mmawwxx/orgs","repos_url":"https://api.github.com/users/mmawwxx/repos","events_url":"https://api.github.com/users/mmawwxx/events{/privacy}","received_events_url":"https://api.github.com/users/mmawwxx/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-01-20T10:01:45Z","performed_via_github_app":null},{"id":5923569629,"node_id":"SE_lADOB4a3hs45fiaDzwAAAAFhEn_d","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/5923569629","actor":{"login":"mmawwxx","id":57813537,"node_id":"MDQ6VXNlcjU3ODEzNTM3","avatar_url":"https://avatars.githubusercontent.com/u/57813537?v=4","gravatar_id":"","url":"https://api.github.com/users/mmawwxx","html_url":"https://github.com/mmawwxx","followers_url":"https://api.github.com/users/mmawwxx/followers","following_url":"https://api.github.com/users/mmawwxx/following{/other_user}","gists_url":"https://api.github.com/users/mmawwxx/gists{/gist_id}","starred_url":"https://api.github.com/users/mmawwxx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmawwxx/subscriptions","organizations_url":"https://api.github.com/users/mmawwxx/orgs","repos_url":"https://api.github.com/users/mmawwxx/repos","events_url":"https://api.github.com/users/mmawwxx/events{/privacy}","received_events_url":"https://api.github.com/users/mmawwxx/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-01-20T10:01:45Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1017308128","html_url":"https://github.com/philipperemy/keras-tcn/issues/216#issuecomment-1017308128","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/216","id":1017308128,"node_id":"IC_kwDOB4a3hs48ouPg","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2022-01-20T10:03:37Z","updated_at":"2022-01-20T10:03:37Z","author_association":"OWNER","body":"Ideally, some computations could be re-used when forecasting step by step. I think that's what you wanted to say. It is not the case at the moment. Every time you call predict(), all the computations are done from scratch. So it's not really efficient for real-time forecasting. But that's how Keras works I guess. Optimizing it would be insanely difficult in my opinion. Probably pytorch would be a better fit for this type of work.","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1017308128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"id":5923584729,"node_id":"LE_lADOB4a3hs45fiaDzwAAAAFhErrZ","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/5923584729","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-01-20T10:03:56Z","label":{"name":"question","color":"d876e3"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1018354435","html_url":"https://github.com/philipperemy/keras-tcn/issues/216#issuecomment-1018354435","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/216","id":1018354435,"node_id":"IC_kwDOB4a3hs48stsD","user":{"login":"mmawwxx","id":57813537,"node_id":"MDQ6VXNlcjU3ODEzNTM3","avatar_url":"https://avatars.githubusercontent.com/u/57813537?v=4","gravatar_id":"","url":"https://api.github.com/users/mmawwxx","html_url":"https://github.com/mmawwxx","followers_url":"https://api.github.com/users/mmawwxx/followers","following_url":"https://api.github.com/users/mmawwxx/following{/other_user}","gists_url":"https://api.github.com/users/mmawwxx/gists{/gist_id}","starred_url":"https://api.github.com/users/mmawwxx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmawwxx/subscriptions","organizations_url":"https://api.github.com/users/mmawwxx/orgs","repos_url":"https://api.github.com/users/mmawwxx/repos","events_url":"https://api.github.com/users/mmawwxx/events{/privacy}","received_events_url":"https://api.github.com/users/mmawwxx/received_events","type":"User","site_admin":false},"created_at":"2022-01-21T09:58:51Z","updated_at":"2022-01-21T10:03:54Z","author_association":"NONE","body":"@philipperemy Thanks for the response ! Actually after checking issue #69, I think my case is pretty similar with #69 . I also set the return sequence to false and only keep a single slice in the last layer. As a result, the computation for the rest slices of the last layer is wasted. Regarding this, I have two follow up questions that wish I could get some of your suggestions:\r\n(1) Currently I'm doing a multi-step ahead forecasting (like 24 steps ahead). What I have done is to set the return sequence as false, hoping that all the information in the input sequence can be extracted and compacted to a single slice in the last layer (just like the encoder in #69). After that, I use a MLP to achieve the mapping from this single slice to the 24-length forecasts, i.e. Dense(24). So basically I'm not repeating the same model for 24 times, but directly achieve 24-step ahead forecasting once for all. From the methodology wise, do you think this is a reasonable way of using TCN to do multi-step forecasting? Or I should set the return sequence as True?\r\n(2) If I set return sequence as false and only keep a single slice in the last layer, is there a way to eliminate the calculation for the rest of the slices in the last layer? This should be able to allievate a lot of computation time","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1018354435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mmawwxx","id":57813537,"node_id":"MDQ6VXNlcjU3ODEzNTM3","avatar_url":"https://avatars.githubusercontent.com/u/57813537?v=4","gravatar_id":"","url":"https://api.github.com/users/mmawwxx","html_url":"https://github.com/mmawwxx","followers_url":"https://api.github.com/users/mmawwxx/followers","following_url":"https://api.github.com/users/mmawwxx/following{/other_user}","gists_url":"https://api.github.com/users/mmawwxx/gists{/gist_id}","starred_url":"https://api.github.com/users/mmawwxx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmawwxx/subscriptions","organizations_url":"https://api.github.com/users/mmawwxx/orgs","repos_url":"https://api.github.com/users/mmawwxx/repos","events_url":"https://api.github.com/users/mmawwxx/events{/privacy}","received_events_url":"https://api.github.com/users/mmawwxx/received_events","type":"User","site_admin":false}},{"id":5930955831,"node_id":"MEE_lADOB4a3hs45fiaDzwAAAAFhgzQ3","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/5930955831","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-01-21T09:58:51Z","performed_via_github_app":null},{"id":5930955837,"node_id":"SE_lADOB4a3hs45fiaDzwAAAAFhgzQ9","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/5930955837","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-01-21T09:58:51Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1018513225","html_url":"https://github.com/philipperemy/keras-tcn/issues/216#issuecomment-1018513225","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/216","id":1018513225,"node_id":"IC_kwDOB4a3hs48tUdJ","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2022-01-21T13:38:50Z","updated_at":"2022-01-21T13:39:24Z","author_association":"OWNER","body":"That's what I was expecting. My points:\r\n- In theory you should just learn P(X_t+1 | X_0,...,X_t) and you could call the model 24 times by re-using the predictions as previous inputs. The problem is that the errors will add. And 24 times is not trivial.\r\n- Your methodology looks good to me. You have some sort of seq-to-seq architecture. And I don't see anything wrong here.\r\n- Like you said a Dense(24) will have you modeling P(X_t+1,... X_t+24 | X_0,...,X_t). So you are generating from the joint distribution. And not the conditional distributions (my point 1). One disadvantage of that is that you assume that P(X_t+1) and P(X_t+2) are independent. Said differently, if you permute X_t+2 and Xt+1 in your vector, the problem would be the same.\r\n- You can also have a look at RepeatVector(24) and TimeDistributed(Dense)).\r\n- Using return_sequences=False is the right way to me. Because the size of your inputs (something different than 24) is different than the size of your outputs (24). And also P(X_t+1) would be conditioned on P(X_0). P(X_t+2) on P(X_0, X_1). And that's not really what you want. You want to input the full sequence first and then unroll on 24 values.\r\n- Unfortunately, at the moment it's not really possible. So yeah you are wasting a lot of resources for sure, especially on very long sequences but I don't have anything to offer you at the moment on that ;)\r\n\r\nI am 99% sure on what I'm discussing here but I might be wrong especially on the stat part. So do not hesitate to question it.","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1018513225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1018534307","html_url":"https://github.com/philipperemy/keras-tcn/issues/216#issuecomment-1018534307","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/216","id":1018534307,"node_id":"IC_kwDOB4a3hs48tZmj","user":{"login":"mmawwxx","id":57813537,"node_id":"MDQ6VXNlcjU3ODEzNTM3","avatar_url":"https://avatars.githubusercontent.com/u/57813537?v=4","gravatar_id":"","url":"https://api.github.com/users/mmawwxx","html_url":"https://github.com/mmawwxx","followers_url":"https://api.github.com/users/mmawwxx/followers","following_url":"https://api.github.com/users/mmawwxx/following{/other_user}","gists_url":"https://api.github.com/users/mmawwxx/gists{/gist_id}","starred_url":"https://api.github.com/users/mmawwxx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmawwxx/subscriptions","organizations_url":"https://api.github.com/users/mmawwxx/orgs","repos_url":"https://api.github.com/users/mmawwxx/repos","events_url":"https://api.github.com/users/mmawwxx/events{/privacy}","received_events_url":"https://api.github.com/users/mmawwxx/received_events","type":"User","site_admin":false},"created_at":"2022-01-21T14:06:54Z","updated_at":"2022-01-21T14:06:54Z","author_association":"NONE","body":"Hi Philipperemy,\n\nThanks so much for your insight. That helps a lot !\n\nBest\nYiyan\n\nOn Fri, Jan 21, 2022 at 9:39 PM Philippe Rémy ***@***.***>\nwrote:\n\n> That's what I was expecting. My points:\n>\n>    - In theory you should just learn P(X_t+1 | X_0,...,X_t) and you could\n>    call the model 24 times by re-using the predictions as previous inputs. The\n>    problem is that the errors will add. And 24 times is not trivial.\n>    - Your methodology looks good to me. You have some sort of seq-to-seq\n>    architecture. And I don't see anything wrong here.\n>    - Like you said a Dense(24) will have you modeling P(X_t+1,... X_t+24\n>    | X_0,...,X_t). So you are generating from the joint distribution. And not\n>    the conditional distributions (my point 1). One disadvantage of that is\n>    that you assume that P(X_t+1) and P(X_t+2) are independent. Said\n>    differently, if you permute X_t+2 and Xt+1 in your vector, the problem\n>    would be the same.\n>    - You can also have a look at RepeatVector(24) and\n>    TimeDistributed(Dense)).\n>    - Using return_sequences=False is the right way to me. Because the\n>    size of your inputs (something different than 24) is different than the\n>    size of your outputs (24). And also P(X_t+1) would be conditioned on\n>    P(X_0). P(X_t+2) on P(X_0, X_1). And that's not really what you want. You\n>    want to input the full sequence first and then unroll on 24 values.\n>    - Unfortunately, at the moment it's not really possible. So yeah you\n>    are wasting a lot of resources for sure, especially on very long sequences\n>    but I don't have anything to offer you at the moment on that ;)\n>\n> —\n> Reply to this email directly, view it on GitHub\n> <https://github.com/philipperemy/keras-tcn/issues/216#issuecomment-1018513225>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ANZCUIPAHH5XOV5XRZKAEUDUXFOXLANCNFSM5B3JJUKA>\n> .\n> Triage notifications on the go with GitHub Mobile for iOS\n> <https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>\n> or Android\n> <https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>.\n>\n> You are receiving this because you were mentioned.Message ID:\n> ***@***.***>\n>\n\n\n-- \nYiyan Li, Ph.D.\nPostdoc Researcher\nNSF FREEDM Systems Center\nNorth Carolina State University\nRaleigh, NC, 27607\nTel: 919.903.1199\n","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1018534307/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mmawwxx","id":57813537,"node_id":"MDQ6VXNlcjU3ODEzNTM3","avatar_url":"https://avatars.githubusercontent.com/u/57813537?v=4","gravatar_id":"","url":"https://api.github.com/users/mmawwxx","html_url":"https://github.com/mmawwxx","followers_url":"https://api.github.com/users/mmawwxx/followers","following_url":"https://api.github.com/users/mmawwxx/following{/other_user}","gists_url":"https://api.github.com/users/mmawwxx/gists{/gist_id}","starred_url":"https://api.github.com/users/mmawwxx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmawwxx/subscriptions","organizations_url":"https://api.github.com/users/mmawwxx/orgs","repos_url":"https://api.github.com/users/mmawwxx/repos","events_url":"https://api.github.com/users/mmawwxx/events{/privacy}","received_events_url":"https://api.github.com/users/mmawwxx/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1018535921","html_url":"https://github.com/philipperemy/keras-tcn/issues/216#issuecomment-1018535921","issue_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/216","id":1018535921,"node_id":"IC_kwDOB4a3hs48tZ_x","user":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"created_at":"2022-01-21T14:08:55Z","updated_at":"2022-01-21T14:08:55Z","author_association":"OWNER","body":"@mmawwxx my pleasure!","reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/comments/1018535921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false}},{"id":5932367802,"node_id":"CE_lADOB4a3hs45fiaDzwAAAAFhmL-6","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/5932367802","actor":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-01-21T14:08:55Z","state_reason":null,"performed_via_github_app":null},{"id":5932367851,"node_id":"MEE_lADOB4a3hs45fiaDzwAAAAFhmL_r","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/5932367851","actor":{"login":"mmawwxx","id":57813537,"node_id":"MDQ6VXNlcjU3ODEzNTM3","avatar_url":"https://avatars.githubusercontent.com/u/57813537?v=4","gravatar_id":"","url":"https://api.github.com/users/mmawwxx","html_url":"https://github.com/mmawwxx","followers_url":"https://api.github.com/users/mmawwxx/followers","following_url":"https://api.github.com/users/mmawwxx/following{/other_user}","gists_url":"https://api.github.com/users/mmawwxx/gists{/gist_id}","starred_url":"https://api.github.com/users/mmawwxx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmawwxx/subscriptions","organizations_url":"https://api.github.com/users/mmawwxx/orgs","repos_url":"https://api.github.com/users/mmawwxx/repos","events_url":"https://api.github.com/users/mmawwxx/events{/privacy}","received_events_url":"https://api.github.com/users/mmawwxx/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-01-21T14:08:56Z","performed_via_github_app":null},{"id":5932367859,"node_id":"SE_lADOB4a3hs45fiaDzwAAAAFhmL_z","url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/events/5932367859","actor":{"login":"mmawwxx","id":57813537,"node_id":"MDQ6VXNlcjU3ODEzNTM3","avatar_url":"https://avatars.githubusercontent.com/u/57813537?v=4","gravatar_id":"","url":"https://api.github.com/users/mmawwxx","html_url":"https://github.com/mmawwxx","followers_url":"https://api.github.com/users/mmawwxx/followers","following_url":"https://api.github.com/users/mmawwxx/following{/other_user}","gists_url":"https://api.github.com/users/mmawwxx/gists{/gist_id}","starred_url":"https://api.github.com/users/mmawwxx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmawwxx/subscriptions","organizations_url":"https://api.github.com/users/mmawwxx/orgs","repos_url":"https://api.github.com/users/mmawwxx/repos","events_url":"https://api.github.com/users/mmawwxx/events{/privacy}","received_events_url":"https://api.github.com/users/mmawwxx/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-01-21T14:08:56Z","performed_via_github_app":null}]