{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/108","repository_url":"https://api.github.com/repos/philipperemy/keras-tcn","labels_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/108/labels{/name}","comments_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/108/comments","events_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/108/events","html_url":"https://github.com/philipperemy/keras-tcn/issues/108","id":530572205,"node_id":"MDU6SXNzdWU1MzA1NzIyMDU=","number":108,"title":"Mismatch in model structure between keras-tcn versions","user":{"login":"asyms","id":34397549,"node_id":"MDQ6VXNlcjM0Mzk3NTQ5","avatar_url":"https://avatars.githubusercontent.com/u/34397549?v=4","gravatar_id":"","url":"https://api.github.com/users/asyms","html_url":"https://github.com/asyms","followers_url":"https://api.github.com/users/asyms/followers","following_url":"https://api.github.com/users/asyms/following{/other_user}","gists_url":"https://api.github.com/users/asyms/gists{/gist_id}","starred_url":"https://api.github.com/users/asyms/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asyms/subscriptions","organizations_url":"https://api.github.com/users/asyms/orgs","repos_url":"https://api.github.com/users/asyms/repos","events_url":"https://api.github.com/users/asyms/events{/privacy}","received_events_url":"https://api.github.com/users/asyms/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2019-11-30T12:19:55Z","updated_at":"2020-04-26T05:41:54Z","closed_at":"2020-04-26T05:41:53Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\r\n\r\nThe issue I'm having is the following.\r\n\r\nSetup:\r\ntensorflow-gpu:2.0.0\r\nkeras-tcn:2.8.3 vs 2.9.2\r\n\r\nRunning the code in test_build_model gives different model structures in keras-tcn 2.8.3 vs 2.9.2.\r\nI believe the issue stems from the fact that build_model() in BuildTCNClassifier.py uses keras for the 2.8.3 version, as opposed to tf.keras for the 2.9.2 version. There are no differences code-wise, only those imports differ.\r\n\r\nI can use the older keras-tcn version without problems, but I would like to figure out how to get the old model summary using the latest keras-tcn version.\r\n\r\nModel summary for keras-tcn==2.8.3\r\n```\r\nModel: \"model_1\"\r\n__________________________________________________________________________________________________\r\nLayer (type)                    Output Shape         Param #     Connected to                     \r\n==================================================================================================\r\ninput_1 (InputLayer)            (None, 61, 10)       0                                            \r\n__________________________________________________________________________________________________\r\nconv1d_1 (Conv1D)               (None, 61, 16)       176         input_1[0][0]                    \r\n__________________________________________________________________________________________________\r\nconv1d_2 (Conv1D)               (None, 61, 16)       784         conv1d_1[0][0]                   \r\n__________________________________________________________________________________________________\r\nbatch_normalization_1 (BatchNor (None, 61, 16)       64          conv1d_2[0][0]                   \r\n__________________________________________________________________________________________________\r\nactivation_1 (Activation)       (None, 61, 16)       0           batch_normalization_1[0][0]      \r\n__________________________________________________________________________________________________\r\nspatial_dropout1d_1 (SpatialDro (None, 61, 16)       0           activation_1[0][0]               \r\n__________________________________________________________________________________________________\r\nconv1d_3 (Conv1D)               (None, 61, 16)       784         spatial_dropout1d_1[0][0]        \r\n__________________________________________________________________________________________________\r\nbatch_normalization_2 (BatchNor (None, 61, 16)       64          conv1d_3[0][0]                   \r\n__________________________________________________________________________________________________\r\nactivation_2 (Activation)       (None, 61, 16)       0           batch_normalization_2[0][0]      \r\n__________________________________________________________________________________________________\r\nconv1d_4 (Conv1D)               (None, 61, 16)       272         conv1d_1[0][0]                   \r\n__________________________________________________________________________________________________\r\nspatial_dropout1d_2 (SpatialDro (None, 61, 16)       0           activation_2[0][0]               \r\n__________________________________________________________________________________________________\r\nadd_1 (Add)                     (None, 61, 16)       0           conv1d_4[0][0]                   \r\n                                                                 spatial_dropout1d_2[0][0]        \r\n__________________________________________________________________________________________________\r\nactivation_3 (Activation)       (None, 61, 16)       0           add_1[0][0]                      \r\n__________________________________________________________________________________________________\r\nconv1d_5 (Conv1D)               (None, 61, 48)       816         activation_3[0][0]               \r\n__________________________________________________________________________________________________\r\nconv1d_6 (Conv1D)               (None, 61, 48)       6960        conv1d_5[0][0]                   \r\n__________________________________________________________________________________________________\r\nbatch_normalization_3 (BatchNor (None, 61, 48)       192         conv1d_6[0][0]                   \r\n__________________________________________________________________________________________________\r\nactivation_4 (Activation)       (None, 61, 48)       0           batch_normalization_3[0][0]      \r\n__________________________________________________________________________________________________\r\nspatial_dropout1d_3 (SpatialDro (None, 61, 48)       0           activation_4[0][0]               \r\n__________________________________________________________________________________________________\r\nconv1d_7 (Conv1D)               (None, 61, 48)       6960        spatial_dropout1d_3[0][0]        \r\n__________________________________________________________________________________________________\r\nbatch_normalization_4 (BatchNor (None, 61, 48)       192         conv1d_7[0][0]                   \r\n__________________________________________________________________________________________________\r\nactivation_5 (Activation)       (None, 61, 48)       0           batch_normalization_4[0][0]      \r\n__________________________________________________________________________________________________\r\nspatial_dropout1d_4 (SpatialDro (None, 61, 48)       0           activation_5[0][0]               \r\n__________________________________________________________________________________________________\r\nconv1d_8 (Conv1D)               (None, 61, 48)       2352        conv1d_5[0][0]                   \r\n__________________________________________________________________________________________________\r\nadd_2 (Add)                     (None, 61, 48)       0           conv1d_8[0][0]                   \r\n                                                                 spatial_dropout1d_4[0][0]        \r\n__________________________________________________________________________________________________\r\nactivation_6 (Activation)       (None, 61, 48)       0           add_2[0][0]                      \r\n__________________________________________________________________________________________________\r\nconv1d_9 (Conv1D)               (None, 61, 48)       6960        activation_6[0][0]               \r\n__________________________________________________________________________________________________\r\nbatch_normalization_5 (BatchNor (None, 61, 48)       192         conv1d_9[0][0]                   \r\n__________________________________________________________________________________________________\r\nactivation_7 (Activation)       (None, 61, 48)       0           batch_normalization_5[0][0]      \r\n__________________________________________________________________________________________________\r\nspatial_dropout1d_5 (SpatialDro (None, 61, 48)       0           activation_7[0][0]               \r\n__________________________________________________________________________________________________\r\nconv1d_10 (Conv1D)              (None, 61, 48)       6960        spatial_dropout1d_5[0][0]        \r\n__________________________________________________________________________________________________\r\nbatch_normalization_6 (BatchNor (None, 61, 48)       192         conv1d_10[0][0]                  \r\n__________________________________________________________________________________________________\r\nactivation_8 (Activation)       (None, 61, 48)       0           batch_normalization_6[0][0]      \r\n__________________________________________________________________________________________________\r\nspatial_dropout1d_6 (SpatialDro (None, 61, 48)       0           activation_8[0][0]               \r\n__________________________________________________________________________________________________\r\nconv1d_11 (Conv1D)              (None, 61, 48)       2352        activation_6[0][0]               \r\n__________________________________________________________________________________________________\r\nadd_3 (Add)                     (None, 61, 48)       0           conv1d_11[0][0]                  \r\n                                                                 spatial_dropout1d_6[0][0]        \r\n__________________________________________________________________________________________________\r\nactivation_9 (Activation)       (None, 61, 48)       0           add_3[0][0]                      \r\n__________________________________________________________________________________________________\r\nconv1d_12 (Conv1D)              (None, 61, 48)       6960        activation_9[0][0]               \r\n__________________________________________________________________________________________________\r\nbatch_normalization_7 (BatchNor (None, 61, 48)       192         conv1d_12[0][0]                  \r\n__________________________________________________________________________________________________\r\nactivation_10 (Activation)      (None, 61, 48)       0           batch_normalization_7[0][0]      \r\n__________________________________________________________________________________________________\r\nspatial_dropout1d_7 (SpatialDro (None, 61, 48)       0           activation_10[0][0]              \r\n__________________________________________________________________________________________________\r\nconv1d_13 (Conv1D)              (None, 61, 48)       6960        spatial_dropout1d_7[0][0]        \r\n__________________________________________________________________________________________________\r\nbatch_normalization_8 (BatchNor (None, 61, 48)       192         conv1d_13[0][0]                  \r\n__________________________________________________________________________________________________\r\nactivation_11 (Activation)      (None, 61, 48)       0           batch_normalization_8[0][0]      \r\n__________________________________________________________________________________________________\r\nspatial_dropout1d_8 (SpatialDro (None, 61, 48)       0           activation_11[0][0]              \r\n__________________________________________________________________________________________________\r\nadd_5 (Add)                     (None, 61, 48)       0           spatial_dropout1d_4[0][0]        \r\n                                                                 spatial_dropout1d_6[0][0]        \r\n                                                                 spatial_dropout1d_8[0][0]        \r\n__________________________________________________________________________________________________\r\naverage_pooling1d_1 (AveragePoo (None, 15, 48)       0           add_5[0][0]                      \r\n__________________________________________________________________________________________________\r\nflatten_1 (Flatten)             (None, 720)          0           average_pooling1d_1[0][0]        \r\n__________________________________________________________________________________________________\r\ndense_1 (Dense)                 (None, 12)           8652        flatten_1[0][0]                  \r\n__________________________________________________________________________________________________\r\nsoftmax (Activation)            (None, 12)           0           dense_1[0][0]                    \r\n==================================================================================================\r\nTotal params: 59,228\r\nTrainable params: 58,588\r\nNon-trainable params: 640\r\n__________________________________________________________________________________________________\r\n```\r\n\r\nModel summary for keras-tcn==2.9.2\r\n```\r\nModel: \"model\"\r\n_________________________________________________________________\r\nLayer (type)                 Output Shape              Param #   \r\n=================================================================\r\ninput_1 (InputLayer)         [(None, 61, 10)]          0         \r\n_________________________________________________________________\r\ntcn_0 (TCN)                  (None, 61, 16)            2144      \r\n_________________________________________________________________\r\ntcn_1 (TCN)                  (None, 61, 48)            48432     \r\n_________________________________________________________________\r\naverage_pooling1d (AveragePo (None, 15, 48)            0         \r\n_________________________________________________________________\r\nflatten (Flatten)            (None, 720)               0         \r\n_________________________________________________________________\r\ndense (Dense)                (None, 12)                8652      \r\n_________________________________________________________________\r\nsoftmax (Activation)         (None, 12)                0         \r\n=================================================================\r\nTotal params: 59,228\r\nTrainable params: 58,588\r\nNon-trainable params: 640\r\n_________________________________________________________________\r\n```\r\n\r\nKind regards","closed_by":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/108/timeline","performed_via_github_app":null,"state_reason":"completed"}