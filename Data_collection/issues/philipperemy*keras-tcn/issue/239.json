{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/239","repository_url":"https://api.github.com/repos/philipperemy/keras-tcn","labels_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/239/labels{/name}","comments_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/239/comments","events_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/239/events","html_url":"https://github.com/philipperemy/keras-tcn/issues/239","id":1384670947,"node_id":"I_kwDOB4a3hs5SiGbj","number":239,"title":"The parameter of the TCN","user":{"login":"yanghui-wng","id":44351425,"node_id":"MDQ6VXNlcjQ0MzUxNDI1","avatar_url":"https://avatars.githubusercontent.com/u/44351425?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghui-wng","html_url":"https://github.com/yanghui-wng","followers_url":"https://api.github.com/users/yanghui-wng/followers","following_url":"https://api.github.com/users/yanghui-wng/following{/other_user}","gists_url":"https://api.github.com/users/yanghui-wng/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghui-wng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghui-wng/subscriptions","organizations_url":"https://api.github.com/users/yanghui-wng/orgs","repos_url":"https://api.github.com/users/yanghui-wng/repos","events_url":"https://api.github.com/users/yanghui-wng/events{/privacy}","received_events_url":"https://api.github.com/users/yanghui-wng/received_events","type":"User","site_admin":false},"labels":[{"id":875498559,"node_id":"MDU6TGFiZWw4NzU0OTg1NTk=","url":"https://api.github.com/repos/philipperemy/keras-tcn/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2022-09-24T13:20:25Z","updated_at":"2022-09-26T06:53:54Z","closed_at":"2022-09-26T06:53:54Z","author_association":"NONE","active_lock_reason":null,"body":"I am studying the code about TCN on github (https://github.com/philipperemy/keras-tcn). The number of parameters of the TCN I calculated is different from the answer of the function \"model.summary()\". The parameter of TCN layer that calculated by the function \"model.summary()\" is 153500, but I am not clear about how to calculate this value and I am trying to calculate the value, but the result is 153000.\r\n## Code\r\n```python\r\n# design network\r\nbatch_size = None\r\nmodel = Sequential()\r\ninput_layer = Input(batch_shape=(batch_size,1,7))\r\nmodel.add(input_layer)\r\nmodel.add(TCN(nb_filters=100, #Integer. The number of filters to use in the convolutional layers. Would be similar to units for LSTM. Can be a list.\r\n        kernel_size=3, #Integer. The size of the kernel to use in each convolutional layer.\r\n        nb_stacks=1,   #The number of stacks of residual blocks to use.\r\n        dilations=(1,2,4), #List/Tuple. A dilation list. Example is: [1, 2, 4, 8, 16, 32, 64].\r\n        padding='causal',\r\n        use_skip_connections=False, \r\n        dropout_rate=0.1,\r\n        return_sequences=False,\r\n        activation='relu', \r\n        kernel_initializer='he_normal', \r\n        use_batch_norm=False, \r\n        use_layer_norm=False, \r\n        ))\r\nmodel.add(Dense(64))\r\nmodel.add(LeakyReLU(alpha=0.3))\r\nmodel.add(Dense(32))\r\nmodel.add(LeakyReLU(alpha=0.3))\r\nmodel.add(Dense(16))\r\nmodel.add(LeakyReLU(alpha=0.3))\r\nmodel.add(Dense(1))\r\nmodel.add(LeakyReLU(alpha=0.3))\r\nmodel.compile(loss='mse', optimizer='adam')\r\nmodel.summary()\r\n```\r\n## Output\r\n```\r\nModel: \"sequential_2\"\r\n_________________________________________________________________\r\nLayer (type)                 Output Shape              Param #   \r\n=================================================================\r\ntcn_2 (TCN)                  (None, 100)               153500    \r\n_________________________________________________________________\r\ndense_8 (Dense)              (None, 64)                6464      \r\n_________________________________________________________________\r\nleaky_re_lu_8 (LeakyReLU)    (None, 64)                0         \r\n_________________________________________________________________\r\ndense_9 (Dense)              (None, 32)                2080      \r\n_________________________________________________________________\r\nleaky_re_lu_9 (LeakyReLU)    (None, 32)                0         \r\n_________________________________________________________________\r\ndense_10 (Dense)             (None, 16)                528       \r\n_________________________________________________________________\r\nleaky_re_lu_10 (LeakyReLU)   (None, 16)                0         \r\n_________________________________________________________________\r\ndense_11 (Dense)             (None, 1)                 17        \r\n_________________________________________________________________\r\nleaky_re_lu_11 (LeakyReLU)   (None, 1)                 0         \r\n=================================================================\r\nTotal params: 162,589\r\nTrainable params: 162,589\r\nNon-trainable params: 0\r\n_________________________________________________________________\r\n```\r\n","closed_by":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/239/timeline","performed_via_github_app":null,"state_reason":"completed"}