{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/207","repository_url":"https://api.github.com/repos/philipperemy/keras-tcn","labels_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/207/labels{/name}","comments_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/207/comments","events_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/207/events","html_url":"https://github.com/philipperemy/keras-tcn/issues/207","id":911664746,"node_id":"MDU6SXNzdWU5MTE2NjQ3NDY=","number":207,"title":"Receptive field description and examples","user":{"login":"strokovnjaka","id":15386238,"node_id":"MDQ6VXNlcjE1Mzg2MjM4","avatar_url":"https://avatars.githubusercontent.com/u/15386238?v=4","gravatar_id":"","url":"https://api.github.com/users/strokovnjaka","html_url":"https://github.com/strokovnjaka","followers_url":"https://api.github.com/users/strokovnjaka/followers","following_url":"https://api.github.com/users/strokovnjaka/following{/other_user}","gists_url":"https://api.github.com/users/strokovnjaka/gists{/gist_id}","starred_url":"https://api.github.com/users/strokovnjaka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/strokovnjaka/subscriptions","organizations_url":"https://api.github.com/users/strokovnjaka/orgs","repos_url":"https://api.github.com/users/strokovnjaka/repos","events_url":"https://api.github.com/users/strokovnjaka/events{/privacy}","received_events_url":"https://api.github.com/users/strokovnjaka/received_events","type":"User","site_admin":false},"labels":[{"id":875498555,"node_id":"MDU6TGFiZWw4NzU0OTg1NTU=","url":"https://api.github.com/repos/philipperemy/keras-tcn/labels/enhancement","name":"enhancement","color":"a2eeef","default":true,"description":"New feature or request"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-06-04T16:23:03Z","updated_at":"2022-01-21T03:33:28Z","closed_at":"2022-01-21T03:33:28Z","author_association":"NONE","active_lock_reason":null,"body":"My 5cents to the _\"In theory, the 2 is not justified. We are still not sure why in practice we need to add this 2 in the formula.\"_ question, as stated in the [README](https://github.com/philipperemy/keras-tcn#receptive-field).\r\n\r\nThe *2* is there because there are two `Conv1d` layers in a single `ResidualBlock`. \r\n\r\nFirst, note that the cited [paper](https://arxiv.org/abs/1803.01271) states _\"This gives us two ways to increase the receptive field of the TCN: choosing larger filter sizes k and increasing the dilation factor d, where the effective history of one such layer is (k − 1)d.\"_\r\nIn my opinion, that defines receptive field as \"maximum number of steps back in time from current sample at time *T*, that a filter from (block, layer, stack, TCN) can hit\", or something in that sense. \r\nThe [README](https://github.com/philipperemy/keras-tcn#receptive-field) seems to define receptive field as \"maximum number of samples that filters from (block, layer, stack, TCN) can hit\", which is basically *effective history + 1*, so no big deal there.\r\n\r\nSo, a level *i* `ResidualBlock`'s effective history is *E<sub>h</sub> = 2⋅(k-1)⋅d<sub>i</sub>*, with *k* being kernel size, and *d<sub>i</sub>* being dilation for the `ResidualBlock` at level *i*.\r\n\r\nNext, as `ResidualBlock`s are stacked in a stack, its *E<sub>h</sub> = Σ(2⋅(k-1)⋅d<sub>i</sub>) = 2⋅(k-1)⋅Σd<sub>i</sub>*.\r\n\r\nNext, as *N* stacks are stacked, their *E<sub>h</sub> = N⋅2⋅(k-1)⋅Σd<sub>i</sub>*.\r\n\r\nAs receptive field seems to be effective history plus current sample at time *T*, the formula *R<sub>field</sub> = 1 + 2⋅(k-1)⋅N⋅Σd<sub>i</sub>* is correct.\r\n\r\nAs far as example figures go, they do not match the formula. For the first figure of single stack *16 != 31 = 1 + 2⋅(2-1)⋅1⋅(1+2+4+8)*, and so on for others. Example figures include single `Conv1d` per layer, so the correct formula would be *R<sub>field</sub> = 1 + (k-1)⋅N⋅Σd<sub>i</sub>* (without the notorious *2*).\r\n\r\nDescription for the formula states _\"...where *N<sub>s</sub>* is the number of stacks, *N<sub>b</sub>* is the number of residual blocks per stack...\"_, \r\nbut formula references *N<sub>stacks</sub>*. So instead of *N<sub>s</sub>* use *N<sub>stacks</sub>*, and somehow state that the number of residual blocks is\r\nthe number of *d<sub>i</sub>* s in the formula (or, even better, replace the formula image)\r\n\r\nTo avoid confusion, stating the formula for the examples, as well as correcting formula's descriptions, would be great.\r\nIf, of course, the above is correct :) ","closed_by":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/207/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/207/timeline","performed_via_github_app":null,"state_reason":"completed"}