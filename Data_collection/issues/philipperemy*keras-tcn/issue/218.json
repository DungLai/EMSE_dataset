{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/218","repository_url":"https://api.github.com/repos/philipperemy/keras-tcn","labels_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/218/labels{/name}","comments_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/218/comments","events_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/218/events","html_url":"https://github.com/philipperemy/keras-tcn/issues/218","id":964803995,"node_id":"MDU6SXNzdWU5NjQ4MDM5OTU=","number":218,"title":"Possible bug in use_skip_connections","user":{"login":"LiamRMoore","id":32279503,"node_id":"MDQ6VXNlcjMyMjc5NTAz","avatar_url":"https://avatars.githubusercontent.com/u/32279503?v=4","gravatar_id":"","url":"https://api.github.com/users/LiamRMoore","html_url":"https://github.com/LiamRMoore","followers_url":"https://api.github.com/users/LiamRMoore/followers","following_url":"https://api.github.com/users/LiamRMoore/following{/other_user}","gists_url":"https://api.github.com/users/LiamRMoore/gists{/gist_id}","starred_url":"https://api.github.com/users/LiamRMoore/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LiamRMoore/subscriptions","organizations_url":"https://api.github.com/users/LiamRMoore/orgs","repos_url":"https://api.github.com/users/LiamRMoore/repos","events_url":"https://api.github.com/users/LiamRMoore/events{/privacy}","received_events_url":"https://api.github.com/users/LiamRMoore/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2021-08-10T09:58:11Z","updated_at":"2022-01-21T09:27:22Z","closed_at":"2022-01-21T09:27:21Z","author_association":"NONE","active_lock_reason":null,"body":"Hey folks,\r\n\r\nI've been playing around a bit with the TCN model class and just wanted to check with you whether there is an issue in the way that the skip connections are included.\r\n\r\nThe residual block returns two outputs:\r\n\r\nhttps://github.com/philipperemy/keras-tcn/blob/2483cd99da5c97cda9763cb9d61baba56436e172/tcn/tcn.py#L151-L156\r\n\r\nhttps://github.com/philipperemy/keras-tcn/blob/2483cd99da5c97cda9763cb9d61baba56436e172/tcn/tcn.py#L157-L164\r\n\r\nThese are **respectively** the channel-matched input + the output of the convolutional layers (the typical output of block with a skip connection), and the output of the convolutional layers alone. In my mind then this first output (input + \"residual\") is what the network should use when `use_skip_connections` is flagged on, and the second is what should be used when it's flagged off.\r\n\r\nLater on when the TCN outputs are built from the residual blocks, these outputs are assigned to the variables `x` and `skip_out` respectively, and I think this may be the wrong way round?\r\n\r\nhttps://github.com/philipperemy/keras-tcn/blob/2483cd99da5c97cda9763cb9d61baba56436e172/tcn/tcn.py#L316-L320\r\n\r\nhttps://github.com/philipperemy/keras-tcn/blob/2483cd99da5c97cda9763cb9d61baba56436e172/tcn/tcn.py#L323-L324\r\n\r\nSpecifically, when `use_skip_connections` is **on**, the TCN outputs the sum of those second outputs (somewhat confusingly named ``skip_out``) - the conv block outputs themselves, without adding the inputs back. \r\n","closed_by":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/218/timeline","performed_via_github_app":null,"state_reason":"completed"}