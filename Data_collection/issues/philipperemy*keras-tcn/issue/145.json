{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/145","repository_url":"https://api.github.com/repos/philipperemy/keras-tcn","labels_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/145/labels{/name}","comments_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/145/comments","events_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/145/events","html_url":"https://github.com/philipperemy/keras-tcn/issues/145","id":632835386,"node_id":"MDU6SXNzdWU2MzI4MzUzODY=","number":145,"title":"Getting bad TCN performance","user":{"login":"bjourne","id":142475,"node_id":"MDQ6VXNlcjE0MjQ3NQ==","avatar_url":"https://avatars.githubusercontent.com/u/142475?v=4","gravatar_id":"","url":"https://api.github.com/users/bjourne","html_url":"https://github.com/bjourne","followers_url":"https://api.github.com/users/bjourne/followers","following_url":"https://api.github.com/users/bjourne/following{/other_user}","gists_url":"https://api.github.com/users/bjourne/gists{/gist_id}","starred_url":"https://api.github.com/users/bjourne/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bjourne/subscriptions","organizations_url":"https://api.github.com/users/bjourne/orgs","repos_url":"https://api.github.com/users/bjourne/repos","events_url":"https://api.github.com/users/bjourne/events{/privacy}","received_events_url":"https://api.github.com/users/bjourne/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-06-07T00:02:13Z","updated_at":"2021-02-16T09:39:56Z","closed_at":"2021-02-16T09:39:56Z","author_association":"NONE","active_lock_reason":null,"body":"Hi. I'm using your TCN for sequence prediction and I'm getting quite bad results in comparison to an LSTM. Maybe I'm doing something wrong or maybe there is a bug?\r\n\r\nI'm comparing the units using:\r\n\r\n    from tcn import TCN\r\n    from tensorflow.keras import *\r\n    from tensorflow.keras.layers import *\r\n    from tensorflow.keras.optimizers import *\r\n    import numpy as np\r\n\r\n    SEQ_LEN = 64\r\n    text = open('shakespeare.txt').read()\r\n    ch2ix = {ch : i for i, ch in enumerate(sorted(set(text)))}\r\n    X = np.array([[ch2ix[ch] for ch in text[i - SEQ_LEN:i]]\r\n                  for i in range(SEQ_LEN, len(text))])\r\n    Y = np.array([ch2ix[text[i]] for i in range(SEQ_LEN, len(text))])\r\n\r\n    model = Sequential([\r\n        Embedding(len(ch2ix), 32, input_shape = (SEQ_LEN,)),\r\n        LSTM(128),\r\n        # TCN(nb_filters = 64,\r\n        #     kernel_size = 2,\r\n        #     nb_stacks = 2,\r\n        #     dilations = [1, 2, 4, 8]),\r\n        Dense(len(ch2ix), activation = 'softmax')])\r\n    opt = RMSprop(learning_rate = 0.005)\r\n    model.compile(\r\n        optimizer = opt,\r\n        loss = 'sparse_categorical_crossentropy',\r\n        metrics = ['sparse_categorical_accuracy'])\r\n    model.fit(X, Y, epochs = 10, verbose = 1, batch_size = 32)\r\n\r\nThe number of parameters for the models are 113k for the TCN and 93k for the LSTM. After one epoch which takes the LSTM 216 seconds the loss is 1.81. For the TCN it is 2.31 and takes 339 seconds. \"shakespeare.txt\" is 1.1m text file containing Shakespeare plays.\r\n","closed_by":{"login":"philipperemy","id":4516927,"node_id":"MDQ6VXNlcjQ1MTY5Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/4516927?v=4","gravatar_id":"","url":"https://api.github.com/users/philipperemy","html_url":"https://github.com/philipperemy","followers_url":"https://api.github.com/users/philipperemy/followers","following_url":"https://api.github.com/users/philipperemy/following{/other_user}","gists_url":"https://api.github.com/users/philipperemy/gists{/gist_id}","starred_url":"https://api.github.com/users/philipperemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philipperemy/subscriptions","organizations_url":"https://api.github.com/users/philipperemy/orgs","repos_url":"https://api.github.com/users/philipperemy/repos","events_url":"https://api.github.com/users/philipperemy/events{/privacy}","received_events_url":"https://api.github.com/users/philipperemy/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/145/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/philipperemy/keras-tcn/issues/145/timeline","performed_via_github_app":null,"state_reason":"completed"}