{"url":"https://api.github.com/repos/BeamNG/BeamNGpy/issues/140","repository_url":"https://api.github.com/repos/BeamNG/BeamNGpy","labels_url":"https://api.github.com/repos/BeamNG/BeamNGpy/issues/140/labels{/name}","comments_url":"https://api.github.com/repos/BeamNG/BeamNGpy/issues/140/comments","events_url":"https://api.github.com/repos/BeamNG/BeamNGpy/issues/140/events","html_url":"https://github.com/BeamNG/BeamNGpy/issues/140","id":957685188,"node_id":"MDU6SXNzdWU5NTc2ODUxODg=","number":140,"title":"Camera sensor position drifts while driving","user":{"login":"hildebrandt-carl","id":26097148,"node_id":"MDQ6VXNlcjI2MDk3MTQ4","avatar_url":"https://avatars.githubusercontent.com/u/26097148?v=4","gravatar_id":"","url":"https://api.github.com/users/hildebrandt-carl","html_url":"https://github.com/hildebrandt-carl","followers_url":"https://api.github.com/users/hildebrandt-carl/followers","following_url":"https://api.github.com/users/hildebrandt-carl/following{/other_user}","gists_url":"https://api.github.com/users/hildebrandt-carl/gists{/gist_id}","starred_url":"https://api.github.com/users/hildebrandt-carl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hildebrandt-carl/subscriptions","organizations_url":"https://api.github.com/users/hildebrandt-carl/orgs","repos_url":"https://api.github.com/users/hildebrandt-carl/repos","events_url":"https://api.github.com/users/hildebrandt-carl/events{/privacy}","received_events_url":"https://api.github.com/users/hildebrandt-carl/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"Palculator","id":37553150,"node_id":"MDQ6VXNlcjM3NTUzMTUw","avatar_url":"https://avatars.githubusercontent.com/u/37553150?v=4","gravatar_id":"","url":"https://api.github.com/users/Palculator","html_url":"https://github.com/Palculator","followers_url":"https://api.github.com/users/Palculator/followers","following_url":"https://api.github.com/users/Palculator/following{/other_user}","gists_url":"https://api.github.com/users/Palculator/gists{/gist_id}","starred_url":"https://api.github.com/users/Palculator/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Palculator/subscriptions","organizations_url":"https://api.github.com/users/Palculator/orgs","repos_url":"https://api.github.com/users/Palculator/repos","events_url":"https://api.github.com/users/Palculator/events{/privacy}","received_events_url":"https://api.github.com/users/Palculator/received_events","type":"User","site_admin":false},"assignees":[{"login":"Palculator","id":37553150,"node_id":"MDQ6VXNlcjM3NTUzMTUw","avatar_url":"https://avatars.githubusercontent.com/u/37553150?v=4","gravatar_id":"","url":"https://api.github.com/users/Palculator","html_url":"https://github.com/Palculator","followers_url":"https://api.github.com/users/Palculator/followers","following_url":"https://api.github.com/users/Palculator/following{/other_user}","gists_url":"https://api.github.com/users/Palculator/gists{/gist_id}","starred_url":"https://api.github.com/users/Palculator/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Palculator/subscriptions","organizations_url":"https://api.github.com/users/Palculator/orgs","repos_url":"https://api.github.com/users/Palculator/repos","events_url":"https://api.github.com/users/Palculator/events{/privacy}","received_events_url":"https://api.github.com/users/Palculator/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2021-08-02T02:41:13Z","updated_at":"2021-08-05T14:11:28Z","closed_at":"2021-08-05T14:11:28Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\r\n\r\nI was trying to attach a camera to the vehicle and then drive it around while recording the camera data. I attached the camera inside the car using:\r\n```python\r\ncam = Camera(pos=(0, 0, 1), direction=(0, 1, 0), fov=60, resolution=(512, 512))\r\nego_vehicle.attach_sensor('cam', cam)\r\n```\r\n\r\nHowever I notice as soon as I start driving the camera's position starts drifting as shown below [note this is 5x playback]:\r\n![drift](https://user-images.githubusercontent.com/26097148/127797295-8c572de9-ebbc-4cc2-b372-028ac2ff22b9.gif)\r\n\r\nYou can replicate this behavior using the python script below. Note you will need to change the `home` parameter in the `BeamNGpy`.\r\n```python\r\nimport numpy as np\r\nimport matplotlib.pyplot as plt\r\n\r\nfrom time import sleep\r\nfrom beamngpy.sensors import Camera\r\nfrom beamngpy import BeamNGpy, Scenario, Vehicle\r\n\r\ndef plot_cam(plt, view):\r\n    overhead_ax = plt.gca()\r\n    view = view.convert('RGB') \r\n    overhead_ax.imshow(np.asarray(view))\r\n    overhead_ax.set_aspect('equal', 'datalim')\r\n\r\ndef main():\r\n    beamng = BeamNGpy('localhost', 64256, home='BeamNG.tech.v0.21.3.0')\r\n    bng = beamng.open(launch=True)\r\n\r\n    # Create a scenario in west_coast_usa\r\n    scenario = Scenario(\"smallgrid\", 'tech_test', description='Random driving for research')\r\n\r\n    # https://documentation.beamng.com/vehicle_system/vehicles/index.html\r\n    ego_vehicle = Vehicle('ego_vehicle', model='etk800', licence='Carlos', color='White')\r\n\r\n    # Create sensors\r\n    cam = Camera(pos=(0, 0, 1), direction=(0, 1, 0), fov=60, resolution=(512, 512))\r\n    ego_vehicle.attach_sensor('cam', cam)\r\n\r\n    # Add the vehicle\r\n    scenario.add_vehicle(ego_vehicle)\r\n\r\n    # Add traffic vehicles\r\n    target_vehicle = Vehicle('target_vehicle', model='etk800', licence='Traffic', color='Red')\r\n    scenario.add_vehicle(target_vehicle, pos=(0, -10, 0))\r\n\r\n    # Create the cam view\r\n    plt.figure(1, figsize=(3, 3))\r\n\r\n    # Try and start beamng\r\n    try:\r\n        # Compile the scenario and place it in BeamNG's map folder\r\n        scenario.make(bng)\r\n\r\n        # bng.hide_hud()\r\n        bng.set_deterministic()  # Set simulator to be deterministic\r\n        bng.set_steps_per_second(60)  # With 60hz temporal resolution\r\n\r\n        # Load and start the scenario\r\n        bng.load_scenario(scenario)\r\n        bng.start_scenario()\r\n\r\n        # Make sure we are following the ego vehicle\r\n        bng.switch_vehicle(ego_vehicle)\r\n\r\n        sensor_rate = 4 #Hz\r\n        sensor_timing = 1.0 / sensor_rate\r\n        time_counter = 0\r\n\r\n        while time_counter <= 100:\r\n            # Set this loop to a set frequency\r\n            sleep(sensor_timing)\r\n            time_counter += sensor_timing\r\n\r\n            # Retrieve sensor data and show the camera data.\r\n            ego_vehicle.poll_sensors()\r\n            sensors = ego_vehicle.sensors\r\n            view = sensors['cam'].data[\"colour\"]\r\n\r\n            # Plot the cam view\r\n            plot_cam(plt, view)\r\n\r\n            # Drive the car automatically (throttle between 0;1 / steering between -1;1)\r\n            ego_vehicle.control(throttle=1, steering=0)\r\n            target_vehicle.control(throttle=1, steering=0)\r\n\r\n            # Draw the plot\r\n            plt.draw()\r\n            plt.pause(0.001)\r\n\r\n    finally:\r\n        bng.close()\r\n\r\nif __name__ == '__main__':\r\n    main()\r\n```\r\n\r\nCarl","closed_by":{"login":"hildebrandt-carl","id":26097148,"node_id":"MDQ6VXNlcjI2MDk3MTQ4","avatar_url":"https://avatars.githubusercontent.com/u/26097148?v=4","gravatar_id":"","url":"https://api.github.com/users/hildebrandt-carl","html_url":"https://github.com/hildebrandt-carl","followers_url":"https://api.github.com/users/hildebrandt-carl/followers","following_url":"https://api.github.com/users/hildebrandt-carl/following{/other_user}","gists_url":"https://api.github.com/users/hildebrandt-carl/gists{/gist_id}","starred_url":"https://api.github.com/users/hildebrandt-carl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hildebrandt-carl/subscriptions","organizations_url":"https://api.github.com/users/hildebrandt-carl/orgs","repos_url":"https://api.github.com/users/hildebrandt-carl/repos","events_url":"https://api.github.com/users/hildebrandt-carl/events{/privacy}","received_events_url":"https://api.github.com/users/hildebrandt-carl/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/BeamNG/BeamNGpy/issues/140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/BeamNG/BeamNGpy/issues/140/timeline","performed_via_github_app":null,"state_reason":"completed"}