{"url":"https://api.github.com/repos/BeamNG/BeamNGpy/issues/102","repository_url":"https://api.github.com/repos/BeamNG/BeamNGpy","labels_url":"https://api.github.com/repos/BeamNG/BeamNGpy/issues/102/labels{/name}","comments_url":"https://api.github.com/repos/BeamNG/BeamNGpy/issues/102/comments","events_url":"https://api.github.com/repos/BeamNG/BeamNGpy/issues/102/events","html_url":"https://github.com/BeamNG/BeamNGpy/issues/102","id":802548010,"node_id":"MDU6SXNzdWU4MDI1NDgwMTA=","number":102,"title":"Pixel-Depth Scaling Incorrect","user":{"login":"BleedObsidian","id":2222870,"node_id":"MDQ6VXNlcjIyMjI4NzA=","avatar_url":"https://avatars.githubusercontent.com/u/2222870?v=4","gravatar_id":"","url":"https://api.github.com/users/BleedObsidian","html_url":"https://github.com/BleedObsidian","followers_url":"https://api.github.com/users/BleedObsidian/followers","following_url":"https://api.github.com/users/BleedObsidian/following{/other_user}","gists_url":"https://api.github.com/users/BleedObsidian/gists{/gist_id}","starred_url":"https://api.github.com/users/BleedObsidian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BleedObsidian/subscriptions","organizations_url":"https://api.github.com/users/BleedObsidian/orgs","repos_url":"https://api.github.com/users/BleedObsidian/repos","events_url":"https://api.github.com/users/BleedObsidian/events{/privacy}","received_events_url":"https://api.github.com/users/BleedObsidian/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"pascale-commits","id":69152944,"node_id":"MDQ6VXNlcjY5MTUyOTQ0","avatar_url":"https://avatars.githubusercontent.com/u/69152944?v=4","gravatar_id":"","url":"https://api.github.com/users/pascale-commits","html_url":"https://github.com/pascale-commits","followers_url":"https://api.github.com/users/pascale-commits/followers","following_url":"https://api.github.com/users/pascale-commits/following{/other_user}","gists_url":"https://api.github.com/users/pascale-commits/gists{/gist_id}","starred_url":"https://api.github.com/users/pascale-commits/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pascale-commits/subscriptions","organizations_url":"https://api.github.com/users/pascale-commits/orgs","repos_url":"https://api.github.com/users/pascale-commits/repos","events_url":"https://api.github.com/users/pascale-commits/events{/privacy}","received_events_url":"https://api.github.com/users/pascale-commits/received_events","type":"User","site_admin":false},"assignees":[{"login":"pascale-commits","id":69152944,"node_id":"MDQ6VXNlcjY5MTUyOTQ0","avatar_url":"https://avatars.githubusercontent.com/u/69152944?v=4","gravatar_id":"","url":"https://api.github.com/users/pascale-commits","html_url":"https://github.com/pascale-commits","followers_url":"https://api.github.com/users/pascale-commits/followers","following_url":"https://api.github.com/users/pascale-commits/following{/other_user}","gists_url":"https://api.github.com/users/pascale-commits/gists{/gist_id}","starred_url":"https://api.github.com/users/pascale-commits/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pascale-commits/subscriptions","organizations_url":"https://api.github.com/users/pascale-commits/orgs","repos_url":"https://api.github.com/users/pascale-commits/repos","events_url":"https://api.github.com/users/pascale-commits/events{/privacy}","received_events_url":"https://api.github.com/users/pascale-commits/received_events","type":"User","site_admin":false}],"milestone":null,"comments":11,"created_at":"2021-02-05T23:53:45Z","updated_at":"2021-03-10T13:59:13Z","closed_at":"2021-03-10T13:59:13Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I believe the calculation for the pixel-depth of the Camera sensor to be incorrect. Please see the below two images:\r\n\r\n![image](https://user-images.githubusercontent.com/2222870/107100237-a8272a00-680b-11eb-844e-8739deb3cb47.png)\r\n\r\nAs you can see, the image on the left is using the default `near_far=(0.01, 1000)` during Camera initialisation. However this image is completely useless for vehicle navigation because all objects close to the car for a significant distance, such as bushes, have a lightness value of 0. So, I have reduced the Camera on the right's `near_far=(0.01, 100)`, expecting that objects at a distance of 100 to have a lightness value of 255 and objects at 0.01 to have a lightness value of 0. This should result in objects closer to the vehicle having a much more fine and resolved lightness scale. As you can see this is not the case.\r\n\r\nThe lightness values are not scaling whatsoever with the `near_far` setting of the camera. The image on the right shows that all objects within range of the cameras `near_far` clipping range, have the exact same lightness values as the image on the left. The only difference is the sky appearing darker because it is clipped at a shorter distance. I am almost certain this is not correct behaviour?\r\n\r\n![image](https://user-images.githubusercontent.com/2222870/107100678-04d71480-680d-11eb-88e3-926ab145b68c.png)\r\n\r\nI believe the above code located in the [Camera](https://beamngpy.readthedocs.io/en/latest/_modules/beamngpy/sensors.html#Camera) class in the `decode_response` method is maybe the culprit. \r\n\r\nIf indeed this is normal behaviour, how can I go about making objects closer to the vehicle have a finer resolution of depth? Because these depth images are completely useless to me.\r\n\r\n# Reproducing\r\n\r\nTo reproduce this behaviour, simply attach a [Camera](https://beamngpy.readthedocs.io/en/latest/api/beamngpy.html#beamngpy.sensors.Camera) to a vehicle and adjust the near_far setting:\r\n\r\n![image](https://user-images.githubusercontent.com/2222870/107101484-65675100-680f-11eb-9bf3-20aa742b1ada.png)\r\n\r\n![image](https://user-images.githubusercontent.com/2222870/107101491-69936e80-680f-11eb-8505-0ba17b328b85.png)\r\n\r\nIf the lightness values are scaled correctly, i would expect the sky to always remain white (lightness 255).","closed_by":{"login":"pascale-commits","id":69152944,"node_id":"MDQ6VXNlcjY5MTUyOTQ0","avatar_url":"https://avatars.githubusercontent.com/u/69152944?v=4","gravatar_id":"","url":"https://api.github.com/users/pascale-commits","html_url":"https://github.com/pascale-commits","followers_url":"https://api.github.com/users/pascale-commits/followers","following_url":"https://api.github.com/users/pascale-commits/following{/other_user}","gists_url":"https://api.github.com/users/pascale-commits/gists{/gist_id}","starred_url":"https://api.github.com/users/pascale-commits/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pascale-commits/subscriptions","organizations_url":"https://api.github.com/users/pascale-commits/orgs","repos_url":"https://api.github.com/users/pascale-commits/repos","events_url":"https://api.github.com/users/pascale-commits/events{/privacy}","received_events_url":"https://api.github.com/users/pascale-commits/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/BeamNG/BeamNGpy/issues/102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/BeamNG/BeamNGpy/issues/102/timeline","performed_via_github_app":null,"state_reason":"completed"}