{"url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/470","repository_url":"https://api.github.com/repos/hudson-and-thames/mlfinlab","labels_url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/470/labels{/name}","comments_url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/470/comments","events_url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/470/events","html_url":"https://github.com/hudson-and-thames/mlfinlab/issues/470","id":742475935,"node_id":"MDU6SXNzdWU3NDI0NzU5MzU=","number":470,"title":"Help: ou_model cannot find root out-of-sample","user":{"login":"kingwongf","id":36856182,"node_id":"MDQ6VXNlcjM2ODU2MTgy","avatar_url":"https://avatars.githubusercontent.com/u/36856182?v=4","gravatar_id":"","url":"https://api.github.com/users/kingwongf","html_url":"https://github.com/kingwongf","followers_url":"https://api.github.com/users/kingwongf/followers","following_url":"https://api.github.com/users/kingwongf/following{/other_user}","gists_url":"https://api.github.com/users/kingwongf/gists{/gist_id}","starred_url":"https://api.github.com/users/kingwongf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingwongf/subscriptions","organizations_url":"https://api.github.com/users/kingwongf/orgs","repos_url":"https://api.github.com/users/kingwongf/repos","events_url":"https://api.github.com/users/kingwongf/events{/privacy}","received_events_url":"https://api.github.com/users/kingwongf/received_events","type":"User","site_admin":false},"labels":[{"id":1232033405,"node_id":"MDU6TGFiZWwxMjMyMDMzNDA1","url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":{"login":"vlrie","id":30659485,"node_id":"MDQ6VXNlcjMwNjU5NDg1","avatar_url":"https://avatars.githubusercontent.com/u/30659485?v=4","gravatar_id":"","url":"https://api.github.com/users/vlrie","html_url":"https://github.com/vlrie","followers_url":"https://api.github.com/users/vlrie/followers","following_url":"https://api.github.com/users/vlrie/following{/other_user}","gists_url":"https://api.github.com/users/vlrie/gists{/gist_id}","starred_url":"https://api.github.com/users/vlrie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vlrie/subscriptions","organizations_url":"https://api.github.com/users/vlrie/orgs","repos_url":"https://api.github.com/users/vlrie/repos","events_url":"https://api.github.com/users/vlrie/events{/privacy}","received_events_url":"https://api.github.com/users/vlrie/received_events","type":"User","site_admin":false},"assignees":[{"login":"vlrie","id":30659485,"node_id":"MDQ6VXNlcjMwNjU5NDg1","avatar_url":"https://avatars.githubusercontent.com/u/30659485?v=4","gravatar_id":"","url":"https://api.github.com/users/vlrie","html_url":"https://github.com/vlrie","followers_url":"https://api.github.com/users/vlrie/followers","following_url":"https://api.github.com/users/vlrie/following{/other_user}","gists_url":"https://api.github.com/users/vlrie/gists{/gist_id}","starred_url":"https://api.github.com/users/vlrie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vlrie/subscriptions","organizations_url":"https://api.github.com/users/vlrie/orgs","repos_url":"https://api.github.com/users/vlrie/repos","events_url":"https://api.github.com/users/vlrie/events{/privacy}","received_events_url":"https://api.github.com/users/vlrie/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2020-11-13T14:10:00Z","updated_at":"2020-11-19T15:24:04Z","closed_at":"2020-11-19T15:24:04Z","author_association":"NONE","active_lock_reason":null,"body":"Hi @PanPip \r\nI tried to run this \r\n`fig = ou_model.plot_levels(mid_prices[['BTC-GBP','ETH-GBP']]['2020-11-13 08:05:02':], stop_loss=True)`\r\n\r\nGot this error\r\n\r\n```/Users/kingf.wong/.conda/envs/FinanceML/lib/python3.7/site-packages/mlfinlab/optimal_mean_reversion/ou_model.py:541: IntegrationWarning: Extremely bad integrand behavior occurs at some points of the\r\n  integration interval.\r\n  calculated_f = quad(f_func, 0, np.inf)[0]\r\n/Users/kingf.wong/.conda/envs/FinanceML/lib/python3.7/site-packages/mlfinlab/optimal_mean_reversion/ou_model.py:541: IntegrationWarning: Extremely bad integrand behavior occurs at some points of the\r\n  integration interval.\r\n  calculated_f = quad(f_func, 0, np.inf)[0]\r\n/Users/kingf.wong/.conda/envs/FinanceML/lib/python3.7/site-packages/mlfinlab/optimal_mean_reversion/ou_model.py:541: IntegrationWarning: Extremely bad integrand behavior occurs at some points of the\r\n  integration interval.\r\n  calculated_f = quad(f_func, 0, np.inf)[0]\r\n/Users/kingf.wong/.conda/envs/FinanceML/lib/python3.7/site-packages/mlfinlab/optimal_mean_reversion/ou_model.py:541: IntegrationWarning: The maximum number of subdivisions (50) has been achieved.\r\n  If increasing the limit yields no improvement it is advised to analyze \r\n  the integrand in order to determine the difficulties.  If the position of a \r\n  local difficulty can be determined (singularity, discontinuity) one will \r\n  probably gain from splitting up the interval and calling the integrator \r\n  on the subranges.  Perhaps a special-purpose integrator should be used.\r\n  calculated_f = quad(f_func, 0, np.inf)[0]\r\n/Users/kingf.wong/.conda/envs/FinanceML/lib/python3.7/site-packages/mlfinlab/optimal_mean_reversion/ou_model.py:541: IntegrationWarning: The maximum number of subdivisions (50) has been achieved.\r\n  If increasing the limit yields no improvement it is advised to analyze \r\n  the integrand in order to determine the difficulties.  If the position of a \r\n  local difficulty can be determined (singularity, discontinuity) one will \r\n  probably gain from splitting up the interval and calling the integrator \r\n  on the subranges.  Perhaps a special-purpose integrator should be used.\r\n  calculated_f = quad(f_func, 0, np.inf)[0]\r\n/Users/kingf.wong/.conda/envs/FinanceML/lib/python3.7/site-packages/mlfinlab/optimal_mean_reversion/ou_model.py:541: IntegrationWarning: The maximum number of subdivisions (50) has been achieved.\r\n  If increasing the limit yields no improvement it is advised to analyze \r\n  the integrand in order to determine the difficulties.  If the position of a \r\n  local difficulty can be determined (singularity, discontinuity) one will \r\n  probably gain from splitting up the interval and calling the integrator \r\n  on the subranges.  Perhaps a special-purpose integrator should be used.\r\n  calculated_f = quad(f_func, 0, np.inf)[0]\r\nTraceback (most recent call last):\r\n  File \"/Users/kingf.wong/.conda/envs/FinanceML/lib/python3.7/site-packages/IPython/core/interactiveshell.py\", line 3326, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-13-9f99eb8b8da9>\", line 7, in <module>\r\n    fig = ou_model.plot_levels(mid_prices[['BTC-GBP','ETH-GBP']]['2020-11-13 08:05:02':], stop_loss=True)\r\n  File \"/Users/kingf.wong/.conda/envs/FinanceML/lib/python3.7/site-packages/mlfinlab/optimal_mean_reversion/ou_model.py\", line 488, in plot_levels\r\n    graph[0].axhline(self.optimal_liquidation_level(), label=\"optimal liquidation level\",\r\n  File \"/Users/kingf.wong/.conda/envs/FinanceML/lib/python3.7/site-packages/mlfinlab/optimal_mean_reversion/ou_model.py\", line 650, in optimal_liquidation_level\r\n    sol = root_scalar(equation, bracket=bracket)\r\n  File \"/Users/kingf.wong/.conda/envs/FinanceML/lib/python3.7/site-packages/scipy/optimize/_root_scalar.py\", line 249, in root_scalar\r\n    r, sol = methodc(f, a, b, args=args, **kwargs)\r\n  File \"/Users/kingf.wong/.conda/envs/FinanceML/lib/python3.7/site-packages/scipy/optimize/zeros.py\", line 780, in brentq\r\n    r = _zeros._brentq(f, a, b, xtol, rtol, maxiter, args, full_output, disp)\r\nValueError: f(a) and f(b) must have different signs\r\n```\r\n\r\n`ou_model.description()` returns the same error. It seems there's a problem in integration and root finding. Does that mean the model cannot find an entry or exit point? \r\nMany thanks!","closed_by":{"login":"kingwongf","id":36856182,"node_id":"MDQ6VXNlcjM2ODU2MTgy","avatar_url":"https://avatars.githubusercontent.com/u/36856182?v=4","gravatar_id":"","url":"https://api.github.com/users/kingwongf","html_url":"https://github.com/kingwongf","followers_url":"https://api.github.com/users/kingwongf/followers","following_url":"https://api.github.com/users/kingwongf/following{/other_user}","gists_url":"https://api.github.com/users/kingwongf/gists{/gist_id}","starred_url":"https://api.github.com/users/kingwongf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingwongf/subscriptions","organizations_url":"https://api.github.com/users/kingwongf/orgs","repos_url":"https://api.github.com/users/kingwongf/repos","events_url":"https://api.github.com/users/kingwongf/events{/privacy}","received_events_url":"https://api.github.com/users/kingwongf/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/470/timeline","performed_via_github_app":null,"state_reason":"completed"}