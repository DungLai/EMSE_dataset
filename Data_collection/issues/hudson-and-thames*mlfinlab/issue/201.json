{"url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/201","repository_url":"https://api.github.com/repos/hudson-and-thames/mlfinlab","labels_url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/201/labels{/name}","comments_url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/201/comments","events_url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/201/events","html_url":"https://github.com/hudson-and-thames/mlfinlab/issues/201","id":567603610,"node_id":"MDU6SXNzdWU1Njc2MDM2MTA=","number":201,"title":"Function barrier_touched compares log returns (ret) to normal returns (target)?","user":{"login":"quoctuams","id":15074019,"node_id":"MDQ6VXNlcjE1MDc0MDE5","avatar_url":"https://avatars.githubusercontent.com/u/15074019?v=4","gravatar_id":"","url":"https://api.github.com/users/quoctuams","html_url":"https://github.com/quoctuams","followers_url":"https://api.github.com/users/quoctuams/followers","following_url":"https://api.github.com/users/quoctuams/following{/other_user}","gists_url":"https://api.github.com/users/quoctuams/gists{/gist_id}","starred_url":"https://api.github.com/users/quoctuams/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/quoctuams/subscriptions","organizations_url":"https://api.github.com/users/quoctuams/orgs","repos_url":"https://api.github.com/users/quoctuams/repos","events_url":"https://api.github.com/users/quoctuams/events{/privacy}","received_events_url":"https://api.github.com/users/quoctuams/received_events","type":"User","site_admin":false},"labels":[{"id":1232033387,"node_id":"MDU6TGFiZWwxMjMyMDMzMzg3","url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2020-02-19T14:21:25Z","updated_at":"2020-03-28T19:55:47Z","closed_at":"2020-03-28T19:55:47Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nThe output of `ml.labeling.get_bins` sometimes show bin = 0 eventhough ret > trgt.\r\nLooking at the function `labeling.barrier_touched`, I noticed that the param `out_df['ret']` is the log return calculated in get_bins, and that param is compared with target to compute the bins:\r\n```\r\npt_level_reached = ret > target * events.loc[date_time, 'pt']\r\nsl_level_reached = ret < -target * events.loc[date_time, 'sl']\r\n```\r\nThe target is usually a multipler of daily volatility, as shown in the book, and it is calculated using normal returns. \r\nSo is the comparison above intended? Should the target be calculated using log return instead?\r\n\r\nThe `out_df['ret']` later is transformed back to normal return and shown along the `trgt` as result of `get_bins` function. If the `trgt` is intended to be log then there is no need to transform the `ret` to be normal returns. \r\n\r\nThanks,\r\n","closed_by":{"login":"Jackal08","id":6911714,"node_id":"MDQ6VXNlcjY5MTE3MTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6911714?v=4","gravatar_id":"","url":"https://api.github.com/users/Jackal08","html_url":"https://github.com/Jackal08","followers_url":"https://api.github.com/users/Jackal08/followers","following_url":"https://api.github.com/users/Jackal08/following{/other_user}","gists_url":"https://api.github.com/users/Jackal08/gists{/gist_id}","starred_url":"https://api.github.com/users/Jackal08/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jackal08/subscriptions","organizations_url":"https://api.github.com/users/Jackal08/orgs","repos_url":"https://api.github.com/users/Jackal08/repos","events_url":"https://api.github.com/users/Jackal08/events{/privacy}","received_events_url":"https://api.github.com/users/Jackal08/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/201/timeline","performed_via_github_app":null,"state_reason":"completed"}