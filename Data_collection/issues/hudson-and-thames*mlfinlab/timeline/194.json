[{"url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/comments/586620582","html_url":"https://github.com/hudson-and-thames/mlfinlab/issues/194#issuecomment-586620582","issue_url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/194","id":586620582,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NjYyMDU4Mg==","user":{"login":"rspadim","id":2468782,"node_id":"MDQ6VXNlcjI0Njg3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/2468782?v=4","gravatar_id":"","url":"https://api.github.com/users/rspadim","html_url":"https://github.com/rspadim","followers_url":"https://api.github.com/users/rspadim/followers","following_url":"https://api.github.com/users/rspadim/following{/other_user}","gists_url":"https://api.github.com/users/rspadim/gists{/gist_id}","starred_url":"https://api.github.com/users/rspadim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rspadim/subscriptions","organizations_url":"https://api.github.com/users/rspadim/orgs","repos_url":"https://api.github.com/users/rspadim/repos","events_url":"https://api.github.com/users/rspadim/events{/privacy}","received_events_url":"https://api.github.com/users/rspadim/received_events","type":"User","site_admin":false},"created_at":"2020-02-15T17:05:11Z","updated_at":"2020-02-15T17:05:11Z","author_association":"NONE","body":"example solution:\r\n\r\n```\r\nimport scipy.stats as ss\r\nfrom sklearn.metrics import mutual_info_score\r\n\r\ndef get_optimal_number_of_bins(num_obs: int, corr_coef: float = None) -> int:\r\n    \"\"\"\r\n    Get optimal number of bins for discretization based on number of observations\r\n    and correlation coefficient (univariate case).\r\n    The algorithm is described in https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3512994&download=yes (p.26)\r\n\r\n    :param num_obs: (int) number of observations.\r\n    :param corr_coef: (int) correlation coefficient, used to estimate the number of bins for univariate case.\r\n    :return: (int) optimal number of bins.\r\n    \"\"\"\r\n    if corr_coef is None or abs(corr_coef - 1) <= 1e-4:  # Univariate case\r\n        z = (8 + 324 * num_obs + 12 * (36 * num_obs + 729 * num_obs ** 2) ** .5) ** (1 / 3.)\r\n        bins = round(z / 6. + 2. / (3 * z) + 1. / 3)\r\n\r\n    # Bivariate case\r\n    else:\r\n        bins = round(2 ** -.5 * (1 + (1 + 24 * num_obs / (1. - corr_coef ** 2)) ** .5) ** .5)\r\n    return int(bins)\r\n\r\n\r\ndef get_mutual_info(x: np.array, y: np.array, n_bins: int = None, normalize: bool = False) -> float:\r\n    def _corr(A,B):\r\n        import numpy.ma as ma\r\n        return ma.corrcoef(ma.masked_invalid(A), ma.masked_invalid(B))\r\n    \r\n    \"\"\"\r\n    Get mutual info score for x and y described in\r\n    https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3512994&download=yes (p.16).\r\n\r\n    :param x: (np.array) x vector\r\n    :param y: (np.array) y vector\r\n    :param n_bins: (int) number of bins for discretization, if None get number of bins based on correlation coefficient.\r\n    :param normalize: (bool) True to normalize the result to [0, 1].\r\n    :return: (float) mutual info score.\r\n    \"\"\"\r\n    bad_indices = np.isnan(x) | np.isnan(y) | np.isinf(x) | np.isinf(y)\r\n    good_indices = ~bad_indices\r\n\r\n    if n_bins is None:\r\n        corr_coef = _corr(x, y)[0][1]\r\n        n_bins = get_optimal_number_of_bins(x[good_indices].shape[0], corr_coef=corr_coef)\r\n    \r\n    contingency = np.histogram2d(\r\n        x[good_indices], \r\n        y[good_indices], \r\n        n_bins)[0]\r\n    mutual_info = mutual_info_score(None, None, contingency=contingency)  # Mutual information\r\n    if normalize is True:\r\n        marginal_x = ss.entropy(np.histogram(x[good_indices], n_bins)[0])  # Marginal for x\r\n        marginal_y = ss.entropy(np.histogram(y[good_indices], n_bins)[0])  # Marginal for y\r\n        mutual_info /= min(marginal_x, marginal_y)\r\n    return mutual_info\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/comments/586620582/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rspadim","id":2468782,"node_id":"MDQ6VXNlcjI0Njg3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/2468782?v=4","gravatar_id":"","url":"https://api.github.com/users/rspadim","html_url":"https://github.com/rspadim","followers_url":"https://api.github.com/users/rspadim/followers","following_url":"https://api.github.com/users/rspadim/following{/other_user}","gists_url":"https://api.github.com/users/rspadim/gists{/gist_id}","starred_url":"https://api.github.com/users/rspadim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rspadim/subscriptions","organizations_url":"https://api.github.com/users/rspadim/orgs","repos_url":"https://api.github.com/users/rspadim/repos","events_url":"https://api.github.com/users/rspadim/events{/privacy}","received_events_url":"https://api.github.com/users/rspadim/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/comments/586655180","html_url":"https://github.com/hudson-and-thames/mlfinlab/issues/194#issuecomment-586655180","issue_url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/194","id":586655180,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NjY1NTE4MA==","user":{"login":"rspadim","id":2468782,"node_id":"MDQ6VXNlcjI0Njg3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/2468782?v=4","gravatar_id":"","url":"https://api.github.com/users/rspadim","html_url":"https://github.com/rspadim","followers_url":"https://api.github.com/users/rspadim/followers","following_url":"https://api.github.com/users/rspadim/following{/other_user}","gists_url":"https://api.github.com/users/rspadim/gists{/gist_id}","starred_url":"https://api.github.com/users/rspadim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rspadim/subscriptions","organizations_url":"https://api.github.com/users/rspadim/orgs","repos_url":"https://api.github.com/users/rspadim/repos","events_url":"https://api.github.com/users/rspadim/events{/privacy}","received_events_url":"https://api.github.com/users/rspadim/received_events","type":"User","site_admin":false},"created_at":"2020-02-16T00:27:51Z","updated_at":"2020-02-16T00:28:25Z","author_association":"NONE","body":"pull request #195 ","reactions":{"url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/comments/586655180/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rspadim","id":2468782,"node_id":"MDQ6VXNlcjI0Njg3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/2468782?v=4","gravatar_id":"","url":"https://api.github.com/users/rspadim","html_url":"https://github.com/rspadim","followers_url":"https://api.github.com/users/rspadim/followers","following_url":"https://api.github.com/users/rspadim/following{/other_user}","gists_url":"https://api.github.com/users/rspadim/gists{/gist_id}","starred_url":"https://api.github.com/users/rspadim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rspadim/subscriptions","organizations_url":"https://api.github.com/users/rspadim/orgs","repos_url":"https://api.github.com/users/rspadim/repos","events_url":"https://api.github.com/users/rspadim/events{/privacy}","received_events_url":"https://api.github.com/users/rspadim/received_events","type":"User","site_admin":false}},{"id":3041230551,"node_id":"MDExOkNsb3NlZEV2ZW50MzA0MTIzMDU1MQ==","url":"https://api.github.com/repos/hudson-and-thames/mlfinlab/issues/events/3041230551","actor":{"login":"rspadim","id":2468782,"node_id":"MDQ6VXNlcjI0Njg3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/2468782?v=4","gravatar_id":"","url":"https://api.github.com/users/rspadim","html_url":"https://github.com/rspadim","followers_url":"https://api.github.com/users/rspadim/followers","following_url":"https://api.github.com/users/rspadim/following{/other_user}","gists_url":"https://api.github.com/users/rspadim/gists{/gist_id}","starred_url":"https://api.github.com/users/rspadim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rspadim/subscriptions","organizations_url":"https://api.github.com/users/rspadim/orgs","repos_url":"https://api.github.com/users/rspadim/repos","events_url":"https://api.github.com/users/rspadim/events{/privacy}","received_events_url":"https://api.github.com/users/rspadim/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-02-16T00:27:51Z","state_reason":null,"performed_via_github_app":null}]