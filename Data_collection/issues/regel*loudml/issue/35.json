{"url":"https://api.github.com/repos/regel/loudml/issues/35","repository_url":"https://api.github.com/repos/regel/loudml","labels_url":"https://api.github.com/repos/regel/loudml/issues/35/labels{/name}","comments_url":"https://api.github.com/repos/regel/loudml/issues/35/comments","events_url":"https://api.github.com/repos/regel/loudml/issues/35/events","html_url":"https://github.com/regel/loudml/issues/35","id":336537645,"node_id":"MDU6SXNzdWUzMzY1Mzc2NDU=","number":35,"title":"Influx communication problem","user":{"login":"noypit","id":33017756,"node_id":"MDQ6VXNlcjMzMDE3NzU2","avatar_url":"https://avatars.githubusercontent.com/u/33017756?v=4","gravatar_id":"","url":"https://api.github.com/users/noypit","html_url":"https://github.com/noypit","followers_url":"https://api.github.com/users/noypit/followers","following_url":"https://api.github.com/users/noypit/following{/other_user}","gists_url":"https://api.github.com/users/noypit/gists{/gist_id}","starred_url":"https://api.github.com/users/noypit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/noypit/subscriptions","organizations_url":"https://api.github.com/users/noypit/orgs","repos_url":"https://api.github.com/users/noypit/repos","events_url":"https://api.github.com/users/noypit/events{/privacy}","received_events_url":"https://api.github.com/users/noypit/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2018-06-28T09:12:06Z","updated_at":"2018-09-05T09:32:11Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I have installed loudml on centos8 as per the installation instructions listed in the documentation.\r\nthe process is up and running:\r\n```\r\n$ ps -ef  | grep loudml\r\nloudml   11312     1  0 Jun26 ?        00:01:56 /bin/python3 /usr/bin/loudmld\r\n\r\n```\r\n**This is my configuration file:**\r\n\r\n```\r\n$ cat /etc/loudml/config.yml\r\n\r\ndatasources:\r\n - name: influx\r\n   type: influxdb\r\n   addr: <addres + port of influx DB>\r\n   use_ssl: \"true\"\r\n   verify_ssl : \"true\"\r\n   ca_certs: <cert path> \r\n   client_cert: <cert path> \r\n   client_key:<cert path> \r\n   database: telegrafqa\r\n   dbuser:<DB name> \r\n   dbuser_password: <DB password>\r\n\r\n\r\nstorage:\r\n  path: /var/lib/loudml\r\n\r\nserver:\r\n  listen: localhost:8077\r\n```\r\n\r\n**This is my model:**\r\n\r\n```\r\n$ sudo cat load-avg.json\r\n{\r\n  \"bucket_interval\": \"1m\",\r\n  \"default_datasource\": \"influx\",\r\n  \"features\": [\r\n    {\r\n      \"metric\": \"mean\",\r\n      \"field\": \"load1\",\r\n      \"measurement\": \"system\",\r\n      \"name\": \"load1\",\r\n      \"match_all\": [\r\n\t\t{\"tag\":\"project\" , \"value\":\"********\"},\r\n                {\"tag\":\"role\" , \"value\":\"*******\"},\r\n                {\"tag\":\"services\" , \"value\":\"*****\"}\r\n      ]\r\n    }\r\n  ],\r\n  \"interval\": \"1m\",\r\n  \"max_evals\": 1,\r\n  \"name\": \"load-avg-model\",\r\n  \"offset\": 30,\r\n  \"span\": 20,\r\n  \"default\":0,\r\n  \"max_threshold\": 90,\r\n  \"min_threshold\": 50,\r\n  \"type\": \"timeseries\"\r\n}\r\n```\r\nNote: when I put \"******\" it mean that i put their the relevant values.\r\nWhen i am trying to train my model I get the following error:\r\n```\r\n/usr/lib64/python3.4/importlib/_bootstrap.py:321: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\r\n  return f(*args, **kwds)\r\nINFO:root:train(load-avg-model) range=[2018-05-29T08:57:35.590Z, 2018-06-28T08:57:35.590Z] train_size=0.670000 batch_size=64 epochs=100)\r\nINFO:root:connecting to influxdb on <relevant DB address> , using database <hostname of DB>\r\nERROR:root:datasource[influx]: ('Connection aborted.', BadStatusLine(\"''\",))\r\n```\r\n\r\n**Connection aborted.', BadStatusLine(\"''\",**)  is a generic python error that mean that there was an error in the connection.\r\nThe host name and port of influx is properly defined.\r\n\r\nIn addition I tried to curl the host with certificate from my machine and i got the following response (as expected):\r\n```\r\nsudo curl -O -v key <cert> -G --cacert <cert> <cert> 'https://<username>:<password>@<influx hostname>:<port>/query?db=<db name>&pretty=true' --data-urlencode 'q=SELECT * FROM \"mymeas\"'\r\n{\r\n    \"results\": [\r\n        {\r\n            \"statement_id\": 0\r\n        }\r\n    ]\r\n}\r\n```\r\nso it means that there is no communication problem with influx or with certification.\r\n\r\nThanks,\r\nNoy.\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/regel/loudml/issues/35/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/regel/loudml/issues/35/timeline","performed_via_github_app":null,"state_reason":null}