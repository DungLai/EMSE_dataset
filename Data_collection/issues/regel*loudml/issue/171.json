{"url":"https://api.github.com/repos/regel/loudml/issues/171","repository_url":"https://api.github.com/repos/regel/loudml","labels_url":"https://api.github.com/repos/regel/loudml/issues/171/labels{/name}","comments_url":"https://api.github.com/repos/regel/loudml/issues/171/comments","events_url":"https://api.github.com/repos/regel/loudml/issues/171/events","html_url":"https://github.com/regel/loudml/issues/171","id":541811350,"node_id":"MDU6SXNzdWU1NDE4MTEzNTA=","number":171,"title":"POST /models/cpu_and_mem-model/_start will never write any points","user":{"login":"simplelife2010","id":22767935,"node_id":"MDQ6VXNlcjIyNzY3OTM1","avatar_url":"https://avatars.githubusercontent.com/u/22767935?v=4","gravatar_id":"","url":"https://api.github.com/users/simplelife2010","html_url":"https://github.com/simplelife2010","followers_url":"https://api.github.com/users/simplelife2010/followers","following_url":"https://api.github.com/users/simplelife2010/following{/other_user}","gists_url":"https://api.github.com/users/simplelife2010/gists{/gist_id}","starred_url":"https://api.github.com/users/simplelife2010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simplelife2010/subscriptions","organizations_url":"https://api.github.com/users/simplelife2010/orgs","repos_url":"https://api.github.com/users/simplelife2010/repos","events_url":"https://api.github.com/users/simplelife2010/events{/privacy}","received_events_url":"https://api.github.com/users/simplelife2010/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"regel","id":355557,"node_id":"MDQ6VXNlcjM1NTU1Nw==","avatar_url":"https://avatars.githubusercontent.com/u/355557?v=4","gravatar_id":"","url":"https://api.github.com/users/regel","html_url":"https://github.com/regel","followers_url":"https://api.github.com/users/regel/followers","following_url":"https://api.github.com/users/regel/following{/other_user}","gists_url":"https://api.github.com/users/regel/gists{/gist_id}","starred_url":"https://api.github.com/users/regel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/regel/subscriptions","organizations_url":"https://api.github.com/users/regel/orgs","repos_url":"https://api.github.com/users/regel/repos","events_url":"https://api.github.com/users/regel/events{/privacy}","received_events_url":"https://api.github.com/users/regel/received_events","type":"User","site_admin":false},"assignees":[{"login":"regel","id":355557,"node_id":"MDQ6VXNlcjM1NTU1Nw==","avatar_url":"https://avatars.githubusercontent.com/u/355557?v=4","gravatar_id":"","url":"https://api.github.com/users/regel","html_url":"https://github.com/regel","followers_url":"https://api.github.com/users/regel/followers","following_url":"https://api.github.com/users/regel/following{/other_user}","gists_url":"https://api.github.com/users/regel/gists{/gist_id}","starred_url":"https://api.github.com/users/regel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/regel/subscriptions","organizations_url":"https://api.github.com/users/regel/orgs","repos_url":"https://api.github.com/users/regel/repos","events_url":"https://api.github.com/users/regel/events{/privacy}","received_events_url":"https://api.github.com/users/regel/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2019-12-23T15:59:43Z","updated_at":"2020-01-03T16:40:10Z","closed_at":"2020-01-03T16:40:10Z","author_association":"NONE","active_lock_reason":null,"body":"When I start a periodic inference using the REST API, I never get any data written to my influxDB:\r\n\r\n```\r\ncurl -X POST 'localhost:8077/models/886-fm1/_start?save_output_data=true&output_bucket=frame_wise&flag_abnormal_data=true'\r\n```\r\n\r\nLooking into ```loudml/server.py```, the params for the scheduled job are set up like this:\r\n```\r\n@app.route(\"/models/<model_name>/_start\", methods=['POST'])\r\ndef model_start(model_name):\r\n    global g_storage\r\n\r\n    params = {\r\n        'save_prediction': get_bool_arg('save_output_data'),\r\n        'output_bucket': request.args.get('output_bucket'),\r\n        'detect_anomalies': get_bool_arg('flag_abnormal_data'),\r\n    }\r\n...\r\n```\r\n\r\n```save_output_data``` is stored in ```save_prediction```. This results in the following API call for ```_eval```:\r\n\r\n```\r\n127.0.0.1 - - [2019-12-23 15:42:07] \"POST /models/886-fm1/_eval?to=1577104926&detect_anomalies=True&save_prediction=True&output_bucket=frame_wise&from=1577104866 HTTP/1.1\" 200 352 0.641569\r\n```\r\n\r\nThe prediction job is set up like this:\r\n```\r\n@app.route(\"/models/<model_name>/_eval\", methods=['POST'])\r\ndef model_eval(model_name):\r\n    global g_storage\r\n    global g_config\r\n\r\n    job = PredictionJob(\r\n        model_name,\r\n        save_run_state=False,\r\n        from_date=get_date_arg('from', is_mandatory=True),\r\n        to_date=get_date_arg('to', is_mandatory=True),\r\n        save_prediction=get_bool_arg('save_output_data', default=False),\r\n        output_bucket=request.args.get('output_bucket'),\r\n        detect_anomalies=get_bool_arg('flag_abnormal_data', default=False),\r\n    )\r\n```\r\n\r\nIt seems to me that ```save_prediction``` is now retrieved from ```save_output_data```, which is not set in the API request.","closed_by":{"login":"simplelife2010","id":22767935,"node_id":"MDQ6VXNlcjIyNzY3OTM1","avatar_url":"https://avatars.githubusercontent.com/u/22767935?v=4","gravatar_id":"","url":"https://api.github.com/users/simplelife2010","html_url":"https://github.com/simplelife2010","followers_url":"https://api.github.com/users/simplelife2010/followers","following_url":"https://api.github.com/users/simplelife2010/following{/other_user}","gists_url":"https://api.github.com/users/simplelife2010/gists{/gist_id}","starred_url":"https://api.github.com/users/simplelife2010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simplelife2010/subscriptions","organizations_url":"https://api.github.com/users/simplelife2010/orgs","repos_url":"https://api.github.com/users/simplelife2010/repos","events_url":"https://api.github.com/users/simplelife2010/events{/privacy}","received_events_url":"https://api.github.com/users/simplelife2010/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/regel/loudml/issues/171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/regel/loudml/issues/171/timeline","performed_via_github_app":null,"state_reason":"completed"}