{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/265","repository_url":"https://api.github.com/repos/BindsNET/bindsnet","labels_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/265/labels{/name}","comments_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/265/comments","events_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/265/events","html_url":"https://github.com/BindsNET/bindsnet/issues/265","id":450469210,"node_id":"MDU6SXNzdWU0NTA0NjkyMTA=","number":265,"title":"Trouble learning","user":{"login":"4iar","id":8053216,"node_id":"MDQ6VXNlcjgwNTMyMTY=","avatar_url":"https://avatars.githubusercontent.com/u/8053216?v=4","gravatar_id":"","url":"https://api.github.com/users/4iar","html_url":"https://github.com/4iar","followers_url":"https://api.github.com/users/4iar/followers","following_url":"https://api.github.com/users/4iar/following{/other_user}","gists_url":"https://api.github.com/users/4iar/gists{/gist_id}","starred_url":"https://api.github.com/users/4iar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/4iar/subscriptions","organizations_url":"https://api.github.com/users/4iar/orgs","repos_url":"https://api.github.com/users/4iar/repos","events_url":"https://api.github.com/users/4iar/events{/privacy}","received_events_url":"https://api.github.com/users/4iar/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-05-30T19:30:08Z","updated_at":"2022-10-30T14:48:04Z","closed_at":"2019-05-31T15:14:58Z","author_association":"NONE","active_lock_reason":null,"body":"This is an extremely cool project!\r\n\r\nI am having trouble getting the network to learn tasks though.\r\n\r\nTo get started with the package (v0.2.4), I tried throwing some OpenAI gyms at it. I used the [breakout_stdp.py](https://github.com/Hananel-Hazan/bindsnet/blob/0.2.4/examples/breakout/breakout_stdp.py) example script and changed the environment from 'BreakoutDeterministic-v4' to 'CartPole-v0', then modified inpt (n=4, shape=[4,1]) and out (n=2) to correspond to the CartPole task. \r\n\r\nI ran 650 iterations of the task but saw no improvement in the accumulated reward. I've tried experimenting with some of the different learning/update rules with no success. I've also tried some of my own custom OpenAI gyms but found no success either. What other things could I try to get the network to learn the task? I am also new to neural networks & reinforcement learning so maybe there are some obvious things I've missed.\r\n\r\n\r\nCheers!\r\n\r\n\r\n<br/><br/><br/><br/>\r\n\r\n\r\nSome other info:\r\n\r\nI ran into two issues and have mentioned them here just in case they are related:\r\n\r\n1. Running the script throws the following error:\r\n```\r\nTraceback (most recent call last):\r\n  File \"run.py\", line 36, in <module>\r\n    environment.reset()\r\n  File \"/Users/x/bindsnet/bindsnet/environment/__init__.py\", line 237, in reset\r\n    self.preprocess()\r\n  File \"/Users/x/bindsnet/bindsnet/environment/__init__.py\", line 268, in preprocess\r\n    self.obs = subsample(gray_scale(self.obs), 84, 110)\r\n  File \"/Users/x/bindsnet/bindsnet/datasets/preprocess.py\", line 13, in gray_scale\r\n    return cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)\r\ncv2.error: OpenCV(4.1.0) /Users/travis/build/skvark/opencv-python/opencv/modules/imgproc/src/color.simd_helpers.hpp:92: error: (-2:Unspecified error) in function 'cv::impl::(anonymous namespace)::CvtHelper<cv::impl::(anonymous namespace)::Set<3, 4, -1>, cv::impl::(anonymous namespace)::Set<1, -1, -1>, cv::impl::(anonymous namespace)::Set<0, 2, 5>, cv::impl::(anonymous namespace)::SizePolicy::NONE>::CvtHelper(InputArray, OutputArray, int) [VScn = cv::impl::(anonymous namespace)::Set<3, 4, -1>, VDcn = cv::impl::(anonymous namespace)::Set<1, -1, -1>, VDepth = cv::impl::(anonymous namespace)::Set<0, 2, 5>, sizePolicy = cv::impl::(anonymous namespace)::SizePolicy::NONE]'\r\n> Invalid number of channels in input image:\r\n>     'VScn::contains(scn)'\r\n> where\r\n>     'scn' is 1\r\n\r\n```\r\nIt looked related to the different input format.\r\n\r\nI temporarily worked around this by commenting out the subsample line in the preprocessing step: https://github.com/Hananel-Hazan/bindsnet/blob/0.2.4/bindsnet/environment/__init__.py#L268 \r\n\r\n\r\n2. The plots only show a single time step (big horizontal bars), rather than spikes/voltages across the entire trial (e.g. like in this fig: https://i.imgur.com/Sltk55I.png). \r\n\r\n\r\n![image](https://user-images.githubusercontent.com/8053216/58656827-e4a34280-8314-11e9-9571-405d74fdff72.png)\r\n\r\n![image](https://user-images.githubusercontent.com/8053216/58656848-eec54100-8314-11e9-9439-25450612956e.png)\r\n\r\n\r\n\r\n","closed_by":{"login":"Hananel-Hazan","id":3954715,"node_id":"MDQ6VXNlcjM5NTQ3MTU=","avatar_url":"https://avatars.githubusercontent.com/u/3954715?v=4","gravatar_id":"","url":"https://api.github.com/users/Hananel-Hazan","html_url":"https://github.com/Hananel-Hazan","followers_url":"https://api.github.com/users/Hananel-Hazan/followers","following_url":"https://api.github.com/users/Hananel-Hazan/following{/other_user}","gists_url":"https://api.github.com/users/Hananel-Hazan/gists{/gist_id}","starred_url":"https://api.github.com/users/Hananel-Hazan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hananel-Hazan/subscriptions","organizations_url":"https://api.github.com/users/Hananel-Hazan/orgs","repos_url":"https://api.github.com/users/Hananel-Hazan/repos","events_url":"https://api.github.com/users/Hananel-Hazan/events{/privacy}","received_events_url":"https://api.github.com/users/Hananel-Hazan/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/265/timeline","performed_via_github_app":null,"state_reason":"completed"}