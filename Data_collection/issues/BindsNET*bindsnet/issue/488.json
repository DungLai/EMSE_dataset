{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/488","repository_url":"https://api.github.com/repos/BindsNET/bindsnet","labels_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/488/labels{/name}","comments_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/488/comments","events_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/488/events","html_url":"https://github.com/BindsNET/bindsnet/issues/488","id":893228150,"node_id":"MDU6SXNzdWU4OTMyMjgxNTA=","number":488,"title":"An error occurred while updating the network with MSTDP learning rule","user":{"login":"AptX395","id":44229751,"node_id":"MDQ6VXNlcjQ0MjI5NzUx","avatar_url":"https://avatars.githubusercontent.com/u/44229751?v=4","gravatar_id":"","url":"https://api.github.com/users/AptX395","html_url":"https://github.com/AptX395","followers_url":"https://api.github.com/users/AptX395/followers","following_url":"https://api.github.com/users/AptX395/following{/other_user}","gists_url":"https://api.github.com/users/AptX395/gists{/gist_id}","starred_url":"https://api.github.com/users/AptX395/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AptX395/subscriptions","organizations_url":"https://api.github.com/users/AptX395/orgs","repos_url":"https://api.github.com/users/AptX395/repos","events_url":"https://api.github.com/users/AptX395/events{/privacy}","received_events_url":"https://api.github.com/users/AptX395/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2021-05-17T11:20:35Z","updated_at":"2021-05-28T20:51:51Z","closed_at":"2021-05-28T20:51:51Z","author_association":"NONE","active_lock_reason":null,"body":"I submitted an issue #487 that explained an error I had encountered.\r\n\r\nAfter investigation, I think it is not because the network parameters were set incorrectly. I replied the [specific disgussion](https://github.com/BindsNET/bindsnet/issues/487#issuecomment-841592109) in #487.\r\n\r\nI think this problem may have occurred in the update phase of the network rather than in the forward propagation phase of the network.\r\n\r\nMy code logic is to separate forward propagation from network updates. That is, I set `self._net.train(mode = False)` before calling `self._net.run()` as follows:\r\n\r\n```python\r\nself._net.train(mode = False)\r\nspike = self._encoder(x)    # PoissonEncoder\r\ninput = {\"input\": spike}\r\nself._net.run(input, self._time, one_step = True)\r\n```\r\n\r\nto make the network behave like:\r\n\r\n```python\r\nwith torch.no_grad():\r\n    model.forward(x)\r\n```\r\n\r\nin PyTorch.\r\n\r\n---\r\n\r\nMy code works fine for forward propagation without any errors. But when I update network parameters as follows:\r\n\r\n```python\r\nself._net.train(mode = True)\r\n\r\nfor connection in self._net.connections:\r\n    self._net.connections[connection].update(reward = reward)\r\n```\r\n\r\nI get the error mentioned in #487.\r\n\r\nThe most critical error message is:\r\n\r\n```python\r\n  File \"/usr/local/anaconda3/envs/snn_rl/lib/python3.7/site-packages/bindsnet/learning/learning.py\", line 669, in _conv2d_connection_update\r\n    self.eligibility = self.eligibility.view(self.connection.w.size())\r\nRuntimeError: shape '[32, 4, 8, 8]' is invalid for input of size 262144\r\n```\r\n\r\nWhat is the cause of this error?\r\n\r\nI really appreciate your help!","closed_by":{"login":"Hananel-Hazan","id":3954715,"node_id":"MDQ6VXNlcjM5NTQ3MTU=","avatar_url":"https://avatars.githubusercontent.com/u/3954715?v=4","gravatar_id":"","url":"https://api.github.com/users/Hananel-Hazan","html_url":"https://github.com/Hananel-Hazan","followers_url":"https://api.github.com/users/Hananel-Hazan/followers","following_url":"https://api.github.com/users/Hananel-Hazan/following{/other_user}","gists_url":"https://api.github.com/users/Hananel-Hazan/gists{/gist_id}","starred_url":"https://api.github.com/users/Hananel-Hazan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hananel-Hazan/subscriptions","organizations_url":"https://api.github.com/users/Hananel-Hazan/orgs","repos_url":"https://api.github.com/users/Hananel-Hazan/repos","events_url":"https://api.github.com/users/Hananel-Hazan/events{/privacy}","received_events_url":"https://api.github.com/users/Hananel-Hazan/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/488/timeline","performed_via_github_app":null,"state_reason":"completed"}