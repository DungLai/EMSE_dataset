{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/601","repository_url":"https://api.github.com/repos/BindsNET/bindsnet","labels_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/601/labels{/name}","comments_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/601/comments","events_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/601/events","html_url":"https://github.com/BindsNET/bindsnet/issues/601","id":1467261974,"node_id":"I_kwDOBzWFSM5XdKQW","number":601,"title":"Network converted from ANN doesn't retain weights after training?","user":{"login":"0xnurl","id":16934551,"node_id":"MDQ6VXNlcjE2OTM0NTUx","avatar_url":"https://avatars.githubusercontent.com/u/16934551?v=4","gravatar_id":"","url":"https://api.github.com/users/0xnurl","html_url":"https://github.com/0xnurl","followers_url":"https://api.github.com/users/0xnurl/followers","following_url":"https://api.github.com/users/0xnurl/following{/other_user}","gists_url":"https://api.github.com/users/0xnurl/gists{/gist_id}","starred_url":"https://api.github.com/users/0xnurl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/0xnurl/subscriptions","organizations_url":"https://api.github.com/users/0xnurl/orgs","repos_url":"https://api.github.com/users/0xnurl/repos","events_url":"https://api.github.com/users/0xnurl/events{/privacy}","received_events_url":"https://api.github.com/users/0xnurl/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-11-29T00:15:58Z","updated_at":"2022-12-02T22:11:25Z","closed_at":"2022-12-02T22:11:25Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"First of all thank you so much for this very impressive project!\r\n\r\nMy current process:\r\n\r\n1. Build a deep ANN using a regular PyTorch module.\r\n2. Convert the ANN to SNN using `bindsnet.conversion.ann_to_snn()`.\r\n3. Train the SNN using `Network.run()`\r\n\r\nFor training, I am following the training and test methods in `examples/eth_mnist.py`.\r\nFor conversion from ANN to SNN, I am following this [conversion example script](https://github.com/BINDS-LAB-UMASS/bindsnet_experiments/blob/master/experiments/conversion/fully_connected_mnist.py). \r\n\r\nThe SNN seems to learn something, and reaches ~50% accuracy on MNIST. \r\n\r\nHowever, the SNN doesn't seem to retain the weights learned while running `Network.run()`. When I test or retrain the SNN, it resets to the same performance it had before running `run()`.\r\n\r\nI am attaching a minimal reproduction script. The critical part is that after running `_train_snn()` for the second time, the performace resets and progresses in the same way as it did during the first training.\r\n\r\nMore details: \r\n\r\n- I am running the SNN training on the exact same data in both times. \r\n- If the ANN is trained before conversion to SNN, the weights of the ANN are retained (but the network still doesn't improve after training as an SNN)\r\n\r\nThank you in advance for any help!\r\n\r\n[bindnset_issue.py.txt](https://github.com/BindsNET/bindsnet/files/10108586/bindnset_issue.py.txt)\r\n\r\n\r\n","closed_by":{"login":"Hananel-Hazan","id":3954715,"node_id":"MDQ6VXNlcjM5NTQ3MTU=","avatar_url":"https://avatars.githubusercontent.com/u/3954715?v=4","gravatar_id":"","url":"https://api.github.com/users/Hananel-Hazan","html_url":"https://github.com/Hananel-Hazan","followers_url":"https://api.github.com/users/Hananel-Hazan/followers","following_url":"https://api.github.com/users/Hananel-Hazan/following{/other_user}","gists_url":"https://api.github.com/users/Hananel-Hazan/gists{/gist_id}","starred_url":"https://api.github.com/users/Hananel-Hazan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hananel-Hazan/subscriptions","organizations_url":"https://api.github.com/users/Hananel-Hazan/orgs","repos_url":"https://api.github.com/users/Hananel-Hazan/repos","events_url":"https://api.github.com/users/Hananel-Hazan/events{/privacy}","received_events_url":"https://api.github.com/users/Hananel-Hazan/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/601/timeline","performed_via_github_app":null,"state_reason":"completed"}