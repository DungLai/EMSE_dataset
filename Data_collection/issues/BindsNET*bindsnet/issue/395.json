{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/395","repository_url":"https://api.github.com/repos/BindsNET/bindsnet","labels_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/395/labels{/name}","comments_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/395/comments","events_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/395/events","html_url":"https://github.com/BindsNET/bindsnet/issues/395","id":663183311,"node_id":"MDU6SXNzdWU2NjMxODMzMTE=","number":395,"title":"Breakout example only works when forcing CPU","user":{"login":"wnourse05","id":25424477,"node_id":"MDQ6VXNlcjI1NDI0NDc3","avatar_url":"https://avatars.githubusercontent.com/u/25424477?v=4","gravatar_id":"","url":"https://api.github.com/users/wnourse05","html_url":"https://github.com/wnourse05","followers_url":"https://api.github.com/users/wnourse05/followers","following_url":"https://api.github.com/users/wnourse05/following{/other_user}","gists_url":"https://api.github.com/users/wnourse05/gists{/gist_id}","starred_url":"https://api.github.com/users/wnourse05/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wnourse05/subscriptions","organizations_url":"https://api.github.com/users/wnourse05/orgs","repos_url":"https://api.github.com/users/wnourse05/repos","events_url":"https://api.github.com/users/wnourse05/events{/privacy}","received_events_url":"https://api.github.com/users/wnourse05/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2020-07-21T17:24:56Z","updated_at":"2020-07-22T14:04:20Z","closed_at":"2020-07-22T14:04:20Z","author_association":"NONE","active_lock_reason":null,"body":"I've tried running the breakout example in version 0.2.7, but I can only get it to work by exporting the shell variable `CUDA_VISIBLE_DEVICES=\"\"` and forcing the CPU. If I try to run with the GPU, I get the following error:\r\n\r\n> Traceback (most recent call last):\r\n>   File \"/home/will/bindsnet/examples/breakout/breakout.py\", line 53, in <module>\r\n>     pipeline.step(result)\r\n>   File \"/home/will/bindsnet/bindsnet/pipeline/base_pipeline.py\", line 124, in step\r\n>     step_out = self.step_(batch, **kwargs)\r\n>   File \"/home/will/bindsnet/bindsnet/pipeline/environment_pipeline.py\", line 266, in step_\r\n>     self.network.run(inputs=inputs, time=self.time, reward=reward, **kwargs)\r\n>   File \"/home/will/bindsnet/bindsnet/network/network.py\", line 357, in run\r\n>     self.layers[l].forward(x=current_inputs[l])\r\n>   File \"/home/will/bindsnet/bindsnet/network/nodes.py\", line 220, in forward\r\n>     super().forward(x)\r\n>   File \"/home/will/bindsnet/bindsnet/network/nodes.py\", line 104, in forward\r\n>     self.x.masked_fill_(self.s != 0, 1)\r\n> RuntimeError: Expected object of device type cuda but got device type cpu for argument #2 'mask' in call to _th_masked_fill_bool_\r\n\r\nI've tried forcing it onto the GPU using`torch.cuda.set_device(\"cuda:0\")` and `network.to(\"cuda:0\")` to no avail. How can I get this to work using the GPU?","closed_by":{"login":"wnourse05","id":25424477,"node_id":"MDQ6VXNlcjI1NDI0NDc3","avatar_url":"https://avatars.githubusercontent.com/u/25424477?v=4","gravatar_id":"","url":"https://api.github.com/users/wnourse05","html_url":"https://github.com/wnourse05","followers_url":"https://api.github.com/users/wnourse05/followers","following_url":"https://api.github.com/users/wnourse05/following{/other_user}","gists_url":"https://api.github.com/users/wnourse05/gists{/gist_id}","starred_url":"https://api.github.com/users/wnourse05/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wnourse05/subscriptions","organizations_url":"https://api.github.com/users/wnourse05/orgs","repos_url":"https://api.github.com/users/wnourse05/repos","events_url":"https://api.github.com/users/wnourse05/events{/privacy}","received_events_url":"https://api.github.com/users/wnourse05/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/395/timeline","performed_via_github_app":null,"state_reason":"completed"}