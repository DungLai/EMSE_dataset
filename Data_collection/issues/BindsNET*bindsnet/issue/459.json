{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/459","repository_url":"https://api.github.com/repos/BindsNET/bindsnet","labels_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/459/labels{/name}","comments_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/459/comments","events_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/459/events","html_url":"https://github.com/BindsNET/bindsnet/issues/459","id":814120999,"node_id":"MDU6SXNzdWU4MTQxMjA5OTk=","number":459,"title":"AttributeError: The eth_mnist.py example can't runing on GPU","user":{"login":"envysir","id":32240006,"node_id":"MDQ6VXNlcjMyMjQwMDA2","avatar_url":"https://avatars.githubusercontent.com/u/32240006?v=4","gravatar_id":"","url":"https://api.github.com/users/envysir","html_url":"https://github.com/envysir","followers_url":"https://api.github.com/users/envysir/followers","following_url":"https://api.github.com/users/envysir/following{/other_user}","gists_url":"https://api.github.com/users/envysir/gists{/gist_id}","starred_url":"https://api.github.com/users/envysir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/envysir/subscriptions","organizations_url":"https://api.github.com/users/envysir/orgs","repos_url":"https://api.github.com/users/envysir/repos","events_url":"https://api.github.com/users/envysir/events{/privacy}","received_events_url":"https://api.github.com/users/envysir/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-02-23T05:26:00Z","updated_at":"2021-02-24T22:44:18Z","closed_at":"2021-02-24T22:44:18Z","author_association":"NONE","active_lock_reason":null,"body":"Hello, Bindsnet\r\nI've tried runing the eth_mnist example in version 0.2.8, the code runing on CPU, it's OK.\r\nBut I want to running on GPU, I set this code in Line 47  `parser.set_defaults(plot=True, gpu=True)`\r\n\r\nThe Traceback are as follows:\r\n\r\n        Running on Device =  cuda\r\n                \r\n        Begin training.\r\n        \r\n        Progress: 0 / 1 (0.0000 seconds)\r\n          0%|          | 0/60000 [00:00<?, ?it/s]\r\n        Traceback (most recent call last):\r\n          File \"D:/Code/bindsnet-master/examples/mnist/eth_mnist.py\", line 175, in <module>\r\n            for step, batch in enumerate(tqdm(dataloader)):\r\n          File \"D:\\Software\\ANACONDA\\Anaconda\\envs\\bindsnet\\lib\\site-packages\\tqdm\\std.py\", line 1166, in __iter__\r\n            for obj in iterable:\r\n          File \"D:\\Software\\ANACONDA\\Anaconda\\envs\\bindsnet\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 352, in __iter__\r\n            return self._get_iterator()\r\n          File \"D:\\Software\\ANACONDA\\Anaconda\\envs\\bindsnet\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 294, in _get_iterator\r\n            return _MultiProcessingDataLoaderIter(self)\r\n          File \"D:\\Software\\ANACONDA\\Anaconda\\envs\\bindsnet\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 801, in __init__\r\n            w.start()\r\n          File \"D:\\Software\\ANACONDA\\Anaconda\\envs\\bindsnet\\lib\\multiprocessing\\process.py\", line 105, in start\r\n            self._popen = self._Popen(self)\r\n          File \"D:\\Software\\ANACONDA\\Anaconda\\envs\\bindsnet\\lib\\multiprocessing\\context.py\", line 223, in _Popen\r\n            return _default_context.get_context().Process._Popen(process_obj)\r\n          File \"D:\\Software\\ANACONDA\\Anaconda\\envs\\bindsnet\\lib\\multiprocessing\\context.py\", line 322, in _Popen\r\n            return Popen(process_obj)\r\n          File \"D:\\Software\\ANACONDA\\Anaconda\\envs\\bindsnet\\lib\\multiprocessing\\popen_spawn_win32.py\", line 65, in __init__\r\n            reduction.dump(process_obj, to_child)\r\n          File \"D:\\Software\\ANACONDA\\Anaconda\\envs\\bindsnet\\lib\\multiprocessing\\reduction.py\", line 60, in dump\r\n            ForkingPickler(file, protocol).dump(obj)\r\n        AttributeError: Can't pickle local object 'create_torchvision_dataset_wrapper.<locals>.TorchvisionDatasetWrapper'\r\n\r\nThis is the output of `pip list`\r\n\r\n\r\n          alabaster                     0.7.12\r\n          appdirs                       1.4.4\r\n          argon2-cffi                   20.1.0\r\n          async-generator               1.10\r\n          atomicwrites                  1.4.0\r\n          attrs                         20.3.0\r\n          Babel                         2.9.0\r\n          backcall                      0.2.0\r\n          BindsNET                      0.2.8               d:\\code\\bindsnet-master\r\n          bleach                        3.2.2\r\n          certifi                       2020.12.5\r\n          cffi                          1.14.4\r\n          cfgv                          3.2.0\r\n          chardet                       4.0.0\r\n          cloudpickle                   1.6.0\r\n          colorama                      0.4.4\r\n          cycler                        0.10.0\r\n          Cython                        0.29.21\r\n          dataclasses                   0.7\r\n          decorator                     4.4.2\r\n          defusedxml                    0.6.0\r\n          distlib                       0.3.1\r\n          distro                        1.5.0\r\n          docutils                      0.16\r\n          eagerpy                       0.29.0\r\n          entrypoints                   0.3\r\n          filelock                      3.0.12\r\n          foolbox                       3.2.1\r\n          future                        0.18.2\r\n          gitdb                         4.0.5\r\n          GitPython                     3.1.12\r\n          gym                           0.18.0\r\n          identify                      1.5.13\r\n          idna                          2.10\r\n          imageio                       2.9.0\r\n          imagesize                     1.2.0\r\n          importlib-metadata            3.4.0\r\n          importlib-resources           5.1.0\r\n          iniconfig                     1.1.1\r\n          ipykernel                     5.3.4\r\n          ipython                       7.16.1\r\n          ipython-genutils              0.2.0\r\n          ipywidgets                    7.6.3\r\n          jedi                          0.18.0\r\n          Jinja2                        2.11.2\r\n          joblib                        1.0.0\r\n          jsonschema                    3.2.0\r\n          jupyter                       1.0.0\r\n          jupyter-client                6.1.7\r\n          jupyter-console               6.2.0\r\n          jupyter-core                  4.7.0\r\n          jupyterlab-pygments           0.1.2\r\n          jupyterlab-widgets            1.0.0\r\n          kiwisolver                    1.3.1\r\n          MarkupSafe                    1.1.1\r\n          matplotlib                    3.3.3\r\n          mistune                       0.8.4\r\n          mkl-fft                       1.2.0\r\n          mkl-random                    1.1.1\r\n          mkl-service                   2.3.0\r\n          nbclient                      0.5.1\r\n          nbconvert                     6.0.7\r\n          nbformat                      5.1.2\r\n          nest-asyncio                  1.4.3\r\n          networkx                      2.5\r\n          nodeenv                       1.5.0\r\n          notebook                      6.2.0\r\n          numpy                         1.19.5\r\n          olefile                       0.46\r\n          opencv-python                 4.5.1.48\r\n          packaging                     20.8\r\n          pandas                        1.1.5\r\n          pandocfilters                 1.4.3\r\n          parso                         0.8.1\r\n          pickleshare                   0.7.5\r\n          Pillow                        7.2.0\r\n          pip                           20.3.3\r\n          pluggy                        0.13.1\r\n          pre-commit                    2.9.3\r\n          prometheus-client             0.9.0\r\n          prompt-toolkit                3.0.8\r\n          protobuf                      3.14.0\r\n          py                            1.10.0\r\n          pycparser                     2.20\r\n          pyglet                        1.5.0\r\n          Pygments                      2.7.4\r\n          pyparsing                     2.4.7\r\n          pyrsistent                    0.17.3\r\n          pytest                        6.2.1\r\n          python-dateutil               2.8.1\r\n          pytz                          2020.5\r\n          PyWavelets                    1.1.1\r\n          pywin32                       227\r\n          pywinpty                      0.5.7\r\n          PyYAML                        5.4.1\r\n          pyzmq                         20.0.0\r\n          qtconsole                     4.7.7\r\n          QtPy                          1.9.0\r\n          requests                      2.25.1\r\n          scikit-build                  0.11.1\r\n          scikit-image                  0.17.2\r\n          scikit-learn                  0.24.1\r\n          scipy                         1.5.4\r\n          Send2Trash                    1.5.0\r\n          setuptools                    51.3.3.post20210118\r\n          six                           1.15.0\r\n          smmap                         3.0.5\r\n          snowballstemmer               2.1.0\r\n          Sphinx                        3.4.3\r\n          sphinx-rtd-theme              0.5.1\r\n          sphinxcontrib-applehelp       1.0.2\r\n          sphinxcontrib-devhelp         1.0.2\r\n          sphinxcontrib-htmlhelp        1.0.3\r\n          sphinxcontrib-jsmath          1.0.1\r\n          sphinxcontrib-qthelp          1.0.3\r\n          sphinxcontrib-serializinghtml 1.1.4\r\n          tensorboardX                  2.1\r\n          terminado                     0.9.2\r\n          testpath                      0.4.4\r\n          threadpoolctl                 2.1.0\r\n          tifffile                      2020.9.3\r\n          toml                          0.10.2\r\n          torch                         1.7.1\r\n          torchaudio                    0.7.2\r\n          torchvision                   0.8.2\r\n          tornado                       6.1\r\n          tqdm                          4.56.0\r\n          traitlets                     4.3.3\r\n          typing-extensions             3.7.4.3\r\n          urllib3                       1.26.2\r\n          virtualenv                    20.4.0\r\n          wcwidth                       0.2.5\r\n          webencodings                  0.5.1\r\n          wheel                         0.36.2\r\n          widgetsnbextension            3.5.1\r\n          wincertstore                  0.2\r\n          zipp                          3.4.0\r\n\r\nI think the cude is work in pytorch\r\n\r\n        import torch\r\n        torch.cuda.current_device()\r\n        Out[3]: 0\r\n        torch.cuda.device_count()\r\n        Out[5]: 1\r\n        torch.cuda.device(0)\r\n        Out[6]: <torch.cuda.device at 0x1eb84955b38>\r\n        torch.cuda.get_device_name(0)\r\n        Out[7]: 'GeForce RTX 2060'\r\n        torch.cuda.is_available()\r\n        Out[8]: True\r\n\r\nIs a certain part of the program not configured correctly? Sorry for long issue, Hope to get an answer, Thanks a lot!\r\n\r\nJayden\r\n","closed_by":{"login":"Hananel-Hazan","id":3954715,"node_id":"MDQ6VXNlcjM5NTQ3MTU=","avatar_url":"https://avatars.githubusercontent.com/u/3954715?v=4","gravatar_id":"","url":"https://api.github.com/users/Hananel-Hazan","html_url":"https://github.com/Hananel-Hazan","followers_url":"https://api.github.com/users/Hananel-Hazan/followers","following_url":"https://api.github.com/users/Hananel-Hazan/following{/other_user}","gists_url":"https://api.github.com/users/Hananel-Hazan/gists{/gist_id}","starred_url":"https://api.github.com/users/Hananel-Hazan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hananel-Hazan/subscriptions","organizations_url":"https://api.github.com/users/Hananel-Hazan/orgs","repos_url":"https://api.github.com/users/Hananel-Hazan/repos","events_url":"https://api.github.com/users/Hananel-Hazan/events{/privacy}","received_events_url":"https://api.github.com/users/Hananel-Hazan/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/459/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/459/timeline","performed_via_github_app":null,"state_reason":"completed"}