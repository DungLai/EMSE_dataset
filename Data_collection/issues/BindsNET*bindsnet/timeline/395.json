[{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/comments/662056386","html_url":"https://github.com/BindsNET/bindsnet/issues/395#issuecomment-662056386","issue_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/395","id":662056386,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjA1NjM4Ng==","user":{"login":"Hananel-Hazan","id":3954715,"node_id":"MDQ6VXNlcjM5NTQ3MTU=","avatar_url":"https://avatars.githubusercontent.com/u/3954715?v=4","gravatar_id":"","url":"https://api.github.com/users/Hananel-Hazan","html_url":"https://github.com/Hananel-Hazan","followers_url":"https://api.github.com/users/Hananel-Hazan/followers","following_url":"https://api.github.com/users/Hananel-Hazan/following{/other_user}","gists_url":"https://api.github.com/users/Hananel-Hazan/gists{/gist_id}","starred_url":"https://api.github.com/users/Hananel-Hazan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hananel-Hazan/subscriptions","organizations_url":"https://api.github.com/users/Hananel-Hazan/orgs","repos_url":"https://api.github.com/users/Hananel-Hazan/repos","events_url":"https://api.github.com/users/Hananel-Hazan/events{/privacy}","received_events_url":"https://api.github.com/users/Hananel-Hazan/received_events","type":"User","site_admin":false},"created_at":"2020-07-21T19:17:33Z","updated_at":"2020-07-21T19:17:33Z","author_association":"COLLABORATOR","body":"Thank you for using BindsNET. \r\nCan you elaborate on your setup, where do you add the shell variable?\r\n\r\nThe script `breakout.py` don't have parameter to choose between CPU to GPU, and it runs on my computer using CPU without any issue","reactions":{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/comments/662056386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Hananel-Hazan","id":3954715,"node_id":"MDQ6VXNlcjM5NTQ3MTU=","avatar_url":"https://avatars.githubusercontent.com/u/3954715?v=4","gravatar_id":"","url":"https://api.github.com/users/Hananel-Hazan","html_url":"https://github.com/Hananel-Hazan","followers_url":"https://api.github.com/users/Hananel-Hazan/followers","following_url":"https://api.github.com/users/Hananel-Hazan/following{/other_user}","gists_url":"https://api.github.com/users/Hananel-Hazan/gists{/gist_id}","starred_url":"https://api.github.com/users/Hananel-Hazan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hananel-Hazan/subscriptions","organizations_url":"https://api.github.com/users/Hananel-Hazan/orgs","repos_url":"https://api.github.com/users/Hananel-Hazan/repos","events_url":"https://api.github.com/users/Hananel-Hazan/events{/privacy}","received_events_url":"https://api.github.com/users/Hananel-Hazan/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/comments/662066112","html_url":"https://github.com/BindsNET/bindsnet/issues/395#issuecomment-662066112","issue_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/395","id":662066112,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjA2NjExMg==","user":{"login":"wnourse05","id":25424477,"node_id":"MDQ6VXNlcjI1NDI0NDc3","avatar_url":"https://avatars.githubusercontent.com/u/25424477?v=4","gravatar_id":"","url":"https://api.github.com/users/wnourse05","html_url":"https://github.com/wnourse05","followers_url":"https://api.github.com/users/wnourse05/followers","following_url":"https://api.github.com/users/wnourse05/following{/other_user}","gists_url":"https://api.github.com/users/wnourse05/gists{/gist_id}","starred_url":"https://api.github.com/users/wnourse05/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wnourse05/subscriptions","organizations_url":"https://api.github.com/users/wnourse05/orgs","repos_url":"https://api.github.com/users/wnourse05/repos","events_url":"https://api.github.com/users/wnourse05/events{/privacy}","received_events_url":"https://api.github.com/users/wnourse05/received_events","type":"User","site_admin":false},"created_at":"2020-07-21T19:37:56Z","updated_at":"2020-07-21T19:37:56Z","author_association":"NONE","body":"My setup is a GTX 980 Ti and Ubuntu 20.04, running in a python 3.8.2 venv with only bindsnet and its dependencies. When I run `breakout.py` (or `breakout_stdp.py`) from the terminal, I get the errors shown above. When I force the torch backend to use only the CPU, by entering `export CUDA_VISIBLE_DEVICES=\"\"` into the terminal first before running `breakout.py`, then the script works.\r\n\r\nUsing just the CPU I can get it to work, but only by telling torch that there isn't a GPU. I'm trying to use this as a reference for building a much larger model that will need the GPU, so I've tried adding lines from other scripts which work to try and get all of the tensors on the same device. It just seems like somewhere tensors are getting only sent to the CPU, even if everything else uses the GPU.\r\n\r\nHow can I successfully modify this script to use the GPU, not the CPU? If the methodology in this script is not amenable to running on a GPU,is there a different process for RL in bindsnet? These scripts are the only examples provided.","reactions":{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/comments/662066112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"wnourse05","id":25424477,"node_id":"MDQ6VXNlcjI1NDI0NDc3","avatar_url":"https://avatars.githubusercontent.com/u/25424477?v=4","gravatar_id":"","url":"https://api.github.com/users/wnourse05","html_url":"https://github.com/wnourse05","followers_url":"https://api.github.com/users/wnourse05/followers","following_url":"https://api.github.com/users/wnourse05/following{/other_user}","gists_url":"https://api.github.com/users/wnourse05/gists{/gist_id}","starred_url":"https://api.github.com/users/wnourse05/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wnourse05/subscriptions","organizations_url":"https://api.github.com/users/wnourse05/orgs","repos_url":"https://api.github.com/users/wnourse05/repos","events_url":"https://api.github.com/users/wnourse05/events{/privacy}","received_events_url":"https://api.github.com/users/wnourse05/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/comments/662099076","html_url":"https://github.com/BindsNET/bindsnet/issues/395#issuecomment-662099076","issue_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/395","id":662099076,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjA5OTA3Ng==","user":{"login":"Hananel-Hazan","id":3954715,"node_id":"MDQ6VXNlcjM5NTQ3MTU=","avatar_url":"https://avatars.githubusercontent.com/u/3954715?v=4","gravatar_id":"","url":"https://api.github.com/users/Hananel-Hazan","html_url":"https://github.com/Hananel-Hazan","followers_url":"https://api.github.com/users/Hananel-Hazan/followers","following_url":"https://api.github.com/users/Hananel-Hazan/following{/other_user}","gists_url":"https://api.github.com/users/Hananel-Hazan/gists{/gist_id}","starred_url":"https://api.github.com/users/Hananel-Hazan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hananel-Hazan/subscriptions","organizations_url":"https://api.github.com/users/Hananel-Hazan/orgs","repos_url":"https://api.github.com/users/Hananel-Hazan/repos","events_url":"https://api.github.com/users/Hananel-Hazan/events{/privacy}","received_events_url":"https://api.github.com/users/Hananel-Hazan/received_events","type":"User","site_admin":false},"created_at":"2020-07-21T20:49:56Z","updated_at":"2020-07-21T20:49:56Z","author_association":"COLLABORATOR","body":"Please run the following code on your system with a default setting, without set `export CUDA_VISIBLE_DEVICES=\"\"` \r\n```\r\nimport os\r\nimport torch\r\nimport time\r\nimport sys\r\n\r\nprint(os.environ)\r\nprint(torch.cuda.device_count())\r\nprint(torch.cuda.current_device())\r\nprint(os.getpid())\r\nsys.stdout.flush()\r\n\r\ndevice = torch.device('cuda')\r\na = torch.randn(2, 2, device=device)\r\n\r\nos.system('nvidia-smi')\r\n```\r\n\r\nAlso, What is your system default settings of `CUDA_VISIBLE_DEVICES` ?\r\n\r\nUsing `network.to(\"cuda\")`  and adding the parameter `device='cuda'` in `EnvironmentPipeline` is the correct way to use the GPU. \r\n\r\nThe methodology of running RL on the GPU is a little bit tricky. Typically, you would like to put your network and all the training data on GPU. This will give you the best performance. But, in the RL case, this could be a problem for two reasons.\r\n\r\n1. The RL training data is usually bigger than your GPU memory capacity.  The only solution is to put all the data on the CPU and transfer chunks to the GPU for training. This way reduces performance. But, you can alleviate the situation by using threading for the memory move. The memory moves are not implemented yet in BindsNET (PyTorch use similar mechanism). \r\n2. The simulator (ATARI, gym, etc ) usually runs and uses CPU and not GPU. Therefore the data need to be transferred in any case. \r\n","reactions":{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/comments/662099076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Hananel-Hazan","id":3954715,"node_id":"MDQ6VXNlcjM5NTQ3MTU=","avatar_url":"https://avatars.githubusercontent.com/u/3954715?v=4","gravatar_id":"","url":"https://api.github.com/users/Hananel-Hazan","html_url":"https://github.com/Hananel-Hazan","followers_url":"https://api.github.com/users/Hananel-Hazan/followers","following_url":"https://api.github.com/users/Hananel-Hazan/following{/other_user}","gists_url":"https://api.github.com/users/Hananel-Hazan/gists{/gist_id}","starred_url":"https://api.github.com/users/Hananel-Hazan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hananel-Hazan/subscriptions","organizations_url":"https://api.github.com/users/Hananel-Hazan/orgs","repos_url":"https://api.github.com/users/Hananel-Hazan/repos","events_url":"https://api.github.com/users/Hananel-Hazan/events{/privacy}","received_events_url":"https://api.github.com/users/Hananel-Hazan/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/comments/662326910","html_url":"https://github.com/BindsNET/bindsnet/issues/395#issuecomment-662326910","issue_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/395","id":662326910,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjMyNjkxMA==","user":{"login":"SimonInParis","id":45327416,"node_id":"MDQ6VXNlcjQ1MzI3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/45327416?v=4","gravatar_id":"","url":"https://api.github.com/users/SimonInParis","html_url":"https://github.com/SimonInParis","followers_url":"https://api.github.com/users/SimonInParis/followers","following_url":"https://api.github.com/users/SimonInParis/following{/other_user}","gists_url":"https://api.github.com/users/SimonInParis/gists{/gist_id}","starred_url":"https://api.github.com/users/SimonInParis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SimonInParis/subscriptions","organizations_url":"https://api.github.com/users/SimonInParis/orgs","repos_url":"https://api.github.com/users/SimonInParis/repos","events_url":"https://api.github.com/users/SimonInParis/events{/privacy}","received_events_url":"https://api.github.com/users/SimonInParis/received_events","type":"User","site_admin":false},"created_at":"2020-07-22T08:44:37Z","updated_at":"2020-07-22T08:44:37Z","author_association":"COLLABORATOR","body":"Some learning parameters are not located on GPU.\r\n\r\nStep 1.\r\nIn **breakout_stdp.py,** don't forget to add     **device='cuda'** when calling **environment_pipeline = EnvironmentPipeline()**\r\n\r\n\r\nStep 2.\r\nAs a quick fix, you can make this small changes in bindsnet/learning/learning.py:\r\nlines from 549:\r\n\r\n        if not hasattr(self, \"p_plus\"):\r\n            self.p_plus = torch.zeros(batch_size, *self.source.shape)\r\n        if not hasattr(self, \"p_minus\"):\r\n            self.p_minus = torch.zeros(batch_size, *self.target.shape)\r\n        if not hasattr(self, \"eligibility\"):\r\n            self.eligibility = torch.zeros(batch_size, *self.connection.w.shape)\r\n\r\nto :\r\n\r\n        if not hasattr(self, \"p_plus\"):\r\n            self.p_plus = torch.zeros(batch_size, *self.source.shape, device=self.source.s.device)\r\n        if not hasattr(self, \"p_minus\"):\r\n            self.p_minus = torch.zeros(batch_size, *self.target.shape, device=self.source.s.device)\r\n        if not hasattr(self, \"eligibility\"):\r\n            self.eligibility = torch.zeros(batch_size, *self.connection.w.shape, device=self.source.s.device)\r\n\r\n\r\nSorry for this GPU bug. \r\nShould work fine now.","reactions":{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/comments/662326910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"SimonInParis","id":45327416,"node_id":"MDQ6VXNlcjQ1MzI3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/45327416?v=4","gravatar_id":"","url":"https://api.github.com/users/SimonInParis","html_url":"https://github.com/SimonInParis","followers_url":"https://api.github.com/users/SimonInParis/followers","following_url":"https://api.github.com/users/SimonInParis/following{/other_user}","gists_url":"https://api.github.com/users/SimonInParis/gists{/gist_id}","starred_url":"https://api.github.com/users/SimonInParis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SimonInParis/subscriptions","organizations_url":"https://api.github.com/users/SimonInParis/orgs","repos_url":"https://api.github.com/users/SimonInParis/repos","events_url":"https://api.github.com/users/SimonInParis/events{/privacy}","received_events_url":"https://api.github.com/users/SimonInParis/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/comments/662472667","html_url":"https://github.com/BindsNET/bindsnet/issues/395#issuecomment-662472667","issue_url":"https://api.github.com/repos/BindsNET/bindsnet/issues/395","id":662472667,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjQ3MjY2Nw==","user":{"login":"wnourse05","id":25424477,"node_id":"MDQ6VXNlcjI1NDI0NDc3","avatar_url":"https://avatars.githubusercontent.com/u/25424477?v=4","gravatar_id":"","url":"https://api.github.com/users/wnourse05","html_url":"https://github.com/wnourse05","followers_url":"https://api.github.com/users/wnourse05/followers","following_url":"https://api.github.com/users/wnourse05/following{/other_user}","gists_url":"https://api.github.com/users/wnourse05/gists{/gist_id}","starred_url":"https://api.github.com/users/wnourse05/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wnourse05/subscriptions","organizations_url":"https://api.github.com/users/wnourse05/orgs","repos_url":"https://api.github.com/users/wnourse05/repos","events_url":"https://api.github.com/users/wnourse05/events{/privacy}","received_events_url":"https://api.github.com/users/wnourse05/received_events","type":"User","site_admin":false},"created_at":"2020-07-22T14:04:20Z","updated_at":"2020-07-22T14:04:20Z","author_association":"NONE","body":"These changes fixed the issue for me, thank you.","reactions":{"url":"https://api.github.com/repos/BindsNET/bindsnet/issues/comments/662472667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"wnourse05","id":25424477,"node_id":"MDQ6VXNlcjI1NDI0NDc3","avatar_url":"https://avatars.githubusercontent.com/u/25424477?v=4","gravatar_id":"","url":"https://api.github.com/users/wnourse05","html_url":"https://github.com/wnourse05","followers_url":"https://api.github.com/users/wnourse05/followers","following_url":"https://api.github.com/users/wnourse05/following{/other_user}","gists_url":"https://api.github.com/users/wnourse05/gists{/gist_id}","starred_url":"https://api.github.com/users/wnourse05/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wnourse05/subscriptions","organizations_url":"https://api.github.com/users/wnourse05/orgs","repos_url":"https://api.github.com/users/wnourse05/repos","events_url":"https://api.github.com/users/wnourse05/events{/privacy}","received_events_url":"https://api.github.com/users/wnourse05/received_events","type":"User","site_admin":false}},{"id":3575937383,"node_id":"MDExOkNsb3NlZEV2ZW50MzU3NTkzNzM4Mw==","url":"https://api.github.com/repos/BindsNET/bindsnet/issues/events/3575937383","actor":{"login":"wnourse05","id":25424477,"node_id":"MDQ6VXNlcjI1NDI0NDc3","avatar_url":"https://avatars.githubusercontent.com/u/25424477?v=4","gravatar_id":"","url":"https://api.github.com/users/wnourse05","html_url":"https://github.com/wnourse05","followers_url":"https://api.github.com/users/wnourse05/followers","following_url":"https://api.github.com/users/wnourse05/following{/other_user}","gists_url":"https://api.github.com/users/wnourse05/gists{/gist_id}","starred_url":"https://api.github.com/users/wnourse05/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wnourse05/subscriptions","organizations_url":"https://api.github.com/users/wnourse05/orgs","repos_url":"https://api.github.com/users/wnourse05/repos","events_url":"https://api.github.com/users/wnourse05/events{/privacy}","received_events_url":"https://api.github.com/users/wnourse05/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-07-22T14:04:20Z","state_reason":null,"performed_via_github_app":null}]