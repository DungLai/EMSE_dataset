[{"id":2102622275,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjEwMjYyMjI3NQ==","url":"https://api.github.com/repos/MillionIntegrals/vel/issues/events/2102622275","actor":{"login":"sgillen","id":9152639,"node_id":"MDQ6VXNlcjkxNTI2Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/9152639?v=4","gravatar_id":"","url":"https://api.github.com/users/sgillen","html_url":"https://github.com/sgillen","followers_url":"https://api.github.com/users/sgillen/followers","following_url":"https://api.github.com/users/sgillen/following{/other_user}","gists_url":"https://api.github.com/users/sgillen/gists{/gist_id}","starred_url":"https://api.github.com/users/sgillen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgillen/subscriptions","organizations_url":"https://api.github.com/users/sgillen/orgs","repos_url":"https://api.github.com/users/sgillen/repos","events_url":"https://api.github.com/users/sgillen/events{/privacy}","received_events_url":"https://api.github.com/users/sgillen/received_events","type":"User","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2019-01-29T04:35:41Z","rename":{"from":"loading saved models?","to":"Loading saved models?"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/comments/458465618","html_url":"https://github.com/MillionIntegrals/vel/issues/37#issuecomment-458465618","issue_url":"https://api.github.com/repos/MillionIntegrals/vel/issues/37","id":458465618,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1ODQ2NTYxOA==","user":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false},"created_at":"2019-01-29T09:19:08Z","updated_at":"2019-01-29T09:19:08Z","author_association":"OWNER","body":"Hi sgillen!\r\n\r\nThank you for your interest in vel. It seems you're doing quite well with the use of the library ;)\r\n\r\n The problem you're having is related to the fact, that for this environment and configuration observations are normalized (converted to N(0, 1) distribution from the underlying distribution) - it's a common transformation usually performed to keep the inputs to the network at the right scale which helps scale the gradients/learning rate properly.\r\n\r\nIn the current implementation, this normalization is done in the vecenv code (this piece of the walker_ppo config):\r\n\r\n```yaml\r\nvec_env:\r\n  name: vel.rl.vecenv.dummy\r\n  normalize: true  # Normalize observations\r\n```\r\n\r\nAnd sadly enough these parameters are not persisted and don't load with a model. So the model trains with properly scaled inputs (that's why you see high scores during training) - but when loaded, inputs are of different scale and that makes it not work when you load a model.\r\n\r\nWhen initially developing that code, I've used vec env implementation from OpenAI, which introduced that issue. If you read the README file https://github.com/openai/baselines/blob/master/README.md you can find this section:\r\n\r\n\r\n> NOTE: At the moment Mujoco training uses VecNormalize wrapper for the environment which is not \r\n> being saved correctly; so loading the models trained on Mujoco will not work well if the environment is recreated. If necessary, you can work around that by replacing RunningMeanStd by TfRunningMeanStd in baselines/common/vec_env/vec_normalize.py. This way, mean and std of environment normalizing wrapper will be saved in tensorflow variables and included in the model file; however, training is slower that way - hence not including it by default\r\n\r\nSaying that, I've worked on solving this issue for the new release, which is currently being developed on the branch https://github.com/MillionIntegrals/vel/tree/candidate-v0.3 There, normalization is done in PyTorch using this module https://github.com/MillionIntegrals/vel/blob/candidate-v0.3/vel/modules/input/normalize_observations.py instead of VecEnv and in that way it gets saved properly together with a model. \r\n\r\nI still want to do quite a bit of testing before I release this new version, but most likely Walker-PPO will work well in this new version. If you'd like to be able to load this model and inspect it the best way is to check out the candidate-v0.3 branch and rerun the experiment.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/comments/458465618/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false}},{"id":2103058829,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQyMTAzMDU4ODI5","url":"https://api.github.com/repos/MillionIntegrals/vel/issues/events/2103058829","actor":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2019-01-29T09:21:20Z","assignee":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"id":2103059171,"node_id":"MDEyOkxhYmVsZWRFdmVudDIxMDMwNTkxNzE=","url":"https://api.github.com/repos/MillionIntegrals/vel/issues/events/2103059171","actor":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-01-29T09:21:30Z","label":{"name":"question","color":"d876e3"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/comments/458785340","html_url":"https://github.com/MillionIntegrals/vel/issues/37#issuecomment-458785340","issue_url":"https://api.github.com/repos/MillionIntegrals/vel/issues/37","id":458785340,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1ODc4NTM0MA==","user":{"login":"sgillen","id":9152639,"node_id":"MDQ6VXNlcjkxNTI2Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/9152639?v=4","gravatar_id":"","url":"https://api.github.com/users/sgillen","html_url":"https://github.com/sgillen","followers_url":"https://api.github.com/users/sgillen/followers","following_url":"https://api.github.com/users/sgillen/following{/other_user}","gists_url":"https://api.github.com/users/sgillen/gists{/gist_id}","starred_url":"https://api.github.com/users/sgillen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgillen/subscriptions","organizations_url":"https://api.github.com/users/sgillen/orgs","repos_url":"https://api.github.com/users/sgillen/repos","events_url":"https://api.github.com/users/sgillen/events{/privacy}","received_events_url":"https://api.github.com/users/sgillen/received_events","type":"User","site_admin":false},"created_at":"2019-01-30T02:17:41Z","updated_at":"2019-01-30T02:17:41Z","author_association":"NONE","body":"Thank you for the quick response MillionIntegrals, I upgraded to vel 0.3 and after some minor modifications it seems to work like a charm. Glad to see you are actively working on this project. \r\n\r\nWould having a general way of doing this be a desirable feature for you? I.E. given a config file/script and the corresponding .data file load the model and set up the environment? I'll probably wind up doing some limited form of that for my own use anyway. Seems like it would be tricky to add that in a way that actually works for all use cases though...\r\n\r\nEither way, thanks again for your help, and for sharing your code with everyone, it's already been very useful for me. ","reactions":{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/comments/458785340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sgillen","id":9152639,"node_id":"MDQ6VXNlcjkxNTI2Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/9152639?v=4","gravatar_id":"","url":"https://api.github.com/users/sgillen","html_url":"https://github.com/sgillen","followers_url":"https://api.github.com/users/sgillen/followers","following_url":"https://api.github.com/users/sgillen/following{/other_user}","gists_url":"https://api.github.com/users/sgillen/gists{/gist_id}","starred_url":"https://api.github.com/users/sgillen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgillen/subscriptions","organizations_url":"https://api.github.com/users/sgillen/orgs","repos_url":"https://api.github.com/users/sgillen/repos","events_url":"https://api.github.com/users/sgillen/events{/privacy}","received_events_url":"https://api.github.com/users/sgillen/received_events","type":"User","site_admin":false}},{"id":2173242476,"node_id":"MDExOkNsb3NlZEV2ZW50MjE3MzI0MjQ3Ng==","url":"https://api.github.com/repos/MillionIntegrals/vel/issues/events/2173242476","actor":{"login":"sgillen","id":9152639,"node_id":"MDQ6VXNlcjkxNTI2Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/9152639?v=4","gravatar_id":"","url":"https://api.github.com/users/sgillen","html_url":"https://github.com/sgillen","followers_url":"https://api.github.com/users/sgillen/followers","following_url":"https://api.github.com/users/sgillen/following{/other_user}","gists_url":"https://api.github.com/users/sgillen/gists{/gist_id}","starred_url":"https://api.github.com/users/sgillen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgillen/subscriptions","organizations_url":"https://api.github.com/users/sgillen/orgs","repos_url":"https://api.github.com/users/sgillen/repos","events_url":"https://api.github.com/users/sgillen/events{/privacy}","received_events_url":"https://api.github.com/users/sgillen/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-03-01T07:30:10Z","state_reason":null,"performed_via_github_app":null}]