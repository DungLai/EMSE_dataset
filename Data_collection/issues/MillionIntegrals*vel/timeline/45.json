[{"id":2295703863,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQyMjk1NzAzODYz","url":"https://api.github.com/repos/MillionIntegrals/vel/issues/events/2295703863","actor":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2019-04-24T00:32:45Z","assignee":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/comments/486024238","html_url":"https://github.com/MillionIntegrals/vel/issues/45#issuecomment-486024238","issue_url":"https://api.github.com/repos/MillionIntegrals/vel/issues/45","id":486024238,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4NjAyNDIzOA==","user":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false},"created_at":"2019-04-24T00:42:12Z","updated_at":"2019-04-24T00:42:12Z","author_association":"OWNER","body":"I haven't really check this configuration, but as far as the idea I had it should work. I'll check it in a free moment, what goes on there exactly.\r\n\r\nIn the meantime it may be good to tweak some other settings that implicitly also affect the rate of learning. Since with more envs the batch size is significantly bigger, you may try to increase the learning rate as well as decrease `target_update_frequency`. \r\n\r\nIn the meantime, I'll double check for any bugs.","reactions":{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/comments/486024238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/comments/486072255","html_url":"https://github.com/MillionIntegrals/vel/issues/45#issuecomment-486072255","issue_url":"https://api.github.com/repos/MillionIntegrals/vel/issues/45","id":486072255,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4NjA3MjI1NQ==","user":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false},"created_at":"2019-04-24T05:22:02Z","updated_at":"2019-04-24T05:22:02Z","author_association":"OWNER","body":"You can try this config, to see if it works:\r\n\r\n```yaml\r\nname: 'breakout_ddqn'\r\n\r\n\r\nenv:\r\n  name: vel.rl.env.classic_atari\r\n  game: 'BreakoutNoFrameskip-v4'\r\n\r\n\r\nvec_env:\r\n  name: vel.rl.vecenv.shared_mem\r\n  frame_history: 4  # How many stacked frames go into a single observation\r\n\r\n\r\nmodel:\r\n  name: vel.rl.models.q_model\r\n\r\n  input_block:\r\n    name: vel.modules.input.image_to_tensor\r\n\r\n  backbone:\r\n    name: vel.rl.models.backbone.nature_cnn\r\n    input_width: 84\r\n    input_height: 84\r\n    input_channels: 4  # The same as frame_history\r\n\r\n\r\nreinforcer:\r\n  name: vel.rl.reinforcers.buffered_off_policy_iteration_reinforcer\r\n\r\n  env_roller:\r\n    name: vel.rl.env_roller.transition_replay_env_roller\r\n\r\n    replay_buffer:\r\n      name: vel.rl.buffers.circular_replay_buffer\r\n\r\n      buffer_initial_size: 1_000 # How many samples we need in the buffer before we start using replay buffer\r\n      buffer_capacity: 25_000\r\n\r\n      # Because env has a framestack already built-in, save memory by encoding only last frames in the replay buffer\r\n      frame_stack_compensation: true\r\n      frame_history: 4  # How many stacked frames go into a single observation\r\n\r\n    action_noise:\r\n      name: vel.rl.modules.noise.eps_greedy\r\n\r\n      epsilon:\r\n        name: vel.schedules.linear_and_constant\r\n        end_of_interpolation: 0.1\r\n        initial_value: 1.0\r\n        final_value: 0.1\r\n\r\n  algo:\r\n    name: vel.rl.algo.dqn\r\n\r\n    double_dqn: true\r\n    target_update_frequency: 1_000  # After how many batches to update the target network\r\n    max_grad_norm: 0.5\r\n\r\n    discount_factor: 0.99\r\n\r\n  rollout_steps: 4 # How many environment steps (per env) to perform per batch of training\r\n  training_steps: 32 # How many environment steps (per env) to perform per training round\r\n  parallel_envs: 12 # Roll out only one env in parallel, just like in DeepMind paper\r\n\r\n\r\noptimizer:\r\n  name: vel.optimizers.rmsprop\r\n  lr: 2.5e-3\r\n  alpha: 0.95\r\n  momentum: 0.95\r\n  epsilon: 1.0e-1\r\n\r\n\r\ncommands:\r\n  train:\r\n    name: vel.rl.commands.rl_train_command\r\n    total_frames: 1.1e7  # 11M\r\n    batches_per_epoch: 250\r\n```\r\n\r\nI've scaled some other settings to match the increase in batch size. \r\n\r\nI've run it locally for a few epochs to see if there is any speedup vs the non-parallel version and the speedup was there, although it was more of 2x rather than 10x which means there are also other bottlenecks, but it's hard for me to profile it at the moment. \r\n\r\nI was not able to find any obvious problems with the code, but I'm interested if this modified config will work. It's good to try. I've implemented the possibility to try DQN with parallel envs as it sounded as a good idea to me and it unified various algorithms, but I've never really tried it so far.\r\n\r\n\r\nAnother question is how to speed up DQN even further on a single node, I'll take a look at it when I have a free moment, but free moments are scarce...","reactions":{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/comments/486072255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/comments/486522682","html_url":"https://github.com/MillionIntegrals/vel/issues/45#issuecomment-486522682","issue_url":"https://api.github.com/repos/MillionIntegrals/vel/issues/45","id":486522682,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4NjUyMjY4Mg==","user":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false},"created_at":"2019-04-25T05:16:42Z","updated_at":"2019-04-25T05:16:42Z","author_association":"OWNER","body":"I got it to average reward of 117 after 11M frames which is kind of ok, but not great. Probably more hyperparam tweaks are needed to get something better.","reactions":{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/comments/486522682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/comments/490582272","html_url":"https://github.com/MillionIntegrals/vel/issues/45#issuecomment-490582272","issue_url":"https://api.github.com/repos/MillionIntegrals/vel/issues/45","id":490582272,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDU4MjI3Mg==","user":{"login":"maxwab","id":9530743,"node_id":"MDQ6VXNlcjk1MzA3NDM=","avatar_url":"https://avatars.githubusercontent.com/u/9530743?v=4","gravatar_id":"","url":"https://api.github.com/users/maxwab","html_url":"https://github.com/maxwab","followers_url":"https://api.github.com/users/maxwab/followers","following_url":"https://api.github.com/users/maxwab/following{/other_user}","gists_url":"https://api.github.com/users/maxwab/gists{/gist_id}","starred_url":"https://api.github.com/users/maxwab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxwab/subscriptions","organizations_url":"https://api.github.com/users/maxwab/orgs","repos_url":"https://api.github.com/users/maxwab/repos","events_url":"https://api.github.com/users/maxwab/events{/privacy}","received_events_url":"https://api.github.com/users/maxwab/received_events","type":"User","site_admin":false},"created_at":"2019-05-08T17:42:57Z","updated_at":"2019-05-08T17:42:57Z","author_association":"NONE","body":"Thanks for the configuration file! When I tested I also got an average reward of ~110 after 11M frames.\r\nI'll try to play a bit with the parameters. If a combination proves to be successful, I'll keep you updated.","reactions":{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/comments/490582272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"maxwab","id":9530743,"node_id":"MDQ6VXNlcjk1MzA3NDM=","avatar_url":"https://avatars.githubusercontent.com/u/9530743?v=4","gravatar_id":"","url":"https://api.github.com/users/maxwab","html_url":"https://github.com/maxwab","followers_url":"https://api.github.com/users/maxwab/followers","following_url":"https://api.github.com/users/maxwab/following{/other_user}","gists_url":"https://api.github.com/users/maxwab/gists{/gist_id}","starred_url":"https://api.github.com/users/maxwab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxwab/subscriptions","organizations_url":"https://api.github.com/users/maxwab/orgs","repos_url":"https://api.github.com/users/maxwab/repos","events_url":"https://api.github.com/users/maxwab/events{/privacy}","received_events_url":"https://api.github.com/users/maxwab/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/comments/535239803","html_url":"https://github.com/MillionIntegrals/vel/issues/45#issuecomment-535239803","issue_url":"https://api.github.com/repos/MillionIntegrals/vel/issues/45","id":535239803,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTIzOTgwMw==","user":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false},"created_at":"2019-09-25T22:01:14Z","updated_at":"2019-09-25T22:01:14Z","author_association":"OWNER","body":"I'll close this issue now.","reactions":{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/comments/535239803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false}},{"id":2663284931,"node_id":"MDExOkNsb3NlZEV2ZW50MjY2MzI4NDkzMQ==","url":"https://api.github.com/repos/MillionIntegrals/vel/issues/events/2663284931","actor":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-09-25T22:01:14Z","state_reason":null,"performed_via_github_app":null}]