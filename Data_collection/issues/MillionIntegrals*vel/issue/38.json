{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/38","repository_url":"https://api.github.com/repos/MillionIntegrals/vel","labels_url":"https://api.github.com/repos/MillionIntegrals/vel/issues/38/labels{/name}","comments_url":"https://api.github.com/repos/MillionIntegrals/vel/issues/38/comments","events_url":"https://api.github.com/repos/MillionIntegrals/vel/issues/38/events","html_url":"https://github.com/MillionIntegrals/vel/issues/38","id":412181654,"node_id":"MDU6SXNzdWU0MTIxODE2NTQ=","number":38,"title":"[v0.3] Record command getting Type exception using NormalizeObservations","user":{"login":"joecargill","id":23087543,"node_id":"MDQ6VXNlcjIzMDg3NTQz","avatar_url":"https://avatars.githubusercontent.com/u/23087543?v=4","gravatar_id":"","url":"https://api.github.com/users/joecargill","html_url":"https://github.com/joecargill","followers_url":"https://api.github.com/users/joecargill/followers","following_url":"https://api.github.com/users/joecargill/following{/other_user}","gists_url":"https://api.github.com/users/joecargill/gists{/gist_id}","starred_url":"https://api.github.com/users/joecargill/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joecargill/subscriptions","organizations_url":"https://api.github.com/users/joecargill/orgs","repos_url":"https://api.github.com/users/joecargill/repos","events_url":"https://api.github.com/users/joecargill/events{/privacy}","received_events_url":"https://api.github.com/users/joecargill/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-02-20T00:01:29Z","updated_at":"2019-03-29T07:09:23Z","closed_at":"2019-03-29T07:09:23Z","author_association":"NONE","active_lock_reason":null,"body":"Hey,\r\n\r\nI have been trying out Vel for a day or two now, using it with a few gym classic control environments. \r\n\r\nOne issue I have run into is when I use the `vel configs/cartpole_dqn.yaml record` command I get the following:\r\n\r\n```\r\nRuntimeError: expected type torch.cuda.DoubleTensor but got torch.cuda.FloatTensor\r\n```\r\n\r\nI have worked around the issue by editing the `normalize_observations.py` file `register_buffer` functions to expect `dtype=torch.double` when I intend to use the Record command, and change it back to `torch.float` when I want to train, but hopefully you can figure out what is causing it as I cannot (I am a bit of newbie with PyTorch).\r\n\r\nHere is the full stack trace:\r\n\r\n```\r\nEvaluating environment...\r\nTraceback (most recent call last):\r\n  File \"/home/j/anaconda3/bin/vel\", line 11, in <module>\r\n    load_entry_point('vel', 'console_scripts', 'vel')()\r\n  File \"/home/j/dev/vel/vel/launcher.py\", line 64, in main\r\n    model_config.run_command(args.command, args.varargs)\r\n  File \"/home/j/dev/vel/vel/internals/model_config.py\", line 119, in run_command\r\n    return command_descriptor.run(*varargs)\r\n  File \"/home/j/dev/vel/vel/rl/commands/record_movie_command.py\", line 43, in run\r\n    self.record_take(model, env, device, take_number=i + 1)\r\n  File \"/home/j/anaconda3/lib/python3.6/site-packages/torch/autograd/grad_mode.py\", line 43, in decorate_no_grad\r\n    return func(*args, **kwargs)\r\n  File \"/home/j/dev/vel/vel/rl/commands/record_movie_command.py\", line 68, in record_take\r\n    actions = model.step(observation_tensor, **self.sample_args)['actions']\r\n  File \"/home/j/dev/vel/vel/rl/models/q_model.py\", line 65, in step\r\n    q_values = self(observations)\r\n  File \"/home/j/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/j/dev/vel/vel/rl/models/q_model.py\", line 58, in forward\r\n    observations = self.input_block(observations)\r\n  File \"/home/j/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/j/dev/vel/vel/modules/input/normalize_observations.py\", line 48, in forward\r\n    return (input_vector- self.running_mean.unsqueeze(0)) / torch.sqrt(self.running_var.unsqueeze(0))\r\nRuntimeError: expected type torch.cuda.DoubleTensor but got torch.cuda.FloatTensor\r\n```","closed_by":{"login":"MillionIntegrals","id":2262651,"node_id":"MDQ6VXNlcjIyNjI2NTE=","avatar_url":"https://avatars.githubusercontent.com/u/2262651?v=4","gravatar_id":"","url":"https://api.github.com/users/MillionIntegrals","html_url":"https://github.com/MillionIntegrals","followers_url":"https://api.github.com/users/MillionIntegrals/followers","following_url":"https://api.github.com/users/MillionIntegrals/following{/other_user}","gists_url":"https://api.github.com/users/MillionIntegrals/gists{/gist_id}","starred_url":"https://api.github.com/users/MillionIntegrals/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MillionIntegrals/subscriptions","organizations_url":"https://api.github.com/users/MillionIntegrals/orgs","repos_url":"https://api.github.com/users/MillionIntegrals/repos","events_url":"https://api.github.com/users/MillionIntegrals/events{/privacy}","received_events_url":"https://api.github.com/users/MillionIntegrals/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/MillionIntegrals/vel/issues/38/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/MillionIntegrals/vel/issues/38/timeline","performed_via_github_app":null,"state_reason":"completed"}