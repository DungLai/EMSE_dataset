{"url":"https://api.github.com/repos/NUAA-AL/ALiPy/issues/26","repository_url":"https://api.github.com/repos/NUAA-AL/ALiPy","labels_url":"https://api.github.com/repos/NUAA-AL/ALiPy/issues/26/labels{/name}","comments_url":"https://api.github.com/repos/NUAA-AL/ALiPy/issues/26/comments","events_url":"https://api.github.com/repos/NUAA-AL/ALiPy/issues/26/events","html_url":"https://github.com/NUAA-AL/ALiPy/issues/26","id":642612059,"node_id":"MDU6SXNzdWU2NDI2MTIwNTk=","number":26,"title":"Problem with ExpectedErrorReduction for instance selection","user":{"login":"JuliaMasche","id":16819450,"node_id":"MDQ6VXNlcjE2ODE5NDUw","avatar_url":"https://avatars.githubusercontent.com/u/16819450?v=4","gravatar_id":"","url":"https://api.github.com/users/JuliaMasche","html_url":"https://github.com/JuliaMasche","followers_url":"https://api.github.com/users/JuliaMasche/followers","following_url":"https://api.github.com/users/JuliaMasche/following{/other_user}","gists_url":"https://api.github.com/users/JuliaMasche/gists{/gist_id}","starred_url":"https://api.github.com/users/JuliaMasche/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JuliaMasche/subscriptions","organizations_url":"https://api.github.com/users/JuliaMasche/orgs","repos_url":"https://api.github.com/users/JuliaMasche/repos","events_url":"https://api.github.com/users/JuliaMasche/events{/privacy}","received_events_url":"https://api.github.com/users/JuliaMasche/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-06-21T18:05:39Z","updated_at":"2020-06-23T01:43:18Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi,\r\n\r\nI am running experiments for multi-class classification and get the following error for EpectedErrorReduction:\r\nFile \"/home/julia/master_thesis/env/lib/python3.6/site-packages/alipy/query_strategy/query_labels.py\", line 829, in select\r\n    score.append(pv[i, yi] * self.log_loss(prob))\r\nIndexError: index 4 is out of bounds for axis 1 with size 4\r\n\r\nI think the Error is that my initial seed set (label index) does not contain all labels which can be found in y.\r\nIn the following code, shouldn't it be \r\n\r\nclasses = np.unique(label_y)\r\ninstead of\r\nclasses = np.unique(self.y)?\r\n\r\n\r\n\r\n``   if self.X is None or self.y is None:\r\n            raise Exception('Data matrix is not provided.')\r\n        if model is None:\r\n            model = LogisticRegression(solver='liblinear')\r\n            model.fit(self.X[label_index if isinstance(label_index, (list, np.ndarray)) else label_index.index],\r\n                      self.y[label_index if isinstance(label_index, (list, np.ndarray)) else label_index.index])\r\n\r\n        unlabel_x = self.X[unlabel_index]\r\n        label_y = self.y[label_index]\r\n        ##################################\r\n\r\n        classes = np.unique(self.y)\r\n        pv, spv = _get_proba_pred(unlabel_x, model)\r\n        scores = []\r\n        for i in range(spv[0]):\r\n            new_train_inds = np.append(label_index, unlabel_index[i])\r\n            new_train_X = self.X[new_train_inds, :]\r\n            unlabel_ind = list(unlabel_index)\r\n            unlabel_ind.pop(i)\r\n            new_unlabel_X = self.X[unlabel_ind, :]\r\n            score = []\r\n            for yi in classes:\r\n                new_model = copy.deepcopy(model)\r\n                new_model.fit(new_train_X, np.append(label_y, yi))\r\n                prob = new_model.predict_proba(new_unlabel_X)\r\n                score.append(pv[i, yi] * self.log_loss(prob))\r\n            scores.append(np.sum(score))\r\n\r\n        return unlabel_index[nsmallestarg(scores, batch_size)]``\r\n\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/NUAA-AL/ALiPy/issues/26/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/NUAA-AL/ALiPy/issues/26/timeline","performed_via_github_app":null,"state_reason":null}