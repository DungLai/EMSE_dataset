[{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/475950025","html_url":"https://github.com/ultralytics/yolov3/issues/152#issuecomment-475950025","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/152","id":475950025,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NTk1MDAyNQ==","user":{"login":"gabrielloye","id":46185613,"node_id":"MDQ6VXNlcjQ2MTg1NjEz","avatar_url":"https://avatars.githubusercontent.com/u/46185613?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielloye","html_url":"https://github.com/gabrielloye","followers_url":"https://api.github.com/users/gabrielloye/followers","following_url":"https://api.github.com/users/gabrielloye/following{/other_user}","gists_url":"https://api.github.com/users/gabrielloye/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielloye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielloye/subscriptions","organizations_url":"https://api.github.com/users/gabrielloye/orgs","repos_url":"https://api.github.com/users/gabrielloye/repos","events_url":"https://api.github.com/users/gabrielloye/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielloye/received_events","type":"User","site_admin":false},"created_at":"2019-03-24T11:30:08Z","updated_at":"2019-03-24T11:30:08Z","author_association":"NONE","body":"Hi @hxy1051653358 ,\r\nNot sure if this is the best practice but what I did was to remove the weights for the yolo layers from your own weights. This is because the sizes of the yolo layers in your new model and old weights do not match (as described in the error message).\r\nAdding this line after loading your own weights in the training script will remove the mismatched weights:\r\n```\r\n if resume:\r\n        checkpoint = torch.load(latest, map_location='cpu')\r\n        mod_weights = removekey(checkpoint['model'],['module_list.104.conv_104.weight', 'module_list.104.conv_104.bias', 'module_list.116.conv_116.weight', 'module_list.116.conv_116.bias', 'module_list.128.conv_128.weight', 'module_list.128.conv_128.bias'])\r\n        model.load_state_dict(mod_weights, strict=False)\r\n```","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/475950025/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gabrielloye","id":46185613,"node_id":"MDQ6VXNlcjQ2MTg1NjEz","avatar_url":"https://avatars.githubusercontent.com/u/46185613?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielloye","html_url":"https://github.com/gabrielloye","followers_url":"https://api.github.com/users/gabrielloye/followers","following_url":"https://api.github.com/users/gabrielloye/following{/other_user}","gists_url":"https://api.github.com/users/gabrielloye/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielloye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielloye/subscriptions","organizations_url":"https://api.github.com/users/gabrielloye/orgs","repos_url":"https://api.github.com/users/gabrielloye/repos","events_url":"https://api.github.com/users/gabrielloye/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielloye/received_events","type":"User","site_admin":false}},{"id":2224802631,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjIyNDgwMjYzMQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2224802631","actor":{"login":"hxy1051653358","id":43035276,"node_id":"MDQ6VXNlcjQzMDM1Mjc2","avatar_url":"https://avatars.githubusercontent.com/u/43035276?v=4","gravatar_id":"","url":"https://api.github.com/users/hxy1051653358","html_url":"https://github.com/hxy1051653358","followers_url":"https://api.github.com/users/hxy1051653358/followers","following_url":"https://api.github.com/users/hxy1051653358/following{/other_user}","gists_url":"https://api.github.com/users/hxy1051653358/gists{/gist_id}","starred_url":"https://api.github.com/users/hxy1051653358/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hxy1051653358/subscriptions","organizations_url":"https://api.github.com/users/hxy1051653358/orgs","repos_url":"https://api.github.com/users/hxy1051653358/repos","events_url":"https://api.github.com/users/hxy1051653358/events{/privacy}","received_events_url":"https://api.github.com/users/hxy1051653358/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-03-24T11:30:09Z","performed_via_github_app":null},{"id":2224802632,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyMjQ4MDI2MzI=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2224802632","actor":{"login":"hxy1051653358","id":43035276,"node_id":"MDQ6VXNlcjQzMDM1Mjc2","avatar_url":"https://avatars.githubusercontent.com/u/43035276?v=4","gravatar_id":"","url":"https://api.github.com/users/hxy1051653358","html_url":"https://github.com/hxy1051653358","followers_url":"https://api.github.com/users/hxy1051653358/followers","following_url":"https://api.github.com/users/hxy1051653358/following{/other_user}","gists_url":"https://api.github.com/users/hxy1051653358/gists{/gist_id}","starred_url":"https://api.github.com/users/hxy1051653358/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hxy1051653358/subscriptions","organizations_url":"https://api.github.com/users/hxy1051653358/orgs","repos_url":"https://api.github.com/users/hxy1051653358/repos","events_url":"https://api.github.com/users/hxy1051653358/events{/privacy}","received_events_url":"https://api.github.com/users/hxy1051653358/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-03-24T11:30:09Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/475964157","html_url":"https://github.com/ultralytics/yolov3/issues/152#issuecomment-475964157","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/152","id":475964157,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NTk2NDE1Nw==","user":{"login":"hxy1051653358","id":43035276,"node_id":"MDQ6VXNlcjQzMDM1Mjc2","avatar_url":"https://avatars.githubusercontent.com/u/43035276?v=4","gravatar_id":"","url":"https://api.github.com/users/hxy1051653358","html_url":"https://github.com/hxy1051653358","followers_url":"https://api.github.com/users/hxy1051653358/followers","following_url":"https://api.github.com/users/hxy1051653358/following{/other_user}","gists_url":"https://api.github.com/users/hxy1051653358/gists{/gist_id}","starred_url":"https://api.github.com/users/hxy1051653358/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hxy1051653358/subscriptions","organizations_url":"https://api.github.com/users/hxy1051653358/orgs","repos_url":"https://api.github.com/users/hxy1051653358/repos","events_url":"https://api.github.com/users/hxy1051653358/events{/privacy}","received_events_url":"https://api.github.com/users/hxy1051653358/received_events","type":"User","site_admin":false},"created_at":"2019-03-24T14:23:45Z","updated_at":"2019-03-24T14:23:45Z","author_association":"NONE","body":"@gabrielloye Thanks for your guidance, I will try your approach","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/475964157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hxy1051653358","id":43035276,"node_id":"MDQ6VXNlcjQzMDM1Mjc2","avatar_url":"https://avatars.githubusercontent.com/u/43035276?v=4","gravatar_id":"","url":"https://api.github.com/users/hxy1051653358","html_url":"https://github.com/hxy1051653358","followers_url":"https://api.github.com/users/hxy1051653358/followers","following_url":"https://api.github.com/users/hxy1051653358/following{/other_user}","gists_url":"https://api.github.com/users/hxy1051653358/gists{/gist_id}","starred_url":"https://api.github.com/users/hxy1051653358/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hxy1051653358/subscriptions","organizations_url":"https://api.github.com/users/hxy1051653358/orgs","repos_url":"https://api.github.com/users/hxy1051653358/repos","events_url":"https://api.github.com/users/hxy1051653358/events{/privacy}","received_events_url":"https://api.github.com/users/hxy1051653358/received_events","type":"User","site_admin":false}},{"id":2224880087,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjIyNDg4MDA4Nw==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2224880087","actor":{"login":"gabrielloye","id":46185613,"node_id":"MDQ6VXNlcjQ2MTg1NjEz","avatar_url":"https://avatars.githubusercontent.com/u/46185613?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielloye","html_url":"https://github.com/gabrielloye","followers_url":"https://api.github.com/users/gabrielloye/followers","following_url":"https://api.github.com/users/gabrielloye/following{/other_user}","gists_url":"https://api.github.com/users/gabrielloye/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielloye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielloye/subscriptions","organizations_url":"https://api.github.com/users/gabrielloye/orgs","repos_url":"https://api.github.com/users/gabrielloye/repos","events_url":"https://api.github.com/users/gabrielloye/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielloye/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-03-24T14:23:45Z","performed_via_github_app":null},{"id":2224880088,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyMjQ4ODAwODg=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2224880088","actor":{"login":"gabrielloye","id":46185613,"node_id":"MDQ6VXNlcjQ2MTg1NjEz","avatar_url":"https://avatars.githubusercontent.com/u/46185613?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielloye","html_url":"https://github.com/gabrielloye","followers_url":"https://api.github.com/users/gabrielloye/followers","following_url":"https://api.github.com/users/gabrielloye/following{/other_user}","gists_url":"https://api.github.com/users/gabrielloye/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielloye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielloye/subscriptions","organizations_url":"https://api.github.com/users/gabrielloye/orgs","repos_url":"https://api.github.com/users/gabrielloye/repos","events_url":"https://api.github.com/users/gabrielloye/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielloye/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-03-24T14:23:45Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/476028950","html_url":"https://github.com/ultralytics/yolov3/issues/152#issuecomment-476028950","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/152","id":476028950,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NjAyODk1MA==","user":{"login":"hxy1051653358","id":43035276,"node_id":"MDQ6VXNlcjQzMDM1Mjc2","avatar_url":"https://avatars.githubusercontent.com/u/43035276?v=4","gravatar_id":"","url":"https://api.github.com/users/hxy1051653358","html_url":"https://github.com/hxy1051653358","followers_url":"https://api.github.com/users/hxy1051653358/followers","following_url":"https://api.github.com/users/hxy1051653358/following{/other_user}","gists_url":"https://api.github.com/users/hxy1051653358/gists{/gist_id}","starred_url":"https://api.github.com/users/hxy1051653358/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hxy1051653358/subscriptions","organizations_url":"https://api.github.com/users/hxy1051653358/orgs","repos_url":"https://api.github.com/users/hxy1051653358/repos","events_url":"https://api.github.com/users/hxy1051653358/events{/privacy}","received_events_url":"https://api.github.com/users/hxy1051653358/received_events","type":"User","site_admin":false},"created_at":"2019-03-25T01:58:30Z","updated_at":"2019-03-25T01:58:30Z","author_association":"NONE","body":"@gabrielloye How can I define removekey?","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/476028950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hxy1051653358","id":43035276,"node_id":"MDQ6VXNlcjQzMDM1Mjc2","avatar_url":"https://avatars.githubusercontent.com/u/43035276?v=4","gravatar_id":"","url":"https://api.github.com/users/hxy1051653358","html_url":"https://github.com/hxy1051653358","followers_url":"https://api.github.com/users/hxy1051653358/followers","following_url":"https://api.github.com/users/hxy1051653358/following{/other_user}","gists_url":"https://api.github.com/users/hxy1051653358/gists{/gist_id}","starred_url":"https://api.github.com/users/hxy1051653358/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hxy1051653358/subscriptions","organizations_url":"https://api.github.com/users/hxy1051653358/orgs","repos_url":"https://api.github.com/users/hxy1051653358/repos","events_url":"https://api.github.com/users/hxy1051653358/events{/privacy}","received_events_url":"https://api.github.com/users/hxy1051653358/received_events","type":"User","site_admin":false}},{"id":2225250467,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjIyNTI1MDQ2Nw==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2225250467","actor":{"login":"gabrielloye","id":46185613,"node_id":"MDQ6VXNlcjQ2MTg1NjEz","avatar_url":"https://avatars.githubusercontent.com/u/46185613?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielloye","html_url":"https://github.com/gabrielloye","followers_url":"https://api.github.com/users/gabrielloye/followers","following_url":"https://api.github.com/users/gabrielloye/following{/other_user}","gists_url":"https://api.github.com/users/gabrielloye/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielloye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielloye/subscriptions","organizations_url":"https://api.github.com/users/gabrielloye/orgs","repos_url":"https://api.github.com/users/gabrielloye/repos","events_url":"https://api.github.com/users/gabrielloye/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielloye/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-03-25T01:58:31Z","performed_via_github_app":null},{"id":2225250469,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyMjUyNTA0Njk=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2225250469","actor":{"login":"gabrielloye","id":46185613,"node_id":"MDQ6VXNlcjQ2MTg1NjEz","avatar_url":"https://avatars.githubusercontent.com/u/46185613?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielloye","html_url":"https://github.com/gabrielloye","followers_url":"https://api.github.com/users/gabrielloye/followers","following_url":"https://api.github.com/users/gabrielloye/following{/other_user}","gists_url":"https://api.github.com/users/gabrielloye/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielloye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielloye/subscriptions","organizations_url":"https://api.github.com/users/gabrielloye/orgs","repos_url":"https://api.github.com/users/gabrielloye/repos","events_url":"https://api.github.com/users/gabrielloye/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielloye/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-03-25T01:58:31Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/476038105","html_url":"https://github.com/ultralytics/yolov3/issues/152#issuecomment-476038105","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/152","id":476038105,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NjAzODEwNQ==","user":{"login":"gabrielloye","id":46185613,"node_id":"MDQ6VXNlcjQ2MTg1NjEz","avatar_url":"https://avatars.githubusercontent.com/u/46185613?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielloye","html_url":"https://github.com/gabrielloye","followers_url":"https://api.github.com/users/gabrielloye/followers","following_url":"https://api.github.com/users/gabrielloye/following{/other_user}","gists_url":"https://api.github.com/users/gabrielloye/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielloye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielloye/subscriptions","organizations_url":"https://api.github.com/users/gabrielloye/orgs","repos_url":"https://api.github.com/users/gabrielloye/repos","events_url":"https://api.github.com/users/gabrielloye/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielloye/received_events","type":"User","site_admin":false},"created_at":"2019-03-25T02:57:22Z","updated_at":"2019-03-25T02:57:22Z","author_association":"NONE","body":"@hxy1051653358 Oh I forgot to include that part as well, my bad. Here:\r\n```\r\ndef removekey(d, listofkeys):\r\n    r = dict(d)\r\n    for key in listofkeys:\r\n        print('key: {} is removed'.format(key))\r\n        r.pop(key)\r\n    return r\r\n```","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/476038105/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gabrielloye","id":46185613,"node_id":"MDQ6VXNlcjQ2MTg1NjEz","avatar_url":"https://avatars.githubusercontent.com/u/46185613?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielloye","html_url":"https://github.com/gabrielloye","followers_url":"https://api.github.com/users/gabrielloye/followers","following_url":"https://api.github.com/users/gabrielloye/following{/other_user}","gists_url":"https://api.github.com/users/gabrielloye/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielloye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielloye/subscriptions","organizations_url":"https://api.github.com/users/gabrielloye/orgs","repos_url":"https://api.github.com/users/gabrielloye/repos","events_url":"https://api.github.com/users/gabrielloye/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielloye/received_events","type":"User","site_admin":false}},{"id":2225311916,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjIyNTMxMTkxNg==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2225311916","actor":{"login":"hxy1051653358","id":43035276,"node_id":"MDQ6VXNlcjQzMDM1Mjc2","avatar_url":"https://avatars.githubusercontent.com/u/43035276?v=4","gravatar_id":"","url":"https://api.github.com/users/hxy1051653358","html_url":"https://github.com/hxy1051653358","followers_url":"https://api.github.com/users/hxy1051653358/followers","following_url":"https://api.github.com/users/hxy1051653358/following{/other_user}","gists_url":"https://api.github.com/users/hxy1051653358/gists{/gist_id}","starred_url":"https://api.github.com/users/hxy1051653358/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hxy1051653358/subscriptions","organizations_url":"https://api.github.com/users/hxy1051653358/orgs","repos_url":"https://api.github.com/users/hxy1051653358/repos","events_url":"https://api.github.com/users/hxy1051653358/events{/privacy}","received_events_url":"https://api.github.com/users/hxy1051653358/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-03-25T02:57:22Z","performed_via_github_app":null},{"id":2225311917,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyMjUzMTE5MTc=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2225311917","actor":{"login":"hxy1051653358","id":43035276,"node_id":"MDQ6VXNlcjQzMDM1Mjc2","avatar_url":"https://avatars.githubusercontent.com/u/43035276?v=4","gravatar_id":"","url":"https://api.github.com/users/hxy1051653358","html_url":"https://github.com/hxy1051653358","followers_url":"https://api.github.com/users/hxy1051653358/followers","following_url":"https://api.github.com/users/hxy1051653358/following{/other_user}","gists_url":"https://api.github.com/users/hxy1051653358/gists{/gist_id}","starred_url":"https://api.github.com/users/hxy1051653358/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hxy1051653358/subscriptions","organizations_url":"https://api.github.com/users/hxy1051653358/orgs","repos_url":"https://api.github.com/users/hxy1051653358/repos","events_url":"https://api.github.com/users/hxy1051653358/events{/privacy}","received_events_url":"https://api.github.com/users/hxy1051653358/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-03-25T02:57:22Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/476112284","html_url":"https://github.com/ultralytics/yolov3/issues/152#issuecomment-476112284","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/152","id":476112284,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NjExMjI4NA==","user":{"login":"perry0418","id":34980036,"node_id":"MDQ6VXNlcjM0OTgwMDM2","avatar_url":"https://avatars.githubusercontent.com/u/34980036?v=4","gravatar_id":"","url":"https://api.github.com/users/perry0418","html_url":"https://github.com/perry0418","followers_url":"https://api.github.com/users/perry0418/followers","following_url":"https://api.github.com/users/perry0418/following{/other_user}","gists_url":"https://api.github.com/users/perry0418/gists{/gist_id}","starred_url":"https://api.github.com/users/perry0418/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/perry0418/subscriptions","organizations_url":"https://api.github.com/users/perry0418/orgs","repos_url":"https://api.github.com/users/perry0418/repos","events_url":"https://api.github.com/users/perry0418/events{/privacy}","received_events_url":"https://api.github.com/users/perry0418/received_events","type":"User","site_admin":false},"created_at":"2019-03-25T09:14:37Z","updated_at":"2019-03-25T09:14:37Z","author_association":"CONTRIBUTOR","body":"make sure your cfg file end with 'yolov3.cfg', and it will load the darknet53 weight for transfer learning. \r\nsee the train.py line 58        `        if cfg.endswith('yolov3.cfg'):\r\n            cutoff = load_darknet_weights(model, weights + 'darknet53.conv.74')` ","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/476112284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"perry0418","id":34980036,"node_id":"MDQ6VXNlcjM0OTgwMDM2","avatar_url":"https://avatars.githubusercontent.com/u/34980036?v=4","gravatar_id":"","url":"https://api.github.com/users/perry0418","html_url":"https://github.com/perry0418","followers_url":"https://api.github.com/users/perry0418/followers","following_url":"https://api.github.com/users/perry0418/following{/other_user}","gists_url":"https://api.github.com/users/perry0418/gists{/gist_id}","starred_url":"https://api.github.com/users/perry0418/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/perry0418/subscriptions","organizations_url":"https://api.github.com/users/perry0418/orgs","repos_url":"https://api.github.com/users/perry0418/repos","events_url":"https://api.github.com/users/perry0418/events{/privacy}","received_events_url":"https://api.github.com/users/perry0418/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/477523388","html_url":"https://github.com/ultralytics/yolov3/issues/152#issuecomment-477523388","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/152","id":477523388,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NzUyMzM4OA==","user":{"login":"100330706","id":48351782,"node_id":"MDQ6VXNlcjQ4MzUxNzgy","avatar_url":"https://avatars.githubusercontent.com/u/48351782?v=4","gravatar_id":"","url":"https://api.github.com/users/100330706","html_url":"https://github.com/100330706","followers_url":"https://api.github.com/users/100330706/followers","following_url":"https://api.github.com/users/100330706/following{/other_user}","gists_url":"https://api.github.com/users/100330706/gists{/gist_id}","starred_url":"https://api.github.com/users/100330706/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/100330706/subscriptions","organizations_url":"https://api.github.com/users/100330706/orgs","repos_url":"https://api.github.com/users/100330706/repos","events_url":"https://api.github.com/users/100330706/events{/privacy}","received_events_url":"https://api.github.com/users/100330706/received_events","type":"User","site_admin":false},"created_at":"2019-03-28T09:47:20Z","updated_at":"2019-03-28T09:47:20Z","author_association":"NONE","body":"@gabrielloye So with your method you use the old weights (randomly initialized or whatever) for layers 104, 116 and 128 whereas the rest of the network uses the new transferred weights, isn't it? Or does this remove any layer?","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/477523388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"100330706","id":48351782,"node_id":"MDQ6VXNlcjQ4MzUxNzgy","avatar_url":"https://avatars.githubusercontent.com/u/48351782?v=4","gravatar_id":"","url":"https://api.github.com/users/100330706","html_url":"https://github.com/100330706","followers_url":"https://api.github.com/users/100330706/followers","following_url":"https://api.github.com/users/100330706/following{/other_user}","gists_url":"https://api.github.com/users/100330706/gists{/gist_id}","starred_url":"https://api.github.com/users/100330706/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/100330706/subscriptions","organizations_url":"https://api.github.com/users/100330706/orgs","repos_url":"https://api.github.com/users/100330706/repos","events_url":"https://api.github.com/users/100330706/events{/privacy}","received_events_url":"https://api.github.com/users/100330706/received_events","type":"User","site_admin":false}},{"id":2235687045,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjIzNTY4NzA0NQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2235687045","actor":{"login":"gabrielloye","id":46185613,"node_id":"MDQ6VXNlcjQ2MTg1NjEz","avatar_url":"https://avatars.githubusercontent.com/u/46185613?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielloye","html_url":"https://github.com/gabrielloye","followers_url":"https://api.github.com/users/gabrielloye/followers","following_url":"https://api.github.com/users/gabrielloye/following{/other_user}","gists_url":"https://api.github.com/users/gabrielloye/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielloye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielloye/subscriptions","organizations_url":"https://api.github.com/users/gabrielloye/orgs","repos_url":"https://api.github.com/users/gabrielloye/repos","events_url":"https://api.github.com/users/gabrielloye/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielloye/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-03-28T09:47:20Z","performed_via_github_app":null},{"id":2235687048,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyMzU2ODcwNDg=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2235687048","actor":{"login":"gabrielloye","id":46185613,"node_id":"MDQ6VXNlcjQ2MTg1NjEz","avatar_url":"https://avatars.githubusercontent.com/u/46185613?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielloye","html_url":"https://github.com/gabrielloye","followers_url":"https://api.github.com/users/gabrielloye/followers","following_url":"https://api.github.com/users/gabrielloye/following{/other_user}","gists_url":"https://api.github.com/users/gabrielloye/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielloye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielloye/subscriptions","organizations_url":"https://api.github.com/users/gabrielloye/orgs","repos_url":"https://api.github.com/users/gabrielloye/repos","events_url":"https://api.github.com/users/gabrielloye/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielloye/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-03-28T09:47:20Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/477683004","html_url":"https://github.com/ultralytics/yolov3/issues/152#issuecomment-477683004","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/152","id":477683004,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NzY4MzAwNA==","user":{"login":"gabrielloye","id":46185613,"node_id":"MDQ6VXNlcjQ2MTg1NjEz","avatar_url":"https://avatars.githubusercontent.com/u/46185613?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielloye","html_url":"https://github.com/gabrielloye","followers_url":"https://api.github.com/users/gabrielloye/followers","following_url":"https://api.github.com/users/gabrielloye/following{/other_user}","gists_url":"https://api.github.com/users/gabrielloye/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielloye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielloye/subscriptions","organizations_url":"https://api.github.com/users/gabrielloye/orgs","repos_url":"https://api.github.com/users/gabrielloye/repos","events_url":"https://api.github.com/users/gabrielloye/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielloye/received_events","type":"User","site_admin":false},"created_at":"2019-03-28T16:57:50Z","updated_at":"2019-03-28T17:07:28Z","author_association":"NONE","body":"@100330706 Nope, it doesn't remove any layer, what I did was to load the transferred weights and remove the yolo layers (104, 116, 128 in this case) first. I then load the old weights that fit the model (depends on the cfg you're using) and call the .update() method on it with the transferred weights. This will transfer all the layers of the transferred weights to the old weights except the ones we removed earlier. Finally, you can load the model with this \"new\" set of weights.\r\nThe code snippet below should be able to work when you add it in train.py\r\n```\r\ncheckpoint = torch.load(latest, map_location=device)  # load checkpoint\r\nmod_weights = removekey(checkpoint['model'],[--list of layers to remove ( i.e. 104, 116, 128)--])\r\nload_darknet_weights(model, weights + 'darknet53.conv.74')\r\nmodel_dict = model.state_dict()\r\nmodel_dict.update(mod_weights)\r\nmodel.load_state_dict(model_dict)\r\n```\r\nRemember to change the number in the below line according to your config as well since you're doing transfer learning: \r\n```\r\n    #Transfer learning (train only YOLO layers)\r\n    for i, (name, p) in enumerate(model.named_parameters()):\r\n        p.requires_grad = True if (p.shape[0] == 30) else False\r\n```\r\nNote: I'm using the latest version, and I had to comment out the scheduler to make this work.","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/477683004/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gabrielloye","id":46185613,"node_id":"MDQ6VXNlcjQ2MTg1NjEz","avatar_url":"https://avatars.githubusercontent.com/u/46185613?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielloye","html_url":"https://github.com/gabrielloye","followers_url":"https://api.github.com/users/gabrielloye/followers","following_url":"https://api.github.com/users/gabrielloye/following{/other_user}","gists_url":"https://api.github.com/users/gabrielloye/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielloye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielloye/subscriptions","organizations_url":"https://api.github.com/users/gabrielloye/orgs","repos_url":"https://api.github.com/users/gabrielloye/repos","events_url":"https://api.github.com/users/gabrielloye/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielloye/received_events","type":"User","site_admin":false}},{"id":2236960410,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjIzNjk2MDQxMA==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2236960410","actor":{"login":"100330706","id":48351782,"node_id":"MDQ6VXNlcjQ4MzUxNzgy","avatar_url":"https://avatars.githubusercontent.com/u/48351782?v=4","gravatar_id":"","url":"https://api.github.com/users/100330706","html_url":"https://github.com/100330706","followers_url":"https://api.github.com/users/100330706/followers","following_url":"https://api.github.com/users/100330706/following{/other_user}","gists_url":"https://api.github.com/users/100330706/gists{/gist_id}","starred_url":"https://api.github.com/users/100330706/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/100330706/subscriptions","organizations_url":"https://api.github.com/users/100330706/orgs","repos_url":"https://api.github.com/users/100330706/repos","events_url":"https://api.github.com/users/100330706/events{/privacy}","received_events_url":"https://api.github.com/users/100330706/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-03-28T16:57:50Z","performed_via_github_app":null},{"id":2236960414,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyMzY5NjA0MTQ=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2236960414","actor":{"login":"100330706","id":48351782,"node_id":"MDQ6VXNlcjQ4MzUxNzgy","avatar_url":"https://avatars.githubusercontent.com/u/48351782?v=4","gravatar_id":"","url":"https://api.github.com/users/100330706","html_url":"https://github.com/100330706","followers_url":"https://api.github.com/users/100330706/followers","following_url":"https://api.github.com/users/100330706/following{/other_user}","gists_url":"https://api.github.com/users/100330706/gists{/gist_id}","starred_url":"https://api.github.com/users/100330706/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/100330706/subscriptions","organizations_url":"https://api.github.com/users/100330706/orgs","repos_url":"https://api.github.com/users/100330706/repos","events_url":"https://api.github.com/users/100330706/events{/privacy}","received_events_url":"https://api.github.com/users/100330706/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-03-28T16:57:50Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/478786640","html_url":"https://github.com/ultralytics/yolov3/issues/152#issuecomment-478786640","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/152","id":478786640,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3ODc4NjY0MA==","user":{"login":"Ownmarc","id":24617457,"node_id":"MDQ6VXNlcjI0NjE3NDU3","avatar_url":"https://avatars.githubusercontent.com/u/24617457?v=4","gravatar_id":"","url":"https://api.github.com/users/Ownmarc","html_url":"https://github.com/Ownmarc","followers_url":"https://api.github.com/users/Ownmarc/followers","following_url":"https://api.github.com/users/Ownmarc/following{/other_user}","gists_url":"https://api.github.com/users/Ownmarc/gists{/gist_id}","starred_url":"https://api.github.com/users/Ownmarc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ownmarc/subscriptions","organizations_url":"https://api.github.com/users/Ownmarc/orgs","repos_url":"https://api.github.com/users/Ownmarc/repos","events_url":"https://api.github.com/users/Ownmarc/events{/privacy}","received_events_url":"https://api.github.com/users/Ownmarc/received_events","type":"User","site_admin":false},"created_at":"2019-04-01T23:38:19Z","updated_at":"2019-04-02T00:11:33Z","author_association":"CONTRIBUTOR","body":"@gabrielloye getting this error following the changes you suggested : \r\n\r\n```\r\nFile \"C:\\Users\\marcp\\Anaconda3\\envs\\yolov3\\lib\\site-packages\\torch\\optim\\sgd.py\", line 101, in step\r\n    buf.mul_(momentum).add_(1 - dampening, d_p)\r\nRuntimeError: The size of tensor a (255) must match the size of tensor b (78) at non-singleton dimension 0\r\n```\r\n\r\nDid this happen to you ?\r\n\r\nEdit, I commented out this and now its working : \r\n\r\n`if checkpoint['optimizer'] is not None:\r\n        #    optimizer.load_state_dict(checkpoint['optimizer'])\r\n        #    best_loss = checkpoint['best_loss']`","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/478786640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Ownmarc","id":24617457,"node_id":"MDQ6VXNlcjI0NjE3NDU3","avatar_url":"https://avatars.githubusercontent.com/u/24617457?v=4","gravatar_id":"","url":"https://api.github.com/users/Ownmarc","html_url":"https://github.com/Ownmarc","followers_url":"https://api.github.com/users/Ownmarc/followers","following_url":"https://api.github.com/users/Ownmarc/following{/other_user}","gists_url":"https://api.github.com/users/Ownmarc/gists{/gist_id}","starred_url":"https://api.github.com/users/Ownmarc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ownmarc/subscriptions","organizations_url":"https://api.github.com/users/Ownmarc/orgs","repos_url":"https://api.github.com/users/Ownmarc/repos","events_url":"https://api.github.com/users/Ownmarc/events{/privacy}","received_events_url":"https://api.github.com/users/Ownmarc/received_events","type":"User","site_admin":false}},{"id":2244907962,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI0NDkwNzk2Mg==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2244907962","actor":{"login":"gabrielloye","id":46185613,"node_id":"MDQ6VXNlcjQ2MTg1NjEz","avatar_url":"https://avatars.githubusercontent.com/u/46185613?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielloye","html_url":"https://github.com/gabrielloye","followers_url":"https://api.github.com/users/gabrielloye/followers","following_url":"https://api.github.com/users/gabrielloye/following{/other_user}","gists_url":"https://api.github.com/users/gabrielloye/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielloye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielloye/subscriptions","organizations_url":"https://api.github.com/users/gabrielloye/orgs","repos_url":"https://api.github.com/users/gabrielloye/repos","events_url":"https://api.github.com/users/gabrielloye/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielloye/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-01T23:38:19Z","performed_via_github_app":null},{"id":2244907963,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyNDQ5MDc5NjM=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2244907963","actor":{"login":"gabrielloye","id":46185613,"node_id":"MDQ6VXNlcjQ2MTg1NjEz","avatar_url":"https://avatars.githubusercontent.com/u/46185613?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielloye","html_url":"https://github.com/gabrielloye","followers_url":"https://api.github.com/users/gabrielloye/followers","following_url":"https://api.github.com/users/gabrielloye/following{/other_user}","gists_url":"https://api.github.com/users/gabrielloye/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielloye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielloye/subscriptions","organizations_url":"https://api.github.com/users/gabrielloye/orgs","repos_url":"https://api.github.com/users/gabrielloye/repos","events_url":"https://api.github.com/users/gabrielloye/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielloye/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-01T23:38:19Z","performed_via_github_app":null},{"id":2246375706,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjI0NjM3NTcwNg==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2246375706","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2019-04-02T12:46:24Z","rename":{"from":"How to use pre-training weight transfer learning for different categories？","to":"Transfer Learning with differing number of classes"},"performed_via_github_app":null},{"actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2019-04-02T12:48:23Z","updated_at":"2019-04-02T12:48:23Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/181","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/181/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/181/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/181/events","html_url":"https://github.com/ultralytics/yolov3/issues/181","id":427936675,"node_id":"MDU6SXNzdWU0Mjc5MzY2NzU=","number":181,"title":"Transfer learning","user":{"login":"Ownmarc","id":24617457,"node_id":"MDQ6VXNlcjI0NjE3NDU3","avatar_url":"https://avatars.githubusercontent.com/u/24617457?v=4","gravatar_id":"","url":"https://api.github.com/users/Ownmarc","html_url":"https://github.com/Ownmarc","followers_url":"https://api.github.com/users/Ownmarc/followers","following_url":"https://api.github.com/users/Ownmarc/following{/other_user}","gists_url":"https://api.github.com/users/Ownmarc/gists{/gist_id}","starred_url":"https://api.github.com/users/Ownmarc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ownmarc/subscriptions","organizations_url":"https://api.github.com/users/Ownmarc/orgs","repos_url":"https://api.github.com/users/Ownmarc/repos","events_url":"https://api.github.com/users/Ownmarc/events{/privacy}","received_events_url":"https://api.github.com/users/Ownmarc/received_events","type":"User","site_admin":false},"labels":[{"id":1035696370,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzcw","url":"https://api.github.com/repos/ultralytics/yolov3/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-04-01T22:18:42Z","updated_at":"2019-04-02T12:48:23Z","closed_at":"2019-04-02T12:48:23Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"repository":{"id":146165888,"node_id":"MDEwOlJlcG9zaXRvcnkxNDYxNjU4ODg=","name":"yolov3","full_name":"ultralytics/yolov3","private":false,"owner":{"login":"ultralytics","id":26833451,"node_id":"MDEyOk9yZ2FuaXphdGlvbjI2ODMzNDUx","avatar_url":"https://avatars.githubusercontent.com/u/26833451?v=4","gravatar_id":"","url":"https://api.github.com/users/ultralytics","html_url":"https://github.com/ultralytics","followers_url":"https://api.github.com/users/ultralytics/followers","following_url":"https://api.github.com/users/ultralytics/following{/other_user}","gists_url":"https://api.github.com/users/ultralytics/gists{/gist_id}","starred_url":"https://api.github.com/users/ultralytics/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ultralytics/subscriptions","organizations_url":"https://api.github.com/users/ultralytics/orgs","repos_url":"https://api.github.com/users/ultralytics/repos","events_url":"https://api.github.com/users/ultralytics/events{/privacy}","received_events_url":"https://api.github.com/users/ultralytics/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/ultralytics/yolov3","description":"YOLOv3 in PyTorch > ONNX > CoreML > TFLite","fork":false,"url":"https://api.github.com/repos/ultralytics/yolov3","forks_url":"https://api.github.com/repos/ultralytics/yolov3/forks","keys_url":"https://api.github.com/repos/ultralytics/yolov3/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ultralytics/yolov3/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ultralytics/yolov3/teams","hooks_url":"https://api.github.com/repos/ultralytics/yolov3/hooks","issue_events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/events{/number}","events_url":"https://api.github.com/repos/ultralytics/yolov3/events","assignees_url":"https://api.github.com/repos/ultralytics/yolov3/assignees{/user}","branches_url":"https://api.github.com/repos/ultralytics/yolov3/branches{/branch}","tags_url":"https://api.github.com/repos/ultralytics/yolov3/tags","blobs_url":"https://api.github.com/repos/ultralytics/yolov3/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ultralytics/yolov3/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ultralytics/yolov3/git/refs{/sha}","trees_url":"https://api.github.com/repos/ultralytics/yolov3/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ultralytics/yolov3/statuses/{sha}","languages_url":"https://api.github.com/repos/ultralytics/yolov3/languages","stargazers_url":"https://api.github.com/repos/ultralytics/yolov3/stargazers","contributors_url":"https://api.github.com/repos/ultralytics/yolov3/contributors","subscribers_url":"https://api.github.com/repos/ultralytics/yolov3/subscribers","subscription_url":"https://api.github.com/repos/ultralytics/yolov3/subscription","commits_url":"https://api.github.com/repos/ultralytics/yolov3/commits{/sha}","git_commits_url":"https://api.github.com/repos/ultralytics/yolov3/git/commits{/sha}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/comments{/number}","issue_comment_url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments{/number}","contents_url":"https://api.github.com/repos/ultralytics/yolov3/contents/{+path}","compare_url":"https://api.github.com/repos/ultralytics/yolov3/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ultralytics/yolov3/merges","archive_url":"https://api.github.com/repos/ultralytics/yolov3/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ultralytics/yolov3/downloads","issues_url":"https://api.github.com/repos/ultralytics/yolov3/issues{/number}","pulls_url":"https://api.github.com/repos/ultralytics/yolov3/pulls{/number}","milestones_url":"https://api.github.com/repos/ultralytics/yolov3/milestones{/number}","notifications_url":"https://api.github.com/repos/ultralytics/yolov3/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ultralytics/yolov3/labels{/name}","releases_url":"https://api.github.com/repos/ultralytics/yolov3/releases{/id}","deployments_url":"https://api.github.com/repos/ultralytics/yolov3/deployments","created_at":"2018-08-26T08:57:20Z","updated_at":"2023-01-19T02:45:28Z","pushed_at":"2023-01-02T20:48:03Z","git_url":"git://github.com/ultralytics/yolov3.git","ssh_url":"git@github.com:ultralytics/yolov3.git","clone_url":"https://github.com/ultralytics/yolov3.git","svn_url":"https://github.com/ultralytics/yolov3","homepage":"https://ultralytics.com","size":9609,"stargazers_count":9265,"watchers_count":9265,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":3359,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":7,"license":{"key":"gpl-3.0","name":"GNU General Public License v3.0","spdx_id":"GPL-3.0","url":"https://api.github.com/licenses/gpl-3.0","node_id":"MDc6TGljZW5zZTk="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["coreml","deep-learning","ios","machine-learning","ml","object-detection","onnx","pytorch","tflite","yolo","yolov3","yolov4","yolov5"],"visibility":"public","forks":3359,"open_issues":7,"watchers":9265,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Hello,\r\n\r\nIs there a way to only initialize the 3 layers that do the classification to new weights/bias ?\r\n\r\nTrying to change the cfg file for 21 classes (78 filters and 21 classes) gave me an error on the 81, 93 and 105 layers while trying to load the pre-trained weights (yolov3.pt). I know we had this in darkflow (Tensorflow version of yolov2), is there a way create new layers for the transfer learning ?","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/181/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/479074652","html_url":"https://github.com/ultralytics/yolov3/issues/152#issuecomment-479074652","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/152","id":479074652,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3OTA3NDY1Mg==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2019-04-02T16:15:41Z","updated_at":"2019-04-02T16:17:50Z","author_association":"MEMBER","body":"@hxy1051653358 @gabrielloye @perry0418 @100330706 @Ownmarc the latest commit should handle transfer learning for various class sizes automatically using a new `--transfer` flag in train.py.\r\n\r\nTransfer learning is performed only on YOLO layers of `yolov3.pt`, and these YOLO layers may now be any size specified in your *.cfg file. Note that you need to download `yolov3.pt` first from our Google Drive folder (https://github.com/ultralytics/yolov3#pretrained-weights) to your `yolov3/weights/ `directory. \r\n\r\nHere is a transfer learning example with a single class (18-length YOLO layers) using `yolov3-1cls.cfg` and `coco_1cls.data` with are now added to the repo. `coco_1cls.data` points to `coco_1cls.txt` for training and testing, which is available in the Google Drive folder, and can be placed in your coco folder to follow our 1-class tutorial: https://github.com/ultralytics/yolov3/wiki/Example:-Train-Single-Class.\r\n\r\n ```\r\nNamespace(accumulate=1, backend='nccl', batch_size=16, cfg='cfg/yolov3-1cls.cfg', data_cfg='data/coco_1cls.data', dist_url='tcp://127.0.0.1:9999', epochs=270, img_size=416, multi_scale=False, num_workers=4, rank=0, resume=False, transfer=True, world_size=1)\r\n\r\nUsing cpu \r\n\r\nlayer                                     name  gradient   parameters                shape         mu      sigma\r\n    0                          0.conv_0.weight     False          864        [32, 3, 3, 3]  -8.67e-05      0.112\r\n    1                    0.batch_norm_0.weight     False           32                 [32]      0.538        0.3\r\n    2                      0.batch_norm_0.bias     False           32                 [32]          0          0\r\n    3                          1.conv_1.weight     False        18432       [64, 32, 3, 3]   0.000231      0.034\r\n...\r\n  218                104.batch_norm_104.weight     False          256                [256]      0.519      0.286\r\n  219                  104.batch_norm_104.bias     False          256                [256]          0          0\r\n  220                      105.conv_105.weight      True         4608      [18, 256, 1, 1]   0.000118     0.0359\r\n  221                        105.conv_105.bias      True           18                 [18]    0.00203     0.0387\r\nModel Summary: 222 layers, 6.15237e+07 parameters, 32310 gradients\r\n\r\n   Epoch       Batch        xy        wh      conf       cls     total  nTargets      time\r\n   0/269         0/0      2.11      6.65       140         0       148        17      6.06\r\n      Image      Total          P          R        mAP\r\nCalculating mAP: 100%|██████████| 1/1 [00:05<00:00,  5.50s/it]\r\n          5          5          0          0          0\r\n```","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/479074652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":2247100074,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI0NzEwMDA3NA==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2247100074","actor":{"login":"Ownmarc","id":24617457,"node_id":"MDQ6VXNlcjI0NjE3NDU3","avatar_url":"https://avatars.githubusercontent.com/u/24617457?v=4","gravatar_id":"","url":"https://api.github.com/users/Ownmarc","html_url":"https://github.com/Ownmarc","followers_url":"https://api.github.com/users/Ownmarc/followers","following_url":"https://api.github.com/users/Ownmarc/following{/other_user}","gists_url":"https://api.github.com/users/Ownmarc/gists{/gist_id}","starred_url":"https://api.github.com/users/Ownmarc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ownmarc/subscriptions","organizations_url":"https://api.github.com/users/Ownmarc/orgs","repos_url":"https://api.github.com/users/Ownmarc/repos","events_url":"https://api.github.com/users/Ownmarc/events{/privacy}","received_events_url":"https://api.github.com/users/Ownmarc/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-02T16:15:41Z","performed_via_github_app":null},{"id":2247100075,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyNDcxMDAwNzU=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2247100075","actor":{"login":"Ownmarc","id":24617457,"node_id":"MDQ6VXNlcjI0NjE3NDU3","avatar_url":"https://avatars.githubusercontent.com/u/24617457?v=4","gravatar_id":"","url":"https://api.github.com/users/Ownmarc","html_url":"https://github.com/Ownmarc","followers_url":"https://api.github.com/users/Ownmarc/followers","following_url":"https://api.github.com/users/Ownmarc/following{/other_user}","gists_url":"https://api.github.com/users/Ownmarc/gists{/gist_id}","starred_url":"https://api.github.com/users/Ownmarc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ownmarc/subscriptions","organizations_url":"https://api.github.com/users/Ownmarc/orgs","repos_url":"https://api.github.com/users/Ownmarc/repos","events_url":"https://api.github.com/users/Ownmarc/events{/privacy}","received_events_url":"https://api.github.com/users/Ownmarc/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-02T16:15:41Z","performed_via_github_app":null},{"id":2247100079,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI0NzEwMDA3OQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2247100079","actor":{"login":"perry0418","id":34980036,"node_id":"MDQ6VXNlcjM0OTgwMDM2","avatar_url":"https://avatars.githubusercontent.com/u/34980036?v=4","gravatar_id":"","url":"https://api.github.com/users/perry0418","html_url":"https://github.com/perry0418","followers_url":"https://api.github.com/users/perry0418/followers","following_url":"https://api.github.com/users/perry0418/following{/other_user}","gists_url":"https://api.github.com/users/perry0418/gists{/gist_id}","starred_url":"https://api.github.com/users/perry0418/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/perry0418/subscriptions","organizations_url":"https://api.github.com/users/perry0418/orgs","repos_url":"https://api.github.com/users/perry0418/repos","events_url":"https://api.github.com/users/perry0418/events{/privacy}","received_events_url":"https://api.github.com/users/perry0418/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-02T16:15:41Z","performed_via_github_app":null},{"id":2247100080,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyNDcxMDAwODA=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2247100080","actor":{"login":"perry0418","id":34980036,"node_id":"MDQ6VXNlcjM0OTgwMDM2","avatar_url":"https://avatars.githubusercontent.com/u/34980036?v=4","gravatar_id":"","url":"https://api.github.com/users/perry0418","html_url":"https://github.com/perry0418","followers_url":"https://api.github.com/users/perry0418/followers","following_url":"https://api.github.com/users/perry0418/following{/other_user}","gists_url":"https://api.github.com/users/perry0418/gists{/gist_id}","starred_url":"https://api.github.com/users/perry0418/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/perry0418/subscriptions","organizations_url":"https://api.github.com/users/perry0418/orgs","repos_url":"https://api.github.com/users/perry0418/repos","events_url":"https://api.github.com/users/perry0418/events{/privacy}","received_events_url":"https://api.github.com/users/perry0418/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-02T16:15:41Z","performed_via_github_app":null},{"id":2247100082,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI0NzEwMDA4Mg==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2247100082","actor":{"login":"hxy1051653358","id":43035276,"node_id":"MDQ6VXNlcjQzMDM1Mjc2","avatar_url":"https://avatars.githubusercontent.com/u/43035276?v=4","gravatar_id":"","url":"https://api.github.com/users/hxy1051653358","html_url":"https://github.com/hxy1051653358","followers_url":"https://api.github.com/users/hxy1051653358/followers","following_url":"https://api.github.com/users/hxy1051653358/following{/other_user}","gists_url":"https://api.github.com/users/hxy1051653358/gists{/gist_id}","starred_url":"https://api.github.com/users/hxy1051653358/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hxy1051653358/subscriptions","organizations_url":"https://api.github.com/users/hxy1051653358/orgs","repos_url":"https://api.github.com/users/hxy1051653358/repos","events_url":"https://api.github.com/users/hxy1051653358/events{/privacy}","received_events_url":"https://api.github.com/users/hxy1051653358/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-02T16:15:41Z","performed_via_github_app":null}]