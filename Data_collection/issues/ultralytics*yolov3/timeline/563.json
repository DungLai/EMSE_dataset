[{"id":2717038262,"node_id":"MDEyOkxhYmVsZWRFdmVudDI3MTcwMzgyNjI=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2717038262","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-10-16T10:13:14Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/542658305","html_url":"https://github.com/ultralytics/yolov3/issues/563#issuecomment-542658305","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/563","id":542658305,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjY1ODMwNQ==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2019-10-16T11:36:31Z","updated_at":"2019-10-16T11:36:31Z","author_association":"MEMBER","body":"@nscotto you set this is the cfg file. For greyscale you can set channels=1.\r\nhttps://github.com/ultralytics/yolov3/blob/d1271941ad158dafd9385f4a9cfd997b51fcda5f/cfg/yolov3-spp.cfg#L10","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/542658305/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":2717269781,"node_id":"MDExOkNsb3NlZEV2ZW50MjcxNzI2OTc4MQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2717269781","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-10-16T11:36:31Z","state_reason":null,"performed_via_github_app":null},{"id":2717269797,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjcxNzI2OTc5Nw==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2717269797","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-10-16T11:36:31Z","performed_via_github_app":null},{"id":2717269798,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI3MTcyNjk3OTg=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2717269798","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-10-16T11:36:31Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/542955873","html_url":"https://github.com/ultralytics/yolov3/issues/563#issuecomment-542955873","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/563","id":542955873,"node_id":"MDEyOklzc3VlQ29tbWVudDU0Mjk1NTg3Mw==","user":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false},"created_at":"2019-10-17T01:23:17Z","updated_at":"2019-10-17T01:23:17Z","author_association":"NONE","body":"@glenn-jocher I tried your solution but throws an error shown below, but when I use channels=3 there is no error. My dataset is a grayscale image.\r\n\r\n`RuntimeError: Given groups=1, weight of size 32 1 3 3, expected input[32, 3, 416, 416] to have 1 channels, but got 3 channels instead`\r\n\r\n","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/542955873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false}},{"id":2719588606,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjcxOTU4ODYwNg==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2719588606","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-10-17T01:23:19Z","performed_via_github_app":null},{"id":2719588607,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI3MTk1ODg2MDc=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2719588607","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-10-17T01:23:19Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543089159","html_url":"https://github.com/ultralytics/yolov3/issues/563#issuecomment-543089159","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/563","id":543089159,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzA4OTE1OQ==","user":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"created_at":"2019-10-17T09:26:58Z","updated_at":"2019-10-17T09:33:06Z","author_association":"NONE","body":"@glenn-jocher \r\n> @nscotto you set this is the cfg file. For greyscale you can set channels=1.\r\n> https://github.com/ultralytics/yolov3/blob/d1271941ad158dafd9385f4a9cfd997b51fcda5f/cfg/yolov3-spp.cfg#L10\r\n\r\nThanks, it works like a charm! \r\nAfter trying conversion to different popular frameworks, I can say this repo is the best solution to convert yolo from darknet! I converted my custom tiny-yolov3 to pytorch then ONNX.\r\nI was mislead by the fact that there is a img_size parameter somewhere in the `Darknet` class where it could be read in the cfg as well. I probably have not inspected the code enough.\r\n\r\n@rlgalvez\r\n> @glenn-jocher I tried your solution but throws an error shown below, but when I use channels=3 there is no error. My dataset is a grayscale image.\r\n> \r\n> `RuntimeError: Given groups=1, weight of size 32 1 3 3, expected input[32, 3, 416, 416] to have 1 channels, but got 3 channels instead`\r\n\r\nWhat is happening is that if you are training/testing in python, the images are opened with opencv so if you don't know you need to pass the argument `cv2.IMREAD_GRAYSCALE` to `imread` for grayscale images, otherwise the resulting objects will have 3 channels.\r\n\r\nSo modify every instances of `cv2.imread` from `cv2.imread(fname)` to `cv2.imread(fname, IMREAD_GRAYSCALE)` and it should work.","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543089159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false}},{"id":2720557793,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjcyMDU1Nzc5Mw==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2720557793","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-10-17T09:26:58Z","performed_via_github_app":null},{"id":2720557794,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI3MjA1NTc3OTQ=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2720557794","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-10-17T09:26:58Z","performed_via_github_app":null},{"id":2720557800,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjcyMDU1NzgwMA==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2720557800","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-10-17T09:26:58Z","performed_via_github_app":null},{"id":2720557801,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI3MjA1NTc4MDE=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2720557801","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-10-17T09:26:58Z","performed_via_github_app":null},{"id":2720579023,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjcyMDU3OTAyMw==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2720579023","actor":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-10-17T09:33:10Z","performed_via_github_app":null},{"id":2720579026,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI3MjA1NzkwMjY=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2720579026","actor":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-10-17T09:33:10Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543190213","html_url":"https://github.com/ultralytics/yolov3/issues/563#issuecomment-543190213","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/563","id":543190213,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzE5MDIxMw==","user":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false},"created_at":"2019-10-17T14:04:01Z","updated_at":"2019-10-17T14:04:01Z","author_association":"NONE","body":"@glenn-jocher Thanks for the response, what python file should I modify? I tried editing train.py, datasets.py, utils.py but still throws an error. My dataset is already a grayscale image, I think the IMREAD_GRAYSCALE only loads the color image as grayscale.","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543190213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false}},{"id":2721425389,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjcyMTQyNTM4OQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2721425389","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-10-17T14:04:01Z","performed_via_github_app":null},{"id":2721425390,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI3MjE0MjUzOTA=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2721425390","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-10-17T14:04:01Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543220131","html_url":"https://github.com/ultralytics/yolov3/issues/563#issuecomment-543220131","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/563","id":543220131,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzIyMDEzMQ==","user":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"created_at":"2019-10-17T15:08:07Z","updated_at":"2019-10-17T15:08:07Z","author_association":"NONE","body":"\r\n\r\n\r\nIf you are on linux, `grep` is your friend for this type of tasks:\r\nGo to the main folder and:\r\n```\r\ngrep -nR imread\r\n```\r\noutput:\r\n```\r\nutils/utils.py:631:        img = cv2.imread(file)  # BGR\r\nutils/datasets.py:97:            img0 = cv2.imread(path)  # BGR\r\nutils/datasets.py:354:                        img = cv2.imread(str(p))\r\nutils/datasets.py:379:                img = cv2.imread(img_path)  # BGR\r\nutils/datasets.py:393:                    _ = io.imread(file)\r\nutils/datasets.py:511:        img = cv2.imread(img_path)  # BGR\r\nutils/datasets.py:766:    # cv2.imread() jpg at 230 img/s, *.bmp at 400 img/s\r\nutils/datasets.py:776:            cv2.imwrite(save_name, cv2.imread(f))\r\ntrain.py:254:                    tb_writer.add_image(fname, cv2.imread(fname)[:, :, ::-1], dataformats='HWC')\r\n```\r\n\r\nThe thing you need to understand is that if you load a grayscale image with only one channel, and you don't pass the argument `cv2.IMREAD_GRAYSCALE`, opencv will still return an object with three channels, that is how it is designed.","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543220131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543281038","html_url":"https://github.com/ultralytics/yolov3/issues/563#issuecomment-543281038","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/563","id":543281038,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzI4MTAzOA==","user":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false},"created_at":"2019-10-17T17:32:06Z","updated_at":"2019-10-17T17:32:06Z","author_association":"NONE","body":"@nscotto I see. Thanks for the info. I tried that also but throws a different error, I tried removing _ in line 515 below but the error still exists.\r\n\r\n ```\r\n File \"/home/yolov3/utils/datasets.py\", line 515, in load_image\r\n    h, w, _ = img.shape\r\nValueError: not enough values to unpack (expected 3, got 2)\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543281038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false}},{"id":2722150760,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjcyMjE1MDc2MA==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2722150760","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-10-17T17:32:07Z","performed_via_github_app":null},{"id":2722150764,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI3MjIxNTA3NjQ=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2722150764","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-10-17T17:32:07Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543619446","html_url":"https://github.com/ultralytics/yolov3/issues/563#issuecomment-543619446","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/563","id":543619446,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzYxOTQ0Ng==","user":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"created_at":"2019-10-18T09:11:12Z","updated_at":"2019-10-18T09:11:12Z","author_association":"NONE","body":"This is because in opencv images with 1 channel are stored in 2-D array, as a tradeoff between efficiency and convenience.\r\nreplace by:\r\n```\r\nh, w = img.shape\r\n```\r\nYou will probably have to do this type of modification in other part of the code, this will all come because the code will be written for 3-D array and you are providing 2-D arrays.","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543619446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543763406","html_url":"https://github.com/ultralytics/yolov3/issues/563#issuecomment-543763406","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/563","id":543763406,"node_id":"MDEyOklzc3VlQ29tbWVudDU0Mzc2MzQwNg==","user":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false},"created_at":"2019-10-18T14:06:37Z","updated_at":"2019-10-18T14:06:37Z","author_association":"NONE","body":"@nscotto Thanks! I tried your suggestion but there are still errors on my code because the variable `_` was not used. I don't know what to modify after this. Have you tried training a grayscale image using this repo?","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543763406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false}},{"id":2725018379,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjcyNTAxODM3OQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2725018379","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-10-18T14:06:37Z","performed_via_github_app":null},{"id":2725018380,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI3MjUwMTgzODA=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2725018380","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-10-18T14:06:37Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543799593","html_url":"https://github.com/ultralytics/yolov3/issues/563#issuecomment-543799593","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/563","id":543799593,"node_id":"MDEyOklzc3VlQ29tbWVudDU0Mzc5OTU5Mw==","user":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"created_at":"2019-10-18T15:33:18Z","updated_at":"2019-10-18T15:34:24Z","author_association":"NONE","body":"No, I just wanted to convert a trained model to ONNX so I have not tried anything with training in pytorch.\r\n\r\nAs stated by glenn-jocher, the model will be created with the number of channels read in corresponding the cfg file.\r\n\r\nWhat you just said:\r\n> there are still errors on my code because the variable `_` was not used.\r\n\r\nBecause it's `_` is not used and `img.shape` is a 2-D tuple, omiting should solve this error and not create other ones.\r\n\r\nI am not sure how the channels are handled in YOLO and pytorch, I guess maybe pytorch is expecting 3-D images (despite the fact that the number of channel is set to 1), so you can try artificially converting the 2-D images into 3-D images with one channel.\r\n\r\nwhat you can try is replacing every `cv2.imread(fname, cv2.IMG_GRAYSCALE)` by:\r\n```\r\nnp.expand_dims(cv2.imread(fname, cv2.IMG_GRAYSCALE), axis=0)\r\n```\r\nThen you should let `h, w, _ = img.shape` as it is as you are now working with 3-D arrays.\r\n\r\nI hope that will do the trick.","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543799593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/544160518","html_url":"https://github.com/ultralytics/yolov3/issues/563#issuecomment-544160518","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/563","id":544160518,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NDE2MDUxOA==","user":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false},"created_at":"2019-10-19T15:30:47Z","updated_at":"2019-10-19T15:30:47Z","author_association":"NONE","body":"> No, I just wanted to convert a trained model to ONNX so I have not tried anything with training in pytorch.\r\n> \r\n> As stated by glenn-jocher, the model will be created with the number of channels read in corresponding the cfg file.\r\n> \r\n> What you just said:\r\n> \r\n> > there are still errors on my code because the variable `_` was not used.\r\n> \r\n> Because it's `_` is not used and `img.shape` is a 2-D tuple, omiting should solve this error and not create other ones.\r\n> \r\n> I am not sure how the channels are handled in YOLO and pytorch, I guess maybe pytorch is expecting 3-D images (despite the fact that the number of channel is set to 1), so you can try artificially converting the 2-D images into 3-D images with one channel.\r\n> \r\n> what you can try is replacing every `cv2.imread(fname, cv2.IMG_GRAYSCALE)` by:\r\n> \r\n> ```\r\n> np.expand_dims(cv2.imread(fname, cv2.IMG_GRAYSCALE), axis=0)\r\n> ```\r\n> \r\n> Then you should let `h, w, _ = img.shape` as it is as you are now working with 3-D arrays.\r\n> \r\n> I hope that will do the trick.\r\n\r\nI tried `np.expand_dims(cv2.imread(fname, cv2.IMG_GRAYSCALE), axis=0)` but there are still errors and I don't know what will do next, anyway thank you for your help @nscotto . I will study the code again.","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/544160518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false}},{"id":2727136215,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjcyNzEzNjIxNQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2727136215","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-10-19T15:30:47Z","performed_via_github_app":null},{"id":2727136217,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI3MjcxMzYyMTc=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2727136217","actor":{"login":"nscotto","id":44670538,"node_id":"MDQ6VXNlcjQ0NjcwNTM4","avatar_url":"https://avatars.githubusercontent.com/u/44670538?v=4","gravatar_id":"","url":"https://api.github.com/users/nscotto","html_url":"https://github.com/nscotto","followers_url":"https://api.github.com/users/nscotto/followers","following_url":"https://api.github.com/users/nscotto/following{/other_user}","gists_url":"https://api.github.com/users/nscotto/gists{/gist_id}","starred_url":"https://api.github.com/users/nscotto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nscotto/subscriptions","organizations_url":"https://api.github.com/users/nscotto/orgs","repos_url":"https://api.github.com/users/nscotto/repos","events_url":"https://api.github.com/users/nscotto/events{/privacy}","received_events_url":"https://api.github.com/users/nscotto/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-10-19T15:30:47Z","performed_via_github_app":null}]