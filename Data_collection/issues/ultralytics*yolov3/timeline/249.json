[{"actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2019-04-29T17:24:09Z","updated_at":"2019-04-29T17:24:09Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/133","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/133/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/133/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/133/events","html_url":"https://github.com/ultralytics/yolov3/issues/133","id":421960374,"node_id":"MDU6SXNzdWU0MjE5NjAzNzQ=","number":133,"title":"Are class weights supported?","user":{"login":"Jaiczay","id":29538753,"node_id":"MDQ6VXNlcjI5NTM4NzUz","avatar_url":"https://avatars.githubusercontent.com/u/29538753?v=4","gravatar_id":"","url":"https://api.github.com/users/Jaiczay","html_url":"https://github.com/Jaiczay","followers_url":"https://api.github.com/users/Jaiczay/followers","following_url":"https://api.github.com/users/Jaiczay/following{/other_user}","gists_url":"https://api.github.com/users/Jaiczay/gists{/gist_id}","starred_url":"https://api.github.com/users/Jaiczay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jaiczay/subscriptions","organizations_url":"https://api.github.com/users/Jaiczay/orgs","repos_url":"https://api.github.com/users/Jaiczay/repos","events_url":"https://api.github.com/users/Jaiczay/events{/privacy}","received_events_url":"https://api.github.com/users/Jaiczay/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-03-17T19:05:04Z","updated_at":"2019-04-29T17:24:09Z","closed_at":"2019-03-18T13:53:06Z","author_association":"NONE","active_lock_reason":null,"repository":{"id":146165888,"node_id":"MDEwOlJlcG9zaXRvcnkxNDYxNjU4ODg=","name":"yolov3","full_name":"ultralytics/yolov3","private":false,"owner":{"login":"ultralytics","id":26833451,"node_id":"MDEyOk9yZ2FuaXphdGlvbjI2ODMzNDUx","avatar_url":"https://avatars.githubusercontent.com/u/26833451?v=4","gravatar_id":"","url":"https://api.github.com/users/ultralytics","html_url":"https://github.com/ultralytics","followers_url":"https://api.github.com/users/ultralytics/followers","following_url":"https://api.github.com/users/ultralytics/following{/other_user}","gists_url":"https://api.github.com/users/ultralytics/gists{/gist_id}","starred_url":"https://api.github.com/users/ultralytics/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ultralytics/subscriptions","organizations_url":"https://api.github.com/users/ultralytics/orgs","repos_url":"https://api.github.com/users/ultralytics/repos","events_url":"https://api.github.com/users/ultralytics/events{/privacy}","received_events_url":"https://api.github.com/users/ultralytics/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/ultralytics/yolov3","description":"YOLOv3 in PyTorch > ONNX > CoreML > TFLite","fork":false,"url":"https://api.github.com/repos/ultralytics/yolov3","forks_url":"https://api.github.com/repos/ultralytics/yolov3/forks","keys_url":"https://api.github.com/repos/ultralytics/yolov3/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ultralytics/yolov3/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ultralytics/yolov3/teams","hooks_url":"https://api.github.com/repos/ultralytics/yolov3/hooks","issue_events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/events{/number}","events_url":"https://api.github.com/repos/ultralytics/yolov3/events","assignees_url":"https://api.github.com/repos/ultralytics/yolov3/assignees{/user}","branches_url":"https://api.github.com/repos/ultralytics/yolov3/branches{/branch}","tags_url":"https://api.github.com/repos/ultralytics/yolov3/tags","blobs_url":"https://api.github.com/repos/ultralytics/yolov3/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ultralytics/yolov3/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ultralytics/yolov3/git/refs{/sha}","trees_url":"https://api.github.com/repos/ultralytics/yolov3/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ultralytics/yolov3/statuses/{sha}","languages_url":"https://api.github.com/repos/ultralytics/yolov3/languages","stargazers_url":"https://api.github.com/repos/ultralytics/yolov3/stargazers","contributors_url":"https://api.github.com/repos/ultralytics/yolov3/contributors","subscribers_url":"https://api.github.com/repos/ultralytics/yolov3/subscribers","subscription_url":"https://api.github.com/repos/ultralytics/yolov3/subscription","commits_url":"https://api.github.com/repos/ultralytics/yolov3/commits{/sha}","git_commits_url":"https://api.github.com/repos/ultralytics/yolov3/git/commits{/sha}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/comments{/number}","issue_comment_url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments{/number}","contents_url":"https://api.github.com/repos/ultralytics/yolov3/contents/{+path}","compare_url":"https://api.github.com/repos/ultralytics/yolov3/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ultralytics/yolov3/merges","archive_url":"https://api.github.com/repos/ultralytics/yolov3/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ultralytics/yolov3/downloads","issues_url":"https://api.github.com/repos/ultralytics/yolov3/issues{/number}","pulls_url":"https://api.github.com/repos/ultralytics/yolov3/pulls{/number}","milestones_url":"https://api.github.com/repos/ultralytics/yolov3/milestones{/number}","notifications_url":"https://api.github.com/repos/ultralytics/yolov3/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ultralytics/yolov3/labels{/name}","releases_url":"https://api.github.com/repos/ultralytics/yolov3/releases{/id}","deployments_url":"https://api.github.com/repos/ultralytics/yolov3/deployments","created_at":"2018-08-26T08:57:20Z","updated_at":"2023-01-19T02:45:28Z","pushed_at":"2023-01-02T20:48:03Z","git_url":"git://github.com/ultralytics/yolov3.git","ssh_url":"git@github.com:ultralytics/yolov3.git","clone_url":"https://github.com/ultralytics/yolov3.git","svn_url":"https://github.com/ultralytics/yolov3","homepage":"https://ultralytics.com","size":9609,"stargazers_count":9265,"watchers_count":9265,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":3359,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":7,"license":{"key":"gpl-3.0","name":"GNU General Public License v3.0","spdx_id":"GPL-3.0","url":"https://api.github.com/licenses/gpl-3.0","node_id":"MDc6TGljZW5zZTk="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["coreml","deep-learning","ios","machine-learning","ml","object-detection","onnx","pytorch","tflite","yolo","yolov3","yolov4","yolov5"],"visibility":"public","forks":3359,"open_issues":7,"watchers":9265,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"I have a unbalanced dataset with like for class 1: 360 and 2: 860 samples. Is it possible to add class weights to the loss to get better results?","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/133/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":2307378453,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQyMzA3Mzc4NDUz","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2307378453","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2019-04-29T17:26:25Z","assignee":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"id":2307379110,"node_id":"MDEyOkxhYmVsZWRFdmVudDIzMDczNzkxMTA=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2307379110","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-04-29T17:26:39Z","label":{"name":"tutorial","color":"3cba0b"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/488096191","html_url":"https://github.com/ultralytics/yolov3/issues/249#issuecomment-488096191","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/249","id":488096191,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4ODA5NjE5MQ==","user":{"login":"Ownmarc","id":24617457,"node_id":"MDQ6VXNlcjI0NjE3NDU3","avatar_url":"https://avatars.githubusercontent.com/u/24617457?v=4","gravatar_id":"","url":"https://api.github.com/users/Ownmarc","html_url":"https://github.com/Ownmarc","followers_url":"https://api.github.com/users/Ownmarc/followers","following_url":"https://api.github.com/users/Ownmarc/following{/other_user}","gists_url":"https://api.github.com/users/Ownmarc/gists{/gist_id}","starred_url":"https://api.github.com/users/Ownmarc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ownmarc/subscriptions","organizations_url":"https://api.github.com/users/Ownmarc/orgs","repos_url":"https://api.github.com/users/Ownmarc/repos","events_url":"https://api.github.com/users/Ownmarc/events{/privacy}","received_events_url":"https://api.github.com/users/Ownmarc/received_events","type":"User","site_admin":false},"created_at":"2019-04-30T20:07:05Z","updated_at":"2019-04-30T20:07:05Z","author_association":"CONTRIBUTOR","body":"Hello Glenn, is this done automaticaly ?\r\n\r\nThats nice, thanks","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/488096191/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Ownmarc","id":24617457,"node_id":"MDQ6VXNlcjI0NjE3NDU3","avatar_url":"https://avatars.githubusercontent.com/u/24617457?v=4","gravatar_id":"","url":"https://api.github.com/users/Ownmarc","html_url":"https://github.com/Ownmarc","followers_url":"https://api.github.com/users/Ownmarc/followers","following_url":"https://api.github.com/users/Ownmarc/following{/other_user}","gists_url":"https://api.github.com/users/Ownmarc/gists{/gist_id}","starred_url":"https://api.github.com/users/Ownmarc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ownmarc/subscriptions","organizations_url":"https://api.github.com/users/Ownmarc/orgs","repos_url":"https://api.github.com/users/Ownmarc/repos","events_url":"https://api.github.com/users/Ownmarc/events{/privacy}","received_events_url":"https://api.github.com/users/Ownmarc/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/488099870","html_url":"https://github.com/ultralytics/yolov3/issues/249#issuecomment-488099870","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/249","id":488099870,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4ODA5OTg3MA==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2019-04-30T20:18:36Z","updated_at":"2019-04-30T20:24:11Z","author_association":"MEMBER","body":"@Ownmarc no its not on by default. The class weights are created from the labels and attached to `model` as `model.class_weights` automatically, but to turn the class weighting on during training you need to set the `weights` variable in the CE loss function:\r\nhttps://github.com/ultralytics/yolov3/blob/7e6e1897ac5514ab0e2ae3e3357da8a9c744cfed/utils/utils.py#L261\r\n\r\ni.e. change this line to `CE = nn.CrossEntropyLoss(weight=model.class_weights) `\r\n","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/488099870/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":2310624337,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjMxMDYyNDMzNw==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2310624337","actor":{"login":"Ownmarc","id":24617457,"node_id":"MDQ6VXNlcjI0NjE3NDU3","avatar_url":"https://avatars.githubusercontent.com/u/24617457?v=4","gravatar_id":"","url":"https://api.github.com/users/Ownmarc","html_url":"https://github.com/Ownmarc","followers_url":"https://api.github.com/users/Ownmarc/followers","following_url":"https://api.github.com/users/Ownmarc/following{/other_user}","gists_url":"https://api.github.com/users/Ownmarc/gists{/gist_id}","starred_url":"https://api.github.com/users/Ownmarc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ownmarc/subscriptions","organizations_url":"https://api.github.com/users/Ownmarc/orgs","repos_url":"https://api.github.com/users/Ownmarc/repos","events_url":"https://api.github.com/users/Ownmarc/events{/privacy}","received_events_url":"https://api.github.com/users/Ownmarc/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-30T20:18:36Z","performed_via_github_app":null},{"id":2310624338,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzMTA2MjQzMzg=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2310624338","actor":{"login":"Ownmarc","id":24617457,"node_id":"MDQ6VXNlcjI0NjE3NDU3","avatar_url":"https://avatars.githubusercontent.com/u/24617457?v=4","gravatar_id":"","url":"https://api.github.com/users/Ownmarc","html_url":"https://github.com/Ownmarc","followers_url":"https://api.github.com/users/Ownmarc/followers","following_url":"https://api.github.com/users/Ownmarc/following{/other_user}","gists_url":"https://api.github.com/users/Ownmarc/gists{/gist_id}","starred_url":"https://api.github.com/users/Ownmarc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ownmarc/subscriptions","organizations_url":"https://api.github.com/users/Ownmarc/orgs","repos_url":"https://api.github.com/users/Ownmarc/repos","events_url":"https://api.github.com/users/Ownmarc/events{/privacy}","received_events_url":"https://api.github.com/users/Ownmarc/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-30T20:18:36Z","performed_via_github_app":null},{"id":2313419836,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjMxMzQxOTgzNg==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2313419836","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-02T02:32:59Z","performed_via_github_app":null},{"id":2313419838,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzMTM0MTk4Mzg=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2313419838","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-02T02:32:59Z","performed_via_github_app":null},{"id":2313421818,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjMxMzQyMTgxOA==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2313421818","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-02T02:35:41Z","performed_via_github_app":null},{"id":2313421820,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzMTM0MjE4MjA=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2313421820","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-02T02:35:41Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/488537054","html_url":"https://github.com/ultralytics/yolov3/issues/249#issuecomment-488537054","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/249","id":488537054,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4ODUzNzA1NA==","user":{"login":"njgre6","id":37560420,"node_id":"MDQ6VXNlcjM3NTYwNDIw","avatar_url":"https://avatars.githubusercontent.com/u/37560420?v=4","gravatar_id":"","url":"https://api.github.com/users/njgre6","html_url":"https://github.com/njgre6","followers_url":"https://api.github.com/users/njgre6/followers","following_url":"https://api.github.com/users/njgre6/following{/other_user}","gists_url":"https://api.github.com/users/njgre6/gists{/gist_id}","starred_url":"https://api.github.com/users/njgre6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/njgre6/subscriptions","organizations_url":"https://api.github.com/users/njgre6/orgs","repos_url":"https://api.github.com/users/njgre6/repos","events_url":"https://api.github.com/users/njgre6/events{/privacy}","received_events_url":"https://api.github.com/users/njgre6/received_events","type":"User","site_admin":false},"created_at":"2019-05-02T02:37:06Z","updated_at":"2019-05-02T13:47:51Z","author_association":"NONE","body":"@glenn-jocher Awesome repo! I am fairly certain that if you have empty label files (ie an empty image with an accompanying empty text file) in your dataset then this will create errors, as np.concatenate(line 54) requires each element to have a 0 axis, but in the input data loading empty files are created as empty lists (datasets.py, line 182). I have a solution working:\r\n\r\n```python\r\ndef labels_to_class_weights(labels, nc=80):\r\n          classCounts = [0]*nc\r\n          for label in labels:\r\n                     if label is not []:\r\n                               for elem in label:\r\n                                         classCounts[int(elem[0])] +=1\r\n          weights = np.asarray(classCounts)\r\n          weights = 1 / weights # number of targets per class\r\n          weights /= weights.sum() # normalize\r\n          return torch.Tensor(weights)\r\n```","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/488537054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"njgre6","id":37560420,"node_id":"MDQ6VXNlcjM3NTYwNDIw","avatar_url":"https://avatars.githubusercontent.com/u/37560420?v=4","gravatar_id":"","url":"https://api.github.com/users/njgre6","html_url":"https://github.com/njgre6","followers_url":"https://api.github.com/users/njgre6/followers","following_url":"https://api.github.com/users/njgre6/following{/other_user}","gists_url":"https://api.github.com/users/njgre6/gists{/gist_id}","starred_url":"https://api.github.com/users/njgre6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/njgre6/subscriptions","organizations_url":"https://api.github.com/users/njgre6/orgs","repos_url":"https://api.github.com/users/njgre6/repos","events_url":"https://api.github.com/users/njgre6/events{/privacy}","received_events_url":"https://api.github.com/users/njgre6/received_events","type":"User","site_admin":false}},{"id":2313422900,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjMxMzQyMjkwMA==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2313422900","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-02T02:37:06Z","performed_via_github_app":null},{"id":2313422901,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzMTM0MjI5MDE=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2313422901","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-02T02:37:06Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/488680685","html_url":"https://github.com/ultralytics/yolov3/issues/249#issuecomment-488680685","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/249","id":488680685,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4ODY4MDY4NQ==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2019-05-02T13:49:21Z","updated_at":"2019-05-02T13:49:21Z","author_association":"MEMBER","body":"@njgre6 yes good catch, thank you! Commit ae41d5855a2150e9c394a0e0fb5f0abebc9e5635 should fix this now.","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/488680685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":2314564119,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjMxNDU2NDExOQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2314564119","actor":{"login":"njgre6","id":37560420,"node_id":"MDQ6VXNlcjM3NTYwNDIw","avatar_url":"https://avatars.githubusercontent.com/u/37560420?v=4","gravatar_id":"","url":"https://api.github.com/users/njgre6","html_url":"https://github.com/njgre6","followers_url":"https://api.github.com/users/njgre6/followers","following_url":"https://api.github.com/users/njgre6/following{/other_user}","gists_url":"https://api.github.com/users/njgre6/gists{/gist_id}","starred_url":"https://api.github.com/users/njgre6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/njgre6/subscriptions","organizations_url":"https://api.github.com/users/njgre6/orgs","repos_url":"https://api.github.com/users/njgre6/repos","events_url":"https://api.github.com/users/njgre6/events{/privacy}","received_events_url":"https://api.github.com/users/njgre6/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-02T13:49:22Z","performed_via_github_app":null},{"id":2314564123,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzMTQ1NjQxMjM=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2314564123","actor":{"login":"njgre6","id":37560420,"node_id":"MDQ6VXNlcjM3NTYwNDIw","avatar_url":"https://avatars.githubusercontent.com/u/37560420?v=4","gravatar_id":"","url":"https://api.github.com/users/njgre6","html_url":"https://github.com/njgre6","followers_url":"https://api.github.com/users/njgre6/followers","following_url":"https://api.github.com/users/njgre6/following{/other_user}","gists_url":"https://api.github.com/users/njgre6/gists{/gist_id}","starred_url":"https://api.github.com/users/njgre6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/njgre6/subscriptions","organizations_url":"https://api.github.com/users/njgre6/orgs","repos_url":"https://api.github.com/users/njgre6/repos","events_url":"https://api.github.com/users/njgre6/events{/privacy}","received_events_url":"https://api.github.com/users/njgre6/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-02T13:49:22Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/592664722","html_url":"https://github.com/ultralytics/yolov3/issues/249#issuecomment-592664722","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/249","id":592664722,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MjY2NDcyMg==","user":{"login":"chouxianyu","id":41263448,"node_id":"MDQ6VXNlcjQxMjYzNDQ4","avatar_url":"https://avatars.githubusercontent.com/u/41263448?v=4","gravatar_id":"","url":"https://api.github.com/users/chouxianyu","html_url":"https://github.com/chouxianyu","followers_url":"https://api.github.com/users/chouxianyu/followers","following_url":"https://api.github.com/users/chouxianyu/following{/other_user}","gists_url":"https://api.github.com/users/chouxianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/chouxianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chouxianyu/subscriptions","organizations_url":"https://api.github.com/users/chouxianyu/orgs","repos_url":"https://api.github.com/users/chouxianyu/repos","events_url":"https://api.github.com/users/chouxianyu/events{/privacy}","received_events_url":"https://api.github.com/users/chouxianyu/received_events","type":"User","site_admin":false},"created_at":"2020-02-28T18:32:11Z","updated_at":"2020-02-28T18:32:11Z","author_association":"NONE","body":"how to use `class weighting` with `torch.nn.BCEWithLogitsLoss`?","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/592664722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"chouxianyu","id":41263448,"node_id":"MDQ6VXNlcjQxMjYzNDQ4","avatar_url":"https://avatars.githubusercontent.com/u/41263448?v=4","gravatar_id":"","url":"https://api.github.com/users/chouxianyu","html_url":"https://github.com/chouxianyu","followers_url":"https://api.github.com/users/chouxianyu/followers","following_url":"https://api.github.com/users/chouxianyu/following{/other_user}","gists_url":"https://api.github.com/users/chouxianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/chouxianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chouxianyu/subscriptions","organizations_url":"https://api.github.com/users/chouxianyu/orgs","repos_url":"https://api.github.com/users/chouxianyu/repos","events_url":"https://api.github.com/users/chouxianyu/events{/privacy}","received_events_url":"https://api.github.com/users/chouxianyu/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/592691653","html_url":"https://github.com/ultralytics/yolov3/issues/249#issuecomment-592691653","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/249","id":592691653,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MjY5MTY1Mw==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2020-02-28T19:36:09Z","updated_at":"2020-02-28T19:36:09Z","author_association":"MEMBER","body":"@chouxianyu you'd have to try to apply the weights experimentally using `model.class_weights` here:\r\n\r\nhttps://github.com/ultralytics/yolov3/blob/cc08e09219960f70f4a70ef5ee0c13dfafe3832a/utils/utils.py#L366-L379","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/592691653/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":3083265681,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzA4MzI2NTY4MQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3083265681","actor":{"login":"chouxianyu","id":41263448,"node_id":"MDQ6VXNlcjQxMjYzNDQ4","avatar_url":"https://avatars.githubusercontent.com/u/41263448?v=4","gravatar_id":"","url":"https://api.github.com/users/chouxianyu","html_url":"https://github.com/chouxianyu","followers_url":"https://api.github.com/users/chouxianyu/followers","following_url":"https://api.github.com/users/chouxianyu/following{/other_user}","gists_url":"https://api.github.com/users/chouxianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/chouxianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chouxianyu/subscriptions","organizations_url":"https://api.github.com/users/chouxianyu/orgs","repos_url":"https://api.github.com/users/chouxianyu/repos","events_url":"https://api.github.com/users/chouxianyu/events{/privacy}","received_events_url":"https://api.github.com/users/chouxianyu/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-02-28T19:36:09Z","performed_via_github_app":null},{"id":3083265686,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMwODMyNjU2ODY=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3083265686","actor":{"login":"chouxianyu","id":41263448,"node_id":"MDQ6VXNlcjQxMjYzNDQ4","avatar_url":"https://avatars.githubusercontent.com/u/41263448?v=4","gravatar_id":"","url":"https://api.github.com/users/chouxianyu","html_url":"https://github.com/chouxianyu","followers_url":"https://api.github.com/users/chouxianyu/followers","following_url":"https://api.github.com/users/chouxianyu/following{/other_user}","gists_url":"https://api.github.com/users/chouxianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/chouxianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chouxianyu/subscriptions","organizations_url":"https://api.github.com/users/chouxianyu/orgs","repos_url":"https://api.github.com/users/chouxianyu/repos","events_url":"https://api.github.com/users/chouxianyu/events{/privacy}","received_events_url":"https://api.github.com/users/chouxianyu/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-02-28T19:36:09Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/592706282","html_url":"https://github.com/ultralytics/yolov3/issues/249#issuecomment-592706282","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/249","id":592706282,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MjcwNjI4Mg==","user":{"login":"chouxianyu","id":41263448,"node_id":"MDQ6VXNlcjQxMjYzNDQ4","avatar_url":"https://avatars.githubusercontent.com/u/41263448?v=4","gravatar_id":"","url":"https://api.github.com/users/chouxianyu","html_url":"https://github.com/chouxianyu","followers_url":"https://api.github.com/users/chouxianyu/followers","following_url":"https://api.github.com/users/chouxianyu/following{/other_user}","gists_url":"https://api.github.com/users/chouxianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/chouxianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chouxianyu/subscriptions","organizations_url":"https://api.github.com/users/chouxianyu/orgs","repos_url":"https://api.github.com/users/chouxianyu/repos","events_url":"https://api.github.com/users/chouxianyu/events{/privacy}","received_events_url":"https://api.github.com/users/chouxianyu/received_events","type":"User","site_admin":false},"created_at":"2020-02-28T20:08:18Z","updated_at":"2020-04-12T03:13:42Z","author_association":"NONE","body":"@glenn-jocher \r\nthanks for your early reply!\r\nAccording to this tutorial, I know how to use `torch.nn.CrossEntropyLoss` with `model.class_weights`.\r\nit's just like this:`CE = nn.CrossEntropyLoss(reduction=red,weight=model.class_weights)`.\r\n\r\n**But I want to use 'torch.nn.BCEWithLogitsLoss' with `model.class_weights`, I would like to know is the code `BCE = nn.bcewithlogitsloss(reduction = red,weight=model.class_weights)` correct?**\r\n\r\nI raise this question because that I find some different between `torch.nn.CrossEntropyLoss` and `torch.nn.BCEWithLogitsLoss`:\r\nIn `BCEWithLogitsLoss`,\r\n>Args:\r\n        weight (Tensor, optional): a manual rescaling weight given to the loss\r\n            of each batch element. If given, has to be a Tensor of size `nbatch`.\r\n\r\nIn `CrossEntropyLoss`:\r\n>Args:\r\n        weight (Tensor, optional): a manual rescaling weight given to each class.\r\n            If given, has to be a Tensor of size `C`\r\n\r\n**the parameter `weight` seems to mean differently?**\r\n\r\nLooking forward to your reply!","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/592706282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"chouxianyu","id":41263448,"node_id":"MDQ6VXNlcjQxMjYzNDQ4","avatar_url":"https://avatars.githubusercontent.com/u/41263448?v=4","gravatar_id":"","url":"https://api.github.com/users/chouxianyu","html_url":"https://github.com/chouxianyu","followers_url":"https://api.github.com/users/chouxianyu/followers","following_url":"https://api.github.com/users/chouxianyu/following{/other_user}","gists_url":"https://api.github.com/users/chouxianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/chouxianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chouxianyu/subscriptions","organizations_url":"https://api.github.com/users/chouxianyu/orgs","repos_url":"https://api.github.com/users/chouxianyu/repos","events_url":"https://api.github.com/users/chouxianyu/events{/privacy}","received_events_url":"https://api.github.com/users/chouxianyu/received_events","type":"User","site_admin":false}},{"id":3083368530,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzA4MzM2ODUzMA==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3083368530","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-02-28T20:08:18Z","performed_via_github_app":null},{"id":3083368532,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMwODMzNjg1MzI=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3083368532","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-02-28T20:08:18Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/592708341","html_url":"https://github.com/ultralytics/yolov3/issues/249#issuecomment-592708341","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/249","id":592708341,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MjcwODM0MQ==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2020-02-28T20:13:50Z","updated_at":"2020-02-28T20:14:23Z","author_association":"MEMBER","body":"@chouxianyu we have only used class weights with CEloss, so you have to experiment yourself with how to implement it in BCEloss. Of course, you could always implement it manually also, using reduction=None, and then apply them yourself, and then do the sum/mean reduction afterwards.\r\n\r\nThis question might be better addressed on the pytorch forums also since it's a general pytorch question. https://discuss.pytorch.org/\r\n\r\nIf you find a good answer please post back here with it!","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/592708341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":3083384235,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzA4MzM4NDIzNQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3083384235","actor":{"login":"chouxianyu","id":41263448,"node_id":"MDQ6VXNlcjQxMjYzNDQ4","avatar_url":"https://avatars.githubusercontent.com/u/41263448?v=4","gravatar_id":"","url":"https://api.github.com/users/chouxianyu","html_url":"https://github.com/chouxianyu","followers_url":"https://api.github.com/users/chouxianyu/followers","following_url":"https://api.github.com/users/chouxianyu/following{/other_user}","gists_url":"https://api.github.com/users/chouxianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/chouxianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chouxianyu/subscriptions","organizations_url":"https://api.github.com/users/chouxianyu/orgs","repos_url":"https://api.github.com/users/chouxianyu/repos","events_url":"https://api.github.com/users/chouxianyu/events{/privacy}","received_events_url":"https://api.github.com/users/chouxianyu/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-02-28T20:13:50Z","performed_via_github_app":null},{"id":3083384238,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMwODMzODQyMzg=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3083384238","actor":{"login":"chouxianyu","id":41263448,"node_id":"MDQ6VXNlcjQxMjYzNDQ4","avatar_url":"https://avatars.githubusercontent.com/u/41263448?v=4","gravatar_id":"","url":"https://api.github.com/users/chouxianyu","html_url":"https://github.com/chouxianyu","followers_url":"https://api.github.com/users/chouxianyu/followers","following_url":"https://api.github.com/users/chouxianyu/following{/other_user}","gists_url":"https://api.github.com/users/chouxianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/chouxianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chouxianyu/subscriptions","organizations_url":"https://api.github.com/users/chouxianyu/orgs","repos_url":"https://api.github.com/users/chouxianyu/repos","events_url":"https://api.github.com/users/chouxianyu/events{/privacy}","received_events_url":"https://api.github.com/users/chouxianyu/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-02-28T20:13:50Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/592708965","html_url":"https://github.com/ultralytics/yolov3/issues/249#issuecomment-592708965","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/249","id":592708965,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MjcwODk2NQ==","user":{"login":"chouxianyu","id":41263448,"node_id":"MDQ6VXNlcjQxMjYzNDQ4","avatar_url":"https://avatars.githubusercontent.com/u/41263448?v=4","gravatar_id":"","url":"https://api.github.com/users/chouxianyu","html_url":"https://github.com/chouxianyu","followers_url":"https://api.github.com/users/chouxianyu/followers","following_url":"https://api.github.com/users/chouxianyu/following{/other_user}","gists_url":"https://api.github.com/users/chouxianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/chouxianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chouxianyu/subscriptions","organizations_url":"https://api.github.com/users/chouxianyu/orgs","repos_url":"https://api.github.com/users/chouxianyu/repos","events_url":"https://api.github.com/users/chouxianyu/events{/privacy}","received_events_url":"https://api.github.com/users/chouxianyu/received_events","type":"User","site_admin":false},"created_at":"2020-02-28T20:15:19Z","updated_at":"2020-02-28T20:15:19Z","author_association":"NONE","body":"@glenn-jocher \r\nok,thanks again!","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/592708965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"chouxianyu","id":41263448,"node_id":"MDQ6VXNlcjQxMjYzNDQ4","avatar_url":"https://avatars.githubusercontent.com/u/41263448?v=4","gravatar_id":"","url":"https://api.github.com/users/chouxianyu","html_url":"https://github.com/chouxianyu","followers_url":"https://api.github.com/users/chouxianyu/followers","following_url":"https://api.github.com/users/chouxianyu/following{/other_user}","gists_url":"https://api.github.com/users/chouxianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/chouxianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chouxianyu/subscriptions","organizations_url":"https://api.github.com/users/chouxianyu/orgs","repos_url":"https://api.github.com/users/chouxianyu/repos","events_url":"https://api.github.com/users/chouxianyu/events{/privacy}","received_events_url":"https://api.github.com/users/chouxianyu/received_events","type":"User","site_admin":false}},{"id":3083388319,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzA4MzM4ODMxOQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3083388319","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-02-28T20:15:19Z","performed_via_github_app":null},{"id":3083388321,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMwODMzODgzMjE=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3083388321","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-02-28T20:15:19Z","performed_via_github_app":null}]