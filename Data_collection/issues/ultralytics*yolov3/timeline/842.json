[{"id":3025822393,"node_id":"MDEyOkxhYmVsZWRFdmVudDMwMjU4MjIzOTM=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3025822393","actor":{"login":"alontrais","id":54616588,"node_id":"MDQ6VXNlcjU0NjE2NTg4","avatar_url":"https://avatars.githubusercontent.com/u/54616588?v=4","gravatar_id":"","url":"https://api.github.com/users/alontrais","html_url":"https://github.com/alontrais","followers_url":"https://api.github.com/users/alontrais/followers","following_url":"https://api.github.com/users/alontrais/following{/other_user}","gists_url":"https://api.github.com/users/alontrais/gists{/gist_id}","starred_url":"https://api.github.com/users/alontrais/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alontrais/subscriptions","organizations_url":"https://api.github.com/users/alontrais/orgs","repos_url":"https://api.github.com/users/alontrais/repos","events_url":"https://api.github.com/users/alontrais/events{/privacy}","received_events_url":"https://api.github.com/users/alontrais/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-02-11T09:46:20Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/584748906","html_url":"https://github.com/ultralytics/yolov3/issues/842#issuecomment-584748906","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/842","id":584748906,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDc0ODkwNg==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2020-02-11T17:21:23Z","updated_at":"2020-02-11T17:21:23Z","author_association":"MEMBER","body":"Hello, thank you for your interest in our work! This issue seems to lack the minimum requirements for a proper response, or is insufficiently detailed for us to help you. In general you can use https://github.com/ultralytics/yolov3/compare to display differences between repository versions.\r\n\r\nPlease note that most technical problems are due to:\r\n\r\n- **Your changes to the default repository**. If your issue is not reproducible in a fresh `git clone` version of this repository we can not debug it. Before going further run this code and ensure your issue persists:\r\n```bash\r\nsudo rm -rf yolov3  # remove existing\r\ngit clone https://github.com/ultralytics/yolov3 && cd yolov3 # clone latest\r\npython3 detect.py  # verify detection\r\npython3 train.py  # verify training (a few batches only)\r\n# CODE TO REPRODUCE YOUR ISSUE HERE\r\n```\r\n- **Your custom data.** If your issue is not reproducible with COCO data we can not debug it. Visit our [Custom Training Tutorial](https://github.com/ultralytics/yolov3/wiki/Train-Custom-Data) for exact details on how to format your custom data. Examine `train_batch0.jpg` and `test_batch0.jpg` for a sanity check of training and testing data.\r\n- **Your environment.** If your issue is not reproducible in a [GCP Quickstart Guide](https://github.com/ultralytics/yolov3/wiki/GCP-Quickstart) VM we can not debug it. Ensure you meet the requirements specified in the README: Unix, MacOS, or Windows with Python >= 3.7, PyTorch >= 1.3 etc. You can also use our [Google Colab Notebook](https://colab.research.google.com/drive/1G8T-VFxQkjDe4idzN8F-hbIBqkkkQnxw) and our [Docker Image](https://hub.docker.com/r/ultralytics/yolov3) to test your code in working environment.\r\n\r\nIf none of these apply to you, we suggest you close this issue and raise a new one using the **Bug Report template**, providing screenshots and **minimum viable code to reproduce your issue**. Thank you!","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/584748906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/584763433","html_url":"https://github.com/ultralytics/yolov3/issues/842#issuecomment-584763433","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/842","id":584763433,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDc2MzQzMw==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2020-02-11T17:47:02Z","updated_at":"2020-02-11T17:47:02Z","author_association":"MEMBER","body":"@alontrais ah one thing pops out from your terminal output. Your images are very large, which is not a use case we have tested. The current objectness loss construction is probably causing this. You can try `red = 'mean'` on L372 when building your loss, which may help.\r\nhttps://github.com/ultralytics/yolov3/blob/0958d81580a8a0086ac3326feeba4f6db20b70a5/utils/utils.py#L366-L373\r\n\r\n","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/584763433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":3027569435,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzAyNzU2OTQzNQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3027569435","actor":{"login":"alontrais","id":54616588,"node_id":"MDQ6VXNlcjU0NjE2NTg4","avatar_url":"https://avatars.githubusercontent.com/u/54616588?v=4","gravatar_id":"","url":"https://api.github.com/users/alontrais","html_url":"https://github.com/alontrais","followers_url":"https://api.github.com/users/alontrais/followers","following_url":"https://api.github.com/users/alontrais/following{/other_user}","gists_url":"https://api.github.com/users/alontrais/gists{/gist_id}","starred_url":"https://api.github.com/users/alontrais/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alontrais/subscriptions","organizations_url":"https://api.github.com/users/alontrais/orgs","repos_url":"https://api.github.com/users/alontrais/repos","events_url":"https://api.github.com/users/alontrais/events{/privacy}","received_events_url":"https://api.github.com/users/alontrais/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-02-11T17:47:03Z","performed_via_github_app":null},{"id":3027569445,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMwMjc1Njk0NDU=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3027569445","actor":{"login":"alontrais","id":54616588,"node_id":"MDQ6VXNlcjU0NjE2NTg4","avatar_url":"https://avatars.githubusercontent.com/u/54616588?v=4","gravatar_id":"","url":"https://api.github.com/users/alontrais","html_url":"https://github.com/alontrais","followers_url":"https://api.github.com/users/alontrais/followers","following_url":"https://api.github.com/users/alontrais/following{/other_user}","gists_url":"https://api.github.com/users/alontrais/gists{/gist_id}","starred_url":"https://api.github.com/users/alontrais/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alontrais/subscriptions","organizations_url":"https://api.github.com/users/alontrais/orgs","repos_url":"https://api.github.com/users/alontrais/repos","events_url":"https://api.github.com/users/alontrais/events{/privacy}","received_events_url":"https://api.github.com/users/alontrais/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-02-11T17:47:03Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/584766094","html_url":"https://github.com/ultralytics/yolov3/issues/842#issuecomment-584766094","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/842","id":584766094,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDc2NjA5NA==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2020-02-11T17:52:38Z","updated_at":"2020-02-11T17:52:38Z","author_association":"MEMBER","body":"@alontrais also, irrespective of the loss reduction, your obj loss is simply far too large. The 3 loss components should be more or less evenly balanced, so you can manually adjust (lower, in your case) your objetness loss hyperparameter on L28 to compensate:\r\nhttps://github.com/ultralytics/yolov3/blob/0958d81580a8a0086ac3326feeba4f6db20b70a5/train.py#L23-L43","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/584766094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":3027588088,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzAyNzU4ODA4OA==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3027588088","actor":{"login":"alontrais","id":54616588,"node_id":"MDQ6VXNlcjU0NjE2NTg4","avatar_url":"https://avatars.githubusercontent.com/u/54616588?v=4","gravatar_id":"","url":"https://api.github.com/users/alontrais","html_url":"https://github.com/alontrais","followers_url":"https://api.github.com/users/alontrais/followers","following_url":"https://api.github.com/users/alontrais/following{/other_user}","gists_url":"https://api.github.com/users/alontrais/gists{/gist_id}","starred_url":"https://api.github.com/users/alontrais/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alontrais/subscriptions","organizations_url":"https://api.github.com/users/alontrais/orgs","repos_url":"https://api.github.com/users/alontrais/repos","events_url":"https://api.github.com/users/alontrais/events{/privacy}","received_events_url":"https://api.github.com/users/alontrais/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-02-11T17:52:39Z","performed_via_github_app":null},{"id":3027588093,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMwMjc1ODgwOTM=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3027588093","actor":{"login":"alontrais","id":54616588,"node_id":"MDQ6VXNlcjU0NjE2NTg4","avatar_url":"https://avatars.githubusercontent.com/u/54616588?v=4","gravatar_id":"","url":"https://api.github.com/users/alontrais","html_url":"https://github.com/alontrais","followers_url":"https://api.github.com/users/alontrais/followers","following_url":"https://api.github.com/users/alontrais/following{/other_user}","gists_url":"https://api.github.com/users/alontrais/gists{/gist_id}","starred_url":"https://api.github.com/users/alontrais/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alontrais/subscriptions","organizations_url":"https://api.github.com/users/alontrais/orgs","repos_url":"https://api.github.com/users/alontrais/repos","events_url":"https://api.github.com/users/alontrais/events{/privacy}","received_events_url":"https://api.github.com/users/alontrais/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-02-11T17:52:39Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/585528101","html_url":"https://github.com/ultralytics/yolov3/issues/842#issuecomment-585528101","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/842","id":585528101,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTUyODEwMQ==","user":{"login":"qwe3208620","id":14366698,"node_id":"MDQ6VXNlcjE0MzY2Njk4","avatar_url":"https://avatars.githubusercontent.com/u/14366698?v=4","gravatar_id":"","url":"https://api.github.com/users/qwe3208620","html_url":"https://github.com/qwe3208620","followers_url":"https://api.github.com/users/qwe3208620/followers","following_url":"https://api.github.com/users/qwe3208620/following{/other_user}","gists_url":"https://api.github.com/users/qwe3208620/gists{/gist_id}","starred_url":"https://api.github.com/users/qwe3208620/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qwe3208620/subscriptions","organizations_url":"https://api.github.com/users/qwe3208620/orgs","repos_url":"https://api.github.com/users/qwe3208620/repos","events_url":"https://api.github.com/users/qwe3208620/events{/privacy}","received_events_url":"https://api.github.com/users/qwe3208620/received_events","type":"User","site_admin":false},"created_at":"2020-02-13T03:10:42Z","updated_at":"2020-02-13T03:10:42Z","author_association":"NONE","body":"I encountered the same problem, it happened after changing the learning rate decay function, the hyperparameters suddenly increased during training","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/585528101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"qwe3208620","id":14366698,"node_id":"MDQ6VXNlcjE0MzY2Njk4","avatar_url":"https://avatars.githubusercontent.com/u/14366698?v=4","gravatar_id":"","url":"https://api.github.com/users/qwe3208620","html_url":"https://github.com/qwe3208620","followers_url":"https://api.github.com/users/qwe3208620/followers","following_url":"https://api.github.com/users/qwe3208620/following{/other_user}","gists_url":"https://api.github.com/users/qwe3208620/gists{/gist_id}","starred_url":"https://api.github.com/users/qwe3208620/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qwe3208620/subscriptions","organizations_url":"https://api.github.com/users/qwe3208620/orgs","repos_url":"https://api.github.com/users/qwe3208620/repos","events_url":"https://api.github.com/users/qwe3208620/events{/privacy}","received_events_url":"https://api.github.com/users/qwe3208620/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/585900463","html_url":"https://github.com/ultralytics/yolov3/issues/842#issuecomment-585900463","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/842","id":585900463,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTkwMDQ2Mw==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2020-02-13T18:22:11Z","updated_at":"2020-02-13T18:22:11Z","author_association":"MEMBER","body":"@qwe3208620 the hyperparameters are static during training except for the LR (and momentum if you use SGD). The LR scheduler modifies the LR, and a prebiasing step for the first 3 epochs increases bias-only LR and momentum.","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/585900463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":3036008713,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzAzNjAwODcxMw==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3036008713","actor":{"login":"qwe3208620","id":14366698,"node_id":"MDQ6VXNlcjE0MzY2Njk4","avatar_url":"https://avatars.githubusercontent.com/u/14366698?v=4","gravatar_id":"","url":"https://api.github.com/users/qwe3208620","html_url":"https://github.com/qwe3208620","followers_url":"https://api.github.com/users/qwe3208620/followers","following_url":"https://api.github.com/users/qwe3208620/following{/other_user}","gists_url":"https://api.github.com/users/qwe3208620/gists{/gist_id}","starred_url":"https://api.github.com/users/qwe3208620/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qwe3208620/subscriptions","organizations_url":"https://api.github.com/users/qwe3208620/orgs","repos_url":"https://api.github.com/users/qwe3208620/repos","events_url":"https://api.github.com/users/qwe3208620/events{/privacy}","received_events_url":"https://api.github.com/users/qwe3208620/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-02-13T18:22:11Z","performed_via_github_app":null},{"id":3036008715,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMwMzYwMDg3MTU=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3036008715","actor":{"login":"qwe3208620","id":14366698,"node_id":"MDQ6VXNlcjE0MzY2Njk4","avatar_url":"https://avatars.githubusercontent.com/u/14366698?v=4","gravatar_id":"","url":"https://api.github.com/users/qwe3208620","html_url":"https://github.com/qwe3208620","followers_url":"https://api.github.com/users/qwe3208620/followers","following_url":"https://api.github.com/users/qwe3208620/following{/other_user}","gists_url":"https://api.github.com/users/qwe3208620/gists{/gist_id}","starred_url":"https://api.github.com/users/qwe3208620/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qwe3208620/subscriptions","organizations_url":"https://api.github.com/users/qwe3208620/orgs","repos_url":"https://api.github.com/users/qwe3208620/repos","events_url":"https://api.github.com/users/qwe3208620/events{/privacy}","received_events_url":"https://api.github.com/users/qwe3208620/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-02-13T18:22:11Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/595718147","html_url":"https://github.com/ultralytics/yolov3/issues/842#issuecomment-595718147","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/842","id":595718147,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTcxODE0Nw==","user":{"login":"guancheng817","id":38133705,"node_id":"MDQ6VXNlcjM4MTMzNzA1","avatar_url":"https://avatars.githubusercontent.com/u/38133705?v=4","gravatar_id":"","url":"https://api.github.com/users/guancheng817","html_url":"https://github.com/guancheng817","followers_url":"https://api.github.com/users/guancheng817/followers","following_url":"https://api.github.com/users/guancheng817/following{/other_user}","gists_url":"https://api.github.com/users/guancheng817/gists{/gist_id}","starred_url":"https://api.github.com/users/guancheng817/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guancheng817/subscriptions","organizations_url":"https://api.github.com/users/guancheng817/orgs","repos_url":"https://api.github.com/users/guancheng817/repos","events_url":"https://api.github.com/users/guancheng817/events{/privacy}","received_events_url":"https://api.github.com/users/guancheng817/received_events","type":"User","site_admin":false},"created_at":"2020-03-06T11:02:16Z","updated_at":"2020-03-06T11:02:16Z","author_association":"NONE","body":"hi, I encountered the same problem when I trained my custom dataset, shown as the following pic.. and I lower the  giou weight and lr, but it doesn't work. \r\n \r\n![image](https://user-images.githubusercontent.com/38133705/76078066-e1905d80-5fdc-11ea-9118-4bf0d5295d67.png)\r\n","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/595718147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"guancheng817","id":38133705,"node_id":"MDQ6VXNlcjM4MTMzNzA1","avatar_url":"https://avatars.githubusercontent.com/u/38133705?v=4","gravatar_id":"","url":"https://api.github.com/users/guancheng817","html_url":"https://github.com/guancheng817","followers_url":"https://api.github.com/users/guancheng817/followers","following_url":"https://api.github.com/users/guancheng817/following{/other_user}","gists_url":"https://api.github.com/users/guancheng817/gists{/gist_id}","starred_url":"https://api.github.com/users/guancheng817/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guancheng817/subscriptions","organizations_url":"https://api.github.com/users/guancheng817/orgs","repos_url":"https://api.github.com/users/guancheng817/repos","events_url":"https://api.github.com/users/guancheng817/events{/privacy}","received_events_url":"https://api.github.com/users/guancheng817/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/595909373","html_url":"https://github.com/ultralytics/yolov3/issues/842#issuecomment-595909373","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/842","id":595909373,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTkwOTM3Mw==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2020-03-06T18:53:37Z","updated_at":"2020-03-06T18:53:37Z","author_association":"MEMBER","body":"@guancheng817 you might want to disable apex mixed precision training if you are using it.","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/595909373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":3106479089,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzEwNjQ3OTA4OQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3106479089","actor":{"login":"guancheng817","id":38133705,"node_id":"MDQ6VXNlcjM4MTMzNzA1","avatar_url":"https://avatars.githubusercontent.com/u/38133705?v=4","gravatar_id":"","url":"https://api.github.com/users/guancheng817","html_url":"https://github.com/guancheng817","followers_url":"https://api.github.com/users/guancheng817/followers","following_url":"https://api.github.com/users/guancheng817/following{/other_user}","gists_url":"https://api.github.com/users/guancheng817/gists{/gist_id}","starred_url":"https://api.github.com/users/guancheng817/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guancheng817/subscriptions","organizations_url":"https://api.github.com/users/guancheng817/orgs","repos_url":"https://api.github.com/users/guancheng817/repos","events_url":"https://api.github.com/users/guancheng817/events{/privacy}","received_events_url":"https://api.github.com/users/guancheng817/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-03-06T18:53:37Z","performed_via_github_app":null},{"id":3106479091,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMxMDY0NzkwOTE=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3106479091","actor":{"login":"guancheng817","id":38133705,"node_id":"MDQ6VXNlcjM4MTMzNzA1","avatar_url":"https://avatars.githubusercontent.com/u/38133705?v=4","gravatar_id":"","url":"https://api.github.com/users/guancheng817","html_url":"https://github.com/guancheng817","followers_url":"https://api.github.com/users/guancheng817/followers","following_url":"https://api.github.com/users/guancheng817/following{/other_user}","gists_url":"https://api.github.com/users/guancheng817/gists{/gist_id}","starred_url":"https://api.github.com/users/guancheng817/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guancheng817/subscriptions","organizations_url":"https://api.github.com/users/guancheng817/orgs","repos_url":"https://api.github.com/users/guancheng817/repos","events_url":"https://api.github.com/users/guancheng817/events{/privacy}","received_events_url":"https://api.github.com/users/guancheng817/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-03-06T18:53:37Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/605557191","html_url":"https://github.com/ultralytics/yolov3/issues/842#issuecomment-605557191","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/842","id":605557191,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNTU1NzE5MQ==","user":{"login":"yangxu351","id":12199053,"node_id":"MDQ6VXNlcjEyMTk5MDUz","avatar_url":"https://avatars.githubusercontent.com/u/12199053?v=4","gravatar_id":"","url":"https://api.github.com/users/yangxu351","html_url":"https://github.com/yangxu351","followers_url":"https://api.github.com/users/yangxu351/followers","following_url":"https://api.github.com/users/yangxu351/following{/other_user}","gists_url":"https://api.github.com/users/yangxu351/gists{/gist_id}","starred_url":"https://api.github.com/users/yangxu351/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yangxu351/subscriptions","organizations_url":"https://api.github.com/users/yangxu351/orgs","repos_url":"https://api.github.com/users/yangxu351/repos","events_url":"https://api.github.com/users/yangxu351/events{/privacy}","received_events_url":"https://api.github.com/users/yangxu351/received_events","type":"User","site_admin":false},"created_at":"2020-03-29T04:29:40Z","updated_at":"2020-03-29T04:29:40Z","author_association":"NONE","body":"I encountered this problem too, I'm wondering if it's related to the empty label files or zero filled label files? @glenn-jocher \r\n    29/179     9.72G      5.06     0.906         0      5.97         5       608\r\n    29/179     9.72G      5.05      0.91         0      5.96        11       608\r\nWARNING: non-finite loss, ending training  tensor([nan, nan, 0., nan], device='cuda:0')","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/605557191/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yangxu351","id":12199053,"node_id":"MDQ6VXNlcjEyMTk5MDUz","avatar_url":"https://avatars.githubusercontent.com/u/12199053?v=4","gravatar_id":"","url":"https://api.github.com/users/yangxu351","html_url":"https://github.com/yangxu351","followers_url":"https://api.github.com/users/yangxu351/followers","following_url":"https://api.github.com/users/yangxu351/following{/other_user}","gists_url":"https://api.github.com/users/yangxu351/gists{/gist_id}","starred_url":"https://api.github.com/users/yangxu351/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yangxu351/subscriptions","organizations_url":"https://api.github.com/users/yangxu351/orgs","repos_url":"https://api.github.com/users/yangxu351/repos","events_url":"https://api.github.com/users/yangxu351/events{/privacy}","received_events_url":"https://api.github.com/users/yangxu351/received_events","type":"User","site_admin":false}},{"id":3175570330,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzE3NTU3MDMzMA==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3175570330","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-03-29T04:29:40Z","performed_via_github_app":null},{"id":3175570333,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMxNzU1NzAzMzM=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3175570333","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-03-29T04:29:40Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/605561226","html_url":"https://github.com/ultralytics/yolov3/issues/842#issuecomment-605561226","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/842","id":605561226,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNTU2MTIyNg==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2020-03-29T05:23:54Z","updated_at":"2020-03-29T05:23:54Z","author_association":"MEMBER","body":"@yangxu351 no definitely not. If there are no labels then there is no loss other than obj loss.\r\n\r\nIf it occurs repeatably perhaps you could print the loss components and trace the origin? Your message says it occurs in the first two only, with the last loss being zero? The 3 are box, obj and cls. \r\n\r\nSo that means it's probably originating in the GIoU calculation, which feeds the obj loss as well.","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/605561226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":3175596466,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzE3NTU5NjQ2Ng==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3175596466","actor":{"login":"yangxu351","id":12199053,"node_id":"MDQ6VXNlcjEyMTk5MDUz","avatar_url":"https://avatars.githubusercontent.com/u/12199053?v=4","gravatar_id":"","url":"https://api.github.com/users/yangxu351","html_url":"https://github.com/yangxu351","followers_url":"https://api.github.com/users/yangxu351/followers","following_url":"https://api.github.com/users/yangxu351/following{/other_user}","gists_url":"https://api.github.com/users/yangxu351/gists{/gist_id}","starred_url":"https://api.github.com/users/yangxu351/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yangxu351/subscriptions","organizations_url":"https://api.github.com/users/yangxu351/orgs","repos_url":"https://api.github.com/users/yangxu351/repos","events_url":"https://api.github.com/users/yangxu351/events{/privacy}","received_events_url":"https://api.github.com/users/yangxu351/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-03-29T05:23:54Z","performed_via_github_app":null},{"id":3175596467,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMxNzU1OTY0Njc=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3175596467","actor":{"login":"yangxu351","id":12199053,"node_id":"MDQ6VXNlcjEyMTk5MDUz","avatar_url":"https://avatars.githubusercontent.com/u/12199053?v=4","gravatar_id":"","url":"https://api.github.com/users/yangxu351","html_url":"https://github.com/yangxu351","followers_url":"https://api.github.com/users/yangxu351/followers","following_url":"https://api.github.com/users/yangxu351/following{/other_user}","gists_url":"https://api.github.com/users/yangxu351/gists{/gist_id}","starred_url":"https://api.github.com/users/yangxu351/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yangxu351/subscriptions","organizations_url":"https://api.github.com/users/yangxu351/orgs","repos_url":"https://api.github.com/users/yangxu351/repos","events_url":"https://api.github.com/users/yangxu351/events{/privacy}","received_events_url":"https://api.github.com/users/yangxu351/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-03-29T05:23:54Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/605562473","html_url":"https://github.com/ultralytics/yolov3/issues/842#issuecomment-605562473","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/842","id":605562473,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNTU2MjQ3Mw==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2020-03-29T05:26:09Z","updated_at":"2020-03-29T05:26:21Z","author_association":"MEMBER","body":"The giou computation is in utils.py. It has protected divides in place though, so I don't understand how it could generate an nan:\r\n\r\n```python\r\ndef bbox_iou(box1, box2, x1y1x2y2=True, GIoU=False, DIoU=False, CIoU=False):\r\n    # Returns the IoU of box1 to box2. box1 is 4, box2 is nx4\r\n    box2 = box2.t()\r\n\r\n    # Get the coordinates of bounding boxes\r\n    if x1y1x2y2:  # x1, y1, x2, y2 = box1\r\n        b1_x1, b1_y1, b1_x2, b1_y2 = box1[0], box1[1], box1[2], box1[3]\r\n        b2_x1, b2_y1, b2_x2, b2_y2 = box2[0], box2[1], box2[2], box2[3]\r\n    else:  # transform from xywh to xyxy\r\n        b1_x1, b1_x2 = box1[0] - box1[2] / 2, box1[0] + box1[2] / 2\r\n        b1_y1, b1_y2 = box1[1] - box1[3] / 2, box1[1] + box1[3] / 2\r\n        b2_x1, b2_x2 = box2[0] - box2[2] / 2, box2[0] + box2[2] / 2\r\n        b2_y1, b2_y2 = box2[1] - box2[3] / 2, box2[1] + box2[3] / 2\r\n\r\n    # Intersection area\r\n    inter = (torch.min(b1_x2, b2_x2) - torch.max(b1_x1, b2_x1)).clamp(0) * \\\r\n            (torch.min(b1_y2, b2_y2) - torch.max(b1_y1, b2_y1)).clamp(0)\r\n\r\n    # Union Area\r\n    w1, h1 = b1_x2 - b1_x1, b1_y2 - b1_y1\r\n    w2, h2 = b2_x2 - b2_x1, b2_y2 - b2_y1\r\n    union = (w1 * h1 + 1e-16) + w2 * h2 - inter\r\n\r\n    iou = inter / union  # iou\r\n    if GIoU or DIoU or CIoU:\r\n        cw = torch.max(b1_x2, b2_x2) - torch.min(b1_x1, b2_x1)  # convex (smallest enclosing box) width\r\n        ch = torch.max(b1_y2, b2_y2) - torch.min(b1_y1, b2_y1)  # convex height\r\n        if GIoU:  # Generalized IoU https://arxiv.org/pdf/1902.09630.pdf\r\n            c_area = cw * ch + 1e-16  # convex area\r\n            return iou - (c_area - union) / c_area  # GIoU\r\n```","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/605562473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/605641510","html_url":"https://github.com/ultralytics/yolov3/issues/842#issuecomment-605641510","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/842","id":605641510,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNTY0MTUxMA==","user":{"login":"yangxu351","id":12199053,"node_id":"MDQ6VXNlcjEyMTk5MDUz","avatar_url":"https://avatars.githubusercontent.com/u/12199053?v=4","gravatar_id":"","url":"https://api.github.com/users/yangxu351","html_url":"https://github.com/yangxu351","followers_url":"https://api.github.com/users/yangxu351/followers","following_url":"https://api.github.com/users/yangxu351/following{/other_user}","gists_url":"https://api.github.com/users/yangxu351/gists{/gist_id}","starred_url":"https://api.github.com/users/yangxu351/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yangxu351/subscriptions","organizations_url":"https://api.github.com/users/yangxu351/orgs","repos_url":"https://api.github.com/users/yangxu351/repos","events_url":"https://api.github.com/users/yangxu351/events{/privacy}","received_events_url":"https://api.github.com/users/yangxu351/received_events","type":"User","site_admin":false},"created_at":"2020-03-29T14:06:08Z","updated_at":"2020-03-29T14:06:08Z","author_association":"NONE","body":"@glenn-jocher I noticed that all empty label files are filled with zero in the load_mosaic with labels = np.zeros((0, 5), dtype=np.float32). \r\nWARNING: non-finite loss, ending training tensor([nan, nan, 0., nan], device='cuda:0')\r\nfor single-class task, the lcls is 0, but I cannot figure out why other loss will be nan","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/605641510/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yangxu351","id":12199053,"node_id":"MDQ6VXNlcjEyMTk5MDUz","avatar_url":"https://avatars.githubusercontent.com/u/12199053?v=4","gravatar_id":"","url":"https://api.github.com/users/yangxu351","html_url":"https://github.com/yangxu351","followers_url":"https://api.github.com/users/yangxu351/followers","following_url":"https://api.github.com/users/yangxu351/following{/other_user}","gists_url":"https://api.github.com/users/yangxu351/gists{/gist_id}","starred_url":"https://api.github.com/users/yangxu351/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yangxu351/subscriptions","organizations_url":"https://api.github.com/users/yangxu351/orgs","repos_url":"https://api.github.com/users/yangxu351/repos","events_url":"https://api.github.com/users/yangxu351/events{/privacy}","received_events_url":"https://api.github.com/users/yangxu351/received_events","type":"User","site_admin":false}},{"id":3175935864,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzE3NTkzNTg2NA==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3175935864","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-03-29T14:06:09Z","performed_via_github_app":null},{"id":3175935865,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMxNzU5MzU4NjU=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3175935865","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-03-29T14:06:09Z","performed_via_github_app":null},{"actor":{"login":"chouxianyu","id":41263448,"node_id":"MDQ6VXNlcjQxMjYzNDQ4","avatar_url":"https://avatars.githubusercontent.com/u/41263448?v=4","gravatar_id":"","url":"https://api.github.com/users/chouxianyu","html_url":"https://github.com/chouxianyu","followers_url":"https://api.github.com/users/chouxianyu/followers","following_url":"https://api.github.com/users/chouxianyu/following{/other_user}","gists_url":"https://api.github.com/users/chouxianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/chouxianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chouxianyu/subscriptions","organizations_url":"https://api.github.com/users/chouxianyu/orgs","repos_url":"https://api.github.com/users/chouxianyu/repos","events_url":"https://api.github.com/users/chouxianyu/events{/privacy}","received_events_url":"https://api.github.com/users/chouxianyu/received_events","type":"User","site_admin":false},"created_at":"2020-03-29T15:20:02Z","updated_at":"2020-03-29T15:20:02Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/issues/20","repository_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning","labels_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/issues/20/labels{/name}","comments_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/issues/20/comments","events_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/issues/20/events","html_url":"https://github.com/tanluren/yolov3-channel-and-layer-pruning/issues/20","id":535471461,"node_id":"MDU6SXNzdWU1MzU0NzE0NjE=","number":20,"title":"can you help me to solve it ?WARNING: non-finite loss, ending training  tensor([    nan, 0.22070, 0.00000,     nan], device='cuda:0')","user":{"login":"shenghsiaowong","id":42805075,"node_id":"MDQ6VXNlcjQyODA1MDc1","avatar_url":"https://avatars.githubusercontent.com/u/42805075?v=4","gravatar_id":"","url":"https://api.github.com/users/shenghsiaowong","html_url":"https://github.com/shenghsiaowong","followers_url":"https://api.github.com/users/shenghsiaowong/followers","following_url":"https://api.github.com/users/shenghsiaowong/following{/other_user}","gists_url":"https://api.github.com/users/shenghsiaowong/gists{/gist_id}","starred_url":"https://api.github.com/users/shenghsiaowong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shenghsiaowong/subscriptions","organizations_url":"https://api.github.com/users/shenghsiaowong/orgs","repos_url":"https://api.github.com/users/shenghsiaowong/repos","events_url":"https://api.github.com/users/shenghsiaowong/events{/privacy}","received_events_url":"https://api.github.com/users/shenghsiaowong/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-12-10T03:36:57Z","updated_at":"2020-09-17T02:33:53Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"repository":{"id":220975737,"node_id":"MDEwOlJlcG9zaXRvcnkyMjA5NzU3Mzc=","name":"yolov3-channel-and-layer-pruning","full_name":"tanluren/yolov3-channel-and-layer-pruning","private":false,"owner":{"login":"tanluren","id":40066466,"node_id":"MDQ6VXNlcjQwMDY2NDY2","avatar_url":"https://avatars.githubusercontent.com/u/40066466?v=4","gravatar_id":"","url":"https://api.github.com/users/tanluren","html_url":"https://github.com/tanluren","followers_url":"https://api.github.com/users/tanluren/followers","following_url":"https://api.github.com/users/tanluren/following{/other_user}","gists_url":"https://api.github.com/users/tanluren/gists{/gist_id}","starred_url":"https://api.github.com/users/tanluren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tanluren/subscriptions","organizations_url":"https://api.github.com/users/tanluren/orgs","repos_url":"https://api.github.com/users/tanluren/repos","events_url":"https://api.github.com/users/tanluren/events{/privacy}","received_events_url":"https://api.github.com/users/tanluren/received_events","type":"User","site_admin":false},"html_url":"https://github.com/tanluren/yolov3-channel-and-layer-pruning","description":"yolov3 yolov4 channel and layer pruning, Knowledge Distillation 层剪枝，通道剪枝，知识蒸馏 ","fork":false,"url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning","forks_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/forks","keys_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/keys{/key_id}","collaborators_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/teams","hooks_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/hooks","issue_events_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/issues/events{/number}","events_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/events","assignees_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/assignees{/user}","branches_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/branches{/branch}","tags_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/tags","blobs_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/git/refs{/sha}","trees_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/git/trees{/sha}","statuses_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/statuses/{sha}","languages_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/languages","stargazers_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/stargazers","contributors_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/contributors","subscribers_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/subscribers","subscription_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/subscription","commits_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/commits{/sha}","git_commits_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/git/commits{/sha}","comments_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/comments{/number}","issue_comment_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/issues/comments{/number}","contents_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/contents/{+path}","compare_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/compare/{base}...{head}","merges_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/merges","archive_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/downloads","issues_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/issues{/number}","pulls_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/pulls{/number}","milestones_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/milestones{/number}","notifications_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/labels{/name}","releases_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/releases{/id}","deployments_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/deployments","created_at":"2019-11-11T12:23:13Z","updated_at":"2023-01-11T10:18:59Z","pushed_at":"2020-09-03T07:10:53Z","git_url":"git://github.com/tanluren/yolov3-channel-and-layer-pruning.git","ssh_url":"git@github.com:tanluren/yolov3-channel-and-layer-pruning.git","clone_url":"https://github.com/tanluren/yolov3-channel-and-layer-pruning.git","svn_url":"https://github.com/tanluren/yolov3-channel-and-layer-pruning","homepage":"","size":1586,"stargazers_count":1416,"watchers_count":1416,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":440,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":150,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":440,"open_issues":150,"watchers":1416,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"WARNING: non-finite loss, ending training  tensor([    nan, 0.22070, 0.00000,     nan], device='cuda:0')\r\n","reactions":{"url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/issues/20/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tanluren/yolov3-channel-and-layer-pruning/issues/20/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/605697611","html_url":"https://github.com/ultralytics/yolov3/issues/842#issuecomment-605697611","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/842","id":605697611,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNTY5NzYxMQ==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2020-03-29T20:38:29Z","updated_at":"2020-03-29T20:38:29Z","author_association":"MEMBER","body":"@yangxu351 no those are not zeros, those are placeholders for the concatenation operation. a 0,5 array has no values.","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/605697611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":3176297398,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzE3NjI5NzM5OA==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3176297398","actor":{"login":"yangxu351","id":12199053,"node_id":"MDQ6VXNlcjEyMTk5MDUz","avatar_url":"https://avatars.githubusercontent.com/u/12199053?v=4","gravatar_id":"","url":"https://api.github.com/users/yangxu351","html_url":"https://github.com/yangxu351","followers_url":"https://api.github.com/users/yangxu351/followers","following_url":"https://api.github.com/users/yangxu351/following{/other_user}","gists_url":"https://api.github.com/users/yangxu351/gists{/gist_id}","starred_url":"https://api.github.com/users/yangxu351/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yangxu351/subscriptions","organizations_url":"https://api.github.com/users/yangxu351/orgs","repos_url":"https://api.github.com/users/yangxu351/repos","events_url":"https://api.github.com/users/yangxu351/events{/privacy}","received_events_url":"https://api.github.com/users/yangxu351/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-03-29T20:38:29Z","performed_via_github_app":null},{"id":3176297400,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMxNzYyOTc0MDA=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/3176297400","actor":{"login":"yangxu351","id":12199053,"node_id":"MDQ6VXNlcjEyMTk5MDUz","avatar_url":"https://avatars.githubusercontent.com/u/12199053?v=4","gravatar_id":"","url":"https://api.github.com/users/yangxu351","html_url":"https://github.com/yangxu351","followers_url":"https://api.github.com/users/yangxu351/followers","following_url":"https://api.github.com/users/yangxu351/following{/other_user}","gists_url":"https://api.github.com/users/yangxu351/gists{/gist_id}","starred_url":"https://api.github.com/users/yangxu351/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yangxu351/subscriptions","organizations_url":"https://api.github.com/users/yangxu351/orgs","repos_url":"https://api.github.com/users/yangxu351/repos","events_url":"https://api.github.com/users/yangxu351/events{/privacy}","received_events_url":"https://api.github.com/users/yangxu351/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-03-29T20:38:29Z","performed_via_github_app":null}]