[{"id":2273821043,"node_id":"MDEyOkxhYmVsZWRFdmVudDIyNzM4MjEwNDM=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2273821043","actor":{"login":"vivian-wong","id":30191150,"node_id":"MDQ6VXNlcjMwMTkxMTUw","avatar_url":"https://avatars.githubusercontent.com/u/30191150?v=4","gravatar_id":"","url":"https://api.github.com/users/vivian-wong","html_url":"https://github.com/vivian-wong","followers_url":"https://api.github.com/users/vivian-wong/followers","following_url":"https://api.github.com/users/vivian-wong/following{/other_user}","gists_url":"https://api.github.com/users/vivian-wong/gists{/gist_id}","starred_url":"https://api.github.com/users/vivian-wong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vivian-wong/subscriptions","organizations_url":"https://api.github.com/users/vivian-wong/orgs","repos_url":"https://api.github.com/users/vivian-wong/repos","events_url":"https://api.github.com/users/vivian-wong/events{/privacy}","received_events_url":"https://api.github.com/users/vivian-wong/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-04-13T00:12:37Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/482804889","html_url":"https://github.com/ultralytics/yolov3/issues/211#issuecomment-482804889","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/211","id":482804889,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MjgwNDg4OQ==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2019-04-13T12:27:18Z","updated_at":"2019-04-13T12:28:02Z","author_association":"MEMBER","body":"@vivian-wong first of all, congratulations on your analysis, you've done a great job of investigating the performance here in different settings.\r\n\r\nI think you've inadvertently discovered the same result I've seen earlier, that **transfer learning produces worse results vs normal training**. What you are seeing in your second set of plots is that all the layers that were frozen before become unfrozen, and are optimized just as in regular training when you manually `--resume` at epoch 273. \r\n\r\nThere are no LR issues, the LR is behaving as expected in both cases, reducing by 10x at epochs 218 and 245, which roughly correspond to 400k and 500k batches in darknet. **This LR scheduler is set for COCO, you probably want to tune it to your custom dataset**.\r\n\r\nIf past experience is correct, you will obtain the best results by simply training normally, and not messing around with transfer learning. **By definition, when you freeze layers, they can not adapt to new data, so transfer learning will never produce results as accurate as normal learning.**","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/482804889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":2274087481,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI3NDA4NzQ4MQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2274087481","actor":{"login":"vivian-wong","id":30191150,"node_id":"MDQ6VXNlcjMwMTkxMTUw","avatar_url":"https://avatars.githubusercontent.com/u/30191150?v=4","gravatar_id":"","url":"https://api.github.com/users/vivian-wong","html_url":"https://github.com/vivian-wong","followers_url":"https://api.github.com/users/vivian-wong/followers","following_url":"https://api.github.com/users/vivian-wong/following{/other_user}","gists_url":"https://api.github.com/users/vivian-wong/gists{/gist_id}","starred_url":"https://api.github.com/users/vivian-wong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vivian-wong/subscriptions","organizations_url":"https://api.github.com/users/vivian-wong/orgs","repos_url":"https://api.github.com/users/vivian-wong/repos","events_url":"https://api.github.com/users/vivian-wong/events{/privacy}","received_events_url":"https://api.github.com/users/vivian-wong/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-13T12:27:18Z","performed_via_github_app":null},{"id":2274087482,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyNzQwODc0ODI=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2274087482","actor":{"login":"vivian-wong","id":30191150,"node_id":"MDQ6VXNlcjMwMTkxMTUw","avatar_url":"https://avatars.githubusercontent.com/u/30191150?v=4","gravatar_id":"","url":"https://api.github.com/users/vivian-wong","html_url":"https://github.com/vivian-wong","followers_url":"https://api.github.com/users/vivian-wong/followers","following_url":"https://api.github.com/users/vivian-wong/following{/other_user}","gists_url":"https://api.github.com/users/vivian-wong/gists{/gist_id}","starred_url":"https://api.github.com/users/vivian-wong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vivian-wong/subscriptions","organizations_url":"https://api.github.com/users/vivian-wong/orgs","repos_url":"https://api.github.com/users/vivian-wong/repos","events_url":"https://api.github.com/users/vivian-wong/events{/privacy}","received_events_url":"https://api.github.com/users/vivian-wong/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-13T12:27:18Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/482860037","html_url":"https://github.com/ultralytics/yolov3/issues/211#issuecomment-482860037","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/211","id":482860037,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4Mjg2MDAzNw==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2019-04-13T18:32:00Z","updated_at":"2019-04-13T18:46:04Z","author_association":"MEMBER","body":"@vivian-wong I investigated further, with fascinating results. I ran our `coco_100img.data` tutorial with and without transfer learning. When running with transfer learning, the `wh` losses diverged, so I reduced the wh loss multiplier from 4 to 1 and clamped the prediction outputs to a range of -4 to 4:\r\n```python\r\nlwh += (k * 1) * MSE(pi[..., 2:4].clamp(min=-4, max=4), twh[i])  # wh yolo loss\r\n```                \r\nThis resulted now converged (transfer learning from `yolov3-spp.pt`), and I saved them as `results2_100img_tl`.  Of course, since I modified the loss function I reran the original tutorial using the modified loss (as `results2_100img`), and plotted the two results against our original tutorial result `results_100img`. The two conclusions are:\r\n\r\n- This new loss (blue) unexpectedly performs better than our original loss (green)! I'm not sure if this is due to the clamping or the reduced multiplier, but this is excellent news!!\r\n- As expected, transfer learning does not perform as well in the end as regular training. It trains a bit faster earlier on, as you'd expect, but it can not achieve the same accuracy later on naturally, as all of its convolutional layers are locked and not able to respond to training.\r\n\r\n![results](https://user-images.githubusercontent.com/26833433/56083732-66a0e000-5e29-11e9-9195-40f1f811a3eb.png)\r\n\r\nThe same plot zoomed in to the first 50 epochs (you can see here transfer learning in orange does initially perform better).\r\n![results](https://user-images.githubusercontent.com/26833433/56083882-1cb8f980-5e2b-11e9-8870-eb51b7a8d51d.png)\r\n\r\nTo recreate these results simply modify the loss as above and run:\r\n```bash\r\ngit pull  # Update to latest\r\nrm results*.txt   # WARNING: removes old results\r\npython3 train.py --nosave --data data/coco_100img.data --transfer && mv results.txt results2_100img_tl.txt\r\npython3 train.py --nosave --data data/coco_100img.data && mv results.txt results2_100img.txt\r\npython3 -c \"from utils import utils; utils.plot_results()\"\r\n```","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/482860037/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":2274303104,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI3NDMwMzEwNA==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2274303104","actor":{"login":"vivian-wong","id":30191150,"node_id":"MDQ6VXNlcjMwMTkxMTUw","avatar_url":"https://avatars.githubusercontent.com/u/30191150?v=4","gravatar_id":"","url":"https://api.github.com/users/vivian-wong","html_url":"https://github.com/vivian-wong","followers_url":"https://api.github.com/users/vivian-wong/followers","following_url":"https://api.github.com/users/vivian-wong/following{/other_user}","gists_url":"https://api.github.com/users/vivian-wong/gists{/gist_id}","starred_url":"https://api.github.com/users/vivian-wong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vivian-wong/subscriptions","organizations_url":"https://api.github.com/users/vivian-wong/orgs","repos_url":"https://api.github.com/users/vivian-wong/repos","events_url":"https://api.github.com/users/vivian-wong/events{/privacy}","received_events_url":"https://api.github.com/users/vivian-wong/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-13T18:32:00Z","performed_via_github_app":null},{"id":2274303105,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyNzQzMDMxMDU=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2274303105","actor":{"login":"vivian-wong","id":30191150,"node_id":"MDQ6VXNlcjMwMTkxMTUw","avatar_url":"https://avatars.githubusercontent.com/u/30191150?v=4","gravatar_id":"","url":"https://api.github.com/users/vivian-wong","html_url":"https://github.com/vivian-wong","followers_url":"https://api.github.com/users/vivian-wong/followers","following_url":"https://api.github.com/users/vivian-wong/following{/other_user}","gists_url":"https://api.github.com/users/vivian-wong/gists{/gist_id}","starred_url":"https://api.github.com/users/vivian-wong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vivian-wong/subscriptions","organizations_url":"https://api.github.com/users/vivian-wong/orgs","repos_url":"https://api.github.com/users/vivian-wong/repos","events_url":"https://api.github.com/users/vivian-wong/events{/privacy}","received_events_url":"https://api.github.com/users/vivian-wong/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-13T18:32:00Z","performed_via_github_app":null},{"actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2019-04-14T14:04:04Z","updated_at":"2019-04-14T14:04:04Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/210","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/210/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/210/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/210/events","html_url":"https://github.com/ultralytics/yolov3/issues/210","id":432554311,"node_id":"MDU6SXNzdWU0MzI1NTQzMTE=","number":210,"title":"Adding mixed precision training for RTX graphic cards","user":{"login":"drapado","id":45577687,"node_id":"MDQ6VXNlcjQ1NTc3Njg3","avatar_url":"https://avatars.githubusercontent.com/u/45577687?v=4","gravatar_id":"","url":"https://api.github.com/users/drapado","html_url":"https://github.com/drapado","followers_url":"https://api.github.com/users/drapado/followers","following_url":"https://api.github.com/users/drapado/following{/other_user}","gists_url":"https://api.github.com/users/drapado/gists{/gist_id}","starred_url":"https://api.github.com/users/drapado/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drapado/subscriptions","organizations_url":"https://api.github.com/users/drapado/orgs","repos_url":"https://api.github.com/users/drapado/repos","events_url":"https://api.github.com/users/drapado/events{/privacy}","received_events_url":"https://api.github.com/users/drapado/received_events","type":"User","site_admin":false},"labels":[{"id":1035696372,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzcy","url":"https://api.github.com/repos/ultralytics/yolov3/labels/enhancement","name":"enhancement","color":"a2eeef","default":true,"description":"New feature or request"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":19,"created_at":"2019-04-12T13:00:12Z","updated_at":"2019-12-17T07:04:34Z","closed_at":"2019-08-06T16:56:09Z","author_association":"NONE","active_lock_reason":null,"repository":{"id":146165888,"node_id":"MDEwOlJlcG9zaXRvcnkxNDYxNjU4ODg=","name":"yolov3","full_name":"ultralytics/yolov3","private":false,"owner":{"login":"ultralytics","id":26833451,"node_id":"MDEyOk9yZ2FuaXphdGlvbjI2ODMzNDUx","avatar_url":"https://avatars.githubusercontent.com/u/26833451?v=4","gravatar_id":"","url":"https://api.github.com/users/ultralytics","html_url":"https://github.com/ultralytics","followers_url":"https://api.github.com/users/ultralytics/followers","following_url":"https://api.github.com/users/ultralytics/following{/other_user}","gists_url":"https://api.github.com/users/ultralytics/gists{/gist_id}","starred_url":"https://api.github.com/users/ultralytics/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ultralytics/subscriptions","organizations_url":"https://api.github.com/users/ultralytics/orgs","repos_url":"https://api.github.com/users/ultralytics/repos","events_url":"https://api.github.com/users/ultralytics/events{/privacy}","received_events_url":"https://api.github.com/users/ultralytics/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/ultralytics/yolov3","description":"YOLOv3 in PyTorch > ONNX > CoreML > TFLite","fork":false,"url":"https://api.github.com/repos/ultralytics/yolov3","forks_url":"https://api.github.com/repos/ultralytics/yolov3/forks","keys_url":"https://api.github.com/repos/ultralytics/yolov3/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ultralytics/yolov3/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ultralytics/yolov3/teams","hooks_url":"https://api.github.com/repos/ultralytics/yolov3/hooks","issue_events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/events{/number}","events_url":"https://api.github.com/repos/ultralytics/yolov3/events","assignees_url":"https://api.github.com/repos/ultralytics/yolov3/assignees{/user}","branches_url":"https://api.github.com/repos/ultralytics/yolov3/branches{/branch}","tags_url":"https://api.github.com/repos/ultralytics/yolov3/tags","blobs_url":"https://api.github.com/repos/ultralytics/yolov3/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ultralytics/yolov3/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ultralytics/yolov3/git/refs{/sha}","trees_url":"https://api.github.com/repos/ultralytics/yolov3/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ultralytics/yolov3/statuses/{sha}","languages_url":"https://api.github.com/repos/ultralytics/yolov3/languages","stargazers_url":"https://api.github.com/repos/ultralytics/yolov3/stargazers","contributors_url":"https://api.github.com/repos/ultralytics/yolov3/contributors","subscribers_url":"https://api.github.com/repos/ultralytics/yolov3/subscribers","subscription_url":"https://api.github.com/repos/ultralytics/yolov3/subscription","commits_url":"https://api.github.com/repos/ultralytics/yolov3/commits{/sha}","git_commits_url":"https://api.github.com/repos/ultralytics/yolov3/git/commits{/sha}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/comments{/number}","issue_comment_url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments{/number}","contents_url":"https://api.github.com/repos/ultralytics/yolov3/contents/{+path}","compare_url":"https://api.github.com/repos/ultralytics/yolov3/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ultralytics/yolov3/merges","archive_url":"https://api.github.com/repos/ultralytics/yolov3/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ultralytics/yolov3/downloads","issues_url":"https://api.github.com/repos/ultralytics/yolov3/issues{/number}","pulls_url":"https://api.github.com/repos/ultralytics/yolov3/pulls{/number}","milestones_url":"https://api.github.com/repos/ultralytics/yolov3/milestones{/number}","notifications_url":"https://api.github.com/repos/ultralytics/yolov3/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ultralytics/yolov3/labels{/name}","releases_url":"https://api.github.com/repos/ultralytics/yolov3/releases{/id}","deployments_url":"https://api.github.com/repos/ultralytics/yolov3/deployments","created_at":"2018-08-26T08:57:20Z","updated_at":"2023-01-19T02:45:28Z","pushed_at":"2023-01-02T20:48:03Z","git_url":"git://github.com/ultralytics/yolov3.git","ssh_url":"git@github.com:ultralytics/yolov3.git","clone_url":"https://github.com/ultralytics/yolov3.git","svn_url":"https://github.com/ultralytics/yolov3","homepage":"https://ultralytics.com","size":9609,"stargazers_count":9265,"watchers_count":9265,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":3359,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":7,"license":{"key":"gpl-3.0","name":"GNU General Public License v3.0","spdx_id":"GPL-3.0","url":"https://api.github.com/licenses/gpl-3.0","node_id":"MDc6TGljZW5zZTk="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["coreml","deep-learning","ios","machine-learning","ml","object-detection","onnx","pytorch","tflite","yolo","yolov3","yolov4","yolov5"],"visibility":"public","forks":3359,"open_issues":7,"watchers":9265,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Hi,\r\n\r\nThanks for your work, it's a very nice implementation of yolov3.\r\n\r\nI have an RTX 2060 and by using mixed precision training I got a speed increment in the training process, since you can almost double batch size)\r\n\r\nI added to your code [nvidia apex.amp](https://nvidia.github.io/apex/amp.html) which is a very easy way to add mixed precision training to a pytorch model. The code you need to add is:\r\n`from apex import amp`\r\n`model, optimizer = amp.initialize(model, optimizer, opt_level=\"O1\")`\r\n\r\nAnd change `loss.backward()` with \r\n```\r\nwith amp.scale_loss(loss, optimizer) as scaled_loss:\r\n    scaled_loss.backward()\r\n```\r\n\r\nAnd with that you are using mixed precision training and you can almost double batch size while training in a gpu with tensor cores.\r\n","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/210/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/210/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2019-04-15T12:23:29Z","updated_at":"2019-04-15T12:23:29Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/171","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/171/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/171/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/171/events","html_url":"https://github.com/ultralytics/yolov3/issues/171","id":426054335,"node_id":"MDU6SXNzdWU0MjYwNTQzMzU=","number":171,"title":"Different mAP from cocoAPI","user":{"login":"xiao1228","id":11752039,"node_id":"MDQ6VXNlcjExNzUyMDM5","avatar_url":"https://avatars.githubusercontent.com/u/11752039?v=4","gravatar_id":"","url":"https://api.github.com/users/xiao1228","html_url":"https://github.com/xiao1228","followers_url":"https://api.github.com/users/xiao1228/followers","following_url":"https://api.github.com/users/xiao1228/following{/other_user}","gists_url":"https://api.github.com/users/xiao1228/gists{/gist_id}","starred_url":"https://api.github.com/users/xiao1228/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiao1228/subscriptions","organizations_url":"https://api.github.com/users/xiao1228/orgs","repos_url":"https://api.github.com/users/xiao1228/repos","events_url":"https://api.github.com/users/xiao1228/events{/privacy}","received_events_url":"https://api.github.com/users/xiao1228/received_events","type":"User","site_admin":false},"labels":[{"id":1035696370,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzcw","url":"https://api.github.com/repos/ultralytics/yolov3/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":23,"created_at":"2019-03-27T16:14:35Z","updated_at":"2019-04-15T12:25:19Z","closed_at":"2019-03-28T16:32:32Z","author_association":"NONE","active_lock_reason":null,"repository":{"id":146165888,"node_id":"MDEwOlJlcG9zaXRvcnkxNDYxNjU4ODg=","name":"yolov3","full_name":"ultralytics/yolov3","private":false,"owner":{"login":"ultralytics","id":26833451,"node_id":"MDEyOk9yZ2FuaXphdGlvbjI2ODMzNDUx","avatar_url":"https://avatars.githubusercontent.com/u/26833451?v=4","gravatar_id":"","url":"https://api.github.com/users/ultralytics","html_url":"https://github.com/ultralytics","followers_url":"https://api.github.com/users/ultralytics/followers","following_url":"https://api.github.com/users/ultralytics/following{/other_user}","gists_url":"https://api.github.com/users/ultralytics/gists{/gist_id}","starred_url":"https://api.github.com/users/ultralytics/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ultralytics/subscriptions","organizations_url":"https://api.github.com/users/ultralytics/orgs","repos_url":"https://api.github.com/users/ultralytics/repos","events_url":"https://api.github.com/users/ultralytics/events{/privacy}","received_events_url":"https://api.github.com/users/ultralytics/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/ultralytics/yolov3","description":"YOLOv3 in PyTorch > ONNX > CoreML > TFLite","fork":false,"url":"https://api.github.com/repos/ultralytics/yolov3","forks_url":"https://api.github.com/repos/ultralytics/yolov3/forks","keys_url":"https://api.github.com/repos/ultralytics/yolov3/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ultralytics/yolov3/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ultralytics/yolov3/teams","hooks_url":"https://api.github.com/repos/ultralytics/yolov3/hooks","issue_events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/events{/number}","events_url":"https://api.github.com/repos/ultralytics/yolov3/events","assignees_url":"https://api.github.com/repos/ultralytics/yolov3/assignees{/user}","branches_url":"https://api.github.com/repos/ultralytics/yolov3/branches{/branch}","tags_url":"https://api.github.com/repos/ultralytics/yolov3/tags","blobs_url":"https://api.github.com/repos/ultralytics/yolov3/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ultralytics/yolov3/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ultralytics/yolov3/git/refs{/sha}","trees_url":"https://api.github.com/repos/ultralytics/yolov3/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ultralytics/yolov3/statuses/{sha}","languages_url":"https://api.github.com/repos/ultralytics/yolov3/languages","stargazers_url":"https://api.github.com/repos/ultralytics/yolov3/stargazers","contributors_url":"https://api.github.com/repos/ultralytics/yolov3/contributors","subscribers_url":"https://api.github.com/repos/ultralytics/yolov3/subscribers","subscription_url":"https://api.github.com/repos/ultralytics/yolov3/subscription","commits_url":"https://api.github.com/repos/ultralytics/yolov3/commits{/sha}","git_commits_url":"https://api.github.com/repos/ultralytics/yolov3/git/commits{/sha}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/comments{/number}","issue_comment_url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments{/number}","contents_url":"https://api.github.com/repos/ultralytics/yolov3/contents/{+path}","compare_url":"https://api.github.com/repos/ultralytics/yolov3/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ultralytics/yolov3/merges","archive_url":"https://api.github.com/repos/ultralytics/yolov3/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ultralytics/yolov3/downloads","issues_url":"https://api.github.com/repos/ultralytics/yolov3/issues{/number}","pulls_url":"https://api.github.com/repos/ultralytics/yolov3/pulls{/number}","milestones_url":"https://api.github.com/repos/ultralytics/yolov3/milestones{/number}","notifications_url":"https://api.github.com/repos/ultralytics/yolov3/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ultralytics/yolov3/labels{/name}","releases_url":"https://api.github.com/repos/ultralytics/yolov3/releases{/id}","deployments_url":"https://api.github.com/repos/ultralytics/yolov3/deployments","created_at":"2018-08-26T08:57:20Z","updated_at":"2023-01-19T02:45:28Z","pushed_at":"2023-01-02T20:48:03Z","git_url":"git://github.com/ultralytics/yolov3.git","ssh_url":"git@github.com:ultralytics/yolov3.git","clone_url":"https://github.com/ultralytics/yolov3.git","svn_url":"https://github.com/ultralytics/yolov3","homepage":"https://ultralytics.com","size":9609,"stargazers_count":9265,"watchers_count":9265,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":3359,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":7,"license":{"key":"gpl-3.0","name":"GNU General Public License v3.0","spdx_id":"GPL-3.0","url":"https://api.github.com/licenses/gpl-3.0","node_id":"MDc6TGljZW5zZTk="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["coreml","deep-learning","ios","machine-learning","ml","object-detection","onnx","pytorch","tflite","yolo","yolov3","yolov4","yolov5"],"visibility":"public","forks":3359,"open_issues":7,"watchers":9265,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"I am training the code from scratch and the results from best.pt are shown below\r\n\r\n```\r\npython3 test.py --weights weights/best.pt --save-json --img-size 416\r\nNamespace(batch_size=32, cfg='cfg/yolov3.cfg', conf_thres=0.3, data_cfg='cfg/coco.data', img_size=416, iou_thres=0.5, nms_thres=0.45, save_json=True, weights='weights/best.pt')\r\n\r\n      Image      Total          P          R        mAP\r\n         32       5000      0.562      0.545      0.523      0.744s\r\n         64       5000      0.554      0.549      0.522      0.472s\r\n         96       5000      0.546      0.555      0.529      0.461s\r\n        128       5000      0.547      0.558      0.533      0.435s\r\n        160       5000      0.548      0.559      0.537      0.468s\r\n        192       5000      0.554      0.562       0.54      0.431s\r\n        224       5000       0.55      0.552       0.53       0.45s\r\n        256       5000      0.558      0.555      0.535      0.469s\r\n        288       5000      0.568      0.565      0.545      0.408s\r\n        320       5000      0.561      0.559      0.539      0.461s\r\n        352       5000       0.56      0.556      0.535      0.474s\r\n        384       5000      0.565      0.564      0.543      0.417s\r\n        416       5000      0.564      0.566      0.545      0.514s\r\n        448       5000      0.563      0.562      0.542      0.553s\r\n        480       5000      0.558      0.557      0.536      0.431s\r\n        512       5000      0.553      0.553      0.532      0.505s\r\n        544       5000       0.55      0.551       0.53      0.477s\r\n        576       5000      0.554      0.554      0.533      0.489s\r\n        608       5000      0.557      0.556      0.535      0.553s\r\n        640       5000      0.555      0.553      0.532      0.485s\r\n        672       5000      0.551      0.549      0.528      0.556s\r\n        704       5000      0.553       0.55       0.53      0.395s\r\n        736       5000      0.551      0.547      0.526      0.521s\r\n        768       5000      0.552       0.55      0.529      0.498s\r\n        800       5000      0.553       0.55      0.529      0.478s\r\n        832       5000      0.554      0.551      0.529      0.491s\r\n        864       5000      0.552      0.549      0.527      0.493s\r\n        896       5000       0.55      0.547      0.525       0.58s\r\n        928       5000      0.549      0.546      0.524      0.554s\r\n        960       5000      0.552      0.548      0.526      0.448s\r\n        992       5000       0.55      0.546      0.524      0.554s\r\n       1024       5000      0.551      0.547      0.525      0.496s\r\n       1056       5000      0.552      0.547      0.526      0.427s\r\n       1088       5000      0.551      0.546      0.524      0.473s\r\n       1120       5000       0.55      0.546      0.524      0.538s\r\n       1152       5000      0.549      0.544      0.523       0.49s\r\n       1184       5000      0.547      0.542       0.52      0.484s\r\n       1216       5000      0.545       0.54      0.519      0.508s\r\n       1248       5000      0.545      0.539      0.518       0.51s\r\n       1280       5000      0.544      0.539      0.517      0.535s\r\n       1312       5000      0.548      0.541       0.52      0.494s\r\n       1344       5000      0.548      0.542      0.521      0.608s\r\n       1376       5000      0.549      0.544      0.523      0.532s\r\n       1408       5000      0.551      0.546      0.525      0.465s\r\n       1440       5000       0.55      0.546      0.525       0.46s\r\n       1472       5000      0.549      0.546      0.524       0.57s\r\n       1504       5000       0.55      0.546      0.525      0.522s\r\n       1536       5000       0.55      0.547      0.526      0.495s\r\n       1568       5000       0.55      0.547      0.526      0.453s\r\n       1600       5000      0.551      0.547      0.526      0.513s\r\n       1632       5000      0.551      0.548      0.527      0.444s\r\n       1664       5000      0.552      0.549      0.528      0.443s\r\n       1696       5000      0.554       0.55      0.529      0.494s\r\n       1728       5000      0.554      0.551       0.53      0.529s\r\n       1760       5000      0.554       0.55      0.529      0.487s\r\n       1792       5000      0.555      0.551       0.53      0.497s\r\n       1824       5000      0.554      0.551       0.53      0.465s\r\n       1856       5000      0.554       0.55      0.529      0.493s\r\n       1888       5000      0.554       0.55      0.529      0.534s\r\n       1920       5000      0.554       0.55      0.529      0.501s\r\n       1952       5000      0.552      0.548      0.528      0.517s\r\n       1984       5000      0.552      0.548      0.527      0.483s\r\n       2016       5000      0.551      0.547      0.526      0.447s\r\n       2048       5000       0.55      0.546      0.525      0.576s\r\n       2080       5000       0.55      0.546      0.525      0.438s\r\n       2112       5000      0.551      0.547      0.526      0.497s\r\n       2144       5000      0.551      0.547      0.526      0.538s\r\n       2176       5000      0.552      0.548      0.526      0.562s\r\n       2208       5000       0.55      0.546      0.525      0.551s\r\n       2240       5000      0.549      0.545      0.524      0.516s\r\n       2272       5000      0.549      0.545      0.524      0.506s\r\n       2304       5000      0.549      0.545      0.524      0.446s\r\n       2336       5000      0.549      0.545      0.523      0.486s\r\n       2368       5000       0.55      0.546      0.524      0.545s\r\n       2400       5000       0.55      0.546      0.524      0.506s\r\n       2432       5000       0.55      0.546      0.524      0.468s\r\n       2464       5000       0.55      0.546      0.525       0.54s\r\n       2496       5000       0.55      0.547      0.525      0.551s\r\n       2528       5000       0.55      0.546      0.525      0.543s\r\n       2560       5000      0.549      0.546      0.524      0.465s\r\n       2592       5000      0.549      0.546      0.524      0.495s\r\n       2624       5000      0.549      0.546      0.524      0.612s\r\n       2656       5000      0.549      0.546      0.525      0.512s\r\n       2688       5000      0.549      0.546      0.524      0.523s\r\n       2720       5000      0.547      0.545      0.523      0.547s\r\n       2752       5000      0.547      0.545      0.523      0.537s\r\n       2784       5000      0.547      0.545      0.523      0.519s\r\n       2816       5000      0.548      0.545      0.524      0.474s\r\n       2848       5000      0.547      0.545      0.523      0.498s\r\n       2880       5000      0.548      0.545      0.523      0.526s\r\n       2912       5000      0.547      0.545      0.523      0.478s\r\n       2944       5000      0.547      0.544      0.523      0.487s\r\n       2976       5000      0.547      0.545      0.523      0.536s\r\n       3008       5000      0.545      0.543      0.521      0.509s\r\n       3040       5000      0.544      0.541       0.52      0.466s\r\n       3072       5000      0.543      0.541      0.519      0.511s\r\n       3104       5000      0.544      0.541       0.52      0.489s\r\n       3136       5000      0.544      0.542       0.52       0.42s\r\n       3168       5000      0.545      0.543      0.521      0.536s\r\n       3200       5000      0.545      0.543      0.521      0.452s\r\n       3232       5000      0.545      0.543      0.521      0.545s\r\n       3264       5000      0.544      0.542       0.52       0.56s\r\n       3296       5000      0.544      0.542       0.52      0.533s\r\n       3328       5000      0.544      0.542       0.52       0.48s\r\n       3360       5000      0.543      0.541      0.519       0.49s\r\n       3392       5000      0.542      0.541      0.519      0.507s\r\n       3424       5000      0.542      0.541      0.519      0.522s\r\n       3456       5000      0.542      0.542       0.52      0.522s\r\n       3488       5000      0.541      0.541      0.519      0.675s\r\n       3520       5000      0.541       0.54      0.518      0.443s\r\n       3552       5000      0.541       0.54      0.518      0.515s\r\n       3584       5000      0.541      0.541      0.519       0.54s\r\n       3616       5000      0.541       0.54      0.518      0.462s\r\n       3648       5000      0.542       0.54      0.519      0.575s\r\n       3680       5000      0.542      0.541      0.519      0.575s\r\n       3712       5000      0.543      0.541      0.519      0.604s\r\n       3744       5000      0.542       0.54      0.519      0.595s\r\n       3776       5000      0.542      0.541      0.519      0.504s\r\n       3808       5000      0.542      0.541      0.519      0.469s\r\n       3840       5000      0.542      0.541      0.519      0.572s\r\n       3872       5000      0.541       0.54      0.518      0.485s\r\n       3904       5000      0.541       0.54      0.518      0.585s\r\n       3936       5000      0.541       0.54      0.518      0.518s\r\n       3968       5000      0.541      0.539      0.517       0.53s\r\n       4000       5000      0.541      0.539      0.517      0.472s\r\n       4032       5000      0.541      0.539      0.517      0.585s\r\n       4064       5000      0.541      0.539      0.517      0.545s\r\n       4096       5000      0.541      0.539      0.518      0.568s\r\n       4128       5000      0.541      0.539      0.517      0.508s\r\n       4160       5000      0.541      0.539      0.517      0.447s\r\n       4192       5000       0.54      0.538      0.516      0.571s\r\n       4224       5000       0.54      0.538      0.516      0.553s\r\n       4256       5000       0.54      0.538      0.517      0.493s\r\n       4288       5000      0.541      0.539      0.517      0.451s\r\n       4320       5000      0.542      0.539      0.517      0.538s\r\n       4352       5000      0.542      0.539      0.518      0.535s\r\n       4384       5000      0.541      0.539      0.517      0.636s\r\n       4416       5000      0.542       0.54      0.518      0.448s\r\n       4448       5000      0.542      0.539      0.518      0.507s\r\n       4480       5000      0.542       0.54      0.518      0.566s\r\n       4512       5000      0.542       0.54      0.518      0.606s\r\n       4544       5000      0.542      0.539      0.518      0.587s\r\n       4576       5000      0.541      0.539      0.517      0.479s\r\n       4608       5000      0.541      0.539      0.517      0.523s\r\n       4640       5000      0.542      0.539      0.517      0.542s\r\n       4672       5000      0.541      0.539      0.517      0.633s\r\n       4704       5000      0.542      0.539      0.517       0.54s\r\n       4736       5000      0.542      0.539      0.517      0.448s\r\n       4768       5000      0.542      0.539      0.517      0.552s\r\n       4800       5000      0.542      0.539      0.518        0.5s\r\n       4832       5000      0.542      0.539      0.517      0.476s\r\n       4864       5000      0.542      0.539      0.518      0.524s\r\n       4896       5000      0.543       0.54      0.518      0.535s\r\n       4928       5000      0.542      0.539      0.518       0.61s\r\n       4960       5000      0.542      0.539      0.518      0.517s\r\n       4992       5000      0.542      0.539      0.517      0.513s\r\n       5000       5000      0.542      0.538      0.517      0.142s\r\nmAP Per Class:\r\n         person: 0.6545\r\n        bicycle: 0.3390\r\n            car: 0.4087\r\n     motorcycle: 0.5551\r\n       airplane: 0.7695\r\n            bus: 0.6553\r\n          train: 0.7421\r\n          truck: 0.3311\r\n           boat: 0.3917\r\n  traffic light: 0.3546\r\n   fire hydrant: 0.6711\r\n      stop sign: 0.5843\r\n  parking meter: 0.2901\r\n          bench: 0.2239\r\n           bird: 0.4490\r\n            cat: 0.6029\r\n            dog: 0.5982\r\n          horse: 0.5965\r\n          sheep: 0.4772\r\n            cow: 0.4832\r\n       elephant: 0.7780\r\n           bear: 0.6631\r\n          zebra: 0.7580\r\n        giraffe: 0.8608\r\n       backpack: 0.1389\r\n       umbrella: 0.4296\r\n        handbag: 0.1174\r\n            tie: 0.4122\r\n       suitcase: 0.2834\r\n        frisbee: 0.4407\r\n           skis: 0.3457\r\n      snowboard: 0.4403\r\n    sports ball: 0.4385\r\n           kite: 0.5387\r\n   baseball bat: 0.3634\r\n baseball glove: 0.3577\r\n     skateboard: 0.6406\r\n      surfboard: 0.4961\r\n  tennis racket: 0.6215\r\n         bottle: 0.2793\r\n     wine glass: 0.3463\r\n            cup: 0.3451\r\n           fork: 0.2618\r\n          knife: 0.1097\r\n          spoon: 0.1302\r\n           bowl: 0.2915\r\n         banana: 0.2537\r\n          apple: 0.1686\r\n       sandwich: 0.3510\r\n         orange: 0.2597\r\n       broccoli: 0.2330\r\n         carrot: 0.1589\r\n        hot dog: 0.4160\r\n          pizza: 0.5690\r\n          donut: 0.3708\r\n           cake: 0.3449\r\n          chair: 0.2805\r\n          couch: 0.3294\r\n   potted plant: 0.3229\r\n            bed: 0.3898\r\n   dining table: 0.2956\r\n         toilet: 0.6938\r\n             tv: 0.5832\r\n         laptop: 0.5667\r\n          mouse: 0.4683\r\n         remote: 0.2484\r\n       keyboard: 0.4403\r\n     cell phone: 0.2181\r\n      microwave: 0.5130\r\n           oven: 0.3297\r\n        toaster: 0.0714\r\n           sink: 0.4191\r\n   refrigerator: 0.4699\r\n           book: 0.1062\r\n          clock: 0.5111\r\n           vase: 0.3223\r\n       scissors: 0.1696\r\n     teddy bear: 0.5323\r\n     hair drier: 0.0000\r\n     toothbrush: 0.2262\r\n```\r\n\r\nHowever from COCOAPI the results are shown below\r\n```\r\nAverage Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.100\r\n Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.101\r\n Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.100\r\n Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.064\r\n Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.122\r\n Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.077\r\n Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.117\r\n Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.200\r\n Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.210\r\n Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.232\r\n Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.308\r\n Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.252\r\n\r\n```\r\n\r\nSo from the test.py it gives mAP 50+ however from COCOAPI it seems like only around 10\r\nAm I missing something or what? \r\nThank you very much @glenn-jocher sorry for the long results. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/171/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":2282228657,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjI4MjIyODY1Nw==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2282228657","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2019-04-17T10:03:14Z","rename":{"from":"Learning rate changes when resuming? ","to":"Transfer Learning Performance"},"performed_via_github_app":null},{"id":2282228862,"node_id":"MDExOkNsb3NlZEV2ZW50MjI4MjIyODg2Mg==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2282228862","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-04-17T10:03:20Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543437585","html_url":"https://github.com/ultralytics/yolov3/issues/211#issuecomment-543437585","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/211","id":543437585,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzQzNzU4NQ==","user":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false},"created_at":"2019-10-18T01:18:04Z","updated_at":"2019-10-18T01:18:04Z","author_association":"NONE","body":"> @vivian-wong first of all, congratulations on your analysis, you've done a great job of investigating the performance here in different settings.\r\n> \r\n> I think you've inadvertently discovered the same result I've seen earlier, that **transfer learning produces worse results vs normal training**. What you are seeing in your second set of plots is that all the layers that were frozen before become unfrozen, and are optimized just as in regular training when you manually `--resume` at epoch 273.\r\n> \r\n> There are no LR issues, the LR is behaving as expected in both cases, reducing by 10x at epochs 218 and 245, which roughly correspond to 400k and 500k batches in darknet. **This LR scheduler is set for COCO, you probably want to tune it to your custom dataset**.\r\n> \r\n> If past experience is correct, you will obtain the best results by simply training normally, and not messing around with transfer learning. **By definition, when you freeze layers, they can not adapt to new data, so transfer learning will never produce results as accurate as normal learning.**\r\n\r\n@glenn-jocher Thank you for this clear explanation, but may I know the advantage of using transfer learning vs training from scratch? Previously, I thought transfer learning also helps to improve the mAP.","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/543437585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false}},{"id":2723219299,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjcyMzIxOTI5OQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2723219299","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-10-18T01:18:09Z","performed_via_github_app":null},{"id":2723219301,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI3MjMyMTkzMDE=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2723219301","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-10-18T01:18:09Z","performed_via_github_app":null},{"id":2723219304,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjcyMzIxOTMwNA==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2723219304","actor":{"login":"vivian-wong","id":30191150,"node_id":"MDQ6VXNlcjMwMTkxMTUw","avatar_url":"https://avatars.githubusercontent.com/u/30191150?v=4","gravatar_id":"","url":"https://api.github.com/users/vivian-wong","html_url":"https://github.com/vivian-wong","followers_url":"https://api.github.com/users/vivian-wong/followers","following_url":"https://api.github.com/users/vivian-wong/following{/other_user}","gists_url":"https://api.github.com/users/vivian-wong/gists{/gist_id}","starred_url":"https://api.github.com/users/vivian-wong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vivian-wong/subscriptions","organizations_url":"https://api.github.com/users/vivian-wong/orgs","repos_url":"https://api.github.com/users/vivian-wong/repos","events_url":"https://api.github.com/users/vivian-wong/events{/privacy}","received_events_url":"https://api.github.com/users/vivian-wong/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-10-18T01:18:09Z","performed_via_github_app":null},{"id":2723219305,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI3MjMyMTkzMDU=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2723219305","actor":{"login":"vivian-wong","id":30191150,"node_id":"MDQ6VXNlcjMwMTkxMTUw","avatar_url":"https://avatars.githubusercontent.com/u/30191150?v=4","gravatar_id":"","url":"https://api.github.com/users/vivian-wong","html_url":"https://github.com/vivian-wong","followers_url":"https://api.github.com/users/vivian-wong/followers","following_url":"https://api.github.com/users/vivian-wong/following{/other_user}","gists_url":"https://api.github.com/users/vivian-wong/gists{/gist_id}","starred_url":"https://api.github.com/users/vivian-wong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vivian-wong/subscriptions","organizations_url":"https://api.github.com/users/vivian-wong/orgs","repos_url":"https://api.github.com/users/vivian-wong/repos","events_url":"https://api.github.com/users/vivian-wong/events{/privacy}","received_events_url":"https://api.github.com/users/vivian-wong/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-10-18T01:18:09Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/551307038","html_url":"https://github.com/ultralytics/yolov3/issues/211#issuecomment-551307038","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/211","id":551307038,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MTMwNzAzOA==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2019-11-07T23:05:13Z","updated_at":"2019-11-07T23:05:27Z","author_association":"MEMBER","body":"@rlgalvez transfer learning should get you decent results quickly, as it only needs to develop gradients for the unfrozen layers training requires less resources (i.e. perhaps an edge device).\r\n\r\nFor training you will always get the best results training all layers normally. See the custom training tutorials.","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/551307038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}},{"id":2781157845,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mjc4MTE1Nzg0NQ==","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2781157845","actor":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-11-07T23:05:13Z","performed_via_github_app":null},{"id":2781157846,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI3ODExNTc4NDY=","url":"https://api.github.com/repos/ultralytics/yolov3/issues/events/2781157846","actor":{"login":"rlgalvez","id":31986369,"node_id":"MDQ6VXNlcjMxOTg2MzY5","avatar_url":"https://avatars.githubusercontent.com/u/31986369?v=4","gravatar_id":"","url":"https://api.github.com/users/rlgalvez","html_url":"https://github.com/rlgalvez","followers_url":"https://api.github.com/users/rlgalvez/followers","following_url":"https://api.github.com/users/rlgalvez/following{/other_user}","gists_url":"https://api.github.com/users/rlgalvez/gists{/gist_id}","starred_url":"https://api.github.com/users/rlgalvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rlgalvez/subscriptions","organizations_url":"https://api.github.com/users/rlgalvez/orgs","repos_url":"https://api.github.com/users/rlgalvez/repos","events_url":"https://api.github.com/users/rlgalvez/events{/privacy}","received_events_url":"https://api.github.com/users/rlgalvez/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-11-07T23:05:13Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/551307405","html_url":"https://github.com/ultralytics/yolov3/issues/211#issuecomment-551307405","issue_url":"https://api.github.com/repos/ultralytics/yolov3/issues/211","id":551307405,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MTMwNzQwNQ==","user":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"created_at":"2019-11-07T23:06:25Z","updated_at":"2019-11-07T23:06:25Z","author_association":"MEMBER","body":"this shows the coco_64img.data tutorial starting from a few different options, including transfer learning. Transfer learning as shown below typically freezes the main pretrained weights, which constrains its performance. You can replicate these results with this code and looking at the resultant results.png file.\r\n\r\n```\r\npython3 train.py --data data/coco_64img.data --batch-size 16 --accumulate 1 --nosave --weights weights/yolov3-spp.weights --transfer --name yolov3-spp_transfer  # TRANSFER LEARNING COMPARISON\r\npython3 train.py --data data/coco_64img.data --batch-size 16 --accumulate 1 --nosave --weights '' --name from_scratch\r\npython3 train.py --data data/coco_64img.data --batch-size 16 --accumulate 1 --nosave --weights weights/darknet53.conv.74 --name darknet53_backbone\r\npython3 train.py --data data/coco_64img.data --batch-size 16 --accumulate 1 --nosave --weights weights/yolov3-spp.weights --name yolov3-spp_backbone\r\n```\r\n![results_64img](https://user-images.githubusercontent.com/26833433/68094898-b42e7a00-fe59-11e9-811c-47b5c92fa066.png)\r\n","reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/comments/551307405/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}}]