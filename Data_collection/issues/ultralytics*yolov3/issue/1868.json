{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1868","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1868/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1868/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1868/events","html_url":"https://github.com/ultralytics/yolov3/issues/1868","id":1066086380,"node_id":"I_kwDOCLZQgM4_iy_s","number":1868,"title":"Train on VOC problems ","user":{"login":"achel-x","id":67953243,"node_id":"MDQ6VXNlcjY3OTUzMjQz","avatar_url":"https://avatars.githubusercontent.com/u/67953243?v=4","gravatar_id":"","url":"https://api.github.com/users/achel-x","html_url":"https://github.com/achel-x","followers_url":"https://api.github.com/users/achel-x/followers","following_url":"https://api.github.com/users/achel-x/following{/other_user}","gists_url":"https://api.github.com/users/achel-x/gists{/gist_id}","starred_url":"https://api.github.com/users/achel-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/achel-x/subscriptions","organizations_url":"https://api.github.com/users/achel-x/orgs","repos_url":"https://api.github.com/users/achel-x/repos","events_url":"https://api.github.com/users/achel-x/events{/privacy}","received_events_url":"https://api.github.com/users/achel-x/received_events","type":"User","site_admin":false},"labels":[{"id":1035696376,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzc2","url":"https://api.github.com/repos/ultralytics/yolov3/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"},{"id":1890885613,"node_id":"MDU6TGFiZWwxODkwODg1NjEz","url":"https://api.github.com/repos/ultralytics/yolov3/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2021-11-29T14:11:14Z","updated_at":"2022-02-07T03:56:52Z","closed_at":"2022-01-05T00:08:31Z","author_association":"NONE","active_lock_reason":null,"body":"### Search before asking\n\n- [X] I have searched the YOLOv3 [issues](https://github.com/ultralytics/yolov3/issues) and [discussions](https://github.com/ultralytics/yolov3/discussions) and found no similar questions.\n\n\n### Question\n\n\r\nI trained according to the tutorial given on the homepage, but unfortunately I encountered such a problem. I printed the following information before and after the code. \r\nHow should I modify it?\r\n\r\n----------train log------------------\r\n(torch) userver@userver:~/PycharmProjects/yolo/yolov3_u/yolov3-archive$ python train.py --epochs 3 \r\nNamespace(adam=False, batch_size=16, bucket='', cache_images=False, cfg='cfg/yolov3.cfg', data='data/voc.data', device='', epochs=3, evolve=False, img_size=[320, 480, 416], multi_scale=False, name='', nosave=False, notest=False, rect=False, resume=False, weights='darknet53.conv.74')\r\nUsing CUDA Apex device0 _CudaDeviceProperties(name='NVIDIA GeForce RTX 3080', total_memory=10018MB)\r\n\r\nStart Tensorboard with \"tensorboard --logdir=runs\" \r\n**Before training.**\r\nWARNING: smart bias initialization failure.\r\nWARNING: smart bias initialization failure.\r\nWARNING: smart bias initialization failure.\r\nModel Summary: 222 layers, 6.1626e+07 parameters, 6.1626e+07 gradients, 116.6 GFLOPS\r\nOptimizer groups: 75 .bias, 75 Conv2d.weight, 72 other\r\nReading image shapes: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1858/1858 [00:00<00:00, 17737.08it/s]\r\nCaching labels /home/userver/PycharmProjects/yolo/PyTorch-YOLOv3-master_erik/data/custom/labels.npy (1857 found, 0 missing, 1 empty, 0 duplicate, for 1858 images): 100%|███████████████████████████| 1858/1858 [00:00<00:00, 12198.05it/s]\r\nSaving labels to /home/userver/PycharmProjects/yolo/PyTorch-YOLOv3-master_erik/data/custom/labels.npy for faster future loading\r\n/home/userver/anaconda3/envs/torch/lib/python3.7/site-packages/numpy/lib/npyio.py:528: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\r\n  arr = np.asanyarray(arr)\r\nCaching labels /home/userver/PycharmProjects/yolo/PyTorch-YOLOv3-master_erik/data/custom/labels.npy (2510 found, 0 missing, 0 empty, 0 duplicate, for 2510 images): 100%|███████████████████████████| 2510/2510 [00:00<00:00, 11459.27it/s]\r\nSaving labels to /home/userver/PycharmProjects/yolo/PyTorch-YOLOv3-master_erik/data/custom/labels.npy for faster future loading\r\nImage sizes 320 - 480 train, 416 test\r\nUsing 8 dataloader workers\r\nStarting training for 3 epochs...\r\n\r\n     Epoch   gpu_mem      GIoU       obj       cls     total   targets  img_size\r\n  0%|                                                                                                                                                                                                              | 0/117 [00:00<?, ?it/s]/home/userver/anaconda3/envs/torch/lib/python3.7/site-packages/torch/cuda/memory.py:375: FutureWarning: torch.cuda.memory_cached has been renamed to torch.cuda.memory_reserved\r\n  FutureWarning)\r\n       0/2     7.43G      6.15      7.56      9.63      23.3        13       480: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:39<00:00,  3.00it/s]\r\n\r\n**Process epoch results\r\nis_coco is  False**\r\n               Class    Images   Targets         P         R   mAP@0.5        F1:   0%|                                                                                                                            | 0/157 [00:00<?, ?it/s]Before plot_images\r\n<class 'list'>\r\n               Class    Images   Targets         P         R   mAP@0.5        F1:   0%|                                                                                                                            | 0/157 [00:00<?, ?it/s]\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 438, in <module>\r\n    train(hyp)  # train normally\r\n  File \"train.py\", line 338, in train\r\n    multi_label=ni > n_burn)\r\n  File \"/home/userver/PycharmProjects/yolo/yolov3_u/yolov3-archive/test.py\", line 174, in test\r\n    plot_images(imgs, output_to_target(output, width, height), paths=paths, names=names, fname=f)  # predictions\r\n  File \"/home/userver/PycharmProjects/yolo/yolov3_u/yolov3-archive/utils/utils.py\", line 821, in output_to_target\r\n    targets = np.array(targets).cpu()\r\n  File \"/home/userver/anaconda3/envs/torch/lib/python3.7/site-packages/torch/tensor.py\", line 621, in __array__\r\n    return self.numpy()\r\nTypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.\r\n---------------------------------------------------------\r\n\r\nThe following pictures are the screenshots of error prompted.\r\n![image](https://user-images.githubusercontent.com/67953243/143882200-630134cb-fc77-4293-805d-591e993054d8.png)\r\n\r\n![image](https://user-images.githubusercontent.com/67953243/143882296-bb11f576-8aca-4e9d-b320-28a17015a6e9.png)\r\nHere I have tried to revise the coco to voc and nc to 20. But failed.\r\n\r\n![image](https://user-images.githubusercontent.com/67953243/143882398-c2fb22d3-5615-4483-b52a-47593110b5c0.png)\r\n\r\n![image](https://user-images.githubusercontent.com/67953243/143882604-c613af6c-1e6e-4eb6-86c0-c9c11d6083c5.png)\r\nI have try many methods to deal with **Tensor.cpu()**. Unfortunatly, it can't work.\r\nI know this repo won't be maintained. But I trust this repo can be worked. \r\n\r\nThanks for help in advance. \n\n### Additional\n\n_No response_","closed_by":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1868/timeline","performed_via_github_app":null,"state_reason":"completed"}