{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/500","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/500/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/500/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/500/events","html_url":"https://github.com/ultralytics/yolov3/issues/500","id":493730512,"node_id":"MDU6SXNzdWU0OTM3MzA1MTI=","number":500,"title":"Error when using last.pt for object detection after custom training","user":{"login":"souvik3333","id":24843773,"node_id":"MDQ6VXNlcjI0ODQzNzcz","avatar_url":"https://avatars.githubusercontent.com/u/24843773?v=4","gravatar_id":"","url":"https://api.github.com/users/souvik3333","html_url":"https://github.com/souvik3333","followers_url":"https://api.github.com/users/souvik3333/followers","following_url":"https://api.github.com/users/souvik3333/following{/other_user}","gists_url":"https://api.github.com/users/souvik3333/gists{/gist_id}","starred_url":"https://api.github.com/users/souvik3333/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/souvik3333/subscriptions","organizations_url":"https://api.github.com/users/souvik3333/orgs","repos_url":"https://api.github.com/users/souvik3333/repos","events_url":"https://api.github.com/users/souvik3333/events{/privacy}","received_events_url":"https://api.github.com/users/souvik3333/received_events","type":"User","site_admin":false},"labels":[{"id":1035696370,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzcw","url":"https://api.github.com/repos/ultralytics/yolov3/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-09-15T12:15:17Z","updated_at":"2019-11-25T21:05:13Z","closed_at":"2019-09-15T12:22:29Z","author_association":"NONE","active_lock_reason":null,"body":"I trained as mentioned in  #192 on data/coco_16img.data file. After training is done when I am trying to detect object on last.pt it's giving following error.\r\nAlso I have tried using backupX.pt files in weight folder. They are giving same error. Only yolov3.weights is working without any error.\r\n\r\nNamespace(cfg='cfg/yolov3.cfg', conf_thres=0.3, data='data/coco.data', device='', fourcc='mp4v', half=False, img_size=416, nms_thres=0.5, output='output', source='beauty-3428550_1280.jpg', weights='weights/last.pt')\r\nUsing CUDA device0 _CudaDeviceProperties(name='Tesla K80', total_memory=11441MB)\r\n\r\nTraceback (most recent call last):\r\n  File \"detect.py\", line 149, in <module>\r\n    detect()\r\n  File \"detect.py\", line 26, in detect\r\n    model.load_state_dict(torch.load(weights, map_location=device)['model'])\r\n  File \"/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py\", line 777, in load_state_dict\r\n    self.__class__.__name__, \"\\n\\t\".join(error_msgs)))\r\nRuntimeError: Error(s) in loading state_dict for Darknet:\r\n\tMissing key(s) in state_dict: \"module_list.78.Conv2d.weight\", \"module_list.78.BatchNorm2d.weight\", \"module_list.78.BatchNorm2d.bias\", \"module_list.78.BatchNorm2d.running_mean\", \"module_list.78.BatchNorm2d.running_var\", \"module_list.79.Conv2d.weight\", \"module_list.79.BatchNorm2d.weight\", \"module_list.79.BatchNorm2d.bias\", \"module_list.79.BatchNorm2d.running_mean\", \"module_list.79.BatchNorm2d.running_var\", \"module_list.80.Conv2d.weight\", \"module_list.80.BatchNorm2d.weight\", \"module_list.80.BatchNorm2d.bias\", \"module_list.80.BatchNorm2d.running_mean\", \"module_list.80.BatchNorm2d.running_var\", \"module_list.81.Conv2d.weight\", \"module_list.81.Conv2d.bias\", \"module_list.88.BatchNorm2d.weight\", \"module_list.88.BatchNorm2d.bias\", \"module_list.88.BatchNorm2d.running_mean\", \"module_list.88.BatchNorm2d.running_var\", \"module_list.89.Conv2d.weight\", \"module_list.89.BatchNorm2d.weight\", \"module_list.89.BatchNorm2d.bias\", \"module_list.89.BatchNorm2d.running_mean\", \"module_list.89.BatchNorm2d.running_var\", \"module_list.90.Conv2d.weight\", \"module_list.90.BatchNorm2d.weight\", \"module_list.90.BatchNorm2d.bias\", \"module_list.90.BatchNorm2d.running_mean\", \"module_list.90.BatchNorm2d.running_var\", \"module_list.92.Conv2d.weight\", \"module_list.92.BatchNorm2d.weight\", \"module_list.92.BatchNorm2d.bias\", \"module_list.92.BatchNorm2d.running_mean\", \"module_list.92.BatchNorm2d.running_var\", \"module_list.93.Conv2d.weight\", \"module_list.93.Conv2d.bias\", \"module_list.100.BatchNorm2d.weight\", \"module_list.100.BatchNorm2d.bias\", \"module_list.100.BatchNorm2d.running_mean\", \"module_list.100.BatchNorm2d.running_var\", \"module_list.101.Conv2d.weight\", \"module_list.101.BatchNorm2d.weight\", \"module_list.101.BatchNorm2d.bias\", \"module_list.101.BatchNorm2d.running_mean\", \"module_list.101.BatchNorm2d.running_var\", \"module_list.102.Conv2d.weight\", \"module_list.102.BatchNorm2d.weight\", \"module_list.102.BatchNorm2d.bias\", \"module_list.102.BatchNorm2d.running_mean\", \"module_list.102.BatchNorm2d.running_var\", \"module_list.104.Conv2d.weight\", \"module_list.104.BatchNorm2d.weight\", \"module_list.104.BatchNorm2d.bias\", \"module_list.104.BatchNorm2d.running_mean\", \"module_list.104.BatchNorm2d.running_var\", \"module_list.105.Conv2d.weight\", \"module_list.105.Conv2d.bias\". \r\n\tUnexpected key(s) in state_dict: \"module_list.107.Conv2d.weight\", \"module_list.107.BatchNorm2d.weight\", \"module_list.107.BatchNorm2d.bias\", \"module_list.107.BatchNorm2d.running_mean\", \"module_list.107.BatchNorm2d.running_var\", \"module_list.107.BatchNorm2d.num_batches_tracked\", \"module_list.108.Conv2d.weight\", \"module_list.108.BatchNorm2d.weight\", \"module_list.108.BatchNorm2d.bias\", \"module_list.108.BatchNorm2d.running_mean\", \"module_list.108.BatchNorm2d.running_var\", \"module_list.108.BatchNorm2d.num_batches_tracked\", \"module_list.109.Conv2d.weight\", \"module_list.109.BatchNorm2d.weight\", \"module_list.109.BatchNorm2d.bias\", \"module_list.109.BatchNorm2d.running_mean\", \"module_list.109.BatchNorm2d.running_var\", \"module_list.109.BatchNorm2d.num_batches_tracked\", \"module_list.110.Conv2d.weight\", \"module_list.110.BatchNorm2d.weight\", \"module_list.110.BatchNorm2d.bias\", \"module_list.110.BatchNorm2d.running_mean\", \"module_list.110.BatchNorm2d.running_var\", \"module_list.110.BatchNorm2d.num_batches_tracked\", \"module_list.111.Conv2d.weight\", \"module_list.111.BatchNorm2d.weight\", \"module_list.111.BatchNorm2d.bias\", \"module_list.111.BatchNorm2d.running_mean\", \"module_list.111.BatchNorm2d.running_var\", \"module_list.111.BatchNorm2d.num_batches_tracked\", \"module_list.112.Conv2d.weight\", \"module_list.112.Conv2d.bias\", \"module_list.85.Conv2d.weight\", \"module_list.85.BatchNorm2d.weight\", \"module_list.85.BatchNorm2d.bias\", \"module_list.85.BatchNorm2d.running_mean\", \"module_list.85.BatchNorm2d.running_var\", \"module_list.85.BatchNorm2d.num_batches_tracked\", \"module_list.86.Conv2d.weight\", \"module_list.86.BatchNorm2d.weight\", \"module_list.86.BatchNorm2d.bias\", \"module_list.86.BatchNorm2d.running_mean\", \"module_list.86.BatchNorm2d.running_var\", \"module_list.86.BatchNorm2d.num_batches_tracked\", \"module_list.88.Conv2d.bias\", \"module_list.94.Conv2d.weight\", \"module_list.94.BatchNorm2d.weight\", \"module_list.94.BatchNorm2d.bias\", \"module_list.94.BatchNorm2d.running_mean\", \"module_list.94.BatchNorm2d.running_var\", \"module_list.94.BatchNorm2d.num_batches_tracked\", \"module_list.95.Conv2d.weight\", \"module_list.95.BatchNorm2d.weight\", \"module_list.95.BatchNorm2d.bias\", \"module_list.95.BatchNorm2d.running_mean\", \"module_list.95.BatchNorm2d.running_var\", \"module_list.95.BatchNorm2d.num_batches_tracked\", \"module_list.97.Conv2d.weight\", \"module_list.97.BatchNorm2d.weight\", \"module_list.97.BatchNorm2d.bias\", \"module_list.97.BatchNorm2d.running_mean\", \"module_list.97.BatchNorm2d.running_var\", \"module_list.97.BatchNorm2d.num_batches_tracked\", \"module_list.98.Conv2d.weight\", \"module_list.98.BatchNorm2d.weight\", \"module_list.98.BatchNorm2d.bias\", \"module_list.98.BatchNorm2d.running_mean\", \"module_list.98.BatchNorm2d.running_var\", \"module_list.98.BatchNorm2d.num_batches_tracked\", \"module_list.100.Conv2d.bias\", \"module_list.106.Conv2d.weight\", \"module_list.106.BatchNorm2d.weight\", \"module_list.106.BatchNorm2d.bias\", \"module_list.106.BatchNorm2d.running_mean\", \"module_list.106.BatchNorm2d.running_var\", \"module_list.106.BatchNorm2d.num_batches_tracked\". \r\n\tsize mismatch for module_list.84.Conv2d.weight: copying a param with shape torch.Size([512, 2048, 1, 1]) from checkpoint, the shape in current model is torch.Size([256, 512, 1, 1]).\r\n\tsize mismatch for module_list.84.BatchNorm2d.weight: copying a param with shape torch.Size([512]) from checkpoint, the shape in current model is torch.Size([256]).\r\n\tsize mismatch for module_list.84.BatchNorm2d.bias: copying a param with shape torch.Size([512]) from checkpoint, the shape in current model is torch.Size([256]).\r\n\tsize mismatch for module_list.84.BatchNorm2d.running_mean: copying a param with shape torch.Size([512]) from checkpoint, the shape in current model is torch.Size([256]).\r\n\tsize mismatch for module_list.84.BatchNorm2d.running_var: copying a param with shape torch.Size([512]) from checkpoint, the shape in current model is torch.Size([256]).\r\n\tsize mismatch for module_list.87.Conv2d.weight: copying a param with shape torch.Size([1024, 512, 3, 3]) from checkpoint, the shape in current model is torch.Size([256, 768, 1, 1]).\r\n\tsize mismatch for module_list.87.BatchNorm2d.weight: copying a param with shape torch.Size([1024]) from checkpoint, the shape in current model is torch.Size([256]).\r\n\tsize mismatch for module_list.87.BatchNorm2d.bias: copying a param with shape torch.Size([1024]) from checkpoint, the shape in current model is torch.Size([256]).\r\n\tsize mismatch for module_list.87.BatchNorm2d.running_mean: copying a param with shape torch.Size([1024]) from checkpoint, the shape in current model is torch.Size([256]).\r\n\tsize mismatch for module_list.87.BatchNorm2d.running_var: copying a param with shape torch.Size([1024]) from checkpoint, the shape in current model is torch.Size([256]).\r\n\tsize mismatch for module_list.88.Conv2d.weight: copying a param with shape torch.Size([255, 1024, 1, 1]) from checkpoint, the shape in current model is torch.Size([512, 256, 3, 3]).\r\n\tsize mismatch for module_list.96.Conv2d.weight: copying a param with shape torch.Size([256, 512, 1, 1]) from checkpoint, the shape in current model is torch.Size([128, 256, 1, 1]).\r\n\tsize mismatch for module_list.96.BatchNorm2d.weight: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([128]).\r\n\tsize mismatch for module_list.96.BatchNorm2d.bias: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([128]).\r\n\tsize mismatch for module_list.96.BatchNorm2d.running_mean: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([128]).\r\n\tsize mismatch for module_list.96.BatchNorm2d.running_var: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([128]).\r\n\tsize mismatch for module_list.99.Conv2d.weight: copying a param with shape torch.Size([512, 256, 3, 3]) from checkpoint, the shape in current model is torch.Size([128, 384, 1, 1]).\r\n\tsize mismatch for module_list.99.BatchNorm2d.weight: copying a param with shape torch.Size([512]) from checkpoint, the shape in current model is torch.Size([128]).\r\n\tsize mismatch for module_list.99.BatchNorm2d.bias: copying a param with shape torch.Size([512]) from checkpoint, the shape in current model is torch.Size([128]).\r\n\tsize mismatch for module_list.99.BatchNorm2d.running_mean: copying a param with shape torch.Size([512]) from checkpoint, the shape in current model is torch.Size([128]).\r\n\tsize mismatch for module_list.99.BatchNorm2d.running_var: copying a param with shape torch.Size([512]) from checkpoint, the shape in current model is torch.Size([128]).\r\n\tsize mismatch for module_list.100.Conv2d.weight: copying a param with shape torch.Size([255, 512, 1, 1]) from checkpoint, the shape in current model is torch.Size([256, 128, 3, 3]).\r\n\r\n**To Reproduce:**\r\nUsed commands: \r\npython3 train.py --data data/coco_16img.data\r\npython3 detect.py --cfg cfg/yolov3.cfg --weights weights/last.pt --source test.jpg\r\n","closed_by":{"login":"souvik3333","id":24843773,"node_id":"MDQ6VXNlcjI0ODQzNzcz","avatar_url":"https://avatars.githubusercontent.com/u/24843773?v=4","gravatar_id":"","url":"https://api.github.com/users/souvik3333","html_url":"https://github.com/souvik3333","followers_url":"https://api.github.com/users/souvik3333/followers","following_url":"https://api.github.com/users/souvik3333/following{/other_user}","gists_url":"https://api.github.com/users/souvik3333/gists{/gist_id}","starred_url":"https://api.github.com/users/souvik3333/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/souvik3333/subscriptions","organizations_url":"https://api.github.com/users/souvik3333/orgs","repos_url":"https://api.github.com/users/souvik3333/repos","events_url":"https://api.github.com/users/souvik3333/events{/privacy}","received_events_url":"https://api.github.com/users/souvik3333/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/500/timeline","performed_via_github_app":null,"state_reason":"completed"}