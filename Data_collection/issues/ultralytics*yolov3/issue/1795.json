{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1795","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1795/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1795/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1795/events","html_url":"https://github.com/ultralytics/yolov3/issues/1795","id":927181325,"node_id":"MDU6SXNzdWU5MjcxODEzMjU=","number":1795,"title":"RuntimeError: Cannot insert a Tensor that requires grad as a constant. Consider making it a parameter or input, or detaching the gradient","user":{"login":"jaskiratsingh2000","id":10228651,"node_id":"MDQ6VXNlcjEwMjI4NjUx","avatar_url":"https://avatars.githubusercontent.com/u/10228651?v=4","gravatar_id":"","url":"https://api.github.com/users/jaskiratsingh2000","html_url":"https://github.com/jaskiratsingh2000","followers_url":"https://api.github.com/users/jaskiratsingh2000/followers","following_url":"https://api.github.com/users/jaskiratsingh2000/following{/other_user}","gists_url":"https://api.github.com/users/jaskiratsingh2000/gists{/gist_id}","starred_url":"https://api.github.com/users/jaskiratsingh2000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaskiratsingh2000/subscriptions","organizations_url":"https://api.github.com/users/jaskiratsingh2000/orgs","repos_url":"https://api.github.com/users/jaskiratsingh2000/repos","events_url":"https://api.github.com/users/jaskiratsingh2000/events{/privacy}","received_events_url":"https://api.github.com/users/jaskiratsingh2000/received_events","type":"User","site_admin":false},"labels":[{"id":1035696376,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzc2","url":"https://api.github.com/repos/ultralytics/yolov3/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"},{"id":1890885613,"node_id":"MDU6TGFiZWwxODkwODg1NjEz","url":"https://api.github.com/repos/ultralytics/yolov3/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2021-06-22T12:30:29Z","updated_at":"2021-08-17T00:06:12Z","closed_at":"2021-08-17T00:06:12Z","author_association":"NONE","active_lock_reason":null,"body":"@glenn-jocher please please need your help here as I was not able to run the yolov5 due to errors but I see the same in yolofv3 as well. Can you please help me resolve these errors?\r\n\r\n**Command ran:** python3 train.py --img 416 --batch 10 --epochs 100 --data ./data.yaml --cfg ./models/yolov3.yaml --weights yolov3.pt\r\n\r\nI am running this on my local and I have already ran on your environerments as well so please consider taking a look here that how can I resolve this error.\r\n\r\n```\r\nYOLOv3 ðŸš€ v9.5.0-13-g1be3170 torch 1.7.0a0+57bffc3 CPU\r\n\r\nNamespace(adam=False, artifact_alias='latest', batch_size=10, bbox_interval=-1, bucket='', cache_images=False, cfg='./models/yolov3.yaml', data='./data.yaml', device='', entity=None, epochs=100, evolve=False, exist_ok=False, global_rank=-1, hyp='data/hyp.scratch.yaml', image_weights=False, img_size=[416, 416], label_smoothing=0.0, linear_lr=False, local_rank=-1, multi_scale=False, name='exp', noautoanchor=False, nosave=False, notest=False, project='runs/train', quad=False, rect=False, resume=False, save_dir='runs/train/exp8', save_period=-1, single_cls=False, sync_bn=False, total_batch_size=10, upload_dataset=False, weights='yolov3.pt', workers=8, world_size=1)\r\ntensorboard: Start with 'tensorboard --logdir runs/train', view at http://localhost:6006/\r\nhyperparameters: lr0=0.01, lrf=0.2, momentum=0.937, weight_decay=0.0005, warmup_epochs=3.0, warmup_momentum=0.8, warmup_bias_lr=0.1, box=0.05, cls=0.5, cls_pw=1.0, obj=1.0, obj_pw=1.0, iou_t=0.2, anchor_t=4.0, fl_gamma=0.0, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, degrees=0.0, translate=0.1, scale=0.5, shear=0.0, perspective=0.0, flipud=0.0, fliplr=0.5, mosaic=1.0, mixup=0.0\r\nwandb: Install Weights & Biases for YOLOv3 logging with 'pip install wandb' (recommended)\r\n\r\n                 from  n    params  module                                  arguments                     \r\n  0                -1  1       232  models.common.Conv                      [3, 8, 3, 1]                  \r\n  1                -1  1       592  models.common.Conv                      [8, 8, 3, 2]                  \r\n  2                -1  1       344  models.common.Bottleneck                [8, 8]                        \r\n  3                -1  1       592  models.common.Conv                      [8, 8, 3, 2]                  \r\n  4                -1  1       344  models.common.Bottleneck                [8, 8]                        \r\n  5                -1  1       592  models.common.Conv                      [8, 8, 3, 2]                  \r\n  6                -1  1       344  models.common.Bottleneck                [8, 8]                        \r\n  7                -1  1      1184  models.common.Conv                      [8, 16, 3, 2]                 \r\n  8                -1  1      1328  models.common.Bottleneck                [16, 16]                      \r\n  9                -1  1      3504  models.common.Conv                      [16, 24, 3, 2]                \r\n 10                -1  1      2952  models.common.Bottleneck                [24, 24]                      \r\n 11                -1  1      2952  models.common.Bottleneck                [24, 24, False]               \r\n 12                -1  1       416  models.common.Conv                      [24, 16, [1, 1]]              \r\n 13                -1  1      3504  models.common.Conv                      [16, 24, 3, 1]                \r\n 14                -1  1       416  models.common.Conv                      [24, 16, 1, 1]                \r\n 15                -1  1      3504  models.common.Conv                      [16, 24, 3, 1]                \r\n 16                -2  1       144  models.common.Conv                      [16, 8, 1, 1]                 \r\n 17                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']          \r\n 18           [-1, 8]  1         0  models.common.Concat                    [1]                           \r\n 19                -1  1      1392  models.common.Bottleneck                [24, 16, False]               \r\n 20                -1  1      1328  models.common.Bottleneck                [16, 16, False]               \r\n 21                -1  1       144  models.common.Conv                      [16, 8, 1, 1]                 \r\n 22                -1  1      1184  models.common.Conv                      [8, 16, 3, 1]                 \r\n 23                -2  1        80  models.common.Conv                      [8, 8, 1, 1]                  \r\n 24                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']          \r\n 25           [-1, 6]  1         0  models.common.Concat                    [1]                           \r\n 26                -1  1       376  models.common.Bottleneck                [16, 8, False]                \r\n 27                -1  1       344  models.common.Bottleneck                [8, 8, False]                 \r\n 28      [27, 22, 15]  1      1071  models.yolo.Detect                      [2, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [8, 16, 24]]\r\nModel Summary: 157 layers, 28863 parameters, 28863 gradients\r\n\r\nTransferred 24/212 items from yolov3.pt\r\nScaled weight_decay = 0.00046875\r\nOptimizer groups: 37 .bias, 37 conv.weight, 34 other\r\nval: Scanning 'valid/labels.cache' images and labels... 29 found,\r\nval: Scanning 'valid/labels.cache' images and labels... 29 found,\r\nPlotting labels... \r\ntrain: Scanning 'train/labels.cache' images and labels... 315 fou\r\n\r\nautoanchor: Analyzing anchors... anchors/target = 5.46, Best Possible Recall (BPR) = 0.9984\r\nImage sizes 416 train, 416 test\r\nUsing 4 dataloader workers\r\nLogging results to runs/train/exp8\r\nStarting training for 100 epochs...\r\n\r\n     Epoch   gpu_mem       box       obj       cls     total    labels  img_size\r\n      0/99        0G    0.1063   0.02055   0.02829    0.1551     \r\nTraceback (most recent call last):\r\n  File \"train.py\", line 541, in <module>\r\n    train(hyp, opt, device, tb_writer)\r\n  File \"train.py\", line 334, in train\r\n    tb_writer.add_graph(torch.jit.trace(de_parallel(model), imgs, strict=False), [])  # model graph\r\n  File \"/home/ubuntu/.local/lib/python3.8/site-packages/torch/jit/_trace.py\", line 733, in trace\r\n    return trace_module(\r\n  File \"/home/ubuntu/.local/lib/python3.8/site-packages/torch/jit/_trace.py\", line 934, in trace_module\r\n    module._c._create_method_from_trace(\r\n  File \"/home/ubuntu/.local/lib/python3.8/site-packages/torch/nn/modules/module.py\", line 725, in _call_impl\r\n    result = self._slow_forward(*input, **kwargs)\r\n  File \"/home/ubuntu/.local/lib/python3.8/site-packages/torch/nn/modules/module.py\", line 709, in _slow_forward\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ubuntu/Desktop/yolov3/models/yolo.py\", line 121, in forward\r\n    return self.forward_once(x, profile)  # single-scale inference, train\r\n  File \"/home/ubuntu/Desktop/yolov3/models/yolo.py\", line 152, in forward_once\r\n    x = m(x)  # run\r\n  File \"/home/ubuntu/.local/lib/python3.8/site-packages/torch/nn/modules/module.py\", line 725, in _call_impl\r\n    result = self._slow_forward(*input, **kwargs)\r\n  File \"/home/ubuntu/.local/lib/python3.8/site-packages/torch/nn/modules/module.py\", line 709, in _slow_forward\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ubuntu/Desktop/yolov3/models/common.py\", line 42, in forward\r\n    return self.act(self.bn(self.conv(x)))\r\n  File \"/home/ubuntu/.local/lib/python3.8/site-packages/torch/nn/modules/module.py\", line 725, in _call_impl\r\n    result = self._slow_forward(*input, **kwargs)\r\n  File \"/home/ubuntu/.local/lib/python3.8/site-packages/torch/nn/modules/module.py\", line 709, in _slow_forward\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ubuntu/.local/lib/python3.8/site-packages/torch/nn/modules/conv.py\", line 423, in forward\r\n    return self._conv_forward(input, self.weight)\r\n  File \"/home/ubuntu/.local/lib/python3.8/site-packages/torch/nn/modules/conv.py\", line 419, in _conv_forward\r\n    return F.conv2d(input, weight, self.bias, self.stride,\r\nRuntimeError: Cannot insert a Tensor that requires grad as a constant. Consider making it a parameter or input, or detaching the gradient\r\nTensor:\r\n(1,1,.,.) = \r\n  0.0992 -0.0850 -0.0373\r\n  0.0903 -0.1812  0.1154\r\n -0.0396  0.0979  0.0267\r\n\r\n(2,1,.,.) = \r\n  0.1046 -0.1881  0.1193\r\n  0.0538  0.1825  0.1271\r\n -0.1753 -0.1830 -0.0928\r\n\r\n(3,1,.,.) = \r\n  0.1917  0.1543 -0.0090\r\n -0.1284  0.1172  0.0597\r\n -0.1244  0.1250  0.1168\r\n\r\n(4,1,.,.) = \r\n -0.1453  0.0117 -0.0328\r\n  0.1130 -0.1115 -0.1711\r\n  0.1400 -0.0285  0.1082\r\n\r\n(5,1,.,.) = \r\n  0.1320  0.0399  0.0619\r\n  0.1438  0.1825 -0.1277\r\n  0.0241  0.1437  0.1394\r\n\r\n(6,1,.,.) = \r\n  0.1367  0.1217  0.0497\r\n -0.1316 -0.1616 -0.0882\r\n -0.0224 -0.1180  0.0704\r\n\r\n(7,1,.,.) = \r\n  0.0616  0.1246 -0.0996\r\n  0.0417 -0.0701 -0.0432\r\n -0.1533 -0.0877 -0.0589\r\n\r\n(8,1,.,.) = \r\n -0.1041  0.0688 -0.0741\r\n -0.0904  0.0109  0.1393\r\n -0.1354  0.0904  0.1237\r\n\r\n(1,2,.,.) = \r\n 0.01 *\r\n -2.3560  5.3375  0.9491\r\n   7.0312 -7.5012 -1.4030\r\n  -1.7319  2.7893 -0.0769\r\n\r\n(2,2,.,.) = \r\n  0.1689 -0.0320  0.0823\r\n -0.0894  0.1888 -0.0814\r\n  0.1443  0.0023 -0.1014\r\n\r\n(3,2,.,.) = \r\n  0.1707 -0.1079 -0.0317\r\n -0.0037  0.0281 -0.1460\r\n -0.1366  0.1047 -0.0451\r\n\r\n(4,2,.,.) = \r\n 0.01 *\r\n  6.1859 -14.4287  3.8666\r\n   4.6234 -12.8906 -9.1309\r\n   6.5613  3.4485 -8.1848\r\n\r\n(5,2,.,.) = \r\n  0.1196 -0.1393 -0.1385\r\n -0.1164  0.0242  0.1918\r\n -0.1216  0.1025 -0.1065\r\n\r\n(6,2,.,.) = \r\n  0.0596 -0.0436  0.0740\r\n  0.0622  0.1175  0.1296\r\n -0.0652  0.1880 -0.0222\r\n\r\n(7,2,.,.) = \r\n  0.0823  0.0352  0.0475\r\n  0.1921  0.1876  0.1312\r\n  0.0061 -0.1332  0.1504\r\n\r\n(8,2,.,.) = \r\n  0.1882 -0.1346  0.0466\r\n -0.1423  0.1643 -0.0746\r\n  0.1159  0.0057 -0.0150\r\n\r\n(1,3,.,.) = \r\n  0.1682  0.0599 -0.0717\r\n -0.1162 -0.0323 -0.0830\r\n -0.0617  0.0092  0.1147\r\n\r\n(2,3,.,.) = \r\n  0.0989 -0.1022  0.0566\r\n -0.0556 -0.0211 -0.1851\r\n -0.0917  0.1044 -0.0468\r\n\r\n(3,3,.,.) = \r\n 0.01 *\r\n  9.3994  1.0971  6.3171\r\n   4.2328  6.9946  9.5398\r\n  -17.8223  9.6863 -13.5376\r\n\r\n(4,3,.,.) = \r\n -0.0583  0.1763 -0.0356\r\n  0.1085  0.0833 -0.1244\r\n -0.1637  0.1847  0.0100\r\n\r\n(5,3,.,.) = \r\n -0.1809 -0.0409  0.1109\r\n  0.1787 -0.1195  0.0418\r\n  0.1660  0.1276  0.1199\r\n\r\n(6,3,.,.) = \r\n -0.0066 -0.1816 -0.1238\r\n -0.1124 -0.0823  0.1368\r\n -0.0629 -0.1438  0.0740\r\n\r\n(7,3,.,.) = \r\n -0.0481 -0.0156 -0.1658\r\n -0.0380 -0.1241  0.1769\r\n -0.1664 -0.1500 -0.0065\r\n\r\n(8,3,.,.) = \r\n -0.0061  0.0327  0.0907\r\n  0.0309  0.0587 -0.1731\r\n  0.1403  0.1678  0.1591\r\n[ torch.FloatTensor{8,3,3,3} ]\r\n\r\n```\r\n","closed_by":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1795/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1795/timeline","performed_via_github_app":null,"state_reason":"completed"}