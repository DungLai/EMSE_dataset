{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1968","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1968/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1968/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1968/events","html_url":"https://github.com/ultralytics/yolov3/issues/1968","id":1349805793,"node_id":"I_kwDOCLZQgM5QdGbh","number":1968,"title":"How to properly load custom trained model with only 1 label","user":{"login":"AceMcAwesome77","id":97188850,"node_id":"U_kgDOBcr78g","avatar_url":"https://avatars.githubusercontent.com/u/97188850?v=4","gravatar_id":"","url":"https://api.github.com/users/AceMcAwesome77","html_url":"https://github.com/AceMcAwesome77","followers_url":"https://api.github.com/users/AceMcAwesome77/followers","following_url":"https://api.github.com/users/AceMcAwesome77/following{/other_user}","gists_url":"https://api.github.com/users/AceMcAwesome77/gists{/gist_id}","starred_url":"https://api.github.com/users/AceMcAwesome77/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AceMcAwesome77/subscriptions","organizations_url":"https://api.github.com/users/AceMcAwesome77/orgs","repos_url":"https://api.github.com/users/AceMcAwesome77/repos","events_url":"https://api.github.com/users/AceMcAwesome77/events{/privacy}","received_events_url":"https://api.github.com/users/AceMcAwesome77/received_events","type":"User","site_admin":false},"labels":[{"id":1035696376,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzc2","url":"https://api.github.com/repos/ultralytics/yolov3/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"},{"id":1890885613,"node_id":"MDU6TGFiZWwxODkwODg1NjEz","url":"https://api.github.com/repos/ultralytics/yolov3/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-08-24T17:37:37Z","updated_at":"2022-10-06T00:20:56Z","closed_at":"2022-10-06T00:20:56Z","author_association":"NONE","active_lock_reason":null,"body":"### Search before asking\r\n\r\n- [X] I have searched the YOLOv3 [issues](https://github.com/ultralytics/yolov3/issues) and [discussions](https://github.com/ultralytics/yolov3/discussions) and found no similar questions.\r\n\r\n\r\n### Question\r\n\r\nI followed the very helpful description for how to train a custom model, and successfully trained a yolo-v3 model with only 1 object type.  However when I run the following code to load my model on a different system:\r\n\r\nweights_path = '\\runs\\train\\exp10\\weights\\best.pt'\r\nmodel = torch.hub.load('ultralytics/yolov3', 'yolov3', weights_path)  # custom trained model\r\nmodel.eval()\r\nresults = model(image)\r\n\r\nThe results produced seem to have all the original yolo labels still in place, such as 'cat', etc.  And the label numbers are 15, 27,etc, whereas they should only be 0 for the single label.  What is the proper way to load the saved model so that the correct number of output labels and label name I trained on is produced?  Thanks!\r\n\r\n\r\n***Update - I've also tried this, after some further googling of this problem:\r\n\r\nmodel = torch.hub.load('ultralytics/yolov3', 'yolov3', pretrained=False, classes=1)\r\nweights = torch.load(weights_path)['model']\r\nmodel.load_state_dict(weights.state_dict())\r\n\r\nbut this causes the following error:\r\n\r\nfile \"<ipython-input-8-d8d98c19035e>\", line 1, in <module>\r\n    model.load_state_dict(weights.state_dict())\r\n  File \"C:\\Users\\robert.harris\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 1604, in load_state_dict\r\n    raise RuntimeError('Error(s) in loading state_dict for {}:\\n\\t{}'.format(\r\nRuntimeError: Error(s) in loading state_dict for AutoShape:\r\n\tMissing key(s) in state_dict: \"model.model.0.conv.weight\", \"model.model.0.bn.weight\", \"model.model.0.bn.bias\", \"model.model.0.bn.running_mean\", \"model.model.0.bn.running_var\",\"model.model.1.conv.weight\", \"model.model.1.bn.weight\", \"model.model.1.bn.bias\", \"model.model.1.bn.running_mean\", \"model.model.1.bn.running_var\", \"model.model.2.cv1.conv.weight\", \"model.model.2.cv1.bn.weight\", \"model.model.2.cv1.bn.bias\", \"model.model.2.cv1.bn.running_mean\", \"model.model.2.cv1.bn.running_var\", \"model.model.2.cv2.conv.weight\", \"model.model.2.cv2.bn.weight\", \"model.model.2.cv2.bn.bias\", \"model.model.2.cv2.bn.running_mean\", \"model.model.2.cv2.bn.running_var\", \"model.model.3.conv.weight\", \"model.model.3.bn.weight\", \"model.model.3.bn.bias\", \"model.model, .... [300 or so lines of this continued] .... 27.1.cv1.bn.num_batches_tracked\", \"model.27.1.cv2.conv.weight\", \"model.27.1.cv2.bn.weight\", \"model.27.1.cv2.bn.bias\", \"model.27.1.cv2.bn.running_mean\", \"model.27.1.cv2.bn.running_var\", \"model.27.1.cv2.bn.num_batches_tracked\", \"model.28.anchors\", \"model.28.m.0.weight\", \"model.28.m.0.bias\", \"model.28.m.1.weight\", \"model.28.m.1.bias\", \"model.28.m.2.weight\", \"model.28.m.2.bias\". \r\n\r\nso I'm still looking for a working solution.  Thanks!\r\n\r\n### Additional\r\n\r\n_No response_","closed_by":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1968/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1968/timeline","performed_via_github_app":null,"state_reason":"not_planned"}