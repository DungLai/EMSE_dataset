{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/671","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/671/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/671/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/671/events","html_url":"https://github.com/ultralytics/yolov3/issues/671","id":530522168,"node_id":"MDU6SXNzdWU1MzA1MjIxNjg=","number":671,"title":"Dimension Error during Testing","user":{"login":"russellave","id":44121878,"node_id":"MDQ6VXNlcjQ0MTIxODc4","avatar_url":"https://avatars.githubusercontent.com/u/44121878?v=4","gravatar_id":"","url":"https://api.github.com/users/russellave","html_url":"https://github.com/russellave","followers_url":"https://api.github.com/users/russellave/followers","following_url":"https://api.github.com/users/russellave/following{/other_user}","gists_url":"https://api.github.com/users/russellave/gists{/gist_id}","starred_url":"https://api.github.com/users/russellave/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/russellave/subscriptions","organizations_url":"https://api.github.com/users/russellave/orgs","repos_url":"https://api.github.com/users/russellave/repos","events_url":"https://api.github.com/users/russellave/events{/privacy}","received_events_url":"https://api.github.com/users/russellave/received_events","type":"User","site_admin":false},"labels":[{"id":1035696370,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzcw","url":"https://api.github.com/repos/ultralytics/yolov3/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-11-30T02:21:21Z","updated_at":"2019-11-30T17:00:02Z","closed_at":"2019-11-30T17:00:02Z","author_association":"NONE","active_lock_reason":null,"body":"I am training a custom dataset. During training, when testing is done after an epoch, I receive a dimension error. The only things I changed in the config file were the number of filters in the last conv layer (from 255 to 48) and the number of classes (11)\r\n\r\nI run this command: \r\npython3 train.py --data data/custom_data.data --cfg cfg/custom_cfg.cfg  --weights '' --batch-size 16\r\n\r\nThis is my output: \r\n\r\nReading labels (100 found, 0 missing, 0 empty for 100 images): 100% 100/100 [00:00<00:00, 716.85it/s]\r\nModel Summary: 222 layers, 6.1896e+07 parameters, 6.1896e+07 gradients\r\nStarting training for 273 epochs...\r\n\r\n     Epoch   gpu_mem      GIoU       obj       cls     total   targets  img_size\r\n     0/272     4.39G      1.45      0.83      19.2      21.5         4       416: 100% 13/13 [00:08<00:00,  2.29it/s]\r\n               Class    Images   Targets         P         R   mAP@0.5        F1:   0% 0/13 [00:00<?, ?it/s]\r\n\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 448, in <module>\r\n    train()  # train normally\r\n  File \"train.py\", line 320, in train\r\n    save_json=final_epoch and epoch > 0 and 'coco.data' in data)\r\n  File \"/content/drive/My Drive/Yolo/yolov3/test.py\", line 74, in test\r\n    inf_out, train_out = model(imgs)  # inference and training outputs\r\n  File \"/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py\", line 541, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/content/drive/My Drive/Yolo/yolov3/models.py\", line 273, in forward\r\n    return torch.cat(io, 1), p\r\nRuntimeError: invalid argument 0: Sizes of tensors must match except in dimension 1. Got 16 and 85 in dimension 2 at /pytorch/aten/src/THC/generic/THCTensorMath.cu:71\r\n\r\n\r\nDo you have an idea on where I can look to fix this? \r\n\r\n\r\n","closed_by":{"login":"russellave","id":44121878,"node_id":"MDQ6VXNlcjQ0MTIxODc4","avatar_url":"https://avatars.githubusercontent.com/u/44121878?v=4","gravatar_id":"","url":"https://api.github.com/users/russellave","html_url":"https://github.com/russellave","followers_url":"https://api.github.com/users/russellave/followers","following_url":"https://api.github.com/users/russellave/following{/other_user}","gists_url":"https://api.github.com/users/russellave/gists{/gist_id}","starred_url":"https://api.github.com/users/russellave/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/russellave/subscriptions","organizations_url":"https://api.github.com/users/russellave/orgs","repos_url":"https://api.github.com/users/russellave/repos","events_url":"https://api.github.com/users/russellave/events{/privacy}","received_events_url":"https://api.github.com/users/russellave/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/671/timeline","performed_via_github_app":null,"state_reason":"completed"}