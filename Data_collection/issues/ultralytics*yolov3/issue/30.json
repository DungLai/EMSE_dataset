{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/30","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/30/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/30/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/30/events","html_url":"https://github.com/ultralytics/yolov3/issues/30","id":373047082,"node_id":"MDU6SXNzdWUzNzMwNDcwODI=","number":30,"title":"Can't seem to load weights from a custom training session.","user":{"login":"nirbenz","id":4930255,"node_id":"MDQ6VXNlcjQ5MzAyNTU=","avatar_url":"https://avatars.githubusercontent.com/u/4930255?v=4","gravatar_id":"","url":"https://api.github.com/users/nirbenz","html_url":"https://github.com/nirbenz","followers_url":"https://api.github.com/users/nirbenz/followers","following_url":"https://api.github.com/users/nirbenz/following{/other_user}","gists_url":"https://api.github.com/users/nirbenz/gists{/gist_id}","starred_url":"https://api.github.com/users/nirbenz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nirbenz/subscriptions","organizations_url":"https://api.github.com/users/nirbenz/orgs","repos_url":"https://api.github.com/users/nirbenz/repos","events_url":"https://api.github.com/users/nirbenz/events{/privacy}","received_events_url":"https://api.github.com/users/nirbenz/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-10-23T14:58:53Z","updated_at":"2021-05-25T20:52:29Z","closed_at":"2018-11-19T15:40:18Z","author_association":"NONE","active_lock_reason":null,"body":"I've got a model trained using Darknet on a custom dataset containing 43 classes. This requires changing the number of filters for 3 conv layers from _255_ to _144_ (and of course the number of classes, although this shouldn't affect the bug I'm describing).\r\n\r\nAlas, when loading this weight file (with the relevant cfg file), the network loading part crashes due to the weights file 'ending' before it should.\r\nThe actual error is generated by:\r\n```conv_w = torch.from_numpy(weights[ptr:ptr + num_w]).view_as(conv_layer.weight)```\r\n\r\nWhile the error is:\r\n```\r\nRuntimeError: invalid argument 2: size '[144 x 256 x 1 x 1]' is invalid for input with 36863 elements at /opt/conda/conda-bld/pytorch_1535491974311/work/aten/src/TH/THStorage.cpp:84\r\n```\r\n\r\nNow, the size of `weights` is _61802511_, and `ptr+num_w` is _61802512_ - i.e. it's one float _shorter_.\r\nI'll note that this doesn't happen when loading the original _yolov3.weights_ file that comes with the original Darknet/YOLOv3 repository (in that one, the numbers perfectly align).\r\n\r\nI can't think of a cause other than something causing the counter to advance one index too fast, but can't think of a reason why this would happen. Any ideas?\r\n\r\nThanks!","closed_by":{"login":"nirbenz","id":4930255,"node_id":"MDQ6VXNlcjQ5MzAyNTU=","avatar_url":"https://avatars.githubusercontent.com/u/4930255?v=4","gravatar_id":"","url":"https://api.github.com/users/nirbenz","html_url":"https://github.com/nirbenz","followers_url":"https://api.github.com/users/nirbenz/followers","following_url":"https://api.github.com/users/nirbenz/following{/other_user}","gists_url":"https://api.github.com/users/nirbenz/gists{/gist_id}","starred_url":"https://api.github.com/users/nirbenz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nirbenz/subscriptions","organizations_url":"https://api.github.com/users/nirbenz/orgs","repos_url":"https://api.github.com/users/nirbenz/repos","events_url":"https://api.github.com/users/nirbenz/events{/privacy}","received_events_url":"https://api.github.com/users/nirbenz/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/30/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/30/timeline","performed_via_github_app":null,"state_reason":"completed"}