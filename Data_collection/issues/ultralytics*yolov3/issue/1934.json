{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1934","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1934/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1934/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1934/events","html_url":"https://github.com/ultralytics/yolov3/issues/1934","id":1214131384,"node_id":"I_kwDOCLZQgM5IXiy4","number":1934,"title":"Something wrong when i run the train.py : RuntimeError: Unable to find a valid cuDNN algorithm to run convolution","user":{"login":"heylary","id":34568834,"node_id":"MDQ6VXNlcjM0NTY4ODM0","avatar_url":"https://avatars.githubusercontent.com/u/34568834?v=4","gravatar_id":"","url":"https://api.github.com/users/heylary","html_url":"https://github.com/heylary","followers_url":"https://api.github.com/users/heylary/followers","following_url":"https://api.github.com/users/heylary/following{/other_user}","gists_url":"https://api.github.com/users/heylary/gists{/gist_id}","starred_url":"https://api.github.com/users/heylary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/heylary/subscriptions","organizations_url":"https://api.github.com/users/heylary/orgs","repos_url":"https://api.github.com/users/heylary/repos","events_url":"https://api.github.com/users/heylary/events{/privacy}","received_events_url":"https://api.github.com/users/heylary/received_events","type":"User","site_admin":false},"labels":[{"id":1035696376,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzc2","url":"https://api.github.com/repos/ultralytics/yolov3/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"},{"id":1890885613,"node_id":"MDU6TGFiZWwxODkwODg1NjEz","url":"https://api.github.com/repos/ultralytics/yolov3/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-04-25T08:08:23Z","updated_at":"2022-06-01T00:15:18Z","closed_at":"2022-06-01T00:15:18Z","author_association":"NONE","active_lock_reason":null,"body":"### Search before asking\r\n\r\n- [X] I have searched the YOLOv3 [issues](https://github.com/ultralytics/yolov3/issues) and [discussions](https://github.com/ultralytics/yolov3/discussions) and found no similar questions.\r\n\r\n\r\n### Question\r\n\r\ni can run the yolo5-5.0 and train my custom dataset, but when i run the latest version of yolov3, i can't ever run the train example, Here are the command:\r\n\r\n`python train.py --img 640 --batch 1 --epochs 5 --data data/coco128.yaml --weights yolov3.pt --device 0 --workers 1 --batch-size 2`\r\n\r\nand it always sent the error tip:\r\n`RuntimeError: Unable to find a valid cuDNN algorithm to run convolution`,\r\n\r\nthe batch and the batch-size is smaller than the yolov5, and it also error. i can run the train.py when i use the CPU, could you please give me some advices?\r\n\r\n### Additional\r\n\r\n` D:\\WorkData\\DeepLearning\\yolov3>python train.py --img 640 --batch 1 --epochs 5 --data data/coco128.yaml --weights yolov3.pt --device 0 --workers 1 --batch-size 2\r\ntrain: weights=yolov3.pt, cfg=, data=data/coco128.yaml, hyp=data/hyps/hyp.scratch.yaml, epochs=5, batch_size=2, imgsz=640, rect=False, resume=False, nosave=False, noval=False, noautoanchor=False, evolve=None, bucket=, cache=None, image_weights=False, device=0, multi_scale=False, single_cls=False, adam=False, sync_bn=False, workers=1, project=runs/train, name=exp, exist_ok=False, quad=False, linear_lr=False, label_smoothing=0.0, patience=100, freeze=0, save_period=-1, local_rank=-1, entity=None, upload_dataset=False, bbox_interval=-1, artifact_alias=latest\r\ngithub: skipping check (not a git repository), for updates see https://github.com/ultralytics/yolov3\r\nYOLOv3  2021-11-14 torch 1.10.0+cu113 CUDA:0 (GeForce RTX 3050 Laptop GPU, 4096MiB)\r\n\r\nhyperparameters: lr0=0.01, lrf=0.1, momentum=0.937, weight_decay=0.0005, warmup_epochs=3.0, warmup_momentum=0.8, warmup_bias_lr=0.1, box=0.05, cls=0.5, cls_pw=1.0, obj=1.0, obj_pw=1.0, iou_t=0.2, anchor_t=4.0, fl_gamma=0.0, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, degrees=0.0, translate=0.1, scale=0.5, shear=0.0, perspective=0.0, flipud=0.0, fliplr=0.5, mosaic=1.0, mixup=0.0, copy_paste=0.0\r\nWeights & Biases: run 'pip install wandb' to automatically track and visualize YOLOv3  runs (RECOMMENDED)\r\nTensorBoard: Start with 'tensorboard --logdir runs\\train', view at http://localhost:6006/\r\n\r\n                 from  n    params  module                                  arguments\r\n  0                -1  1       928  models.common.Conv                      [3, 32, 3, 1]\r\n  1                -1  1     18560  models.common.Conv                      [32, 64, 3, 2]\r\n  2                -1  1     20672  models.common.Bottleneck                [64, 64]\r\n  3                -1  1     73984  models.common.Conv                      [64, 128, 3, 2]\r\n  4                -1  2    164608  models.common.Bottleneck                [128, 128]\r\n  5                -1  1    295424  models.common.Conv                      [128, 256, 3, 2]\r\n  6                -1  8   2627584  models.common.Bottleneck                [256, 256]\r\n  7                -1  1   1180672  models.common.Conv                      [256, 512, 3, 2]\r\n  8                -1  8  10498048  models.common.Bottleneck                [512, 512]\r\n  9                -1  1   4720640  models.common.Conv                      [512, 1024, 3, 2]\r\n 10                -1  4  20983808  models.common.Bottleneck                [1024, 1024]\r\n 11                -1  1   5245952  models.common.Bottleneck                [1024, 1024, False]\r\n 12                -1  1    525312  models.common.Conv                      [1024, 512, 1, 1]\r\n 13                -1  1   4720640  models.common.Conv                      [512, 1024, 3, 1]\r\n 14                -1  1    525312  models.common.Conv                      [1024, 512, 1, 1]\r\n 15                -1  1   4720640  models.common.Conv                      [512, 1024, 3, 1]\r\n 16                -2  1    131584  models.common.Conv                      [512, 256, 1, 1]\r\n 17                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']\r\n 18           [-1, 8]  1         0  models.common.Concat                    [1]\r\n 19                -1  1   1377792  models.common.Bottleneck                [768, 512, False]\r\n 20                -1  1   1312256  models.common.Bottleneck                [512, 512, False]\r\n 21                -1  1    131584  models.common.Conv                      [512, 256, 1, 1]\r\n 22                -1  1   1180672  models.common.Conv                      [256, 512, 3, 1]\r\n 23                -2  1     33024  models.common.Conv                      [256, 128, 1, 1]\r\n 24                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']\r\n 25           [-1, 6]  1         0  models.common.Concat                    [1]\r\n 26                -1  1    344832  models.common.Bottleneck                [384, 256, False]\r\n 27                -1  2    656896  models.common.Bottleneck                [256, 256, False]\r\n 28      [27, 22, 15]  1    457725  models.yolo.Detect                      [80, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [256, 512, 1024]]\r\nModel Summary: 333 layers, 61949149 parameters, 61949149 gradients, 156.3 GFLOPs\r\n\r\nTransferred 439/439 items from yolov3.pt\r\nScaled weight_decay = 0.0005\r\noptimizer: SGD with parameter groups 72 weight, 75 weight (no decay), 75 bias\r\ntrain: Scanning '..\\datasets\\coco128\\labels\\train2017.cache' images and labels... 128 found, 0 missing, 2 empty, 0 corrupted: 100%|██████████████████████████████████████████████████| 128/128 [00:00<?, ?it/s]\r\nval: Scanning '..\\datasets\\coco128\\labels\\train2017.cache' images and labels... 128 found, 0 missing, 2 empty, 0 corrupted: 100%|████████████████████████████████████████████████████| 128/128 [00:00<?, ?it/s]\r\nmodule 'signal' has no attribute 'SIGALRM'\r\n\r\nAutoAnchor: 4.27 anchors/target, 0.994 Best Possible Recall (BPR). Current anchors are a good fit to dataset\r\nImage sizes 640 train, 640 val\r\nUsing 1 dataloader workers\r\nLogging results to runs\\train\\exp15\r\nStarting training for 5 epochs...\r\n\r\n     Epoch   gpu_mem       box       obj       cls    labels  img_size\r\n       0/4     1.72G   0.02951   0.02213   0.02484        12       640:   0%|          | 0/64 [00:05<?, ?it/s]                                                                                                  \r\nTraceback (most recent call last):\r\n  File \"train.py\", line 625, in <module>\r\n    main(opt)\r\n  File \"train.py\", line 522, in main\r\n    train(opt.hyp, opt, device, callbacks)\r\n  File \"train.py\", line 343, in train\r\n    callbacks.run('on_train_batch_end', ni, model, imgs, targets, paths, plots, opt.sync_bn)\r\n  File \"D:\\WorkData\\DeepLearning\\yolov3\\utils\\callbacks.py\", line 76, in run\r\n    logger['callback'](*args, **kwargs)\r\n  File \"D:\\WorkData\\DeepLearning\\yolov3\\utils\\loggers\\__init__.py\", line 86, in on_train_batch_end\r\n    self.tb.add_graph(torch.jit.trace(de_parallel(model), imgs[0:1], strict=False), [])\r\n  File \"D:\\WorkSoftware\\Anaconda3\\envs\\yolov5\\lib\\site-packages\\torch\\jit\\_trace.py\", line 750, in trace\r\n    _module_class,\r\n  File \"D:\\WorkSoftware\\Anaconda3\\envs\\yolov5\\lib\\site-packages\\torch\\jit\\_trace.py\", line 965, in trace_module\r\n    argument_names,\r\n  File \"D:\\WorkSoftware\\Anaconda3\\envs\\yolov5\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 1102, in _call_impl\r\n    return forward_call(*input, **kwargs)\r\n  File \"D:\\WorkSoftware\\Anaconda3\\envs\\yolov5\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 1090, in _slow_forward\r\n    result = self.forward(*input, **kwargs)\r\n  File \"D:\\WorkData\\DeepLearning\\yolov3\\models\\yolo.py\", line 127, in forward\r\n    return self._forward_once(x, profile, visualize)  # single-scale inference, train\r\n    return x + self.cv2(self.cv1(x)) if self.add else self.cv2(self.cv1(x))\r\n  File \"D:\\WorkSoftware\\Anaconda3\\envs\\yolov5\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 1102, in _call_impl\r\n    return forward_call(*input, **kwargs)\r\n  File \"D:\\WorkSoftware\\Anaconda3\\envs\\yolov5\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 1090, in _slow_forward\r\n    result = self.forward(*input, **kwargs)\r\n  File \"D:\\WorkData\\DeepLearning\\yolov3\\models\\common.py\", line 45, in forward\r\n    return self.act(self.bn(self.conv(x)))\r\n  File \"D:\\WorkSoftware\\Anaconda3\\envs\\yolov5\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 1102, in _call_impl\r\n    return forward_call(*input, **kwargs)\r\n  File \"D:\\WorkSoftware\\Anaconda3\\envs\\yolov5\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 1090, in _slow_forward\r\n    result = self.forward(*input, **kwargs)\r\n  File \"D:\\WorkSoftware\\Anaconda3\\envs\\yolov5\\lib\\site-packages\\torch\\nn\\modules\\conv.py\", line 446, in forward\r\n    return self._conv_forward(input, self.weight, self.bias)\r\n  File \"D:\\WorkSoftware\\Anaconda3\\envs\\yolov5\\lib\\site-packages\\torch\\nn\\modules\\conv.py\", line 443, in _conv_forward\r\n    self.padding, self.dilation, self.groups)\r\nRuntimeError: Unable to find a valid cuDNN algorithm to run convolution`","closed_by":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1934/timeline","performed_via_github_app":null,"state_reason":"completed"}