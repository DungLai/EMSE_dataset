{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/782","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/782/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/782/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/782/events","html_url":"https://github.com/ultralytics/yolov3/issues/782","id":550607270,"node_id":"MDU6SXNzdWU1NTA2MDcyNzA=","number":782,"title":"Segmentation fault (core dumped) on TensorRT","user":{"login":"cloudrivers","id":24874934,"node_id":"MDQ6VXNlcjI0ODc0OTM0","avatar_url":"https://avatars.githubusercontent.com/u/24874934?v=4","gravatar_id":"","url":"https://api.github.com/users/cloudrivers","html_url":"https://github.com/cloudrivers","followers_url":"https://api.github.com/users/cloudrivers/followers","following_url":"https://api.github.com/users/cloudrivers/following{/other_user}","gists_url":"https://api.github.com/users/cloudrivers/gists{/gist_id}","starred_url":"https://api.github.com/users/cloudrivers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloudrivers/subscriptions","organizations_url":"https://api.github.com/users/cloudrivers/orgs","repos_url":"https://api.github.com/users/cloudrivers/repos","events_url":"https://api.github.com/users/cloudrivers/events{/privacy}","received_events_url":"https://api.github.com/users/cloudrivers/received_events","type":"User","site_admin":false},"labels":[{"id":1035696370,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzcw","url":"https://api.github.com/repos/ultralytics/yolov3/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-01-16T06:44:01Z","updated_at":"2020-01-16T18:11:42Z","closed_at":"2020-01-16T18:11:42Z","author_association":"NONE","active_lock_reason":null,"body":"## üêõ Bug\r\n\r\n  Export model as onnx and load this model in tensorrt. meet an error 'Segmentation fault (core dumped)'\r\n\r\n## To Reproduce\r\nSteps to reproduce the behavior:\r\n1. change ONNX_EXPORT = True in model.py\r\n2. load the onnx model in tensorrt. code is as below\r\nimport os\r\nimport sys\r\nimport cv2\r\nimport time\r\nimport numpy as np\r\nimport pycuda.autoinit\r\nimport pycuda.driver as cuda\r\nimport tensorrt as trt\r\nfrom PIL import Image\r\n\r\ndef ONNX_build_engine(onnx_file_path):\r\n        G_LOGGER = trt.Logger(trt.Logger.WARNING)\r\n        EXPLICIT_BATCH = 1 << (int)(trt.NetworkDefinitionCreationFlag.EXPLICIT_BATCH)\r\n        with trt.Builder(G_LOGGER) as builder, builder.create_network(EXPLICIT_BATCH) as network, trt.OnnxParser(network, G_LOGGER) as parser:\r\n            print('1.1--Loading ONNX file from path {}...'.format(onnx_file_path))\r\n        with open(onnx_file_path, 'rb') as model:\r\n            print('1.2--Parsing ONNX model')\r\n            parser.parse(model.read())\r\n            builder.max_batch_size = 100\r\n            builder.max_workspace_size = 1 << 30\r\n            print('1.3--Completed parsing of ONNX model')\r\n        with trt.Builder(TRT_LOGGER) as builder, builder.create_builder_config() as config, builder.build_cuda_engine(network, config) as engine:\r\n            print('1.4--Building an engine from file {}; this may take a while...'.format(onnx_file_path))\r\n            serialized_engine = engine.serialize()\r\n            with trt.Runtime(TRT_LOGGER) as runtime:\r\n                runtime.deserialize_cuda_engine(serialized_engine)\r\n            print(\"1.5--Completed creating Engine\")\r\n            #with open(engine_file_path, \"wb\") as fs:\r\n            #   fs.write(engine.serialize())\r\n            return engine\r\n\r\n## Error\r\n     Segmentation fault (core dumped)\r\n\r\n## Environment\r\n  TensorRT 6.0\r\n\r\n**Desktop (please complete the following information):**\r\n   Jetson nano\r\n\r\n","closed_by":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/782/timeline","performed_via_github_app":null,"state_reason":"completed"}