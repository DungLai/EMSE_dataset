{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/39","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/39/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/39/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/39/events","html_url":"https://github.com/ultralytics/yolov3/issues/39","id":384817287,"node_id":"MDU6SXNzdWUzODQ4MTcyODc=","number":39,"title":"Own dataset doesn't work on latest commit","user":{"login":"RickvanHek","id":11407553,"node_id":"MDQ6VXNlcjExNDA3NTUz","avatar_url":"https://avatars.githubusercontent.com/u/11407553?v=4","gravatar_id":"","url":"https://api.github.com/users/RickvanHek","html_url":"https://github.com/RickvanHek","followers_url":"https://api.github.com/users/RickvanHek/followers","following_url":"https://api.github.com/users/RickvanHek/following{/other_user}","gists_url":"https://api.github.com/users/RickvanHek/gists{/gist_id}","starred_url":"https://api.github.com/users/RickvanHek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RickvanHek/subscriptions","organizations_url":"https://api.github.com/users/RickvanHek/orgs","repos_url":"https://api.github.com/users/RickvanHek/repos","events_url":"https://api.github.com/users/RickvanHek/events{/privacy}","received_events_url":"https://api.github.com/users/RickvanHek/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2018-11-27T14:21:15Z","updated_at":"2018-12-01T13:47:46Z","closed_at":"2018-12-01T13:47:45Z","author_association":"NONE","active_lock_reason":null,"body":"For some reason I can't seem to train my own dataset on the latest commit. I am able to do it from an earlier commit [e.g. this state](https://github.com/ultralytics/yolov3/tree/9dbc3ec1c4ab7b2396742eebf6f9d3f76f5f54d9). In this state if i run my training (with the exact same cfg files, dataset etc), i get these results after a couple epochs:\r\n\r\n```\r\n      Epoch      Batch          x          y          w          h       conf        cls      total          P          R   nTargets         TP         FP         FN       time\r\n       0/99      99/99       1.49       1.47       7.46       12.8        111       7.38        141          0          0          3          0    2.9e+03          0      0.124\r\n       1/99      99/99       1.26       1.19       1.99       3.07       16.1       7.35       30.9          0          0         10          0          1          8      0.131\r\n       2/99      99/99       1.04       1.02      0.831       1.08       4.64       7.25       15.9          0          0          7          0          3          4      0.129\r\n       3/99      99/99      0.756      0.796      0.666       0.79       3.67       7.25       13.9   0.000769    0.00187         10          0          2          7      0.129\r\n       4/99      99/99       0.58      0.683      0.574      0.739       2.93       7.15       12.7    0.00314     0.0167          3          0          3          1      0.129\r\n       5/99      99/99      0.455       0.54      0.462       0.64       2.62       7.14       11.9    0.00636     0.0221          6          0          6          1      0.132\r\n```\r\n\r\nIf I use the latest commit, i get this:\r\n\r\n```\r\n      Epoch      Batch          x          y          w          h       conf        cls      total          P          R   nTargets         TP         FP         FN       time\r\n       0/99      99/99       1.49       1.47       7.41       12.6        111       7.38        141          0          0          3          0          0          0      0.117\r\n       1/99      99/99       4.91       4.93        nan        nan        nan        nan        nan          0          0         10          0          0          0      0.125\r\n       2/99      99/99       5.52       5.24        nan        nan        nan        nan        nan          0          0          7          0          0          0      0.124\r\n       3/99      99/99       5.23       5.21        nan        nan        nan        nan        nan          0          0         10          0          0          0      0.129\r\n       4/99      99/99       5.35       5.17        nan        nan        nan        nan        nan          0          0          3          0          0          0      0.125\r\n       5/99      99/99       5.65       5.41        nan        nan        nan        nan        nan          0          0          6          0          0          0      0.124\r\n       6/99      99/99       5.13       5.13        nan        nan        nan        nan        nan          0          0          9          0          0          0      0.126\r\n```\r\n\r\nAlso in the latest commit, [line 197 of train.py](https://github.com/ultralytics/yolov3/blob/ab9ee6aa9ad0919761e6e0003b908a3b41218440/train.py#L197) causes the following error:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/rick/Documents/yolov3-master/train.py\", line 208, in <module>\r\n    main(opt)\r\n  File \"/home/rick/Documents/yolov3-master/train.py\", line 195, in main\r\n    mAP, R, P = test.main(test.opt)\r\n  File \"/home/rick/Documents/yolov3-master/test.py\", line 42, in main\r\n    model.load_state_dict(checkpoint['model'])\r\n  File \"/media/rick/HDD/Env/yolov3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 719, in load_state_dict\r\n    self.__class__.__name__, \"\\n\\t\".join(error_msgs)))\r\nRuntimeError: Error(s) in loading state_dict for Darknet:\r\n\tsize mismatch for module_list.81.conv_81.weight: copying a param of torch.Size([255, 1024, 1, 1]) from checkpoint, where the shape is torch.Size([303, 1024, 1, 1]) in current model.\r\n\tsize mismatch for module_list.81.conv_81.bias: copying a param of torch.Size([255]) from checkpoint, where the shape is torch.Size([303]) in current model.\r\n\tsize mismatch for module_list.93.conv_93.weight: copying a param of torch.Size([255, 512, 1, 1]) from checkpoint, where the shape is torch.Size([303, 512, 1, 1]) in current model.\r\n\tsize mismatch for module_list.93.conv_93.bias: copying a param of torch.Size([255]) from checkpoint, where the shape is torch.Size([303]) in current model.\r\n\tsize mismatch for module_list.105.conv_105.weight: copying a param of torch.Size([255, 256, 1, 1]) from checkpoint, where the shape is torch.Size([303, 256, 1, 1]) in current model.\r\n\tsize mismatch for module_list.105.conv_105.bias: copying a param of torch.Size([255]) from checkpoint, where the shape is torch.Size([303]) in current model.\r\n```\r\n\r\nSo I replaced it with (the old) code:\r\n\r\n```\r\n        with open('results.txt', 'a') as file:\r\n            file.write(s + '\\n')\r\n```\r\nI don't know if this is normal but i can't seem to find a solution.\r\nDo you know why i get nan whilst using the exact same cfg files and data? My txt files for each image is spot on, the bounding boxes, width, height etc are all relative to the image width and height.","closed_by":{"login":"RickvanHek","id":11407553,"node_id":"MDQ6VXNlcjExNDA3NTUz","avatar_url":"https://avatars.githubusercontent.com/u/11407553?v=4","gravatar_id":"","url":"https://api.github.com/users/RickvanHek","html_url":"https://github.com/RickvanHek","followers_url":"https://api.github.com/users/RickvanHek/followers","following_url":"https://api.github.com/users/RickvanHek/following{/other_user}","gists_url":"https://api.github.com/users/RickvanHek/gists{/gist_id}","starred_url":"https://api.github.com/users/RickvanHek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RickvanHek/subscriptions","organizations_url":"https://api.github.com/users/RickvanHek/orgs","repos_url":"https://api.github.com/users/RickvanHek/repos","events_url":"https://api.github.com/users/RickvanHek/events{/privacy}","received_events_url":"https://api.github.com/users/RickvanHek/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/39/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/39/timeline","performed_via_github_app":null,"state_reason":"completed"}