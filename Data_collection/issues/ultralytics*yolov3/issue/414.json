{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/414","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/414/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/414/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/414/events","html_url":"https://github.com/ultralytics/yolov3/issues/414","id":475747883,"node_id":"MDU6SXNzdWU0NzU3NDc4ODM=","number":414,"title":"test.py error upon 'negative examples' (completely empty batches)","user":{"login":"bigrobinson","id":42244176,"node_id":"MDQ6VXNlcjQyMjQ0MTc2","avatar_url":"https://avatars.githubusercontent.com/u/42244176?v=4","gravatar_id":"","url":"https://api.github.com/users/bigrobinson","html_url":"https://github.com/bigrobinson","followers_url":"https://api.github.com/users/bigrobinson/followers","following_url":"https://api.github.com/users/bigrobinson/following{/other_user}","gists_url":"https://api.github.com/users/bigrobinson/gists{/gist_id}","starred_url":"https://api.github.com/users/bigrobinson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bigrobinson/subscriptions","organizations_url":"https://api.github.com/users/bigrobinson/orgs","repos_url":"https://api.github.com/users/bigrobinson/repos","events_url":"https://api.github.com/users/bigrobinson/events{/privacy}","received_events_url":"https://api.github.com/users/bigrobinson/received_events","type":"User","site_admin":false},"labels":[{"id":1035696370,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzcw","url":"https://api.github.com/repos/ultralytics/yolov3/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"assignees":[{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2019-08-01T15:27:20Z","updated_at":"2019-09-26T11:06:37Z","closed_at":"2019-09-26T11:06:27Z","author_association":"NONE","active_lock_reason":null,"body":"**Description of the bug**\r\nI have four classes along with negative examples, with training set about evenly split with 4000 images total, and test block also evenly split with about 500 images.  (Train/test/validation split is 80/10/10 all cases.) If I exclude negative examples, it trains just fine and will calculate mAP in every epoch. When I include the negative examples, it trains but it will not calculate mAP without giving the error below:\r\n\r\n**Screen output**\r\n```bash\r\nNamespace(accumulate=2, batch_size=32, bucket='', cfg='/home/brian/yolov3_ultralytics/data/RawTrainingData/yolov3-spp_uxo.cfg', data='/home/brian/yolov3_ultralytics/data/RawTrainingData/Uxo.data', epochs=273, evolve=False, img_size=416, img_weights=False, multi_scale=False, nosave=False, notest=False, num_workers=4, rect=False, resume=False, transfer=False, xywh=False)\r\nUsing CUDA device0 _CudaDeviceProperties(name='GeForce GTX 1080 Ti', total_memory=11175MB)\r\n           device1 _CudaDeviceProperties(name='GeForce GTX 1080', total_memory=8119MB)\r\n\r\nModel Summary: 225 layers, 6.25895e+07 parameters, 6.25895e+07 gradients\r\n\r\n     Epoch   gpu_mem   GIoU/xy        wh       obj       cls     total   targets  img_size\r\n     0/272     2.42G      1.23         0      1.49      17.4      20.1         5       416: 100%|████████████████████████████████████████████████████████████████████████████████| 127/127 [11:59<00:00,  4.17s/it]\r\nReading image shapes: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 502/502 [00:07<00:00, 65.69it/s]\r\n                         Class    Images   Targets         P         R       mAP        F1:  75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [01:20<00:16,  4.03s/it]Traceback (most recent call last):\r\n  File \"/home/brian/anaconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py\", line 511, in _try_get_batch\r\n    data = self.data_queue.get(timeout=timeout)\r\n  File \"/home/brian/anaconda3/lib/python3.7/queue.py\", line 179, in get\r\n    self.not_empty.wait(remaining)\r\n  File \"/home/brian/anaconda3/lib/python3.7/threading.py\", line 300, in wait\r\n    gotit = waiter.acquire(True, timeout)\r\n  File \"/home/brian/anaconda3/lib/python3.7/site-packages/torch/utils/data/_utils/signal_handling.py\", line 63, in handler\r\n    _error_if_any_worker_fails()\r\nRuntimeError: DataLoader worker (pid 18316) is killed by signal: Killed. \r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 362, in <module>\r\n    accumulate=opt.accumulate)\r\n  File \"train.py\", line 288, in train\r\n    conf_thres=0.1)\r\n  File \"/home/brian/yolov3/test.py\", line 61, in test\r\n    for batch_i, (imgs, targets, paths, shapes) in enumerate(tqdm(dataloader, desc=s)):\r\n  File \"/home/brian/anaconda3/lib/python3.7/site-packages/tqdm/_tqdm.py\", line 1005, in __iter__\r\n    for obj in iterable:\r\n  File \"/home/brian/anaconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py\", line 576, in __next__\r\n    idx, batch = self._get_batch()\r\n  File \"/home/brian/anaconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py\", line 543, in _get_batch\r\n    success, data = self._try_get_batch()\r\n  File \"/home/brian/anaconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py\", line 519, in _try_get_batch\r\n    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str))\r\nRuntimeError: DataLoader worker (pid(s) 18316) exited unexpectedly\r\n```\r\n\r\n**Steps to reproduce the behavior:**\r\n1. Divide data into train and test directories and assemble .data text files using custom python module\r\n2. Execute train.py with above switches set from root directory\r\n3. Wait for first epoch to finish and mAP calculation to start\r\n4. See error around time when negative examples are reached (test data does not appear to be shuffled)\r\n\r\n**Expected behavior**\r\nI expect it to train for 272 epochs and track the mAP for each epoch\r\n\r\n**Desktop:**\r\n - OS: Ubuntu\r\n - Version 18.04\r\n","closed_by":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/414/timeline","performed_via_github_app":null,"state_reason":"completed"}