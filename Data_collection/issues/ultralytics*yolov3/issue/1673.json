{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1673","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1673/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1673/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1673/events","html_url":"https://github.com/ultralytics/yolov3/issues/1673","id":793221587,"node_id":"MDU6SXNzdWU3OTMyMjE1ODc=","number":1673,"title":"Anchor Vector Scale Mismatch","user":{"login":"vsuriya93","id":7788805,"node_id":"MDQ6VXNlcjc3ODg4MDU=","avatar_url":"https://avatars.githubusercontent.com/u/7788805?v=4","gravatar_id":"","url":"https://api.github.com/users/vsuriya93","html_url":"https://github.com/vsuriya93","followers_url":"https://api.github.com/users/vsuriya93/followers","following_url":"https://api.github.com/users/vsuriya93/following{/other_user}","gists_url":"https://api.github.com/users/vsuriya93/gists{/gist_id}","starred_url":"https://api.github.com/users/vsuriya93/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vsuriya93/subscriptions","organizations_url":"https://api.github.com/users/vsuriya93/orgs","repos_url":"https://api.github.com/users/vsuriya93/repos","events_url":"https://api.github.com/users/vsuriya93/events{/privacy}","received_events_url":"https://api.github.com/users/vsuriya93/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2021-01-25T09:47:39Z","updated_at":"2021-02-03T09:10:19Z","closed_at":"2021-02-03T09:10:19Z","author_association":"NONE","active_lock_reason":null,"body":"Context - Tiny-Yolo Model computing wh_iou loss (in Yolo v3 implementation) returns empty_lables (targets)\r\n\r\nProblem - While training tiny-yolo model, only the lobj reduces and gIoU and class_loss are always zero. On debugging I found the following to be the problem.\r\n\r\nThe target variables have values (w and h) in the range [0,1] as attached below (after data pre-processing step)\r\n\r\n![Screenshot 2021-01-25 at 5 32 56 PM](https://user-images.githubusercontent.com/7788805/105687423-635de200-5f33-11eb-9833-a365d6efa95c.png)\r\n\r\nwhereas the anchor_wh vector computed from wh_priors (post stride division by 32 ) is shown below (taken from yolov3-tiny.cfg)\r\n\r\n![Screenshot 2021-01-25 at 5 30 21 PM](https://user-images.githubusercontent.com/7788805/105687089-02360e80-5f33-11eb-8374-8ae336af675c.png)\r\n\r\nwhere [16] refers to the index of the yolo_layer in the module_list\r\n\r\nSrc Code - https://github.com/ultralytics/yolov3/blob/98068efebc699e7a652fb495f3e7a23bf296affd/utils/utils.py#L440\r\n\r\nSince these values are in different scales, this results in the wh_Iou value to be very low and hence sets all box to False based on the threshold and hence having no valid labels for training.\r\n\r\nSince all target values are in the range [0,1], should the anchor_wh be normalized as such too?\r\n\r\nPlease help clarify- Thank you for your time.\r\n","closed_by":{"login":"vsuriya93","id":7788805,"node_id":"MDQ6VXNlcjc3ODg4MDU=","avatar_url":"https://avatars.githubusercontent.com/u/7788805?v=4","gravatar_id":"","url":"https://api.github.com/users/vsuriya93","html_url":"https://github.com/vsuriya93","followers_url":"https://api.github.com/users/vsuriya93/followers","following_url":"https://api.github.com/users/vsuriya93/following{/other_user}","gists_url":"https://api.github.com/users/vsuriya93/gists{/gist_id}","starred_url":"https://api.github.com/users/vsuriya93/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vsuriya93/subscriptions","organizations_url":"https://api.github.com/users/vsuriya93/orgs","repos_url":"https://api.github.com/users/vsuriya93/repos","events_url":"https://api.github.com/users/vsuriya93/events{/privacy}","received_events_url":"https://api.github.com/users/vsuriya93/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1673/timeline","performed_via_github_app":null,"state_reason":"completed"}