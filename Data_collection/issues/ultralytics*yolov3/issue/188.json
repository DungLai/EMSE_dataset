{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/188","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/188/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/188/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/188/events","html_url":"https://github.com/ultralytics/yolov3/issues/188","id":428764732,"node_id":"MDU6SXNzdWU0Mjg3NjQ3MzI=","number":188,"title":"Unable to reproduce mAP with yolov3-tiny.weights","user":{"login":"TommoAsh","id":39056439,"node_id":"MDQ6VXNlcjM5MDU2NDM5","avatar_url":"https://avatars.githubusercontent.com/u/39056439?v=4","gravatar_id":"","url":"https://api.github.com/users/TommoAsh","html_url":"https://github.com/TommoAsh","followers_url":"https://api.github.com/users/TommoAsh/followers","following_url":"https://api.github.com/users/TommoAsh/following{/other_user}","gists_url":"https://api.github.com/users/TommoAsh/gists{/gist_id}","starred_url":"https://api.github.com/users/TommoAsh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TommoAsh/subscriptions","organizations_url":"https://api.github.com/users/TommoAsh/orgs","repos_url":"https://api.github.com/users/TommoAsh/repos","events_url":"https://api.github.com/users/TommoAsh/events{/privacy}","received_events_url":"https://api.github.com/users/TommoAsh/received_events","type":"User","site_admin":false},"labels":[{"id":1035696376,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzc2","url":"https://api.github.com/repos/ultralytics/yolov3/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":15,"created_at":"2019-04-03T13:22:07Z","updated_at":"2019-05-07T09:59:43Z","closed_at":"2019-05-07T09:59:43Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nI have tried using test.py to get mAP scores for the yolov3-tiny.weights model, and the score I get is 0.177 - much lower than the 0.331 that is claimed by the original author of yolo for that model.\r\nNote I have not been able to try the full sized (yolov3.weights) model as I haven't yet been able to access a GPU big enough to cope with it yet, so I can't say if there is the same issue with that model or not.\r\n\r\n**To Reproduce**\r\nI used the commit d526ce0d118fcbbfae3e73d9627183b95ceb2b26 (after the mAP updates were merged).\r\nI then followed instructions as in the README, ending with this:\r\n```\r\npython test.py --weights weights/yolov3-tiny.weights --save-json --cfg cfg/yolov3\r\n-tiny.cfg --conf-thres 0.001\r\nNamespace(batch_size=32, cfg='cfg/yolov3-tiny.cfg', conf_thres=0.001, data_cfg='cfg/coco.data', img_size=416, iou_thres=0.\r\n5, nms_thres=0.45, save_json=True, weights='weights/yolov3-tiny.weights')\r\n\r\nFound 3 GPUs\r\nUsing cuda _CudaDeviceProperties(name='GeForce GTX 980', major=5, minor=2, total_memory=4043MB, multi_processor_count=16)\r\n\r\n/usr/local/lib/python3.7/site-packages/torch/nn/parallel/data_parallel.py:25: UserWarning: \r\n    There is an imbalance between your GPUs. You may want to exclude GPU 2 which\r\n    has less than 75% of the memory or cores of GPU 0. You can do so by setting\r\n    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES\r\n    environment variable.\r\n  warnings.warn(imbalance_warn.format(device_ids[min_pos], device_ids[max_pos]))\r\n      Image      Total          P          R        mAP\r\n100%|███████████████████████████████████████████████████████████████████████████████████| 157/157 [13:02<00:00,  4.18s/it]\r\n       5000       5000     0.0168      0.139      0.102       1.22s\r\n\r\nmAP Per Class:\r\n         person: 0.2868\r\n        bicycle: 0.0403\r\n            car: 0.0432\r\n...\r\n     toothbrush: 0.0196\r\nloading annotations into memory...\r\nDone (t=3.41s)\r\ncreating index...\r\nindex created!\r\nLoading and preparing results...\r\nDONE (t=4.16s)\r\ncreating index...\r\nindex created!\r\nRunning per image evaluation...\r\nEvaluate annotation type *bbox*\r\nDONE (t=59.39s).\r\nAccumulating evaluation results...\r\nDONE (t=9.33s).\r\n Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.086\r\n Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.177\r\n Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.078\r\n Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.001\r\n Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.039\r\n Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.243\r\n Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.108\r\n Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.175\r\n Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.192\r\n Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.016\r\n Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.149\r\n Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.405\r\n```\r\n\r\n**Expected behavior**\r\nI was expecting the final mAP to be 0.331 (or similar to it).\r\nI would ideally like to know if this is an error in mAP calculations, an error on my part, or an issue with the tiny model.\r\n\r\n**Desktop (please complete the following information):**\r\nBase Docker image nvidia/cuda:10.1-cudnn7-runtime-ubuntu16.04\r\nWith Python3.7.1 installed.\r\n\r\n**Finally**\r\nThanks for all the good work - it is much appreciated!","closed_by":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/188/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/188/timeline","performed_via_github_app":null,"state_reason":"completed"}