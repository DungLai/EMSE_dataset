{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/537","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/537/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/537/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/537/events","html_url":"https://github.com/ultralytics/yolov3/issues/537","id":503778067,"node_id":"MDU6SXNzdWU1MDM3NzgwNjc=","number":537,"title":"WARNING: non-finite loss, ending training tensor([    nan, 0.53250, 1.26820,     nan], device='cuda:0') on custom data set","user":{"login":"alpizano","id":39110859,"node_id":"MDQ6VXNlcjM5MTEwODU5","avatar_url":"https://avatars.githubusercontent.com/u/39110859?v=4","gravatar_id":"","url":"https://api.github.com/users/alpizano","html_url":"https://github.com/alpizano","followers_url":"https://api.github.com/users/alpizano/followers","following_url":"https://api.github.com/users/alpizano/following{/other_user}","gists_url":"https://api.github.com/users/alpizano/gists{/gist_id}","starred_url":"https://api.github.com/users/alpizano/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpizano/subscriptions","organizations_url":"https://api.github.com/users/alpizano/orgs","repos_url":"https://api.github.com/users/alpizano/repos","events_url":"https://api.github.com/users/alpizano/events{/privacy}","received_events_url":"https://api.github.com/users/alpizano/received_events","type":"User","site_admin":false},"labels":[{"id":1035696370,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzcw","url":"https://api.github.com/repos/ultralytics/yolov3/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2019-10-08T01:48:38Z","updated_at":"2020-10-04T15:18:13Z","closed_at":"2019-10-25T17:18:15Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\n```WARNING: non-finite loss, ending training tensor([    nan, 0.53250, 1.26820,     nan], device='cuda:0') ``` ...error on EPOCH 2/272 while attempting to train my own custom dataset (with 2 classes) using ultralytics and the yolo3.cfg.\r\n\r\nScreen shot: \r\nhttps://gyazo.com/6e7828ef7f0473fd0b955682bc4421b4\r\n\r\nI'm using only 2 custom classes in my roulette.names, which are:\r\n```\r\nBall\r\nZero\r\n```\r\n\r\nroulette.data contains paths:\r\n```\r\nclasses = 2\r\ntrain = data/train.txt\r\nvalid = data/test.txt\r\nnames = data/roulette.names\r\nbackup = backup/roulette3\r\n```\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. I took the yolov3.cfg and renamed it to roulette3.cfg\r\n2. I changed:\r\n- batches = 8 (using anything > 8 batches gave me a memory error on my GTX1060 6GB for some reason)\r\n- subdivisions to 16\r\n- max_batches to 4000\r\n- steps=3200,3600\r\n- classes=2\r\n- filters=21\r\n3. Added 697 images to the ```data/images``` folder and created a ```data/labels``` folder where I placed the corresponding label .txts.\r\n4. The train.txt and test.txt are in the ```data``` directory\r\n5. roulette.names (Ball, Zero) and roulette.data are in the ```data``` directory. \r\n6. I used this command in the Windows 10 x64 command prompt to attempt to train my data before receiving the error:\r\n```python train.py --data data/roulette.data --cfg cfg/roulette3.cfg --batch-size 8```\r\n\r\n**Expected behavior**\r\nI expected to be able to train my data.\r\n\r\n**Screenshots**\r\nScreen shot: \r\nhttps://gyazo.com/6e7828ef7f0473fd0b955682bc4421b4\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows 10 Pro 64 bit\r\n - Version 10..0.18362 Build 18362\r\n- GPU: Gigabyte GTX1060 6GB\r\n\r\n**Smartphone (please complete the following information):**\r\nN/A\r\n\r\n**Additional context**\r\nI'm just trying to train custom data of a roulette wheel and ball, I want to be able to detect the ball and roulette wheel ONLY and I've already annotated my own custom data with those 2 classes. Am I missing something here?\r\n","closed_by":{"login":"glenn-jocher","id":26833433,"node_id":"MDQ6VXNlcjI2ODMzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/26833433?v=4","gravatar_id":"","url":"https://api.github.com/users/glenn-jocher","html_url":"https://github.com/glenn-jocher","followers_url":"https://api.github.com/users/glenn-jocher/followers","following_url":"https://api.github.com/users/glenn-jocher/following{/other_user}","gists_url":"https://api.github.com/users/glenn-jocher/gists{/gist_id}","starred_url":"https://api.github.com/users/glenn-jocher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glenn-jocher/subscriptions","organizations_url":"https://api.github.com/users/glenn-jocher/orgs","repos_url":"https://api.github.com/users/glenn-jocher/repos","events_url":"https://api.github.com/users/glenn-jocher/events{/privacy}","received_events_url":"https://api.github.com/users/glenn-jocher/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/537/timeline","performed_via_github_app":null,"state_reason":"completed"}