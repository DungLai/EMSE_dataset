{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1192","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1192/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1192/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1192/events","html_url":"https://github.com/ultralytics/yolov3/issues/1192","id":620347089,"node_id":"MDU6SXNzdWU2MjAzNDcwODk=","number":1192,"title":"Error running detect.py for the example \"Train Single Class\"","user":{"login":"bhilloul","id":16799336,"node_id":"MDQ6VXNlcjE2Nzk5MzM2","avatar_url":"https://avatars.githubusercontent.com/u/16799336?v=4","gravatar_id":"","url":"https://api.github.com/users/bhilloul","html_url":"https://github.com/bhilloul","followers_url":"https://api.github.com/users/bhilloul/followers","following_url":"https://api.github.com/users/bhilloul/following{/other_user}","gists_url":"https://api.github.com/users/bhilloul/gists{/gist_id}","starred_url":"https://api.github.com/users/bhilloul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhilloul/subscriptions","organizations_url":"https://api.github.com/users/bhilloul/orgs","repos_url":"https://api.github.com/users/bhilloul/repos","events_url":"https://api.github.com/users/bhilloul/events{/privacy}","received_events_url":"https://api.github.com/users/bhilloul/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2020-05-18T16:31:02Z","updated_at":"2020-06-10T17:44:09Z","closed_at":"2020-05-23T06:30:25Z","author_association":"NONE","active_lock_reason":null,"body":"After training for a single class following Train-Single-Class tutorial, I have an error when I run python detect.py --weights weights/last.pt. Do you have any idea how to solve it? Thank you\r\n\r\nNamespace(agnostic_nms=False, augment=False, cfg='./cfg/yolov3-spp.cfg', classes=None, conf_thres=0.3, device='', fourcc='mp4v', half=False, img_size=512, iou_thres=0.6, names='./data/coco.names', output='output', save_txt=False, source='data/samples', view_img=False, weights='weights/last.pt')\r\nUsing CPU\r\n\r\nModel Summary: 225 layers, 6.29987e+07 parameters, 6.29987e+07 gradients\r\nTraceback (most recent call last):\r\n  File \"detect.py\", line 191, in <module>\r\n    detect()\r\n  File \"detect.py\", line 25, in detect\r\n    model.load_state_dict(torch.load(weights, map_location=device)['model'])\r\n  File \"/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py\", line 847, in load_state_dict\r\n    self.__class__.__name__, \"\\n\\t\".join(error_msgs)))\r\nRuntimeError: Error(s) in loading state_dict for Darknet:\r\n\tMissing key(s) in state_dict: \"module_list.1.Conv2d.weight\", \"module_list.1.BatchNorm2d.weight\", \"module_list.1.BatchNorm2d.bias\", \"module_list.1.BatchNorm2d.running_mean\", \"module_list.1.BatchNorm2d.running_var\", \"module_list.3.Conv2d.weight\", \"module_list.3.BatchNorm2d.weight\", \"module_list.3.BatchNorm2d.bias\", \"module_list.3.BatchNorm2d.running_mean\", \"module_list.3.BatchNorm2d.running_var\", \"module_list.5.Conv2d.weight\", \"module_list.5.BatchNorm2d.weight\", \"module_list.5.BatchNorm2d.bias\", \"module_list.5.BatchNorm2d.running_mean\", \"module_list.5.BatchNorm2d.running_var\", \"module_list.7.Conv2d.weight\", \"module_list.7.BatchNorm2d.weight\", \"module_list.7.BatchNorm2d.bias\", \"module_list.7.BatchNorm2d.running_mean\", \"module_list.7.BatchNorm2d.running_var\", \"module_list.9.Conv2d.weight\", \"module_list.9.BatchNorm2d.weight\", \"module_list.9.BatchNorm2d.bias\", \"module_list.9.BatchNorm2d.running_mean\", \"module_list.9.BatchNorm2d.running_var\", \"module_list.16.Conv2d.weight\", \"module_list.16.BatchNorm2d.weight\", \"module_list.16.BatchNorm2d.bias\", \"module_list.16.BatchNorm2d.running_mean\", \"module_list.16.BatchNorm2d.running_var\", \"module_list.17.Conv2d.weight\", \"module_list.17.BatchNorm2d.weight\", \"module_list.17.BatchNorm2d.bias\", \"module_list.17.BatchNorm2d.running_mean\", \"module_list.17.BatchNorm2d.running_var\", \"module_list.19.Conv2d.weight\", \"module_list.19.BatchNorm2d.weight\", \"module_list.19.BatchNorm2d.bias\", \"module_list.19.BatchNorm2d.running_mean\", \"module_list.19.BatchNorm2d.running_var\", \"module_list.20.Conv2d.weight\", \"module_list.20.BatchNorm2d.weight\", \"module_list.20.BatchNorm2d.bias\", \"module_list.20.BatchNorm2d.running_mean\", \"module_list.20.BatchNorm2d.running_var\", \"module_list.22.BatchNorm2d.weight\", \"module_list.22.BatchNorm2d.bias\", \"module_list.22.BatchNorm2d.running_mean\", \"module_list.22.BatchNorm2d.running_var\", \"module_list.23.Conv2d.weight\", \"module_list.23.BatchNorm2d.weight\", \"module_list.23.BatchNorm2d.bias\", \"module_list.23.BatchNorm2d.running_mean\", \"module_list.23.BatchNorm2d.running_var\", \"module_list.26.Conv2d.weight\", \"module_list.26.BatchNorm2d.weight\", \"module_list.26.BatchNorm2d.bias\", \"module_list.26.BatchNorm2d.running_mean\", \"module_list.26.BatchNorm2d.running_var\", \"module_list.29.BatchNorm2d.weight\", \"module_list.29.BatchNorm2d.bias\", \"module_list.29.BatchNorm2d.running_mean\", \"module_list.29.BatchNorm2d.running_var\", \"module_list.31.Conv2d.weight\", \"module_list.31.BatchNorm2d.weight\", \"module_list.31.BatchNorm2d.bias\", \"module_list.31.BatchNorm2d.running_mean\", \"module_list.31.BatchNorm2d.running_var\", \"module_list.32.Conv2d.weight\", \"module_list.32.BatchNorm2d.weight\", \"module_list.32.BatchNorm2d.bias\", \"module_list.32.BatchNorm2d.running_mean\", \"module_list.32.BatchNorm2d.running_var\", \"module_list.34.Conv2d.weight\", \"module_list.34.BatchNorm2d.weight\", \"module_list.34.BatchNorm2d.bias\", \"module_list.34.BatchNorm2d.running_mean\", \"module_list.34.BatchNorm2d.running_var\", \"module_list.35.Conv2d.weight\", \"module_list.35.BatchNorm2d.weight\", \"module_list.35.BatchNorm2d.bias\", \"module_list.35.BatchNorm2d.running_mean\", \"module_list.35.BatchNorm2d.running_var\", \"module_list.37.Conv2d.weight\", \"module_list.37.BatchNorm2d.weight\", \"module_list.37.BatchNorm2d.bias\", \"module_list.37.BatchNorm2d.running_mean\", \"module_list.37.BatchNorm2d.running_var\", \"module_list.38.Conv2d.weight\", \"module_list.38.BatchNorm2d.weight\", \"module_list.38.BatchNorm2d.bias\", \"module_list.38.BatchNorm2d.running_mean\", \"module_list.38.BatchNorm2d.running_var\", \"module_list.39.Conv2d.weight\", \"module_list.39.BatchNorm2d.weight\", \"module_list.39.BatchNorm2d.bias\", \"module_list.39.BatchNorm2d.running_mean\", \"module_list.39.BatchNorm2d.running_var\", \"module_list.41.Conv2d.weight\", \"module_list.41.BatchNorm2d.weight\", \"module_list.41.BatchNorm2d.bias\", \"module_list.41.BatchNorm2d.running_mean\", \"module_list.41.BatchNorm2d.running_var\", \"module_list.42.Conv2d.weight\", \"module_list.42.BatchNorm2d.weight\", \"module_list.42.BatchNorm2d.bias\", \"module_list.42.BatchNorm2d.running_mean\", \"module_list.42.BatchNorm2d.running_var\", \"module_list.44.Conv2d.weight\", \"module_list.44.BatchNorm2d.weight\", \"module_list.44.BatchNorm2d.bias\", \"module_list.44.BatchNorm2d.running_mean\", \"module_list.44.BatchNorm2d.running_var\", \"module_list.45.Conv2d.weight\", \"module_list.45.BatchNorm2d.weight\", \"module_list.45.BatchNorm2d.bias\", \"module_list.45.BatchNorm2d.running_mean\", \"module_list.45.BatchNorm2d.running_var\", \"module_list.47.Conv2d.weight\", \"module_list.47.BatchNorm2d.weight\", \"module_list.47.BatchNorm2d.bias\", \"module_list.47.BatchNorm2d.running_mean\", \"module_list.47.BatchNorm2d.running_var\", \"module_list.48.Conv2d.weight\", \"module_list.48.BatchNorm2d.weight\", \"module_list.48.BatchNorm2d.bias\", \"module_list.48.BatchNorm2d.running_mean\", \"module_list.48.BatchNorm2d.running_var\", \"module_list.50.Conv2d.weight\", \"module_list.50.BatchNorm2d.weight\", \"module_list.50.BatchNorm2d.bias\", \"module_list.50.BatchNorm2d.running_mean\", \"module_list.50.BatchNorm2d.running_var\", \"module_list.51.Conv2d.weight\", \"module_list.51.BatchNorm2d.weight\", \"module_list.51.BatchNorm2d.bias\", \"module_list.51.BatchNorm2d.running_mean\", \"module_list.51.BatchNorm2d.running_var\", \"module_list.53.Conv2d.weight\", \"module_list.53.BatchNorm2d.weight\", \"module_list.53.BatchNorm2d.bias\", \"module_list.53.BatchNorm2d.running_mean\", \"module_list.53.BatchNorm2d.running_var\", \"module_list.54.Conv2d.weight\", \"module_list.54.BatchNorm2d.weight\", \"module_list.54.BatchNorm2d.bias\", \"module_list.54.BatchNorm2d.running_mean\", \"module_list.54.BatchNorm2d.running_var\", \"module_list.56.Conv2d.weight\", \"module_list.56.BatchNorm2d.weight\", \"module_list.56.BatchNorm2d.bias\", \"module_list.56.BatchNorm2d.running_mean\", \"module_list.56.BatchNorm2d.running_var\", \"module_list.57.Conv2d.weight\", \"module_list.57.BatchNorm2d.weight\", \"module_list.57.BatchNorm2d.bias\", \"module_list.57.BatchNorm2d.running_mean\", \"module_list.57.BatchNorm2d.running_var\", \"module_list.59.Conv2d.weight\", \"module_list.59.BatchNorm2d.weight\", \"module_list.59.BatchNorm2d.bias\", \"module_list.59.BatchNorm2d.running_mean\", \"module_list.59.BatchNorm2d.running_var\", \"module_list.60.Conv2d.weight\", \"module_list.60.BatchNorm2d.weight\", \"module_list.60.BatchNorm2d.bias\", \"module_list.60.BatchNorm2d.running_mean\", \"module_list.60.BatchNorm2d.running_var\", \"module_list.62.Conv2d.weight\", \"module_list.62.BatchNorm2d.weight\", \"module_list.62.BatchNorm2d.bias\", \"module_list.62.BatchNorm2d.running_mean\", \"module_list.62.BatchNorm2d.running_var\", \"module_list.63.Conv2d.weight\", \"module_list.63.BatchNorm2d.weight\", \"module_list.63.BatchNorm2d.bias\", \"module_list.63.BatchNorm2d.running_mean\", \"module_list.63.BatchNorm2d.running_var\", \"module_list.64.Conv2d.weight\", \"module_list.64.BatchNorm2d.weight\", \"module_list.64.BatchNorm2d.bias\", \"module_list.64.BatchNorm2d.running_mean\", \"module_list.64.BatchNorm2d.running_var\", \"module_list.66.Conv2d.weight\", \"module_list.66.BatchNorm2d.weight\", \"module_list.66.BatchNorm2d.bias\", \"module_list.66.BatchNorm2d.running_mean\", \"module_list.66.BatchNorm2d.running_var\", \"module_list.67.Conv2d.weight\", \"module_list.67.BatchNorm2d.weight\", \"module_list.67.BatchNorm2d.bias\", \"module_list.67.BatchNorm2d.running_mean\", \"module_list.67.BatchNorm2d.running_var\", \"module_list.69.Conv2d.weight\", \"module_list.69.BatchNorm2d.weight\", \"module_list.69.BatchNorm2d.bias\", \"module_list.69.BatchNorm2d.running_mean\", \"module_list.69.BatchNorm2d.running_var\", \"module_list.70.Conv2d.weight\", \"module_list.70.BatchNorm2d.weight\", \"module_list.70.BatchNorm2d.bias\", \"module_list.70.BatchNorm2d.running_mean\", \"module_list.70.BatchNorm2d.running_var\", \"module_list.72.Conv2d.weight\", \"module_list.72.BatchNorm2d.weight\", \"module_list.72.BatchNorm2d.bias\", \"module_list.72.BatchNorm2d.running_mean\", \"module_list.72.BatchNorm2d.running_var\", \"module_list.73.Conv2d.weight\", \"module_list.73.BatchNorm2d.weight\", \"module_list.73.BatchNorm2d.bias\", \"module_list.73.BatchNorm2d.running_mean\", \"module_list.73.BatchNorm2d.running_var\", \"module_list.75.Conv2d.weight\", \"module_list.75.BatchNorm2d.weight\", \"module_list.75.BatchNorm2d.bias\", \"module_list.75.BatchNorm2d.running_mean\", \"module_list.75.BatchNorm2d.running_var\", \"module_list.76.Conv2d.weight\", \"module_list.76.BatchNorm2d.weight\", \"module_list.76.BatchNorm2d.bias\", \"module_list.76.BatchNorm2d.running_mean\", \"module_list.76.BatchNorm2d.running_var\", \"module_list.77.Conv2d.weight\", \"module_list.77.BatchNorm2d.weight\", \"module_list.77.BatchNorm2d.bias\", \"module_list.77.BatchNorm2d.running_mean\", \"module_list.77.BatchNorm2d.running_var\", \"module_list.84.Conv2d.weight\", \"module_list.84.BatchNorm2d.weight\", \"module_list.84.BatchNorm2d.bias\", \"module_list.84.BatchNorm2d.running_mean\", \"module_list.84.BatchNorm2d.running_var\", \"module_list.85.Conv2d.weight\", \"module_list.85.BatchNorm2d.weight\", \"module_list.85.BatchNorm2d.bias\", \"module_list.85.BatchNorm2d.running_mean\", \"module_list.85.BatchNorm2d.running_var\", \"module_list.86.Conv2d.weight\", \"module_list.86.BatchNorm2d.weight\", \"module_list.86.BatchNorm2d.bias\", \"module_list.86.BatchNorm2d.running_mean\", \"module_list.86.BatchNorm2d.running_var\", \"module_list.87.Conv2d.weight\", \"module_list.87.BatchNorm2d.weight\", \"module_list.87.BatchNorm2d.bias\", \"module_list.87.BatchNorm2d.running_mean\", \"module_list.87.BatchNorm2d.running_var\", \"module_list.88.Conv2d.weight\", \"module_list.88.Conv2d.bias\", \"module_list.91.Conv2d.weight\", \"module_list.91.BatchNorm2d.weight\", \"module_list.91.BatchNorm2d.bias\", \"module_list.91.BatchNorm2d.running_mean\", \"module_list.91.BatchNorm2d.running_var\", \"module_list.94.Conv2d.weight\", \"module_list.94.BatchNorm2d.weight\", \"module_list.94.BatchNorm2d.bias\", \"module_list.94.BatchNorm2d.running_mean\", \"module_list.94.BatchNorm2d.running_var\", \"module_list.95.Conv2d.weight\", \"module_list.95.BatchNorm2d.weight\", \"module_list.95.BatchNorm2d.bias\", \"module_list.95.BatchNorm2d.running_mean\", \"module_list.95.BatchNorm2d.running_var\", \"module_list.96.Conv2d.weight\", \"module_list.96.BatchNorm2d.weight\", \"module_list.96.BatchNorm2d.bias\", \"module_list.96.BatchNorm2d.running_mean\", \"module_list.96.BatchNorm2d.running_var\", \"module_list.97.Conv2d.weight\", \"module_list.97.BatchNorm2d.weight\", \"module_list.97.BatchNorm2d.bias\", \"module_list.97.BatchNorm2d.running_mean\", \"module_list.97.BatchNorm2d.running_var\", \"module_list.98.Conv2d.weight\", \"module_list.98.BatchNorm2d.weight\", \"module_list.98.BatchNorm2d.bias\", \"module_list.98.BatchNorm2d.running_mean\", \"module_list.98.BatchNorm2d.running_var\", \"module_list.99.Conv2d.weight\", \"module_list.99.BatchNorm2d.weight\", \"module_list.99.BatchNorm2d.bias\", \"module_list.99.BatchNorm2d.running_mean\", \"module_list.99.BatchNorm2d.running_var\", \"module_list.100.Conv2d.weight\", \"module_list.100.Conv2d.bias\", \"module_list.103.Conv2d.weight\", \"module_list.103.BatchNorm2d.weight\", \"module_list.103.BatchNorm2d.bias\", \"module_list.103.BatchNorm2d.running_mean\", \"module_list.103.BatchNorm2d.running_var\", \"module_list.106.Conv2d.weight\", \"module_list.106.BatchNorm2d.weight\", \"module_list.106.BatchNorm2d.bias\", \"module_list.106.BatchNorm2d.running_mean\", \"module_list.106.BatchNorm2d.running_var\", \"module_list.107.Conv2d.weight\", \"module_list.107.BatchNorm2d.weight\", \"module_list.107.BatchNorm2d.bias\", \"module_list.107.BatchNorm2d.running_mean\", \"module_list.107.BatchNorm2d.running_var\", \"module_list.108.Conv2d.weight\", \"module_list.108.BatchNorm2d.weight\", \"module_list.108.BatchNorm2d.bias\", \"module_list.108.BatchNorm2d.running_mean\", \"module_list.108.BatchNorm2d.running_var\", \"module_list.109.Conv2d.weight\", \"module_list.109.BatchNorm2d.weight\", \"module_list.109.BatchNorm2d.bias\", \"module_list.109.BatchNorm2d.running_mean\", \"module_list.109.BatchNorm2d.running_var\", \"module_list.110.Conv2d.weight\", \"module_list.110.BatchNorm2d.weight\", \"module_list.110.BatchNorm2d.bias\", \"module_list.110.BatchNorm2d.running_mean\", \"module_list.110.BatchNorm2d.running_var\", \"module_list.111.Conv2d.weight\", \"module_list.111.BatchNorm2d.weight\", \"module_list.111.BatchNorm2d.bias\", \"module_list.111.BatchNorm2d.running_mean\", \"module_list.111.BatchNorm2d.running_var\", \"module_list.112.Conv2d.weight\", \"module_list.112.Conv2d.bias\". \r\n\tUnexpected key(s) in state_dict: \"module_list.4.Conv2d.weight\", \"module_list.4.BatchNorm2d.weight\", \"module_list.4.BatchNorm2d.bias\", \"module_list.4.BatchNorm2d.running_mean\", \"module_list.4.BatchNorm2d.running_var\", \"module_list.4.BatchNorm2d.num_batches_tracked\", \"module_list.8.Conv2d.weight\", \"module_list.8.BatchNorm2d.weight\", \"module_list.8.BatchNorm2d.bias\", \"module_list.8.BatchNorm2d.running_mean\", \"module_list.8.BatchNorm2d.running_var\", \"module_list.8.BatchNorm2d.num_batches_tracked\", \"module_list.15.Conv2d.weight\", \"module_list.15.Conv2d.bias\", \"module_list.18.Conv2d.weight\", \"module_list.18.BatchNorm2d.weight\", \"module_list.18.BatchNorm2d.bias\", \"module_list.18.BatchNorm2d.running_mean\", \"module_list.18.BatchNorm2d.running_var\", \"module_list.18.BatchNorm2d.num_batches_tracked\", \"module_list.21.Conv2d.weight\", \"module_list.21.BatchNorm2d.weight\", \"module_list.21.BatchNorm2d.bias\", \"module_list.21.BatchNorm2d.running_mean\", \"module_list.21.BatchNorm2d.running_var\", \"module_list.21.BatchNorm2d.num_batches_tracked\", \"module_list.22.Conv2d.bias\", \"module_list.29.Conv2d.bias\". \r\n\tsize mismatch for module_list.0.Conv2d.weight: copying a param with shape torch.Size([16, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([32, 3, 3, 3]).\r\n\tsize mismatch for module_list.0.BatchNorm2d.weight: copying a param with shape torch.Size([16]) from checkpoint, the shape in current model is torch.Size([32]).\r\n\t","closed_by":{"login":"bhilloul","id":16799336,"node_id":"MDQ6VXNlcjE2Nzk5MzM2","avatar_url":"https://avatars.githubusercontent.com/u/16799336?v=4","gravatar_id":"","url":"https://api.github.com/users/bhilloul","html_url":"https://github.com/bhilloul","followers_url":"https://api.github.com/users/bhilloul/followers","following_url":"https://api.github.com/users/bhilloul/following{/other_user}","gists_url":"https://api.github.com/users/bhilloul/gists{/gist_id}","starred_url":"https://api.github.com/users/bhilloul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhilloul/subscriptions","organizations_url":"https://api.github.com/users/bhilloul/orgs","repos_url":"https://api.github.com/users/bhilloul/repos","events_url":"https://api.github.com/users/bhilloul/events{/privacy}","received_events_url":"https://api.github.com/users/bhilloul/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1192/timeline","performed_via_github_app":null,"state_reason":"completed"}