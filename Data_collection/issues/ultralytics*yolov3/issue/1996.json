{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1996","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1996/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1996/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1996/events","html_url":"https://github.com/ultralytics/yolov3/issues/1996","id":1491775193,"node_id":"I_kwDOCLZQgM5Y6q7Z","number":1996,"title":"how to load  pretrained weights  on custom data?","user":{"login":"ayingxp","id":11738688,"node_id":"MDQ6VXNlcjExNzM4Njg4","avatar_url":"https://avatars.githubusercontent.com/u/11738688?v=4","gravatar_id":"","url":"https://api.github.com/users/ayingxp","html_url":"https://github.com/ayingxp","followers_url":"https://api.github.com/users/ayingxp/followers","following_url":"https://api.github.com/users/ayingxp/following{/other_user}","gists_url":"https://api.github.com/users/ayingxp/gists{/gist_id}","starred_url":"https://api.github.com/users/ayingxp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayingxp/subscriptions","organizations_url":"https://api.github.com/users/ayingxp/orgs","repos_url":"https://api.github.com/users/ayingxp/repos","events_url":"https://api.github.com/users/ayingxp/events{/privacy}","received_events_url":"https://api.github.com/users/ayingxp/received_events","type":"User","site_admin":false},"labels":[{"id":1035696376,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzc2","url":"https://api.github.com/repos/ultralytics/yolov3/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"},{"id":1890885613,"node_id":"MDU6TGFiZWwxODkwODg1NjEz","url":"https://api.github.com/repos/ultralytics/yolov3/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-12-12T12:34:41Z","updated_at":"2023-01-15T00:14:16Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"### Search before asking\n\n- [X] I have searched the YOLOv3 [issues](https://github.com/ultralytics/yolov3/issues) and [discussions](https://github.com/ultralytics/yolov3/discussions) and found no similar questions.\n\n\n### Question\n\nwaiting for your kindness help!!!\r\n\r\nI load pretrained yolov3 model from torch hub, like below:\r\n\r\nmodel = torch.hub.load('ultralytics/yolov3', 'yolov3')\r\n\r\nAnd I trained the model on my custom data,  I really got the best.pt and last.pt weights file in the folder of  runs/train/exp60/weights.\r\nHowever, when I try to load the model use my own weights files, there is something wrong.\r\nMy code like this:\r\n\r\nimport torch\r\nfrom models import yolo\r\n\r\nmodel = yolo.Model(cfg=\"models/yolov3.yaml\",ch=3, nc=1).to(\"cpu\")\r\nweights_path = r\"F:\\DeepLearning\\yolov3-master\\yolov3-master\\runs\\train\\exp60\\weights\\best.pt\"\r\ncheckpcoint = torch.load(weights_path)\r\nmodel.load_state_dict(checkpoint[\"model\"], strict=False)\r\nmodel.eval()\r\n\r\nThe error informations:\r\n\r\nTraceback (most recent call last):\r\n  File \"f:/DeepLearning/yolov3-master/yolov3-master/peppertest.py\", line 22, in <module>\r\n    model.load_state_dict(checkpoint[\"model\"], strict=False)\r\n  File \"D:\\anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 1379, in load_state_dict\r\n    state_dict = state_dict.copy()\r\n  File \"D:\\anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 1130, in __getattr__\r\n    raise AttributeError(\"'{}' object has no attribute '{}'\".format(\r\nAttributeError: 'Model' object has no attribute 'copy'\n\n### Additional\n\n_No response_","closed_by":null,"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1996/timeline","performed_via_github_app":null,"state_reason":null}