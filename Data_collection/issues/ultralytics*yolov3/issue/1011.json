{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1011","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1011/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1011/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1011/events","html_url":"https://github.com/ultralytics/yolov3/issues/1011","id":593799851,"node_id":"MDU6SXNzdWU1OTM3OTk4NTE=","number":1011,"title":"Question about how does the code ensure \"Each object should match at least one anchor\" in anchor matching mechanism?","user":{"login":"AlphaGoMK","id":24295596,"node_id":"MDQ6VXNlcjI0Mjk1NTk2","avatar_url":"https://avatars.githubusercontent.com/u/24295596?v=4","gravatar_id":"","url":"https://api.github.com/users/AlphaGoMK","html_url":"https://github.com/AlphaGoMK","followers_url":"https://api.github.com/users/AlphaGoMK/followers","following_url":"https://api.github.com/users/AlphaGoMK/following{/other_user}","gists_url":"https://api.github.com/users/AlphaGoMK/gists{/gist_id}","starred_url":"https://api.github.com/users/AlphaGoMK/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlphaGoMK/subscriptions","organizations_url":"https://api.github.com/users/AlphaGoMK/orgs","repos_url":"https://api.github.com/users/AlphaGoMK/repos","events_url":"https://api.github.com/users/AlphaGoMK/events{/privacy}","received_events_url":"https://api.github.com/users/AlphaGoMK/received_events","type":"User","site_admin":false},"labels":[{"id":1890885613,"node_id":"MDU6TGFiZWwxODkwODg1NjEz","url":"https://api.github.com/repos/ultralytics/yolov3/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2020-04-04T11:13:57Z","updated_at":"2020-05-11T00:09:09Z","closed_at":"2020-05-11T00:09:09Z","author_association":"NONE","active_lock_reason":null,"body":"Thanks for your great work!  \r\n  \r\nI'm quite confused about how does the code make sure that each object should assign at least one anchor in yolo anchor-matching mechanism.  \r\n  \r\nFunction `build_targets` in `utils/utils.py`, row [459-473](https://github.com/ultralytics/yolov3/blob/master/utils/utils.py#L459)  \r\n```python\r\nif nt:\r\n            iou = wh_iou(anchor_vec, gwh)  # iou(3,n) = wh_iou(anchor_vec(3,2), gwh(n,2))\r\n\r\n            if use_all_anchors:\r\n                na = anchor_vec.shape[0]  # number of anchors\r\n                a = torch.arange(na).view((-1, 1)).repeat([1, nt]).view(-1)\r\n                t = targets.repeat([na, 1])\r\n                gwh = gwh.repeat([na, 1])\r\n            else:  # use best anchor only\r\n                iou, a = iou.max(0)  # best iou and anchor\r\n\r\n            # reject anchors below iou_thres (OPTIONAL, increases P, lowers R)\r\n            if reject:\r\n                j = iou.view(-1) > model.hyp['iou_t']  # iou threshold hyperparameter\r\n                t, a, gwh = t[j], a[j], gwh[j]\r\n```\r\nWhat if all the anchors should be matched to an object are filtered out in `if reject:` statements? Which means there are not a single anchor matched to that object and may cause the detector could not learn detecting that object.  \r\n  \r\nCould you please give some assistance to figure out this confusion? Thanks in advance!","closed_by":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1011/timeline","performed_via_github_app":null,"state_reason":"completed"}