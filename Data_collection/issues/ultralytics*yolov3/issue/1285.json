{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1285","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1285/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1285/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1285/events","html_url":"https://github.com/ultralytics/yolov3/issues/1285","id":632354046,"node_id":"MDU6SXNzdWU2MzIzNTQwNDY=","number":1285,"title":"No class loss for one-class models","user":{"login":"MauroPfister","id":48028499,"node_id":"MDQ6VXNlcjQ4MDI4NDk5","avatar_url":"https://avatars.githubusercontent.com/u/48028499?v=4","gravatar_id":"","url":"https://api.github.com/users/MauroPfister","html_url":"https://github.com/MauroPfister","followers_url":"https://api.github.com/users/MauroPfister/followers","following_url":"https://api.github.com/users/MauroPfister/following{/other_user}","gists_url":"https://api.github.com/users/MauroPfister/gists{/gist_id}","starred_url":"https://api.github.com/users/MauroPfister/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MauroPfister/subscriptions","organizations_url":"https://api.github.com/users/MauroPfister/orgs","repos_url":"https://api.github.com/users/MauroPfister/repos","events_url":"https://api.github.com/users/MauroPfister/events{/privacy}","received_events_url":"https://api.github.com/users/MauroPfister/received_events","type":"User","site_admin":false},"labels":[{"id":1035696376,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzc2","url":"https://api.github.com/repos/ultralytics/yolov3/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"},{"id":1890885613,"node_id":"MDU6TGFiZWwxODkwODg1NjEz","url":"https://api.github.com/repos/ultralytics/yolov3/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-06-06T10:17:19Z","updated_at":"2020-07-12T00:21:50Z","closed_at":"2020-07-12T00:21:50Z","author_association":"NONE","active_lock_reason":null,"body":"Hi\r\n\r\nI am training on a one-class dataset and noticed that if `model.nc = 1` there is no BCE loss applied for the class prediction:\r\nhttps://github.com/ultralytics/yolov3/blob/82f653b0f579db97f8908800d45e8f5287f79bd3/utils/utils.py#L384-L387\r\n\r\nI think this is not a huge problem because of the \"smart bias initialization\" of the 1x1 convs that predict the bounding boxes:\r\nhttps://github.com/ultralytics/yolov3/blob/82f653b0f579db97f8908800d45e8f5287f79bd3/models.py#L106-L113\r\n\r\nIf I understand correctly, the line `bias[:, 5:] += math.log(0.6 / (modules.nc - 0.99))` comes from the following reasoning (no idea where the `0.6` comes from though):\r\n```\r\nx: output of 1x1 convs, nc: number of classes\r\n\r\nWe want that sigmoid(x) = 0.99 / nc\r\n-> 1 / (1 + exp(-x)) = 0.99 / nc\r\n-> nc / 0.99 = 1 + exp(-x)\r\n-> log( 0.99 / (nc - 0.99) ) = x\r\n```\r\n\r\nHowever, I believe that doing so, you are essentially leaving the weights predicting the class untrained at its random initialization + smart bias for a one-class model? Do you not think that training the prediction of the class as well could could help to reduce some false positives. For example when the objectness score is high for a bounding box that does not contain the one class. In this case, the detector might be able to \"downweight\" the prediction by assigning a low class confidence if the class prediction has been trained as well?\r\n\r\nI know that this is an edge case for one-class models but for the sake of correctness, I still wanted to report it. Please let me know if I overlooked something!\r\n\r\nCheers\r\n","closed_by":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1285/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1285/timeline","performed_via_github_app":null,"state_reason":"completed"}