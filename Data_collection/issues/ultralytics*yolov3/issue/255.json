{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/255","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/255/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/255/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/255/events","html_url":"https://github.com/ultralytics/yolov3/issues/255","id":439899780,"node_id":"MDU6SXNzdWU0Mzk4OTk3ODA=","number":255,"title":"bug of training with \"--evolve\" option (training on a single machine with multi-GPU)","user":{"login":"zhou-ren","id":5122098,"node_id":"MDQ6VXNlcjUxMjIwOTg=","avatar_url":"https://avatars.githubusercontent.com/u/5122098?v=4","gravatar_id":"","url":"https://api.github.com/users/zhou-ren","html_url":"https://github.com/zhou-ren","followers_url":"https://api.github.com/users/zhou-ren/followers","following_url":"https://api.github.com/users/zhou-ren/following{/other_user}","gists_url":"https://api.github.com/users/zhou-ren/gists{/gist_id}","starred_url":"https://api.github.com/users/zhou-ren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhou-ren/subscriptions","organizations_url":"https://api.github.com/users/zhou-ren/orgs","repos_url":"https://api.github.com/users/zhou-ren/repos","events_url":"https://api.github.com/users/zhou-ren/events{/privacy}","received_events_url":"https://api.github.com/users/zhou-ren/received_events","type":"User","site_admin":false},"labels":[{"id":1035696370,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzcw","url":"https://api.github.com/repos/ultralytics/yolov3/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2019-05-03T06:05:13Z","updated_at":"2019-07-25T01:25:54Z","closed_at":"2019-07-25T01:25:54Z","author_association":"NONE","active_lock_reason":null,"body":"**1. Describe the bug**\r\nWhen training on a multi-GPU single machine, e.g., \"python3 train.py --evolve --data data/coco_100img.data  --epochs 3\", it will report error \"**_RuntimeError: trying to initialize the default process group twice!_**\" at the second evolve cycle when initializing the pytorch distributed training.\r\n\r\nI tried to add \"dist.destroy_process_group()\" at the end of the train() function. But it still reports error \"**_RuntimeError: Address already in use_**\".\r\n\r\n\r\n**2. To Reproduce**\r\nSteps to reproduce the behavior:\r\n1). use a multi-gpu single machine\r\n2). run script \"python3 train.py --evolve --data data/coco_100img.data  --epochs 3\"\r\n3). will see the error\r\n\r\n**3. Expected behavior**\r\nIt should clear GPU memory at the end of every distributed training function. When evolving into the next generation (cycle), the dist.init_process_group() should work and start training for the next cycle.\r\n\r\n**4. Desktop (please complete the following information):**\r\n - OS: Ubuntu \r\n - Version 18.04\r\n - PyTorch 1.0.1 (Glenn also noticed this problem in PyTorch 1.1)\r\n - Python 3.7\r\n\r\nThis problem is related to pytorch distributed package but I cannot figure it out. \r\nThank you so much for the help!\r\n","closed_by":{"login":"zhou-ren","id":5122098,"node_id":"MDQ6VXNlcjUxMjIwOTg=","avatar_url":"https://avatars.githubusercontent.com/u/5122098?v=4","gravatar_id":"","url":"https://api.github.com/users/zhou-ren","html_url":"https://github.com/zhou-ren","followers_url":"https://api.github.com/users/zhou-ren/followers","following_url":"https://api.github.com/users/zhou-ren/following{/other_user}","gists_url":"https://api.github.com/users/zhou-ren/gists{/gist_id}","starred_url":"https://api.github.com/users/zhou-ren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhou-ren/subscriptions","organizations_url":"https://api.github.com/users/zhou-ren/orgs","repos_url":"https://api.github.com/users/zhou-ren/repos","events_url":"https://api.github.com/users/zhou-ren/events{/privacy}","received_events_url":"https://api.github.com/users/zhou-ren/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/255/timeline","performed_via_github_app":null,"state_reason":"completed"}