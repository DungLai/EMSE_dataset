{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1190","repository_url":"https://api.github.com/repos/ultralytics/yolov3","labels_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1190/labels{/name}","comments_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1190/comments","events_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1190/events","html_url":"https://github.com/ultralytics/yolov3/issues/1190","id":620243829,"node_id":"MDU6SXNzdWU2MjAyNDM4Mjk=","number":1190,"title":"Can [shotcut] with activation?","user":{"login":"st1312st","id":52808868,"node_id":"MDQ6VXNlcjUyODA4ODY4","avatar_url":"https://avatars.githubusercontent.com/u/52808868?v=4","gravatar_id":"","url":"https://api.github.com/users/st1312st","html_url":"https://github.com/st1312st","followers_url":"https://api.github.com/users/st1312st/followers","following_url":"https://api.github.com/users/st1312st/following{/other_user}","gists_url":"https://api.github.com/users/st1312st/gists{/gist_id}","starred_url":"https://api.github.com/users/st1312st/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/st1312st/subscriptions","organizations_url":"https://api.github.com/users/st1312st/orgs","repos_url":"https://api.github.com/users/st1312st/repos","events_url":"https://api.github.com/users/st1312st/events{/privacy}","received_events_url":"https://api.github.com/users/st1312st/received_events","type":"User","site_admin":false},"labels":[{"id":1035696370,"node_id":"MDU6TGFiZWwxMDM1Njk2Mzcw","url":"https://api.github.com/repos/ultralytics/yolov3/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1890885613,"node_id":"MDU6TGFiZWwxODkwODg1NjEz","url":"https://api.github.com/repos/ultralytics/yolov3/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2020-05-18T14:13:09Z","updated_at":"2020-06-25T00:16:28Z","closed_at":"2020-06-25T00:16:28Z","author_association":"NONE","active_lock_reason":null,"body":"Hello!\r\n\r\nI see [shotcut] have activation in .cfg file,but i can not see shotcut use activation in code.\r\n#######################################\r\nin .cfg\r\n    [shortcut]\r\n    from=-4\r\n    activation=leaky\r\n\r\n\r\n#######################################\r\nin model.py\r\n\r\n    elif mdef['type'] == 'shortcut':  # nn.Sequential() placeholder for 'shortcut' layer\r\n            layers = mdef['from']\r\n            filters = output_filters[-1]\r\n            routs.extend([i + l if l < 0 else l for l in layers])\r\n            modules = WeightedFeatureFusion(layers=layers, weight='weights_type' in mdef)\r\n\r\n#######################################\r\nin utils/layers.py\r\n\r\nclass WeightedFeatureFusion(nn.Module): \r\n    def __init__(self, layers, weight=False):\r\n        super(WeightedFeatureFusion, self).__init__()\r\n        self.layers = layers  # layer indices\r\n        self.weight = weight  # apply weights boolean\r\n        self.n = len(layers) + 1  # number of layers\r\n        if weight:\r\n            self.w = nn.Parameter(torch.zeros(self.n), requires_grad=True)  # layer weights\r\n\r\n    def forward(self, x, outputs):\r\n        # Weights\r\n        if self.weight:\r\n            w = torch.sigmoid(self.w) * (2 / self.n)  # sigmoid weights (0-1)\r\n            x = x * w[0]\r\n\r\n        # Fusion\r\n        nx = x.shape[1]  # input channels\r\n        for i in range(self.n - 1):\r\n            a = outputs[self.layers[i]] * w[i + 1] if self.weight else outputs[self.layers[i]]  # feature to add\r\n            na = a.shape[1]  # feature channels\r\n\r\n            # Adjust channels\r\n            if nx == na:  # same shape\r\n                x = x + a\r\n            elif nx > na:  # slice input\r\n                x[:, :na] = x[:, :na] + a  # or a = nn.ZeroPad2d((0, 0, 0, 0, 0, dc))(a); x = x + a\r\n            else:  # slice feature\r\n                x = x + a[:, :nx]\r\n\r\n        return x\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n########################################\r\n\r\nso can i use [shotcut] with activation?\r\nIf everyone can help me, Thank you!\r\n","closed_by":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ultralytics/yolov3/issues/1190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ultralytics/yolov3/issues/1190/timeline","performed_via_github_app":null,"state_reason":"completed"}