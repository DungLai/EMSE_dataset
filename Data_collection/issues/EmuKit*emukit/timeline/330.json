[{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/727904743","html_url":"https://github.com/EmuKit/emukit/issues/330#issuecomment-727904743","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/330","id":727904743,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzkwNDc0Mw==","user":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false},"created_at":"2020-11-16T10:59:00Z","updated_at":"2020-11-16T10:59:00Z","author_association":"COLLABORATOR","body":"Can you share example code and some plots maybe, to illustrate the issue better? Thanks!","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/727904743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/733538664","html_url":"https://github.com/EmuKit/emukit/issues/330#issuecomment-733538664","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/330","id":733538664,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzUzODY2NA==","user":{"login":"chrisliu2007","id":35850912,"node_id":"MDQ6VXNlcjM1ODUwOTEy","avatar_url":"https://avatars.githubusercontent.com/u/35850912?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisliu2007","html_url":"https://github.com/chrisliu2007","followers_url":"https://api.github.com/users/chrisliu2007/followers","following_url":"https://api.github.com/users/chrisliu2007/following{/other_user}","gists_url":"https://api.github.com/users/chrisliu2007/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisliu2007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisliu2007/subscriptions","organizations_url":"https://api.github.com/users/chrisliu2007/orgs","repos_url":"https://api.github.com/users/chrisliu2007/repos","events_url":"https://api.github.com/users/chrisliu2007/events{/privacy}","received_events_url":"https://api.github.com/users/chrisliu2007/received_events","type":"User","site_admin":false},"created_at":"2020-11-25T08:07:44Z","updated_at":"2020-11-25T08:07:44Z","author_association":"NONE","body":"Yes. Of course. Here are some partial code and the plots. I tested with Branin function \r\n    \r\n    ### Define the objective function\r\n    ### In this case we use the Branin function available in Emukit.\r\n    f, _ = branin_function()\r\n\r\n    ## GP regression\r\n    input_dim = len(X[0])\r\n    ker = GPy.kern.Matern52(input_dim = input_dim, ARD =False)#\r\n    ker.lengthscale.constrain_bounded(1e-2, 100.1)\r\n    ker.variance.constrain_bounded(1e-2, 1000.1)\r\n    #ker += GPy.kern.Bias(input_dim = input_dim)\r\n    model_gpy = GPRegression(X , Y, ker)\r\n    model_gpy.randomize()\r\n    model_gpy.optimize_restarts(num_restarts=20,verbose =False, messages=False)\r\n    objective_model = GPyModelWrapper(model_gpy)\r\n\r\n    ## Upper Confidence Bound (UCB)\r\n    acquisition = NegativeLowerConfidenceBound(objective_model, beta = 1)\r\n    batch = 5\r\n    # Make loop and collect points\r\n    bayesopt_cons = BayesianOptimizationLoop(model=objective_model, \r\n                                             space=parameter_space, \r\n                                             acquisition=acquisition,\r\n                                             batch_size = batch)\r\n    \r\n    X_new = bayesopt_cons.candidate_point_calculator.compute_next_points(bayesopt_cons.loop_state)\r\n\r\nThe acquired next points (green circles) are not at the highest acquisition value. I suspect it is because the NLCB gives negative values to local penalization in batch mode. \r\n![image](https://user-images.githubusercontent.com/35850912/100199165-c8975600-2f37-11eb-971c-8f787dc52f06.png)\r\n\r\nSo, I purposely use Y-350 in the GP regression. Here is what I got. \r\n\r\n![image](https://user-images.githubusercontent.com/35850912/100199556-4f4c3300-2f38-11eb-9392-1476f5fbc3bb.png)\r\n","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/733538664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"chrisliu2007","id":35850912,"node_id":"MDQ6VXNlcjM1ODUwOTEy","avatar_url":"https://avatars.githubusercontent.com/u/35850912?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisliu2007","html_url":"https://github.com/chrisliu2007","followers_url":"https://api.github.com/users/chrisliu2007/followers","following_url":"https://api.github.com/users/chrisliu2007/following{/other_user}","gists_url":"https://api.github.com/users/chrisliu2007/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisliu2007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisliu2007/subscriptions","organizations_url":"https://api.github.com/users/chrisliu2007/orgs","repos_url":"https://api.github.com/users/chrisliu2007/repos","events_url":"https://api.github.com/users/chrisliu2007/events{/privacy}","received_events_url":"https://api.github.com/users/chrisliu2007/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/733690877","html_url":"https://github.com/EmuKit/emukit/issues/330#issuecomment-733690877","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/330","id":733690877,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzY5MDg3Nw==","user":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false},"created_at":"2020-11-25T12:57:54Z","updated_at":"2020-11-25T12:57:54Z","author_association":"COLLABORATOR","body":"I think you are correct, thanks for the update. The reason for this appears to be the fact that when using batch we are applying log transform to the acquisition. See this section for details: https://github.com/EmuKit/emukit/blob/master/emukit/bayesian_optimization/loops/bayesian_optimization_loop.py#L54\r\n\r\nIt is indeed surprising that is still runs. Can you check your console output? It must be full of numpy warnings of taking logs of negatives.\r\n\r\nBy the way of fixing it, we shall absolutely put validation inside the LogAcquisition implementation. Whether its a warning or a straight up exception I am not sure yet. Besides that, there is probably not much we can do really at this point. Essentially the way batch is implemented right now we cannot support it for Negative LCB.","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/733690877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/733709971","html_url":"https://github.com/EmuKit/emukit/issues/330#issuecomment-733709971","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/330","id":733709971,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzcwOTk3MQ==","user":{"login":"chrisliu2007","id":35850912,"node_id":"MDQ6VXNlcjM1ODUwOTEy","avatar_url":"https://avatars.githubusercontent.com/u/35850912?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisliu2007","html_url":"https://github.com/chrisliu2007","followers_url":"https://api.github.com/users/chrisliu2007/followers","following_url":"https://api.github.com/users/chrisliu2007/following{/other_user}","gists_url":"https://api.github.com/users/chrisliu2007/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisliu2007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisliu2007/subscriptions","organizations_url":"https://api.github.com/users/chrisliu2007/orgs","repos_url":"https://api.github.com/users/chrisliu2007/repos","events_url":"https://api.github.com/users/chrisliu2007/events{/privacy}","received_events_url":"https://api.github.com/users/chrisliu2007/received_events","type":"User","site_admin":false},"created_at":"2020-11-25T13:35:23Z","updated_at":"2020-11-25T13:35:23Z","author_association":"NONE","body":"Thank you for the quick reply. I guess the current workaround is to offset the Y value so that it is always negative then, so the acquisition values of NLCB stays positive. \r\n\r\nDo you think something similar to the \"softplus\" transformation in GPyOpt would probabbly work here? https://github.com/SheffieldML/GPyOpt/blob/master/GPyOpt/acquisitions/LP.py\r\n\r\nIf so, I can try to implement that in the local_penalization function. Thanks!","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/733709971/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"chrisliu2007","id":35850912,"node_id":"MDQ6VXNlcjM1ODUwOTEy","avatar_url":"https://avatars.githubusercontent.com/u/35850912?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisliu2007","html_url":"https://github.com/chrisliu2007","followers_url":"https://api.github.com/users/chrisliu2007/followers","following_url":"https://api.github.com/users/chrisliu2007/following{/other_user}","gists_url":"https://api.github.com/users/chrisliu2007/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisliu2007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisliu2007/subscriptions","organizations_url":"https://api.github.com/users/chrisliu2007/orgs","repos_url":"https://api.github.com/users/chrisliu2007/repos","events_url":"https://api.github.com/users/chrisliu2007/events{/privacy}","received_events_url":"https://api.github.com/users/chrisliu2007/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/733722600","html_url":"https://github.com/EmuKit/emukit/issues/330#issuecomment-733722600","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/330","id":733722600,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzcyMjYwMA==","user":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false},"created_at":"2020-11-25T13:58:39Z","updated_at":"2020-11-25T13:58:39Z","author_association":"COLLABORATOR","body":"I don't immediatelly see how something like that would help with negative values of the acquisition. But I might be wrong. Do you have any particular reason to think it would?","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/733722600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/733739488","html_url":"https://github.com/EmuKit/emukit/issues/330#issuecomment-733739488","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/330","id":733739488,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzczOTQ4OA==","user":{"login":"chrisliu2007","id":35850912,"node_id":"MDQ6VXNlcjM1ODUwOTEy","avatar_url":"https://avatars.githubusercontent.com/u/35850912?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisliu2007","html_url":"https://github.com/chrisliu2007","followers_url":"https://api.github.com/users/chrisliu2007/followers","following_url":"https://api.github.com/users/chrisliu2007/following{/other_user}","gists_url":"https://api.github.com/users/chrisliu2007/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisliu2007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisliu2007/subscriptions","organizations_url":"https://api.github.com/users/chrisliu2007/orgs","repos_url":"https://api.github.com/users/chrisliu2007/repos","events_url":"https://api.github.com/users/chrisliu2007/events{/privacy}","received_events_url":"https://api.github.com/users/chrisliu2007/received_events","type":"User","site_admin":false},"created_at":"2020-11-25T14:27:32Z","updated_at":"2020-11-27T02:48:27Z","author_association":"NONE","body":"I only went through the LP.py code in GPyOpt briefly. I could be wrong as well. \r\n\r\nFirst, I want to make sure your comments are on the \"softplus\" transformation in LP.py.\r\n\r\nIf so, I thought the line 81: fval[fval_org<40.] = np.log(np.log1p(np.exp(fval_org[fval_org<40.]))) in LP.py try to convert the negative values to the positive np.log1p(np.exp(NLCB)). \r\n\r\n![image](https://user-images.githubusercontent.com/35850912/100240035-1084a000-2f6d-11eb-86f8-a8d52c73dd87.png)\r\n","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/733739488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"chrisliu2007","id":35850912,"node_id":"MDQ6VXNlcjM1ODUwOTEy","avatar_url":"https://avatars.githubusercontent.com/u/35850912?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisliu2007","html_url":"https://github.com/chrisliu2007","followers_url":"https://api.github.com/users/chrisliu2007/followers","following_url":"https://api.github.com/users/chrisliu2007/following{/other_user}","gists_url":"https://api.github.com/users/chrisliu2007/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisliu2007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisliu2007/subscriptions","organizations_url":"https://api.github.com/users/chrisliu2007/orgs","repos_url":"https://api.github.com/users/chrisliu2007/repos","events_url":"https://api.github.com/users/chrisliu2007/events{/privacy}","received_events_url":"https://api.github.com/users/chrisliu2007/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/734251792","html_url":"https://github.com/EmuKit/emukit/issues/330#issuecomment-734251792","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/330","id":734251792,"node_id":"MDEyOklzc3VlQ29tbWVudDczNDI1MTc5Mg==","user":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false},"created_at":"2020-11-26T11:45:48Z","updated_at":"2020-11-26T11:45:48Z","author_association":"COLLABORATOR","body":"Ah, that makes total sense now, thanks for clarifying. I wonder what is this magic 40 doing in there?\r\n\r\nIs there any point in making this the default behavior of LP, instead of simple log transform we are doing now? The upside is that our batch mode becomes more general, you can use any acquisition, and not just positive valued functions. What are the downsides of it? ","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/734251792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/734627204","html_url":"https://github.com/EmuKit/emukit/issues/330#issuecomment-734627204","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/330","id":734627204,"node_id":"MDEyOklzc3VlQ29tbWVudDczNDYyNzIwNA==","user":{"login":"chrisliu2007","id":35850912,"node_id":"MDQ6VXNlcjM1ODUwOTEy","avatar_url":"https://avatars.githubusercontent.com/u/35850912?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisliu2007","html_url":"https://github.com/chrisliu2007","followers_url":"https://api.github.com/users/chrisliu2007/followers","following_url":"https://api.github.com/users/chrisliu2007/following{/other_user}","gists_url":"https://api.github.com/users/chrisliu2007/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisliu2007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisliu2007/subscriptions","organizations_url":"https://api.github.com/users/chrisliu2007/orgs","repos_url":"https://api.github.com/users/chrisliu2007/repos","events_url":"https://api.github.com/users/chrisliu2007/events{/privacy}","received_events_url":"https://api.github.com/users/chrisliu2007/received_events","type":"User","site_admin":false},"created_at":"2020-11-27T03:30:00Z","updated_at":"2020-11-27T03:30:15Z","author_association":"NONE","body":"ln(1+exp(x)) will almost be equal to x when x is large enough. I guess 40 is picked because it is large enough, and the computation does not need to go through the conversion of exp and log. \r\n\r\nI don't see much of the downside here (at least, I have not realized any at the moment). The only trick here is to convert all the negative values to some value close to zero.\r\n","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/734627204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"chrisliu2007","id":35850912,"node_id":"MDQ6VXNlcjM1ODUwOTEy","avatar_url":"https://avatars.githubusercontent.com/u/35850912?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisliu2007","html_url":"https://github.com/chrisliu2007","followers_url":"https://api.github.com/users/chrisliu2007/followers","following_url":"https://api.github.com/users/chrisliu2007/following{/other_user}","gists_url":"https://api.github.com/users/chrisliu2007/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisliu2007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisliu2007/subscriptions","organizations_url":"https://api.github.com/users/chrisliu2007/orgs","repos_url":"https://api.github.com/users/chrisliu2007/repos","events_url":"https://api.github.com/users/chrisliu2007/events{/privacy}","received_events_url":"https://api.github.com/users/chrisliu2007/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/862155439","html_url":"https://github.com/EmuKit/emukit/issues/330#issuecomment-862155439","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/330","id":862155439,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjE1NTQzOQ==","user":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false},"created_at":"2021-06-16T08:17:45Z","updated_at":"2021-06-16T08:17:45Z","author_association":"COLLABORATOR","body":"Summoning @mmahsereci to this thread. Maren, can you please share your opinion on this idea before we implement it?","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/862155439/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false}},{"id":4896222784,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDg5NjIyMjc4NA==","url":"https://api.github.com/repos/EmuKit/emukit/issues/events/4896222784","actor":{"login":"mmahsereci","id":42842079,"node_id":"MDQ6VXNlcjQyODQyMDc5","avatar_url":"https://avatars.githubusercontent.com/u/42842079?v=4","gravatar_id":"","url":"https://api.github.com/users/mmahsereci","html_url":"https://github.com/mmahsereci","followers_url":"https://api.github.com/users/mmahsereci/followers","following_url":"https://api.github.com/users/mmahsereci/following{/other_user}","gists_url":"https://api.github.com/users/mmahsereci/gists{/gist_id}","starred_url":"https://api.github.com/users/mmahsereci/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmahsereci/subscriptions","organizations_url":"https://api.github.com/users/mmahsereci/orgs","repos_url":"https://api.github.com/users/mmahsereci/repos","events_url":"https://api.github.com/users/mmahsereci/events{/privacy}","received_events_url":"https://api.github.com/users/mmahsereci/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-06-16T08:17:45Z","performed_via_github_app":null},{"id":4896222791,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ4OTYyMjI3OTE=","url":"https://api.github.com/repos/EmuKit/emukit/issues/events/4896222791","actor":{"login":"mmahsereci","id":42842079,"node_id":"MDQ6VXNlcjQyODQyMDc5","avatar_url":"https://avatars.githubusercontent.com/u/42842079?v=4","gravatar_id":"","url":"https://api.github.com/users/mmahsereci","html_url":"https://github.com/mmahsereci","followers_url":"https://api.github.com/users/mmahsereci/followers","following_url":"https://api.github.com/users/mmahsereci/following{/other_user}","gists_url":"https://api.github.com/users/mmahsereci/gists{/gist_id}","starred_url":"https://api.github.com/users/mmahsereci/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmahsereci/subscriptions","organizations_url":"https://api.github.com/users/mmahsereci/orgs","repos_url":"https://api.github.com/users/mmahsereci/repos","events_url":"https://api.github.com/users/mmahsereci/events{/privacy}","received_events_url":"https://api.github.com/users/mmahsereci/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-06-16T08:17:45Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/862531329","html_url":"https://github.com/EmuKit/emukit/issues/330#issuecomment-862531329","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/330","id":862531329,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjUzMTMyOQ==","user":{"login":"mmahsereci","id":42842079,"node_id":"MDQ6VXNlcjQyODQyMDc5","avatar_url":"https://avatars.githubusercontent.com/u/42842079?v=4","gravatar_id":"","url":"https://api.github.com/users/mmahsereci","html_url":"https://github.com/mmahsereci","followers_url":"https://api.github.com/users/mmahsereci/followers","following_url":"https://api.github.com/users/mmahsereci/following{/other_user}","gists_url":"https://api.github.com/users/mmahsereci/gists{/gist_id}","starred_url":"https://api.github.com/users/mmahsereci/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmahsereci/subscriptions","organizations_url":"https://api.github.com/users/mmahsereci/orgs","repos_url":"https://api.github.com/users/mmahsereci/repos","events_url":"https://api.github.com/users/mmahsereci/events{/privacy}","received_events_url":"https://api.github.com/users/mmahsereci/received_events","type":"User","site_admin":false},"created_at":"2021-06-16T16:36:07Z","updated_at":"2021-06-16T16:36:07Z","author_association":"CONTRIBUTOR","body":"Hi, I checked the original [paper](http://proceedings.mlr.press/v51/gonzalez16a.pdf) of LP. I cite from the paragraph below Eq(4):\r\n\r\n\"g : IR → IR+ is a differentiable transformation of α(x) that keeps it strictly positive without changing the location of its extrema. We will use g(z) = z if α(x) is already positive and the soft-plus transformation g(z) = ln(1+e^z) elsewhere.\"\r\n\r\nThis suggestion from the paper is used in GPy I suppose (apart for the magic number 40). I believe the transformation would be applied to the acquisition function only and not to the the penalization term. It would take place probably above line 55 in the BO Loop [here](https://github.com/EmuKit/emukit/blob/main/emukit/bayesian_optimization/loops/bayesian_optimization_loop.py#L55). This is before the log transform is applied to the product of acquisition and LP term.  The log transform of the product happens in 2 places in our code since ln(αp) = ln(α) + ln(p). So we would have ln(softplus(α)) + ln(p) in the end which is I guess what the paper proposes.\r\n\r\nIt should be noted though (not sure if it is stated in the paper) that applying softplus moves the maximizer eventually. Hence probably the magic number 40 as @chrisliu2007 says. The log transform we perform does not move the maximizer as it is applied to the product of acquisition and LP term.\r\n\r\nThis is what I can say from first glance, it looks good to me to do this. We would require sth like `SoftPlusAcquisition` similar to `LogAcquisition` I suppose which is applied before the log transform in the Loop. ","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/862531329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mmahsereci","id":42842079,"node_id":"MDQ6VXNlcjQyODQyMDc5","avatar_url":"https://avatars.githubusercontent.com/u/42842079?v=4","gravatar_id":"","url":"https://api.github.com/users/mmahsereci","html_url":"https://github.com/mmahsereci","followers_url":"https://api.github.com/users/mmahsereci/followers","following_url":"https://api.github.com/users/mmahsereci/following{/other_user}","gists_url":"https://api.github.com/users/mmahsereci/gists{/gist_id}","starred_url":"https://api.github.com/users/mmahsereci/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmahsereci/subscriptions","organizations_url":"https://api.github.com/users/mmahsereci/orgs","repos_url":"https://api.github.com/users/mmahsereci/repos","events_url":"https://api.github.com/users/mmahsereci/events{/privacy}","received_events_url":"https://api.github.com/users/mmahsereci/received_events","type":"User","site_admin":false}},{"id":4899131421,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDg5OTEzMTQyMQ==","url":"https://api.github.com/repos/EmuKit/emukit/issues/events/4899131421","actor":{"login":"chrisliu2007","id":35850912,"node_id":"MDQ6VXNlcjM1ODUwOTEy","avatar_url":"https://avatars.githubusercontent.com/u/35850912?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisliu2007","html_url":"https://github.com/chrisliu2007","followers_url":"https://api.github.com/users/chrisliu2007/followers","following_url":"https://api.github.com/users/chrisliu2007/following{/other_user}","gists_url":"https://api.github.com/users/chrisliu2007/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisliu2007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisliu2007/subscriptions","organizations_url":"https://api.github.com/users/chrisliu2007/orgs","repos_url":"https://api.github.com/users/chrisliu2007/repos","events_url":"https://api.github.com/users/chrisliu2007/events{/privacy}","received_events_url":"https://api.github.com/users/chrisliu2007/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-06-16T16:36:07Z","performed_via_github_app":null},{"id":4899131424,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ4OTkxMzE0MjQ=","url":"https://api.github.com/repos/EmuKit/emukit/issues/events/4899131424","actor":{"login":"chrisliu2007","id":35850912,"node_id":"MDQ6VXNlcjM1ODUwOTEy","avatar_url":"https://avatars.githubusercontent.com/u/35850912?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisliu2007","html_url":"https://github.com/chrisliu2007","followers_url":"https://api.github.com/users/chrisliu2007/followers","following_url":"https://api.github.com/users/chrisliu2007/following{/other_user}","gists_url":"https://api.github.com/users/chrisliu2007/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisliu2007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisliu2007/subscriptions","organizations_url":"https://api.github.com/users/chrisliu2007/orgs","repos_url":"https://api.github.com/users/chrisliu2007/repos","events_url":"https://api.github.com/users/chrisliu2007/events{/privacy}","received_events_url":"https://api.github.com/users/chrisliu2007/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-06-16T16:36:07Z","performed_via_github_app":null}]