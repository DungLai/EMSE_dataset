[{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/965552273","html_url":"https://github.com/EmuKit/emukit/issues/391#issuecomment-965552273","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/391","id":965552273,"node_id":"IC_kwDOCMd54845jSiR","user":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false},"created_at":"2021-11-10T17:06:13Z","updated_at":"2021-11-10T17:06:13Z","author_association":"COLLABORATOR","body":"Hi @AlbanMor and thanks for a great bug report. I was able to easily reproduce it.\r\n\r\nThe core of the issue, as you correctly surmised, is that we apply context to the space, and do the constrained optimization over context free space: [here](https://github.com/EmuKit/emukit/blob/main/emukit/core/optimization/gradient_acquisition_optimizer.py#L76). That puts a lot of implicit assumptions on the constraints about order and usage of variables.\r\n\r\nTo unblock yourself now you can design your constraints to refer to non-context variables only, and design your parameter space so that non-context variables always come before context ones.\r\n\r\nBut a proper fix isn't clear at all to me at the moment. Ideas welcome","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/965552273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false}},{"id":5598654384,"node_id":"MEE_lADOCMd5484-hy8vzwAAAAFNtK-w","url":"https://api.github.com/repos/EmuKit/emukit/issues/events/5598654384","actor":{"login":"AlbanMor","id":86852921,"node_id":"MDQ6VXNlcjg2ODUyOTIx","avatar_url":"https://avatars.githubusercontent.com/u/86852921?v=4","gravatar_id":"","url":"https://api.github.com/users/AlbanMor","html_url":"https://github.com/AlbanMor","followers_url":"https://api.github.com/users/AlbanMor/followers","following_url":"https://api.github.com/users/AlbanMor/following{/other_user}","gists_url":"https://api.github.com/users/AlbanMor/gists{/gist_id}","starred_url":"https://api.github.com/users/AlbanMor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlbanMor/subscriptions","organizations_url":"https://api.github.com/users/AlbanMor/orgs","repos_url":"https://api.github.com/users/AlbanMor/repos","events_url":"https://api.github.com/users/AlbanMor/events{/privacy}","received_events_url":"https://api.github.com/users/AlbanMor/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-11-10T17:06:13Z","performed_via_github_app":null},{"id":5598654392,"node_id":"SE_lADOCMd5484-hy8vzwAAAAFNtK-4","url":"https://api.github.com/repos/EmuKit/emukit/issues/events/5598654392","actor":{"login":"AlbanMor","id":86852921,"node_id":"MDQ6VXNlcjg2ODUyOTIx","avatar_url":"https://avatars.githubusercontent.com/u/86852921?v=4","gravatar_id":"","url":"https://api.github.com/users/AlbanMor","html_url":"https://github.com/AlbanMor","followers_url":"https://api.github.com/users/AlbanMor/followers","following_url":"https://api.github.com/users/AlbanMor/following{/other_user}","gists_url":"https://api.github.com/users/AlbanMor/gists{/gist_id}","starred_url":"https://api.github.com/users/AlbanMor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlbanMor/subscriptions","organizations_url":"https://api.github.com/users/AlbanMor/orgs","repos_url":"https://api.github.com/users/AlbanMor/repos","events_url":"https://api.github.com/users/AlbanMor/events{/privacy}","received_events_url":"https://api.github.com/users/AlbanMor/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-11-10T17:06:13Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/965609206","html_url":"https://github.com/EmuKit/emukit/issues/391#issuecomment-965609206","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/391","id":965609206,"node_id":"IC_kwDOCMd54845jgb2","user":{"login":"ekalosak","id":6068321,"node_id":"MDQ6VXNlcjYwNjgzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/6068321?v=4","gravatar_id":"","url":"https://api.github.com/users/ekalosak","html_url":"https://github.com/ekalosak","followers_url":"https://api.github.com/users/ekalosak/followers","following_url":"https://api.github.com/users/ekalosak/following{/other_user}","gists_url":"https://api.github.com/users/ekalosak/gists{/gist_id}","starred_url":"https://api.github.com/users/ekalosak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ekalosak/subscriptions","organizations_url":"https://api.github.com/users/ekalosak/orgs","repos_url":"https://api.github.com/users/ekalosak/repos","events_url":"https://api.github.com/users/ekalosak/events{/privacy}","received_events_url":"https://api.github.com/users/ekalosak/received_events","type":"User","site_admin":false},"created_at":"2021-11-10T18:11:53Z","updated_at":"2021-11-10T18:11:53Z","author_association":"CONTRIBUTOR","body":"Seems like we could just make the documentation more explicit about the assumptions made here? e.g. \"we have a canonical ordering of variables in the parameter space\" or whatever it shakes out to be.","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/965609206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ekalosak","id":6068321,"node_id":"MDQ6VXNlcjYwNjgzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/6068321?v=4","gravatar_id":"","url":"https://api.github.com/users/ekalosak","html_url":"https://github.com/ekalosak","followers_url":"https://api.github.com/users/ekalosak/followers","following_url":"https://api.github.com/users/ekalosak/following{/other_user}","gists_url":"https://api.github.com/users/ekalosak/gists{/gist_id}","starred_url":"https://api.github.com/users/ekalosak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ekalosak/subscriptions","organizations_url":"https://api.github.com/users/ekalosak/orgs","repos_url":"https://api.github.com/users/ekalosak/repos","events_url":"https://api.github.com/users/ekalosak/events{/privacy}","received_events_url":"https://api.github.com/users/ekalosak/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/965667910","html_url":"https://github.com/EmuKit/emukit/issues/391#issuecomment-965667910","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/391","id":965667910,"node_id":"IC_kwDOCMd54845juxG","user":{"login":"AlbanMor","id":86852921,"node_id":"MDQ6VXNlcjg2ODUyOTIx","avatar_url":"https://avatars.githubusercontent.com/u/86852921?v=4","gravatar_id":"","url":"https://api.github.com/users/AlbanMor","html_url":"https://github.com/AlbanMor","followers_url":"https://api.github.com/users/AlbanMor/followers","following_url":"https://api.github.com/users/AlbanMor/following{/other_user}","gists_url":"https://api.github.com/users/AlbanMor/gists{/gist_id}","starred_url":"https://api.github.com/users/AlbanMor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlbanMor/subscriptions","organizations_url":"https://api.github.com/users/AlbanMor/orgs","repos_url":"https://api.github.com/users/AlbanMor/repos","events_url":"https://api.github.com/users/AlbanMor/events{/privacy}","received_events_url":"https://api.github.com/users/AlbanMor/received_events","type":"User","site_admin":false},"created_at":"2021-11-10T19:25:45Z","updated_at":"2021-11-10T19:25:45Z","author_association":"NONE","body":"> To unblock yourself now you can design your constraints to refer to non-context variables only, and design your parameter space so that non-context variables always come before context ones.\r\n\r\nThank you for the quick reply. A more agile approach on my end might be to take into account the specified context variable in my constraint function. How would i go about to call the context variable in my function? ","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/965667910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AlbanMor","id":86852921,"node_id":"MDQ6VXNlcjg2ODUyOTIx","avatar_url":"https://avatars.githubusercontent.com/u/86852921?v=4","gravatar_id":"","url":"https://api.github.com/users/AlbanMor","html_url":"https://github.com/AlbanMor","followers_url":"https://api.github.com/users/AlbanMor/followers","following_url":"https://api.github.com/users/AlbanMor/following{/other_user}","gists_url":"https://api.github.com/users/AlbanMor/gists{/gist_id}","starred_url":"https://api.github.com/users/AlbanMor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlbanMor/subscriptions","organizations_url":"https://api.github.com/users/AlbanMor/orgs","repos_url":"https://api.github.com/users/AlbanMor/repos","events_url":"https://api.github.com/users/AlbanMor/events{/privacy}","received_events_url":"https://api.github.com/users/AlbanMor/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/966117206","html_url":"https://github.com/EmuKit/emukit/issues/391#issuecomment-966117206","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/391","id":966117206,"node_id":"IC_kwDOCMd54845lcdW","user":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false},"created_at":"2021-11-11T09:10:26Z","updated_at":"2021-11-11T09:10:26Z","author_association":"COLLABORATOR","body":"@AlbanMor that's the thing, context variables aren't available inside constraints at the moment. So the best you can do is to have a global variable that you refer to. In the example:\r\n\r\n```\r\nX2_VALUE = 3\r\n...\r\nconstraint_fcn = lambda x: 10 * (-(x[0] - 3)**2 - (X2_VALUE - 7)**2 + constraint_radius ** 2)\r\n...\r\nbo_loop.get_next_points(results=None,context={'x2': X2_VALUE})`\r\n```\r\n\r\nAdmittedly, that's far from ideal.","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/966117206/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false}},{"id":5602420854,"node_id":"MEE_lADOCMd5484-hy8vzwAAAAFN7ih2","url":"https://api.github.com/repos/EmuKit/emukit/issues/events/5602420854","actor":{"login":"AlbanMor","id":86852921,"node_id":"MDQ6VXNlcjg2ODUyOTIx","avatar_url":"https://avatars.githubusercontent.com/u/86852921?v=4","gravatar_id":"","url":"https://api.github.com/users/AlbanMor","html_url":"https://github.com/AlbanMor","followers_url":"https://api.github.com/users/AlbanMor/followers","following_url":"https://api.github.com/users/AlbanMor/following{/other_user}","gists_url":"https://api.github.com/users/AlbanMor/gists{/gist_id}","starred_url":"https://api.github.com/users/AlbanMor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlbanMor/subscriptions","organizations_url":"https://api.github.com/users/AlbanMor/orgs","repos_url":"https://api.github.com/users/AlbanMor/repos","events_url":"https://api.github.com/users/AlbanMor/events{/privacy}","received_events_url":"https://api.github.com/users/AlbanMor/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-11-11T09:10:26Z","performed_via_github_app":null},{"id":5602420865,"node_id":"SE_lADOCMd5484-hy8vzwAAAAFN7iiB","url":"https://api.github.com/repos/EmuKit/emukit/issues/events/5602420865","actor":{"login":"AlbanMor","id":86852921,"node_id":"MDQ6VXNlcjg2ODUyOTIx","avatar_url":"https://avatars.githubusercontent.com/u/86852921?v=4","gravatar_id":"","url":"https://api.github.com/users/AlbanMor","html_url":"https://github.com/AlbanMor","followers_url":"https://api.github.com/users/AlbanMor/followers","following_url":"https://api.github.com/users/AlbanMor/following{/other_user}","gists_url":"https://api.github.com/users/AlbanMor/gists{/gist_id}","starred_url":"https://api.github.com/users/AlbanMor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlbanMor/subscriptions","organizations_url":"https://api.github.com/users/AlbanMor/orgs","repos_url":"https://api.github.com/users/AlbanMor/repos","events_url":"https://api.github.com/users/AlbanMor/events{/privacy}","received_events_url":"https://api.github.com/users/AlbanMor/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-11-11T09:10:26Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/966121882","html_url":"https://github.com/EmuKit/emukit/issues/391#issuecomment-966121882","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/391","id":966121882,"node_id":"IC_kwDOCMd54845ldma","user":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false},"created_at":"2021-11-11T09:12:55Z","updated_at":"2021-11-11T09:12:55Z","author_association":"COLLABORATOR","body":"@ekalosak that is a possibility, but I'd rather explore ways to solve it first. We just need to find a good way of passing full variables in constraints instead of a context-free ones. It is probably not too hard, and I think can be done by context manager.","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/966121882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false}},{"id":5602434049,"node_id":"MEE_lADOCMd5484-hy8vzwAAAAFN7lwB","url":"https://api.github.com/repos/EmuKit/emukit/issues/events/5602434049","actor":{"login":"ekalosak","id":6068321,"node_id":"MDQ6VXNlcjYwNjgzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/6068321?v=4","gravatar_id":"","url":"https://api.github.com/users/ekalosak","html_url":"https://github.com/ekalosak","followers_url":"https://api.github.com/users/ekalosak/followers","following_url":"https://api.github.com/users/ekalosak/following{/other_user}","gists_url":"https://api.github.com/users/ekalosak/gists{/gist_id}","starred_url":"https://api.github.com/users/ekalosak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ekalosak/subscriptions","organizations_url":"https://api.github.com/users/ekalosak/orgs","repos_url":"https://api.github.com/users/ekalosak/repos","events_url":"https://api.github.com/users/ekalosak/events{/privacy}","received_events_url":"https://api.github.com/users/ekalosak/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-11-11T09:12:55Z","performed_via_github_app":null},{"id":5602434052,"node_id":"SE_lADOCMd5484-hy8vzwAAAAFN7lwE","url":"https://api.github.com/repos/EmuKit/emukit/issues/events/5602434052","actor":{"login":"ekalosak","id":6068321,"node_id":"MDQ6VXNlcjYwNjgzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/6068321?v=4","gravatar_id":"","url":"https://api.github.com/users/ekalosak","html_url":"https://github.com/ekalosak","followers_url":"https://api.github.com/users/ekalosak/followers","following_url":"https://api.github.com/users/ekalosak/following{/other_user}","gists_url":"https://api.github.com/users/ekalosak/gists{/gist_id}","starred_url":"https://api.github.com/users/ekalosak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ekalosak/subscriptions","organizations_url":"https://api.github.com/users/ekalosak/orgs","repos_url":"https://api.github.com/users/ekalosak/repos","events_url":"https://api.github.com/users/ekalosak/events{/privacy}","received_events_url":"https://api.github.com/users/ekalosak/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-11-11T09:12:55Z","performed_via_github_app":null}]