[{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/539518924","html_url":"https://github.com/EmuKit/emukit/issues/248#issuecomment-539518924","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/248","id":539518924,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTUxODkyNA==","user":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false},"created_at":"2019-10-08T13:40:59Z","updated_at":"2019-10-08T13:40:59Z","author_association":"COLLABORATOR","body":"Can you share the code you are trying to run, and full stack trace of the error? Otherwise it would be very difficult to diagnose","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/539518924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"apaleyes","id":2852301,"node_id":"MDQ6VXNlcjI4NTIzMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2852301?v=4","gravatar_id":"","url":"https://api.github.com/users/apaleyes","html_url":"https://github.com/apaleyes","followers_url":"https://api.github.com/users/apaleyes/followers","following_url":"https://api.github.com/users/apaleyes/following{/other_user}","gists_url":"https://api.github.com/users/apaleyes/gists{/gist_id}","starred_url":"https://api.github.com/users/apaleyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apaleyes/subscriptions","organizations_url":"https://api.github.com/users/apaleyes/orgs","repos_url":"https://api.github.com/users/apaleyes/repos","events_url":"https://api.github.com/users/apaleyes/events{/privacy}","received_events_url":"https://api.github.com/users/apaleyes/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/539560329","html_url":"https://github.com/EmuKit/emukit/issues/248#issuecomment-539560329","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/248","id":539560329,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTU2MDMyOQ==","user":{"login":"zhangsiyu1103","id":25301738,"node_id":"MDQ6VXNlcjI1MzAxNzM4","avatar_url":"https://avatars.githubusercontent.com/u/25301738?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangsiyu1103","html_url":"https://github.com/zhangsiyu1103","followers_url":"https://api.github.com/users/zhangsiyu1103/followers","following_url":"https://api.github.com/users/zhangsiyu1103/following{/other_user}","gists_url":"https://api.github.com/users/zhangsiyu1103/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangsiyu1103/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangsiyu1103/subscriptions","organizations_url":"https://api.github.com/users/zhangsiyu1103/orgs","repos_url":"https://api.github.com/users/zhangsiyu1103/repos","events_url":"https://api.github.com/users/zhangsiyu1103/events{/privacy}","received_events_url":"https://api.github.com/users/zhangsiyu1103/received_events","type":"User","site_admin":false},"created_at":"2019-10-08T15:11:07Z","updated_at":"2019-10-08T15:11:07Z","author_association":"NONE","body":"Here is the code.\r\n   \r\n    parameter_space = ParameterSpace([DiscreteParameter('x1',input_data[\"maxtrain\"] ), DiscreteParameter('x2', input_data[\"epochs\"])])\r\n    num_data_points = 8\r\n    design = LatinDesign(parameter_space)\r\n    X = design.get_samples(num_data_points)\r\n    Y = f(X)\r\n    constrains = g(X)\r\n    model_gpy = GPRegression(X,Y)\r\n    model_cons_gpy = GPRegression(X,constrains)\r\n    #the line below is equivalent to exact_feval = true in gpyopt\r\n    model_gpy.Gaussian_noise.constrain_fixed(1e-6, warning=False)\r\n    model_cons_gpy.Gaussian_noise.constrain_fixed(1e-6, warning=False)\r\n    model_gpy.optimize()\r\n    model_cons_gpy.optimize()\r\n    model_emukit = GPyModelWrapper(model_gpy)\r\n    model_cons = GPyModelWrapper(model_cons_gpy)\r\n    \r\n    expected_improvement = ExpectedImprovement(model = model_emukit)\r\n\r\n    bayesopt_loop =UnknownConstraintBayesianOptimizationLoop(\r\n        model_objective = model_emukit,\r\n        model_constraint = model_cons,\r\n        space = parameter_space,\r\n        acquisition = expected_improvement,\r\n        batch_size = 1)\r\n\r\n    print(\"running optimization\")\r\n    bayesopt_loop.run_loop(f, 100)\r\n    result = bayesopt_loop.get_results()\r\n\r\nHere's the full stack trace\r\n\r\nTraceback (most recent call last):\r\n  File \"emukit_test.py\", line 331, in <module>\r\n    main()\r\n  File \"emukit_test.py\", line 50, in main\r\n    x_opt, fx_opt = BayesianOPT(input_data,target_perf,cons_perf,list_knobs,cons)\r\n  File \"emukit_test.py\", line 165, in BayesianOPT\r\n    bayesopt_loop.run_loop(f, 100)\r\n  File \"/h2/szhang/.local/lib/python3.6/site-packages/emukit/core/loop/outer_loop.py\", line 84, in run_loop\r\n    self._update_models()\r\n  File \"/h2/szhang/.local/lib/python3.6/site-packages/emukit/core/loop/outer_loop.py\", line 97, in _update_models\r\n    model_updater.update(self.loop_state)\r\n  File \"/h2/szhang/.local/lib/python3.6/site-packages/emukit/core/loop/model_updaters.py\", line 58, in update\r\n    targets = self.targets_extractor_fcn(loop_state)\r\n  File \"/h2/szhang/.local/lib/python3.6/site-packages/emukit/bayesian_optimization/loops/unknown_constraint_bayesian_optimization_loop.py\", line 53, in <lambda>\r\n    lambda state: state.Y_constraint)\r\n  File \"/h2/szhang/.local/lib/python3.6/site-packages/emukit/core/loop/loop_state.py\", line 61, in __getattr__\r\n    raise ValueError('{} not found in results object'.format(item))\r\nValueError: Y_constraint not found in results object\r\n","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/539560329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zhangsiyu1103","id":25301738,"node_id":"MDQ6VXNlcjI1MzAxNzM4","avatar_url":"https://avatars.githubusercontent.com/u/25301738?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangsiyu1103","html_url":"https://github.com/zhangsiyu1103","followers_url":"https://api.github.com/users/zhangsiyu1103/followers","following_url":"https://api.github.com/users/zhangsiyu1103/following{/other_user}","gists_url":"https://api.github.com/users/zhangsiyu1103/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangsiyu1103/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangsiyu1103/subscriptions","organizations_url":"https://api.github.com/users/zhangsiyu1103/orgs","repos_url":"https://api.github.com/users/zhangsiyu1103/repos","events_url":"https://api.github.com/users/zhangsiyu1103/events{/privacy}","received_events_url":"https://api.github.com/users/zhangsiyu1103/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/540204467","html_url":"https://github.com/EmuKit/emukit/issues/248#issuecomment-540204467","issue_url":"https://api.github.com/repos/EmuKit/emukit/issues/248","id":540204467,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDIwNDQ2Nw==","user":{"login":"zhangsiyu1103","id":25301738,"node_id":"MDQ6VXNlcjI1MzAxNzM4","avatar_url":"https://avatars.githubusercontent.com/u/25301738?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangsiyu1103","html_url":"https://github.com/zhangsiyu1103","followers_url":"https://api.github.com/users/zhangsiyu1103/followers","following_url":"https://api.github.com/users/zhangsiyu1103/following{/other_user}","gists_url":"https://api.github.com/users/zhangsiyu1103/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangsiyu1103/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangsiyu1103/subscriptions","organizations_url":"https://api.github.com/users/zhangsiyu1103/orgs","repos_url":"https://api.github.com/users/zhangsiyu1103/repos","events_url":"https://api.github.com/users/zhangsiyu1103/events{/privacy}","received_events_url":"https://api.github.com/users/zhangsiyu1103/received_events","type":"User","site_admin":false},"created_at":"2019-10-09T21:19:51Z","updated_at":"2019-10-09T21:19:51Z","author_association":"NONE","body":"I realized that the \"Y_constraint not found\" error occurs because after the first optimization run, the results of loop_state does not include the extra_output because there is no extra_output in the run_loop function. Essentially, the reason is that the constraint function is not evaluated in the loop such that the loop_state for constraint is not updated.\r\n\r\nI am trying modify both the update functions in loop_state and the run_loop function in the outer_loop to include the constraint function.","reactions":{"url":"https://api.github.com/repos/EmuKit/emukit/issues/comments/540204467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zhangsiyu1103","id":25301738,"node_id":"MDQ6VXNlcjI1MzAxNzM4","avatar_url":"https://avatars.githubusercontent.com/u/25301738?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangsiyu1103","html_url":"https://github.com/zhangsiyu1103","followers_url":"https://api.github.com/users/zhangsiyu1103/followers","following_url":"https://api.github.com/users/zhangsiyu1103/following{/other_user}","gists_url":"https://api.github.com/users/zhangsiyu1103/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangsiyu1103/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangsiyu1103/subscriptions","organizations_url":"https://api.github.com/users/zhangsiyu1103/orgs","repos_url":"https://api.github.com/users/zhangsiyu1103/repos","events_url":"https://api.github.com/users/zhangsiyu1103/events{/privacy}","received_events_url":"https://api.github.com/users/zhangsiyu1103/received_events","type":"User","site_admin":false}}]