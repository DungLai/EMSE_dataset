{"url":"https://api.github.com/repos/raphaelvallat/entropy/issues/14","repository_url":"https://api.github.com/repos/raphaelvallat/entropy","labels_url":"https://api.github.com/repos/raphaelvallat/entropy/issues/14/labels{/name}","comments_url":"https://api.github.com/repos/raphaelvallat/entropy/issues/14/comments","events_url":"https://api.github.com/repos/raphaelvallat/entropy/issues/14/events","html_url":"https://github.com/raphaelvallat/entropy/issues/14","id":795041149,"node_id":"MDU6SXNzdWU3OTUwNDExNDk=","number":14,"title":"Inaccuracies in LZ complexity estimates","user":{"login":"pranaysy","id":8765418,"node_id":"MDQ6VXNlcjg3NjU0MTg=","avatar_url":"https://avatars.githubusercontent.com/u/8765418?v=4","gravatar_id":"","url":"https://api.github.com/users/pranaysy","html_url":"https://github.com/pranaysy","followers_url":"https://api.github.com/users/pranaysy/followers","following_url":"https://api.github.com/users/pranaysy/following{/other_user}","gists_url":"https://api.github.com/users/pranaysy/gists{/gist_id}","starred_url":"https://api.github.com/users/pranaysy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pranaysy/subscriptions","organizations_url":"https://api.github.com/users/pranaysy/orgs","repos_url":"https://api.github.com/users/pranaysy/repos","events_url":"https://api.github.com/users/pranaysy/events{/privacy}","received_events_url":"https://api.github.com/users/pranaysy/received_events","type":"User","site_admin":false},"labels":[{"id":1092403155,"node_id":"MDU6TGFiZWwxMDkyNDAzMTU1","url":"https://api.github.com/repos/raphaelvallat/entropy/labels/invalid","name":"invalid","color":"e4e669","default":true,"description":"This doesn't seem right"}],"state":"closed","locked":false,"assignee":{"login":"raphaelvallat","id":25703792,"node_id":"MDQ6VXNlcjI1NzAzNzky","avatar_url":"https://avatars.githubusercontent.com/u/25703792?v=4","gravatar_id":"","url":"https://api.github.com/users/raphaelvallat","html_url":"https://github.com/raphaelvallat","followers_url":"https://api.github.com/users/raphaelvallat/followers","following_url":"https://api.github.com/users/raphaelvallat/following{/other_user}","gists_url":"https://api.github.com/users/raphaelvallat/gists{/gist_id}","starred_url":"https://api.github.com/users/raphaelvallat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raphaelvallat/subscriptions","organizations_url":"https://api.github.com/users/raphaelvallat/orgs","repos_url":"https://api.github.com/users/raphaelvallat/repos","events_url":"https://api.github.com/users/raphaelvallat/events{/privacy}","received_events_url":"https://api.github.com/users/raphaelvallat/received_events","type":"User","site_admin":false},"assignees":[{"login":"raphaelvallat","id":25703792,"node_id":"MDQ6VXNlcjI1NzAzNzky","avatar_url":"https://avatars.githubusercontent.com/u/25703792?v=4","gravatar_id":"","url":"https://api.github.com/users/raphaelvallat","html_url":"https://github.com/raphaelvallat","followers_url":"https://api.github.com/users/raphaelvallat/followers","following_url":"https://api.github.com/users/raphaelvallat/following{/other_user}","gists_url":"https://api.github.com/users/raphaelvallat/gists{/gist_id}","starred_url":"https://api.github.com/users/raphaelvallat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raphaelvallat/subscriptions","organizations_url":"https://api.github.com/users/raphaelvallat/orgs","repos_url":"https://api.github.com/users/raphaelvallat/repos","events_url":"https://api.github.com/users/raphaelvallat/events{/privacy}","received_events_url":"https://api.github.com/users/raphaelvallat/received_events","type":"User","site_admin":false}],"milestone":null,"comments":19,"created_at":"2021-01-27T12:02:08Z","updated_at":"2021-03-29T17:53:08Z","closed_at":"2021-03-29T17:53:08Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Hi Raphael!\r\n\r\nI'm a big fan of your work and I am a regular user of your packages `entropy`, `pingouin` as well as `yasa`. These are great contributions, and I thank you for them :)\r\n\r\nI've been relying on your Numba implementation of [`lempel_ziv_complexity`](https://github.com/raphaelvallat/entropy/blob/3bf3b6e937687e77965ecb5bfdc69e2a0f059363/entropy/entropy.py#L485) for various analyses I'm working on. I found myself in need for a faster implementation and comments in your code pointed me to [Naereen's Cython implementation](https://github.com/Naereen/Lempel-Ziv_Complexity/blob/master/src/lempel_ziv_complexity.pyx).\r\n\r\nI briefly compared the timings and accuracy of your Numba version with both the pure Python and Cython versions by Naereen. With string inputs, somehow the Numba version is slower than pure Python, both of which are slower than the Cython version. But more importantly, the estimates are different. The pure Python and Cython versions return the exact same estimates, but the Numba version returns different estimates, which are usually smaller.\r\n\r\nI tried all three methods on `1000` randomly generated strings each for lengths `[10, 100, 1000, 10000]`  Here's a quick visual summary of the timings, raw estimates and differences between the 3. The difference in estimates grows with string length. :(\r\n\r\n![test](https://user-images.githubusercontent.com/8765418/105970531-7ac1da00-60af-11eb-90ee-2aa9d2ddfeb1.png)\r\n\r\nI tried out a few examples by hand too. For example: \r\n - the string `rpfqvnradv` is decomposed by LZ76 to `['r', 'p', 'f', 'q', 'v', 'n', 'ra', 'd']` or `8` unique substrings\r\n   - Both the Cython and pure Python versions return `8`\r\n   - The Numba version returns `9`\r\n - the string `msduldaefd` is decomposed by LZ76 to `['m', 's', 'd', 'u', 'l', 'da', 'e', 'f']` or `8` unique substrings\r\n   - Both the Cython and pure Python versions return `8`\r\n   - The Numba version returns `9`\r\n \r\nI haven't spent any time troubleshooting the Numba code beyond this. If I get time to go through your implementation, I'll see if there's anything I can do to help or address this issue.\r\n\r\n---\r\nHere are versions of packages I've used on Python 3.8.5:\r\n - Numba - 0.51.2\r\n - Numpy - 1.19.2\r\n - EntroPy - 0.1.2\r\n - Cython - 0.29.21\r\n\r\nSystem: 10th Gen Intel Core i5-1035G4 running PopOS 20.10, kernel 5.8; gcc 10.2.0; llvmlite 0.34.0\r\n\r\n","closed_by":{"login":"raphaelvallat","id":25703792,"node_id":"MDQ6VXNlcjI1NzAzNzky","avatar_url":"https://avatars.githubusercontent.com/u/25703792?v=4","gravatar_id":"","url":"https://api.github.com/users/raphaelvallat","html_url":"https://github.com/raphaelvallat","followers_url":"https://api.github.com/users/raphaelvallat/followers","following_url":"https://api.github.com/users/raphaelvallat/following{/other_user}","gists_url":"https://api.github.com/users/raphaelvallat/gists{/gist_id}","starred_url":"https://api.github.com/users/raphaelvallat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raphaelvallat/subscriptions","organizations_url":"https://api.github.com/users/raphaelvallat/orgs","repos_url":"https://api.github.com/users/raphaelvallat/repos","events_url":"https://api.github.com/users/raphaelvallat/events{/privacy}","received_events_url":"https://api.github.com/users/raphaelvallat/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/raphaelvallat/entropy/issues/14/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/raphaelvallat/entropy/issues/14/timeline","performed_via_github_app":null,"state_reason":"completed"}