[{"id":3319986313,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzMxOTk4NjMxMw==","url":"https://api.github.com/repos/raphaelvallat/entropy/issues/events/3319986313","actor":{"login":"DominiqueMakowski","id":8875533,"node_id":"MDQ6VXNlcjg4NzU1MzM=","avatar_url":"https://avatars.githubusercontent.com/u/8875533?v=4","gravatar_id":"","url":"https://api.github.com/users/DominiqueMakowski","html_url":"https://github.com/DominiqueMakowski","followers_url":"https://api.github.com/users/DominiqueMakowski/followers","following_url":"https://api.github.com/users/DominiqueMakowski/following{/other_user}","gists_url":"https://api.github.com/users/DominiqueMakowski/gists{/gist_id}","starred_url":"https://api.github.com/users/DominiqueMakowski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DominiqueMakowski/subscriptions","organizations_url":"https://api.github.com/users/DominiqueMakowski/orgs","repos_url":"https://api.github.com/users/DominiqueMakowski/repos","events_url":"https://api.github.com/users/DominiqueMakowski/events{/privacy}","received_events_url":"https://api.github.com/users/DominiqueMakowski/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-05-10T04:47:40Z","performed_via_github_app":null},{"id":3319986314,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMzMTk5ODYzMTQ=","url":"https://api.github.com/repos/raphaelvallat/entropy/issues/events/3319986314","actor":{"login":"DominiqueMakowski","id":8875533,"node_id":"MDQ6VXNlcjg4NzU1MzM=","avatar_url":"https://avatars.githubusercontent.com/u/8875533?v=4","gravatar_id":"","url":"https://api.github.com/users/DominiqueMakowski","html_url":"https://github.com/DominiqueMakowski","followers_url":"https://api.github.com/users/DominiqueMakowski/followers","following_url":"https://api.github.com/users/DominiqueMakowski/following{/other_user}","gists_url":"https://api.github.com/users/DominiqueMakowski/gists{/gist_id}","starred_url":"https://api.github.com/users/DominiqueMakowski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DominiqueMakowski/subscriptions","organizations_url":"https://api.github.com/users/DominiqueMakowski/orgs","repos_url":"https://api.github.com/users/DominiqueMakowski/repos","events_url":"https://api.github.com/users/DominiqueMakowski/events{/privacy}","received_events_url":"https://api.github.com/users/DominiqueMakowski/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-05-10T04:47:40Z","performed_via_github_app":null},{"id":3319986316,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzMxOTk4NjMxNg==","url":"https://api.github.com/repos/raphaelvallat/entropy/issues/events/3319986316","actor":{"login":"raphaelvallat","id":25703792,"node_id":"MDQ6VXNlcjI1NzAzNzky","avatar_url":"https://avatars.githubusercontent.com/u/25703792?v=4","gravatar_id":"","url":"https://api.github.com/users/raphaelvallat","html_url":"https://github.com/raphaelvallat","followers_url":"https://api.github.com/users/raphaelvallat/followers","following_url":"https://api.github.com/users/raphaelvallat/following{/other_user}","gists_url":"https://api.github.com/users/raphaelvallat/gists{/gist_id}","starred_url":"https://api.github.com/users/raphaelvallat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raphaelvallat/subscriptions","organizations_url":"https://api.github.com/users/raphaelvallat/orgs","repos_url":"https://api.github.com/users/raphaelvallat/repos","events_url":"https://api.github.com/users/raphaelvallat/events{/privacy}","received_events_url":"https://api.github.com/users/raphaelvallat/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-05-10T04:47:41Z","performed_via_github_app":null},{"id":3319986319,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMzMTk5ODYzMTk=","url":"https://api.github.com/repos/raphaelvallat/entropy/issues/events/3319986319","actor":{"login":"raphaelvallat","id":25703792,"node_id":"MDQ6VXNlcjI1NzAzNzky","avatar_url":"https://avatars.githubusercontent.com/u/25703792?v=4","gravatar_id":"","url":"https://api.github.com/users/raphaelvallat","html_url":"https://github.com/raphaelvallat","followers_url":"https://api.github.com/users/raphaelvallat/followers","following_url":"https://api.github.com/users/raphaelvallat/following{/other_user}","gists_url":"https://api.github.com/users/raphaelvallat/gists{/gist_id}","starred_url":"https://api.github.com/users/raphaelvallat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raphaelvallat/subscriptions","organizations_url":"https://api.github.com/users/raphaelvallat/orgs","repos_url":"https://api.github.com/users/raphaelvallat/repos","events_url":"https://api.github.com/users/raphaelvallat/events{/privacy}","received_events_url":"https://api.github.com/users/raphaelvallat/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-05-10T04:47:41Z","performed_via_github_app":null},{"id":3319997194,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQzMzE5OTk3MTk0","url":"https://api.github.com/repos/raphaelvallat/entropy/issues/events/3319997194","actor":{"login":"raphaelvallat","id":25703792,"node_id":"MDQ6VXNlcjI1NzAzNzky","avatar_url":"https://avatars.githubusercontent.com/u/25703792?v=4","gravatar_id":"","url":"https://api.github.com/users/raphaelvallat","html_url":"https://github.com/raphaelvallat","followers_url":"https://api.github.com/users/raphaelvallat/followers","following_url":"https://api.github.com/users/raphaelvallat/following{/other_user}","gists_url":"https://api.github.com/users/raphaelvallat/gists{/gist_id}","starred_url":"https://api.github.com/users/raphaelvallat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raphaelvallat/subscriptions","organizations_url":"https://api.github.com/users/raphaelvallat/orgs","repos_url":"https://api.github.com/users/raphaelvallat/repos","events_url":"https://api.github.com/users/raphaelvallat/events{/privacy}","received_events_url":"https://api.github.com/users/raphaelvallat/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2020-05-10T05:12:50Z","assignee":{"login":"raphaelvallat","id":25703792,"node_id":"MDQ6VXNlcjI1NzAzNzky","avatar_url":"https://avatars.githubusercontent.com/u/25703792?v=4","gravatar_id":"","url":"https://api.github.com/users/raphaelvallat","html_url":"https://github.com/raphaelvallat","followers_url":"https://api.github.com/users/raphaelvallat/followers","following_url":"https://api.github.com/users/raphaelvallat/following{/other_user}","gists_url":"https://api.github.com/users/raphaelvallat/gists{/gist_id}","starred_url":"https://api.github.com/users/raphaelvallat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raphaelvallat/subscriptions","organizations_url":"https://api.github.com/users/raphaelvallat/orgs","repos_url":"https://api.github.com/users/raphaelvallat/repos","events_url":"https://api.github.com/users/raphaelvallat/events{/privacy}","received_events_url":"https://api.github.com/users/raphaelvallat/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/raphaelvallat/entropy/issues/comments/626282977","html_url":"https://github.com/raphaelvallat/entropy/issues/5#issuecomment-626282977","issue_url":"https://api.github.com/repos/raphaelvallat/entropy/issues/5","id":626282977,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNjI4Mjk3Nw==","user":{"login":"raphaelvallat","id":25703792,"node_id":"MDQ6VXNlcjI1NzAzNzky","avatar_url":"https://avatars.githubusercontent.com/u/25703792?v=4","gravatar_id":"","url":"https://api.github.com/users/raphaelvallat","html_url":"https://github.com/raphaelvallat","followers_url":"https://api.github.com/users/raphaelvallat/followers","following_url":"https://api.github.com/users/raphaelvallat/following{/other_user}","gists_url":"https://api.github.com/users/raphaelvallat/gists{/gist_id}","starred_url":"https://api.github.com/users/raphaelvallat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raphaelvallat/subscriptions","organizations_url":"https://api.github.com/users/raphaelvallat/orgs","repos_url":"https://api.github.com/users/raphaelvallat/repos","events_url":"https://api.github.com/users/raphaelvallat/events{/privacy}","received_events_url":"https://api.github.com/users/raphaelvallat/received_events","type":"User","site_admin":false},"created_at":"2020-05-10T06:51:22Z","updated_at":"2020-05-10T06:51:22Z","author_association":"OWNER","body":"Hi @Tam-Pham!\r\n\r\nThanks for the feedback and for opening this issue!\r\n\r\nThe implementations of the approximate and sample entropy are simply 1D adaptations of a code from the [MNE-features](https://github.com/mne-tools/mne-features/blob/629dad6345a61769c97a526c3878bd81c4d50ab6/mne_features/univariate.py#L357) package and since I did not write the original code I'm not sure to understand why the last embedded vector is removed here (also, I worked on these functions almost two years ago and I have a very bad memory...ðŸ˜¬).\r\n\r\nI have compared the output of several implementations of the sample entropy in the Jupyter notebook attached. As you can see, the two methods implemented in entropy gives similar results to the [nolds](https://cschoel.github.io/nolds/_modules/nolds/measures.html#sampen) package, but a different output than the example code on [Wikipedia](https://en.wikipedia.org/wiki/Sample_entropy) as well as a Matlab implementation. Even though the differences between implementations are quite small, it is still troublesome and it would be great to understand what causes them. I'll definitely look at that in the next weeks, but please let me know if you make any progress on your side.\r\n\r\nOne other minor issue that can lead to very small differences is whether we use the sample or population standard deviation to define the tolerance, i.e. `r = 0.2 * np.std(x, ddof=0)` or `r = 0.2 * np.std(ddof=1)`, respectively. I have found both implementations, but I'm not sure which one is more valid.\r\n\r\nTake care,\r\nRaphael\r\n\r\n[sampen.zip](https://github.com/raphaelvallat/entropy/files/4605257/sampen.zip)","reactions":{"url":"https://api.github.com/repos/raphaelvallat/entropy/issues/comments/626282977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"raphaelvallat","id":25703792,"node_id":"MDQ6VXNlcjI1NzAzNzky","avatar_url":"https://avatars.githubusercontent.com/u/25703792?v=4","gravatar_id":"","url":"https://api.github.com/users/raphaelvallat","html_url":"https://github.com/raphaelvallat","followers_url":"https://api.github.com/users/raphaelvallat/followers","following_url":"https://api.github.com/users/raphaelvallat/following{/other_user}","gists_url":"https://api.github.com/users/raphaelvallat/gists{/gist_id}","starred_url":"https://api.github.com/users/raphaelvallat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raphaelvallat/subscriptions","organizations_url":"https://api.github.com/users/raphaelvallat/orgs","repos_url":"https://api.github.com/users/raphaelvallat/repos","events_url":"https://api.github.com/users/raphaelvallat/events{/privacy}","received_events_url":"https://api.github.com/users/raphaelvallat/received_events","type":"User","site_admin":false}},{"id":3320048249,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzMyMDA0ODI0OQ==","url":"https://api.github.com/repos/raphaelvallat/entropy/issues/events/3320048249","actor":{"login":"Tam-Pham","id":47100701,"node_id":"MDQ6VXNlcjQ3MTAwNzAx","avatar_url":"https://avatars.githubusercontent.com/u/47100701?v=4","gravatar_id":"","url":"https://api.github.com/users/Tam-Pham","html_url":"https://github.com/Tam-Pham","followers_url":"https://api.github.com/users/Tam-Pham/followers","following_url":"https://api.github.com/users/Tam-Pham/following{/other_user}","gists_url":"https://api.github.com/users/Tam-Pham/gists{/gist_id}","starred_url":"https://api.github.com/users/Tam-Pham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tam-Pham/subscriptions","organizations_url":"https://api.github.com/users/Tam-Pham/orgs","repos_url":"https://api.github.com/users/Tam-Pham/repos","events_url":"https://api.github.com/users/Tam-Pham/events{/privacy}","received_events_url":"https://api.github.com/users/Tam-Pham/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-05-10T06:51:22Z","performed_via_github_app":null},{"id":3320048250,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMzMjAwNDgyNTA=","url":"https://api.github.com/repos/raphaelvallat/entropy/issues/events/3320048250","actor":{"login":"Tam-Pham","id":47100701,"node_id":"MDQ6VXNlcjQ3MTAwNzAx","avatar_url":"https://avatars.githubusercontent.com/u/47100701?v=4","gravatar_id":"","url":"https://api.github.com/users/Tam-Pham","html_url":"https://github.com/Tam-Pham","followers_url":"https://api.github.com/users/Tam-Pham/followers","following_url":"https://api.github.com/users/Tam-Pham/following{/other_user}","gists_url":"https://api.github.com/users/Tam-Pham/gists{/gist_id}","starred_url":"https://api.github.com/users/Tam-Pham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tam-Pham/subscriptions","organizations_url":"https://api.github.com/users/Tam-Pham/orgs","repos_url":"https://api.github.com/users/Tam-Pham/repos","events_url":"https://api.github.com/users/Tam-Pham/events{/privacy}","received_events_url":"https://api.github.com/users/Tam-Pham/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-05-10T06:51:22Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/raphaelvallat/entropy/issues/comments/626288028","html_url":"https://github.com/raphaelvallat/entropy/issues/5#issuecomment-626288028","issue_url":"https://api.github.com/repos/raphaelvallat/entropy/issues/5","id":626288028,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNjI4ODAyOA==","user":{"login":"Tam-Pham","id":47100701,"node_id":"MDQ6VXNlcjQ3MTAwNzAx","avatar_url":"https://avatars.githubusercontent.com/u/47100701?v=4","gravatar_id":"","url":"https://api.github.com/users/Tam-Pham","html_url":"https://github.com/Tam-Pham","followers_url":"https://api.github.com/users/Tam-Pham/followers","following_url":"https://api.github.com/users/Tam-Pham/following{/other_user}","gists_url":"https://api.github.com/users/Tam-Pham/gists{/gist_id}","starred_url":"https://api.github.com/users/Tam-Pham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tam-Pham/subscriptions","organizations_url":"https://api.github.com/users/Tam-Pham/orgs","repos_url":"https://api.github.com/users/Tam-Pham/repos","events_url":"https://api.github.com/users/Tam-Pham/events{/privacy}","received_events_url":"https://api.github.com/users/Tam-Pham/received_events","type":"User","site_admin":false},"created_at":"2020-05-10T07:47:13Z","updated_at":"2020-05-10T07:51:28Z","author_association":"NONE","body":"Thanks @raphaelvallat for very detailed answer and the comparison script. \r\n\r\nRecently, I have been looking at the paper here: [Shi (2017)](https://www.mdpi.com/1099-4300/19/10/568/htm) and the paper seems to suggest that:\r\n\r\n![image](https://user-images.githubusercontent.com/47100701/81493709-4914a300-92d5-11ea-8324-2d87fd3f249e.png)\r\n\r\nfor a signal with N number of samples, m dimension and Ï„ time delay, the number of vector formed is limited to **Nâˆ’mÏ„**  vectors. \r\n\r\nAnd since the full embedding matrix that we obtain has the shape of **N - (m-1)Ï„ - by - m**,  it would make more sense to remove the Ï„ number of embedded vector when approximate entropy is calculated ðŸ¤” \r\n\r\nI'm still investigating if my above interpretation is correct. Do let me know if you have a different interpretation of this paper ðŸ˜„ \r\n\r\n","reactions":{"url":"https://api.github.com/repos/raphaelvallat/entropy/issues/comments/626288028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Tam-Pham","id":47100701,"node_id":"MDQ6VXNlcjQ3MTAwNzAx","avatar_url":"https://avatars.githubusercontent.com/u/47100701?v=4","gravatar_id":"","url":"https://api.github.com/users/Tam-Pham","html_url":"https://github.com/Tam-Pham","followers_url":"https://api.github.com/users/Tam-Pham/followers","following_url":"https://api.github.com/users/Tam-Pham/following{/other_user}","gists_url":"https://api.github.com/users/Tam-Pham/gists{/gist_id}","starred_url":"https://api.github.com/users/Tam-Pham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tam-Pham/subscriptions","organizations_url":"https://api.github.com/users/Tam-Pham/orgs","repos_url":"https://api.github.com/users/Tam-Pham/repos","events_url":"https://api.github.com/users/Tam-Pham/events{/privacy}","received_events_url":"https://api.github.com/users/Tam-Pham/received_events","type":"User","site_admin":false}},{"id":3320080078,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzMyMDA4MDA3OA==","url":"https://api.github.com/repos/raphaelvallat/entropy/issues/events/3320080078","actor":{"login":"raphaelvallat","id":25703792,"node_id":"MDQ6VXNlcjI1NzAzNzky","avatar_url":"https://avatars.githubusercontent.com/u/25703792?v=4","gravatar_id":"","url":"https://api.github.com/users/raphaelvallat","html_url":"https://github.com/raphaelvallat","followers_url":"https://api.github.com/users/raphaelvallat/followers","following_url":"https://api.github.com/users/raphaelvallat/following{/other_user}","gists_url":"https://api.github.com/users/raphaelvallat/gists{/gist_id}","starred_url":"https://api.github.com/users/raphaelvallat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raphaelvallat/subscriptions","organizations_url":"https://api.github.com/users/raphaelvallat/orgs","repos_url":"https://api.github.com/users/raphaelvallat/repos","events_url":"https://api.github.com/users/raphaelvallat/events{/privacy}","received_events_url":"https://api.github.com/users/raphaelvallat/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-05-10T07:47:13Z","performed_via_github_app":null},{"id":3320080080,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMzMjAwODAwODA=","url":"https://api.github.com/repos/raphaelvallat/entropy/issues/events/3320080080","actor":{"login":"raphaelvallat","id":25703792,"node_id":"MDQ6VXNlcjI1NzAzNzky","avatar_url":"https://avatars.githubusercontent.com/u/25703792?v=4","gravatar_id":"","url":"https://api.github.com/users/raphaelvallat","html_url":"https://github.com/raphaelvallat","followers_url":"https://api.github.com/users/raphaelvallat/followers","following_url":"https://api.github.com/users/raphaelvallat/following{/other_user}","gists_url":"https://api.github.com/users/raphaelvallat/gists{/gist_id}","starred_url":"https://api.github.com/users/raphaelvallat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raphaelvallat/subscriptions","organizations_url":"https://api.github.com/users/raphaelvallat/orgs","repos_url":"https://api.github.com/users/raphaelvallat/repos","events_url":"https://api.github.com/users/raphaelvallat/events{/privacy}","received_events_url":"https://api.github.com/users/raphaelvallat/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-05-10T07:47:13Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/raphaelvallat/entropy/issues/comments/626308669","html_url":"https://github.com/raphaelvallat/entropy/issues/5#issuecomment-626308669","issue_url":"https://api.github.com/repos/raphaelvallat/entropy/issues/5","id":626308669,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNjMwODY2OQ==","user":{"login":"Tam-Pham","id":47100701,"node_id":"MDQ6VXNlcjQ3MTAwNzAx","avatar_url":"https://avatars.githubusercontent.com/u/47100701?v=4","gravatar_id":"","url":"https://api.github.com/users/Tam-Pham","html_url":"https://github.com/Tam-Pham","followers_url":"https://api.github.com/users/Tam-Pham/followers","following_url":"https://api.github.com/users/Tam-Pham/following{/other_user}","gists_url":"https://api.github.com/users/Tam-Pham/gists{/gist_id}","starred_url":"https://api.github.com/users/Tam-Pham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tam-Pham/subscriptions","organizations_url":"https://api.github.com/users/Tam-Pham/orgs","repos_url":"https://api.github.com/users/Tam-Pham/repos","events_url":"https://api.github.com/users/Tam-Pham/events{/privacy}","received_events_url":"https://api.github.com/users/Tam-Pham/received_events","type":"User","site_admin":false},"created_at":"2020-05-10T10:53:15Z","updated_at":"2020-05-10T10:53:15Z","author_association":"NONE","body":"By the way, we might look into implementing a function to optimize r for each signal, based on this paper [Lu (2008)](https://biosignal.uconn.edu/wp-content/uploads/sites/2503/2018/09/06_Lu_2008_TBME.pdf). \r\nTrue to what you say, since r can have such significant effect on the results, I think it should deserve some \"complex optimization\" on it own ðŸ˜„ ","reactions":{"url":"https://api.github.com/repos/raphaelvallat/entropy/issues/comments/626308669/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Tam-Pham","id":47100701,"node_id":"MDQ6VXNlcjQ3MTAwNzAx","avatar_url":"https://avatars.githubusercontent.com/u/47100701?v=4","gravatar_id":"","url":"https://api.github.com/users/Tam-Pham","html_url":"https://github.com/Tam-Pham","followers_url":"https://api.github.com/users/Tam-Pham/followers","following_url":"https://api.github.com/users/Tam-Pham/following{/other_user}","gists_url":"https://api.github.com/users/Tam-Pham/gists{/gist_id}","starred_url":"https://api.github.com/users/Tam-Pham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tam-Pham/subscriptions","organizations_url":"https://api.github.com/users/Tam-Pham/orgs","repos_url":"https://api.github.com/users/Tam-Pham/repos","events_url":"https://api.github.com/users/Tam-Pham/events{/privacy}","received_events_url":"https://api.github.com/users/Tam-Pham/received_events","type":"User","site_admin":false}}]