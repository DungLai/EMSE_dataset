{"url":"https://api.github.com/repos/perslev/MultiPlanarUNet/issues/7","repository_url":"https://api.github.com/repos/perslev/MultiPlanarUNet","labels_url":"https://api.github.com/repos/perslev/MultiPlanarUNet/issues/7/labels{/name}","comments_url":"https://api.github.com/repos/perslev/MultiPlanarUNet/issues/7/comments","events_url":"https://api.github.com/repos/perslev/MultiPlanarUNet/issues/7/events","html_url":"https://github.com/perslev/MultiPlanarUNet/issues/7","id":521613672,"node_id":"MDU6SXNzdWU1MjE2MTM2NzI=","number":7,"title":"When training on toy_data, TypeError: can only concatenate list (not \"dict\") to list","user":{"login":"admshumar","id":31727606,"node_id":"MDQ6VXNlcjMxNzI3NjA2","avatar_url":"https://avatars.githubusercontent.com/u/31727606?v=4","gravatar_id":"","url":"https://api.github.com/users/admshumar","html_url":"https://github.com/admshumar","followers_url":"https://api.github.com/users/admshumar/followers","following_url":"https://api.github.com/users/admshumar/following{/other_user}","gists_url":"https://api.github.com/users/admshumar/gists{/gist_id}","starred_url":"https://api.github.com/users/admshumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/admshumar/subscriptions","organizations_url":"https://api.github.com/users/admshumar/orgs","repos_url":"https://api.github.com/users/admshumar/repos","events_url":"https://api.github.com/users/admshumar/events{/privacy}","received_events_url":"https://api.github.com/users/admshumar/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-11-12T15:16:23Z","updated_at":"2020-02-11T12:02:58Z","closed_at":"2020-02-11T12:02:58Z","author_association":"NONE","active_lock_reason":null,"body":"Running `mp train --just_one --overwrite` on a toy project with data generated using `mp toy_data --out_dir ./toy_data` leads to TensorFlow reporting a TypeError:\r\n\r\n`Epoch 1/500\r\nWARNING:tensorflow:From /home/akshay/.local/lib/python3.6/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.where in 2.0, which has the same broadcast rule as np.where\r\n2019-11-12 14:46:01.034121: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7\r\n2019-11-12 14:46:11.320775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 2447:00:00.0\r\n2019-11-12 14:46:11.320857: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0\r\n2019-11-12 14:46:11.320885: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0\r\n2019-11-12 14:46:11.320909: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10.0\r\n2019-11-12 14:46:11.320932: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10.0\r\n2019-11-12 14:46:11.320954: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10.0\r\n2019-11-12 14:46:11.320976: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10.0\r\n2019-11-12 14:46:11.321000: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7\r\n2019-11-12 14:46:11.321705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0\r\n2019-11-12 14:46:11.323352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 2447:00:00.0\r\n2019-11-12 14:46:11.323398: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0\r\n2019-11-12 14:46:11.323424: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0\r\n2019-11-12 14:46:11.323446: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10.0\r\n2019-11-12 14:46:11.323468: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10.0\r\n2019-11-12 14:46:11.323490: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10.0\r\n2019-11-12 14:46:11.323512: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10.0\r\n2019-11-12 14:46:11.323534: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7\r\n2019-11-12 14:46:11.324196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0\r\n2019-11-12 14:46:11.324233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-11-12 14:46:11.324247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0\r\n2019-11-12 14:46:11.324255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N\r\n2019-11-12 14:46:11.324970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10805 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 2447:00:00.0, compute capability: 3.7)\r\n2019-11-12 14:46:11.325972: I tensorflow/core/profiler/lib/profiler_session.cc:174] Profiler session started.\r\n2019-11-12 14:46:11.341159: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcupti.so.10.0\r\n  1/157 [..............................] - ETA: 49:50 - loss: 0.49752019-11-12 14:46:13.153506: I tensorflow/core/platform/default/device_tracer.cc:641] Collecting 4204 kernel records, 123 memcpy records.\r\n156/157 [============================>.] - ETA: 1s - loss: 0.2752can only concatenate list (not \"dict\") to list\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/mp\", line 11, in <module>\r\n    load_entry_point('MultiPlanarUNet==0.2.2', 'console_scripts', 'mp')()\r\n  File \"/usr/local/lib/python3.6/dist-packages/MultiPlanarUNet-0.2.2-py3.6.egg/MultiPlanarUNet/bin/mp.py\", line 55, in entry_func\r\n    mod.entry_func(parsed.args)\r\n  File \"/usr/local/lib/python3.6/dist-packages/MultiPlanarUNet-0.2.2-py3.6.egg/MultiPlanarUNet/bin/train.py\", line 398, in entry_func\r\n    raise e\r\n  File \"/usr/local/lib/python3.6/dist-packages/MultiPlanarUNet-0.2.2-py3.6.egg/MultiPlanarUNet/bin/train.py\", line 394, in entry_func\r\n    run(project_dir=project_dir, gpu_mon=gpu_mon, logger=logger, args=args)\r\n  File \"/usr/local/lib/python3.6/dist-packages/MultiPlanarUNet-0.2.2-py3.6.egg/MultiPlanarUNet/bin/train.py\", line 358, in run\r\n    hparams=hparams, no_im=args.no_images, **hparams[\"fit\"])\r\n  File \"/usr/local/lib/python3.6/dist-packages/MultiPlanarUNet-0.2.2-py3.6.egg/MultiPlanarUNet/train/trainer.py\", line 122, in fit\r\n    raise e\r\n  File \"/usr/local/lib/python3.6/dist-packages/MultiPlanarUNet-0.2.2-py3.6.egg/MultiPlanarUNet/train/trainer.py\", line 107, in fit\r\n    val_ignore_class_zero)\r\n  File \"/usr/local/lib/python3.6/dist-packages/MultiPlanarUNet-0.2.2-py3.6.egg/MultiPlanarUNet/train/trainer.py\", line 215, in _fit_loop\r\n    self.model.fit_generator(**fit_kwargs)\r\n  File \"/home/akshay/.local/lib/python3.6/site-packages/tensorflow/python/keras/engine/training.py\", line 1433, in fit_generator\r\n    steps_name='steps_per_epoch')\r\n  File \"/home/akshay/.local/lib/python3.6/site-packages/tensorflow/python/keras/engine/training_generator.py\", line 331, in model_iteration\r\n    callbacks.on_epoch_end(epoch, epoch_logs)\r\n  File \"/home/akshay/.local/lib/python3.6/site-packages/tensorflow/python/keras/callbacks.py\", line 311, in on_epoch_end\r\n    callback.on_epoch_end(epoch, logs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/MultiPlanarUNet-0.2.2-py3.6.egg/MultiPlanarUNet/callbacks/callbacks.py\", line 416, in on_epoch_end\r\n    TPs, relevant, selected, metrics = self.predict()\r\n  File \"/usr/local/lib/python3.6/dist-packages/MultiPlanarUNet-0.2.2-py3.6.egg/MultiPlanarUNet/callbacks/callbacks.py\", line 318, in predict\r\n    tensors = [self.model.total_loss] + metrics_tensors + self.model.outputs\r\nTypeError: can only concatenate list (not \"dict\") to list`\r\n\r\nI continued with `mp train_fusion`, under the assumption that the model was trained, but ran into an ImportError:\r\n`Traceback (most recent call last):\r\n  File \"/usr/local/bin/mp\", line 11, in <module>\r\n    load_entry_point('MultiPlanarUNet==0.2.2', 'console_scripts', 'mp')()\r\n  File \"/usr/local/lib/python3.6/dist-packages/MultiPlanarUNet-0.2.2-py3.6.egg/MultiPlanarUNet/bin/mp.py\", line 52, in entry_func\r\n    mod = importlib.import_module(\"MultiPlanarUNet.bin.\" + script)\r\n  File \"/usr/lib/python3.6/importlib/__init__.py\", line 126, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"<frozen importlib._bootstrap>\", line 994, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 971, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 955, in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 665, in _load_unlocked\r\n  File \"<frozen importlib._bootstrap_external>\", line 678, in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\n  File \"/usr/local/lib/python3.6/dist-packages/MultiPlanarUNet-0.2.2-py3.6.egg/MultiPlanarUNet/bin/train_fusion.py\", line 26, in <module>\r\n    from MultiPlanarUNet.train import YAMLHParams\r\nImportError: cannot import name 'YAMLHParams'`\r\n\r\nUbuntu 18.04.3 LTS (GNU/Linux 5.0.0-1023-azure x86_64)\r\nCuda V10.0.130\r\nCuDNN V7\r\ntensorflow-gpu 1.14.0 (binary)\r\nNvidia Tesla K80 (12Gb)\r\n\r\n","closed_by":{"login":"perslev","id":12041524,"node_id":"MDQ6VXNlcjEyMDQxNTI0","avatar_url":"https://avatars.githubusercontent.com/u/12041524?v=4","gravatar_id":"","url":"https://api.github.com/users/perslev","html_url":"https://github.com/perslev","followers_url":"https://api.github.com/users/perslev/followers","following_url":"https://api.github.com/users/perslev/following{/other_user}","gists_url":"https://api.github.com/users/perslev/gists{/gist_id}","starred_url":"https://api.github.com/users/perslev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/perslev/subscriptions","organizations_url":"https://api.github.com/users/perslev/orgs","repos_url":"https://api.github.com/users/perslev/repos","events_url":"https://api.github.com/users/perslev/events{/privacy}","received_events_url":"https://api.github.com/users/perslev/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/perslev/MultiPlanarUNet/issues/7/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/perslev/MultiPlanarUNet/issues/7/timeline","performed_via_github_app":null,"state_reason":"completed"}