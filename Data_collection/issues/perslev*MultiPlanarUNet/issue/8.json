{"url":"https://api.github.com/repos/perslev/MultiPlanarUNet/issues/8","repository_url":"https://api.github.com/repos/perslev/MultiPlanarUNet","labels_url":"https://api.github.com/repos/perslev/MultiPlanarUNet/issues/8/labels{/name}","comments_url":"https://api.github.com/repos/perslev/MultiPlanarUNet/issues/8/comments","events_url":"https://api.github.com/repos/perslev/MultiPlanarUNet/issues/8/events","html_url":"https://github.com/perslev/MultiPlanarUNet/issues/8","id":525754227,"node_id":"MDU6SXNzdWU1MjU3NTQyMjc=","number":8,"title":"weights can not be broadcast to values. values.rank=3. weights.rank=1. values.shape=(2, 448, 448). weights.shape=(2,).","user":{"login":"JoshuaChou2018","id":25849209,"node_id":"MDQ6VXNlcjI1ODQ5MjA5","avatar_url":"https://avatars.githubusercontent.com/u/25849209?v=4","gravatar_id":"","url":"https://api.github.com/users/JoshuaChou2018","html_url":"https://github.com/JoshuaChou2018","followers_url":"https://api.github.com/users/JoshuaChou2018/followers","following_url":"https://api.github.com/users/JoshuaChou2018/following{/other_user}","gists_url":"https://api.github.com/users/JoshuaChou2018/gists{/gist_id}","starred_url":"https://api.github.com/users/JoshuaChou2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JoshuaChou2018/subscriptions","organizations_url":"https://api.github.com/users/JoshuaChou2018/orgs","repos_url":"https://api.github.com/users/JoshuaChou2018/repos","events_url":"https://api.github.com/users/JoshuaChou2018/events{/privacy}","received_events_url":"https://api.github.com/users/JoshuaChou2018/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2019-11-20T11:49:13Z","updated_at":"2020-02-10T11:51:46Z","closed_at":"2020-02-10T11:51:46Z","author_association":"NONE","active_lock_reason":null,"body":"I got error while training.\r\n\r\nEpoch 1/500\r\n2019-11-20 14:47:08.423134: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n2019-11-20 14:47:17.904216: W tensorflow/stream_executor/cuda/redzone_allocator.cc:312] Not found: ./bin/ptxas not found\r\nRelying on driver to perform ptx compilation. This message will be only logged once.\r\n2019-11-20 14:47:24.653919: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0\r\nweights can not be broadcast to values. values.rank=3. weights.rank=1. values.shape=(2, 448, 448). weights.shape=(2,).\r\nTraceback (most recent call last):\r\n  File \"/home/zhouj0d/.conda/envs/mp/bin/mp\", line 11, in <module>\r\n    load_entry_point('MultiPlanarUNet==0.2.3', 'console_scripts', 'mp')()\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/MultiPlanarUNet-0.2.3-py3.6.egg/MultiPlanarUNet/bin/mp.py\", line 55, in entry_func\r\n    mod.entry_func(parsed.args)\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/MultiPlanarUNet-0.2.3-py3.6.egg/MultiPlanarUNet/bin/train.py\", line 398, in entry_func\r\n    raise e\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/MultiPlanarUNet-0.2.3-py3.6.egg/MultiPlanarUNet/bin/train.py\", line 394, in entry_func\r\n    run(project_dir=project_dir, gpu_mon=gpu_mon, logger=logger, args=args)\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/MultiPlanarUNet-0.2.3-py3.6.egg/MultiPlanarUNet/bin/train.py\", line 358, in run\r\n    hparams=hparams, no_im=args.no_images, **hparams[\"fit\"])\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/MultiPlanarUNet-0.2.3-py3.6.egg/MultiPlanarUNet/train/trainer.py\", line 111, in fit\r\n    raise e\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/MultiPlanarUNet-0.2.3-py3.6.egg/MultiPlanarUNet/train/trainer.py\", line 96, in fit\r\n    val_ignore_class_zero)\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/MultiPlanarUNet-0.2.3-py3.6.egg/MultiPlanarUNet/train/trainer.py\", line 204, in _fit_loop\r\n    self.model.fit_generator(**fit_kwargs)\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training.py\", line 1297, in fit_generator\r\n    steps_name='steps_per_epoch')\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_generator.py\", line 265, in model_iteration\r\n    batch_outs = batch_function(*batch_data)\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training.py\", line 973, in train_on_batch\r\n    class_weight=class_weight, reset_metrics=reset_metrics)\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py\", line 264, in train_on_batch\r\n    output_loss_metrics=model._output_loss_metrics)\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_eager.py\", line 311, in train_on_batch\r\n    output_loss_metrics=output_loss_metrics))\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_eager.py\", line 252, in _process_single_batch\r\n    training=training))\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_eager.py\", line 170, in _model_loss\r\n    reduction=losses_utils.ReductionV2.NONE)\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/tensorflow_core/python/keras/utils/losses_utils.py\", line 107, in compute_weighted_loss\r\n    losses, sample_weight)\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/tensorflow_core/python/ops/losses/util.py\", line 148, in scale_losses_by_sample_weight\r\n    sample_weight = weights_broadcast_ops.broadcast_weights(sample_weight, losses)\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/tensorflow_core/python/ops/weights_broadcast_ops.py\", line 167, in broadcast_weights\r\n    with ops.control_dependencies((assert_broadcastable(weights, values),)):\r\n  File \"/home/zhouj0d/.conda/envs/mp/lib/python3.6/site-packages/tensorflow_core/python/ops/weights_broadcast_ops.py\", line 103, in assert_broadcastable\r\n    weights_rank_static, values.shape, weights.shape))\r\nValueError: weights can not be broadcast to values. values.rank=3. weights.rank=1. values.shape=(2, 448, 448). weights.shape=(2,).","closed_by":{"login":"perslev","id":12041524,"node_id":"MDQ6VXNlcjEyMDQxNTI0","avatar_url":"https://avatars.githubusercontent.com/u/12041524?v=4","gravatar_id":"","url":"https://api.github.com/users/perslev","html_url":"https://github.com/perslev","followers_url":"https://api.github.com/users/perslev/followers","following_url":"https://api.github.com/users/perslev/following{/other_user}","gists_url":"https://api.github.com/users/perslev/gists{/gist_id}","starred_url":"https://api.github.com/users/perslev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/perslev/subscriptions","organizations_url":"https://api.github.com/users/perslev/orgs","repos_url":"https://api.github.com/users/perslev/repos","events_url":"https://api.github.com/users/perslev/events{/privacy}","received_events_url":"https://api.github.com/users/perslev/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/perslev/MultiPlanarUNet/issues/8/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/perslev/MultiPlanarUNet/issues/8/timeline","performed_via_github_app":null,"state_reason":"completed"}