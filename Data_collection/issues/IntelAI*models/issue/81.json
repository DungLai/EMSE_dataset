{"url":"https://api.github.com/repos/IntelAI/models/issues/81","repository_url":"https://api.github.com/repos/IntelAI/models","labels_url":"https://api.github.com/repos/IntelAI/models/issues/81/labels{/name}","comments_url":"https://api.github.com/repos/IntelAI/models/issues/81/comments","events_url":"https://api.github.com/repos/IntelAI/models/issues/81/events","html_url":"https://github.com/IntelAI/models/issues/81","id":891744542,"node_id":"MDU6SXNzdWU4OTE3NDQ1NDI=","number":81,"title":"I had a mistake when I ran tensorflow with multiple nodes","user":{"login":"houyushan","id":31638075,"node_id":"MDQ6VXNlcjMxNjM4MDc1","avatar_url":"https://avatars.githubusercontent.com/u/31638075?v=4","gravatar_id":"","url":"https://api.github.com/users/houyushan","html_url":"https://github.com/houyushan","followers_url":"https://api.github.com/users/houyushan/followers","following_url":"https://api.github.com/users/houyushan/following{/other_user}","gists_url":"https://api.github.com/users/houyushan/gists{/gist_id}","starred_url":"https://api.github.com/users/houyushan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/houyushan/subscriptions","organizations_url":"https://api.github.com/users/houyushan/orgs","repos_url":"https://api.github.com/users/houyushan/repos","events_url":"https://api.github.com/users/houyushan/events{/privacy}","received_events_url":"https://api.github.com/users/houyushan/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-05-14T08:53:40Z","updated_at":"2021-05-14T08:53:40Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"hi,\r\nI had a mistake when I ran tensorflow with multiple nodes\r\n\r\n\r\nThis is my order：\r\n\r\npython launch_benchmark.py \\\r\n>          --verbose \\\r\n>          --model-name=resnet50v1_5 \\\r\n>          --precision=fp32 \\\r\n>          --mode=training \\\r\n>          --framework tensorflow \\\r\n>          --noinstall \\\r\n>          --checkpoint=/home/mount_dir/hys/modles/checkpoints \\\r\n>          --data-location=/home/mount_dir/wj/ImageNet/data/tf_images \\\r\n>          --mpi_hostnames='c1,head' \\\r\n>          --mpi_num_processes=4 2>&1\r\n\r\n\r\nThis is the error encountered：\r\n\r\n    SOCKET_ID: -1\r\n    MODEL_NAME: resnet50v1_5\r\n    MODE: training\r\n    PRECISION: fp32\r\n    BATCH_SIZE: -1\r\n    NUM_CORES: -1\r\n    BENCHMARK_ONLY: True\r\n    ACCURACY_ONLY: False\r\n    OUTPUT_RESULTS: False\r\n    DISABLE_TCMALLOC: True\r\n    TCMALLOC_LARGE_ALLOC_REPORT_THRESHOLD: 2147483648\r\n    NOINSTALL: True\r\n    OUTPUT_DIR: /home/mount_dir/hys/models/benchmarks/common/tensorflow/logs\r\n    MPI_NUM_PROCESSES: 4\r\n    MPI_NUM_PEOCESSES_PER_SOCKET: 1\r\n    MPI_HOSTNAMES: c1,head\r\n    NUMA_CORES_PER_INSTANCE: None\r\n    PYTHON_EXE: /opt/intel/oneapi/tensorflow/2.2.0/bin/python\r\n    PYTHONPATH:\r\n    DRY_RUN:\r\n/bin/sh: numactl: command not found\r\n[mpiexec@head] match_arg (../../../../../src/pm/i_hydra/libhydra/arg/hydra_arg.c:91): unrecognized argument x\r\n[mpiexec@head] Similar arguments:\r\n[mpiexec@head]   demux\r\n[mpiexec@head]   s\r\n[mpiexec@head]   n\r\n[mpiexec@head]   enable-x\r\n[mpiexec@head]   f\r\n[mpiexec@head] HYD_arg_parse_array (../../../../../src/pm/i_hydra/libhydra/arg/hydra_arg.c:128): argument matching returned error\r\n[mpiexec@head] mpiexec_get_parameters (../../../../../src/pm/i_hydra/mpiexec/mpiexec_params.c:1350): error parsing input array\r\n[mpiexec@head] main (../../../../../src/pm/i_hydra/mpiexec/mpiexec.c:1755): error parsing parameters\r\nnum_inter_threads: 1\r\nnum_intra_threads: 26\r\nReceived these standard args: Namespace(accuracy_only=False, backbone_model=None, batch_size=64, benchmark_dir='/home/mount_dir/hys/models/benchmarks', benchmark_only=True, checkpoint='/home/mount_dir/hys/modles/checkpoints', data_location='/home/mount_dir/wj/ImageNet/data/tf_images', data_num_inter_threads=None, data_num_intra_threads=None, disable_tcmalloc=True, epochsbtwevals=1, experimental_gelu=False, framework='tensorflow', input_graph=None, intelai_models='/home/mount_dir/hys/models/benchmarks/../models/image_recognition/tensorflow/resnet50v1_5', mode='training', model_args=[], model_name='resnet50v1_5', model_source_dir=None, mpi=None, mpi_hostnames=None, num_cores=-1, num_instances=1, num_inter_threads=1, num_intra_threads=26, num_mpi=1, num_train_steps=1, numa_cores_per_instance=None, optimized_softmax=True, output_dir='/home/mount_dir/hys/models/benchmarks/common/tensorflow/logs', output_results=False, precision='fp32', socket_id=-1, steps=112590, tcmalloc_large_alloc_report_threshold=2147483648, tf_serving_version='master', trainepochs=72, use_case='image_recognition', verbose=True)\r\nReceived these custom args: []\r\nCurrent directory: /home/mount_dir/hys/models/benchmarks\r\nRunning: mpirun  -x LD_LIBRARY_PATH  -x PYTHONPATH  --allow-run-as-root -n 4 -H c1:2,head:2 -mca pml ob1 -mca btl ^openib -mca btl_tcp_if_exclude lo,docker0 --bind-to none --map-by slot /opt/intel/oneapi/tensorflow/2.2.0/bin/python /home/mount_dir/hys/models/benchmarks/../models/image_recognition/tensorflow/resnet50v1_5/training/mlperf_resnet/imagenet_main.py 2 --batch_size=64 --max_train_steps=112590 --train_epochs=72 --epochs_between_evals=1 --inter_op_parallelism_threads 1 --intra_op_parallelism_threads 26 --version 1 --resnet_size 50 --data_dir=/home/mount_dir/wj/ImageNet/data/tf_images --model_dir=/home/mount_dir/hys/modles/checkpoints\r\nPYTHONPATH: :/home/mount_dir/hys/models/benchmarks/../models/common/tensorflow:/home/mount_dir/hys/models/benchmarks/../models/image_recognition/tensorflow/resnet50v1_5:/home/mount_dir/hys/models/benchmarks:/home/mount_dir/hys/models/benchmarks\r\nRUNCMD: /opt/intel/oneapi/tensorflow/2.2.0/bin/python common/tensorflow/run_tf_benchmark.py --framework=tensorflow --use-case=image_recognition --model-name=resnet50v1_5 --precision=fp32 --mode=training --benchmark-dir=/home/mount_dir/hys/models/benchmarks --intelai-models=/home/mount_dir/hys/models/benchmarks/../models/image_recognition/tensorflow/resnet50v1_5 --num-cores=-1 --batch-size=-1 --socket-id=-1 --output-dir=/home/mount_dir/hys/models/benchmarks/common/tensorflow/logs --num-train-steps=1   --benchmark-only  --verbose --checkpoint=/home/mount_dir/hys/modles/checkpoints --data-location=/home/mount_dir/wj/ImageNet/data/tf_images --disable-tcmalloc=True\r\nLog file location: /home/mount_dir/hys/models/benchmarks/common/tensorflow/logs/benchmark_resnet50v1_5_training_fp32_20210514_163202.log\r\n\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/IntelAI/models/issues/81/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/IntelAI/models/issues/81/timeline","performed_via_github_app":null,"state_reason":null}