[{"id":4672637308,"node_id":"MDEyOkxhYmVsZWRFdmVudDQ2NzI2MzczMDg=","url":"https://api.github.com/repos/wzpan/wukong-robot/issues/events/4672637308","actor":{"login":"siemenliu","id":610228,"node_id":"MDQ6VXNlcjYxMDIyOA==","avatar_url":"https://avatars.githubusercontent.com/u/610228?v=4","gravatar_id":"","url":"https://api.github.com/users/siemenliu","html_url":"https://github.com/siemenliu","followers_url":"https://api.github.com/users/siemenliu/followers","following_url":"https://api.github.com/users/siemenliu/following{/other_user}","gists_url":"https://api.github.com/users/siemenliu/gists{/gist_id}","starred_url":"https://api.github.com/users/siemenliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/siemenliu/subscriptions","organizations_url":"https://api.github.com/users/siemenliu/orgs","repos_url":"https://api.github.com/users/siemenliu/repos","events_url":"https://api.github.com/users/siemenliu/events{/privacy}","received_events_url":"https://api.github.com/users/siemenliu/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-05-01T01:39:42Z","label":{"name":"operation problem","color":"8bed95"},"performed_via_github_app":null},{"id":4672637311,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQ0NjcyNjM3MzEx","url":"https://api.github.com/repos/wzpan/wukong-robot/issues/events/4672637311","actor":{"login":"siemenliu","id":610228,"node_id":"MDQ6VXNlcjYxMDIyOA==","avatar_url":"https://avatars.githubusercontent.com/u/610228?v=4","gravatar_id":"","url":"https://api.github.com/users/siemenliu","html_url":"https://github.com/siemenliu","followers_url":"https://api.github.com/users/siemenliu/followers","following_url":"https://api.github.com/users/siemenliu/following{/other_user}","gists_url":"https://api.github.com/users/siemenliu/gists{/gist_id}","starred_url":"https://api.github.com/users/siemenliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/siemenliu/subscriptions","organizations_url":"https://api.github.com/users/siemenliu/orgs","repos_url":"https://api.github.com/users/siemenliu/repos","events_url":"https://api.github.com/users/siemenliu/events{/privacy}","received_events_url":"https://api.github.com/users/siemenliu/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2021-05-01T01:39:42Z","assignee":{"login":"wzpan","id":1631405,"node_id":"MDQ6VXNlcjE2MzE0MDU=","avatar_url":"https://avatars.githubusercontent.com/u/1631405?v=4","gravatar_id":"","url":"https://api.github.com/users/wzpan","html_url":"https://github.com/wzpan","followers_url":"https://api.github.com/users/wzpan/followers","following_url":"https://api.github.com/users/wzpan/following{/other_user}","gists_url":"https://api.github.com/users/wzpan/gists{/gist_id}","starred_url":"https://api.github.com/users/wzpan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wzpan/subscriptions","organizations_url":"https://api.github.com/users/wzpan/orgs","repos_url":"https://api.github.com/users/wzpan/repos","events_url":"https://api.github.com/users/wzpan/events{/privacy}","received_events_url":"https://api.github.com/users/wzpan/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/wzpan/wukong-robot/issues/comments/830735115","html_url":"https://github.com/wzpan/wukong-robot/issues/147#issuecomment-830735115","issue_url":"https://api.github.com/repos/wzpan/wukong-robot/issues/147","id":830735115,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMDczNTExNQ==","user":{"login":"wzpan","id":1631405,"node_id":"MDQ6VXNlcjE2MzE0MDU=","avatar_url":"https://avatars.githubusercontent.com/u/1631405?v=4","gravatar_id":"","url":"https://api.github.com/users/wzpan","html_url":"https://github.com/wzpan","followers_url":"https://api.github.com/users/wzpan/followers","following_url":"https://api.github.com/users/wzpan/following{/other_user}","gists_url":"https://api.github.com/users/wzpan/gists{/gist_id}","starred_url":"https://api.github.com/users/wzpan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wzpan/subscriptions","organizations_url":"https://api.github.com/users/wzpan/orgs","repos_url":"https://api.github.com/users/wzpan/repos","events_url":"https://api.github.com/users/wzpan/events{/privacy}","received_events_url":"https://api.github.com/users/wzpan/received_events","type":"User","site_admin":false},"created_at":"2021-05-02T03:52:25Z","updated_at":"2021-05-02T03:52:25Z","author_association":"OWNER","body":"试试更新到最新版本的wukong-robot？刚修复了用户录音会带上 beep_hi 提示音的 bug ，所以你应该不用改 pardon 的判断词。","reactions":{"url":"https://api.github.com/repos/wzpan/wukong-robot/issues/comments/830735115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"wzpan","id":1631405,"node_id":"MDQ6VXNlcjE2MzE0MDU=","avatar_url":"https://avatars.githubusercontent.com/u/1631405?v=4","gravatar_id":"","url":"https://api.github.com/users/wzpan","html_url":"https://github.com/wzpan","followers_url":"https://api.github.com/users/wzpan/followers","following_url":"https://api.github.com/users/wzpan/following{/other_user}","gists_url":"https://api.github.com/users/wzpan/gists{/gist_id}","starred_url":"https://api.github.com/users/wzpan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wzpan/subscriptions","organizations_url":"https://api.github.com/users/wzpan/orgs","repos_url":"https://api.github.com/users/wzpan/repos","events_url":"https://api.github.com/users/wzpan/events{/privacy}","received_events_url":"https://api.github.com/users/wzpan/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/wzpan/wukong-robot/issues/comments/831602171","html_url":"https://github.com/wzpan/wukong-robot/issues/147#issuecomment-831602171","issue_url":"https://api.github.com/repos/wzpan/wukong-robot/issues/147","id":831602171,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMTYwMjE3MQ==","user":{"login":"siemenliu","id":610228,"node_id":"MDQ6VXNlcjYxMDIyOA==","avatar_url":"https://avatars.githubusercontent.com/u/610228?v=4","gravatar_id":"","url":"https://api.github.com/users/siemenliu","html_url":"https://github.com/siemenliu","followers_url":"https://api.github.com/users/siemenliu/followers","following_url":"https://api.github.com/users/siemenliu/following{/other_user}","gists_url":"https://api.github.com/users/siemenliu/gists{/gist_id}","starred_url":"https://api.github.com/users/siemenliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/siemenliu/subscriptions","organizations_url":"https://api.github.com/users/siemenliu/orgs","repos_url":"https://api.github.com/users/siemenliu/repos","events_url":"https://api.github.com/users/siemenliu/events{/privacy}","received_events_url":"https://api.github.com/users/siemenliu/received_events","type":"User","site_admin":false},"created_at":"2021-05-03T23:42:54Z","updated_at":"2021-05-04T12:16:06Z","author_association":"NONE","body":"感谢作者，使用了最新master代码后：\r\n1. 不说话是会识别成'嗯'，不会进入pardon，我用的麦克风是ReSpeaker 2-Mics Pi HAT\r\n2. 极客模式进入就还是会报错\r\n\r\n我尝试修改了下`snowboydecoder.py`中，将audio.open后的stream_in进行管理，每次open前先关闭现有打开的就可以规避这个问题，但是pardon触发后无法监听到唤醒词了。\r\n\r\n感觉问题像是硬件资源占用冲突问题？\r\n```\r\nroot@555d4c7d8c87:~/wukong-robot# python3 wukong.py \r\n\r\n********************************************************\r\n*          wukong-robot - 中文语音对话机器人           *\r\n*          (c) 2019 潘伟洲 <m@hahack.com>              *\r\n*     https://github.com/wzpan/wukong-robot.git        *\r\n********************************************************\r\n\r\n            后台管理端：http://0.0.0.0:5000\r\n            如需退出，可以按 Ctrl-4 组合键\r\n\r\n\r\nINFO:snowboy:Keyword 1 detected at time: 2021-05-03 23:32:10\r\nINFO:__main__:开始录音\r\nINFO:robot.Conversation:结束录音\r\nINFO:robot.ASR:baidu-asr 语音识别到了：['嗯']\r\nINFO:robot.AI:emotibot 回答：叮当出去一下,请稍等片刻,马上回来~~\r\nINFO:robot.TTS:baidu-tts 语音合成成功，合成路径：/tmp/tmpq13u45is.mp3\r\nINFO:snowboy:Keyword 1 detected at time: 2021-05-03 23:32:27\r\nINFO:__main__:开始录音\r\nINFO:robot.Conversation:结束录音\r\nINFO:robot.ASR:baidu-asr 语音识别到了：['进入即刻模式']\r\nINFO:robot.Brain:'进入即刻模式' 命中技能 Geek\r\nINFO:robot.TTS:baidu-tts 语音合成成功，合成路径：/tmp/tmp1in5_95p.mp3\r\nExpression 'ret' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 1736\r\nExpression 'AlsaOpen( &alsaApi->baseHostApiRep, params, streamDir, &self->pcm )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 1904\r\nExpression 'PaAlsaStreamComponent_Initialize( &self->capture, alsaApi, inParams, StreamDirection_In, NULL != callback )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 2171\r\nExpression 'PaAlsaStream_Initialize( stream, alsaHostApi, inputParameters, outputParameters, sampleRate, framesPerBuffer, callback, streamFlags, userData )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 2840\r\nCRITICAL:snowboy:[Errno Device unavailable] -9985\r\nExpression 'ret' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 1736\r\nExpression 'AlsaOpen( &alsaApi->baseHostApiRep, params, streamDir, &self->pcm )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 1904\r\nExpression 'PaAlsaStreamComponent_Initialize( &self->capture, alsaApi, inParams, StreamDirection_In, NULL != callback )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 2171\r\nExpression 'PaAlsaStream_Initialize( stream, alsaHostApi, inputParameters, outputParameters, sampleRate, framesPerBuffer, callback, streamFlags, userData )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 2840\r\nCRITICAL:snowboy:[Errno Device unavailable] -9985\r\nExpression 'ret' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 1736\r\nExpression 'AlsaOpen( &alsaApi->baseHostApiRep, params, streamDir, &self->pcm )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 1904\r\nExpression 'PaAlsaStreamComponent_Initialize( &self->capture, alsaApi, inParams, StreamDirection_In, NULL != callback )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 2171\r\nExpression 'PaAlsaStream_Initialize( stream, alsaHostApi, inputParameters, outputParameters, sampleRate, framesPerBuffer, callback, streamFlags, userData )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 2840\r\nCRITICAL:snowboy:[Errno Device unavailable] -9985\r\nExpression 'ret' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 1736\r\nExpression 'AlsaOpen( &alsaApi->baseHostApiRep, params, streamDir, &self->pcm )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 1904\r\nExpression 'PaAlsaStreamComponent_Initialize( &self->capture, alsaApi, inParams, StreamDirection_In, NULL != callback )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 2171\r\nExpression 'PaAlsaStream_Initialize( stream, alsaHostApi, inputParameters, outputParameters, sampleRate, framesPerBuffer, callback, streamFlags, userData )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 2840\r\nCRITICAL:snowboy:[Errno Device unavailable] -9985\r\nExpression 'ret' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 1736\r\nExpression 'AlsaOpen( &alsaApi->baseHostApiRep, params, streamDir, &self->pcm )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 1904\r\nExpression 'PaAlsaStreamComponent_Initialize( &self->capture, alsaApi, inParams, StreamDirection_In, NULL != callback )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 2171\r\nExpression 'PaAlsaStream_Initialize( stream, alsaHostApi, inputParameters, outputParameters, sampleRate, framesPerBuffer, callback, streamFlags, userData )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 2840\r\nCRITICAL:snowboy:[Errno Device unavailable] -9985\r\nINFO:robot.TTS:baidu-tts 语音合成成功，合成路径：/tmp/tmp96_1jq5k.mp3\r\n^\\Quit (core dumped)\r\nroot@555d4c7d8c87:~/wukong-robot# git pull\r\nAlready up-to-date.\r\nroot@555d4c7d8c87:~/wukong-robot# git branch\r\n* master\r\nroot@555d4c7d8c87:~/wukong-robot#\r\n```","reactions":{"url":"https://api.github.com/repos/wzpan/wukong-robot/issues/comments/831602171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"siemenliu","id":610228,"node_id":"MDQ6VXNlcjYxMDIyOA==","avatar_url":"https://avatars.githubusercontent.com/u/610228?v=4","gravatar_id":"","url":"https://api.github.com/users/siemenliu","html_url":"https://github.com/siemenliu","followers_url":"https://api.github.com/users/siemenliu/followers","following_url":"https://api.github.com/users/siemenliu/following{/other_user}","gists_url":"https://api.github.com/users/siemenliu/gists{/gist_id}","starred_url":"https://api.github.com/users/siemenliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/siemenliu/subscriptions","organizations_url":"https://api.github.com/users/siemenliu/orgs","repos_url":"https://api.github.com/users/siemenliu/repos","events_url":"https://api.github.com/users/siemenliu/events{/privacy}","received_events_url":"https://api.github.com/users/siemenliu/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/wzpan/wukong-robot/issues/comments/831607023","html_url":"https://github.com/wzpan/wukong-robot/issues/147#issuecomment-831607023","issue_url":"https://api.github.com/repos/wzpan/wukong-robot/issues/147","id":831607023,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMTYwNzAyMw==","user":{"login":"siemenliu","id":610228,"node_id":"MDQ6VXNlcjYxMDIyOA==","avatar_url":"https://avatars.githubusercontent.com/u/610228?v=4","gravatar_id":"","url":"https://api.github.com/users/siemenliu","html_url":"https://github.com/siemenliu","followers_url":"https://api.github.com/users/siemenliu/followers","following_url":"https://api.github.com/users/siemenliu/following{/other_user}","gists_url":"https://api.github.com/users/siemenliu/gists{/gist_id}","starred_url":"https://api.github.com/users/siemenliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/siemenliu/subscriptions","organizations_url":"https://api.github.com/users/siemenliu/orgs","repos_url":"https://api.github.com/users/siemenliu/repos","events_url":"https://api.github.com/users/siemenliu/events{/privacy}","received_events_url":"https://api.github.com/users/siemenliu/received_events","type":"User","site_admin":false},"created_at":"2021-05-03T23:58:49Z","updated_at":"2021-05-03T23:59:30Z","author_association":"NONE","body":"这是我管理了stream_in后的效果，极客模式正常可以多轮应答，但一旦进入pardon后，完成一轮应答就无法再次唤醒词激活了，但不确定这种修改方式是否合适。\r\n\r\n```\r\n@@ -114,6 +117,11 @@ class ActiveListener(object):\r\n         logger.debug('opening audio stream')\r\n \r\n         try:\r\n+            global stream_in_hotword\r\n+            if stream_in_hotword is not None:\r\n+                stream_in_hotword.stop_stream()\r\n+                stream_in_hotword.close()\r\n+\r\n             self.stream_in = self.audio.open(\r\n                 input=True, output=False,\r\n                 format=self.audio.get_format_from_width(\r\n@@ -122,6 +130,9 @@ class ActiveListener(object):\r\n                 rate=self.detector.SampleRate(),\r\n                 frames_per_buffer=2048,\r\n                 stream_callback=audio_callback)\r\n+\r\n+            global stream_in_active\r\n+            stream_in_active = self.stream_in\r\n         except Exception as e:\r\n             logger.critical(e)\r\n             return \r\n```\r\n\r\n```\r\n@@ -300,6 +321,12 @@ class HotwordDetector(object):\r\n \r\n         with no_alsa_error():\r\n             self.audio = pyaudio.PyAudio()\r\n+\r\n+        global stream_in_active\r\n+        if stream_in_active is not None:\r\n+            stream_in_active.stop_stream()\r\n+            stream_in_active.close()\r\n+\r\n         self.stream_in = self.audio.open(\r\n             input=True, output=False,\r\n             format=self.audio.get_format_from_width(\r\n@@ -308,6 +335,8 @@ class HotwordDetector(object):\r\n             rate=self.detector.SampleRate(),\r\n             frames_per_buffer=2048,\r\n             stream_callback=audio_callback)\r\n+        global stream_in_hotword\r\n+        stream_in_hotword = self.stream_in\r\n \r\n         if interrupt_check():\r\n             logger.debug(\"detect voice return\")\r\n\r\n\r\n```\r\n\r\n```\r\n********************************************************\r\n*          wukong-robot - 中文语音对话机器人           *\r\n*          (c) 2019 潘伟洲 <m@hahack.com>              *\r\n*     https://github.com/wzpan/wukong-robot.git        *\r\n********************************************************\r\n\r\n            如需退出，可以按 Ctrl-4 组合键。\r\n\r\n\r\nINFO:snowboy:Keyword 1 detected at time: 2021-05-03 23:46:10\r\nINFO:__main__:开始录音\r\nINFO:robot.Conversation:结束录音\r\nINFO:robot.ASR:baidu-asr 语音识别到了：['进入即刻模式']\r\nINFO:robot.Brain:'进入即刻模式' 命中技能 Geek\r\nINFO:robot.Conversation:命中缓存，播放缓存语音\r\nINFO:robot.ASR:baidu-asr 语音识别到了：['你是谁']\r\nINFO:robot.AI:emotibot 回答：叮当出去一下,请稍等片刻,马上回来~~\r\nINFO:robot.Conversation:命中缓存，播放缓存语音\r\nINFO:robot.ASR:baidu-asr 语音识别到了：['哪个招呼']\r\nINFO:robot.AI:emotibot 回答：叮当出去一下,请稍等片刻,马上回来~~\r\nINFO:robot.Conversation:命中缓存，播放缓存语音\r\nINFO:robot.ASR:baidu-asr 语音识别到了：['打个招呼']\r\nINFO:robot.Brain:'打个招呼' 命中技能 HelloWorld\r\nINFO:robot.Conversation:命中缓存，播放缓存语音\r\nINFO:robot.ASR:baidu-asr 语音识别到了：['嗯']\r\nINFO:robot.ASR:baidu-asr 语音识别到了：['嗯']\r\nINFO:robot.TTS:baidu-tts 语音合成成功，合成路径：/tmp/tmphiuwdzwy.mp3\r\nINFO:robot.ASR:baidu-asr 语音识别到了：['嗯']\r\nINFO:robot.TTS:baidu-tts 语音合成成功，合成路径：/tmp/tmpyrbtambx.mp3\r\n```","reactions":{"url":"https://api.github.com/repos/wzpan/wukong-robot/issues/comments/831607023/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"siemenliu","id":610228,"node_id":"MDQ6VXNlcjYxMDIyOA==","avatar_url":"https://avatars.githubusercontent.com/u/610228?v=4","gravatar_id":"","url":"https://api.github.com/users/siemenliu","html_url":"https://github.com/siemenliu","followers_url":"https://api.github.com/users/siemenliu/followers","following_url":"https://api.github.com/users/siemenliu/following{/other_user}","gists_url":"https://api.github.com/users/siemenliu/gists{/gist_id}","starred_url":"https://api.github.com/users/siemenliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/siemenliu/subscriptions","organizations_url":"https://api.github.com/users/siemenliu/orgs","repos_url":"https://api.github.com/users/siemenliu/repos","events_url":"https://api.github.com/users/siemenliu/events{/privacy}","received_events_url":"https://api.github.com/users/siemenliu/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/wzpan/wukong-robot/issues/comments/833214700","html_url":"https://github.com/wzpan/wukong-robot/issues/147#issuecomment-833214700","issue_url":"https://api.github.com/repos/wzpan/wukong-robot/issues/147","id":833214700,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzIxNDcwMA==","user":{"login":"wzpan","id":1631405,"node_id":"MDQ6VXNlcjE2MzE0MDU=","avatar_url":"https://avatars.githubusercontent.com/u/1631405?v=4","gravatar_id":"","url":"https://api.github.com/users/wzpan","html_url":"https://github.com/wzpan","followers_url":"https://api.github.com/users/wzpan/followers","following_url":"https://api.github.com/users/wzpan/following{/other_user}","gists_url":"https://api.github.com/users/wzpan/gists{/gist_id}","starred_url":"https://api.github.com/users/wzpan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wzpan/subscriptions","organizations_url":"https://api.github.com/users/wzpan/orgs","repos_url":"https://api.github.com/users/wzpan/repos","events_url":"https://api.github.com/users/wzpan/events{/privacy}","received_events_url":"https://api.github.com/users/wzpan/received_events","type":"User","site_admin":false},"created_at":"2021-05-06T04:27:28Z","updated_at":"2021-05-06T04:28:38Z","author_association":"OWNER","body":"因为在我的设备（MacBook）上不能复现这个问题，所以难以帮你诊断这个问题。\r\n\r\n但是我看你定义了好多个 `stream_in` 。有 `stream_in_hotword`，`stream_in `，`stream_in_active` 等等。这些是不能同时工作的，否则会发生资源抢占冲突。所以不建议你这么修改。\r\n\r\n不说任何话被误识别成 “嗯” 后，这种情况通常是你的麦克风底噪比较大导致。此时识别成 “嗯” 后也不应该走 pardon 逻辑，而是直接丢弃。可以修改 [这里](https://github.com/wzpan/wukong-robot/blob/master/plugins/Geek.py#L23) ，改为：\r\n\r\n``` python\r\n    def onAsk(self, input):\r\n        if input and input != '嗯':  # 识别为 '嗯' 后当成无输入，丢弃结果\r\n            logger.debug('input: {}'.format(input))\r\n            self.silent_count = 0\r\n            self.con.doResponse(input)\r\n        else:\r\n            self.silent_count += 1\r\n            if self.silent_count >= 5:\r\n                self.say('退出极客模式', cache=True)\r\n                self.clearImmersive()\r\n            else:\r\n                self.onAsk(self.activeListen(silent=True))\r\n```","reactions":{"url":"https://api.github.com/repos/wzpan/wukong-robot/issues/comments/833214700/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"wzpan","id":1631405,"node_id":"MDQ6VXNlcjE2MzE0MDU=","avatar_url":"https://avatars.githubusercontent.com/u/1631405?v=4","gravatar_id":"","url":"https://api.github.com/users/wzpan","html_url":"https://github.com/wzpan","followers_url":"https://api.github.com/users/wzpan/followers","following_url":"https://api.github.com/users/wzpan/following{/other_user}","gists_url":"https://api.github.com/users/wzpan/gists{/gist_id}","starred_url":"https://api.github.com/users/wzpan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wzpan/subscriptions","organizations_url":"https://api.github.com/users/wzpan/orgs","repos_url":"https://api.github.com/users/wzpan/repos","events_url":"https://api.github.com/users/wzpan/events{/privacy}","received_events_url":"https://api.github.com/users/wzpan/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/wzpan/wukong-robot/issues/comments/833507367","html_url":"https://github.com/wzpan/wukong-robot/issues/147#issuecomment-833507367","issue_url":"https://api.github.com/repos/wzpan/wukong-robot/issues/147","id":833507367,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzUwNzM2Nw==","user":{"login":"siemenliu","id":610228,"node_id":"MDQ6VXNlcjYxMDIyOA==","avatar_url":"https://avatars.githubusercontent.com/u/610228?v=4","gravatar_id":"","url":"https://api.github.com/users/siemenliu","html_url":"https://github.com/siemenliu","followers_url":"https://api.github.com/users/siemenliu/followers","following_url":"https://api.github.com/users/siemenliu/following{/other_user}","gists_url":"https://api.github.com/users/siemenliu/gists{/gist_id}","starred_url":"https://api.github.com/users/siemenliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/siemenliu/subscriptions","organizations_url":"https://api.github.com/users/siemenliu/orgs","repos_url":"https://api.github.com/users/siemenliu/repos","events_url":"https://api.github.com/users/siemenliu/events{/privacy}","received_events_url":"https://api.github.com/users/siemenliu/received_events","type":"User","site_admin":false},"created_at":"2021-05-06T13:07:09Z","updated_at":"2021-05-06T13:07:09Z","author_association":"NONE","body":"> 因为在我的设备（MacBook）上不能复现这个问题，所以难以帮你诊断这个问题。\r\n> \r\n> 但是我看你定义了好多个 `stream_in` 。有 `stream_in_hotword`，`stream_in `，`stream_in_active` 等等。这些是不能同时工作的，否则会发生资源抢占冲突。所以不建议你这么修改。\r\n> \r\n> 不说任何话被误识别成 “嗯” 后，这种情况通常是你的麦克风底噪比较大导致。此时识别成 “嗯” 后也不应该走 pardon 逻辑，而是直接丢弃。可以修改 [这里](https://github.com/wzpan/wukong-robot/blob/master/plugins/Geek.py#L23) ，改为：\r\n> \r\n> ```python\r\n>     def onAsk(self, input):\r\n>         if input and input != '嗯':  # 识别为 '嗯' 后当成无输入，丢弃结果\r\n>             logger.debug('input: {}'.format(input))\r\n>             self.silent_count = 0\r\n>             self.con.doResponse(input)\r\n>         else:\r\n>             self.silent_count += 1\r\n>             if self.silent_count >= 5:\r\n>                 self.say('退出极客模式', cache=True)\r\n>                 self.clearImmersive()\r\n>             else:\r\n>                 self.onAsk(self.activeListen(silent=True))\r\n> ```\r\n\r\n好的，我再研究下，感谢。目前看这么干可以，树莓派上必须遵循在某个audio.open时，上一个open的stream需要close才可以正常工作。这块如果我找到更好的解决方案再来交PR，这里先关了。","reactions":{"url":"https://api.github.com/repos/wzpan/wukong-robot/issues/comments/833507367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"siemenliu","id":610228,"node_id":"MDQ6VXNlcjYxMDIyOA==","avatar_url":"https://avatars.githubusercontent.com/u/610228?v=4","gravatar_id":"","url":"https://api.github.com/users/siemenliu","html_url":"https://github.com/siemenliu","followers_url":"https://api.github.com/users/siemenliu/followers","following_url":"https://api.github.com/users/siemenliu/following{/other_user}","gists_url":"https://api.github.com/users/siemenliu/gists{/gist_id}","starred_url":"https://api.github.com/users/siemenliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/siemenliu/subscriptions","organizations_url":"https://api.github.com/users/siemenliu/orgs","repos_url":"https://api.github.com/users/siemenliu/repos","events_url":"https://api.github.com/users/siemenliu/events{/privacy}","received_events_url":"https://api.github.com/users/siemenliu/received_events","type":"User","site_admin":false}},{"id":4695071639,"node_id":"MDExOkNsb3NlZEV2ZW50NDY5NTA3MTYzOQ==","url":"https://api.github.com/repos/wzpan/wukong-robot/issues/events/4695071639","actor":{"login":"siemenliu","id":610228,"node_id":"MDQ6VXNlcjYxMDIyOA==","avatar_url":"https://avatars.githubusercontent.com/u/610228?v=4","gravatar_id":"","url":"https://api.github.com/users/siemenliu","html_url":"https://github.com/siemenliu","followers_url":"https://api.github.com/users/siemenliu/followers","following_url":"https://api.github.com/users/siemenliu/following{/other_user}","gists_url":"https://api.github.com/users/siemenliu/gists{/gist_id}","starred_url":"https://api.github.com/users/siemenliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/siemenliu/subscriptions","organizations_url":"https://api.github.com/users/siemenliu/orgs","repos_url":"https://api.github.com/users/siemenliu/repos","events_url":"https://api.github.com/users/siemenliu/events{/privacy}","received_events_url":"https://api.github.com/users/siemenliu/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-05-06T13:07:12Z","state_reason":null,"performed_via_github_app":null}]