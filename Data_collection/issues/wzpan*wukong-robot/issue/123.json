{"url":"https://api.github.com/repos/wzpan/wukong-robot/issues/123","repository_url":"https://api.github.com/repos/wzpan/wukong-robot","labels_url":"https://api.github.com/repos/wzpan/wukong-robot/issues/123/labels{/name}","comments_url":"https://api.github.com/repos/wzpan/wukong-robot/issues/123/comments","events_url":"https://api.github.com/repos/wzpan/wukong-robot/issues/123/events","html_url":"https://github.com/wzpan/wukong-robot/issues/123","id":606740182,"node_id":"MDU6SXNzdWU2MDY3NDAxODI=","number":123,"title":"技能插件不能触发","user":{"login":"qingfengzi","id":28665401,"node_id":"MDQ6VXNlcjI4NjY1NDAx","avatar_url":"https://avatars.githubusercontent.com/u/28665401?v=4","gravatar_id":"","url":"https://api.github.com/users/qingfengzi","html_url":"https://github.com/qingfengzi","followers_url":"https://api.github.com/users/qingfengzi/followers","following_url":"https://api.github.com/users/qingfengzi/following{/other_user}","gists_url":"https://api.github.com/users/qingfengzi/gists{/gist_id}","starred_url":"https://api.github.com/users/qingfengzi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qingfengzi/subscriptions","organizations_url":"https://api.github.com/users/qingfengzi/orgs","repos_url":"https://api.github.com/users/qingfengzi/repos","events_url":"https://api.github.com/users/qingfengzi/events{/privacy}","received_events_url":"https://api.github.com/users/qingfengzi/received_events","type":"User","site_admin":false},"labels":[{"id":1236422386,"node_id":"MDU6TGFiZWwxMjM2NDIyMzg2","url":"https://api.github.com/repos/wzpan/wukong-robot/labels/operation%20problem","name":"operation problem","color":"8bed95","default":false,"description":"用户操作问题"}],"state":"closed","locked":false,"assignee":{"login":"wzpan","id":1631405,"node_id":"MDQ6VXNlcjE2MzE0MDU=","avatar_url":"https://avatars.githubusercontent.com/u/1631405?v=4","gravatar_id":"","url":"https://api.github.com/users/wzpan","html_url":"https://github.com/wzpan","followers_url":"https://api.github.com/users/wzpan/followers","following_url":"https://api.github.com/users/wzpan/following{/other_user}","gists_url":"https://api.github.com/users/wzpan/gists{/gist_id}","starred_url":"https://api.github.com/users/wzpan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wzpan/subscriptions","organizations_url":"https://api.github.com/users/wzpan/orgs","repos_url":"https://api.github.com/users/wzpan/repos","events_url":"https://api.github.com/users/wzpan/events{/privacy}","received_events_url":"https://api.github.com/users/wzpan/received_events","type":"User","site_admin":false},"assignees":[{"login":"wzpan","id":1631405,"node_id":"MDQ6VXNlcjE2MzE0MDU=","avatar_url":"https://avatars.githubusercontent.com/u/1631405?v=4","gravatar_id":"","url":"https://api.github.com/users/wzpan","html_url":"https://github.com/wzpan","followers_url":"https://api.github.com/users/wzpan/followers","following_url":"https://api.github.com/users/wzpan/following{/other_user}","gists_url":"https://api.github.com/users/wzpan/gists{/gist_id}","starred_url":"https://api.github.com/users/wzpan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wzpan/subscriptions","organizations_url":"https://api.github.com/users/wzpan/orgs","repos_url":"https://api.github.com/users/wzpan/repos","events_url":"https://api.github.com/users/wzpan/events{/privacy}","received_events_url":"https://api.github.com/users/wzpan/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2020-04-25T10:29:26Z","updated_at":"2020-04-26T02:28:42Z","closed_at":"2020-04-26T02:28:41Z","author_association":"NONE","active_lock_reason":null,"body":"**确认已寻找过答案**\r\n\r\n我已确认在 [Github issue](https://github.com/wzpan/wukong-robot/issues) 页、[常见问题](https://github.com/wzpan/wukong-robot/wiki/troubleshooting)页、[文档](http://wukong.hahack.com) 中都查找过，没有找到类似问题和资料。我也没有 google / bing/ 百度 / duckduckgo 到相关解答。\r\n\r\n**安装方式**\r\n\r\n手动安装\r\n\r\n**操作系统**\r\n\r\nRaspbian Buster\r\n\r\n**离线唤醒相关**\r\n\r\n如果是离线唤醒相关的问题，是否已确保 `arecord temp.wav`、`aplay temp.wav` (Linux) 或 `rec temp.wav`、`play temp.wav` （Mac）已正常工作？（注意要求不能带任何其他参数）如果不能，请先配置好麦克风和音响再尝试。\r\n\r\n—— 我已确保录音、播放都正常工作才尝试 wukong-robot 。\r\n\r\n**问题描述**\r\n\r\n具体说明下问题\r\n\r\n前辈您好，我最近在开发一个日程提醒的插件，但是该插件不能触发。我使用的的百度UNIT中的预置技能“提醒”来判断意图，以下问题已经确定：\r\n    1.百度unit中的机器人已经获取了预置技能提醒\r\n    2. SERVICE_ID, API_KEY, SECRET_KEY参数正确（开发的其他插件都能正常触发）\r\n    3.插件没有语法错误\r\n    4.插件isValid()方法没有和其他插件冲突\r\n    5.查看了日志，ASR识别准确\r\n    6.插件的模板我是拷贝的其他可用插件，仅改变插件isValid()方法中\r\n      unit.hasIntent(parsed, 'SET_REMIND')中的最后一个字段，仍然不能触发\r\n这是百度UNIT的“提醒”预置技能\r\n![图片](https://user-images.githubusercontent.com/28665401/80277328-cca09280-8720-11ea-9ece-699a5e12fd73.png)\r\n\r\n实现日程提醒插件的代码如下：\r\nclass Plugin(AbstractPlugin):\r\n\r\n    def handle(self, text, parsed):\r\n                #print(res)\r\n        import time  # 调试用，用于避免频繁调用UNIT导致QPS超限，发布时删除\r\n        time.sleep(1)  # 调试用，用于避免频繁调用UNIT导致QPS超限，发布时删除\r\n        parsed = unit.getUnit(text, SERVICE_ID, API_KEY, SECRET_KEY) # 调试用，发布时删除\r\n        slots = unit.getSlots(parsed, 'SET_REMIND')  # 取出所有词槽\r\n        # 遍历词槽，找出 user_person 对应的值\r\n        for slot in slots:\r\n            if slot['name'] == 'user_remind_time':\r\n                tn = TimeNormalizer()#提取语句中的时间\r\n                res = tn.parse(target=text) # target为待分析语句，timeBase为基准时间默认是当前时间\r\n                self.say('你好吖，{}！'.format(res))\r\n        return\r\n\r\n    def isValid(self, text, parsed):\r\n        parsed = unit.getUnit(text, SERVICE_ID, API_KEY, SECRET_KEY) # 调试用，发布时删除\r\n        # 判断是否包含 SET_REMIND 意图\r\n        return unit.hasIntent(parsed, 'SET_REMIND')\r\n\r\n如果有时间请您帮我看一下，谢谢，麻烦您啦！","closed_by":{"login":"qingfengzi","id":28665401,"node_id":"MDQ6VXNlcjI4NjY1NDAx","avatar_url":"https://avatars.githubusercontent.com/u/28665401?v=4","gravatar_id":"","url":"https://api.github.com/users/qingfengzi","html_url":"https://github.com/qingfengzi","followers_url":"https://api.github.com/users/qingfengzi/followers","following_url":"https://api.github.com/users/qingfengzi/following{/other_user}","gists_url":"https://api.github.com/users/qingfengzi/gists{/gist_id}","starred_url":"https://api.github.com/users/qingfengzi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qingfengzi/subscriptions","organizations_url":"https://api.github.com/users/qingfengzi/orgs","repos_url":"https://api.github.com/users/qingfengzi/repos","events_url":"https://api.github.com/users/qingfengzi/events{/privacy}","received_events_url":"https://api.github.com/users/qingfengzi/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/wzpan/wukong-robot/issues/123/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/wzpan/wukong-robot/issues/123/timeline","performed_via_github_app":null,"state_reason":"completed"}