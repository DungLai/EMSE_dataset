{"url":"https://api.github.com/repos/wzpan/wukong-robot/issues/76","repository_url":"https://api.github.com/repos/wzpan/wukong-robot","labels_url":"https://api.github.com/repos/wzpan/wukong-robot/issues/76/labels{/name}","comments_url":"https://api.github.com/repos/wzpan/wukong-robot/issues/76/comments","events_url":"https://api.github.com/repos/wzpan/wukong-robot/issues/76/events","html_url":"https://github.com/wzpan/wukong-robot/issues/76","id":470630685,"node_id":"MDU6SXNzdWU0NzA2MzA2ODU=","number":76,"title":"唤醒后，若不录入语音，会出现NoneType错误导致服务不可用","user":{"login":"shawn2013","id":46065644,"node_id":"MDQ6VXNlcjQ2MDY1NjQ0","avatar_url":"https://avatars.githubusercontent.com/u/46065644?v=4","gravatar_id":"","url":"https://api.github.com/users/shawn2013","html_url":"https://github.com/shawn2013","followers_url":"https://api.github.com/users/shawn2013/followers","following_url":"https://api.github.com/users/shawn2013/following{/other_user}","gists_url":"https://api.github.com/users/shawn2013/gists{/gist_id}","starred_url":"https://api.github.com/users/shawn2013/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shawn2013/subscriptions","organizations_url":"https://api.github.com/users/shawn2013/orgs","repos_url":"https://api.github.com/users/shawn2013/repos","events_url":"https://api.github.com/users/shawn2013/events{/privacy}","received_events_url":"https://api.github.com/users/shawn2013/received_events","type":"User","site_admin":false},"labels":[{"id":1196019304,"node_id":"MDU6TGFiZWwxMTk2MDE5MzA0","url":"https://api.github.com/repos/wzpan/wukong-robot/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"我的锅"}],"state":"closed","locked":false,"assignee":{"login":"wzpan","id":1631405,"node_id":"MDQ6VXNlcjE2MzE0MDU=","avatar_url":"https://avatars.githubusercontent.com/u/1631405?v=4","gravatar_id":"","url":"https://api.github.com/users/wzpan","html_url":"https://github.com/wzpan","followers_url":"https://api.github.com/users/wzpan/followers","following_url":"https://api.github.com/users/wzpan/following{/other_user}","gists_url":"https://api.github.com/users/wzpan/gists{/gist_id}","starred_url":"https://api.github.com/users/wzpan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wzpan/subscriptions","organizations_url":"https://api.github.com/users/wzpan/orgs","repos_url":"https://api.github.com/users/wzpan/repos","events_url":"https://api.github.com/users/wzpan/events{/privacy}","received_events_url":"https://api.github.com/users/wzpan/received_events","type":"User","site_admin":false},"assignees":[{"login":"wzpan","id":1631405,"node_id":"MDQ6VXNlcjE2MzE0MDU=","avatar_url":"https://avatars.githubusercontent.com/u/1631405?v=4","gravatar_id":"","url":"https://api.github.com/users/wzpan","html_url":"https://github.com/wzpan","followers_url":"https://api.github.com/users/wzpan/followers","following_url":"https://api.github.com/users/wzpan/following{/other_user}","gists_url":"https://api.github.com/users/wzpan/gists{/gist_id}","starred_url":"https://api.github.com/users/wzpan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wzpan/subscriptions","organizations_url":"https://api.github.com/users/wzpan/orgs","repos_url":"https://api.github.com/users/wzpan/repos","events_url":"https://api.github.com/users/wzpan/events{/privacy}","received_events_url":"https://api.github.com/users/wzpan/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2019-07-20T03:44:07Z","updated_at":"2019-07-22T01:12:47Z","closed_at":"2019-07-22T01:12:47Z","author_association":"NONE","active_lock_reason":null,"body":"**问题描述**\r\n语音唤醒后，若保持安静，不录入语音，会出现NoneType错误导致服务不可用，需要重启服务\r\n\r\n具体说明下问题\r\nINFO:snowboy:Keyword 1 detected at time: 2019-07-19 19:28:42\r\nINFO:__main__:开始录音\r\nINFO:robot.Conversation:结束录音\r\nINFO:robot.ASR:baidu-asr 语音识别出错了: speech quality error.\r\nINFO:robot.TTS:baidu-tts 语音合成成功，合成路径：/tmp/tmp7tyytdxs.mp3\r\nExpression 'ret' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 1736\r\nExpression 'AlsaOpen( &alsaApi->baseHostApiRep, params, streamDir, &self->pcm )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 1904\r\nExpression 'PaAlsaStreamComponent_Initialize( &self->capture, alsaApi, inParams, StreamDirection_In, NULL != callback )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 2171\r\nExpression 'PaAlsaStream_Initialize( stream, alsaHostApi, inputParameters, outputParameters, sampleRate, framesPerBuffer, callback, streamFlags, userData )' failed in 'src/hostapi/alsa/pa_linux_alsa.c', line: 2840\r\nCRITICAL:snowboy:[Errno -9985] Device unavailable\r\nException in thread Thread-12:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.5/threading.py\", line 914, in _bootstrap_inner\r\n    self.run()\r\n  File \"/mnt/card/wukong-robot/robot/Player.py\", line 88, in run\r\n    onCompleted()\r\n  File \"/mnt/card/wukong-robot/robot/Conversation.py\", line 152, in <lambda>\r\n    self.say(\"抱歉，刚刚没听清，能再说一遍吗？\", onCompleted=lambda: self.doResponse(self.activeListen()))\r\n  File \"/mnt/card/wukong-robot/robot/Conversation.py\", line 59, in doResponse\r\n    self.appendHistory(0, query, UUID)\r\n  File \"/mnt/card/wukong-robot/robot/Conversation.py\", line 125, in appendHistory\r\n    if text.endswith(',') or text.endswith('，'):\r\nAttributeError: 'NoneType' object has no attribute 'endswith'\r\n","closed_by":{"login":"shawn2013","id":46065644,"node_id":"MDQ6VXNlcjQ2MDY1NjQ0","avatar_url":"https://avatars.githubusercontent.com/u/46065644?v=4","gravatar_id":"","url":"https://api.github.com/users/shawn2013","html_url":"https://github.com/shawn2013","followers_url":"https://api.github.com/users/shawn2013/followers","following_url":"https://api.github.com/users/shawn2013/following{/other_user}","gists_url":"https://api.github.com/users/shawn2013/gists{/gist_id}","starred_url":"https://api.github.com/users/shawn2013/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shawn2013/subscriptions","organizations_url":"https://api.github.com/users/shawn2013/orgs","repos_url":"https://api.github.com/users/shawn2013/repos","events_url":"https://api.github.com/users/shawn2013/events{/privacy}","received_events_url":"https://api.github.com/users/shawn2013/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/wzpan/wukong-robot/issues/76/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/wzpan/wukong-robot/issues/76/timeline","performed_via_github_app":null,"state_reason":"completed"}