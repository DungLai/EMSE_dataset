{"url":"https://api.github.com/repos/lfortran/lfortran/issues/160","repository_url":"https://api.github.com/repos/lfortran/lfortran","labels_url":"https://api.github.com/repos/lfortran/lfortran/issues/160/labels{/name}","comments_url":"https://api.github.com/repos/lfortran/lfortran/issues/160/comments","events_url":"https://api.github.com/repos/lfortran/lfortran/issues/160/events","html_url":"https://github.com/lfortran/lfortran/issues/160","id":1338680329,"node_id":"I_kwDOCpMuHc5PyqQJ","number":160,"title":"Implement \"Language Service\"","user":{"login":"certik","id":20568,"node_id":"MDQ6VXNlcjIwNTY4","avatar_url":"https://avatars.githubusercontent.com/u/20568?v=4","gravatar_id":"","url":"https://api.github.com/users/certik","html_url":"https://github.com/certik","followers_url":"https://api.github.com/users/certik/followers","following_url":"https://api.github.com/users/certik/following{/other_user}","gists_url":"https://api.github.com/users/certik/gists{/gist_id}","starred_url":"https://api.github.com/users/certik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/certik/subscriptions","organizations_url":"https://api.github.com/users/certik/orgs","repos_url":"https://api.github.com/users/certik/repos","events_url":"https://api.github.com/users/certik/events{/privacy}","received_events_url":"https://api.github.com/users/certik/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-08-15T08:14:38Z","updated_at":"2022-08-15T08:14:38Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"*Original issue*: https://gitlab.com/lfortran/lfortran/-/issues/12\n\nImplement a \"Language Service\", which is a server exposing a JSON based API that accepts user cursor movement and each character changes. It brings back, e.g., a list of members for the editor to show.\n\nHow it works:\n\n* Each source file gets compiled to AST.\n  * If a source file does not change, the AST does not change. AST is immutable. Type annotations are kept in a separate hash table.\n  * If a source file changes at a place, only that node at the given place and all parent nodes must change (in the direct line to the root), but all other nodes in the file can be reused and hooked in. This saves time to reconstruct the AST\n* The AST is thus always available and ready.\n* Type annotations must be redone, since some base type can change in a file, and all modules that depend on it can change their type annotations too. The AST however does not change. In Fortran, a given module can be fully compiled if just the symbol table is known. So given a symbol table, one must redo type annotations for all AST trees of all modules.\n* The type annotations are slow in general, so they work on the \"pull\" basis --- for a given symbol, one can figure out a type by going over the parents, and the rest of types are not computed.\n* For a source file change, the mentality is to \"start over\". The type annotations are erased (but perhaps can be reused in some fashion to build the new annotations). The AST is only changed in one file at a time, and one can greatly reuse the AST tree in there too, as described above.\n\nTypescript does it:\n\nhttps://github.com/Microsoft/TypeScript/wiki/Architectural-Overview\n\nC# also has it:\n\nhttps://github.com/dotnet/roslyn\nhttps://msdn.microsoft.com/en-us/magazine/dn879356\nhttps://github.com/dotnet/roslyn/wiki/Syntax%20Visualizer\n\nClang has it: https://github.com/llvm-mirror/clang-tools-extra/tree/master/clangd\n\nThere seems to be a standard now: https://en.wikipedia.org/wiki/Language_Server_Protocol, and it is supported, e.g., by https://en.wikipedia.org/wiki/Visual_Studio_Code.","closed_by":null,"reactions":{"url":"https://api.github.com/repos/lfortran/lfortran/issues/160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/lfortran/lfortran/issues/160/timeline","performed_via_github_app":null,"state_reason":null}