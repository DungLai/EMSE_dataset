{"url":"https://api.github.com/repos/lfortran/lfortran/issues/889","repository_url":"https://api.github.com/repos/lfortran/lfortran","labels_url":"https://api.github.com/repos/lfortran/lfortran/issues/889/labels{/name}","comments_url":"https://api.github.com/repos/lfortran/lfortran/issues/889/comments","events_url":"https://api.github.com/repos/lfortran/lfortran/issues/889/events","html_url":"https://github.com/lfortran/lfortran/issues/889","id":1405387856,"node_id":"I_kwDOCpMuHc5TxIRQ","number":889,"title":"How to use with `fpm` and compile to Wasm?","user":{"login":"rjzak","id":1133882,"node_id":"MDQ6VXNlcjExMzM4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/1133882?v=4","gravatar_id":"","url":"https://api.github.com/users/rjzak","html_url":"https://github.com/rjzak","followers_url":"https://api.github.com/users/rjzak/followers","following_url":"https://api.github.com/users/rjzak/following{/other_user}","gists_url":"https://api.github.com/users/rjzak/gists{/gist_id}","starred_url":"https://api.github.com/users/rjzak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjzak/subscriptions","organizations_url":"https://api.github.com/users/rjzak/orgs","repos_url":"https://api.github.com/users/rjzak/repos","events_url":"https://api.github.com/users/rjzak/events{/privacy}","received_events_url":"https://api.github.com/users/rjzak/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2022-10-12T00:36:11Z","updated_at":"2022-10-12T09:56:00Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I have a very simple Fortran application [rjzak/fibonacci-fpm-demo](https://github.com/rjzak/fibonacci-fpm-demo) where I was trying to learn the language, and try out [fpm](https://github.com/fortran-lang/fpm/releases/tag/v0.6.0). I'd like to use `lfortran` and `fpm` to build the project for Wasm, but I'm running into an issue:\r\n\r\n```\r\nFPM_FC=~/Downloads/lfortran/inst/bin/lfortran FPM_FFLAGS=\"--backend wasm\" fpm build\r\nfibonacci.f90                          done.\r\nlibfibonacci.a                         done.\r\nmain.f90                               failed.\r\n[  75%]Compiling...\r\nsemantic error: Module 'fibonacci' not declared in the current source and the modfile was not found\r\n --> app/main.f90:2:3\r\n  |\r\n2 |   use fibonacci, only: fibonacci_calc\r\n  |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ \r\n\r\n\r\nNote: if any of the above error or warning messages are not clear or are lacking\r\ncontext please report it to us (we consider that a bug that needs to be fixed).\r\n<ERROR> Compilation failed for object \" app_main.f90.o \"\r\n<ERROR>stopping due to failed compilation\r\nSTOP 1\r\n```\r\n\r\nAm I doing this correctly?\r\n\r\nTrying without setting the compilation target to Wasm has this:\r\n\r\n```\r\nFPM_FC=~/Downloads/lfortran/inst/bin/lfortran fpm build\r\nfibonacci.f90                          done.\r\nlibfibonacci.a                         done.\r\nmain.f90                               failed.\r\n[  75%]Compiling...\r\ncode generation error: The intrinsic function read() is not implemented yet in the LLVM backend\r\n --> app/main.f90:7:3\r\n  |\r\n7 |   read(*,*) user_num\r\n  |   ^^^^^^^^^^^^^^^^^^ not implemented\r\n\r\n\r\nNote: if any of the above error or warning messages are not clear or are lacking\r\ncontext please report it to us (we consider that a bug that needs to be fixed).\r\n<ERROR> Compilation failed for object \" app_main.f90.o \"\r\n<ERROR>stopping due to failed compilation\r\nSTOP 1\r\n```\r\n\r\nIt does seem odd to have a different error given a different target. Is there a better way to get input? My apologies if \"learning Fortran\" is beyond the scope of Github issues :)\r\n\r\n```\r\n$ ~/Downloads/lfortran/inst/bin/lfortran --version\r\nLFortran version: 0.16.0-1054-gf2b9aff1e-dirty\r\nPlatform: Linux\r\nDefault target: x86_64-pc-linux-gnu\r\n\r\n$ lsb_release -a\r\nNo LSB modules are available.\r\nDistributor ID:\tDebian\r\nDescription:\tDebian GNU/Linux 11 (bullseye)\r\nRelease:\t11\r\nCodename:\tbullseye\r\n```","closed_by":null,"reactions":{"url":"https://api.github.com/repos/lfortran/lfortran/issues/889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/lfortran/lfortran/issues/889/timeline","performed_via_github_app":null,"state_reason":null}