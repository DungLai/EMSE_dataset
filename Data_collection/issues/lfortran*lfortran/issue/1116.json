{"url":"https://api.github.com/repos/lfortran/lfortran/issues/1116","repository_url":"https://api.github.com/repos/lfortran/lfortran","labels_url":"https://api.github.com/repos/lfortran/lfortran/issues/1116/labels{/name}","comments_url":"https://api.github.com/repos/lfortran/lfortran/issues/1116/comments","events_url":"https://api.github.com/repos/lfortran/lfortran/issues/1116/events","html_url":"https://github.com/lfortran/lfortran/issues/1116","id":1503785457,"node_id":"I_kwDOCpMuHc5ZofHx","number":1116,"title":"Build: Missing symbols when Clang is installed inside Conda","user":{"login":"Shaikh-Ubaid","id":43722035,"node_id":"MDQ6VXNlcjQzNzIyMDM1","avatar_url":"https://avatars.githubusercontent.com/u/43722035?v=4","gravatar_id":"","url":"https://api.github.com/users/Shaikh-Ubaid","html_url":"https://github.com/Shaikh-Ubaid","followers_url":"https://api.github.com/users/Shaikh-Ubaid/followers","following_url":"https://api.github.com/users/Shaikh-Ubaid/following{/other_user}","gists_url":"https://api.github.com/users/Shaikh-Ubaid/gists{/gist_id}","starred_url":"https://api.github.com/users/Shaikh-Ubaid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Shaikh-Ubaid/subscriptions","organizations_url":"https://api.github.com/users/Shaikh-Ubaid/orgs","repos_url":"https://api.github.com/users/Shaikh-Ubaid/repos","events_url":"https://api.github.com/users/Shaikh-Ubaid/events{/privacy}","received_events_url":"https://api.github.com/users/Shaikh-Ubaid/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-12-19T23:46:12Z","updated_at":"2022-12-19T23:49:57Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"If `Clang` is installed inside `Conda` and we want to use `Clang` for linking, there are issues with regards to some missing symbols when building `lfortran`.\r\n\r\n## Steps to reproduce:\r\n\r\n1. `sudo apt-get install binutils-dev zlib1g-dev`\r\n2. `conda create -n lf -c conda-forge llvmdev=11.0.1 bison=3.4 re2c python cmake make toml clang`\r\n3. `conda activate lf`\r\n4. `./build0.sh`\r\n5. `./build1.sh`\r\n\r\n**Output:**\r\n```bash\r\nAssuming default values of wasm_instructions.txt and wasm_visitor.h\r\nOK\r\n-- The C compiler identification is GNU 11.3.0\r\n-- The CXX compiler identification is GNU 11.3.0\r\n-- Detecting C compiler ABI info\r\n-- Detecting C compiler ABI info - done\r\n-- Check for working C compiler: /usr/bin/cc - skipped\r\n-- Detecting C compile features\r\n-- Detecting C compile features - done\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Check for working CXX compiler: /usr/bin/c++ - skipped\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- Found ZLIB: /home/ubaid/miniconda3/envs/lf_website_clang/lib/libz.a (found version \"1.2.13\") \r\n-- Found LLVM 11.0.1\r\n-- Using LLVMConfig.cmake in: /home/ubaid/miniconda3/envs/lf_website_clang/lib/cmake/llvm\r\n-- Found BFD: /home/ubaid/miniconda3/envs/lf_website_clang/include  \r\n-- Found LINKH: /usr/include  \r\n-- Configuring done\r\n-- Generating done\r\n-- Build files have been written to: /home/ubaid/Desktop/Open-Source/lfortran\r\n[  1%] Building C object src/runtime/legacy/CMakeFiles/lfortran_runtime_static.dir/__/__/libasr/runtime/lfortran_intrinsics.c.o\r\n[  2%] Building CXX object src/tests/CMakeFiles/doctest.dir/doctest.cpp.o\r\n[  3%] Building C object src/runtime/legacy/CMakeFiles/lfortran_runtime.dir/__/__/libasr/runtime/lfortran_intrinsics.c.o\r\n[  3%] Building CXX object src/libasr/CMakeFiles/asr.dir/codegen/asr_to_cpp.cpp.o\r\n[  4%] Building CXX object src/libasr/CMakeFiles/asr.dir/codegen/asr_to_c.cpp.o\r\n[  5%] Building CXX object src/libasr/CMakeFiles/asr.dir/codegen/asr_to_julia.cpp.o\r\n[  7%] Building CXX object src/libasr/CMakeFiles/asr.dir/codegen/asr_to_x86.cpp.o\r\n[  7%] Building CXX object src/libasr/CMakeFiles/asr.dir/codegen/x86_assembler.cpp.o\r\n[  8%] Building CXX object src/libasr/CMakeFiles/asr.dir/codegen/asr_to_py.cpp.o\r\n[  9%] Building CXX object src/libasr/CMakeFiles/asr.dir/codegen/asr_to_wasm.cpp.o\r\n[ 10%] Building CXX object src/libasr/CMakeFiles/asr.dir/codegen/wasm_to_wat.cpp.o\r\n[ 11%] Building CXX object src/libasr/CMakeFiles/asr.dir/codegen/wasm_to_x86.cpp.o\r\n[ 12%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/param_to_const.cpp.o\r\n[ 13%] Building CXX object src/libasr/CMakeFiles/asr.dir/codegen/wasm_utils.cpp.o\r\n[ 14%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/do_loops.cpp.o\r\n[ 14%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/for_all.cpp.o\r\n[ 15%] Linking C static library liblfortran_runtime_static.a\r\n[ 16%] Linking C shared library ../liblfortran_runtime.so\r\n[ 16%] Built target lfortran_runtime_static\r\n[ 17%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/global_stmts.cpp.o\r\n[ 17%] Built target lfortran_runtime\r\n[ 18%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/global_stmts_program.cpp.o\r\n[ 19%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/select_case.cpp.o\r\n[ 20%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/implied_do_loops.cpp.o\r\n[ 21%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/array_op.cpp.o\r\n[ 22%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/subroutine_from_function.cpp.o\r\n[ 23%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/class_constructor.cpp.o\r\n[ 23%] Linking CXX static library libdoctest.a\r\n[ 24%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/arr_slice.cpp.o\r\n[ 24%] Built target doctest\r\n[ 25%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/print_arr.cpp.o\r\n[ 25%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/print_list.cpp.o\r\n[ 26%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/pass_utils.cpp.o\r\n[ 27%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/unused_functions.cpp.o\r\n[ 28%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/flip_sign.cpp.o\r\n[ 29%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/div_to_mul.cpp.o\r\n[ 30%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/fma.cpp.o\r\n[ 31%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/loop_vectorise.cpp.o\r\n[ 32%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/sign_from_value.cpp.o\r\n[ 33%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/inline_function_calls.cpp.o\r\n[ 34%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/loop_unroll.cpp.o\r\n[ 35%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/dead_code_removal.cpp.o\r\n[ 35%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/instantiate_template.cpp.o\r\n[ 36%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/update_array_dim_intrinsic_calls.cpp.o\r\n[ 37%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/pass_array_by_data.cpp.o\r\n[ 38%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/pass_list_expr.cpp.o\r\n[ 39%] Building CXX object src/libasr/CMakeFiles/asr.dir/asr_verify.cpp.o\r\n[ 40%] Building CXX object src/libasr/CMakeFiles/asr.dir/asr_utils.cpp.o\r\n[ 41%] Building CXX object src/libasr/CMakeFiles/asr.dir/diagnostics.cpp.o\r\n[ 42%] Building CXX object src/libasr/CMakeFiles/asr.dir/stacktrace.cpp.o\r\n[ 43%] Building CXX object src/libasr/CMakeFiles/asr.dir/string_utils.cpp.o\r\n[ 44%] Building CXX object src/libasr/CMakeFiles/asr.dir/asr_scopes.cpp.o\r\n[ 45%] Building CXX object src/libasr/CMakeFiles/asr.dir/modfile.cpp.o\r\n[ 45%] Building CXX object src/libasr/CMakeFiles/asr.dir/serialization.cpp.o\r\n[ 46%] Building CXX object src/libasr/CMakeFiles/asr.dir/utils2.cpp.o\r\n[ 47%] Building CXX object src/libasr/CMakeFiles/asr.dir/codegen/evaluator.cpp.o\r\n[ 48%] Building CXX object src/libasr/CMakeFiles/asr.dir/codegen/asr_to_llvm.cpp.o\r\n[ 49%] Building CXX object src/libasr/CMakeFiles/asr.dir/codegen/llvm_array_utils.cpp.o\r\n[ 50%] Building CXX object src/libasr/CMakeFiles/asr.dir/codegen/llvm_utils.cpp.o\r\n[ 51%] Building CXX object src/libasr/CMakeFiles/asr.dir/pass/nested_vars.cpp.o\r\n[ 52%] Linking CXX static library libasr.a\r\n[ 52%] Built target asr\r\n[ 54%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/parser/parser.tab.cc.o\r\n[ 54%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/parser/tokenizer.cpp.o\r\n[ 55%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/parser/fixedform_tokenizer.cpp.o\r\n[ 56%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/parser/preprocessor.cpp.o\r\n[ 57%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/parser/parser.cpp.o\r\n[ 57%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/semantics/ast_body_visitor.cpp.o\r\n[ 58%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/semantics/ast_symboltable_visitor.cpp.o\r\n[ 59%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/semantics/ast_to_asr.cpp.o\r\n[ 61%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/cwrapper.cpp.o\r\n[ 61%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/fortran_evaluator.cpp.o\r\n[ 62%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/ast_serialization.cpp.o\r\n[ 63%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/pickle.cpp.o\r\n[ 65%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/ast_to_openmp.cpp.o\r\n[ 65%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/ast_to_src.cpp.o\r\n[ 66%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/mod_to_asr.cpp.o\r\n[ 67%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/utils.cpp.o\r\n[ 68%] Building CXX object src/lfortran/CMakeFiles/lfortran_lib.dir/__/bin/tpl/whereami/whereami.cpp.o\r\n[ 68%] Linking CXX static library liblfortran_lib.a\r\n[ 68%] Built target lfortran_lib\r\n[ 70%] Building CXX object src/lfortran/tests/CMakeFiles/test_stacktrace.dir/test_stacktrace.cpp.o\r\n[ 70%] Building CXX object src/bin/CMakeFiles/lfortran.dir/lfortran.cpp.o\r\n[ 71%] Building CXX object src/bin/CMakeFiles/parse2.dir/parse2.cpp.o\r\n[ 75%] Building C object src/lfortran/tests/CMakeFiles/test_cwrapper.dir/test_cwrapper.c.o\r\n[ 75%] Building CXX object src/lfortran/tests/CMakeFiles/test_lfortran.dir/test_ast.cpp.o\r\n[ 75%] Building CXX object src/bin/CMakeFiles/parse.dir/parse.cpp.o\r\n[ 75%] Building CXX object src/lfortran/tests/CMakeFiles/test_lfortran.dir/test_stacktrace2.cpp.o\r\n[ 76%] Building CXX object src/lfortran/tests/CMakeFiles/test_lfortran.dir/test_pickle.cpp.o\r\n[ 77%] Building CXX object src/bin/CMakeFiles/cpptranslate.dir/cpptranslate.cpp.o\r\n[ 78%] Building CXX object src/lfortran/tests/CMakeFiles/test_lfortran.dir/test_parse.cpp.o\r\n[ 78%] Building CXX object src/lfortran/tests/CMakeFiles/test_lfortran.dir/test_asm.cpp.o\r\n[ 79%] Building CXX object src/lfortran/tests/CMakeFiles/test_lfortran.dir/test_serialization.cpp.o\r\n[ 80%] Building CXX object src/lfortran/tests/CMakeFiles/test_lfortran.dir/test_error_rendering.cpp.o\r\n[ 81%] Building CXX object src/lfortran/tests/CMakeFiles/test_lfortran.dir/test_llvm.cpp.o\r\n[ 82%] Linking CXX executable test_cwrapper\r\n[ 83%] Linking CXX executable test_stacktrace\r\n[ 84%] Linking CXX executable parse\r\n[ 85%] Linking CXX executable parse2\r\n[ 86%] Linking CXX executable test_lfortran\r\n[ 87%] Linking CXX executable cpptranslate\r\n[ 88%] Linking CXX executable lfortran\r\n```\r\n\r\n\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/lfortran/lfortran/issues/1116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/lfortran/lfortran/issues/1116/timeline","performed_via_github_app":null,"state_reason":null}