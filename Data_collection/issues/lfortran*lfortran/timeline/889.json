[{"url":"https://api.github.com/repos/lfortran/lfortran/issues/comments/1275444405","html_url":"https://github.com/lfortran/lfortran/issues/889#issuecomment-1275444405","issue_url":"https://api.github.com/repos/lfortran/lfortran/issues/889","id":1275444405,"node_id":"IC_kwDOCpMuHc5MBby1","user":{"login":"rjzak","id":1133882,"node_id":"MDQ6VXNlcjExMzM4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/1133882?v=4","gravatar_id":"","url":"https://api.github.com/users/rjzak","html_url":"https://github.com/rjzak","followers_url":"https://api.github.com/users/rjzak/followers","following_url":"https://api.github.com/users/rjzak/following{/other_user}","gists_url":"https://api.github.com/users/rjzak/gists{/gist_id}","starred_url":"https://api.github.com/users/rjzak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjzak/subscriptions","organizations_url":"https://api.github.com/users/rjzak/orgs","repos_url":"https://api.github.com/users/rjzak/repos","events_url":"https://api.github.com/users/rjzak/events{/privacy}","received_events_url":"https://api.github.com/users/rjzak/received_events","type":"User","site_admin":false},"created_at":"2022-10-12T00:50:21Z","updated_at":"2022-10-12T00:59:17Z","author_association":"NONE","body":"Removing `read(*, *) user_num` and setting `user_num` to some value worked! But trying to get it to compile for Wasm resulted in a different error:\r\n\r\n```\r\n$ fpm clean\r\nDelete build, excluding dependencies (y/n)? y\r\n + rm -rf build/gfortran_2A42023B310FA28D\r\n + rm -rf build/lfortran_00000000811C9DC5\r\n\r\n$ FPM_FC=~/Downloads/lfortran/inst/bin/lfortran FPM_FFLAGS=\"--backend wasm\" fpm build --verbose\r\n <INFO> BUILD_NAME: build/lfortran\r\n <INFO> COMPILER:  /thecrypt/home/rjzak/Downloads/lfortran/inst/bin/lfortran\r\n <INFO> C COMPILER:  cc\r\n <INFO> COMPILER OPTIONS:   --backend wasm\r\n <INFO> C COMPILER OPTIONS:  \r\n <INFO> LINKER OPTIONS:  \r\n <INFO> INCLUDE DIRECTORIES:  []\r\n + mkdir -p build/lfortran_9DE2FF917B5540D9\r\n [   0%]                 fibonacci.f90\r\n + mkdir -p build/lfortran_9DE2FF917B5540D9/fibonacci/\r\n + /thecrypt/home/rjzak/Downloads/lfortran/inst/bin/lfortran -c ./src/fibonacci.f90  --backend wasm -J build/lfortran_9DE2FF917B5540D9 -Ibuild/lfortran_9DE2FF917B5540D9 -o build/lfortran_9DE2FF917B5540D9/fibonacci/src_fibonacci.f90.o\r\n [  25%]                 fibonacci.f90  done.\r\n [  25%]                libfibonacci.a\r\n + ar -rs build/lfortran_9DE2FF917B5540D9/fibonacci/libfibonacci.a build/lfortran_9DE2FF917B5540D9/fibonacci/src_fibonacci.f90.o\r\nar: creating build/lfortran_9DE2FF917B5540D9/fibonacci/libfibonacci.a\r\n [  50%]                libfibonacci.a  done.\r\n [  50%]                      main.f90\r\n + /thecrypt/home/rjzak/Downloads/lfortran/inst/bin/lfortran -c app/main.f90  --backend wasm -J build/lfortran_9DE2FF917B5540D9 -Ibuild/lfortran_9DE2FF917B5540D9 -o build/lfortran_9DE2FF917B5540D9/fibonacci/app_main.f90.o\r\nSegmentation fault\r\n [  75%]                      main.f90  done.\r\n\r\nSegmentation fault\r\n<ERROR> Compilation failed for object \" app_main.f90.o \"\r\n<ERROR>stopping due to failed compilation\r\nSTOP 1\r\n\r\n$ tree .\r\n.\r\n├── app\r\n│   └── main.f90\r\n├── build\r\n│   ├── cache.toml\r\n│   ├── dependencies\r\n│   └── lfortran_9DE2FF917B5540D9\r\n│       └── fibonacci\r\n│           ├── app_main.f90.o.log\r\n│           ├── libfibonacci.a\r\n│           ├── libfibonacci.a.log\r\n│           ├── src_fibonacci.f90.o\r\n│           ├── src_fibonacci.f90.o.digest\r\n│           ├── src_fibonacci.f90.o.js\r\n│           └── src_fibonacci.f90.o.log\r\n├── fibonacci.mod\r\n├── fpm.toml\r\n├── LICENSE\r\n├── README.md\r\n├── src\r\n│   └── fibonacci.f90\r\n└── test\r\n    └── check.f90\r\n\r\n7 directories, 15 files\r\n\r\n$ file build/lfortran_9DE2FF917B5540D9/fibonacci/src_fibonacci.f90.o\r\nbuild/lfortran_9DE2FF917B5540D9/fibonacci/src_fibonacci.f90.o: WebAssembly (wasm) binary module version 0x1 (MVP)\r\n\r\n$ cat build/lfortran_9DE2FF917B5540D9/fibonacci/app_main.f90.o.log \r\nSegmentation fault\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/lfortran/lfortran/issues/comments/1275444405/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rjzak","id":1133882,"node_id":"MDQ6VXNlcjExMzM4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/1133882?v=4","gravatar_id":"","url":"https://api.github.com/users/rjzak","html_url":"https://github.com/rjzak","followers_url":"https://api.github.com/users/rjzak/followers","following_url":"https://api.github.com/users/rjzak/following{/other_user}","gists_url":"https://api.github.com/users/rjzak/gists{/gist_id}","starred_url":"https://api.github.com/users/rjzak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjzak/subscriptions","organizations_url":"https://api.github.com/users/rjzak/orgs","repos_url":"https://api.github.com/users/rjzak/repos","events_url":"https://api.github.com/users/rjzak/events{/privacy}","received_events_url":"https://api.github.com/users/rjzak/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/lfortran/lfortran/issues/comments/1275477940","html_url":"https://github.com/lfortran/lfortran/issues/889#issuecomment-1275477940","issue_url":"https://api.github.com/repos/lfortran/lfortran/issues/889","id":1275477940,"node_id":"IC_kwDOCpMuHc5MBj-0","user":{"login":"certik","id":20568,"node_id":"MDQ6VXNlcjIwNTY4","avatar_url":"https://avatars.githubusercontent.com/u/20568?v=4","gravatar_id":"","url":"https://api.github.com/users/certik","html_url":"https://github.com/certik","followers_url":"https://api.github.com/users/certik/followers","following_url":"https://api.github.com/users/certik/following{/other_user}","gists_url":"https://api.github.com/users/certik/gists{/gist_id}","starred_url":"https://api.github.com/users/certik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/certik/subscriptions","organizations_url":"https://api.github.com/users/certik/orgs","repos_url":"https://api.github.com/users/certik/repos","events_url":"https://api.github.com/users/certik/events{/privacy}","received_events_url":"https://api.github.com/users/certik/received_events","type":"User","site_admin":false},"created_at":"2022-10-12T01:45:40Z","updated_at":"2022-10-12T01:45:40Z","author_association":"CONTRIBUTOR","body":"There is a known issue that the `-I` doesn't yet work (cmake uses it to tell lfortran where to find the mod files), but we have a PR open to fix it: #598.\r\n\r\nWe have two WASM backends, in your case I would use the one via LLVM. We also have a direct ASR->WASM backend, but that one might have more bugs.\r\n\r\nFinally, we also want to use WASI. Do you know if LLVM uses WASI by default?","reactions":{"url":"https://api.github.com/repos/lfortran/lfortran/issues/comments/1275477940/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"certik","id":20568,"node_id":"MDQ6VXNlcjIwNTY4","avatar_url":"https://avatars.githubusercontent.com/u/20568?v=4","gravatar_id":"","url":"https://api.github.com/users/certik","html_url":"https://github.com/certik","followers_url":"https://api.github.com/users/certik/followers","following_url":"https://api.github.com/users/certik/following{/other_user}","gists_url":"https://api.github.com/users/certik/gists{/gist_id}","starred_url":"https://api.github.com/users/certik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/certik/subscriptions","organizations_url":"https://api.github.com/users/certik/orgs","repos_url":"https://api.github.com/users/certik/repos","events_url":"https://api.github.com/users/certik/events{/privacy}","received_events_url":"https://api.github.com/users/certik/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/lfortran/lfortran/issues/comments/1275484120","html_url":"https://github.com/lfortran/lfortran/issues/889#issuecomment-1275484120","issue_url":"https://api.github.com/repos/lfortran/lfortran/issues/889","id":1275484120,"node_id":"IC_kwDOCpMuHc5MBlfY","user":{"login":"rjzak","id":1133882,"node_id":"MDQ6VXNlcjExMzM4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/1133882?v=4","gravatar_id":"","url":"https://api.github.com/users/rjzak","html_url":"https://github.com/rjzak","followers_url":"https://api.github.com/users/rjzak/followers","following_url":"https://api.github.com/users/rjzak/following{/other_user}","gists_url":"https://api.github.com/users/rjzak/gists{/gist_id}","starred_url":"https://api.github.com/users/rjzak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjzak/subscriptions","organizations_url":"https://api.github.com/users/rjzak/orgs","repos_url":"https://api.github.com/users/rjzak/repos","events_url":"https://api.github.com/users/rjzak/events{/privacy}","received_events_url":"https://api.github.com/users/rjzak/received_events","type":"User","site_admin":false},"created_at":"2022-10-12T01:55:41Z","updated_at":"2022-10-12T01:55:41Z","author_association":"NONE","body":"* How do I tell LFortran to compile for Wasm? I thought the `--backend` argument was that.\r\n* I don't think LLVM uses Wasi by default, which is why there's the [wasi-sdk](https://github.com/WebAssembly/wasi-sdk). Running `llc --version` shows `wasm32` and `wasm64`. Wasi is a collection of functions which resemble Posix, so the backend doesn't need to know about Wasi in particular (I think). It might be worth either 1) exposing the functions needed via a Fortran-C bridge (I know it's a thing, don't recall what it's called) and let Fortran call the functions, or 2) having the compiler generate C and have it then use the Wasi-SDK I mentioned above, which includes the Wasi header files and `clang`, `lld`, others for `wasm32-wasi`. I'd be interested in helping here.","reactions":{"url":"https://api.github.com/repos/lfortran/lfortran/issues/comments/1275484120/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rjzak","id":1133882,"node_id":"MDQ6VXNlcjExMzM4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/1133882?v=4","gravatar_id":"","url":"https://api.github.com/users/rjzak","html_url":"https://github.com/rjzak","followers_url":"https://api.github.com/users/rjzak/followers","following_url":"https://api.github.com/users/rjzak/following{/other_user}","gists_url":"https://api.github.com/users/rjzak/gists{/gist_id}","starred_url":"https://api.github.com/users/rjzak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjzak/subscriptions","organizations_url":"https://api.github.com/users/rjzak/orgs","repos_url":"https://api.github.com/users/rjzak/repos","events_url":"https://api.github.com/users/rjzak/events{/privacy}","received_events_url":"https://api.github.com/users/rjzak/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/lfortran/lfortran/issues/comments/1275485818","html_url":"https://github.com/lfortran/lfortran/issues/889#issuecomment-1275485818","issue_url":"https://api.github.com/repos/lfortran/lfortran/issues/889","id":1275485818,"node_id":"IC_kwDOCpMuHc5MBl56","user":{"login":"certik","id":20568,"node_id":"MDQ6VXNlcjIwNTY4","avatar_url":"https://avatars.githubusercontent.com/u/20568?v=4","gravatar_id":"","url":"https://api.github.com/users/certik","html_url":"https://github.com/certik","followers_url":"https://api.github.com/users/certik/followers","following_url":"https://api.github.com/users/certik/following{/other_user}","gists_url":"https://api.github.com/users/certik/gists{/gist_id}","starred_url":"https://api.github.com/users/certik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/certik/subscriptions","organizations_url":"https://api.github.com/users/certik/orgs","repos_url":"https://api.github.com/users/certik/repos","events_url":"https://api.github.com/users/certik/events{/privacy}","received_events_url":"https://api.github.com/users/certik/received_events","type":"User","site_admin":false},"created_at":"2022-10-12T01:58:34Z","updated_at":"2022-10-12T01:58:34Z","author_association":"CONTRIBUTOR","body":"I think the `--backend=wasm` tells it to use the direct ASR->WASM backend. To use the WASM backend via LLVM, I think one has to use the `--target`, but I can't remember what the target is for LLVM to use WASM. We should obviously document it and ideally expose it directly via `--backend=llvm-wasm` or something like that.","reactions":{"url":"https://api.github.com/repos/lfortran/lfortran/issues/comments/1275485818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"certik","id":20568,"node_id":"MDQ6VXNlcjIwNTY4","avatar_url":"https://avatars.githubusercontent.com/u/20568?v=4","gravatar_id":"","url":"https://api.github.com/users/certik","html_url":"https://github.com/certik","followers_url":"https://api.github.com/users/certik/followers","following_url":"https://api.github.com/users/certik/following{/other_user}","gists_url":"https://api.github.com/users/certik/gists{/gist_id}","starred_url":"https://api.github.com/users/certik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/certik/subscriptions","organizations_url":"https://api.github.com/users/certik/orgs","repos_url":"https://api.github.com/users/certik/repos","events_url":"https://api.github.com/users/certik/events{/privacy}","received_events_url":"https://api.github.com/users/certik/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/lfortran/lfortran/issues/comments/1275902934","html_url":"https://github.com/lfortran/lfortran/issues/889#issuecomment-1275902934","issue_url":"https://api.github.com/repos/lfortran/lfortran/issues/889","id":1275902934,"node_id":"IC_kwDOCpMuHc5MDLvW","user":{"login":"konradha","id":9871746,"node_id":"MDQ6VXNlcjk4NzE3NDY=","avatar_url":"https://avatars.githubusercontent.com/u/9871746?v=4","gravatar_id":"","url":"https://api.github.com/users/konradha","html_url":"https://github.com/konradha","followers_url":"https://api.github.com/users/konradha/followers","following_url":"https://api.github.com/users/konradha/following{/other_user}","gists_url":"https://api.github.com/users/konradha/gists{/gist_id}","starred_url":"https://api.github.com/users/konradha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/konradha/subscriptions","organizations_url":"https://api.github.com/users/konradha/orgs","repos_url":"https://api.github.com/users/konradha/repos","events_url":"https://api.github.com/users/konradha/events{/privacy}","received_events_url":"https://api.github.com/users/konradha/received_events","type":"User","site_admin":false},"created_at":"2022-10-12T09:55:28Z","updated_at":"2022-10-12T09:56:00Z","author_association":"CONTRIBUTOR","body":"The conda-forge package is missing `wasm-ld` though (which also supports the high prioritization to update the LLVM backend).","reactions":{"url":"https://api.github.com/repos/lfortran/lfortran/issues/comments/1275902934/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"konradha","id":9871746,"node_id":"MDQ6VXNlcjk4NzE3NDY=","avatar_url":"https://avatars.githubusercontent.com/u/9871746?v=4","gravatar_id":"","url":"https://api.github.com/users/konradha","html_url":"https://github.com/konradha","followers_url":"https://api.github.com/users/konradha/followers","following_url":"https://api.github.com/users/konradha/following{/other_user}","gists_url":"https://api.github.com/users/konradha/gists{/gist_id}","starred_url":"https://api.github.com/users/konradha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/konradha/subscriptions","organizations_url":"https://api.github.com/users/konradha/orgs","repos_url":"https://api.github.com/users/konradha/repos","events_url":"https://api.github.com/users/konradha/events{/privacy}","received_events_url":"https://api.github.com/users/konradha/received_events","type":"User","site_admin":false}}]