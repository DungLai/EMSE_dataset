{"url":"https://api.github.com/repos/HazyResearch/fonduer/issues/278","repository_url":"https://api.github.com/repos/HazyResearch/fonduer","labels_url":"https://api.github.com/repos/HazyResearch/fonduer/issues/278/labels{/name}","comments_url":"https://api.github.com/repos/HazyResearch/fonduer/issues/278/comments","events_url":"https://api.github.com/repos/HazyResearch/fonduer/issues/278/events","html_url":"https://github.com/HazyResearch/fonduer/issues/278","id":460357871,"node_id":"MDU6SXNzdWU0NjAzNTc4NzE=","number":278,"title":"Removing several documents from the database by name?","user":{"login":"lauratolosi","id":9861330,"node_id":"MDQ6VXNlcjk4NjEzMzA=","avatar_url":"https://avatars.githubusercontent.com/u/9861330?v=4","gravatar_id":"","url":"https://api.github.com/users/lauratolosi","html_url":"https://github.com/lauratolosi","followers_url":"https://api.github.com/users/lauratolosi/followers","following_url":"https://api.github.com/users/lauratolosi/following{/other_user}","gists_url":"https://api.github.com/users/lauratolosi/gists{/gist_id}","starred_url":"https://api.github.com/users/lauratolosi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lauratolosi/subscriptions","organizations_url":"https://api.github.com/users/lauratolosi/orgs","repos_url":"https://api.github.com/users/lauratolosi/repos","events_url":"https://api.github.com/users/lauratolosi/events{/privacy}","received_events_url":"https://api.github.com/users/lauratolosi/received_events","type":"User","site_admin":false},"labels":[{"id":825323864,"node_id":"MDU6TGFiZWw4MjUzMjM4NjQ=","url":"https://api.github.com/repos/HazyResearch/fonduer/labels/discussion","name":"discussion","color":"d876e3","default":false,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-06-25T11:05:09Z","updated_at":"2019-07-23T21:29:04Z","closed_at":"2019-07-23T21:28:40Z","author_association":"NONE","active_lock_reason":null,"body":"I want to test the Fonduer model on new files (pdfs), in a separate pipeline. \r\nI need to ensure that the file is not already in the database (which results in an error and failure anyway).\r\nThe solution that I see is to delete the test documents and all related elements from the database before the testing - if they exist. \r\n\r\nCan anyone please help with a procedure that deletes documents by name? \r\n\r\nI have tried to delete from table `documents`:\r\n```\r\n#delete from document where id = 141250;\r\nERROR:  update or delete on table \"document\" violates foreign key constraint \r\n\"table_document_id_fkey\" on table \"table\"\r\nDETAIL:  Key (id)=(141250) is still referenced from table \"table\".\r\n```\r\n\r\nThe following is the detailed information on table `document` . It does not allow `CASCADE DELETE` on foreign keys on tables `table`, `caption`, `paragraph`, `sentence`, etc\r\n\r\n```\r\n#\\d+ document\r\n ...\r\nIndexes:\r\n    \"document_pkey\" PRIMARY KEY, btree (id)\r\n    \"document_name_key\" UNIQUE CONSTRAINT, btree (name)\r\nForeign-key constraints:\r\n    \"document_id_fkey\" FOREIGN KEY (id) REFERENCES context(id) ON DELETE CASCADE\r\nReferenced by:\r\n    TABLE \"caption\" CONSTRAINT \"caption_document_id_fkey\" FOREIGN KEY (document_id) REFERENCES document(id)\r\n    TABLE \"cell\" CONSTRAINT \"cell_document_id_fkey\" FOREIGN KEY (document_id) REFERENCES document(id)\r\n    TABLE \"figure\" CONSTRAINT \"figure_document_id_fkey\" FOREIGN KEY (document_id) REFERENCES document(id) ON DELETE CASCADE\r\n    TABLE \"model\" CONSTRAINT \"model_document_id_fkey\" FOREIGN KEY (document_id) REFERENCES document(id) ON DELETE CASCADE\r\n    TABLE \"model_power\" CONSTRAINT \"model_power_document_id_fkey\" FOREIGN KEY (document_id) REFERENCES document(id) ON DELETE CASCADE\r\n    TABLE \"paragraph\" CONSTRAINT \"paragraph_document_id_fkey\" FOREIGN KEY (document_id) REFERENCES document(id)\r\n    TABLE \"power\" CONSTRAINT \"power_document_id_fkey\" FOREIGN KEY (document_id) REFERENCES document(id) ON DELETE CASCADE\r\n    TABLE \"section\" CONSTRAINT \"section_document_id_fkey\" FOREIGN KEY (document_id) REFERENCES document(id) ON DELETE CASCADE\r\n    TABLE \"sentence\" CONSTRAINT \"sentence_document_id_fkey\" FOREIGN KEY (document_id) REFERENCES document(id)\r\n    TABLE \"\"table\"\" CONSTRAINT \"table_document_id_fkey\" FOREIGN KEY (document_id) REFERENCES document(id)\r\n```\r\n\r\nI have tried to delete from table `context`, but I am getting the same conflict.","closed_by":{"login":"senwu","id":5580008,"node_id":"MDQ6VXNlcjU1ODAwMDg=","avatar_url":"https://avatars.githubusercontent.com/u/5580008?v=4","gravatar_id":"","url":"https://api.github.com/users/senwu","html_url":"https://github.com/senwu","followers_url":"https://api.github.com/users/senwu/followers","following_url":"https://api.github.com/users/senwu/following{/other_user}","gists_url":"https://api.github.com/users/senwu/gists{/gist_id}","starred_url":"https://api.github.com/users/senwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/senwu/subscriptions","organizations_url":"https://api.github.com/users/senwu/orgs","repos_url":"https://api.github.com/users/senwu/repos","events_url":"https://api.github.com/users/senwu/events{/privacy}","received_events_url":"https://api.github.com/users/senwu/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/HazyResearch/fonduer/issues/278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/HazyResearch/fonduer/issues/278/timeline","performed_via_github_app":null,"state_reason":"completed"}