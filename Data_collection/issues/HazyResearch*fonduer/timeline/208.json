[{"id":2097775927,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQyMDk3Nzc1OTI3","url":"https://api.github.com/repos/HazyResearch/fonduer/issues/events/2097775927","actor":{"login":"lukehsiao","id":7573542,"node_id":"MDQ6VXNlcjc1NzM1NDI=","avatar_url":"https://avatars.githubusercontent.com/u/7573542?v=4","gravatar_id":"","url":"https://api.github.com/users/lukehsiao","html_url":"https://github.com/lukehsiao","followers_url":"https://api.github.com/users/lukehsiao/followers","following_url":"https://api.github.com/users/lukehsiao/following{/other_user}","gists_url":"https://api.github.com/users/lukehsiao/gists{/gist_id}","starred_url":"https://api.github.com/users/lukehsiao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukehsiao/subscriptions","organizations_url":"https://api.github.com/users/lukehsiao/orgs","repos_url":"https://api.github.com/users/lukehsiao/repos","events_url":"https://api.github.com/users/lukehsiao/events{/privacy}","received_events_url":"https://api.github.com/users/lukehsiao/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2019-01-25T17:36:02Z","assignee":{"login":"senwu","id":5580008,"node_id":"MDQ6VXNlcjU1ODAwMDg=","avatar_url":"https://avatars.githubusercontent.com/u/5580008?v=4","gravatar_id":"","url":"https://api.github.com/users/senwu","html_url":"https://github.com/senwu","followers_url":"https://api.github.com/users/senwu/followers","following_url":"https://api.github.com/users/senwu/following{/other_user}","gists_url":"https://api.github.com/users/senwu/gists{/gist_id}","starred_url":"https://api.github.com/users/senwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/senwu/subscriptions","organizations_url":"https://api.github.com/users/senwu/orgs","repos_url":"https://api.github.com/users/senwu/repos","events_url":"https://api.github.com/users/senwu/events{/privacy}","received_events_url":"https://api.github.com/users/senwu/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/HazyResearch/fonduer/issues/comments/457860786","html_url":"https://github.com/HazyResearch/fonduer/issues/208#issuecomment-457860786","issue_url":"https://api.github.com/repos/HazyResearch/fonduer/issues/208","id":457860786,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1Nzg2MDc4Ng==","user":{"login":"senwu","id":5580008,"node_id":"MDQ6VXNlcjU1ODAwMDg=","avatar_url":"https://avatars.githubusercontent.com/u/5580008?v=4","gravatar_id":"","url":"https://api.github.com/users/senwu","html_url":"https://github.com/senwu","followers_url":"https://api.github.com/users/senwu/followers","following_url":"https://api.github.com/users/senwu/following{/other_user}","gists_url":"https://api.github.com/users/senwu/gists{/gist_id}","starred_url":"https://api.github.com/users/senwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/senwu/subscriptions","organizations_url":"https://api.github.com/users/senwu/orgs","repos_url":"https://api.github.com/users/senwu/repos","events_url":"https://api.github.com/users/senwu/events{/privacy}","received_events_url":"https://api.github.com/users/senwu/received_events","type":"User","site_admin":false},"created_at":"2019-01-26T19:55:46Z","updated_at":"2019-01-26T19:55:46Z","author_association":"COLLABORATOR","body":"Hi @rahultripathi94,\r\n\r\nThanks for posting your issue here. As you may be aware, in Fonduer learning, it builds the model during training (see here for ref: https://github.com/HazyResearch/fonduer/blob/master/src/fonduer/learning/classifier.py#L198). So when you load the model directly it causes the issue. We are planning to update this design (separate building model and training) in the next release.\r\n\r\nOne workaround now is to use train function to build the model first and then load the model. Here is an example:\r\n\r\n```py\r\n# Original model\r\ndisc_model = LogisticRegression()\r\n%time disc_model.train((train_cands_person[0], F_train_cands_person[0]), train_marginals, n_epochs=50,batch_size=256, lr=0.0001)\r\n# Save original model\r\ndisc_model.save(model_name=\"disc_model\", save_dir='checkpoints', verbose=True, global_step=0)\r\n\r\n# Define the new model\r\nnew_model = LogisticRegression()\r\n# Use train to build the model first\r\n%time new_model.train((train_cands_person[0], F_train_cands_person[0]), train_marginals, n_epochs=0)\r\n# Load the model next\r\nnew_model.load(model_name=\"disc_model\", save_dir='checkpoints', verbose=True, global_step=0)\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/HazyResearch/fonduer/issues/comments/457860786/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"senwu","id":5580008,"node_id":"MDQ6VXNlcjU1ODAwMDg=","avatar_url":"https://avatars.githubusercontent.com/u/5580008?v=4","gravatar_id":"","url":"https://api.github.com/users/senwu","html_url":"https://github.com/senwu","followers_url":"https://api.github.com/users/senwu/followers","following_url":"https://api.github.com/users/senwu/following{/other_user}","gists_url":"https://api.github.com/users/senwu/gists{/gist_id}","starred_url":"https://api.github.com/users/senwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/senwu/subscriptions","organizations_url":"https://api.github.com/users/senwu/orgs","repos_url":"https://api.github.com/users/senwu/repos","events_url":"https://api.github.com/users/senwu/events{/privacy}","received_events_url":"https://api.github.com/users/senwu/received_events","type":"User","site_admin":false}},{"id":2098998527,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjA5ODk5ODUyNw==","url":"https://api.github.com/repos/HazyResearch/fonduer/issues/events/2098998527","actor":{"login":"rahultripathi94","id":24509638,"node_id":"MDQ6VXNlcjI0NTA5NjM4","avatar_url":"https://avatars.githubusercontent.com/u/24509638?v=4","gravatar_id":"","url":"https://api.github.com/users/rahultripathi94","html_url":"https://github.com/rahultripathi94","followers_url":"https://api.github.com/users/rahultripathi94/followers","following_url":"https://api.github.com/users/rahultripathi94/following{/other_user}","gists_url":"https://api.github.com/users/rahultripathi94/gists{/gist_id}","starred_url":"https://api.github.com/users/rahultripathi94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rahultripathi94/subscriptions","organizations_url":"https://api.github.com/users/rahultripathi94/orgs","repos_url":"https://api.github.com/users/rahultripathi94/repos","events_url":"https://api.github.com/users/rahultripathi94/events{/privacy}","received_events_url":"https://api.github.com/users/rahultripathi94/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-01-26T19:55:46Z","performed_via_github_app":null},{"id":2098998528,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIwOTg5OTg1Mjg=","url":"https://api.github.com/repos/HazyResearch/fonduer/issues/events/2098998528","actor":{"login":"rahultripathi94","id":24509638,"node_id":"MDQ6VXNlcjI0NTA5NjM4","avatar_url":"https://avatars.githubusercontent.com/u/24509638?v=4","gravatar_id":"","url":"https://api.github.com/users/rahultripathi94","html_url":"https://github.com/rahultripathi94","followers_url":"https://api.github.com/users/rahultripathi94/followers","following_url":"https://api.github.com/users/rahultripathi94/following{/other_user}","gists_url":"https://api.github.com/users/rahultripathi94/gists{/gist_id}","starred_url":"https://api.github.com/users/rahultripathi94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rahultripathi94/subscriptions","organizations_url":"https://api.github.com/users/rahultripathi94/orgs","repos_url":"https://api.github.com/users/rahultripathi94/repos","events_url":"https://api.github.com/users/rahultripathi94/events{/privacy}","received_events_url":"https://api.github.com/users/rahultripathi94/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-01-26T19:55:46Z","performed_via_github_app":null},{"id":2105392214,"node_id":"MDExOkNsb3NlZEV2ZW50MjEwNTM5MjIxNA==","url":"https://api.github.com/repos/HazyResearch/fonduer/issues/events/2105392214","actor":{"login":"senwu","id":5580008,"node_id":"MDQ6VXNlcjU1ODAwMDg=","avatar_url":"https://avatars.githubusercontent.com/u/5580008?v=4","gravatar_id":"","url":"https://api.github.com/users/senwu","html_url":"https://github.com/senwu","followers_url":"https://api.github.com/users/senwu/followers","following_url":"https://api.github.com/users/senwu/following{/other_user}","gists_url":"https://api.github.com/users/senwu/gists{/gist_id}","starred_url":"https://api.github.com/users/senwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/senwu/subscriptions","organizations_url":"https://api.github.com/users/senwu/orgs","repos_url":"https://api.github.com/users/senwu/repos","events_url":"https://api.github.com/users/senwu/events{/privacy}","received_events_url":"https://api.github.com/users/senwu/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-01-30T02:41:26Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/HazyResearch/fonduer/issues/comments/488478384","html_url":"https://github.com/HazyResearch/fonduer/issues/208#issuecomment-488478384","issue_url":"https://api.github.com/repos/HazyResearch/fonduer/issues/208","id":488478384,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4ODQ3ODM4NA==","user":{"login":"HiromuHota","id":20668349,"node_id":"MDQ6VXNlcjIwNjY4MzQ5","avatar_url":"https://avatars.githubusercontent.com/u/20668349?v=4","gravatar_id":"","url":"https://api.github.com/users/HiromuHota","html_url":"https://github.com/HiromuHota","followers_url":"https://api.github.com/users/HiromuHota/followers","following_url":"https://api.github.com/users/HiromuHota/following{/other_user}","gists_url":"https://api.github.com/users/HiromuHota/gists{/gist_id}","starred_url":"https://api.github.com/users/HiromuHota/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HiromuHota/subscriptions","organizations_url":"https://api.github.com/users/HiromuHota/orgs","repos_url":"https://api.github.com/users/HiromuHota/repos","events_url":"https://api.github.com/users/HiromuHota/events{/privacy}","received_events_url":"https://api.github.com/users/HiromuHota/received_events","type":"User","site_admin":false},"created_at":"2019-05-01T23:06:01Z","updated_at":"2019-05-01T23:06:01Z","author_association":"CONTRIBUTOR","body":"As another workaround, you could also do\r\n\r\n```\r\n# Define the new model\r\nnew_model = LogisticRegression()\r\n\r\n# Manually load settings and cardinality from a saved trained model.\r\ncheckpoint = torch.load(\"./best_model.pt\")\r\nnew_model.settings = checkpoint[\"config\"]\r\nnew_model.cardinality = checkpoint[\"cardinality\"]\r\n\r\n# Build a model using the loaded settings and cardinality.\r\nnew_model._build_model()\r\n\r\n# Load the trained model\r\nnew_model.load(model_file=\"best_model.pt\", save_dir=\"./\")\r\n```","reactions":{"url":"https://api.github.com/repos/HazyResearch/fonduer/issues/comments/488478384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"HiromuHota","id":20668349,"node_id":"MDQ6VXNlcjIwNjY4MzQ5","avatar_url":"https://avatars.githubusercontent.com/u/20668349?v=4","gravatar_id":"","url":"https://api.github.com/users/HiromuHota","html_url":"https://github.com/HiromuHota","followers_url":"https://api.github.com/users/HiromuHota/followers","following_url":"https://api.github.com/users/HiromuHota/following{/other_user}","gists_url":"https://api.github.com/users/HiromuHota/gists{/gist_id}","starred_url":"https://api.github.com/users/HiromuHota/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HiromuHota/subscriptions","organizations_url":"https://api.github.com/users/HiromuHota/orgs","repos_url":"https://api.github.com/users/HiromuHota/repos","events_url":"https://api.github.com/users/HiromuHota/events{/privacy}","received_events_url":"https://api.github.com/users/HiromuHota/received_events","type":"User","site_admin":false}}]