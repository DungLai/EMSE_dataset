{"url":"https://api.github.com/repos/xiongma/transformer-pointer-generator/issues/20","repository_url":"https://api.github.com/repos/xiongma/transformer-pointer-generator","labels_url":"https://api.github.com/repos/xiongma/transformer-pointer-generator/issues/20/labels{/name}","comments_url":"https://api.github.com/repos/xiongma/transformer-pointer-generator/issues/20/comments","events_url":"https://api.github.com/repos/xiongma/transformer-pointer-generator/issues/20/events","html_url":"https://github.com/xiongma/transformer-pointer-generator/issues/20","id":487882222,"node_id":"MDU6SXNzdWU0ODc4ODIyMjI=","number":20,"title":"\"InvalidArgumentError (see above for traceback): indices[6,25] = 25 is not in [0, 25)\"","user":{"login":"lisi-github","id":9844441,"node_id":"MDQ6VXNlcjk4NDQ0NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9844441?v=4","gravatar_id":"","url":"https://api.github.com/users/lisi-github","html_url":"https://github.com/lisi-github","followers_url":"https://api.github.com/users/lisi-github/followers","following_url":"https://api.github.com/users/lisi-github/following{/other_user}","gists_url":"https://api.github.com/users/lisi-github/gists{/gist_id}","starred_url":"https://api.github.com/users/lisi-github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lisi-github/subscriptions","organizations_url":"https://api.github.com/users/lisi-github/orgs","repos_url":"https://api.github.com/users/lisi-github/repos","events_url":"https://api.github.com/users/lisi-github/events{/privacy}","received_events_url":"https://api.github.com/users/lisi-github/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-09-01T12:49:52Z","updated_at":"2019-10-08T03:04:16Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi policeme, thank you for sharing the code!\r\nBut i have some trouble in running the codeï¼Œwhile the vocab size of the training equals that in predicting. And other parameters are the same with yours. Did you have the same problem with me. I'm pending for your solution.\r\n\r\n\r\nFull Error Trace is as follows:\r\n\"\"\"\"\"\r\n# hparams\r\n2019-09-01 19:12:35.633634: I T:\\src\\github\\tensorflow\\tensorflow\\core\\platform\\cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2\r\nTraceback (most recent call last):\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1278, in _do_call\r\n    return fn(*args)\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1263, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1350, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: indices[6,25] = 25 is not in [0, 25)\r\n\t [[Node: predict/decode_5/positional_encoding/embedding_lookup = GatherV2[Taxis=DT_INT32, Tindices=DT_INT32, Tparams=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](predict/decode_24/positional_encoding/Const, predict/decode_5/positional_encoding/Tile, predict/decode_5/positional_encoding/embedding_lookup/axis)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"D:/work/nlg/code/transformer-nlg-1/train.py\", line 75, in <module>\r\n    train()\r\n  File \"D:/work/nlg/code/transformer-nlg-1/train.py\", line 40, in train\r\n    m.encoder_input: article_id, m.decoder_input: title_id, m.decoder_output: target_id\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 877, in run\r\n    run_metadata_ptr)\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1100, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1272, in _do_run\r\n    run_metadata)\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1291, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: indices[6,25] = 25 is not in [0, 25)\r\n\t [[Node: predict/decode_5/positional_encoding/embedding_lookup = GatherV2[Taxis=DT_INT32, Tindices=DT_INT32, Tparams=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](predict/decode_24/positional_encoding/Const, predict/decode_5/positional_encoding/Tile, predict/decode_5/positional_encoding/embedding_lookup/axis)]]\r\n\r\nCaused by op 'predict/decode_5/positional_encoding/embedding_lookup', defined at:\r\n  File \"D:/work/nlg/code/transformer-nlg-1/train.py\", line 75, in <module>\r\n    train()\r\n  File \"D:/work/nlg/code/transformer-nlg-1/train.py\", line 34, in train\r\n    m = Transformer(hp)\r\n  File \"D:\\work\\nlg\\code\\transformer-nlg-1\\model.py\", line 49, in __init__\r\n    logits = self.decode(self.encoder_input, dec_input, memory, False)\r\n  File \"D:\\work\\nlg\\code\\transformer-nlg-1\\model.py\", line 134, in decode\r\n    dec += positional_encoding(dec, self.hp.maxlen2)\r\n  File \"D:\\work\\nlg\\code\\transformer-nlg-1\\modules.py\", line 278, in positional_encoding\r\n    outputs = tf.nn.embedding_lookup(position_enc, position_ind)\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\ops\\embedding_ops.py\", line 310, in embedding_lookup\r\n    transform_fn=None)\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\ops\\embedding_ops.py\", line 133, in _embedding_lookup_and_transform\r\n    result = _clip(array_ops.gather(params[0], ids, name=name),\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\ops\\array_ops.py\", line 2659, in gather\r\n    return gen_array_ops.gather_v2(params, indices, axis, name=name)\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_array_ops.py\", line 3761, in gather_v2\r\n    \"GatherV2\", params=params, indices=indices, axis=axis, name=name)\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\util\\deprecation.py\", line 454, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3155, in create_op\r\n    op_def=op_def)\r\n  File \"D:\\python\\python3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1717, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): indices[6,25] = 25 is not in [0, 25)\r\n\t [[Node: predict/decode_5/positional_encoding/embedding_lookup = GatherV2[Taxis=DT_INT32, Tindices=DT_INT32, Tparams=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](predict/decode_24/positional_encoding/Const, predict/decode_5/positional_encoding/Tile, predict/decode_5/positional_encoding/embedding_lookup/axis)]]\r\n\r\n\r\nProcess finished with exit code 1\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/xiongma/transformer-pointer-generator/issues/20/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/xiongma/transformer-pointer-generator/issues/20/timeline","performed_via_github_app":null,"state_reason":null}