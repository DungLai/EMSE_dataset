[{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/438314140","html_url":"https://github.com/adambielski/siamese-triplet/issues/17#issuecomment-438314140","issue_url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/17","id":438314140,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODMxNDE0MA==","user":{"login":"adambielski","id":14027793,"node_id":"MDQ6VXNlcjE0MDI3Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/14027793?v=4","gravatar_id":"","url":"https://api.github.com/users/adambielski","html_url":"https://github.com/adambielski","followers_url":"https://api.github.com/users/adambielski/followers","following_url":"https://api.github.com/users/adambielski/following{/other_user}","gists_url":"https://api.github.com/users/adambielski/gists{/gist_id}","starred_url":"https://api.github.com/users/adambielski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adambielski/subscriptions","organizations_url":"https://api.github.com/users/adambielski/orgs","repos_url":"https://api.github.com/users/adambielski/repos","events_url":"https://api.github.com/users/adambielski/events{/privacy}","received_events_url":"https://api.github.com/users/adambielski/received_events","type":"User","site_admin":false},"created_at":"2018-11-13T15:46:01Z","updated_at":"2018-11-13T15:46:01Z","author_association":"OWNER","body":"ReLU should work just as well. I chose PReLU because their outputs serve better for visualizations. And personally I like the idea of a learnable slope in the activation function (although various papers show it's not always better)","reactions":{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/438314140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adambielski","id":14027793,"node_id":"MDQ6VXNlcjE0MDI3Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/14027793?v=4","gravatar_id":"","url":"https://api.github.com/users/adambielski","html_url":"https://github.com/adambielski","followers_url":"https://api.github.com/users/adambielski/followers","following_url":"https://api.github.com/users/adambielski/following{/other_user}","gists_url":"https://api.github.com/users/adambielski/gists{/gist_id}","starred_url":"https://api.github.com/users/adambielski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adambielski/subscriptions","organizations_url":"https://api.github.com/users/adambielski/orgs","repos_url":"https://api.github.com/users/adambielski/repos","events_url":"https://api.github.com/users/adambielski/events{/privacy}","received_events_url":"https://api.github.com/users/adambielski/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/438338731","html_url":"https://github.com/adambielski/siamese-triplet/issues/17#issuecomment-438338731","issue_url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/17","id":438338731,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODMzODczMQ==","user":{"login":"w-hc","id":17956191,"node_id":"MDQ6VXNlcjE3OTU2MTkx","avatar_url":"https://avatars.githubusercontent.com/u/17956191?v=4","gravatar_id":"","url":"https://api.github.com/users/w-hc","html_url":"https://github.com/w-hc","followers_url":"https://api.github.com/users/w-hc/followers","following_url":"https://api.github.com/users/w-hc/following{/other_user}","gists_url":"https://api.github.com/users/w-hc/gists{/gist_id}","starred_url":"https://api.github.com/users/w-hc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w-hc/subscriptions","organizations_url":"https://api.github.com/users/w-hc/orgs","repos_url":"https://api.github.com/users/w-hc/repos","events_url":"https://api.github.com/users/w-hc/events{/privacy}","received_events_url":"https://api.github.com/users/w-hc/received_events","type":"User","site_admin":false},"created_at":"2018-11-13T16:32:55Z","updated_at":"2018-11-13T16:33:45Z","author_association":"NONE","body":"But I tried replacing PReLU with ReLU, keeping the other config unchanged, and the training does not converge. The default setup seems reasonable though. It seems a little surprising.","reactions":{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/438338731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"w-hc","id":17956191,"node_id":"MDQ6VXNlcjE3OTU2MTkx","avatar_url":"https://avatars.githubusercontent.com/u/17956191?v=4","gravatar_id":"","url":"https://api.github.com/users/w-hc","html_url":"https://github.com/w-hc","followers_url":"https://api.github.com/users/w-hc/followers","following_url":"https://api.github.com/users/w-hc/following{/other_user}","gists_url":"https://api.github.com/users/w-hc/gists{/gist_id}","starred_url":"https://api.github.com/users/w-hc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w-hc/subscriptions","organizations_url":"https://api.github.com/users/w-hc/orgs","repos_url":"https://api.github.com/users/w-hc/repos","events_url":"https://api.github.com/users/w-hc/events{/privacy}","received_events_url":"https://api.github.com/users/w-hc/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/438607841","html_url":"https://github.com/adambielski/siamese-triplet/issues/17#issuecomment-438607841","issue_url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/17","id":438607841,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODYwNzg0MQ==","user":{"login":"adambielski","id":14027793,"node_id":"MDQ6VXNlcjE0MDI3Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/14027793?v=4","gravatar_id":"","url":"https://api.github.com/users/adambielski","html_url":"https://github.com/adambielski","followers_url":"https://api.github.com/users/adambielski/followers","following_url":"https://api.github.com/users/adambielski/following{/other_user}","gists_url":"https://api.github.com/users/adambielski/gists{/gist_id}","starred_url":"https://api.github.com/users/adambielski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adambielski/subscriptions","organizations_url":"https://api.github.com/users/adambielski/orgs","repos_url":"https://api.github.com/users/adambielski/repos","events_url":"https://api.github.com/users/adambielski/events{/privacy}","received_events_url":"https://api.github.com/users/adambielski/received_events","type":"User","site_admin":false},"created_at":"2018-11-14T10:07:29Z","updated_at":"2018-11-14T10:08:07Z","author_association":"OWNER","body":"For training with ReLU, you need to initialize convolutional layers more carefully. E.g. you can use kaiming initialization with gain for ReLU nonlinearity. You can do it with these lines in initialization of EmbeddingNet:\r\n```\r\nfor m in self.modules():\r\n    if isinstance(m, nn.Conv2d):\r\n        nn.init.kaiming_normal_(m.weight, mode='fan_out', nonlinearity='relu')\r\n```","reactions":{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/438607841/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adambielski","id":14027793,"node_id":"MDQ6VXNlcjE0MDI3Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/14027793?v=4","gravatar_id":"","url":"https://api.github.com/users/adambielski","html_url":"https://github.com/adambielski","followers_url":"https://api.github.com/users/adambielski/followers","following_url":"https://api.github.com/users/adambielski/following{/other_user}","gists_url":"https://api.github.com/users/adambielski/gists{/gist_id}","starred_url":"https://api.github.com/users/adambielski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adambielski/subscriptions","organizations_url":"https://api.github.com/users/adambielski/orgs","repos_url":"https://api.github.com/users/adambielski/repos","events_url":"https://api.github.com/users/adambielski/events{/privacy}","received_events_url":"https://api.github.com/users/adambielski/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/439005773","html_url":"https://github.com/adambielski/siamese-triplet/issues/17#issuecomment-439005773","issue_url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/17","id":439005773,"node_id":"MDEyOklzc3VlQ29tbWVudDQzOTAwNTc3Mw==","user":{"login":"adambielski","id":14027793,"node_id":"MDQ6VXNlcjE0MDI3Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/14027793?v=4","gravatar_id":"","url":"https://api.github.com/users/adambielski","html_url":"https://github.com/adambielski","followers_url":"https://api.github.com/users/adambielski/followers","following_url":"https://api.github.com/users/adambielski/following{/other_user}","gists_url":"https://api.github.com/users/adambielski/gists{/gist_id}","starred_url":"https://api.github.com/users/adambielski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adambielski/subscriptions","organizations_url":"https://api.github.com/users/adambielski/orgs","repos_url":"https://api.github.com/users/adambielski/repos","events_url":"https://api.github.com/users/adambielski/events{/privacy}","received_events_url":"https://api.github.com/users/adambielski/received_events","type":"User","site_admin":false},"created_at":"2018-11-15T11:15:42Z","updated_at":"2018-11-15T11:15:42Z","author_association":"OWNER","body":"@w-hc did you try training with this change?","reactions":{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/439005773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adambielski","id":14027793,"node_id":"MDQ6VXNlcjE0MDI3Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/14027793?v=4","gravatar_id":"","url":"https://api.github.com/users/adambielski","html_url":"https://github.com/adambielski","followers_url":"https://api.github.com/users/adambielski/followers","following_url":"https://api.github.com/users/adambielski/following{/other_user}","gists_url":"https://api.github.com/users/adambielski/gists{/gist_id}","starred_url":"https://api.github.com/users/adambielski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adambielski/subscriptions","organizations_url":"https://api.github.com/users/adambielski/orgs","repos_url":"https://api.github.com/users/adambielski/repos","events_url":"https://api.github.com/users/adambielski/events{/privacy}","received_events_url":"https://api.github.com/users/adambielski/received_events","type":"User","site_admin":false}},{"id":1968352897,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTk2ODM1Mjg5Nw==","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/1968352897","actor":{"login":"w-hc","id":17956191,"node_id":"MDQ6VXNlcjE3OTU2MTkx","avatar_url":"https://avatars.githubusercontent.com/u/17956191?v=4","gravatar_id":"","url":"https://api.github.com/users/w-hc","html_url":"https://github.com/w-hc","followers_url":"https://api.github.com/users/w-hc/followers","following_url":"https://api.github.com/users/w-hc/following{/other_user}","gists_url":"https://api.github.com/users/w-hc/gists{/gist_id}","starred_url":"https://api.github.com/users/w-hc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w-hc/subscriptions","organizations_url":"https://api.github.com/users/w-hc/orgs","repos_url":"https://api.github.com/users/w-hc/repos","events_url":"https://api.github.com/users/w-hc/events{/privacy}","received_events_url":"https://api.github.com/users/w-hc/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-11-15T11:15:42Z","performed_via_github_app":null},{"id":1968352898,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE5NjgzNTI4OTg=","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/1968352898","actor":{"login":"w-hc","id":17956191,"node_id":"MDQ6VXNlcjE3OTU2MTkx","avatar_url":"https://avatars.githubusercontent.com/u/17956191?v=4","gravatar_id":"","url":"https://api.github.com/users/w-hc","html_url":"https://github.com/w-hc","followers_url":"https://api.github.com/users/w-hc/followers","following_url":"https://api.github.com/users/w-hc/following{/other_user}","gists_url":"https://api.github.com/users/w-hc/gists{/gist_id}","starred_url":"https://api.github.com/users/w-hc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w-hc/subscriptions","organizations_url":"https://api.github.com/users/w-hc/orgs","repos_url":"https://api.github.com/users/w-hc/repos","events_url":"https://api.github.com/users/w-hc/events{/privacy}","received_events_url":"https://api.github.com/users/w-hc/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-11-15T11:15:42Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/439104908","html_url":"https://github.com/adambielski/siamese-triplet/issues/17#issuecomment-439104908","issue_url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/17","id":439104908,"node_id":"MDEyOklzc3VlQ29tbWVudDQzOTEwNDkwOA==","user":{"login":"w-hc","id":17956191,"node_id":"MDQ6VXNlcjE3OTU2MTkx","avatar_url":"https://avatars.githubusercontent.com/u/17956191?v=4","gravatar_id":"","url":"https://api.github.com/users/w-hc","html_url":"https://github.com/w-hc","followers_url":"https://api.github.com/users/w-hc/followers","following_url":"https://api.github.com/users/w-hc/following{/other_user}","gists_url":"https://api.github.com/users/w-hc/gists{/gist_id}","starred_url":"https://api.github.com/users/w-hc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w-hc/subscriptions","organizations_url":"https://api.github.com/users/w-hc/orgs","repos_url":"https://api.github.com/users/w-hc/repos","events_url":"https://api.github.com/users/w-hc/events{/privacy}","received_events_url":"https://api.github.com/users/w-hc/received_events","type":"User","site_admin":false},"created_at":"2018-11-15T16:37:54Z","updated_at":"2018-11-15T16:37:54Z","author_association":"NONE","body":"I will try in a minute. Sry.","reactions":{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/439104908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"w-hc","id":17956191,"node_id":"MDQ6VXNlcjE3OTU2MTkx","avatar_url":"https://avatars.githubusercontent.com/u/17956191?v=4","gravatar_id":"","url":"https://api.github.com/users/w-hc","html_url":"https://github.com/w-hc","followers_url":"https://api.github.com/users/w-hc/followers","following_url":"https://api.github.com/users/w-hc/following{/other_user}","gists_url":"https://api.github.com/users/w-hc/gists{/gist_id}","starred_url":"https://api.github.com/users/w-hc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w-hc/subscriptions","organizations_url":"https://api.github.com/users/w-hc/orgs","repos_url":"https://api.github.com/users/w-hc/repos","events_url":"https://api.github.com/users/w-hc/events{/privacy}","received_events_url":"https://api.github.com/users/w-hc/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/439189732","html_url":"https://github.com/adambielski/siamese-triplet/issues/17#issuecomment-439189732","issue_url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/17","id":439189732,"node_id":"MDEyOklzc3VlQ29tbWVudDQzOTE4OTczMg==","user":{"login":"w-hc","id":17956191,"node_id":"MDQ6VXNlcjE3OTU2MTkx","avatar_url":"https://avatars.githubusercontent.com/u/17956191?v=4","gravatar_id":"","url":"https://api.github.com/users/w-hc","html_url":"https://github.com/w-hc","followers_url":"https://api.github.com/users/w-hc/followers","following_url":"https://api.github.com/users/w-hc/following{/other_user}","gists_url":"https://api.github.com/users/w-hc/gists{/gist_id}","starred_url":"https://api.github.com/users/w-hc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w-hc/subscriptions","organizations_url":"https://api.github.com/users/w-hc/orgs","repos_url":"https://api.github.com/users/w-hc/repos","events_url":"https://api.github.com/users/w-hc/events{/privacy}","received_events_url":"https://api.github.com/users/w-hc/received_events","type":"User","site_admin":false},"created_at":"2018-11-15T21:05:18Z","updated_at":"2018-11-15T23:34:29Z","author_association":"NONE","body":"No it still does not work. The basic classification training loss gets stuck at 2.3 i.e. random guessing. I don't think initialization can play such a huge role. It might really have to do with the fact that the final output is in 2d and in this case throwing away 3/4 of the space is too difficult for the network. \r\n\r\nupdate:\r\n1. lowering the starting learning rate down to 1e-3 can help to make a pure ReLU network trainable. It still converges much lower compared to PReLU. I should have spent a little more time doing hyper-parameter searching. The embedding looks as expected: 10 beams squeezed in the first quadrant.\r\n\r\n2. Using vanilla ReLU for all layers, and simply changing the nonlinear in classification net to a PReLU, with default initialization, would make the network converge faster and get good looking embeddings. Constraining them to a quadrant is really too difficult.","reactions":{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/439189732/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"w-hc","id":17956191,"node_id":"MDQ6VXNlcjE3OTU2MTkx","avatar_url":"https://avatars.githubusercontent.com/u/17956191?v=4","gravatar_id":"","url":"https://api.github.com/users/w-hc","html_url":"https://github.com/w-hc","followers_url":"https://api.github.com/users/w-hc/followers","following_url":"https://api.github.com/users/w-hc/following{/other_user}","gists_url":"https://api.github.com/users/w-hc/gists{/gist_id}","starred_url":"https://api.github.com/users/w-hc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w-hc/subscriptions","organizations_url":"https://api.github.com/users/w-hc/orgs","repos_url":"https://api.github.com/users/w-hc/repos","events_url":"https://api.github.com/users/w-hc/events{/privacy}","received_events_url":"https://api.github.com/users/w-hc/received_events","type":"User","site_admin":false}},{"id":1970001066,"node_id":"MDExOkNsb3NlZEV2ZW50MTk3MDAwMTA2Ng==","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/1970001066","actor":{"login":"w-hc","id":17956191,"node_id":"MDQ6VXNlcjE3OTU2MTkx","avatar_url":"https://avatars.githubusercontent.com/u/17956191?v=4","gravatar_id":"","url":"https://api.github.com/users/w-hc","html_url":"https://github.com/w-hc","followers_url":"https://api.github.com/users/w-hc/followers","following_url":"https://api.github.com/users/w-hc/following{/other_user}","gists_url":"https://api.github.com/users/w-hc/gists{/gist_id}","starred_url":"https://api.github.com/users/w-hc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w-hc/subscriptions","organizations_url":"https://api.github.com/users/w-hc/orgs","repos_url":"https://api.github.com/users/w-hc/repos","events_url":"https://api.github.com/users/w-hc/events{/privacy}","received_events_url":"https://api.github.com/users/w-hc/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2018-11-15T23:15:17Z","state_reason":null,"performed_via_github_app":null}]