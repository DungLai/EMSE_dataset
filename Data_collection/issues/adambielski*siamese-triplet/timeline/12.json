[{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/411699801","html_url":"https://github.com/adambielski/siamese-triplet/issues/12#issuecomment-411699801","issue_url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/12","id":411699801,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTY5OTgwMQ==","user":{"login":"sabrinazuraimi","id":21196685,"node_id":"MDQ6VXNlcjIxMTk2Njg1","avatar_url":"https://avatars.githubusercontent.com/u/21196685?v=4","gravatar_id":"","url":"https://api.github.com/users/sabrinazuraimi","html_url":"https://github.com/sabrinazuraimi","followers_url":"https://api.github.com/users/sabrinazuraimi/followers","following_url":"https://api.github.com/users/sabrinazuraimi/following{/other_user}","gists_url":"https://api.github.com/users/sabrinazuraimi/gists{/gist_id}","starred_url":"https://api.github.com/users/sabrinazuraimi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sabrinazuraimi/subscriptions","organizations_url":"https://api.github.com/users/sabrinazuraimi/orgs","repos_url":"https://api.github.com/users/sabrinazuraimi/repos","events_url":"https://api.github.com/users/sabrinazuraimi/events{/privacy}","received_events_url":"https://api.github.com/users/sabrinazuraimi/received_events","type":"User","site_admin":false},"created_at":"2018-08-09T09:39:48Z","updated_at":"2018-08-09T09:39:48Z","author_association":"NONE","body":"I'm also trying to run this with my own image folder(which has a huge number of classes) but I'm having problems with the triplet selections. Anyone have any idea how to implement the triplet selection?","reactions":{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/411699801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sabrinazuraimi","id":21196685,"node_id":"MDQ6VXNlcjIxMTk2Njg1","avatar_url":"https://avatars.githubusercontent.com/u/21196685?v=4","gravatar_id":"","url":"https://api.github.com/users/sabrinazuraimi","html_url":"https://github.com/sabrinazuraimi","followers_url":"https://api.github.com/users/sabrinazuraimi/followers","following_url":"https://api.github.com/users/sabrinazuraimi/following{/other_user}","gists_url":"https://api.github.com/users/sabrinazuraimi/gists{/gist_id}","starred_url":"https://api.github.com/users/sabrinazuraimi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sabrinazuraimi/subscriptions","organizations_url":"https://api.github.com/users/sabrinazuraimi/orgs","repos_url":"https://api.github.com/users/sabrinazuraimi/repos","events_url":"https://api.github.com/users/sabrinazuraimi/events{/privacy}","received_events_url":"https://api.github.com/users/sabrinazuraimi/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/413173229","html_url":"https://github.com/adambielski/siamese-triplet/issues/12#issuecomment-413173229","issue_url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/12","id":413173229,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzE3MzIyOQ==","user":{"login":"madarax64","id":4976654,"node_id":"MDQ6VXNlcjQ5NzY2NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4976654?v=4","gravatar_id":"","url":"https://api.github.com/users/madarax64","html_url":"https://github.com/madarax64","followers_url":"https://api.github.com/users/madarax64/followers","following_url":"https://api.github.com/users/madarax64/following{/other_user}","gists_url":"https://api.github.com/users/madarax64/gists{/gist_id}","starred_url":"https://api.github.com/users/madarax64/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/madarax64/subscriptions","organizations_url":"https://api.github.com/users/madarax64/orgs","repos_url":"https://api.github.com/users/madarax64/repos","events_url":"https://api.github.com/users/madarax64/events{/privacy}","received_events_url":"https://api.github.com/users/madarax64/received_events","type":"User","site_admin":false},"created_at":"2018-08-15T11:41:18Z","updated_at":"2018-08-15T11:47:15Z","author_association":"NONE","body":"Hello @salbatron @sabrinazuraimi ,\r\nI've also been working on this implementation for short while now, but specifically for the Triplet Network not the Siamese one. To train with your own data, I'd say the easiest way to get this working would be to:\r\n\r\na. Implement a custom Dataset class - specifically, inherit from the base Dataset class and implement the `__len__` and `__getitem__` methods as described in the [docs](https://pytorch.org/docs/stable/data.html) . When that's done, the DataLoaders should then be instantiated using your custom Dataset class.\r\n\r\nb. It is also necessary to implement a BalancedBatchSampler class as well, or simply edit the base version from the repo. This is because in the source code, within the constructor of the BalancedBatchSampler, it is apparently expected that the Dataset class/implementation used has a property called `train_labels` or `test_labels`, the contents of which are stored in the `labels` property of the BalancedBatchSampler. Therefore your Dataset implementation will have to include some way of getting the labels of the instances therein, and you'll need to edit the BalancedBatchSampler to populate its labels property using your chosen method/property.\r\n\r\nc. When all that;s done, the already-implemented Triplet selections should work out of the box as far as I can tell.\r\n\r\nI hope this was a little helpful to either of you guys.\r\n\r\nGood luck!","reactions":{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/413173229/reactions","total_count":6,"+1":6,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"madarax64","id":4976654,"node_id":"MDQ6VXNlcjQ5NzY2NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4976654?v=4","gravatar_id":"","url":"https://api.github.com/users/madarax64","html_url":"https://github.com/madarax64","followers_url":"https://api.github.com/users/madarax64/followers","following_url":"https://api.github.com/users/madarax64/following{/other_user}","gists_url":"https://api.github.com/users/madarax64/gists{/gist_id}","starred_url":"https://api.github.com/users/madarax64/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/madarax64/subscriptions","organizations_url":"https://api.github.com/users/madarax64/orgs","repos_url":"https://api.github.com/users/madarax64/repos","events_url":"https://api.github.com/users/madarax64/events{/privacy}","received_events_url":"https://api.github.com/users/madarax64/received_events","type":"User","site_admin":false}},{"id":1789843814,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTc4OTg0MzgxNA==","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/1789843814","actor":{"login":"sabrinazuraimi","id":21196685,"node_id":"MDQ6VXNlcjIxMTk2Njg1","avatar_url":"https://avatars.githubusercontent.com/u/21196685?v=4","gravatar_id":"","url":"https://api.github.com/users/sabrinazuraimi","html_url":"https://github.com/sabrinazuraimi","followers_url":"https://api.github.com/users/sabrinazuraimi/followers","following_url":"https://api.github.com/users/sabrinazuraimi/following{/other_user}","gists_url":"https://api.github.com/users/sabrinazuraimi/gists{/gist_id}","starred_url":"https://api.github.com/users/sabrinazuraimi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sabrinazuraimi/subscriptions","organizations_url":"https://api.github.com/users/sabrinazuraimi/orgs","repos_url":"https://api.github.com/users/sabrinazuraimi/repos","events_url":"https://api.github.com/users/sabrinazuraimi/events{/privacy}","received_events_url":"https://api.github.com/users/sabrinazuraimi/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-08-15T11:41:18Z","performed_via_github_app":null},{"id":1789843815,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE3ODk4NDM4MTU=","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/1789843815","actor":{"login":"sabrinazuraimi","id":21196685,"node_id":"MDQ6VXNlcjIxMTk2Njg1","avatar_url":"https://avatars.githubusercontent.com/u/21196685?v=4","gravatar_id":"","url":"https://api.github.com/users/sabrinazuraimi","html_url":"https://github.com/sabrinazuraimi","followers_url":"https://api.github.com/users/sabrinazuraimi/followers","following_url":"https://api.github.com/users/sabrinazuraimi/following{/other_user}","gists_url":"https://api.github.com/users/sabrinazuraimi/gists{/gist_id}","starred_url":"https://api.github.com/users/sabrinazuraimi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sabrinazuraimi/subscriptions","organizations_url":"https://api.github.com/users/sabrinazuraimi/orgs","repos_url":"https://api.github.com/users/sabrinazuraimi/repos","events_url":"https://api.github.com/users/sabrinazuraimi/events{/privacy}","received_events_url":"https://api.github.com/users/sabrinazuraimi/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-08-15T11:41:18Z","performed_via_github_app":null},{"id":1789843816,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTc4OTg0MzgxNg==","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/1789843816","actor":{"login":"salbatron","id":29922029,"node_id":"MDQ6VXNlcjI5OTIyMDI5","avatar_url":"https://avatars.githubusercontent.com/u/29922029?v=4","gravatar_id":"","url":"https://api.github.com/users/salbatron","html_url":"https://github.com/salbatron","followers_url":"https://api.github.com/users/salbatron/followers","following_url":"https://api.github.com/users/salbatron/following{/other_user}","gists_url":"https://api.github.com/users/salbatron/gists{/gist_id}","starred_url":"https://api.github.com/users/salbatron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/salbatron/subscriptions","organizations_url":"https://api.github.com/users/salbatron/orgs","repos_url":"https://api.github.com/users/salbatron/repos","events_url":"https://api.github.com/users/salbatron/events{/privacy}","received_events_url":"https://api.github.com/users/salbatron/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-08-15T11:41:18Z","performed_via_github_app":null},{"id":1789843817,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE3ODk4NDM4MTc=","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/1789843817","actor":{"login":"salbatron","id":29922029,"node_id":"MDQ6VXNlcjI5OTIyMDI5","avatar_url":"https://avatars.githubusercontent.com/u/29922029?v=4","gravatar_id":"","url":"https://api.github.com/users/salbatron","html_url":"https://github.com/salbatron","followers_url":"https://api.github.com/users/salbatron/followers","following_url":"https://api.github.com/users/salbatron/following{/other_user}","gists_url":"https://api.github.com/users/salbatron/gists{/gist_id}","starred_url":"https://api.github.com/users/salbatron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/salbatron/subscriptions","organizations_url":"https://api.github.com/users/salbatron/orgs","repos_url":"https://api.github.com/users/salbatron/repos","events_url":"https://api.github.com/users/salbatron/events{/privacy}","received_events_url":"https://api.github.com/users/salbatron/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-08-15T11:41:18Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/458407569","html_url":"https://github.com/adambielski/siamese-triplet/issues/12#issuecomment-458407569","issue_url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/12","id":458407569,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1ODQwNzU2OQ==","user":{"login":"vishalgolcha","id":10381466,"node_id":"MDQ6VXNlcjEwMzgxNDY2","avatar_url":"https://avatars.githubusercontent.com/u/10381466?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalgolcha","html_url":"https://github.com/vishalgolcha","followers_url":"https://api.github.com/users/vishalgolcha/followers","following_url":"https://api.github.com/users/vishalgolcha/following{/other_user}","gists_url":"https://api.github.com/users/vishalgolcha/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalgolcha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalgolcha/subscriptions","organizations_url":"https://api.github.com/users/vishalgolcha/orgs","repos_url":"https://api.github.com/users/vishalgolcha/repos","events_url":"https://api.github.com/users/vishalgolcha/events{/privacy}","received_events_url":"https://api.github.com/users/vishalgolcha/received_events","type":"User","site_admin":false},"created_at":"2019-01-29T04:55:15Z","updated_at":"2019-01-29T04:55:15Z","author_association":"NONE","body":"I was thinking of creating a  pull request with a custom dataloader that i made with this repository if that could help some people  .","reactions":{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/458407569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vishalgolcha","id":10381466,"node_id":"MDQ6VXNlcjEwMzgxNDY2","avatar_url":"https://avatars.githubusercontent.com/u/10381466?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalgolcha","html_url":"https://github.com/vishalgolcha","followers_url":"https://api.github.com/users/vishalgolcha/followers","following_url":"https://api.github.com/users/vishalgolcha/following{/other_user}","gists_url":"https://api.github.com/users/vishalgolcha/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalgolcha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalgolcha/subscriptions","organizations_url":"https://api.github.com/users/vishalgolcha/orgs","repos_url":"https://api.github.com/users/vishalgolcha/repos","events_url":"https://api.github.com/users/vishalgolcha/events{/privacy}","received_events_url":"https://api.github.com/users/vishalgolcha/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/458832148","html_url":"https://github.com/adambielski/siamese-triplet/issues/12#issuecomment-458832148","issue_url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/12","id":458832148,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1ODgzMjE0OA==","user":{"login":"WillDamon","id":29217770,"node_id":"MDQ6VXNlcjI5MjE3Nzcw","avatar_url":"https://avatars.githubusercontent.com/u/29217770?v=4","gravatar_id":"","url":"https://api.github.com/users/WillDamon","html_url":"https://github.com/WillDamon","followers_url":"https://api.github.com/users/WillDamon/followers","following_url":"https://api.github.com/users/WillDamon/following{/other_user}","gists_url":"https://api.github.com/users/WillDamon/gists{/gist_id}","starred_url":"https://api.github.com/users/WillDamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WillDamon/subscriptions","organizations_url":"https://api.github.com/users/WillDamon/orgs","repos_url":"https://api.github.com/users/WillDamon/repos","events_url":"https://api.github.com/users/WillDamon/events{/privacy}","received_events_url":"https://api.github.com/users/WillDamon/received_events","type":"User","site_admin":false},"created_at":"2019-01-30T06:49:56Z","updated_at":"2019-01-30T06:49:56Z","author_association":"NONE","body":"@vishalgolcha \r\nWould you mind share your code with us on how to train this project with our own data, which is just like  train/1/001.jpg, train/1/002.jpg, ..., train/100/001.jpg, test/101/001.jpg, test/101/002.jpg, ..., test/110/001.jpg...\r\nThank you so much.","reactions":{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/458832148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WillDamon","id":29217770,"node_id":"MDQ6VXNlcjI5MjE3Nzcw","avatar_url":"https://avatars.githubusercontent.com/u/29217770?v=4","gravatar_id":"","url":"https://api.github.com/users/WillDamon","html_url":"https://github.com/WillDamon","followers_url":"https://api.github.com/users/WillDamon/followers","following_url":"https://api.github.com/users/WillDamon/following{/other_user}","gists_url":"https://api.github.com/users/WillDamon/gists{/gist_id}","starred_url":"https://api.github.com/users/WillDamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WillDamon/subscriptions","organizations_url":"https://api.github.com/users/WillDamon/orgs","repos_url":"https://api.github.com/users/WillDamon/repos","events_url":"https://api.github.com/users/WillDamon/events{/privacy}","received_events_url":"https://api.github.com/users/WillDamon/received_events","type":"User","site_admin":false}},{"id":2105671892,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjEwNTY3MTg5Mg==","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/2105671892","actor":{"login":"vishalgolcha","id":10381466,"node_id":"MDQ6VXNlcjEwMzgxNDY2","avatar_url":"https://avatars.githubusercontent.com/u/10381466?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalgolcha","html_url":"https://github.com/vishalgolcha","followers_url":"https://api.github.com/users/vishalgolcha/followers","following_url":"https://api.github.com/users/vishalgolcha/following{/other_user}","gists_url":"https://api.github.com/users/vishalgolcha/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalgolcha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalgolcha/subscriptions","organizations_url":"https://api.github.com/users/vishalgolcha/orgs","repos_url":"https://api.github.com/users/vishalgolcha/repos","events_url":"https://api.github.com/users/vishalgolcha/events{/privacy}","received_events_url":"https://api.github.com/users/vishalgolcha/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-01-30T06:49:56Z","performed_via_github_app":null},{"id":2105671893,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIxMDU2NzE4OTM=","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/2105671893","actor":{"login":"vishalgolcha","id":10381466,"node_id":"MDQ6VXNlcjEwMzgxNDY2","avatar_url":"https://avatars.githubusercontent.com/u/10381466?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalgolcha","html_url":"https://github.com/vishalgolcha","followers_url":"https://api.github.com/users/vishalgolcha/followers","following_url":"https://api.github.com/users/vishalgolcha/following{/other_user}","gists_url":"https://api.github.com/users/vishalgolcha/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalgolcha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalgolcha/subscriptions","organizations_url":"https://api.github.com/users/vishalgolcha/orgs","repos_url":"https://api.github.com/users/vishalgolcha/repos","events_url":"https://api.github.com/users/vishalgolcha/events{/privacy}","received_events_url":"https://api.github.com/users/vishalgolcha/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-01-30T06:49:56Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/460538678","html_url":"https://github.com/adambielski/siamese-triplet/issues/12#issuecomment-460538678","issue_url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/12","id":460538678,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MDUzODY3OA==","user":{"login":"vishalgolcha","id":10381466,"node_id":"MDQ6VXNlcjEwMzgxNDY2","avatar_url":"https://avatars.githubusercontent.com/u/10381466?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalgolcha","html_url":"https://github.com/vishalgolcha","followers_url":"https://api.github.com/users/vishalgolcha/followers","following_url":"https://api.github.com/users/vishalgolcha/following{/other_user}","gists_url":"https://api.github.com/users/vishalgolcha/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalgolcha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalgolcha/subscriptions","organizations_url":"https://api.github.com/users/vishalgolcha/orgs","repos_url":"https://api.github.com/users/vishalgolcha/repos","events_url":"https://api.github.com/users/vishalgolcha/events{/privacy}","received_events_url":"https://api.github.com/users/vishalgolcha/received_events","type":"User","site_admin":false},"created_at":"2019-02-05T07:28:02Z","updated_at":"2019-02-05T07:36:22Z","author_association":"NONE","body":"```\r\nclass CUHK(Dataset):\r\n    def __init__(self,train_path,test_path,train):\r\n        # Transforms\r\n        self.to_tensor = transforms.ToTensor()\r\n        self.transform=None\r\n        # Read the csv file\r\n        self.train=train\r\n        if self.train:\r\n            self.train_data_info = pd.read_csv(train_path,header=None)\r\n            self.train_data =[] \r\n            \r\n            print(\"printing train data length CUHK\")\r\n            print(len(self.train_data_info.index))\r\n\r\n            for (i,j) in enumerate(np.asarray(self.train_data_info.iloc[:, 1])):\r\n                try : \r\n                    self.train_data.append(self.to_tensor(Image.open(\"../data/CUHK3/\"+j))) \r\n                except : \r\n                    print(j)\r\n            \r\n\r\n            self.train_data = torch.stack(self.train_data)\r\n            self.train_labels = np.asarray(self.train_data_info.iloc[:, 2])\r\n            self.train_labels = torch.from_numpy(self.train_labels)\r\n\r\n            self.train_data_len = len(self.train_data_info.index)\r\n\r\n        else :\r\n            self.test_data_info = pd.read_csv(test_path,header=None)\r\n            self.test_data =[] \r\n            for (i,j) in enumerate(np.asarray(self.test_data_info.iloc[:, 1])):\r\n                try : \r\n                    self.test_data.append(self.to_tensor(Image.open(\"../data/CUHK3/\"+j))) \r\n                except : \r\n                    print(j)  \r\n\r\n            self.test_data = torch.stack(self.test_data)\r\n            self.test_labels = np.asarray(self.test_data_info.iloc[:, 2])\r\n            self.test_labels = torch.from_numpy(self.test_labels)\r\n            \r\n            self.test_data_len = len(self.test_data_info.index)\r\n            \r\n\r\n    def __getitem__(self, index):\r\n        if self.train:\r\n            img, target = self.train_data[index], self.train_labels[index]\r\n        else:\r\n            img, target = self.test_data[index], self.test_labels[index]\r\n\r\n        return (img,target)\r\n\r\n    def __len__(self):\r\n        if self.train :\r\n            return self.train_data_len\r\n        else :\r\n            return self.test_data_len\r\n`\r\n```\r\nThis class was used for training over the CUHK dataset , the only thing is that you've to create a csv file that contains path to your image files and labels .\r\n\r\n```\r\nclass TripletCUHK(Dataset):\r\n    \"\"\"\r\n    Train: For each sample (anchor) randomly chooses a positive and negative samples\r\n    Test: Creates fixed triplets for testing\r\n    \"\"\"\r\n\r\n    def __init__(self, mnist_dataset):\r\n        self.mnist_dataset = mnist_dataset\r\n        self.train = self.mnist_dataset.train\r\n        self.transform = self.mnist_dataset.transform\r\n\r\n        if self.train:\r\n            self.train_labels = self.mnist_dataset.train_labels\r\n            self.train_data = self.mnist_dataset.train_data\r\n            self.labels_set = set(self.train_labels)\r\n            self.label_to_indices = {label.item(): np.where(np.asarray(self.train_labels) == label)[0]\r\n                                     for label in self.labels_set}\r\n\r\n        else:\r\n            self.test_labels = self.mnist_dataset.test_labels\r\n            self.test_data = self.mnist_dataset.test_data\r\n            # generate fixed triplets for testing\r\n            self.labels_set = set(self.test_labels)\r\n                        \r\n            self.label_to_indices = {label.item(): np.where(self.test_labels == label)[0]\r\n                                     for label in self.labels_set}\r\n\r\n            random_state = np.random.RandomState(29)\r\n\r\n            # print(self.label_to_indices)\r\n\r\n            triplets = []\r\n            for i in range(len(self.test_data)):\r\n                    triplets.append([i,\r\n                                random_state.choice(self.label_to_indices[self.test_labels[i].item()]),\r\n                                random_state.choice(self.label_to_indices[\r\n                                                        np.random.choice(\r\n                                                            list(self.labels_set - set([self.test_labels[i].item()]))\r\n                                                        )\r\n                                                    ])\r\n                                ])\r\n            self.test_triplets = triplets\r\n\r\n    def get_type(self):\r\n        print(\"test_labels type\"+str(type(self.test_labels)))\r\n    \r\n    def __getitem__(self, index):\r\n        if self.train:\r\n            img1, label1 = self.train_data[index], self.train_labels[index].item()\r\n            positive_index = index\r\n            while positive_index == index:\r\n                positive_index = np.random.choice(self.label_to_indices[label1])\r\n            negative_label = np.random.choice(list(self.labels_set - set([label1])))\r\n            negative_index = np.random.choice(self.label_to_indices[negative_label])\r\n            img2 = self.train_data[positive_index]\r\n            img3 = self.train_data[negative_index]\r\n        else:\r\n            img1 = self.test_data[self.test_triplets[index][0]]\r\n            img2 = self.test_data[self.test_triplets[index][1]]\r\n            img3 = self.test_data[self.test_triplets[index][2]]\r\n\r\n        # img1 = Image.fromarray(img1.numpy(), mode='RGB')\r\n        # img2 = Image.fromarray(img2.numpy(), mode='RGB')\r\n        # img3 = Image.fromarray(img3.numpy(), mode='RGB')\r\n\r\n        if self.transform is not None:\r\n            img1 = self.transform(img1)\r\n            img2 = self.transform(img2)\r\n            img3 = self.transform(img3)\r\n\r\n        return (img1, img2, img3), []\r\n\r\n    def __len__(self):\r\n        return len(self.mnist_dataset)\r\n```\r\n\r\nThis is another class used for training over the triplet module . Similar logic .","reactions":{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/460538678/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vishalgolcha","id":10381466,"node_id":"MDQ6VXNlcjEwMzgxNDY2","avatar_url":"https://avatars.githubusercontent.com/u/10381466?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalgolcha","html_url":"https://github.com/vishalgolcha","followers_url":"https://api.github.com/users/vishalgolcha/followers","following_url":"https://api.github.com/users/vishalgolcha/following{/other_user}","gists_url":"https://api.github.com/users/vishalgolcha/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalgolcha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalgolcha/subscriptions","organizations_url":"https://api.github.com/users/vishalgolcha/orgs","repos_url":"https://api.github.com/users/vishalgolcha/repos","events_url":"https://api.github.com/users/vishalgolcha/events{/privacy}","received_events_url":"https://api.github.com/users/vishalgolcha/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/460928001","html_url":"https://github.com/adambielski/siamese-triplet/issues/12#issuecomment-460928001","issue_url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/12","id":460928001,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MDkyODAwMQ==","user":{"login":"Ella77","id":42016485,"node_id":"MDQ6VXNlcjQyMDE2NDg1","avatar_url":"https://avatars.githubusercontent.com/u/42016485?v=4","gravatar_id":"","url":"https://api.github.com/users/Ella77","html_url":"https://github.com/Ella77","followers_url":"https://api.github.com/users/Ella77/followers","following_url":"https://api.github.com/users/Ella77/following{/other_user}","gists_url":"https://api.github.com/users/Ella77/gists{/gist_id}","starred_url":"https://api.github.com/users/Ella77/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ella77/subscriptions","organizations_url":"https://api.github.com/users/Ella77/orgs","repos_url":"https://api.github.com/users/Ella77/repos","events_url":"https://api.github.com/users/Ella77/events{/privacy}","received_events_url":"https://api.github.com/users/Ella77/received_events","type":"User","site_admin":false},"created_at":"2019-02-06T07:38:28Z","updated_at":"2019-02-06T07:38:43Z","author_association":"NONE","body":"@vishalgolcha Thanks for own data custom generator :) I have some questions regarding this and sent email(hotmail) for you. Would you mind opening it? ","reactions":{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/460928001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Ella77","id":42016485,"node_id":"MDQ6VXNlcjQyMDE2NDg1","avatar_url":"https://avatars.githubusercontent.com/u/42016485?v=4","gravatar_id":"","url":"https://api.github.com/users/Ella77","html_url":"https://github.com/Ella77","followers_url":"https://api.github.com/users/Ella77/followers","following_url":"https://api.github.com/users/Ella77/following{/other_user}","gists_url":"https://api.github.com/users/Ella77/gists{/gist_id}","starred_url":"https://api.github.com/users/Ella77/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ella77/subscriptions","organizations_url":"https://api.github.com/users/Ella77/orgs","repos_url":"https://api.github.com/users/Ella77/repos","events_url":"https://api.github.com/users/Ella77/events{/privacy}","received_events_url":"https://api.github.com/users/Ella77/received_events","type":"User","site_admin":false}},{"id":2120492175,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjEyMDQ5MjE3NQ==","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/2120492175","actor":{"login":"vishalgolcha","id":10381466,"node_id":"MDQ6VXNlcjEwMzgxNDY2","avatar_url":"https://avatars.githubusercontent.com/u/10381466?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalgolcha","html_url":"https://github.com/vishalgolcha","followers_url":"https://api.github.com/users/vishalgolcha/followers","following_url":"https://api.github.com/users/vishalgolcha/following{/other_user}","gists_url":"https://api.github.com/users/vishalgolcha/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalgolcha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalgolcha/subscriptions","organizations_url":"https://api.github.com/users/vishalgolcha/orgs","repos_url":"https://api.github.com/users/vishalgolcha/repos","events_url":"https://api.github.com/users/vishalgolcha/events{/privacy}","received_events_url":"https://api.github.com/users/vishalgolcha/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-02-06T07:38:28Z","performed_via_github_app":null},{"id":2120492177,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIxMjA0OTIxNzc=","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/2120492177","actor":{"login":"vishalgolcha","id":10381466,"node_id":"MDQ6VXNlcjEwMzgxNDY2","avatar_url":"https://avatars.githubusercontent.com/u/10381466?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalgolcha","html_url":"https://github.com/vishalgolcha","followers_url":"https://api.github.com/users/vishalgolcha/followers","following_url":"https://api.github.com/users/vishalgolcha/following{/other_user}","gists_url":"https://api.github.com/users/vishalgolcha/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalgolcha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalgolcha/subscriptions","organizations_url":"https://api.github.com/users/vishalgolcha/orgs","repos_url":"https://api.github.com/users/vishalgolcha/repos","events_url":"https://api.github.com/users/vishalgolcha/events{/privacy}","received_events_url":"https://api.github.com/users/vishalgolcha/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-02-06T07:38:28Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/461860907","html_url":"https://github.com/adambielski/siamese-triplet/issues/12#issuecomment-461860907","issue_url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/12","id":461860907,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MTg2MDkwNw==","user":{"login":"adambielski","id":14027793,"node_id":"MDQ6VXNlcjE0MDI3Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/14027793?v=4","gravatar_id":"","url":"https://api.github.com/users/adambielski","html_url":"https://github.com/adambielski","followers_url":"https://api.github.com/users/adambielski/followers","following_url":"https://api.github.com/users/adambielski/following{/other_user}","gists_url":"https://api.github.com/users/adambielski/gists{/gist_id}","starred_url":"https://api.github.com/users/adambielski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adambielski/subscriptions","organizations_url":"https://api.github.com/users/adambielski/orgs","repos_url":"https://api.github.com/users/adambielski/repos","events_url":"https://api.github.com/users/adambielski/events{/privacy}","received_events_url":"https://api.github.com/users/adambielski/received_events","type":"User","site_admin":false},"created_at":"2019-02-08T16:29:04Z","updated_at":"2019-02-08T16:29:04Z","author_association":"OWNER","body":"@madarax64 explained it very well - thank you for this.\r\nI refactored BalancedBatchSampler, now it should be easier to use with different datasets (it just needs labels in the same order as in the dataset.\r\n\r\nAll in all, what you need is (for the case with online triplet sampling):\r\n1. A Dataset class, so own implementation of `__len__` and `__getitem__(index)` methods; this is PyTorch specific and you can use some default PyTorch loaders or customize them for your case (see post by @madarax64). See some examples of custom Datasets https://github.com/utkuozbulak/pytorch-custom-dataset-examples\r\n2. BalancedBatchSampler that now takes a list of all labels in the dataset, where n-th label corresponds to n-th index in the Dataset class. The inefficient to get the list of labels would be `labels = [dataset[i][1] for i in range(len(dataset))]`, assuming that `__getitem__(index)` returns a pair of image and a label. Most likely your dataset already stores that list and it can be accessed without processing the images.","reactions":{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/461860907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adambielski","id":14027793,"node_id":"MDQ6VXNlcjE0MDI3Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/14027793?v=4","gravatar_id":"","url":"https://api.github.com/users/adambielski","html_url":"https://github.com/adambielski","followers_url":"https://api.github.com/users/adambielski/followers","following_url":"https://api.github.com/users/adambielski/following{/other_user}","gists_url":"https://api.github.com/users/adambielski/gists{/gist_id}","starred_url":"https://api.github.com/users/adambielski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adambielski/subscriptions","organizations_url":"https://api.github.com/users/adambielski/orgs","repos_url":"https://api.github.com/users/adambielski/repos","events_url":"https://api.github.com/users/adambielski/events{/privacy}","received_events_url":"https://api.github.com/users/adambielski/received_events","type":"User","site_admin":false}},{"id":2127533600,"node_id":"MDExOkNsb3NlZEV2ZW50MjEyNzUzMzYwMA==","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/2127533600","actor":{"login":"adambielski","id":14027793,"node_id":"MDQ6VXNlcjE0MDI3Nzkz","avatar_url":"https://avatars.githubusercontent.com/u/14027793?v=4","gravatar_id":"","url":"https://api.github.com/users/adambielski","html_url":"https://github.com/adambielski","followers_url":"https://api.github.com/users/adambielski/followers","following_url":"https://api.github.com/users/adambielski/following{/other_user}","gists_url":"https://api.github.com/users/adambielski/gists{/gist_id}","starred_url":"https://api.github.com/users/adambielski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adambielski/subscriptions","organizations_url":"https://api.github.com/users/adambielski/orgs","repos_url":"https://api.github.com/users/adambielski/repos","events_url":"https://api.github.com/users/adambielski/events{/privacy}","received_events_url":"https://api.github.com/users/adambielski/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-02-08T16:29:04Z","state_reason":null,"performed_via_github_app":null},{"id":2127533605,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjEyNzUzMzYwNQ==","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/2127533605","actor":{"login":"madarax64","id":4976654,"node_id":"MDQ6VXNlcjQ5NzY2NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4976654?v=4","gravatar_id":"","url":"https://api.github.com/users/madarax64","html_url":"https://github.com/madarax64","followers_url":"https://api.github.com/users/madarax64/followers","following_url":"https://api.github.com/users/madarax64/following{/other_user}","gists_url":"https://api.github.com/users/madarax64/gists{/gist_id}","starred_url":"https://api.github.com/users/madarax64/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/madarax64/subscriptions","organizations_url":"https://api.github.com/users/madarax64/orgs","repos_url":"https://api.github.com/users/madarax64/repos","events_url":"https://api.github.com/users/madarax64/events{/privacy}","received_events_url":"https://api.github.com/users/madarax64/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-02-08T16:29:04Z","performed_via_github_app":null},{"id":2127533607,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIxMjc1MzM2MDc=","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/2127533607","actor":{"login":"madarax64","id":4976654,"node_id":"MDQ6VXNlcjQ5NzY2NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4976654?v=4","gravatar_id":"","url":"https://api.github.com/users/madarax64","html_url":"https://github.com/madarax64","followers_url":"https://api.github.com/users/madarax64/followers","following_url":"https://api.github.com/users/madarax64/following{/other_user}","gists_url":"https://api.github.com/users/madarax64/gists{/gist_id}","starred_url":"https://api.github.com/users/madarax64/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/madarax64/subscriptions","organizations_url":"https://api.github.com/users/madarax64/orgs","repos_url":"https://api.github.com/users/madarax64/repos","events_url":"https://api.github.com/users/madarax64/events{/privacy}","received_events_url":"https://api.github.com/users/madarax64/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-02-08T16:29:04Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/523134266","html_url":"https://github.com/adambielski/siamese-triplet/issues/12#issuecomment-523134266","issue_url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/12","id":523134266,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzEzNDI2Ng==","user":{"login":"josianerodrigues","id":1696861,"node_id":"MDQ6VXNlcjE2OTY4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1696861?v=4","gravatar_id":"","url":"https://api.github.com/users/josianerodrigues","html_url":"https://github.com/josianerodrigues","followers_url":"https://api.github.com/users/josianerodrigues/followers","following_url":"https://api.github.com/users/josianerodrigues/following{/other_user}","gists_url":"https://api.github.com/users/josianerodrigues/gists{/gist_id}","starred_url":"https://api.github.com/users/josianerodrigues/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/josianerodrigues/subscriptions","organizations_url":"https://api.github.com/users/josianerodrigues/orgs","repos_url":"https://api.github.com/users/josianerodrigues/repos","events_url":"https://api.github.com/users/josianerodrigues/events{/privacy}","received_events_url":"https://api.github.com/users/josianerodrigues/received_events","type":"User","site_admin":false},"created_at":"2019-08-20T18:15:41Z","updated_at":"2019-08-20T18:15:41Z","author_association":"NONE","body":"Hi @vishalgolcha,\r\n\r\nI need to do tests with the CIFAR100, but I can't make the function to generate the triplets and pairs of image work. Can you help me? I believe it changes little because this dataset also has in the pytorch library.","reactions":{"url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/comments/523134266/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"josianerodrigues","id":1696861,"node_id":"MDQ6VXNlcjE2OTY4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1696861?v=4","gravatar_id":"","url":"https://api.github.com/users/josianerodrigues","html_url":"https://github.com/josianerodrigues","followers_url":"https://api.github.com/users/josianerodrigues/followers","following_url":"https://api.github.com/users/josianerodrigues/following{/other_user}","gists_url":"https://api.github.com/users/josianerodrigues/gists{/gist_id}","starred_url":"https://api.github.com/users/josianerodrigues/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/josianerodrigues/subscriptions","organizations_url":"https://api.github.com/users/josianerodrigues/orgs","repos_url":"https://api.github.com/users/josianerodrigues/repos","events_url":"https://api.github.com/users/josianerodrigues/events{/privacy}","received_events_url":"https://api.github.com/users/josianerodrigues/received_events","type":"User","site_admin":false}},{"id":2570618735,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjU3MDYxODczNQ==","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/2570618735","actor":{"login":"vishalgolcha","id":10381466,"node_id":"MDQ6VXNlcjEwMzgxNDY2","avatar_url":"https://avatars.githubusercontent.com/u/10381466?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalgolcha","html_url":"https://github.com/vishalgolcha","followers_url":"https://api.github.com/users/vishalgolcha/followers","following_url":"https://api.github.com/users/vishalgolcha/following{/other_user}","gists_url":"https://api.github.com/users/vishalgolcha/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalgolcha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalgolcha/subscriptions","organizations_url":"https://api.github.com/users/vishalgolcha/orgs","repos_url":"https://api.github.com/users/vishalgolcha/repos","events_url":"https://api.github.com/users/vishalgolcha/events{/privacy}","received_events_url":"https://api.github.com/users/vishalgolcha/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-08-20T18:15:41Z","performed_via_github_app":null},{"id":2570618736,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI1NzA2MTg3MzY=","url":"https://api.github.com/repos/adambielski/siamese-triplet/issues/events/2570618736","actor":{"login":"vishalgolcha","id":10381466,"node_id":"MDQ6VXNlcjEwMzgxNDY2","avatar_url":"https://avatars.githubusercontent.com/u/10381466?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalgolcha","html_url":"https://github.com/vishalgolcha","followers_url":"https://api.github.com/users/vishalgolcha/followers","following_url":"https://api.github.com/users/vishalgolcha/following{/other_user}","gists_url":"https://api.github.com/users/vishalgolcha/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalgolcha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalgolcha/subscriptions","organizations_url":"https://api.github.com/users/vishalgolcha/orgs","repos_url":"https://api.github.com/users/vishalgolcha/repos","events_url":"https://api.github.com/users/vishalgolcha/events{/privacy}","received_events_url":"https://api.github.com/users/vishalgolcha/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-08-20T18:15:41Z","performed_via_github_app":null}]