{"url":"https://api.github.com/repos/shahrukhqasim/TIES-2.0/issues/12","repository_url":"https://api.github.com/repos/shahrukhqasim/TIES-2.0","labels_url":"https://api.github.com/repos/shahrukhqasim/TIES-2.0/issues/12/labels{/name}","comments_url":"https://api.github.com/repos/shahrukhqasim/TIES-2.0/issues/12/comments","events_url":"https://api.github.com/repos/shahrukhqasim/TIES-2.0/issues/12/events","html_url":"https://github.com/shahrukhqasim/TIES-2.0/issues/12","id":475652228,"node_id":"MDU6SXNzdWU0NzU2NTIyMjg=","number":12,"title":"Indices do not index into param shape","user":{"login":"johannes-michael","id":22617743,"node_id":"MDQ6VXNlcjIyNjE3NzQz","avatar_url":"https://avatars.githubusercontent.com/u/22617743?v=4","gravatar_id":"","url":"https://api.github.com/users/johannes-michael","html_url":"https://github.com/johannes-michael","followers_url":"https://api.github.com/users/johannes-michael/followers","following_url":"https://api.github.com/users/johannes-michael/following{/other_user}","gists_url":"https://api.github.com/users/johannes-michael/gists{/gist_id}","starred_url":"https://api.github.com/users/johannes-michael/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johannes-michael/subscriptions","organizations_url":"https://api.github.com/users/johannes-michael/orgs","repos_url":"https://api.github.com/users/johannes-michael/repos","events_url":"https://api.github.com/users/johannes-michael/events{/privacy}","received_events_url":"https://api.github.com/users/johannes-michael/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2019-08-01T12:23:26Z","updated_at":"2020-08-21T17:31:25Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I'm trying to run a training with the data you provided, but get some index problems after some seconds into iteration 0:\r\n```\r\npython bin/iterate/table_adjacency_parsing.py /home/johannes/devel/projects/tr/configs/gravnet_fast_conv_partial.ini gravnet_fast_conv\r\n(25, 900, 64)\r\n(25, 900, 64)\r\n(25, 900, 64)\r\n(25, 900, 64)\r\nThe model has 972848 parameters.\r\nCleaned summary directory\r\nCleaned visual feedback output directory\r\n2019-08-01 12:21:21.721217: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\nWARNING:tensorflow:From /home/johannes/devel/src/git/python/TIES-2.0/python/iterators/table_adjacency_parsing_iterator.py:67: start_queue_runners (from tensorflow.python.training.queue_runner_impl) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nTo construct input pipelines, use the `tf.data` module.\r\nWARNING:tensorflow:`tf.train.start_queue_runners()` was called when no queue runners were defined. You can safely remove the call to this deprecated function.\r\nStarting iterations\r\nTraining Iteration 0:\r\n2019-08-01 12:21:41.314411: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at gather_nd_op.cc:50 : Invalid argument: indices[14,899,5] = [14, 899, 900] does not index into param shape [25,900,900]\r\n2019-08-01 12:21:41.317000: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at gather_nd_op.cc:50 : Invalid argument: indices[14,899,5] = [14, 899, 900] does not index into param shape [25,900,900]\r\n2019-08-01 12:21:41.320124: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at gather_nd_op.cc:50 : Invalid argument: indices[9,899,5] = [9, 899, 900] does not index into param shape [25,900,900]\r\n2019-08-01 12:21:43.658247: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at gather_nd_op.cc:50 : Invalid argument: indices[19,899,5] = [19, 900] does not index into param shape [25,900,128]\r\n2019-08-01 12:21:43.668727: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at gather_nd_op.cc:50 : Invalid argument: indices[24,899,5] = [24, 900] does not index into param shape [25,900,128]\r\n2019-08-01 12:21:43.673979: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at gather_nd_op.cc:50 : Invalid argument: indices[4,899,5] = [4, 900] does not index into param shape [25,900,128]\r\nTraceback (most recent call last):\r\n  File \"/home/johannes/devel/env/ties/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1334, in _do_call\r\n    return fn(*args)\r\n  File \"/home/johannes/devel/env/ties/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1319, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/home/johannes/devel/env/ties/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1407, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: indices[14,899,5] = [14, 899, 900] does not index into param shape [25,900,900]\r\n\t [[{{node conv_grav_net_fast_conv/GatherNd_6}} = GatherNd[Tindices=DT_INT32, Tparams=DT_INT64, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_conv_grav_net_fast_conv/Placeholder_3_0_3, conv_grav_net_fast_conv/concat_11)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"bin/iterate/table_adjacency_parsing.py\", line 31, in <module>\r\n    trainer.train()\r\n  File \"/home/johannes/devel/src/git/python/TIES-2.0/python/iterators/table_adjacency_parsing_iterator.py\", line 82, in train\r\n    model.run_training_iteration(sess, summary_writer, iteration_number)\r\n  File \"/home/johannes/devel/src/git/python/TIES-2.0/python/models/basic_model.py\", line 384, in run_training_iteration\r\n    ops_result = sess.run(ops_to_run, feed_dict = feed_dict)\r\n  File \"/home/johannes/devel/env/ties/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 929, in run\r\n    run_metadata_ptr)\r\n  File \"/home/johannes/devel/env/ties/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1152, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/johannes/devel/env/ties/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1328, in _do_run\r\n    run_metadata)\r\n  File \"/home/johannes/devel/env/ties/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1348, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: indices[14,899,5] = [14, 899, 900] does not index into param shape [25,900,900]\r\n\t [[node conv_grav_net_fast_conv/GatherNd_6 (defined at /home/johannes/devel/src/git/python/TIES-2.0/python/models/basic_model.py:201)  = GatherNd[Tindices=DT_INT32, Tparams=DT_INT64, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_conv_grav_net_fast_conv/Placeholder_3_0_3, conv_grav_net_fast_conv/concat_11)]]\r\n\r\nCaused by op 'conv_grav_net_fast_conv/GatherNd_6', defined at:\r\n  File \"bin/iterate/table_adjacency_parsing.py\", line 31, in <module>\r\n    trainer.train()\r\n  File \"/home/johannes/devel/src/git/python/TIES-2.0/python/iterators/table_adjacency_parsing_iterator.py\", line 48, in train\r\n    model.initialize(training=True)\r\n  File \"/home/johannes/devel/src/git/python/TIES-2.0/python/models/basic_model.py\", line 92, in initialize\r\n    self.build_computation_graphs()\r\n  File \"/home/johannes/devel/src/git/python/TIES-2.0/python/models/basic_model.py\", line 360, in build_computation_graphs\r\n    self.build_classification_segments(graph_features, placeholders)\r\n  File \"/home/johannes/devel/src/git/python/TIES-2.0/python/models/basic_model.py\", line 270, in build_classification_segments\r\n    sampled_indices, computation_graph, gt_matrix = self.do_monte_carlo_sampling(graph_features, gt_sampled_adj_matrix)\r\n  File \"/home/johannes/devel/src/git/python/TIES-2.0/python/models/basic_model.py\", line 201, in do_monte_carlo_sampling\r\n    return samples, x, tf.gather_nd(gt_matrix, indexing_tensor_for_adj_matrices)\r\n  File \"/home/johannes/devel/env/ties/lib/python3.6/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 3240, in gather_nd\r\n    \"GatherNd\", params=params, indices=indices, name=name)\r\n  File \"/home/johannes/devel/env/ties/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/johannes/devel/env/ties/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/johannes/devel/env/ties/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3274, in create_op\r\n    op_def=op_def)\r\n  File \"/home/johannes/devel/env/ties/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1770, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): indices[14,899,5] = [14, 899, 900] does not index into param shape [25,900,900]\r\n\t [[node conv_grav_net_fast_conv/GatherNd_6 (defined at /home/johannes/devel/src/git/python/TIES-2.0/python/models/basic_model.py:201)  = GatherNd[Tindices=DT_INT32, Tparams=DT_INT64, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](_arg_conv_grav_net_fast_conv/Placeholder_3_0_3, conv_grav_net_fast_conv/concat_11)]]\r\n```\r\nSome indices seem to reference out of bounds. Do you have an idea what could be causing this?","closed_by":null,"reactions":{"url":"https://api.github.com/repos/shahrukhqasim/TIES-2.0/issues/12/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"timeline_url":"https://api.github.com/repos/shahrukhqasim/TIES-2.0/issues/12/timeline","performed_via_github_app":null,"state_reason":null}