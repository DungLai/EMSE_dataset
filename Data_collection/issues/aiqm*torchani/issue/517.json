{"url":"https://api.github.com/repos/aiqm/torchani/issues/517","repository_url":"https://api.github.com/repos/aiqm/torchani","labels_url":"https://api.github.com/repos/aiqm/torchani/issues/517/labels{/name}","comments_url":"https://api.github.com/repos/aiqm/torchani/issues/517/comments","events_url":"https://api.github.com/repos/aiqm/torchani/issues/517/events","html_url":"https://github.com/aiqm/torchani/issues/517","id":728354833,"node_id":"MDU6SXNzdWU3MjgzNTQ4MzM=","number":517,"title":"subtract_self_energies returns empty TransformableIterable","user":{"login":"ajsmit24","id":20092226,"node_id":"MDQ6VXNlcjIwMDkyMjI2","avatar_url":"https://avatars.githubusercontent.com/u/20092226?v=4","gravatar_id":"","url":"https://api.github.com/users/ajsmit24","html_url":"https://github.com/ajsmit24","followers_url":"https://api.github.com/users/ajsmit24/followers","following_url":"https://api.github.com/users/ajsmit24/following{/other_user}","gists_url":"https://api.github.com/users/ajsmit24/gists{/gist_id}","starred_url":"https://api.github.com/users/ajsmit24/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajsmit24/subscriptions","organizations_url":"https://api.github.com/users/ajsmit24/orgs","repos_url":"https://api.github.com/users/ajsmit24/repos","events_url":"https://api.github.com/users/ajsmit24/events{/privacy}","received_events_url":"https://api.github.com/users/ajsmit24/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-10-23T16:28:34Z","updated_at":"2021-02-03T19:06:30Z","closed_at":"2021-02-03T19:06:30Z","author_association":"NONE","active_lock_reason":null,"body":"I am attempting to train the ANI model based on some in house data and following [this](https://github.com/aiqm/torchani/blob/master/examples/nnp_training.py) tutorial:\r\n\r\nMy problem is at this point:\r\ntraining, validation = torchani.data.load(dspath).subtract_self_energies(energy_shifter,species_order).species_to_indices(species_order).shuffle().split(0.8, None)\r\n\r\nIt works fine if I remove subtract_self_energies. What I have determined is that subtract_self_energies is returning an empty TransformableIterable. Notably, my data is coming in the form of jsons that have been turned into a generator of dicts which is turned into a TransformableIterable. The dictionaries are of the form below:\r\n\r\n```\r\n{'coordinates': array([[-2.879155e+00, -2.659750e-01,  6.010000e-04],\r\n        [-2.694267e+00,  9.670450e-01, -2.199000e-03],\r\n        [-1.425789e+00,  1.282788e+00, -2.415000e-03],\r\n        [-6.712590e-01,  2.823620e-01, -1.133000e-03],\r\n        [-1.519620e+00, -1.044127e+00,  2.595000e-03],\r\n        [ 6.712590e-01,  2.823620e-01,  1.143000e-03],\r\n        [ 1.425789e+00,  1.282788e+00,  2.416000e-03],\r\n        [ 2.694267e+00,  9.670450e-01,  2.195000e-03],\r\n        [ 2.879155e+00, -2.659750e-01, -6.080000e-04],\r\n        [ 1.519620e+00, -1.044127e+00, -2.594000e-03],\r\n        [-3.750497e+00, -7.489210e-01,  1.302000e-03],\r\n        [-3.435114e+00,  1.635729e+00, -3.818000e-03],\r\n        [-1.089719e+00,  2.221911e+00, -4.189000e-03],\r\n        [ 1.089719e+00,  2.221911e+00,  4.191000e-03],\r\n        [ 3.435114e+00,  1.635729e+00,  3.810000e-03],\r\n        [ 3.750497e+00, -7.489210e-01, -1.316000e-03]]),\r\n 'species': ['C',\r\n  'C',\r\n  'C',\r\n  'C',\r\n  'S',\r\n  'C',\r\n  'C',\r\n  'C',\r\n  'C',\r\n  'S',\r\n  'H',\r\n  'H',\r\n  'H',\r\n  'H',\r\n  'H',\r\n  'H'],\r\n 'energies': -1154.52692963}\r\n```\r\n\r\nThe dicts are converted from an array to a generator by the following code:\r\n```\r\nANIs=[]\r\n    for molN in molNames:\r\n        temp=#a method that reads a json to a dict and parses it to the above form\r\n        ANIs.append(temp)\r\n    g=(o for o in ANIs)\r\n    return TransformableIterable(IterableAdapter(lambda: g))\r\n```\r\n\r\nAny help would be much appreciated.\r\n\r\n\r\n\r\n","closed_by":{"login":"ajsmit24","id":20092226,"node_id":"MDQ6VXNlcjIwMDkyMjI2","avatar_url":"https://avatars.githubusercontent.com/u/20092226?v=4","gravatar_id":"","url":"https://api.github.com/users/ajsmit24","html_url":"https://github.com/ajsmit24","followers_url":"https://api.github.com/users/ajsmit24/followers","following_url":"https://api.github.com/users/ajsmit24/following{/other_user}","gists_url":"https://api.github.com/users/ajsmit24/gists{/gist_id}","starred_url":"https://api.github.com/users/ajsmit24/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajsmit24/subscriptions","organizations_url":"https://api.github.com/users/ajsmit24/orgs","repos_url":"https://api.github.com/users/ajsmit24/repos","events_url":"https://api.github.com/users/ajsmit24/events{/privacy}","received_events_url":"https://api.github.com/users/ajsmit24/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/aiqm/torchani/issues/517/timeline","performed_via_github_app":null,"state_reason":"completed"}