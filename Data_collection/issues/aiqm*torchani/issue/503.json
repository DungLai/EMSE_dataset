{"url":"https://api.github.com/repos/aiqm/torchani/issues/503","repository_url":"https://api.github.com/repos/aiqm/torchani","labels_url":"https://api.github.com/repos/aiqm/torchani/issues/503/labels{/name}","comments_url":"https://api.github.com/repos/aiqm/torchani/issues/503/comments","events_url":"https://api.github.com/repos/aiqm/torchani/issues/503/events","html_url":"https://github.com/aiqm/torchani/issues/503","id":654413121,"node_id":"MDU6SXNzdWU2NTQ0MTMxMjE=","number":503,"title":"self atomic energies order is changed by energy_shifter","user":{"login":"muammar","id":954209,"node_id":"MDQ6VXNlcjk1NDIwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/954209?v=4","gravatar_id":"","url":"https://api.github.com/users/muammar","html_url":"https://github.com/muammar","followers_url":"https://api.github.com/users/muammar/followers","following_url":"https://api.github.com/users/muammar/following{/other_user}","gists_url":"https://api.github.com/users/muammar/gists{/gist_id}","starred_url":"https://api.github.com/users/muammar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muammar/subscriptions","organizations_url":"https://api.github.com/users/muammar/orgs","repos_url":"https://api.github.com/users/muammar/repos","events_url":"https://api.github.com/users/muammar/events{/privacy}","received_events_url":"https://api.github.com/users/muammar/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-07-09T23:42:20Z","updated_at":"2021-02-18T15:02:07Z","closed_at":"2021-02-18T15:02:07Z","author_association":"NONE","active_lock_reason":null,"body":"``` \r\nself_energies = [\r\n    -0.501393616509,\r\n    -37.846231170093,\r\n    -54.591755729681,\r\n    -75.076743759610,\r\n    -398.107788038429,\r\n    -99.747331673869,\r\n    -460.146415053587,\r\n    -341.252624074530,\r\n]\r\n\r\nspecies_order = [\"H\", \"C\", \"N\", \"O\", \"F\", \"P\", \"S\", \"Cl\"]\r\n\r\n\r\nenergy_shifter = torchani.utils.EnergyShifter(self_energies)\r\n\r\nprint(\"Self atomic energies: \", energy_shifter.self_energies)\r\n\r\nspecies_to_tensor = torchani.utils.ChemicalSymbolsToInts(species_order)\r\n\r\ntry:\r\n    path = os.path.dirname(os.path.realpath(__file__))\r\nexcept NameError:\r\n    path = os.getcwd()\r\ndspath = os.path.join(path, \"some.h5\")\r\n\r\nbatch_size = 2560 // 8\r\n# batch_size = 1\r\n\r\ndata = (\r\n    torchani.data.load(dspath, additional_properties=(\"forces\", ))\r\n    .subtract_self_energies(energy_shifter)\r\n#     .remove_outliers()\r\n    .species_to_indices(species_order)\r\n#     .shuffle()\r\n#     .split(0.8, None)\r\n)\r\ndata = data.collate(batch_size).cache()\r\n# validation = validation.collate(batch_size).cache()\r\n\r\nprint(\"Self atomic energies: \", energy_shifter.self_energies)\r\n```\r\n\r\nRunning these prints: \r\n\r\n```\r\nSelf atomic energies:  tensor([  -0.5014,  -37.8462,  -54.5918,  -75.0767, -398.1078,  -99.7473,\r\n        -460.1464, -341.2526], dtype=torch.float64)\r\nSelf atomic energies:  tensor([  -0.6019,  -38.1003,  -54.7528,  -75.2432,  -99.8626, -341.3882,\r\n        -398.1908, -460.2129], dtype=torch.float64)\r\n```\r\n\r\nI see the self energies are now from larger to smaller, but this does not represent the order that I set previously in the list `species_order`. Is the list `species_order` reorganized as well so that this is matching? Or I have to change the order myself?","closed_by":{"login":"IgnacioJPickering","id":34223426,"node_id":"MDQ6VXNlcjM0MjIzNDI2","avatar_url":"https://avatars.githubusercontent.com/u/34223426?v=4","gravatar_id":"","url":"https://api.github.com/users/IgnacioJPickering","html_url":"https://github.com/IgnacioJPickering","followers_url":"https://api.github.com/users/IgnacioJPickering/followers","following_url":"https://api.github.com/users/IgnacioJPickering/following{/other_user}","gists_url":"https://api.github.com/users/IgnacioJPickering/gists{/gist_id}","starred_url":"https://api.github.com/users/IgnacioJPickering/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IgnacioJPickering/subscriptions","organizations_url":"https://api.github.com/users/IgnacioJPickering/orgs","repos_url":"https://api.github.com/users/IgnacioJPickering/repos","events_url":"https://api.github.com/users/IgnacioJPickering/events{/privacy}","received_events_url":"https://api.github.com/users/IgnacioJPickering/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/aiqm/torchani/issues/503/timeline","performed_via_github_app":null,"state_reason":"completed"}