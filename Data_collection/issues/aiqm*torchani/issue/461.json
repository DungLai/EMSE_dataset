{"url":"https://api.github.com/repos/aiqm/torchani/issues/461","repository_url":"https://api.github.com/repos/aiqm/torchani","labels_url":"https://api.github.com/repos/aiqm/torchani/issues/461/labels{/name}","comments_url":"https://api.github.com/repos/aiqm/torchani/issues/461/comments","events_url":"https://api.github.com/repos/aiqm/torchani/issues/461/events","html_url":"https://github.com/aiqm/torchani/issues/461","id":609213458,"node_id":"MDU6SXNzdWU2MDkyMTM0NTg=","number":461,"title":"SpeciesConverter returns species on CPU","user":{"login":"RMeli","id":11348981,"node_id":"MDQ6VXNlcjExMzQ4OTgx","avatar_url":"https://avatars.githubusercontent.com/u/11348981?v=4","gravatar_id":"","url":"https://api.github.com/users/RMeli","html_url":"https://github.com/RMeli","followers_url":"https://api.github.com/users/RMeli/followers","following_url":"https://api.github.com/users/RMeli/following{/other_user}","gists_url":"https://api.github.com/users/RMeli/gists{/gist_id}","starred_url":"https://api.github.com/users/RMeli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RMeli/subscriptions","organizations_url":"https://api.github.com/users/RMeli/orgs","repos_url":"https://api.github.com/users/RMeli/repos","events_url":"https://api.github.com/users/RMeli/events{/privacy}","received_events_url":"https://api.github.com/users/RMeli/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-04-29T17:02:36Z","updated_at":"2020-04-29T17:59:07Z","closed_at":"2020-04-29T17:58:24Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"`torchani.SpeciesConverter` always returns species on the CPU, even if the inputs of `forward` are on the GPU.\r\n\r\n```python\r\nimport torch\r\nimport torchani\r\n\r\ndevice = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\r\n\r\nprint(\"device:\", device)\r\n\r\nSC = torchani.SpeciesConverter(\"H\")\r\n\r\natomicnums = torch.tensor([[1, 1]], device=device)\r\ncoordinates = torch.tensor([[[0.0, 0.0, 0.0], [1.0, 0.0, 0.0]]], device=device)\r\n\r\nprint(atomicnums.device, coordinates.device)\r\n\r\nsc = SC((atomicnums, coordinates))\r\n\r\nprint(sc.species.device, sc.coordinates.device)\r\n```\r\n\r\n```\r\ndevice: cuda\r\ncuda:0 cuda:0\r\ncpu cuda:0\r\n```\r\n\r\n---\r\n\r\nTorchANI: `2.0`\r\nPythorch: `1.5`\r\nPython: `3.7`","closed_by":{"login":"zasdfgbnm","id":1032377,"node_id":"MDQ6VXNlcjEwMzIzNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1032377?v=4","gravatar_id":"","url":"https://api.github.com/users/zasdfgbnm","html_url":"https://github.com/zasdfgbnm","followers_url":"https://api.github.com/users/zasdfgbnm/followers","following_url":"https://api.github.com/users/zasdfgbnm/following{/other_user}","gists_url":"https://api.github.com/users/zasdfgbnm/gists{/gist_id}","starred_url":"https://api.github.com/users/zasdfgbnm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zasdfgbnm/subscriptions","organizations_url":"https://api.github.com/users/zasdfgbnm/orgs","repos_url":"https://api.github.com/users/zasdfgbnm/repos","events_url":"https://api.github.com/users/zasdfgbnm/events{/privacy}","received_events_url":"https://api.github.com/users/zasdfgbnm/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/aiqm/torchani/issues/461/timeline","performed_via_github_app":null,"state_reason":"completed"}