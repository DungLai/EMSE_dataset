[{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/794043503","html_url":"https://github.com/aiqm/torchani/issues/578#issuecomment-794043503","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/578","id":794043503,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDA0MzUwMw==","user":{"login":"farhadrgh","id":13050245,"node_id":"MDQ6VXNlcjEzMDUwMjQ1","avatar_url":"https://avatars.githubusercontent.com/u/13050245?v=4","gravatar_id":"","url":"https://api.github.com/users/farhadrgh","html_url":"https://github.com/farhadrgh","followers_url":"https://api.github.com/users/farhadrgh/followers","following_url":"https://api.github.com/users/farhadrgh/following{/other_user}","gists_url":"https://api.github.com/users/farhadrgh/gists{/gist_id}","starred_url":"https://api.github.com/users/farhadrgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farhadrgh/subscriptions","organizations_url":"https://api.github.com/users/farhadrgh/orgs","repos_url":"https://api.github.com/users/farhadrgh/repos","events_url":"https://api.github.com/users/farhadrgh/events{/privacy}","received_events_url":"https://api.github.com/users/farhadrgh/received_events","type":"User","site_admin":false},"created_at":"2021-03-09T15:25:42Z","updated_at":"2021-03-09T15:25:42Z","author_association":"MEMBER","body":"What are the arguments in `subtract_self_energies(...)`? There might be a mixed-up in computing self atomic energies (SAE) in your second method. It computes the SAEs every time you load the data given `energy_shifter = torchani.utils.EnergyShifter(None)`. I suggest storing the SAEs in a dict and use that when loading the validation:\r\n\r\n```python\r\nenergy_shifter = torchani.utils.EnergyShifter(None)\r\ntraining,_ = torchani.data.load('train.h5').subtract_self_energies(...).species_to_indices(...).shuffle()\r\n# Transfer training SAEs to other data loaders\r\nsae_dict = {s: e for s, e in zip(species_order, energy_shifter.self_energies.tolist())}\r\nvalidation = torchani.data.load('validate.h5').subtract_self_energies(sae_dict).species_to_indices(...)\r\n```","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/794043503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"farhadrgh","id":13050245,"node_id":"MDQ6VXNlcjEzMDUwMjQ1","avatar_url":"https://avatars.githubusercontent.com/u/13050245?v=4","gravatar_id":"","url":"https://api.github.com/users/farhadrgh","html_url":"https://github.com/farhadrgh","followers_url":"https://api.github.com/users/farhadrgh/followers","following_url":"https://api.github.com/users/farhadrgh/following{/other_user}","gists_url":"https://api.github.com/users/farhadrgh/gists{/gist_id}","starred_url":"https://api.github.com/users/farhadrgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farhadrgh/subscriptions","organizations_url":"https://api.github.com/users/farhadrgh/orgs","repos_url":"https://api.github.com/users/farhadrgh/repos","events_url":"https://api.github.com/users/farhadrgh/events{/privacy}","received_events_url":"https://api.github.com/users/farhadrgh/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/794579575","html_url":"https://github.com/aiqm/torchani/issues/578#issuecomment-794579575","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/578","id":794579575,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDU3OTU3NQ==","user":{"login":"shubbey","id":24950802,"node_id":"MDQ6VXNlcjI0OTUwODAy","avatar_url":"https://avatars.githubusercontent.com/u/24950802?v=4","gravatar_id":"","url":"https://api.github.com/users/shubbey","html_url":"https://github.com/shubbey","followers_url":"https://api.github.com/users/shubbey/followers","following_url":"https://api.github.com/users/shubbey/following{/other_user}","gists_url":"https://api.github.com/users/shubbey/gists{/gist_id}","starred_url":"https://api.github.com/users/shubbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shubbey/subscriptions","organizations_url":"https://api.github.com/users/shubbey/orgs","repos_url":"https://api.github.com/users/shubbey/repos","events_url":"https://api.github.com/users/shubbey/events{/privacy}","received_events_url":"https://api.github.com/users/shubbey/received_events","type":"User","site_admin":false},"created_at":"2021-03-09T23:05:56Z","updated_at":"2021-03-09T23:21:46Z","author_association":"NONE","body":"Thank you for the advice.  I initially responded here with some erroneous info. Trying your method now!\r\n\r\nAlso, would it make sense to shuffle the training data before each epoch?  I noticed that it keeps the data in the same order each pass through.","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/794579575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shubbey","id":24950802,"node_id":"MDQ6VXNlcjI0OTUwODAy","avatar_url":"https://avatars.githubusercontent.com/u/24950802?v=4","gravatar_id":"","url":"https://api.github.com/users/shubbey","html_url":"https://github.com/shubbey","followers_url":"https://api.github.com/users/shubbey/followers","following_url":"https://api.github.com/users/shubbey/following{/other_user}","gists_url":"https://api.github.com/users/shubbey/gists{/gist_id}","starred_url":"https://api.github.com/users/shubbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shubbey/subscriptions","organizations_url":"https://api.github.com/users/shubbey/orgs","repos_url":"https://api.github.com/users/shubbey/repos","events_url":"https://api.github.com/users/shubbey/events{/privacy}","received_events_url":"https://api.github.com/users/shubbey/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/795008465","html_url":"https://github.com/aiqm/torchani/issues/578#issuecomment-795008465","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/578","id":795008465,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NTAwODQ2NQ==","user":{"login":"shubbey","id":24950802,"node_id":"MDQ6VXNlcjI0OTUwODAy","avatar_url":"https://avatars.githubusercontent.com/u/24950802?v=4","gravatar_id":"","url":"https://api.github.com/users/shubbey","html_url":"https://github.com/shubbey","followers_url":"https://api.github.com/users/shubbey/followers","following_url":"https://api.github.com/users/shubbey/following{/other_user}","gists_url":"https://api.github.com/users/shubbey/gists{/gist_id}","starred_url":"https://api.github.com/users/shubbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shubbey/subscriptions","organizations_url":"https://api.github.com/users/shubbey/orgs","repos_url":"https://api.github.com/users/shubbey/repos","events_url":"https://api.github.com/users/shubbey/events{/privacy}","received_events_url":"https://api.github.com/users/shubbey/received_events","type":"User","site_admin":false},"created_at":"2021-03-10T07:19:01Z","updated_at":"2021-03-10T07:42:24Z","author_association":"NONE","body":"Unfortunately, the energy_shifter method isn't the issue here, but it's good to know how it works. \r\n\r\nAfter running several tests, I confirmed that the single biggest factor for network improvement is the mixing of training and validation conformers.  That is:\r\n\r\n```\r\n    training, validation = torchani.data.load('full.h5')\\\r\n                                        .subtract_self_energies(energy_shifter,species_order)\\\r\n                                        .species_to_indices(species_order)\\\r\n                                        .cache()\\\r\n                                        .split(0.8, None)\r\n    training.shuffle()\r\n```\r\n== bad result,\r\n\r\n```\r\n    training, validation = torchani.data.load('full.h5')\\\r\n                                        .subtract_self_energies(energy_shifter,species_order)\\\r\n                                        .species_to_indices(species_order)\\\r\n                                        .shuffle()\\\r\n                                        .split(0.8, None)\r\n```\r\n== good result\r\n\r\nNote that my dataset, 'full.h5',  is pre-shuffled with all of the molecule data, with each molecule having ~10-100 conformers.  In the first case, training and validation won't each contain different conformers of the same molecule. In the second, there will be a lot of overlap because the shuffle() will split conformers of the same molecule between the two sets.\r\n\r\nThe result isn't surprising, since you'd expect the validation set to have a better RMSE if it contains molecules more similar to those in the training set (and similar in this case would be different conformers of the same molecule).  \r\n\r\nHowever, what puzzles me is that you'd expect this to produce an overfit and not give good results in an independent testing set (where all molecules/conformers are unique).  However, it does much better than the results in the first example, because that network converges quickly to a poor result.\r\n\r\nDo you know if this is by design or did I stumble into an involuntary \"optimization\"?  The reason I am curious is that I am also running an NMR network that has similar input (since each NMR datapoint has several AEV vectors from the same molecule), and it may make sense to split these up between training and validation.\r\n\r\nThanks again for all of the help.","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/795008465/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shubbey","id":24950802,"node_id":"MDQ6VXNlcjI0OTUwODAy","avatar_url":"https://avatars.githubusercontent.com/u/24950802?v=4","gravatar_id":"","url":"https://api.github.com/users/shubbey","html_url":"https://github.com/shubbey","followers_url":"https://api.github.com/users/shubbey/followers","following_url":"https://api.github.com/users/shubbey/following{/other_user}","gists_url":"https://api.github.com/users/shubbey/gists{/gist_id}","starred_url":"https://api.github.com/users/shubbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shubbey/subscriptions","organizations_url":"https://api.github.com/users/shubbey/orgs","repos_url":"https://api.github.com/users/shubbey/repos","events_url":"https://api.github.com/users/shubbey/events{/privacy}","received_events_url":"https://api.github.com/users/shubbey/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/795688865","html_url":"https://github.com/aiqm/torchani/issues/578#issuecomment-795688865","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/578","id":795688865,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NTY4ODg2NQ==","user":{"login":"zasdfgbnm","id":1032377,"node_id":"MDQ6VXNlcjEwMzIzNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1032377?v=4","gravatar_id":"","url":"https://api.github.com/users/zasdfgbnm","html_url":"https://github.com/zasdfgbnm","followers_url":"https://api.github.com/users/zasdfgbnm/followers","following_url":"https://api.github.com/users/zasdfgbnm/following{/other_user}","gists_url":"https://api.github.com/users/zasdfgbnm/gists{/gist_id}","starred_url":"https://api.github.com/users/zasdfgbnm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zasdfgbnm/subscriptions","organizations_url":"https://api.github.com/users/zasdfgbnm/orgs","repos_url":"https://api.github.com/users/zasdfgbnm/repos","events_url":"https://api.github.com/users/zasdfgbnm/events{/privacy}","received_events_url":"https://api.github.com/users/zasdfgbnm/received_events","type":"User","site_admin":false},"created_at":"2021-03-10T16:26:18Z","updated_at":"2021-03-10T16:26:18Z","author_association":"CONTRIBUTOR","body":"From the paper https://pubs.rsc.org/en/content/articlelanding/2017/sc/c6sc05720a#!divAbstract\r\n\r\n> Using this procedure to generate the ANI-1 data set results in molecular energies for a total of ∼17.2 million conformations generated from ∼58k small molecules. For each molecule's individual set of random conformations, 80% is used for training, while 10% is used for each validation and testing of the ANI-1 model.\r\n\r\nSo I think the procedure actually is different conformers of the same molecule goes to both training and validation? @Jussmith01  to confirm.","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/795688865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zasdfgbnm","id":1032377,"node_id":"MDQ6VXNlcjEwMzIzNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1032377?v=4","gravatar_id":"","url":"https://api.github.com/users/zasdfgbnm","html_url":"https://github.com/zasdfgbnm","followers_url":"https://api.github.com/users/zasdfgbnm/followers","following_url":"https://api.github.com/users/zasdfgbnm/following{/other_user}","gists_url":"https://api.github.com/users/zasdfgbnm/gists{/gist_id}","starred_url":"https://api.github.com/users/zasdfgbnm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zasdfgbnm/subscriptions","organizations_url":"https://api.github.com/users/zasdfgbnm/orgs","repos_url":"https://api.github.com/users/zasdfgbnm/repos","events_url":"https://api.github.com/users/zasdfgbnm/events{/privacy}","received_events_url":"https://api.github.com/users/zasdfgbnm/received_events","type":"User","site_admin":false}},{"id":4437631232,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDQzNzYzMTIzMg==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/4437631232","actor":{"login":"Jussmith01","id":11092076,"node_id":"MDQ6VXNlcjExMDkyMDc2","avatar_url":"https://avatars.githubusercontent.com/u/11092076?v=4","gravatar_id":"","url":"https://api.github.com/users/Jussmith01","html_url":"https://github.com/Jussmith01","followers_url":"https://api.github.com/users/Jussmith01/followers","following_url":"https://api.github.com/users/Jussmith01/following{/other_user}","gists_url":"https://api.github.com/users/Jussmith01/gists{/gist_id}","starred_url":"https://api.github.com/users/Jussmith01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jussmith01/subscriptions","organizations_url":"https://api.github.com/users/Jussmith01/orgs","repos_url":"https://api.github.com/users/Jussmith01/repos","events_url":"https://api.github.com/users/Jussmith01/events{/privacy}","received_events_url":"https://api.github.com/users/Jussmith01/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-10T16:26:18Z","performed_via_github_app":null},{"id":4437631246,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ0Mzc2MzEyNDY=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/4437631246","actor":{"login":"Jussmith01","id":11092076,"node_id":"MDQ6VXNlcjExMDkyMDc2","avatar_url":"https://avatars.githubusercontent.com/u/11092076?v=4","gravatar_id":"","url":"https://api.github.com/users/Jussmith01","html_url":"https://github.com/Jussmith01","followers_url":"https://api.github.com/users/Jussmith01/followers","following_url":"https://api.github.com/users/Jussmith01/following{/other_user}","gists_url":"https://api.github.com/users/Jussmith01/gists{/gist_id}","starred_url":"https://api.github.com/users/Jussmith01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jussmith01/subscriptions","organizations_url":"https://api.github.com/users/Jussmith01/orgs","repos_url":"https://api.github.com/users/Jussmith01/repos","events_url":"https://api.github.com/users/Jussmith01/events{/privacy}","received_events_url":"https://api.github.com/users/Jussmith01/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-10T16:26:18Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/796301433","html_url":"https://github.com/aiqm/torchani/issues/578#issuecomment-796301433","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/578","id":796301433,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjMwMTQzMw==","user":{"login":"shubbey","id":24950802,"node_id":"MDQ6VXNlcjI0OTUwODAy","avatar_url":"https://avatars.githubusercontent.com/u/24950802?v=4","gravatar_id":"","url":"https://api.github.com/users/shubbey","html_url":"https://github.com/shubbey","followers_url":"https://api.github.com/users/shubbey/followers","following_url":"https://api.github.com/users/shubbey/following{/other_user}","gists_url":"https://api.github.com/users/shubbey/gists{/gist_id}","starred_url":"https://api.github.com/users/shubbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shubbey/subscriptions","organizations_url":"https://api.github.com/users/shubbey/orgs","repos_url":"https://api.github.com/users/shubbey/repos","events_url":"https://api.github.com/users/shubbey/events{/privacy}","received_events_url":"https://api.github.com/users/shubbey/received_events","type":"User","site_admin":false},"created_at":"2021-03-10T23:56:06Z","updated_at":"2021-03-10T23:56:06Z","author_association":"NONE","body":"Good find!  I would be very interested in the methodology behind this.  In my numerous tests it seems that training and validating on conformers of the same molecule definitely leads to much better convergence.  Thank you!","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/796301433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shubbey","id":24950802,"node_id":"MDQ6VXNlcjI0OTUwODAy","avatar_url":"https://avatars.githubusercontent.com/u/24950802?v=4","gravatar_id":"","url":"https://api.github.com/users/shubbey","html_url":"https://github.com/shubbey","followers_url":"https://api.github.com/users/shubbey/followers","following_url":"https://api.github.com/users/shubbey/following{/other_user}","gists_url":"https://api.github.com/users/shubbey/gists{/gist_id}","starred_url":"https://api.github.com/users/shubbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shubbey/subscriptions","organizations_url":"https://api.github.com/users/shubbey/orgs","repos_url":"https://api.github.com/users/shubbey/repos","events_url":"https://api.github.com/users/shubbey/events{/privacy}","received_events_url":"https://api.github.com/users/shubbey/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/808457672","html_url":"https://github.com/aiqm/torchani/issues/578#issuecomment-808457672","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/578","id":808457672,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODQ1NzY3Mg==","user":{"login":"IgnacioJPickering","id":34223426,"node_id":"MDQ6VXNlcjM0MjIzNDI2","avatar_url":"https://avatars.githubusercontent.com/u/34223426?v=4","gravatar_id":"","url":"https://api.github.com/users/IgnacioJPickering","html_url":"https://github.com/IgnacioJPickering","followers_url":"https://api.github.com/users/IgnacioJPickering/followers","following_url":"https://api.github.com/users/IgnacioJPickering/following{/other_user}","gists_url":"https://api.github.com/users/IgnacioJPickering/gists{/gist_id}","starred_url":"https://api.github.com/users/IgnacioJPickering/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IgnacioJPickering/subscriptions","organizations_url":"https://api.github.com/users/IgnacioJPickering/orgs","repos_url":"https://api.github.com/users/IgnacioJPickering/repos","events_url":"https://api.github.com/users/IgnacioJPickering/events{/privacy}","received_events_url":"https://api.github.com/users/IgnacioJPickering/received_events","type":"User","site_admin":false},"created_at":"2021-03-26T19:19:32Z","updated_at":"2021-03-26T19:19:32Z","author_association":"CONTRIBUTOR","body":"@shubbey @zasdfgbnm I can confirm that the current method is to add conformers of the same molecule into both training and validation sets. I think the potential can only be expected to generalize to a fully disjoint set of molecules if it has been trained on an extremely large training set, by splitting the training and validation conformers it is possible to end up overfitting to the training conformers and if the training and validation conformers are very heterogeneous subsets then the validation error will be large","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/808457672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"IgnacioJPickering","id":34223426,"node_id":"MDQ6VXNlcjM0MjIzNDI2","avatar_url":"https://avatars.githubusercontent.com/u/34223426?v=4","gravatar_id":"","url":"https://api.github.com/users/IgnacioJPickering","html_url":"https://github.com/IgnacioJPickering","followers_url":"https://api.github.com/users/IgnacioJPickering/followers","following_url":"https://api.github.com/users/IgnacioJPickering/following{/other_user}","gists_url":"https://api.github.com/users/IgnacioJPickering/gists{/gist_id}","starred_url":"https://api.github.com/users/IgnacioJPickering/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IgnacioJPickering/subscriptions","organizations_url":"https://api.github.com/users/IgnacioJPickering/orgs","repos_url":"https://api.github.com/users/IgnacioJPickering/repos","events_url":"https://api.github.com/users/IgnacioJPickering/events{/privacy}","received_events_url":"https://api.github.com/users/IgnacioJPickering/received_events","type":"User","site_admin":false}},{"id":4515652887,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDUxNTY1Mjg4Nw==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/4515652887","actor":{"login":"zasdfgbnm","id":1032377,"node_id":"MDQ6VXNlcjEwMzIzNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1032377?v=4","gravatar_id":"","url":"https://api.github.com/users/zasdfgbnm","html_url":"https://github.com/zasdfgbnm","followers_url":"https://api.github.com/users/zasdfgbnm/followers","following_url":"https://api.github.com/users/zasdfgbnm/following{/other_user}","gists_url":"https://api.github.com/users/zasdfgbnm/gists{/gist_id}","starred_url":"https://api.github.com/users/zasdfgbnm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zasdfgbnm/subscriptions","organizations_url":"https://api.github.com/users/zasdfgbnm/orgs","repos_url":"https://api.github.com/users/zasdfgbnm/repos","events_url":"https://api.github.com/users/zasdfgbnm/events{/privacy}","received_events_url":"https://api.github.com/users/zasdfgbnm/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-26T19:19:32Z","performed_via_github_app":null},{"id":4515652896,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1MTU2NTI4OTY=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/4515652896","actor":{"login":"zasdfgbnm","id":1032377,"node_id":"MDQ6VXNlcjEwMzIzNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1032377?v=4","gravatar_id":"","url":"https://api.github.com/users/zasdfgbnm","html_url":"https://github.com/zasdfgbnm","followers_url":"https://api.github.com/users/zasdfgbnm/followers","following_url":"https://api.github.com/users/zasdfgbnm/following{/other_user}","gists_url":"https://api.github.com/users/zasdfgbnm/gists{/gist_id}","starred_url":"https://api.github.com/users/zasdfgbnm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zasdfgbnm/subscriptions","organizations_url":"https://api.github.com/users/zasdfgbnm/orgs","repos_url":"https://api.github.com/users/zasdfgbnm/repos","events_url":"https://api.github.com/users/zasdfgbnm/events{/privacy}","received_events_url":"https://api.github.com/users/zasdfgbnm/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-26T19:19:32Z","performed_via_github_app":null},{"id":4515652907,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDUxNTY1MjkwNw==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/4515652907","actor":{"login":"shubbey","id":24950802,"node_id":"MDQ6VXNlcjI0OTUwODAy","avatar_url":"https://avatars.githubusercontent.com/u/24950802?v=4","gravatar_id":"","url":"https://api.github.com/users/shubbey","html_url":"https://github.com/shubbey","followers_url":"https://api.github.com/users/shubbey/followers","following_url":"https://api.github.com/users/shubbey/following{/other_user}","gists_url":"https://api.github.com/users/shubbey/gists{/gist_id}","starred_url":"https://api.github.com/users/shubbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shubbey/subscriptions","organizations_url":"https://api.github.com/users/shubbey/orgs","repos_url":"https://api.github.com/users/shubbey/repos","events_url":"https://api.github.com/users/shubbey/events{/privacy}","received_events_url":"https://api.github.com/users/shubbey/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-26T19:19:32Z","performed_via_github_app":null},{"id":4515652915,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1MTU2NTI5MTU=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/4515652915","actor":{"login":"shubbey","id":24950802,"node_id":"MDQ6VXNlcjI0OTUwODAy","avatar_url":"https://avatars.githubusercontent.com/u/24950802?v=4","gravatar_id":"","url":"https://api.github.com/users/shubbey","html_url":"https://github.com/shubbey","followers_url":"https://api.github.com/users/shubbey/followers","following_url":"https://api.github.com/users/shubbey/following{/other_user}","gists_url":"https://api.github.com/users/shubbey/gists{/gist_id}","starred_url":"https://api.github.com/users/shubbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shubbey/subscriptions","organizations_url":"https://api.github.com/users/shubbey/orgs","repos_url":"https://api.github.com/users/shubbey/repos","events_url":"https://api.github.com/users/shubbey/events{/privacy}","received_events_url":"https://api.github.com/users/shubbey/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-26T19:19:32Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/808753549","html_url":"https://github.com/aiqm/torchani/issues/578#issuecomment-808753549","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/578","id":808753549,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODc1MzU0OQ==","user":{"login":"Jussmith01","id":11092076,"node_id":"MDQ6VXNlcjExMDkyMDc2","avatar_url":"https://avatars.githubusercontent.com/u/11092076?v=4","gravatar_id":"","url":"https://api.github.com/users/Jussmith01","html_url":"https://github.com/Jussmith01","followers_url":"https://api.github.com/users/Jussmith01/followers","following_url":"https://api.github.com/users/Jussmith01/following{/other_user}","gists_url":"https://api.github.com/users/Jussmith01/gists{/gist_id}","starred_url":"https://api.github.com/users/Jussmith01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jussmith01/subscriptions","organizations_url":"https://api.github.com/users/Jussmith01/orgs","repos_url":"https://api.github.com/users/Jussmith01/repos","events_url":"https://api.github.com/users/Jussmith01/events{/privacy}","received_events_url":"https://api.github.com/users/Jussmith01/received_events","type":"User","site_admin":false},"created_at":"2021-03-27T15:58:32Z","updated_at":"2021-03-27T15:58:32Z","author_association":"NONE","body":"@shubbey Sorry for the late reply. In the original ANI-1 paper there was some probability that a molecule may be excluded from the training set, but in general, there was nothing forcing it.  Imagine putting all conformations in the data set in one big bucket, then randomly selecting 80%. There is a chance you could end up not including any conformations from a specific configuration. \r\n\r\nIn any case, @IgnacioJPickering is correct. We have always relied on very large datasets with a lot of configurational diversity to develop models that are transferable in that space. We also validate our models on completely unseen data sets to ensure there is minimal overfitting. This is why we never focus on validation error or held out test error, but rather on systems that may be more interesting (e.g. large drug molecules) and are not included in the training set. Our work on ANI-1x [https://aip.scitation.org/doi/abs/10.1063/1.5023802] and ANI-2x [https://pubs.acs.org/doi/abs/10.1021/acs.jctc.0c00121] shows the importance of chemical diversity in training and testing outside of the space of things you train on. See the COMP6 benchmark in those papers. Also, one of our more recent publications [https://www.nature.com/articles/s41467-021-21376-0] takes the idea of configurational diversity to a new level, albeit in the materials world.\r\n\r\nAs for your specific issue. Without knowing more about your data set (size, # of configurations, how configurations were selected, etc.) I do not have much to add. I would suggest some form of active learning for data set construction since human bias can impact transferability. ","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/808753549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Jussmith01","id":11092076,"node_id":"MDQ6VXNlcjExMDkyMDc2","avatar_url":"https://avatars.githubusercontent.com/u/11092076?v=4","gravatar_id":"","url":"https://api.github.com/users/Jussmith01","html_url":"https://github.com/Jussmith01","followers_url":"https://api.github.com/users/Jussmith01/followers","following_url":"https://api.github.com/users/Jussmith01/following{/other_user}","gists_url":"https://api.github.com/users/Jussmith01/gists{/gist_id}","starred_url":"https://api.github.com/users/Jussmith01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jussmith01/subscriptions","organizations_url":"https://api.github.com/users/Jussmith01/orgs","repos_url":"https://api.github.com/users/Jussmith01/repos","events_url":"https://api.github.com/users/Jussmith01/events{/privacy}","received_events_url":"https://api.github.com/users/Jussmith01/received_events","type":"User","site_admin":false}},{"id":4517194895,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDUxNzE5NDg5NQ==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/4517194895","actor":{"login":"shubbey","id":24950802,"node_id":"MDQ6VXNlcjI0OTUwODAy","avatar_url":"https://avatars.githubusercontent.com/u/24950802?v=4","gravatar_id":"","url":"https://api.github.com/users/shubbey","html_url":"https://github.com/shubbey","followers_url":"https://api.github.com/users/shubbey/followers","following_url":"https://api.github.com/users/shubbey/following{/other_user}","gists_url":"https://api.github.com/users/shubbey/gists{/gist_id}","starred_url":"https://api.github.com/users/shubbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shubbey/subscriptions","organizations_url":"https://api.github.com/users/shubbey/orgs","repos_url":"https://api.github.com/users/shubbey/repos","events_url":"https://api.github.com/users/shubbey/events{/privacy}","received_events_url":"https://api.github.com/users/shubbey/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-27T15:58:33Z","performed_via_github_app":null},{"id":4517194896,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1MTcxOTQ4OTY=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/4517194896","actor":{"login":"shubbey","id":24950802,"node_id":"MDQ6VXNlcjI0OTUwODAy","avatar_url":"https://avatars.githubusercontent.com/u/24950802?v=4","gravatar_id":"","url":"https://api.github.com/users/shubbey","html_url":"https://github.com/shubbey","followers_url":"https://api.github.com/users/shubbey/followers","following_url":"https://api.github.com/users/shubbey/following{/other_user}","gists_url":"https://api.github.com/users/shubbey/gists{/gist_id}","starred_url":"https://api.github.com/users/shubbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shubbey/subscriptions","organizations_url":"https://api.github.com/users/shubbey/orgs","repos_url":"https://api.github.com/users/shubbey/repos","events_url":"https://api.github.com/users/shubbey/events{/privacy}","received_events_url":"https://api.github.com/users/shubbey/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-27T15:58:33Z","performed_via_github_app":null},{"id":4517194897,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDUxNzE5NDg5Nw==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/4517194897","actor":{"login":"IgnacioJPickering","id":34223426,"node_id":"MDQ6VXNlcjM0MjIzNDI2","avatar_url":"https://avatars.githubusercontent.com/u/34223426?v=4","gravatar_id":"","url":"https://api.github.com/users/IgnacioJPickering","html_url":"https://github.com/IgnacioJPickering","followers_url":"https://api.github.com/users/IgnacioJPickering/followers","following_url":"https://api.github.com/users/IgnacioJPickering/following{/other_user}","gists_url":"https://api.github.com/users/IgnacioJPickering/gists{/gist_id}","starred_url":"https://api.github.com/users/IgnacioJPickering/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IgnacioJPickering/subscriptions","organizations_url":"https://api.github.com/users/IgnacioJPickering/orgs","repos_url":"https://api.github.com/users/IgnacioJPickering/repos","events_url":"https://api.github.com/users/IgnacioJPickering/events{/privacy}","received_events_url":"https://api.github.com/users/IgnacioJPickering/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-27T15:58:33Z","performed_via_github_app":null},{"id":4517194899,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1MTcxOTQ4OTk=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/4517194899","actor":{"login":"IgnacioJPickering","id":34223426,"node_id":"MDQ6VXNlcjM0MjIzNDI2","avatar_url":"https://avatars.githubusercontent.com/u/34223426?v=4","gravatar_id":"","url":"https://api.github.com/users/IgnacioJPickering","html_url":"https://github.com/IgnacioJPickering","followers_url":"https://api.github.com/users/IgnacioJPickering/followers","following_url":"https://api.github.com/users/IgnacioJPickering/following{/other_user}","gists_url":"https://api.github.com/users/IgnacioJPickering/gists{/gist_id}","starred_url":"https://api.github.com/users/IgnacioJPickering/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IgnacioJPickering/subscriptions","organizations_url":"https://api.github.com/users/IgnacioJPickering/orgs","repos_url":"https://api.github.com/users/IgnacioJPickering/repos","events_url":"https://api.github.com/users/IgnacioJPickering/events{/privacy}","received_events_url":"https://api.github.com/users/IgnacioJPickering/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-27T15:58:33Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/809789224","html_url":"https://github.com/aiqm/torchani/issues/578#issuecomment-809789224","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/578","id":809789224,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTc4OTIyNA==","user":{"login":"shubbey","id":24950802,"node_id":"MDQ6VXNlcjI0OTUwODAy","avatar_url":"https://avatars.githubusercontent.com/u/24950802?v=4","gravatar_id":"","url":"https://api.github.com/users/shubbey","html_url":"https://github.com/shubbey","followers_url":"https://api.github.com/users/shubbey/followers","following_url":"https://api.github.com/users/shubbey/following{/other_user}","gists_url":"https://api.github.com/users/shubbey/gists{/gist_id}","starred_url":"https://api.github.com/users/shubbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shubbey/subscriptions","organizations_url":"https://api.github.com/users/shubbey/orgs","repos_url":"https://api.github.com/users/shubbey/repos","events_url":"https://api.github.com/users/shubbey/events{/privacy}","received_events_url":"https://api.github.com/users/shubbey/received_events","type":"User","site_admin":false},"created_at":"2021-03-29T23:21:42Z","updated_at":"2021-03-29T23:21:42Z","author_association":"NONE","body":"Thanks for the responses, guys.  It makes sense.  ","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/809789224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shubbey","id":24950802,"node_id":"MDQ6VXNlcjI0OTUwODAy","avatar_url":"https://avatars.githubusercontent.com/u/24950802?v=4","gravatar_id":"","url":"https://api.github.com/users/shubbey","html_url":"https://github.com/shubbey","followers_url":"https://api.github.com/users/shubbey/followers","following_url":"https://api.github.com/users/shubbey/following{/other_user}","gists_url":"https://api.github.com/users/shubbey/gists{/gist_id}","starred_url":"https://api.github.com/users/shubbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shubbey/subscriptions","organizations_url":"https://api.github.com/users/shubbey/orgs","repos_url":"https://api.github.com/users/shubbey/repos","events_url":"https://api.github.com/users/shubbey/events{/privacy}","received_events_url":"https://api.github.com/users/shubbey/received_events","type":"User","site_admin":false}},{"id":4839270937,"node_id":"MDExOkNsb3NlZEV2ZW50NDgzOTI3MDkzNw==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/4839270937","actor":{"login":"IgnacioJPickering","id":34223426,"node_id":"MDQ6VXNlcjM0MjIzNDI2","avatar_url":"https://avatars.githubusercontent.com/u/34223426?v=4","gravatar_id":"","url":"https://api.github.com/users/IgnacioJPickering","html_url":"https://github.com/IgnacioJPickering","followers_url":"https://api.github.com/users/IgnacioJPickering/followers","following_url":"https://api.github.com/users/IgnacioJPickering/following{/other_user}","gists_url":"https://api.github.com/users/IgnacioJPickering/gists{/gist_id}","starred_url":"https://api.github.com/users/IgnacioJPickering/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IgnacioJPickering/subscriptions","organizations_url":"https://api.github.com/users/IgnacioJPickering/orgs","repos_url":"https://api.github.com/users/IgnacioJPickering/repos","events_url":"https://api.github.com/users/IgnacioJPickering/events{/privacy}","received_events_url":"https://api.github.com/users/IgnacioJPickering/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-06-03T18:50:38Z","state_reason":null,"performed_via_github_app":null}]