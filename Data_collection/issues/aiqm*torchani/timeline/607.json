[{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1022412760","html_url":"https://github.com/aiqm/torchani/issues/607#issuecomment-1022412760","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/607","id":1022412760,"node_id":"IC_kwDOB5237M488MfY","user":{"login":"not-matt","id":32398028,"node_id":"MDQ6VXNlcjMyMzk4MDI4","avatar_url":"https://avatars.githubusercontent.com/u/32398028?v=4","gravatar_id":"","url":"https://api.github.com/users/not-matt","html_url":"https://github.com/not-matt","followers_url":"https://api.github.com/users/not-matt/followers","following_url":"https://api.github.com/users/not-matt/following{/other_user}","gists_url":"https://api.github.com/users/not-matt/gists{/gist_id}","starred_url":"https://api.github.com/users/not-matt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/not-matt/subscriptions","organizations_url":"https://api.github.com/users/not-matt/orgs","repos_url":"https://api.github.com/users/not-matt/repos","events_url":"https://api.github.com/users/not-matt/events{/privacy}","received_events_url":"https://api.github.com/users/not-matt/received_events","type":"User","site_admin":false},"created_at":"2022-01-26T17:14:50Z","updated_at":"2022-01-26T17:15:06Z","author_association":"NONE","body":"Similar issue, probably related?\r\n\r\n```\r\nnum_repeats = torch.where(pbc, num_repeats, num_repeats.new_zeros(()))\r\n                  ~~~~~~~~~~~ <--- HERE\r\n    r1 = torch.arange(1, num_repeats[0].item() + 1, device=cell.device)\r\n    r2 = torch.arange(1, num_repeats[1].item() + 1, device=cell.device)\r\nRuntimeError: Expected condition, x and y to be on the same device, but condition is on cpu and x and y are on cuda:0 and cuda:0 respectively\r\n```\r\n\r\nClean conda environment on Ubuntu, installed packages:\r\n\r\n```\r\nopenmm                    7.7.0            py39h792354b_0    conda-forge\r\nopenmm-torch              0.5             cuda112py39hb628e3f_0    conda-forge\r\nopenmmml                  1.0                      pypi_0    pypi\r\npytorch                   1.10.0          cuda112py39h3ad47f5_1    conda-forge\r\npytorch-gpu               1.10.0          cuda112py39h0bbbad9_1    conda-forge\r\ntorchani                  2.2.3.dev2+g3dfbaf4          pypi_0    pypi\r\n```","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1022412760/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"not-matt","id":32398028,"node_id":"MDQ6VXNlcjMyMzk4MDI4","avatar_url":"https://avatars.githubusercontent.com/u/32398028?v=4","gravatar_id":"","url":"https://api.github.com/users/not-matt","html_url":"https://github.com/not-matt","followers_url":"https://api.github.com/users/not-matt/followers","following_url":"https://api.github.com/users/not-matt/following{/other_user}","gists_url":"https://api.github.com/users/not-matt/gists{/gist_id}","starred_url":"https://api.github.com/users/not-matt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/not-matt/subscriptions","organizations_url":"https://api.github.com/users/not-matt/orgs","repos_url":"https://api.github.com/users/not-matt/repos","events_url":"https://api.github.com/users/not-matt/events{/privacy}","received_events_url":"https://api.github.com/users/not-matt/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1022451965","html_url":"https://github.com/aiqm/torchani/issues/607#issuecomment-1022451965","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/607","id":1022451965,"node_id":"IC_kwDOB5237M488WD9","user":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false},"created_at":"2022-01-26T18:01:51Z","updated_at":"2022-01-26T18:01:51Z","author_association":"CONTRIBUTOR","body":"Hi, thanks for the report! Could you provide a minimal example to reproduce this?","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1022451965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1023139804","html_url":"https://github.com/aiqm/torchani/issues/607#issuecomment-1023139804","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/607","id":1023139804,"node_id":"IC_kwDOB5237M48-9_c","user":{"login":"not-matt","id":32398028,"node_id":"MDQ6VXNlcjMyMzk4MDI4","avatar_url":"https://avatars.githubusercontent.com/u/32398028?v=4","gravatar_id":"","url":"https://api.github.com/users/not-matt","html_url":"https://github.com/not-matt","followers_url":"https://api.github.com/users/not-matt/followers","following_url":"https://api.github.com/users/not-matt/following{/other_user}","gists_url":"https://api.github.com/users/not-matt/gists{/gist_id}","starred_url":"https://api.github.com/users/not-matt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/not-matt/subscriptions","organizations_url":"https://api.github.com/users/not-matt/orgs","repos_url":"https://api.github.com/users/not-matt/repos","events_url":"https://api.github.com/users/not-matt/events{/privacy}","received_events_url":"https://api.github.com/users/not-matt/received_events","type":"User","site_admin":false},"created_at":"2022-01-27T12:06:39Z","updated_at":"2022-01-27T12:07:02Z","author_association":"NONE","body":"It might be more suitable for a separate issue since I'm using an openmm stack.\r\n\r\nSee the full output of the code here:\r\n\r\nhttps://github.com/meyresearch/ANI-Peptides/blob/main/demos/ANI_minimal.ipynb\r\n\r\n## Setup\r\n1. Install openmm and pytorch\r\n```\r\nconda install -c conda-forge openmm openmm-torch pytorch cudatoolkit=11.5\r\n```\r\n2. In bashrc set `CUDA_HOME` to `/usr/local/cuda` and add `/usr/local/cuda` to `PATH`\r\n3. Install torchani with cuaev: \r\n```\r\ngit clone https://github.com/aiqm/torchani\r\ncd torchani\r\npython setup.py install --cuaev\r\n```\r\n4. Install openmm-ml\r\n```\r\ngit clone https://github.com/openmm/openmm-ml\r\npip install openmm-ml/.\r\n```\r\n5. Fetch sample peptide\r\n```\r\nwget -q https://github.com/meyresearch/ANI-Peptides/raw/main/pdbs/aaa.pdb\r\n```\r\n\r\n\r\n## Code\r\n```py\r\n# Import libraries\r\nfrom openmm.app import *\r\nfrom openmm import *\r\nfrom openmm.unit import *\r\nfrom openmmml import MLPotential\r\nimport sys\r\n\r\n# Setup\r\npdb = PDBFile(\"aaa.pdb\")\r\npotential = MLPotential('ani2x')\r\nsystem = potential.createSystem(pdb.topology)\r\nintegrator = LangevinIntegrator(\r\n    300 * kelvin, \r\n    1 / picosecond, \r\n    1.0 * femtosecond,\r\n)\r\nsimulation = Simulation(\r\n    pdb.topology,\r\n    system,\r\n    integrator,\r\n    Platform.getPlatformByName(\"CUDA\"),\r\n)\r\nsimulation.context.setPositions(pdb.positions)\r\n\r\n# Minimize and run\r\nsimulation.minimizeEnergy()\r\nsimulation.step(1000)\r\nprint(\"done\")\r\n```","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1023139804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"not-matt","id":32398028,"node_id":"MDQ6VXNlcjMyMzk4MDI4","avatar_url":"https://avatars.githubusercontent.com/u/32398028?v=4","gravatar_id":"","url":"https://api.github.com/users/not-matt","html_url":"https://github.com/not-matt","followers_url":"https://api.github.com/users/not-matt/followers","following_url":"https://api.github.com/users/not-matt/following{/other_user}","gists_url":"https://api.github.com/users/not-matt/gists{/gist_id}","starred_url":"https://api.github.com/users/not-matt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/not-matt/subscriptions","organizations_url":"https://api.github.com/users/not-matt/orgs","repos_url":"https://api.github.com/users/not-matt/repos","events_url":"https://api.github.com/users/not-matt/events{/privacy}","received_events_url":"https://api.github.com/users/not-matt/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1023628057","html_url":"https://github.com/aiqm/torchani/issues/607#issuecomment-1023628057","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/607","id":1023628057,"node_id":"IC_kwDOB5237M49A1MZ","user":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false},"created_at":"2022-01-27T20:51:37Z","updated_at":"2022-01-27T20:54:42Z","author_association":"CONTRIBUTOR","body":"Hi, the error came from the openmm-ml wrapper. A temp fixed version work ONLY for GPU could be found at: https://github.com/yueyericardo/openmm-ml/commit/1d1d3f24f40becdcd8a36431c8d0900d98eb1304#diff-911692ca194bf903c77d038662969ad3277dcf2fa8b3b3048d95a5aa3af59de1\r\n\r\nIt is using cuaev `use_cuda_extension` for aev calculation, but it currently does not support pbc, so if you want to use cuaev, you have to change your script slightly to\r\n```py\r\npdb = PDBFile(\"aaa.pdb\")\r\n# add this line\r\npdb.topology.setPeriodicBoxVectors(None)\r\npotential = MLPotential('ani2x')\r\n```\r\nOur internal version has some other updates to make it faster, but it currently is not open source yet.\r\nIn the meanwhile, openmm team is building [NNPOPS](https://github.com/openmm/NNPOps) for ani and schnet, you could track the progress here [Add example of using NNPOps with openmm-torch?](https://github.com/openmm/openmm-torch/issues/59)!\r\n\r\nEdit:\r\nBTW, our conda-forge package includes the latest public build with cuaev:\r\nyou could install it directly by \r\n```\r\nconda install -c conda-forge torchani\r\n```","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1023628057/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1023631291","html_url":"https://github.com/aiqm/torchani/issues/607#issuecomment-1023631291","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/607","id":1023631291,"node_id":"IC_kwDOB5237M49A1-7","user":{"login":"not-matt","id":32398028,"node_id":"MDQ6VXNlcjMyMzk4MDI4","avatar_url":"https://avatars.githubusercontent.com/u/32398028?v=4","gravatar_id":"","url":"https://api.github.com/users/not-matt","html_url":"https://github.com/not-matt","followers_url":"https://api.github.com/users/not-matt/followers","following_url":"https://api.github.com/users/not-matt/following{/other_user}","gists_url":"https://api.github.com/users/not-matt/gists{/gist_id}","starred_url":"https://api.github.com/users/not-matt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/not-matt/subscriptions","organizations_url":"https://api.github.com/users/not-matt/orgs","repos_url":"https://api.github.com/users/not-matt/repos","events_url":"https://api.github.com/users/not-matt/events{/privacy}","received_events_url":"https://api.github.com/users/not-matt/received_events","type":"User","site_admin":false},"created_at":"2022-01-27T20:56:16Z","updated_at":"2022-01-27T20:56:16Z","author_association":"NONE","body":"Fantastic! Thank you for looking into this and getting back to me so quickly.","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1023631291/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"not-matt","id":32398028,"node_id":"MDQ6VXNlcjMyMzk4MDI4","avatar_url":"https://avatars.githubusercontent.com/u/32398028?v=4","gravatar_id":"","url":"https://api.github.com/users/not-matt","html_url":"https://github.com/not-matt","followers_url":"https://api.github.com/users/not-matt/followers","following_url":"https://api.github.com/users/not-matt/following{/other_user}","gists_url":"https://api.github.com/users/not-matt/gists{/gist_id}","starred_url":"https://api.github.com/users/not-matt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/not-matt/subscriptions","organizations_url":"https://api.github.com/users/not-matt/orgs","repos_url":"https://api.github.com/users/not-matt/repos","events_url":"https://api.github.com/users/not-matt/events{/privacy}","received_events_url":"https://api.github.com/users/not-matt/received_events","type":"User","site_admin":false}},{"actor":{"login":"not-matt","id":32398028,"node_id":"MDQ6VXNlcjMyMzk4MDI4","avatar_url":"https://avatars.githubusercontent.com/u/32398028?v=4","gravatar_id":"","url":"https://api.github.com/users/not-matt","html_url":"https://github.com/not-matt","followers_url":"https://api.github.com/users/not-matt/followers","following_url":"https://api.github.com/users/not-matt/following{/other_user}","gists_url":"https://api.github.com/users/not-matt/gists{/gist_id}","starred_url":"https://api.github.com/users/not-matt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/not-matt/subscriptions","organizations_url":"https://api.github.com/users/not-matt/orgs","repos_url":"https://api.github.com/users/not-matt/repos","events_url":"https://api.github.com/users/not-matt/events{/privacy}","received_events_url":"https://api.github.com/users/not-matt/received_events","type":"User","site_admin":false},"created_at":"2022-02-03T12:55:36Z","updated_at":"2022-02-03T12:55:36Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/openmm/openmm-ml/issues/21","repository_url":"https://api.github.com/repos/openmm/openmm-ml","labels_url":"https://api.github.com/repos/openmm/openmm-ml/issues/21/labels{/name}","comments_url":"https://api.github.com/repos/openmm/openmm-ml/issues/21/comments","events_url":"https://api.github.com/repos/openmm/openmm-ml/issues/21/events","html_url":"https://github.com/openmm/openmm-ml/pull/21","id":1123053530,"node_id":"PR_kwDOFCM0Hc4yBkO0","number":21,"title":"Implement NNPOps Optimised ANI","user":{"login":"not-matt","id":32398028,"node_id":"MDQ6VXNlcjMyMzk4MDI4","avatar_url":"https://avatars.githubusercontent.com/u/32398028?v=4","gravatar_id":"","url":"https://api.github.com/users/not-matt","html_url":"https://github.com/not-matt","followers_url":"https://api.github.com/users/not-matt/followers","following_url":"https://api.github.com/users/not-matt/following{/other_user}","gists_url":"https://api.github.com/users/not-matt/gists{/gist_id}","starred_url":"https://api.github.com/users/not-matt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/not-matt/subscriptions","organizations_url":"https://api.github.com/users/not-matt/orgs","repos_url":"https://api.github.com/users/not-matt/repos","events_url":"https://api.github.com/users/not-matt/events{/privacy}","received_events_url":"https://api.github.com/users/not-matt/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":16,"created_at":"2022-02-03T12:55:36Z","updated_at":"2022-07-14T16:18:41Z","closed_at":"2022-07-14T16:18:40Z","author_association":"NONE","active_lock_reason":null,"draft":false,"repository":{"id":337851421,"node_id":"MDEwOlJlcG9zaXRvcnkzMzc4NTE0MjE=","name":"openmm-ml","full_name":"openmm/openmm-ml","private":false,"owner":{"login":"openmm","id":52428936,"node_id":"MDEyOk9yZ2FuaXphdGlvbjUyNDI4OTM2","avatar_url":"https://avatars.githubusercontent.com/u/52428936?v=4","gravatar_id":"","url":"https://api.github.com/users/openmm","html_url":"https://github.com/openmm","followers_url":"https://api.github.com/users/openmm/followers","following_url":"https://api.github.com/users/openmm/following{/other_user}","gists_url":"https://api.github.com/users/openmm/gists{/gist_id}","starred_url":"https://api.github.com/users/openmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openmm/subscriptions","organizations_url":"https://api.github.com/users/openmm/orgs","repos_url":"https://api.github.com/users/openmm/repos","events_url":"https://api.github.com/users/openmm/events{/privacy}","received_events_url":"https://api.github.com/users/openmm/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/openmm/openmm-ml","description":"High level API for using machine learning models in OpenMM simulations","fork":false,"url":"https://api.github.com/repos/openmm/openmm-ml","forks_url":"https://api.github.com/repos/openmm/openmm-ml/forks","keys_url":"https://api.github.com/repos/openmm/openmm-ml/keys{/key_id}","collaborators_url":"https://api.github.com/repos/openmm/openmm-ml/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/openmm/openmm-ml/teams","hooks_url":"https://api.github.com/repos/openmm/openmm-ml/hooks","issue_events_url":"https://api.github.com/repos/openmm/openmm-ml/issues/events{/number}","events_url":"https://api.github.com/repos/openmm/openmm-ml/events","assignees_url":"https://api.github.com/repos/openmm/openmm-ml/assignees{/user}","branches_url":"https://api.github.com/repos/openmm/openmm-ml/branches{/branch}","tags_url":"https://api.github.com/repos/openmm/openmm-ml/tags","blobs_url":"https://api.github.com/repos/openmm/openmm-ml/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/openmm/openmm-ml/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/openmm/openmm-ml/git/refs{/sha}","trees_url":"https://api.github.com/repos/openmm/openmm-ml/git/trees{/sha}","statuses_url":"https://api.github.com/repos/openmm/openmm-ml/statuses/{sha}","languages_url":"https://api.github.com/repos/openmm/openmm-ml/languages","stargazers_url":"https://api.github.com/repos/openmm/openmm-ml/stargazers","contributors_url":"https://api.github.com/repos/openmm/openmm-ml/contributors","subscribers_url":"https://api.github.com/repos/openmm/openmm-ml/subscribers","subscription_url":"https://api.github.com/repos/openmm/openmm-ml/subscription","commits_url":"https://api.github.com/repos/openmm/openmm-ml/commits{/sha}","git_commits_url":"https://api.github.com/repos/openmm/openmm-ml/git/commits{/sha}","comments_url":"https://api.github.com/repos/openmm/openmm-ml/comments{/number}","issue_comment_url":"https://api.github.com/repos/openmm/openmm-ml/issues/comments{/number}","contents_url":"https://api.github.com/repos/openmm/openmm-ml/contents/{+path}","compare_url":"https://api.github.com/repos/openmm/openmm-ml/compare/{base}...{head}","merges_url":"https://api.github.com/repos/openmm/openmm-ml/merges","archive_url":"https://api.github.com/repos/openmm/openmm-ml/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/openmm/openmm-ml/downloads","issues_url":"https://api.github.com/repos/openmm/openmm-ml/issues{/number}","pulls_url":"https://api.github.com/repos/openmm/openmm-ml/pulls{/number}","milestones_url":"https://api.github.com/repos/openmm/openmm-ml/milestones{/number}","notifications_url":"https://api.github.com/repos/openmm/openmm-ml/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/openmm/openmm-ml/labels{/name}","releases_url":"https://api.github.com/repos/openmm/openmm-ml/releases{/id}","deployments_url":"https://api.github.com/repos/openmm/openmm-ml/deployments","created_at":"2021-02-10T20:55:25Z","updated_at":"2023-01-05T19:19:48Z","pushed_at":"2022-12-16T07:22:02Z","git_url":"git://github.com/openmm/openmm-ml.git","ssh_url":"git@github.com:openmm/openmm-ml.git","clone_url":"https://github.com/openmm/openmm-ml.git","svn_url":"https://github.com/openmm/openmm-ml","homepage":null,"size":65,"stargazers_count":38,"watchers_count":38,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":14,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":22,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":14,"open_issues":22,"watchers":38,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/openmm/openmm-ml/pulls/21","html_url":"https://github.com/openmm/openmm-ml/pull/21","diff_url":"https://github.com/openmm/openmm-ml/pull/21.diff","patch_url":"https://github.com/openmm/openmm-ml/pull/21.patch","merged_at":null},"body":"These changes simplify the use of NNPOps OptimisedTorchANI in OpenMM simulations, allowing ANI2x to be used with ~6x speedup on my machine. It also allows periodic boundary conditions again for CUDA (see https://github.com/aiqm/torchani/issues/607#issuecomment-1023628057)\r\n\r\n- Faster ANI for small, unsolvated systems\r\n- Allows large solvated systems to be run using mixed ANI/AMBER\r\n\r\nThanks to @jchodera for his example code https://github.com/openmm/openmm-torch/issues/59#issuecomment-1028042839\r\nAddresses https://github.com/openmm/openmm-ml/issues/14\r\n\r\nDemonstration\r\nhttps://github.com/meyresearch/ANI-Peptides/blob/main/demos/ANI_minimal.ipynb\r\n\r\nImportant to note that this PR lacks an option to choose between classic TorchANI and OptimisedTorchANI, instead enforcing NNPops as the only method. I'd be happy to implement a way to choose between the two, but I'm not sure how this would best be implemented to fit this library's structure?\r\n\r\neg.\r\n\r\n```py\r\nopenmmml.MLPotential('ani2x_optimised')\r\n```\r\nor perhaps\r\n```py\r\nopenmmml.MLPotential('ani2x', optimised=True)\r\n```","reactions":{"url":"https://api.github.com/repos/openmm/openmm-ml/issues/21/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/openmm/openmm-ml/issues/21/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1057330567","html_url":"https://github.com/aiqm/torchani/issues/607#issuecomment-1057330567","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/607","id":1057330567,"node_id":"IC_kwDOB5237M4_BZWH","user":{"login":"kryczko","id":3220144,"node_id":"MDQ6VXNlcjMyMjAxNDQ=","avatar_url":"https://avatars.githubusercontent.com/u/3220144?v=4","gravatar_id":"","url":"https://api.github.com/users/kryczko","html_url":"https://github.com/kryczko","followers_url":"https://api.github.com/users/kryczko/followers","following_url":"https://api.github.com/users/kryczko/following{/other_user}","gists_url":"https://api.github.com/users/kryczko/gists{/gist_id}","starred_url":"https://api.github.com/users/kryczko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kryczko/subscriptions","organizations_url":"https://api.github.com/users/kryczko/orgs","repos_url":"https://api.github.com/users/kryczko/repos","events_url":"https://api.github.com/users/kryczko/events{/privacy}","received_events_url":"https://api.github.com/users/kryczko/received_events","type":"User","site_admin":false},"created_at":"2022-03-02T20:05:45Z","updated_at":"2022-03-02T20:05:45Z","author_association":"NONE","body":"I am still getting the same issue I showed above while using an ANI model within pytorch lightning. Any ideas how to fix it?","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1057330567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kryczko","id":3220144,"node_id":"MDQ6VXNlcjMyMjAxNDQ=","avatar_url":"https://avatars.githubusercontent.com/u/3220144?v=4","gravatar_id":"","url":"https://api.github.com/users/kryczko","html_url":"https://github.com/kryczko","followers_url":"https://api.github.com/users/kryczko/followers","following_url":"https://api.github.com/users/kryczko/following{/other_user}","gists_url":"https://api.github.com/users/kryczko/gists{/gist_id}","starred_url":"https://api.github.com/users/kryczko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kryczko/subscriptions","organizations_url":"https://api.github.com/users/kryczko/orgs","repos_url":"https://api.github.com/users/kryczko/repos","events_url":"https://api.github.com/users/kryczko/events{/privacy}","received_events_url":"https://api.github.com/users/kryczko/received_events","type":"User","site_admin":false}}]