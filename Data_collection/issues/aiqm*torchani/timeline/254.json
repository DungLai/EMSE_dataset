[{"id":2414921666,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQxNDkyMTY2Ng==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2414921666","actor":{"login":"jchodera","id":3656088,"node_id":"MDQ6VXNlcjM2NTYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/3656088?v=4","gravatar_id":"","url":"https://api.github.com/users/jchodera","html_url":"https://github.com/jchodera","followers_url":"https://api.github.com/users/jchodera/followers","following_url":"https://api.github.com/users/jchodera/following{/other_user}","gists_url":"https://api.github.com/users/jchodera/gists{/gist_id}","starred_url":"https://api.github.com/users/jchodera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jchodera/subscriptions","organizations_url":"https://api.github.com/users/jchodera/orgs","repos_url":"https://api.github.com/users/jchodera/repos","events_url":"https://api.github.com/users/jchodera/events{/privacy}","received_events_url":"https://api.github.com/users/jchodera/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-06-14T21:41:33Z","performed_via_github_app":null},{"id":2414921668,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0MTQ5MjE2Njg=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2414921668","actor":{"login":"jchodera","id":3656088,"node_id":"MDQ6VXNlcjM2NTYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/3656088?v=4","gravatar_id":"","url":"https://api.github.com/users/jchodera","html_url":"https://github.com/jchodera","followers_url":"https://api.github.com/users/jchodera/followers","following_url":"https://api.github.com/users/jchodera/following{/other_user}","gists_url":"https://api.github.com/users/jchodera/gists{/gist_id}","starred_url":"https://api.github.com/users/jchodera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jchodera/subscriptions","organizations_url":"https://api.github.com/users/jchodera/orgs","repos_url":"https://api.github.com/users/jchodera/repos","events_url":"https://api.github.com/users/jchodera/events{/privacy}","received_events_url":"https://api.github.com/users/jchodera/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-06-14T21:41:33Z","performed_via_github_app":null},{"id":2414921673,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQxNDkyMTY3Mw==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2414921673","actor":{"login":"wiederm","id":31651017,"node_id":"MDQ6VXNlcjMxNjUxMDE3","avatar_url":"https://avatars.githubusercontent.com/u/31651017?v=4","gravatar_id":"","url":"https://api.github.com/users/wiederm","html_url":"https://github.com/wiederm","followers_url":"https://api.github.com/users/wiederm/followers","following_url":"https://api.github.com/users/wiederm/following{/other_user}","gists_url":"https://api.github.com/users/wiederm/gists{/gist_id}","starred_url":"https://api.github.com/users/wiederm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wiederm/subscriptions","organizations_url":"https://api.github.com/users/wiederm/orgs","repos_url":"https://api.github.com/users/wiederm/repos","events_url":"https://api.github.com/users/wiederm/events{/privacy}","received_events_url":"https://api.github.com/users/wiederm/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-06-14T21:41:33Z","performed_via_github_app":null},{"id":2414921674,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0MTQ5MjE2NzQ=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2414921674","actor":{"login":"wiederm","id":31651017,"node_id":"MDQ6VXNlcjMxNjUxMDE3","avatar_url":"https://avatars.githubusercontent.com/u/31651017?v=4","gravatar_id":"","url":"https://api.github.com/users/wiederm","html_url":"https://github.com/wiederm","followers_url":"https://api.github.com/users/wiederm/followers","following_url":"https://api.github.com/users/wiederm/following{/other_user}","gists_url":"https://api.github.com/users/wiederm/gists{/gist_id}","starred_url":"https://api.github.com/users/wiederm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wiederm/subscriptions","organizations_url":"https://api.github.com/users/wiederm/orgs","repos_url":"https://api.github.com/users/wiederm/repos","events_url":"https://api.github.com/users/wiederm/events{/privacy}","received_events_url":"https://api.github.com/users/wiederm/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-06-14T21:41:33Z","performed_via_github_app":null},{"id":2415066217,"node_id":"MDEyOkxhYmVsZWRFdmVudDI0MTUwNjYyMTc=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2415066217","actor":{"login":"zasdfgbnm","id":1032377,"node_id":"MDQ6VXNlcjEwMzIzNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1032377?v=4","gravatar_id":"","url":"https://api.github.com/users/zasdfgbnm","html_url":"https://github.com/zasdfgbnm","followers_url":"https://api.github.com/users/zasdfgbnm/followers","following_url":"https://api.github.com/users/zasdfgbnm/following{/other_user}","gists_url":"https://api.github.com/users/zasdfgbnm/gists{/gist_id}","starred_url":"https://api.github.com/users/zasdfgbnm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zasdfgbnm/subscriptions","organizations_url":"https://api.github.com/users/zasdfgbnm/orgs","repos_url":"https://api.github.com/users/zasdfgbnm/repos","events_url":"https://api.github.com/users/zasdfgbnm/events{/privacy}","received_events_url":"https://api.github.com/users/zasdfgbnm/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-06-14T23:16:00Z","label":{"name":"high priority","color":"b51020"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/502308565","html_url":"https://github.com/aiqm/torchani/issues/254#issuecomment-502308565","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/254","id":502308565,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMjMwODU2NQ==","user":{"login":"zasdfgbnm","id":1032377,"node_id":"MDQ6VXNlcjEwMzIzNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1032377?v=4","gravatar_id":"","url":"https://api.github.com/users/zasdfgbnm","html_url":"https://github.com/zasdfgbnm","followers_url":"https://api.github.com/users/zasdfgbnm/followers","following_url":"https://api.github.com/users/zasdfgbnm/following{/other_user}","gists_url":"https://api.github.com/users/zasdfgbnm/gists{/gist_id}","starred_url":"https://api.github.com/users/zasdfgbnm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zasdfgbnm/subscriptions","organizations_url":"https://api.github.com/users/zasdfgbnm/orgs","repos_url":"https://api.github.com/users/zasdfgbnm/repos","events_url":"https://api.github.com/users/zasdfgbnm/events{/privacy}","received_events_url":"https://api.github.com/users/zasdfgbnm/received_events","type":"User","site_admin":false},"created_at":"2019-06-14T23:18:58Z","updated_at":"2019-06-14T23:18:58Z","author_association":"CONTRIBUTOR","body":"Hi @maxentile, I see this issue and thank you so much for this very detailed explanation. Your feedback is important to us. I will try to reproduce and get back to you as soon as possible.","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/502308565/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zasdfgbnm","id":1032377,"node_id":"MDQ6VXNlcjEwMzIzNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1032377?v=4","gravatar_id":"","url":"https://api.github.com/users/zasdfgbnm","html_url":"https://github.com/zasdfgbnm","followers_url":"https://api.github.com/users/zasdfgbnm/followers","following_url":"https://api.github.com/users/zasdfgbnm/following{/other_user}","gists_url":"https://api.github.com/users/zasdfgbnm/gists{/gist_id}","starred_url":"https://api.github.com/users/zasdfgbnm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zasdfgbnm/subscriptions","organizations_url":"https://api.github.com/users/zasdfgbnm/orgs","repos_url":"https://api.github.com/users/zasdfgbnm/repos","events_url":"https://api.github.com/users/zasdfgbnm/events{/privacy}","received_events_url":"https://api.github.com/users/zasdfgbnm/received_events","type":"User","site_admin":false}},{"id":2415069250,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQxNTA2OTI1MA==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2415069250","actor":{"login":"maxentile","id":5759036,"node_id":"MDQ6VXNlcjU3NTkwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/5759036?v=4","gravatar_id":"","url":"https://api.github.com/users/maxentile","html_url":"https://github.com/maxentile","followers_url":"https://api.github.com/users/maxentile/followers","following_url":"https://api.github.com/users/maxentile/following{/other_user}","gists_url":"https://api.github.com/users/maxentile/gists{/gist_id}","starred_url":"https://api.github.com/users/maxentile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxentile/subscriptions","organizations_url":"https://api.github.com/users/maxentile/orgs","repos_url":"https://api.github.com/users/maxentile/repos","events_url":"https://api.github.com/users/maxentile/events{/privacy}","received_events_url":"https://api.github.com/users/maxentile/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-06-14T23:18:58Z","performed_via_github_app":null},{"id":2415069252,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0MTUwNjkyNTI=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2415069252","actor":{"login":"maxentile","id":5759036,"node_id":"MDQ6VXNlcjU3NTkwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/5759036?v=4","gravatar_id":"","url":"https://api.github.com/users/maxentile","html_url":"https://github.com/maxentile","followers_url":"https://api.github.com/users/maxentile/followers","following_url":"https://api.github.com/users/maxentile/following{/other_user}","gists_url":"https://api.github.com/users/maxentile/gists{/gist_id}","starred_url":"https://api.github.com/users/maxentile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxentile/subscriptions","organizations_url":"https://api.github.com/users/maxentile/orgs","repos_url":"https://api.github.com/users/maxentile/repos","events_url":"https://api.github.com/users/maxentile/events{/privacy}","received_events_url":"https://api.github.com/users/maxentile/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-06-14T23:18:58Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/502321200","html_url":"https://github.com/aiqm/torchani/issues/254#issuecomment-502321200","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/254","id":502321200,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMjMyMTIwMA==","user":{"login":"zasdfgbnm","id":1032377,"node_id":"MDQ6VXNlcjEwMzIzNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1032377?v=4","gravatar_id":"","url":"https://api.github.com/users/zasdfgbnm","html_url":"https://github.com/zasdfgbnm","followers_url":"https://api.github.com/users/zasdfgbnm/followers","following_url":"https://api.github.com/users/zasdfgbnm/following{/other_user}","gists_url":"https://api.github.com/users/zasdfgbnm/gists{/gist_id}","starred_url":"https://api.github.com/users/zasdfgbnm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zasdfgbnm/subscriptions","organizations_url":"https://api.github.com/users/zasdfgbnm/orgs","repos_url":"https://api.github.com/users/zasdfgbnm/repos","events_url":"https://api.github.com/users/zasdfgbnm/events{/privacy}","received_events_url":"https://api.github.com/users/zasdfgbnm/received_events","type":"User","site_admin":false},"created_at":"2019-06-15T00:57:48Z","updated_at":"2019-06-15T01:01:42Z","author_association":"CONTRIBUTOR","body":"Hi @maxentile, I don't quite understand the difference on how you get the figure in 1.1 and in 2.1.\r\nI tried to reproduce using the code below:\r\n\r\n```python\r\nimport torchani\r\nimport torch\r\nimport math\r\n%pylab inline\r\n\r\ndevice = torch.device('cpu')\r\nmodel = torchani.models.ANI1ccx()\r\nspecies = model.species_to_tensor('CHHHH').to(device).unsqueeze(0)\r\ncoordinates = torch.tensor(\r\n    [[ 0.        ,  0.        ,  0.        ],\r\n     [ 0.63918859,  0.63918859,  0.63918859],\r\n     [-0.63918859, -0.63918859,  0.63918859],\r\n     [-0.63918859,  0.63918859, -0.63918859],\r\n     [ 0.63918859, -0.63918859, -0.63918859]])\r\n\r\nglobal_lowest_energy = -106313.8125\r\n\r\ndef try_range(start, end):\r\n    scale = torch.arange(start, end, 0.005)\r\n    bond_lengths = 0.63918859 * math.sqrt(3) * scale\r\n    species_ = species.expand(scale.shape[0], -1)\r\n    coordinates_ = coordinates * scale.unsqueeze(-1).unsqueeze(-1)\r\n    _, energies = model((species_, coordinates_))\r\n    energies = energies * 2625.50 - global_lowest_energy  # Hartree to kJ/mol\r\n    plt.plot(bond_lengths.numpy(), energies.detach().numpy())\r\n    plt.title('ANI-1ccx')\r\n    plt.xlabel('C-H length (Angstrom)')\r\n    plt.ylabel('Energy (kJ/mol)')\r\n    plt.show()\r\n    \r\ntry_range(0, 5)\r\ntry_range(0.8, 1.2)\r\n```\r\nand I get\r\n![image](https://user-images.githubusercontent.com/1032377/59545080-84e99180-8ee7-11e9-84cf-bb95d1bda0b5.png)\r\n![image](https://user-images.githubusercontent.com/1032377/59545086-9468da80-8ee7-11e9-8420-300b78c76b35.png)\r\n\r\nwhich is similar to your figure at 2.1.\r\n\r\nBut how do you get the figure at 1.1?\r\n\r\nThanks a lot!","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/502321200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zasdfgbnm","id":1032377,"node_id":"MDQ6VXNlcjEwMzIzNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1032377?v=4","gravatar_id":"","url":"https://api.github.com/users/zasdfgbnm","html_url":"https://github.com/zasdfgbnm","followers_url":"https://api.github.com/users/zasdfgbnm/followers","following_url":"https://api.github.com/users/zasdfgbnm/following{/other_user}","gists_url":"https://api.github.com/users/zasdfgbnm/gists{/gist_id}","starred_url":"https://api.github.com/users/zasdfgbnm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zasdfgbnm/subscriptions","organizations_url":"https://api.github.com/users/zasdfgbnm/orgs","repos_url":"https://api.github.com/users/zasdfgbnm/repos","events_url":"https://api.github.com/users/zasdfgbnm/events{/privacy}","received_events_url":"https://api.github.com/users/zasdfgbnm/received_events","type":"User","site_admin":false}},{"id":2415146584,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQxNTE0NjU4NA==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2415146584","actor":{"login":"maxentile","id":5759036,"node_id":"MDQ6VXNlcjU3NTkwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/5759036?v=4","gravatar_id":"","url":"https://api.github.com/users/maxentile","html_url":"https://github.com/maxentile","followers_url":"https://api.github.com/users/maxentile/followers","following_url":"https://api.github.com/users/maxentile/following{/other_user}","gists_url":"https://api.github.com/users/maxentile/gists{/gist_id}","starred_url":"https://api.github.com/users/maxentile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxentile/subscriptions","organizations_url":"https://api.github.com/users/maxentile/orgs","repos_url":"https://api.github.com/users/maxentile/repos","events_url":"https://api.github.com/users/maxentile/events{/privacy}","received_events_url":"https://api.github.com/users/maxentile/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-06-15T00:57:48Z","performed_via_github_app":null},{"id":2415146585,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0MTUxNDY1ODU=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2415146585","actor":{"login":"maxentile","id":5759036,"node_id":"MDQ6VXNlcjU3NTkwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/5759036?v=4","gravatar_id":"","url":"https://api.github.com/users/maxentile","html_url":"https://github.com/maxentile","followers_url":"https://api.github.com/users/maxentile/followers","following_url":"https://api.github.com/users/maxentile/following{/other_user}","gists_url":"https://api.github.com/users/maxentile/gists{/gist_id}","starred_url":"https://api.github.com/users/maxentile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxentile/subscriptions","organizations_url":"https://api.github.com/users/maxentile/orgs","repos_url":"https://api.github.com/users/maxentile/repos","events_url":"https://api.github.com/users/maxentile/events{/privacy}","received_events_url":"https://api.github.com/users/maxentile/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-06-15T00:57:48Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/502408692","html_url":"https://github.com/aiqm/torchani/issues/254#issuecomment-502408692","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/254","id":502408692,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMjQwODY5Mg==","user":{"login":"maxentile","id":5759036,"node_id":"MDQ6VXNlcjU3NTkwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/5759036?v=4","gravatar_id":"","url":"https://api.github.com/users/maxentile","html_url":"https://github.com/maxentile","followers_url":"https://api.github.com/users/maxentile/followers","following_url":"https://api.github.com/users/maxentile/following{/other_user}","gists_url":"https://api.github.com/users/maxentile/gists{/gist_id}","starred_url":"https://api.github.com/users/maxentile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxentile/subscriptions","organizations_url":"https://api.github.com/users/maxentile/orgs","repos_url":"https://api.github.com/users/maxentile/repos","events_url":"https://api.github.com/users/maxentile/events{/privacy}","received_events_url":"https://api.github.com/users/maxentile/received_events","type":"User","site_admin":false},"created_at":"2019-06-16T00:11:11Z","updated_at":"2019-06-16T00:11:11Z","author_association":"NONE","body":"Dear Xiang, thank you very much for looking into this! Apologies for my delayed response.\r\n\r\nHere is the script I used to reproduce the energy scans: https://gist.github.com/maxentile/01eb9c09ad6265eaa316efc4078a3cc7\r\n\r\nand the output:\r\n\r\n![methane_energy_scans_with_uncertainties](https://user-images.githubusercontent.com/5759036/59557507-53d19580-8fa9-11e9-8fdf-9ddf257d4de5.png)","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/502408692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"maxentile","id":5759036,"node_id":"MDQ6VXNlcjU3NTkwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/5759036?v=4","gravatar_id":"","url":"https://api.github.com/users/maxentile","html_url":"https://github.com/maxentile","followers_url":"https://api.github.com/users/maxentile/followers","following_url":"https://api.github.com/users/maxentile/following{/other_user}","gists_url":"https://api.github.com/users/maxentile/gists{/gist_id}","starred_url":"https://api.github.com/users/maxentile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxentile/subscriptions","organizations_url":"https://api.github.com/users/maxentile/orgs","repos_url":"https://api.github.com/users/maxentile/repos","events_url":"https://api.github.com/users/maxentile/events{/privacy}","received_events_url":"https://api.github.com/users/maxentile/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/502420853","html_url":"https://github.com/aiqm/torchani/issues/254#issuecomment-502420853","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/254","id":502420853,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMjQyMDg1Mw==","user":{"login":"isayev","id":3207981,"node_id":"MDQ6VXNlcjMyMDc5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3207981?v=4","gravatar_id":"","url":"https://api.github.com/users/isayev","html_url":"https://github.com/isayev","followers_url":"https://api.github.com/users/isayev/followers","following_url":"https://api.github.com/users/isayev/following{/other_user}","gists_url":"https://api.github.com/users/isayev/gists{/gist_id}","starred_url":"https://api.github.com/users/isayev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/isayev/subscriptions","organizations_url":"https://api.github.com/users/isayev/orgs","repos_url":"https://api.github.com/users/isayev/repos","events_url":"https://api.github.com/users/isayev/events{/privacy}","received_events_url":"https://api.github.com/users/isayev/received_events","type":"User","site_admin":false},"created_at":"2019-06-16T05:11:37Z","updated_at":"2019-06-16T05:12:15Z","author_association":"MEMBER","body":"Hey @maxentile @wiederm - first of all, thanks for very detailed \"post mortem\". We are investigating...\r\nFew comments.\r\n\r\n1. Current \"pure\" ML potentials have no physically imposed constraints. Therefore, one has to use them exactly within their **domains of applicability**. For ANI at this point, it's just a single molecule potential. We are working to include bond breaking, but the current public model has sampled C-H bonds within [~0.8... ~1.6] with **closed shell** hamiltonian. As you see it produces a realistic potential well. We are aware of artificial short distance minima - it will be fixed soon. However, to describe the proper bond breaking reactions requires sampling with unrestricted open shell Hamiltonian, proper spin states, etc.  \r\n\r\n2. The transfer learning model is bleeding edge research, and we are still looking for some anomalies because it's essentially a Frankenstein model between DFT and CCSDT. Did you try pure DFT model (1x)?\r\n\r\n3. By the nature ML potentials are reactive, so you can't just use a 1-2fs step for MD. There is also no SHAKE. Realistic time steps should be like in AIMD: 0.1...0.4 fs depending on the fastest vibration in the system and temperature. \r\n","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/502420853/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"isayev","id":3207981,"node_id":"MDQ6VXNlcjMyMDc5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3207981?v=4","gravatar_id":"","url":"https://api.github.com/users/isayev","html_url":"https://github.com/isayev","followers_url":"https://api.github.com/users/isayev/followers","following_url":"https://api.github.com/users/isayev/following{/other_user}","gists_url":"https://api.github.com/users/isayev/gists{/gist_id}","starred_url":"https://api.github.com/users/isayev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/isayev/subscriptions","organizations_url":"https://api.github.com/users/isayev/orgs","repos_url":"https://api.github.com/users/isayev/repos","events_url":"https://api.github.com/users/isayev/events{/privacy}","received_events_url":"https://api.github.com/users/isayev/received_events","type":"User","site_admin":false}},{"id":2415715130,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQxNTcxNTEzMA==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2415715130","actor":{"login":"maxentile","id":5759036,"node_id":"MDQ6VXNlcjU3NTkwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/5759036?v=4","gravatar_id":"","url":"https://api.github.com/users/maxentile","html_url":"https://github.com/maxentile","followers_url":"https://api.github.com/users/maxentile/followers","following_url":"https://api.github.com/users/maxentile/following{/other_user}","gists_url":"https://api.github.com/users/maxentile/gists{/gist_id}","starred_url":"https://api.github.com/users/maxentile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxentile/subscriptions","organizations_url":"https://api.github.com/users/maxentile/orgs","repos_url":"https://api.github.com/users/maxentile/repos","events_url":"https://api.github.com/users/maxentile/events{/privacy}","received_events_url":"https://api.github.com/users/maxentile/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-06-16T05:11:37Z","performed_via_github_app":null},{"id":2415715131,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0MTU3MTUxMzE=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2415715131","actor":{"login":"maxentile","id":5759036,"node_id":"MDQ6VXNlcjU3NTkwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/5759036?v=4","gravatar_id":"","url":"https://api.github.com/users/maxentile","html_url":"https://github.com/maxentile","followers_url":"https://api.github.com/users/maxentile/followers","following_url":"https://api.github.com/users/maxentile/following{/other_user}","gists_url":"https://api.github.com/users/maxentile/gists{/gist_id}","starred_url":"https://api.github.com/users/maxentile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxentile/subscriptions","organizations_url":"https://api.github.com/users/maxentile/orgs","repos_url":"https://api.github.com/users/maxentile/repos","events_url":"https://api.github.com/users/maxentile/events{/privacy}","received_events_url":"https://api.github.com/users/maxentile/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-06-16T05:11:37Z","performed_via_github_app":null},{"id":2415715132,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQxNTcxNTEzMg==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2415715132","actor":{"login":"wiederm","id":31651017,"node_id":"MDQ6VXNlcjMxNjUxMDE3","avatar_url":"https://avatars.githubusercontent.com/u/31651017?v=4","gravatar_id":"","url":"https://api.github.com/users/wiederm","html_url":"https://github.com/wiederm","followers_url":"https://api.github.com/users/wiederm/followers","following_url":"https://api.github.com/users/wiederm/following{/other_user}","gists_url":"https://api.github.com/users/wiederm/gists{/gist_id}","starred_url":"https://api.github.com/users/wiederm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wiederm/subscriptions","organizations_url":"https://api.github.com/users/wiederm/orgs","repos_url":"https://api.github.com/users/wiederm/repos","events_url":"https://api.github.com/users/wiederm/events{/privacy}","received_events_url":"https://api.github.com/users/wiederm/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-06-16T05:11:37Z","performed_via_github_app":null},{"id":2415715133,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0MTU3MTUxMzM=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2415715133","actor":{"login":"wiederm","id":31651017,"node_id":"MDQ6VXNlcjMxNjUxMDE3","avatar_url":"https://avatars.githubusercontent.com/u/31651017?v=4","gravatar_id":"","url":"https://api.github.com/users/wiederm","html_url":"https://github.com/wiederm","followers_url":"https://api.github.com/users/wiederm/followers","following_url":"https://api.github.com/users/wiederm/following{/other_user}","gists_url":"https://api.github.com/users/wiederm/gists{/gist_id}","starred_url":"https://api.github.com/users/wiederm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wiederm/subscriptions","organizations_url":"https://api.github.com/users/wiederm/orgs","repos_url":"https://api.github.com/users/wiederm/repos","events_url":"https://api.github.com/users/wiederm/events{/privacy}","received_events_url":"https://api.github.com/users/wiederm/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-06-16T05:11:37Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/502430716","html_url":"https://github.com/aiqm/torchani/issues/254#issuecomment-502430716","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/254","id":502430716,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMjQzMDcxNg==","user":{"login":"jchodera","id":3656088,"node_id":"MDQ6VXNlcjM2NTYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/3656088?v=4","gravatar_id":"","url":"https://api.github.com/users/jchodera","html_url":"https://github.com/jchodera","followers_url":"https://api.github.com/users/jchodera/followers","following_url":"https://api.github.com/users/jchodera/following{/other_user}","gists_url":"https://api.github.com/users/jchodera/gists{/gist_id}","starred_url":"https://api.github.com/users/jchodera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jchodera/subscriptions","organizations_url":"https://api.github.com/users/jchodera/orgs","repos_url":"https://api.github.com/users/jchodera/repos","events_url":"https://api.github.com/users/jchodera/events{/privacy}","received_events_url":"https://api.github.com/users/jchodera/received_events","type":"User","site_admin":false},"created_at":"2019-06-16T08:08:20Z","updated_at":"2019-06-16T08:43:13Z","author_association":"NONE","body":"Thanks for the detailed response, @isayev!\r\n\r\nWe're just trying to compute the free energy between two tautomers at this point, which should involve only two well-defined end-states that should be fully within the domain of applicability of the model: We're essentially integrating the partition function over the thermally-accessible conformations of the fully closed-shell Hamiltonian. The method we're using to do so may break bonds or alchemically annihilate atoms, but since we're doing this with classical statistical mechanics and free energy is a state function, all we need is well-behaved chemical end-states.\r\n\r\nBecause high-quality Langevin integrators like VRORV ([BAOAB](https://royalsocietypublishing.org/doi/full/10.1098/rspa.2016.0138)) integrators can be pushed to their stability limit [without creating large errors in sampling from conformational probability densities](http://www.choderalab.org/publications/2018/2/16/quantifying-configuration-sampling-error-in-langevin-simulations-of-complex-molecular-systems), and our goal is only to compute relative free energies in configuration space, I don't think we're bound by the need to use tiny timesteps as in AIMD. That assumes there are no nightmarish pathologies introduced into the energy landscape---those energy cusps worry me---that would cause the superconvergence properties to break down.","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/502430716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jchodera","id":3656088,"node_id":"MDQ6VXNlcjM2NTYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/3656088?v=4","gravatar_id":"","url":"https://api.github.com/users/jchodera","html_url":"https://github.com/jchodera","followers_url":"https://api.github.com/users/jchodera/followers","following_url":"https://api.github.com/users/jchodera/following{/other_user}","gists_url":"https://api.github.com/users/jchodera/gists{/gist_id}","starred_url":"https://api.github.com/users/jchodera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jchodera/subscriptions","organizations_url":"https://api.github.com/users/jchodera/orgs","repos_url":"https://api.github.com/users/jchodera/repos","events_url":"https://api.github.com/users/jchodera/events{/privacy}","received_events_url":"https://api.github.com/users/jchodera/received_events","type":"User","site_admin":false}},{"id":2415770545,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQxNTc3MDU0NQ==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2415770545","actor":{"login":"isayev","id":3207981,"node_id":"MDQ6VXNlcjMyMDc5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3207981?v=4","gravatar_id":"","url":"https://api.github.com/users/isayev","html_url":"https://github.com/isayev","followers_url":"https://api.github.com/users/isayev/followers","following_url":"https://api.github.com/users/isayev/following{/other_user}","gists_url":"https://api.github.com/users/isayev/gists{/gist_id}","starred_url":"https://api.github.com/users/isayev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/isayev/subscriptions","organizations_url":"https://api.github.com/users/isayev/orgs","repos_url":"https://api.github.com/users/isayev/repos","events_url":"https://api.github.com/users/isayev/events{/privacy}","received_events_url":"https://api.github.com/users/isayev/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-06-16T08:08:20Z","performed_via_github_app":null},{"id":2415770546,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0MTU3NzA1NDY=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2415770546","actor":{"login":"isayev","id":3207981,"node_id":"MDQ6VXNlcjMyMDc5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3207981?v=4","gravatar_id":"","url":"https://api.github.com/users/isayev","html_url":"https://github.com/isayev","followers_url":"https://api.github.com/users/isayev/followers","following_url":"https://api.github.com/users/isayev/following{/other_user}","gists_url":"https://api.github.com/users/isayev/gists{/gist_id}","starred_url":"https://api.github.com/users/isayev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/isayev/subscriptions","organizations_url":"https://api.github.com/users/isayev/orgs","repos_url":"https://api.github.com/users/isayev/repos","events_url":"https://api.github.com/users/isayev/events{/privacy}","received_events_url":"https://api.github.com/users/isayev/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-06-16T08:08:20Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/502465928","html_url":"https://github.com/aiqm/torchani/issues/254#issuecomment-502465928","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/254","id":502465928,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMjQ2NTkyOA==","user":{"login":"isayev","id":3207981,"node_id":"MDQ6VXNlcjMyMDc5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3207981?v=4","gravatar_id":"","url":"https://api.github.com/users/isayev","html_url":"https://github.com/isayev","followers_url":"https://api.github.com/users/isayev/followers","following_url":"https://api.github.com/users/isayev/following{/other_user}","gists_url":"https://api.github.com/users/isayev/gists{/gist_id}","starred_url":"https://api.github.com/users/isayev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/isayev/subscriptions","organizations_url":"https://api.github.com/users/isayev/orgs","repos_url":"https://api.github.com/users/isayev/repos","events_url":"https://api.github.com/users/isayev/events{/privacy}","received_events_url":"https://api.github.com/users/isayev/received_events","type":"User","site_admin":false},"created_at":"2019-06-16T16:20:51Z","updated_at":"2019-06-16T16:20:51Z","author_association":"MEMBER","body":"@jchodera yah, those look pretty bad! Could you please try \"normal\" DFT trained ANI? Also, irrespective of integrators you really need a shorter timer step for those potentials. I have not tried VRORV, but we use 0.5fs time step for MD. ","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/502465928/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"isayev","id":3207981,"node_id":"MDQ6VXNlcjMyMDc5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3207981?v=4","gravatar_id":"","url":"https://api.github.com/users/isayev","html_url":"https://github.com/isayev","followers_url":"https://api.github.com/users/isayev/followers","following_url":"https://api.github.com/users/isayev/following{/other_user}","gists_url":"https://api.github.com/users/isayev/gists{/gist_id}","starred_url":"https://api.github.com/users/isayev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/isayev/subscriptions","organizations_url":"https://api.github.com/users/isayev/orgs","repos_url":"https://api.github.com/users/isayev/repos","events_url":"https://api.github.com/users/isayev/events{/privacy}","received_events_url":"https://api.github.com/users/isayev/received_events","type":"User","site_admin":false}},{"id":2415972043,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQxNTk3MjA0Mw==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2415972043","actor":{"login":"jchodera","id":3656088,"node_id":"MDQ6VXNlcjM2NTYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/3656088?v=4","gravatar_id":"","url":"https://api.github.com/users/jchodera","html_url":"https://github.com/jchodera","followers_url":"https://api.github.com/users/jchodera/followers","following_url":"https://api.github.com/users/jchodera/following{/other_user}","gists_url":"https://api.github.com/users/jchodera/gists{/gist_id}","starred_url":"https://api.github.com/users/jchodera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jchodera/subscriptions","organizations_url":"https://api.github.com/users/jchodera/orgs","repos_url":"https://api.github.com/users/jchodera/repos","events_url":"https://api.github.com/users/jchodera/events{/privacy}","received_events_url":"https://api.github.com/users/jchodera/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-06-16T16:20:51Z","performed_via_github_app":null},{"id":2415972044,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0MTU5NzIwNDQ=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2415972044","actor":{"login":"jchodera","id":3656088,"node_id":"MDQ6VXNlcjM2NTYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/3656088?v=4","gravatar_id":"","url":"https://api.github.com/users/jchodera","html_url":"https://github.com/jchodera","followers_url":"https://api.github.com/users/jchodera/followers","following_url":"https://api.github.com/users/jchodera/following{/other_user}","gists_url":"https://api.github.com/users/jchodera/gists{/gist_id}","starred_url":"https://api.github.com/users/jchodera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jchodera/subscriptions","organizations_url":"https://api.github.com/users/jchodera/orgs","repos_url":"https://api.github.com/users/jchodera/repos","events_url":"https://api.github.com/users/jchodera/events{/privacy}","received_events_url":"https://api.github.com/users/jchodera/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-06-16T16:20:51Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/502489787","html_url":"https://github.com/aiqm/torchani/issues/254#issuecomment-502489787","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/254","id":502489787,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMjQ4OTc4Nw==","user":{"login":"Jussmith01","id":11092076,"node_id":"MDQ6VXNlcjExMDkyMDc2","avatar_url":"https://avatars.githubusercontent.com/u/11092076?v=4","gravatar_id":"","url":"https://api.github.com/users/Jussmith01","html_url":"https://github.com/Jussmith01","followers_url":"https://api.github.com/users/Jussmith01/followers","following_url":"https://api.github.com/users/Jussmith01/following{/other_user}","gists_url":"https://api.github.com/users/Jussmith01/gists{/gist_id}","starred_url":"https://api.github.com/users/Jussmith01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jussmith01/subscriptions","organizations_url":"https://api.github.com/users/Jussmith01/orgs","repos_url":"https://api.github.com/users/Jussmith01/repos","events_url":"https://api.github.com/users/Jussmith01/events{/privacy}","received_events_url":"https://api.github.com/users/Jussmith01/received_events","type":"User","site_admin":false},"created_at":"2019-06-16T22:07:06Z","updated_at":"2019-06-16T22:07:06Z","author_association":"NONE","body":"Hi all,\r\n\r\nThank you for your interest in our work, and for sharing your experience with us. I'd like to throw in my 2-cents. This post freaked me out a bit so I might have gone a little overboard attempting validate @maxentile results. My findings in short: NeuroChem/ASE with ANI-1ccx are unable to reproduce @maxentile's results. This likely means that ANI-1ccx is not to blame, but some code implementation problem elsewhere. Keep reading for details.\r\n\r\n### Basics of neural network based potentials\r\nI would like to clarify a few things with regard to how ML potentials work. It should not surprise anybody that an ML potential can have a global minimum far lower in energy than what is considered the physical minimum of a system. In fact, there are likely many such minima in the space of all possible input coordinates. Does it surprise me if there is a weird minima for methane that exists for ANI-1ccx? The answer is no. I can show an ML model meant to categorize pictures of horses a picture that to you and I appears to be static noise, but the model will categorize it as a horse. This is an inherent problem in all deep learning. What does surprise me is the 300K thermal accessibility of such states. Ensuring that an ML potential is applicable in MD simulation is a matter of sampling the physically relevant space of interest well enough that the probability of reaching non-physical states under the desired conditions (e.g. 300K temperature) approaches zero. Of course, this is assuming that you start from a semi-realistic geometry. As Olexandr pointed out, most of the regions of the methane potential surface discussed in this thread are well outside of any sampled space, as can be seen by the large standard deviation in @maxentile's figures. Fun fact, Gaussian 09 will crash if you were to give it a bond distance less than 0.5A, so we couldn't have sampled that if we wanted to. In the end, you should use the tools at your disposal, such as the ensemble disagreement to notify you when you do enter into these unphysical regions. With that said, I find it hard to believe (based on my intimate knowledge of the ANI data sets) methane in vacuum is a problem for ANI-1ccx, so I ran a few tests.\r\n\r\n### Independent tests of the ANI-1ccx potential\r\nI wanted to validate whether the ability for @maxentile's MD to escape the well described region of chemical space was ANI-1ccx potential related, TorchANI related, or other code related. Therefore, I decided to run similar studies of methane independently, using our other code package (NeuroChem+ASE). \r\n\r\n### Checking if the \"Bent\" geometry is a minima for ANI-1ccx\r\nTo see if I could reproduce the \"bent\" geometry energy minimum, or at least a minima, I copied @maxentile \"bent\" coordinates and ran a geometry optimization with ANI-1ccx in the NeuroChem/ASE package using LBFGS. Below is the output, where I print all C-H distances and H-C-H angles before and after the optimization:\r\n\r\nDistances:  [1.27001867 1.27055506 1.06795258 1.06973148]\r\nAngles:  [ 92.17736159 102.57026975 102.53879659 102.57196359 102.52411243\r\n 143.47920595]\r\nLBFGS:    1 15:11:31    -1100.161277        6.5967\r\nLBFGS:    2 15:11:31    -1100.512521        5.2980\r\nLBFGS:    3 15:11:31    -1100.790695        3.4940\r\nLBFGS:    4 15:11:31    -1100.966503        1.3452\r\nLBFGS:    5 15:11:31    -1101.040357        0.7483\r\nLBFGS:    6 15:11:31    -1101.062402        0.6299\r\nLBFGS:    7 15:11:31    -1101.091741        0.2075\r\nLBFGS:    8 15:11:31    -1101.093479        0.1288\r\nLBFGS:    9 15:11:31    -1101.094436        0.0762\r\nLBFGS:   10 15:11:31    -1101.094680        0.0649\r\nLBFGS:   11 15:11:31    -1101.095067        0.0416\r\nLBFGS:   12 15:11:31    -1101.095151        0.0197\r\nLBFGS:   13 15:11:31    -1101.095163        0.0024\r\nLBFGS:   14 15:11:31    -1101.095164        0.0001\r\n[ANI Total time: 0.09245634078979492 seconds]\r\nDistances:  [1.08765633 1.08765634 1.08766003 1.08765931]\r\nAngles:  [109.46917795 109.47189449 109.47154575 109.47178379 109.47151341\r\n 109.47164326]\r\n\r\nAs you can see, the geometry optimization returned the \"bent\" structure to the correct tetrahedral geometry. I then did a similar stretch of the tetrahedral vs bent geometry (Section 1.4) and I am not seeing the same behavior. See the figure below:\r\n\r\n![image](https://user-images.githubusercontent.com/11092076/59569975-360a3c00-904e-11e9-85a3-19b8c1a610c3.png)\r\n\r\nHere the bent geometry is higher in energy than the tetrahedral geometry, as we would expect. I have also not seen any of the strange cusps that @jchodera pointed out.\r\n\r\n### My attempt to find the non-physical geometries for Methane in MD\r\nThe first thing I noticed was that my ANI-1ccx geometry optimization resulted in a minimum energy bond distance of 1.087A for the tetrahedral geometry, which seems to be different from what @maxentile found with his scan. This difference needs to be investigated. Below I provide a tetrahedral stretch similar to what @maxentile provided. This clearly shows a lower bond distance than what @maxentile presented: 1.107A.\r\n\r\n![image](https://user-images.githubusercontent.com/11092076/59569267-153ce900-9044-11e9-8231-27c62b2bd9dd.png)\r\n\r\nWhat interests me more than the existence of lower energy minima is the accessibility of those minima. Therefore, I carried out an MD study similar to @maxentile using the Langevin thermostat as implemented in ASE. I stuck with a 1fs time step as @maxentile did, even though I would recommend smaller since we have ran into trouble in the past mixing > 0.5fs time steps and hydrogens. I tried running longer timescale simulations than @maxentile, more specifically 250ps at 300K but I could not reproduce the issue of finding a bent state, or anything other than the tetrahedral geometry. I then tried 250ps at 400K, then 500K, and I still could not reproduce this behavior. I have ran the simulation around 4 times at each temperature using different random seeds. I was have not been able to reproduced it. Below are similar figures to what @maxentile originally provided for his MD. The black dashed lines represent the optimized geometry values.\r\n\r\nC-H bond distance along the trajectory:\r\n![image](https://user-images.githubusercontent.com/11092076/59569344-5da8d680-9045-11e9-8a59-4b469fbbe510.png)\r\n\r\nC-H bond distance histogram (data from the entire trajectory):\r\n![image](https://user-images.githubusercontent.com/11092076/59569350-7c0ed200-9045-11e9-9dbe-6aa4cd8bc215.png)\r\n\r\nHere we can see that the bond distance correctly fluctuates around the equilibrium bond distance. It is slightly off center likely due to the anharmonicity of the bond.\r\n\r\n H-C-H angle along the trajectory:\r\n![image](https://user-images.githubusercontent.com/11092076/59569354-87fa9400-9045-11e9-9542-b80b2239863b.png)\r\n\r\nH-C-H angle histogram (data from the entire trajectory):\r\n![image](https://user-images.githubusercontent.com/11092076/59569378-efb0df00-9045-11e9-8778-efb710820f83.png)\r\n\r\nThe angle correctly fluctuates around the equilibrium angle.\r\n\r\nEnergy along the trajectory:\r\n![image](https://user-images.githubusercontent.com/11092076/59569381-00615500-9046-11e9-9177-7bac7d6d67dc.png)\r\n\r\nThe energy of the trajectory never drops below the optimized tetrahedral geometry energy.\r\n\r\n### Concluding remarks\r\nGiven I cannot reproduce this bent structure in MD or optimization with ANI-1ccx and NeuroChem/ASE points to possible implementation problems with either the thermostat or TorchANI. I believe the above evidence shows this is not a problem with the potential itself. Also, we have validated that TorchANI and NeuroChem agree to single precision, but we should still test TorchANI to be safe. @zasdfgbnm I would recommend getting someone to run a similar study as I did above with TorchANI/ASE to make sure that we agree. If we do agree then there must be something specific to @maxentile code causing the problem.\r\n\r\n### Additional discussion\r\nIt is possible that methods for accelerating the discovery of low energy states might find their way out of a well described physical minima. In the event that happens, you can likely tell by a large ensemble disagreement. At that point the fix would be to rerun active learning using the accelerated sampler to better sample conformational space. ","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/502489787/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Jussmith01","id":11092076,"node_id":"MDQ6VXNlcjExMDkyMDc2","avatar_url":"https://avatars.githubusercontent.com/u/11092076?v=4","gravatar_id":"","url":"https://api.github.com/users/Jussmith01","html_url":"https://github.com/Jussmith01","followers_url":"https://api.github.com/users/Jussmith01/followers","following_url":"https://api.github.com/users/Jussmith01/following{/other_user}","gists_url":"https://api.github.com/users/Jussmith01/gists{/gist_id}","starred_url":"https://api.github.com/users/Jussmith01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jussmith01/subscriptions","organizations_url":"https://api.github.com/users/Jussmith01/orgs","repos_url":"https://api.github.com/users/Jussmith01/repos","events_url":"https://api.github.com/users/Jussmith01/events{/privacy}","received_events_url":"https://api.github.com/users/Jussmith01/received_events","type":"User","site_admin":false}},{"id":2416110671,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQxNjExMDY3MQ==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2416110671","actor":{"login":"zasdfgbnm","id":1032377,"node_id":"MDQ6VXNlcjEwMzIzNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1032377?v=4","gravatar_id":"","url":"https://api.github.com/users/zasdfgbnm","html_url":"https://github.com/zasdfgbnm","followers_url":"https://api.github.com/users/zasdfgbnm/followers","following_url":"https://api.github.com/users/zasdfgbnm/following{/other_user}","gists_url":"https://api.github.com/users/zasdfgbnm/gists{/gist_id}","starred_url":"https://api.github.com/users/zasdfgbnm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zasdfgbnm/subscriptions","organizations_url":"https://api.github.com/users/zasdfgbnm/orgs","repos_url":"https://api.github.com/users/zasdfgbnm/repos","events_url":"https://api.github.com/users/zasdfgbnm/events{/privacy}","received_events_url":"https://api.github.com/users/zasdfgbnm/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-06-16T22:07:06Z","performed_via_github_app":null},{"id":2416110672,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0MTYxMTA2NzI=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2416110672","actor":{"login":"zasdfgbnm","id":1032377,"node_id":"MDQ6VXNlcjEwMzIzNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1032377?v=4","gravatar_id":"","url":"https://api.github.com/users/zasdfgbnm","html_url":"https://github.com/zasdfgbnm","followers_url":"https://api.github.com/users/zasdfgbnm/followers","following_url":"https://api.github.com/users/zasdfgbnm/following{/other_user}","gists_url":"https://api.github.com/users/zasdfgbnm/gists{/gist_id}","starred_url":"https://api.github.com/users/zasdfgbnm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zasdfgbnm/subscriptions","organizations_url":"https://api.github.com/users/zasdfgbnm/orgs","repos_url":"https://api.github.com/users/zasdfgbnm/repos","events_url":"https://api.github.com/users/zasdfgbnm/events{/privacy}","received_events_url":"https://api.github.com/users/zasdfgbnm/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-06-16T22:07:06Z","performed_via_github_app":null},{"id":2416110674,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQxNjExMDY3NA==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2416110674","actor":{"login":"jchodera","id":3656088,"node_id":"MDQ6VXNlcjM2NTYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/3656088?v=4","gravatar_id":"","url":"https://api.github.com/users/jchodera","html_url":"https://github.com/jchodera","followers_url":"https://api.github.com/users/jchodera/followers","following_url":"https://api.github.com/users/jchodera/following{/other_user}","gists_url":"https://api.github.com/users/jchodera/gists{/gist_id}","starred_url":"https://api.github.com/users/jchodera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jchodera/subscriptions","organizations_url":"https://api.github.com/users/jchodera/orgs","repos_url":"https://api.github.com/users/jchodera/repos","events_url":"https://api.github.com/users/jchodera/events{/privacy}","received_events_url":"https://api.github.com/users/jchodera/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-06-16T22:07:06Z","performed_via_github_app":null},{"id":2416110675,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0MTYxMTA2NzU=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2416110675","actor":{"login":"jchodera","id":3656088,"node_id":"MDQ6VXNlcjM2NTYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/3656088?v=4","gravatar_id":"","url":"https://api.github.com/users/jchodera","html_url":"https://github.com/jchodera","followers_url":"https://api.github.com/users/jchodera/followers","following_url":"https://api.github.com/users/jchodera/following{/other_user}","gists_url":"https://api.github.com/users/jchodera/gists{/gist_id}","starred_url":"https://api.github.com/users/jchodera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jchodera/subscriptions","organizations_url":"https://api.github.com/users/jchodera/orgs","repos_url":"https://api.github.com/users/jchodera/repos","events_url":"https://api.github.com/users/jchodera/events{/privacy}","received_events_url":"https://api.github.com/users/jchodera/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-06-16T22:07:06Z","performed_via_github_app":null},{"id":2416110676,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQxNjExMDY3Ng==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2416110676","actor":{"login":"maxentile","id":5759036,"node_id":"MDQ6VXNlcjU3NTkwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/5759036?v=4","gravatar_id":"","url":"https://api.github.com/users/maxentile","html_url":"https://github.com/maxentile","followers_url":"https://api.github.com/users/maxentile/followers","following_url":"https://api.github.com/users/maxentile/following{/other_user}","gists_url":"https://api.github.com/users/maxentile/gists{/gist_id}","starred_url":"https://api.github.com/users/maxentile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxentile/subscriptions","organizations_url":"https://api.github.com/users/maxentile/orgs","repos_url":"https://api.github.com/users/maxentile/repos","events_url":"https://api.github.com/users/maxentile/events{/privacy}","received_events_url":"https://api.github.com/users/maxentile/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-06-16T22:07:06Z","performed_via_github_app":null},{"id":2416110677,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0MTYxMTA2Nzc=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/2416110677","actor":{"login":"maxentile","id":5759036,"node_id":"MDQ6VXNlcjU3NTkwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/5759036?v=4","gravatar_id":"","url":"https://api.github.com/users/maxentile","html_url":"https://github.com/maxentile","followers_url":"https://api.github.com/users/maxentile/followers","following_url":"https://api.github.com/users/maxentile/following{/other_user}","gists_url":"https://api.github.com/users/maxentile/gists{/gist_id}","starred_url":"https://api.github.com/users/maxentile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxentile/subscriptions","organizations_url":"https://api.github.com/users/maxentile/orgs","repos_url":"https://api.github.com/users/maxentile/repos","events_url":"https://api.github.com/users/maxentile/events{/privacy}","received_events_url":"https://api.github.com/users/maxentile/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-06-16T22:07:06Z","performed_via_github_app":null}]