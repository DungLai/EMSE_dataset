[{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1027595891","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1027595891","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1027595891,"node_id":"IC_kwDOB5237M49P95z","user":{"login":"isayev","id":3207981,"node_id":"MDQ6VXNlcjMyMDc5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3207981?v=4","gravatar_id":"","url":"https://api.github.com/users/isayev","html_url":"https://github.com/isayev","followers_url":"https://api.github.com/users/isayev/followers","following_url":"https://api.github.com/users/isayev/following{/other_user}","gists_url":"https://api.github.com/users/isayev/gists{/gist_id}","starred_url":"https://api.github.com/users/isayev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/isayev/subscriptions","organizations_url":"https://api.github.com/users/isayev/orgs","repos_url":"https://api.github.com/users/isayev/repos","events_url":"https://api.github.com/users/isayev/events{/privacy}","received_events_url":"https://api.github.com/users/isayev/received_events","type":"User","site_admin":false},"created_at":"2022-02-02T05:19:26Z","updated_at":"2022-02-02T05:19:26Z","author_association":"MEMBER","body":"You can't serialize a model with compiled custom CUDA kernels. This should work with the default `use_cuda_extension=Flase`\r\nIf you want to use them, save model first, re-load (if needed) and enable afterwards\r\n","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1027595891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"isayev","id":3207981,"node_id":"MDQ6VXNlcjMyMDc5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3207981?v=4","gravatar_id":"","url":"https://api.github.com/users/isayev","html_url":"https://github.com/isayev","followers_url":"https://api.github.com/users/isayev/followers","following_url":"https://api.github.com/users/isayev/following{/other_user}","gists_url":"https://api.github.com/users/isayev/gists{/gist_id}","starred_url":"https://api.github.com/users/isayev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/isayev/subscriptions","organizations_url":"https://api.github.com/users/isayev/orgs","repos_url":"https://api.github.com/users/isayev/repos","events_url":"https://api.github.com/users/isayev/events{/privacy}","received_events_url":"https://api.github.com/users/isayev/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1028075552","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1028075552","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1028075552,"node_id":"IC_kwDOB5237M49RzAg","user":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false},"created_at":"2022-02-02T15:45:15Z","updated_at":"2022-02-02T15:45:15Z","author_association":"CONTRIBUTOR","body":"Hi, you should be able to load the `cuaev.cpython-38-x86_64-linux-gnu.so` under torchani folder. I will look at this later today.","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1028075552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1028202341","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1028202341","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1028202341,"node_id":"IC_kwDOB5237M49SR9l","user":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false},"created_at":"2022-02-02T17:54:34Z","updated_at":"2022-02-02T17:54:34Z","author_association":"NONE","body":"I have already tried saving a CPU model and loading it in C++, then moving it on CUDA. In this case, it runs once and dies afterward. Here is the error \r\n\r\n```\r\nsuccessfully loaded the model\r\nterminate called after throwing an instance of 'c10::Error'\r\n  what():  Error in dlopen or dlsym: libnvrtc-f4909b87.so.11.0: cannot open shared object file: No such file or directory\r\nException raised from checkDL at /home/nazanin/programs/pytorch/aten/src/ATen/DynamicLibrary.cpp:23 (most recent call first):\r\nframe #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x55 (0x7fa2c01a58b5 in /home/nazanin/programs/libtorch/lib/libc10.so)\r\nframe #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0xb1 (0x7fa2c01a3021 in /home/nazanin/programs/libtorch/lib/libc10.so)\r\nframe #2: <unknown function> + 0xedf79e (0x7fa2b3c2179e in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #3: at::DynamicLibrary::DynamicLibrary(char const*, char const*) + 0x62 (0x7fa2b3c21bf2 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #4: <unknown function> + 0xc3d4a2 (0x7fa2aa2a54a2 in /home/nazanin/programs/libtorch/lib/libtorch_cuda.so)\r\nframe #5: <unknown function> + 0xc3d8a1 (0x7fa2aa2a58a1 in /home/nazanin/programs/libtorch/lib/libtorch_cuda.so)\r\nframe #6: torch::jit::tensorexpr::CudaCodeGen::CompileToNVRTC(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x1c8 (0x7fa2aa78fc58 in /home/nazanin/programs/libtorch/lib/libtorch_cuda.so)\r\nframe #7: torch::jit::tensorexpr::CudaCodeGen::Initialize() + 0x172a (0x7fa2aa794a8a in /home/nazanin/programs/libtorch/lib/libtorch_cuda.so)\r\nframe #8: <unknown function> + 0x11399f4 (0x7fa2aa7a19f4 in /home/nazanin/programs/libtorch/lib/libtorch_cuda.so)\r\nframe #9: torch::jit::tensorexpr::CreateCodeGen(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, torch::jit::tensorexpr::Stmt*, std::vector<torch::jit::tensorexpr::CodeGen::BufferArg, std::allocator<torch::jit::tensorexpr::CodeGen::BufferArg> > const&, c10::Device, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x7b (0x7fa2b6222a4b in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #10: torch::jit::tensorexpr::TensorExprKernel::compile() + 0x907 (0x7fa2b62b78c7 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #11: torch::jit::tensorexpr::TensorExprKernel::TensorExprKernel(std::shared_ptr<torch::jit::Graph> const&) + 0x2e8 (0x7fa2b62b84e8 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #12: <unknown function> + 0x33f0a46 (0x7fa2b6132a46 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #13: <unknown function> + 0x3433919 (0x7fa2b6175919 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #14: <unknown function> + 0x3435fe7 (0x7fa2b6177fe7 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #15: <unknown function> + 0x343651a (0x7fa2b617851a in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #16: <unknown function> + 0x343686b (0x7fa2b617886b in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #17: <unknown function> + 0x34369ff (0x7fa2b61789ff in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #18: <unknown function> + 0x3435fcc (0x7fa2b6177fcc in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #19: <unknown function> + 0x343651a (0x7fa2b617851a in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #20: torch::jit::Code::Code(std::shared_ptr<torch::jit::Graph> const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, unsigned long) + 0x1d2b (0x7fa2b616e08b in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #21: <unknown function> + 0x341f855 (0x7fa2b6161855 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #22: <unknown function> + 0x341fed9 (0x7fa2b6161ed9 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #23: <unknown function> + 0x3433919 (0x7fa2b6175919 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #24: <unknown function> + 0x3435fe7 (0x7fa2b6177fe7 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #25: <unknown function> + 0x343651a (0x7fa2b617851a in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #26: <unknown function> + 0x343686b (0x7fa2b617886b in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #27: <unknown function> + 0x34369ff (0x7fa2b61789ff in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #28: <unknown function> + 0x3435fcc (0x7fa2b6177fcc in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #29: <unknown function> + 0x343651a (0x7fa2b617851a in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #30: <unknown function> + 0x343686b (0x7fa2b617886b in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #31: <unknown function> + 0x34369ff (0x7fa2b61789ff in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #32: <unknown function> + 0x3435fcc (0x7fa2b6177fcc in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #33: <unknown function> + 0x343651a (0x7fa2b617851a in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #34: torch::jit::Code::Code(std::shared_ptr<torch::jit::Graph> const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, unsigned long) + 0x1d2b (0x7fa2b616e08b in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #35: <unknown function> + 0x3424318 (0x7fa2b6166318 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #36: <unknown function> + 0x3449701 (0x7fa2b618b701 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #37: <unknown function> + 0x344a18e (0x7fa2b618c18e in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #38: <unknown function> + 0x34227d4 (0x7fa2b61647d4 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #39: torch::jit::GraphFunction::operator()(std::vector<c10::IValue, std::allocator<c10::IValue> >, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, c10::IValue, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, c10::IValue> > > const&) + 0x39 (0x7fa2b5ed73c9 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #40: torch::jit::Method::operator()(std::vector<c10::IValue, std::allocator<c10::IValue> >, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, c10::IValue, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, c10::IValue> > > const&) + 0x143 (0x7fa2b5ee3253 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #41: torch::jit::Module::forward(std::vector<c10::IValue, std::allocator<c10::IValue> >) + 0xe8 (0x435ef6 in ./test_model)\r\nframe #42: main + 0x1042 (0x42d60f in ./test_model)\r\nframe #43: __libc_start_main + 0xf3 (0x7fa2a92c6493 in /lib64/libc.so.6)\r\nframe #44: _start + 0x2e (0x42c3be in ./test_model)\r\n\r\nAborted (core dumped)\r\n```\r\n[ani_cuda.zip](https://github.com/aiqm/torchani/files/7988938/ani_cuda.zip)\r\n","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1028202341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1028338008","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1028338008","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1028338008,"node_id":"IC_kwDOB5237M49SzFY","user":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false},"created_at":"2022-02-02T20:39:14Z","updated_at":"2022-02-02T20:39:14Z","author_association":"CONTRIBUTOR","body":"Hi, please try whether this works: https://github.com/yueyericardo/cuaev_cpp\r\n\r\ncc @IgnacioJPickering ","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1028338008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false}},{"id":5998510370,"node_id":"MEE_lADOB5237M5C1qZJzwAAAAFligEi","url":"https://api.github.com/repos/aiqm/torchani/issues/events/5998510370","actor":{"login":"IgnacioJPickering","id":34223426,"node_id":"MDQ6VXNlcjM0MjIzNDI2","avatar_url":"https://avatars.githubusercontent.com/u/34223426?v=4","gravatar_id":"","url":"https://api.github.com/users/IgnacioJPickering","html_url":"https://github.com/IgnacioJPickering","followers_url":"https://api.github.com/users/IgnacioJPickering/followers","following_url":"https://api.github.com/users/IgnacioJPickering/following{/other_user}","gists_url":"https://api.github.com/users/IgnacioJPickering/gists{/gist_id}","starred_url":"https://api.github.com/users/IgnacioJPickering/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IgnacioJPickering/subscriptions","organizations_url":"https://api.github.com/users/IgnacioJPickering/orgs","repos_url":"https://api.github.com/users/IgnacioJPickering/repos","events_url":"https://api.github.com/users/IgnacioJPickering/events{/privacy}","received_events_url":"https://api.github.com/users/IgnacioJPickering/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-02-02T20:39:14Z","performed_via_github_app":null},{"id":5998510382,"node_id":"SE_lADOB5237M5C1qZJzwAAAAFligEu","url":"https://api.github.com/repos/aiqm/torchani/issues/events/5998510382","actor":{"login":"IgnacioJPickering","id":34223426,"node_id":"MDQ6VXNlcjM0MjIzNDI2","avatar_url":"https://avatars.githubusercontent.com/u/34223426?v=4","gravatar_id":"","url":"https://api.github.com/users/IgnacioJPickering","html_url":"https://github.com/IgnacioJPickering","followers_url":"https://api.github.com/users/IgnacioJPickering/followers","following_url":"https://api.github.com/users/IgnacioJPickering/following{/other_user}","gists_url":"https://api.github.com/users/IgnacioJPickering/gists{/gist_id}","starred_url":"https://api.github.com/users/IgnacioJPickering/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IgnacioJPickering/subscriptions","organizations_url":"https://api.github.com/users/IgnacioJPickering/orgs","repos_url":"https://api.github.com/users/IgnacioJPickering/repos","events_url":"https://api.github.com/users/IgnacioJPickering/events{/privacy}","received_events_url":"https://api.github.com/users/IgnacioJPickering/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-02-02T20:39:14Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1028375794","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1028375794","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1028375794,"node_id":"IC_kwDOB5237M49S8Ty","user":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false},"created_at":"2022-02-02T21:30:15Z","updated_at":"2022-02-02T21:30:15Z","author_association":"NONE","body":"Thank you for taking the time and working on this issue. I cloned the repo and followed the instructions you wrote. This is the error:\r\n\r\n```\r\n[ 20%] Building CXX object cuaev/CMakeFiles/cuaev.dir/cuaev.cpp.o\r\n[ 40%] Building CUDA object cuaev/CMakeFiles/cuaev.dir/aev.cu.o\r\n/projects/cpp_codes/cuaev_cpp/cuaev/aev.cu(799): error: identifier \"C10_CUDA_KERNEL_LAUNCH_CHECK\" is undefined\r\n\r\n/projects/cpp_codes/cuaev_cpp/cuaev/aev.cu(810): error: identifier \"C10_CUDA_KERNEL_LAUNCH_CHECK\" is undefined\r\n\r\n/projects/cpp_codes/cuaev_cpp/cuaev/aev.cu(833): error: identifier \"C10_CUDA_KERNEL_LAUNCH_CHECK\" is undefined\r\n\r\n/projects/cpp_codes/cuaev_cpp/cuaev/aev.cu(957): error: identifier \"C10_CUDA_KERNEL_LAUNCH_CHECK\" is undefined\r\n\r\n/projects/cpp_codes/cuaev_cpp/cuaev/aev.cu(1045): error: identifier \"C10_CUDA_KERNEL_LAUNCH_CHECK\" is undefined\r\n``` ","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1028375794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1028464530","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1028464530","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1028464530,"node_id":"IC_kwDOB5237M49TR-S","user":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false},"created_at":"2022-02-02T23:46:17Z","updated_at":"2022-02-02T23:53:14Z","author_association":"CONTRIBUTOR","body":"Hi, please check the readme and build again. https://github.com/yueyericardo/cuaev_cpp\r\nIt is currently working for cuda and cpu when not using cuaev. \r\nI'm still checking the cuaev issue.","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1028464530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1028522094","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1028522094","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1028522094,"node_id":"IC_kwDOB5237M49TgBu","user":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false},"created_at":"2022-02-03T01:37:38Z","updated_at":"2022-02-03T01:37:38Z","author_association":"CONTRIBUTOR","body":"cuaev also works now on my local machine. let me know if it works on your side. \r\nJust curious, what are you using this for?","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1028522094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029140850","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029140850","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029140850,"node_id":"IC_kwDOB5237M49V3Fy","user":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false},"created_at":"2022-02-03T16:02:07Z","updated_at":"2022-02-03T16:09:08Z","author_association":"NONE","body":"It is working for me too! We are using this model as an OpenMM external force plugin to run MD simulations. \r\nThank you for getting the cuaev  working. I was wondering why loading the CPU model and moving it on CUDA is not working even though all its functions are implemented by Torch? ","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029140850/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029519036","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029519036","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029519036,"node_id":"IC_kwDOB5237M49XTa8","user":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T00:11:05Z","updated_at":"2022-02-04T00:11:05Z","author_association":"CONTRIBUTOR","body":"Hi, if not using cuaev, cpu and gpu model should be fine for both cases.\r\nif using cuaev (cuda_extension=True), the model has to been on gpu, because in the begining of the design, https://github.com/aiqm/torchani/blob/master/torchani/cuaev/cuaev.cpp#L153, the tensors of aev_params (EtaR_t, ShfZ_t etc) are assumed already in the gpu if calling cuda_extension==True, and these tensors is not supported to change device in the current code.\r\nA workaround now could be save different models on disks, and use different one accordingly.","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029519036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029556507","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029556507","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029556507,"node_id":"IC_kwDOB5237M49Xckb","user":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T01:27:45Z","updated_at":"2022-02-04T01:27:45Z","author_association":"NONE","body":"I am not sure what the problem is, but the GPU model is not working without using cuaev. My goal was to have a CPU model and move it on GPU without dealing with cuaev, but it runs just once. Unfortunately, I was not able to fix this issue. I attached the code. Use `save_ani_cpu.py` to create the model.\r\n[ani_cuda.zip](https://github.com/aiqm/torchani/files/7999277/ani_cuda.zip)\r\n ","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029556507/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029563016","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029563016","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029563016,"node_id":"IC_kwDOB5237M49XeKI","user":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T01:43:29Z","updated_at":"2022-02-04T01:43:29Z","author_association":"CONTRIBUTOR","body":"please check the commit at https://github.com/yueyericardo/cuaev_cpp/commit/0ebf55a527e92f1e3f56585ffbdd1d0137a43839,\r\nit should print out \r\n```\r\nFirst call:  [2, 5, 384]\r\nSecond call: [2, 5, 384]\r\n```","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029563016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029568705","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029568705","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029568705,"node_id":"IC_kwDOB5237M49XfjB","user":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T01:56:53Z","updated_at":"2022-02-04T01:56:53Z","author_association":"NONE","body":"Thank you! It works! It seems that we have to compile the code with cuaev even when we are not using it. In the folder that I've attached, I am not using cuaev. ","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029568705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029571065","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029571065","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029571065,"node_id":"IC_kwDOB5237M49XgH5","user":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T02:02:37Z","updated_at":"2022-02-04T02:02:37Z","author_association":"NONE","body":"Also, your model is still on CPU and has not moved on GPU.","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029571065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029572549","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029572549","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029572549,"node_id":"IC_kwDOB5237M49XgfF","user":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T02:05:43Z","updated_at":"2022-02-04T02:05:43Z","author_association":"CONTRIBUTOR","body":"could you try https://github.com/yueyericardo/cuaev_cpp/blob/main/test_model.cpp#L22\r\n```\r\nmodel = torch::jit::load(argv[1], device);\r\n```\r\ninstead of `model.to(cuda)`?","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029572549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029576052","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029576052","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029576052,"node_id":"IC_kwDOB5237M49XhV0","user":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T02:13:52Z","updated_at":"2022-02-04T02:13:52Z","author_association":"NONE","body":"Same error. Would it be possible to try the codes inside the attached folder below? \r\n[ani_cuda.zip](https://github.com/aiqm/torchani/files/7999547/ani_cuda.zip)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029576052/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029578725","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029578725","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029578725,"node_id":"IC_kwDOB5237M49Xh_l","user":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T02:20:05Z","updated_at":"2022-02-04T02:20:21Z","author_association":"CONTRIBUTOR","body":"Your attched code worked fine.\r\nto make it cpu model, I changed the following, it also works.\r\n```diff\r\ndiff --git a/models/cpu_model.pt b/models/cpu_model.pt\r\nindex 29688aa..1d90e3b 100644\r\nBinary files a/models/cpu_model.pt and b/models/cpu_model.pt differ\r\ndiff --git a/save_ani_cpu.py b/save_ani_cpu.py\r\nindex a8ac783..1d32ef5 100644\r\n--- a/save_ani_cpu.py\r\n+++ b/save_ani_cpu.py\r\n@@ -6,7 +6,7 @@ import torchani\r\n\r\n\r\n def save_cpu_aev():\r\n-    device = torch.device('cuda')\r\n+    device = torch.device('cpu')\r\n     tolerance = 5e-5\r\n     Rcr = 5.2000e+00\r\n     Rca = 3.5000e+00\r\ndiff --git a/test_model.cpp b/test_model.cpp\r\nindex c656257..b75b89a 100755\r\n--- a/test_model.cpp\r\n+++ b/test_model.cpp\r\n@@ -21,7 +21,7 @@ int main(int argc, const char* argv[]) {\r\n   torch::Device device(torch::kCUDA);\r\n   try {\r\n\r\n-       model = torch::jit::load(argv[1]);\r\n+       model = torch::jit::load(argv[1], device);\r\n        std::cout << \"successfully loaded the model\\n\";\r\n   }\r\n\r\n@@ -30,7 +30,7 @@ int main(int argc, const char* argv[]) {\r\n        return -1;\r\n   }\r\n\r\n-  model.to(device);\r\n+  // model.to(device);\r\n   torch::Tensor coords = torch::tensor({\r\n        {{0.03192167, 0.00638559, 0.01301679},\r\n         {-0.83140486, 0.39370209, -0.26395324},\r\n```\r\n\r\nwhat kind of error you gor?\r\n","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029578725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029580368","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029580368","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029580368,"node_id":"IC_kwDOB5237M49XiZQ","user":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T02:23:48Z","updated_at":"2022-02-04T02:23:48Z","author_association":"NONE","body":"Here is the error:\r\n\r\n```\r\nsuccessfully loaded the model  \r\nfirst call[2, 5, 560]\r\nterminate called after throwing an instance of 'c10::Error'\r\n  what():  Error in dlopen or dlsym: libnvrtc-f4909b87.so.11.0: cannot open shared object file: No such file or directory\r\nException raised from checkDL at /home/nazanin/programs/pytorch/aten/src/ATen/DynamicLibrary.cpp:23 (most recent call first):\r\nframe #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x55 (0x7f634b5908b5 in /home/nazanin/programs/libtorch/lib/libc10.so)\r\nframe #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0xb1 (0x7f634b58e021 in /home/nazanin/programs/libtorch/lib/libc10.so)\r\nframe #2: <unknown function> + 0xedf79e (0x7f633f00c79e in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #3: at::DynamicLibrary::DynamicLibrary(char const*, char const*) + 0x62 (0x7f633f00cbf2 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #4: <unknown function> + 0xc3d4a2 (0x7f63356904a2 in /home/nazanin/programs/libtorch/lib/libtorch_cuda.so)\r\nframe #5: <unknown function> + 0xc3d8a1 (0x7f63356908a1 in /home/nazanin/programs/libtorch/lib/libtorch_cuda.so)\r\nframe #6: torch::jit::tensorexpr::CudaCodeGen::CompileToNVRTC(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x1c8 (0x7f6335b7ac58 in /home/nazanin/programs/libtorch/lib/libtorch_cuda.so)\r\nframe #7: torch::jit::tensorexpr::CudaCodeGen::Initialize() + 0x172a (0x7f6335b7fa8a in /home/nazanin/programs/libtorch/lib/libtorch_cuda.so)\r\nframe #8: <unknown function> + 0x11399f4 (0x7f6335b8c9f4 in /home/nazanin/programs/libtorch/lib/libtorch_cuda.so)\r\nframe #9: torch::jit::tensorexpr::CreateCodeGen(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, torch::jit::tensorexpr::Stmt*, std::vector<torch::jit::tensorexpr::CodeGen::BufferArg, std::allocator<torch::jit::tensorexpr::CodeGen::BufferArg> > const&, c10::Device, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x7b (0x7f634160da4b in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #10: torch::jit::tensorexpr::TensorExprKernel::compile() + 0x907 (0x7f63416a28c7 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #11: torch::jit::tensorexpr::TensorExprKernel::TensorExprKernel(std::shared_ptr<torch::jit::Graph> const&) + 0x2e8 (0x7f63416a34e8 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\n63416a34e8 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #12: <unknown function> + 0x33f0a46 (0x7f634151da46 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #13: <unknown function> + 0x3433919 (0x7f6341560919 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #14: <unknown function> + 0x3435fe7 (0x7f6341562fe7 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #15: <unknown function> + 0x343651a (0x7f634156351a in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #16: <unknown function> + 0x343686b (0x7f634156386b in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #17: <unknown function> + 0x34369ff (0x7f63415639ff in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #18: <unknown function> + 0x3435fcc (0x7f6341562fcc in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #19: <unknown function> + 0x343651a (0x7f634156351a in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #20: torch::jit::Code::Code(std::shared_ptr<torch::jit::Graph> const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, unsigned long) + 0x1d2b (0x7f634155908b in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #21: <unknown function> + 0x341f855 (0x7f634154c855 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #22: <unknown function> + 0x341fed9 (0x7f634154ced9 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #23: <unknown function> + 0x3433919 (0x7f6341560919 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #24: <unknown function> + 0x3435fe7 (0x7f6341562fe7 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #25: <unknown function> + 0x343651a (0x7f634156351a in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #26: <unknown function> + 0x343686b (0x7f634156386b in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #27: <unknown function> + 0x34369ff (0x7f63415639ff in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #28: <unknown function> + 0x3435fcc (0x7f6341562fcc in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #29: <unknown function> + 0x343651a (0x7f634156351a in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #30: <unknown function> + 0x343686b (0x7f634156386b in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #31: <unknown function> + 0x34369ff (0x7f63415639ff in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #32: <unknown function> + 0x3435fcc (0x7f6341562fcc in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #33: <unknown function> + 0x343651a (0x7f634156351a in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #34: torch::jit::Code::Code(std::shared_ptr<torch::jit::Graph> const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, unsigned long) + 0x1d2b (0x7f634155908b in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #35: <unknown function> + 0x3424318 (0x7f6341551318 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #36: <unknown function> + 0x3449701 (0x7f6341576701 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #37: <unknown function> + 0x344a18e (0x7f634157718e in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #38: <unknown function> + 0x34227d4 (0x7f634154f7d4 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #39: torch::jit::GraphFunction::operator()(std::vector<c10::IValue, std::allocator<c10::IValue> >, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, c10::IValue, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, c10::IValue> > > const&) + 0x39 (0x7f63412c23c9 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #40: torch::jit::Method::operator()(std::vector<c10::IValue, std::allocator<c10::IValue> >, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, c10::IValue, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, c10::IValue> > > const&) + 0x143 (0x7f63412ce253 in /home/nazanin/programs/libtorch/lib/libtorch_cpu.so)\r\nframe #41: torch::jit::Module::forward(std::vector<c10::IValue, std::allocator<c10::IValue> >) + 0xe8 (0x436900 in ./test_model)\r\nframe #42: main + 0x1106 (0x42db93 in ./test_model)\r\nframe #43: __libc_start_main + 0xf3 (0x7f63346b1493 in /lib64/libc.so.6)\r\nframe #44: _start + 0x2e (0x42c87e in ./test_model)\r\n\r\nAborted (core dumped)\r\n```","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029580368/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029581974","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029581974","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029581974,"node_id":"IC_kwDOB5237M49XiyW","user":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T02:27:36Z","updated_at":"2022-02-04T02:27:36Z","author_association":"CONTRIBUTOR","body":"have no idea, I'm using the environment created at https://github.com/yueyericardo/cuaev_cpp/blob/main/README.md#build-instruction\r\n\r\nAre you using the same? cuda 11.3 latest torch and torchani?","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029581974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029583269","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029583269","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029583269,"node_id":"IC_kwDOB5237M49XjGl","user":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T02:31:09Z","updated_at":"2022-02-04T02:31:09Z","author_association":"NONE","body":"The only difference is that I'm not compiling with cuaev. ","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029583269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029585364","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029585364","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029585364,"node_id":"IC_kwDOB5237M49XjnU","user":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T02:37:07Z","updated_at":"2022-02-04T02:37:07Z","author_association":"CONTRIBUTOR","body":"I'm not sure, but \r\n```\r\nwhat():  Error in dlopen or dlsym: libnvrtc-f4909b87.so.11.0: cannot open shared object file: No such file or directory\r\n```\r\nthis seems to be linked with cuda11.0 library instead of cuda11.3?\r\n\r\n![image](https://user-images.githubusercontent.com/9999318/152463167-cb400300-f762-4909-97a8-5279e55ae693.png)\r\n","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029585364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029586121","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029586121","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029586121,"node_id":"IC_kwDOB5237M49XjzJ","user":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T02:39:20Z","updated_at":"2022-02-04T02:39:20Z","author_association":"NONE","body":"Ok. I get the following error when I compiled it with Libtorch from Pytorch Conda installation.\r\n\r\n```\r\nsuccessfully loaded the model\r\nfirst call[2, 5, 560]\r\nterminate called after throwing an instance of 'std::runtime_error'\r\n  what():  The following operation failed in the TorchScript interpreter.\r\nTraceback of TorchScript, serialized code (most recent call last):\r\n  File \"code/__torch__/torchani/aev/___torch_mangle_0.py\", line 117, in forward\r\n      _38 = torch.cumsum(_36, 0, dtype=None, out=_37)\r\n      _39 = torch.index_select(cumsum, 0, pair_indices)\r\n      sorted_local_index120 = torch.add_(sorted_local_index12, _39, alpha=1)\r\n                              ~~~~~~~~~~ <--- HERE\r\n      _40 = annotate(List[Optional[Tensor]], [sorted_local_index120])\r\n      local_index12 = torch.index(rev_indices, _40)\r\n\r\nTraceback of TorchScript, original code (most recent call last):\r\n  File \"/home/nazanin/programs/torchani/torchani/aev.py\", line 254, in forward\r\n    mask = (torch.arange(intra_pair_indices.shape[2], device=ai1.device) < pair_sizes.unsqueeze(1)).flatten()\r\n    sorted_local_index12 = intra_pair_indices.flatten(1, 2)[:, mask]\r\n    sorted_local_index12 += cumsum_from_zero(counts).index_select(0, pair_indices)\r\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ <--- HERE\r\n\r\n    # unsort result from last part\r\nRuntimeError: The size of tensor a (46) must match the size of tensor b (51) at non-singleton dimension 1\r\n\r\nAborted (core dumped)\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029586121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029599711","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1029599711","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1029599711,"node_id":"IC_kwDOB5237M49XnHf","user":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T03:16:50Z","updated_at":"2022-02-04T03:17:16Z","author_association":"NONE","body":"It seems that I've been compiling my code with CUDA11.0 instead of CUDA11.3. Thank you!","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1029599711/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false}},{"id":6006940983,"node_id":"CE_lADOB5237M5C1qZJzwAAAAFmCqU3","url":"https://api.github.com/repos/aiqm/torchani/issues/events/6006940983","actor":{"login":"ndonyapour","id":31333163,"node_id":"MDQ6VXNlcjMxMzMzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/31333163?v=4","gravatar_id":"","url":"https://api.github.com/users/ndonyapour","html_url":"https://github.com/ndonyapour","followers_url":"https://api.github.com/users/ndonyapour/followers","following_url":"https://api.github.com/users/ndonyapour/following{/other_user}","gists_url":"https://api.github.com/users/ndonyapour/gists{/gist_id}","starred_url":"https://api.github.com/users/ndonyapour/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndonyapour/subscriptions","organizations_url":"https://api.github.com/users/ndonyapour/orgs","repos_url":"https://api.github.com/users/ndonyapour/repos","events_url":"https://api.github.com/users/ndonyapour/events{/privacy}","received_events_url":"https://api.github.com/users/ndonyapour/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-02-04T03:16:50Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1030273044","html_url":"https://github.com/aiqm/torchani/issues/609#issuecomment-1030273044","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/609","id":1030273044,"node_id":"IC_kwDOB5237M49aLgU","user":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T19:10:00Z","updated_at":"2022-02-04T19:10:00Z","author_association":"CONTRIBUTOR","body":"Great! you are welcome","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/1030273044/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yueyericardo","id":9999318,"node_id":"MDQ6VXNlcjk5OTkzMTg=","avatar_url":"https://avatars.githubusercontent.com/u/9999318?v=4","gravatar_id":"","url":"https://api.github.com/users/yueyericardo","html_url":"https://github.com/yueyericardo","followers_url":"https://api.github.com/users/yueyericardo/followers","following_url":"https://api.github.com/users/yueyericardo/following{/other_user}","gists_url":"https://api.github.com/users/yueyericardo/gists{/gist_id}","starred_url":"https://api.github.com/users/yueyericardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yueyericardo/subscriptions","organizations_url":"https://api.github.com/users/yueyericardo/orgs","repos_url":"https://api.github.com/users/yueyericardo/repos","events_url":"https://api.github.com/users/yueyericardo/events{/privacy}","received_events_url":"https://api.github.com/users/yueyericardo/received_events","type":"User","site_admin":false}}]