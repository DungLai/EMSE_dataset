[{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607449319","html_url":"https://github.com/aiqm/torchani/issues/441#issuecomment-607449319","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/441","id":607449319,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNzQ0OTMxOQ==","user":{"login":"farhadrgh","id":13050245,"node_id":"MDQ6VXNlcjEzMDUwMjQ1","avatar_url":"https://avatars.githubusercontent.com/u/13050245?v=4","gravatar_id":"","url":"https://api.github.com/users/farhadrgh","html_url":"https://github.com/farhadrgh","followers_url":"https://api.github.com/users/farhadrgh/followers","following_url":"https://api.github.com/users/farhadrgh/following{/other_user}","gists_url":"https://api.github.com/users/farhadrgh/gists{/gist_id}","starred_url":"https://api.github.com/users/farhadrgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farhadrgh/subscriptions","organizations_url":"https://api.github.com/users/farhadrgh/orgs","repos_url":"https://api.github.com/users/farhadrgh/repos","events_url":"https://api.github.com/users/farhadrgh/events{/privacy}","received_events_url":"https://api.github.com/users/farhadrgh/received_events","type":"User","site_admin":false},"created_at":"2020-04-01T19:35:07Z","updated_at":"2020-04-01T19:35:07Z","author_association":"MEMBER","body":"Are you using the default settings in that script, including the dataset paths? In that case, make sure you have already downloaded the datasets using [this script](https://github.com/aiqm/torchani/blob/master/download.sh).\r\n\r\n","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607449319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"farhadrgh","id":13050245,"node_id":"MDQ6VXNlcjEzMDUwMjQ1","avatar_url":"https://avatars.githubusercontent.com/u/13050245?v=4","gravatar_id":"","url":"https://api.github.com/users/farhadrgh","html_url":"https://github.com/farhadrgh","followers_url":"https://api.github.com/users/farhadrgh/followers","following_url":"https://api.github.com/users/farhadrgh/following{/other_user}","gists_url":"https://api.github.com/users/farhadrgh/gists{/gist_id}","starred_url":"https://api.github.com/users/farhadrgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farhadrgh/subscriptions","organizations_url":"https://api.github.com/users/farhadrgh/orgs","repos_url":"https://api.github.com/users/farhadrgh/repos","events_url":"https://api.github.com/users/farhadrgh/events{/privacy}","received_events_url":"https://api.github.com/users/farhadrgh/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607512799","html_url":"https://github.com/aiqm/torchani/issues/441#issuecomment-607512799","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/441","id":607512799,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNzUxMjc5OQ==","user":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false},"created_at":"2020-04-01T22:04:27Z","updated_at":"2020-04-01T22:04:27Z","author_association":"NONE","body":"Hi Farhad - Thanks for your reply, it works.\nI have another question - what parameters do I need to consider to train\nNNP for a new atom 'P' along with CHNO?\n\nAayush\n","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607512799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607537476","html_url":"https://github.com/aiqm/torchani/issues/441#issuecomment-607537476","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/441","id":607537476,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNzUzNzQ3Ng==","user":{"login":"farhadrgh","id":13050245,"node_id":"MDQ6VXNlcjEzMDUwMjQ1","avatar_url":"https://avatars.githubusercontent.com/u/13050245?v=4","gravatar_id":"","url":"https://api.github.com/users/farhadrgh","html_url":"https://github.com/farhadrgh","followers_url":"https://api.github.com/users/farhadrgh/followers","following_url":"https://api.github.com/users/farhadrgh/following{/other_user}","gists_url":"https://api.github.com/users/farhadrgh/gists{/gist_id}","starred_url":"https://api.github.com/users/farhadrgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farhadrgh/subscriptions","organizations_url":"https://api.github.com/users/farhadrgh/orgs","repos_url":"https://api.github.com/users/farhadrgh/repos","events_url":"https://api.github.com/users/farhadrgh/events{/privacy}","received_events_url":"https://api.github.com/users/farhadrgh/received_events","type":"User","site_admin":false},"created_at":"2020-04-01T23:23:11Z","updated_at":"2020-04-01T23:23:36Z","author_association":"MEMBER","body":"Hi Aayush,\r\n\r\nThe minimum required changes to get it working are creating an additional atomic network (`P_network`) and modifying the following lines in `nnp_training.py`:\r\n\r\n```python\r\nnum_species = 5\r\nspecies_to_tensor = torchani.utils.ChemicalSymbolsToInts(['H', 'C', 'N', 'O', 'P'])\r\nnn = torchani.ANIModel([H_network, C_network, N_network, O_network, P_network])\r\n```\r\n\r\nAdditionally, you need to include the parameters of this new atomic network in `SGD` and `AdamW` optimizers.","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607537476/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"farhadrgh","id":13050245,"node_id":"MDQ6VXNlcjEzMDUwMjQ1","avatar_url":"https://avatars.githubusercontent.com/u/13050245?v=4","gravatar_id":"","url":"https://api.github.com/users/farhadrgh","html_url":"https://github.com/farhadrgh","followers_url":"https://api.github.com/users/farhadrgh/followers","following_url":"https://api.github.com/users/farhadrgh/following{/other_user}","gists_url":"https://api.github.com/users/farhadrgh/gists{/gist_id}","starred_url":"https://api.github.com/users/farhadrgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farhadrgh/subscriptions","organizations_url":"https://api.github.com/users/farhadrgh/orgs","repos_url":"https://api.github.com/users/farhadrgh/repos","events_url":"https://api.github.com/users/farhadrgh/events{/privacy}","received_events_url":"https://api.github.com/users/farhadrgh/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607551260","html_url":"https://github.com/aiqm/torchani/issues/441#issuecomment-607551260","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/441","id":607551260,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNzU1MTI2MA==","user":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false},"created_at":"2020-04-02T00:15:11Z","updated_at":"2020-04-02T00:15:11Z","author_association":"NONE","body":"Thanks again Farhad, I made the changes as per your suggestions but get the\nfollowing error:\n\nRuntimeError: Error(s) in loading state_dict for ANIModel:\n\nMissing key(s) in state_dict: \"4.0.weight\", \"4.0.bias\", \"4.2.weight\",\n\"4.2.bias\", \"4.4.weight\", \"4.4.bias\", \"4.6.weight\", \"4.6.bias\".\n\n\n\nOn Wed, Apr 1, 2020 at 6:23 PM Farhad Ramezanghorbani <\nnotifications@github.com> wrote:\n\n> Hi Aayush,\n>\n> The minimum required changes to get it working is creating an additional\n> atomic network (P_network) and modifying the following lines in\n> nnp_training.py:\n>\n> num_species = 5\n> species_to_tensor = torchani.utils.ChemicalSymbolsToInts(['H', 'C', 'N', 'O', 'P'])\n> nn = torchani.ANIModel([H_network, C_network, N_network, O_network, P_network])\n>\n> Additionally, you need to include the parameters of this new atomic\n> network in SGD and AdamW optimizers.\n>\n> —\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/aiqm/torchani/issues/441#issuecomment-607537476>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ALKXTF6WHL24Z4ZGIQZTS5TRKPEGZANCNFSM4LZLRXYQ>\n> .\n>\n\n\n-- \n\n\n*Aayush Gupta*\n\n*Graduate Student*\n\n*University of Illinois at Chicago.*\n","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607551260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607553662","html_url":"https://github.com/aiqm/torchani/issues/441#issuecomment-607553662","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/441","id":607553662,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNzU1MzY2Mg==","user":{"login":"farhadrgh","id":13050245,"node_id":"MDQ6VXNlcjEzMDUwMjQ1","avatar_url":"https://avatars.githubusercontent.com/u/13050245?v=4","gravatar_id":"","url":"https://api.github.com/users/farhadrgh","html_url":"https://github.com/farhadrgh","followers_url":"https://api.github.com/users/farhadrgh/followers","following_url":"https://api.github.com/users/farhadrgh/following{/other_user}","gists_url":"https://api.github.com/users/farhadrgh/gists{/gist_id}","starred_url":"https://api.github.com/users/farhadrgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farhadrgh/subscriptions","organizations_url":"https://api.github.com/users/farhadrgh/orgs","repos_url":"https://api.github.com/users/farhadrgh/repos","events_url":"https://api.github.com/users/farhadrgh/events{/privacy}","received_events_url":"https://api.github.com/users/farhadrgh/received_events","type":"User","site_admin":false},"created_at":"2020-04-02T00:24:02Z","updated_at":"2020-04-02T00:24:02Z","author_association":"MEMBER","body":"No problem. Make sure you remove the generated checkpoints files in the directory you are running the `nnp_training.py`. This code is trying to load the checkpoints generated from your earlier trials (with 4 species) into the current model that has 5 species. The error raised since the `state_dict` in those checkpoints does not have the parameters for `P_network` (indexed as 4).","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607553662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"farhadrgh","id":13050245,"node_id":"MDQ6VXNlcjEzMDUwMjQ1","avatar_url":"https://avatars.githubusercontent.com/u/13050245?v=4","gravatar_id":"","url":"https://api.github.com/users/farhadrgh","html_url":"https://github.com/farhadrgh","followers_url":"https://api.github.com/users/farhadrgh/followers","following_url":"https://api.github.com/users/farhadrgh/following{/other_user}","gists_url":"https://api.github.com/users/farhadrgh/gists{/gist_id}","starred_url":"https://api.github.com/users/farhadrgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farhadrgh/subscriptions","organizations_url":"https://api.github.com/users/farhadrgh/orgs","repos_url":"https://api.github.com/users/farhadrgh/repos","events_url":"https://api.github.com/users/farhadrgh/events{/privacy}","received_events_url":"https://api.github.com/users/farhadrgh/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607556240","html_url":"https://github.com/aiqm/torchani/issues/441#issuecomment-607556240","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/441","id":607556240,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNzU1NjI0MA==","user":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false},"created_at":"2020-04-02T00:33:39Z","updated_at":"2020-04-02T00:33:39Z","author_association":"NONE","body":"Great thanks - that fixed the error. But now I'm getting a runtime error - is it because of no validation file ?\r\nRuntimeError: size mismatch, m1: [15583 x 560], m2: [384 x 160] at /pytorch/aten/src/THC/generic/THCTensorMathBlas.cu:290","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607556240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607560084","html_url":"https://github.com/aiqm/torchani/issues/441#issuecomment-607560084","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/441","id":607560084,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNzU2MDA4NA==","user":{"login":"isayev","id":3207981,"node_id":"MDQ6VXNlcjMyMDc5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3207981?v=4","gravatar_id":"","url":"https://api.github.com/users/isayev","html_url":"https://github.com/isayev","followers_url":"https://api.github.com/users/isayev/followers","following_url":"https://api.github.com/users/isayev/following{/other_user}","gists_url":"https://api.github.com/users/isayev/gists{/gist_id}","starred_url":"https://api.github.com/users/isayev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/isayev/subscriptions","organizations_url":"https://api.github.com/users/isayev/orgs","repos_url":"https://api.github.com/users/isayev/repos","events_url":"https://api.github.com/users/isayev/events{/privacy}","received_events_url":"https://api.github.com/users/isayev/received_events","type":"User","site_admin":false},"created_at":"2020-04-02T00:50:16Z","updated_at":"2020-04-02T00:50:16Z","author_association":"MEMBER","body":"Aayush:\n\nSince you changed number of species you need to adjust parameters of AEVs\nand also dimensions of input layers for every network.\nAlso, keep in mind, you will need to re-train all your networkd either\nbecause old weights are now meaningless.\n\nOn Wed, Apr 1, 2020 at 8:33 PM Aayush Gupta <notifications@github.com>\nwrote:\n\n> Great thanks - that fixed the error. But now I'm getting a runtime error -\n> is it because of no validation file ?\n> RuntimeError: size mismatch, m1: [15583 x 560], m2: [384 x 160] at\n> /pytorch/aten/src/THC/generic/THCTensorMathBlas.cu:290\n>\n> —\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/aiqm/torchani/issues/441#issuecomment-607556240>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAYPGLKTX4S56DY2SGWN6VLRKPMPBANCNFSM4LZLRXYQ>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607560084/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"isayev","id":3207981,"node_id":"MDQ6VXNlcjMyMDc5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3207981?v=4","gravatar_id":"","url":"https://api.github.com/users/isayev","html_url":"https://github.com/isayev","followers_url":"https://api.github.com/users/isayev/followers","following_url":"https://api.github.com/users/isayev/following{/other_user}","gists_url":"https://api.github.com/users/isayev/gists{/gist_id}","starred_url":"https://api.github.com/users/isayev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/isayev/subscriptions","organizations_url":"https://api.github.com/users/isayev/orgs","repos_url":"https://api.github.com/users/isayev/repos","events_url":"https://api.github.com/users/isayev/events{/privacy}","received_events_url":"https://api.github.com/users/isayev/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607561412","html_url":"https://github.com/aiqm/torchani/issues/441#issuecomment-607561412","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/441","id":607561412,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNzU2MTQxMg==","user":{"login":"farhadrgh","id":13050245,"node_id":"MDQ6VXNlcjEzMDUwMjQ1","avatar_url":"https://avatars.githubusercontent.com/u/13050245?v=4","gravatar_id":"","url":"https://api.github.com/users/farhadrgh","html_url":"https://github.com/farhadrgh","followers_url":"https://api.github.com/users/farhadrgh/followers","following_url":"https://api.github.com/users/farhadrgh/following{/other_user}","gists_url":"https://api.github.com/users/farhadrgh/gists{/gist_id}","starred_url":"https://api.github.com/users/farhadrgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farhadrgh/subscriptions","organizations_url":"https://api.github.com/users/farhadrgh/orgs","repos_url":"https://api.github.com/users/farhadrgh/repos","events_url":"https://api.github.com/users/farhadrgh/events{/privacy}","received_events_url":"https://api.github.com/users/farhadrgh/received_events","type":"User","site_admin":false},"created_at":"2020-04-02T00:55:50Z","updated_at":"2020-04-02T01:13:22Z","author_association":"MEMBER","body":"Oh, I forgot about that! @aaayushg each AEV vector with 5 species has 560 elements instead of 384 now. So this has to be fixed in all the first layers of your networks.\r\n\r\nYou can also use the changes in #442. Then you can just read AEV dimensions directly from `aev_computer`","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607561412/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"farhadrgh","id":13050245,"node_id":"MDQ6VXNlcjEzMDUwMjQ1","avatar_url":"https://avatars.githubusercontent.com/u/13050245?v=4","gravatar_id":"","url":"https://api.github.com/users/farhadrgh","html_url":"https://github.com/farhadrgh","followers_url":"https://api.github.com/users/farhadrgh/followers","following_url":"https://api.github.com/users/farhadrgh/following{/other_user}","gists_url":"https://api.github.com/users/farhadrgh/gists{/gist_id}","starred_url":"https://api.github.com/users/farhadrgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farhadrgh/subscriptions","organizations_url":"https://api.github.com/users/farhadrgh/orgs","repos_url":"https://api.github.com/users/farhadrgh/repos","events_url":"https://api.github.com/users/farhadrgh/events{/privacy}","received_events_url":"https://api.github.com/users/farhadrgh/received_events","type":"User","site_admin":false}},{"id":3190179419,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzE5MDE3OTQxOQ==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/3190179419","actor":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-04-02T00:55:50Z","performed_via_github_app":null},{"id":3190179424,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMxOTAxNzk0MjQ=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/3190179424","actor":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-04-02T00:55:50Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607569240","html_url":"https://github.com/aiqm/torchani/issues/441#issuecomment-607569240","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/441","id":607569240,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNzU2OTI0MA==","user":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false},"created_at":"2020-04-02T01:26:00Z","updated_at":"2020-04-02T01:26:00Z","author_association":"NONE","body":"That works ! Thanks for your help.\r\nLast thing - could you direct me to a code/document on how to use generated '.pt' files to run optimization or molecular dynamics on a system(xyz file) ? \r\nThanks again","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607569240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607571801","html_url":"https://github.com/aiqm/torchani/issues/441#issuecomment-607571801","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/441","id":607571801,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNzU3MTgwMQ==","user":{"login":"farhadrgh","id":13050245,"node_id":"MDQ6VXNlcjEzMDUwMjQ1","avatar_url":"https://avatars.githubusercontent.com/u/13050245?v=4","gravatar_id":"","url":"https://api.github.com/users/farhadrgh","html_url":"https://github.com/farhadrgh","followers_url":"https://api.github.com/users/farhadrgh/followers","following_url":"https://api.github.com/users/farhadrgh/following{/other_user}","gists_url":"https://api.github.com/users/farhadrgh/gists{/gist_id}","starred_url":"https://api.github.com/users/farhadrgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farhadrgh/subscriptions","organizations_url":"https://api.github.com/users/farhadrgh/orgs","repos_url":"https://api.github.com/users/farhadrgh/repos","events_url":"https://api.github.com/users/farhadrgh/events{/privacy}","received_events_url":"https://api.github.com/users/farhadrgh/received_events","type":"User","site_admin":false},"created_at":"2020-04-02T01:36:30Z","updated_at":"2020-04-02T01:36:30Z","author_association":"MEMBER","body":"I am glad this was helpful. At the moment we don't have an example that loads the checkpoint (.pt) of a trained custom model. However, the process is straightforward and you will need to use something similar to our [energy_force.py](https://github.com/aiqm/torchani/blob/master/examples/energy_force.py) script.\r\n\r\nThe difference is that instead of loading the pre-trained ANI1x model, you now need to define your model (as you did in your custom `nnp_training.py`) and load the `state_dict` from .pt file as explained [here](https://pytorch.org/tutorials/beginner/saving_loading_models.html).","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607571801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"farhadrgh","id":13050245,"node_id":"MDQ6VXNlcjEzMDUwMjQ1","avatar_url":"https://avatars.githubusercontent.com/u/13050245?v=4","gravatar_id":"","url":"https://api.github.com/users/farhadrgh","html_url":"https://github.com/farhadrgh","followers_url":"https://api.github.com/users/farhadrgh/followers","following_url":"https://api.github.com/users/farhadrgh/following{/other_user}","gists_url":"https://api.github.com/users/farhadrgh/gists{/gist_id}","starred_url":"https://api.github.com/users/farhadrgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farhadrgh/subscriptions","organizations_url":"https://api.github.com/users/farhadrgh/orgs","repos_url":"https://api.github.com/users/farhadrgh/repos","events_url":"https://api.github.com/users/farhadrgh/events{/privacy}","received_events_url":"https://api.github.com/users/farhadrgh/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607575783","html_url":"https://github.com/aiqm/torchani/issues/441#issuecomment-607575783","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/441","id":607575783,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNzU3NTc4Mw==","user":{"login":"isayev","id":3207981,"node_id":"MDQ6VXNlcjMyMDc5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3207981?v=4","gravatar_id":"","url":"https://api.github.com/users/isayev","html_url":"https://github.com/isayev","followers_url":"https://api.github.com/users/isayev/followers","following_url":"https://api.github.com/users/isayev/following{/other_user}","gists_url":"https://api.github.com/users/isayev/gists{/gist_id}","starred_url":"https://api.github.com/users/isayev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/isayev/subscriptions","organizations_url":"https://api.github.com/users/isayev/orgs","repos_url":"https://api.github.com/users/isayev/repos","events_url":"https://api.github.com/users/isayev/events{/privacy}","received_events_url":"https://api.github.com/users/isayev/received_events","type":"User","site_admin":false},"created_at":"2020-04-02T01:52:35Z","updated_at":"2020-04-02T01:52:35Z","author_association":"MEMBER","body":"@aaayushg yah this is not available yet. If you find torchani useful in your research, and implement this feature, we would be glad to see your PR request :) Thanks! ","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607575783/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"isayev","id":3207981,"node_id":"MDQ6VXNlcjMyMDc5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3207981?v=4","gravatar_id":"","url":"https://api.github.com/users/isayev","html_url":"https://github.com/isayev","followers_url":"https://api.github.com/users/isayev/followers","following_url":"https://api.github.com/users/isayev/following{/other_user}","gists_url":"https://api.github.com/users/isayev/gists{/gist_id}","starred_url":"https://api.github.com/users/isayev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/isayev/subscriptions","organizations_url":"https://api.github.com/users/isayev/orgs","repos_url":"https://api.github.com/users/isayev/repos","events_url":"https://api.github.com/users/isayev/events{/privacy}","received_events_url":"https://api.github.com/users/isayev/received_events","type":"User","site_admin":false}},{"id":3190272676,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzE5MDI3MjY3Ng==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/3190272676","actor":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-04-02T01:52:35Z","performed_via_github_app":null},{"id":3190272678,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMxOTAyNzI2Nzg=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/3190272678","actor":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-04-02T01:52:35Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607580003","html_url":"https://github.com/aiqm/torchani/issues/441#issuecomment-607580003","issue_url":"https://api.github.com/repos/aiqm/torchani/issues/441","id":607580003,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNzU4MDAwMw==","user":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false},"created_at":"2020-04-02T02:08:02Z","updated_at":"2020-04-02T02:08:02Z","author_association":"NONE","body":"Great thanks, Farhad and Olex.\nI will try to work with this and try some test systems.\nThanks again for your help !\n\n\nOn Wed, Apr 1, 2020 at 8:52 PM Olexandr Isayev <notifications@github.com>\nwrote:\n\n> @aaayushg <https://github.com/aaayushg> yah this is not available yet. If\n> you find torchani useful in your research, and implement this feature, we\n> would be glad to see your PR request :) Thanks!\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/aiqm/torchani/issues/441#issuecomment-607575783>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ALKXTF4PFME3VRL2JSXKVUDRKPVXBANCNFSM4LZLRXYQ>\n> .\n>\n-- \n\n\n*Aayush Gupta*\n\n*Graduate Student*\n\n*University of Illinois at Chicago.*\n","reactions":{"url":"https://api.github.com/repos/aiqm/torchani/issues/comments/607580003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false}},{"id":3190297348,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzE5MDI5NzM0OA==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/3190297348","actor":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-04-02T02:08:03Z","performed_via_github_app":null},{"id":3190297350,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMxOTAyOTczNTA=","url":"https://api.github.com/repos/aiqm/torchani/issues/events/3190297350","actor":{"login":"aaayushg","id":47544727,"node_id":"MDQ6VXNlcjQ3NTQ0NzI3","avatar_url":"https://avatars.githubusercontent.com/u/47544727?v=4","gravatar_id":"","url":"https://api.github.com/users/aaayushg","html_url":"https://github.com/aaayushg","followers_url":"https://api.github.com/users/aaayushg/followers","following_url":"https://api.github.com/users/aaayushg/following{/other_user}","gists_url":"https://api.github.com/users/aaayushg/gists{/gist_id}","starred_url":"https://api.github.com/users/aaayushg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaayushg/subscriptions","organizations_url":"https://api.github.com/users/aaayushg/orgs","repos_url":"https://api.github.com/users/aaayushg/repos","events_url":"https://api.github.com/users/aaayushg/events{/privacy}","received_events_url":"https://api.github.com/users/aaayushg/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-04-02T02:08:03Z","performed_via_github_app":null},{"id":3190323722,"node_id":"MDExOkNsb3NlZEV2ZW50MzE5MDMyMzcyMg==","url":"https://api.github.com/repos/aiqm/torchani/issues/events/3190323722","actor":{"login":"farhadrgh","id":13050245,"node_id":"MDQ6VXNlcjEzMDUwMjQ1","avatar_url":"https://avatars.githubusercontent.com/u/13050245?v=4","gravatar_id":"","url":"https://api.github.com/users/farhadrgh","html_url":"https://github.com/farhadrgh","followers_url":"https://api.github.com/users/farhadrgh/followers","following_url":"https://api.github.com/users/farhadrgh/following{/other_user}","gists_url":"https://api.github.com/users/farhadrgh/gists{/gist_id}","starred_url":"https://api.github.com/users/farhadrgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farhadrgh/subscriptions","organizations_url":"https://api.github.com/users/farhadrgh/orgs","repos_url":"https://api.github.com/users/farhadrgh/repos","events_url":"https://api.github.com/users/farhadrgh/events{/privacy}","received_events_url":"https://api.github.com/users/farhadrgh/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-04-02T02:23:58Z","state_reason":null,"performed_via_github_app":null}]