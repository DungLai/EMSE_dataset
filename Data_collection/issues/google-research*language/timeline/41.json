[{"url":"https://api.github.com/repos/google-research/language/issues/comments/568519780","html_url":"https://github.com/google-research/language/issues/41#issuecomment-568519780","issue_url":"https://api.github.com/repos/google-research/language/issues/41","id":568519780,"node_id":"MDEyOklzc3VlQ29tbWVudDU2ODUxOTc4MA==","user":{"login":"kws-slalom","id":51205975,"node_id":"MDQ6VXNlcjUxMjA1OTc1","avatar_url":"https://avatars.githubusercontent.com/u/51205975?v=4","gravatar_id":"","url":"https://api.github.com/users/kws-slalom","html_url":"https://github.com/kws-slalom","followers_url":"https://api.github.com/users/kws-slalom/followers","following_url":"https://api.github.com/users/kws-slalom/following{/other_user}","gists_url":"https://api.github.com/users/kws-slalom/gists{/gist_id}","starred_url":"https://api.github.com/users/kws-slalom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kws-slalom/subscriptions","organizations_url":"https://api.github.com/users/kws-slalom/orgs","repos_url":"https://api.github.com/users/kws-slalom/repos","events_url":"https://api.github.com/users/kws-slalom/events{/privacy}","received_events_url":"https://api.github.com/users/kws-slalom/received_events","type":"User","site_admin":false},"created_at":"2019-12-23T16:31:38Z","updated_at":"2019-12-23T16:31:38Z","author_association":"NONE","body":"Also, FYI.  I'm using AWS Sagemaker `tensorflow_p27` premade conda instance with `bert-tensorflow` and `natural-questions` installed.","reactions":{"url":"https://api.github.com/repos/google-research/language/issues/comments/568519780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kws-slalom","id":51205975,"node_id":"MDQ6VXNlcjUxMjA1OTc1","avatar_url":"https://avatars.githubusercontent.com/u/51205975?v=4","gravatar_id":"","url":"https://api.github.com/users/kws-slalom","html_url":"https://github.com/kws-slalom","followers_url":"https://api.github.com/users/kws-slalom/followers","following_url":"https://api.github.com/users/kws-slalom/following{/other_user}","gists_url":"https://api.github.com/users/kws-slalom/gists{/gist_id}","starred_url":"https://api.github.com/users/kws-slalom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kws-slalom/subscriptions","organizations_url":"https://api.github.com/users/kws-slalom/orgs","repos_url":"https://api.github.com/users/kws-slalom/repos","events_url":"https://api.github.com/users/kws-slalom/events{/privacy}","received_events_url":"https://api.github.com/users/kws-slalom/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/google-research/language/issues/comments/568536567","html_url":"https://github.com/google-research/language/issues/41#issuecomment-568536567","issue_url":"https://api.github.com/repos/google-research/language/issues/41","id":568536567,"node_id":"MDEyOklzc3VlQ29tbWVudDU2ODUzNjU2Nw==","user":{"login":"kws-slalom","id":51205975,"node_id":"MDQ6VXNlcjUxMjA1OTc1","avatar_url":"https://avatars.githubusercontent.com/u/51205975?v=4","gravatar_id":"","url":"https://api.github.com/users/kws-slalom","html_url":"https://github.com/kws-slalom","followers_url":"https://api.github.com/users/kws-slalom/followers","following_url":"https://api.github.com/users/kws-slalom/following{/other_user}","gists_url":"https://api.github.com/users/kws-slalom/gists{/gist_id}","starred_url":"https://api.github.com/users/kws-slalom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kws-slalom/subscriptions","organizations_url":"https://api.github.com/users/kws-slalom/orgs","repos_url":"https://api.github.com/users/kws-slalom/repos","events_url":"https://api.github.com/users/kws-slalom/events{/privacy}","received_events_url":"https://api.github.com/users/kws-slalom/received_events","type":"User","site_admin":false},"created_at":"2019-12-23T17:40:35Z","updated_at":"2019-12-23T17:40:35Z","author_association":"NONE","body":"I ran it with `export AUTOGRAPH_VERBOSITY=10` as suggested in the output above which provides a more detailed log but still not really sure what to try next:\r\n\r\n```\r\nINFO:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>> is not cached for key <code object call at 0x7f35d4627130, file \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/keras/layers/core.py\", line 1031> subkey (<tensorflow.python.autograph.core.converter.ConversionOptions object at 0x7f35bcd73f90>, frozenset([]))\r\nI1223 17:22:02.250940 139869963634496 ag_logging.py:139] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>> is not cached for key <code object call at 0x7f35d4627130, file \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/keras/layers/core.py\", line 1031> subkey (<tensorflow.python.autograph.core.converter.ConversionOptions object at 0x7f35bcd73f90>, frozenset([]))\r\nINFO:tensorflow:Converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>>\r\nI1223 17:22:02.251044 139869963634496 ag_logging.py:139] Converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>>\r\nINFO:tensorflow:Source code of <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>>:\r\n\r\nfrom __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\ndef call(self, inputs):\r\n  inputs = ops.convert_to_tensor(inputs)\r\n  rank = common_shapes.rank(inputs)\r\n  if rank > 2:\r\n    # Broadcasting is required for the inputs.\r\n    outputs = standard_ops.tensordot(inputs, self.kernel, [[rank - 1], [0]])\r\n    # Reshape the output back to the original ndim of the input.\r\n    if not context.executing_eagerly():\r\n      shape = inputs.shape.as_list()\r\n      output_shape = shape[:-1] + [self.units]\r\n      outputs.set_shape(output_shape)\r\n  else:\r\n    # Cast the inputs to self.dtype, which is the variable dtype. We do not\r\n    # cast if `should_cast_variables` is True, as in that case the variable\r\n    # will be automatically casted to inputs.dtype.\r\n    if not self._mixed_precision_policy.should_cast_variables:\r\n      inputs = math_ops.cast(inputs, self.dtype)\r\n    outputs = gen_math_ops.mat_mul(inputs, self.kernel)\r\n  if self.use_bias:\r\n    outputs = nn.bias_add(outputs, self.bias)\r\n  if self.activation is not None:\r\n    return self.activation(outputs)  # pylint: disable=not-callable\r\n  return outputs\r\n\r\n\r\nI1223 17:22:02.258529 139869963634496 ag_logging.py:139] Source code of <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>>:\r\n\r\nfrom __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\ndef call(self, inputs):\r\n  inputs = ops.convert_to_tensor(inputs)\r\n  rank = common_shapes.rank(inputs)\r\n  if rank > 2:\r\n    # Broadcasting is required for the inputs.\r\n    outputs = standard_ops.tensordot(inputs, self.kernel, [[rank - 1], [0]])\r\n    # Reshape the output back to the original ndim of the input.\r\n    if not context.executing_eagerly():\r\n      shape = inputs.shape.as_list()\r\n      output_shape = shape[:-1] + [self.units]\r\n      outputs.set_shape(output_shape)\r\n  else:\r\n    # Cast the inputs to self.dtype, which is the variable dtype. We do not\r\n    # cast if `should_cast_variables` is True, as in that case the variable\r\n    # will be automatically casted to inputs.dtype.\r\n    if not self._mixed_precision_policy.should_cast_variables:\r\n      inputs = math_ops.cast(inputs, self.dtype)\r\n    outputs = gen_math_ops.mat_mul(inputs, self.kernel)\r\n  if self.use_bias:\r\n    outputs = nn.bias_add(outputs, self.bias)\r\n  if self.activation is not None:\r\n    return self.activation(outputs)  # pylint: disable=not-callable\r\n  return outputs\r\n\r\n\r\nERROR:tensorflow:Error converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>>\r\nTraceback (most recent call last):\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/api.py\", line 524, in to_graph\r\n    return conversion.convert(entity, program_ctx)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 306, in convert\r\n    entity, program_ctx, free_nonglobal_var_names)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 229, in _convert_with_cache\r\n    entity, program_ctx)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 433, in convert_entity_to_ast\r\n    nodes, name, entity_info = convert_func_to_ast(o, program_ctx)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 624, in convert_func_to_ast\r\n    node = node_to_graph(node, context)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 667, in node_to_graph\r\n    node = converter.apply_(node, context, return_statements)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/core/converter.py\", line 380, in apply_\r\n    node = converter_module.transform(node, context)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/converters/return_statements.py\", line 412, in transform\r\n    node = transformer.visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/core/converter.py\", line 317, in visit\r\n    return super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 480, in visit\r\n    result = super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/converters/return_statements.py\", line 363, in visit_FunctionDef\r\n    converted_body = self._visit_statement_block(node, node.body)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/converters/return_statements.py\", line 287, in _visit_statement_block\r\n    nodes = self.visit_block(nodes, after_visit=self._postprocess_statement)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 371, in visit_block\r\n    replacement = self.visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/core/converter.py\", line 317, in visit\r\n    return super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 480, in visit\r\n    result = super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/converters/return_statements.py\", line 348, in visit_If\r\n    node.body = self._visit_statement_block(node, node.body)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/converters/return_statements.py\", line 287, in _visit_statement_block\r\n    nodes = self.visit_block(nodes, after_visit=self._postprocess_statement)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 371, in visit_block\r\n    replacement = self.visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/core/converter.py\", line 317, in visit\r\n    return super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 480, in visit\r\n    result = super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/converters/return_statements.py\", line 237, in visit_Return\r\n    retval=retval)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/templates.py\", line 260, in replace\r\n    replacements[k] = _convert_to_ast(replacements[k])\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/templates.py\", line 222, in _convert_to_ast\r\n    return gast.Name(id=n, ctx=None, annotation=None)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/gast/gast.py\", line 19, in create_node\r\n    format(Name, nbparam, len(Fields))\r\nAssertionError: Bad argument number for Name: 3, expecting 4\r\nE1223 17:22:02.355459 139869963634496 ag_logging.py:132] Error converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>>\r\nTraceback (most recent call last):\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/api.py\", line 524, in to_graph\r\n    return conversion.convert(entity, program_ctx)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 306, in convert\r\n    entity, program_ctx, free_nonglobal_var_names)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 229, in _convert_with_cache\r\n    entity, program_ctx)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 433, in convert_entity_to_ast\r\n    nodes, name, entity_info = convert_func_to_ast(o, program_ctx)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 624, in convert_func_to_ast\r\n    node = node_to_graph(node, context)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 667, in node_to_graph\r\n    node = converter.apply_(node, context, return_statements)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/core/converter.py\", line 380, in apply_\r\n    node = converter_module.transform(node, context)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/converters/return_statements.py\", line 412, in transform\r\n    node = transformer.visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/core/converter.py\", line 317, in visit\r\n    return super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 480, in visit\r\n    result = super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/converters/return_statements.py\", line 363, in visit_FunctionDef\r\n    converted_body = self._visit_statement_block(node, node.body)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/converters/return_statements.py\", line 287, in _visit_statement_block\r\n    nodes = self.visit_block(nodes, after_visit=self._postprocess_statement)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 371, in visit_block\r\n    replacement = self.visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/core/converter.py\", line 317, in visit\r\n    return super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 480, in visit\r\n    result = super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/converters/return_statements.py\", line 348, in visit_If\r\n    node.body = self._visit_statement_block(node, node.body)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/converters/return_statements.py\", line 287, in _visit_statement_block\r\n    nodes = self.visit_block(nodes, after_visit=self._postprocess_statement)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 371, in visit_block\r\n    replacement = self.visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/core/converter.py\", line 317, in visit\r\n    return super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 480, in visit\r\n    result = super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/converters/return_statements.py\", line 237, in visit_Return\r\n    retval=retval)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/templates.py\", line 260, in replace\r\n    replacements[k] = _convert_to_ast(replacements[k])\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/templates.py\", line 222, in _convert_to_ast\r\n    return gast.Name(id=n, ctx=None, annotation=None)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/gast/gast.py\", line 19, in create_node\r\n    format(Name, nbparam, len(Fields))\r\nAssertionError: Bad argument number for Name: 3, expecting 4\r\nINFO:tensorflow:Error transforming entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>>\r\nTraceback (most recent call last):\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/api.py\", line 423, in converted_call\r\n    experimental_optional_features=options.optional_features)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/api.py\", line 528, in to_graph\r\n    entity, e.__class__.__name__, str(e)))\r\nConversionError: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>>: AssertionError: Bad argument number for Name: 3, expecting 4\r\nI1223 17:22:02.356198 139869963634496 ag_logging.py:139] Error transforming entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>>\r\nTraceback (most recent call last):\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/api.py\", line 423, in converted_call\r\n    experimental_optional_features=options.optional_features)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/api.py\", line 528, in to_graph\r\n    entity, e.__class__.__name__, str(e)))\r\nConversionError: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>>: AssertionError: Bad argument number for Name: 3, expecting 4\r\nWARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>>: AssertionError: Bad argument number for Name: 3, expecting 4\r\nW1223 17:22:02.356378 139869963634496 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bcd4ca10>>: AssertionError: Bad argument number for Name: 3, expecting 4\r\nINFO:tensorflow:Converted call: <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bd196c10>> \r\n    args: (<tf.Tensor 'bert/encoder/layer_19/attention/self/Reshape_3:0' shape=(?, 1024) dtype=float32>,)\r\n    kwargs: {}\r\n\r\nI1223 17:22:02.388948 139869963634496 ag_logging.py:139] Converted call: <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bd196c10>> \r\n    args: (<tf.Tensor 'bert/encoder/layer_19/attention/self/Reshape_3:0' shape=(?, 1024) dtype=float32>,)\r\n    kwargs: {}\r\n\r\nINFO:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bd196c10>> is not cached for key <code object call at 0x7f35d4627130, file \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/keras/layers/core.py\", line 1031> subkey (<tensorflow.python.autograph.core.converter.ConversionOptions object at 0x7f35bcc96310>, frozenset([]))\r\nI1223 17:22:02.389297 139869963634496 ag_logging.py:139] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bd196c10>> is not cached for key <code object call at 0x7f35d4627130, file \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/keras/layers/core.py\", line 1031> subkey (<tensorflow.python.autograph.core.converter.ConversionOptions object at 0x7f35bcc96310>, frozenset([]))\r\nINFO:tensorflow:Converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bd196c10>>\r\nI1223 17:22:02.389405 139869963634496 ag_logging.py:139] Converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bd196c10>>\r\nINFO:tensorflow:Source code of <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bd196c10>>:\r\n\r\nfrom __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\ndef call(self, inputs):\r\n  inputs = ops.convert_to_tensor(inputs)\r\n  rank = common_shapes.rank(inputs)\r\n  if rank > 2:\r\n    # Broadcasting is required for the inputs.\r\n    outputs = standard_ops.tensordot(inputs, self.kernel, [[rank - 1], [0]])\r\n    # Reshape the output back to the original ndim of the input.\r\n    if not context.executing_eagerly():\r\n      shape = inputs.shape.as_list()\r\n      output_shape = shape[:-1] + [self.units]\r\n      outputs.set_shape(output_shape)\r\n  else:\r\n    # Cast the inputs to self.dtype, which is the variable dtype. We do not\r\n    # cast if `should_cast_variables` is True, as in that case the variable\r\n    # will be automatically casted to inputs.dtype.\r\n    if not self._mixed_precision_policy.should_cast_variables:\r\n      inputs = math_ops.cast(inputs, self.dtype)\r\n    outputs = gen_math_ops.mat_mul(inputs, self.kernel)\r\n  if self.use_bias:\r\n    outputs = nn.bias_add(outputs, self.bias)\r\n  if self.activation is not None:\r\n    return self.activation(outputs)  # pylint: disable=not-callable\r\n  return outputs\r\n\r\n\r\nI1223 17:22:02.397010 139869963634496 ag_logging.py:139] Source code of <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f35bd196c10>>:\r\n\r\nfrom __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\ndef call(self, inputs):\r\n  inputs = ops.convert_to_tensor(inputs)\r\n  rank = common_shapes.rank(inputs)\r\n  if rank > 2:\r\n    # Broadcasting is required for the inputs.\r\n    outputs = standard_ops.tensordot(inputs, self.kernel, [[rank - 1], [0]])\r\n    # Reshape the output back to the original ndim of the input.\r\n    if not context.executing_eagerly():\r\n      shape = inputs.shape.as_list()\r\n      output_shape = shape[:-1] + [self.units]\r\n      outputs.set_shape(output_shape)\r\n  else:\r\n    # Cast the inputs to self.dtype, which is the variable dtype. We do not\r\n    # cast if `should_cast_variables` is True, as in that case the variable\r\n    # will be automatically casted to inputs.dtype.\r\n    if not self._mixed_precision_policy.should_cast_variables:\r\n      inputs = math_ops.cast(inputs, self.dtype)\r\n    outputs = gen_math_ops.mat_mul(inputs, self.kernel)\r\n  if self.use_bias:\r\n    outputs = nn.bias_add(outputs, self.bias)\r\n  if self.activation is not None:\r\n    return self.activation(outputs)  # pylint: disable=not-callable\r\n  return outputs\r\n\r\n\r\n^CINFO:tensorflow:prediction_loop marked as finished\r\nI1223 17:22:02.425369 139869963634496 error_handling.py:96] prediction_loop marked as finished\r\nTraceback (most recent call last):\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/runpy.py\", line 174, in _run_module_as_main\r\n    \"__main__\", fname, loader, pkg_name)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/runpy.py\", line 72, in _run_code\r\n    exec code in run_globals\r\n  File \"/home/ec2-user/SageMaker/language/language/question_answering/bert_joint/run_nq.py\", line 1442, in <module>\r\n    tf.app.run()\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/home/ec2-user/SageMaker/language/language/question_answering/bert_joint/run_nq.py\", line 1412, in main\r\n    predict_input_fn, yield_single_examples=True):\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 2913, in predict\r\n    yield_single_examples=yield_single_examples):\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 619, in predict\r\n    features, None, ModeKeys.PREDICT, self.config)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 2709, in _call_model_fn\r\n    config)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1146, in _call_model_fn\r\n    model_fn_results = self._model_fn(features=features, **kwargs)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 2967, in _model_fn\r\n    features, labels, is_export_mode=is_export_mode)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 1549, in call_without_tpu\r\n    return self._call_model_fn(features, labels, is_export_mode=is_export_mode)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 1867, in _call_model_fn\r\n    estimator_spec = self._model_fn(features=features, **kwargs)\r\n  File \"/home/ec2-user/SageMaker/language/language/question_answering/bert_joint/run_nq.py\", line 920, in model_fn\r\n    use_one_hot_embeddings=use_one_hot_embeddings)\r\n  File \"/home/ec2-user/SageMaker/language/language/question_answering/bert_joint/run_nq.py\", line 845, in create_model\r\n    use_one_hot_embeddings=use_one_hot_embeddings)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/bert/modeling.py\", line 216, in __init__\r\n    do_return_all_layers=True)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/bert/modeling.py\", line 861, in transformer_model\r\n    kernel_initializer=create_initializer(initializer_range))\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 324, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/layers/core.py\", line 188, in dense\r\n    return layer.apply(inputs)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/keras/engine/base_layer.py\", line 1481, in apply\r\n    return self.__call__(inputs, *args, **kwargs)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/layers/base.py\", line 537, in __call__\r\n    outputs = super(Layer, self).__call__(inputs, *args, **kwargs)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/keras/engine/base_layer.py\", line 636, in __call__\r\n    outputs = call_fn(inputs, *args, **kwargs)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/api.py\", line 146, in wrapper\r\n    ), args, kwargs)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/api.py\", line 423, in converted_call\r\n    experimental_optional_features=options.optional_features)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/api.py\", line 524, in to_graph\r\n    return conversion.convert(entity, program_ctx)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 306, in convert\r\n    entity, program_ctx, free_nonglobal_var_names)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 229, in _convert_with_cache\r\n    entity, program_ctx)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 433, in convert_entity_to_ast\r\n    nodes, name, entity_info = convert_func_to_ast(o, program_ctx)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 624, in convert_func_to_ast\r\n    node = node_to_graph(node, context)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/impl/conversion.py\", line 658, in node_to_graph\r\n    node = converter.apply_(node, context, arg_defaults)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/core/converter.py\", line 379, in apply_\r\n    node = standard_analysis(node, context)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/core/converter.py\", line 356, in standard_analysis\r\n    node = reaching_definitions.resolve(node, context, graphs, AnnotatedDef)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/static_analysis/reaching_definitions.py\", line 312, in resolve\r\n    node = visitor.visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/static_analysis/reaching_definitions.py\", line 294, in visit\r\n    node = super(TreeAnnotator, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 480, in visit\r\n    result = super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/static_analysis/reaching_definitions.py\", line 214, in visit_FunctionDef\r\n    node.body = self.visit_block(node.body)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 371, in visit_block\r\n    replacement = self.visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/static_analysis/reaching_definitions.py\", line 294, in visit\r\n    node = super(TreeAnnotator, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 480, in visit\r\n    result = super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/static_analysis/reaching_definitions.py\", line 256, in visit_If\r\n    return self.generic_visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 297, in generic_visit\r\n    value = self.visit(value)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/static_analysis/reaching_definitions.py\", line 294, in visit\r\n    node = super(TreeAnnotator, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 480, in visit\r\n    result = super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/static_analysis/reaching_definitions.py\", line 256, in visit_If\r\n    return self.generic_visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 306, in generic_visit\r\n    new_node = self.visit(old_value)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/static_analysis/reaching_definitions.py\", line 294, in visit\r\n    node = super(TreeAnnotator, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 480, in visit\r\n    result = super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 306, in generic_visit\r\n    new_node = self.visit(old_value)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/static_analysis/reaching_definitions.py\", line 294, in visit\r\n    node = super(TreeAnnotator, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 480, in visit\r\n    result = super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 306, in generic_visit\r\n    new_node = self.visit(old_value)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/static_analysis/reaching_definitions.py\", line 294, in visit\r\n    node = super(TreeAnnotator, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/site-packages/tensorflow/python/autograph/pyct/transformer.py\", line 480, in visit\r\n    result = super(Base, self).visit(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/home/ec2-user/anaconda3/envs/tensorflow_p27/lib/python2.7/ast.py\", line 290, in generic_visit\r\n    def generic_visit(self, node):\r\nKeyboardInterrupt\r\n(tensorflow_p27) sh-4.2$ \r\n```","reactions":{"url":"https://api.github.com/repos/google-research/language/issues/comments/568536567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kws-slalom","id":51205975,"node_id":"MDQ6VXNlcjUxMjA1OTc1","avatar_url":"https://avatars.githubusercontent.com/u/51205975?v=4","gravatar_id":"","url":"https://api.github.com/users/kws-slalom","html_url":"https://github.com/kws-slalom","followers_url":"https://api.github.com/users/kws-slalom/followers","following_url":"https://api.github.com/users/kws-slalom/following{/other_user}","gists_url":"https://api.github.com/users/kws-slalom/gists{/gist_id}","starred_url":"https://api.github.com/users/kws-slalom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kws-slalom/subscriptions","organizations_url":"https://api.github.com/users/kws-slalom/orgs","repos_url":"https://api.github.com/users/kws-slalom/repos","events_url":"https://api.github.com/users/kws-slalom/events{/privacy}","received_events_url":"https://api.github.com/users/kws-slalom/received_events","type":"User","site_admin":false}}]