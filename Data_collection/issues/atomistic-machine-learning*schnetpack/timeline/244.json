[{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/717147913","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/244#issuecomment-717147913","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/244","id":717147913,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNzE0NzkxMw==","user":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"created_at":"2020-10-27T10:35:31Z","updated_at":"2020-10-27T10:36:43Z","author_association":"COLLABORATOR","body":"Hey @6-Qingying ,\r\nI assume that you want to increase the volatile gpu-util? Are you using an SSD? You could also try to set `pin_memory=True` in the dataloader (see this [post](https://discuss.pytorch.org/t/gpu-high-memory-usage-low-gpu-volatile-util/19856) on the pytorch-forum). Let me know, if that solved the problem!\r\nIf you want to increase the memory-usage, you could use a bigger batch size.","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/717147913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false}},{"id":3925166143,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzkyNTE2NjE0Mw==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/3925166143","actor":{"login":"6-Qingying","id":73232902,"node_id":"MDQ6VXNlcjczMjMyOTAy","avatar_url":"https://avatars.githubusercontent.com/u/73232902?v=4","gravatar_id":"","url":"https://api.github.com/users/6-Qingying","html_url":"https://github.com/6-Qingying","followers_url":"https://api.github.com/users/6-Qingying/followers","following_url":"https://api.github.com/users/6-Qingying/following{/other_user}","gists_url":"https://api.github.com/users/6-Qingying/gists{/gist_id}","starred_url":"https://api.github.com/users/6-Qingying/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6-Qingying/subscriptions","organizations_url":"https://api.github.com/users/6-Qingying/orgs","repos_url":"https://api.github.com/users/6-Qingying/repos","events_url":"https://api.github.com/users/6-Qingying/events{/privacy}","received_events_url":"https://api.github.com/users/6-Qingying/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-10-27T10:35:31Z","performed_via_github_app":null},{"id":3925166151,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM5MjUxNjYxNTE=","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/3925166151","actor":{"login":"6-Qingying","id":73232902,"node_id":"MDQ6VXNlcjczMjMyOTAy","avatar_url":"https://avatars.githubusercontent.com/u/73232902?v=4","gravatar_id":"","url":"https://api.github.com/users/6-Qingying","html_url":"https://github.com/6-Qingying","followers_url":"https://api.github.com/users/6-Qingying/followers","following_url":"https://api.github.com/users/6-Qingying/following{/other_user}","gists_url":"https://api.github.com/users/6-Qingying/gists{/gist_id}","starred_url":"https://api.github.com/users/6-Qingying/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6-Qingying/subscriptions","organizations_url":"https://api.github.com/users/6-Qingying/orgs","repos_url":"https://api.github.com/users/6-Qingying/repos","events_url":"https://api.github.com/users/6-Qingying/events{/privacy}","received_events_url":"https://api.github.com/users/6-Qingying/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-10-27T10:35:31Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/717221750","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/244#issuecomment-717221750","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/244","id":717221750,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNzIyMTc1MA==","user":{"login":"6-Qingying","id":73232902,"node_id":"MDQ6VXNlcjczMjMyOTAy","avatar_url":"https://avatars.githubusercontent.com/u/73232902?v=4","gravatar_id":"","url":"https://api.github.com/users/6-Qingying","html_url":"https://github.com/6-Qingying","followers_url":"https://api.github.com/users/6-Qingying/followers","following_url":"https://api.github.com/users/6-Qingying/following{/other_user}","gists_url":"https://api.github.com/users/6-Qingying/gists{/gist_id}","starred_url":"https://api.github.com/users/6-Qingying/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6-Qingying/subscriptions","organizations_url":"https://api.github.com/users/6-Qingying/orgs","repos_url":"https://api.github.com/users/6-Qingying/repos","events_url":"https://api.github.com/users/6-Qingying/events{/privacy}","received_events_url":"https://api.github.com/users/6-Qingying/received_events","type":"User","site_admin":false},"created_at":"2020-10-27T12:52:07Z","updated_at":"2020-10-27T12:52:07Z","author_association":"NONE","body":"`import argparse\r\nimport os\r\nimport torch\r\nimport numpy as np\r\nimport schnetpack as spk\r\nimport schnetpack.train as trn\r\nfrom schnetpack import AtomsData\r\nfrom torch.optim import Adam\r\n\r\nparser = argparse.ArgumentParser()\r\nparser.add_argument(\"-db\", type=str, help=\"Database file path\")\r\nparser.add_argument(\"-log\", type=str, help=\"Log directory\")\r\nargs = parser.parse_args()\r\n\r\nlogdir = args.log\r\nif not os.path.exists(logdir):\r\n    os.makedirs(logdir)\r\n\r\nnew_dataset = AtomsData(args.db,\r\n                        available_properties=['energy'])\r\ntrain, val, test = spk.train_test_split(\r\n    data=new_dataset,\r\n    num_train=43000,\r\n    num_val=15000,\r\n    split_file=os.path.join(logdir, \"split.npz\"),\r\n)\r\n\r\ntrain_loader = spk.AtomsLoader(train, batch_size=256, shuffle=True, num_workers=2, pin_memory=True)\r\nval_loader = spk.AtomsLoader(val, batch_size=256, pin_memory=True)\r\n\r\nschnet = spk.representation.SchNet(\r\n    n_atom_basis=30, n_filters=60, n_gaussians=20, n_interactions=6,cutoff=5., \r\n    normalize_filter=False, coupled_interactions=False, return_intermediate=False, \r\n    trainable_gaussians=False, distance_expansion=None, charged_systems=False, \r\n    cutoff_network=spk.nn.cutoff.CosineCutoff\r\n)\r\n\r\noutput_U0 = spk.atomistic.ElementalAtomwise(\r\n    n_in=30, property=new_dataset.available_properties[0], elements=frozenset({1, 6, 7, 8, 16}))\r\nmodel = spk.AtomisticModel(representation=schnet, output_modules=output_U0)\r\n\r\n\r\n# loss function\r\ndef mse_loss(batch, result):\r\n    diff = batch[new_dataset.available_properties[0]] - \\\r\n        result[new_dataset.available_properties[0]]\r\n    err_sq = torch.mean(diff ** 2)\r\n    return err_sq\r\n\r\n\r\n# build optimizer\r\noptimizer = Adam(model.parameters(), lr=1e-3)\r\n\r\nloss = trn.build_mse_loss([new_dataset.available_properties[0]])\r\n\r\nmetrics = [spk.metrics.MeanAbsoluteError(new_dataset.available_properties[0])]\r\nhooks = [\r\n    trn.CSVHook(log_path=logdir, metrics=metrics),\r\n    trn.ReduceLROnPlateauHook(\r\n        optimizer,\r\n        patience=5, factor=0.8, min_lr=1e-6,\r\n        stop_after_min=True\r\n    )\r\n]\r\n\r\ntrainer = trn.Trainer(\r\n    model_path=logdir,\r\n    model=model,\r\n    hooks=hooks,\r\n    loss_fn=loss,\r\n    optimizer=optimizer,\r\n    train_loader=train_loader,\r\n    validation_loader=val_loader,\r\n)\r\n\r\ndevice = \"cuda\"\r\ntrainer.train(device=device)\r\n\r\nresults = np.loadtxt(os.path.join(logdir, 'log.csv'),\r\n                     skiprows=1, delimiter=',')\r\n\r\ntime = results[:, 0]-results[0, 0]\r\nlearning_rate = results[:, 1]\r\ntrain_loss = results[:, 2]\r\nval_loss = results[:, 3]\r\nval_mae = results[:, 4]\r\n\r\nprint('Final validation MAE:', np.round(val_mae[-1], 2), 'kcal/mol')`\r\n\r\nHello!\r\nThis is my traing script. And my data is not on SSD. My training efficiency doesn't change noticeably after setting `pin_memory=True` in the dataloader.  >_<\r\n I also wonder if there is someway which could speed up the calculation of every step. \r\nThank you for your help (and forgive my pour English) !","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/717221750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"6-Qingying","id":73232902,"node_id":"MDQ6VXNlcjczMjMyOTAy","avatar_url":"https://avatars.githubusercontent.com/u/73232902?v=4","gravatar_id":"","url":"https://api.github.com/users/6-Qingying","html_url":"https://github.com/6-Qingying","followers_url":"https://api.github.com/users/6-Qingying/followers","following_url":"https://api.github.com/users/6-Qingying/following{/other_user}","gists_url":"https://api.github.com/users/6-Qingying/gists{/gist_id}","starred_url":"https://api.github.com/users/6-Qingying/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6-Qingying/subscriptions","organizations_url":"https://api.github.com/users/6-Qingying/orgs","repos_url":"https://api.github.com/users/6-Qingying/repos","events_url":"https://api.github.com/users/6-Qingying/events{/privacy}","received_events_url":"https://api.github.com/users/6-Qingying/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/717237601","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/244#issuecomment-717237601","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/244","id":717237601,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNzIzNzYwMQ==","user":{"login":"Dankomaister","id":14222532,"node_id":"MDQ6VXNlcjE0MjIyNTMy","avatar_url":"https://avatars.githubusercontent.com/u/14222532?v=4","gravatar_id":"","url":"https://api.github.com/users/Dankomaister","html_url":"https://github.com/Dankomaister","followers_url":"https://api.github.com/users/Dankomaister/followers","following_url":"https://api.github.com/users/Dankomaister/following{/other_user}","gists_url":"https://api.github.com/users/Dankomaister/gists{/gist_id}","starred_url":"https://api.github.com/users/Dankomaister/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Dankomaister/subscriptions","organizations_url":"https://api.github.com/users/Dankomaister/orgs","repos_url":"https://api.github.com/users/Dankomaister/repos","events_url":"https://api.github.com/users/Dankomaister/events{/privacy}","received_events_url":"https://api.github.com/users/Dankomaister/received_events","type":"User","site_admin":false},"created_at":"2020-10-27T13:19:37Z","updated_at":"2020-10-27T13:19:37Z","author_association":"NONE","body":"Hi @6-Qingying,\r\nMaybe I can give some suggestions.\r\nFirst try and set `num_workers` for both the `train_loader` and `val_loader` since both are used during training.\r\nAlso what hardware are you running on?\r\nI would increase the `num_workers` to at least 4 per GPU (depending on how many CPU cores you have available).\r\nI see that you are trying to run on two GPUs, maybe try and use only one initially and see if you can efficiently utilize that.\r\nI also agree with @Stefaanhess that is better if the training data is located on fast storage like an SSD or if you are using Linux you can first copy the training data to a `tmpfs` filesystem like `/dev/shm` which is essentiality a RAM disk and read it form there.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/717237601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Dankomaister","id":14222532,"node_id":"MDQ6VXNlcjE0MjIyNTMy","avatar_url":"https://avatars.githubusercontent.com/u/14222532?v=4","gravatar_id":"","url":"https://api.github.com/users/Dankomaister","html_url":"https://github.com/Dankomaister","followers_url":"https://api.github.com/users/Dankomaister/followers","following_url":"https://api.github.com/users/Dankomaister/following{/other_user}","gists_url":"https://api.github.com/users/Dankomaister/gists{/gist_id}","starred_url":"https://api.github.com/users/Dankomaister/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Dankomaister/subscriptions","organizations_url":"https://api.github.com/users/Dankomaister/orgs","repos_url":"https://api.github.com/users/Dankomaister/repos","events_url":"https://api.github.com/users/Dankomaister/events{/privacy}","received_events_url":"https://api.github.com/users/Dankomaister/received_events","type":"User","site_admin":false}},{"id":3925876110,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzkyNTg3NjExMA==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/3925876110","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-10-27T13:19:37Z","performed_via_github_app":null},{"id":3925876115,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM5MjU4NzYxMTU=","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/3925876115","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-10-27T13:19:37Z","performed_via_github_app":null},{"id":3925876122,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzkyNTg3NjEyMg==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/3925876122","actor":{"login":"6-Qingying","id":73232902,"node_id":"MDQ6VXNlcjczMjMyOTAy","avatar_url":"https://avatars.githubusercontent.com/u/73232902?v=4","gravatar_id":"","url":"https://api.github.com/users/6-Qingying","html_url":"https://github.com/6-Qingying","followers_url":"https://api.github.com/users/6-Qingying/followers","following_url":"https://api.github.com/users/6-Qingying/following{/other_user}","gists_url":"https://api.github.com/users/6-Qingying/gists{/gist_id}","starred_url":"https://api.github.com/users/6-Qingying/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6-Qingying/subscriptions","organizations_url":"https://api.github.com/users/6-Qingying/orgs","repos_url":"https://api.github.com/users/6-Qingying/repos","events_url":"https://api.github.com/users/6-Qingying/events{/privacy}","received_events_url":"https://api.github.com/users/6-Qingying/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-10-27T13:19:37Z","performed_via_github_app":null},{"id":3925876129,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM5MjU4NzYxMjk=","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/3925876129","actor":{"login":"6-Qingying","id":73232902,"node_id":"MDQ6VXNlcjczMjMyOTAy","avatar_url":"https://avatars.githubusercontent.com/u/73232902?v=4","gravatar_id":"","url":"https://api.github.com/users/6-Qingying","html_url":"https://github.com/6-Qingying","followers_url":"https://api.github.com/users/6-Qingying/followers","following_url":"https://api.github.com/users/6-Qingying/following{/other_user}","gists_url":"https://api.github.com/users/6-Qingying/gists{/gist_id}","starred_url":"https://api.github.com/users/6-Qingying/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6-Qingying/subscriptions","organizations_url":"https://api.github.com/users/6-Qingying/orgs","repos_url":"https://api.github.com/users/6-Qingying/repos","events_url":"https://api.github.com/users/6-Qingying/events{/privacy}","received_events_url":"https://api.github.com/users/6-Qingying/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-10-27T13:19:37Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/717297350","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/244#issuecomment-717297350","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/244","id":717297350,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNzI5NzM1MA==","user":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"created_at":"2020-10-27T14:49:41Z","updated_at":"2020-10-27T14:49:41Z","author_association":"COLLABORATOR","body":"I just did a little test, to measure the difference. When I run a training session on the SSD, I get a volatile gpu-util value between 30% and 90%. The same script on a HDD only yields values between 0% and 30% :)","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/717297350/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/719497174","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/244#issuecomment-719497174","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/244","id":719497174,"node_id":"MDEyOklzc3VlQ29tbWVudDcxOTQ5NzE3NA==","user":{"login":"6-Qingying","id":73232902,"node_id":"MDQ6VXNlcjczMjMyOTAy","avatar_url":"https://avatars.githubusercontent.com/u/73232902?v=4","gravatar_id":"","url":"https://api.github.com/users/6-Qingying","html_url":"https://github.com/6-Qingying","followers_url":"https://api.github.com/users/6-Qingying/followers","following_url":"https://api.github.com/users/6-Qingying/following{/other_user}","gists_url":"https://api.github.com/users/6-Qingying/gists{/gist_id}","starred_url":"https://api.github.com/users/6-Qingying/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6-Qingying/subscriptions","organizations_url":"https://api.github.com/users/6-Qingying/orgs","repos_url":"https://api.github.com/users/6-Qingying/repos","events_url":"https://api.github.com/users/6-Qingying/events{/privacy}","received_events_url":"https://api.github.com/users/6-Qingying/received_events","type":"User","site_admin":false},"created_at":"2020-10-30T11:23:48Z","updated_at":"2020-10-30T11:23:48Z","author_association":"NONE","body":"> Hi @6-Qingying,\r\n> Maybe I can give some suggestions.\r\n> First try and set `num_workers` for both the `train_loader` and `val_loader` since both are used during training.\r\n> Also what hardware are you running on?\r\n> I would increase the `num_workers` to at least 4 per GPU (depending on how many CPU cores you have available).\r\n> I see that you are trying to run on two GPUs, maybe try and use only one initially and see if you can efficiently utilize that.\r\n> I also agree with @Stefaanhess that is better if the training data is located on fast storage like an SSD or if you are using Linux you can first copy the training data to a `tmpfs` filesystem like `/dev/shm` which is essentiality a RAM disk and read it form there.\r\n\r\nThanks for help!\r\nI have tried the approach you provided, and it is quite useful! Thank you so much!","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/719497174/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"6-Qingying","id":73232902,"node_id":"MDQ6VXNlcjczMjMyOTAy","avatar_url":"https://avatars.githubusercontent.com/u/73232902?v=4","gravatar_id":"","url":"https://api.github.com/users/6-Qingying","html_url":"https://github.com/6-Qingying","followers_url":"https://api.github.com/users/6-Qingying/followers","following_url":"https://api.github.com/users/6-Qingying/following{/other_user}","gists_url":"https://api.github.com/users/6-Qingying/gists{/gist_id}","starred_url":"https://api.github.com/users/6-Qingying/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6-Qingying/subscriptions","organizations_url":"https://api.github.com/users/6-Qingying/orgs","repos_url":"https://api.github.com/users/6-Qingying/repos","events_url":"https://api.github.com/users/6-Qingying/events{/privacy}","received_events_url":"https://api.github.com/users/6-Qingying/received_events","type":"User","site_admin":false}},{"id":3940751047,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mzk0MDc1MTA0Nw==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/3940751047","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-10-30T11:23:49Z","performed_via_github_app":null},{"id":3940751053,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM5NDA3NTEwNTM=","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/3940751053","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-10-30T11:23:49Z","performed_via_github_app":null},{"id":3940751059,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mzk0MDc1MTA1OQ==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/3940751059","actor":{"login":"6-Qingying","id":73232902,"node_id":"MDQ6VXNlcjczMjMyOTAy","avatar_url":"https://avatars.githubusercontent.com/u/73232902?v=4","gravatar_id":"","url":"https://api.github.com/users/6-Qingying","html_url":"https://github.com/6-Qingying","followers_url":"https://api.github.com/users/6-Qingying/followers","following_url":"https://api.github.com/users/6-Qingying/following{/other_user}","gists_url":"https://api.github.com/users/6-Qingying/gists{/gist_id}","starred_url":"https://api.github.com/users/6-Qingying/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6-Qingying/subscriptions","organizations_url":"https://api.github.com/users/6-Qingying/orgs","repos_url":"https://api.github.com/users/6-Qingying/repos","events_url":"https://api.github.com/users/6-Qingying/events{/privacy}","received_events_url":"https://api.github.com/users/6-Qingying/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-10-30T11:23:49Z","performed_via_github_app":null},{"id":3940751065,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM5NDA3NTEwNjU=","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/3940751065","actor":{"login":"6-Qingying","id":73232902,"node_id":"MDQ6VXNlcjczMjMyOTAy","avatar_url":"https://avatars.githubusercontent.com/u/73232902?v=4","gravatar_id":"","url":"https://api.github.com/users/6-Qingying","html_url":"https://github.com/6-Qingying","followers_url":"https://api.github.com/users/6-Qingying/followers","following_url":"https://api.github.com/users/6-Qingying/following{/other_user}","gists_url":"https://api.github.com/users/6-Qingying/gists{/gist_id}","starred_url":"https://api.github.com/users/6-Qingying/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6-Qingying/subscriptions","organizations_url":"https://api.github.com/users/6-Qingying/orgs","repos_url":"https://api.github.com/users/6-Qingying/repos","events_url":"https://api.github.com/users/6-Qingying/events{/privacy}","received_events_url":"https://api.github.com/users/6-Qingying/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-10-30T11:23:49Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/719519156","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/244#issuecomment-719519156","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/244","id":719519156,"node_id":"MDEyOklzc3VlQ29tbWVudDcxOTUxOTE1Ng==","user":{"login":"6-Qingying","id":73232902,"node_id":"MDQ6VXNlcjczMjMyOTAy","avatar_url":"https://avatars.githubusercontent.com/u/73232902?v=4","gravatar_id":"","url":"https://api.github.com/users/6-Qingying","html_url":"https://github.com/6-Qingying","followers_url":"https://api.github.com/users/6-Qingying/followers","following_url":"https://api.github.com/users/6-Qingying/following{/other_user}","gists_url":"https://api.github.com/users/6-Qingying/gists{/gist_id}","starred_url":"https://api.github.com/users/6-Qingying/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6-Qingying/subscriptions","organizations_url":"https://api.github.com/users/6-Qingying/orgs","repos_url":"https://api.github.com/users/6-Qingying/repos","events_url":"https://api.github.com/users/6-Qingying/events{/privacy}","received_events_url":"https://api.github.com/users/6-Qingying/received_events","type":"User","site_admin":false},"created_at":"2020-10-30T12:16:23Z","updated_at":"2020-10-30T12:16:23Z","author_association":"NONE","body":"> I just did a little test, to measure the difference. When I run a training session on the SSD, I get a volatile gpu-util value between 30% and 90%. The same script on a HDD only yields values between 0% and 30% :)\r\n\r\nThat explains a lot!  I see. Thanks again for your help! And SSD is unavailable temporarily, maybe one day I would have a try and experience a volatile gpu-util value between 30% and 90%. 👍 :)","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/719519156/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"6-Qingying","id":73232902,"node_id":"MDQ6VXNlcjczMjMyOTAy","avatar_url":"https://avatars.githubusercontent.com/u/73232902?v=4","gravatar_id":"","url":"https://api.github.com/users/6-Qingying","html_url":"https://github.com/6-Qingying","followers_url":"https://api.github.com/users/6-Qingying/followers","following_url":"https://api.github.com/users/6-Qingying/following{/other_user}","gists_url":"https://api.github.com/users/6-Qingying/gists{/gist_id}","starred_url":"https://api.github.com/users/6-Qingying/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6-Qingying/subscriptions","organizations_url":"https://api.github.com/users/6-Qingying/orgs","repos_url":"https://api.github.com/users/6-Qingying/repos","events_url":"https://api.github.com/users/6-Qingying/events{/privacy}","received_events_url":"https://api.github.com/users/6-Qingying/received_events","type":"User","site_admin":false}},{"id":3998782560,"node_id":"MDExOkNsb3NlZEV2ZW50Mzk5ODc4MjU2MA==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/3998782560","actor":{"login":"6-Qingying","id":73232902,"node_id":"MDQ6VXNlcjczMjMyOTAy","avatar_url":"https://avatars.githubusercontent.com/u/73232902?v=4","gravatar_id":"","url":"https://api.github.com/users/6-Qingying","html_url":"https://github.com/6-Qingying","followers_url":"https://api.github.com/users/6-Qingying/followers","following_url":"https://api.github.com/users/6-Qingying/following{/other_user}","gists_url":"https://api.github.com/users/6-Qingying/gists{/gist_id}","starred_url":"https://api.github.com/users/6-Qingying/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6-Qingying/subscriptions","organizations_url":"https://api.github.com/users/6-Qingying/orgs","repos_url":"https://api.github.com/users/6-Qingying/repos","events_url":"https://api.github.com/users/6-Qingying/events{/privacy}","received_events_url":"https://api.github.com/users/6-Qingying/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-11-16T07:22:49Z","state_reason":null,"performed_via_github_app":null}]