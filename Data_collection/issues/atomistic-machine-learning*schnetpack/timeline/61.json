[{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/470466643","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/61#issuecomment-470466643","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/61","id":470466643,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MDQ2NjY0Mw==","user":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"created_at":"2019-03-07T10:13:44Z","updated_at":"2019-03-07T10:13:44Z","author_association":"CONTRIBUTOR","body":"HDNN require angles, therfore triples of atoms have to be collected during data loading. You can activate this by using:\r\n`data = AtomsData('./db/Icosahedron-2-large-unique-50-test.db', properties=['energy'], collect_triples=True)`","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/470466643/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false}},{"id":2186722951,"node_id":"MDExOkNsb3NlZEV2ZW50MjE4NjcyMjk1MQ==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2186722951","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-03-07T10:13:52Z","state_reason":null,"performed_via_github_app":null},{"id":2186723912,"node_id":"MDEzOlJlb3BlbmVkRXZlbnQyMTg2NzIzOTEy","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2186723912","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"event":"reopened","commit_id":null,"commit_url":null,"created_at":"2019-03-07T10:14:11Z","state_reason":null,"performed_via_github_app":null},{"actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"created_at":"2019-03-07T10:50:12Z","updated_at":"2019-03-07T10:50:12Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/63","repository_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack","labels_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/63/labels{/name}","comments_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/63/comments","events_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/63/events","html_url":"https://github.com/atomistic-machine-learning/schnetpack/pull/63","id":418245311,"node_id":"MDExOlB1bGxSZXF1ZXN0MjU5MDYyNjM4","number":63,"title":"Improved error message","user":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-03-07T10:50:12Z","updated_at":"2019-03-26T15:23:17Z","closed_at":"2019-03-07T10:58:19Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"repository":{"id":147224878,"node_id":"MDEwOlJlcG9zaXRvcnkxNDcyMjQ4Nzg=","name":"schnetpack","full_name":"atomistic-machine-learning/schnetpack","private":false,"owner":{"login":"atomistic-machine-learning","id":26488588,"node_id":"MDEyOk9yZ2FuaXphdGlvbjI2NDg4NTg4","avatar_url":"https://avatars.githubusercontent.com/u/26488588?v=4","gravatar_id":"","url":"https://api.github.com/users/atomistic-machine-learning","html_url":"https://github.com/atomistic-machine-learning","followers_url":"https://api.github.com/users/atomistic-machine-learning/followers","following_url":"https://api.github.com/users/atomistic-machine-learning/following{/other_user}","gists_url":"https://api.github.com/users/atomistic-machine-learning/gists{/gist_id}","starred_url":"https://api.github.com/users/atomistic-machine-learning/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atomistic-machine-learning/subscriptions","organizations_url":"https://api.github.com/users/atomistic-machine-learning/orgs","repos_url":"https://api.github.com/users/atomistic-machine-learning/repos","events_url":"https://api.github.com/users/atomistic-machine-learning/events{/privacy}","received_events_url":"https://api.github.com/users/atomistic-machine-learning/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/atomistic-machine-learning/schnetpack","description":"SchNetPack - Deep Neural Networks for Atomistic Systems","fork":false,"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack","forks_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/forks","keys_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/keys{/key_id}","collaborators_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/teams","hooks_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/hooks","issue_events_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events{/number}","events_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/events","assignees_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/assignees{/user}","branches_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/branches{/branch}","tags_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/tags","blobs_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/git/refs{/sha}","trees_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/git/trees{/sha}","statuses_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/statuses/{sha}","languages_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/languages","stargazers_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/stargazers","contributors_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/contributors","subscribers_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/subscribers","subscription_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/subscription","commits_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/commits{/sha}","git_commits_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/git/commits{/sha}","comments_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/comments{/number}","issue_comment_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments{/number}","contents_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/contents/{+path}","compare_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/compare/{base}...{head}","merges_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/merges","archive_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/downloads","issues_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues{/number}","pulls_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/pulls{/number}","milestones_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/milestones{/number}","notifications_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/labels{/name}","releases_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/releases{/id}","deployments_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/deployments","created_at":"2018-09-03T15:44:35Z","updated_at":"2023-01-19T06:30:46Z","pushed_at":"2023-01-11T14:21:06Z","git_url":"git://github.com/atomistic-machine-learning/schnetpack.git","ssh_url":"git@github.com:atomistic-machine-learning/schnetpack.git","clone_url":"https://github.com/atomistic-machine-learning/schnetpack.git","svn_url":"https://github.com/atomistic-machine-learning/schnetpack","homepage":null,"size":33470,"stargazers_count":557,"watchers_count":557,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":167,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["condensed-matter","machine-learning","molecular-dynamics","neural-network","quantum-chemistry"],"visibility":"public","forks":167,"open_issues":2,"watchers":557,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/pulls/63","html_url":"https://github.com/atomistic-machine-learning/schnetpack/pull/63","diff_url":"https://github.com/atomistic-machine-learning/schnetpack/pull/63.diff","patch_url":"https://github.com/atomistic-machine-learning/schnetpack/pull/63.patch","merged_at":"2019-03-07T10:58:19Z"},"body":"See issue #61 ","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/63/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/63/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":2186823784,"node_id":"MDExOkNsb3NlZEV2ZW50MjE4NjgyMzc4NA==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2186823784","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-03-07T10:51:16Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/470687338","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/61#issuecomment-470687338","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/61","id":470687338,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MDY4NzMzOA==","user":{"login":"lmj1029123","id":34913961,"node_id":"MDQ6VXNlcjM0OTEzOTYx","avatar_url":"https://avatars.githubusercontent.com/u/34913961?v=4","gravatar_id":"","url":"https://api.github.com/users/lmj1029123","html_url":"https://github.com/lmj1029123","followers_url":"https://api.github.com/users/lmj1029123/followers","following_url":"https://api.github.com/users/lmj1029123/following{/other_user}","gists_url":"https://api.github.com/users/lmj1029123/gists{/gist_id}","starred_url":"https://api.github.com/users/lmj1029123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lmj1029123/subscriptions","organizations_url":"https://api.github.com/users/lmj1029123/orgs","repos_url":"https://api.github.com/users/lmj1029123/repos","events_url":"https://api.github.com/users/lmj1029123/events{/privacy}","received_events_url":"https://api.github.com/users/lmj1029123/received_events","type":"User","site_admin":false},"created_at":"2019-03-07T20:45:52Z","updated_at":"2019-03-07T20:45:52Z","author_association":"CONTRIBUTOR","body":"Thanks for the reply. However, I am still getting errors after adding that argument, though it is a different error.\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-1-5c51adbb0a71> in <module>()\r\n     32 \r\n     33 # start training\r\n---> 34 trainer.train(torch.device(\"cpu\"))\r\n\r\n~\\Anaconda3\\lib\\site-packages\\schnetpack\\train\\trainer.py in train(self, device)\r\n    214                 h.on_train_failed(self)\r\n    215 \r\n--> 216             raise e\r\n\r\n~\\Anaconda3\\lib\\site-packages\\schnetpack\\train\\trainer.py in train(self, device)\r\n    142                     }\r\n    143 \r\n--> 144                     result = self._model(train_batch)\r\n    145                     loss = self.loss_fn(train_batch, result)\r\n    146 \r\n\r\n~\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in __call__(self, *input, **kwargs)\r\n    487             result = self._slow_forward(*input, **kwargs)\r\n    488         else:\r\n--> 489             result = self.forward(*input, **kwargs)\r\n    490         for hook in self._forward_hooks.values():\r\n    491             hook_result = hook(self, input, result)\r\n\r\n~\\Anaconda3\\lib\\site-packages\\schnetpack\\atomistic.py in forward(self, inputs)\r\n     60                 outs[output_module] = output_module(inputs)\r\n     61         else:\r\n---> 62             outs = self.output_modules(inputs)\r\n     63 \r\n     64         return outs\r\n\r\n~\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in __call__(self, *input, **kwargs)\r\n    487             result = self._slow_forward(*input, **kwargs)\r\n    488         else:\r\n--> 489             result = self.forward(*input, **kwargs)\r\n    490         for hook in self._forward_hooks.values():\r\n    491             hook_result = hook(self, input, result)\r\n\r\n~\\Anaconda3\\lib\\site-packages\\schnetpack\\atomistic.py in forward(self, inputs)\r\n    165         atom_mask = inputs[Structure.atom_mask]\r\n    166 \r\n--> 167         yi = self.out_net(inputs)\r\n    168         yi = self.standardize(yi)\r\n    169 \r\n\r\n~\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in __call__(self, *input, **kwargs)\r\n    487             result = self._slow_forward(*input, **kwargs)\r\n    488         else:\r\n--> 489             result = self.forward(*input, **kwargs)\r\n    490         for hook in self._forward_hooks.values():\r\n    491             hook_result = hook(self, input, result)\r\n\r\n~\\Anaconda3\\lib\\site-packages\\schnetpack\\nn\\blocks.py in forward(self, inputs)\r\n    174         atomic_numbers = inputs[Structure.Z]\r\n    175         representation = inputs[\"representation\"]\r\n--> 176         gated_network = self.gate(atomic_numbers) * self.network(representation)\r\n    177         return torch.sum(gated_network, -1, keepdim=True)\r\n\r\n~\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in __call__(self, *input, **kwargs)\r\n    487             result = self._slow_forward(*input, **kwargs)\r\n    488         else:\r\n--> 489             result = self.forward(*input, **kwargs)\r\n    490         for hook in self._forward_hooks.values():\r\n    491             hook_result = hook(self, input, result)\r\n\r\n~\\Anaconda3\\lib\\site-packages\\schnetpack\\nn\\blocks.py in forward(self, atomic_numbers)\r\n    129 \r\n    130         \"\"\"\r\n--> 131         return self.gate(atomic_numbers)\r\n    132 \r\n    133 \r\n\r\n~\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in __call__(self, *input, **kwargs)\r\n    487             result = self._slow_forward(*input, **kwargs)\r\n    488         else:\r\n--> 489             result = self.forward(*input, **kwargs)\r\n    490         for hook in self._forward_hooks.values():\r\n    491             hook_result = hook(self, input, result)\r\n\r\n~\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\sparse.py in forward(self, input)\r\n    116         return F.embedding(\r\n    117             input, self.weight, self.padding_idx, self.max_norm,\r\n--> 118             self.norm_type, self.scale_grad_by_freq, self.sparse)\r\n    119 \r\n    120     def extra_repr(self):\r\n\r\n~\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py in embedding(input, weight, padding_idx, max_norm, norm_type, scale_grad_by_freq, sparse)\r\n   1452         # remove once script supports set_grad_enabled\r\n   1453         _no_grad_embedding_renorm_(weight, input, max_norm, norm_type)\r\n-> 1454     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)\r\n   1455 \r\n   1456 \r\n\r\nRuntimeError: index out of range at c:\\a\\w\\1\\s\\tmp_conda_3.6_062715\\conda\\conda-bld\\pytorch-cpu_1550384979956\\work\\aten\\src\\th\\generic/THTensorEvenMoreMath.cpp:191\r\n```\r\n\r\nAlso, I am not very sure about \r\n```data = AtomsData('./db/Icosahedron-2-large-unique-50-test.db', properties=['energy'], collect_triples=True)```\r\nWhat does the properties actually do. The db file is from ase so for each row in the db, I can get the energy by \r\n```energy = row.energy```\r\nWill it work? Or am I supposed to have the energy stored in data of the row so that I can get the energy by\r\n```energy = row.data['energy']```\r\n\r\nThanks you very much!\r\n","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/470687338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lmj1029123","id":34913961,"node_id":"MDQ6VXNlcjM0OTEzOTYx","avatar_url":"https://avatars.githubusercontent.com/u/34913961?v=4","gravatar_id":"","url":"https://api.github.com/users/lmj1029123","html_url":"https://github.com/lmj1029123","followers_url":"https://api.github.com/users/lmj1029123/followers","following_url":"https://api.github.com/users/lmj1029123/following{/other_user}","gists_url":"https://api.github.com/users/lmj1029123/gists{/gist_id}","starred_url":"https://api.github.com/users/lmj1029123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lmj1029123/subscriptions","organizations_url":"https://api.github.com/users/lmj1029123/orgs","repos_url":"https://api.github.com/users/lmj1029123/repos","events_url":"https://api.github.com/users/lmj1029123/events{/privacy}","received_events_url":"https://api.github.com/users/lmj1029123/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/470713730","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/61#issuecomment-470713730","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/61","id":470713730,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MDcxMzczMA==","user":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"created_at":"2019-03-07T22:03:55Z","updated_at":"2019-03-07T22:03:55Z","author_association":"CONTRIBUTOR","body":"Yes, it should be in data\n\nOn Thu, Mar 7, 2019, 21:45 lmj1029123 <notifications@github.com> wrote:\n\n> Thanks for the reply. However, I am still getting errors after adding that\n> argument, though it is a different error.\n>\n> ---------------------------------------------------------------------------\n> RuntimeError                              Traceback (most recent call last)\n> <ipython-input-1-5c51adbb0a71> in <module>()\n>      32\n>      33 # start training\n> ---> 34 trainer.train(torch.device(\"cpu\"))\n>\n> ~\\Anaconda3\\lib\\site-packages\\schnetpack\\train\\trainer.py in train(self, device)\n>     214                 h.on_train_failed(self)\n>     215\n> --> 216             raise e\n>\n> ~\\Anaconda3\\lib\\site-packages\\schnetpack\\train\\trainer.py in train(self, device)\n>     142                     }\n>     143\n> --> 144                     result = self._model(train_batch)\n>     145                     loss = self.loss_fn(train_batch, result)\n>     146\n>\n> ~\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in __call__(self, *input, **kwargs)\n>     487             result = self._slow_forward(*input, **kwargs)\n>     488         else:\n> --> 489             result = self.forward(*input, **kwargs)\n>     490         for hook in self._forward_hooks.values():\n>     491             hook_result = hook(self, input, result)\n>\n> ~\\Anaconda3\\lib\\site-packages\\schnetpack\\atomistic.py in forward(self, inputs)\n>      60                 outs[output_module] = output_module(inputs)\n>      61         else:\n> ---> 62             outs = self.output_modules(inputs)\n>      63\n>      64         return outs\n>\n> ~\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in __call__(self, *input, **kwargs)\n>     487             result = self._slow_forward(*input, **kwargs)\n>     488         else:\n> --> 489             result = self.forward(*input, **kwargs)\n>     490         for hook in self._forward_hooks.values():\n>     491             hook_result = hook(self, input, result)\n>\n> ~\\Anaconda3\\lib\\site-packages\\schnetpack\\atomistic.py in forward(self, inputs)\n>     165         atom_mask = inputs[Structure.atom_mask]\n>     166\n> --> 167         yi = self.out_net(inputs)\n>     168         yi = self.standardize(yi)\n>     169\n>\n> ~\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in __call__(self, *input, **kwargs)\n>     487             result = self._slow_forward(*input, **kwargs)\n>     488         else:\n> --> 489             result = self.forward(*input, **kwargs)\n>     490         for hook in self._forward_hooks.values():\n>     491             hook_result = hook(self, input, result)\n>\n> ~\\Anaconda3\\lib\\site-packages\\schnetpack\\nn\\blocks.py in forward(self, inputs)\n>     174         atomic_numbers = inputs[Structure.Z]\n>     175         representation = inputs[\"representation\"]\n> --> 176         gated_network = self.gate(atomic_numbers) * self.network(representation)\n>     177         return torch.sum(gated_network, -1, keepdim=True)\n>\n> ~\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in __call__(self, *input, **kwargs)\n>     487             result = self._slow_forward(*input, **kwargs)\n>     488         else:\n> --> 489             result = self.forward(*input, **kwargs)\n>     490         for hook in self._forward_hooks.values():\n>     491             hook_result = hook(self, input, result)\n>\n> ~\\Anaconda3\\lib\\site-packages\\schnetpack\\nn\\blocks.py in forward(self, atomic_numbers)\n>     129\n>     130         \"\"\"\n> --> 131         return self.gate(atomic_numbers)\n>     132\n>     133\n>\n> ~\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py in __call__(self, *input, **kwargs)\n>     487             result = self._slow_forward(*input, **kwargs)\n>     488         else:\n> --> 489             result = self.forward(*input, **kwargs)\n>     490         for hook in self._forward_hooks.values():\n>     491             hook_result = hook(self, input, result)\n>\n> ~\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\sparse.py in forward(self, input)\n>     116         return F.embedding(\n>     117             input, self.weight, self.padding_idx, self.max_norm,\n> --> 118             self.norm_type, self.scale_grad_by_freq, self.sparse)\n>     119\n>     120     def extra_repr(self):\n>\n> ~\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py in embedding(input, weight, padding_idx, max_norm, norm_type, scale_grad_by_freq, sparse)\n>    1452         # remove once script supports set_grad_enabled\n>    1453         _no_grad_embedding_renorm_(weight, input, max_norm, norm_type)\n> -> 1454     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)\n>    1455\n>    1456\n>\n> RuntimeError: index out of range at c:\\a\\w\\1\\s\\tmp_conda_3.6_062715\\conda\\conda-bld\\pytorch-cpu_1550384979956\\work\\aten\\src\\th\\generic/THTensorEvenMoreMath.cpp:191\n>\n> Also, I am not very sure about\n> data = AtomsData('./db/Icosahedron-2-large-unique-50-test.db',\n> properties=['energy'], collect_triples=True)\n> What does the properties actually do. The db file is from ase so for each\n> row in the db, I can get the energy by\n> energy = row.energy\n> Will it work? Or am I supposed to have the energy stored in data of the\n> row so that I can get the energy by\n> energy = row.data['energy']\n>\n> Thanks you very much!\n>\n> —\n> You are receiving this because you modified the open/close state.\n>\n>\n> Reply to this email directly, view it on GitHub\n> <https://github.com/atomistic-machine-learning/schnetpack/issues/61#issuecomment-470687338>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AGR7Gh9m7ezwXJgPOljBtx9N8XyXqB0Eks5vUXqBgaJpZM4bh4Z1>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/470713730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/470717650","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/61#issuecomment-470717650","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/61","id":470717650,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MDcxNzY1MA==","user":{"login":"lmj1029123","id":34913961,"node_id":"MDQ6VXNlcjM0OTEzOTYx","avatar_url":"https://avatars.githubusercontent.com/u/34913961?v=4","gravatar_id":"","url":"https://api.github.com/users/lmj1029123","html_url":"https://github.com/lmj1029123","followers_url":"https://api.github.com/users/lmj1029123/followers","following_url":"https://api.github.com/users/lmj1029123/following{/other_user}","gists_url":"https://api.github.com/users/lmj1029123/gists{/gist_id}","starred_url":"https://api.github.com/users/lmj1029123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lmj1029123/subscriptions","organizations_url":"https://api.github.com/users/lmj1029123/orgs","repos_url":"https://api.github.com/users/lmj1029123/repos","events_url":"https://api.github.com/users/lmj1029123/events{/privacy}","received_events_url":"https://api.github.com/users/lmj1029123/received_events","type":"User","site_admin":false},"created_at":"2019-03-07T22:14:24Z","updated_at":"2019-03-07T22:14:24Z","author_association":"CONTRIBUTOR","body":"I am still getting the same error after adding the energy to data. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/470717650/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lmj1029123","id":34913961,"node_id":"MDQ6VXNlcjM0OTEzOTYx","avatar_url":"https://avatars.githubusercontent.com/u/34913961?v=4","gravatar_id":"","url":"https://api.github.com/users/lmj1029123","html_url":"https://github.com/lmj1029123","followers_url":"https://api.github.com/users/lmj1029123/followers","following_url":"https://api.github.com/users/lmj1029123/following{/other_user}","gists_url":"https://api.github.com/users/lmj1029123/gists{/gist_id}","starred_url":"https://api.github.com/users/lmj1029123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lmj1029123/subscriptions","organizations_url":"https://api.github.com/users/lmj1029123/orgs","repos_url":"https://api.github.com/users/lmj1029123/repos","events_url":"https://api.github.com/users/lmj1029123/events{/privacy}","received_events_url":"https://api.github.com/users/lmj1029123/received_events","type":"User","site_admin":false}},{"id":2193075776,"node_id":"MDEzOlJlb3BlbmVkRXZlbnQyMTkzMDc1Nzc2","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2193075776","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"event":"reopened","commit_id":null,"commit_url":null,"created_at":"2019-03-11T07:51:48Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/471439834","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/61#issuecomment-471439834","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/61","id":471439834,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MTQzOTgzNA==","user":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"created_at":"2019-03-11T08:03:03Z","updated_at":"2019-03-11T08:03:03Z","author_association":"CONTRIBUTOR","body":"Ok, I see:\r\n1. We normally store properties binary-encoded in data (which is faster, especially if it is not just a scalar), but have a fallback for key-value-pairs and the default ASE string-encoding, so this did not matter.\r\n2. You have to give the set of elements also to `ElementalAtomwise` since it is creating one output network per atom type:\r\n`output = atm.ElementalAtomwise(reps.n_symfuncs, elements=frozenset([46,79]))`","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/471439834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false}},{"id":2193095682,"node_id":"MDExOkNsb3NlZEV2ZW50MjE5MzA5NTY4Mg==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2193095682","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-03-11T08:03:15Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/471735045","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/61#issuecomment-471735045","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/61","id":471735045,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MTczNTA0NQ==","user":{"login":"lmj1029123","id":34913961,"node_id":"MDQ6VXNlcjM0OTEzOTYx","avatar_url":"https://avatars.githubusercontent.com/u/34913961?v=4","gravatar_id":"","url":"https://api.github.com/users/lmj1029123","html_url":"https://github.com/lmj1029123","followers_url":"https://api.github.com/users/lmj1029123/followers","following_url":"https://api.github.com/users/lmj1029123/following{/other_user}","gists_url":"https://api.github.com/users/lmj1029123/gists{/gist_id}","starred_url":"https://api.github.com/users/lmj1029123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lmj1029123/subscriptions","organizations_url":"https://api.github.com/users/lmj1029123/orgs","repos_url":"https://api.github.com/users/lmj1029123/repos","events_url":"https://api.github.com/users/lmj1029123/events{/privacy}","received_events_url":"https://api.github.com/users/lmj1029123/received_events","type":"User","site_admin":false},"created_at":"2019-03-11T21:21:54Z","updated_at":"2019-03-11T21:21:54Z","author_association":"CONTRIBUTOR","body":"Thanks! It is working now. \r\n\r\nHowever, I am wondering how do you do force training with the code. Apparently, there is the \"create_graph\" argument, so it can predict the force, but I don't know how the model is going to extract the force information from the database and compare it with the predicted forces. \r\n\r\nThank you! ","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/471735045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lmj1029123","id":34913961,"node_id":"MDQ6VXNlcjM0OTEzOTYx","avatar_url":"https://avatars.githubusercontent.com/u/34913961?v=4","gravatar_id":"","url":"https://api.github.com/users/lmj1029123","html_url":"https://github.com/lmj1029123","followers_url":"https://api.github.com/users/lmj1029123/followers","following_url":"https://api.github.com/users/lmj1029123/following{/other_user}","gists_url":"https://api.github.com/users/lmj1029123/gists{/gist_id}","starred_url":"https://api.github.com/users/lmj1029123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lmj1029123/subscriptions","organizations_url":"https://api.github.com/users/lmj1029123/orgs","repos_url":"https://api.github.com/users/lmj1029123/repos","events_url":"https://api.github.com/users/lmj1029123/events{/privacy}","received_events_url":"https://api.github.com/users/lmj1029123/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/471901321","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/61#issuecomment-471901321","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/61","id":471901321,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MTkwMTMyMQ==","user":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"created_at":"2019-03-12T08:22:58Z","updated_at":"2019-03-12T08:22:58Z","author_association":"CONTRIBUTOR","body":"You're welcome! With the forces it works pretty much like with the energies: you just have to provide their key in the ase db to the `properties` of `AtomsData` to load them. Of course, you have to change the loss. You can see an example in the MD17 script:\r\nhttps://github.com/atomistic-machine-learning/schnetpack/blob/master/src/scripts/schnetpack_md17.py\r\n\r\nWe're currently working on some easier to use scripts and improved documentation with tutorials how to get from your own data to running an MD with schnetpack, so stay tuned!","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/471901321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/474086076","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/61#issuecomment-474086076","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/61","id":474086076,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDA4NjA3Ng==","user":{"login":"lmj1029123","id":34913961,"node_id":"MDQ6VXNlcjM0OTEzOTYx","avatar_url":"https://avatars.githubusercontent.com/u/34913961?v=4","gravatar_id":"","url":"https://api.github.com/users/lmj1029123","html_url":"https://github.com/lmj1029123","followers_url":"https://api.github.com/users/lmj1029123/followers","following_url":"https://api.github.com/users/lmj1029123/following{/other_user}","gists_url":"https://api.github.com/users/lmj1029123/gists{/gist_id}","starred_url":"https://api.github.com/users/lmj1029123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lmj1029123/subscriptions","organizations_url":"https://api.github.com/users/lmj1029123/orgs","repos_url":"https://api.github.com/users/lmj1029123/repos","events_url":"https://api.github.com/users/lmj1029123/events{/privacy}","received_events_url":"https://api.github.com/users/lmj1029123/received_events","type":"User","site_admin":false},"created_at":"2019-03-18T20:23:43Z","updated_at":"2019-03-18T20:23:43Z","author_association":"CONTRIBUTOR","body":"Thanks!\r\n\r\nCurrently, I am trying to get the training loss as a function of the epoch. I understand that I will need to use the hook. However, I am not exactly sure how I should use it. \r\n\r\n```import sys\r\nsys.path.insert(0, '~/schnetpack/')\r\nfrom schnetpack.data import AtomsData\r\nimport torch\r\nimport torch.nn.functional as F\r\nfrom torch.optim import Adam\r\nimport pickle \r\nimport schnetpack as spk\r\nimport schnetpack.atomistic as atm\r\nimport schnetpack.representation as rep\r\nfrom schnetpack.datasets import *\r\nimport schnetpack.evaluation as eva\r\nfrom schnetpack.metrics import MeanSquaredError\r\n\r\nName = 'acsf_force_2'  # (ref:Name)\r\nif not os.path.exists(Name):\r\n    os.makedirs(Name)\r\n\r\ndata = AtomsData('./db/Icosahedron-2-large-unique-50-test.db', required_properties=['energy','forces'],collect_triples=True)\r\n\r\n#40 training data, 5 val data, rest are for test\r\ntrain, val, test = data.create_splits(40, 5)\r\ntrain_loader = spk.data.AtomsLoader(train, batch_size=10, num_workers=0)\r\nval_loader = spk.data.AtomsLoader(val)\r\ntest_loader = spk.data.AtomsLoader(test)\r\nloader = [train_loader, val_loader, test_loader]\r\npickle.dump(loader, open('./'+Name+'/loader.sav','wb'))\r\n\r\nreps = rep.BehlerSFBlock(n_radial=4, n_angular=3,elements=frozenset([46,79]), cutoff_radius=6.0, mode = 'Behler')\r\n#print(reps.n_symfuncs)\r\noutput = atm.ElementalEnergy(n_in=reps.n_symfuncs,n_layers=3,n_hidden=10, elements=frozenset([46,79]),return_force=True,create_graph=True)\r\nmodel = atm.AtomisticModel(reps, output)\r\n\r\ntrainable_params = filter(lambda p: p.requires_grad, model.parameters())\r\n\r\nmetric_E = [MeanSquaredError(target = 'energy')]\r\nhook_E = spk.train.CSVHook(\"./\"+Name+\"/E_loss.csv\", metric_E)\r\n\r\nopt = Adam(trainable_params, lr=1e-3)\r\n\r\nloss = lambda b, p: F.mse_loss(p[\"y\"], b['energy'])+F.mse_loss(p[\"dydx\"], b['forces'])\r\ntrainer = spk.train.Trainer(Name+\"/\", model, loss,\r\n                      opt, train_loader, val_loader,hooks = [hook_E])\r\n\r\n# start training\r\ntrainer.train(torch.device(\"cpu\"))\r\n···\r\nIt is giving me errors now, and I am pretty sure the problem is in the way that I define metric_E and hook_E but I am not sure how to do it. Could you have a look at it? Thank you very much!","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/474086076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lmj1029123","id":34913961,"node_id":"MDQ6VXNlcjM0OTEzOTYx","avatar_url":"https://avatars.githubusercontent.com/u/34913961?v=4","gravatar_id":"","url":"https://api.github.com/users/lmj1029123","html_url":"https://github.com/lmj1029123","followers_url":"https://api.github.com/users/lmj1029123/followers","following_url":"https://api.github.com/users/lmj1029123/following{/other_user}","gists_url":"https://api.github.com/users/lmj1029123/gists{/gist_id}","starred_url":"https://api.github.com/users/lmj1029123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lmj1029123/subscriptions","organizations_url":"https://api.github.com/users/lmj1029123/orgs","repos_url":"https://api.github.com/users/lmj1029123/repos","events_url":"https://api.github.com/users/lmj1029123/events{/privacy}","received_events_url":"https://api.github.com/users/lmj1029123/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/474088634","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/61#issuecomment-474088634","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/61","id":474088634,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDA4ODYzNA==","user":{"login":"lmj1029123","id":34913961,"node_id":"MDQ6VXNlcjM0OTEzOTYx","avatar_url":"https://avatars.githubusercontent.com/u/34913961?v=4","gravatar_id":"","url":"https://api.github.com/users/lmj1029123","html_url":"https://github.com/lmj1029123","followers_url":"https://api.github.com/users/lmj1029123/followers","following_url":"https://api.github.com/users/lmj1029123/following{/other_user}","gists_url":"https://api.github.com/users/lmj1029123/gists{/gist_id}","starred_url":"https://api.github.com/users/lmj1029123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lmj1029123/subscriptions","organizations_url":"https://api.github.com/users/lmj1029123/orgs","repos_url":"https://api.github.com/users/lmj1029123/repos","events_url":"https://api.github.com/users/lmj1029123/events{/privacy}","received_events_url":"https://api.github.com/users/lmj1029123/received_events","type":"User","site_admin":false},"created_at":"2019-03-18T20:30:51Z","updated_at":"2019-03-18T20:30:51Z","author_association":"CONTRIBUTOR","body":"It does generate the csv file but it gives me the following error:\r\n```\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-53-08a45639795b> in <module>()\r\n      6 \r\n      7 # start training\r\n----> 8 trainer.train(torch.device(\"cpu\"))\r\n\r\n~\\Anaconda3\\lib\\site-packages\\schnetpack-0.2.1-py3.6.egg\\schnetpack\\train\\trainer.py in train(self, device)\r\n    236                 h.on_train_failed(self)\r\n    237 \r\n--> 238             raise e\r\n\r\n~\\Anaconda3\\lib\\site-packages\\schnetpack-0.2.1-py3.6.egg\\schnetpack\\train\\trainer.py in train(self, device)\r\n    210                         for h in self.hooks:\r\n    211                             h.on_validation_batch_end(self, val_batch,\r\n--> 212                                                       val_result)\r\n    213 \r\n    214                     # weighted average over batches\r\n\r\n~\\Anaconda3\\lib\\site-packages\\schnetpack-0.2.1-py3.6.egg\\schnetpack\\train\\hooks.py in on_validation_batch_end(self, trainer, val_batch, val_result)\r\n    104     def on_validation_batch_end(self, trainer, val_batch, val_result):\r\n    105         for metric in self.metrics:\r\n--> 106             metric.add_batch(val_batch, val_result)\r\n    107 \r\n    108 \r\n\r\n~\\Anaconda3\\lib\\site-packages\\schnetpack-0.2.1-py3.6.egg\\schnetpack\\metrics.py in add_batch(self, batch, result)\r\n    146             yp = result\r\n    147 \r\n--> 148         diff = self._get_diff(y, yp)\r\n    149         self.l2loss += torch.sum(\r\n    150             diff.view(-1) ** 2).detach().cpu().data.numpy()\r\n\r\n~\\Anaconda3\\lib\\site-packages\\schnetpack-0.2.1-py3.6.egg\\schnetpack\\metrics.py in _get_diff(self, y, yp)\r\n    129 \r\n    130     def _get_diff(self, y, yp):\r\n--> 131         diff = y - yp\r\n    132         if self.bias_correction is not None:\r\n    133             diff += self.bias_correction\r\n\r\nTypeError: sub(): argument 'other' (position 1) must be Tensor, not dict\r\n:end:\r\n```","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/474088634/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lmj1029123","id":34913961,"node_id":"MDQ6VXNlcjM0OTEzOTYx","avatar_url":"https://avatars.githubusercontent.com/u/34913961?v=4","gravatar_id":"","url":"https://api.github.com/users/lmj1029123","html_url":"https://github.com/lmj1029123","followers_url":"https://api.github.com/users/lmj1029123/followers","following_url":"https://api.github.com/users/lmj1029123/following{/other_user}","gists_url":"https://api.github.com/users/lmj1029123/gists{/gist_id}","starred_url":"https://api.github.com/users/lmj1029123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lmj1029123/subscriptions","organizations_url":"https://api.github.com/users/lmj1029123/orgs","repos_url":"https://api.github.com/users/lmj1029123/repos","events_url":"https://api.github.com/users/lmj1029123/events{/privacy}","received_events_url":"https://api.github.com/users/lmj1029123/received_events","type":"User","site_admin":false}},{"id":2212646904,"node_id":"MDEzOlJlb3BlbmVkRXZlbnQyMjEyNjQ2OTA0","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2212646904","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"event":"reopened","commit_id":null,"commit_url":null,"created_at":"2019-03-19T07:42:13Z","state_reason":null,"performed_via_github_app":null},{"id":2212649183,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQyMjEyNjQ5MTgz","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2212649183","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2019-03-19T07:43:26Z","assignee":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/474231677","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/61#issuecomment-474231677","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/61","id":474231677,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDIzMTY3Nw==","user":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"created_at":"2019-03-19T07:43:55Z","updated_at":"2019-03-19T07:43:55Z","author_association":"CONTRIBUTOR","body":"@Stefaanhess Could you have a look?","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/474231677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false}},{"id":2212650097,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjIxMjY1MDA5Nw==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2212650097","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-03-19T07:43:56Z","performed_via_github_app":null},{"id":2212650099,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyMTI2NTAwOTk=","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2212650099","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-03-19T07:43:56Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/474265902","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/61#issuecomment-474265902","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/61","id":474265902,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDI2NTkwMg==","user":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"created_at":"2019-03-19T09:32:40Z","updated_at":"2019-03-19T09:32:40Z","author_association":"COLLABORATOR","body":"Yes, I will look at it today.","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/474265902/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/474330844","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/61#issuecomment-474330844","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/61","id":474330844,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDMzMDg0NA==","user":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"created_at":"2019-03-19T11:52:34Z","updated_at":"2019-03-19T11:52:34Z","author_association":"COLLABORATOR","body":"@lmj1029123 You would need to define your model_output for the metric so it can map the model output to the right target property.\r\nThis worked for me:\r\n`metric_E = [MeanSquaredError(target='total_energy', model_output='y')]`","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/474330844/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false}},{"id":2213301339,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjIxMzMwMTMzOQ==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2213301339","actor":{"login":"lmj1029123","id":34913961,"node_id":"MDQ6VXNlcjM0OTEzOTYx","avatar_url":"https://avatars.githubusercontent.com/u/34913961?v=4","gravatar_id":"","url":"https://api.github.com/users/lmj1029123","html_url":"https://github.com/lmj1029123","followers_url":"https://api.github.com/users/lmj1029123/followers","following_url":"https://api.github.com/users/lmj1029123/following{/other_user}","gists_url":"https://api.github.com/users/lmj1029123/gists{/gist_id}","starred_url":"https://api.github.com/users/lmj1029123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lmj1029123/subscriptions","organizations_url":"https://api.github.com/users/lmj1029123/orgs","repos_url":"https://api.github.com/users/lmj1029123/repos","events_url":"https://api.github.com/users/lmj1029123/events{/privacy}","received_events_url":"https://api.github.com/users/lmj1029123/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-03-19T11:52:34Z","performed_via_github_app":null},{"id":2213301341,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyMTMzMDEzNDE=","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2213301341","actor":{"login":"lmj1029123","id":34913961,"node_id":"MDQ6VXNlcjM0OTEzOTYx","avatar_url":"https://avatars.githubusercontent.com/u/34913961?v=4","gravatar_id":"","url":"https://api.github.com/users/lmj1029123","html_url":"https://github.com/lmj1029123","followers_url":"https://api.github.com/users/lmj1029123/followers","following_url":"https://api.github.com/users/lmj1029123/following{/other_user}","gists_url":"https://api.github.com/users/lmj1029123/gists{/gist_id}","starred_url":"https://api.github.com/users/lmj1029123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lmj1029123/subscriptions","organizations_url":"https://api.github.com/users/lmj1029123/orgs","repos_url":"https://api.github.com/users/lmj1029123/repos","events_url":"https://api.github.com/users/lmj1029123/events{/privacy}","received_events_url":"https://api.github.com/users/lmj1029123/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-03-19T11:52:34Z","performed_via_github_app":null},{"id":2213375304,"node_id":"MDExOkNsb3NlZEV2ZW50MjIxMzM3NTMwNA==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2213375304","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-03-19T12:23:11Z","state_reason":null,"performed_via_github_app":null}]