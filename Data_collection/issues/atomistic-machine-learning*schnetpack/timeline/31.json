[{"id":2059455129,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQyMDU5NDU1MTI5","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2059455129","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2019-01-08T07:42:18Z","assignee":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"id":2059455352,"node_id":"MDE1OlVuYXNzaWduZWRFdmVudDIwNTk0NTUzNTI=","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2059455352","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"event":"unassigned","commit_id":null,"commit_url":null,"created_at":"2019-01-08T07:42:29Z","assignee":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"id":2059455357,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQyMDU5NDU1MzU3","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2059455357","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2019-01-08T07:42:29Z","assignee":{"login":"mgastegger","id":36198330,"node_id":"MDQ6VXNlcjM2MTk4MzMw","avatar_url":"https://avatars.githubusercontent.com/u/36198330?v=4","gravatar_id":"","url":"https://api.github.com/users/mgastegger","html_url":"https://github.com/mgastegger","followers_url":"https://api.github.com/users/mgastegger/followers","following_url":"https://api.github.com/users/mgastegger/following{/other_user}","gists_url":"https://api.github.com/users/mgastegger/gists{/gist_id}","starred_url":"https://api.github.com/users/mgastegger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgastegger/subscriptions","organizations_url":"https://api.github.com/users/mgastegger/orgs","repos_url":"https://api.github.com/users/mgastegger/repos","events_url":"https://api.github.com/users/mgastegger/events{/privacy}","received_events_url":"https://api.github.com/users/mgastegger/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/452265447","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/31#issuecomment-452265447","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/31","id":452265447,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjI2NTQ0Nw==","user":{"login":"mgastegger","id":36198330,"node_id":"MDQ6VXNlcjM2MTk4MzMw","avatar_url":"https://avatars.githubusercontent.com/u/36198330?v=4","gravatar_id":"","url":"https://api.github.com/users/mgastegger","html_url":"https://github.com/mgastegger","followers_url":"https://api.github.com/users/mgastegger/followers","following_url":"https://api.github.com/users/mgastegger/following{/other_user}","gists_url":"https://api.github.com/users/mgastegger/gists{/gist_id}","starred_url":"https://api.github.com/users/mgastegger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgastegger/subscriptions","organizations_url":"https://api.github.com/users/mgastegger/orgs","repos_url":"https://api.github.com/users/mgastegger/repos","events_url":"https://api.github.com/users/mgastegger/events{/privacy}","received_events_url":"https://api.github.com/users/mgastegger/received_events","type":"User","site_admin":false},"created_at":"2019-01-08T11:25:15Z","updated_at":"2019-01-08T11:25:15Z","author_association":"COLLABORATOR","body":"We are glad you like our library!\r\n\r\nWith regards to your issue, I tested the standard implementations of schnet and the Behler type models and don't encounter any problems during loading.\r\n\r\nOne reason for the issue might be, that there are parameter groups (e.g. layers) present in the trained model, but not accounted for in the model definitions in `md.py` (lines 357 to 373). This would explain, why using `strict=False` works as a fix, since it ignores non-matching state dict entries.\r\n\r\nAre you using the standard schnetpack architectures?","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/452265447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mgastegger","id":36198330,"node_id":"MDQ6VXNlcjM2MTk4MzMw","avatar_url":"https://avatars.githubusercontent.com/u/36198330?v=4","gravatar_id":"","url":"https://api.github.com/users/mgastegger","html_url":"https://github.com/mgastegger","followers_url":"https://api.github.com/users/mgastegger/followers","following_url":"https://api.github.com/users/mgastegger/following{/other_user}","gists_url":"https://api.github.com/users/mgastegger/gists{/gist_id}","starred_url":"https://api.github.com/users/mgastegger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgastegger/subscriptions","organizations_url":"https://api.github.com/users/mgastegger/orgs","repos_url":"https://api.github.com/users/mgastegger/repos","events_url":"https://api.github.com/users/mgastegger/events{/privacy}","received_events_url":"https://api.github.com/users/mgastegger/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/452395998","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/31#issuecomment-452395998","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/31","id":452395998,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjM5NTk5OA==","user":{"login":"Sangwon91","id":20216145,"node_id":"MDQ6VXNlcjIwMjE2MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/20216145?v=4","gravatar_id":"","url":"https://api.github.com/users/Sangwon91","html_url":"https://github.com/Sangwon91","followers_url":"https://api.github.com/users/Sangwon91/followers","following_url":"https://api.github.com/users/Sangwon91/following{/other_user}","gists_url":"https://api.github.com/users/Sangwon91/gists{/gist_id}","starred_url":"https://api.github.com/users/Sangwon91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sangwon91/subscriptions","organizations_url":"https://api.github.com/users/Sangwon91/orgs","repos_url":"https://api.github.com/users/Sangwon91/repos","events_url":"https://api.github.com/users/Sangwon91/events{/privacy}","received_events_url":"https://api.github.com/users/Sangwon91/received_events","type":"User","site_admin":false},"created_at":"2019-01-08T18:08:01Z","updated_at":"2019-01-08T18:08:01Z","author_association":"NONE","body":"Thank you for the response.\r\n\r\nActually, it was a simple test.\r\n\r\nOn `workdir`, I trained `schnet` using the following command\r\n`CUDA_VISIBLE_DEVICES=1,python schnetpack_qm9.py train schnet qm9.db schnet-qm9-100k --split 100000 10000 --cuda`\r\n\r\nAnd I ran simple molecular dynamics simulation using the following code at same directory,\r\n```python\r\n# Load learned model.\r\nmodel = md.load_model(modelpath=\"schnet-qm9-100k/\") # Error occurs here.\r\n\r\nsystem = \"CO2s\"\r\n\r\nml_calculator = md.AseInterface(\r\n    molecule_path=\"simulation/{}.xyz\".format(system),\r\n    ml_model=model,\r\n    working_dir=\"simulation\"\r\n)\r\n\r\nml_calculator.init_md(name=\"{}-md\".format(system))\r\nml_calculator.run_md(steps=1000)\r\n\r\ntraj_to_xyz(\"simulation/{}-md.traj\".format(system))\r\n```\r\n\r\n(CO2s.xyz just an arbitrary xyz file)\r\nAre there any problems?\r\n\r\nThanks!\r\n\r\n","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/452395998/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Sangwon91","id":20216145,"node_id":"MDQ6VXNlcjIwMjE2MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/20216145?v=4","gravatar_id":"","url":"https://api.github.com/users/Sangwon91","html_url":"https://github.com/Sangwon91","followers_url":"https://api.github.com/users/Sangwon91/followers","following_url":"https://api.github.com/users/Sangwon91/following{/other_user}","gists_url":"https://api.github.com/users/Sangwon91/gists{/gist_id}","starred_url":"https://api.github.com/users/Sangwon91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sangwon91/subscriptions","organizations_url":"https://api.github.com/users/Sangwon91/orgs","repos_url":"https://api.github.com/users/Sangwon91/repos","events_url":"https://api.github.com/users/Sangwon91/events{/privacy}","received_events_url":"https://api.github.com/users/Sangwon91/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/452643134","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/31#issuecomment-452643134","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/31","id":452643134,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjY0MzEzNA==","user":{"login":"mgastegger","id":36198330,"node_id":"MDQ6VXNlcjM2MTk4MzMw","avatar_url":"https://avatars.githubusercontent.com/u/36198330?v=4","gravatar_id":"","url":"https://api.github.com/users/mgastegger","html_url":"https://github.com/mgastegger","followers_url":"https://api.github.com/users/mgastegger/followers","following_url":"https://api.github.com/users/mgastegger/following{/other_user}","gists_url":"https://api.github.com/users/mgastegger/gists{/gist_id}","starred_url":"https://api.github.com/users/mgastegger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgastegger/subscriptions","organizations_url":"https://api.github.com/users/mgastegger/orgs","repos_url":"https://api.github.com/users/mgastegger/repos","events_url":"https://api.github.com/users/mgastegger/events{/privacy}","received_events_url":"https://api.github.com/users/mgastegger/received_events","type":"User","site_admin":false},"created_at":"2019-01-09T10:12:59Z","updated_at":"2019-01-09T10:12:59Z","author_association":"COLLABORATOR","body":"I tried your example and it seems to work for me.\r\n\r\nAnother reason for the issue might be that we made a change in the package after you started training and before running the dynamics.\r\n\r\nDid you update schnetpack between training the model and the dynamics? And what does the error message say?","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/452643134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mgastegger","id":36198330,"node_id":"MDQ6VXNlcjM2MTk4MzMw","avatar_url":"https://avatars.githubusercontent.com/u/36198330?v=4","gravatar_id":"","url":"https://api.github.com/users/mgastegger","html_url":"https://github.com/mgastegger","followers_url":"https://api.github.com/users/mgastegger/followers","following_url":"https://api.github.com/users/mgastegger/following{/other_user}","gists_url":"https://api.github.com/users/mgastegger/gists{/gist_id}","starred_url":"https://api.github.com/users/mgastegger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgastegger/subscriptions","organizations_url":"https://api.github.com/users/mgastegger/orgs","repos_url":"https://api.github.com/users/mgastegger/repos","events_url":"https://api.github.com/users/mgastegger/events{/privacy}","received_events_url":"https://api.github.com/users/mgastegger/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/452930524","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/31#issuecomment-452930524","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/31","id":452930524,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjkzMDUyNA==","user":{"login":"Sangwon91","id":20216145,"node_id":"MDQ6VXNlcjIwMjE2MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/20216145?v=4","gravatar_id":"","url":"https://api.github.com/users/Sangwon91","html_url":"https://github.com/Sangwon91","followers_url":"https://api.github.com/users/Sangwon91/followers","following_url":"https://api.github.com/users/Sangwon91/following{/other_user}","gists_url":"https://api.github.com/users/Sangwon91/gists{/gist_id}","starred_url":"https://api.github.com/users/Sangwon91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sangwon91/subscriptions","organizations_url":"https://api.github.com/users/Sangwon91/orgs","repos_url":"https://api.github.com/users/Sangwon91/repos","events_url":"https://api.github.com/users/Sangwon91/events{/privacy}","received_events_url":"https://api.github.com/users/Sangwon91/received_events","type":"User","site_admin":false},"created_at":"2019-01-10T00:59:56Z","updated_at":"2019-01-10T00:59:56Z","author_association":"NONE","body":"I'm not sure about the version issue. But I think I didn't update anything during training and MD run. \r\nIn my system, SchNetPack is installed via pip on conda environment.\r\n\r\nThe error message is\r\n```\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-7-6b9db153d1ba> in <module>()\r\n      1 # Load learned model.\r\n----> 2 model = md.load_model(modelpath=\"schnet-qm9-100k/\")\r\n      3 \r\n      4 system = \"CO2s\"\r\n      5 \r\n\r\n~/anaconda3/envs/schnetpack/lib/python3.5/site-packages/schnetpack/md.py in load_model(modelpath, cuda)\r\n    375 \r\n    376     # Load old parameters\r\n--> 377     model.load_state_dict(torch.load(os.path.join(modelpath, 'best_model')))\r\n    378 \r\n    379     # Set cuda if requested\r\n\r\n~/anaconda3/envs/schnetpack/lib/python3.5/site-packages/torch/nn/modules/module.py in load_state_dict(self, state_dict, strict)\r\n    767         if len(error_msgs) > 0:\r\n    768             raise RuntimeError('Error(s) in loading state_dict for {}:\\n\\t{}'.format(\r\n--> 769                                self.__class__.__name__, \"\\n\\t\".join(error_msgs)))\r\n    770 \r\n    771     def _named_members(self, get_members_fn, prefix='', recurse=True):\r\n\r\nRuntimeError: Error(s) in loading state_dict for AtomisticModel:\r\n\tUnexpected key(s) in state_dict: \"output_modules.atomref.weight\". \r\n```\r\n","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/452930524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Sangwon91","id":20216145,"node_id":"MDQ6VXNlcjIwMjE2MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/20216145?v=4","gravatar_id":"","url":"https://api.github.com/users/Sangwon91","html_url":"https://github.com/Sangwon91","followers_url":"https://api.github.com/users/Sangwon91/followers","following_url":"https://api.github.com/users/Sangwon91/following{/other_user}","gists_url":"https://api.github.com/users/Sangwon91/gists{/gist_id}","starred_url":"https://api.github.com/users/Sangwon91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sangwon91/subscriptions","organizations_url":"https://api.github.com/users/Sangwon91/orgs","repos_url":"https://api.github.com/users/Sangwon91/repos","events_url":"https://api.github.com/users/Sangwon91/events{/privacy}","received_events_url":"https://api.github.com/users/Sangwon91/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/453044697","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/31#issuecomment-453044697","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/31","id":453044697,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA0NDY5Nw==","user":{"login":"mgastegger","id":36198330,"node_id":"MDQ6VXNlcjM2MTk4MzMw","avatar_url":"https://avatars.githubusercontent.com/u/36198330?v=4","gravatar_id":"","url":"https://api.github.com/users/mgastegger","html_url":"https://github.com/mgastegger","followers_url":"https://api.github.com/users/mgastegger/followers","following_url":"https://api.github.com/users/mgastegger/following{/other_user}","gists_url":"https://api.github.com/users/mgastegger/gists{/gist_id}","starred_url":"https://api.github.com/users/mgastegger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgastegger/subscriptions","organizations_url":"https://api.github.com/users/mgastegger/orgs","repos_url":"https://api.github.com/users/mgastegger/repos","events_url":"https://api.github.com/users/mgastegger/events{/privacy}","received_events_url":"https://api.github.com/users/mgastegger/received_events","type":"User","site_admin":false},"created_at":"2019-01-10T10:21:22Z","updated_at":"2019-01-10T10:21:22Z","author_association":"COLLABORATOR","body":"Ah, I see where the problem is. For QM9, the free atom energies are subtracted from the total energies, which leads to an additional weight tensor in the state dict. Since we only intended the MD17 trained models (where atomrefs are not subtracted) to be used with the MD script, this tensor is missing in the generated model leading to the error.\r\n\r\nI will check, how I can fix this.","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/453044697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mgastegger","id":36198330,"node_id":"MDQ6VXNlcjM2MTk4MzMw","avatar_url":"https://avatars.githubusercontent.com/u/36198330?v=4","gravatar_id":"","url":"https://api.github.com/users/mgastegger","html_url":"https://github.com/mgastegger","followers_url":"https://api.github.com/users/mgastegger/followers","following_url":"https://api.github.com/users/mgastegger/following{/other_user}","gists_url":"https://api.github.com/users/mgastegger/gists{/gist_id}","starred_url":"https://api.github.com/users/mgastegger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgastegger/subscriptions","organizations_url":"https://api.github.com/users/mgastegger/orgs","repos_url":"https://api.github.com/users/mgastegger/repos","events_url":"https://api.github.com/users/mgastegger/events{/privacy}","received_events_url":"https://api.github.com/users/mgastegger/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/455973753","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/31#issuecomment-455973753","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/31","id":455973753,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NTk3Mzc1Mw==","user":{"login":"Sangwon91","id":20216145,"node_id":"MDQ6VXNlcjIwMjE2MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/20216145?v=4","gravatar_id":"","url":"https://api.github.com/users/Sangwon91","html_url":"https://github.com/Sangwon91","followers_url":"https://api.github.com/users/Sangwon91/followers","following_url":"https://api.github.com/users/Sangwon91/following{/other_user}","gists_url":"https://api.github.com/users/Sangwon91/gists{/gist_id}","starred_url":"https://api.github.com/users/Sangwon91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sangwon91/subscriptions","organizations_url":"https://api.github.com/users/Sangwon91/orgs","repos_url":"https://api.github.com/users/Sangwon91/repos","events_url":"https://api.github.com/users/Sangwon91/events{/privacy}","received_events_url":"https://api.github.com/users/Sangwon91/received_events","type":"User","site_admin":false},"created_at":"2019-01-21T07:31:50Z","updated_at":"2019-01-21T07:31:50Z","author_association":"NONE","body":"Can `nn.Module.register_buffer()` resolve the problem?\r\nThe registered buffers are included in `nn.Module.state_dict()`.\r\n(batch normalization uses `nn.Module.register_buffer()` for `moving_mean` and `moving_var`.)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/455973753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Sangwon91","id":20216145,"node_id":"MDQ6VXNlcjIwMjE2MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/20216145?v=4","gravatar_id":"","url":"https://api.github.com/users/Sangwon91","html_url":"https://github.com/Sangwon91","followers_url":"https://api.github.com/users/Sangwon91/followers","following_url":"https://api.github.com/users/Sangwon91/following{/other_user}","gists_url":"https://api.github.com/users/Sangwon91/gists{/gist_id}","starred_url":"https://api.github.com/users/Sangwon91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sangwon91/subscriptions","organizations_url":"https://api.github.com/users/Sangwon91/orgs","repos_url":"https://api.github.com/users/Sangwon91/repos","events_url":"https://api.github.com/users/Sangwon91/events{/privacy}","received_events_url":"https://api.github.com/users/Sangwon91/received_events","type":"User","site_admin":false}},{"actor":{"login":"mgastegger","id":36198330,"node_id":"MDQ6VXNlcjM2MTk4MzMw","avatar_url":"https://avatars.githubusercontent.com/u/36198330?v=4","gravatar_id":"","url":"https://api.github.com/users/mgastegger","html_url":"https://github.com/mgastegger","followers_url":"https://api.github.com/users/mgastegger/followers","following_url":"https://api.github.com/users/mgastegger/following{/other_user}","gists_url":"https://api.github.com/users/mgastegger/gists{/gist_id}","starred_url":"https://api.github.com/users/mgastegger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgastegger/subscriptions","organizations_url":"https://api.github.com/users/mgastegger/orgs","repos_url":"https://api.github.com/users/mgastegger/repos","events_url":"https://api.github.com/users/mgastegger/events{/privacy}","received_events_url":"https://api.github.com/users/mgastegger/received_events","type":"User","site_admin":false},"created_at":"2019-01-21T09:43:38Z","updated_at":"2019-01-21T09:43:38Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/41","repository_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack","labels_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/41/labels{/name}","comments_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/41/comments","events_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/41/events","html_url":"https://github.com/atomistic-machine-learning/schnetpack/pull/41","id":401268448,"node_id":"MDExOlB1bGxSZXF1ZXN0MjQ2MjI3MTY3","number":41,"title":"Md model loading","user":{"login":"mgastegger","id":36198330,"node_id":"MDQ6VXNlcjM2MTk4MzMw","avatar_url":"https://avatars.githubusercontent.com/u/36198330?v=4","gravatar_id":"","url":"https://api.github.com/users/mgastegger","html_url":"https://github.com/mgastegger","followers_url":"https://api.github.com/users/mgastegger/followers","following_url":"https://api.github.com/users/mgastegger/following{/other_user}","gists_url":"https://api.github.com/users/mgastegger/gists{/gist_id}","starred_url":"https://api.github.com/users/mgastegger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgastegger/subscriptions","organizations_url":"https://api.github.com/users/mgastegger/orgs","repos_url":"https://api.github.com/users/mgastegger/repos","events_url":"https://api.github.com/users/mgastegger/events{/privacy}","received_events_url":"https://api.github.com/users/mgastegger/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-01-21T09:43:38Z","updated_at":"2019-01-21T09:47:53Z","closed_at":"2019-01-21T09:47:49Z","author_association":"COLLABORATOR","active_lock_reason":null,"draft":false,"repository":{"id":147224878,"node_id":"MDEwOlJlcG9zaXRvcnkxNDcyMjQ4Nzg=","name":"schnetpack","full_name":"atomistic-machine-learning/schnetpack","private":false,"owner":{"login":"atomistic-machine-learning","id":26488588,"node_id":"MDEyOk9yZ2FuaXphdGlvbjI2NDg4NTg4","avatar_url":"https://avatars.githubusercontent.com/u/26488588?v=4","gravatar_id":"","url":"https://api.github.com/users/atomistic-machine-learning","html_url":"https://github.com/atomistic-machine-learning","followers_url":"https://api.github.com/users/atomistic-machine-learning/followers","following_url":"https://api.github.com/users/atomistic-machine-learning/following{/other_user}","gists_url":"https://api.github.com/users/atomistic-machine-learning/gists{/gist_id}","starred_url":"https://api.github.com/users/atomistic-machine-learning/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atomistic-machine-learning/subscriptions","organizations_url":"https://api.github.com/users/atomistic-machine-learning/orgs","repos_url":"https://api.github.com/users/atomistic-machine-learning/repos","events_url":"https://api.github.com/users/atomistic-machine-learning/events{/privacy}","received_events_url":"https://api.github.com/users/atomistic-machine-learning/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/atomistic-machine-learning/schnetpack","description":"SchNetPack - Deep Neural Networks for Atomistic Systems","fork":false,"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack","forks_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/forks","keys_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/keys{/key_id}","collaborators_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/teams","hooks_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/hooks","issue_events_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events{/number}","events_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/events","assignees_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/assignees{/user}","branches_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/branches{/branch}","tags_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/tags","blobs_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/git/refs{/sha}","trees_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/git/trees{/sha}","statuses_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/statuses/{sha}","languages_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/languages","stargazers_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/stargazers","contributors_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/contributors","subscribers_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/subscribers","subscription_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/subscription","commits_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/commits{/sha}","git_commits_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/git/commits{/sha}","comments_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/comments{/number}","issue_comment_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments{/number}","contents_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/contents/{+path}","compare_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/compare/{base}...{head}","merges_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/merges","archive_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/downloads","issues_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues{/number}","pulls_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/pulls{/number}","milestones_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/milestones{/number}","notifications_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/labels{/name}","releases_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/releases{/id}","deployments_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/deployments","created_at":"2018-09-03T15:44:35Z","updated_at":"2023-01-19T06:30:46Z","pushed_at":"2023-01-11T14:21:06Z","git_url":"git://github.com/atomistic-machine-learning/schnetpack.git","ssh_url":"git@github.com:atomistic-machine-learning/schnetpack.git","clone_url":"https://github.com/atomistic-machine-learning/schnetpack.git","svn_url":"https://github.com/atomistic-machine-learning/schnetpack","homepage":null,"size":33470,"stargazers_count":557,"watchers_count":557,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":167,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["condensed-matter","machine-learning","molecular-dynamics","neural-network","quantum-chemistry"],"visibility":"public","forks":167,"open_issues":2,"watchers":557,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/pulls/41","html_url":"https://github.com/atomistic-machine-learning/schnetpack/pull/41","diff_url":"https://github.com/atomistic-machine-learning/schnetpack/pull/41.diff","patch_url":"https://github.com/atomistic-machine-learning/schnetpack/pull/41.patch","merged_at":"2019-01-21T09:47:49Z"},"body":"Changed model loading behavior as discussed in issue #31.","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/41/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/41/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/456009553","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/31#issuecomment-456009553","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/31","id":456009553,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NjAwOTU1Mw==","user":{"login":"mgastegger","id":36198330,"node_id":"MDQ6VXNlcjM2MTk4MzMw","avatar_url":"https://avatars.githubusercontent.com/u/36198330?v=4","gravatar_id":"","url":"https://api.github.com/users/mgastegger","html_url":"https://github.com/mgastegger","followers_url":"https://api.github.com/users/mgastegger/followers","following_url":"https://api.github.com/users/mgastegger/following{/other_user}","gists_url":"https://api.github.com/users/mgastegger/gists{/gist_id}","starred_url":"https://api.github.com/users/mgastegger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgastegger/subscriptions","organizations_url":"https://api.github.com/users/mgastegger/orgs","repos_url":"https://api.github.com/users/mgastegger/repos","events_url":"https://api.github.com/users/mgastegger/events{/privacy}","received_events_url":"https://api.github.com/users/mgastegger/received_events","type":"User","site_admin":false},"created_at":"2019-01-21T09:43:53Z","updated_at":"2019-01-21T09:43:53Z","author_association":"COLLABORATOR","body":"Hi, sorry this took so long.\r\n\r\nThe general problem was that QM9 was never intended to be used for running molecular dynamics, since no forces are present for training. Hence, as I said above, the atomref tensor was missing from the model built in the `md` module. This would be problematic if one were e.g. to use atom reference energies for the MD17 dataset. I now changed the behavior of `load_model` to load a pickled model file which can be obtained by running the various schnetpack scripts in `export` mode after training a model. This way, `load_model` should be more resilient to changes and special architectural features in the main scripts. The function now also raises an error if loading a model not containing a dedicated energy output layer required for predicting forces, as is the case QM9.","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/456009553/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mgastegger","id":36198330,"node_id":"MDQ6VXNlcjM2MTk4MzMw","avatar_url":"https://avatars.githubusercontent.com/u/36198330?v=4","gravatar_id":"","url":"https://api.github.com/users/mgastegger","html_url":"https://github.com/mgastegger","followers_url":"https://api.github.com/users/mgastegger/followers","following_url":"https://api.github.com/users/mgastegger/following{/other_user}","gists_url":"https://api.github.com/users/mgastegger/gists{/gist_id}","starred_url":"https://api.github.com/users/mgastegger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgastegger/subscriptions","organizations_url":"https://api.github.com/users/mgastegger/orgs","repos_url":"https://api.github.com/users/mgastegger/repos","events_url":"https://api.github.com/users/mgastegger/events{/privacy}","received_events_url":"https://api.github.com/users/mgastegger/received_events","type":"User","site_admin":false}},{"id":2085897461,"node_id":"MDExOkNsb3NlZEV2ZW50MjA4NTg5NzQ2MQ==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/2085897461","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-01-21T09:48:05Z","state_reason":null,"performed_via_github_app":null}]