[{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/938701927","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/348#issuecomment-938701927","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/348","id":938701927,"node_id":"IC_kwDOCMZ5Ls4383Rn","user":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false},"created_at":"2021-10-08T14:49:09Z","updated_at":"2021-10-08T14:49:09Z","author_association":"NONE","body":"I wanted to determine if this was a problem with the diversity of the training set so I've tried to train on 665 steps of a single CASTEP geometry optimisation.\r\n\r\nSchNetPack continues to guess forces as 0 and in this case, it was also predicting that the energies are close to 0.\r\n![One_big_geom_E](https://user-images.githubusercontent.com/1126249/136577434-13b8a4db-03c4-4c50-a598-2406d6f89845.png)\r\n![One_big_geom_F](https://user-images.githubusercontent.com/1126249/136577455-90029167-6a3e-4744-971f-e2cfb6920628.png)\r\nI've attached my db file: [JDorrell_One_big_geom.zip](https://github.com/atomistic-machine-learning/schnetpack/files/7312147/JDorrell_One_big_geom.zip)\r\n\r\nMy args.json is as such:\r\n```\r\n{\r\n    \"aggregation_mode\": \"avg\",\r\n    \"batch_size\": 30,\r\n    \"checkpoint_interval\": 1,\r\n    \"contributions\": null,\r\n    \"cuda\": true,\r\n    \"cutoff\": 8.0,\r\n    \"cutoff_function\": \"cosine\",\r\n    \"datapath\": \"One_big_geom.db\",\r\n    \"dataset\": \"custom\",\r\n    \"derivative\": \"forces\",\r\n    \"environment_provider\": \"torch\",\r\n    \"features\": 128,\r\n    \"force\": null,\r\n    \"interactions\": 3,\r\n    \"keep_n_checkpoints\": 3,\r\n    \"log_every_n_epochs\": 1,\r\n    \"logger\": \"csv\",\r\n    \"lr\": 0.0001,\r\n    \"lr_decay\": 0.9,\r\n    \"lr_min\": 1e-06,\r\n    \"lr_patience\": 25,\r\n    \"max_epochs\": 5000,\r\n    \"max_steps\": null,\r\n    \"mode\": \"train\",\r\n    \"model\": \"schnet\",\r\n    \"modelpath\": \"model/\",\r\n    \"n_epochs\": 1000,\r\n    \"negative_dr\": true,\r\n    \"normalize_filter\": true,\r\n    \"num_gaussians\": 50,\r\n    \"output_module\": \"atomwise\",\r\n    \"overwrite\": false,\r\n    \"parallel\": true,\r\n    \"property\": \"formation_energy_per_atom\",\r\n    \"rho\": {},\r\n    \"seed\": null,\r\n    \"split\": [\r\n        300,\r\n        50\r\n    ],\r\n    \"split_path\": \"model/split.npz\",\r\n    \"stress\": null\r\n}\r\n```\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/938701927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/940830642","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/348#issuecomment-940830642","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/348","id":940830642,"node_id":"IC_kwDOCMZ5Ls44E--y","user":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"created_at":"2021-10-12T09:24:19Z","updated_at":"2021-10-12T09:24:19Z","author_association":"COLLABORATOR","body":"Hey @JordD04 ,\r\nI just checked your arguments and the `rho` parameter is set to `{}`. This means, that no weights for the loss function are set and I think this will ignore the forces. This might explain the strange behaviour :)","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/940830642/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false}},{"id":5448187368,"node_id":"MEE_lADOCMZ5Ls48uM5BzwAAAAFEvL3o","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/5448187368","actor":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-12T09:24:19Z","performed_via_github_app":null},{"id":5448187374,"node_id":"SE_lADOCMZ5Ls48uM5BzwAAAAFEvL3u","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/5448187374","actor":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-12T09:24:19Z","performed_via_github_app":null},{"id":5449967909,"node_id":"CE_lADOCMZ5Ls48uM5BzwAAAAFE1-kl","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/5449967909","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-10-12T14:16:04Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/943366901","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/348#issuecomment-943366901","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/348","id":943366901,"node_id":"IC_kwDOCMZ5Ls44OqL1","user":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false},"created_at":"2021-10-14T13:37:51Z","updated_at":"2021-10-14T13:41:55Z","author_association":"NONE","body":"> Hey @JordD04 , I just checked your arguments and the `rho` parameter is set to `{}`. This means, that no weights for the loss function are set and I think this will ignore the forces. This might explain the strange behaviour :)\r\n\r\nThanks for your help, Stefaan.\r\nIf force or derivative are defined in the args.json, SchNetPack defines a default value, so forces aren't ignored if the `rho` is blank. \r\nI did go back and review the code surrounding `rho` though and I realised that I misunderstood how `rho` was intended to be defined. In your 2018 and 2019 papers you only ever talk of one `rho` value, so I assumed SchNetPack just wanted a float.\r\nBy setting     \r\n```\r\n\"rho\": {\r\n        \"derivative\": 0.9,\r\n        \"property\": 0.1\r\n    },\r\n```\r\nI was able to get a more sensible plot.\r\n![MLRSS_Filtered_0_9F_rho_forces](https://user-images.githubusercontent.com/1126249/137327579-89094b4d-e677-415b-a343-8578de3bf011.png)\r\n\r\nMy errors are still large (Formation energy MAE = 0.131 eV / atom and Forces MAE = 0.220 eV/ Ã… / atom), but perhaps I just need to scale up my hyperparameters. I'm using `cutoff = 5`, `features = 128`, `interactions = 3`, and `num_gaussians = 50`. I'm not sure if that's considered a lot for a periodic system with forces, but I see that you used 6 interactions when training on just energies on MP structures.\r\n\r\nThanks for your help.\r\n","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/943366901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false}},{"id":5463912132,"node_id":"MEE_lADOCMZ5Ls48uM5BzwAAAAFFrK7E","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/5463912132","actor":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-14T13:37:52Z","performed_via_github_app":null},{"id":5463912135,"node_id":"SE_lADOCMZ5Ls48uM5BzwAAAAFFrK7H","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/5463912135","actor":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-14T13:37:52Z","performed_via_github_app":null}]