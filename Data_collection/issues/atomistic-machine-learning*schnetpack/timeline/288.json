[{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/843119678","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/288#issuecomment-843119678","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/288","id":843119678,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzExOTY3OA==","user":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"created_at":"2021-05-18T12:17:59Z","updated_at":"2021-05-18T12:17:59Z","author_association":"COLLABORATOR","body":"Hi @JordD04 ,\r\n\r\nWhat environment-provider are you using for the PBC models? In the args-file it looks like the simple environment-provider is used, but you will need to use the torch env-provider.\r\nI tried to reproduce your experiments with a database of SiO2, that I have been working with lately and the train-loss converges to very low values while the validation loss does not (as expected). Maybe you could also check if the energy values match the forces in you dataset. E.g. if you are maybe training on energy/atom and forces. This could be an issue, since the derivatives do not match then.\r\n\r\nBest, Stefaan","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/843119678/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false}},{"id":4760294041,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDc2MDI5NDA0MQ==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/4760294041","actor":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-05-18T12:17:59Z","performed_via_github_app":null},{"id":4760294051,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ3NjAyOTQwNTE=","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/4760294051","actor":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-05-18T12:17:59Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/844155731","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/288#issuecomment-844155731","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/288","id":844155731,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDE1NTczMQ==","user":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false},"created_at":"2021-05-19T14:24:14Z","updated_at":"2021-05-19T14:24:14Z","author_association":"NONE","body":"Hey Stefaan, thanks for getting back to me.\r\nI did some testing following your recommendations.\r\nSwitching to the Torch environment has allowed me to consistently get Train Loss = 0 (or very close to) for my small MatProj db but I continue to struggle with my custom dataset. \r\nUsing the same parameters as in the args.json above (but with the Torch environment, I've gotten a loss as high as 3.4.\r\nWith lr = 1E-3, I get a loss as high as 2.9, and if I step the lr_patience up to 50, I get a loss as high as 4.7. In all cases though, I got at least 1 run that converged to train loss = 0.\r\nInterestingly, I find that the MatProj dataset converges much more slowly than the custom one. The Custom set takes around 1000 seconds to converge and the MatProj set takes between 2000 and 3500 seconds. You can see it here:\r\n![Train_comparison](https://user-images.githubusercontent.com/1126249/118828733-6fd8c280-b8b5-11eb-9b94-8e1597d8b005.png)\r\nI was worried I might be setting up my database incorrectly so I exported the contents of my small MatProj db as .res files and then turned it back into a database file. I was still able to get the train loss down to 0.\r\nSo the problem almost certainly isn't related to PBCs, but there must be something going wrong.\r\n\r\nMy full dataset has energies and forces, but I've just been training only on energies for these tests.","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/844155731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/844196956","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/288#issuecomment-844196956","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/288","id":844196956,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDE5Njk1Ng==","user":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"created_at":"2021-05-19T15:07:44Z","updated_at":"2021-05-19T15:07:44Z","author_association":"COLLABORATOR","body":"Hey @JordD04 ,\r\nif you are training on energy/atom, you will also need to set `aggregation_mode=avg`. Since you are building your own database, I would check if `pbc=True` is set in the atoms objects of your database. Otherwise this will also cause problems for the neighbour selection.\r\nLet me know, if this helps to solve the issue.","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/844196956/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false}},{"id":4767435824,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDc2NzQzNTgyNA==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/4767435824","actor":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-05-19T15:07:44Z","performed_via_github_app":null},{"id":4767435828,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ3Njc0MzU4Mjg=","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/4767435828","actor":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-05-19T15:07:44Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/844202010","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/288#issuecomment-844202010","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/288","id":844202010,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDIwMjAxMA==","user":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false},"created_at":"2021-05-19T15:13:18Z","updated_at":"2021-05-19T15:13:26Z","author_association":"NONE","body":"Hey Stefaan,\r\nI definitely have pbc set to true but I haven't tried `aggregation_mode=avg` yet. Your readthedocs says \r\n> Since energy is a property that depends on the total number of atoms we select --aggregation_mode sum\r\n\r\nWhen should I be using sum and when should I be using avg?","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/844202010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/844220523","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/288#issuecomment-844220523","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/288","id":844220523,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDIyMDUyMw==","user":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"created_at":"2021-05-19T15:34:24Z","updated_at":"2021-05-19T15:34:24Z","author_association":"COLLABORATOR","body":"This depends on the definition of energy in your dataset. For molecules this is usually the total energy of the structure, which is interpreted by the model as the sum over the local energy contributions of every atom. For pbc-structures this definition is not working well since the structure is infinite. So you could either define the energy as the sum over all atoms inside the cell, or as energy per atoms. If the energy is per cell `aggregation_mode=sum` is needed, because the local energies are summed up over the cell. If the energy is per atom avg contributions of every atom are needed and you will need to set `aggregation_mode=avg`.","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/844220523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/844323761","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/288#issuecomment-844323761","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/288","id":844323761,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDMyMzc2MQ==","user":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false},"created_at":"2021-05-19T17:39:45Z","updated_at":"2021-05-19T17:39:45Z","author_association":"NONE","body":"I was training on the energy of the cell before but I've defined an energy_per_atom property, set `aggregation_mode=avg` and then trained 5 more NN. The largest loss was 0.006, so this looks quite promising. I'm going to try and train on my full dataset and see if these new parameters improve my MAE energy and loss. Thanks for your help!","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/844323761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/844773610","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/288#issuecomment-844773610","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/288","id":844773610,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDc3MzYxMA==","user":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"created_at":"2021-05-20T07:07:09Z","updated_at":"2021-05-20T07:07:09Z","author_association":"COLLABORATOR","body":"Sure, no problem! Let me know if it worked out well.","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/844773610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false}},{"id":4779454542,"node_id":"MDExOkNsb3NlZEV2ZW50NDc3OTQ1NDU0Mg==","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/events/4779454542","actor":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-05-21T13:57:37Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/846943044","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/288#issuecomment-846943044","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/288","id":846943044,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Njk0MzA0NA==","user":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false},"created_at":"2021-05-24T10:20:21Z","updated_at":"2021-05-27T11:57:30Z","author_association":"NONE","body":"Sorry for the delayed response. My cluster's GPUs are offline so I have to run everything slowly on GPUs. I ran a few tests; I got the best results from the args.json below:\r\n`{\r\n    \"aggregation_mode\": \"avg\",\r\n    \"batch_size\": 30,\r\n    \"checkpoint_interval\": 1,\r\n    \"contributions\": null,\r\n    \"cuda\": false,\r\n    \"cutoff\": 5.0,\r\n    \"cutoff_function\": \"cosine\",\r\n    \"datapath\": \"model/third_gen_few_atoms_non_zero_forces_epa.db\",\r\n    \"dataset\": \"custom\",\r\n    \"derivative\": \"forces\",\r\n    \"environment_provider\": \"torch\",\r\n    \"features\": 128,\r\n    \"force\": null,\r\n    \"interactions\": 3,\r\n    \"keep_n_checkpoints\": 3,\r\n    \"log_every_n_epochs\": 1,\r\n    \"logger\": \"csv\",\r\n    \"lr\": 0.0001,\r\n    \"lr_decay\": 0.8,\r\n    \"lr_min\": 1e-06,\r\n    \"lr_patience\": 25,\r\n    \"max_epochs\": 5000,\r\n    \"max_steps\": null,\r\n    \"mode\": \"train\",\r\n    \"model\": \"schnet\",\r\n    \"modelpath\": \"model/\",\r\n    \"n_epochs\": 1000,\r\n    \"negative_dr\": true,\r\n    \"num_gaussians\": 20,\r\n    \"output_module\": \"atomwise\",\r\n    \"overwrite\": false,\r\n    \"parallel\": true,\r\n    \"property\": \"energy_per_atom\",\r\n    \"rho\": {},\r\n    \"seed\": null,\r\n    \"split\": [\r\n        114545,\r\n        11455\r\n    ],\r\n    \"split_path\": null,\r\n    \"stress\": null\r\n}\r\n`\r\n\r\nAfter about 3 days of compute time (but still running) I've approached an energy MAE of 0.152 eV / atom, a force MAE of 0.180 eV / Å and a train loss of 0.049. Assuming that the error reported by Schnetpack is actually per atom, this is a big improvement over training on total energies with aggregation_mode sum but I think it still falls short of being an accurate model.\r\nI embed the associated graphs below:\r\n![schnet_energy_and_force](https://user-images.githubusercontent.com/1126249/119333127-6c608500-bc81-11eb-81ec-f30674552ccd.png)\r\n![schnet_loss](https://user-images.githubusercontent.com/1126249/119333138-6ff40c00-bc81-11eb-814d-2d96080ea7ab.png)\r\nYou may notice that i've picked some slightly cheaper parameters than my prior args.json, notably cutoff, interactions, and num_gaussians. I tried to train with those parameters and after 20 hours on a 20-core haswell, it still hadn't computed a single iteration. I checked my current parameters on my set of 10 structures and was still able to get an appropriately low train loss.\r\n\r\nAt this point I imagine the issue is just that my batch size, interactions, cutoff, and num_guassians is too low, so I will have to wait  until I can get access to a GPU again?","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/846943044/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"JordD04","id":1126249,"node_id":"MDQ6VXNlcjExMjYyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1126249?v=4","gravatar_id":"","url":"https://api.github.com/users/JordD04","html_url":"https://github.com/JordD04","followers_url":"https://api.github.com/users/JordD04/followers","following_url":"https://api.github.com/users/JordD04/following{/other_user}","gists_url":"https://api.github.com/users/JordD04/gists{/gist_id}","starred_url":"https://api.github.com/users/JordD04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JordD04/subscriptions","organizations_url":"https://api.github.com/users/JordD04/orgs","repos_url":"https://api.github.com/users/JordD04/repos","events_url":"https://api.github.com/users/JordD04/events{/privacy}","received_events_url":"https://api.github.com/users/JordD04/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/968199624","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/288#issuecomment-968199624","issue_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/288","id":968199624,"node_id":"IC_kwDOCMZ5Ls45tY3I","user":{"login":"MrRobot2211","id":23513768,"node_id":"MDQ6VXNlcjIzNTEzNzY4","avatar_url":"https://avatars.githubusercontent.com/u/23513768?v=4","gravatar_id":"","url":"https://api.github.com/users/MrRobot2211","html_url":"https://github.com/MrRobot2211","followers_url":"https://api.github.com/users/MrRobot2211/followers","following_url":"https://api.github.com/users/MrRobot2211/following{/other_user}","gists_url":"https://api.github.com/users/MrRobot2211/gists{/gist_id}","starred_url":"https://api.github.com/users/MrRobot2211/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MrRobot2211/subscriptions","organizations_url":"https://api.github.com/users/MrRobot2211/orgs","repos_url":"https://api.github.com/users/MrRobot2211/repos","events_url":"https://api.github.com/users/MrRobot2211/events{/privacy}","received_events_url":"https://api.github.com/users/MrRobot2211/received_events","type":"User","site_admin":false},"created_at":"2021-11-14T03:35:05Z","updated_at":"2021-11-14T03:35:05Z","author_association":"NONE","body":"Hi, maybe it will be useful to point out that in the paper the feature dimension for materials project is 64 instead of 128. Maybe by switching to 64 yo will reduce the overfitting, I am trying it myself.","reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/comments/968199624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MrRobot2211","id":23513768,"node_id":"MDQ6VXNlcjIzNTEzNzY4","avatar_url":"https://avatars.githubusercontent.com/u/23513768?v=4","gravatar_id":"","url":"https://api.github.com/users/MrRobot2211","html_url":"https://github.com/MrRobot2211","followers_url":"https://api.github.com/users/MrRobot2211/followers","following_url":"https://api.github.com/users/MrRobot2211/following{/other_user}","gists_url":"https://api.github.com/users/MrRobot2211/gists{/gist_id}","starred_url":"https://api.github.com/users/MrRobot2211/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MrRobot2211/subscriptions","organizations_url":"https://api.github.com/users/MrRobot2211/orgs","repos_url":"https://api.github.com/users/MrRobot2211/repos","events_url":"https://api.github.com/users/MrRobot2211/events{/privacy}","received_events_url":"https://api.github.com/users/MrRobot2211/received_events","type":"User","site_admin":false}}]