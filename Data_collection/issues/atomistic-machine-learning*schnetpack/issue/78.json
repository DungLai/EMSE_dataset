{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/78","repository_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack","labels_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/78/labels{/name}","comments_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/78/comments","events_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/78/events","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/78","id":426564085,"node_id":"MDU6SXNzdWU0MjY1NjQwODU=","number":78,"title":"Problem with schnetpack_qm9.py","user":{"login":"somnambWl","id":18290380,"node_id":"MDQ6VXNlcjE4MjkwMzgw","avatar_url":"https://avatars.githubusercontent.com/u/18290380?v=4","gravatar_id":"","url":"https://api.github.com/users/somnambWl","html_url":"https://github.com/somnambWl","followers_url":"https://api.github.com/users/somnambWl/followers","following_url":"https://api.github.com/users/somnambWl/following{/other_user}","gists_url":"https://api.github.com/users/somnambWl/gists{/gist_id}","starred_url":"https://api.github.com/users/somnambWl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/somnambWl/subscriptions","organizations_url":"https://api.github.com/users/somnambWl/orgs","repos_url":"https://api.github.com/users/somnambWl/repos","events_url":"https://api.github.com/users/somnambWl/events{/privacy}","received_events_url":"https://api.github.com/users/somnambWl/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-03-28T15:39:01Z","updated_at":"2019-03-29T09:55:27Z","closed_at":"2019-03-29T09:55:26Z","author_association":"NONE","active_lock_reason":null,"body":"Hello,\r\n\r\nI would like to ask if _schnetpack_qm9.py_ is still working. No matter what I try, I eventually run into `RuntimeError: cublas runtime error : the GPU program failed to execute at /pytorch/aten/src/THC/THCBlas.cu:441`. \r\n\r\nI only create a new virtualenv, pip install schnetpack and then I run:\r\n`schnetpack_qm9.py train schnet QM9 TestRun --split 10000 10000 --cuda`       \r\n\r\nOutput is following (when I already downloaded QM9):\r\n```\r\nINFO:root:Random state initialized with seed 3679303364\r\nINFO:root:QM9 will be loaded...\r\nINFO:root:create splits...\r\nINFO:root:load data...\r\nINFO:root:calculate statistics...\r\nINFO:root:cached statistics was loaded...\r\nINFO:root:The model you built has: 1676133 parameters\r\nINFO:root:training...\r\nTraceback (most recent call last):\r\n  File \"/home/kubaw/.virtualenvs/schnet/bin/schnetpack_qm9.py\", line 357, in <module>\r\n    train(args, model, train_loader, val_loader, device)\r\n  File \"/home/kubaw/.virtualenvs/schnet/bin/schnetpack_qm9.py\", line 177, in train\r\n    trainer.train(device)\r\n  File \"/home/kubaw/.virtualenvs/schnet/lib/python3.7/site-packages/schnetpack/train/trainer.py\", line 216, in train\r\n    raise e\r\n  File \"/home/kubaw/.virtualenvs/schnet/lib/python3.7/site-packages/schnetpack/train/trainer.py\", line 144, in train\r\n    result = self._model(train_batch)\r\n  File \"/home/kubaw/.virtualenvs/schnet/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/kubaw/.virtualenvs/schnet/lib/python3.7/site-packages/schnetpack/atomistic.py\", line 55, in forward\r\n    inputs['representation'] = self.representation(inputs)\r\n  File \"/home/kubaw/.virtualenvs/schnet/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/kubaw/.virtualenvs/schnet/lib/python3.7/site-packages/schnetpack/representation/schnet.py\", line 191, in forward\r\n    r_ij = self.distances(positions, neighbors, cell, cell_offset)\r\n  File \"/home/kubaw/.virtualenvs/schnet/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/kubaw/.virtualenvs/schnet/lib/python3.7/site-packages/schnetpack/nn/neighbors.py\", line 76, in forward\r\n    return atom_distances(positions, neighbors, cell, cell_offsets, return_directions=self.return_directions)\r\n  File \"/home/kubaw/.virtualenvs/schnet/lib/python3.7/site-packages/schnetpack/nn/neighbors.py\", line 36, in atom_distances\r\n    offsets = cell_offsets.bmm(cell)\r\nRuntimeError: cublas runtime error : the GPU program failed to execute at /pytorch/aten/src/THC/THCBlas.cu:441\r\n```\r\n\r\nI am not sure where this error comes from because for me a basic pytorch nn is working.\r\nI have also noticed that the version installed with pip needs a folder as datadir, the version installed with setup.py needs a .db file as datadir. It also seems that there is recent work on scripts using sacred, so it may also be, that old scripts are not working anymore. It would be great if you could confirm, that the script is working as then I could search for the origin of the error elsewhere; or if you had an idea where this error comes from. ","closed_by":{"login":"somnambWl","id":18290380,"node_id":"MDQ6VXNlcjE4MjkwMzgw","avatar_url":"https://avatars.githubusercontent.com/u/18290380?v=4","gravatar_id":"","url":"https://api.github.com/users/somnambWl","html_url":"https://github.com/somnambWl","followers_url":"https://api.github.com/users/somnambWl/followers","following_url":"https://api.github.com/users/somnambWl/following{/other_user}","gists_url":"https://api.github.com/users/somnambWl/gists{/gist_id}","starred_url":"https://api.github.com/users/somnambWl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/somnambWl/subscriptions","organizations_url":"https://api.github.com/users/somnambWl/orgs","repos_url":"https://api.github.com/users/somnambWl/repos","events_url":"https://api.github.com/users/somnambWl/events{/privacy}","received_events_url":"https://api.github.com/users/somnambWl/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/78/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/78/timeline","performed_via_github_app":null,"state_reason":"completed"}