{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/401","repository_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack","labels_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/401/labels{/name}","comments_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/401/comments","events_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/401/events","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/401","id":1213072066,"node_id":"I_kwDOCMZ5Ls5ITgLC","number":401,"title":"Towards stress in `dev` branch","user":{"login":"sirmarcel","id":1615910,"node_id":"MDQ6VXNlcjE2MTU5MTA=","avatar_url":"https://avatars.githubusercontent.com/u/1615910?v=4","gravatar_id":"","url":"https://api.github.com/users/sirmarcel","html_url":"https://github.com/sirmarcel","followers_url":"https://api.github.com/users/sirmarcel/followers","following_url":"https://api.github.com/users/sirmarcel/following{/other_user}","gists_url":"https://api.github.com/users/sirmarcel/gists{/gist_id}","starred_url":"https://api.github.com/users/sirmarcel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sirmarcel/subscriptions","organizations_url":"https://api.github.com/users/sirmarcel/orgs","repos_url":"https://api.github.com/users/sirmarcel/repos","events_url":"https://api.github.com/users/sirmarcel/events{/privacy}","received_events_url":"https://api.github.com/users/sirmarcel/received_events","type":"User","site_admin":false},"labels":[{"id":1044272334,"node_id":"MDU6TGFiZWwxMDQ0MjcyMzM0","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1496554663,"node_id":"MDU6TGFiZWwxNDk2NTU0NjYz","url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/labels/documentation","name":"documentation","color":"c2e0c6","default":true,"description":""}],"state":"closed","locked":false,"assignee":{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false},"assignees":[{"login":"Stefaanhess","id":23171261,"node_id":"MDQ6VXNlcjIzMTcxMjYx","avatar_url":"https://avatars.githubusercontent.com/u/23171261?v=4","gravatar_id":"","url":"https://api.github.com/users/Stefaanhess","html_url":"https://github.com/Stefaanhess","followers_url":"https://api.github.com/users/Stefaanhess/followers","following_url":"https://api.github.com/users/Stefaanhess/following{/other_user}","gists_url":"https://api.github.com/users/Stefaanhess/gists{/gist_id}","starred_url":"https://api.github.com/users/Stefaanhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stefaanhess/subscriptions","organizations_url":"https://api.github.com/users/Stefaanhess/orgs","repos_url":"https://api.github.com/users/Stefaanhess/repos","events_url":"https://api.github.com/users/Stefaanhess/events{/privacy}","received_events_url":"https://api.github.com/users/Stefaanhess/received_events","type":"User","site_admin":false}],"milestone":null,"comments":12,"created_at":"2022-04-23T01:52:27Z","updated_at":"2022-06-01T09:44:00Z","closed_at":"2022-06-01T09:44:00Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Hello,\r\n\r\nI've started to play around with stress and PaiNN (hah!) in the `dev` branch. As far as I can tell, stress computation doesn't work, and I'd like to try fixing it. I'm making this issue to ask some questions on the internals of the new `schnetpack`, I hope that's ok!\r\n\r\nI've had a bit of a poke around and it looks like there's a bunch of smaller problems related to the switch from an explicit batch dimension to the new approach of just concatenating everything and tracking things via `idx_m`. Before I can fix those bugs, I have a question: are the `NeighborListTransform` objects intended to be used in the `model.input_modules`, i.e. to be called during a forward pass, or are they supposed to be \"offline\" pre-processors that simply provide inputs one structure (molecule) at a time? The code seems to be expecting the latter, which means that the implemented way of computing stress doesn't work, because the computation of the offsets happens outside the computational graph. (In that case, a better way would probably be to differentiate with respect to `Rij` and compute stress as `sum_ij Rij (x) d U d Rij`, which should be straightforward.)\r\n\r\nCheers,\r\n\r\nMarcel","closed_by":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/401/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/401/timeline","performed_via_github_app":null,"state_reason":"completed"}