{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/255","repository_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack","labels_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/255/labels{/name}","comments_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/255/comments","events_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/255/events","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/255","id":813889861,"node_id":"MDU6SXNzdWU4MTM4ODk4NjE=","number":255,"title":"Errors when downloading materials dataset","user":{"login":"jhrmnn","id":940353,"node_id":"MDQ6VXNlcjk0MDM1Mw==","avatar_url":"https://avatars.githubusercontent.com/u/940353?v=4","gravatar_id":"","url":"https://api.github.com/users/jhrmnn","html_url":"https://github.com/jhrmnn","followers_url":"https://api.github.com/users/jhrmnn/followers","following_url":"https://api.github.com/users/jhrmnn/following{/other_user}","gists_url":"https://api.github.com/users/jhrmnn/gists{/gist_id}","starred_url":"https://api.github.com/users/jhrmnn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhrmnn/subscriptions","organizations_url":"https://api.github.com/users/jhrmnn/orgs","repos_url":"https://api.github.com/users/jhrmnn/repos","events_url":"https://api.github.com/users/jhrmnn/events{/privacy}","received_events_url":"https://api.github.com/users/jhrmnn/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-02-22T21:44:40Z","updated_at":"2021-05-21T14:33:58Z","closed_at":"2021-05-21T14:33:58Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"With current master, I'm getting the following errors:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/srv/hdd/jhermann/.cache/conda/envs/long-range/lib/python3.8/runpy.py\", line 194, in _run_module_as_main\r\n    return _run_code(code, main_globals, None,\r\n  File \"/srv/hdd/jhermann/.cache/conda/envs/long-range/lib/python3.8/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/srv/hdd/jhermann/Research/Projects/long-range/longrange/scripts/materials_dataset.py\", line 44, in <module>\r\n    ds = generate_materials_dataset(\r\n  File \"/srv/hdd/jhermann/Research/Projects/long-range/longrange/scripts/materials_dataset.py\", line 19, in generate_materials_dataset\r\n    print(repr(orig_ds[0]))\r\n  File \"/srv/hdd/jhermann/Research/Projects/long-range/extern/schnetpack/src/schnetpack/data/atoms.py\", line 202, in __getitem__\r\n    at, properties = self.get_properties(idx)\r\n  File \"/srv/hdd/jhermann/Research/Projects/long-range/extern/schnetpack/src/schnetpack/data/atoms.py\", line 336, in get_properties\r\n    properties[pname] = torch.FloatTensor(row.data[pname].copy())\r\nAttributeError: 'float' object has no attribute 'copy'\r\n```\r\n\r\nThis seems to fix the issue, don't know if it's a correct fix:\r\n\r\n```diff\r\ndiff --git a/src/schnetpack/data/atoms.py b/src/schnetpack/data/atoms.py\r\nindex a9d8707..ceb9772 100644\r\n--- a/src/schnetpack/data/atoms.py\r\n+++ b/src/schnetpack/data/atoms.py\r\n@@ -327,7 +327,12 @@ class AtomsData(Dataset):\r\n         # extract properties\r\n         properties = {}\r\n         for pname in self.load_only:\r\n-            properties[pname] = torch.FloatTensor(row.data[pname].copy())\r\n+            value = row.data[pname]\r\n+            try:\r\n+                value = value.copy()\r\n+            except AttributeError:\r\n+                pass\r\n+            properties[pname] = torch.tensor(value)\r\n\r\n         # extract/calculate structure\r\n         properties = _convert_atoms(\r\n```","closed_by":{"login":"ktschuett","id":6585114,"node_id":"MDQ6VXNlcjY1ODUxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6585114?v=4","gravatar_id":"","url":"https://api.github.com/users/ktschuett","html_url":"https://github.com/ktschuett","followers_url":"https://api.github.com/users/ktschuett/followers","following_url":"https://api.github.com/users/ktschuett/following{/other_user}","gists_url":"https://api.github.com/users/ktschuett/gists{/gist_id}","starred_url":"https://api.github.com/users/ktschuett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktschuett/subscriptions","organizations_url":"https://api.github.com/users/ktschuett/orgs","repos_url":"https://api.github.com/users/ktschuett/repos","events_url":"https://api.github.com/users/ktschuett/events{/privacy}","received_events_url":"https://api.github.com/users/ktschuett/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/255/timeline","performed_via_github_app":null,"state_reason":"completed"}