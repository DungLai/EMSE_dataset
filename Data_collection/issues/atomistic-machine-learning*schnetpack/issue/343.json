{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/343","repository_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack","labels_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/343/labels{/name}","comments_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/343/comments","events_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/343/events","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/343","id":1014610111,"node_id":"I_kwDOCMZ5Ls48ebi_","number":343,"title":"Error in tutorial 4 code section 32 and some minor issue","user":{"login":"wuziqi-cmu","id":88000636,"node_id":"MDQ6VXNlcjg4MDAwNjM2","avatar_url":"https://avatars.githubusercontent.com/u/88000636?v=4","gravatar_id":"","url":"https://api.github.com/users/wuziqi-cmu","html_url":"https://github.com/wuziqi-cmu","followers_url":"https://api.github.com/users/wuziqi-cmu/followers","following_url":"https://api.github.com/users/wuziqi-cmu/following{/other_user}","gists_url":"https://api.github.com/users/wuziqi-cmu/gists{/gist_id}","starred_url":"https://api.github.com/users/wuziqi-cmu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuziqi-cmu/subscriptions","organizations_url":"https://api.github.com/users/wuziqi-cmu/orgs","repos_url":"https://api.github.com/users/wuziqi-cmu/repos","events_url":"https://api.github.com/users/wuziqi-cmu/events{/privacy}","received_events_url":"https://api.github.com/users/wuziqi-cmu/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-10-04T00:32:05Z","updated_at":"2021-10-05T14:45:29Z","closed_at":"2021-10-05T14:45:28Z","author_association":"NONE","active_lock_reason":null,"body":"When running tutorial 4, I encountered several problems:\r\n\r\n1. the tests/data path is wrong\r\n2. fs2atu attribute not found\r\n3. In code section 32, the error message is shown below:\r\n---------------------------------------------------------------------------\r\nIndexError                                Traceback (most recent call last)\r\n/var/folders/k_/jq6m6ps14v59j7zn4tqygzjr0000gn/T/ipykernel_43873/4039029887.py in <module>\r\n      1 n_steps = 50000\r\n      2 \r\n----> 3 rpmd_simulator.simulate(n_steps)\r\n\r\n~/opt/anaconda3/envs/SchNet/lib/python3.9/site-packages/schnetpack/md/simulator.py in simulate(self, n_steps)\r\n     76         # Perform initial computation of forces\r\n     77         if self.system.forces is None:\r\n---> 78             self.calculator.calculate(self.system)\r\n     79 \r\n     80         # Call hooks at the simulation start\r\n\r\n~/opt/anaconda3/envs/SchNet/lib/python3.9/site-packages/schnetpack/md/calculators/schnet_calculator.py in calculate(self, system)\r\n     91 \r\n     92         inputs = self._generate_input(system)\r\n---> 93         self.results = self.model(inputs)\r\n     94         self._update_system(system)\r\n     95 \r\n\r\n~/opt/anaconda3/envs/SchNet/lib/python3.9/site-packages/torch/nn/modules/module.py in _call_impl(self, *input, **kwargs)\r\n   1049         if not (self._backward_hooks or self._forward_hooks or self._forward_pre_hooks or _global_backward_hooks\r\n   1050                 or _global_forward_hooks or _global_forward_pre_hooks):\r\n-> 1051             return forward_call(*input, **kwargs)\r\n   1052         # Do not call functions when jit is used\r\n   1053         full_backward_hooks, non_full_backward_hooks = [], []\r\n\r\n~/opt/anaconda3/envs/SchNet/lib/python3.9/site-packages/schnetpack/atomistic/model.py in forward(self, inputs)\r\n     63             )\r\n     64 \r\n---> 65         inputs[\"representation\"] = self.representation(inputs)\r\n     66         outs = {}\r\n     67         for output_model in self.output_modules:\r\n\r\n~/opt/anaconda3/envs/SchNet/lib/python3.9/site-packages/torch/nn/modules/module.py in _call_impl(self, *input, **kwargs)\r\n   1049         if not (self._backward_hooks or self._forward_hooks or self._forward_pre_hooks or _global_backward_hooks\r\n   1050                 or _global_forward_hooks or _global_forward_pre_hooks):\r\n-> 1051             return forward_call(*input, **kwargs)\r\n   1052         # Do not call functions when jit is used\r\n   1053         full_backward_hooks, non_full_backward_hooks = [], []\r\n\r\n~/opt/anaconda3/envs/SchNet/lib/python3.9/site-packages/schnetpack/representation/schnet.py in forward(self, inputs)\r\n    225 \r\n    226         # compute interatomic distance of every atom to its neighbors\r\n--> 227         r_ij = self.distances(\r\n    228             positions, neighbors, cell, cell_offset, neighbor_mask=neighbor_mask\r\n    229         )\r\n\r\n~/opt/anaconda3/envs/SchNet/lib/python3.9/site-packages/torch/nn/modules/module.py in _call_impl(self, *input, **kwargs)\r\n   1049         if not (self._backward_hooks or self._forward_hooks or self._forward_pre_hooks or _global_backward_hooks\r\n   1050                 or _global_forward_hooks or _global_forward_pre_hooks):\r\n-> 1051             return forward_call(*input, **kwargs)\r\n   1052         # Do not call functions when jit is used\r\n   1053         full_backward_hooks, non_full_backward_hooks = [], []\r\n\r\n~/opt/anaconda3/envs/SchNet/lib/python3.9/site-packages/schnetpack/nn/neighbors.py in forward(self, positions, neighbors, cell, cell_offsets, neighbor_mask)\r\n    117 \r\n    118         \"\"\"\r\n--> 119         return atom_distances(\r\n    120             positions,\r\n    121             neighbors,\r\n\r\n~/opt/anaconda3/envs/SchNet/lib/python3.9/site-packages/schnetpack/nn/neighbors.py in atom_distances(positions, neighbors, cell, cell_offsets, return_vecs, normalize_vecs, neighbor_mask)\r\n     70         # -> distances[mask==0] = 0.0\r\n     71         tmp_distances = torch.zeros_like(distances)\r\n---> 72         tmp_distances[neighbor_mask != 0] = distances[neighbor_mask != 0]\r\n     73         distances = tmp_distances\r\n     74 \r\n\r\nIndexError: The shape of the mask [1, 9, 8] at index 0 does not match the shape of the indexed tensor [4, 9, 8] at index 0\r\n\r\nAny help on how to resolve those bugs? Thanks a lot!\r\n","closed_by":{"login":"mgastegger","id":36198330,"node_id":"MDQ6VXNlcjM2MTk4MzMw","avatar_url":"https://avatars.githubusercontent.com/u/36198330?v=4","gravatar_id":"","url":"https://api.github.com/users/mgastegger","html_url":"https://github.com/mgastegger","followers_url":"https://api.github.com/users/mgastegger/followers","following_url":"https://api.github.com/users/mgastegger/following{/other_user}","gists_url":"https://api.github.com/users/mgastegger/gists{/gist_id}","starred_url":"https://api.github.com/users/mgastegger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgastegger/subscriptions","organizations_url":"https://api.github.com/users/mgastegger/orgs","repos_url":"https://api.github.com/users/mgastegger/repos","events_url":"https://api.github.com/users/mgastegger/events{/privacy}","received_events_url":"https://api.github.com/users/mgastegger/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/343/timeline","performed_via_github_app":null,"state_reason":"completed"}