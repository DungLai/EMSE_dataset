{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/413","repository_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack","labels_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/413/labels{/name}","comments_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/413/comments","events_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/413/events","html_url":"https://github.com/atomistic-machine-learning/schnetpack/issues/413","id":1249015521,"node_id":"I_kwDOCMZ5Ls5Kcnbh","number":413,"title":"parameter setting","user":{"login":"Dong-Shiyu","id":77573858,"node_id":"MDQ6VXNlcjc3NTczODU4","avatar_url":"https://avatars.githubusercontent.com/u/77573858?v=4","gravatar_id":"","url":"https://api.github.com/users/Dong-Shiyu","html_url":"https://github.com/Dong-Shiyu","followers_url":"https://api.github.com/users/Dong-Shiyu/followers","following_url":"https://api.github.com/users/Dong-Shiyu/following{/other_user}","gists_url":"https://api.github.com/users/Dong-Shiyu/gists{/gist_id}","starred_url":"https://api.github.com/users/Dong-Shiyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Dong-Shiyu/subscriptions","organizations_url":"https://api.github.com/users/Dong-Shiyu/orgs","repos_url":"https://api.github.com/users/Dong-Shiyu/repos","events_url":"https://api.github.com/users/Dong-Shiyu/events{/privacy}","received_events_url":"https://api.github.com/users/Dong-Shiyu/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-05-26T02:34:59Z","updated_at":"2022-05-27T03:22:54Z","closed_at":"2022-05-27T03:22:54Z","author_association":"NONE","active_lock_reason":null,"body":"Currently, I use schnetpack to train dipole moment using using QM9 dataset ,but my training always  stop at mae about 0.9 (e angstrom) after about 50 steps.\r\nHere is my parameter setting:\r\n`import schnetpack as spk\r\nimport torch\r\nfrom schnetpack.datasets import QM9\r\n\r\ndata=QM9(\"./data/qm9.db\",load_only=[QM9.mu],remove_uncharacterized=True)\r\ntrain,val,test=spk.train_test_split(data=data,num_train=10000,num_val=1000,\r\nsplit_file=\"./data/split.npz\")\r\ntrain_loader=spk.AtomsLoader(train,batch_size=100,shuffle=True)\r\nval_loader=spk.AtomsLoader(val,batch_size=100)\r\n# statistic \r\nmean,stdvar=train_loader.get_statistics(QM9.mu)\r\nschnet=spk.representation.SchNet(n_atom_basis=64,n_filters=64,n_gaussians=200,n_interactions=6,cutoff=20,cutoff_network=spk.nn.cutoff.HardCutoff)\r\noutput=spk.atomistic.DipoleMoment(n_in=64,property=QM9.mu,mean=mean[QM9.mu],stddev=stdvar[QM9.mu])\r\nmodel=spk.AtomisticModel(representation=schnet,output_modules=output)\r\n\r\n\r\nfrom torch.optim import Adam\r\ndef loss_fn(batch,result):\r\n    diff=batch[QM9.mu]-result[QM9.mu]\r\n    err= torch.mean(diff**2)\r\n    return err\r\noptimizer=Adam(model.parameters(),lr=1e-3)\r\n\r\nimport schnetpack.train as trn\r\nloss=trn.build_mse_loss([QM9.mu])\r\n\r\n\r\nmetrics=[spk.metrics.MeanAbsoluteError(QM9.mu)]\r\nhooks=[trn.CSVHook(log_path=\"./log\",metrics=metrics),trn.ReduceLROnPlateauHook(optimizer,patience=25,factor=0.5,min_lr=1e-6,stop_after_min=True)]\r\n\r\n\r\ntrainer=trn.Trainer(\r\n    model_path=\"./model\",\r\n    model=model,\r\n    hooks=hooks,\r\n    loss_fn=loss_fn,\r\n    optimizer=optimizer,\r\n    train_loader=train_loader,\r\n    validation_loader=val_loader\r\n)\r\ndevice=\"cpu\"\r\nn_epochs=200\r\ntrainer.train(device=device,n_epochs=n_epochs)\r\n`\r\n\r\nI have used a large trainning sets before,but it failed the same way.In order to lower computational cost during parameter searching , I reduce them to 10000,1000 train,val. What is wrong of my parameters?\r\n\r\n","closed_by":{"login":"Dong-Shiyu","id":77573858,"node_id":"MDQ6VXNlcjc3NTczODU4","avatar_url":"https://avatars.githubusercontent.com/u/77573858?v=4","gravatar_id":"","url":"https://api.github.com/users/Dong-Shiyu","html_url":"https://github.com/Dong-Shiyu","followers_url":"https://api.github.com/users/Dong-Shiyu/followers","following_url":"https://api.github.com/users/Dong-Shiyu/following{/other_user}","gists_url":"https://api.github.com/users/Dong-Shiyu/gists{/gist_id}","starred_url":"https://api.github.com/users/Dong-Shiyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Dong-Shiyu/subscriptions","organizations_url":"https://api.github.com/users/Dong-Shiyu/orgs","repos_url":"https://api.github.com/users/Dong-Shiyu/repos","events_url":"https://api.github.com/users/Dong-Shiyu/events{/privacy}","received_events_url":"https://api.github.com/users/Dong-Shiyu/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/atomistic-machine-learning/schnetpack/issues/413/timeline","performed_via_github_app":null,"state_reason":"completed"}