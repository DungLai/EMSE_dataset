{"url":"https://api.github.com/repos/ml-tooling/ml-workspace/issues/51","repository_url":"https://api.github.com/repos/ml-tooling/ml-workspace","labels_url":"https://api.github.com/repos/ml-tooling/ml-workspace/issues/51/labels{/name}","comments_url":"https://api.github.com/repos/ml-tooling/ml-workspace/issues/51/comments","events_url":"https://api.github.com/repos/ml-tooling/ml-workspace/issues/51/events","html_url":"https://github.com/ml-tooling/ml-workspace/issues/51","id":712012109,"node_id":"MDU6SXNzdWU3MTIwMTIxMDk=","number":51,"title":"Fails to run","user":{"login":"ReggieCarey","id":10270182,"node_id":"MDQ6VXNlcjEwMjcwMTgy","avatar_url":"https://avatars.githubusercontent.com/u/10270182?v=4","gravatar_id":"","url":"https://api.github.com/users/ReggieCarey","html_url":"https://github.com/ReggieCarey","followers_url":"https://api.github.com/users/ReggieCarey/followers","following_url":"https://api.github.com/users/ReggieCarey/following{/other_user}","gists_url":"https://api.github.com/users/ReggieCarey/gists{/gist_id}","starred_url":"https://api.github.com/users/ReggieCarey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ReggieCarey/subscriptions","organizations_url":"https://api.github.com/users/ReggieCarey/orgs","repos_url":"https://api.github.com/users/ReggieCarey/repos","events_url":"https://api.github.com/users/ReggieCarey/events{/privacy}","received_events_url":"https://api.github.com/users/ReggieCarey/received_events","type":"User","site_admin":false},"labels":[{"id":1379266800,"node_id":"MDU6TGFiZWwxMzc5MjY2ODAw","url":"https://api.github.com/repos/ml-tooling/ml-workspace/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working as expected"}],"state":"closed","locked":false,"assignee":{"login":"raethlein","id":3775781,"node_id":"MDQ6VXNlcjM3NzU3ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3775781?v=4","gravatar_id":"","url":"https://api.github.com/users/raethlein","html_url":"https://github.com/raethlein","followers_url":"https://api.github.com/users/raethlein/followers","following_url":"https://api.github.com/users/raethlein/following{/other_user}","gists_url":"https://api.github.com/users/raethlein/gists{/gist_id}","starred_url":"https://api.github.com/users/raethlein/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raethlein/subscriptions","organizations_url":"https://api.github.com/users/raethlein/orgs","repos_url":"https://api.github.com/users/raethlein/repos","events_url":"https://api.github.com/users/raethlein/events{/privacy}","received_events_url":"https://api.github.com/users/raethlein/received_events","type":"User","site_admin":false},"assignees":[{"login":"raethlein","id":3775781,"node_id":"MDQ6VXNlcjM3NzU3ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3775781?v=4","gravatar_id":"","url":"https://api.github.com/users/raethlein","html_url":"https://github.com/raethlein","followers_url":"https://api.github.com/users/raethlein/followers","following_url":"https://api.github.com/users/raethlein/following{/other_user}","gists_url":"https://api.github.com/users/raethlein/gists{/gist_id}","starred_url":"https://api.github.com/users/raethlein/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raethlein/subscriptions","organizations_url":"https://api.github.com/users/raethlein/orgs","repos_url":"https://api.github.com/users/raethlein/repos","events_url":"https://api.github.com/users/raethlein/events{/privacy}","received_events_url":"https://api.github.com/users/raethlein/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2020-09-30T14:45:06Z","updated_at":"2020-12-12T21:01:54Z","closed_at":"2020-12-12T21:01:54Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug:**\r\n\r\nML Workspace fails to start and serve up Jupyter Notebooks\r\n\r\n<!-- Describe your issue, but please be descriptive! Thanks again 🙌 ❤️ -->\r\n\r\nStarted ML WORKSPACE with the Following Docker Command:\r\n\r\n```bash\r\n$ docker run -d \\\r\n    -p 8080:8080 \\\r\n    --name \"ml-workspace\" \\\r\n    -v \"/Users/<myuserid>/Documents/Notebooks:/workspace\" \\\r\n    --env AUTHENTICATE_VIA_JUPYTER=\"mytoken\" \\\r\n    --shm-size 512m \\\r\n    --restart always \\\r\n    mltooling/ml-workspace:latest\r\n57fc561fa9eb1c38261e9c6a09a66a1a4c2ca9e686fbb1991996cb4befa1f8a6\r\n$\r\n```\r\n\r\nIt launched and reported the container id\r\n\r\n**Expected behaviour:**\r\n\r\nWhen I go to http://localhost:8080 I expect to get to my Jupyter Notebooks.  Instead I get a waiting forever display and the logs as you see below.\r\n\r\n**Steps to reproduce the issue:**\r\n\r\nRun the docker command as described above. Open http://localhost:8080 in the browser.\r\n\r\nDOCKER LOGS:\r\n```\r\n2020-09-30 14:18:47,850 [INFO] Starting...\r\n2020-09-30 14:18:47,960 [INFO] Start Workspace\r\n2020-09-30 14:18:48,082 [INFO] Running config backup restore.\r\n2020-09-30 14:18:48,336 [INFO] Configure ssh service\r\n\r\nAgent pid 41\r\nIdentity added: /root/.ssh/id_ed25519 (root@6d2fe55b74ff)\r\n2020-09-30 14:18:48,449 [INFO] Configure nginx service\r\n2020-09-30 14:18:48,532 [INFO] Configure tools\r\n2020-09-30 14:18:48,599 [INFO] Configure cron scripts\r\n2020-09-30 14:18:48,876 [INFO] Scheduling cron check xfdesktop task with with cron: 0 * * * *\r\n2020-09-30 14:18:48,898 [INFO] Running cron jobs:\r\n2020-09-30 14:18:48,899 [INFO] @hourly /opt/conda/bin/python '/resources/scripts/check_xfdesktop_leak.py' check> /proc/1/fd/1 2>/proc/1/fd/2\r\n2020-09-30 14:18:48,996 [INFO] Starting configuration backup.\r\n2020-09-30 14:18:49,316 [INFO] Scheduling cron config backup task with with cron: 0 * * * *\r\n2020-09-30 14:18:49,323 [INFO] Running cron jobs:\r\n2020-09-30 14:18:49,324 [INFO] @hourly /opt/conda/bin/python '/resources/scripts/check_xfdesktop_leak.py' check> /proc/1/fd/1 2>/proc/1/fd/2\r\n2020-09-30 14:18:49,325 [INFO] @hourly . /resources/environment.sh; /opt/conda/bin/python '/resources/scripts/backup_restore_config.py' backup> /proc/1/fd/1 2>/proc/1/fd/2\r\n2020-09-30 14:18:49,341 [INFO] Configure and run custom scripts\r\n2020-09-30 14:18:50,338 INFO Included extra file \"/etc/supervisor/conf.d/cron.conf\" during parsing\r\n2020-09-30 14:18:50,339 INFO Included extra file \"/etc/supervisor/conf.d/filebrowser.conf\" during parsing\r\n2020-09-30 14:18:50,339 INFO Included extra file \"/etc/supervisor/conf.d/glances.conf\" during parsing\r\n2020-09-30 14:18:50,339 INFO Included extra file \"/etc/supervisor/conf.d/jupyter.conf\" during parsing\r\n2020-09-30 14:18:50,339 INFO Included extra file \"/etc/supervisor/conf.d/netdata.conf\" during parsing\r\n2020-09-30 14:18:50,339 INFO Included extra file \"/etc/supervisor/conf.d/nginx.conf\" during parsing\r\n2020-09-30 14:18:50,339 INFO Included extra file \"/etc/supervisor/conf.d/novnc.conf\" during parsing\r\n2020-09-30 14:18:50,339 INFO Included extra file \"/etc/supervisor/conf.d/rsyslog.conf\" during parsing\r\n2020-09-30 14:18:50,340 INFO Included extra file \"/etc/supervisor/conf.d/sshd.conf\" during parsing\r\n2020-09-30 14:18:50,340 INFO Included extra file \"/etc/supervisor/conf.d/sslh.conf\" during parsing\r\n2020-09-30 14:18:50,340 INFO Included extra file \"/etc/supervisor/conf.d/ungit.conf\" during parsing\r\n2020-09-30 14:18:50,340 INFO Included extra file \"/etc/supervisor/conf.d/vncserver.conf\" during parsing\r\n2020-09-30 14:18:50,340 INFO Included extra file \"/etc/supervisor/conf.d/vscode.conf\" during parsing\r\n2020-09-30 14:18:50,340 INFO Included extra file \"/etc/supervisor/conf.d/xrdp.conf\" during parsing\r\n2020-09-30 14:18:50,340 INFO Set uid to user 0 succeeded\r\n2020-09-30 14:18:50,385 INFO RPC interface 'supervisor' initialized\r\n2020-09-30 14:18:50,386 CRIT Server 'inet_http_server' running without any HTTP authentication checking\r\n2020-09-30 14:18:50,388 INFO RPC interface 'supervisor' initialized\r\n2020-09-30 14:18:50,388 CRIT Server 'unix_http_server' running without any HTTP authentication checking\r\n2020-09-30 14:18:50,389 INFO supervisord started with pid 95\r\n2020-09-30 14:18:51,392 INFO spawned: 'rsyslog' with pid 98\r\n2020-09-30 14:18:51,396 INFO spawned: 'nginx' with pid 99\r\n2020-09-30 14:18:51,399 INFO spawned: 'sslh' with pid 100\r\n2020-09-30 14:18:51,405 INFO spawned: 'sshd' with pid 101\r\n2020-09-30 14:18:51,410 INFO spawned: 'jupyter' with pid 102\r\n2020-09-30 14:18:51,413 INFO spawned: 'vncserver' with pid 104\r\n2020-09-30 14:18:51,417 INFO spawned: 'cron' with pid 107\r\n2020-09-30 14:18:51,422 INFO spawned: 'filebrowser' with pid 108\r\n2020-09-30 14:18:51,427 INFO spawned: 'glances' with pid 109\r\n2020-09-30 14:18:51,433 INFO spawned: 'netdata' with pid 113\r\n2020-09-30 14:18:51,440 INFO spawned: 'novnc' with pid 116\r\n2020-09-30 14:18:51,447 INFO spawned: 'ungit' with pid 118\r\n2020-09-30 14:18:51,454 INFO spawned: 'vscode' with pid 123\r\n2020-09-30 14:18:51,460 INFO spawned: 'xrdp' with pid 124\r\n2020-09-30 14:18:52,395 INFO success: rsyslog entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-09-30 14:18:52,395 INFO success: nginx entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-09-30 14:18:52,418 INFO success: sslh entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-09-30 14:18:52,457 INFO success: sshd entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-09-30 14:18:52,457 INFO success: jupyter entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-09-30 14:18:52,461 INFO success: vncserver entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-09-30 14:18:52,461 INFO success: cron entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-09-30 14:18:52,461 INFO success: filebrowser entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-09-30 14:18:52,461 INFO success: glances entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-09-30 14:18:52,461 INFO success: netdata entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-09-30 14:18:52,462 INFO success: novnc entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-09-30 14:18:52,462 INFO success: ungit entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-09-30 14:18:52,463 INFO success: vscode entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-09-30 14:18:52,463 INFO success: xrdp entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020/09/30 14:19:34 [error] 136#0: *1 connect() failed (111: Connection refused) while connecting to upstream, client: 127.0.0.1, server: , request: \"GET / HTTP/1.1\", upstream: \"http://127.0.0.1:8090/\", host: \"localhost:8080\"\r\n2020/09/30 14:19:39 [error] 136#0: *3 connect() failed (111: Connection refused) while connecting to upstream, client: 127.0.0.1, server: , request: \"GET / HTTP/1.1\", upstream: \"http://127.0.0.1:8090/\", host: \"localhost:8080\", referrer: \"http://localhost:8080/\"\r\n2020/09/30 14:19:44 [error] 136#0: *3 connect() failed (111: Connection refused) while connecting to upstream, client: 127.0.0.1, server: , request: \"GET / HTTP/1.1\", upstream: \"http://127.0.0.1:8090/\", host: \"localhost:8080\", referrer: \"http://localhost:8080/\"\r\n2020/09/30 14:19:49 [error] 136#0: *3 connect() failed (111: Connection refused) while connecting to upstream, client: 127.0.0.1, server: , request: \"GET / HTTP/1.1\", upstream: \"http://127.0.0.1:8090/\", host: \"localhost:8080\", referrer: \"http://localhost:8080/\"\r\n....\r\n2020/09/30 14:21:05 [error] 136#0: *3 connect() failed (111: Connection refused) while connecting to upstream, client: 127.0.0.1, server: , request: \"GET / HTTP/1.1\", upstream: \"http://127.0.0.1:8090/\", host: \"localhost:8080\", referrer: \"http://localhost:8080/\"\r\n...\r\n```\r\n\r\nSCREENSHOT:\r\n\r\n![Screen Shot 2020-09-30 at 10 25 38](https://user-images.githubusercontent.com/10270182/94698976-d188f400-0307-11eb-8d85-6993ebd10afc.png)\r\n\r\n**Technical details:**\r\n\r\n- Workspace version <!-- run `echo $WORKSPACE_VERSION` inside the workspace -->: \r\n\r\n```bash\r\ndocker exec -it 57fc561fa9eb1c38261e9c6a09a66a1a4c2ca9e686fbb1991996cb4befa1f8a6 /bin/sh; exit\r\n# echo $WORKSPACE_VERSION\r\n0.9.1\r\n# \r\n```\r\n\r\n- Docker version <!-- run `docker version` on host machine -->: \r\n\r\n```bash\r\n$ docker version\r\nClient: Docker Engine - Community\r\n Version:           19.03.12\r\n API version:       1.40\r\n Go version:        go1.13.10\r\n Git commit:        48a66213fe\r\n Built:             Mon Jun 22 15:41:33 2020\r\n OS/Arch:           darwin/amd64\r\n Experimental:      false\r\n\r\nServer: Docker Engine - Community\r\n Engine:\r\n  Version:          19.03.12\r\n  API version:      1.40 (minimum version 1.12)\r\n  Go version:       go1.13.10\r\n  Git commit:       48a66213fe\r\n  Built:            Mon Jun 22 15:49:27 2020\r\n  OS/Arch:          linux/amd64\r\n  Experimental:     false\r\n containerd:\r\n  Version:          v1.2.13\r\n  GitCommit:        7ad184331fa3e55e52b890ea95e65ba581ae3429\r\n runc:\r\n  Version:          1.0.0-rc10\r\n  GitCommit:        dc9208a3303feef5b3839f4323d9beb36df0a9dd\r\n docker-init:\r\n  Version:          0.18.0\r\n  GitCommit:        fec3683\r\n```\r\n\r\n- Host Machine OS (Windows/Linux/Mac): \r\n\r\n![Screen Shot 2020-09-30 at 10 32 44](https://user-images.githubusercontent.com/10270182/94699437-4fe59600-0308-11eb-9eb1-dd26dfd26f03.png)\r\n\r\n- Command used to start the workspace <!-- e.g. `docker run mltooling/ml-workspace:latest` -->:\r\n\r\n```bash\r\n$ docker run -d \\\r\n    -p 8080:8080 \\\r\n    --name \"ml-workspace\" \\\r\n    -v \"/Users/<myuserid>/Documents/Notebooks:/workspace\" \\\r\n    --env AUTHENTICATE_VIA_JUPYTER=\"mytoken\" \\\r\n    --shm-size 512m \\\r\n    --restart always \\\r\n    mltooling/ml-workspace:latest\r\n```\r\n\r\n- Environment (From inside container):\r\n\r\n```bash\r\n$ docker exec -it 57fc561fa9eb1c38261e9c6a09a66a1a4c2ca9e686fbb1991996cb4befa1f8a6 /bin/sh; exit\r\n# env\r\nLANGUAGE=en_US:en\r\nWORKSPACE_PORT=8080\r\nHOSTNAME=57fc561fa9eb\r\nXDG_CACHE_HOME=/root/.cache/\r\nLD_LIBRARY_PATH=/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/opt/conda/lib\r\nSHUTDOWN_INACTIVE_KERNELS=false\r\nHOME=/root\r\nKMP_BLOCKTIME=0\r\nNB_USER=root\r\nVNC_COL_DEPTH=24\r\nWORKSPACE_HOME=/workspace\r\nCONFIG_BACKUP_ENABLED=true\r\nDATA_ENVIRONMENT=/workspace/environment\r\nTERM=xterm\r\nWORKSPACE_FLAVOR=full\r\nPATH=/opt/node/bin:/opt/conda/bin:/usr/local/openresty/nginx/sbin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\nXDG_RUNTIME_DIR=/tmp\r\nDISPLAY=:1\r\nCONDA_PYTHON_DIR=/opt/conda/lib/python3.7\r\nKMP_DUPLICATE_LIB_OK=True\r\nKMP_AFFINITY=granularity=fine,compact,1,0\r\nLANG=en_US.UTF-8\r\nSHARED_LINKS_ENABLED=true\r\nAUTHENTICATE_VIA_JUPYTER=mytoken\r\nDEBIAN_FRONTEND=noninteractive\r\nWORKSPACE_BASE_URL=/\r\nSHELL=/usr/bin/zsh\r\nRESOURCES_PATH=/resources\r\nPYTHON_VERSION=3.7.6\r\nSSL_RESOURCES_PATH=/resources/ssl\r\nCONDA_DIR=/opt/conda\r\nLC_ALL=en_US.UTF-8\r\nJAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64\r\nVNC_RESOLUTION=1600x900\r\nINCLUDE_TUTORIALS=true\r\nWORKSPACE_VERSION=0.9.1\r\nPWD=/root\r\nUSER_GID=0\r\nVNC_PW=vncpassword\r\nMAX_NUM_THREADS=auto\r\n# \r\n```\r\n\r\n- Browser (Chrome/Firefox/Safari):\r\n\r\n![Screen Shot 2020-09-30 at 10 34 05](https://user-images.githubusercontent.com/10270182/94699604-7dcada80-0308-11eb-8cc6-43e486ed99ef.png)\r\n\r\n**Possible Fix:**\r\n\r\n<!--- Not obligatory, but suggest a fix or reason for the bug -->\r\n\r\n**Additional context:**\r\n\r\n<!-- Add any other context about the problem here. -->\r\n","closed_by":{"login":"LukasMasuch","id":2852129,"node_id":"MDQ6VXNlcjI4NTIxMjk=","avatar_url":"https://avatars.githubusercontent.com/u/2852129?v=4","gravatar_id":"","url":"https://api.github.com/users/LukasMasuch","html_url":"https://github.com/LukasMasuch","followers_url":"https://api.github.com/users/LukasMasuch/followers","following_url":"https://api.github.com/users/LukasMasuch/following{/other_user}","gists_url":"https://api.github.com/users/LukasMasuch/gists{/gist_id}","starred_url":"https://api.github.com/users/LukasMasuch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LukasMasuch/subscriptions","organizations_url":"https://api.github.com/users/LukasMasuch/orgs","repos_url":"https://api.github.com/users/LukasMasuch/repos","events_url":"https://api.github.com/users/LukasMasuch/events{/privacy}","received_events_url":"https://api.github.com/users/LukasMasuch/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ml-tooling/ml-workspace/issues/51/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ml-tooling/ml-workspace/issues/51/timeline","performed_via_github_app":null,"state_reason":"completed"}