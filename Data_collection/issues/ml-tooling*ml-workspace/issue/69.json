{"url":"https://api.github.com/repos/ml-tooling/ml-workspace/issues/69","repository_url":"https://api.github.com/repos/ml-tooling/ml-workspace","labels_url":"https://api.github.com/repos/ml-tooling/ml-workspace/issues/69/labels{/name}","comments_url":"https://api.github.com/repos/ml-tooling/ml-workspace/issues/69/comments","events_url":"https://api.github.com/repos/ml-tooling/ml-workspace/issues/69/events","html_url":"https://github.com/ml-tooling/ml-workspace/issues/69","id":785961319,"node_id":"MDU6SXNzdWU3ODU5NjEzMTk=","number":69,"title":"(Selfsinged) Certificates can't be installed","user":{"login":"Someone894","id":43947920,"node_id":"MDQ6VXNlcjQzOTQ3OTIw","avatar_url":"https://avatars.githubusercontent.com/u/43947920?v=4","gravatar_id":"","url":"https://api.github.com/users/Someone894","html_url":"https://github.com/Someone894","followers_url":"https://api.github.com/users/Someone894/followers","following_url":"https://api.github.com/users/Someone894/following{/other_user}","gists_url":"https://api.github.com/users/Someone894/gists{/gist_id}","starred_url":"https://api.github.com/users/Someone894/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Someone894/subscriptions","organizations_url":"https://api.github.com/users/Someone894/orgs","repos_url":"https://api.github.com/users/Someone894/repos","events_url":"https://api.github.com/users/Someone894/events{/privacy}","received_events_url":"https://api.github.com/users/Someone894/received_events","type":"User","site_admin":false},"labels":[{"id":1379266800,"node_id":"MDU6TGFiZWwxMzc5MjY2ODAw","url":"https://api.github.com/repos/ml-tooling/ml-workspace/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working as expected"},{"id":2552279497,"node_id":"MDU6TGFiZWwyNTUyMjc5NDk3","url":"https://api.github.com/repos/ml-tooling/ml-workspace/labels/stale","name":"stale","color":"cfd3d7","default":false,"description":"Awaiting input from creator for prolonged time period"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2021-01-14T12:47:26Z","updated_at":"2021-10-28T02:08:09Z","closed_at":"2021-10-28T02:08:09Z","author_association":"NONE","active_lock_reason":null,"body":"Hello,\r\n\r\nsome days ago I found your wonderful ml-workspace image.\r\nYou're doing great work with this image :-)\r\n\r\nWhile testing it out I found a bug.\r\nI suppose that this is a operating-system issue, where you can't really do anything about it, but I'd still like to report it.\r\n\r\nWhen I create an container via:\r\n\r\n\tdocker run -d \\\r\n\t\t-p 8080:8080 \\\r\n\t\t--gpus all \\\r\n\t\t--name \"ml-workspace\" \\\r\n\t\t--env WORKSPACE_SSL_ENABLED=\"true\" \\\r\n\t\t-v /data/Docker/ML-tooling/workspace:/workspace \\\r\n\t\t--env AUTHENTICATE_VIA_JUPYTER=\"secret\" \\\r\n\t\t--shm-size 1G \\\r\n\t\t--restart always \\\r\n\t\tmltooling/ml-workspace-gpu:0.12.1\r\nAs you can see I'm using selfsinged certificate mode, since no certificate volumn is mapped.\r\n\r\nI get this log file:\r\n\r\n\t2021-01-13 13:23:37,335 [INFO] Starting...\r\n\t2021-01-13 13:23:37,409 [INFO] Start Workspace\r\n\t2021-01-13 13:23:37,409 [INFO] Copy tutorials to /workspace folder\r\n\t2021-01-13 13:23:37,520 [INFO] Running config backup restore.\r\n\t2021-01-13 13:23:37,520 [INFO] Nothing to restore. Config backup folder is empty.\r\n\t2021-01-13 13:23:37,526 [INFO] Configure ssh service\r\n\t2021-01-13 13:23:37,576 [INFO] Creating new SSH Key (id_ed25519)\r\n\tAgent pid 41\r\n\tIdentity added: /root/.ssh/id_ed25519 (root@3aeea7d289d1)\r\n\t2021-01-13 13:23:37,626 [INFO] Configure nginx service\r\n\tGenerating self-signed certificate for SSL/HTTPS.\r\n\tERROR: usage: test [options] [file_or_dir] [file_or_dir] [...]\r\n\ttest: error: unrecognized arguments: -e\r\n\t  inifile: None\r\n\t  rootdir: /etc/ssl/certs\r\n\tERROR: usage: test [options] [file_or_dir] [file_or_dir] [...]\r\n\ttest: error: unrecognized arguments: -e\r\n\t  inifile: None\r\n\t  rootdir: /etc/ssl/certs\r\n\tERROR: usage: test [options] [file_or_dir] [file_or_dir] [...]\r\n\ttest: error: unrecognized arguments: -e\r\n\t  inifile: None\r\n\t  rootdir: /etc/ssl/certs\r\n\r\n        ...\r\n\r\n\tERROR: usage: test [options] [file_or_dir] [file_or_dir] [...]\r\n\ttest: error: unrecognized arguments: -e\r\n\t  inifile: None\r\n\t  rootdir: /etc/ssl/certs\r\n\tERROR: usage: test [options] [file_or_dir] [file_or_dir] [...]\r\n\ttest: error: unrecognized arguments: -e\r\n\t  inifile: None\r\n\t  rootdir: /etc/ssl/certs\r\n\tWarning: there was a problem reading the certificate file /etc/ssl/certs/cert.pem. Message:\r\n\t  /etc/ssl/certs/cert.pem (No such file or directory)\r\n\t/resources/scripts/setup-certs.sh: 26: /resources/scripts/setup-certs.sh: cannot create /opt/conda/envs/python2/lib/python2.7/site-packages/certifi/cacert.pem: Directory nonexistent\r\n\t2021-01-13 13:28:31,325 [INFO] Configure tools\r\n\t2021-01-13 13:28:31,389 [INFO] Initialize filebrowser database.\r\n\t2021-01-13 13:28:31,423 [INFO] Create filebrowser admin with generated password: jzwdoikaqyspxumgnvhb\r\n\t2021-01-13 13:28:31,540 [INFO] Configure cron scripts\r\n\t2021-01-13 13:28:31,710 [INFO] Scheduling cron check xfdesktop task with with cron: 0 * * * *\r\n\t2021-01-13 13:28:31,715 [INFO] Running cron jobs:\r\n\t2021-01-13 13:28:31,715 [INFO] @hourly /opt/conda/bin/python '/resources/scripts/check_xfdesktop_leak.py' check> /proc/1/fd/1 2>/proc/1/fd/2\r\n\t2021-01-13 13:28:31,784 [INFO] Starting configuration backup.\r\n\t2021-01-13 13:28:31,876 [INFO] Scheduling cron config backup task with with cron: 0 * * * *\r\n\t2021-01-13 13:28:31,882 [INFO] Running cron jobs:\r\n\t2021-01-13 13:28:31,882 [INFO] @hourly /opt/conda/bin/python '/resources/scripts/check_xfdesktop_leak.py' check> /proc/1/fd/1 2>/proc/1/fd/2\r\n\t2021-01-13 13:28:31,882 [INFO] @hourly . /resources/environment.sh; /opt/conda/bin/python '/resources/scripts/backup_restore_config.py' backup> /proc/1/fd/1 2>/proc/1/fd/2\r\n\t2021-01-13 13:28:31,899 [INFO] Configure and run custom scripts\r\n\t2021-01-13 13:28:32,148 INFO Included extra file \"/etc/supervisor/conf.d/cron.conf\" during parsing\r\n\t2021-01-13 13:28:32,148 INFO Included extra file \"/etc/supervisor/conf.d/filebrowser.conf\" during parsing\r\n\t2021-01-13 13:28:32,148 INFO Included extra file \"/etc/supervisor/conf.d/glances.conf\" during parsing\r\n\t2021-01-13 13:28:32,148 INFO Included extra file \"/etc/supervisor/conf.d/jupyter.conf\" during parsing\r\n\t2021-01-13 13:28:32,148 INFO Included extra file \"/etc/supervisor/conf.d/netdata.conf\" during parsing\r\n\t2021-01-13 13:28:32,148 INFO Included extra file \"/etc/supervisor/conf.d/nginx.conf\" during parsing\r\n\t2021-01-13 13:28:32,148 INFO Included extra file \"/etc/supervisor/conf.d/novnc.conf\" during parsing\r\n\t2021-01-13 13:28:32,149 INFO Included extra file \"/etc/supervisor/conf.d/rsyslog.conf\" during parsing\r\n\t2021-01-13 13:28:32,149 INFO Included extra file \"/etc/supervisor/conf.d/sshd.conf\" during parsing\r\n\t2021-01-13 13:28:32,149 INFO Included extra file \"/etc/supervisor/conf.d/sslh.conf\" during parsing\r\n\t2021-01-13 13:28:32,149 INFO Included extra file \"/etc/supervisor/conf.d/ungit.conf\" during parsing\r\n\t2021-01-13 13:28:32,149 INFO Included extra file \"/etc/supervisor/conf.d/vncserver.conf\" during parsing\r\n\t2021-01-13 13:28:32,149 INFO Included extra file \"/etc/supervisor/conf.d/vscode.conf\" during parsing\r\n\t2021-01-13 13:28:32,149 INFO Included extra file \"/etc/supervisor/conf.d/xrdp.conf\" during parsing\r\n\t2021-01-13 13:28:32,149 INFO Set uid to user 0 succeeded\r\n\t2021-01-13 13:28:32,159 INFO RPC interface 'supervisor' initialized\r\n\t2021-01-13 13:28:32,159 CRIT Server 'inet_http_server' running without any HTTP authentication checking\r\n\t2021-01-13 13:28:32,159 INFO RPC interface 'supervisor' initialized\r\n\t2021-01-13 13:28:32,159 CRIT Server 'unix_http_server' running without any HTTP authentication checking\r\n\t2021-01-13 13:28:32,159 INFO supervisord started with pid 1717\r\n\t2021-01-13 13:28:33,162 INFO spawned: 'rsyslog' with pid 1719\r\n\t2021-01-13 13:28:33,164 INFO spawned: 'nginx' with pid 1720\r\n\t2021-01-13 13:28:33,166 INFO spawned: 'sslh' with pid 1721\r\n\t2021-01-13 13:28:33,169 INFO spawned: 'sshd' with pid 1722\r\n\t2021-01-13 13:28:33,171 INFO spawned: 'jupyter' with pid 1723\r\n\t2021-01-13 13:28:33,173 INFO spawned: 'vncserver' with pid 1727\r\n\t2021-01-13 13:28:33,175 INFO spawned: 'cron' with pid 1728\r\n\t2021-01-13 13:28:33,177 INFO spawned: 'filebrowser' with pid 1729\r\n\t2021-01-13 13:28:33,179 INFO spawned: 'glances' with pid 1732\r\n\t2021-01-13 13:28:33,181 INFO spawned: 'netdata' with pid 1734\r\n\t2021-01-13 13:28:33,183 INFO spawned: 'novnc' with pid 1736\r\n\t2021-01-13 13:28:33,185 INFO spawned: 'ungit' with pid 1743\r\n\t2021-01-13 13:28:33,187 INFO spawned: 'vscode' with pid 1745\r\n\t2021-01-13 13:28:33,189 INFO spawned: 'xrdp' with pid 1747\r\n\t2021-01-13 13:28:34,212 INFO success: rsyslog entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n\t2021-01-13 13:28:34,212 INFO success: nginx entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n\t2021-01-13 13:28:34,212 INFO success: sslh entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n\t2021-01-13 13:28:34,212 INFO success: sshd entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n\t2021-01-13 13:28:34,212 INFO success: jupyter entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n\t2021-01-13 13:28:34,212 INFO success: vncserver entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n\t2021-01-13 13:28:34,212 INFO success: cron entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n\t2021-01-13 13:28:34,212 INFO success: filebrowser entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n\t2021-01-13 13:28:34,212 INFO success: glances entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n\t2021-01-13 13:28:34,212 INFO success: netdata entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n\t2021-01-13 13:28:34,212 INFO success: novnc entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n\t2021-01-13 13:28:34,212 INFO success: ungit entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n\t2021-01-13 13:28:34,212 INFO success: vscode entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n\t2021-01-13 13:28:34,212 INFO success: xrdp entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n\t2021-01-13 13:28:36.904169: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1\r\n\t2021-01-13 14:00:01,277 [INFO] Starting configuration backup.\r\n\r\nAs you can see the `update-ca-certificates` causes a crash. After about 5 min the system keeps going and runs into the nex issue sine the path `/opt/conda/envs/python2/lib/python2.7` does not exsist.\r\nI suppose this old python 2.7 path is no longer valied since you're using Python 3.X so I'm not that bothered by it.\r\nBut the `update-ca-certificates`-Bug leads to me beeing unable to install e.g. RStudio within the container.\r\nI Hope that using another Ubuntu base image will fix this issue.\r\n\r\nB.t.w. is it a lot of work for you to upgrade yout R 3.6.1 to the R 4.0.3 Version?\r\n\r\nThanks for you wunderfull Software.\r\n","closed_by":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ml-tooling/ml-workspace/issues/69/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ml-tooling/ml-workspace/issues/69/timeline","performed_via_github_app":null,"state_reason":"completed"}