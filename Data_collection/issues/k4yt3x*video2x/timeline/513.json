[{"id":4814076028,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQ0ODE0MDc2MDI4","url":"https://api.github.com/repos/k4yt3x/video2x/issues/events/4814076028","actor":{"login":"jrobgh","id":84988403,"node_id":"MDQ6VXNlcjg0OTg4NDAz","avatar_url":"https://avatars.githubusercontent.com/u/84988403?v=4","gravatar_id":"","url":"https://api.github.com/users/jrobgh","html_url":"https://github.com/jrobgh","followers_url":"https://api.github.com/users/jrobgh/followers","following_url":"https://api.github.com/users/jrobgh/following{/other_user}","gists_url":"https://api.github.com/users/jrobgh/gists{/gist_id}","starred_url":"https://api.github.com/users/jrobgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrobgh/subscriptions","organizations_url":"https://api.github.com/users/jrobgh/orgs","repos_url":"https://api.github.com/users/jrobgh/repos","events_url":"https://api.github.com/users/jrobgh/events{/privacy}","received_events_url":"https://api.github.com/users/jrobgh/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2021-05-28T18:13:29Z","assignee":{"login":"k4yt3x","id":21986859,"node_id":"MDQ6VXNlcjIxOTg2ODU5","avatar_url":"https://avatars.githubusercontent.com/u/21986859?v=4","gravatar_id":"","url":"https://api.github.com/users/k4yt3x","html_url":"https://github.com/k4yt3x","followers_url":"https://api.github.com/users/k4yt3x/followers","following_url":"https://api.github.com/users/k4yt3x/following{/other_user}","gists_url":"https://api.github.com/users/k4yt3x/gists{/gist_id}","starred_url":"https://api.github.com/users/k4yt3x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k4yt3x/subscriptions","organizations_url":"https://api.github.com/users/k4yt3x/orgs","repos_url":"https://api.github.com/users/k4yt3x/repos","events_url":"https://api.github.com/users/k4yt3x/events{/privacy}","received_events_url":"https://api.github.com/users/k4yt3x/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/k4yt3x/video2x/issues/comments/850703820","html_url":"https://github.com/k4yt3x/video2x/issues/513#issuecomment-850703820","issue_url":"https://api.github.com/repos/k4yt3x/video2x/issues/513","id":850703820,"node_id":"MDEyOklzc3VlQ29tbWVudDg1MDcwMzgyMA==","user":{"login":"k4yt3x","id":21986859,"node_id":"MDQ6VXNlcjIxOTg2ODU5","avatar_url":"https://avatars.githubusercontent.com/u/21986859?v=4","gravatar_id":"","url":"https://api.github.com/users/k4yt3x","html_url":"https://github.com/k4yt3x","followers_url":"https://api.github.com/users/k4yt3x/followers","following_url":"https://api.github.com/users/k4yt3x/following{/other_user}","gists_url":"https://api.github.com/users/k4yt3x/gists{/gist_id}","starred_url":"https://api.github.com/users/k4yt3x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k4yt3x/subscriptions","organizations_url":"https://api.github.com/users/k4yt3x/orgs","repos_url":"https://api.github.com/users/k4yt3x/repos","events_url":"https://api.github.com/users/k4yt3x/events{/privacy}","received_events_url":"https://api.github.com/users/k4yt3x/received_events","type":"User","site_admin":false},"created_at":"2021-05-28T22:27:11Z","updated_at":"2021-05-28T22:27:11Z","author_association":"OWNER","body":"Please upload the error log file. The logs from the terminal does not contain STDOUT output.","reactions":{"url":"https://api.github.com/repos/k4yt3x/video2x/issues/comments/850703820/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"k4yt3x","id":21986859,"node_id":"MDQ6VXNlcjIxOTg2ODU5","avatar_url":"https://avatars.githubusercontent.com/u/21986859?v=4","gravatar_id":"","url":"https://api.github.com/users/k4yt3x","html_url":"https://github.com/k4yt3x","followers_url":"https://api.github.com/users/k4yt3x/followers","following_url":"https://api.github.com/users/k4yt3x/following{/other_user}","gists_url":"https://api.github.com/users/k4yt3x/gists{/gist_id}","starred_url":"https://api.github.com/users/k4yt3x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k4yt3x/subscriptions","organizations_url":"https://api.github.com/users/k4yt3x/orgs","repos_url":"https://api.github.com/users/k4yt3x/repos","events_url":"https://api.github.com/users/k4yt3x/events{/privacy}","received_events_url":"https://api.github.com/users/k4yt3x/received_events","type":"User","site_admin":false}},{"id":6015504713,"node_id":"CE_lADOB1EkMc41_gnIzwAAAAFmjVFJ","url":"https://api.github.com/repos/k4yt3x/video2x/issues/events/6015504713","actor":{"login":"k4yt3x","id":21986859,"node_id":"MDQ6VXNlcjIxOTg2ODU5","avatar_url":"https://avatars.githubusercontent.com/u/21986859?v=4","gravatar_id":"","url":"https://api.github.com/users/k4yt3x","html_url":"https://github.com/k4yt3x","followers_url":"https://api.github.com/users/k4yt3x/followers","following_url":"https://api.github.com/users/k4yt3x/following{/other_user}","gists_url":"https://api.github.com/users/k4yt3x/gists{/gist_id}","starred_url":"https://api.github.com/users/k4yt3x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k4yt3x/subscriptions","organizations_url":"https://api.github.com/users/k4yt3x/orgs","repos_url":"https://api.github.com/users/k4yt3x/repos","events_url":"https://api.github.com/users/k4yt3x/events{/privacy}","received_events_url":"https://api.github.com/users/k4yt3x/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-02-06T20:30:05Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/k4yt3x/video2x/issues/comments/1215975266","html_url":"https://github.com/k4yt3x/video2x/issues/513#issuecomment-1215975266","issue_url":"https://api.github.com/repos/k4yt3x/video2x/issues/513","id":1215975266,"node_id":"IC_kwDOB1EkMc5Iek9i","user":{"login":"ArakiSatoshi","id":45124115,"node_id":"MDQ6VXNlcjQ1MTI0MTE1","avatar_url":"https://avatars.githubusercontent.com/u/45124115?v=4","gravatar_id":"","url":"https://api.github.com/users/ArakiSatoshi","html_url":"https://github.com/ArakiSatoshi","followers_url":"https://api.github.com/users/ArakiSatoshi/followers","following_url":"https://api.github.com/users/ArakiSatoshi/following{/other_user}","gists_url":"https://api.github.com/users/ArakiSatoshi/gists{/gist_id}","starred_url":"https://api.github.com/users/ArakiSatoshi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArakiSatoshi/subscriptions","organizations_url":"https://api.github.com/users/ArakiSatoshi/orgs","repos_url":"https://api.github.com/users/ArakiSatoshi/repos","events_url":"https://api.github.com/users/ArakiSatoshi/events{/privacy}","received_events_url":"https://api.github.com/users/ArakiSatoshi/received_events","type":"User","site_admin":false},"created_at":"2022-08-15T23:20:52Z","updated_at":"2022-08-15T23:45:38Z","author_association":"NONE","body":"I have the same issue. It's simple to trace what's happening when you choose anything except .png:\r\n\r\n1. Video2X listens to the `extracted_frame_format: jpg` line in the video2x.yaml file and extracts the files as .**jpg**\r\n\r\n`INFO: Executing: C:\\video2x-4.8.1-win32-full\\dependencies\\ffmpeg\\bin\\ffmpeg -hwaccel auto -y -i E:\\Downloads\\1_edit.mp4 -pix_fmt rgb24 -qscale:v 1 C:\\cache-test\\cache\\tmpjfb4t58d\\extracted_%0d.jpg`\r\n\r\n\\tmpjfb4t58d\r\n- extracted_1.**jpg**\r\n- extracted_2.**jpg**\r\n- extracted_3.**jpg**\r\n- ...\r\n\r\n2. Video2X handles this data to Anime4KCPP for it to upscale. It is not specified to Anime4KCPP to use .jpg, so Anime4KCPP outputs the upscaled images as .png\r\n\r\n`INFO: [upscaler] Subprocess 260 executing: C:\\video2x-4.8.1-win32-full\\dependencies\\anime4kcpp\\CLI\\Anime4KCPP_CLI\\Anime4KCPP_CLI --passes 2 --pushColorCount 2 --strengthColor 0.3 --strengthGradient 1.0 --zoomFactor 2.0 --threads 16 --preprocessing --postprocessing --preFilters 4 --postFilters 40 --GPUMode --CNNMode --HDN --HDNLevel 1 --platformID 0 --deviceID 0 --codec mp4v --forceFps 0.0 --input C:\\cache-test\\cache\\tmpjfb4t58d --output C:\\cache-test\\cache\\tmp9p39zad0`\r\n\r\n\\tmp9p39zad0\r\n- extracted_1.**png**\r\n- extracted_2.**png**\r\n- extracted_3.**png**\r\n- ...\r\n\r\n3. Video2X handles the upscaled images to ffmpeg as .jpg, having no idea that the images Anime4KCPP produced are .png images\r\n\r\n`INFO: Executing: C:\\video2x-4.8.1-win32-full\\dependencies\\ffmpeg\\bin\\ffmpeg -r 23.976023976023978 -hwaccel auto -y -f image2 -i C:\\cache-test\\cache\\tmp9p39zad0\\extracted_%d.jpg -vcodec hevc_amf -pix_fmt yuv420p -crf 12 -vf pad=ceil(iw/2)*2:ceil(ih/2)*2 C:\\cache-test\\cache\\tmp9p39zad0\\intermediate.mkv`\r\n\r\n4. ffmpeg expectedly returns an error, Video2X handles the generalized error to the user in the frontend.\r\n\r\nIf you try to run the command above manually (changing tmp9p39zad0 to tmpjfb4t58d since \"Preserve Frames\" moves the upscaled frames to the initial input folder after an error on this step)\r\n\r\n`C:\\video2x-4.8.1-win32-full\\dependencies\\ffmpeg\\bin\\ffmpeg -r 23.976023976023978 -hwaccel auto -y -f image2 -i C:\\cache-test\\cache\\tmpjfb4t58d\\extracted_%d.jpg -vcodec hevc_amf -pix_fmt yuv420p -crf 12 -vf pad=ceil(iw/2)*2:ceil(ih/2)*2 C:\\cache-test\\cache\\tmp9p39zad0\\intermediate.mkv`\r\n\r\n ffmpeg tells you this:\r\n\r\n`[image2 @ 00000265a884e600] Could find no file with path 'C:\\cache-test\\cache\\tmpjfb4t58d\\extracted_%d.jpg' and index in the range 0-4`\r\n`C:\\cache-test\\cache\\tmpjfb4t58d\\extracted_%d.jpg: No such file or directory`\r\n\r\nThis is expected since there are no .jpg files, those are .png, as Anime4KCPP outputted. Simply changing extracted_%d.jpg to extracted_%d.png:\r\n\r\n`C:\\video2x-4.8.1-win32-full\\dependencies\\ffmpeg\\bin\\ffmpeg -r 23.976023976023978 -hwaccel auto -y -f image2 -i C:\\cache-test\\cache\\tmpjfb4t58d\\extracted_%d.png -vcodec hevc_amf -pix_fmt yuv420p -crf 12 -vf pad=ceil(iw/2)*2:ceil(ih/2)*2 C:\\cache-test\\cache\\tmp9p39zad0\\intermediate.mkv`\r\n\r\nWill produce a nice and clean intermediate.mkv file from the upscaled images.\r\n\r\nSo the workaround for this would be to upscale something with Anime2x with the frames preserved and then use these upscaled frames to manually combine them with ffmpeg.\r\nHowever, this does not solve the initial problem. Anime4KCPP upscales the images as .png, this is not what the user wants. In their [CLI documentation](https://github.com/TianZerL/Anime4KCPP/wiki/CLI) they have this:\r\n\r\n```\r\n  -o, --output\r\n        File for outputting\r\n         (string [=output.png])\r\n```\r\n\r\nWhich does exist in the video2x.yaml:\r\n\r\n`  #output: null # File for outputting (string [=output.png])`\r\n\r\nBut it's written in a confusing way for me, and it is `#` commented by the Video2x's developer in the first place.\r\n\r\nFull terminal output:\r\n\r\n```\r\n[+] INFO: Loading files into processing queue\r\n2022-08-16 01:37:04.682716 [+] INFO: Input path(s): E:\\Downloads\\1_edit.mp4\r\n2022-08-16 01:37:04.684716 [+] INFO: File MIME type: video/mp4\r\n[+] INFO: Loaded files into processing queue\r\n2022-08-16 01:37:04.687717 [+] INFO: Input file: E:\\Downloads\\1_edit.mp4\r\n[+] INFO: Reading file information\r\n2022-08-16 01:37:04.688717 [+] INFO: Executing: C:\\video2x-4.8.1-win32-full\\dependencies\\ffmpeg\\bin\\ffprobe -v quiet -print_format json -show_format -show_streams -i E:\\Downloads\\1_edit.mp4\r\n2022-08-16 01:37:04.746731 [+] INFO: Creating cache directory C:\\cache-test\\cache\r\n2022-08-16 01:37:04.747732 [+] INFO: Extracted frames are being saved to: C:\\cache-test\\cache\\tmpjfb4t58d\r\n2022-08-16 01:37:04.747732 [+] INFO: Upscaled frames are being saved to: C:\\cache-test\\cache\\tmp9p39zad0\r\n[+] INFO: Starting upscaling video/GIF\r\n[+] INFO: Getting total number of frames in the file\r\n[+] INFO: Calculating scaling parameters\r\n2022-08-16 01:37:04.748731 [+] INFO: Framerate: 23.976023976023978\r\n2022-08-16 01:37:04.749732 [+] INFO: Width: 854\r\n2022-08-16 01:37:04.749732 [+] INFO: Height: 480\r\n2022-08-16 01:37:04.749732 [+] INFO: Total number of frames: 120\r\n2022-08-16 01:37:04.749732 [+] INFO: Output width: 1708\r\n2022-08-16 01:37:04.749732 [+] INFO: Output height: 960\r\n2022-08-16 01:37:04.749732 [+] INFO: Required scale ratio: 2.0\r\n2022-08-16 01:37:04.750742 [+] INFO: Upscaling jobs queue: [2.0]\r\n2022-08-16 01:37:04.750742 [+] INFO: Executing: C:\\video2x-4.8.1-win32-full\\dependencies\\ffmpeg\\bin\\ffmpeg -hwaccel auto -y -i E:\\Downloads\\1_edit.mp4 -pix_fmt rgb24 -qscale:v 1 C:\\cache-test\\cache\\tmpjfb4t58d\\extracted_%0d.jpg\r\n2022-08-16 01:37:04.752732 [+] INFO: Main process waiting for subprocesses to exit\r\n2022-08-16 01:37:05.358951 [+] INFO: Subprocess 2972 exited with code 0\r\n[+] INFO: Starting to upscale extracted frames\r\n2022-08-16 01:37:05.466966 [+] INFO: [upscaler] Subprocess 260 executing: C:\\video2x-4.8.1-win32-full\\dependencies\\anime4kcpp\\CLI\\Anime4KCPP_CLI\\Anime4KCPP_CLI --passes 2 --pushColorCount 2 --strengthColor 0.3 --strengthGradient 1.0 --zoomFactor 2.0 --threads 16 --preprocessing --postprocessing --preFilters 4 --postFilters 40 --GPUMode --CNNMode --HDN --HDNLevel 1 --platformID 0 --deviceID 0 --codec mp4v --forceFps 0.0 --input C:\\cache-test\\cache\\tmpjfb4t58d --output C:\\cache-test\\cache\\tmp9p39zad0\r\n2022-08-16 01:37:05.469966 [+] INFO: Starting progress monitor\r\n2022-08-16 01:37:05.470966 [+] INFO: Starting upscaled image cleaner\r\n2022-08-16 01:37:05.472966 [+] INFO: Main process waiting for subprocesses to exit\r\nProcessing: 1_edit.mp4 (pass 1/1):   0%|                                                       | 0/120 [00:04<?, ?it/s]2022-08-16 01:37:09.643216 [+] INFO: Subprocess 2340 exited with code 0\r\n2022-08-16 01:37:09.753240 [+] INFO: Killing progress monitor\r\nProcessing: 1_edit.mp4 (pass 1/1):   0%|                                                       | 0/120 [00:05<?, ?it/s]\r\n2022-08-16 01:37:10.524631 [+] INFO: Killing upscaled image cleaner\r\n[+] INFO: Upscaling completed\r\n[+] INFO: Average processing speed: 19.798722853075237 seconds per frame\r\n[+] INFO: Lanczos downscaling frames\r\nDownscaling: 0it [00:00, ?it/s]\r\n[+] INFO: Converting extracted frames into video\r\n2022-08-16 01:37:11.563963 [+] INFO: Executing: C:\\video2x-4.8.1-win32-full\\dependencies\\ffmpeg\\bin\\ffmpeg -r 23.976023976023978 -hwaccel auto -y -f image2 -i C:\\cache-test\\cache\\tmp9p39zad0\\extracted_%d.jpg -vcodec hevc_amf -pix_fmt yuv420p -crf 12 -vf pad=ceil(iw/2)*2:ceil(ih/2)*2 C:\\cache-test\\cache\\tmp9p39zad0\\intermediate.mkv\r\n2022-08-16 01:37:11.565963 [+] INFO: Main process waiting for subprocesses to exit\r\n[!] ERROR: Subprocess 11572 exited with code 1\r\n[!] ERROR: Subprocess execution ran into an error\r\n[!] WARNING: Terminating all processes\r\nTraceback (most recent call last):\r\n  File \"video2x_gui.py\", line 105, in run\r\n  File \"upscaler.py\", line 1022, in run\r\n  File \"upscaler.py\", line 941, in run\r\n  File \"upscaler.py\", line 489, in _wait\r\n  File \"upscaler.py\", line 467, in _wait\r\nsubprocess.CalledProcessError: Command '['C:\\\\video2x-4.8.1-win32-full\\\\dependencies\\\\ffmpeg\\\\bin\\\\ffmpeg', '-r', '23.976023976023978', '-hwaccel', 'auto', '-y', '-f', 'image2', '-i', 'C:\\\\cache-test\\\\cache\\\\tmp9p39zad0\\\\extracted_%d.jpg', '-vcodec', 'hevc_amf', '-pix_fmt', 'yuv420p', '-crf', '12', '-vf', 'pad=ceil(iw/2)*2:ceil(ih/2)*2', 'C:\\\\cache-test\\\\cache\\\\tmp9p39zad0\\\\intermediate.mkv']' returned non-zero exit status 1.\r\n```","reactions":{"url":"https://api.github.com/repos/k4yt3x/video2x/issues/comments/1215975266/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ArakiSatoshi","id":45124115,"node_id":"MDQ6VXNlcjQ1MTI0MTE1","avatar_url":"https://avatars.githubusercontent.com/u/45124115?v=4","gravatar_id":"","url":"https://api.github.com/users/ArakiSatoshi","html_url":"https://github.com/ArakiSatoshi","followers_url":"https://api.github.com/users/ArakiSatoshi/followers","following_url":"https://api.github.com/users/ArakiSatoshi/following{/other_user}","gists_url":"https://api.github.com/users/ArakiSatoshi/gists{/gist_id}","starred_url":"https://api.github.com/users/ArakiSatoshi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArakiSatoshi/subscriptions","organizations_url":"https://api.github.com/users/ArakiSatoshi/orgs","repos_url":"https://api.github.com/users/ArakiSatoshi/repos","events_url":"https://api.github.com/users/ArakiSatoshi/events{/privacy}","received_events_url":"https://api.github.com/users/ArakiSatoshi/received_events","type":"User","site_admin":false}}]