{"url":"https://api.github.com/repos/k4yt3x/video2x/issues/100","repository_url":"https://api.github.com/repos/k4yt3x/video2x","labels_url":"https://api.github.com/repos/k4yt3x/video2x/issues/100/labels{/name}","comments_url":"https://api.github.com/repos/k4yt3x/video2x/issues/100/comments","events_url":"https://api.github.com/repos/k4yt3x/video2x/issues/100/events","html_url":"https://github.com/k4yt3x/video2x/issues/100","id":451236876,"node_id":"MDU6SXNzdWU0NTEyMzY4NzY=","number":100,"title":"ffmpeg json issues ","user":{"login":"akai-katto","id":28079088,"node_id":"MDQ6VXNlcjI4MDc5MDg4","avatar_url":"https://avatars.githubusercontent.com/u/28079088?v=4","gravatar_id":"","url":"https://api.github.com/users/akai-katto","html_url":"https://github.com/akai-katto","followers_url":"https://api.github.com/users/akai-katto/followers","following_url":"https://api.github.com/users/akai-katto/following{/other_user}","gists_url":"https://api.github.com/users/akai-katto/gists{/gist_id}","starred_url":"https://api.github.com/users/akai-katto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akai-katto/subscriptions","organizations_url":"https://api.github.com/users/akai-katto/orgs","repos_url":"https://api.github.com/users/akai-katto/repos","events_url":"https://api.github.com/users/akai-katto/events{/privacy}","received_events_url":"https://api.github.com/users/akai-katto/received_events","type":"User","site_admin":false},"labels":[{"id":847238628,"node_id":"MDU6TGFiZWw4NDcyMzg2Mjg=","url":"https://api.github.com/repos/k4yt3x/video2x/labels/type:Bug","name":"type:Bug","color":"d80000","default":false,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"k4yt3x","id":21986859,"node_id":"MDQ6VXNlcjIxOTg2ODU5","avatar_url":"https://avatars.githubusercontent.com/u/21986859?v=4","gravatar_id":"","url":"https://api.github.com/users/k4yt3x","html_url":"https://github.com/k4yt3x","followers_url":"https://api.github.com/users/k4yt3x/followers","following_url":"https://api.github.com/users/k4yt3x/following{/other_user}","gists_url":"https://api.github.com/users/k4yt3x/gists{/gist_id}","starred_url":"https://api.github.com/users/k4yt3x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k4yt3x/subscriptions","organizations_url":"https://api.github.com/users/k4yt3x/orgs","repos_url":"https://api.github.com/users/k4yt3x/repos","events_url":"https://api.github.com/users/k4yt3x/events{/privacy}","received_events_url":"https://api.github.com/users/k4yt3x/received_events","type":"User","site_admin":false},"assignees":[{"login":"k4yt3x","id":21986859,"node_id":"MDQ6VXNlcjIxOTg2ODU5","avatar_url":"https://avatars.githubusercontent.com/u/21986859?v=4","gravatar_id":"","url":"https://api.github.com/users/k4yt3x","html_url":"https://github.com/k4yt3x","followers_url":"https://api.github.com/users/k4yt3x/followers","following_url":"https://api.github.com/users/k4yt3x/following{/other_user}","gists_url":"https://api.github.com/users/k4yt3x/gists{/gist_id}","starred_url":"https://api.github.com/users/k4yt3x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k4yt3x/subscriptions","organizations_url":"https://api.github.com/users/k4yt3x/orgs","repos_url":"https://api.github.com/users/k4yt3x/repos","events_url":"https://api.github.com/users/k4yt3x/events{/privacy}","received_events_url":"https://api.github.com/users/k4yt3x/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2019-06-02T21:28:55Z","updated_at":"2019-06-06T14:44:56Z","closed_at":"2019-06-06T14:44:56Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"Under \r\n\r\n```\r\n\"video_to_frames\": {\r\n    \"-qscale:v\": null,\r\n    \"-hwaccel\": \"auto\",\r\n    \"-y\": true\r\n},\r\n```\r\n\r\nSetting `-qscale:v` to `2` (anything not null essentially) is an invalid input for ffmpeg.\r\n\r\nThe culprit ( I believe ) is any filter or qscale needs to go after input, where as in the current wrapper, all the settings are inserted before \r\n\r\nI.e\r\n\r\n(psuedo code)\r\n\r\n`ffmpeg.exe -qscale:v 2 -i input.mkv output.mkv`\r\n\r\nIs invalid, but \r\n\r\n\r\n`ffmpeg.exe -i input.mkv  -qscale:v 2 output.mkv`\r\n\r\nIs valid.\r\n\r\nvideo2x's ffmpeg.py uses the former command. \r\n\r\nMy temporary solution involves adding another json category (titled 'filters') that needs to go after the input, i.e\r\n\r\n\r\n# video2x.json\r\n\r\n```\r\n....\"ffmpeg\": {\r\n    \"ffmpeg_path\": \"C:\\\\Users\\\\windwoz\\\\AppData\\\\Local\\\\video2x\\\\ffmpeg-latest-win64-static\\\\bin\",\r\n    \"video_to_frames\": {\r\n        \"-ss\": \"00:05:01\",\r\n        \"-t\": \"00:00:02\",\r\n        \"-hwaccel\": \"auto\",\r\n        \"-y\": true\r\n    },\r\n    \"filters\": {\r\n        \"-qscale:v\": \"2\"\r\n    },\r\n.....\r\n```\r\n\r\n# ffmpeg.py (lines 89+)\r\n\r\n```\r\n        execute.extend(self._read_configuration(phase='video_to_frames'))\r\n\r\n        execute.extend([\r\n            '-i',\r\n            input_video\r\n        ])\r\n\r\n        execute.extend(self._read_configuration(phase='filters'))\r\n\r\n        execute.extend([f'{extracted_frames}extracted_%0d.{self.image_format}'])\r\n\r\n        self._execute(execute)\r\n```\r\n\r\n","closed_by":{"login":"k4yt3x","id":21986859,"node_id":"MDQ6VXNlcjIxOTg2ODU5","avatar_url":"https://avatars.githubusercontent.com/u/21986859?v=4","gravatar_id":"","url":"https://api.github.com/users/k4yt3x","html_url":"https://github.com/k4yt3x","followers_url":"https://api.github.com/users/k4yt3x/followers","following_url":"https://api.github.com/users/k4yt3x/following{/other_user}","gists_url":"https://api.github.com/users/k4yt3x/gists{/gist_id}","starred_url":"https://api.github.com/users/k4yt3x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k4yt3x/subscriptions","organizations_url":"https://api.github.com/users/k4yt3x/orgs","repos_url":"https://api.github.com/users/k4yt3x/repos","events_url":"https://api.github.com/users/k4yt3x/events{/privacy}","received_events_url":"https://api.github.com/users/k4yt3x/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/k4yt3x/video2x/issues/100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/k4yt3x/video2x/issues/100/timeline","performed_via_github_app":null,"state_reason":"completed"}