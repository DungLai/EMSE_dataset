{"url":"https://api.github.com/repos/k4yt3x/video2x/issues/439","repository_url":"https://api.github.com/repos/k4yt3x/video2x","labels_url":"https://api.github.com/repos/k4yt3x/video2x/issues/439/labels{/name}","comments_url":"https://api.github.com/repos/k4yt3x/video2x/issues/439/comments","events_url":"https://api.github.com/repos/k4yt3x/video2x/issues/439/events","html_url":"https://github.com/k4yt3x/video2x/issues/439","id":775821671,"node_id":"MDU6SXNzdWU3NzU4MjE2NzE=","number":439,"title":"[Mac OS X 10.15.7] Locale error :: locale.getdefaultlocale() <-- (None, 'UTF-8')","user":{"login":"AlfredJKwack","id":557102,"node_id":"MDQ6VXNlcjU1NzEwMg==","avatar_url":"https://avatars.githubusercontent.com/u/557102?v=4","gravatar_id":"","url":"https://api.github.com/users/AlfredJKwack","html_url":"https://github.com/AlfredJKwack","followers_url":"https://api.github.com/users/AlfredJKwack/followers","following_url":"https://api.github.com/users/AlfredJKwack/following{/other_user}","gists_url":"https://api.github.com/users/AlfredJKwack/gists{/gist_id}","starred_url":"https://api.github.com/users/AlfredJKwack/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlfredJKwack/subscriptions","organizations_url":"https://api.github.com/users/AlfredJKwack/orgs","repos_url":"https://api.github.com/users/AlfredJKwack/repos","events_url":"https://api.github.com/users/AlfredJKwack/events{/privacy}","received_events_url":"https://api.github.com/users/AlfredJKwack/received_events","type":"User","site_admin":false},"labels":[{"id":847238628,"node_id":"MDU6TGFiZWw4NDcyMzg2Mjg=","url":"https://api.github.com/repos/k4yt3x/video2x/labels/type:Bug","name":"type:Bug","color":"d80000","default":false,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"k4yt3x","id":21986859,"node_id":"MDQ6VXNlcjIxOTg2ODU5","avatar_url":"https://avatars.githubusercontent.com/u/21986859?v=4","gravatar_id":"","url":"https://api.github.com/users/k4yt3x","html_url":"https://github.com/k4yt3x","followers_url":"https://api.github.com/users/k4yt3x/followers","following_url":"https://api.github.com/users/k4yt3x/following{/other_user}","gists_url":"https://api.github.com/users/k4yt3x/gists{/gist_id}","starred_url":"https://api.github.com/users/k4yt3x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k4yt3x/subscriptions","organizations_url":"https://api.github.com/users/k4yt3x/orgs","repos_url":"https://api.github.com/users/k4yt3x/repos","events_url":"https://api.github.com/users/k4yt3x/events{/privacy}","received_events_url":"https://api.github.com/users/k4yt3x/received_events","type":"User","site_admin":false},"assignees":[{"login":"k4yt3x","id":21986859,"node_id":"MDQ6VXNlcjIxOTg2ODU5","avatar_url":"https://avatars.githubusercontent.com/u/21986859?v=4","gravatar_id":"","url":"https://api.github.com/users/k4yt3x","html_url":"https://github.com/k4yt3x","followers_url":"https://api.github.com/users/k4yt3x/followers","following_url":"https://api.github.com/users/k4yt3x/following{/other_user}","gists_url":"https://api.github.com/users/k4yt3x/gists{/gist_id}","starred_url":"https://api.github.com/users/k4yt3x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k4yt3x/subscriptions","organizations_url":"https://api.github.com/users/k4yt3x/orgs","repos_url":"https://api.github.com/users/k4yt3x/repos","events_url":"https://api.github.com/users/k4yt3x/events{/privacy}","received_events_url":"https://api.github.com/users/k4yt3x/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2020-12-29T10:35:00Z","updated_at":"2020-12-30T07:13:14Z","closed_at":"2020-12-30T07:13:14Z","author_association":"NONE","active_lock_reason":null,"body":"## Component Versions\r\n\r\nPlease at least fill in the release version and GUI or CLI version.\r\n\r\n- **Video2X release version**: 4.8.1\r\n- **Upscaler version**: 4.4.1 - December 13, 2020\r\n- **GUI version**: 2.8.1 - December 13, 2020\r\n- **CLI version**: 4.3.1 - December 13, 2020\r\n\r\n## Symptom\r\n\r\nRunning either the CLI or the GUI version results in the same error related to internationalization.\r\nI'm running video2x on MacOS. All dependencies are satisfied. The issue is not with the app so much as it is with the locale of my shell. Below are the symptoms, what causes them and how it can be remediated. Hopefully this is of use to someone.\r\n\r\n## Error Log or Screenshots\r\n\r\n```\r\n~/bin/video2x/src (Git#4.8.1 )> python video2x.py                                                                                                                     \r\nTraceback (most recent call last):\r\n  File \"/Users/lesparents/bin/video2x/src/video2x.py\", line 53, in <module>\r\n    from upscaler import AVAILABLE_DRIVERS\r\n  File \"/Users/lesparents/bin/video2x/src/upscaler.py\", line 51, in <module>\r\n    language = gettext.translation(\r\n  File \"/Users/lesparents/.pyenv/versions/3.9.0/lib/python3.9/gettext.py\", line 587, in translation\r\n    mofiles = find(domain, localedir, languages, all=True)\r\n  File \"/Users/lesparents/.pyenv/versions/3.9.0/lib/python3.9/gettext.py\", line 558, in find\r\n    for nelang in _expand_lang(lang):\r\n  File \"/Users/lesparents/.pyenv/versions/3.9.0/lib/python3.9/gettext.py\", line 213, in _expand_lang\r\n    loc = locale.normalize(loc)\r\n  File \"/Users/lesparents/.pyenv/versions/3.9.0/lib/python3.9/locale.py\", line 403, in normalize\r\n    code = localename.lower()\r\nAttributeError: 'NoneType' object has no attribute 'lower'\r\n```\r\n\r\n##  Root cause\r\n```\r\n~/bin/video2x/src (Git#4.8.1 )> locale\r\nLANG=\"\"\r\nLC_COLLATE=\"C\"\r\nLC_CTYPE=\"UTF-8\"\r\nLC_MESSAGES=\"C\"\r\nLC_MONETARY=\"C\"\r\nLC_NUMERIC=\"C\"\r\nLC_TIME=\"C\"\r\nLC_ALL=\r\n```\r\nThe above environment creates a challenge for the localization implementation since `locale.getdefaultlocale()` will give you `(None, 'UTF-8')`. This is the source of the issue... I'm assuming that the `gettext.translation` call doesn't much like it when `default_locale = None`\r\n\r\n## Resolution\r\nEither set your locale in your .zshrc or .bashrc file as below (edit as required for your locale)\r\n```\r\n#set locale\r\nexport LC_ALL=en_US.UTF-8\r\nexport LC_CTYPE=en_US.UTF-8\r\n```\r\nOr you can disable 'set locale variables automatically' in iTerm or whatever the equivalent is in the terminal app.\r\n\r\nyour mileage may vary of course.","closed_by":{"login":"k4yt3x","id":21986859,"node_id":"MDQ6VXNlcjIxOTg2ODU5","avatar_url":"https://avatars.githubusercontent.com/u/21986859?v=4","gravatar_id":"","url":"https://api.github.com/users/k4yt3x","html_url":"https://github.com/k4yt3x","followers_url":"https://api.github.com/users/k4yt3x/followers","following_url":"https://api.github.com/users/k4yt3x/following{/other_user}","gists_url":"https://api.github.com/users/k4yt3x/gists{/gist_id}","starred_url":"https://api.github.com/users/k4yt3x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k4yt3x/subscriptions","organizations_url":"https://api.github.com/users/k4yt3x/orgs","repos_url":"https://api.github.com/users/k4yt3x/repos","events_url":"https://api.github.com/users/k4yt3x/events{/privacy}","received_events_url":"https://api.github.com/users/k4yt3x/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/k4yt3x/video2x/issues/439/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/k4yt3x/video2x/issues/439/timeline","performed_via_github_app":null,"state_reason":"completed"}