{"url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo/issues/97","repository_url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo","labels_url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo/issues/97/labels{/name}","comments_url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo/issues/97/comments","events_url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo/issues/97/events","html_url":"https://github.com/avinashpaliwal/Super-SloMo/issues/97","id":875405711,"node_id":"MDU6SXNzdWU4NzU0MDU3MTE=","number":97,"title":"Could be faster by not saving PNG frames","user":{"login":"artur-ag","id":9512554,"node_id":"MDQ6VXNlcjk1MTI1NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/9512554?v=4","gravatar_id":"","url":"https://api.github.com/users/artur-ag","html_url":"https://github.com/artur-ag","followers_url":"https://api.github.com/users/artur-ag/followers","following_url":"https://api.github.com/users/artur-ag/following{/other_user}","gists_url":"https://api.github.com/users/artur-ag/gists{/gist_id}","starred_url":"https://api.github.com/users/artur-ag/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/artur-ag/subscriptions","organizations_url":"https://api.github.com/users/artur-ag/orgs","repos_url":"https://api.github.com/users/artur-ag/repos","events_url":"https://api.github.com/users/artur-ag/events{/privacy}","received_events_url":"https://api.github.com/users/artur-ag/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-05-04T12:20:13Z","updated_at":"2021-05-04T12:20:13Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Is your feature request related to a problem? Please describe.**\r\nThe program could be faster by outputting the frames directly to ffmpeg, via a pipe, instead of saving PNG files and then reading them again. In my machine, doing this got me a 4x speedup for a 640x800 video.\r\n\r\nI already modified `video_to_slowmo.py` to achieve this. Would you like me to open a pull request? I can do that maybe tomorrow.\r\n\r\n**Describe the solution you'd like**\r\nUse [ffmpeg-python](https://github.com/kkroening/ffmpeg-python) in the `video_to_slowmo.py` script to save the output video in one go, instead of saving PNG images. Specifically, something like\r\n```\r\n# Prepare output stream\r\noutputProcess = (\r\n        ffmpeg\r\n        .input('pipe:', format='rawvideo', pix_fmt='rgb24', r=args.fps, s='{}x{}'.format(width, height))\r\n        .output(args.output, pix_fmt='yuv420p', r=args.fps)\r\n        .run_async(pipe_stdin=True)\r\n    )\r\n...\r\n# Save reference/intermediate frames\r\noutputProcess.stdin.write((TP(frame0[batchIndex].detach())).resize(videoFrames.origDim, Image.BILINEAR).tobytes())\r\n```\r\n\r\nI have `ffmpeg` in my PATH, so by default that's what's used, but it can probably be modified to use the `--ffmpeg_dir` argument that video_to_slowmo already uses.\r\n\r\n**Describe alternatives you've considered**\r\nN/A\r\n\r\n**Additional context**\r\nN/A","closed_by":null,"reactions":{"url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo/issues/97/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo/issues/97/timeline","performed_via_github_app":null,"state_reason":null}