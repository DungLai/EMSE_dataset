{"url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo/issues/56","repository_url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo","labels_url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo/issues/56/labels{/name}","comments_url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo/issues/56/comments","events_url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo/issues/56/events","html_url":"https://github.com/avinashpaliwal/Super-SloMo/issues/56","id":484614778,"node_id":"MDU6SXNzdWU0ODQ2MTQ3Nzg=","number":56,"title":"CPU Mode only using 2 threads on Mac","user":{"login":"FC-Jason","id":25483047,"node_id":"MDQ6VXNlcjI1NDgzMDQ3","avatar_url":"https://avatars.githubusercontent.com/u/25483047?v=4","gravatar_id":"","url":"https://api.github.com/users/FC-Jason","html_url":"https://github.com/FC-Jason","followers_url":"https://api.github.com/users/FC-Jason/followers","following_url":"https://api.github.com/users/FC-Jason/following{/other_user}","gists_url":"https://api.github.com/users/FC-Jason/gists{/gist_id}","starred_url":"https://api.github.com/users/FC-Jason/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FC-Jason/subscriptions","organizations_url":"https://api.github.com/users/FC-Jason/orgs","repos_url":"https://api.github.com/users/FC-Jason/repos","events_url":"https://api.github.com/users/FC-Jason/events{/privacy}","received_events_url":"https://api.github.com/users/FC-Jason/received_events","type":"User","site_admin":false},"labels":[{"id":1172098997,"node_id":"MDU6TGFiZWwxMTcyMDk4OTk3","url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1172099004,"node_id":"MDU6TGFiZWwxMTcyMDk5MDA0","url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo/labels/wontfix","name":"wontfix","color":"ffffff","default":true,"description":"This will not be worked on"}],"state":"closed","locked":false,"assignee":{"login":"avinashpaliwal","id":43282710,"node_id":"MDQ6VXNlcjQzMjgyNzEw","avatar_url":"https://avatars.githubusercontent.com/u/43282710?v=4","gravatar_id":"","url":"https://api.github.com/users/avinashpaliwal","html_url":"https://github.com/avinashpaliwal","followers_url":"https://api.github.com/users/avinashpaliwal/followers","following_url":"https://api.github.com/users/avinashpaliwal/following{/other_user}","gists_url":"https://api.github.com/users/avinashpaliwal/gists{/gist_id}","starred_url":"https://api.github.com/users/avinashpaliwal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avinashpaliwal/subscriptions","organizations_url":"https://api.github.com/users/avinashpaliwal/orgs","repos_url":"https://api.github.com/users/avinashpaliwal/repos","events_url":"https://api.github.com/users/avinashpaliwal/events{/privacy}","received_events_url":"https://api.github.com/users/avinashpaliwal/received_events","type":"User","site_admin":false},"assignees":[{"login":"avinashpaliwal","id":43282710,"node_id":"MDQ6VXNlcjQzMjgyNzEw","avatar_url":"https://avatars.githubusercontent.com/u/43282710?v=4","gravatar_id":"","url":"https://api.github.com/users/avinashpaliwal","html_url":"https://github.com/avinashpaliwal","followers_url":"https://api.github.com/users/avinashpaliwal/followers","following_url":"https://api.github.com/users/avinashpaliwal/following{/other_user}","gists_url":"https://api.github.com/users/avinashpaliwal/gists{/gist_id}","starred_url":"https://api.github.com/users/avinashpaliwal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avinashpaliwal/subscriptions","organizations_url":"https://api.github.com/users/avinashpaliwal/orgs","repos_url":"https://api.github.com/users/avinashpaliwal/repos","events_url":"https://api.github.com/users/avinashpaliwal/events{/privacy}","received_events_url":"https://api.github.com/users/avinashpaliwal/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2019-08-23T16:31:12Z","updated_at":"2019-12-03T16:30:47Z","closed_at":"2019-12-03T16:30:47Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nWhen running the slo mo conversion on a MAC, I'm only able to get 2 threads to process the video using CPU mode (no CUDA). RAM sits around 12 gigabytes used for processing, but I have 32 available.\r\n\r\n**To Reproduce**\r\n1. Running this script to convert: python video_to_slomo.py --ffmpeg /Users/user/slomo/ffmpeg/bin/ --video /Users/user/slomo/input/mountain_timelapse.mp4 --sf 4 --checkpoint /Users/user/slomo/superslomo/SuperSloMo.ckpt --fps 119.880 --output /Users/user/slomo/output/mountain120.mp4 --batch_size 2\r\n2. No matter what I change the batch_size to, it doesn't change the amount of CPU usage or RAM.  I've tried changing it to 10 and nothing happens.  If I run the same thing on Windows (no CUDA) a value of 2 eats up 32 gigs of ram and runs the processor on multiple cores.\r\n\r\n**Expected behavior**\r\nI would expect that as I increase the value of the batch_size on a Mac, that the CPU usage would go up and the process would complete faster.\r\n\r\n**Interpolated results/error output**\r\n(base) MacBook:superslomo user$ python video_to_slomo.py --ffmpeg /Users/user/slomo/ffmpeg/bin/ --video /Users/user/slomo/input/mountain_timelapse.mp4 --sf 4 --checkpoint /Users/user/slomo/superslomo/SuperSloMo.ckpt --fps 119.880 --output /Users/user/slomo/output/mountain120.mp4 --batch_size 2\r\n/Users/user/slomo/ffmpeg/bin/ffmpeg -i /Users/user/slomo/input/mountain_timelapse.mp4 -vsync 0 -qscale:v 2 .tmpSuperSloMo/input/%06d.jpg\r\nffmpeg version 4.2 Copyright (c) 2000-2019 the FFmpeg developers\r\n  built with Apple LLVM version 10.0.1 (clang-1001.0.46.4)\r\n  configuration: --enable-gpl --enable-version3 --enable-sdl2 --enable-fontconfig --enable-gnutls --enable-iconv --enable-libass --enable-libdav1d --enable-libbluray --enable-libfreetype --enable-libmp3lame --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenjpeg --enable-libopus --enable-libshine --enable-libsnappy --enable-libsoxr --enable-libtheora --enable-libtwolame --enable-libvpx --enable-libwavpack --enable-libwebp --enable-libx264 --enable-libx265 --enable-libxml2 --enable-libzimg --enable-lzma --enable-zlib --enable-gmp --enable-libvidstab --enable-libvorbis --enable-libvo-amrwbenc --enable-libmysofa --enable-libspeex --enable-libxvid --enable-libaom --enable-appkit --enable-avfoundation --enable-coreimage --enable-audiotoolbox\r\n  libavutil      56. 31.100 / 56. 31.100\r\n  libavcodec     58. 54.100 / 58. 54.100\r\n  libavformat    58. 29.100 / 58. 29.100\r\n  libavdevice    58.  8.100 / 58.  8.100\r\n  libavfilter     7. 57.100 /  7. 57.100\r\n  libswscale      5.  5.100 /  5.  5.100\r\n  libswresample   3.  5.100 /  3.  5.100\r\n  libpostproc    55.  5.100 / 55.  5.100\r\nInput #0, mov,mp4,m4a,3gp,3g2,mj2, from '/Users/user/slomo/input/mountain_timelapse.mp4':\r\n  Metadata:\r\n    major_brand     : avc1\r\n    minor_version   : 538182144\r\n    compatible_brands: avc1isom\r\n    creation_time   : 2019-07-21T19:08:34.000000Z\r\n    comment         : DE=None, Type=Timelapse, HQ=Normal, Mode=P\r\n  Duration: 00:00:10.04, start: 0.000000, bitrate: 35507 kb/s\r\n    Stream #0:0(eng): Video: h264 (High) (avc1 / 0x31637661), yuv420p(tv, bt709), 1920x1080 [SAR 1:1 DAR 16:9], 35334 kb/s, 29.97 fps, 29.97 tbr, 30k tbn, 59.94 tbc (default)\r\n    Metadata:\r\n      creation_time   : 2019-07-21T19:08:34.000000Z\r\n      handler_name    : ?DJI.AVC\r\n      encoder         : AVC encoder\r\n    Stream #0:1(eng): Data: none (priv / 0x76697270), 1690 kb/s\r\n    Metadata:\r\n      creation_time   : 2019-07-21T19:08:34.000000Z\r\n      handler_name    : ?DJI.Meta\r\nStream mapping:\r\n  Stream #0:0 -> #0:0 (h264 (native) -> mjpeg (native))\r\nPress [q] to stop, [?] for help\r\n[swscaler @ 0x7f7f58cb8000] deprecated pixel format used, make sure you did set range correctly\r\nOutput #0, image2, to '.tmpSuperSloMo/input/%06d.jpg':\r\n  Metadata:\r\n    major_brand     : avc1\r\n    minor_version   : 538182144\r\n    compatible_brands: avc1isom\r\n    comment         : DE=None, Type=Timelapse, HQ=Normal, Mode=P\r\n    encoder         : Lavf58.29.100\r\n    Stream #0:0(eng): Video: mjpeg, yuvj420p(pc), 1920x1080 [SAR 1:1 DAR 16:9], q=2-31, 200 kb/s, 29.97 fps, 29.97 tbn, 29.97 tbc (default)\r\n    Metadata:\r\n      creation_time   : 2019-07-21T19:08:34.000000Z\r\n      handler_name    : ?DJI.AVC\r\n      encoder         : Lavc58.54.100 mjpeg\r\n    Side data:\r\n      cpb: bitrate max/min/avg: 0/0/200000 buffer size: 0 vbv_delay: -1\r\nframe=  301 fps=206 q=2.0 Lsize=N/A time=00:00:10.04 bitrate=N/A speed=6.89x    \r\nvideo:140142kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: unknown\r\n  0%|                                                                                                               | 0/150 [00:00<?, ?it/s]^[/Users/user/anaconda3/lib/python3.7/site-packages/torch/nn/functional.py:2479: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.\r\n  \"See the documentation of nn.Upsample for details.\".format(mode))\r\n/Users/user/anaconda3/lib/python3.7/site-packages/torch/nn/functional.py:1350: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.\r\n  warnings.warn(\"nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.\")\r\n\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: MacOS Mojave 10.14.6\r\n - Using CPU\r\n - 2.2 GHz Intel Core i7 6 cores, 32 Gig RAM\r\n - Setup Info \r\n1. Installed Python 3.7 using Anaconda\r\n2. Using ffmpeg 4.2\r\n3. Using provided model\r\n4. Using stable Pytorch 1.2 for Mac, Conda, Python 3.7, CUDA None\r\n\r\n**Additional context**\r\nThe video processed fine using CUDA on a Windows machine. Was just trying to get it to work on a Mac using CPU only. \r\n","closed_by":{"login":"avinashpaliwal","id":43282710,"node_id":"MDQ6VXNlcjQzMjgyNzEw","avatar_url":"https://avatars.githubusercontent.com/u/43282710?v=4","gravatar_id":"","url":"https://api.github.com/users/avinashpaliwal","html_url":"https://github.com/avinashpaliwal","followers_url":"https://api.github.com/users/avinashpaliwal/followers","following_url":"https://api.github.com/users/avinashpaliwal/following{/other_user}","gists_url":"https://api.github.com/users/avinashpaliwal/gists{/gist_id}","starred_url":"https://api.github.com/users/avinashpaliwal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avinashpaliwal/subscriptions","organizations_url":"https://api.github.com/users/avinashpaliwal/orgs","repos_url":"https://api.github.com/users/avinashpaliwal/repos","events_url":"https://api.github.com/users/avinashpaliwal/events{/privacy}","received_events_url":"https://api.github.com/users/avinashpaliwal/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo/issues/56/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/avinashpaliwal/Super-SloMo/issues/56/timeline","performed_via_github_app":null,"state_reason":"completed"}