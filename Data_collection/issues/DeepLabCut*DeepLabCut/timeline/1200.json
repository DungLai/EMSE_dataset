[{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825717136","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-825717136","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":825717136,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNTcxNzEzNg==","user":{"login":"alexcwsmith","id":47009665,"node_id":"MDQ6VXNlcjQ3MDA5NjY1","avatar_url":"https://avatars.githubusercontent.com/u/47009665?v=4","gravatar_id":"","url":"https://api.github.com/users/alexcwsmith","html_url":"https://github.com/alexcwsmith","followers_url":"https://api.github.com/users/alexcwsmith/followers","following_url":"https://api.github.com/users/alexcwsmith/following{/other_user}","gists_url":"https://api.github.com/users/alexcwsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/alexcwsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexcwsmith/subscriptions","organizations_url":"https://api.github.com/users/alexcwsmith/orgs","repos_url":"https://api.github.com/users/alexcwsmith/repos","events_url":"https://api.github.com/users/alexcwsmith/events{/privacy}","received_events_url":"https://api.github.com/users/alexcwsmith/received_events","type":"User","site_admin":false},"created_at":"2021-04-23T14:58:24Z","updated_at":"2021-04-23T14:59:34Z","author_association":"CONTRIBUTOR","body":"Could you post what the actual error is? The full traceback would be helpful. There's no way to troubleshoot a problem unless we know what the problem actually is.\r\n\r\nIf you run:\r\n```\r\nimport tensorflow as tf\r\ntf.test.is_gpu_available()\r\n```\r\ndoes that return True?","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825717136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"alexcwsmith","id":47009665,"node_id":"MDQ6VXNlcjQ3MDA5NjY1","avatar_url":"https://avatars.githubusercontent.com/u/47009665?v=4","gravatar_id":"","url":"https://api.github.com/users/alexcwsmith","html_url":"https://github.com/alexcwsmith","followers_url":"https://api.github.com/users/alexcwsmith/followers","following_url":"https://api.github.com/users/alexcwsmith/following{/other_user}","gists_url":"https://api.github.com/users/alexcwsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/alexcwsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexcwsmith/subscriptions","organizations_url":"https://api.github.com/users/alexcwsmith/orgs","repos_url":"https://api.github.com/users/alexcwsmith/repos","events_url":"https://api.github.com/users/alexcwsmith/events{/privacy}","received_events_url":"https://api.github.com/users/alexcwsmith/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825813008","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-825813008","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":825813008,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNTgxMzAwOA==","user":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"created_at":"2021-04-23T17:38:43Z","updated_at":"2021-04-23T17:40:04Z","author_association":"NONE","body":"Hi, thanks for the answer. Yes, it returns True. \r\n\r\nTo reproduce what I do, I just use the _Demo_yourowndata_ notebook. I create the project, extract the frames and label them in DLC-CPU. \r\n\r\nThen I open another terminal, activate DLC-**GPU**, open the same notebook, create the training set and then train:\r\n\r\n```\r\ndeeplabcut.train_network(path_config_file)\r\nConfig:\r\n{'all_joints': [[0], [1], [2]],\r\n 'all_joints_names': ['left_eye', 'right_eye', 'tail_base'],\r\n 'alpha_r': 0.02,\r\n 'batch_size': 1,\r\n 'crop_pad': 0,\r\n 'cropratio': 0.4,\r\n 'dataset': 'training-datasets/iteration-0/UnaugmentedDataSet_azure_small_spraguesApr23/azure_small_spragues_jmaicas95shuffle1.mat',\r\n 'dataset_type': 'default',\r\n 'decay_steps': 30000,\r\n 'deterministic': False,\r\n 'display_iters': 1000,\r\n 'fg_fraction': 0.25,\r\n 'global_scale': 0.8,\r\n 'init_weights': '/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/models/pretrained/resnet_v1_50.ckpt',\r\n 'intermediate_supervision': False,\r\n 'intermediate_supervision_layer': 12,\r\n 'location_refinement': True,\r\n 'locref_huber_loss': True,\r\n 'locref_loss_weight': 0.05,\r\n 'locref_stdev': 7.2801,\r\n 'log_dir': 'log',\r\n 'lr_init': 0.0005,\r\n 'max_input_size': 1500,\r\n 'mean_pixel': [123.68, 116.779, 103.939],\r\n 'metadataset': 'training-datasets/iteration-0/UnaugmentedDataSet_azure_small_spraguesApr23/Documentation_data-azure_small_spragues_95shuffle1.pickle',\r\n 'min_input_size': 64,\r\n 'mirror': False,\r\n 'multi_step': [[0.005, 10000],\r\n                [0.02, 430000],\r\n                [0.002, 730000],\r\n                [0.001, 1030000]],\r\n 'net_type': 'resnet_50',\r\n 'num_joints': 3,\r\n 'optimizer': 'sgd',\r\n 'pairwise_huber_loss': False,\r\n 'pairwise_predict': False,\r\n 'partaffinityfield_predict': False,\r\n 'pos_dist_thresh': 17,\r\n 'project_path': '/home/jorge/Documents/DeepLabCut/examples/azure_small_spragues-jmaicas-2021-04-23',\r\n 'regularize': False,\r\n 'rotation': 25,\r\n 'rotratio': 0.4,\r\n 'save_iters': 50000,\r\n 'scale_jitter_lo': 0.5,\r\n 'scale_jitter_up': 1.25,\r\n 'scoremap_dir': 'test',\r\n 'shuffle': True,\r\n 'snapshot_prefix': '/home/jorge/Documents/DeepLabCut/examples/azure_small_spragues-jmaicas-2021-04-23/dlc-models/iteration-0/azure_small_spraguesApr23-trainset95shuffle1/train/snapshot',\r\n 'stride': 8.0,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001}\r\nSelecting single-animal trainer\r\nStarting with imgaug pose-dataset loader (=default).\r\nBatch Size is 1\r\nInitializing ResNet\r\nLoading ImageNet-pretrained resnet_50\r\nTraining parameter:\r\n{'stride': 8.0, 'weigh_part_predictions': False, 'weigh_negatives': False, 'fg_fraction': 0.25, 'mean_pixel': [123.68, 116.779, 103.939], 'shuffle': True, 'snapshot_prefix': '/home/jorge/Documents/DeepLabCut/examples/azure_small_spragues-jmaicas-2021-04-23/dlc-models/iteration-0/azure_small_spraguesApr23-trainset95shuffle1/train/snapshot', 'log_dir': 'log', 'global_scale': 0.8, 'location_refinement': True, 'locref_stdev': 7.2801, 'locref_loss_weight': 0.05, 'locref_huber_loss': True, 'optimizer': 'sgd', 'intermediate_supervision': False, 'intermediate_supervision_layer': 12, 'regularize': False, 'weight_decay': 0.0001, 'crop_pad': 0, 'scoremap_dir': 'test', 'batch_size': 1, 'dataset_type': 'default', 'deterministic': False, 'mirror': False, 'pairwise_huber_loss': False, 'weigh_only_present_joints': False, 'partaffinityfield_predict': False, 'pairwise_predict': False, 'all_joints': [[0], [1], [2]], 'all_joints_names': ['left_eye', 'right_eye', 'tail_base'], 'alpha_r': 0.02, 'cropratio': 0.4, 'dataset': 'training-datasets/iteration-0/UnaugmentedDataSet_azure_small_spraguesApr23/azure_small_spragues_jmaicas95shuffle1.mat', 'decay_steps': 30000, 'display_iters': 1000, 'init_weights': '/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/models/pretrained/resnet_v1_50.ckpt', 'lr_init': 0.0005, 'max_input_size': 1500, 'metadataset': 'training-datasets/iteration-0/UnaugmentedDataSet_azure_small_spraguesApr23/Documentation_data-azure_small_spragues_95shuffle1.pickle', 'min_input_size': 64, 'multi_step': [[0.005, 10000], [0.02, 430000], [0.002, 730000], [0.001, 1030000]], 'net_type': 'resnet_50', 'num_joints': 3, 'pos_dist_thresh': 17, 'project_path': '/home/jorge/Documents/DeepLabCut/examples/azure_small_spragues-jmaicas-2021-04-23', 'rotation': 25, 'rotratio': 0.4, 'save_iters': 50000, 'scale_jitter_lo': 0.5, 'scale_jitter_up': 1.25, 'covering': True, 'elastic_transform': True, 'motion_blur': True, 'motion_blur_params': {'k': 7, 'angle': (-90, 90)}}\r\nStarting training....\r\n---------------------------------------------------------------------------\r\nUnknownError                              Traceback (most recent call last)\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\r\n   1333     try:\r\n-> 1334       return fn(*args)\r\n   1335     except errors.OpError as e:\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/client/session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)\r\n   1318       return self._call_tf_sessionrun(\r\n-> 1319           options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1320 \r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/client/session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1406         self._session, options, feed_dict, fetch_list, target_list,\r\n-> 1407         run_metadata)\r\n   1408 \r\n\r\nUnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[{{node resnet_v1_50/conv1/Conv2D}}]]\r\n\t [[{{node sigmoid_cross_entropy_loss/value}}]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nUnknownError                              Traceback (most recent call last)\r\n<ipython-input-5-7e3f40db92d4> in <module>\r\n----> 1 deeplabcut.train_network(path_config_file)\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/training.py in train_network(config, shuffle, trainingsetindex, max_snapshots_to_keep, displayiters, saveiters, maxiters, allow_growth, gputouse, autotune, keepdeconvweights, modelprefix)\r\n    191 \r\n    192     except BaseException as e:\r\n--> 193         raise e\r\n    194     finally:\r\n    195         os.chdir(str(start_path))\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/training.py in train_network(config, shuffle, trainingsetindex, max_snapshots_to_keep, displayiters, saveiters, maxiters, allow_growth, gputouse, autotune, keepdeconvweights, modelprefix)\r\n    187                 max_to_keep=max_snapshots_to_keep,\r\n    188                 keepdeconvweights=keepdeconvweights,\r\n--> 189                 allow_growth=allow_growth,\r\n    190             )  # pass on path and file name for pose_cfg.yaml!\r\n    191 \r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/train.py in train(config_yaml, displayiters, saveiters, maxiters, max_to_keep, keepdeconvweights, allow_growth)\r\n    273         [_, loss_val, summary] = sess.run(\r\n    274             [train_op, total_loss, merged_summaries],\r\n--> 275             feed_dict=dict,\r\n    276         )\r\n    277         cum_loss += loss_val\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/client/session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    927     try:\r\n    928       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 929                          run_metadata_ptr)\r\n    930       if run_metadata:\r\n    931         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/client/session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n   1150     if final_fetches or final_targets or (handle and feed_dict_tensor):\r\n   1151       results = self._do_run(handle, final_targets, final_fetches,\r\n-> 1152                              feed_dict_tensor, options, run_metadata)\r\n   1153     else:\r\n   1154       results = []\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/client/session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n   1326     if handle is None:\r\n   1327       return self._do_call(_run_fn, feeds, fetches, targets, options,\r\n-> 1328                            run_metadata)\r\n   1329     else:\r\n   1330       return self._do_call(_prun_fn, handle, feeds, fetches)\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\r\n   1346           pass\r\n   1347       message = error_interpolation.interpolate(message, self._graph)\r\n-> 1348       raise type(e)(node_def, op, message)\r\n   1349 \r\n   1350   def _extend_graph(self):\r\n\r\nUnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[node resnet_v1_50/conv1/Conv2D (defined at /home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py:131) ]]\r\n\t [[node sigmoid_cross_entropy_loss/value (defined at /home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py:288) ]]\r\n\r\nCaused by op 'resnet_v1_50/conv1/Conv2D', defined at:\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/ipykernel_launcher.py\", line 16, in <module>\r\n    app.launch_new_instance()\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/traitlets/config/application.py\", line 837, in launch_instance\r\n    app.start()\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/ipykernel/kernelapp.py\", line 612, in start\r\n    self.io_loop.start()\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/tornado/platform/asyncio.py\", line 149, in start\r\n    self.asyncio_loop.run_forever()\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/asyncio/base_events.py\", line 541, in run_forever\r\n    self._run_once()\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/asyncio/base_events.py\", line 1786, in _run_once\r\n    handle._run()\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/asyncio/events.py\", line 88, in _run\r\n    self._context.run(self._callback, *self._args)\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/tornado/ioloop.py\", line 690, in <lambda>\r\n    lambda f: self._run_callback(functools.partial(callback, future))\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/tornado/ioloop.py\", line 743, in _run_callback\r\n    ret = callback()\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/tornado/gen.py\", line 787, in inner\r\n    self.run()\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/tornado/gen.py\", line 748, in run\r\n    yielded = self.gen.send(value)\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/ipykernel/kernelbase.py\", line 365, in process_one\r\n    yield gen.maybe_future(dispatch(*args))\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/tornado/gen.py\", line 209, in wrapper\r\n    yielded = next(result)\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/ipykernel/kernelbase.py\", line 268, in dispatch_shell\r\n    yield gen.maybe_future(handler(stream, idents, msg))\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/tornado/gen.py\", line 209, in wrapper\r\n    yielded = next(result)\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/ipykernel/kernelbase.py\", line 545, in execute_request\r\n    user_expressions, allow_stdin,\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/tornado/gen.py\", line 209, in wrapper\r\n    yielded = next(result)\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/ipykernel/ipkernel.py\", line 306, in do_execute\r\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/ipykernel/zmqshell.py\", line 536, in run_cell\r\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/core/interactiveshell.py\", line 2895, in run_cell\r\n    raw_cell, store_history, silent, shell_futures)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/core/interactiveshell.py\", line 2940, in _run_cell\r\n    return runner(coro)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/core/async_helpers.py\", line 68, in _pseudo_sync_runner\r\n    coro.send(None)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/core/interactiveshell.py\", line 3166, in run_cell_async\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/core/interactiveshell.py\", line 3357, in run_ast_nodes\r\n    if (await self.run_code(code, result,  async_=asy)):\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/core/interactiveshell.py\", line 3437, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-5-7e3f40db92d4>\", line 1, in <module>\r\n    deeplabcut.train_network(path_config_file)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/training.py\", line 189, in train_network\r\n    allow_growth=allow_growth,\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/train.py\", line 179, in train\r\n    losses = pose_net(cfg).train(batch)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py\", line 280, in train\r\n    heads = self.get_net(batch[Batch.inputs])\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py\", line 179, in get_net\r\n    net, end_points = self.extract_features(inputs)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py\", line 131, in extract_features\r\n    im_centered, global_pool=False, output_stride=16, is_training=False\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/contrib/slim/python/slim/nets/resnet_v1.py\", line 274, in resnet_v1_50\r\n    scope=scope)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/contrib/slim/python/slim/nets/resnet_v1.py\", line 205, in resnet_v1\r\n    net = resnet_utils.conv2d_same(net, 64, 7, stride=2, scope='conv1')\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/contrib/slim/python/slim/nets/resnet_utils.py\", line 146, in conv2d_same\r\n    scope=scope)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 182, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/contrib/layers/python/layers/layers.py\", line 1155, in convolution2d\r\n    conv_dims=2)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 182, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/contrib/layers/python/layers/layers.py\", line 1058, in convolution\r\n    outputs = layer.apply(inputs)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py\", line 1227, in apply\r\n    return self.__call__(inputs, *args, **kwargs)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/layers/base.py\", line 530, in __call__\r\n    outputs = super(Layer, self).__call__(inputs, *args, **kwargs)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py\", line 554, in __call__\r\n    outputs = self.call(inputs, *args, **kwargs)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/keras/layers/convolutional.py\", line 194, in call\r\n    outputs = self._convolution_op(inputs, self.kernel)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py\", line 966, in __call__\r\n    return self.conv_op(inp, filter)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py\", line 591, in __call__\r\n    return self.call(inp, filter)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py\", line 208, in __call__\r\n    name=self.name)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 1026, in conv2d\r\n    data_format=data_format, dilations=dilations, name=name)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 788, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 3300, in create_op\r\n    op_def=op_def)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 1801, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nUnknownError (see above for traceback): Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[node resnet_v1_50/conv1/Conv2D (defined at /home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py:131) ]]\r\n\t [[node sigmoid_cross_entropy_loss/value (defined at /home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py:288) ]]\r\n```","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825813008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825836860","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-825836860","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":825836860,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNTgzNjg2MA==","user":{"login":"alexcwsmith","id":47009665,"node_id":"MDQ6VXNlcjQ3MDA5NjY1","avatar_url":"https://avatars.githubusercontent.com/u/47009665?v=4","gravatar_id":"","url":"https://api.github.com/users/alexcwsmith","html_url":"https://github.com/alexcwsmith","followers_url":"https://api.github.com/users/alexcwsmith/followers","following_url":"https://api.github.com/users/alexcwsmith/following{/other_user}","gists_url":"https://api.github.com/users/alexcwsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/alexcwsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexcwsmith/subscriptions","organizations_url":"https://api.github.com/users/alexcwsmith/orgs","repos_url":"https://api.github.com/users/alexcwsmith/repos","events_url":"https://api.github.com/users/alexcwsmith/events{/privacy}","received_events_url":"https://api.github.com/users/alexcwsmith/received_events","type":"User","site_admin":false},"created_at":"2021-04-23T18:18:57Z","updated_at":"2021-04-23T18:18:57Z","author_association":"CONTRIBUTOR","body":"Weird that it won't initalize cuDNN but returns True that the GPU is available. Will you check the exact version of DLC with:\r\n```\r\nimport deeplabcut as dlc\r\nprint(dlc.__version__)\r\n```\r\n\r\nIs there a reason you are labeling frames with the CPU version but training with the GPU version? Are you doing all of this on the same computer? I doubt that is causing this but using two different environments could introduce odd behavior.\r\n\r\nAre you installing cudatoolkit and cudnn through anaconda? Try cudatoolkit version 10.2.89 and cudnn versoin 7.6.5, both from the anaconda channel.\r\n\r\nI would suggest cloning this repo and import DLC directly from there rather than importing whatever version you have installed from pip, and see if the issue persists. If that fixes it then just update your DLC install through pip if you don't want to keep importing from the repo. The line numbers in the scripts on the error traceback do not have anything that would cause errors in the most recent versions of the script.","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825836860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"alexcwsmith","id":47009665,"node_id":"MDQ6VXNlcjQ3MDA5NjY1","avatar_url":"https://avatars.githubusercontent.com/u/47009665?v=4","gravatar_id":"","url":"https://api.github.com/users/alexcwsmith","html_url":"https://github.com/alexcwsmith","followers_url":"https://api.github.com/users/alexcwsmith/followers","following_url":"https://api.github.com/users/alexcwsmith/following{/other_user}","gists_url":"https://api.github.com/users/alexcwsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/alexcwsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexcwsmith/subscriptions","organizations_url":"https://api.github.com/users/alexcwsmith/orgs","repos_url":"https://api.github.com/users/alexcwsmith/repos","events_url":"https://api.github.com/users/alexcwsmith/events{/privacy}","received_events_url":"https://api.github.com/users/alexcwsmith/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825888441","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-825888441","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":825888441,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNTg4ODQ0MQ==","user":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"created_at":"2021-04-23T20:01:16Z","updated_at":"2021-04-23T20:04:09Z","author_association":"NONE","body":"> Will you check the exact version of DLC\r\n\r\nDLC version: 2.1.10.3\r\n\r\n> Is there a reason you are labeling frames with the CPU version but training with the GPU version? \r\n\r\nI watched some tutorials where that was done it that way. The labelling was made with GUI and the training did not have it, so I use the DLC-CPU for the fist part (which needs GUI). \r\n\r\nAlso, it is the way it worked for me using Colab. I get the labels in local in DLC-CPU and then I train in Colab. In that case it works with no problem. \r\n\r\n> Are you installing cudatoolkit and cudnn through anaconda? Try cudatoolkit version 10.2.89 and cudnn versoin 7.6.5, both from the anaconda channel.\r\n\r\nThese are the ones in my  DLC-GPU environment. Should I try to update cudatoolkit then to 10.2.89?\r\n\r\n```\r\n$ conda list\r\ncudatoolkit               10.0.130                      0  \r\ncudnn                     7.6.5                cuda10.0_0 \r\n```\r\n\r\n> I would suggest cloning this repo and import DLC directly from there rather than importing whatever version you have installed from pip, and see if the issue persists. If that fixes it then just update your DLC install through pip if you don't want to keep importing from the repo.\r\n\r\nI'll try that. Thanks!","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825888441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825907304","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-825907304","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":825907304,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNTkwNzMwNA==","user":{"login":"alexcwsmith","id":47009665,"node_id":"MDQ6VXNlcjQ3MDA5NjY1","avatar_url":"https://avatars.githubusercontent.com/u/47009665?v=4","gravatar_id":"","url":"https://api.github.com/users/alexcwsmith","html_url":"https://github.com/alexcwsmith","followers_url":"https://api.github.com/users/alexcwsmith/followers","following_url":"https://api.github.com/users/alexcwsmith/following{/other_user}","gists_url":"https://api.github.com/users/alexcwsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/alexcwsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexcwsmith/subscriptions","organizations_url":"https://api.github.com/users/alexcwsmith/orgs","repos_url":"https://api.github.com/users/alexcwsmith/repos","events_url":"https://api.github.com/users/alexcwsmith/events{/privacy}","received_events_url":"https://api.github.com/users/alexcwsmith/received_events","type":"User","site_admin":false},"created_at":"2021-04-23T20:26:11Z","updated_at":"2021-04-23T20:26:11Z","author_association":"CONTRIBUTOR","body":"Yeah I would try this:\r\n\r\n```\r\nconda install -c anaconda cudatoolkit=10.2.89=hfd86e86_1 cudnn=7.6.5=10.2_0\r\n```\r\n\r\nThose are the exact builds that I have. The fact that it just lists 0 for cudatoolkit build and doesn't have channel info is odd. The above line will exactly replicate my install which I have run on an RTX4000, though now I run on RTX5000.","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825907304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"alexcwsmith","id":47009665,"node_id":"MDQ6VXNlcjQ3MDA5NjY1","avatar_url":"https://avatars.githubusercontent.com/u/47009665?v=4","gravatar_id":"","url":"https://api.github.com/users/alexcwsmith","html_url":"https://github.com/alexcwsmith","followers_url":"https://api.github.com/users/alexcwsmith/followers","following_url":"https://api.github.com/users/alexcwsmith/following{/other_user}","gists_url":"https://api.github.com/users/alexcwsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/alexcwsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexcwsmith/subscriptions","organizations_url":"https://api.github.com/users/alexcwsmith/orgs","repos_url":"https://api.github.com/users/alexcwsmith/repos","events_url":"https://api.github.com/users/alexcwsmith/events{/privacy}","received_events_url":"https://api.github.com/users/alexcwsmith/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825912855","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-825912855","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":825912855,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNTkxMjg1NQ==","user":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"created_at":"2021-04-23T20:38:23Z","updated_at":"2021-04-23T20:38:23Z","author_association":"NONE","body":"```\r\nPackagesNotFoundError: The following packages are not available from current channels:\r\n\r\n  - cudnn==7.6.5=10.2_0\r\n```\r\n\r\nIf I try to install just cudatoolkit it tries to solve several inconsistencies but at the end it does not update it. \r\n\r\n```\r\nconda install -c anaconda cudatoolkit=10.2.89=hfd86e86_1\r\nCollecting package metadata (current_repodata.json): done\r\nSolving environment: - \r\nThe environment is inconsistent, please check the package plan carefully\r\nThe following packages are causing the inconsistency:\r\n\r\n  - defaults/linux-64::mkl_random==1.1.1=py37h0573a6f_0\r\n  - defaults/linux-64::tensorboard==1.13.1=py37hf484d3e_0\r\n  - defaults/noarch::keras-applications==1.0.8=py_1\r\n  - defaults/linux-64::shapely==1.7.1=py37h98ec03d_0\r\n  - defaults/linux-64::tensorflow==1.13.1=gpu_py37hc158e3b_0\r\n  - defaults/linux-64::tensorflow-gpu==1.13.1=h0d30ee6_0\r\n  - defaults/linux-64::mkl_fft==1.3.0=py37h54f3939_0\r\n  - defaults/noarch::keras-preprocessing==1.1.2=pyhd3eb1b0_0\r\n  - defaults/linux-64::numpy==1.19.2=py37h54aff64_0\r\n  - defaults/linux-64::scipy==1.6.2=py37h91f5cce_0\r\n  - defaults/linux-64::tensorflow-base==1.13.1=gpu_py37h8d69cac_0\r\n  - defaults/noarch::tensorflow-estimator==1.13.0=py_0\r\n  - defaults/linux-64::h5py==2.10.0=py37hd6299e0_1\r\nfailed with initial frozen solve. Retrying with flexible solve.\r\nSolving environment: failed with repodata from current_repodata.json, will retry with next repodata source.\r\nCollecting package metadata (repodata.json): done\r\nSolving environment: / \r\nThe environment is inconsistent, please check the package plan carefully\r\n```\r\n\r\nThanks for you help. It good to know that you managed to run it with a RTX4000. I am going to try to clone the repository. ","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825912855/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825938246","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-825938246","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":825938246,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNTkzODI0Ng==","user":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"created_at":"2021-04-23T21:37:26Z","updated_at":"2021-04-23T21:37:26Z","author_association":"NONE","body":"Ok, I imported deeplabcut from a just cloned repository as described [here](https://github.com/DeepLabCut/DeepLabCut/wiki/How-to-use-the-latest-GitHub-code). When I train I got some extra lines after 'weight_decay':\r\n\r\n```\r\n 'weight_decay': 0.0001}\r\nStarting with imgaug pose-dataset loader (=default).\r\nBatch Size is 1\r\nInitializing ResNet\r\nLoading ImageNet-pretrained resnet_50\r\n**2021-04-23 22:29:55.477892: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA\r\n2021-04-23 22:29:55.504609: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2200000000 Hz\r\n2021-04-23 22:29:55.508655: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55bf0a4f6150 executing computations on platform Host. Devices:\r\n2021-04-23 22:29:55.508705: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>\r\n2021-04-23 22:29:55.635364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: \r\nname: Quadro RTX 4000 major: 7 minor: 5 memoryClockRate(GHz): 1.545\r\npciBusID: 0000:2d:00.0\r\ntotalMemory: 7.77GiB freeMemory: 7.33GiB\r\n2021-04-23 22:29:55.635403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0\r\n2021-04-23 22:29:55.636110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2021-04-23 22:29:55.636122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 \r\n2021-04-23 22:29:55.636130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N \r\n2021-04-23 22:29:55.636218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7128 MB memory) -> physical GPU (device: 0, name: Quadro RTX 4000, pci bus id: 0000:2d:00.0, compute capability: 7.5)\r\n2021-04-23 22:29:55.638042: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55bf09fa72c0 executing computations on platform CUDA. Devices:\r\n2021-04-23 22:29:55.638062: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): Quadro RTX 4000, Compute Capability 7.5**\r\nTraining parameter:\r\n{'stride': 8.0, 'weigh_part_predictions': False, 'weigh_negatives': False, 'fg_fraction': 0.25, 'mean_pixel': [123.68, 116.779, 103.939], 'shuffle': True, 'snapshot_prefix': '/home/jorge/Documents/DeepLabCut/examples/azure_small_spragues-jmaicas-2021-04-23/dlc-models/iteration-0/azure_small_spraguesApr23-trainset95shuffle1/train/snapshot', 'log_dir': 'log', 'global_scale': 0.8, 'location_refinement': True, 'locref_stdev': 7.2801, 'locref_loss_weight': 0.05, 'locref_huber_loss': True, 'optimizer': 'sgd', 'intermediate_supervision': False, 'intermediate_supervision_layer': 12, 'regularize': False, 'weight_decay': 0.0001, 'crop_pad': 0, 'scoremap_dir': 'test', 'batch_size': 1, 'dataset_type': 'default', 'deterministic': False, 'mirror': False, 'pairwise_huber_loss': False, 'weigh_only_present_joints': False, 'partaffinityfield_predict': False, 'pairwise_predict': False, 'all_joints': [[0], [1], [2]], 'all_joints_names': ['left_eye', 'right_eye', 'tail_base'], 'alpha_r': 0.02, 'clahe': True, 'claheratio': 0.1, 'cropratio': 0.4, 'dataset': 'training-datasets/iteration-0/UnaugmentedDataSet_azure_small_spraguesApr23/azure_small_spragues_jmaicas95shuffle1.mat', 'decay_steps': 30000, 'display_iters': 1000, 'edge': False, 'emboss': {'alpha': [0.0, 1.0], 'embossratio': 0.1, 'strength': [0.5, 1.5]}, 'histeq': True, 'histeqratio': 0.1, 'init_weights': '/home/jorge/Downloads/dlc-gpu/DeepLabCut/deeplabcut/pose_estimation_tensorflow/models/pretrained/resnet_v1_50.ckpt', 'lr_init': 0.0005, 'max_input_size': 1500, 'metadataset': 'training-datasets/iteration-0/UnaugmentedDataSet_azure_small_spraguesApr23/Documentation_data-azure_small_spragues_95shuffle1.pickle', 'min_input_size': 64, 'multi_step': [[0.005, 10000], [0.02, 430000], [0.002, 730000], [0.001, 1030000]], 'net_type': 'resnet_50', 'num_joints': 3, 'pos_dist_thresh': 17, 'project_path': '/home/jorge/Documents/DeepLabCut/examples/azure_small_spragues-jmaicas-2021-04-23', 'rotation': 25, 'rotratio': 0.4, 'save_iters': 50000, 'scale_jitter_lo': 0.5, 'scale_jitter_up': 1.25, 'sharpen': False, 'sharpenratio': 0.3, 'covering': True, 'elastic_transform': True, 'motion_blur': True, 'motion_blur_params': {'k': 7, 'angle': (-90, 90)}}\r\nStarting training....\r\n2021-04-23 22:30:03.792416: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2021-04-23 22:30:03.812547: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n---------------------------------------------------------------------------\r\nUnknownError                              Traceback (most recent call last)\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\r\n   1333     try:\r\n-> 1334       return fn(*args)\r\n   1335     except errors.OpError as e:\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/client/session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)\r\n   1318       return self._call_tf_sessionrun(\r\n-> 1319           options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1320 \r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/client/session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1406         self._session, options, feed_dict, fetch_list, target_list,\r\n-> 1407         run_metadata)\r\n   1408 \r\n\r\nUnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[{{node resnet_v1_50/conv1/Conv2D}}]]\r\n\t [[{{node absolute_difference/weighted_loss/assert_broadcastable/is_valid_shape/has_valid_nonscalar_shape/has_invalid_dims}}]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nUnknownError                              Traceback (most recent call last)\r\n<ipython-input-7-7e3f40db92d4> in <module>\r\n----> 1 deeplabcut.train_network(path_config_file)\r\n\r\n~/Downloads/dlc-gpu/DeepLabCut/deeplabcut/pose_estimation_tensorflow/training.py in train_network(config, shuffle, trainingsetindex, max_snapshots_to_keep, displayiters, saveiters, maxiters, allow_growth, gputouse, autotune, keepdeconvweights, modelprefix)\r\n    191 \r\n    192     except BaseException as e:\r\n--> 193         raise e\r\n    194     finally:\r\n    195         os.chdir(str(start_path))\r\n\r\n~/Downloads/dlc-gpu/DeepLabCut/deeplabcut/pose_estimation_tensorflow/training.py in train_network(config, shuffle, trainingsetindex, max_snapshots_to_keep, displayiters, saveiters, maxiters, allow_growth, gputouse, autotune, keepdeconvweights, modelprefix)\r\n    187                 max_to_keep=max_snapshots_to_keep,\r\n    188                 keepdeconvweights=keepdeconvweights,\r\n--> 189                 allow_growth=allow_growth,\r\n    190             )  # pass on path and file name for pose_cfg.yaml!\r\n    191 \r\n\r\n~/Downloads/dlc-gpu/DeepLabCut/deeplabcut/pose_estimation_tensorflow/train.py in train(config_yaml, displayiters, saveiters, maxiters, max_to_keep, keepdeconvweights, allow_growth)\r\n    273         [_, loss_val, summary] = sess.run(\r\n    274             [train_op, total_loss, merged_summaries],\r\n--> 275             feed_dict=dict,\r\n    276         )\r\n    277         cum_loss += loss_val\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/client/session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    927     try:\r\n    928       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 929                          run_metadata_ptr)\r\n    930       if run_metadata:\r\n    931         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/client/session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n   1150     if final_fetches or final_targets or (handle and feed_dict_tensor):\r\n   1151       results = self._do_run(handle, final_targets, final_fetches,\r\n-> 1152                              feed_dict_tensor, options, run_metadata)\r\n   1153     else:\r\n   1154       results = []\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/client/session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n   1326     if handle is None:\r\n   1327       return self._do_call(_run_fn, feeds, fetches, targets, options,\r\n-> 1328                            run_metadata)\r\n   1329     else:\r\n   1330       return self._do_call(_prun_fn, handle, feeds, fetches)\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\r\n   1346           pass\r\n   1347       message = error_interpolation.interpolate(message, self._graph)\r\n-> 1348       raise type(e)(node_def, op, message)\r\n   1349 \r\n   1350   def _extend_graph(self):\r\n\r\nUnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[node resnet_v1_50/conv1/Conv2D (defined at /home/jorge/Downloads/dlc-gpu/DeepLabCut/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py:131) ]]\r\n\t [[node absolute_difference/weighted_loss/assert_broadcastable/is_valid_shape/has_valid_nonscalar_shape/has_invalid_dims (defined at /home/jorge/Downloads/dlc-gpu/DeepLabCut/deeplabcut/pose_estimation_tensorflow/nnet/losses.py:45) ]]\r\n\r\nCaused by op 'resnet_v1_50/conv1/Conv2D', defined at:\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/bin/ipython\", line 11, in <module>\r\n    sys.exit(start_ipython())\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/__init__.py\", line 126, in start_ipython\r\n    return launch_new_instance(argv=argv, **kwargs)\r\n  File \"/home/jorge/.local/lib/python3.7/site-packages/traitlets/config/application.py\", line 837, in launch_instance\r\n    app.start()\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/terminal/ipapp.py\", line 356, in start\r\n    self.shell.mainloop()\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/terminal/interactiveshell.py\", line 564, in mainloop\r\n    self.interact()\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/terminal/interactiveshell.py\", line 555, in interact\r\n    self.run_cell(code, store_history=True)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/core/interactiveshell.py\", line 2895, in run_cell\r\n    raw_cell, store_history, silent, shell_futures)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/core/interactiveshell.py\", line 2940, in _run_cell\r\n    return runner(coro)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/core/async_helpers.py\", line 68, in _pseudo_sync_runner\r\n    coro.send(None)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/core/interactiveshell.py\", line 3166, in run_cell_async\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/core/interactiveshell.py\", line 3357, in run_ast_nodes\r\n    if (await self.run_code(code, result,  async_=asy)):\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/IPython/core/interactiveshell.py\", line 3437, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-7-7e3f40db92d4>\", line 1, in <module>\r\n    deeplabcut.train_network(path_config_file)\r\n  File \"/home/jorge/Downloads/dlc-gpu/DeepLabCut/deeplabcut/pose_estimation_tensorflow/training.py\", line 189, in train_network\r\n    allow_growth=allow_growth,\r\n  File \"/home/jorge/Downloads/dlc-gpu/DeepLabCut/deeplabcut/pose_estimation_tensorflow/train.py\", line 179, in train\r\n    losses = pose_net(cfg).train(batch)\r\n  File \"/home/jorge/Downloads/dlc-gpu/DeepLabCut/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py\", line 280, in train\r\n    heads = self.get_net(batch[Batch.inputs])\r\n  File \"/home/jorge/Downloads/dlc-gpu/DeepLabCut/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py\", line 179, in get_net\r\n    net, end_points = self.extract_features(inputs)\r\n  File \"/home/jorge/Downloads/dlc-gpu/DeepLabCut/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py\", line 131, in extract_features\r\n    im_centered, global_pool=False, output_stride=16, is_training=False\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/contrib/slim/python/slim/nets/resnet_v1.py\", line 274, in resnet_v1_50\r\n    scope=scope)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/contrib/slim/python/slim/nets/resnet_v1.py\", line 205, in resnet_v1\r\n    net = resnet_utils.conv2d_same(net, 64, 7, stride=2, scope='conv1')\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/contrib/slim/python/slim/nets/resnet_utils.py\", line 146, in conv2d_same\r\n    scope=scope)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 182, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/contrib/layers/python/layers/layers.py\", line 1155, in convolution2d\r\n    conv_dims=2)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 182, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/contrib/layers/python/layers/layers.py\", line 1058, in convolution\r\n    outputs = layer.apply(inputs)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py\", line 1227, in apply\r\n    return self.__call__(inputs, *args, **kwargs)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/layers/base.py\", line 530, in __call__\r\n    outputs = super(Layer, self).__call__(inputs, *args, **kwargs)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py\", line 554, in __call__\r\n    outputs = self.call(inputs, *args, **kwargs)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/keras/layers/convolutional.py\", line 194, in call\r\n    outputs = self._convolution_op(inputs, self.kernel)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py\", line 966, in __call__\r\n    return self.conv_op(inp, filter)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py\", line 591, in __call__\r\n    return self.call(inp, filter)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py\", line 208, in __call__\r\n    name=self.name)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 1026, in conv2d\r\n    data_format=data_format, dilations=dilations, name=name)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 788, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 3300, in create_op\r\n    op_def=op_def)\r\n  File \"/home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 1801, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nUnknownError (see above for traceback): Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[node resnet_v1_50/conv1/Conv2D (defined at /home/jorge/Downloads/dlc-gpu/DeepLabCut/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py:131) ]]\r\n\t [[node absolute_difference/weighted_loss/assert_broadcastable/is_valid_shape/has_valid_nonscalar_shape/has_invalid_dims (defined at /home/jorge/Downloads/dlc-gpu/DeepLabCut/deeplabcut/pose_estimation_tensorflow/nnet/losses.py:45) ]]\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825938246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825951749","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-825951749","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":825951749,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNTk1MTc0OQ==","user":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"created_at":"2021-04-23T22:16:46Z","updated_at":"2021-04-23T22:16:46Z","author_association":"NONE","body":"I also tried to install the DLC-GPU from the cloned repository (I was happy when it started because it was installing cudatoolkit=10.2.89 and cudnn=7.6.5) but it crashed with this error (I got a previous error of not finding GTK to build wxWidgets but I installed):\r\n\r\n```\r\nChecking for python version >= 2.7.0     : 3.7.10\r\n    python-config                            : /home/jorge/miniconda3/envs/DLC-GPU/bin/python3.7-config\r\n    Asking python-config for pyext '--cflags --libs --ldflags' flags : yes\r\n    Testing pyext configuration                                      : Could not build python extensions\r\n    The configuration failed\r\n    (complete log in /tmp/pip-install-tlobzeo2/wxpython_16b459d8fbcb4122bd5d3a997c2ef23c/build/waf/3.7/gtk3/config.log)\r\n    Command '\"/home/jorge/miniconda3/envs/DLC-GPU/bin/python\" /tmp/pip-install-tlobzeo2/wxpython_16b459d8fbcb4122bd5d3a997c2ef23c/bin/waf-2.0.8 --wx_config=/tmp/pip-install-tlobzeo2/wxpython_16b459d8fbcb4122bd5d3a997c2ef23c/build/wxbld/gtk3/wx-config --gtk3 --python=\"/home/jorge/miniconda3/envs/DLC-GPU/bin/python\" --out=build/waf/3.7/gtk3 configure build ' failed with exit code 1.\r\n    Finished command: build_py (0.894s)\r\n    Finished command: build (0m1.817s)\r\n    Command '\"/home/jorge/miniconda3/envs/DLC-GPU/bin/python\" -u build.py build' failed with exit code 1.\r\n    ----------------------------------------\r\nERROR: Command errored out with exit status 1: /home/jorge/miniconda3/envs/DLC-GPU/bin/python -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'/tmp/pip-install-tlobzeo2/wxpython_16b459d8fbcb4122bd5d3a997c2ef23c/setup.py'\"'\"'; __file__='\"'\"'/tmp/pip-install-tlobzeo2/wxpython_16b459d8fbcb4122bd5d3a997c2ef23c/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record /tmp/pip-record-qa7fly_6/install-record.txt --single-version-externally-managed --compile --install-headers /home/jorge/miniconda3/envs/DLC-GPU/include/python3.7m/wxpython Check the logs for full command output.\r\n\r\nfailed\r\n\r\nCondaEnvException: Pip failed\r\n\r\n```\r\n\r\nThe complete log in _/tmp/pip-install-tlobzeo2/wxpython_16b459d8fbcb4122bd5d3a997c2ef23c/build/waf/3.7/gtk3/config.log_ does not exist. ","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825951749/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825975541","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-825975541","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":825975541,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNTk3NTU0MQ==","user":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"created_at":"2021-04-23T22:32:33Z","updated_at":"2021-04-23T22:41:40Z","author_association":"NONE","body":"What I managed to do is install the DLC-GPU-LITE that comes in the last version. However, when I train it does not seem to find the GPU (the training does not crash but it runs over all my CPU cores):\r\n\r\n```\r\n2021-04-23 23:23:33.945484: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1\r\n2021-04-23 23:23:33.996029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 0 with properties: \r\nname: Quadro RTX 4000 major: 7 minor: 5 memoryClockRate(GHz): 1.545\r\npciBusID: 0000:2d:00.0\r\n2021-04-23 23:23:33.996250: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory\r\n2021-04-23 23:23:33.996362: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory\r\n2021-04-23 23:23:33.996428: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory\r\n2021-04-23 23:23:33.996492: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory\r\n2021-04-23 23:23:33.996554: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory\r\n2021-04-23 23:23:33.996611: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory\r\n2021-04-23 23:23:34.000515: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n2021-04-23 23:23:34.000538: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1662] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.\r\nSkipping registering GPU devices...\r\n2021-04-23 23:23:34.000946: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA\r\n2021-04-23 23:23:34.010802: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2200000000 Hz\r\n2021-04-23 23:23:34.014366: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fc1bceddb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2021-04-23 23:23:34.014420: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n2021-04-23 23:23:34.106051: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fc1b6e6cd0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:\r\n2021-04-23 23:23:34.106119: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Quadro RTX 4000, Compute Capability 7.5\r\n2021-04-23 23:23:34.106311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1180] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2021-04-23 23:23:34.106334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1186]      \r\nTraining parameter:\r\n{'stride': 8.0, 'weigh_part_predictions': False, 'weigh_negatives': False, 'fg_fraction': 0.25, 'mean_pixel': [123.68, 116.779, 103.939], 'shuffle': True, 'snapshot_prefix': '/home/jorge/Documents/DeepLabCut/examples/azure_small_spragues-jmaicas-2021-04-23/dlc-models/iteration-0/azure_small_spraguesApr23-trainset95shuffle1/train/snapshot', 'log_dir': 'log', 'global_scale': 0.8, 'location_refinement': True, 'locref_stdev': 7.2801, 'locref_loss_weight': 0.05, 'locref_huber_loss': True, 'optimizer': 'sgd', 'intermediate_supervision': False, 'intermediate_supervision_layer': 12, 'regularize': False, 'weight_decay': 0.0001, 'crop_pad': 0, 'scoremap_dir': 'test', 'batch_size': 1, 'dataset_type': 'default', 'deterministic': False, 'mirror': False, 'pairwise_huber_loss': False, 'weigh_only_present_joints': False, 'partaffinityfield_predict': False, 'pairwise_predict': False, 'all_joints': [[0], [1], [2]], 'all_joints_names': ['left_eye', 'right_eye', 'tail_base'], 'alpha_r': 0.02, 'cropratio': 0.4, 'dataset': 'training-datasets/iteration-0/UnaugmentedDataSet_azure_small_spraguesApr23/azure_small_spragues_jmaicas95shuffle1.mat', 'decay_steps': 30000, 'display_iters': 1000, 'init_weights': '/home/jorge/miniconda3/envs/DLC-GPU-LITE/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/models/pretrained/resnet_v1_50.ckpt', 'lr_init': 0.0005, 'max_input_size': 1500, 'metadataset': 'training-datasets/iteration-0/UnaugmentedDataSet_azure_small_spraguesApr23/Documentation_data-azure_small_spragues_95shuffle1.pickle', 'min_input_size': 64, 'multi_step': [[0.005, 10000], [0.02, 430000], [0.002, 730000], [0.001, 1030000]], 'net_type': 'resnet_50', 'num_joints': 3, 'pos_dist_thresh': 17, 'project_path': '/home/jorge/Documents/DeepLabCut/examples/azure_small_spragues-jmaicas-2021-04-23', 'rotation': 25, 'rotratio': 0.4, 'save_iters': 50000, 'scale_jitter_lo': 0.5, 'scale_jitter_up': 1.25, 'covering': True, 'elastic_transform': True, 'motion_blur': True, 'motion_blur_params': {'k': 7, 'angle': (-90, 90)}}\r\nStarting training....\r\n\r\n```\r\nBut it does not use the GPU:\r\n```\r\n$ nvidia-smi\r\nFri Apr 23 23:35:22 2021       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 460.32.03    Driver Version: 460.32.03    CUDA Version: 11.2     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|                               |                      |               MIG M. |\r\n|===============================+======================+======================|\r\n|   0  Quadro RTX 4000     Off  | 00000000:2D:00.0 Off |                  N/A |\r\n| 30%   35C    P8     5W / 125W |    458MiB /  7959MiB |      0%      Default |\r\n|                               |                      |                  N/A |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                                  |\r\n|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\r\n|        ID   ID                                                   Usage      |\r\n|=============================================================================|\r\n|    0   N/A  N/A      1983      G   /usr/bin/gnome-shell              117MiB |\r\n|    0   N/A  N/A      2554      G   /usr/lib/xorg/Xorg                186MiB |\r\n|    0   N/A  N/A      2711      G   /usr/bin/gnome-shell               37MiB |\r\n|    0   N/A  N/A     23120      C   ...s/DLC-GPU-LITE/bin/python       95MiB |\r\n+-----------------------------------------------------------------------------+\r\n```\r\n\r\nDLC-GPU-LITE installs these cudnn and cudatoolkit:\r\n\r\n```\r\ncudatoolkit               10.2.89              h8f6ccaa_8    conda-forge\r\ncudnn                     7.6.5.32             h01f27c4_1    conda-forge\r\n```","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/825975541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false}},{"id":4639879760,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50NDYzOTg3OTc2MA==","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/events/4639879760","actor":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2021-04-24T12:01:02Z","rename":{"from":"Convolution error running DLC-GPU with RTX-4000 in Ubuntu 18.04","to":"Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/826082590","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-826082590","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":826082590,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNjA4MjU5MA==","user":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"created_at":"2021-04-24T12:02:25Z","updated_at":"2021-04-24T12:02:25Z","author_association":"MEMBER","body":"Here is exactly how I install CUDA for DeepLabCut in Ubuntu; https://github.com/DeepLabCut/Docker4DeepLabCut2.0/wiki/Installation-of-NVIDIA-driver-and-CUDA-10\r\n\r\nalso labeling in CPU and GPU is fine; but note I don't do that in the demo's on youtube; I run docker for all training aspects; I never use conda GPU envs (only docker).  https://github.com/DeepLabCut/Docker4DeepLabCut2.0","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/826082590/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/826366318","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-826366318","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":826366318,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNjM2NjMxOA==","user":{"login":"alexcwsmith","id":47009665,"node_id":"MDQ6VXNlcjQ3MDA5NjY1","avatar_url":"https://avatars.githubusercontent.com/u/47009665?v=4","gravatar_id":"","url":"https://api.github.com/users/alexcwsmith","html_url":"https://github.com/alexcwsmith","followers_url":"https://api.github.com/users/alexcwsmith/followers","following_url":"https://api.github.com/users/alexcwsmith/following{/other_user}","gists_url":"https://api.github.com/users/alexcwsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/alexcwsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexcwsmith/subscriptions","organizations_url":"https://api.github.com/users/alexcwsmith/orgs","repos_url":"https://api.github.com/users/alexcwsmith/repos","events_url":"https://api.github.com/users/alexcwsmith/events{/privacy}","received_events_url":"https://api.github.com/users/alexcwsmith/received_events","type":"User","site_admin":false},"created_at":"2021-04-25T18:15:34Z","updated_at":"2021-04-25T18:32:29Z","author_association":"CONTRIBUTOR","body":"Yeah so now it is showing the message that it can't find the cuda shared object files. I was surprised that was not in the first tracebacks you posted.\r\n\r\nAssuming you are on Ubuntu, you can use 'locate' in the terminal to see if you can find those files. For example:\r\n\r\n```\r\n$ locate libcudart.so.10.0\r\n```\r\n\r\nreturns this path on my machine:\r\n/usr/local/cuda-10.0/targets/x86_64-linux/lib/libcudart.so.10.0\r\n\r\nYou need to make sure that the parent cuda binary (so for me /usr/local/cuda-10.0/bin/) is appended to your systems PATH variable (you can check by putting 'echo $PATH' into the terminal which will return a series of paths), and that the cuda-10.0/lib64 is on the LD_LIBRARY_PATH variable (again 'echo $LD_LIBRARY_PATH' will show this). The $PATH and $LD_LIBARY_PATH variables are system variables that tell your system where it is allowed to look for these shared object files. So if the correct paths to your cuda installation are not stored in these variables, the system will not be able to find the files.\r\n\r\nIf those paths are not already stored in those variables, the best way to do this is to edit the .bashrc file in your home directory and add these two lines (with the correct paths if yours are different from mine):\r\n\r\n```\r\nexport PATH=/usr/local/cuda-10.0/bin:$PATH\r\nexport LD_LIBRARY_PATH=/usr/local/cuda-10.0/lib64\r\n```\r\n\r\nAlternatively you can do this in your python interpreter, but then you need to do this every time you open a new console, whereas if you edit .bashrc you won't need to worry about it again. .bashrc is essentially a config file that runs every time you open a terminal, so any changes you make there won't take effect until you close the terminal and start a new one. \r\n\r\nTo do it in python is:\r\n\r\n```\r\nimport sys\r\nsys.path.append('/usr/local/cuda-10.0/bin')\r\nsys.path.append('/usr/local/cuda-10.0/lib64')\r\n```\r\n\r\nbut again this will be temporary and you need to do it again if you start a new console/kernel.\r\n\r\nPretty sure that will get it running on the GPU for you.","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/826366318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"alexcwsmith","id":47009665,"node_id":"MDQ6VXNlcjQ3MDA5NjY1","avatar_url":"https://avatars.githubusercontent.com/u/47009665?v=4","gravatar_id":"","url":"https://api.github.com/users/alexcwsmith","html_url":"https://github.com/alexcwsmith","followers_url":"https://api.github.com/users/alexcwsmith/followers","following_url":"https://api.github.com/users/alexcwsmith/following{/other_user}","gists_url":"https://api.github.com/users/alexcwsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/alexcwsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexcwsmith/subscriptions","organizations_url":"https://api.github.com/users/alexcwsmith/orgs","repos_url":"https://api.github.com/users/alexcwsmith/repos","events_url":"https://api.github.com/users/alexcwsmith/events{/privacy}","received_events_url":"https://api.github.com/users/alexcwsmith/received_events","type":"User","site_admin":false}},{"id":4646422019,"node_id":"MDExOkNsb3NlZEV2ZW50NDY0NjQyMjAxOQ==","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/events/4646422019","actor":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-04-26T17:46:17Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/830657037","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-830657037","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":830657037,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMDY1NzAzNw==","user":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"created_at":"2021-05-01T16:21:01Z","updated_at":"2021-05-01T16:21:53Z","author_association":"NONE","body":"Hi @alexcwsmith and @MMathisLab. Thanks for your answers. Sorry for not answering sooner. I have been doing other stuff this week. \r\n\r\nWhen I follow @MMathisLab instructions to install CUDA, the driver and the cudnn toolkit, it install the cuda version 10.1. Is that ok? I ask that because when locating the cuda libraries, different versions seem to appear.\r\n\r\n```\r\n`$ locate libcudart.so.10\r\n/home/jorge/miniconda3/envs/DLC-GPU/lib/libcudart.so.10.2\r\n/home/jorge/miniconda3/envs/DLC-GPU/lib/libcudart.so.10.2.89\r\n/home/jorge/miniconda3/envs/DLC-GPU-LITE/lib/libcudart.so.10.2\r\n/home/jorge/miniconda3/envs/DLC-GPU-LITE/lib/libcudart.so.10.2.89\r\n/home/jorge/miniconda3/pkgs/cudatoolkit-10.0.130-0/lib/libcudart.so.10.0\r\n/home/jorge/miniconda3/pkgs/cudatoolkit-10.0.130-0/lib/libcudart.so.10.0.130\r\n/home/jorge/miniconda3/pkgs/cudatoolkit-10.2.89-h8f6ccaa_8/lib/libcudart.so.10.2\r\n/home/jorge/miniconda3/pkgs/cudatoolkit-10.2.89-h8f6ccaa_8/lib/libcudart.so.10.2.89\r\n/home/jorge2/miniconda3/envs/DLC-GPU/lib/libcudart.so.10.0\r\n/home/jorge2/miniconda3/envs/DLC-GPU/lib/libcudart.so.10.0.130\r\n/home/jorge2/miniconda3/pkgs/cudatoolkit-10.0.130-0/lib/libcudart.so.10.0\r\n/home/jorge2/miniconda3/pkgs/cudatoolkit-10.0.130-0/lib/libcudart.so.10.0.130\r\n/usr/local/cuda-10.1/targets/x86_64-linux/lib/libcudart.so.10.1\r\n/usr/local/cuda-10.1/targets/x86_64-linux/lib/libcudart.so.10.1.243`\r\n```\r\n\r\nI am gonna try to use the Docker but I wanted to ask about it. ","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/830657037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false}},{"id":4673772723,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDY3Mzc3MjcyMw==","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/events/4673772723","actor":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-05-01T16:21:02Z","performed_via_github_app":null},{"id":4673772724,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ2NzM3NzI3MjQ=","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/events/4673772724","actor":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-05-01T16:21:02Z","performed_via_github_app":null},{"id":4673772725,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDY3Mzc3MjcyNQ==","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/events/4673772725","actor":{"login":"alexcwsmith","id":47009665,"node_id":"MDQ6VXNlcjQ3MDA5NjY1","avatar_url":"https://avatars.githubusercontent.com/u/47009665?v=4","gravatar_id":"","url":"https://api.github.com/users/alexcwsmith","html_url":"https://github.com/alexcwsmith","followers_url":"https://api.github.com/users/alexcwsmith/followers","following_url":"https://api.github.com/users/alexcwsmith/following{/other_user}","gists_url":"https://api.github.com/users/alexcwsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/alexcwsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexcwsmith/subscriptions","organizations_url":"https://api.github.com/users/alexcwsmith/orgs","repos_url":"https://api.github.com/users/alexcwsmith/repos","events_url":"https://api.github.com/users/alexcwsmith/events{/privacy}","received_events_url":"https://api.github.com/users/alexcwsmith/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-05-01T16:21:02Z","performed_via_github_app":null},{"id":4673772727,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ2NzM3NzI3Mjc=","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/events/4673772727","actor":{"login":"alexcwsmith","id":47009665,"node_id":"MDQ6VXNlcjQ3MDA5NjY1","avatar_url":"https://avatars.githubusercontent.com/u/47009665?v=4","gravatar_id":"","url":"https://api.github.com/users/alexcwsmith","html_url":"https://github.com/alexcwsmith","followers_url":"https://api.github.com/users/alexcwsmith/followers","following_url":"https://api.github.com/users/alexcwsmith/following{/other_user}","gists_url":"https://api.github.com/users/alexcwsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/alexcwsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexcwsmith/subscriptions","organizations_url":"https://api.github.com/users/alexcwsmith/orgs","repos_url":"https://api.github.com/users/alexcwsmith/repos","events_url":"https://api.github.com/users/alexcwsmith/events{/privacy}","received_events_url":"https://api.github.com/users/alexcwsmith/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-05-01T16:21:02Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/830662846","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-830662846","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":830662846,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMDY2Mjg0Ng==","user":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"created_at":"2021-05-01T17:06:09Z","updated_at":"2021-05-01T17:07:25Z","author_association":"NONE","body":"I got this error creating the docker:\r\n\r\n```\r\n$ GPU=1 bash ./dlc-docker run -d -p 2351:8888 -e USER_HOME=$HOME/DeepLabCut --name dlccontainer jorge/dlcdocker\r\nret run -d -p 2351:8888 -e USER_HOME=/home/jorge/DeepLabCut --name dlccontainer jorge/dlcdocker run\r\n1st CMD run\r\n\r\n* Setting user name to:             jorge\r\n* Setting user ID to:               1000\r\n* Setting user groups to:           sudo\r\n* Setting password to:              pw\r\n* Setting Notebook port binding to: 2351 (to set manually add -p 2351:8888 as flag)\r\n\r\nYou can now open the notebook on the host machine by directing your browser to\r\n\r\n    http://localhost:2351\r\n\r\n1 nvidia-docker run -v /home/jorge:/home/jorge -p 55298:22 -p 2351:8888 -e USER_GROUPS=sudo -e USER=jorge -e USER_ID=1000 -e USER_ENCRYPTED_PASSWORD=aa5V9MSdgw5ec -e USER_HOME=/home/jorge -e GPU=1 -e DISPLAY=:0 -d -e USER_HOME=/home/jorge/DeepLabCut --name dlccontainer jorge/dlcdocker\r\n0154ee1ce84504030075bcc545bb538453d49fce35d0ebf5304ca86ed96c8afa\r\ndocker: Error response from daemon: OCI runtime create failed: container_linux.go:367: starting container process caused: process_linux.go:495: container init caused: Running hook #1:: error running hook: exit status 1, stdout: , stderr: nvidia-container-cli: device error: 1: unknown device: unknown.\r\n```\r\n\r\n```\r\n$ nvidia-smi\r\nSat May  1 18:05:37 2021       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 460.73.01    Driver Version: 460.73.01    CUDA Version: 11.2     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|                               |                      |               MIG M. |\r\n|===============================+======================+======================|\r\n|   0  Quadro RTX 4000     Off  | 00000000:2D:00.0  On |                  N/A |\r\n| 30%   41C    P8    13W / 125W |    441MiB /  7959MiB |      3%      Default |\r\n|                               |                      |                  N/A |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                                  |\r\n|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\r\n|        ID   ID                                                   Usage      |\r\n|=============================================================================|\r\n|    0   N/A  N/A      1875      G   /usr/bin/gnome-shell              117MiB |\r\n|    0   N/A  N/A      2782      G   /usr/lib/xorg/Xorg                163MiB |\r\n|    0   N/A  N/A      3024      G   /usr/bin/gnome-shell               35MiB |\r\n|    0   N/A  N/A      3614      G   ...gAAAAAAAAA --shared-files        9MiB |\r\n|    0   N/A  N/A      4070      G   ...oken=13913367502425427311       94MiB |\r\n+-----------------------------------------------------------------------------+\r\n```\r\n\r\n```\r\n$ nvcc -V\r\nnvcc: NVIDIA (R) Cuda compiler driver\r\nCopyright (c) 2005-2019 NVIDIA Corporation\r\nBuilt on Sun_Jul_28_19:07:16_PDT_2019\r\nCuda compilation tools, release 10.1, V10.1.243\r\n```","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/830662846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/830668686","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-830668686","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":830668686,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMDY2ODY4Ng==","user":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"created_at":"2021-05-01T17:49:34Z","updated_at":"2021-05-01T17:51:21Z","author_association":"NONE","body":"So this is my progress so far:\r\n\r\nI installed CUDA, the drivers and cudnn following https://github.com/DeepLabCut/Docker4DeepLabCut2.0/wiki/Installation-of-NVIDIA-driver-and-CUDA-10\r\n\r\nI modified .bashrc to include the CUDA 10 in the two PATH variables.\r\n\r\nAfter doing that, I tried 4 different things:\r\n\r\n- I cannot launch the docker: https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-830662846\r\n- I managed to install an old version of DLC-GPU (tensorflow 1.13) but it gives the convolutional error. https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-825813008\r\n- I cannot install the newest version of DLC-GPU (cloning the repository) : https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-825951749\r\n- I manage to install the latest version of DLC-GPU-LITE, but it does not use the GPU. https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-825975541","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/830668686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/830676522","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-830676522","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":830676522,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMDY3NjUyMg==","user":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"created_at":"2021-05-01T18:41:13Z","updated_at":"2021-05-01T18:41:13Z","author_association":"MEMBER","body":"`GPU=1`\r\n\r\nYou don't have 2 GPUs, please carefully check the docker instructions -- it tells you how you need to set each term, it's not a simple copy/paste :).","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/830676522/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/830685432","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-830685432","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":830685432,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMDY4NTQzMg==","user":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"created_at":"2021-05-01T19:52:41Z","updated_at":"2021-05-01T19:52:41Z","author_association":"NONE","body":"That was quick! Thanks. \r\n\r\nOnce in the docker, I still have the convolutional error:\r\n\r\n```\r\nStarting with imgaug pose-dataset loader (=default).\r\nBatch Size is 1\r\nInitializing ResNet\r\nLoading ImageNet-pretrained resnet_50\r\n2021-05-01 19:50:14.663080: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA\r\n2021-05-01 19:50:14.819023: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x258d1e0 executing computations on platform CUDA. Devices:\r\n2021-05-01 19:50:14.819067: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): Quadro RTX 4000, Compute Capability 7.5\r\n2021-05-01 19:50:14.824964: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2200000000 Hz\r\n2021-05-01 19:50:14.828867: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x258d340 executing computations on platform Host. Devices:\r\n2021-05-01 19:50:14.828902: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>\r\n2021-05-01 19:50:14.829116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties:\r\nname: Quadro RTX 4000 major: 7 minor: 5 memoryClockRate(GHz): 1.545\r\npciBusID: 0000:2d:00.0\r\ntotalMemory: 7.77GiB freeMemory: 7.32GiB\r\n2021-05-01 19:50:14.829144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0\r\n2021-05-01 19:50:14.830938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2021-05-01 19:50:14.830958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0\r\n2021-05-01 19:50:14.830967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N\r\n2021-05-01 19:50:14.831083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7120 MB memory) -> physical GPU (device: 0, name: Quadro RTX 4000, pci bus id: 0000:2d:00.0, compute capability: 7.5)\r\nMax_iters overwritten as 50000\r\nDisplay_iters overwritten as 50\r\nSave_iters overwritten as 20000\r\nTraining parameter:\r\n{'stride': 8.0, 'weigh_part_predictions': False, 'weigh_negatives': False, 'fg_fraction': 0.25, 'mean_pixel': [123.68, 116.779, 103.939], 'shuffle': True, 'snapshot_prefix': '/home/jorge/Documents/DeepLabCut/examples/azure_small_spragues-jmaicas-2021-04-23/dlc-models/iteration-0/azure_small_spraguesApr23-trainset95shuffle1/train/snapshot', 'log_dir': 'log', 'global_scale': 0.8, 'location_refinement': True, 'locref_stdev': 7.2801, 'locref_loss_weight': 0.05, 'locref_huber_loss': True, 'optimizer': 'sgd', 'intermediate_supervision': False, 'intermediate_supervision_layer': 12, 'regularize': False, 'weight_decay': 0.0001, 'crop_pad': 0, 'scoremap_dir': 'test', 'batch_size': 1, 'dataset_type': 'default', 'deterministic': False, 'mirror': False, 'pairwise_huber_loss': False, 'weigh_only_present_joints': False, 'partaffinityfield_predict': False, 'pairwise_predict': False, 'all_joints': [[0], [1], [2]], 'all_joints_names': ['left_eye', 'right_eye', 'tail_base'], 'alpha_r': 0.02, 'clahe': True, 'claheratio': 0.1, 'cropratio': 0.4, 'dataset': 'training-datasets/iteration-0/UnaugmentedDataSet_azure_small_spraguesApr23/azure_small_spragues_jmaicas95shuffle1.mat', 'decay_steps': 30000, 'display_iters': 1000, 'edge': False, 'emboss': {'alpha': [0.0, 1.0], 'embossratio': 0.1, 'strength': [0.5, 1.5]}, 'histeq': True, 'histeqratio': 0.1, 'init_weights': '/usr/local/lib/python3.6/dist-packages/deeplabcut/pose_estimation_tensorflow/models/pretrained/resnet_v1_50.ckpt', 'lr_init': 0.0005, 'max_input_size': 1500, 'metadataset': 'training-datasets/iteration-0/UnaugmentedDataSet_azure_small_spraguesApr23/Documentation_data-azure_small_spragues_95shuffle1.pickle', 'min_input_size': 64, 'multi_step': [[0.005, 10000], [0.02, 430000], [0.002, 730000], [0.001, 1030000]], 'net_type': 'resnet_50', 'num_joints': 3, 'pos_dist_thresh': 17, 'project_path': '/home/jorge/Documents/DeepLabCut/examples/azure_small_spragues-jmaicas-2021-04-23', 'rotation': 25, 'rotratio': 0.4, 'save_iters': 50000, 'scale_jitter_lo': 0.5, 'scale_jitter_up': 1.25, 'sharpen': False, 'sharpenratio': 0.3, 'covering': True, 'elastic_transform': True, 'motion_blur': True, 'motion_blur_params': {'k': 7, 'angle': (-90, 90)}}\r\nStarting training....\r\n2021-05-01 19:50:24.200604: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2021-05-01 19:50:24.202360: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n---------------------------------------------------------------------------\r\nUnknownError                              Traceback (most recent call last)\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\r\n   1333     try:\r\n-> 1334       return fn(*args)\r\n   1335     except errors.OpError as e:\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)\r\n   1318       return self._call_tf_sessionrun(\r\n-> 1319           options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1320\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1406         self._session, options, feed_dict, fetch_list, target_list,\r\n-> 1407         run_metadata)\r\n   1408\r\n\r\nUnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n         [[{{node resnet_v1_50/conv1/Conv2D}}]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nUnknownError                              Traceback (most recent call last)\r\n<ipython-input-4-65c8cb9be350> in <module>\r\n----> 1 deeplabcut.train_network(path_config_file, shuffle=1, displayiters=50,saveiters=20000, maxiters=50000)\r\n\r\n/usr/local/lib/python3.6/dist-packages/deeplabcut/pose_estimation_tensorflow/training.py in train_network(config, shuffle, trainingsetindex, max_snapshots_to_keep, displayiters, saveiters, maxiters, allow_growth, gputouse, autotune, keepdeconvweights, modelprefix)\r\n    191\r\n    192     except BaseException as e:\r\n--> 193         raise e\r\n    194     finally:\r\n    195         os.chdir(str(start_path))\r\n\r\n/usr/local/lib/python3.6/dist-packages/deeplabcut/pose_estimation_tensorflow/training.py in train_network(config, shuffle, trainingsetindex, max_snapshots_to_keep, displayiters, saveiters, maxiters, allow_growth, gputouse, autotune, keepdeconvweights, modelprefix)\r\n    187                 max_to_keep=max_snapshots_to_keep,\r\n    188                 keepdeconvweights=keepdeconvweights,\r\n--> 189                 allow_growth=allow_growth,\r\n    190             )  # pass on path and file name for pose_cfg.yaml!\r\n    191\r\n\r\n/usr/local/lib/python3.6/dist-packages/deeplabcut/pose_estimation_tensorflow/train.py in train(config_yaml, displayiters, saveiters, maxiters, max_to_keep, keepdeconvweights, allow_growth)\r\n    275\r\n    276         [_, loss_val, summary] = sess.run(\r\n--> 277             [train_op, total_loss, merged_summaries], feed_dict=dict\r\n    278         )\r\n    279         cum_loss += loss_val\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    927     try:\r\n    928       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 929                          run_metadata_ptr)\r\n    930       if run_metadata:\r\n    931         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n   1150     if final_fetches or final_targets or (handle and feed_dict_tensor):\r\n   1151       results = self._do_run(handle, final_targets, final_fetches,\r\n-> 1152                              feed_dict_tensor, options, run_metadata)\r\n   1153     else:\r\n   1154       results = []\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n   1326     if handle is None:\r\n   1327       return self._do_call(_run_fn, feeds, fetches, targets, options,\r\n-> 1328                            run_metadata)\r\n   1329     else:\r\n   1330       return self._do_call(_prun_fn, handle, feeds, fetches)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\r\n   1346           pass\r\n   1347       message = error_interpolation.interpolate(message, self._graph)\r\n-> 1348       raise type(e)(node_def, op, message)\r\n   1349\r\n   1350   def _extend_graph(self):\r\n\r\nUnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n         [[node resnet_v1_50/conv1/Conv2D (defined at /usr/local/lib/python3.6/dist-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py:124) ]]\r\n\r\nCaused by op 'resnet_v1_50/conv1/Conv2D', defined at:\r\n  File \"/usr/local/bin/ipython\", line 10, in <module>\r\n    sys.exit(start_ipython())\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/__init__.py\", line 125, in start_ipython\r\n    return launch_new_instance(argv=argv, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/traitlets/config/application.py\", line 658, in launch_instance\r\n    app.start()\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/terminal/ipapp.py\", line 356, in start\r\n    self.shell.mainloop()\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/terminal/interactiveshell.py\", line 498, in mainloop\r\n    self.interact()\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/terminal/interactiveshell.py\", line 489, in interact\r\n    self.run_cell(code, store_history=True)\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 2848, in run_cell\r\n    raw_cell, store_history, silent, shell_futures)\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 2874, in _run_cell\r\n    return runner(coro)\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/async_helpers.py\", line 67, in _pseudo_sync_runner\r\n    coro.send(None)\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 3049, in run_cell_async\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 3220, in run_ast_nodes\r\n    if (yield from self.run_code(code, result)):\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 3296, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-4-65c8cb9be350>\", line 1, in <module>\r\n    deeplabcut.train_network(path_config_file, shuffle=1, displayiters=50,saveiters=20000, maxiters=50000)\r\n  File \"/usr/local/lib/python3.6/dist-packages/deeplabcut/pose_estimation_tensorflow/training.py\", line 189, in train_network\r\n    allow_growth=allow_growth,\r\n  File \"/usr/local/lib/python3.6/dist-packages/deeplabcut/pose_estimation_tensorflow/train.py\", line 178, in train\r\n    losses = pose_net(cfg).train(batch)\r\n  File \"/usr/local/lib/python3.6/dist-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py\", line 275, in train\r\n    heads = self.get_net(batch[Batch.inputs])\r\n  File \"/usr/local/lib/python3.6/dist-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py\", line 174, in get_net\r\n    net, end_points = self.extract_features(inputs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py\", line 124, in extract_features\r\n    im_centered, global_pool=False, output_stride=16, is_training=False\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/slim/python/slim/nets/resnet_v1.py\", line 274, in resnet_v1_50\r\n    scope=scope)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/slim/python/slim/nets/resnet_v1.py\", line 205, in resnet_v1\r\n    net = resnet_utils.conv2d_same(net, 64, 7, stride=2, scope='conv1')\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/slim/python/slim/nets/resnet_utils.py\", line 146, in conv2d_same\r\n    scope=scope)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 182, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/layers/python/layers/layers.py\", line 1155, in convolution2d\r\n    conv_dims=2)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 182, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/layers/python/layers/layers.py\", line 1058, in convolution\r\n    outputs = layer.apply(inputs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/base_layer.py\", line 1227, in apply\r\n    return self.__call__(inputs, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/layers/base.py\", line 530, in __call__\r\n    outputs = super(Layer, self).__call__(inputs, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/base_layer.py\", line 554, in __call__\r\n    outputs = self.call(inputs, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/layers/convolutional.py\", line 194, in call\r\n    outputs = self._convolution_op(inputs, self.kernel)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/nn_ops.py\", line 966, in __call__\r\n    return self.conv_op(inp, filter)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/nn_ops.py\", line 591, in __call__\r\n    return self.call(inp, filter)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/nn_ops.py\", line 208, in __call__\r\n    name=self.name)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/gen_nn_ops.py\", line 1026, in conv2d\r\n    data_format=data_format, dilations=dilations, name=name)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/op_def_library.py\", line 788, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/ops.py\", line 3300, in create_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/ops.py\", line 1801, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nUnknownError (see above for traceback): Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n         [[node resnet_v1_50/conv1/Conv2D (defined at /usr/local/lib/python3.6/dist-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py:124) ]]\r\n```","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/830685432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false}},{"actor":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"created_at":"2021-05-02T21:35:48Z","updated_at":"2021-05-02T21:35:48Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1212","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1212/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1212/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1212/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1212","id":874050267,"node_id":"MDU6SXNzdWU4NzQwNTAyNjc=","number":1212,"title":"Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR","user":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"labels":[{"id":1010467338,"node_id":"MDU6TGFiZWwxMDEwNDY3MzM4","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/Installation","name":"Installation","color":"ecfca6","default":false,"description":""},{"id":2225445655,"node_id":"MDU6TGFiZWwyMjI1NDQ1NjU1","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/issue%20with%20non-DLC%20code","name":"issue with non-DLC code","color":"aa25db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-05-02T21:35:48Z","updated_at":"2021-05-09T17:12:06Z","closed_at":"2021-05-03T10:18:28Z","author_association":"NONE","active_lock_reason":null,"repository":{"id":126897385,"node_id":"MDEwOlJlcG9zaXRvcnkxMjY4OTczODU=","name":"DeepLabCut","full_name":"DeepLabCut/DeepLabCut","private":false,"owner":{"login":"DeepLabCut","id":59848143,"node_id":"MDEyOk9yZ2FuaXphdGlvbjU5ODQ4MTQz","avatar_url":"https://avatars.githubusercontent.com/u/59848143?v=4","gravatar_id":"","url":"https://api.github.com/users/DeepLabCut","html_url":"https://github.com/DeepLabCut","followers_url":"https://api.github.com/users/DeepLabCut/followers","following_url":"https://api.github.com/users/DeepLabCut/following{/other_user}","gists_url":"https://api.github.com/users/DeepLabCut/gists{/gist_id}","starred_url":"https://api.github.com/users/DeepLabCut/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DeepLabCut/subscriptions","organizations_url":"https://api.github.com/users/DeepLabCut/orgs","repos_url":"https://api.github.com/users/DeepLabCut/repos","events_url":"https://api.github.com/users/DeepLabCut/events{/privacy}","received_events_url":"https://api.github.com/users/DeepLabCut/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/DeepLabCut/DeepLabCut","description":"Official implementation of DeepLabCut: Markerless pose estimation of user-defined features with deep learning for all animals incl. humans","fork":false,"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","forks_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/forks","keys_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/keys{/key_id}","collaborators_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/teams","hooks_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/hooks","issue_events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/events{/number}","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/events","assignees_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/assignees{/user}","branches_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/branches{/branch}","tags_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/tags","blobs_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/git/refs{/sha}","trees_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/git/trees{/sha}","statuses_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/statuses/{sha}","languages_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/languages","stargazers_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/stargazers","contributors_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/contributors","subscribers_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/subscribers","subscription_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/subscription","commits_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/commits{/sha}","git_commits_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/git/commits{/sha}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/comments{/number}","issue_comment_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments{/number}","contents_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/contents/{+path}","compare_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/compare/{base}...{head}","merges_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/merges","archive_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/downloads","issues_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues{/number}","pulls_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/pulls{/number}","milestones_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/milestones{/number}","notifications_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels{/name}","releases_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/releases{/id}","deployments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/deployments","created_at":"2018-03-26T22:29:12Z","updated_at":"2023-01-19T09:39:11Z","pushed_at":"2023-01-13T07:57:38Z","git_url":"git://github.com/DeepLabCut/DeepLabCut.git","ssh_url":"git@github.com:DeepLabCut/DeepLabCut.git","clone_url":"https://github.com/DeepLabCut/DeepLabCut.git","svn_url":"https://github.com/DeepLabCut/DeepLabCut","homepage":"http://deeplabcut.org","size":166257,"stargazers_count":3464,"watchers_count":3464,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":false,"forks_count":1470,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":43,"license":{"key":"lgpl-3.0","name":"GNU Lesser General Public License v3.0","spdx_id":"LGPL-3.0","url":"https://api.github.com/licenses/lgpl-3.0","node_id":"MDc6TGljZW5zZTEy"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["animal-pose-estimation","behavior-analysis","deep-learning","deeplabcut","feature-detectors","keypoint-detection","keypoint-tracking","labeling-tool","pose-estimation","toolbox"],"visibility":"public","forks":1470,"open_issues":43,"watchers":3464,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Hi, I keep having the same issue that I tried to explain in https://github.com/DeepLabCut/DeepLabCut/issues/1200#issue-865209506. I am working in Ubuntu 18.04 with a Nvidia RTX 4000\r\n\r\nAfter trying the Docker and getting the same issue, I am back using the DLC-GPU environment, I still get the same problem when I try to train. \r\n\r\nRight now I came back to install Cuda 10.0 (included in the PATH in the .bashrc file) because that is the one is used by the DLC-GPU environment when I install it in miniconda.\r\n \r\n```\r\n$ nvcc -V\r\nnvcc: NVIDIA (R) Cuda compiler driver\r\nCopyright (c) 2005-2018 NVIDIA Corporation\r\nBuilt on Sat_Aug_25_21:08:01_CDT_2018\r\nCuda compilation tools, release 10.0, V10.0.130\r\n```\r\n\r\nDuring training, I opted for doing `allow_growth = True` because I saw it in this github issue. https://github.com/tensorflow/tensorflow/issues/24496\r\n\r\nHowever, it still does not work. \r\n\r\ndeeplabcut.train_network(path_config_file, shuffle=1, allow_growth=True, gputouse=0, displayiters=50,saveiters=20000, maxiters=50000)\r\n\r\n```\r\n2021-05-02 22:16:22.447624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/device:GPU:0 with 7018 MB memory) -> physical GPU (device: 0, name: NVIDIA Quadro RTX 4000, pci bus id: 0000:2d:00.0, compute capability: 7.5)\r\n2021-05-02 22:16:22.449495: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55d6db8d6fd0 executing computations on platform CUDA. Devices:\r\n2021-05-02 22:16:22.449516: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): NVIDIA Quadro RTX 4000, Compute Capability 7.5\r\n2021-05-02 22:16:29.122700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0\r\n2021-05-02 22:16:29.122776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2021-05-02 22:16:29.122783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 \r\n2021-05-02 22:16:29.122790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N \r\n2021-05-02 22:16:29.122871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7018 MB memory) -> physical GPU (device: 0, name: NVIDIA Quadro RTX 4000, pci bus id: 0000:2d:00.0, compute capability: 7.5)\r\n2021-05-02 22:16:37.593240: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2021-05-02 22:16:37.598426: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n```\r\nI also get this:\r\n\r\n```\r\nUnknownError (see above for traceback): Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[node resnet_v1_50/conv1/Conv2D (defined at /home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py:124) ]]\r\n\t [[node sigmoid_cross_entropy_loss/value (defined at /home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py:283) ]]\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1212/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/835846327","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-835846327","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":835846327,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTg0NjMyNw==","user":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"created_at":"2021-05-09T17:13:29Z","updated_at":"2021-05-09T17:13:29Z","author_association":"NONE","body":"At the end, it worked for me with this:\r\n\r\n```\r\nSet the TF_FORCE_GPU_ALLOW_GROWTH environment variable to true.\r\nIn your terminal, run this command.\r\n$ export TF_FORCE_GPU_ALLOW_GROWTH=true\r\n```\r\nCuriously enough, it did not work for me setting `allow_growth` to true as a python variable, but it did work setting it as a system variable. \r\n\r\nhttps://github.com/tensorflow/tensorflow/issues/24828#issuecomment-742469380","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/835846327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/835893861","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-835893861","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":835893861,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTg5Mzg2MQ==","user":{"login":"alexcwsmith","id":47009665,"node_id":"MDQ6VXNlcjQ3MDA5NjY1","avatar_url":"https://avatars.githubusercontent.com/u/47009665?v=4","gravatar_id":"","url":"https://api.github.com/users/alexcwsmith","html_url":"https://github.com/alexcwsmith","followers_url":"https://api.github.com/users/alexcwsmith/followers","following_url":"https://api.github.com/users/alexcwsmith/following{/other_user}","gists_url":"https://api.github.com/users/alexcwsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/alexcwsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexcwsmith/subscriptions","organizations_url":"https://api.github.com/users/alexcwsmith/orgs","repos_url":"https://api.github.com/users/alexcwsmith/repos","events_url":"https://api.github.com/users/alexcwsmith/events{/privacy}","received_events_url":"https://api.github.com/users/alexcwsmith/received_events","type":"User","site_admin":false},"created_at":"2021-05-09T21:24:05Z","updated_at":"2021-05-09T21:26:19Z","author_association":"CONTRIBUTOR","body":"That is quite curious, I've never seen that variable have an impact on loading cuDNN (unless it's actually a GPU resource issue), but glad it's working for you.\n\nIf you want to set that variable for DLC without adding it to bashrc and having it impact other envs, you can set it at the top of your DLC script:\n\nimport os\nos.environ[\"TF_FORCE_GPU_ALLOW_GROWTH\"]=\"true\"\n","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/835893861/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"alexcwsmith","id":47009665,"node_id":"MDQ6VXNlcjQ3MDA5NjY1","avatar_url":"https://avatars.githubusercontent.com/u/47009665?v=4","gravatar_id":"","url":"https://api.github.com/users/alexcwsmith","html_url":"https://github.com/alexcwsmith","followers_url":"https://api.github.com/users/alexcwsmith/followers","following_url":"https://api.github.com/users/alexcwsmith/following{/other_user}","gists_url":"https://api.github.com/users/alexcwsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/alexcwsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexcwsmith/subscriptions","organizations_url":"https://api.github.com/users/alexcwsmith/orgs","repos_url":"https://api.github.com/users/alexcwsmith/repos","events_url":"https://api.github.com/users/alexcwsmith/events{/privacy}","received_events_url":"https://api.github.com/users/alexcwsmith/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/836283270","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1200#issuecomment-836283270","issue_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1200","id":836283270,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjI4MzI3MA==","user":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"created_at":"2021-05-10T07:17:29Z","updated_at":"2021-05-10T07:17:29Z","author_association":"NONE","body":"Thanks! I'll do it that way. ","reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/comments/836283270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false}}]