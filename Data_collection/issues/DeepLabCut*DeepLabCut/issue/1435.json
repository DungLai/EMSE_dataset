{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1435","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1435/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1435/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1435/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1435","id":952261948,"node_id":"MDU6SXNzdWU5NTIyNjE5NDg=","number":1435,"title":"`Aborted (core dumped)` ... `*** Received signal 8 ***` 2.2rc3 and TF 2.5 ","user":{"login":"A-Telfer","id":75952206,"node_id":"MDQ6VXNlcjc1OTUyMjA2","avatar_url":"https://avatars.githubusercontent.com/u/75952206?v=4","gravatar_id":"","url":"https://api.github.com/users/A-Telfer","html_url":"https://github.com/A-Telfer","followers_url":"https://api.github.com/users/A-Telfer/followers","following_url":"https://api.github.com/users/A-Telfer/following{/other_user}","gists_url":"https://api.github.com/users/A-Telfer/gists{/gist_id}","starred_url":"https://api.github.com/users/A-Telfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/A-Telfer/subscriptions","organizations_url":"https://api.github.com/users/A-Telfer/orgs","repos_url":"https://api.github.com/users/A-Telfer/repos","events_url":"https://api.github.com/users/A-Telfer/events{/privacy}","received_events_url":"https://api.github.com/users/A-Telfer/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2021-07-25T12:15:00Z","updated_at":"2021-07-27T17:31:19Z","closed_at":"2021-07-27T17:27:51Z","author_association":"NONE","active_lock_reason":null,"body":"**Your Operating system and DeepLabCut version**\r\nUbuntu 20.04 LTS\r\nDocker Anaconda Env (Dockerfile below, conda env built using DLCs env file)\r\ndeeplabcut==2.2rc3\r\ntensorflow==2.5.0 (CUDA 11.2, cudnn 8.2)\r\n\r\n**Describe the problem**\r\n~~Running `train_network` leads to a no `attribute 'pose_estimation_tensorflow'` error in a multianimal project (with identity=True).~~\r\nAborted (core dumped) for Multianimal project. Configuration successfully trains non-multianimal projects\r\n\r\n**Complete Log**\r\n\r\n```\r\n(DEEPLABCUT) root@c2839a3a68f7:/shared/gs/johnlab/flies-telfer-2021-07-22# python3 train.py                                                                                                  \r\n2021-07-25 12:12:18.024011: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0                                            \r\nDLC loaded in light mode; you cannot use any GUI (labeling, relabeling and standalone GUI)                                                                                                   \r\n/shared/gs/johnlab/flies-telfer-2021-07-22/training-datasets/iteration-0/UnaugmentedDataSet_fliesJul22  already exists!                                                                      \r\nUtilizing the following graph: []                                                                                                                                                            \r\nCreating training data for: Shuffle: 1 TrainFraction:  0.95                                                                                                                                  \r\n100% | 75/75 [00:00<00:00, 4252.36it/s]\r\n/shared/gs/johnlab/flies-telfer-2021-07-22/dlc-models/iteration-0/fliesJul22-trainset95shuffle1  already exists!                                                                             \r\n/shared/gs/johnlab/flies-telfer-2021-07-22/dlc-models/iteration-0/fliesJul22-trainset95shuffle1/train  already exists!                                                                       \r\n/shared/gs/johnlab/flies-telfer-2021-07-22/dlc-models/iteration-0/fliesJul22-trainset95shuffle1/test  already exists!                                                                        \r\nThe training dataset is successfully created. Use the function 'train_network' to start training. Happy training!                                                                            \r\nSelecting multi-animal trainer                                                                                                                                                               \r\nConfig:                                                                                                                                                                                      \r\n{'all_joints': [[0]],                                                                                                                                                                        \r\n 'all_joints_names': ['bodypart1'],                                                                                                                                                          \r\n 'alpha_r': 0.02,                                                                                                                                                                            \r\n 'batch_size': 8,                                                                                                                                                                            \r\n 'clahe': True,                                                                                                                                                                              \r\n 'claheratio': 0.1,                                                                                                                                                                          \r\n 'crop_pad': 0,                                                                                                                                                                              \r\n 'cropratio': 0.4,                                                                                                                                                                           \r\n 'dataset': 'training-datasets/iteration-0/UnaugmentedDataSet_fliesJul22/flies_telfer95shuffle1.pickle',                                                                                     \r\n 'dataset_type': 'multi-animal-imgaug',                                                                                                                                                      \r\n 'decay_steps': 30000,                                                                                                                                                                       \r\n 'deterministic': False,                                                                                                                                                                     \r\n 'display_iters': 500,                                                                                                                                                                       \r\n 'edge': False,                                                                                                                                                                              \r\n 'emboss': {'alpha': [0.0, 1.0], 'embossratio': 0.1, 'strength': [0.5, 1.5]},                                                                                                                \r\n 'fg_fraction': 0.25,                                                                                                                                                                        \r\n 'global_scale': 0.8,                                                                                                                                                                        \r\n 'histeq': True,                                                                                                                                                                             \r\n 'histeqratio': 0.1,                                                                                                                                                                         \r\n 'init_weights': '/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/deeplabcut/pose_estimation_tensorflow/models/pretrained/resnet_v1_50.ckpt',                                    \r\n 'intermediate_supervision': False,                                                                                                                                                          \r\n 'intermediate_supervision_layer': 12,                                                                                                                                                       \r\n 'location_refinement': True,                                                                                                                                                                \r\n 'locref_huber_loss': True,                                                                                                                                                                  \r\n 'locref_loss_weight': 0.05,                                                                                                                                                                 \r\n 'locref_stdev': 7.2801,                                                                                                                                                                     \r\n 'log_dir': 'log',                                                                                                                                                                           \r\n 'lr_init': 0.0005,                                                                                                                                                                          \r\n 'max_input_size': 1500,                                                                                                                                                                     \r\n 'mean_pixel': [123.68, 116.779, 103.939],                \r\n'metadataset': 'training-datasets/iteration-0/UnaugmentedDataSet_fliesJul22/Documentation_data-flies_95shuffle1.pickle',                                                          [220/1805]\r\n 'min_input_size': 64,                                                                                                                                                                       \r\n 'mirror': False,                                                                                                                                                                            \r\n 'multi_stage': False,                                                                                                                                                                       \r\n 'multi_step': [[0.0001, 7500], [5e-05, 12000], [1e-05, 200000]],                                                                                                                            \r\n 'net_type': 'resnet_50',                                                                                                                                                                    \r\n 'num_idchannel': 2,                                                                                                                                                                         \r\n 'num_joints': 1,                                                                                                                                                                            \r\n 'num_limbs': 0,                                                                                                                                                                             \r\n 'optimizer': 'adam',                                                                                                                                                                        \r\n 'pafwidth': 20,                                                                                                                                                                             \r\n 'pairwise_huber_loss': False,                                                                                                                                                               \r\n 'pairwise_loss_weight': 0.1,\r\n 'pairwise_predict': False,\r\n 'partaffinityfield_graph': [],\r\n 'partaffinityfield_predict': True,\r\n 'pos_dist_thresh': 17,\r\n 'project_path': '/shared/gs/johnlab/flies-telfer-2021-07-22',\r\n 'regularize': False,\r\n 'rotation': 25,\r\n 'rotratio': 0.4,\r\n 'save_iters': 10000,\r\n 'scale_jitter_lo': 0.5,\r\n 'scale_jitter_up': 1.25,\r\n 'scoremap_dir': 'test',\r\n 'sharpen': False,\r\n 'sharpenratio': 0.3,\r\n 'shuffle': True,\r\n 'snapshot_prefix': '/shared/gs/johnlab/flies-telfer-2021-07-22/dlc-models/iteration-0/fliesJul22-trainset95shuffle1/train/snapshot',\r\n 'stride': 8.0,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001}\r\nActivating limb prediction...\r\nBatch Size is 8\r\nGetting specs multi-animal-imgaug 0 1\r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer_v1.py:1692: UserWarning: `layer.apply` is deprecated and will be removed in a future ve\r\nrsion. Please use `layer.__call__` method instead.\r\n  warnings.warn('`layer.apply` is deprecated and '                                                                                                                                 [181/1805]\r\n2021-07-25 12:12:24.835594: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1                                                 \r\n2021-07-25 12:12:25.377348: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA nod\r\ne, so returning NUMA node zero                                                                                                                                                               \r\n2021-07-25 12:12:25.378060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties:                                                                         \r\npciBusID: 0000:00:05.0 name: NVIDIA TITAN V computeCapability: 7.0                                                                                                                           \r\ncoreClock: 1.455GHz coreCount: 80 deviceMemorySize: 11.78GiB deviceMemoryBandwidth: 607.97GiB/s                                                                                              \r\n2021-07-25 12:12:25.378105: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0                                            \r\n2021-07-25 12:12:25.385283: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11                                              \r\n2021-07-25 12:12:25.385387: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11                                            \r\n2021-07-25 12:12:25.387289: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10                                               \r\n2021-07-25 12:12:25.387792: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10                                              \r\n2021-07-25 12:12:25.388805: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11                                            \r\n2021-07-25 12:12:25.390238: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11                                            \r\n2021-07-25 12:12:25.391053: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8                                                \r\n2021-07-25 12:12:25.391285: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA nod\r\ne, so returning NUMA node zero                                                                                                                                                               \r\n2021-07-25 12:12:25.395740: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA nod\r\ne, so returning NUMA node zero                                                                                                                                                               \r\n2021-07-25 12:12:25.396440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0                                                                           \r\n2021-07-25 12:12:25.397746: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CP\r\nU instructions in performance-critical operations:  AVX2 FMA                                                                                                                                 \r\nTo enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.                                                                                                  \r\n2021-07-25 12:12:25.398802: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA nod\r\ne, so returning NUMA node zero                                                                                                                                                               \r\n2021-07-25 12:12:25.399524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties:                                                                         \r\npciBusID: 0000:00:05.0 name: NVIDIA TITAN V computeCapability: 7.0                                                                                                                           \r\ncoreClock: 1.455GHz coreCount: 80 deviceMemorySize: 11.78GiB deviceMemoryBandwidth: 607.97GiB/s                                                                                              \r\n2021-07-25 12:12:25.399666: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA nod\r\ne, so returning NUMA node zero                                                                                                                                                               \r\n2021-07-25 12:12:25.400426: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA nod\r\ne, so returning NUMA node zero                                                                                                                                                               \r\n2021-07-25 12:12:25.401063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0                                                                           \r\n2021-07-25 12:12:25.401134: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0                                            \r\n2021-07-25 12:12:26.243552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:                                         \r\n2021-07-25 12:12:26.243607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0                                                                                                  \r\n2021-07-25 12:12:26.243627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N                                                                                                  \r\n2021-07-25 12:12:26.244006: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA nod\r\ne, so returning NUMA node zero                                                                                                                                                               \r\n2021-07-25 12:12:26.244764: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA nod\r\ne, so returning NUMA node zero                                                                                                                                                               \r\n2021-07-25 12:12:26.245483: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA nod\r\ne, so returning NUMA node zero                                                                                                                                                               \r\n2021-07-25 12:12:26.246134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10551 MB memory) -> physica\r\nl GPU (device: 0, name: NVIDIA TITAN V, pci bus id: 0000:00:05.0, compute capability: 7.0)                                                                                                               [132/1805]\r\ncoreClock: 1.455GHz coreCount: 80 deviceMemorySize: 11.78GiB deviceMemoryBandwidth: 607.97GiB/s\r\n2021-07-25 12:12:26.992197: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA nod\r\ne, so returning NUMA node zero\r\n2021-07-25 12:12:26.992892: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA nod\r\ne, so returning NUMA node zero\r\n2021-07-25 12:12:26.993488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0\r\n2021-07-25 12:12:26.993534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2021-07-25 12:12:26.993550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 \r\n2021-07-25 12:12:26.993566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N \r\n2021-07-25 12:12:26.993720: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA nod\r\ne, so returning NUMA node zero\r\n2021-07-25 12:12:26.994415: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA nod\r\ne, so returning NUMA node zero\r\n2021-07-25 12:12:26.995107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10551 MB memory) -> physica\r\nl GPU (device: 0, name: NVIDIA TITAN V, pci bus id: 0000:00:05.0, compute capability: 7.0)\r\n*** Received signal 8 ***\r\n*** BEGIN MANGLED STACK TRACE ***\r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/../libtensorflow_framework.so.2(+0x122c67d)[0x7f26c530367d]\r\n/lib/x86_64-linux-gnu/libpthread.so.0(+0x12980)[0x7f2722213980]\r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/../libtensorflow_framework.so.2(+0x947fea)[0x7f26c4a1efea]\r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/../libtensorflow_framework.so.2(_ZN10tensorflow15shape_inference30Conv2DShapeWithExplicitPaddingEPNS0_16Inferen\r\nceContextE+0x16)[0x7f26c4a1f6c6]\r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so(_ZNSt17_Function_handlerIFN10tensorflow6StatusEPNS0_15shape_inference16Inference\r\nContextEEPS5_E9_M_invokeERKSt9_Any_dataOS4_+0x14)[0x7f26c9829504]\r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/../libtensorflow_framework.so.2(_ZN10tensorflow15shape_inference16InferenceContext3RunERKSt8functionIFNS_6Statu\r\nsEPS1_EE+0x4e)[0x7f26c4a371ee]\r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/../libtensorflow_framework.so.2(_ZN10tensorflow12ShapeRefiner10RunShapeFnEPKNS_4NodeEPKNS_18OpRegistrationDataE\r\nPNS_24ExtendedInferenceContextEPNS_15shape_inference16InferenceContextE+0x2b4)[0x7f26c4bc2834] \r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/../libtensorflow_framework.so.2(_ZN10tensorflow12ShapeRefiner15AddNodeInternalEPKNS_4NodeEPNS_15shape_inference\r\n16InferenceContextE+0x907)[0x7f26c4bc3d07]\r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/../libtensorflow_framework.so.2(_ZN10tensorflow12ShapeRefiner7AddNodeEPKNS_4NodeE+0x13)[0x7f26c4bc4e13]\r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so(TF_FinishOperation+0x62c)[0x7f26ca047ccc]\r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/_pywrap_tf_session.so(+0x3b9bf)[0x7f26c34929bf]\r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/_pywrap_tf_session.so(+0x307d0)[0x7f26c34877d0]\r\npython3(PyCFunction_Call+0x54)[0x5628e59a6914]\r\npython3(_PyObject_MakeTpCall+0x31e)[0x5628e59a9ebe]\r\npython3(_PyEval_EvalFrameDefault+0x52f6)[0x5628e5a4b986]\r\nPNS_24ExtendedInferenceContextEPNS_15shape_inference16InferenceContextE+0x2b4)[0x7f26c4bc2834]                                                                                     [104/1805]\r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/../libtensorflow_framework.so.2(_ZN10tensorflow12ShapeRefiner15AddNodeInternalEPKNS_4NodeEPNS_15shape_inference\r\n16InferenceContextE+0x907)[0x7f26c4bc3d07]                                                                                                                                                   \r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/../libtensorflow_framework.so.2(_ZN10tensorflow12ShapeRefiner7AddNodeEPKNS_4NodeE+0x13)[0x7f26c4bc4e13]        \r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so(TF_FinishOperation+0x62c)[0x7f26ca047ccc]                                       \r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/_pywrap_tf_session.so(+0x3b9bf)[0x7f26c34929bf]                                                                \r\n/root/miniconda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/_pywrap_tf_session.so(+0x307d0)[0x7f26c34877d0]                                                                \r\npython3(PyCFunction_Call+0x54)[0x5628e59a6914]                                                                                                                                               \r\npython3(_PyObject_MakeTpCall+0x31e)[0x5628e59a9ebe]                                                                                                                                     \r\npython3(Py_RunMain+0x36d)[0x5628e5aeb77d]                                                                                                                                                    \r\npython3(Py_BytesMain+0x39)[0x5628e5aeb939]                                                                                                                                                   \r\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xe7)[0x7f2721484bf7]                                                                                                                      \r\npython3(+0x1e8f39)[0x5628e5a5ff39]                                                                                                                                                           \r\n*** END MANGLED STACK TRACE ***                                                                                                                               \r\n*** Begin stack trace ***                                                                                                                                                                    \r\n        tensorflow::CurrentStackTrace()                                                                                                                                       \r\n        tensorflow::shape_inference::Conv2DShapeWithExplicitPadding(tensorflow::shape_inference::InferenceContext*)                                                                          \r\n        std::_Function_handler<tensorflow::Status (tensorflow::shape_inference::InferenceContext*), tensorflow::Status (*)(tensorflow::shape_inference::InferenceContext*)>::_M_invoke(std::_\r\nAny_data const&, tensorflow::shape_inference::InferenceContext*&&)                                                                                                                           \r\n        tensorflow::shape_inference::InferenceContext::Run(std::function<tensorflow::Status (tensorflow::shape_inference::InferenceContext*)> const&)                                        \r\n        tensorflow::ShapeRefiner::RunShapeFn(tensorflow::Node const*, tensorflow::OpRegistrationData const*, tensorflow::ExtendedInferenceContext*, tensorflow::shape_inference::InferenceCon\r\ntext*)                                                                                                                                                                                       \r\n        tensorflow::ShapeRefiner::AddNodeInternal(tensorflow::Node const*, tensorflow::shape_inference::InferenceContext*)                                                                   \r\n        tensorflow::ShapeRefiner::AddNode(tensorflow::Node const*)                                                                                                                           \r\n        TF_FinishOperation                                                                                                                                                     \r\n        PyCFunction_Call                                                                                                                                                                     \r\n        _PyObject_MakeTpCall                                                                                                                                                                 \r\n        _PyEval_EvalFrameDefault                                                                                                                                                             \r\n        _PyEval_EvalCodeWithName                                                                                                                                                             \r\n        _PyFunction_Vectorcall                                                                                                                                                               \r\n        _PyEval_EvalFrameDefault  \r\n        _PyEval_EvalCodeWithName                                                                                                                                                     [0/1805]\r\n        _PyFunction_Vectorcall                                                                \r\n        _PyEval_EvalFrameDefault             \r\n        _PyFunction_Vectorcall    \r\n        PyObject_Call             \r\n        _PyEval_EvalFrameDefault  \r\n        _PyEval_EvalCodeWithName                                                              \r\n        _PyFunction_Vectorcall           \r\n        _PyEval_EvalFrameDefault          \r\n        _PyFunction_Vectorcall                                                                \r\n        _PyEval_EvalFrameDefault  \r\n        _PyEval_EvalCodeWithName\r\n        _PyFunction_Vectorcall                 \r\n        _PyEval_EvalFrameDefault\r\n        _PyEval_EvalCodeWithName       \r\n        _PyFunction_Vectorcall                 \r\n        _PyEval_EvalFrameDefault               \r\n        _PyEval_EvalCodeWithName               \r\n                                                                                                                                                                                             \r\n        _PyEval_EvalFrameDefault                                                                                                                                                             \r\n        _PyEval_EvalCodeWithName                                                              \r\n        _PyFunction_Vectorcall                                                                                                                                                               \r\n        _PyEval_EvalFrameDefault                                                                                                                                                             \r\n        _PyEval_EvalCodeWithName\r\n        _PyFunction_Vectorcall                                                                                                                                                               \r\n        _PyEval_EvalFrameDefault                                                              \r\n        _PyFunction_Vectorcall\r\n        _PyEval_EvalFrameDefault               \r\n        _PyEval_EvalCodeWithName\r\n        _PyFunction_Vectorcall\r\n        _PyEval_EvalFrameDefault\r\n        _PyEval_EvalCodeWithName\r\n        _PyFunction_Vectorcall\r\n        _PyEval_EvalFrameDefault\r\n        _PyEval_EvalCodeWithName\r\n        PyEval_EvalCodeEx\r\n        PyEval_EvalCode\r\n        PyRun_SimpleFileExFlags\r\n        Py_RunMain\r\n        Py_BytesMain\r\n        __libc_start_main\r\n\r\n*** End stack trace ***\r\nAborted (core dumped)\r\n```\r\n\r\n**How to Reproduce the problem**\r\nSteps to reproduce the behavior:\r\n1. Create a multianimal project\r\n2. Attempt to train a model...\r\n```python\r\nimport deeplabcut as dlc\r\nconfig = '<path to my project>/config.yaml' # edit \r\ndlc.create_training_dataset(config)\r\ndlc.train_network(config)\r\n```\r\n## Additional context\r\nDockerfile \r\n```Dockerfile\r\nfrom tensorflow/tensorflow:2.5.0-gpu-jupyter\r\n\r\n# Common misc dependencies (OpenCV, FFmpeg, etc...)\r\nRUN apt-get update \r\nRUN apt-get install -y build-essential cmake unzip pkg-config wget \\\r\n    libjpeg-dev libpng-dev libtiff-dev \\\r\n    libavcodec-dev libavformat-dev libswscale-dev \\\r\n    libv4l-dev libxvidcore-dev libx264-dev \\\r\n    libgtk-3-dev libatlas-base-dev gfortran \\\r\n    python3-dev git wget libgtk2.0-dev libxxf86vm1 ffmpeg\r\n\r\n# Install Anaconda\r\nRUN wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O ~/miniconda.sh\r\nRUN bash ~/miniconda.sh -b -p $HOME/miniconda\r\nRUN sed -e 's|PATH=\"\\(.*\\)\"|PATH=\"/root/miniconda/bin:\\1\"|g' -i /etc/environment\r\nENV PATH=\"/root/miniconda/bin:${PATH}\"\r\n\r\n# Create environment\r\nWORKDIR /usr/local/src\r\nRUN git clone https://github.com/DeepLabCut/DeepLabCut.git\r\nWORKDIR /usr/local/src/DeepLabCut\r\nRUN git checkout 75159dfb8278a07f836cc10ffa80f03986ef4de1\r\nRUN sed -e 's|\\[gui\\]||g' -i ./conda-environments/DEEPLABCUT.yaml\r\nRUN cat ./conda-environments/DEEPLABCUT.yaml\r\nRUN conda env create -f ./conda-environments/DEEPLABCUT.yaml\r\n\r\nSHELL [\"conda\", \"run\", \"-n\", \"DEEPLABCUT\", \"/bin/bash\", \"-c\"]\r\nRUN conda install -c conda-forge cudnn\r\nRUN conda install cudatoolkit \r\nRUN python -m ipykernel install --user --name DEEPLABCUT --display-name \"DEEPLABCUT\"\r\nENV DLClight=True \r\n```\r\n\r\ndocker-compose.yml file\r\n```\r\nversion: '3.8'\r\nservices:\r\n  dlc:\r\n    tty: true\r\n    stdin_open: true\r\n    build: dlc\r\n    command: ./run.sh \r\n    build: \r\n      context: ./dlc\r\n    ports:\r\n      - 8888:8888\r\n    env_file:\r\n      - .env\r\n    volumes:\r\n      - ${SHARED_VOLUME}:/shared\r\n    deploy:\r\n      resources:\r\n        reservations:\r\n          devices:\r\n          - capabilities: [gpu]\r\n```\r\n\r\nto run: `sudo docker-compose run dlc bash`, then activate the DEEPLABCUT environment, and run the python training script supplied above","closed_by":{"login":"A-Telfer","id":75952206,"node_id":"MDQ6VXNlcjc1OTUyMjA2","avatar_url":"https://avatars.githubusercontent.com/u/75952206?v=4","gravatar_id":"","url":"https://api.github.com/users/A-Telfer","html_url":"https://github.com/A-Telfer","followers_url":"https://api.github.com/users/A-Telfer/followers","following_url":"https://api.github.com/users/A-Telfer/following{/other_user}","gists_url":"https://api.github.com/users/A-Telfer/gists{/gist_id}","starred_url":"https://api.github.com/users/A-Telfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/A-Telfer/subscriptions","organizations_url":"https://api.github.com/users/A-Telfer/orgs","repos_url":"https://api.github.com/users/A-Telfer/repos","events_url":"https://api.github.com/users/A-Telfer/events{/privacy}","received_events_url":"https://api.github.com/users/A-Telfer/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1435/timeline","performed_via_github_app":null,"state_reason":"completed"}