{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/667","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/667/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/667/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/667/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/667","id":608112372,"node_id":"MDU6SXNzdWU2MDgxMTIzNzI=","number":667,"title":"\"UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\"","user":{"login":"Ejdrup","id":50575240,"node_id":"MDQ6VXNlcjUwNTc1MjQw","avatar_url":"https://avatars.githubusercontent.com/u/50575240?v=4","gravatar_id":"","url":"https://api.github.com/users/Ejdrup","html_url":"https://github.com/Ejdrup","followers_url":"https://api.github.com/users/Ejdrup/followers","following_url":"https://api.github.com/users/Ejdrup/following{/other_user}","gists_url":"https://api.github.com/users/Ejdrup/gists{/gist_id}","starred_url":"https://api.github.com/users/Ejdrup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ejdrup/subscriptions","organizations_url":"https://api.github.com/users/Ejdrup/orgs","repos_url":"https://api.github.com/users/Ejdrup/repos","events_url":"https://api.github.com/users/Ejdrup/events{/privacy}","received_events_url":"https://api.github.com/users/Ejdrup/received_events","type":"User","site_admin":false},"labels":[{"id":1816193536,"node_id":"MDU6TGFiZWwxODE2MTkzNTM2","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/tensorflow/training","name":"tensorflow/training","color":"0052cc","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-04-28T08:07:32Z","updated_at":"2020-04-29T10:25:08Z","closed_at":"2020-04-29T04:48:23Z","author_association":"NONE","active_lock_reason":null,"body":"Im on Windows 10 using DLC 2.1.7 in a conda environment following your installation guide running in chrome. I have a GTX 1660 TI and I'm running your Demo_yourowndata.ipynb\r\n\r\nDeepLabCut works perfectly until it's time starting to train the network. Upon initializing:\r\n\r\n`deeplabcut.train_network(path_config_file)`\r\n\r\nI get the following lengthy error message:\r\n```\r\nStarting training....\r\n---------------------------------------------------------------------------\r\nUnknownError                              Traceback (most recent call last)\r\nC:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\r\n   1333     try:\r\n-> 1334       return fn(*args)\r\n   1335     except errors.OpError as e:\r\n\r\nC:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)\r\n   1318       return self._call_tf_sessionrun(\r\n-> 1319           options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1320 \r\n\r\nC:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1406         self._session, options, feed_dict, fetch_list, target_list,\r\n-> 1407         run_metadata)\r\n   1408 \r\n\r\nUnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[{{node resnet_v1_50/conv1/Conv2D}}]]\r\n\t [[{{node train_op/control_dependency}}]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nUnknownError                              Traceback (most recent call last)\r\n<ipython-input-4-7e3f40db92d4> in <module>\r\n----> 1 deeplabcut.train_network(path_config_file)\r\n\r\nC:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\training.py in train_network(config, shuffle, trainingsetindex, max_snapshots_to_keep, displayiters, saveiters, maxiters, allow_growth, gputouse, autotune, keepdeconvweights)\r\n    132         train(str(poseconfigfile),displayiters,saveiters,maxiters,max_to_keep=max_snapshots_to_keep,keepdeconvweights=keepdeconvweights,allow_growth=allow_growth) #pass on path and file name for pose_cfg.yaml!\r\n    133     except BaseException as e:\r\n--> 134         raise e\r\n    135     finally:\r\n    136         os.chdir(str(start_path))\r\n\r\nC:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\training.py in train_network(config, shuffle, trainingsetindex, max_snapshots_to_keep, displayiters, saveiters, maxiters, allow_growth, gputouse, autotune, keepdeconvweights)\r\n    130             os.environ['CUDA_VISIBLE_DEVICES'] = str(gputouse)\r\n    131     try:\r\n--> 132         train(str(poseconfigfile),displayiters,saveiters,maxiters,max_to_keep=max_snapshots_to_keep,keepdeconvweights=keepdeconvweights,allow_growth=allow_growth) #pass on path and file name for pose_cfg.yaml!\r\n    133     except BaseException as e:\r\n    134         raise e\r\n\r\nC:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train.py in train(config_yaml, displayiters, saveiters, maxiters, max_to_keep, keepdeconvweights, allow_growth)\r\n    188         current_lr = lr_gen.get_lr(it)\r\n    189         [_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],\r\n--> 190                                           feed_dict={learning_rate: current_lr})\r\n    191         cum_loss += loss_val\r\n    192         train_writer.add_summary(summary, it)\r\n\r\nC:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\client\\session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    927     try:\r\n    928       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 929                          run_metadata_ptr)\r\n    930       if run_metadata:\r\n    931         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\nC:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n   1150     if final_fetches or final_targets or (handle and feed_dict_tensor):\r\n   1151       results = self._do_run(handle, final_targets, final_fetches,\r\n-> 1152                              feed_dict_tensor, options, run_metadata)\r\n   1153     else:\r\n   1154       results = []\r\n\r\nC:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n   1326     if handle is None:\r\n   1327       return self._do_call(_run_fn, feeds, fetches, targets, options,\r\n-> 1328                            run_metadata)\r\n   1329     else:\r\n   1330       return self._do_call(_prun_fn, handle, feeds, fetches)\r\n\r\nC:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\r\n   1346           pass\r\n   1347       message = error_interpolation.interpolate(message, self._graph)\r\n-> 1348       raise type(e)(node_def, op, message)\r\n   1349 \r\n   1350   def _extend_graph(self):\r\n\r\nUnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[node resnet_v1_50/conv1/Conv2D (defined at C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\nnet\\pose_net.py:52) ]]\r\n\t [[node train_op/control_dependency (defined at C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train.py:102) ]]\r\n\r\nCaused by op 'resnet_v1_50/conv1/Conv2D', defined at:\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\ipykernel_launcher.py\", line 16, in <module>\r\n    app.launch_new_instance()\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\traitlets\\config\\application.py\", line 664, in launch_instance\r\n    app.start()\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\ipykernel\\kernelapp.py\", line 583, in start\r\n    self.io_loop.start()\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tornado\\platform\\asyncio.py\", line 149, in start\r\n    self.asyncio_loop.run_forever()\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\asyncio\\base_events.py\", line 541, in run_forever\r\n    self._run_once()\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\asyncio\\base_events.py\", line 1786, in _run_once\r\n    handle._run()\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\asyncio\\events.py\", line 88, in _run\r\n    self._context.run(self._callback, *self._args)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tornado\\ioloop.py\", line 690, in <lambda>\r\n    lambda f: self._run_callback(functools.partial(callback, future))\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tornado\\ioloop.py\", line 743, in _run_callback\r\n    ret = callback()\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tornado\\gen.py\", line 787, in inner\r\n    self.run()\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tornado\\gen.py\", line 748, in run\r\n    yielded = self.gen.send(value)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 361, in process_one\r\n    yield gen.maybe_future(dispatch(*args))\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tornado\\gen.py\", line 209, in wrapper\r\n    yielded = next(result)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 268, in dispatch_shell\r\n    yield gen.maybe_future(handler(stream, idents, msg))\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tornado\\gen.py\", line 209, in wrapper\r\n    yielded = next(result)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 541, in execute_request\r\n    user_expressions, allow_stdin,\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tornado\\gen.py\", line 209, in wrapper\r\n    yielded = next(result)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\ipykernel\\ipkernel.py\", line 300, in do_execute\r\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\ipykernel\\zmqshell.py\", line 536, in run_cell\r\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2858, in run_cell\r\n    raw_cell, store_history, silent, shell_futures)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2886, in _run_cell\r\n    return runner(coro)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\core\\async_helpers.py\", line 68, in _pseudo_sync_runner\r\n    coro.send(None)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 3063, in run_cell_async\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 3254, in run_ast_nodes\r\n    if (await self.run_code(code, result,  async_=asy)):\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 3331, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-4-7e3f40db92d4>\", line 1, in <module>\r\n    deeplabcut.train_network(path_config_file)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\training.py\", line 132, in train_network\r\n    train(str(poseconfigfile),displayiters,saveiters,maxiters,max_to_keep=max_snapshots_to_keep,keepdeconvweights=keepdeconvweights,allow_growth=allow_growth) #pass on path and file name for pose_cfg.yaml!\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train.py\", line 119, in train\r\n    losses = pose_net(cfg).train(batch)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\nnet\\pose_net.py\", line 154, in train\r\n    heads = self.get_net(batch[Batch.inputs])\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\nnet\\pose_net.py\", line 81, in get_net\r\n    net, end_points = self.extract_features(inputs)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\nnet\\pose_net.py\", line 52, in extract_features\r\n    global_pool=False, output_stride=self.cfg.output_stride,is_training=False)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\contrib\\slim\\python\\slim\\nets\\resnet_v1.py\", line 274, in resnet_v1_50\r\n    scope=scope)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\contrib\\slim\\python\\slim\\nets\\resnet_v1.py\", line 205, in resnet_v1\r\n    net = resnet_utils.conv2d_same(net, 64, 7, stride=2, scope='conv1')\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\contrib\\slim\\python\\slim\\nets\\resnet_utils.py\", line 146, in conv2d_same\r\n    scope=scope)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\contrib\\framework\\python\\ops\\arg_scope.py\", line 182, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\contrib\\layers\\python\\layers\\layers.py\", line 1155, in convolution2d\r\n    conv_dims=2)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\contrib\\framework\\python\\ops\\arg_scope.py\", line 182, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\contrib\\layers\\python\\layers\\layers.py\", line 1058, in convolution\r\n    outputs = layer.apply(inputs)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\base_layer.py\", line 1227, in apply\r\n    return self.__call__(inputs, *args, **kwargs)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\layers\\base.py\", line 530, in __call__\r\n    outputs = super(Layer, self).__call__(inputs, *args, **kwargs)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\base_layer.py\", line 554, in __call__\r\n    outputs = self.call(inputs, *args, **kwargs)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\keras\\layers\\convolutional.py\", line 194, in call\r\n    outputs = self._convolution_op(inputs, self.kernel)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\ops\\nn_ops.py\", line 966, in __call__\r\n    return self.conv_op(inp, filter)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\ops\\nn_ops.py\", line 591, in __call__\r\n    return self.call(inp, filter)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\ops\\nn_ops.py\", line 208, in __call__\r\n    name=self.name)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\ops\\gen_nn_ops.py\", line 1026, in conv2d\r\n    data_format=data_format, dilations=dilations, name=name)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 788, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\util\\deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3300, in create_op\r\n    op_def=op_def)\r\n  File \"C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1801, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nUnknownError (see above for traceback): Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[node resnet_v1_50/conv1/Conv2D (defined at C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\nnet\\pose_net.py:52) ]]\r\n\t [[node train_op/control_dependency (defined at C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train.py:102) ]]\r\n```\r\n\r\nI have CUDA 10.0, TF 1.13.1 and\r\n`(DLC-GPU) C:\\windows\\system32>conda list cudnn`\r\nyields\r\n`cudnn                     7.6.5                cuda10.0_0`\r\n\r\nLooking for solutions I ran into the command:\r\n`os.environ['TF_FORCE_GPU_ALLOW_GROWTH'] = 'true'`\r\nWhich removes the error message and starts the training, but the on displayiter = 1000 nothing happens and on displayiter = 100 only the first two iterations succeed in just a few min, and the it just stops progressing.. Ive let it run overnight.","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/667/timeline","performed_via_github_app":null,"state_reason":"completed"}