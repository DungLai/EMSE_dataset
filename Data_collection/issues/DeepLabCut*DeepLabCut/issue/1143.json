{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1143","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1143/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1143/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1143/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1143","id":831038626,"node_id":"MDU6SXNzdWU4MzEwMzg2MjY=","number":1143,"title":"FileNotFoundError when running triangulate in 3D DLC","user":{"login":"maimechevee","id":35109451,"node_id":"MDQ6VXNlcjM1MTA5NDUx","avatar_url":"https://avatars.githubusercontent.com/u/35109451?v=4","gravatar_id":"","url":"https://api.github.com/users/maimechevee","html_url":"https://github.com/maimechevee","followers_url":"https://api.github.com/users/maimechevee/followers","following_url":"https://api.github.com/users/maimechevee/following{/other_user}","gists_url":"https://api.github.com/users/maimechevee/gists{/gist_id}","starred_url":"https://api.github.com/users/maimechevee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maimechevee/subscriptions","organizations_url":"https://api.github.com/users/maimechevee/orgs","repos_url":"https://api.github.com/users/maimechevee/repos","events_url":"https://api.github.com/users/maimechevee/events{/privacy}","received_events_url":"https://api.github.com/users/maimechevee/received_events","type":"User","site_admin":false},"labels":[{"id":1932265427,"node_id":"MDU6TGFiZWwxOTMyMjY1NDI3","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/3D","name":"3D","color":"ddf952","default":false,"description":"questions/code issues regarding 3D DLC"}],"state":"closed","locked":false,"assignee":{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false},"assignees":[{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false}],"milestone":null,"comments":9,"created_at":"2021-03-14T01:16:30Z","updated_at":"2021-05-10T18:05:55Z","closed_at":"2021-05-10T17:58:28Z","author_association":"NONE","active_lock_reason":null,"body":"OS:  Windows 10\r\nDeepLabCut Version: 2.2b8\r\nAnaconda env used: DLC-GPU\r\n\r\n**Describe the problem**\r\n\r\nHello, I seem to be missing the .h5 basic output file from the 2d DLC analyses, which gives me the error below when I run deeplabcut.triangulate(config_path3d, Videos_folder_path, filterpredictions=True). \r\n\r\nI have tried pre-analyzing the videos, in which case I get output files with the following endings (I'm happy with these):\r\n'_bx.h5'\r\n'_bx.pickle'\r\n'_bx_filtered.csv'\r\n'_bx_filtered.h5'\r\n'_bx_filtered_bp_labeled.mp4'\r\n'_filtered.csv'\r\n'_filtered.h5'\r\n'_full.pickle'\r\n'_meta.pickle'\r\n\r\nOr letting the triangulate function run the deeplabcut.analyze_videos() command. in which case the only outputs created (before it errors) are:\r\n'_full.pickle'\r\n'_meta.pickle'\r\n\r\n\r\nPlease place code inside this:\r\nconfig_path3d='C:\\\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Test3D-Maxime-2021-03-05-3d\\config.yaml'\r\ndeeplabcut.calibrate_cameras(config_path3d, cbrow=7, cbcol=5, calibrate=True, alpha=0.9)\r\ndeeplabcut.check_undistortion(config_path3d, cbrow=7, cbcol=5)\r\nVideos_folder_path='C:\\\\Users\\\\Brown Lab\\\\Desktop\\\\Calipari Lab\\\\Mice\\\\Inscopix\\\\3146-210226-135049'\r\ndeeplabcut.triangulate(config_path3d, Videos_folder_path, filterpredictions=True)\r\n\r\n<details><summary>Code output</summary><p>\r\nList of pairs: [['C:\\\\Users\\\\Brown Lab\\\\Desktop\\\\Calipari Lab\\\\Mice\\\\Inscopix\\\\3146-210226-135049\\\\Inscopix-210208-082641_3146-210226-135049_Cam1.avi', 'C:\\\\Users\\\\Brown Lab\\\\Desktop\\\\Calipari Lab\\\\Mice\\\\Inscopix\\\\3146-210226-135049\\\\Inscopix-210208-082641_3146-210226-135049_Cam2.avi']]\r\nAnalyzing video C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049\\Inscopix-210208-082641_3146-210226-135049_Cam1.avi using config_file_Cam1\r\nUsing snapshot-70000 for model C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\cueFR5-Maxime-2021-02-23\\dlc-models\\iteration-0\\cueFR5Feb23-trainset95shuffle1\r\nInitializing ResNet\r\nActivating extracting of PAFs\r\n  0%|                                                                                        | 0/12549 [00:00<?, ?it/s]\r\nStarting to analyze %  C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049\\Inscopix-210208-082641_3146-210226-135049_Cam1.avi\r\nC:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049  already exists!\r\nLoading  C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049\\Inscopix-210208-082641_3146-210226-135049_Cam1.avi\r\nDuration of video [s]:  627.45 , recorded with  20.0 fps!\r\nOverall # of frames:  12549  found with (before cropping) frame dimensions:  640 480\r\nStarting to extract posture\r\n12625it [14:57, 13.99it/s]                                                                                             \r\nDetected frames:  12549\r\n12625it [15:01, 14.00it/s]\r\nSaving results in C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049...\r\nThe videos are analyzed. Time to assemble animals and track 'em... \r\n Call 'create_video_with_all_detections' to check multi-animal detection quality before tracking.\r\nIf the tracking is not satisfactory for some videos, consider expanding the training set. You can use the function 'extract_outlier_frames' to extract a few representative outlier frames.\r\nC:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049 Inscopix-210208-082641_3146-210226-135049_Cam1 DLC_resnet50_cueFR5Feb23shuffle1_70000\r\nFiltering with median model C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049\\Inscopix-210208-082641_3146-210226-135049_Cam1.avi\r\nNo unfiltered data file found in C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049 for video Inscopix-210208-082641_3146-210226-135049_Cam1 and scorer DLC_resnet50_cueFR5Feb23shuffle1_70000.\r\nAnalyzing video C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049\\Inscopix-210208-082641_3146-210226-135049_Cam2.avi using config_file_Cam2\r\nUsing snapshot-40000 for model C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\cueFR5-Maxime-2021-02-11\\dlc-models\\iteration-0\\cueFR5Feb11-trainset95shuffle1\r\nInitializing ResNet\r\nActivating extracting of PAFs\r\n  0%|                                                                                        | 0/12527 [00:00<?, ?it/s]\r\nStarting to analyze %  C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049\\Inscopix-210208-082641_3146-210226-135049_Cam2.avi\r\nC:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049  already exists!\r\nLoading  C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049\\Inscopix-210208-082641_3146-210226-135049_Cam2.avi\r\nDuration of video [s]:  417.57 , recorded with  30.0 fps!\r\nOverall # of frames:  12527  found with (before cropping) frame dimensions:  640 480\r\nStarting to extract posture\r\n12625it [17:39, 11.80it/s]                                                                                             \r\nDetected frames:  12527\r\n12625it [17:41, 11.89it/s]\r\nSaving results in C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049...\r\nThe videos are analyzed. Time to assemble animals and track 'em... \r\n Call 'create_video_with_all_detections' to check multi-animal detection quality before tracking.\r\nIf the tracking is not satisfactory for some videos, consider expanding the training set. You can use the function 'extract_outlier_frames' to extract a few representative outlier frames.\r\nC:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049 Inscopix-210208-082641_3146-210226-135049_Cam2 DLC_resnet50_cueFR5Feb11shuffle1_40000\r\nFiltering with median model C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049\\Inscopix-210208-082641_3146-210226-135049_Cam2.avi\r\nNo unfiltered data file found in C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049 for video Inscopix-210208-082641_3146-210226-135049_Cam2 and scorer DLC_resnet50_cueFR5Feb11shuffle1_40000.\r\nUndistorting...\r\n---------------------------------------------------------------------------\r\nFileNotFoundError                         Traceback (most recent call last)\r\n<ipython-input-19-4a6d0d62bfee> in <module>\r\n----> 1 deeplabcut.triangulate(config_path3d, Videos_folder_path, filterpredictions=True)\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_3d\\triangulation.py in triangulate(config, video_path, videotype, filterpredictions, filtertype, gputouse, destfolder, save_as_csv)\r\n    302                 path_stereo_file,\r\n    303             ) = undistort_points(\r\n--> 304                 config, dataname, str(cam_names[0] + \"-\" + cam_names[1]), destfolder\r\n    305             )\r\n    306             if len(dataFrame_camera1_undistort) != len(dataFrame_camera2_undistort):\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_3d\\triangulation.py in undistort_points(config, dataframe, camera_pair, destfolder)\r\n    451     if True:\r\n    452         # Create an empty dataFrame to store the undistorted 2d coordinates and likelihood\r\n--> 453         dataframe_cam1 = pd.read_hdf(dataframe[0])\r\n    454         dataframe_cam2 = pd.read_hdf(dataframe[1])\r\n    455         scorer_cam1 = dataframe_cam1.columns.get_level_values(0)[0]\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\pandas\\io\\pytables.py in read_hdf(path_or_buf, key, mode, errors, where, start, stop, columns, iterator, chunksize, **kwargs)\r\n    385 \r\n    386         if not exists:\r\n--> 387             raise FileNotFoundError(f\"File {path_or_buf} does not exist\")\r\n    388 \r\n    389         store = HDFStore(path_or_buf, mode=mode, errors=errors, **kwargs)\r\n\r\nFileNotFoundError: File C:\\Users\\Brown Lab\\Desktop\\Calipari Lab\\Mice\\Inscopix\\3146-210226-135049\\Inscopix-210208-082641_3146-210226-135049_Cam1DLC_resnet50_cueFR5Feb23shuffle1_70000.h5 does not exist\r\n\r\n\r\n</p></details>\r\n\r\n**How to Reproduce the problem**\r\nSteps to reproduce the behavior:\r\n1. After calibrating the videos, I ran this line which generated the error copied above: deeplabcut.triangulate(config_path3d, Videos_folder_path, filterpredictions=True)\r\n2. When I tested it by pre-analyzing each video separately, this was the code:\r\nHome_dir='C://Users//Brown Lab//Desktop//Calipari Lab//Mice'\r\nmice=['Inscopix']\r\nfor mouse in mice:\r\n    mouse_dir=os.path.join(Home_dir,mouse)\r\n    Dates=['3146-210226-135049']\r\n    for date in Dates:\r\n        date_dir=os.path.join(mouse_dir, date)\r\n        #path_config_file='C:\\\\Users\\\\Brown Lab\\\\Desktop\\\\Calipari Lab\\\\Mice\\\\cueFR5-Maxime-2021-02-11\\\\config.yaml'\r\n        path_config_file='C:\\\\Users\\\\Brown Lab\\\\Desktop\\\\Calipari Lab\\\\Mice\\\\cueFR5-Maxime-2021-02-23\\\\config.yaml'\r\n\r\n        videofile=[x for x in os.listdir(date_dir) if 'Cam2' in x][0]\r\n         #define video location\r\n        videofile_path =os.path.join(date_dir,videofile)\r\n\r\n        #Analyze video\r\n        scorename=deeplabcut.analyze_videos(path_config_file,videofile_path, videotype='.avi')\r\n\r\n        #convert detections to tracklets\r\n        deeplabcut.convert_detections2tracklets(path_config_file, videofile_path, videotype='mp4', shuffle=1, trainingsetindex=0, track_method='box', overwrite=True)\r\n\r\n        #formatting of outputs\r\n        tracklet_file_path =os.path.join(date_dir,[f for f in os.listdir(date_dir) if f[-10:]=='_bx.pickle'][0])\r\n        deeplabcut.convert_raw_tracks_to_h5(path_config_file,tracklet_file_path, min_tracklet_len=0) \r\n\r\n        #filter\r\n        deeplabcut.filterpredictions(path_config_file,videofile_path, track_method='box')\r\n\r\n        #Save results\r\n        deeplabcut.refine_training_dataset.convert_raw_tracks_to_h5(path_config_file, tracklet_file_path)\r\n\r\n        #Make and save labeled video\r\n        deeplabcut.create_labeled_video(path_config_file,videofile_path, track_method='box', filtered=True, draw_skeleton=True)\r\n\r\nThank you!","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1143/timeline","performed_via_github_app":null,"state_reason":"completed"}