{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1663","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1663/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1663/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1663/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1663","id":1122072925,"node_id":"I_kwDOB5BM6c5C4Xld","number":1663,"title":"Failure to evaluate trained network and analyze videos/ plot trajectories","user":{"login":"bgibWh","id":89856024,"node_id":"MDQ6VXNlcjg5ODU2MDI0","avatar_url":"https://avatars.githubusercontent.com/u/89856024?v=4","gravatar_id":"","url":"https://api.github.com/users/bgibWh","html_url":"https://github.com/bgibWh","followers_url":"https://api.github.com/users/bgibWh/followers","following_url":"https://api.github.com/users/bgibWh/following{/other_user}","gists_url":"https://api.github.com/users/bgibWh/gists{/gist_id}","starred_url":"https://api.github.com/users/bgibWh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bgibWh/subscriptions","organizations_url":"https://api.github.com/users/bgibWh/orgs","repos_url":"https://api.github.com/users/bgibWh/repos","events_url":"https://api.github.com/users/bgibWh/events{/privacy}","received_events_url":"https://api.github.com/users/bgibWh/received_events","type":"User","site_admin":false},"labels":[{"id":1313079487,"node_id":"MDU6TGFiZWwxMzEzMDc5NDg3","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/howtousedlc","name":"howtousedlc","color":"a1b3f4","default":false,"description":"issue regarding the use of DeepLabCut"}],"state":"closed","locked":false,"assignee":{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false},"assignees":[{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false}],"milestone":null,"comments":14,"created_at":"2022-02-02T15:33:43Z","updated_at":"2022-03-02T08:30:03Z","closed_at":"2022-03-02T08:30:02Z","author_association":"NONE","active_lock_reason":null,"body":"### Is there an existing issue for this?\n\n- [X] I have searched the existing issues\n\n### Bug description\n\nI tried to evaluate the network after training and get a wxAssertionError and when I try to use deeplabcut.plot_trajectories, deeplabcut.filterpredictions and deeplabcut.create_labeled_video I get the output:\r\n\r\nNo unfiltered data file found in D:\\Zfish2\\zfish-Brendan-2022-01-28\\videos for video zfish1 and scorer DLC_resnet50_zfishJan28shuffle1_200000 and ellipse tracker.\n\n### Operating System\n\nWindows 10\n\n### DeepLabCut version\n\n2.2.05\n\n### DeepLabCut mode\n\nsingle animal\n\n### Device type\n\nGeForce RTX 2080 SUPER\n\n### Steps To Reproduce\n\nTrain network then once I evaluate network it starts working then get an error\n\n### Relevant log output\n\n```shell\ndeeplabcut.evaluate_network('E:\\\\Deeplab\\\\redfish_flowtank-Brendan-2022-02-01\\\\config.yaml', plotting=True)\r\nConfig:\r\n{'all_joints': [[0], [1], [2], [3], [4], [5], [6], [7], [8], [9]],\r\n 'all_joints_names': ['snout',\r\n                      'MLA',\r\n                      'MLB',\r\n                      'MLC',\r\n                      'MLD',\r\n                      'MLE',\r\n                      'MLF',\r\n                      'MLG',\r\n                      'MLH',\r\n                      'tail'],\r\n 'batch_size': 1,\r\n 'crop_pad': 0,\r\n 'dataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_redfish_flowtankFeb1\\\\redfish_flowtank_Brendan95shuffle1.mat',\r\n 'dataset_type': 'imgaug',\r\n 'deterministic': False,\r\n 'fg_fraction': 0.25,\r\n 'global_scale': 0.8,\r\n 'init_weights': 'C:\\\\Users\\\\brendan.gibbs\\\\Anaconda3\\\\envs\\\\DEEPLABCUT3\\\\lib\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt',\r\n 'intermediate_supervision': False,\r\n 'intermediate_supervision_layer': 12,\r\n 'location_refinement': True,\r\n 'locref_huber_loss': True,\r\n 'locref_loss_weight': 1.0,\r\n 'locref_stdev': 7.2801,\r\n 'log_dir': 'log',\r\n 'mean_pixel': [123.68, 116.779, 103.939],\r\n 'mirror': False,\r\n 'net_type': 'resnet_50',\r\n 'num_joints': 10,\r\n 'optimizer': 'sgd',\r\n 'pairwise_huber_loss': True,\r\n 'pairwise_predict': False,\r\n 'partaffinityfield_predict': False,\r\n 'regularize': False,\r\n 'scoremap_dir': 'test',\r\n 'shuffle': True,\r\n 'snapshot_prefix': 'E:\\\\Deeplab\\\\redfish_flowtank-Brendan-2022-02-01\\\\dlc-models\\\\iteration-0\\\\redfish_flowtankFeb1-trainset95shuffle1\\\\test\\\\snapshot',\r\n 'stride': 8.0,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001}\r\nRunning  DLC_resnet50_redfish_flowtankFeb1shuffle1_400000  with # of training iterations: 400000\r\nC:\\Users\\brendan.gibbs\\Anaconda3\\envs\\DEEPLABCUT3\\lib\\site-packages\\tensorflow\\python\\keras\\engine\\base_layer_v1.py:1694: UserWarning: `layer.apply` is deprecated and will be removed in a future version. Please use `layer.__call__` method instead.\r\n  warnings.warn('`layer.apply` is deprecated and '\r\n2022-02-02 10:24:28.003170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5527 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2080 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5\r\nRunning evaluation ...\r\n73it [00:07,  9.33it/s]\r\nAnalysis is done and the results are stored (see evaluation-results) for snapshot:  snapshot-400000\r\nResults for 400000  training iterations: 95 1 train error: 1.99 pixels. Test error: 18.76  pixels.\r\nWith pcutoff of 0.6  train error: 1.99 pixels. Test error: 18.76 pixels\r\nThereby, the errors are given by the average distances between the labels by DLC and the scorer.\r\nPlotting...\r\n---------------------------------------------------------------------------\r\nwxAssertionError                          Traceback (most recent call last)\r\n<ipython-input-17-37b316589add> in <module>\r\n----> 1 deeplabcut.evaluate_network('E:\\\\Deeplab\\\\redfish_flowtank-Brendan-2022-02-01\\\\config.yaml', plotting=True)\r\n\r\n~\\Anaconda3\\envs\\DEEPLABCUT3\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\core\\evaluate.py in evaluate_network(config, Shuffles, trainingsetindex, plotting, show_errors, comparisonbodyparts, gputouse, rescale, modelprefix)\r\n    910                             )\r\n    911                             auxiliaryfunctions.attempttomakefolder(foldername)\r\n--> 912                             Plotting(\r\n    913                                 cfg,\r\n    914                                 comparisonbodyparts,\r\n\r\n~\\Anaconda3\\envs\\DEEPLABCUT3\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\core\\evaluate.py in Plotting(cfg, comparisonbodyparts, DLCscorer, trainIndices, DataCombined, foldername)\r\n    197     colors = visualization.get_cmap(len(comparisonbodyparts), name=cfg[\"colormap\"])\r\n    198     NumFrames = np.size(DataCombined.index)\r\n--> 199     fig, ax = visualization.create_minimal_figure()\r\n    200     for ind in tqdm(np.arange(NumFrames)):\r\n    201         ax = visualization.plot_and_save_labeled_frame(\r\n\r\n~\\Anaconda3\\envs\\DEEPLABCUT3\\lib\\site-packages\\deeplabcut\\utils\\visualization.py in create_minimal_figure(dpi)\r\n    195\r\n    196 def create_minimal_figure(dpi=100):\r\n--> 197     fig, ax = plt.subplots(frameon=False, dpi=dpi)\r\n    198     ax.axis(\"off\")\r\n    199     ax.invert_yaxis()\r\n\r\n~\\Anaconda3\\envs\\DEEPLABCUT3\\lib\\site-packages\\matplotlib\\pyplot.py in subplots(nrows, ncols, sharex, sharey, squeeze, subplot_kw, gridspec_kw, **fig_kw)\r\n   1432\r\n   1433     \"\"\"\r\n-> 1434     fig = figure(**fig_kw)\r\n   1435     axs = fig.subplots(nrows=nrows, ncols=ncols, sharex=sharex, sharey=sharey,\r\n   1436                        squeeze=squeeze, subplot_kw=subplot_kw,\r\n\r\n~\\Anaconda3\\envs\\DEEPLABCUT3\\lib\\site-packages\\matplotlib\\pyplot.py in figure(num, figsize, dpi, facecolor, edgecolor, frameon, FigureClass, clear, **kwargs)\r\n    785                 RuntimeWarning)\r\n    786\r\n--> 787         manager = new_figure_manager(\r\n    788             num, figsize=figsize, dpi=dpi,\r\n    789             facecolor=facecolor, edgecolor=edgecolor, frameon=frameon,\r\n\r\n~\\Anaconda3\\envs\\DEEPLABCUT3\\lib\\site-packages\\matplotlib\\pyplot.py in new_figure_manager(*args, **kwargs)\r\n    304     \"\"\"Create a new figure manager instance.\"\"\"\r\n    305     _warn_if_gui_out_of_main_thread()\r\n--> 306     return _backend_mod.new_figure_manager(*args, **kwargs)\r\n    307\r\n    308\r\n\r\n~\\Anaconda3\\envs\\DEEPLABCUT3\\lib\\site-packages\\matplotlib\\backends\\backend_wx.py in new_figure_manager(cls, num, *args, **kwargs)\r\n   1404             # garbage collected.\r\n   1405             _BackendWx._theWxApp = wxapp\r\n-> 1406         return super().new_figure_manager(num, *args, **kwargs)\r\n   1407\r\n   1408     @classmethod\r\n\r\n~\\Anaconda3\\envs\\DEEPLABCUT3\\lib\\site-packages\\matplotlib\\backend_bases.py in new_figure_manager(cls, num, *args, **kwargs)\r\n   3492         fig_cls = kwargs.pop('FigureClass', Figure)\r\n   3493         fig = fig_cls(*args, **kwargs)\r\n-> 3494         return cls.new_figure_manager_given_figure(num, fig)\r\n   3495\r\n   3496     @classmethod\r\n\r\n~\\Anaconda3\\envs\\DEEPLABCUT3\\lib\\site-packages\\matplotlib\\backends\\backend_wx.py in new_figure_manager_given_figure(cls, num, figure)\r\n   1408     @classmethod\r\n   1409     def new_figure_manager_given_figure(cls, num, figure):\r\n-> 1410         frame = cls._frame_class(num, figure)\r\n   1411         figmgr = frame.get_figure_manager()\r\n   1412         if mpl.is_interactive():\r\n\r\n~\\Anaconda3\\envs\\DEEPLABCUT3\\lib\\site-packages\\matplotlib\\backends\\backend_wx.py in __init__(self, num, fig)\r\n    908         w, h = map(math.ceil, fig.bbox.size)\r\n    909         self.canvas.SetInitialSize(wx.Size(w, h))\r\n--> 910         self.canvas.SetFocus()\r\n    911         self.sizer = wx.BoxSizer(wx.VERTICAL)\r\n    912         self.sizer.Add(self.canvas, 1, wx.TOP | wx.LEFT | wx.EXPAND)\r\n\r\nwxAssertionError: C++ assertion \"hWnd\" failed at ..\\..\\src\\msw\\window.cpp(562) in wxWindow::SetFocus(): can't set focus to invalid window\n```\n\n\n### Anything else?\n\n_No response_\n\n### Code of Conduct\n\n- [X] I agree to follow this project's [Code of Conduct](https://github.com/DeepLabCut/DeepLabCut/blob/master/CODE_OF_CONDUCT.md)","closed_by":{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1663/timeline","performed_via_github_app":null,"state_reason":"completed"}