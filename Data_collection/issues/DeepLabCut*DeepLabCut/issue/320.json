{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/320","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/320/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/320/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/320/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/320","id":454315991,"node_id":"MDU6SXNzdWU0NTQzMTU5OTE=","number":320,"title":"HDF5 files not being saved by tf.train.Saver in example notebooks","user":{"login":"zbarry","id":4762711,"node_id":"MDQ6VXNlcjQ3NjI3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/4762711?v=4","gravatar_id":"","url":"https://api.github.com/users/zbarry","html_url":"https://github.com/zbarry","followers_url":"https://api.github.com/users/zbarry/followers","following_url":"https://api.github.com/users/zbarry/following{/other_user}","gists_url":"https://api.github.com/users/zbarry/gists{/gist_id}","starred_url":"https://api.github.com/users/zbarry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zbarry/subscriptions","organizations_url":"https://api.github.com/users/zbarry/orgs","repos_url":"https://api.github.com/users/zbarry/repos","events_url":"https://api.github.com/users/zbarry/events{/privacy}","received_events_url":"https://api.github.com/users/zbarry/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-06-10T18:51:05Z","updated_at":"2019-06-10T20:35:52Z","closed_at":"2019-06-10T20:34:32Z","author_association":"NONE","active_lock_reason":null,"body":"**Your Operating system and DeepLabCut version**\r\n\r\nCentOS 7 \r\nDLC ver: 2.0.6.3 | commit hash ef8d67fabbf1c06da7734bdb33a75a9c5c797df5\r\nAnaconda environment\r\n\r\nPackage list:\r\n\r\n```\r\n# Name                    Version                   Build  Channel\r\n_tflow_select             2.1.0                       gpu  \r\nabsl-py                   0.7.1                    py36_0  \r\nasn1crypto                0.24.0                   py36_0  \r\nastor                     0.7.1                    py36_0  \r\nastroid                   2.2.5                    py36_0  \r\nattrs                     19.1.0                   py36_1  \r\nbackcall                  0.1.0                    py36_0  \r\nblas                      1.0                         mkl  \r\nbleach                    3.1.0                    py36_0  \r\nblosc                     1.16.3               hd408876_0  \r\nbokeh                     1.2.0                    py36_0  \r\nbzip2                     1.0.6                h14c3975_5  \r\nc-ares                    1.15.0               h7b6447c_1  \r\nca-certificates           2019.3.9             hecc5488_0    conda-forge\r\ncairo                     1.14.12              h8948797_3  \r\ncertifi                   2019.3.9                 py36_0    conda-forge\r\ncffi                      1.12.3           py36h2e261b9_0  \r\nchardet                   3.0.4                    py36_1  \r\nclick                     7.0                      py36_0  \r\ncloudpickle               1.1.1                      py_0  \r\ncryptography              2.7              py36h72c5cf5_0    conda-forge\r\ncudatoolkit               10.0.130                      0  \r\ncudnn                     7.6.0                cuda10.0_0  \r\ncupti                     10.0.130                      0  \r\ncycler                    0.10.0                   py36_0  \r\ncytoolz                   0.9.0.1          py36h14c3975_1  \r\ndask-core                 1.2.2                      py_0  \r\ndbus                      1.13.6               h746ee38_0  \r\ndecorator                 4.4.0                    py36_1  \r\ndeeplabcut                2.0.6.3                   dev_0    <develop>\r\ndefusedxml                0.6.0                      py_0  \r\neasydict                  1.9                        py_0    conda-forge\r\nentrypoints               0.3                      py36_0  \r\nexpat                     2.2.6                he6710b0_0  \r\nffmpeg                    4.0                  hcdf2ecd_0  \r\nfontconfig                2.13.0               h9420a91_0  \r\nfreeglut                  3.0.0                hf484d3e_5  \r\nfreetype                  2.9.1                h8a8886c_1  \r\nfribidi                   1.0.5                h7b6447c_0  \r\ngast                      0.2.2                    py36_0  \r\ngettext                   0.19.8.1             hd7bead4_3  \r\nglib                      2.56.2               hd408876_0  \r\ngmp                       6.1.2                h6c8ec71_1  \r\ngraphite2                 1.3.13               h23475e2_0  \r\ngrpcio                    1.16.1           py36hf8bcb03_1  \r\ngst-plugins-base          1.14.0               hbbd80ab_1  \r\ngstreamer                 1.14.0               hb453b48_1  \r\nh5py                      2.7.1            py36ha1f6525_2  \r\nharfbuzz                  1.8.8                hffaf4a1_0  \r\nhdf5                      1.10.2               hba1933b_1  \r\nholoviews                 1.12.3                     py_0    pyviz/label/dev\r\nhvplot                    0.4.0                      py_0    pyviz/label/dev\r\nicu                       58.2                 h9c2bf20_1  \r\nidna                      2.8                      py36_0  \r\nimageio                   2.3.0                    py36_0  \r\nintel-openmp              2019.4                      243  \r\nipykernel                 5.1.1            py36h39e3cac_0  \r\nipython                   7.5.0            py36h39e3cac_0  \r\nipython_genutils          0.2.0                    py36_0  \r\nisort                     4.3.20                   py36_0  \r\njasper                    2.0.14               h07fcdf6_1  \r\njedi                      0.13.3                   py36_0  \r\njinja2                    2.10.1                   py36_0  \r\njoblib                    0.13.2                   py36_0  \r\njpeg                      9b                   h024ee3a_2  \r\njsonschema                3.0.1                    py36_0  \r\njupyter_client            5.2.4                    py36_0  \r\njupyter_core              4.4.0                    py36_0  \r\nkeras-applications        1.0.8                      py_0  \r\nkeras-preprocessing       1.1.0                      py_1  \r\nkiwisolver                1.1.0            py36he6710b0_0  \r\nlazy-object-proxy         1.4.1            py36h7b6447c_0  \r\nlibedit                   3.1.20181209         hc058e9b_0  \r\nlibffi                    3.2.1                hd88cf55_4  \r\nlibgcc-ng                 8.2.0                hdf63c60_1  \r\nlibgfortran-ng            7.3.0                hdf63c60_0  \r\nlibglu                    9.0.0                hf484d3e_1  \r\nlibopencv                 3.4.2                hb342d67_1  \r\nlibopus                   1.3                  h7b6447c_0  \r\nlibpng                    1.6.37               hbc83047_0  \r\nlibprotobuf               3.8.0                hd408876_0  \r\nlibsodium                 1.0.16               h1bed415_0  \r\nlibstdcxx-ng              8.2.0                hdf63c60_1  \r\nlibtiff                   4.0.10               h2733197_2  \r\nlibuuid                   1.0.3                h1bed415_2  \r\nlibvpx                    1.7.0                h439df22_0  \r\nlibxcb                    1.13                 h1bed415_1  \r\nlibxml2                   2.9.9                he19cac6_0  \r\nlz4-c                     1.8.1.2              h14c3975_0  \r\nlzo                       2.10                 h49e0be7_2  \r\nmarkdown                  3.1.1                    py36_0  \r\nmarkupsafe                1.1.1            py36h7b6447c_0  \r\nmatplotlib                3.1.0            py36h5429711_0  \r\nmccabe                    0.6.1                    py36_1  \r\nmistune                   0.8.4            py36h7b6447c_0  \r\nmkl                       2019.4                      243  \r\nmkl-service               2.0.2            py36h7b6447c_0  \r\nmkl_fft                   1.0.12           py36ha843d7b_0  \r\nmkl_random                1.0.2            py36hd81dba3_0  \r\nmock                      3.0.5                    py36_0  \r\nmoviepy                   0.2.3.5                    py_0    conda-forge\r\nmypy                      0.701                      py_1  \r\nmypy_extensions           0.4.1                    py36_0  \r\nnbconvert                 5.5.0                      py_0  \r\nnbformat                  4.4.0                    py36_0  \r\nncurses                   6.1                  he6710b0_1  \r\nnetworkx                  2.3                        py_0  \r\nnotebook                  5.7.8                    py36_0  \r\nnumexpr                   2.6.9            py36h9e4a6bb_0  \r\nnumpy                     1.16.4           py36h7e9f1db_0  \r\nnumpy-base                1.16.4           py36hde5b4d6_0  \r\nolefile                   0.46                     py36_0  \r\nopencv                    3.4.2            py36h6fd60c2_1  \r\nopenssl                   1.1.1b               h14c3975_1    conda-forge\r\npackaging                 19.0                     py36_0  \r\npandas                    0.24.2           py36he6710b0_0  \r\npandoc                    2.2.3.2                       0  \r\npandocfilters             1.4.2                    py36_1  \r\npanel                     0.6.0                      py_0    pyviz/label/dev\r\npango                     1.42.4               h049681c_0  \r\nparam                     1.9.1                      py_0    pyviz/label/dev\r\nparso                     0.4.0                      py_0  \r\npatsy                     0.5.1                    py36_0  \r\npcre                      8.43                 he6710b0_0  \r\npexpect                   4.7.0                    py36_0  \r\npickleshare               0.7.5                    py36_0  \r\npillow                    6.0.0            py36h34e0f95_0  \r\npip                       19.1.1                   py36_0  \r\npixman                    0.38.0               h7b6447c_0  \r\nprometheus_client         0.6.0                    py36_0  \r\nprompt_toolkit            2.0.9                    py36_0  \r\nprotobuf                  3.8.0            py36he6710b0_0  \r\npsutil                    5.4.8            py36h7b6447c_0  \r\nptyprocess                0.6.0                    py36_0  \r\npy-opencv                 3.4.2            py36hb342d67_1  \r\npycparser                 2.19                     py36_0  \r\npyct                      0.4.6                      py_0    pyviz/label/dev\r\npyct-core                 0.4.6                      py_0    pyviz/label/dev\r\npygments                  2.4.2                      py_0  \r\npylint                    2.3.1                    py36_0  \r\npyopenssl                 19.0.0                   py36_0  \r\npyparsing                 2.4.0                      py_0  \r\npyqt                      5.9.2            py36h05f1152_2  \r\npyrsistent                0.14.11          py36h7b6447c_0  \r\npysocks                   1.7.0                    py36_0  \r\npytables                  3.4.4            py36h4f72b40_1    conda-forge\r\npython                    3.6.8                h0371630_0  \r\npython-dateutil           2.8.0                    py36_0  \r\npytz                      2019.1                     py_0  \r\npyviz_comms               0.7.2                      py_0    pyviz/label/dev\r\npywavelets                1.0.3            py36hdd07704_1  \r\npyyaml                    5.1              py36h7b6447c_0  \r\npyzmq                     18.0.0           py36he6710b0_0  \r\nqt                        5.9.7                h5867ecd_1  \r\nreadline                  7.0                  h7b6447c_5  \r\nrequests                  2.22.0                   py36_0  \r\nruamel-yaml               0.15.97                  pypi_0    pypi\r\nscikit-image              0.15.0           py36he6710b0_0  \r\nscikit-learn              0.21.2           py36hd81dba3_0  \r\nscipy                     1.2.1            py36h7c811a0_0  \r\nsend2trash                1.5.0                    py36_0  \r\nsetuptools                41.0.1                   py36_0  \r\nsip                       4.19.8           py36hf484d3e_0  \r\nsix                       1.12.0                   py36_0  \r\nsnappy                    1.1.7                hbae5bb6_3  \r\nsqlite                    3.28.0               h7b6447c_0  \r\nstatsmodels               0.9.0            py36h035aef0_0  \r\ntensorboard               1.13.1           py36hf484d3e_0  \r\ntensorflow                1.13.1          gpu_py36h3991807_0  \r\ntensorflow-base           1.13.1          gpu_py36h8d69cac_0  \r\ntensorflow-estimator      1.13.0                     py_0  \r\ntensorflow-gpu            1.13.1               h0d30ee6_0  \r\ntermcolor                 1.1.0                    py36_1  \r\nterminado                 0.8.2                    py36_0  \r\ntestpath                  0.4.2                    py36_0  \r\ntk                        8.6.8                hbc83047_0  \r\ntoolz                     0.9.0                    py36_0  \r\ntornado                   6.0.2            py36h7b6447c_0  \r\ntqdm                      4.32.1                     py_0  \r\ntraitlets                 4.3.2                    py36_0  \r\ntyped-ast                 1.3.4            py36h7b6447c_0  \r\nurllib3                   1.24.2                   py36_0  \r\nwcwidth                   0.1.7                    py36_0  \r\nwebencodings              0.5.1                    py36_1  \r\nwerkzeug                  0.15.4                     py_0  \r\nwheel                     0.33.4                   py36_0  \r\nwrapt                     1.11.1           py36h7b6447c_0  \r\nwxpython                  4.0.4            py36hc99224d_0  \r\nxz                        5.2.4                h14c3975_4  \r\nyaml                      0.1.7                had09818_2  \r\nzeromq                    4.3.1                he6710b0_3  \r\nzlib                      1.2.11               h7b6447c_3  \r\nzstd                      1.3.7                h0b5b093_0  \r\n```\r\n\r\n**Describe the bug**\r\n\r\nUpon trying both the `Demo_labeledexample_Openfield.ipynb` and `Demo_labeledexample_MouseReaching.ipynb` notebooks, training appears to proceed correctly, but no hdf5 file is saved to disk. This results in the following error when running `evaluate_network` in the next cell:\r\n\r\n```\r\nFileNotFoundError                         Traceback (most recent call last)\r\n/data/external_repos/DeepLabCut/deeplabcut/pose_estimation_tensorflow/evaluate.py in evaluate_network(config, Shuffles, plotting, show_errors, comparisonbodyparts, gputouse)\r\n    152                 try:\r\n--> 153                     DataMachine = pd.read_hdf(resultsfilename,'df_with_missing')\r\n    154                     print(\"This net has already been evaluated!\")\r\n\r\n/scratch/miniconda3/envs/deeplabcut/lib/python3.6/site-packages/pandas/io/pytables.py in read_hdf(path_or_buf, key, mode, **kwargs)\r\n    365             raise compat.FileNotFoundError(\r\n--> 366                 'File {path} does not exist'.format(path=path_or_buf))\r\n    367 \r\n\r\nFileNotFoundError: File /data/external_repos/DeepLabCut/examples/openfield-Pranav-2018-10-30/evaluation-results/iteration-0/openfieldOct30-trainset95shuffle1/DeepCut_resnet50_openfieldOct30shuffle1_80-snapshot-80.h5 does not exist\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-19-81e3acf2ea63> in <module>\r\n----> 1 deeplabcut.evaluate_network(path_config_file,plotting=False)\r\n\r\n/data/external_repos/DeepLabCut/deeplabcut/pose_estimation_tensorflow/evaluate.py in evaluate_network(config, Shuffles, plotting, show_errors, comparisonbodyparts, gputouse)\r\n    161                     print(\"Analyzing data...\")\r\n    162                     for imageindex, imagename in tqdm(enumerate(Data.index)):\r\n--> 163                         image = io.imread(os.path.join(cfg['project_path'],imagename),mode='RGB')\r\n    164                         image = skimage.color.gray2rgb(image)\r\n    165                         image_batch = data_to_input(image)\r\n\r\n/scratch/miniconda3/envs/deeplabcut/lib/python3.6/site-packages/skimage/io/_io.py in imread(fname, as_gray, plugin, flatten, **plugin_args)\r\n     59 \r\n     60     with file_or_url_context(fname) as fname:\r\n---> 61         img = call_plugin('imread', fname, plugin=plugin, **plugin_args)\r\n     62 \r\n     63     if not hasattr(img, 'ndim'):\r\n\r\n/scratch/miniconda3/envs/deeplabcut/lib/python3.6/site-packages/skimage/io/manage_plugins.py in call_plugin(kind, *args, **kwargs)\r\n    208                                (plugin, kind))\r\n    209 \r\n--> 210     return func(*args, **kwargs)\r\n    211 \r\n    212 \r\n\r\n/scratch/miniconda3/envs/deeplabcut/lib/python3.6/site-packages/imageio/core/functions.py in imread(uri, format, **kwargs)\r\n    200 \r\n    201     if 'mode' in kwargs:\r\n--> 202         raise TypeError('Invalid keyword argument \"mode\", '\r\n    203                         'perhaps you mean \"pilmode\"?')\r\n    204 \r\n\r\nTypeError: Invalid keyword argument \"mode\", perhaps you mean \"pilmode\"?\r\n```\r\n\r\nThe files we do see exported are in the `DeepLabCut/examples/openfield-Pranav-2018-10-30/dlc-models/iteration-0/openfieldOct30-trainset95shuffle1/train` directory:\r\n\r\n![image](https://user-images.githubusercontent.com/4762711/59218513-6d7c7280-8b8e-11e9-8910-baa8f061439b.png)\r\n\r\nThe `DeepLabCut/examples/openfield-Pranav-2018-10-30/evaluation-results/iteration-0/openfieldOct30-trainset95shuffle1` folder is completely empty.\r\n\r\n**To Reproduce**\r\n\r\nThe step to reproduce in our case is simply to execute either of the example notebooks. Note that because we are on a Linux distribution, there was no supplied environment file, so we had to install the packages manually via `conda`. If someone has a working conda environment on a Linux install, we would be happy to try it out.","closed_by":{"login":"zbarry","id":4762711,"node_id":"MDQ6VXNlcjQ3NjI3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/4762711?v=4","gravatar_id":"","url":"https://api.github.com/users/zbarry","html_url":"https://github.com/zbarry","followers_url":"https://api.github.com/users/zbarry/followers","following_url":"https://api.github.com/users/zbarry/following{/other_user}","gists_url":"https://api.github.com/users/zbarry/gists{/gist_id}","starred_url":"https://api.github.com/users/zbarry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zbarry/subscriptions","organizations_url":"https://api.github.com/users/zbarry/orgs","repos_url":"https://api.github.com/users/zbarry/repos","events_url":"https://api.github.com/users/zbarry/events{/privacy}","received_events_url":"https://api.github.com/users/zbarry/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/320/timeline","performed_via_github_app":null,"state_reason":"completed"}