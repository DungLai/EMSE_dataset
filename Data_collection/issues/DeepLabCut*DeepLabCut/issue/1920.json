{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1920","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1920/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1920/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1920/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1920","id":1316907091,"node_id":"I_kwDOB5BM6c5OfmhT","number":1920,"title":"DeepLabCut on Colab not restarting training","user":{"login":"kevinle628","id":93158952,"node_id":"U_kgDOBY1-KA","avatar_url":"https://avatars.githubusercontent.com/u/93158952?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinle628","html_url":"https://github.com/kevinle628","followers_url":"https://api.github.com/users/kevinle628/followers","following_url":"https://api.github.com/users/kevinle628/following{/other_user}","gists_url":"https://api.github.com/users/kevinle628/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinle628/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinle628/subscriptions","organizations_url":"https://api.github.com/users/kevinle628/orgs","repos_url":"https://api.github.com/users/kevinle628/repos","events_url":"https://api.github.com/users/kevinle628/events{/privacy}","received_events_url":"https://api.github.com/users/kevinle628/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false},"assignees":[{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2022-07-25T14:16:00Z","updated_at":"2022-07-29T16:01:20Z","closed_at":"2022-07-29T16:01:20Z","author_association":"NONE","active_lock_reason":null,"body":"### Is there an existing issue for this?\n\n- [X] I have searched the existing issues\n\n### Bug description\n\nGoogle Colab kicked me off while training due to using up the resources available, I reconnected and attempted to restart the training by changing the init_weight in the pose file but for some reason it says that the save_path is not valid\n\n### Operating System\n\nGoogle Colab\n\n### DeepLabCut version\n\ndlc version 2.2.1.1\n\n### DeepLabCut mode\n\nsingle animal\n\n### Device type\n\ngpu\n\n### Steps To Reproduce\n\n_No response_\n\n### Relevant log output\n\n```shell\nConfig:\r\n{'all_joints': [[0], [1], [2], [3], [4], [5], [6], [7], [8]],\r\n 'all_joints_names': ['First Digit Distal Joint',\r\n                      'Second Digit Distal Joint',\r\n                      'Third Digit Distal Joint',\r\n                      'Fourth Digit Distal Joint',\r\n                      'First Digit Proximal Joint',\r\n                      'Second Digit Proximal Joint',\r\n                      'Third Digit Proximal Joint',\r\n                      'Fourth Digit Proximal Joint',\r\n                      'Paw'],\r\n 'alpha_r': 0.02,\r\n 'apply_prob': 0.5,\r\n 'batch_size': 1,\r\n 'clahe': True,\r\n 'claheratio': 0.1,\r\n 'crop_pad': 0,\r\n 'cropratio': 0.4,\r\n 'dataset': 'training-datasets/iteration-0/UnaugmentedDataSet_Angled '\r\n            'ProjectJun21/Angled Project_Kevin95shuffle1.mat',\r\n 'dataset_type': 'imgaug',\r\n 'decay_steps': 30000,\r\n 'deterministic': False,\r\n 'display_iters': 1000,\r\n 'edge': False,\r\n 'emboss': {'alpha': [0.0, 1.0], 'embossratio': 0.1, 'strength': [0.5, 1.5]},\r\n 'fg_fraction': 0.25,\r\n 'global_scale': 0.8,\r\n 'histeq': True,\r\n 'histeqratio': 0.1,\r\n 'init_weights': 'dlc-models/iteration-0/Angled '\r\n                 'ProjectJun21-trainset95shuffle1/train/snapshot-3000',\r\n 'intermediate_supervision': False,\r\n 'intermediate_supervision_layer': 12,\r\n 'location_refinement': True,\r\n 'locref_huber_loss': True,\r\n 'locref_loss_weight': 0.05,\r\n 'locref_stdev': 7.2801,\r\n 'log_dir': 'log',\r\n 'lr_init': 0.0005,\r\n 'max_input_size': 1500,\r\n 'mean_pixel': [123.68, 116.779, 103.939],\r\n 'metadataset': 'training-datasets/iteration-0/UnaugmentedDataSet_Angled '\r\n                'ProjectJun21/Documentation_data-Angled '\r\n                'Project_95shuffle1.pickle',\r\n 'min_input_size': 64,\r\n 'mirror': False,\r\n 'multi_stage': False,\r\n 'multi_step': [[0.005, 10000],\r\n                [0.02, 430000],\r\n                [0.002, 730000],\r\n                [0.001, 1030000]],\r\n 'net_type': 'resnet_50',\r\n 'num_joints': 9,\r\n 'optimizer': 'sgd',\r\n 'pairwise_huber_loss': False,\r\n 'pairwise_predict': False,\r\n 'partaffinityfield_predict': False,\r\n 'pos_dist_thresh': 17,\r\n 'project_path': '/content/drive/My Drive/Angled_Project-Kevin-2022-06-21',\r\n 'regularize': False,\r\n 'rotation': 25,\r\n 'rotratio': 0.4,\r\n 'save_iters': 50000,\r\n 'scale_jitter_lo': 0.5,\r\n 'scale_jitter_up': 1.25,\r\n 'scoremap_dir': 'test',\r\n 'sharpen': False,\r\n 'sharpenratio': 0.3,\r\n 'shuffle': True,\r\n 'snapshot_prefix': '/content/drive/My '\r\n                    'Drive/Angled_Project-Kevin-2022-06-21/dlc-models/iteration-0/Angled '\r\n                    'ProjectJun21-trainset95shuffle1/train/snapshot',\r\n 'stride': 8.0,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001}\r\nSelecting single-animal trainer\r\nBatch Size is 1\r\n/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer_v1.py:1694: UserWarning: `layer.apply` is deprecated and will be removed in a future version. Please use `layer.__call__` method instead.\r\n  warnings.warn('`layer.apply` is deprecated and '\r\n/usr/local/lib/python3.7/dist-packages/tf_slim/layers/layers.py:684: UserWarning: `layer.apply` is deprecated and will be removed in a future version. Please use `layer.__call__` method instead.\r\n  outputs = layer.apply(inputs, training=is_training)\r\nLoading already trained DLC with backbone: resnet_50\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-9-f5c1f8f7a264> in <module>()\r\n      3 #more info and there are more things you can set: https://github.com/DeepLabCut/DeepLabCut/blob/master/docs/functionDetails.md#g-train-the-network\r\n      4 \r\n----> 5 deeplabcut.train_network(path_config_file, shuffle=SHUF, displayiters=10,saveiters=500)\r\n      6 \r\n      7 #this will run until you stop it (CTRL+C), or hit \"STOP\" icon, or when it hits the end (default, 1.03M iterations).\r\n\r\n3 frames\r\n/usr/local/lib/python3.7/dist-packages/deeplabcut/pose_estimation_tensorflow/training.py in train_network(config, shuffle, trainingsetindex, max_snapshots_to_keep, displayiters, saveiters, maxiters, allow_growth, gputouse, autotune, keepdeconvweights, modelprefix)\r\n    216 \r\n    217     except BaseException as e:\r\n--> 218         raise e\r\n    219     finally:\r\n    220         os.chdir(str(start_path))\r\n\r\n/usr/local/lib/python3.7/dist-packages/deeplabcut/pose_estimation_tensorflow/training.py in train_network(config, shuffle, trainingsetindex, max_snapshots_to_keep, displayiters, saveiters, maxiters, allow_growth, gputouse, autotune, keepdeconvweights, modelprefix)\r\n    212                 max_to_keep=max_snapshots_to_keep,\r\n    213                 keepdeconvweights=keepdeconvweights,\r\n--> 214                 allow_growth=allow_growth,\r\n    215             )  # pass on path and file name for pose_cfg.yaml!\r\n    216 \r\n\r\n/usr/local/lib/python3.7/dist-packages/deeplabcut/pose_estimation_tensorflow/core/train.py in train(config_yaml, displayiters, saveiters, maxiters, max_to_keep, keepdeconvweights, allow_growth)\r\n    231 \r\n    232     # Restore variables from disk.\r\n--> 233     restorer.restore(sess, cfg[\"init_weights\"])\r\n    234     if maxiters is None:\r\n    235         max_iter = int(cfg[\"multi_step\"][-1][1])\r\n\r\n/usr/local/lib/python3.7/dist-packages/tensorflow/python/training/saver.py in restore(self, sess, save_path)\r\n   1391     if not checkpoint_management.checkpoint_exists_internal(checkpoint_prefix):\r\n   1392       raise ValueError(\"The passed save_path is not a valid checkpoint: \" +\r\n-> 1393                        checkpoint_prefix)\r\n   1394 \r\n   1395     logging.info(\"Restoring parameters from %s\", checkpoint_prefix)\r\n\r\nValueError: The passed save_path is not a valid checkpoint: dlc-models/iteration-0/Angled ProjectJun21-trainset95shuffle1/train/snapshot-3000\n```\n\n\n### Anything else?\n\n_No response_\n\n### Code of Conduct\n\n- [X] I agree to follow this project's [Code of Conduct](https://github.com/DeepLabCut/DeepLabCut/blob/master/CODE_OF_CONDUCT.md)","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1920/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1920/timeline","performed_via_github_app":null,"state_reason":"completed"}