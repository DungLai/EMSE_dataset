{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/536","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/536/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/536/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/536/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/536","id":544178963,"node_id":"MDU6SXNzdWU1NDQxNzg5NjM=","number":536,"title":"GPU use in training goes to 0% after a few thousand iterations.","user":{"login":"Gaelic98","id":33144206,"node_id":"MDQ6VXNlcjMzMTQ0MjA2","avatar_url":"https://avatars.githubusercontent.com/u/33144206?v=4","gravatar_id":"","url":"https://api.github.com/users/Gaelic98","html_url":"https://github.com/Gaelic98","followers_url":"https://api.github.com/users/Gaelic98/followers","following_url":"https://api.github.com/users/Gaelic98/following{/other_user}","gists_url":"https://api.github.com/users/Gaelic98/gists{/gist_id}","starred_url":"https://api.github.com/users/Gaelic98/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gaelic98/subscriptions","organizations_url":"https://api.github.com/users/Gaelic98/orgs","repos_url":"https://api.github.com/users/Gaelic98/repos","events_url":"https://api.github.com/users/Gaelic98/events{/privacy}","received_events_url":"https://api.github.com/users/Gaelic98/received_events","type":"User","site_admin":false},"labels":[{"id":1816193536,"node_id":"MDU6TGFiZWwxODE2MTkzNTM2","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/tensorflow/training","name":"tensorflow/training","color":"0052cc","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false},"assignees":[{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false}],"milestone":null,"comments":11,"created_at":"2019-12-31T12:33:17Z","updated_at":"2020-03-12T10:10:30Z","closed_at":"2020-02-15T19:29:00Z","author_association":"NONE","active_lock_reason":null,"body":"Windows 10 OS with Anaconda environment (called dlc) and DeepLabCut version = 2.1.4\r\n\r\nCode run using a Jupyter Notebook ans a Nvidia GeForce GTX 1070 GPU\r\n\r\n**GPU Env Info**\r\n```\r\ntensorboard               1.12.0           \r\ntensorflow                1.12.0          \r\ntensorflow-base           1.12.0          \r\ntensorflow-gpu            1.12.0\r\n\r\n# Name                    Version                   Build\r\ncudatoolkit               9.0                           1\r\ncudnn                     7.3.1                 cuda9.0_0\r\n\r\n```\r\n**Problem**\r\n\r\nOccasionally when I run the ``` deeplabcut.train_network(path_config_file, allow_growth=True)``` command, I see some training on GPU for ~15000 iterations and then the GPU usage falls to 0% while the GPU memory is still in use. \r\n\r\n\r\n![Screenshot (2)](https://user-images.githubusercontent.com/33144206/71621794-530cf380-2bc9-11ea-9575-04eb9798a844.png)\r\n\r\n\r\n![Screenshot (3)](https://user-images.githubusercontent.com/33144206/71621796-5607e400-2bc9-11ea-8d91-758119226f24.png)\r\n\r\n\r\n\r\nOther times it only runs for a few thousand iterations before stopping.\r\n\r\nThis occurs regardless of the video upon which I am running the code. \r\n\r\nI do not believe it to be a CUDA/TF error  (but I have included the verisons of the cudatoolkit and cudnn used within the environment above.\r\n\r\nMy only other concern was a memory issue  which was why I decreased the global scale (to 0.3 for a 1080 by 1920 video) but I found that this did not resolve the problem so I can only assume it is as a result of the number of joints I am using - 43. \r\n\r\n**Edit**\r\n\r\nAfter a little consideration I wanted to check if there was en error when I updated deeplabcut.\r\n\r\nThus I created a fresh install of dlc-windowsGPU.\r\n\r\nWithout manually changing anything my tensorflow/cuda dependecies became:\r\n\r\n```\r\n# Name                    Version                   Build  \r\ntensorboard               1.13.1                   py36_0    \r\ntensorflow                1.13.1               h21ff451_8    \r\ntensorflow-base           1.13.1                   py36_8    \r\ntensorflow-estimator      1.13.0           py36h39e3cac_0    \r\ntensorflow-gpu            1.13.1               h0d30ee6_0\r\n\r\ncudatoolkit               10.0.130                      0\r\ncudnn                     7.6.5                cuda10.0_0\r\n```\r\n\r\nThe problem is  the code still experiences the same issue as before. \r\n```\r\nall_joints:\r\n- - 0\r\n- - 1\r\n- - 2\r\n- - 3\r\n- - 4\r\n- - 5\r\n- - 6\r\n- - 7\r\n- - 8\r\n- - 9\r\n- - 10\r\n- - 11\r\n- - 12\r\n- - 13\r\n- - 14\r\n- - 15\r\n- - 16\r\n- - 17\r\n- - 18\r\n- - 19\r\n- - 20\r\n- - 21\r\n- - 22\r\n- - 23\r\n- - 24\r\n- - 25\r\n- - 26\r\n- - 27\r\n- - 28\r\n- - 29\r\n- - 30\r\n- - 31\r\n- - 32\r\n- - 33\r\n- - 34\r\n- - 35\r\n- - 36\r\n- - 37\r\n- - 38\r\n- - 39\r\n- - 40\r\n- - 41\r\n- - 42\r\nall_joints_names:\r\n- Nose\r\n- Head\r\n- RightEar\r\n- RightEarEnd\r\n- LeftEar\r\n- LeftEarEnd\r\n- Neck04\r\n- Neck03\r\n- Neck02\r\n- Neck01\r\n- Spine02\r\n- Spine01\r\n- Root\r\n- RightShoulder\r\n- RightArm\r\n- RightForeArm\r\n- RightWrist\r\n- RightHand\r\n- RightFinger\r\n- LeftShoulder\r\n- LeftArm\r\n- LeftForeArm\r\n- LeftWrist\r\n- LeftHand\r\n- LeftFinger\r\n- RightLeg\r\n- RightLowerLeg\r\n- RightAnkle\r\n- RightFoot\r\n- RightToe\r\n- LeftLeg\r\n- LeftLowerLeg\r\n- LeftAnkle\r\n- LeftFoot\r\n- LeftToe\r\n- TailBase\r\n- Tail1\r\n- Tail2\r\n- Tail3\r\n- Tail4\r\n- Tail5\r\n- Tail6\r\n- TailEnd\r\nbatch_size: 1\r\nbottomheight: 400\r\ncrop: False\r\ncropratio: 0.3\r\ndataset: training-datasets\\iteration-5\\UnaugmentedDataSet_Dogs_Data_Generation_36Jul16\\Dogs_Data_Generation_36_J95shuffle1.mat\r\ndataset_type: default\r\ndisplay_iters: 1000\r\nglobal_scale: 0.3\r\ninit_weights: F:\\DeepLabTrial\\DeepLabCut_trial_dogs\\Dogs_Data_Generation_36-J-2019-07-16\\dlc-models\\iteration-5\\Dogs_Data_Generation_36Jul16-trainset95shuffle1\\train\\snapshot-14000\r\nintermediate_supervision: false\r\nintermediate_supervision_layer: 12\r\nleftwidth: 400\r\nlocation_refinement: true\r\nlocref_huber_loss: true\r\nlocref_loss_weight: 0.05\r\nlocref_stdev: 7.2801\r\nmax_input_size: 1500\r\nmetadataset: training-datasets\\iteration-5\\UnaugmentedDataSet_Dogs_Data_Generation_36Jul16\\Documentation_data-Dogs_Data_Generation_36_95shuffle1.pickle\r\nmin_input_size: 64\r\nminsize: 100\r\nmirror: false\r\nmulti_step:\r\n- - 0.05\r\n  - 10000\r\n- - 0.02\r\n  - 430000\r\n- - 0.002\r\n  - 730000\r\n- - 0.001\r\n  - 1030000\r\nnet_type: resnet_50\r\nnum_joints: 43\r\npos_dist_thresh: 17\r\nproject_path: F:\\DeepLabTrial\\DeepLabCut_trial_dogs\\Dogs_Data_Generation_36-J-2019-07-16\r\nrightwidth: 400\r\nsave_iters: 1000\r\nscale_jitter_lo: 0.5\r\nscale_jitter_up: 1\r\ntopheight: 400\r\n\r\n```\r\n\r\nMany thanks.","closed_by":{"login":"AlexEMG","id":20850270,"node_id":"MDQ6VXNlcjIwODUwMjcw","avatar_url":"https://avatars.githubusercontent.com/u/20850270?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexEMG","html_url":"https://github.com/AlexEMG","followers_url":"https://api.github.com/users/AlexEMG/followers","following_url":"https://api.github.com/users/AlexEMG/following{/other_user}","gists_url":"https://api.github.com/users/AlexEMG/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexEMG/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexEMG/subscriptions","organizations_url":"https://api.github.com/users/AlexEMG/orgs","repos_url":"https://api.github.com/users/AlexEMG/repos","events_url":"https://api.github.com/users/AlexEMG/events{/privacy}","received_events_url":"https://api.github.com/users/AlexEMG/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/536/timeline","performed_via_github_app":null,"state_reason":"completed"}