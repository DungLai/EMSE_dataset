{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/975","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/975/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/975/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/975/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/975","id":730957182,"node_id":"MDU6SXNzdWU3MzA5NTcxODI=","number":975,"title":"\"rpck/rmse miss/hit nan\" with evaluate_multianimal_crossvalidate()","user":{"login":"rasdani","id":73563550,"node_id":"MDQ6VXNlcjczNTYzNTUw","avatar_url":"https://avatars.githubusercontent.com/u/73563550?v=4","gravatar_id":"","url":"https://api.github.com/users/rasdani","html_url":"https://github.com/rasdani","followers_url":"https://api.github.com/users/rasdani/followers","following_url":"https://api.github.com/users/rasdani/following{/other_user}","gists_url":"https://api.github.com/users/rasdani/gists{/gist_id}","starred_url":"https://api.github.com/users/rasdani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rasdani/subscriptions","organizations_url":"https://api.github.com/users/rasdani/orgs","repos_url":"https://api.github.com/users/rasdani/repos","events_url":"https://api.github.com/users/rasdani/events{/privacy}","received_events_url":"https://api.github.com/users/rasdani/received_events","type":"User","site_admin":false},"labels":[{"id":2379991078,"node_id":"MDU6TGFiZWwyMzc5OTkxMDc4","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/maDLC","name":"maDLC","color":"96001b","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"AlexEMG","id":20850270,"node_id":"MDQ6VXNlcjIwODUwMjcw","avatar_url":"https://avatars.githubusercontent.com/u/20850270?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexEMG","html_url":"https://github.com/AlexEMG","followers_url":"https://api.github.com/users/AlexEMG/followers","following_url":"https://api.github.com/users/AlexEMG/following{/other_user}","gists_url":"https://api.github.com/users/AlexEMG/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexEMG/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexEMG/subscriptions","organizations_url":"https://api.github.com/users/AlexEMG/orgs","repos_url":"https://api.github.com/users/AlexEMG/repos","events_url":"https://api.github.com/users/AlexEMG/events{/privacy}","received_events_url":"https://api.github.com/users/AlexEMG/received_events","type":"User","site_admin":false},"assignees":[{"login":"AlexEMG","id":20850270,"node_id":"MDQ6VXNlcjIwODUwMjcw","avatar_url":"https://avatars.githubusercontent.com/u/20850270?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexEMG","html_url":"https://github.com/AlexEMG","followers_url":"https://api.github.com/users/AlexEMG/followers","following_url":"https://api.github.com/users/AlexEMG/following{/other_user}","gists_url":"https://api.github.com/users/AlexEMG/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexEMG/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexEMG/subscriptions","organizations_url":"https://api.github.com/users/AlexEMG/orgs","repos_url":"https://api.github.com/users/AlexEMG/repos","events_url":"https://api.github.com/users/AlexEMG/events{/privacy}","received_events_url":"https://api.github.com/users/AlexEMG/received_events","type":"User","site_admin":false},{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false}],"milestone":null,"comments":11,"created_at":"2020-10-27T23:56:24Z","updated_at":"2020-12-22T13:09:51Z","closed_at":"2020-12-21T23:34:50Z","author_association":"NONE","active_lock_reason":null,"body":"Hi there, fellow researchers!\r\n\r\n**Tried on Google Colab with COLAB_maDLC_TrainNetwork_VideoAnalysis.ipynb and a Ubuntu 18.04 machine with deeplabcut 2.2b8 and 2.2b5 in a miniconda Env (DLC-GPU, newest from mousemotorlab-webpage)**\r\n\r\n\r\nAfter successful training and model evaluation in the Colab Notebook, I tried the next step critical to multi-animal analysis: cross-validation.\r\nAfter trying every possible option for the 'target' argument, I always get the following output:\r\n\r\n<details><summary>Code output</summary><p>\r\n\r\n```python\r\ndeeplabcut.evaluate_multianimal_crossvalidate(\r\n            path_config_file,\r\n            Shuffles=[shuffle],\r\n            edgewisecondition=True,\r\n            leastbpts=1,\r\n            init_points=20,\r\n            n_iter=50,\r\n            target='rpck_train',\r\n        )\r\n\r\n/content/drive/My Drive/Test-rasdani-2020-10-17/evaluation-results/iteration-0/TestOkt17-trainset95shuffle1  already exists!\r\n/content/drive/My Drive/Test-rasdani-2020-10-17/evaluation-results/iteration-0/TestOkt17-trainset95shuffle1/DLC_resnet50_TestOkt17shuffle1_51000-snapshot-51000.h5\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\n/content/drive/My Drive/Test-rasdani-2020-10-17/evaluation-results/iteration-0/TestOkt17-trainset95shuffle1/DLC_resnet50_TestOkt17shuffle1_51000-snapshot-51000.h5\r\nSaving optimal inference parameters...\r\n   train_iter  train_frac  shuffle  rmse_train  hits_train  misses_train  falsepos_train  ndetects_train  pck_train  rpck_train  rmse_test  hits_test  misses_test  falsepos_test  ndetects_test  pck_test  rpck_test\r\n0     51000.0        95.0      1.0         NaN         NaN           NaN             NaN             NaN        NaN         NaN        NaN        NaN          NaN            NaN            NaN       NaN        NaN\r\n\r\n---------------------------------------------------------------------------\r\n\r\nValueError                                Traceback (most recent call last)\r\n\r\n<ipython-input-7-5f1968ee4948> in <module>()\r\n     25             init_points=20,\r\n     26             n_iter=50,\r\n---> 27             target=\"rpck_train\",\r\n     28         )\r\n\r\n/usr/local/lib/python3.6/dist-packages/deeplabcut/pose_estimation_tensorflow/evaluate_multianimal.py in evaluate_multianimal_crossvalidate(config, Shuffles, trainingsetindex, pbounds, edgewisecondition, target, inferencecfg, init_points, n_iter, log_file, dcorr, leastbpts, printingintermediatevalues, modelprefix, plotting)\r\n    668 \r\n    669         # Store best predictions\r\n--> 670         max_indivs = max(pose.shape[0] for pose in poses)\r\n    671         bpts = dlc_cfg[\"all_joints_names\"]\r\n    672         container = np.full((len(poses), max_indivs * len(bpts) * 3), np.nan)\r\n\r\nValueError: max() arg is an empty sequence\r\n```\r\n\r\n\r\n</p></details>\r\n\r\nAfter porting everything to a remote machine (Ubuntu 18.04), I get a somewhat more verbose output:\r\n\r\n<details><summary>Code output</summary><p>\r\n\r\n```python\r\ndeeplabcut.evaluate_multianimal_crossvalidate(config_path, Shuffles=[1], edgewisecondition=True,\r\n   ...: leastbpts=1, init_points=20, n_iter=50)\r\n\r\n/home/rasdani/dlc-project/Test-rasdani-2020-10-17/evaluation-results/iteration-0/TestOkt17-trainset95shuffle1/DLC_resnet50_TestOkt17shuffle1_51000-snapshot-51000.h5\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\nrpck nan rpck train: nan\r\nrmse nan miss nan hit nan\r\n---------------------------------------------------------------------------\r\nStopIteration                             Traceback (most recent call last)\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/bayes_opt/bayesian_optimization.py in maximize(self, init_points, n_iter, acq, kappa, kappa_decay, kappa_decay_delay, xi, **gp_params)\r\n    178             try:\r\n--> 179                 x_probe = next(self._queue)\r\n    180             except StopIteration:\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/bayes_opt/bayesian_optimization.py in __next__(self)\r\n     24         if self.empty:\r\n---> 25             raise StopIteration(\"Queue is empty, no more objects to retrieve.\")\r\n     26         obj = self._queue[0]\r\n\r\nStopIteration: Queue is empty, no more objects to retrieve.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-13-0db080d156c2> in <module>\r\n----> 1 deeplabcut.evaluate_multianimal_crossvalidate(config_path, Shuffles=[1], edgewisecondition=True, leastbpts=1, init_points=20, n_iter=50, target=\"rmse_test\")\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/evaluate_multianimal.py in evaluate_multianimal_crossvalidate(config, Shuffles, trainingsetindex, pbounds, edgewisecondition, target, inferencecfg, init_points, n_iter, log_file, dcorr, leastbpts, printingintermediatevalues, modelprefix, plotting)\r\n    641             leastbpts=leastbpts,\r\n    642             modelprefix=modelprefix,\r\n--> 643             printingintermediatevalues=printingintermediatevalues,\r\n    644         )\r\n    645\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/lib/crossvalutils.py in bayesian_search(config_path, inferencecfg, pbounds, edgewisecondition, shuffle, trainingsetindex, modelprefix, snapshotindex, target, maximize, init_points, n_iter, acq, log_file, dcorr, leastbpts, printingintermediatevalues)\r\n    463     )\r\n    464     opt.subscribe(Events.OPTIMIZATION_STEP, logger)\r\n--> 465     opt.maximize(init_points=init_points, n_iter=n_iter, acq=acq)\r\n    466\r\n    467     inferencecfg.update(opt.max[\"params\"])\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/bayes_opt/bayesian_optimization.py in maximize(self, init_points, n_iter, acq, kappa, kappa_decay, kappa_decay_delay, xi, **gp_params)\r\n    180             except StopIteration:\r\n    181                 util.update_params()\r\n--> 182                 x_probe = self.suggest(util)\r\n    183                 iteration += 1\r\n    184\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/bayes_opt/bayesian_optimization.py in suggest(self, utility_function)\r\n    126         with warnings.catch_warnings():\r\n    127             warnings.simplefilter(\"ignore\")\r\n--> 128             self._gp.fit(self._space.params, self._space.target)\r\n    129\r\n    130         # Finding argmax of the acquisition function.\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/sklearn/gaussian_process/_gpr.py in fit(self, X, y)\r\n    232             optima = [(self._constrained_optimization(obj_func,\r\n    233                                                       self.kernel_.theta,\r\n--> 234                                                       self.kernel_.bounds))]\r\n    235\r\n    236             # Additional runs are performed from log-uniform chosen initial\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/sklearn/gaussian_process/_gpr.py in _constrained_optimization(self, obj_func, initial_theta, bounds)\r\n    501             opt_res = scipy.optimize.minimize(\r\n    502                 obj_func, initial_theta, method=\"L-BFGS-B\", jac=True,\r\n--> 503                 bounds=bounds)\r\n    504             _check_optimize_result(\"lbfgs\", opt_res)\r\n    505             theta_opt, func_min = opt_res.x, opt_res.fun\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/scipy/optimize/_minimize.py in minimize(fun, x0, args, method, jac, hess, hessp, bounds, constraints, tol, callback, options)\r\n    616     elif meth == 'l-bfgs-b':\r\n    617         return _minimize_lbfgsb(fun, x0, args, jac, bounds,\r\n--> 618                                 callback=callback, **options)\r\n    619     elif meth == 'tnc':\r\n    620         return _minimize_tnc(fun, x0, args, jac, bounds, callback=callback,\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/scipy/optimize/lbfgsb.py in _minimize_lbfgsb(fun, x0, args, jac, bounds, disp, maxcor, ftol, gtol, eps, maxfun, maxiter, iprint, callback, maxls, finite_diff_rel_step, **unknown_options)\r\n    306     sf = _prepare_scalar_function(fun, x0, jac=jac, args=args, epsilon=eps,\r\n    307                                   bounds=new_bounds,\r\n--> 308                                   finite_diff_rel_step=finite_diff_rel_step)\r\n    309\r\n    310     func_and_grad = sf.fun_and_grad\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/scipy/optimize/optimize.py in _prepare_scalar_function(fun, x0, jac, args, bounds, epsilon, finite_diff_rel_step, hess)\r\n    260     # calculation reduces overall function evaluations.\r\n    261     sf = ScalarFunction(fun, x0, args, grad, hess,\r\n--> 262                         finite_diff_rel_step, bounds, epsilon=epsilon)\r\n    263\r\n    264     return sf\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py in __init__(self, fun, x0, args, grad, hess, finite_diff_rel_step, finite_diff_bounds, epsilon)\r\n     74\r\n     75         self._update_fun_impl = update_fun\r\n---> 76         self._update_fun()\r\n     77\r\n     78         # Gradient evaluation\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py in _update_fun(self)\r\n    164     def _update_fun(self):\r\n    165         if not self.f_updated:\r\n--> 166             self._update_fun_impl()\r\n    167             self.f_updated = True\r\n    168\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py in update_fun()\r\n     71\r\n     72         def update_fun():\r\n---> 73             self.f = fun_wrapped(self.x)\r\n     74\r\n     75         self._update_fun_impl = update_fun\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py in fun_wrapped(x)\r\n     68         def fun_wrapped(x):\r\n     69             self.nfev += 1\r\n---> 70             return fun(x, *args)\r\n     71\r\n     72         def update_fun():\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/scipy/optimize/optimize.py in __call__(self, x, *args)\r\n     72     def __call__(self, x, *args):\r\n     73         \"\"\" returns the the function value \"\"\"\r\n---> 74         self._compute_if_needed(x, *args)\r\n     75         return self._value\r\n     76\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/scipy/optimize/optimize.py in _compute_if_needed(self, x, *args)\r\n     66         if not np.all(x == self.x) or self._value is None or self.jac is None:\r\n     67             self.x = np.asarray(x).copy()\r\n---> 68             fg = self.fun(x, *args)\r\n     69             self.jac = fg[1]\r\n     70             self._value = fg[0]\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/sklearn/gaussian_process/_gpr.py in obj_func(theta, eval_gradient)\r\n    223                 if eval_gradient:\r\n    224                     lml, grad = self.log_marginal_likelihood(\r\n--> 225                         theta, eval_gradient=True, clone_kernel=False)\r\n    226                     return -lml, -grad\r\n    227                 else:\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/sklearn/gaussian_process/_gpr.py in log_marginal_likelihood(self, theta, eval_gradient, clone_kernel)\r\n    474             y_train = y_train[:, np.newaxis]\r\n    475\r\n--> 476         alpha = cho_solve((L, True), y_train)  # Line 3\r\n    477\r\n    478         # Compute log-likelihood (compare line 7)\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/scipy/linalg/decomp_cholesky.py in cho_solve(c_and_lower, b, overwrite_b, check_finite)\r\n    192     (c, lower) = c_and_lower\r\n    193     if check_finite:\r\n--> 194         b1 = asarray_chkfinite(b)\r\n    195         c = asarray_chkfinite(c)\r\n    196     else:\r\n\r\n~/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/numpy/lib/function_base.py in asarray_chkfinite(a, dtype, order)\r\n    496     if a.dtype.char in typecodes['AllFloat'] and not np.isfinite(a).all():\r\n    497         raise ValueError(\r\n--> 498             \"array must not contain infs or NaNs\")\r\n    499     return a\r\n    500\r\n\r\nValueError: array must not contain infs or NaNs\r\n```\r\n\r\n</p></details>\r\n\r\nHelp is much appreciated!\r\n","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/975/timeline","performed_via_github_app":null,"state_reason":"completed"}