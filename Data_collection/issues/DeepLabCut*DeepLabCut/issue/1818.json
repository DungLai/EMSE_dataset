{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1818","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1818/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1818/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1818/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1818","id":1223609451,"node_id":"I_kwDOB5BM6c5I7sxr","number":1818,"title":"ZeroDivisionError when analyze videos","user":{"login":"BinZJU","id":70118908,"node_id":"MDQ6VXNlcjcwMTE4OTA4","avatar_url":"https://avatars.githubusercontent.com/u/70118908?v=4","gravatar_id":"","url":"https://api.github.com/users/BinZJU","html_url":"https://github.com/BinZJU","followers_url":"https://api.github.com/users/BinZJU/followers","following_url":"https://api.github.com/users/BinZJU/following{/other_user}","gists_url":"https://api.github.com/users/BinZJU/gists{/gist_id}","starred_url":"https://api.github.com/users/BinZJU/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BinZJU/subscriptions","organizations_url":"https://api.github.com/users/BinZJU/orgs","repos_url":"https://api.github.com/users/BinZJU/repos","events_url":"https://api.github.com/users/BinZJU/events{/privacy}","received_events_url":"https://api.github.com/users/BinZJU/received_events","type":"User","site_admin":false},"labels":[{"id":880550034,"node_id":"MDU6TGFiZWw4ODA1NTAwMzQ=","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false},"assignees":[{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false}],"milestone":null,"comments":8,"created_at":"2022-05-03T03:12:32Z","updated_at":"2022-05-07T08:56:28Z","closed_at":"2022-05-03T09:28:28Z","author_association":"NONE","active_lock_reason":null,"body":"### Is there an existing issue for this?\n\n- [X] I have searched the existing issues\n\n### Bug description\n\nThank you for the powerful tools. I'm using the  DLC 2.2.1[GUI], troubled with the ZeroDivisionError. I have searched the existing issues, finding a similar one [#1638 ] [https://github.com/DeepLabCut/DeepLabCut/issues/1638]. However, it is not exactly the same.\r\nEverything goes fine until the step of **Analyze Videos**.\r\nBriefly, I am tracking 2 black mice in 6 videos, each lasting for 5-10 min. 40 frames per video were extracted to generate the dataset used for annotation (SimBA 7 points). I chose the resnet_50 network to train the model for 200k iterations. The original resolution is 900*1024, batch processed with SimBA. When I use the original resolution, the ZeroDivisionError showed. So I created another project after downsampling the videos to 400*400. Yet, the same error was present again. It said: \" line 332, in calc_assembly_mahalanobis_dist    factor = self._kde.d / len(inds) ZeroDivisionError: division by zero\"\r\n\r\nIf the **Calibrate animal assembly** or **Assemble using animal identity** was unchecked, the video can be successfully analyzed.\r\n\r\nI have updated to the latest DLC version with pip install https://github.com/DeepLabCut/DeepLabCut/archive/master.zip. And make sure that the identity = true in config.yaml before training, num_idchannel: 2 in the pose_cfg.yaml, and topktoretain: 2 in the inference_cfg.yaml. \r\nIt doesn't help.\r\n\r\nI have uploaded the yaml files, if further details are needed, please let me know.\r\n\r\nCould you please help me out? I really appreciate it.\r\n\r\n\r\n[yaml.zip](https://github.com/DeepLabCut/DeepLabCut/files/8608094/yaml.zip)\r\n \n\n### Operating System\n\nWindows 11 x64\n\n### DeepLabCut version\n\n2.2.1 with GUI\n\n### DeepLabCut mode\n\nmulti animal\n\n### Device type\n\ngpu, 3080\n\n### Steps To Reproduce\n\n1. Starting the GUI in Anaconda deeplabcut env\r\n2. Creating the project, extract frames, label, train, evaluate\r\n3. Analyze a single 400*400 video, shuffle = 1, videotype = avi, number of animals =2. Checked the Creat video, Calibrate, Assemble, Save csv, Save nwb, Plots to pop up, and Plot trajectories. Unchecked the Use ffprobe, Filter Predictions.\r\n4. The error was reproduced.\r\n\r\n![Snipaste_2022-05-03_11-11-38](https://user-images.githubusercontent.com/70118908/166400494-53b1d05c-a992-47db-8899-a76eaf8e9b91.jpg)\n\n### Relevant log output\n\n```shell\nProcessing...  F:\\CLAHE\\Downsample\\CLAHE_Trial_11.avi\r\nAnalyzing F:\\CLAHE\\Downsample\\CLAHE_Trial_11DLC_resnet50_Mating_DualMs_7pts_DLCMay2shuffle1_200000.h5\r\n7it [00:00, 3499.84it/s]\r\nTraceback (most recent call last):\r\n  File \"F:\\Anaconda\\envs\\deeplabcut\\lib\\site-packages\\deeplabcut\\gui\\analyze_videos.py\", line 492, in analyze_videos\r\n    scorername = deeplabcut.analyze_videos(\r\n  File \"F:\\Anaconda\\envs\\deeplabcut\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\predict_videos.py\", line 570, in analyze_videos\r\n    convert_detections2tracklets(\r\n  File \"F:\\Anaconda\\envs\\deeplabcut\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\predict_videos.py\", line 1747, in convert_detections2tracklets\r\n    ass.assemble()\r\n  File \"F:\\Anaconda\\envs\\deeplabcut\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\lib\\inferenceutils.py\", line 784, in assemble\r\n    assemblies, unique = self._assemble(data_dict, i)\r\n  File \"F:\\Anaconda\\envs\\deeplabcut\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\lib\\inferenceutils.py\", line 727, in _assemble\r\n    scores = [\r\n  File \"F:\\Anaconda\\envs\\deeplabcut\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\lib\\inferenceutils.py\", line 728, in <listcomp>\r\n    -self.calc_assembly_mahalanobis_dist(ass) for ass in assemblies\r\n  File \"F:\\Anaconda\\envs\\deeplabcut\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\lib\\inferenceutils.py\", line 332, in calc_assembly_mahalanobis_dist\r\n    factor = self._kde.d / len(inds)\r\nZeroDivisionError: division by zero\n```\n\n\n### Anything else?\n\n_No response_\n\n### Code of Conduct\n\n- [X] I agree to follow this project's [Code of Conduct](https://github.com/DeepLabCut/DeepLabCut/blob/master/CODE_OF_CONDUCT.md)","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1818/timeline","performed_via_github_app":null,"state_reason":"completed"}