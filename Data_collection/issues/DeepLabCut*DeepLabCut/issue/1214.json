{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1214","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1214/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1214/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1214/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1214","id":874426202,"node_id":"MDU6SXNzdWU4NzQ0MjYyMDI=","number":1214,"title":"issue during training maDLC (training stopped way too early)","user":{"login":"rosalba3574","id":83355542,"node_id":"MDQ6VXNlcjgzMzU1NTQy","avatar_url":"https://avatars.githubusercontent.com/u/83355542?v=4","gravatar_id":"","url":"https://api.github.com/users/rosalba3574","html_url":"https://github.com/rosalba3574","followers_url":"https://api.github.com/users/rosalba3574/followers","following_url":"https://api.github.com/users/rosalba3574/following{/other_user}","gists_url":"https://api.github.com/users/rosalba3574/gists{/gist_id}","starred_url":"https://api.github.com/users/rosalba3574/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rosalba3574/subscriptions","organizations_url":"https://api.github.com/users/rosalba3574/orgs","repos_url":"https://api.github.com/users/rosalba3574/repos","events_url":"https://api.github.com/users/rosalba3574/events{/privacy}","received_events_url":"https://api.github.com/users/rosalba3574/received_events","type":"User","site_admin":false},"labels":[{"id":1313079487,"node_id":"MDU6TGFiZWwxMzEzMDc5NDg3","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/howtousedlc","name":"howtousedlc","color":"a1b3f4","default":false,"description":"issue regarding the use of DeepLabCut"},{"id":2379991078,"node_id":"MDU6TGFiZWwyMzc5OTkxMDc4","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/maDLC","name":"maDLC","color":"96001b","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2021-05-03T10:00:42Z","updated_at":"2021-05-04T15:53:22Z","closed_at":"2021-05-03T10:16:35Z","author_association":"NONE","active_lock_reason":null,"body":"Thanks for opening this issue, and thanks for using DeepLabCut (we hope you are enjoying it ;). Please fill out the template completely, including the full \"traceback\" and input code that you ran to hit this error.\r\n\r\nGPU Geforce 3070 RTX\r\nCuda v.11.2\r\ncuDNN v.8\r\npython 3.8.5\r\ntensorflow-gpu 1.14\r\ndeeplabcut 2.1.10.4\r\nWindows 10 Pro with anaconda env DLC-GPU\r\n\r\nHello, thank you so much for developing deeplabcut :)\r\nI am new to programming so I hope I gave you all the important information. I used deeplabcut without problems for single animal tracking and now I am trying to use it for a multi-animal tracking project, and I tried to run my data but it didn´t work so I tried with your example but I found some errors between the network training and its evaluation. I can open the GUI and import projects, extract frames, label the frames, check them and create a training dataset without problems. I also left all your pre-settings, but when I run the train network it gives some error message but at the end, it says that it was able to train the network. The real errors appear with the evaluate network it reaches a point and then it blocks there, I´ll report the entire code here, I hope you can help me, Thank you so much in advance.\r\nRosalba\r\n\r\n\r\nPlease place code inside this:\r\n\r\n<details><summary>Code output</summary><p>\r\n\r\n[In [3]: import deeplabcut\r\n\r\nIn [4]: deeplabcut.launch_dlc()\r\nmore networks are available soon for maDLC, but currenlty this uses DLC-ResNet50 only\r\nConfig file read successfully.\r\nExtracting frames based on kmeans ...\r\nKmeans-quantization based extracting of frames from 0.0  seconds to 77.67  seconds.\r\nExtracting and downsampling... 2330  frames from the video.\r\n2330it [00:04, 517.30it/s]\r\nKmeans clustering ... (this might take a while)\r\nFrames were successfully extracted, for the videos of interest.\r\n\r\nYou can now label the frames using the function 'label_frames' (if you extracted enough frames for all videos).\r\nFound new frames..\r\nYou can now check the labels, using 'check_labels' before proceeding. Then,  you can use the function 'create_training_dataset' to create the training dataset.\r\nCreating images with labels by dlc_team.\r\nC:\\Users\\rproce\\DeepLabCut\\examples\\multi_mouse-dlc_team-2021-05-03\\labeled-data\\m3v1mp4_cropped_labeled  already exists!\r\n100%|███████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 30.12it/s]\r\nIf all the labels are ok, then use the function 'create_training_dataset' to create the training dataset!\r\nC:\\Users\\rproce\\DeepLabCut\\examples\\multi_mouse-dlc_team-2021-05-03\\labeled-data\\m3v1mp4_cropped  already exists!\r\n100%|███████████████████████████████████████████████████████████████████████████████| 10/10 [00:20<00:00,  2.00s/it]\r\nC:\\Users\\rproce\\DeepLabCut\\examples\\multi_mouse-dlc_team-2021-05-03\\training-datasets\\iteration-0\\UnaugmentedDataSet_multi_mouseMay3  already exists!\r\nUtilizing the following graph: [[0, 1], [1, 2], [0, 2]]\r\nCreating training data for  1 0.8\r\nThis can take some time...\r\n100%|█████████████████████████████████████████████████████████████████████████████| 120/120 [00:01<00:00, 97.97it/s]\r\nC:\\Users\\rproce\\DeepLabCut\\examples\\multi_mouse-dlc_team-2021-05-03\\dlc-models\\iteration-0\\multi_mouseMay3-trainset80shuffle1  already exists!\r\nC:\\Users\\rproce\\DeepLabCut\\examples\\multi_mouse-dlc_team-2021-05-03\\dlc-models\\iteration-0\\multi_mouseMay3-trainset80shuffle1\\train  already exists!\r\nC:\\Users\\rproce\\DeepLabCut\\examples\\multi_mouse-dlc_team-2021-05-03\\dlc-models\\iteration-0\\multi_mouseMay3-trainset80shuffle1\\test  already exists!\r\nThe training dataset is successfully created. Use the function 'train_network' to start training. Happy training!\r\nSelecting multi-animal trainer\r\nConfig:\r\n{'all_joints': [[0], [1], [2]],\r\n 'all_joints_names': ['bodypart1', 'bodypart2', 'bodypart3'],\r\n 'alpha_r': 0.02,\r\n 'batch_size': 8,\r\n 'clahe': True,\r\n 'claheratio': 0.1,\r\n 'crop_pad': 0,\r\n 'cropratio': 0.4,\r\n 'dataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_multi_mouseMay3\\\\multi_mouse_dlc_team80shuffle1.pickle',\r\n 'dataset_type': 'multi-animal-imgaug',\r\n 'decay_steps': 30000,\r\n 'deterministic': False,\r\n 'display_iters': 500,\r\n 'edge': False,\r\n 'emboss': {'alpha': [0.0, 1.0], 'embossratio': 0.1, 'strength': [0.5, 1.5]},\r\n 'fg_fraction': 0.25,\r\n 'global_scale': 0.8,\r\n 'histeq': True,\r\n 'histeqratio': 0.1,\r\n 'init_weights': 'C:\\\\Users\\\\rproce\\\\AppData\\\\Roaming\\\\Python\\\\Python37\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt',\r\n 'intermediate_supervision': False,\r\n 'intermediate_supervision_layer': 12,\r\n 'location_refinement': True,\r\n 'locref_huber_loss': True,\r\n 'locref_loss_weight': 0.05,\r\n 'locref_stdev': 7.2801,\r\n 'log_dir': 'log',\r\n 'lr_init': 0.0005,\r\n 'max_input_size': 1500,\r\n 'mean_pixel': [123.68, 116.779, 103.939],\r\n 'metadataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_multi_mouseMay3\\\\Documentation_data-multi_mouse_80shuffle1.pickle',\r\n 'min_input_size': 64,\r\n 'mirror': False,\r\n 'multi_step': [[0.0001, 7500], [5e-05, 12000], [1e-05, 200000]],\r\n 'net_type': 'resnet_50',\r\n 'num_joints': 3,\r\n 'num_limbs': 3,\r\n 'optimizer': 'adam',\r\n 'pafwidth': 20,\r\n 'pairwise_huber_loss': False,\r\n 'pairwise_loss_weight': 0.1,\r\n 'pairwise_predict': False,\r\n 'partaffinityfield_graph': [[0, 1], [1, 2], [0, 2]],\r\n 'partaffinityfield_predict': True,\r\n 'pos_dist_thresh': 17,\r\n 'project_path': 'C:\\\\Users\\\\rproce\\\\DeepLabCut\\\\examples\\\\multi_mouse-dlc_team-2021-05-03',\r\n 'regularize': False,\r\n 'rotation': 25,\r\n 'rotratio': 0.4,\r\n 'save_iters': 10000,\r\n 'scale_jitter_lo': 0.5,\r\n 'scale_jitter_up': 1.25,\r\n 'scoremap_dir': 'test',\r\n 'sharpen': False,\r\n 'sharpenratio': 0.3,\r\n 'shuffle': True,\r\n 'snapshot_prefix': 'C:\\\\Users\\\\rproce\\\\DeepLabCut\\\\examples\\\\multi_mouse-dlc_team-2021-05-03\\\\dlc-models\\\\iteration-0\\\\multi_mouseMay3-trainset80shuffle1\\\\train\\\\snapshot',\r\n 'stride': 8.0,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001}\r\nActivating limb prediction...\r\nStarting with multi-animal imaug + adam pose-dataset loader.\r\nBatch Size is 8\r\nGetting specs multi-animal-imgaug 3 3\r\nInitializing ResNet\r\nLoading ImageNet-pretrained resnet_50\r\n2021-05-03 11:00:35.253805: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library nvcuda.dll\r\n2021-05-03 11:00:35.286404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties:\r\nname: GeForce RTX 3070 major: 8 minor: 6 memoryClockRate(GHz): 1.755\r\npciBusID: 0000:01:00.0\r\n2021-05-03 11:00:35.290309: I tensorflow/stream_executor/platform/default/dlopen_checker_stub.cc:25] GPU libraries are statically linked, skip dlopen check.\r\n2021-05-03 11:00:35.293188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0\r\n2021-05-03 11:00:35.295912: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2\r\n2021-05-03 11:00:35.302900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties:\r\nname: GeForce RTX 3070 major: 8 minor: 6 memoryClockRate(GHz): 1.755\r\npciBusID: 0000:01:00.0\r\n2021-05-03 11:00:35.307743: I tensorflow/stream_executor/platform/default/dlopen_checker_stub.cc:25] GPU libraries are statically linked, skip dlopen check.\r\n2021-05-03 11:00:35.310323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0\r\n2021-05-03 11:03:45.052211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2021-05-03 11:03:45.054622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0\r\n2021-05-03 11:03:45.056097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N\r\n2021-05-03 11:03:45.057861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6268 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3070, pci bus id: 0000:01:00.0, compute capability: 8.6)\r\nMax_iters overwritten as 50\r\nDisplay_iters overwritten as 10\r\nSave_iters overwritten as 5\r\nTraining parameters:\r\n{'stride': 8.0, 'weigh_part_predictions': False, 'weigh_negatives': False, 'fg_fraction': 0.25, 'mean_pixel': [123.68, 116.779, 103.939], 'shuffle': True, 'snapshot_prefix': 'C:\\\\Users\\\\rproce\\\\DeepLabCut\\\\examples\\\\multi_mouse-dlc_team-2021-05-03\\\\dlc-models\\\\iteration-0\\\\multi_mouseMay3-trainset80shuffle1\\\\train\\\\snapshot', 'log_dir': 'log', 'global_scale': 0.8, 'location_refinement': True, 'locref_stdev': 7.2801, 'locref_loss_weight': 0.05, 'locref_huber_loss': True, 'optimizer': 'adam', 'intermediate_supervision': False, 'intermediate_supervision_layer': 12, 'regularize': False, 'weight_decay': 0.0001, 'crop_pad': 0, 'scoremap_dir': 'test', 'batch_size': 8, 'dataset_type': 'multi-animal-imgaug', 'deterministic': False, 'mirror': False, 'pairwise_huber_loss': False, 'weigh_only_present_joints': False, 'partaffinityfield_predict': True, 'pairwise_predict': True, 'all_joints': [[0], [1], [2]], 'all_joints_names': ['bodypart1', 'bodypart2', 'bodypart3'], 'alpha_r': 0.02, 'clahe': True, 'claheratio': 0.1, 'cropratio': 0.4, 'dataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_multi_mouseMay3\\\\multi_mouse_dlc_team80shuffle1.pickle', 'decay_steps': 30000, 'display_iters': 500, 'edge': False, 'emboss': {'alpha': [0.0, 1.0], 'embossratio': 0.1, 'strength': [0.5, 1.5]}, 'histeq': True, 'histeqratio': 0.1, 'init_weights': 'C:\\\\Users\\\\rproce\\\\AppData\\\\Roaming\\\\Python\\\\Python37\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt', 'lr_init': 0.0005, 'max_input_size': 1500, 'metadataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_multi_mouseMay3\\\\Documentation_data-multi_mouse_80shuffle1.pickle', 'min_input_size': 64, 'multi_step': [[0.0001, 7500], [5e-05, 12000], [1e-05, 200000]], 'net_type': 'resnet_50', 'num_joints': 3, 'num_limbs': 3, 'pafwidth': 20, 'pairwise_loss_weight': 0.1, 'partaffinityfield_graph': [[0, 1], [1, 2], [0, 2]], 'pos_dist_thresh': 17, 'project_path': 'C:\\\\Users\\\\rproce\\\\DeepLabCut\\\\examples\\\\multi_mouse-dlc_team-2021-05-03', 'rotation': 25, 'rotratio': 0.4, 'save_iters': 10000, 'scale_jitter_lo': 0.5, 'scale_jitter_up': 1.25, 'sharpen': False, 'sharpenratio': 0.3}\r\nStarting multi-animal training....\r\niteration: 10 loss: 0.6911 scmap loss: 0.6841 locref loss: 0.0016 limb loss: 0.0054 lr: 0.0001\r\niteration: 20 loss: 0.4658 scmap loss: 0.4617 locref loss: 0.0008 limb loss: 0.0032 lr: 0.0001\r\niteration: 30 loss: 0.3654 scmap loss: 0.3622 locref loss: 0.0007 limb loss: 0.0026 lr: 0.0001\r\niteration: 40 loss: 0.2971 scmap loss: 0.2943 locref loss: 0.0006 limb loss: 0.0022 lr: 0.0001\r\niteration: 50 loss: 0.2476 scmap loss: 0.2440 locref loss: 0.0007 limb loss: 0.0029 lr: 0.0001\r\n2021-05-03 11:16:40.779018: W tensorflow/core/kernels/queue_base.cc:277] _0_fifo_queue: Skipping cancelled enqueue attempt with queue not closed\r\nException in thread Thread-64:\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1356, in _do_call\r\n    return fn(*args)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1341, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1429, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.CancelledError: Enqueue operation was cancelled\r\n         [[{{node fifo_queue_enqueue}}]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\threading.py\", line 926, in _bootstrap_inner\r\n    self.run()\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\threading.py\", line 870, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"C:\\Users\\rproce\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train_multianimal.py\", line 78, in load_and_enqueue\r\n    sess.run(enqueue_op, feed_dict=food)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 950, in run\r\n    run_metadata_ptr)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1173, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1350, in _do_run\r\n    run_metadata)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1370, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.CancelledError: Enqueue operation was cancelled\r\n         [[node fifo_queue_enqueue (defined at C:\\Users\\rproce\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train_multianimal.py:64) ]]\r\n\r\nErrors may have originated from an input operation.\r\nInput Source operations connected to node fifo_queue_enqueue:\r\n Placeholder (defined at C:\\Users\\rproce\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train_multianimal.py:53)\r\n fifo_queue (defined at C:\\Users\\rproce\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train_multianimal.py:61)\r\n\r\nOriginal stack trace for 'fifo_queue_enqueue':\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\Scripts\\ipython-script.py\", line 10, in <module>\r\n    sys.exit(start_ipython())\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\__init__.py\", line 126, in start_ipython\r\n    return launch_new_instance(argv=argv, **kwargs)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\traitlets\\config\\application.py\", line 845, in launch_instance\r\n    app.start()\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\terminal\\ipapp.py\", line 356, in start\r\n    self.shell.mainloop()\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\terminal\\interactiveshell.py\", line 564, in mainloop\r\n    self.interact()\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\terminal\\interactiveshell.py\", line 555, in interact\r\n    self.run_cell(code, store_history=True)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2895, in run_cell\r\n    raw_cell, store_history, silent, shell_futures)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2940, in _run_cell\r\n    return runner(coro)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\core\\async_helpers.py\", line 68, in _pseudo_sync_runner\r\n    coro.send(None)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 3166, in run_cell_async\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 3357, in run_ast_nodes\r\n    if (await self.run_code(code, result,  async_=asy)):\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 3437, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-4-1ced4355ffc5>\", line 1, in <module>\r\n    deeplabcut.launch_dlc()\r\n  File \"C:\\Users\\rproce\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\gui\\launch_script.py\", line 46, in launch_dlc\r\n    app.MainLoop()\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\wx\\core.py\", line 2166, in MainLoop\r\n    rv = wx.PyApp.MainLoop(self)\r\n  File \"C:\\Users\\rproce\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\gui\\label_frames.py\", line 211, in label_frames\r\n    label_frames(self.config)\r\n  File \"C:\\Users\\rproce\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\gui\\label_frames.py\", line 76, in label_frames\r\n    multiple_individuals_labeling_toolbox.show(config, config3d, sourceCam)\r\n  File \"C:\\Users\\rproce\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\gui\\multiple_individuals_labeling_toolbox.py\", line 1312, in show\r\n    app.MainLoop()\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\wx\\core.py\", line 2166, in MainLoop\r\n    rv = wx.PyApp.MainLoop(self)\r\n  File \"C:\\Users\\rproce\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\gui\\train_network.py\", line 328, in train_network\r\n    maxiters=maxiters,\r\n  File \"C:\\Users\\rproce\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\training.py\", line 176, in train_network\r\n    allow_growth=allow_growth,\r\n  File \"C:\\Users\\rproce\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train_multianimal.py\", line 147, in train\r\n    batch, enqueue_op, placeholders = setup_preloading(batch_spec)\r\n  File \"C:\\Users\\rproce\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train_multianimal.py\", line 64, in setup_preloading\r\n    enqueue_op = q.enqueue(placeholders_list)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\ops\\data_flow_ops.py\", line 345, in enqueue\r\n    self._queue_ref, vals, name=scope)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\ops\\gen_data_flow_ops.py\", line 4807, in queue_enqueue_v2\r\n    timeout_ms=timeout_ms, name=name)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 788, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\util\\deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3616, in create_op\r\n    op_def=op_def)\r\n  File \"C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 2005, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\n\r\nThe network is now trained and ready to evaluate. Use the function 'evaluate_network' to evaluate the network.\r\nC:\\Users\\rproce\\DeepLabCut\\examples\\multi_mouse-dlc_team-2021-05-03/evaluation-results/  already exists!\r\nConfig:\r\n{'all_joints': [[0], [1], [2]],\r\n 'all_joints_names': ['bodypart1', 'bodypart2', 'bodypart3'],\r\n 'batch_size': 1,\r\n 'crop_pad': 0,\r\n 'dataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_multi_mouseMay3\\\\multi_mouse_dlc_team80shuffle1.pickle',\r\n 'dataset_type': 'multi-animal-imgaug',\r\n 'deterministic': False,\r\n 'fg_fraction': 0.25,\r\n 'global_scale': 0.8,\r\n 'init_weights': 'C:\\\\Users\\\\rproce\\\\AppData\\\\Roaming\\\\Python\\\\Python37\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt',\r\n 'intermediate_supervision': False,\r\n 'intermediate_supervision_layer': 12,\r\n 'location_refinement': True,\r\n 'locref_huber_loss': True,\r\n 'locref_loss_weight': 1.0,\r\n 'locref_stdev': 7.2801,\r\n 'log_dir': 'log',\r\n 'mean_pixel': [123.68, 116.779, 103.939],\r\n 'minconfidence': 0.01,\r\n 'mirror': False,\r\n 'net_type': 'resnet_50',\r\n 'nmsradius': 5.0,\r\n 'num_joints': 3,\r\n 'num_limbs': 3,\r\n 'optimizer': 'sgd',\r\n 'pairwise_huber_loss': True,\r\n 'pairwise_predict': False,\r\n 'partaffinityfield_graph': [[0, 1], [1, 2], [0, 2]],\r\n 'partaffinityfield_predict': True,\r\n 'regularize': False,\r\n 'scoremap_dir': 'test',\r\n 'shuffle': True,\r\n 'snapshot_prefix': 'C:\\\\Users\\\\rproce\\\\DeepLabCut\\\\examples\\\\multi_mouse-dlc_team-2021-05-03\\\\dlc-models\\\\iteration-0\\\\multi_mouseMay3-trainset80shuffle1\\\\test\\\\snapshot',\r\n 'stride': 8.0,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001}\r\nC:\\Users\\rproce\\DeepLabCut\\examples\\multi_mouse-dlc_team-2021-05-03\\evaluation-results\\iteration-0\\multi_mouseMay3-trainset80shuffle1  already exists!\r\nRunning  DLC_resnet50_multi_mouseMay3shuffle1_50  with # of trainingiterations: 50\r\nC:\\Users\\rproce\\DeepLabCut\\examples\\multi_mouse-dlc_team-2021-05-03\\evaluation-results\\iteration-0\\multi_mouseMay3-trainset80shuffle1\\LabeledImages_DLC_resnet50_multi_mouseMay3shuffle1_50_snapshot-50  already exists!\r\nInitializing ResNet\r\nActivating extracting of PAFs\r\n2021-05-03 11:16:50.318485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties:\r\nname: GeForce RTX 3070 major: 8 minor: 6 memoryClockRate(GHz): 1.755\r\npciBusID: 0000:01:00.0\r\n2021-05-03 11:16:50.323240: I tensorflow/stream_executor/platform/default/dlopen_checker_stub.cc:25] GPU libraries are statically linked, skip dlopen check.\r\n2021-05-03 11:16:50.325407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0\r\n2021-05-03 11:16:50.327394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2021-05-03 11:16:50.329593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0\r\n2021-05-03 11:16:50.330825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N\r\n2021-05-03 11:16:50.332167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6268 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3070, pci bus id: 0000:01:00.0, compute capability: 8.6)\r\nAnalyzing data...\r\n12it [10:57, 70.74s/it]C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\numpy\\lib\\function_base.py:4069: RuntimeWarning: invalid value encountered in add\r\n  ret = (d * (y[tuple(slice1)] + y[tuple(slice2)]) / 2.0).sum(axis)\r\n13it [12:13, 72.13s/it]C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\numpy\\lib\\function_base.py:4069: RuntimeWarning: invalid value encountered in add\r\n  ret = (d * (y[tuple(slice1)] + y[tuple(slice2)]) / 2.0).sum(axis)\r\n14it [13:29, 73.46s/it]C:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\numpy\\lib\\function_base.py:4069: RuntimeWarning: invalid value encountered in add\r\n  ret = (d * (y[tuple(slice1)] + y[tuple(slice2)]) / 2.0).sum(axis)\r\nC:\\Users\\rproce\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\numpy\\core\\_methods.py:38: RuntimeWarning: invalid value encountered in reduce\r\n  return umr_sum(a, axis, dtype, out, keepdims, initial, where)\r\n14it [14:18, 61.33s/it]\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n~\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\gui\\evaluate_network.py in evaluate_network(self, event)\r\n    335             plotting=plotting,\r\n    336             show_errors=True,\r\n--> 337             comparisonbodyparts=self.bodyparts,\r\n    338         )\r\n    339\r\n\r\n~\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\evaluate.py in evaluate_network(config, Shuffles, trainingsetindex, plotting, show_errors, comparisonbodyparts, gputouse, rescale, modelprefix, c_engine)\r\n    568             gputouse=gputouse,\r\n    569             modelprefix=modelprefix,\r\n--> 570             c_engine=c_engine,\r\n    571         )\r\n    572     else:\r\n\r\n~\\AppData\\Roaming\\Python\\Python37\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\evaluate_multianimal.py in evaluate_multianimal_full(config, Shuffles, trainingsetindex, plotting, show_errors, comparisonbodyparts, gputouse, modelprefix, c_engine)\r\n    378                                     # rather than the ones the model has most confident in\r\n    379                                     d = cdist(xy_gt.iloc[inds_gt], xy)\r\n--> 380                                     rows, cols = linear_sum_assignment(d)\r\n    381                                     min_dists = d[rows, cols]\r\n    382                                     inds = np.flatnonzero(all_bpts == bpt)\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\scipy\\optimize\\_lsap.py in linear_sum_assignment(cost_matrix, maximize)\r\n     91\r\n     92     if np.any(np.isneginf(cost_matrix) | np.isnan(cost_matrix)):\r\n---> 93         raise ValueError(\"matrix contains invalid numeric entries\")\r\n     94\r\n     95     cost_matrix = cost_matrix.astype(np.double)\r\n\r\nValueError: matrix contains invalid numeric entries]\r\n\r\n\r\n","closed_by":{"login":"AlexEMG","id":20850270,"node_id":"MDQ6VXNlcjIwODUwMjcw","avatar_url":"https://avatars.githubusercontent.com/u/20850270?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexEMG","html_url":"https://github.com/AlexEMG","followers_url":"https://api.github.com/users/AlexEMG/followers","following_url":"https://api.github.com/users/AlexEMG/following{/other_user}","gists_url":"https://api.github.com/users/AlexEMG/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexEMG/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexEMG/subscriptions","organizations_url":"https://api.github.com/users/AlexEMG/orgs","repos_url":"https://api.github.com/users/AlexEMG/repos","events_url":"https://api.github.com/users/AlexEMG/events{/privacy}","received_events_url":"https://api.github.com/users/AlexEMG/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1214/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1214/timeline","performed_via_github_app":null,"state_reason":"completed"}