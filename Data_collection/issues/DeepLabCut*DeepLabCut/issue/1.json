{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1","id":313753650,"node_id":"MDU6SXNzdWUzMTM3NTM2NTA=","number":1,"title":"cuDNN launch failure : input shape([1,3,395,536]) filter shape([7,7,3,64])","user":{"login":"mschart","id":17218515,"node_id":"MDQ6VXNlcjE3MjE4NTE1","avatar_url":"https://avatars.githubusercontent.com/u/17218515?v=4","gravatar_id":"","url":"https://api.github.com/users/mschart","html_url":"https://github.com/mschart","followers_url":"https://api.github.com/users/mschart/followers","following_url":"https://api.github.com/users/mschart/following{/other_user}","gists_url":"https://api.github.com/users/mschart/gists{/gist_id}","starred_url":"https://api.github.com/users/mschart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mschart/subscriptions","organizations_url":"https://api.github.com/users/mschart/orgs","repos_url":"https://api.github.com/users/mschart/repos","events_url":"https://api.github.com/users/mschart/events{/privacy}","received_events_url":"https://api.github.com/users/mschart/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":18,"created_at":"2018-04-12T14:32:21Z","updated_at":"2021-10-07T12:35:49Z","closed_at":"2018-04-12T20:25:21Z","author_association":"NONE","active_lock_reason":null,"body":"Hi there,\r\nWhen trying to retrain the network using the example labels - just to test if the installation is ok - I get a mismatch error like that:\r\n```\r\n(tensorflow) mic@mic-OptiPlex-9010:~/DeepLabCut/pose-tensorflow/models/reachingJan30-trainset95shuffle1/train$ TF_CUDNN_USE_AUTOTUNE=0 CUDA_VISIBLE_DEVICES=0 python3 ../../../train.py\r\n/home/mic/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\r\n  from ._conv import register_converters as _register_converters\r\nWARNING:tensorflow:From /home/mic/.local/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/datasets/base.py:198: retry (from tensorflow.contrib.learn.python.learn.datasets.base) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse the retry module or similar alternatives.\r\nConfig:\r\n{'all_joints': [[0], [1], [2], [3]],\r\n 'all_joints_names': ['hand', 'Finger1', 'Finger2', 'Joystick'],\r\n 'batch_size': 1,\r\n 'crop': False,\r\n 'crop_pad': 0,\r\n 'dataset': '../../UnaugmentedDataSet_reachingJan30/reaching_Mackenzie95shuffle1.mat',\r\n 'dataset_type': 'default',\r\n 'display_iters': 5000,\r\n 'fg_fraction': 0.25,\r\n 'global_scale': 0.8,\r\n 'init_weights': '../../pretrained/resnet_v1_50.ckpt',\r\n 'intermediate_supervision': False,\r\n 'intermediate_supervision_layer': 12,\r\n 'location_refinement': True,\r\n 'locref_huber_loss': True,\r\n 'locref_loss_weight': 0.05,\r\n 'locref_stdev': 7.2801,\r\n 'log_dir': 'log',\r\n 'max_input_size': 1000,\r\n 'mean_pixel': [123.68, 116.779, 103.939],\r\n 'mirror': False,\r\n 'multi_step': [[0.005, 10000],\r\n                [0.02, 430000],\r\n                [0.002, 730000],\r\n                [0.001, 1030000]],\r\n 'net_type': 'resnet_50',\r\n 'num_joints': 4,\r\n 'optimizer': 'sgd',\r\n 'pos_dist_thresh': 17,\r\n 'regularize': False,\r\n 'save_iters': 50000,\r\n 'scale_jitter_lo': 0.5,\r\n 'scale_jitter_up': 1.5,\r\n 'scoremap_dir': 'test',\r\n 'shuffle': True,\r\n 'snapshot_prefix': './snapshot',\r\n 'stride': 8.0,\r\n 'use_gt_segm': False,\r\n 'video': False,\r\n 'video_batch': False,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001}\r\n2018-04-12 16:28:32.944642: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-04-12 16:28:32.944900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1344] Found device 0 with properties: \r\nname: Quadro K620 major: 5 minor: 0 memoryClockRate(GHz): 1.124\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 1.95GiB freeMemory: 1.33GiB\r\n2018-04-12 16:28:32.944919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1423] Adding visible gpu devices: 0\r\n2018-04-12 16:28:33.373499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-04-12 16:28:33.373536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0 \r\n2018-04-12 16:28:33.373543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N \r\n2018-04-12 16:28:33.373694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1041] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 1088 MB memory) -> physical GPU (device: 0, name: Quadro K620, pci bus id: 0000:01:00.0, compute capability: 5.0)\r\nINFO:tensorflow:Restoring parameters from ../../pretrained/resnet_v1_50.ckpt\r\nRestoring parameters from ../../pretrained/resnet_v1_50.ckpt\r\n2018-04-12 16:28:38.363988: E tensorflow/stream_executor/cuda/cuda_dnn.cc:396] Loaded runtime CuDNN library: 7102 (compatibility version 7100) but source was compiled with 7005 (compatibility version 7000).  If using a binary install, upgrade your CuDNN library to match.  If building from sources, make sure the library loaded at runtime matches a compatible version specified during compile configuration.\r\n2018-04-12 16:28:38.364664: W ./tensorflow/stream_executor/stream.h:2018] attempting to perform DNN operation using StreamExecutor without DNN support\r\nTraceback (most recent call last):\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1327, in _do_call\r\n    return fn(*args)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1312, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1420, in _call_tf_sessionrun\r\n    status, run_metadata)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py\", line 516, in __exit__\r\n    c_api.TF_GetCode(self.status.status))\r\ntensorflow.python.framework.errors_impl.InternalError: cuDNN launch failure : input shape([1,3,395,536]) filter shape([7,7,3,64])\r\n\t [[Node: resnet_v1_50/conv1/Conv2D = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"VALID\", strides=[1, 1, 2, 2], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](resnet_v1_50/conv1/Conv2D-0-TransposeNHWCToNCHW-LayoutOptimizer, resnet_v1_50/conv1/weights/read)]]\r\n\t [[Node: add/_763 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_1602_add\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"../../../train.py\", line 140, in <module>\r\n    train()\r\n  File \"../../../train.py\", line 119, in train\r\n    feed_dict={learning_rate: current_lr})\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 905, in run\r\n    run_metadata_ptr)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1140, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1321, in _do_run\r\n    run_metadata)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1340, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InternalError: cuDNN launch failure : input shape([1,3,395,536]) filter shape([7,7,3,64])\r\n\t [[Node: resnet_v1_50/conv1/Conv2D = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"VALID\", strides=[1, 1, 2, 2], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](resnet_v1_50/conv1/Conv2D-0-TransposeNHWCToNCHW-LayoutOptimizer, resnet_v1_50/conv1/weights/read)]]\r\n\t [[Node: add/_763 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_1602_add\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n\r\nCaused by op 'resnet_v1_50/conv1/Conv2D', defined at:\r\n  File \"../../../train.py\", line 140, in <module>\r\n    train()\r\n  File \"../../../train.py\", line 85, in train\r\n    losses = pose_net(cfg).train(batch)\r\n  File \"/home/mic/DeepLabCut/pose-tensorflow/nnet/pose_net.py\", line 96, in train\r\n    heads = self.get_net(batch[Batch.inputs])\r\n  File \"/home/mic/DeepLabCut/pose-tensorflow/nnet/pose_net.py\", line 85, in get_net\r\n    net, end_points = self.extract_features(inputs)\r\n  File \"/home/mic/DeepLabCut/pose-tensorflow/nnet/pose_net.py\", line 58, in extract_features\r\n    global_pool=False, output_stride=16,is_training=False)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/contrib/slim/python/slim/nets/resnet_v1.py\", line 274, in resnet_v1_50\r\n    scope=scope)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/contrib/slim/python/slim/nets/resnet_v1.py\", line 205, in resnet_v1\r\n    net = resnet_utils.conv2d_same(net, 64, 7, stride=2, scope='conv1')\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/contrib/slim/python/slim/nets/resnet_utils.py\", line 146, in conv2d_same\r\n    scope=scope)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/contrib/framework/python/ops/arg_scope.py\", line 183, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py\", line 1049, in convolution\r\n    outputs = layer.apply(inputs)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/layers/base.py\", line 825, in apply\r\n    return self.__call__(inputs, *args, **kwargs)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/layers/base.py\", line 714, in __call__\r\n    outputs = self.call(inputs, *args, **kwargs)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/layers/convolutional.py\", line 168, in call\r\n    outputs = self._convolution_op(inputs, self.kernel)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 870, in __call__\r\n    return self.conv_op(inp, filter)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 522, in __call__\r\n    return self.call(inp, filter)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/ops/nn_ops.py\", line 206, in __call__\r\n    name=self.name)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 953, in conv2d\r\n    data_format=data_format, dilations=dilations, name=name)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3290, in create_op\r\n    op_def=op_def)\r\n  File \"/home/mic/.local/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1654, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nInternalError (see above for traceback): cuDNN launch failure : input shape([1,3,395,536]) filter shape([7,7,3,64])\r\n\t [[Node: resnet_v1_50/conv1/Conv2D = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"VALID\", strides=[1, 1, 2, 2], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](resnet_v1_50/conv1/Conv2D-0-TransposeNHWCToNCHW-LayoutOptimizer, resnet_v1_50/conv1/weights/read)]]\r\n\t [[Node: add/_763 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_1602_add\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n```\r\n\r\nAny hints greatly appreciated! ","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1/timeline","performed_via_github_app":null,"state_reason":"completed"}