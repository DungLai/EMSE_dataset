{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/133","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/133/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/133/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/133/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/133","id":384267421,"node_id":"MDU6SXNzdWUzODQyNjc0MjE=","number":133,"title":"Error appearing in \"train_network\" level (ResourceExhaustedError >> get smaller images or a larger GPU, or turn already running net off...)","user":{"login":"saritma","id":31058799,"node_id":"MDQ6VXNlcjMxMDU4Nzk5","avatar_url":"https://avatars.githubusercontent.com/u/31058799?v=4","gravatar_id":"","url":"https://api.github.com/users/saritma","html_url":"https://github.com/saritma","followers_url":"https://api.github.com/users/saritma/followers","following_url":"https://api.github.com/users/saritma/following{/other_user}","gists_url":"https://api.github.com/users/saritma/gists{/gist_id}","starred_url":"https://api.github.com/users/saritma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/saritma/subscriptions","organizations_url":"https://api.github.com/users/saritma/orgs","repos_url":"https://api.github.com/users/saritma/repos","events_url":"https://api.github.com/users/saritma/events{/privacy}","received_events_url":"https://api.github.com/users/saritma/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2018-11-26T10:33:37Z","updated_at":"2019-10-07T18:55:39Z","closed_at":"2018-11-26T15:23:10Z","author_association":"NONE","active_lock_reason":null,"body":"**Your Operating system and DeepLabCut version**\r\nwindows 10, DLC version2, conda environment, using jupyter notebook and GPU\r\n\r\n**Describe the problem**\r\nI reached the level of training the data with the file \"demo with your own data\", and I get an error. tried to use different sizes of display iters and save iters:\r\n\r\nConfig:\r\n{'all_joints': [[0], [1]],\r\n 'all_joints_names': ['snout', 'eye'],\r\n 'batch_size': 1,\r\n 'bottomheight': 400,\r\n 'crop': True,\r\n 'crop_pad': 0,\r\n 'cropratio': 0.4,\r\n 'dataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_try26Nov26\\\\try26_Sarit95shuffle1.mat',\r\n 'dataset_type': 'default',\r\n 'display_iters': 1000,\r\n 'fg_fraction': 0.25,\r\n 'global_scale': 0.8,\r\n 'init_weights': 'c:\\\\users\\\\sarit\\\\anaconda3\\\\envs\\\\saritenv\\\\lib\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt',\r\n 'intermediate_supervision': False,\r\n 'intermediate_supervision_layer': 12,\r\n 'leftwidth': 400,\r\n 'location_refinement': True,\r\n 'locref_huber_loss': True,\r\n 'locref_loss_weight': 0.05,\r\n 'locref_stdev': 7.2801,\r\n 'log_dir': 'log',\r\n 'max_input_size': 1000,\r\n 'mean_pixel': [123.68, 116.779, 103.939],\r\n 'metadataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_try26Nov26\\\\Documentation_data-try26_95shuffle1.pickle',\r\n 'minsize': 100,\r\n 'mirror': False,\r\n 'multi_step': [[0.005, 10000],\r\n                [0.02, 430000],\r\n                [0.002, 730000],\r\n                [0.001, 1030000]],\r\n 'net_type': 'resnet_50',\r\n 'num_joints': 2,\r\n 'optimizer': 'sgd',\r\n 'pos_dist_thresh': 17,\r\n 'project_path': 'C:\\\\Users\\\\Sarit\\\\Desktop\\\\try26.11\\\\try26-Sarit-2018-11-26',\r\n 'regularize': False,\r\n 'rightwidth': 400,\r\n 'save_iters': 50000,\r\n 'scale_jitter_lo': 0.5,\r\n 'scale_jitter_up': 1.25,\r\n 'scoremap_dir': 'test',\r\n 'shuffle': True,\r\n 'snapshot_prefix': 'C:\\\\Users\\\\Sarit\\\\Desktop\\\\try26.11\\\\try26-Sarit-2018-11-26\\\\dlc-models\\\\iteration-0\\\\try26Nov26-trainset95shuffle1\\\\train\\\\snapshot',\r\n 'stride': 8.0,\r\n 'topheight': 400,\r\n 'use_gt_segm': False,\r\n 'video': False,\r\n 'video_batch': False,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001}\r\nConfig:\r\n{'all_joints': [[0], [1]],\r\n 'all_joints_names': ['snout', 'eye'],\r\n 'batch_size': 1,\r\n 'bottomheight': 400,\r\n 'crop': True,\r\n 'crop_pad': 0,\r\n 'cropratio': 0.4,\r\n 'dataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_try26Nov26\\\\try26_Sarit95shuffle1.mat',\r\n 'dataset_type': 'default',\r\n 'display_iters': 1000,\r\n 'fg_fraction': 0.25,\r\n 'global_scale': 0.8,\r\n 'init_weights': 'c:\\\\users\\\\sarit\\\\anaconda3\\\\envs\\\\saritenv\\\\lib\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt',\r\n 'intermediate_supervision': False,\r\n 'intermediate_supervision_layer': 12,\r\n 'leftwidth': 400,\r\n 'location_refinement': True,\r\n 'locref_huber_loss': True,\r\n 'locref_loss_weight': 0.05,\r\n 'locref_stdev': 7.2801,\r\n 'log_dir': 'log',\r\n 'max_input_size': 1000,\r\n 'mean_pixel': [123.68, 116.779, 103.939],\r\n 'metadataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_try26Nov26\\\\Documentation_data-try26_95shuffle1.pickle',\r\n 'minsize': 100,\r\n 'mirror': False,\r\n 'multi_step': [[0.005, 10000],\r\n                [0.02, 430000],\r\n                [0.002, 730000],\r\n                [0.001, 1030000]],\r\n 'net_type': 'resnet_50',\r\n 'num_joints': 2,\r\n 'optimizer': 'sgd',\r\n 'pos_dist_thresh': 17,\r\n 'project_path': 'C:\\\\Users\\\\Sarit\\\\Desktop\\\\try26.11\\\\try26-Sarit-2018-11-26',\r\n 'regularize': False,\r\n 'rightwidth': 400,\r\n 'save_iters': 50000,\r\n 'scale_jitter_lo': 0.5,\r\n 'scale_jitter_up': 1.25,\r\n 'scoremap_dir': 'test',\r\n 'shuffle': True,\r\n 'snapshot_prefix': 'C:\\\\Users\\\\Sarit\\\\Desktop\\\\try26.11\\\\try26-Sarit-2018-11-26\\\\dlc-models\\\\iteration-0\\\\try26Nov26-trainset95shuffle1\\\\train\\\\snapshot',\r\n 'stride': 8.0,\r\n 'topheight': 400,\r\n 'use_gt_segm': False,\r\n 'video': False,\r\n 'video_batch': False,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001}\r\nConfig:\r\n{'all_joints': [[0], [1]],\r\n 'all_joints_names': ['snout', 'eye'],\r\n 'batch_size': 1,\r\n 'bottomheight': 400,\r\n 'crop': True,\r\n 'crop_pad': 0,\r\n 'cropratio': 0.4,\r\n 'dataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_try26Nov26\\\\try26_Sarit95shuffle1.mat',\r\n 'dataset_type': 'default',\r\n 'display_iters': 1000,\r\n 'fg_fraction': 0.25,\r\n 'global_scale': 0.8,\r\n 'init_weights': 'c:\\\\users\\\\sarit\\\\anaconda3\\\\envs\\\\saritenv\\\\lib\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt',\r\n 'intermediate_supervision': False,\r\n 'intermediate_supervision_layer': 12,\r\n 'leftwidth': 400,\r\n 'location_refinement': True,\r\n 'locref_huber_loss': True,\r\n 'locref_loss_weight': 0.05,\r\n 'locref_stdev': 7.2801,\r\n 'log_dir': 'log',\r\n 'max_input_size': 1000,\r\n 'mean_pixel': [123.68, 116.779, 103.939],\r\n 'metadataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_try26Nov26\\\\Documentation_data-try26_95shuffle1.pickle',\r\n 'minsize': 100,\r\n 'mirror': False,\r\n 'multi_step': [[0.005, 10000],\r\n                [0.02, 430000],\r\n                [0.002, 730000],\r\n                [0.001, 1030000]],\r\n 'net_type': 'resnet_50',\r\n 'num_joints': 2,\r\n 'optimizer': 'sgd',\r\n 'pos_dist_thresh': 17,\r\n 'project_path': 'C:\\\\Users\\\\Sarit\\\\Desktop\\\\try26.11\\\\try26-Sarit-2018-11-26',\r\n 'regularize': False,\r\n 'rightwidth': 400,\r\n 'save_iters': 50000,\r\n 'scale_jitter_lo': 0.5,\r\n 'scale_jitter_up': 1.25,\r\n 'scoremap_dir': 'test',\r\n 'shuffle': True,\r\n 'snapshot_prefix': 'C:\\\\Users\\\\Sarit\\\\Desktop\\\\try26.11\\\\try26-Sarit-2018-11-26\\\\dlc-models\\\\iteration-0\\\\try26Nov26-trainset95shuffle1\\\\train\\\\snapshot',\r\n 'stride': 8.0,\r\n 'topheight': 400,\r\n 'use_gt_segm': False,\r\n 'video': False,\r\n 'video_batch': False,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001}\r\nINFO:tensorflow:Restoring parameters from c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\models\\pretrained\\resnet_v1_50.ckpt\r\nRestoring parameters from c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\models\\pretrained\\resnet_v1_50.ckpt\r\nRestoring parameters from c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\models\\pretrained\\resnet_v1_50.ckpt\r\nRestoring parameters from c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\models\\pretrained\\resnet_v1_50.ckpt\r\nTraining parameter:\r\n{'stride': 8.0, 'weigh_part_predictions': False, 'weigh_negatives': False, 'fg_fraction': 0.25, 'weigh_only_present_joints': False, 'mean_pixel': [123.68, 116.779, 103.939], 'shuffle': True, 'snapshot_prefix': 'C:\\\\Users\\\\Sarit\\\\Desktop\\\\try26.11\\\\try26-Sarit-2018-11-26\\\\dlc-models\\\\iteration-0\\\\try26Nov26-trainset95shuffle1\\\\train\\\\snapshot', 'log_dir': 'log', 'global_scale': 0.8, 'location_refinement': True, 'locref_stdev': 7.2801, 'locref_loss_weight': 0.05, 'locref_huber_loss': True, 'optimizer': 'sgd', 'intermediate_supervision': False, 'intermediate_supervision_layer': 12, 'regularize': False, 'weight_decay': 0.0001, 'mirror': False, 'crop_pad': 0, 'scoremap_dir': 'test', 'dataset_type': 'default', 'use_gt_segm': False, 'batch_size': 1, 'video': False, 'video_batch': False, 'crop': True, 'cropratio': 0.4, 'minsize': 100, 'leftwidth': 400, 'rightwidth': 400, 'topheight': 400, 'bottomheight': 400, 'all_joints': [[0], [1]], 'all_joints_names': ['snout', 'eye'], 'dataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_try26Nov26\\\\try26_Sarit95shuffle1.mat', 'display_iters': 1000, 'init_weights': 'c:\\\\users\\\\sarit\\\\anaconda3\\\\envs\\\\saritenv\\\\lib\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt', 'max_input_size': 1000, 'metadataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_try26Nov26\\\\Documentation_data-try26_95shuffle1.pickle', 'multi_step': [[0.005, 10000], [0.02, 430000], [0.002, 730000], [0.001, 1030000]], 'net_type': 'resnet_50', 'num_joints': 2, 'pos_dist_thresh': 17, 'project_path': 'C:\\\\Users\\\\Sarit\\\\Desktop\\\\try26.11\\\\try26-Sarit-2018-11-26', 'save_iters': 50000, 'scale_jitter_lo': 0.5, 'scale_jitter_up': 1.25}\r\nStarting training....\r\n---------------------------------------------------------------------------\r\nResourceExhaustedError                    Traceback (most recent call last)\r\nc:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\r\n   1321     try:\r\n-> 1322       return fn(*args)\r\n   1323     except errors.OpError as e:\r\n\r\nc:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)\r\n   1306       return self._call_tf_sessionrun(\r\n-> 1307           options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1308 \r\n\r\nc:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1408           self._session, options, feed_dict, fetch_list, target_list,\r\n-> 1409           run_metadata)\r\n   1410     else:\r\n\r\nResourceExhaustedError: OOM when allocating tensor with shape[1,2048,50,62] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc\r\n\t [[Node: resnet_v1_50/block4/unit_3/bottleneck_v1/conv3/Conv2D = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"SAME\", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](resnet_v1_50/block4/unit_3/bottleneck_v1/conv2/Relu, resnet_v1_50/block4/unit_3/bottleneck_v1/conv3/weights/read/_1247)]]\r\nHint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.\r\n\r\n\t [[Node: pose/part_pred/block4/stack/_1347 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_1430_pose/part_pred/block4/stack\", tensor_type=DT_INT32, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\nHint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.\r\n\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nResourceExhaustedError                    Traceback (most recent call last)\r\n<ipython-input-9-9519d82efecc> in <module>()\r\n----> 1 deeplabcut.train_network(path_config_file)\r\n\r\nc:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\training.py in train_network(config, shuffle, trainingsetindex, gputouse, max_snapshots_to_keep, autotune, displayiters, saveiters, maxiters)\r\n     79           train(str(poseconfigfile),displayiters,saveiters,maxiters,max_to_keep=max_snapshots_to_keep) #pass on path and file name for pose_cfg.yaml!\r\n     80       except BaseException as e:\r\n---> 81           raise e\r\n     82       finally:\r\n     83           os.chdir(str(start_path))\r\n\r\nc:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\training.py in train_network(config, shuffle, trainingsetindex, gputouse, max_snapshots_to_keep, autotune, displayiters, saveiters, maxiters)\r\n     77         os.environ['CUDA_VISIBLE_DEVICES'] = str(gputouse)\r\n     78       try:\r\n---> 79           train(str(poseconfigfile),displayiters,saveiters,maxiters,max_to_keep=max_snapshots_to_keep) #pass on path and file name for pose_cfg.yaml!\r\n     80       except BaseException as e:\r\n     81           raise e\r\n\r\nc:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train.py in train(config_yaml, displayiters, saveiters, maxiters, max_to_keep)\r\n    140         current_lr = lr_gen.get_lr(it)\r\n    141         [_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],\r\n--> 142                                           feed_dict={learning_rate: current_lr})\r\n    143         cum_loss += loss_val\r\n    144         train_writer.add_summary(summary, it)\r\n\r\nc:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\client\\session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    898     try:\r\n    899       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 900                          run_metadata_ptr)\r\n    901       if run_metadata:\r\n    902         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\nc:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n   1133     if final_fetches or final_targets or (handle and feed_dict_tensor):\r\n   1134       results = self._do_run(handle, final_targets, final_fetches,\r\n-> 1135                              feed_dict_tensor, options, run_metadata)\r\n   1136     else:\r\n   1137       results = []\r\n\r\nc:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n   1314     if handle is None:\r\n   1315       return self._do_call(_run_fn, feeds, fetches, targets, options,\r\n-> 1316                            run_metadata)\r\n   1317     else:\r\n   1318       return self._do_call(_prun_fn, handle, feeds, fetches)\r\n\r\nc:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\r\n   1333         except KeyError:\r\n   1334           pass\r\n-> 1335       raise type(e)(node_def, op, message)\r\n   1336 \r\n   1337   def _extend_graph(self):\r\n\r\nResourceExhaustedError: OOM when allocating tensor with shape[1,2048,50,62] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc\r\n\t [[Node: resnet_v1_50/block4/unit_3/bottleneck_v1/conv3/Conv2D = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"SAME\", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](resnet_v1_50/block4/unit_3/bottleneck_v1/conv2/Relu, resnet_v1_50/block4/unit_3/bottleneck_v1/conv3/weights/read/_1247)]]\r\nHint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.\r\n\r\n\t [[Node: pose/part_pred/block4/stack/_1347 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_1430_pose/part_pred/block4/stack\", tensor_type=DT_INT32, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\nHint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.\r\n\r\n\r\nCaused by op 'resnet_v1_50/block4/unit_3/bottleneck_v1/conv3/Conv2D', defined at:\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\ipykernel_launcher.py\", line 16, in <module>\r\n    app.launch_new_instance()\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\traitlets\\config\\application.py\", line 658, in launch_instance\r\n    app.start()\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\ipykernel\\kernelapp.py\", line 505, in start\r\n    self.io_loop.start()\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tornado\\platform\\asyncio.py\", line 132, in start\r\n    self.asyncio_loop.run_forever()\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\asyncio\\base_events.py\", line 427, in run_forever\r\n    self._run_once()\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\asyncio\\base_events.py\", line 1440, in _run_once\r\n    handle._run()\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\asyncio\\events.py\", line 145, in _run\r\n    self._callback(*self._args)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tornado\\ioloop.py\", line 758, in _run_callback\r\n    ret = callback()\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tornado\\stack_context.py\", line 300, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tornado\\gen.py\", line 1233, in inner\r\n    self.run()\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tornado\\gen.py\", line 1147, in run\r\n    yielded = self.gen.send(value)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 357, in process_one\r\n    yield gen.maybe_future(dispatch(*args))\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tornado\\gen.py\", line 326, in wrapper\r\n    yielded = next(result)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 267, in dispatch_shell\r\n    yield gen.maybe_future(handler(stream, idents, msg))\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tornado\\gen.py\", line 326, in wrapper\r\n    yielded = next(result)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 534, in execute_request\r\n    user_expressions, allow_stdin,\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tornado\\gen.py\", line 326, in wrapper\r\n    yielded = next(result)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\ipykernel\\ipkernel.py\", line 294, in do_execute\r\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\ipykernel\\zmqshell.py\", line 536, in run_cell\r\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2683, in run_cell\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2793, in run_ast_nodes\r\n    if self.run_code(code, result):\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2847, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-9-9519d82efecc>\", line 1, in <module>\r\n    deeplabcut.train_network(path_config_file)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\training.py\", line 79, in train_network\r\n    train(str(poseconfigfile),displayiters,saveiters,maxiters,max_to_keep=max_snapshots_to_keep) #pass on path and file name for pose_cfg.yaml!\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train.py\", line 89, in train\r\n    losses = pose_net(cfg).train(batch)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\nnet\\pose_net.py\", line 100, in train\r\n    heads = self.get_net(batch[Batch.inputs])\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\nnet\\pose_net.py\", line 89, in get_net\r\n    net, end_points = self.extract_features(inputs)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\nnet\\pose_net.py\", line 62, in extract_features\r\n    global_pool=False, output_stride=16,is_training=False)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\contrib\\slim\\python\\slim\\nets\\resnet_v1.py\", line 274, in resnet_v1_50\r\n    scope=scope)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\contrib\\slim\\python\\slim\\nets\\resnet_v1.py\", line 207, in resnet_v1\r\n    net = resnet_utils.stack_blocks_dense(net, blocks, output_stride)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\contrib\\framework\\python\\ops\\arg_scope.py\", line 183, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\contrib\\slim\\python\\slim\\nets\\resnet_utils.py\", line 211, in stack_blocks_dense\r\n    net = block.unit_fn(net, rate=rate, **dict(unit, stride=1))\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\contrib\\framework\\python\\ops\\arg_scope.py\", line 183, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\contrib\\slim\\python\\slim\\nets\\resnet_v1.py\", line 121, in bottleneck\r\n    residual, depth, [1, 1], stride=1, activation_fn=None, scope='conv3')\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\contrib\\framework\\python\\ops\\arg_scope.py\", line 183, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\contrib\\layers\\python\\layers\\layers.py\", line 1049, in convolution\r\n    outputs = layer.apply(inputs)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\layers\\base.py\", line 828, in apply\r\n    return self.__call__(inputs, *args, **kwargs)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\layers\\base.py\", line 717, in __call__\r\n    outputs = self.call(inputs, *args, **kwargs)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\layers\\convolutional.py\", line 168, in call\r\n    outputs = self._convolution_op(inputs, self.kernel)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\ops\\nn_ops.py\", line 868, in __call__\r\n    return self.conv_op(inp, filter)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\ops\\nn_ops.py\", line 520, in __call__\r\n    return self.call(inp, filter)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\ops\\nn_ops.py\", line 204, in __call__\r\n    name=self.name)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\ops\\gen_nn_ops.py\", line 1042, in conv2d\r\n    data_format=data_format, dilations=dilations, name=name)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3392, in create_op\r\n    op_def=op_def)\r\n  File \"c:\\users\\sarit\\anaconda3\\envs\\saritenv\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1718, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[1,2048,50,62] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc\r\n\t [[Node: resnet_v1_50/block4/unit_3/bottleneck_v1/conv3/Conv2D = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"SAME\", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](resnet_v1_50/block4/unit_3/bottleneck_v1/conv2/Relu, resnet_v1_50/block4/unit_3/bottleneck_v1/conv3/weights/read/_1247)]]\r\nHint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.\r\n\r\n\t [[Node: pose/part_pred/block4/stack/_1347 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_1430_pose/part_pred/block4/stack\", tensor_type=DT_INT32, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\nHint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.\r\n\r\n\r\n\r\nI could't find what is the problem. Please help.\r\n\r\n\r\n\r\n\r\n\r\n","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/133/timeline","performed_via_github_app":null,"state_reason":"completed"}