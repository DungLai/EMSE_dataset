{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1212","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1212/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1212/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1212/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1212","id":874050267,"node_id":"MDU6SXNzdWU4NzQwNTAyNjc=","number":1212,"title":"Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR","user":{"login":"jmaicas","id":8972322,"node_id":"MDQ6VXNlcjg5NzIzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/8972322?v=4","gravatar_id":"","url":"https://api.github.com/users/jmaicas","html_url":"https://github.com/jmaicas","followers_url":"https://api.github.com/users/jmaicas/followers","following_url":"https://api.github.com/users/jmaicas/following{/other_user}","gists_url":"https://api.github.com/users/jmaicas/gists{/gist_id}","starred_url":"https://api.github.com/users/jmaicas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmaicas/subscriptions","organizations_url":"https://api.github.com/users/jmaicas/orgs","repos_url":"https://api.github.com/users/jmaicas/repos","events_url":"https://api.github.com/users/jmaicas/events{/privacy}","received_events_url":"https://api.github.com/users/jmaicas/received_events","type":"User","site_admin":false},"labels":[{"id":1010467338,"node_id":"MDU6TGFiZWwxMDEwNDY3MzM4","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/Installation","name":"Installation","color":"ecfca6","default":false,"description":""},{"id":2225445655,"node_id":"MDU6TGFiZWwyMjI1NDQ1NjU1","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/issue%20with%20non-DLC%20code","name":"issue with non-DLC code","color":"aa25db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-05-02T21:35:48Z","updated_at":"2021-05-09T17:12:06Z","closed_at":"2021-05-03T10:18:28Z","author_association":"NONE","active_lock_reason":null,"body":"Hi, I keep having the same issue that I tried to explain in https://github.com/DeepLabCut/DeepLabCut/issues/1200#issue-865209506. I am working in Ubuntu 18.04 with a Nvidia RTX 4000\r\n\r\nAfter trying the Docker and getting the same issue, I am back using the DLC-GPU environment, I still get the same problem when I try to train. \r\n\r\nRight now I came back to install Cuda 10.0 (included in the PATH in the .bashrc file) because that is the one is used by the DLC-GPU environment when I install it in miniconda.\r\n \r\n```\r\n$ nvcc -V\r\nnvcc: NVIDIA (R) Cuda compiler driver\r\nCopyright (c) 2005-2018 NVIDIA Corporation\r\nBuilt on Sat_Aug_25_21:08:01_CDT_2018\r\nCuda compilation tools, release 10.0, V10.0.130\r\n```\r\n\r\nDuring training, I opted for doing `allow_growth = True` because I saw it in this github issue. https://github.com/tensorflow/tensorflow/issues/24496\r\n\r\nHowever, it still does not work. \r\n\r\ndeeplabcut.train_network(path_config_file, shuffle=1, allow_growth=True, gputouse=0, displayiters=50,saveiters=20000, maxiters=50000)\r\n\r\n```\r\n2021-05-02 22:16:22.447624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/device:GPU:0 with 7018 MB memory) -> physical GPU (device: 0, name: NVIDIA Quadro RTX 4000, pci bus id: 0000:2d:00.0, compute capability: 7.5)\r\n2021-05-02 22:16:22.449495: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55d6db8d6fd0 executing computations on platform CUDA. Devices:\r\n2021-05-02 22:16:22.449516: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): NVIDIA Quadro RTX 4000, Compute Capability 7.5\r\n2021-05-02 22:16:29.122700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0\r\n2021-05-02 22:16:29.122776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2021-05-02 22:16:29.122783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 \r\n2021-05-02 22:16:29.122790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N \r\n2021-05-02 22:16:29.122871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7018 MB memory) -> physical GPU (device: 0, name: NVIDIA Quadro RTX 4000, pci bus id: 0000:2d:00.0, compute capability: 7.5)\r\n2021-05-02 22:16:37.593240: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2021-05-02 22:16:37.598426: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n```\r\nI also get this:\r\n\r\n```\r\nUnknownError (see above for traceback): Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[node resnet_v1_50/conv1/Conv2D (defined at /home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py:124) ]]\r\n\t [[node sigmoid_cross_entropy_loss/value (defined at /home/jorge/miniconda3/envs/DLC-GPU/lib/python3.7/site-packages/deeplabcut/pose_estimation_tensorflow/nnet/pose_net.py:283) ]]\r\n```\r\n","closed_by":{"login":"AlexEMG","id":20850270,"node_id":"MDQ6VXNlcjIwODUwMjcw","avatar_url":"https://avatars.githubusercontent.com/u/20850270?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexEMG","html_url":"https://github.com/AlexEMG","followers_url":"https://api.github.com/users/AlexEMG/followers","following_url":"https://api.github.com/users/AlexEMG/following{/other_user}","gists_url":"https://api.github.com/users/AlexEMG/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexEMG/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexEMG/subscriptions","organizations_url":"https://api.github.com/users/AlexEMG/orgs","repos_url":"https://api.github.com/users/AlexEMG/repos","events_url":"https://api.github.com/users/AlexEMG/events{/privacy}","received_events_url":"https://api.github.com/users/AlexEMG/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1212/timeline","performed_via_github_app":null,"state_reason":"completed"}