{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1321","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1321/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1321/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1321/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1321","id":920400851,"node_id":"MDU6SXNzdWU5MjA0MDA4NTE=","number":1321,"title":"Keypoints_only cannot draw skeleton in create_labeled_video","user":{"login":"tzeriver","id":6364271,"node_id":"MDQ6VXNlcjYzNjQyNzE=","avatar_url":"https://avatars.githubusercontent.com/u/6364271?v=4","gravatar_id":"","url":"https://api.github.com/users/tzeriver","html_url":"https://github.com/tzeriver","followers_url":"https://api.github.com/users/tzeriver/followers","following_url":"https://api.github.com/users/tzeriver/following{/other_user}","gists_url":"https://api.github.com/users/tzeriver/gists{/gist_id}","starred_url":"https://api.github.com/users/tzeriver/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzeriver/subscriptions","organizations_url":"https://api.github.com/users/tzeriver/orgs","repos_url":"https://api.github.com/users/tzeriver/repos","events_url":"https://api.github.com/users/tzeriver/events{/privacy}","received_events_url":"https://api.github.com/users/tzeriver/received_events","type":"User","site_admin":false},"labels":[{"id":880550034,"node_id":"MDU6TGFiZWw4ODA1NTAwMzQ=","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false},"assignees":[{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2021-06-14T13:13:43Z","updated_at":"2021-06-15T21:38:50Z","closed_at":"2021-06-15T21:38:50Z","author_association":"NONE","active_lock_reason":null,"body":"Moving from the forum post to here as requested. Original post: https://forum.image.sc/t/keypoints-only-cannot-draw-skeleton-in-create-labeled-video/53802\r\n\r\n**Your Operating system and DeepLabCut version**\r\n\r\nEnvironment: Google Colab\r\nDeepLabCut Version: 2.2rc2\r\n\r\n**Describe the problem**\r\n\r\nI’m trying to create labeled video with keypoints_only = True.\r\nI’m getting the following error when I set draw_skeleton = True:\r\n`/usr/local/lib/python3.7/dist-packages/deeplabcut/utils/make_labeled_video.py in create_labeled_video(config, videos, videotype, shuffle, trainingsetindex, filtered, fastmode, save_frames, keypoints_only, Frames2plot, displayedbodyparts, displayedindividuals, codec, outputframerate, destfolder, draw_skeleton, trailpoints, displaycropped, color_by, modelprefix, track_method)\r\n    509 \r\n    510     with Pool(min(os.cpu_count(), len(Videos))) as pool:\r\n--> 511         pool.map(func, Videos)\r\n    512 \r\n    513     os.chdir(start_path)\r\n\r\n/usr/lib/python3.7/multiprocessing/pool.py in map(self, func, iterable, chunksize)\r\n    266         in a list that is returned.\r\n    267         '''\r\n--> 268         return self._map_async(func, iterable, mapstar, chunksize).get()\r\n    269 \r\n    270     def starmap(self, func, iterable, chunksize=None):\r\n\r\n/usr/lib/python3.7/multiprocessing/pool.py in get(self, timeout)\r\n    655             return self._value\r\n    656         else:\r\n--> 657             raise self._value\r\n    658 \r\n    659     def _set(self, i, obj):\r\n\r\n/usr/lib/python3.7/multiprocessing/pool.py in worker()\r\n    119         job, i, func, args, kwds = task\r\n    120         try:\r\n--> 121             result = (True, func(*args, **kwds))\r\n    122         except Exception as e:\r\n    123             if wrap_exception and func is not _helper_reraises_exception:\r\n\r\n/usr/lib/python3.7/multiprocessing/pool.py in mapstar()\r\n     42 \r\n     43 def mapstar(args):\r\n---> 44     return list(map(*args))\r\n     45 \r\n     46 def starmapstar(args):\r\n\r\n/usr/local/lib/python3.7/dist-packages/deeplabcut/utils/make_labeled_video.py in proc_video()\r\n    609                     skeleton_color=skeleton_color,\r\n    610                     color_by=color_by,\r\n--> 611                     colormap=cfg[\"colormap\"],\r\n    612                 )\r\n    613             elif not fastmode:\r\n\r\n/usr/local/lib/python3.7/dist-packages/deeplabcut/utils/make_labeled_video.py in create_video_with_keypoints_only()\r\n    728     colors = cmap(map_)\r\n    729     scat.set_color(colors)\r\n--> 730     segs = coords[tuple(zip(*tuple([ind_links])))].swapaxes(0, 1) if ind_links else []\r\n    731     coll = LineCollection(segs, colors=skeleton_color, alpha=alpha)\r\n    732     ax.add_collection(coll)\r\n\r\nIndexError: too many indices for array`\r\n\r\nSetting keypoints_only = False, or setting draw_skeleton = False will both work just fine.\r\n\r\nChanging the number of body parts to display or number of individuals won’t solve the issue.\r\n\r\n**How to Reproduce the problem**\r\nSteps to reproduce the behavior:\r\nRun\r\n`deeplabcut.create_labeled_video(path_config_file,\r\n                                videofile_path_3, \r\n                                shuffle=shuffle, \r\n                                draw_skeleton=True, \r\n                                videotype=VideoType, \r\n                                save_frames=False,\r\n                                filtered=True, \r\n                                track_method = tracktype,\r\n                                keypoints_only=True,\r\n                                displayedbodyparts=['6-neck','13-upper back','14-mid back'])`\r\n","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1321/timeline","performed_via_github_app":null,"state_reason":"completed"}