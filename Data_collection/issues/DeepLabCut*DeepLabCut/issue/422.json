{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/422","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/422/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/422/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/422/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/422","id":494894739,"node_id":"MDU6SXNzdWU0OTQ4OTQ3Mzk=","number":422,"title":"Error during saving within analyze_video","user":{"login":"lolaBerkowitz","id":31447162,"node_id":"MDQ6VXNlcjMxNDQ3MTYy","avatar_url":"https://avatars.githubusercontent.com/u/31447162?v=4","gravatar_id":"","url":"https://api.github.com/users/lolaBerkowitz","html_url":"https://github.com/lolaBerkowitz","followers_url":"https://api.github.com/users/lolaBerkowitz/followers","following_url":"https://api.github.com/users/lolaBerkowitz/following{/other_user}","gists_url":"https://api.github.com/users/lolaBerkowitz/gists{/gist_id}","starred_url":"https://api.github.com/users/lolaBerkowitz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lolaBerkowitz/subscriptions","organizations_url":"https://api.github.com/users/lolaBerkowitz/orgs","repos_url":"https://api.github.com/users/lolaBerkowitz/repos","events_url":"https://api.github.com/users/lolaBerkowitz/events{/privacy}","received_events_url":"https://api.github.com/users/lolaBerkowitz/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"AlexEMG","id":20850270,"node_id":"MDQ6VXNlcjIwODUwMjcw","avatar_url":"https://avatars.githubusercontent.com/u/20850270?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexEMG","html_url":"https://github.com/AlexEMG","followers_url":"https://api.github.com/users/AlexEMG/followers","following_url":"https://api.github.com/users/AlexEMG/following{/other_user}","gists_url":"https://api.github.com/users/AlexEMG/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexEMG/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexEMG/subscriptions","organizations_url":"https://api.github.com/users/AlexEMG/orgs","repos_url":"https://api.github.com/users/AlexEMG/repos","events_url":"https://api.github.com/users/AlexEMG/events{/privacy}","received_events_url":"https://api.github.com/users/AlexEMG/received_events","type":"User","site_admin":false},"assignees":[{"login":"AlexEMG","id":20850270,"node_id":"MDQ6VXNlcjIwODUwMjcw","avatar_url":"https://avatars.githubusercontent.com/u/20850270?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexEMG","html_url":"https://github.com/AlexEMG","followers_url":"https://api.github.com/users/AlexEMG/followers","following_url":"https://api.github.com/users/AlexEMG/following{/other_user}","gists_url":"https://api.github.com/users/AlexEMG/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexEMG/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexEMG/subscriptions","organizations_url":"https://api.github.com/users/AlexEMG/orgs","repos_url":"https://api.github.com/users/AlexEMG/repos","events_url":"https://api.github.com/users/AlexEMG/events{/privacy}","received_events_url":"https://api.github.com/users/AlexEMG/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2019-09-17T22:59:25Z","updated_at":"2019-09-19T22:41:44Z","closed_at":"2019-09-19T22:41:44Z","author_association":"NONE","active_lock_reason":null,"body":"windows 10, Anaconda Env, DLC 2.0.5.1\r\n\r\nWe've been receiving errors for some videos during the saving portion of analyze_video. The errors are video specific (e.g. the below example). \r\n\r\nFor the below example, it seems as though the overall number of frames does not match the detected frames. Any reason as to why this might occur?\r\n\r\nHere is the below output from terminal: \r\n```\r\nRunning  R10Light\r\nUsing snapshot-1030000 for model F:\\Users\\BClarkLab\\Desktop\\Monica\\OF-Monica-2019-08-06\\dlc-models\\iteration-0\\OFAug6-trainset95shuffle1\r\nINFO:tensorflow:Restoring parameters from F:\\Users\\BClarkLab\\Desktop\\Monica\\OF-Monica-2019-08-06\\dlc-models\\iteration-0\\OFAug6-trainset95shuffle1\\train\\snapshot-1030000\r\nINFO:tensorflow:Restoring parameters from F:\\Users\\BClarkLab\\Desktop\\Monica\\OF-Monica-2019-08-06\\dlc-models\\iteration-0\\OFAug6-trainset95shuffle1\\train\\snapshot-1030000\r\nAnalyzing all the videos in the directory\r\nStarting to analyze %  R10Light.mpg\r\nLoading  R10Light.mpg\r\nDuration of video [s]:  2387.85 , recorded with  29.97 fps!\r\nOverall # of frames:  71564  found with (before cropping) frame dimensions:  720 480\r\nStarting to extract posture\r\n72215it [3:58:37,  5.01it/s]                                                                                           Detected frames:  71565\r\n\r\nSaving results in ....\r\n---------------------------------------------------------------------------\r\nFileNotFoundError                         Traceback (most recent call last)\r\n~\\Anaconda3\\envs\\dlc-windowsGPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\predict_videos.py in AnalyzeVideo(video, DLCscorer, trainFraction, cfg, dlc_cfg, sess, inputs, outputs, pdindex, save_as_csv, destfolder)\r\n    262         # Attempt to load data...\r\n--> 263         pd.read_hdf(dataname)\r\n    264         print(\"Video already analyzed!\", dataname)\r\n\r\n~\\Anaconda3\\envs\\dlc-windowsGPU\\lib\\site-packages\\pandas\\io\\pytables.py in read_hdf(path_or_buf, key, mode, **kwargs)\r\n    370             raise compat.FileNotFoundError(\r\n--> 371                 'File %s does not exist' % path_or_buf)\r\n    372\r\n\r\nFileNotFoundError: File .\\R10LightDeepCut_resnet50_OFAug6shuffle1_1030000.h5 does not exist\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nValueError                                Traceback (most recent call last)\r\n~\\Anaconda3\\envs\\dlc-windowsGPU\\lib\\site-packages\\pandas\\core\\internals.py in create_block_manager_from_blocks(blocks, axes)\r\n   4858\r\n-> 4859         mgr = BlockManager(blocks, axes)\r\n   4860         mgr._consolidate_inplace()\r\n\r\n~\\Anaconda3\\envs\\dlc-windowsGPU\\lib\\site-packages\\pandas\\core\\internals.py in __init__(self, blocks, axes, do_integrity_check)\r\n   3281         if do_integrity_check:\r\n-> 3282             self._verify_integrity()\r\n   3283\r\n\r\n~\\Anaconda3\\envs\\dlc-windowsGPU\\lib\\site-packages\\pandas\\core\\internals.py in _verify_integrity(self)\r\n   3492             if block._verify_integrity and block.shape[1:] != mgr_shape[1:]:\r\n-> 3493                 construction_error(tot_items, block.shape[1:], self.axes)\r\n   3494         if len(self.items) != tot_items:\r\n\r\n~\\Anaconda3\\envs\\dlc-windowsGPU\\lib\\site-packages\\pandas\\core\\internals.py in construction_error(tot_items, block_shape, axes, e)\r\n   4842     raise ValueError(\"Shape of passed values is {0}, indices imply {1}\".format(\r\n-> 4843         passed, implied))\r\n   4844\r\n\r\nValueError: Shape of passed values is (12, 71564), indices imply (12, 71565)\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-6-3709687ab414> in <module>\r\n      1 for i in range(0,len(vidName)):\r\n      2     print(\"Running \", vidName[i])\r\n----> 3     deeplabcut.analyze_videos(config_path, [vidPath + \"\\\\\" + vidName[i]],shuffle=1,videotype='.mpg',save_as_csv=True)\r\n      4\r\n\r\n~\\Anaconda3\\envs\\dlc-windowsGPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\predict_videos.py in analyze_videos(config, videos, videotype, shuffle, trainingsetindex, gputouse, save_as_csv, destfolder)\r\n    151         #looping over videos\r\n    152         for video in Videos:\r\n--> 153             AnalyzeVideo(video,DLCscorer,trainFraction,cfg,dlc_cfg,sess,inputs, outputs,pdindex,save_as_csv, destfolder)\r\n    154\r\n    155     os.chdir(str(start_path))\r\n\r\n~\\Anaconda3\\envs\\dlc-windowsGPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\predict_videos.py in AnalyzeVideo(video, DLCscorer, trainFraction, cfg, dlc_cfg, sess, inputs, outputs, pdindex, save_as_csv, destfolder)\r\n    308\r\n    309         print(\"Saving results in %s...\" %(Path(video).parents[0]))\r\n--> 310         auxiliaryfunctions.SaveData(PredicteData[:nframes,:], metadata, dataname, pdindex, range(nframes),save_as_csv)\r\n    311\r\n    312 def GetPosesofFrames(cfg,dlc_cfg, sess, inputs, outputs,directory,framelist,nframes,batchsize,rgb):\r\n\r\n~\\Anaconda3\\envs\\dlc-windowsGPU\\lib\\site-packages\\deeplabcut\\utils\\auxiliaryfunctions.py in SaveData(PredicteData, metadata, dataname, pdindex, imagenames, save_as_csv)\r\n    147 def SaveData(PredicteData, metadata, dataname, pdindex, imagenames,save_as_csv):\r\n    148     ''' Save predicted data as h5 file and metadata as pickle file; created by predict_videos.py '''\r\n--> 149     DataMachine = pd.DataFrame(PredicteData, columns=pdindex, index=imagenames)\r\n    150     DataMachine.to_hdf(dataname, 'df_with_missing', format='table', mode='w')\r\n    151     if save_as_csv:\r\n\r\n~\\Anaconda3\\envs\\dlc-windowsGPU\\lib\\site-packages\\pandas\\core\\frame.py in __init__(self, data, index, columns, dtype, copy)\r\n    377             else:\r\n    378                 mgr = self._init_ndarray(data, index, columns, dtype=dtype,\r\n--> 379                                          copy=copy)\r\n    380         elif isinstance(data, (list, types.GeneratorType)):\r\n    381             if isinstance(data, types.GeneratorType):\r\n\r\n~\\Anaconda3\\envs\\dlc-windowsGPU\\lib\\site-packages\\pandas\\core\\frame.py in _init_ndarray(self, values, index, columns, dtype, copy)\r\n    534             values = maybe_infer_to_datetimelike(values)\r\n    535\r\n--> 536         return create_block_manager_from_blocks([values], [columns, index])\r\n    537\r\n    538     @property\r\n\r\n~\\Anaconda3\\envs\\dlc-windowsGPU\\lib\\site-packages\\pandas\\core\\internals.py in create_block_manager_from_blocks(blocks, axes)\r\n   4864         blocks = [getattr(b, 'values', b) for b in blocks]\r\n   4865         tot_items = sum(b.shape[0] for b in blocks)\r\n-> 4866         construction_error(tot_items, blocks[0].shape[1:], axes, e)\r\n   4867\r\n   4868\r\n\r\n~\\Anaconda3\\envs\\dlc-windowsGPU\\lib\\site-packages\\pandas\\core\\internals.py in construction_error(tot_items, block_shape, axes, e)\r\n   4841         raise ValueError(\"Empty data passed with indices specified.\")\r\n   4842     raise ValueError(\"Shape of passed values is {0}, indices imply {1}\".format(\r\n-> 4843         passed, implied))\r\n   4844\r\n   4845\r\n\r\nValueError: Shape of passed values is (12, 71564), indices imply (12, 71565)\r\n\r\nIn [7]:\r\n```","closed_by":{"login":"AlexEMG","id":20850270,"node_id":"MDQ6VXNlcjIwODUwMjcw","avatar_url":"https://avatars.githubusercontent.com/u/20850270?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexEMG","html_url":"https://github.com/AlexEMG","followers_url":"https://api.github.com/users/AlexEMG/followers","following_url":"https://api.github.com/users/AlexEMG/following{/other_user}","gists_url":"https://api.github.com/users/AlexEMG/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexEMG/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexEMG/subscriptions","organizations_url":"https://api.github.com/users/AlexEMG/orgs","repos_url":"https://api.github.com/users/AlexEMG/repos","events_url":"https://api.github.com/users/AlexEMG/events{/privacy}","received_events_url":"https://api.github.com/users/AlexEMG/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/422/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/422/timeline","performed_via_github_app":null,"state_reason":"completed"}