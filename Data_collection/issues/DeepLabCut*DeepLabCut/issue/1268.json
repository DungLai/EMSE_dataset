{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1268","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1268/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1268/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1268/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1268","id":900705782,"node_id":"MDU6SXNzdWU5MDA3MDU3ODI=","number":1268,"title":"error with create dataset and training when tried to upgrade to 2.2 ","user":{"login":"Shachafbe","id":53897118,"node_id":"MDQ6VXNlcjUzODk3MTE4","avatar_url":"https://avatars.githubusercontent.com/u/53897118?v=4","gravatar_id":"","url":"https://api.github.com/users/Shachafbe","html_url":"https://github.com/Shachafbe","followers_url":"https://api.github.com/users/Shachafbe/followers","following_url":"https://api.github.com/users/Shachafbe/following{/other_user}","gists_url":"https://api.github.com/users/Shachafbe/gists{/gist_id}","starred_url":"https://api.github.com/users/Shachafbe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Shachafbe/subscriptions","organizations_url":"https://api.github.com/users/Shachafbe/orgs","repos_url":"https://api.github.com/users/Shachafbe/repos","events_url":"https://api.github.com/users/Shachafbe/events{/privacy}","received_events_url":"https://api.github.com/users/Shachafbe/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-05-25T11:56:26Z","updated_at":"2021-05-25T16:01:46Z","closed_at":"2021-05-25T16:01:46Z","author_association":"NONE","active_lock_reason":null,"body":"**Windows 10, anaconda, deep lab cut 2.2rc1 with GUI for GPU with GeForce RTX 2080 Ti **\r\n\r\n\r\n**Describe the problem**\r\nHey all,\r\nI'm using DLC for 2 years now. while I was working on a multianimals project that runs perfectly last week, I tried to upgrade to DLC2.2  (and I think might accidentally upgrade cudnn as well, the version now is 7.6.5.32).  \r\nIn the beginning, it gave me a memory error when training. cropping and allow_growth didn't help. \r\nI did notice that the Cudetoolkit version appears on anaconda is 10.2.89. I wasn't sure if that might cause the problem,  so I tried to delete and reinstall 10.0 version and recreated the environment (restarting after every step).\r\n\r\n**Now it doesn't even let me create a training dataset and display the error :**\r\n\"IndexError: index 0 is out of bounds for axis 0 with size 0\"\r\n \r\n**when trying to train with pre existed data set:**\r\n```python\r\nInternalError: 2 root error(s) found.\r\n  (0) Internal: cuDNN launch failure : input shape([32,512,20,34]) filter shape([3,3,512,512])\r\n         [[node resnet_v1_50/block4/unit_1/bottleneck_v1/conv2/Conv2D (defined at C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU1\\lib\\site-packages\\tensorflow_core\\python\\framework\\ops.py:1748) ]]\r\n         [[absolute_difference/weighted_loss/assert_broadcastable/is_valid_shape/has_valid_nonscalar_shape/has_invalid_dims/_595]]\r\n  (1) Internal: cuDNN launch failure : input shape([32,512,20,34]) filter shape([3,3,512,512])\r\n         [[node resnet_v1_50/block4/unit_1/bottleneck_v1/conv2/Conv2D (defined at C:\\ProgramData\\Anaconda3\\envs\\DLC-GPU1\\lib\\site-packages\\tensorflow_core\\python\\framework\\ops.py:1748) ]]\r\n0 successful operations.\r\n0 derived errors ignored.\r\n```\r\n\r\n\r\n\r\nI would appreciate any help!\r\nThanks,\r\nShachaf.\r\n\r\n\r\n\r\n\r\n\r\nfull error code for creating data set:\r\n```python\r\nF:\\thirdcolony\\colony3try2-shachaf-2021-01-16\\labeled-data\\col3D1_cropped  already exists!\r\nF:\\thirdcolony\\colony3try2-shachaf-2021-01-16\\labeled-data\\col3L1_cropped  already exists!\r\nF:\\thirdcolony\\colony3try2-shachaf-2021-01-16\\training-datasets\\iteration-0\\UnaugmentedDataSet_colony3try2Jan16  already exists!\r\n---------------------------------------------------------------------------\r\nIndexError                                Traceback (most recent call last)\r\n~\\.conda\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\gui\\create_training_dataset.py in create_training_dataset(self, event)\r\n    381                 num_shuffles,\r\n    382                 Shuffles=[self.shuffle.GetValue()],\r\n--> 383                 net_type=self.net_choice.GetValue(),\r\n    384             )\r\n    385         else:\r\n\r\n~\\.conda\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\generate_training_dataset\\multiple_individuals_trainingsetmanipulation.py in create_multianimaltraining_dataset(config, num_shuffles, Shuffles, windows2linux, net_type, numdigits)\r\n     79\r\n     80     Data = trainingsetmanipulation.merge_annotateddatasets(\r\n---> 81         cfg, full_training_path, windows2linux\r\n     82     )\r\n     83     if Data is None:\r\n\r\n~\\.conda\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\generate_training_dataset\\trainingsetmanipulation.py in merge_annotateddatasets(cfg, trainingsetfolder_full, windows2linux)\r\n    619     # Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)\r\n    620     # but the paths are in windows format...\r\n--> 621     windowspath = \"\\\\\" in AnnotationData.index[0]\r\n    622     if os.name != \"nt\" and windowspath and not windows2linux:\r\n    623         print(\r\n\r\n~\\.conda\\envs\\DLC-GPU\\lib\\site-packages\\pandas\\core\\indexes\\base.py in __getitem__(self, key)\r\n   4295         if is_scalar(key):\r\n   4296             key = com.cast_scalar_indexer(key, warn_float=True)\r\n-> 4297             return getitem(key)\r\n   4298\r\n   4299         if isinstance(key, slice):\r\n\r\nIndexError: index 0 is out of bounds for axis 0 with size 0\r\n```","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1268/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1268/timeline","performed_via_github_app":null,"state_reason":"completed"}