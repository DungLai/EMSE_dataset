{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1302","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1302/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1302/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1302/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1302","id":910624970,"node_id":"MDU6SXNzdWU5MTA2MjQ5NzA=","number":1302,"title":"maDLC2.2rc2: index error during re-training","user":{"login":"deepbraincut","id":75436015,"node_id":"MDQ6VXNlcjc1NDM2MDE1","avatar_url":"https://avatars.githubusercontent.com/u/75436015?v=4","gravatar_id":"","url":"https://api.github.com/users/deepbraincut","html_url":"https://github.com/deepbraincut","followers_url":"https://api.github.com/users/deepbraincut/followers","following_url":"https://api.github.com/users/deepbraincut/following{/other_user}","gists_url":"https://api.github.com/users/deepbraincut/gists{/gist_id}","starred_url":"https://api.github.com/users/deepbraincut/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepbraincut/subscriptions","organizations_url":"https://api.github.com/users/deepbraincut/orgs","repos_url":"https://api.github.com/users/deepbraincut/repos","events_url":"https://api.github.com/users/deepbraincut/events{/privacy}","received_events_url":"https://api.github.com/users/deepbraincut/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false},"assignees":[{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2021-06-03T15:45:40Z","updated_at":"2021-06-15T16:45:47Z","closed_at":"2021-06-15T16:45:47Z","author_association":"NONE","active_lock_reason":null,"body":"Thanks for opening this issue, and thanks for using DeepLabCut (we hope you are enjoying it ;). Please fill out the template completely, including the full \"traceback\" and input code that you ran to hit this error.\r\n\r\n**Your Operating system and DeepLabCut version**\r\n\r\nHi DLC team,\r\n\r\nI am using windows10, DLC-GPU, DLC Anaconda, 2.2rc2.\r\n\r\nI've created training set and refined tracklets using DLC2.2rc1. and upgraded to DLC2.2rc2 and tried to expend the training set. \r\nI've corrected config files for identity==true for the new training set (for the first data set I did not changed it to true), and had to changed cropping size to create the new training set. I did not change any other options in GUI.\r\nAfter I changed cropping size, I could create training set and checked there is a new folder iteration-1, but when I tried to start new training, there is an index error but still continues until showing up \"starting multi-animal training..\" I waited for hours but training did not started. I tried to delete the new folder and started from the creating a new set, did not work and had the same error. \r\nCould you check what is the problems? \r\nPlease complete the following information about your system:\r\n\r\n\r\n\r\n\r\n<details><summary>Code output</summary><p>\r\n\r\n```python\r\n(DLC-GPU) C:\\Users\\sahay>python -m deeplabcut\r\nC:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\dtypes.py:526: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\r\nC:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\dtypes.py:527: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\r\nC:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\dtypes.py:528: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\r\nC:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\dtypes.py:529: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\r\nC:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\dtypes.py:530: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\r\nC:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\dtypes.py:535: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\r\nStarting GUI...\r\ncurrently DLCRNet is only supported in multi-animal mode\r\nYou can now check the labels, using 'check_labels' before proceeding. Then,  you can use the function 'create_training_dataset' to create the training dataset.\r\nFound new frames..\r\nChecking labels if they are outside the image\r\nA training dataset file is already found for this video. The refined machine labels are merged to this data!\r\nMerged data sets and updated refinement iteration to 1.\r\nNow you can create a new training set for the expanded annotated images (use create_training_dataset).\r\n 19%|███████████████▋                                                                 | 57/295 [01:47<07:29,  1.89s/it]\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\gui\\create_training_dataset.py\", line 376, in create_training_dataset\r\n    self.config, n_crops, (height, width), userfeedback\r\n  File \"C:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\generate_training_dataset\\trainingsetmanipulation.py\", line 350, in cropimagesandlabels\r\n    raise ValueError(\"Crop dimensions are larger than image size\")\r\nValueError: Crop dimensions are larger than image size\r\nD:\\DLC\\MashBax_sampling_2mice-ac-2021-05-19\\labeled-data\\Trial1_2020-11-18-092624-0000_cropped  already exists!\r\n100%|████████████████████████████████████████████████████████████████████████████████| 238/238 [01:40<00:00,  2.36it/s]\r\n100%|██████████████████████████████████████████████████████████████████████████████████| 68/68 [00:28<00:00,  2.42it/s]\r\n100%|██████████████████████████████████████████████████████████████████████████████████| 20/20 [00:09<00:00,  2.11it/s]\r\n100%|██████████████████████████████████████████████████████████████████████████████████| 20/20 [00:08<00:00,  2.29it/s]\r\n100%|██████████████████████████████████████████████████████████████████████████████████| 20/20 [00:09<00:00,  2.13it/s]\r\nUtilizing the following graph: [[0, 1], [0, 2], [0, 3], [0, 4], [0, 5], [0, 6], [1, 2], [1, 3], [1, 4], [1, 5], [1, 6], [2, 3], [2, 4], [2, 5], [2, 6], [3, 4], [3, 5], [3, 6], [4, 5], [4, 6], [5, 6]]\r\nCreating training data for: Shuffle: 1 TrainFraction:  0.95\r\n100%|████████████████████████████████████████████████████████████████████████████| 3470/3470 [00:00<00:00, 5042.44it/s]\r\nThe training dataset is successfully created. Use the function 'train_network' to start training. Happy training!\r\nSelecting multi-animal trainer\r\nConfig:\r\n{'all_joints': [[0], [1], [2], [3], [4], [5], [6]],\r\n 'all_joints_names': ['Nose',\r\n                      'LeftEar',\r\n                      'RightEar',\r\n                      'Center',\r\n                      'LeftLeg',\r\n                      'RightLeg',\r\n                      'Tail'],\r\n 'alpha_r': 0.02,\r\n 'batch_size': 8,\r\n 'clahe': True,\r\n 'claheratio': 0.1,\r\n 'crop_pad': 0,\r\n 'cropratio': 0.4,\r\n 'dataset': 'training-datasets\\\\iteration-1\\\\UnaugmentedDataSet_MashBax_sampling_2miceMay19\\\\MashBax_sampling_2mice_ac95shuffle1.pickle',\r\n 'dataset_type': 'multi-animal-imgaug',\r\n 'decay_steps': 30000,\r\n 'deterministic': False,\r\n 'display_iters': 500,\r\n 'edge': False,\r\n 'emboss': {'alpha': [0.0, 1.0], 'embossratio': 0.1, 'strength': [0.5, 1.5]},\r\n 'fg_fraction': 0.25,\r\n 'global_scale': 0.8,\r\n 'histeq': True,\r\n 'histeqratio': 0.1,\r\n 'init_weights': 'C:\\\\Users\\\\sahay\\\\Anaconda3\\\\envs\\\\DLC-GPU\\\\lib\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt',\r\n 'intermediate_supervision': False,\r\n 'intermediate_supervision_layer': 12,\r\n 'location_refinement': True,\r\n 'locref_huber_loss': True,\r\n 'locref_loss_weight': 0.05,\r\n 'locref_stdev': 7.2801,\r\n 'log_dir': 'log',\r\n 'lr_init': 0.0005,\r\n 'max_input_size': 1500,\r\n 'mean_pixel': [123.68, 116.779, 103.939],\r\n 'metadataset': 'training-datasets\\\\iteration-1\\\\UnaugmentedDataSet_MashBax_sampling_2miceMay19\\\\Documentation_data-MashBax_sampling_2mice_95shuffle1.pickle',\r\n 'min_input_size': 64,\r\n 'mirror': False,\r\n 'multi_stage': False,\r\n 'multi_step': [[0.0001, 7500], [5e-05, 12000], [1e-05, 200000]],\r\n 'net_type': 'resnet_50',\r\n 'num_idchannel': 2,\r\n 'num_joints': 7,\r\n 'num_limbs': 21,\r\n 'optimizer': 'adam',\r\n 'pafwidth': 20,\r\n 'pairwise_huber_loss': False,\r\n 'pairwise_loss_weight': 0.1,\r\n 'pairwise_predict': False,\r\n 'partaffinityfield_graph': [[0, 1],\r\n                             [0, 2],\r\n                             [0, 3],\r\n                             [0, 4],\r\n                             [0, 5],\r\n                             [0, 6],\r\n                             [1, 2],\r\n                             [1, 3],\r\n                             [1, 4],\r\n                             [1, 5],\r\n                             [1, 6],\r\n                             [2, 3],\r\n                             [2, 4],\r\n                             [2, 5],\r\n                             [2, 6],\r\n                             [3, 4],\r\n                             [3, 5],\r\n                             [3, 6],\r\n                             [4, 5],\r\n                             [4, 6],\r\n                             [5, 6]],\r\n 'partaffinityfield_predict': True,\r\n 'pos_dist_thresh': 17,\r\n 'project_path': 'D:\\\\DLC\\\\MashBax_sampling_2mice-ac-2021-05-19',\r\n 'regularize': False,\r\n 'rotation': 25,\r\n 'rotratio': 0.4,\r\n 'save_iters': 10000,\r\n 'scale_jitter_lo': 0.5,\r\n 'scale_jitter_up': 1.25,\r\n 'scoremap_dir': 'test',\r\n 'sharpen': False,\r\n 'sharpenratio': 0.3,\r\n 'shuffle': True,\r\n 'snapshot_prefix': 'D:\\\\DLC\\\\MashBax_sampling_2mice-ac-2021-05-19\\\\dlc-models\\\\iteration-1\\\\MashBax_sampling_2miceMay19-trainset95shuffle1\\\\train\\\\snapshot',\r\n 'stride': 8.0,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001}\r\nActivating limb prediction...\r\nStarting with multi-animal imgaug + adam pose-dataset loader.\r\nBatch Size is 8\r\nGetting specs: multi-animal-imgaug Number of Limbs: 21 No. of Joints: 7\r\nInitializing ResNet\r\nLoading ImageNet-pretrained resnet_50\r\n2021-06-02 16:45:47.409689: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2\r\n2021-06-02 16:45:47.512329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties:\r\nname: GeForce RTX 2060 SUPER major: 7 minor: 5 memoryClockRate(GHz): 1.65\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 8.00GiB freeMemory: 7.02GiB\r\n2021-06-02 16:45:47.512626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0\r\n2021-06-02 16:45:49.122163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2021-06-02 16:45:49.122216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0\r\n2021-06-02 16:45:49.122425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N\r\n2021-06-02 16:45:49.124804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6736 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5)\r\nException in thread Thread-3:\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\threading.py\", line 926, in _bootstrap_inner\r\n    self.run()\r\n  File \"C:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\threading.py\", line 870, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"C:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train_multianimal.py\", line 76, in load_and_enqueue\r\n    batch_np = dataset.next_batch()\r\n  File \"C:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\dataset\\pose_multianimal_imgaug.py\", line 279, in next_batch\r\n    joint_ids, batch_joints, data_items, sm_size, image_shape\r\n  File \"C:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\dataset\\pose_multianimal_imgaug.py\", line 222, in get_targetmaps_update\r\n    joint_ids[i], [joints[i]], data_items[i], sm_size, scale\r\n  File \"C:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\dataset\\pose_multianimal_imgaug.py\", line 393, in compute_target_part_scoremap_numpy\r\n    joint_ids = joint_id[person_id].copy()\r\nIndexError: list index out of range\r\n\r\nMax_iters overwritten as 200000\r\nDisplay_iters overwritten as 1000\r\nSave_iters overwritten as 50000\r\nTraining parameters:\r\n{'stride': 8.0, 'weigh_part_predictions': False, 'weigh_negatives': False, 'fg_fraction': 0.25, 'mean_pixel': [123.68, 116.779, 103.939], 'shuffle': True, 'snapshot_prefix': 'D:\\\\DLC\\\\MashBax_sampling_2mice-ac-2021-05-19\\\\dlc-models\\\\iteration-1\\\\MashBax_sampling_2miceMay19-trainset95shuffle1\\\\train\\\\snapshot', 'log_dir': 'log', 'global_scale': 0.8, 'location_refinement': True, 'locref_stdev': 7.2801, 'locref_loss_weight': 0.05, 'locref_huber_loss': True, 'optimizer': 'adam', 'intermediate_supervision': False, 'intermediate_supervision_layer': 12, 'regularize': False, 'weight_decay': 0.0001, 'crop_pad': 0, 'scoremap_dir': 'test', 'batch_size': 8, 'dataset_type': 'multi-animal-imgaug', 'deterministic': False, 'mirror': False, 'pairwise_huber_loss': False, 'weigh_only_present_joints': False, 'partaffinityfield_predict': True, 'pairwise_predict': True, 'all_joints': [[0], [1], [2], [3], [4], [5], [6]], 'all_joints_names': ['Nose', 'LeftEar', 'RightEar', 'Center', 'LeftLeg', 'RightLeg', 'Tail'], 'alpha_r': 0.02, 'clahe': True, 'claheratio': 0.1, 'cropratio': 0.4, 'dataset': 'training-datasets\\\\iteration-1\\\\UnaugmentedDataSet_MashBax_sampling_2miceMay19\\\\MashBax_sampling_2mice_ac95shuffle1.pickle', 'decay_steps': 30000, 'display_iters': 500, 'edge': False, 'emboss': {'alpha': [0.0, 1.0], 'embossratio': 0.1, 'strength': [0.5, 1.5]}, 'histeq': True, 'histeqratio': 0.1, 'init_weights': 'C:\\\\Users\\\\sahay\\\\Anaconda3\\\\envs\\\\DLC-GPU\\\\lib\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt', 'lr_init': 0.0005, 'max_input_size': 1500, 'metadataset': 'training-datasets\\\\iteration-1\\\\UnaugmentedDataSet_MashBax_sampling_2miceMay19\\\\Documentation_data-MashBax_sampling_2mice_95shuffle1.pickle', 'min_input_size': 64, 'multi_stage': False, 'multi_step': [[0.0001, 7500], [5e-05, 12000], [1e-05, 200000]], 'net_type': 'resnet_50', 'num_idchannel': 2, 'num_joints': 7, 'num_limbs': 21, 'pafwidth': 20, 'pairwise_loss_weight': 0.1, 'partaffinityfield_graph': [[0, 1], [0, 2], [0, 3], [0, 4], [0, 5], [0, 6], [1, 2], [1, 3], [1, 4], [1, 5], [1, 6], [2, 3], [2, 4], [2, 5], [2, 6], [3, 4], [3, 5], [3, 6], [4, 5], [4, 6], [5, 6]], 'pos_dist_thresh': 17, 'project_path': 'D:\\\\DLC\\\\MashBax_sampling_2mice-ac-2021-05-19', 'rotation': 25, 'rotratio': 0.4, 'save_iters': 10000, 'scale_jitter_lo': 0.5, 'scale_jitter_up': 1.25, 'sharpen': False, 'sharpenratio': 0.3}\r\nStarting multi-animal training....\r\n\r\n(DLC-GPU) C:\\Users\\sahay>python -m deeplabcut\r\nC:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\dtypes.py:526: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\r\nC:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\dtypes.py:527: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\r\nC:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\dtypes.py:528: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\r\nC:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\dtypes.py:529: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\r\nC:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\dtypes.py:530: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\r\nC:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\dtypes.py:535: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\r\nStarting GUI...\r\ncurrently DLCRNet is only supported in multi-animal mode\r\nSelecting multi-animal trainer\r\nConfig:\r\n{'all_joints': [[0], [1], [2], [3], [4], [5], [6]],\r\n 'all_joints_names': ['Nose',\r\n                      'LeftEar',\r\n                      'RightEar',\r\n                      'Center',\r\n                      'LeftLeg',\r\n                      'RightLeg',\r\n                      'Tail'],\r\n 'alpha_r': 0.02,\r\n 'batch_size': 8,\r\n 'clahe': True,\r\n 'claheratio': 0.1,\r\n 'crop_pad': 0,\r\n 'cropratio': 0.4,\r\n 'dataset': 'training-datasets\\\\iteration-1\\\\UnaugmentedDataSet_MashBax_sampling_2miceMay19\\\\MashBax_sampling_2mice_ac95shuffle1.pickle',\r\n 'dataset_type': 'multi-animal-imgaug',\r\n 'decay_steps': 30000,\r\n 'deterministic': False,\r\n 'display_iters': 500,\r\n 'edge': False,\r\n 'emboss': {'alpha': [0.0, 1.0], 'embossratio': 0.1, 'strength': [0.5, 1.5]},\r\n 'fg_fraction': 0.25,\r\n 'global_scale': 0.8,\r\n 'histeq': True,\r\n 'histeqratio': 0.1,\r\n 'init_weights': 'C:\\\\Users\\\\sahay\\\\Anaconda3\\\\envs\\\\DLC-GPU\\\\lib\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt',\r\n 'intermediate_supervision': False,\r\n 'intermediate_supervision_layer': 12,\r\n 'location_refinement': True,\r\n 'locref_huber_loss': True,\r\n 'locref_loss_weight': 0.05,\r\n 'locref_stdev': 7.2801,\r\n 'log_dir': 'log',\r\n 'lr_init': 0.0005,\r\n 'max_input_size': 1500,\r\n 'mean_pixel': [123.68, 116.779, 103.939],\r\n 'metadataset': 'training-datasets\\\\iteration-1\\\\UnaugmentedDataSet_MashBax_sampling_2miceMay19\\\\Documentation_data-MashBax_sampling_2mice_95shuffle1.pickle',\r\n 'min_input_size': 64,\r\n 'mirror': False,\r\n 'multi_stage': False,\r\n 'multi_step': [[0.0001, 7500], [5e-05, 12000], [1e-05, 200000]],\r\n 'net_type': 'resnet_50',\r\n 'num_idchannel': 2,\r\n 'num_joints': 7,\r\n 'num_limbs': 21,\r\n 'optimizer': 'adam',\r\n 'pafwidth': 20,\r\n 'pairwise_huber_loss': False,\r\n 'pairwise_loss_weight': 0.1,\r\n 'pairwise_predict': False,\r\n 'partaffinityfield_graph': [[0, 1],\r\n                             [0, 2],\r\n                             [0, 3],\r\n                             [0, 4],\r\n                             [0, 5],\r\n                             [0, 6],\r\n                             [1, 2],\r\n                             [1, 3],\r\n                             [1, 4],\r\n                             [1, 5],\r\n                             [1, 6],\r\n                             [2, 3],\r\n                             [2, 4],\r\n                             [2, 5],\r\n                             [2, 6],\r\n                             [3, 4],\r\n                             [3, 5],\r\n                             [3, 6],\r\n                             [4, 5],\r\n                             [4, 6],\r\n                             [5, 6]],\r\n 'partaffinityfield_predict': True,\r\n 'pos_dist_thresh': 17,\r\n 'project_path': 'D:\\\\DLC\\\\MashBax_sampling_2mice-ac-2021-05-19',\r\n 'regularize': False,\r\n 'rotation': 25,\r\n 'rotratio': 0.4,\r\n 'save_iters': 10000,\r\n 'scale_jitter_lo': 0.5,\r\n 'scale_jitter_up': 1.25,\r\n 'scoremap_dir': 'test',\r\n 'sharpen': False,\r\n 'sharpenratio': 0.3,\r\n 'shuffle': True,\r\n 'snapshot_prefix': 'D:\\\\DLC\\\\MashBax_sampling_2mice-ac-2021-05-19\\\\dlc-models\\\\iteration-1\\\\MashBax_sampling_2miceMay19-trainset95shuffle1\\\\train\\\\snapshot',\r\n 'stride': 8.0,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001}\r\nActivating limb prediction...\r\nStarting with multi-animal imgaug + adam pose-dataset loader.\r\nBatch Size is 8\r\nGetting specs: multi-animal-imgaug Number of Limbs: 21 No. of Joints: 7\r\nInitializing ResNet\r\nLoading ImageNet-pretrained resnet_50\r\n2021-06-03 11:22:16.818135: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2\r\n2021-06-03 11:22:16.896120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties:\r\nname: GeForce RTX 2060 SUPER major: 7 minor: 5 memoryClockRate(GHz): 1.65\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 8.00GiB freeMemory: 7.02GiB\r\n2021-06-03 11:22:16.896279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0\r\n2021-06-03 11:22:17.137498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2021-06-03 11:22:17.137566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0\r\n2021-06-03 11:22:17.138089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N\r\n2021-06-03 11:22:17.138330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6736 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2060 SUPER, pci bus id: 0000:01:00.0, compute capability: 7.5)\r\nException in thread Thread-1:\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\threading.py\", line 926, in _bootstrap_inner\r\n    self.run()\r\n  File \"C:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\threading.py\", line 870, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"C:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train_multianimal.py\", line 76, in load_and_enqueue\r\n    batch_np = dataset.next_batch()\r\n  File \"C:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\dataset\\pose_multianimal_imgaug.py\", line 279, in next_batch\r\n    joint_ids, batch_joints, data_items, sm_size, image_shape\r\n  File \"C:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\dataset\\pose_multianimal_imgaug.py\", line 222, in get_targetmaps_update\r\n    joint_ids[i], [joints[i]], data_items[i], sm_size, scale\r\n  File \"C:\\Users\\sahay\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\dataset\\pose_multianimal_imgaug.py\", line 393, in compute_target_part_scoremap_numpy\r\n    joint_ids = joint_id[person_id].copy()\r\nIndexError: list index out of range\r\n\r\nMax_iters overwritten as 200000\r\nDisplay_iters overwritten as 1000\r\nSave_iters overwritten as 50000\r\nTraining parameters:\r\n{'stride': 8.0, 'weigh_part_predictions': False, 'weigh_negatives': False, 'fg_fraction': 0.25, 'mean_pixel': [123.68, 116.779, 103.939], 'shuffle': True, 'snapshot_prefix': 'D:\\\\DLC\\\\MashBax_sampling_2mice-ac-2021-05-19\\\\dlc-models\\\\iteration-1\\\\MashBax_sampling_2miceMay19-trainset95shuffle1\\\\train\\\\snapshot', 'log_dir': 'log', 'global_scale': 0.8, 'location_refinement': True, 'locref_stdev': 7.2801, 'locref_loss_weight': 0.05, 'locref_huber_loss': True, 'optimizer': 'adam', 'intermediate_supervision': False, 'intermediate_supervision_layer': 12, 'regularize': False, 'weight_decay': 0.0001, 'crop_pad': 0, 'scoremap_dir': 'test', 'batch_size': 8, 'dataset_type': 'multi-animal-imgaug', 'deterministic': False, 'mirror': False, 'pairwise_huber_loss': False, 'weigh_only_present_joints': False, 'partaffinityfield_predict': True, 'pairwise_predict': True, 'all_joints': [[0], [1], [2], [3], [4], [5], [6]], 'all_joints_names': ['Nose', 'LeftEar', 'RightEar', 'Center', 'LeftLeg', 'RightLeg', 'Tail'], 'alpha_r': 0.02, 'clahe': True, 'claheratio': 0.1, 'cropratio': 0.4, 'dataset': 'training-datasets\\\\iteration-1\\\\UnaugmentedDataSet_MashBax_sampling_2miceMay19\\\\MashBax_sampling_2mice_ac95shuffle1.pickle', 'decay_steps': 30000, 'display_iters': 500, 'edge': False, 'emboss': {'alpha': [0.0, 1.0], 'embossratio': 0.1, 'strength': [0.5, 1.5]}, 'histeq': True, 'histeqratio': 0.1, 'init_weights': 'C:\\\\Users\\\\sahay\\\\Anaconda3\\\\envs\\\\DLC-GPU\\\\lib\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt', 'lr_init': 0.0005, 'max_input_size': 1500, 'metadataset': 'training-datasets\\\\iteration-1\\\\UnaugmentedDataSet_MashBax_sampling_2miceMay19\\\\Documentation_data-MashBax_sampling_2mice_95shuffle1.pickle', 'min_input_size': 64, 'multi_stage': False, 'multi_step': [[0.0001, 7500], [5e-05, 12000], [1e-05, 200000]], 'net_type': 'resnet_50', 'num_idchannel': 2, 'num_joints': 7, 'num_limbs': 21, 'pafwidth': 20, 'pairwise_loss_weight': 0.1, 'partaffinityfield_graph': [[0, 1], [0, 2], [0, 3], [0, 4], [0, 5], [0, 6], [1, 2], [1, 3], [1, 4], [1, 5], [1, 6], [2, 3], [2, 4], [2, 5], [2, 6], [3, 4], [3, 5], [3, 6], [4, 5], [4, 6], [5, 6]], 'pos_dist_thresh': 17, 'project_path': 'D:\\\\DLC\\\\MashBax_sampling_2mice-ac-2021-05-19', 'rotation': 25, 'rotratio': 0.4, 'save_iters': 10000, 'scale_jitter_lo': 0.5, 'scale_jitter_up': 1.25, 'sharpen': False, 'sharpenratio': 0.3}\r\nStarting multi-animal training....\r\n```\r\n\r\n</p></details>\r\n\r\n**How to Reproduce the problem**\r\nSteps to reproduce the behavior:\r\n1. Go to train network\r\n2. Click on 'OK'\r\n3. Scroll down to 'Index error'\r\n4. See error\r\n\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n\r\n\r\n-------\r\n\r\n\r\nThank you so much all the support-\r\n\r\n-Ain","closed_by":{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1302/timeline","performed_via_github_app":null,"state_reason":"completed"}