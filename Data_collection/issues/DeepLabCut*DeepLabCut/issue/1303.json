{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1303","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1303/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1303/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1303/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1303","id":910795455,"node_id":"MDU6SXNzdWU5MTA3OTU0NTU=","number":1303,"title":"Analyze_videos runs into video error partway into analysis","user":{"login":"rshteyn","id":82400459,"node_id":"MDQ6VXNlcjgyNDAwNDU5","avatar_url":"https://avatars.githubusercontent.com/u/82400459?v=4","gravatar_id":"","url":"https://api.github.com/users/rshteyn","html_url":"https://github.com/rshteyn","followers_url":"https://api.github.com/users/rshteyn/followers","following_url":"https://api.github.com/users/rshteyn/following{/other_user}","gists_url":"https://api.github.com/users/rshteyn/gists{/gist_id}","starred_url":"https://api.github.com/users/rshteyn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rshteyn/subscriptions","organizations_url":"https://api.github.com/users/rshteyn/orgs","repos_url":"https://api.github.com/users/rshteyn/repos","events_url":"https://api.github.com/users/rshteyn/events{/privacy}","received_events_url":"https://api.github.com/users/rshteyn/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false},"assignees":[{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2021-06-03T19:35:55Z","updated_at":"2021-06-06T19:32:27Z","closed_at":"2021-06-06T19:32:26Z","author_association":"NONE","active_lock_reason":null,"body":"I am using my university's linux cluster, accessed on my Mac, deeplabcut/2.0-p3.68-tf1.14\r\n\r\n\r\nI created a pbs and py file to run analyze_videos through the cluster. The first few videos work fine, but after that there is an error that the file is not found, and the script stops running. But all of the videos are the same mp4 files, collected on the same camera/stored in the same folder, same everything.\r\n\r\n\r\n\r\nHere is how a correct video analysis looks:\r\n<details><summary>Starting to analyze %  FMS1_TestD1.mp4\r\nLoading  FMS1_TestD1.mp4\r\nDuration of video [s]:  2435.5 , recorded with  30.0 fps!\r\nOverall # of frames:  73065  found with (before cropping) frame dimensions:  640 480\r\nStarting to extract posture\r\nDetected frames:  72990\r\nSaving results in ....\r\nSaving csv poses!</summary></p>\r\n\r\n\r\nHere is how the error looks:\r\n<details><summary>Starting to analyze %  FMS1_ExtD1.mp4\r\nLoading  FMS1_ExtD1.mp4\r\nDuration of video [s]:  1955.16 , recorded with  25.0 fps!\r\nOverall # of frames:  48879  found with (before cropping) frame dimensions:  640 480\r\nStarting to extract posture\r\n\u001B[0;31m---------------------------------------------------------------------------\u001B[0m\r\n\u001B[0;31mFileNotFoundError\u001B[0m                         Traceback (most recent call last)\r\n\u001B[0;32m/gsfs0/public/deeplabcut/2.0-p3.68/envs/tfgpu/lib/python3.6/site-packages/deeplabcut/pose_estimation_tensorflow/predict_videos.py\u001B[0m in \u001B[0;36mAnalyzeVideo\u001B[0;34m(video, DLCscorer, trainFraction, cfg, dlc_cfg, sess, inputs, outputs, pdindex, save_as_csv, destfolder, get_nframesfrommetadata)\u001B[0m\r\n\u001B[1;32m    322\u001B[0m         \u001B[0;31m# Attempt to load data...\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[0;32m--> 323\u001B[0;31m         \u001B[0mpd\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0mread_hdf\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0mdataname\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[0m\u001B[1;32m    324\u001B[0m         \u001B[0mprint\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0;34m\"Video already analyzed!\"\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0mdataname\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\r\n\u001B[0;32m/gsfs0/public/deeplabcut/2.0-p3.68/envs/tfgpu/lib/python3.6/site-packages/pandas/io/pytables.py\u001B[0m in \u001B[0;36mread_hdf\u001B[0;34m(path_or_buf, key, mode, **kwargs)\u001B[0m\r\n\u001B[1;32m    380\u001B[0m             raise FileNotFoundError(\r\n\u001B[0;32m--> 381\u001B[0;31m                 \u001B[0;34m\"File {path} does not exist\"\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0mformat\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0mpath\u001B[0m\u001B[0;34m=\u001B[0m\u001B[0mpath_or_buf\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[0m\u001B[1;32m    382\u001B[0m             )\r\n\r\n\u001B[0;31mFileNotFoundError\u001B[0m: File ./FMS1_ExtD1DeepCut_resnet50_FMSMay26shuffle1_1030000.h5 does not exist\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\n\u001B[0;31mValueError\u001B[0m                                Traceback (most recent call last)\r\n\u001B[0;32m/gsfs0/data/shteynr/analyzedlc1.py\u001B[0m in \u001B[0;36m<module>\u001B[0;34m()\u001B[0m\r\n\u001B[1;32m      5\u001B[0m \u001B[0mconfig_path\u001B[0m\u001B[0;34m=\u001B[0m\u001B[0;34m'FMS-shteynr-2021-05-26/config.yaml'\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[1;32m      6\u001B[0m \u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[0;32m----> 7\u001B[0;31m \u001B[0mdlc\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0manalyze_videos\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0mconfig_path\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0;34m[\u001B[0m\u001B[0;34m'/gsfs0/data/shteynr/Videos/FMS1'\u001B[0m\u001B[0;34m]\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0mvideotype\u001B[0m\u001B[0;34m=\u001B[0m\u001B[0;34m'mp4'\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0mgputouse\u001B[0m\u001B[0;34m=\u001B[0m\u001B[0;36m3\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0msave_as_csv\u001B[0m\u001B[0;34m=\u001B[0m\u001B[0;32mTrue\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[0m\r\n\u001B[0;32m/gsfs0/public/deeplabcut/2.0-p3.68/envs/tfgpu/lib/python3.6/site-packages/deeplabcut/pose_estimation_tensorflow/predict_videos.py\u001B[0m in \u001B[0;36manalyze_videos\u001B[0;34m(config, videos, videotype, shuffle, trainingsetindex, gputouse, save_as_csv, destfolder, cropping, get_nframesfrommetadata)\u001B[0m\r\n\u001B[1;32m    192\u001B[0m         \u001B[0;31m#looping over videos\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[1;32m    193\u001B[0m         \u001B[0;32mfor\u001B[0m \u001B[0mvideo\u001B[0m \u001B[0;32min\u001B[0m \u001B[0mVideos\u001B[0m\u001B[0;34m:\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[0;32m--> 194\u001B[0;31m             \u001B[0mAnalyzeVideo\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0mvideo\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mDLCscorer\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mtrainFraction\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mcfg\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mdlc_cfg\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0msess\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0minputs\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0moutputs\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mpdindex\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0msave_as_csv\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0mdestfolder\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mget_nframesfrommetadata\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[0m\u001B[1;32m    195\u001B[0m \u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[1;32m    196\u001B[0m         \u001B[0mos\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0mchdir\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0mstr\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0mstart_path\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\r\n\u001B[0;32m/gsfs0/public/deeplabcut/2.0-p3.68/envs/tfgpu/lib/python3.6/site-packages/deeplabcut/pose_estimation_tensorflow/predict_videos.py\u001B[0m in \u001B[0;36mAnalyzeVideo\u001B[0;34m(video, DLCscorer, trainFraction, cfg, dlc_cfg, sess, inputs, outputs, pdindex, save_as_csv, destfolder, get_nframesfrommetadata)\u001B[0m\r\n\u001B[1;32m    346\u001B[0m         \u001B[0mprint\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0;34m\"Starting to extract posture\"\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[1;32m    347\u001B[0m         \u001B[0;32mif\u001B[0m \u001B[0mint\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0mdlc_cfg\u001B[0m\u001B[0;34m[\u001B[0m\u001B[0;34m\"batch_size\"\u001B[0m\u001B[0;34m]\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m>\u001B[0m\u001B[0;36m1\u001B[0m\u001B[0;34m:\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[0;32m--> 348\u001B[0;31m             \u001B[0mPredicteData\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mnframes\u001B[0m\u001B[0;34m=\u001B[0m\u001B[0mGetPoseF\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0mcfg\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mdlc_cfg\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0msess\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0minputs\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0moutputs\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mcap\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mnframes\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mint\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0mdlc_cfg\u001B[0m\u001B[0;34m[\u001B[0m\u001B[0;34m\"batch_size\"\u001B[0m\u001B[0;34m]\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[0m\u001B[1;32m    349\u001B[0m         \u001B[0;32melse\u001B[0m\u001B[0;34m:\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[1;32m    350\u001B[0m             \u001B[0mPredicteData\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mnframes\u001B[0m\u001B[0;34m=\u001B[0m\u001B[0mGetPoseS\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0mcfg\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mdlc_cfg\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0msess\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0minputs\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0moutputs\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mcap\u001B[0m\u001B[0;34m,\u001B[0m\u001B[0mnframes\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\r\n\u001B[0;32m/gsfs0/public/deeplabcut/2.0-p3.68/envs/tfgpu/lib/python3.6/site-packages/deeplabcut/pose_estimation_tensorflow/predict_videos.py\u001B[0m in \u001B[0;36mGetPoseF\u001B[0;34m(cfg, dlc_cfg, sess, inputs, outputs, cap, nframes, batchsize)\u001B[0m\r\n\u001B[1;32m    241\u001B[0m                 \u001B[0;32mif\u001B[0m \u001B[0mbatch_ind\u001B[0m\u001B[0;34m==\u001B[0m\u001B[0mbatchsize\u001B[0m\u001B[0;34m-\u001B[0m\u001B[0;36m1\u001B[0m\u001B[0;34m:\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[1;32m    242\u001B[0m                     \u001B[0mpose\u001B[0m \u001B[0;34m=\u001B[0m \u001B[0mpredict\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0mgetposeNP\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0mframes\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0mdlc_cfg\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0msess\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0minputs\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0moutputs\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[0;32m--> 243\u001B[0;31m                     \u001B[0mPredicteData\u001B[0m\u001B[0;34m[\u001B[0m\u001B[0mbatch_num\u001B[0m\u001B[0;34m*\u001B[0m\u001B[0mbatchsize\u001B[0m\u001B[0;34m:\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0mbatch_num\u001B[0m\u001B[0;34m+\u001B[0m\u001B[0;36m1\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m*\u001B[0m\u001B[0mbatchsize\u001B[0m\u001B[0;34m,\u001B[0m \u001B[0;34m:\u001B[0m\u001B[0;34m]\u001B[0m \u001B[0;34m=\u001B[0m \u001B[0mpose\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[0m\u001B[1;32m    244\u001B[0m                     \u001B[0mbatch_ind\u001B[0m \u001B[0;34m=\u001B[0m \u001B[0;36m0\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\u001B[1;32m    245\u001B[0m                     \u001B[0mbatch_num\u001B[0m \u001B[0;34m+=\u001B[0m \u001B[0;36m1\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\r\n\r\n\u001B[0;31mValueError\u001B[0m: could not broadcast input array from shape (8,18) into shape (7,18)</summary></p>\r\n\r\n\r\n</p></details>\r\n\r\n\r\nSteps to reproduce the behavior:\r\n1. qsub the pbs file (see screenshot) -- it will call the python file\r\n\r\n\r\n\r\n<img width=\"516\" alt=\"pbs\" src=\"https://user-images.githubusercontent.com/82400459/120701340-b9620980-c480-11eb-8530-660ee0666687.png\">\r\n<img width=\"630\" alt=\"py\" src=\"https://user-images.githubusercontent.com/82400459/120701338-b8c97300-c480-11eb-82d5-6ef34b6a6175.png\">\r\n\r\n\r\n","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1303/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1303/timeline","performed_via_github_app":null,"state_reason":"completed"}