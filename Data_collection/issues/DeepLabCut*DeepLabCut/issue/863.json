{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/863","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/863/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/863/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/863/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/863","id":683076889,"node_id":"MDU6SXNzdWU2ODMwNzY4ODk=","number":863,"title":"Issue properly terminating Train Network function","user":{"login":"nschapp","id":69989544,"node_id":"MDQ6VXNlcjY5OTg5NTQ0","avatar_url":"https://avatars.githubusercontent.com/u/69989544?v=4","gravatar_id":"","url":"https://api.github.com/users/nschapp","html_url":"https://github.com/nschapp","followers_url":"https://api.github.com/users/nschapp/followers","following_url":"https://api.github.com/users/nschapp/following{/other_user}","gists_url":"https://api.github.com/users/nschapp/gists{/gist_id}","starred_url":"https://api.github.com/users/nschapp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nschapp/subscriptions","organizations_url":"https://api.github.com/users/nschapp/orgs","repos_url":"https://api.github.com/users/nschapp/repos","events_url":"https://api.github.com/users/nschapp/events{/privacy}","received_events_url":"https://api.github.com/users/nschapp/received_events","type":"User","site_admin":false},"labels":[{"id":880550040,"node_id":"MDU6TGFiZWw4ODA1NTAwNDA=","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/question","name":"question","color":"d876e3","default":true,"description":"user question (not great for github ;)"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-08-20T20:30:45Z","updated_at":"2020-08-21T11:36:51Z","closed_at":"2020-08-21T11:36:41Z","author_association":"NONE","active_lock_reason":null,"body":"**Your Operating system and DeepLabCut version**\r\nWindows 10, with the latest update of DeepLabCut and Anaconda (both only installed a week ago)\r\n\r\n**Describe the problem**\r\nMy issue isn't a specific error with a code I am encountering, but rather, a problem running the \"train network\" function.  I have followed the pipeline up to that function but I am unable to get the train network to terminate without losing all of its data.  I can copy here what I am seeing in the command window at the bottom of this post.\r\n\r\nPerhaps I haven't properly used the train network function in this program, but I have attempted to stop the program manually by killing the function or the command window, but it results in no network training data being visible in the relevant folder afterwards, indicated by the following error when I attempt to perform the evaluate network function: \r\n raise FileNotFoundError(\"Snapshots not found! It seems the dataset for shuffle %s and trainFraction %s is not trained.\\nPlease train it before evaluating.\\nUse the function 'train_network' to do so.\"%(shuffle,trainFraction))\r\n\r\nIf there is a need to specify as argument to limit or save the data at a certain point in the train network function, I must have missed it.  I would appreciate if this was just a user error on my part what I can change to run the function properly.\r\n\r\nCommand prompt output below:\r\n\r\nIn [7]: deeplabcut.train_network(path_config_file)\r\nConfig:\r\n{'all_joints': [[0], [1], [2], [3], [4]],\r\n 'all_joints_names': ['snout', 'right ear', 'left ear', 'body center', 'tail'],\r\n 'batch_size': 1,\r\n 'bottomheight': 400,\r\n 'crop': True,\r\n 'crop_pad': 0,\r\n 'cropratio': 0.4,\r\n 'dataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_ReachingAug17\\\\Reaching_Mackenzie95shuffle1.mat',\r\n 'dataset_type': 'default',\r\n 'deterministic': False,\r\n 'display_iters': 1000,\r\n 'fg_fraction': 0.25,\r\n 'global_scale': 0.8,\r\n 'init_weights': 'C:\\\\Users\\\\malavikalabuser\\\\Anaconda3\\\\envs\\\\DLC-CPU\\\\lib\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt',\r\n 'intermediate_supervision': False,\r\n 'intermediate_supervision_layer': 12,\r\n 'leftwidth': 400,\r\n 'location_refinement': True,\r\n 'locref_huber_loss': True,\r\n 'locref_loss_weight': 0.05,\r\n 'locref_stdev': 7.2801,\r\n 'log_dir': 'log',\r\n 'max_input_size': 1500,\r\n 'mean_pixel': [123.68, 116.779, 103.939],\r\n 'metadataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_ReachingAug17\\\\Documentation_data-Reaching_95shuffle1.pickle',\r\n 'min_input_size': 64,\r\n 'minsize': 100,\r\n 'mirror': False,\r\n 'multi_step': [[0.005, 10000],\r\n                [0.02, 430000],\r\n                [0.002, 730000],\r\n                [0.001, 1030000]],\r\n 'net_type': 'resnet_50',\r\n 'num_joints': 5,\r\n 'optimizer': 'sgd',\r\n 'pos_dist_thresh': 17,\r\n 'project_path': 'C:\\\\Users\\\\malavikalabuser\\\\Reaching-Mackenzie-2020-08-17',\r\n 'regularize': False,\r\n 'rightwidth': 400,\r\n 'save_iters': 50000,\r\n 'scale_jitter_lo': 0.5,\r\n 'scale_jitter_up': 1.25,\r\n 'scoremap_dir': 'test',\r\n 'shuffle': True,\r\n 'snapshot_prefix': 'C:\\\\Users\\\\malavikalabuser\\\\Reaching-Mackenzie-2020-08-17\\\\dlc-models\\\\iteration-0\\\\ReachingAug17-trainset95shuffle1\\\\train\\\\snapshot',\r\n 'stride': 8.0,\r\n 'topheight': 400,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001}\r\nSwitching batchsize to 1, as default/tensorpack/deterministic loaders do not support batches >1. Use imgaug loader.\r\nStarting with standard pose-dataset loader.\r\nInitializing ResNet\r\nWARNING:tensorflow:From C:\\Users\\malavikalabuser\\Anaconda3\\envs\\DLC-CPU\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\nWARNING:tensorflow:From C:\\Users\\malavikalabuser\\Anaconda3\\envs\\DLC-CPU\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\nWARNING:tensorflow:From C:\\Users\\malavikalabuser\\Anaconda3\\envs\\DLC-CPU\\lib\\site-packages\\tensorflow\\python\\ops\\losses\\losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.cast instead.\r\nWARNING:tensorflow:From C:\\Users\\malavikalabuser\\Anaconda3\\envs\\DLC-CPU\\lib\\site-packages\\tensorflow\\python\\ops\\losses\\losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.cast instead.\r\nLoading ImageNet-pretrained resnet_50\r\nWARNING:tensorflow:From C:\\Users\\malavikalabuser\\Anaconda3\\envs\\DLC-CPU\\lib\\site-packages\\tensorflow\\python\\training\\saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse standard file APIs to check for files with this prefix.\r\nWARNING:tensorflow:From C:\\Users\\malavikalabuser\\Anaconda3\\envs\\DLC-CPU\\lib\\site-packages\\tensorflow\\python\\training\\saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse standard file APIs to check for files with this prefix.\r\nINFO:tensorflow:Restoring parameters from C:\\Users\\malavikalabuser\\Anaconda3\\envs\\DLC-CPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\models\\pretrained\\resnet_v1_50.ckpt\r\nINFO:tensorflow:Restoring parameters from C:\\Users\\malavikalabuser\\Anaconda3\\envs\\DLC-CPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\models\\pretrained\\resnet_v1_50.ckpt\r\nTraining parameter:\r\n{'stride': 8.0, 'weigh_part_predictions': False, 'weigh_negatives': False, 'fg_fraction': 0.25, 'weigh_only_present_joints': False, 'mean_pixel': [123.68, 116.779, 103.939], 'shuffle': True, 'snapshot_prefix': 'C:\\\\Users\\\\malavikalabuser\\\\Reaching-Mackenzie-2020-08-17\\\\dlc-models\\\\iteration-0\\\\ReachingAug17-trainset95shuffle1\\\\train\\\\snapshot', 'log_dir': 'log', 'global_scale': 0.8, 'location_refinement': True, 'locref_stdev': 7.2801, 'locref_loss_weight': 0.05, 'locref_huber_loss': True, 'optimizer': 'sgd', 'intermediate_supervision': False, 'intermediate_supervision_layer': 12, 'regularize': False, 'weight_decay': 0.0001, 'mirror': False, 'crop_pad': 0, 'scoremap_dir': 'test', 'batch_size': 1, 'dataset_type': 'default', 'deterministic': False, 'crop': True, 'cropratio': 0.4, 'minsize': 100, 'leftwidth': 400, 'rightwidth': 400, 'topheight': 400, 'bottomheight': 400, 'all_joints': [[0], [1], [2], [3], [4]], 'all_joints_names': ['snout', 'right ear', 'left ear', 'body center', 'tail'], 'dataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_ReachingAug17\\\\Reaching_Mackenzie95shuffle1.mat', 'init_weights': 'C:\\\\Users\\\\malavikalabuser\\\\Anaconda3\\\\envs\\\\DLC-CPU\\\\lib\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt', 'net_type': 'resnet_50', 'num_joints': 5, 'display_iters': 1000, 'max_input_size': 1500, 'metadataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_ReachingAug17\\\\Documentation_data-Reaching_95shuffle1.pickle', 'min_input_size': 64, 'multi_step': [[0.005, 10000], [0.02, 430000], [0.002, 730000], [0.001, 1030000]], 'pos_dist_thresh': 17, 'project_path': 'C:\\\\Users\\\\malavikalabuser\\\\Reaching-Mackenzie-2020-08-17', 'save_iters': 50000, 'scale_jitter_lo': 0.5, 'scale_jitter_up': 1.25, 'output_stride': 16, 'deconvolutionstride': 2}\r\nStarting training....\r\niteration: 1000 loss: 0.0208 lr: 0.005\r\niteration: 2000 loss: 0.0099 lr: 0.005\r\niteration: 3000 loss: 0.0072 lr: 0.005\r\niteration: 4000 loss: 0.0055 lr: 0.005\r\niteration: 5000 loss: 0.0051 lr: 0.005\r\niteration: 6000 loss: 0.0043 lr: 0.005\r\niteration: 7000 loss: 0.0038 lr: 0.005\r\niteration: 8000 loss: 0.0036 lr: 0.005\r\niteration: 9000 loss: 0.0033 lr: 0.005\r\niteration: 10000 loss: 0.0032 lr: 0.005\r\niteration: 11000 loss: 0.0055 lr: 0.02\r\niteration: 12000 loss: 0.0041 lr: 0.02\r\niteration: 13000 loss: 0.0034 lr: 0.02\r\niteration: 14000 loss: 0.0030 lr: 0.02\r\niteration: 15000 loss: 0.0028 lr: 0.02\r\niteration: 16000 loss: 0.0026 lr: 0.02\r\niteration: 17000 loss: 0.0024 lr: 0.02\r\niteration: 18000 loss: 0.0024 lr: 0.02\r\niteration: 19000 loss: 0.0024 lr: 0.02\r\niteration: 20000 loss: 0.0023 lr: 0.02\r\niteration: 21000 loss: 0.0021 lr: 0.02\r\niteration: 22000 loss: 0.0021 lr: 0.02\r\niteration: 23000 loss: 0.0020 lr: 0.02\r\niteration: 24000 loss: 0.0020 lr: 0.02\r\niteration: 25000 loss: 0.0020 lr: 0.02\r\niteration: 26000 loss: 0.0019 lr: 0.02\r\niteration: 27000 loss: 0.0018 lr: 0.02\r\niteration: 28000 loss: 0.0019 lr: 0.02\r\niteration: 29000 loss: 0.0018 lr: 0.02\r\niteration: 30000 loss: 0.0018 lr: 0.02\r\niteration: 31000 loss: 0.0018 lr: 0.02\r\niteration: 32000 loss: 0.0018 lr: 0.02\r\niteration: 33000 loss: 0.0018 lr: 0.02\r\niteration: 34000 loss: 0.0017 lr: 0.02\r\niteration: 35000 loss: 0.0017 lr: 0.02\r\niteration: 36000 loss: 0.0017 lr: 0.02\r\niteration: 37000 loss: 0.0016 lr: 0.02\r\niteration: 38000 loss: 0.0016 lr: 0.02\r\niteration: 39000 loss: 0.0016 lr: 0.02\r\niteration: 40000 loss: 0.0016 lr: 0.02\r\niteration: 41000 loss: 0.0016 lr: 0.02\r\niteration: 42000 loss: 0.0016 lr: 0.02\r\niteration: 43000 loss: 0.0016 lr: 0.02\r\niteration: 44000 loss: 0.0015 lr: 0.02\r\niteration: 45000 loss: 0.0015 lr: 0.02\r\niteration: 46000 loss: 0.0015 lr: 0.02\r\niteration: 47000 loss: 0.0016 lr: 0.02\r\niteration: 48000 loss: 0.0015 lr: 0.02\r\niteration: 49000 loss: 0.0015 lr: 0.02\r\niteration: 50000 loss: 0.0014 lr: 0.02\r\n//it continues onward from here if not interrupted//","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/863/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/863/timeline","performed_via_github_app":null,"state_reason":"completed"}