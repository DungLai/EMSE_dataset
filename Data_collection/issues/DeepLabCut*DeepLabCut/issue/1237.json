{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1237","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1237/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1237/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1237/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1237","id":890370747,"node_id":"MDU6SXNzdWU4OTAzNzA3NDc=","number":1237,"title":"Issue creating and refining tracklets","user":{"login":"rkos29","id":77119145,"node_id":"MDQ6VXNlcjc3MTE5MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/77119145?v=4","gravatar_id":"","url":"https://api.github.com/users/rkos29","html_url":"https://github.com/rkos29","followers_url":"https://api.github.com/users/rkos29/followers","following_url":"https://api.github.com/users/rkos29/following{/other_user}","gists_url":"https://api.github.com/users/rkos29/gists{/gist_id}","starred_url":"https://api.github.com/users/rkos29/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rkos29/subscriptions","organizations_url":"https://api.github.com/users/rkos29/orgs","repos_url":"https://api.github.com/users/rkos29/repos","events_url":"https://api.github.com/users/rkos29/events{/privacy}","received_events_url":"https://api.github.com/users/rkos29/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-05-12T18:26:05Z","updated_at":"2021-05-12T22:13:16Z","closed_at":"2021-05-12T22:13:16Z","author_association":"NONE","active_lock_reason":null,"body":"Thank you for the 2.2rc1 release - it is amazing so far! \r\n\r\n**Your Operating system and DeepLabCut version**\r\nWindows 10\r\nDeepLabCut Version: 2.2rc1\r\nAnaconda env DLC-GPU\r\n\r\n**Describe the problem**\r\n\r\nI previously trained maDLC 2.2b8 to track the behavior of one animal in an open field. With the upgrade, I labeled some more images and trained a new iteration. Using the GUI, when I try to refine tracklets with the ellipse or skeleton method, I get an error during stitching for the shape of passed values. When I use the box method, it works beautifully, but half way through the video all of the labels on the one mouse switch from being indiv1 to indiv2. This is potentially related to  #1215, although this post does not reference any value errors for the other tracking methods. Since multi-animal is now optimized for 2-14 animals, do you recommend switching to a single animal project? I really appreciate all the work that has gone into this release and your advice on this issue. \r\n\r\n<details>\r\n<summary> Please place code inside this: </summary><p>\r\n<br>\r\nC:\\Users\\rog8777\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\refine_training_dataset\\stitch.py:634: UserWarning: No optimal solution found. Employing black magic...\r\n  warnings.warn(\"No optimal solution found. Employing black magic...\")\r\n---------------------------------------------------------------------------ValueError                                Traceback (most recent call last)\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\pandas\\core\\internals\\managers.py in create_block_manager_from_blocks(blocks, axes)\r\n   1661                 blocks = [\r\n-> 1662                     make_block(values=blocks[0], placement=slice(0, len(axes[0])))\r\n   1663                 ]\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\pandas\\core\\internals\\blocks.py in make_block(values, placement, klass, ndim, dtype)\r\n   2713\r\n-> 2714     return klass(values, ndim=ndim, placement=placement)\r\n   2715\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\pandas\\core\\internals\\blocks.py in __init__(self, values, placement, ndim)\r\n    129             raise ValueError(\r\n--> 130                 f\"Wrong number of items passed {len(self.values)}, \"\r\n    131                 f\"placement implies {len(self.mgr_locs)}\"\r\n\r\nValueError: Wrong number of items passed 39, placement implies 36 \r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nValueError                                Traceback (most recent call last)\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\gui\\refine_tracklets.py in create_tracks(self, event)\r\n    316             self.datafile,\r\n    317             n_tracks=self.ntracks.GetValue(),\r\n--> 318             animal_names=self.cfg[\"individuals\"],\r\n    319         )\r\n    320\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\refine_training_dataset\\stitch.py in stitch_tracklets(pickle_file, n_tracks, min_length, split_tracklets, prestitch_residuals, weight_func, animal_names, output_name)\r\n   1006     stitcher.build_graph(weight_func=weight_func)\r\n   1007     stitcher.stitch()\r\n-> 1008     stitcher.write_tracks(output_name, animal_names)\r\n   1009     return stitcher\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\refine_training_dataset\\stitch.py in write_tracks(self, output_name, animal_names)\r\n    838\r\n    839     def write_tracks(self, output_name=\"\", animal_names=None):\r\n--> 840         df = self.format_df(animal_names)\r\n    841         if not output_name:\r\n    842             output_name = self.filename.replace(\"pickle\", \"h5\")\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\refine_training_dataset\\stitch.py in format_df(self, animal_names)\r\n    825         )\r\n    826         inds = range(self._first_frame, self._last_frame + 1)\r\n--> 827         df = pd.DataFrame(data, columns=columns, index=inds)\r\n    828         if self.single is not None:\r\n    829             columns = pd.MultiIndex.from_product(\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\pandas\\core\\frame.py in __init__(self, data, index, columns, dtype, copy)\r\n    495                 mgr = init_dict({data.name: data}, index, columns, dtype=dtype)\r\n    496             else:\r\n--> 497                 mgr = init_ndarray(data, index, columns, dtype=dtype, copy=copy)\r\n    498\r\n    499         # For data is list-like, or Iterable (will consume into list)\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\pandas\\core\\internals\\construction.py in init_ndarray(values, index, columns, dtype, copy)\r\n    232         block_values = [values]\r\n    233\r\n--> 234     return create_block_manager_from_blocks(block_values, [columns, index])\r\n    235\r\n    236\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\pandas\\core\\internals\\managers.py in create_block_manager_from_blocks(blocks, axes)\r\n   1670         blocks = [getattr(b, \"values\", b) for b in blocks]\r\n   1671         tot_items = sum(b.shape[0] for b in blocks)\r\n-> 1672         raise construction_error(tot_items, blocks[0].shape[1:], axes, e)\r\n   1673\r\n   1674\r\n\r\nValueError: Shape of passed values is (9457, 39), indices imply (9457, 36)\r\n</p></details>\r\n\r\n\r\n","closed_by":{"login":"rkos29","id":77119145,"node_id":"MDQ6VXNlcjc3MTE5MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/77119145?v=4","gravatar_id":"","url":"https://api.github.com/users/rkos29","html_url":"https://github.com/rkos29","followers_url":"https://api.github.com/users/rkos29/followers","following_url":"https://api.github.com/users/rkos29/following{/other_user}","gists_url":"https://api.github.com/users/rkos29/gists{/gist_id}","starred_url":"https://api.github.com/users/rkos29/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rkos29/subscriptions","organizations_url":"https://api.github.com/users/rkos29/orgs","repos_url":"https://api.github.com/users/rkos29/repos","events_url":"https://api.github.com/users/rkos29/events{/privacy}","received_events_url":"https://api.github.com/users/rkos29/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1237/timeline","performed_via_github_app":null,"state_reason":"completed"}