{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/62","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/62/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/62/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/62/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/62","id":361571730,"node_id":"MDU6SXNzdWUzNjE1NzE3MzA=","number":62,"title":"LossTensor is inf or nan while running my own dataset (Problem with data set)","user":{"login":"cfanyyx","id":7723243,"node_id":"MDQ6VXNlcjc3MjMyNDM=","avatar_url":"https://avatars.githubusercontent.com/u/7723243?v=4","gravatar_id":"","url":"https://api.github.com/users/cfanyyx","html_url":"https://github.com/cfanyyx","followers_url":"https://api.github.com/users/cfanyyx/followers","following_url":"https://api.github.com/users/cfanyyx/following{/other_user}","gists_url":"https://api.github.com/users/cfanyyx/gists{/gist_id}","starred_url":"https://api.github.com/users/cfanyyx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cfanyyx/subscriptions","organizations_url":"https://api.github.com/users/cfanyyx/orgs","repos_url":"https://api.github.com/users/cfanyyx/repos","events_url":"https://api.github.com/users/cfanyyx/events{/privacy}","received_events_url":"https://api.github.com/users/cfanyyx/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":24,"created_at":"2018-09-19T04:15:03Z","updated_at":"2021-08-18T18:42:30Z","closed_at":"2018-09-23T13:50:45Z","author_association":"NONE","active_lock_reason":null,"body":"**Hi, I am interested in your project very much and succeed running the demo.\r\nBut when I ran with my own dataset, I got error \"LossTensor is inf or nan while running my own dataset\".\r\nHere is config info:**\r\nConfig:\r\n{'all_joints': [[0],\r\n                [1],\r\n                [2],\r\n                [3],\r\n                [4],\r\n                [5],\r\n                [6],\r\n                [7],\r\n                [8],\r\n                [9],\r\n                [10],\r\n                [11],\r\n                [12],\r\n                [13],\r\n                [14],\r\n                [15],\r\n                [16],\r\n                [17],\r\n                [18],\r\n                [19],\r\n                [20]],\r\n 'all_joints_names': ['hand0',\r\n                      'hand1',\r\n                      'hand2',\r\n                      'hand3',\r\n                      'hand4',\r\n                      'hand5',\r\n                      'hand6',\r\n                      'hand7',\r\n                      'hand8',\r\n                      'hand9',\r\n                      'hand10',\r\n                      'hand11',\r\n                      'hand12',\r\n                      'hand13',\r\n                      'hand14',\r\n                      'hand15',\r\n                      'hand16',\r\n                      'hand17',\r\n                      'hand18',\r\n                      'hand19',\r\n                      'hand20'],\r\n 'batch_size': 1,\r\n 'crop': False,\r\n 'crop_pad': 0,\r\n 'dataset': '../../UnaugmentedDataSet_handSep18/hand_openpose80shuffle1.mat',\r\n 'dataset_type': 'default',\r\n 'display_iters': 100,\r\n 'fg_fraction': 0.25,\r\n 'global_scale': 0.95,\r\n 'init_weights': '../../pretrained/resnet_v1_50.ckpt',\r\n 'intermediate_supervision': False,\r\n 'intermediate_supervision_layer': 12,\r\n 'location_refinement': True,\r\n 'locref_huber_loss': True,\r\n 'locref_loss_weight': 0.05,\r\n 'locref_stdev': 7.2801,\r\n 'log_dir': 'log',\r\n 'max_input_size': 1000,\r\n 'mean_pixel': [123.68, 116.779, 103.939],\r\n 'mirror': False,\r\n 'multi_step': [[0.005, 10000],\r\n                [0.02, 430000],\r\n                [0.002, 730000],\r\n                [0.001, 1030000]],\r\n 'net_type': 'resnet_50',\r\n 'num_joints': 21,\r\n 'optimizer': 'sgd',\r\n 'pos_dist_thresh': 17,\r\n 'regularize': False,\r\n 'save_iters': 5000,\r\n 'scale_jitter_lo': 0.9,\r\n 'scale_jitter_up': 1.1,\r\n 'scoremap_dir': 'test',\r\n 'shuffle': True,\r\n 'snapshot_prefix': './snapshot',\r\n 'stride': 8.0,\r\n 'use_gt_segm': False,\r\n 'video': False,\r\n 'video_batch': False,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001}\r\n\r\n**And I use 240 pics for training. After 100 iters, the error occurs:**\r\niteration: 0 loss: 0.0086 lr: 0.005\r\niteration: 100 loss: 0.8863 lr: 0.005\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1361, in _do_call\r\n    return fn(*args)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1340, in _run_fn\r\n    target_list, status, run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/errors_impl.py\", line 516, in __exit__\r\n    c_api.TF_GetCode(self.status.status))\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: LossTensor is inf or nan : Tensor had NaN values\r\n         [[Node: train_op/CheckNumerics = CheckNumerics[T=DT_FLOAT, message=\"LossTensor is inf or nan\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](add)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"../../../train.py\", line 140, in <module>\r\n    train()\r\n  File \"../../../train.py\", line 119, in train\r\n    feed_dict={learning_rate: current_lr})\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 905, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1137, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1355, in _do_run\r\n    options, run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1374, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: LossTensor is inf or nan : Tensor had NaN values\r\n         [[Node: train_op/CheckNumerics = CheckNumerics[T=DT_FLOAT, message=\"LossTensor is inf or nan\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](add)]]\r\n\r\nCaused by op 'train_op/CheckNumerics', defined at:\r\n  File \"../../../train.py\", line 140, in <module>\r\n    train()\r\n  File \"../../../train.py\", line 102, in train\r\n    learning_rate, train_op = get_optimizer(total_loss, cfg)\r\n  File \"../../../train.py\", line 71, in get_optimizer\r\n    train_op = slim.learning.create_train_op(loss_op, optimizer)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/slim/python/slim/learning.py\", line 439, in create_train_op\r\n    check_numerics=check_numerics)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/contrib/training/python/training/training.py\", line 464, in create_train_op\r\n    'LossTensor is inf or nan')\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 498, in check_numerics\r\n    \"CheckNumerics\", tensor=tensor, message=message, name=name)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 3271, in create_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 1650, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nInvalidArgumentError (see above for traceback): LossTensor is inf or nan : Tensor had NaN values\r\n         [[Node: train_op/CheckNumerics = CheckNumerics[T=DT_FLOAT, message=\"LossTensor is inf or nan\", _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](add)]]\r\n\r\n**I am wondering if anyone could help me with this problem?**","closed_by":{"login":"AlexEMG","id":20850270,"node_id":"MDQ6VXNlcjIwODUwMjcw","avatar_url":"https://avatars.githubusercontent.com/u/20850270?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexEMG","html_url":"https://github.com/AlexEMG","followers_url":"https://api.github.com/users/AlexEMG/followers","following_url":"https://api.github.com/users/AlexEMG/following{/other_user}","gists_url":"https://api.github.com/users/AlexEMG/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexEMG/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexEMG/subscriptions","organizations_url":"https://api.github.com/users/AlexEMG/orgs","repos_url":"https://api.github.com/users/AlexEMG/repos","events_url":"https://api.github.com/users/AlexEMG/events{/privacy}","received_events_url":"https://api.github.com/users/AlexEMG/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/62/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/62/timeline","performed_via_github_app":null,"state_reason":"completed"}