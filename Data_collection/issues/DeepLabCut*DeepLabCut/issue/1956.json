{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1956","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1956/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1956/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1956/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1956","id":1345542546,"node_id":"I_kwDOB5BM6c5QM1mS","number":1956,"title":"Error evaluating single images","user":{"login":"abedghanbari2","id":22683143,"node_id":"MDQ6VXNlcjIyNjgzMTQz","avatar_url":"https://avatars.githubusercontent.com/u/22683143?v=4","gravatar_id":"","url":"https://api.github.com/users/abedghanbari2","html_url":"https://github.com/abedghanbari2","followers_url":"https://api.github.com/users/abedghanbari2/followers","following_url":"https://api.github.com/users/abedghanbari2/following{/other_user}","gists_url":"https://api.github.com/users/abedghanbari2/gists{/gist_id}","starred_url":"https://api.github.com/users/abedghanbari2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abedghanbari2/subscriptions","organizations_url":"https://api.github.com/users/abedghanbari2/orgs","repos_url":"https://api.github.com/users/abedghanbari2/repos","events_url":"https://api.github.com/users/abedghanbari2/events{/privacy}","received_events_url":"https://api.github.com/users/abedghanbari2/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false},"assignees":[{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2022-08-21T17:06:43Z","updated_at":"2022-08-22T14:27:32Z","closed_at":"2022-08-22T14:24:07Z","author_association":"NONE","active_lock_reason":null,"body":"### Is there an existing issue for this?\n\n- [X] I have searched the existing issues\n\n### Bug description\n\nTrying to get single image evaluation to work\r\n\r\n```\r\ncfg = load_config('./testdlc3-abed-2021-12-06/dlc-models/iteration-0/testdlc2Dec6-trainset95shuffle1/test/pose_cfg.yaml')\r\ndf = _eval_images(\r\n        image_paths='./dlc_cloudfactory/labeled-data1',\r\n        test_cfg=cfg,\r\n        snapshot_path='./testdlc3-abed-2021-12-06/dlc-models/iteration-0/testdlc2Dec6-trainset95shuffle1/train/snapshot-500.index',\r\n)\r\n```\r\n\r\nHowever it fails to load the weights with following error:\r\n```\r\nNotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:\r\n\r\nGraph execution error:\r\n\r\nDetected at node 'save/RestoreV2' defined at (most recent call last):\r\n    File \"/home/ghanba/.conda/envs/DEEPLABCUT/bin/ipython\", line 11, in <module>\r\n      sys.exit(start_ipython())\r\n    File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/__init__.py\", line 124, in start_ipython\r\n      return launch_new_instance(argv=argv, **kwargs)\r\n    File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/traitlets/config/application.py\", line 976, in launch_instance\r\n      app.start()\r\n    File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/terminal/ipapp.py\", line 318, in start\r\n      self.shell.mainloop()\r\n    File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/terminal/interactiveshell.py\", line 680, in mainloop\r\n      self.interact()\r\n    File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/terminal/interactiveshell.py\", line 673, in interact\r\n      self.run_cell(code, store_history=True)\r\n    File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 2881, in run_cell\r\n      result = self._run_cell(\r\n    File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 2936, in _run_cell\r\n      return runner(coro)\r\n    File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\r\n      coro.send(None)\r\n    File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 3135, in run_cell_async\r\n      has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\r\n    File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 3338, in run_ast_nodes\r\n      if await self.run_code(code, result, async_=asy):\r\n    File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 3398, in run_code\r\n      exec(code_obj, self.user_global_ns, self.user_ns)\r\n    File \"<ipython-input-5-032f348ecd58>\", line 2, in <cell line: 2>\r\n      df = _eval_images(\r\n    File \"<ipython-input-1-4511ed47cffc>\", line 63, in _eval_images\r\n      pose_setup = predict.setup_pose_prediction(test_cfg)\r\n    File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/deeplabcut/pose_estimation_tensorflow/core/predict.py\", line 51, in setup_pose_prediction\r\n      restorer = tf.compat.v1.train.Saver()\r\nNode: 'save/RestoreV2'\r\nTensor name \"pose/locref_pred/block4/biases\" not found in checkpoint files /projects/compsci/ramamg/USERS/ghanba/DLC/testdlc3-abed-2021-12-06/dlc-models/iteration-0/testdlc2Dec6-trainset95shuffle1/train/snapshot-700.index\r\n         [[{{node save/RestoreV2}}]]\r\n\r\nOriginal stack trace for 'save/RestoreV2':\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/bin/ipython\", line 11, in <module>\r\n    sys.exit(start_ipython())\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/__init__.py\", line 124, in start_ipython\r\n    return launch_new_instance(argv=argv, **kwargs)\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/traitlets/config/application.py\", line 976, in launch_instance\r\n    app.start()\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/terminal/ipapp.py\", line 318, in start\r\n    self.shell.mainloop()\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/terminal/interactiveshell.py\", line 680, in mainloop\r\n    self.interact()\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/terminal/interactiveshell.py\", line 673, in interact\r\n    self.run_cell(code, store_history=True)\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 2881, in run_cell\r\n    result = self._run_cell(\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 2936, in _run_cell\r\n    return runner(coro)\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\r\n    coro.send(None)\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 3135, in run_cell_async\r\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 3338, in run_ast_nodes\r\n    if await self.run_code(code, result, async_=asy):\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 3398, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-5-032f348ecd58>\", line 2, in <cell line: 2>\r\n    df = _eval_images(\r\n  File \"<ipython-input-1-4511ed47cffc>\", line 63, in _eval_images\r\n    pose_setup = predict.setup_pose_prediction(test_cfg)\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/deeplabcut/pose_estimation_tensorflow/core/predict.py\", line 51, in setup_pose_prediction\r\n    restorer = tf.compat.v1.train.Saver()\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/training/saver.py\", line 933, in __init__\r\n    self.build()\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/training/saver.py\", line 945, in build\r\n    self._build(self._filename, build_save=True, build_restore=True)\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/training/saver.py\", line 973, in _build\r\n    self.saver_def = self._builder._build_internal(  # pylint: disable=protected-access\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/training/saver.py\", line 543, in _build_internal\r\n    restore_op = self._AddRestoreOps(filename_tensor, saveables,\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/training/saver.py\", line 363, in _AddRestoreOps\r\n    all_tensors = self.bulk_restore(filename_tensor, saveables, preferred_shard,\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/training/saver.py\", line 611, in bulk_restore\r\n    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/ops/gen_io_ops.py\", line 1501, in restore_v2\r\n    _, _, _op, _outputs = _op_def_library._apply_op_helper(\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/framework/op_def_library.py\", line 797, in _apply_op_helper\r\n    op = g._create_op_internal(op_type_name, inputs, dtypes=None,\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/framework/ops.py\", line 3754, in _create_op_internal\r\n    ret = Operation(\r\n  File \"/home/ghanba/.conda/envs/DEEPLABCUT/lib/python3.8/site-packages/tensorflow/python/framework/ops.py\", line 2133, in __init__\r\n    self._traceback = tf_stack.extract_stack_for_node(self._c_op)\r\n```\n\n### Operating System\n\n```\r\nCentOS Linux release 7.8.2003 (Core)\r\nCluster Manager v9.0\r\nslave\r\nNAME=\"CentOS Linux\"\r\nVERSION=\"7 (Core)\"\r\nID=\"centos\"\r\nID_LIKE=\"rhel fedora\"\r\nVERSION_ID=\"7\"\r\nPRETTY_NAME=\"CentOS Linux 7 (Core)\"\r\nANSI_COLOR=\"0;31\"\r\nCPE_NAME=\"cpe:/o:centos:centos:7\"\r\nHOME_URL=\"https://www.centos.org/\"\r\nBUG_REPORT_URL=\"https://bugs.centos.org/\"\r\n\r\nCENTOS_MANTISBT_PROJECT=\"CentOS-7\"\r\nCENTOS_MANTISBT_PROJECT_VERSION=\"7\"\r\nREDHAT_SUPPORT_PRODUCT=\"centos\"\r\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7\"\r\n\r\nCentOS Linux release 7.8.2003 (Core)\r\nCentOS Linux release 7.8.2003 (Core)\r\n```\n\n### DeepLabCut version\n\nDLC 2.2.1.1\n\n### DeepLabCut mode\n\nmulti animal\n\n### Device type\n\ngpu\n\n### Steps To Reproduce\n\nTrained the network and trying to use a snapshot to evaluate single frames\n\n### Relevant log output\n\n_No response_\n\n### Anything else?\n\n_No response_\n\n### Code of Conduct\n\n- [X] I agree to follow this project's [Code of Conduct](https://github.com/DeepLabCut/DeepLabCut/blob/master/CODE_OF_CONDUCT.md)","closed_by":{"login":"abedghanbari2","id":22683143,"node_id":"MDQ6VXNlcjIyNjgzMTQz","avatar_url":"https://avatars.githubusercontent.com/u/22683143?v=4","gravatar_id":"","url":"https://api.github.com/users/abedghanbari2","html_url":"https://github.com/abedghanbari2","followers_url":"https://api.github.com/users/abedghanbari2/followers","following_url":"https://api.github.com/users/abedghanbari2/following{/other_user}","gists_url":"https://api.github.com/users/abedghanbari2/gists{/gist_id}","starred_url":"https://api.github.com/users/abedghanbari2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abedghanbari2/subscriptions","organizations_url":"https://api.github.com/users/abedghanbari2/orgs","repos_url":"https://api.github.com/users/abedghanbari2/repos","events_url":"https://api.github.com/users/abedghanbari2/events{/privacy}","received_events_url":"https://api.github.com/users/abedghanbari2/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1956/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1956/timeline","performed_via_github_app":null,"state_reason":"completed"}