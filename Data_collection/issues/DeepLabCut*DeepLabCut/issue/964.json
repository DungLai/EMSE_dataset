{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/964","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/964/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/964/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/964/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/964","id":723830781,"node_id":"MDU6SXNzdWU3MjM4MzA3ODE=","number":964,"title":"DeepLabCut Not Using my GPU (windows 10)","user":{"login":"hsolb","id":72955701,"node_id":"MDQ6VXNlcjcyOTU1NzAx","avatar_url":"https://avatars.githubusercontent.com/u/72955701?v=4","gravatar_id":"","url":"https://api.github.com/users/hsolb","html_url":"https://github.com/hsolb","followers_url":"https://api.github.com/users/hsolb/followers","following_url":"https://api.github.com/users/hsolb/following{/other_user}","gists_url":"https://api.github.com/users/hsolb/gists{/gist_id}","starred_url":"https://api.github.com/users/hsolb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hsolb/subscriptions","organizations_url":"https://api.github.com/users/hsolb/orgs","repos_url":"https://api.github.com/users/hsolb/repos","events_url":"https://api.github.com/users/hsolb/events{/privacy}","received_events_url":"https://api.github.com/users/hsolb/received_events","type":"User","site_admin":false},"labels":[{"id":1010467338,"node_id":"MDU6TGFiZWwxMDEwNDY3MzM4","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/Installation","name":"Installation","color":"ecfca6","default":false,"description":""},{"id":1313079487,"node_id":"MDU6TGFiZWwxMzEzMDc5NDg3","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/howtousedlc","name":"howtousedlc","color":"a1b3f4","default":false,"description":"issue regarding the use of DeepLabCut"}],"state":"closed","locked":false,"assignee":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"assignees":[{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false}],"milestone":null,"comments":16,"created_at":"2020-10-17T19:20:18Z","updated_at":"2020-11-29T15:29:47Z","closed_at":"2020-10-19T18:40:05Z","author_association":"NONE","active_lock_reason":null,"body":"OS: Windows 10\r\nDeepLabCut Version: 2.1.8.2 (checked with import deeplabcut, deeplabcut.__version__)\r\nAnaconda env used: Supplied Anaconda env from https://github.com/DeepLabCut/DeepLabCut/blob/master/conda-environments/README.md\r\nPython: 3.7\r\nTensorflow: 1.13.1 (installed using pip install tensorflow-gpu==1.13.1)\r\nCUDA: 10.0 (confirmed using nvcc --version)\r\n\r\n\r\n**Describe the problem**\r\n\r\nMy computer is not using the GPU at all when I run DeepLabCut. Here is a screenshot of the Task Manager while training the network:\r\n\r\n<img width=\"842\" alt=\"GPU-usage\" src=\"https://user-images.githubusercontent.com/72955701/96351246-32465980-1088-11eb-84bc-b56696229652.PNG\">\r\n\r\nAs you will see in the code below, tensorflow sees the GPU and maps the device. I have double checked all the versions using this site https://www.tensorflow.org/install/source_windows#tested_build_configurations and they all match up.\r\n\r\n<details><summary>Command Line Input/Output (inside supplied Anaconda env named DLC-GPU)</summary><p>\r\n\r\n```\r\n(DLC-GPU) C:\\Users\\hannah>ipython\r\nPython 3.7.0 (default, Jun 28 2018, 08:04:48) [MSC v.1912 64 bit (AMD64)]\r\nType 'copyright', 'credits' or 'license' for more information\r\nIPython 7.18.1 -- An enhanced Interactive Python. Type '?' for help.\r\n\r\nIn [1]: import tensorflow as tf\r\n\r\nIn [2]: sess = tf.Session(config=tf.ConfigProto(log_device_placement=True))\r\n2020-10-17 14:43:26.858786: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2\r\n2020-10-17 14:43:27.015260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties:\r\nname: Quadro RTX 4000 major: 7 minor: 5 memoryClockRate(GHz): 1.545\r\npciBusID: 0000:03:00.0\r\ntotalMemory: 8.00GiB freeMemory: 7.00GiB\r\n2020-10-17 14:43:27.015428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0\r\n2020-10-17 14:43:27.374654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-10-17 14:43:27.374728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0\r\n2020-10-17 14:43:27.375666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N\r\n2020-10-17 14:43:27.376112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6720 MB memory) -> physical GPU (device: 0, name: Quadro RTX 4000, pci bus id: 0000:03:00.0, compute capability: 7.5)\r\nDevice mapping:\r\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: Quadro RTX 4000, pci bus id: 0000:03:00.0, compute capability: 7.5\r\n2020-10-17 14:43:27.379892: I tensorflow/core/common_runtime/direct_session.cc:317] Device mapping:\r\n/job:localhost/replica:0/task:0/device:GPU:0 -> device: 0, name: Quadro RTX 4000, pci bus id: 0000:03:00.0, compute capability: 7.5\r\n\r\n\r\nIn [3]: import deeplabcut\r\n\r\nIn [4]: deeplabcut.launch_dlc()\r\nConfig:\r\n{'Task': None,\r\n 'TrainingFraction': None,\r\n 'all_joints': [[0], [1], [2], [3], [4]],\r\n 'all_joints_names': ['Reye', 'Leye', 'Nose', 'Rshoulder', 'Lshoulder'],\r\n 'alphavalue': None,\r\n 'batch_size': 1,\r\n 'bodyparts': None,\r\n 'bottomheight': 400,\r\n 'colormap': None,\r\n 'corner2move2': None,\r\n 'crop': True,\r\n 'crop_pad': 0,\r\n 'cropping': None,\r\n 'cropratio': 0.4,\r\n 'dataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_Oct17Oct17\\\\Oct17_hannah95shuffle1.mat',\r\n 'dataset_type': 'default',\r\n 'date': None,\r\n 'deterministic': False,\r\n 'display_iters': 1000,\r\n 'dotsize': None,\r\n 'fg_fraction': 0.25,\r\n 'global_scale': 0.8,\r\n 'init_weights': 'C:\\\\Users\\\\hannah\\\\anaconda3\\\\envs\\\\DLC-GPU\\\\lib\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt',\r\n 'intermediate_supervision': False,\r\n 'intermediate_supervision_layer': 12,\r\n 'iteration': None,\r\n 'leftwidth': 400,\r\n 'location_refinement': True,\r\n 'locref_huber_loss': True,\r\n 'locref_loss_weight': 0.05,\r\n 'locref_stdev': 7.2801,\r\n 'log_dir': 'log',\r\n 'max_input_size': 1500,\r\n 'mean_pixel': [123.68, 116.779, 103.939],\r\n 'metadataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_Oct17Oct17\\\\Documentation_data-Oct17_95shuffle1.pickle',\r\n 'min_input_size': 64,\r\n 'minsize': 100,\r\n 'mirror': False,\r\n 'move2corner': None,\r\n 'multi_step': [[0.005, 10000],\r\n                [0.02, 430000],\r\n                [0.002, 730000],\r\n                [0.001, 1030000]],\r\n 'net_type': 'resnet_50',\r\n 'num_joints': 5,\r\n 'numframes2pick': None,\r\n 'optimizer': 'sgd',\r\n 'pcutoff': None,\r\n 'pos_dist_thresh': 17,\r\n 'project_path': 'C:\\\\Users\\\\hannah\\\\Oct17-hannah-2020-10-17',\r\n 'regularize': False,\r\n 'resnet': None,\r\n 'rightwidth': 400,\r\n 'save_iters': 50000,\r\n 'scale_jitter_lo': 0.5,\r\n 'scale_jitter_up': 1.25,\r\n 'scoremap_dir': 'test',\r\n 'scorer': None,\r\n 'shuffle': True,\r\n 'skeleton': [],\r\n 'skeleton_color': 'black',\r\n 'snapshot_prefix': 'C:\\\\Users\\\\hannah\\\\Oct17-hannah-2020-10-17\\\\dlc-models\\\\iteration-0\\\\Oct17Oct17-trainset95shuffle1\\\\train\\\\snapshot',\r\n 'snapshotindex': None,\r\n 'start': None,\r\n 'stop': None,\r\n 'stride': 8.0,\r\n 'topheight': 400,\r\n 'video_sets': None,\r\n 'weigh_negatives': False,\r\n 'weigh_only_present_joints': False,\r\n 'weigh_part_predictions': False,\r\n 'weight_decay': 0.0001,\r\n 'x1': None,\r\n 'x2': None,\r\n 'y1': None,\r\n 'y2': None}\r\nSwitching batchsize to 1, as default/tensorpack/deterministic loaders do not support batches >1. Use imgaug loader.\r\nStarting with standard pose-dataset loader.\r\nInitializing ResNet\r\nWARNING:tensorflow:From C:\\Users\\hannah\\anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\nWARNING:tensorflow:From C:\\Users\\hannah\\anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\ops\\losses\\losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.cast instead.\r\nLoading ImageNet-pretrained resnet_50\r\n2020-10-17 14:45:16.782623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0\r\n2020-10-17 14:45:16.782746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-10-17 14:45:16.783523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0\r\n2020-10-17 14:45:16.783826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N\r\n2020-10-17 14:45:16.784161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6720 MB memory) -> physical GPU (device: 0, name: Quadro RTX 4000, pci bus id: 0000:03:00.0, compute capability: 7.5)\r\nWARNING:tensorflow:From C:\\Users\\hannah\\anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\tensorflow\\python\\training\\saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse standard file APIs to check for files with this prefix.\r\nINFO:tensorflow:Restoring parameters from C:\\Users\\hannah\\anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\models\\pretrained\\resnet_v1_50.ckpt\r\nMax_iters overwritten as 200000\r\nDisplay_iters overwritten as 200\r\nSave_iters overwritten as 2000\r\nTraining parameter:\r\n{'stride': 8.0, 'weigh_part_predictions': False, 'weigh_negatives': False, 'fg_fraction': 0.25, 'weigh_only_present_joints': False, 'mean_pixel': [123.68, 116.779, 103.939], 'shuffle': True, 'snapshot_prefix': 'C:\\\\Users\\\\hannah\\\\Oct17-hannah-2020-10-17\\\\dlc-models\\\\iteration-0\\\\Oct17Oct17-trainset95shuffle1\\\\train\\\\snapshot', 'log_dir': 'log', 'global_scale': 0.8, 'location_refinement': True, 'locref_stdev': 7.2801, 'locref_loss_weight': 0.05, 'locref_huber_loss': True, 'optimizer': 'sgd', 'intermediate_supervision': False, 'intermediate_supervision_layer': 12, 'regularize': False, 'weight_decay': 0.0001, 'mirror': False, 'crop_pad': 0, 'scoremap_dir': 'test', 'batch_size': 1, 'dataset_type': 'default', 'deterministic': False, 'crop': True, 'cropratio': 0.4, 'minsize': 100, 'leftwidth': 400, 'rightwidth': 400, 'topheight': 400, 'bottomheight': 400, 'Task': None, 'TrainingFraction': None, 'all_joints': [[0], [1], [2], [3], [4]], 'all_joints_names': ['Reye', 'Leye', 'Nose', 'Rshoulder', 'Lshoulder'], 'alphavalue': None, 'bodyparts': None, 'colormap': None, 'corner2move2': None, 'cropping': None, 'dataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_Oct17Oct17\\\\Oct17_hannah95shuffle1.mat', 'date': None, 'display_iters': 1000, 'dotsize': None, 'init_weights': 'C:\\\\Users\\\\hannah\\\\anaconda3\\\\envs\\\\DLC-GPU\\\\lib\\\\site-packages\\\\deeplabcut\\\\pose_estimation_tensorflow\\\\models\\\\pretrained\\\\resnet_v1_50.ckpt', 'iteration': None, 'max_input_size': 1500, 'metadataset': 'training-datasets\\\\iteration-0\\\\UnaugmentedDataSet_Oct17Oct17\\\\Documentation_data-Oct17_95shuffle1.pickle', 'min_input_size': 64, 'move2corner': None, 'multi_step': [[0.005, 10000], [0.02, 430000], [0.002, 730000], [0.001, 1030000]], 'net_type': 'resnet_50', 'num_joints': 5, 'numframes2pick': None, 'pcutoff': None, 'pos_dist_thresh': 17, 'project_path': 'C:\\\\Users\\\\hannah\\\\Oct17-hannah-2020-10-17', 'resnet': None, 'save_iters': 50000, 'scale_jitter_lo': 0.5, 'scale_jitter_up': 1.25, 'scorer': None, 'skeleton': [], 'skeleton_color': 'black', 'snapshotindex': None, 'start': None, 'stop': None, 'video_sets': None, 'x1': None, 'x2': None, 'y1': None, 'y2': None, 'output_stride': 16, 'deconvolutionstride': 2}\r\nStarting training....\r\niteration: 200 loss: 0.0487 lr: 0.005\r\niteration: 400 loss: 0.0183 lr: 0.005\r\niteration: 600 loss: 0.0156 lr: 0.005\r\n```\r\n\r\n</p></details>\r\n\r\n**How to Reproduce the problem**\r\nSteps to reproduce the behavior can be seen in the above Command Line process within the Anaconda env. Happy to answer additional questions if that is not clear.\r\n\r\nAdditionally, here are screenshots when running nvidia-smi and nvcc --version\r\n\r\n<img width=\"457\" alt=\"nvidia-smi\" src=\"https://user-images.githubusercontent.com/72955701/96351832-2bb9e100-108c-11eb-9c96-e44c64049008.PNG\">\r\n\r\n<img width=\"319\" alt=\"nvcc --version\" src=\"https://user-images.githubusercontent.com/72955701/96351845-41c7a180-108c-11eb-8300-d7083eda5be5.PNG\">\r\n\r\n","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/964/timeline","performed_via_github_app":null,"state_reason":"completed"}