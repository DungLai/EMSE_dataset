{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1419","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1419/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1419/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1419/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1419","id":945787265,"node_id":"MDU6SXNzdWU5NDU3ODcyNjU=","number":1419,"title":"Value Error after converting single to multi animal project and resetting iterations during extract outliers","user":{"login":"backyardbiomech","id":9662673,"node_id":"MDQ6VXNlcjk2NjI2NzM=","avatar_url":"https://avatars.githubusercontent.com/u/9662673?v=4","gravatar_id":"","url":"https://api.github.com/users/backyardbiomech","html_url":"https://github.com/backyardbiomech","followers_url":"https://api.github.com/users/backyardbiomech/followers","following_url":"https://api.github.com/users/backyardbiomech/following{/other_user}","gists_url":"https://api.github.com/users/backyardbiomech/gists{/gist_id}","starred_url":"https://api.github.com/users/backyardbiomech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/backyardbiomech/subscriptions","organizations_url":"https://api.github.com/users/backyardbiomech/orgs","repos_url":"https://api.github.com/users/backyardbiomech/repos","events_url":"https://api.github.com/users/backyardbiomech/events{/privacy}","received_events_url":"https://api.github.com/users/backyardbiomech/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-07-15T22:08:44Z","updated_at":"2021-07-15T22:08:56Z","closed_at":"2021-07-15T22:08:56Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"\r\nThis will probably never happen to anyone else, so I will close this issue immediately, but I wanted to document it, and leave it here for future search engines. I don't even think it's worth updating the documentation, as this should never happen.\r\n\r\nI started with a single animal project, and had refined through 9 iterations. I then converted that project to multi-animal, and because the I had been experimenting with some training, I rolled iterations back to 6 (my last best model). When I tried to run `deeplabcut.extract_outliers` , the existing `machinelabels-iter6.h5` files caused a concatenation conflict in pandas, because they had single animal headers rather than multi animal. This is easily fixed by either: 1. Not stupidly resetting the iteration counter after a single-multi conversion, or 2. Deleting the previous machine labels files.\r\n\r\nWindows 10, Deeplabcut 2.2rc3 (though this would happen with any version and os)\r\n\r\n<details><summary>TRACEBACK</summary><p>\r\n\r\n```python\r\n\r\nMethod  jump  found  107  putative outlier frames.\r\nDo you want to proceed with extracting  3  of those?\r\nIf this list is very large, perhaps consider changing the parameters (start, stop, p_bound, comparisonbodyparts) or use a different method.\r\nFrames from video cam1_04-Mar-21_20-27-56  already extracted (more will be added)!\r\nLoading video...\r\nDuration of video [s]:  4.2 , recorded @  30.0 fps!\r\nOverall # of frames:  114 with (cropped) frame dimensions: \r\nKmeans-quantization based extracting of frames from 0.42  seconds to 4.2  seconds.\r\nExtracting and downsampling... 107  frames from the video.\r\n107it [00:04, 23.21it/s]\r\nKmeans clustering ... (this might take a while)\r\nLet's select frames indices: [108, 36, 65]\r\nNew video was added to the project! Use the function 'extract_frames' to select frames for labeling.\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 3441, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-9-23f7cc72dd11>\", line 3, in <module>\r\n    dlc.extract_outlier_frames(config,\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\deeplabcut\\refine_training_dataset\\outlier_frames.py\", line 395, in extract_outlier_frames\r\n    ExtractFramesbasedonPreselection(\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\deeplabcut\\refine_training_dataset\\outlier_frames.py\", line 745, in ExtractFramesbasedonPreselection\r\n    DataCombined = pd.concat([Data, df])\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\pandas\\core\\reshape\\concat.py\", line 285, in concat\r\n    op = _Concatenator(\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\pandas\\core\\reshape\\concat.py\", line 467, in __init__\r\n    self.new_axes = self._get_new_axes()\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\pandas\\core\\reshape\\concat.py\", line 537, in _get_new_axes\r\n    return [\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\pandas\\core\\reshape\\concat.py\", line 538, in <listcomp>\r\n    self._get_concat_axis() if i == self.bm_axis else self._get_comb_axis(i)\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\pandas\\core\\reshape\\concat.py\", line 544, in _get_comb_axis\r\n    return get_objs_combined_axis(\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\pandas\\core\\indexes\\api.py\", line 92, in get_objs_combined_axis\r\n    return _get_combined_index(obs_idxes, intersect=intersect, sort=sort, copy=copy)\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\pandas\\core\\indexes\\api.py\", line 145, in _get_combined_index\r\n    index = union_indexes(indexes, sort=sort)\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\pandas\\core\\indexes\\api.py\", line 217, in union_indexes\r\n    result = result.union(other)\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\pandas\\core\\indexes\\multi.py\", line 3574, in union\r\n    return self._union(other, sort=sort)\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\pandas\\core\\indexes\\multi.py\", line 3589, in _union\r\n    return MultiIndex.from_arrays(\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\pandas\\core\\indexes\\multi.py\", line 466, in from_arrays\r\n    return cls(\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\pandas\\core\\indexes\\multi.py\", line 308, in __new__\r\n    result._set_names(names)\r\n  File \"C:\\Users\\jacksonbe3\\Miniconda3\\envs\\dlcrc3test\\lib\\site-packages\\pandas\\core\\indexes\\multi.py\", line 1433, in _set_names\r\n    raise ValueError(\r\nValueError: Length of names must match number of levels in MultiIndex.\r\n\r\n```\r\n</p></details>\r\n\r\n","closed_by":{"login":"backyardbiomech","id":9662673,"node_id":"MDQ6VXNlcjk2NjI2NzM=","avatar_url":"https://avatars.githubusercontent.com/u/9662673?v=4","gravatar_id":"","url":"https://api.github.com/users/backyardbiomech","html_url":"https://github.com/backyardbiomech","followers_url":"https://api.github.com/users/backyardbiomech/followers","following_url":"https://api.github.com/users/backyardbiomech/following{/other_user}","gists_url":"https://api.github.com/users/backyardbiomech/gists{/gist_id}","starred_url":"https://api.github.com/users/backyardbiomech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/backyardbiomech/subscriptions","organizations_url":"https://api.github.com/users/backyardbiomech/orgs","repos_url":"https://api.github.com/users/backyardbiomech/repos","events_url":"https://api.github.com/users/backyardbiomech/events{/privacy}","received_events_url":"https://api.github.com/users/backyardbiomech/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1419/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1419/timeline","performed_via_github_app":null,"state_reason":"completed"}