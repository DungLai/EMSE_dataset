{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/851","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/851/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/851/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/851/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/851","id":679424419,"node_id":"MDU6SXNzdWU2Nzk0MjQ0MTk=","number":851,"title":"Frame extraction failure (for corrupted videos)","user":{"login":"j0ner0n","id":44198728,"node_id":"MDQ6VXNlcjQ0MTk4NzI4","avatar_url":"https://avatars.githubusercontent.com/u/44198728?v=4","gravatar_id":"","url":"https://api.github.com/users/j0ner0n","html_url":"https://github.com/j0ner0n","followers_url":"https://api.github.com/users/j0ner0n/followers","following_url":"https://api.github.com/users/j0ner0n/following{/other_user}","gists_url":"https://api.github.com/users/j0ner0n/gists{/gist_id}","starred_url":"https://api.github.com/users/j0ner0n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/j0ner0n/subscriptions","organizations_url":"https://api.github.com/users/j0ner0n/orgs","repos_url":"https://api.github.com/users/j0ner0n/repos","events_url":"https://api.github.com/users/j0ner0n/events{/privacy}","received_events_url":"https://api.github.com/users/j0ner0n/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-08-14T22:03:58Z","updated_at":"2020-08-16T23:48:40Z","closed_at":"2020-08-16T23:48:39Z","author_association":"NONE","active_lock_reason":null,"body":"**Your Operating system and DeepLabCut version**\r\n\r\nOS: macOS Catalina 10.15.6\r\nDeepLabCut Version: 2.1.8.2\r\nAnaconda env used: default anaconda DLC_CPU.yaml\r\n\r\n**Describe the problem**\r\n\r\nWhen trying to extract frames manually from a .avi file a traceback error occurs breaking the image loading process and stops the GUI labeling process to start (grey screen with no image loading for labeling). The videos did have error messages for missing frames which maybe relate to this issue.\r\n\r\nPlease place code inside this:\r\n\r\n<details><summary>Code output</summary><p>\r\n\r\npythonw launch.py\r\n2.1.8.2\r\nCreated \"/Users/jonasschafer/CS/Additional/Learn/AI/deeplabcut/Animal Behaviour Small-Jonas Schäfer-2020-08-14/videos\"\r\nCreated \"/Users/jonasschafer/CS/Additional/Learn/AI/deeplabcut/Animal Behaviour Small-Jonas Schäfer-2020-08-14/labeled-data\"\r\nCreated \"/Users/jonasschafer/CS/Additional/Learn/AI/deeplabcut/Animal Behaviour Small-Jonas Schäfer-2020-08-14/training-datasets\"\r\nCreated \"/Users/jonasschafer/CS/Additional/Learn/AI/deeplabcut/Animal Behaviour Small-Jonas Schäfer-2020-08-14/dlc-models\"\r\nCopying the videos\r\n/Users/jonasschafer/CS/Additional/Learn/AI/deeplabcut/Animal Behaviour Small-Jonas Schäfer-2020-08-14/videos/20191113090848_01.avi\r\n[h264 @ 0x7ff6d3132600] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6d3132600] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6d3132600] decode_slice_header error\r\n[h264 @ 0x7ff6d3132600] no frame!\r\n\r\n// Numerous identical messages as above would be here, cut out for readability\r\n\r\n/Users/jonasschafer/CS/Additional/Learn/AI/deeplabcut/Animal Behaviour Small-Jonas Schäfer-2020-08-14/videos/20191113091718_01.avi\r\n[h264 @ 0x7ff6b81a0c00] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6b81a0c00] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6b81a0c00] decode_slice_header error\r\n[h264 @ 0x7ff6b81a0c00] no frame!\r\n\r\n// Numerous identical messages as above would be here, cut out for readability\r\n\r\n/Users/jonasschafer/CS/Additional/Learn/AI/deeplabcut/Animal Behaviour Small-Jonas Schäfer-2020-08-14/videos/20191113092627_01.avi\r\n[h264 @ 0x7ff6d2ab9e00] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6d2ab9e00] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6d2ab9e00] decode_slice_header error\r\n[h264 @ 0x7ff6d2ab9e00] no frame!\r\n\r\n// Numerous identical messages as above would be here, cut out for readability\r\n\r\n/Users/jonasschafer/CS/Additional/Learn/AI/deeplabcut/Animal Behaviour Small-Jonas Schäfer-2020-08-14/videos/20191113094247_01.avi\r\n[h264 @ 0x7ff6b80f9600] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6b80f9600] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6b80f9600] decode_slice_header error\r\n[h264 @ 0x7ff6b80f9600] no frame!\r\n\r\n// Numerous identical messages as above would be here, cut out for readability\r\n\r\n/Users/jonasschafer/CS/Additional/Learn/AI/deeplabcut/Animal Behaviour Small-Jonas Schäfer-2020-08-14/videos/20191113094643_01.avi\r\n[h264 @ 0x7ff6d2a99600] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6d2a99600] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6d2a99600] decode_slice_header error\r\n[h264 @ 0x7ff6d2a99600] no frame!\r\n\r\n// Numerous identical messages as above would be here, cut out for readability\r\n\r\n/Users/jonasschafer/CS/Additional/Learn/AI/deeplabcut/Animal Behaviour Small-Jonas Schäfer-2020-08-14/videos/20191113095009_01.avi\r\n[h264 @ 0x7ff6b80f9600] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6b80f9600] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6b80f9600] decode_slice_header error\r\n[h264 @ 0x7ff6b80f9600] no frame!\r\n\r\n// Numerous identical messages as above would be here, cut out for readability\r\n\r\n/Users/jonasschafer/CS/Additional/Learn/AI/deeplabcut/Animal Behaviour Small-Jonas Schäfer-2020-08-14/videos/20191113095648_01.avi\r\n[h264 @ 0x7ff6b80efc00] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6b80efc00] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6b80efc00] decode_slice_header error\r\n[h264 @ 0x7ff6b80efc00] no frame!\r\n\r\n// Numerous identical messages as above would be here, cut out for readability\r\n\r\n/Users/jonasschafer/CS/Additional/Learn/AI/deeplabcut/Animal Behaviour Small-Jonas Schäfer-2020-08-14/videos/20191113095959_01.avi\r\n[h264 @ 0x7ff6c5f5de00] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6c5f5de00] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6c5f5de00] decode_slice_header error\r\n[h264 @ 0x7ff6c5f5de00] no frame!\r\n\r\n// Numerous identical messages as above would be here, cut out for readability\r\n\r\nGenerated \"/Users/jonasschafer/CS/Additional/Learn/AI/deeplabcut/Animal Behaviour Small-Jonas Schäfer-2020-08-14/config.yaml\"\r\n\r\nA new project with name Animal Behaviour Small-Jonas Schäfer-2020-08-14 is created at /Users/jonasschafer/CS/Additional/Learn/AI/deeplabcut and a configurable file (config.yaml) is stored there. Change the parameters in this file to adapt to your project's needs.\r\n Once you have changed the configuration file, use the function 'extract_frames' to select frames for labeling.\r\n. [OPTIONAL] Use the function 'add_new_videos' to add new videos to your project (at any stage).\r\n[h264 @ 0x7ff6b809b400] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6b809b400] non-existing PPS 0 referenced\r\n[h264 @ 0x7ff6b809b400] decode_slice_header error\r\n[h264 @ 0x7ff6b809b400] no frame!\r\n\r\n// Numerous identical messages as above would be here, cut out for readability\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/jonasschafer/opt/anaconda3/envs/DLC-CPU/lib/python3.7/site-packages/deeplabcut/generate_training_dataset/frame_extraction_toolbox.py\", line 339, in browseDir\r\n    self.update()\r\n  File \"/Users/jonasschafer/opt/anaconda3/envs/DLC-CPU/lib/python3.7/site-packages/deeplabcut/generate_training_dataset/frame_extraction_toolbox.py\", line 374, in update\r\n    self.ax = self.axes.imshow(frame)\r\n  File \"/Users/jonasschafer/opt/anaconda3/envs/DLC-CPU/lib/python3.7/site-packages/matplotlib/__init__.py\", line 1810, in inner\r\n    return func(ax, *args, **kwargs)\r\n  File \"/Users/jonasschafer/opt/anaconda3/envs/DLC-CPU/lib/python3.7/site-packages/matplotlib/axes/_axes.py\", line 5494, in imshow\r\n    im.set_data(X)\r\n  File \"/Users/jonasschafer/opt/anaconda3/envs/DLC-CPU/lib/python3.7/site-packages/matplotlib/image.py\", line 634, in set_data\r\n    raise TypeError(\"Image data cannot be converted to float\")\r\nTypeError: Image data cannot be converted to float\r\nTraceback (most recent call last):\r\n  File \"/Users/jonasschafer/opt/anaconda3/envs/DLC-CPU/lib/python3.7/site-packages/deeplabcut/generate_training_dataset/frame_extraction_toolbox.py\", line 403, in grabFrame\r\n    self.chooseFrame()\r\n  File \"/Users/jonasschafer/opt/anaconda3/envs/DLC-CPU/lib/python3.7/site-packages/deeplabcut/generate_training_dataset/frame_extraction_toolbox.py\", line 384, in chooseFrame\r\n    frame=cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)\r\ncv2.error: OpenCV(3.4.10) /Users/travis/build/skvark/opencv-python/opencv/modules/imgproc/src/color.cpp:182: error: (-215:Assertion failed) !_src.empty() in function 'cvtColor'\r\n\r\n</p></details>\r\n\r\n**How to Reproduce the problem**\r\nSteps to reproduce the behavior:\r\n1. import deeplabcut and run the GUI deeplabcut.launch_dlc()\r\n2. Create project with .avi video files\r\n3. Extraction method: manual, click \"OK\"\r\n4. \"Load video\" and select a single .avi video file, see first Traceback error\r\n5. Select \"Grab frames\" for followup Traceback error from above\r\n\r\n\r\n**Screenshots**\r\nN/A\r\n\r\n\r\n**Additional context**\r\nMaybe the missing frames are related to this issue and it breaks conversion to float?\r\n","closed_by":{"login":"j0ner0n","id":44198728,"node_id":"MDQ6VXNlcjQ0MTk4NzI4","avatar_url":"https://avatars.githubusercontent.com/u/44198728?v=4","gravatar_id":"","url":"https://api.github.com/users/j0ner0n","html_url":"https://github.com/j0ner0n","followers_url":"https://api.github.com/users/j0ner0n/followers","following_url":"https://api.github.com/users/j0ner0n/following{/other_user}","gists_url":"https://api.github.com/users/j0ner0n/gists{/gist_id}","starred_url":"https://api.github.com/users/j0ner0n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/j0ner0n/subscriptions","organizations_url":"https://api.github.com/users/j0ner0n/orgs","repos_url":"https://api.github.com/users/j0ner0n/repos","events_url":"https://api.github.com/users/j0ner0n/events{/privacy}","received_events_url":"https://api.github.com/users/j0ner0n/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/851/timeline","performed_via_github_app":null,"state_reason":"completed"}