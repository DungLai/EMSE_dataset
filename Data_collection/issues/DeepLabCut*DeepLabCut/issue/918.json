{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/918","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/918/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/918/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/918/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/918","id":705466529,"node_id":"MDU6SXNzdWU3MDU0NjY1Mjk=","number":918,"title":"InternalError: 2 root error(s) found.  Internal: cuDNN launch failure : input shape([8,3,317,317]) filter shape([7,7,3,64])","user":{"login":"moskovicher","id":71636683,"node_id":"MDQ6VXNlcjcxNjM2Njgz","avatar_url":"https://avatars.githubusercontent.com/u/71636683?v=4","gravatar_id":"","url":"https://api.github.com/users/moskovicher","html_url":"https://github.com/moskovicher","followers_url":"https://api.github.com/users/moskovicher/followers","following_url":"https://api.github.com/users/moskovicher/following{/other_user}","gists_url":"https://api.github.com/users/moskovicher/gists{/gist_id}","starred_url":"https://api.github.com/users/moskovicher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/moskovicher/subscriptions","organizations_url":"https://api.github.com/users/moskovicher/orgs","repos_url":"https://api.github.com/users/moskovicher/repos","events_url":"https://api.github.com/users/moskovicher/events{/privacy}","received_events_url":"https://api.github.com/users/moskovicher/received_events","type":"User","site_admin":false},"labels":[{"id":1313079487,"node_id":"MDU6TGFiZWwxMzEzMDc5NDg3","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/howtousedlc","name":"howtousedlc","color":"a1b3f4","default":false,"description":"issue regarding the use of DeepLabCut"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-09-21T10:16:32Z","updated_at":"2020-09-27T11:12:02Z","closed_at":"2020-09-27T11:12:02Z","author_association":"NONE","active_lock_reason":null,"body":"Hello everyone,\r\n\r\nOS: Windows 10\r\nDeepLabCut Version: 2.2b7\r\nAnaconda env used: 3\r\nPython: 3.7\r\nCuda version: 10\r\nTF version: 1.15\r\n\r\nI'm using the deepLabCut GUI (I don't know how to code with python). I have already been able to label the photos, and now I just need to train the network.\r\nThis is the first time I'm using this computer to do so, so I had to download the GPU-supported version, the CUDA, the TS and everything. \r\nWhen trying to train the network this is the code it shows in the prompt:\r\n```\r\n<details><summary>c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\deeplabcut\\gui\\train_network.py in train_network(self, event)\r\n    327             displayiters=displayiters,\r\n    328             saveiters=saveiters,\r\n--> 329             maxiters=maxiters,\r\n    330         )\r\n    331\r\n\r\nc:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\training.py in train_network(config, shuffle, trainingsetindex, max_snapshots_to_keep, displayiters, saveiters, maxiters, allow_growth, gputouse, autotune, keepdeconvweights, modelprefix)\r\n    191\r\n    192     except BaseException as e:\r\n--> 193         raise e\r\n    194     finally:\r\n    195         os.chdir(str(start_path))\r\n\r\nc:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\training.py in train_network(config, shuffle, trainingsetindex, max_snapshots_to_keep, displayiters, saveiters, maxiters, allow_growth, gputouse, autotune, keepdeconvweights, modelprefix)\r\n    174                 max_to_keep=max_snapshots_to_keep,\r\n    175                 keepdeconvweights=keepdeconvweights,\r\n--> 176                 allow_growth=allow_growth,\r\n    177             )  # pass on path and file name for pose_cfg.yaml!\r\n    178         else:\r\n\r\nc:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train_multianimal.py in train(config_yaml, displayiters, saveiters, maxiters, max_to_keep, keepdeconvweights, allow_growth)\r\n    215         [_, alllosses, loss_val, summary] = sess.run(\r\n    216             [train_op, losses, total_loss, merged_summaries],\r\n--> 217             feed_dict={learning_rate: current_lr},\r\n    218         )\r\n    219\r\n\r\nc:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\client\\session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    954     try:\r\n    955       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 956                          run_metadata_ptr)\r\n    957       if run_metadata:\r\n    958         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\nc:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\client\\session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n   1178     if final_fetches or final_targets or (handle and feed_dict_tensor):\r\n   1179       results = self._do_run(handle, final_targets, final_fetches,\r\n-> 1180                              feed_dict_tensor, options, run_metadata)\r\n   1181     else:\r\n   1182       results = []\r\n\r\nc:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\client\\session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n   1357     if handle is None:\r\n   1358       return self._do_call(_run_fn, feeds, fetches, targets, options,\r\n-> 1359                            run_metadata)\r\n   1360     else:\r\n   1361       return self._do_call(_prun_fn, handle, feeds, fetches)\r\n\r\nc:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\client\\session.py in _do_call(self, fn, *args)\r\n   1382                     '\\nsession_config.graph_options.rewrite_options.'\r\n   1383                     'disable_meta_optimizer = True')\r\n-> 1384       raise type(e)(node_def, op, message)\r\n   1385\r\n   1386   def _extend_graph(self):</summary><p>\r\n```\r\nAnd this is the error:\r\n```\r\n</p>InternalError: 2 root error(s) found.\r\n  (0) Internal: cuDNN launch failure : input shape([8,3,317,317]) filter shape([7,7,3,64])\r\n         [[node resnet_v1_50/conv1/Conv2D (defined at c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\framework\\ops.py:1748) ]]\r\n         [[absolute_difference/weighted_loss/assert_broadcastable/is_valid_shape/has_valid_nonscalar_shape/has_invalid_dims/_595]]\r\n  (1) Internal: cuDNN launch failure : input shape([8,3,317,317]) filter shape([7,7,3,64])\r\n         [[node resnet_v1_50/conv1/Conv2D (defined at c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\framework\\ops.py:1748) ]]\r\n0 successful operations.\r\n0 derived errors ignored.\r\n\r\nOriginal stack trace for 'resnet_v1_50/conv1/Conv2D':\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"C:\\Users\\Shachar_Mizrahi\\.conda\\envs\\DLC\\Scripts\\ipython.exe\\__main__.py\", line 7, in <module>\r\n    sys.exit(start_ipython())\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\IPython\\__init__.py\", line 126, in start_ipython\r\n    return launch_new_instance(argv=argv, **kwargs)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\traitlets\\config\\application.py\", line 837, in launch_instance\r\n    app.start()\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\IPython\\terminal\\ipapp.py\", line 356, in start\r\n    self.shell.mainloop()\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\IPython\\terminal\\interactiveshell.py\", line 564, in mainloop\r\n    self.interact()\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\IPython\\terminal\\interactiveshell.py\", line 555, in interact\r\n    self.run_cell(code, store_history=True)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2877, in run_cell\r\n    raw_cell, store_history, silent, shell_futures)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 2922, in _run_cell\r\n    return runner(coro)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\IPython\\core\\async_helpers.py\", line 68, in _pseudo_sync_runner\r\n    coro.send(None)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 3146, in run_cell_async\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 3337, in run_ast_nodes\r\n    if (await self.run_code(code, result,  async_=asy)):\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 3417, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-2-1ced4355ffc5>\", line 1, in <module>\r\n    deeplabcut.launch_dlc()\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\deeplabcut\\gui\\launch_script.py\", line 66, in launch_dlc\r\n    app.MainLoop()\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\wx\\core.py\", line 2167, in MainLoop\r\n    rv = wx.PyApp.MainLoop(self)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\deeplabcut\\gui\\train_network.py\", line 329, in train_network\r\n    maxiters=maxiters,\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\training.py\", line 176, in train_network\r\n    allow_growth=allow_growth,\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\train_multianimal.py\", line 141, in train\r\n    losses = pose_net(cfg).train(batch)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\nnet\\pose_net.py\", line 279, in train\r\n    heads = self.get_net(batch[Batch.inputs])\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\nnet\\pose_net.py\", line 178, in get_net\r\n    net, end_points = self.extract_features(inputs)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\nnet\\pose_net.py\", line 130, in extract_features\r\n    im_centered, global_pool=False, output_stride=16, is_training=False\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\contrib\\slim\\python\\slim\\nets\\resnet_v1.py\", line 274, in resnet_v1_50\r\n    scope=scope)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\contrib\\slim\\python\\slim\\nets\\resnet_v1.py\", line 205, in resnet_v1\r\n    net = resnet_utils.conv2d_same(net, 64, 7, stride=2, scope='conv1')\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\contrib\\slim\\python\\slim\\nets\\resnet_utils.py\", line 146, in conv2d_same\r\n    scope=scope)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\contrib\\framework\\python\\ops\\arg_scope.py\", line 182, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\contrib\\layers\\python\\layers\\layers.py\", line 1159, in convolution2d\r\n    conv_dims=2)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\contrib\\framework\\python\\ops\\arg_scope.py\", line 182, in func_with_args\r\n    return func(*args, **current_args)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\contrib\\layers\\python\\layers\\layers.py\", line 1057, in convolution\r\n    outputs = layer.apply(inputs)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\util\\deprecation.py\", line 324, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\base_layer.py\", line 1700, in apply\r\n    return self.__call__(inputs, *args, **kwargs)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\layers\\base.py\", line 548, in __call__\r\n    outputs = super(Layer, self).__call__(inputs, *args, **kwargs)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\base_layer.py\", line 854, in __call__\r\n    outputs = call_fn(cast_inputs, *args, **kwargs)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\autograph\\impl\\api.py\", line 234, in wrapper\r\n    return converted_call(f, options, args, kwargs)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\autograph\\impl\\api.py\", line 439, in converted_call\r\n    return _call_unconverted(f, args, kwargs, options)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\autograph\\impl\\api.py\", line 330, in _call_unconverted\r\n    return f(*args, **kwargs)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\keras\\layers\\convolutional.py\", line 197, in call\r\n    outputs = self._convolution_op(inputs, self.kernel)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\ops\\nn_ops.py\", line 1134, in __call__\r\n    return self.conv_op(inp, filter)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\ops\\nn_ops.py\", line 639, in __call__\r\n    return self.call(inp, filter)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\ops\\nn_ops.py\", line 238, in __call__\r\n    name=self.name)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\ops\\nn_ops.py\", line 2010, in conv2d\r\n    name=name)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\ops\\gen_nn_ops.py\", line 1071, in conv2d\r\n    data_format=data_format, dilations=dilations, name=name)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\framework\\op_def_library.py\", line 794, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\util\\deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\framework\\ops.py\", line 3357, in create_op\r\n    attrs, op_def, compute_device)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\framework\\ops.py\", line 3426, in _create_op_internal\r\n    op_def=op_def)\r\n  File \"c:\\users\\shachar_mizrahi\\.conda\\envs\\dlc\\lib\\site-packages\\tensorflow_core\\python\\framework\\ops.py\", line 1748, in __init__\r\n    self._traceback = tf_stack.extract_stack()</details>\r\n```\r\nSteps to reproduce the behavior:\r\n1. Go to 'Train network' on the GUI, after all photos had been extracted and labeled\r\n2. Click on 'Ok' \r\n3. See error\r\n\r\nI saw this problem popped earlier for someone else, and when trying to replicate the steps he did to solve it I couldn't use the test you suggested to check if the CUDA and the TF versions are compatible. \r\nAny help will be apriciated!\r\nThanks!","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/918/timeline","performed_via_github_app":null,"state_reason":"completed"}