{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1457","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1457/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1457/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1457/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1457","id":964964925,"node_id":"MDU6SXNzdWU5NjQ5NjQ5MjU=","number":1457,"title":"Prioritizing prior connections with occluded animals","user":{"login":"blogeman","id":62612214,"node_id":"MDQ6VXNlcjYyNjEyMjE0","avatar_url":"https://avatars.githubusercontent.com/u/62612214?v=4","gravatar_id":"","url":"https://api.github.com/users/blogeman","html_url":"https://github.com/blogeman","followers_url":"https://api.github.com/users/blogeman/followers","following_url":"https://api.github.com/users/blogeman/following{/other_user}","gists_url":"https://api.github.com/users/blogeman/gists{/gist_id}","starred_url":"https://api.github.com/users/blogeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blogeman/subscriptions","organizations_url":"https://api.github.com/users/blogeman/orgs","repos_url":"https://api.github.com/users/blogeman/repos","events_url":"https://api.github.com/users/blogeman/events{/privacy}","received_events_url":"https://api.github.com/users/blogeman/received_events","type":"User","site_admin":false},"labels":[{"id":880550034,"node_id":"MDU6TGFiZWw4ODA1NTAwMzQ=","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false},"assignees":[{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2021-08-10T13:08:22Z","updated_at":"2021-09-13T17:25:40Z","closed_at":"2021-08-23T15:22:51Z","author_association":"NONE","active_lock_reason":null,"body":"### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Bug description\n\nI am using the (very nice) DLC GUI and have successfully trained a multi-animal model and analyzed my videos. I encounter an error upon converting to tractlets. Specifically, the error is only present if I choose to prioritize past connections (i.e. if I leave this value at 0 everything is fine but anything higher than 0 results in the error below).\r\n\r\nImportantly, a key aspect of my video is that the animals being tracked are:\r\n1) not present at the start of the video\r\n2) at times fully occluded from view\r\n\r\nThus I am assuming the error is triggered because prior connections cannot be prioritized if the previous frames do not contain any connections. Is there a work around this so that frames with no prior connections are skipped rather than causing the program to error out?\r\n\r\nThanks for the great piece of software!\n\n### Operating System\n\noperating system = Windows 10\n\n### DeepLabCut version\n\ndlc version = 2.2rc3\n\n### DeepLabCut mode\n\nmulti animal\n\n### Device type\n\ngpu = GEFORCE RTX 2080Ti\n\n### Steps To Reproduce\n\nMy hypothesis is that the error is caused because at the beginning of the video the animals are not present, thus there are no prior connections to prioritize. To reproduce this, any analyzed video where none of the tracked animals are present in the first frame(s) can be used.\n\n### Relevant log output\n\n```shell\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n~\\anaconda3\\envs\\DLC\\lib\\site-packages\\deeplabcut\\gui\\analyze_videos.py in convert2_tracklets(self, event)\r\n    412         else:\r\n    413             overwrite = False\r\n--> 414         deeplabcut.convert_detections2tracklets(\r\n    415             self.config,\r\n    416             self.filelist,\r\n\r\n~\\anaconda3\\envs\\DLC\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\predict_videos.py in convert_detections2tracklets(config, videos, videotype, shuffle, trainingsetindex, overwrite, destfolder, ignore_bodyparts, inferencecfg, modelprefix, track_method, greedy, calibrate, window_size, identity_only)\r\n   1476                     )\r\n   1477                     ass.calibrate(train_data_file)\r\n-> 1478                 ass.assemble()\r\n   1479                 ass.to_pickle(dataname.split(\".h5\")[0] + \"_assemblies.pickle\")\r\n   1480\r\n\r\n~\\anaconda3\\envs\\DLC\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\lib\\inferenceutils.py in assemble(self, chunk_size, n_processes)\r\n    721         if chunk_size == 0 or multiprocessing.get_start_method() == \"spawn\":\r\n    722             for i, data_dict in enumerate(tqdm(self)):\r\n--> 723                 assemblies, unique = self._assemble(data_dict, i)\r\n    724                 if assemblies:\r\n    725                     self.assemblies[i] = assemblies\r\n\r\n~\\anaconda3\\envs\\DLC\\lib\\site-packages\\deeplabcut\\pose_estimation_tensorflow\\lib\\inferenceutils.py in _assemble(self, data_dict, ind_frame)\r\n    646             if self.window_size >= 1:\r\n    647                 # Store selected edges for subsequent frames\r\n--> 648                 vecs = np.vstack([link.to_vector() for link in links])\r\n    649                 self._trees[ind_frame] = cKDTree(vecs)\r\n    650\r\n\r\n<__array_function__ internals> in vstack(*args, **kwargs)\r\n\r\n~\\anaconda3\\envs\\DLC\\lib\\site-packages\\numpy\\core\\shape_base.py in vstack(tup)\r\n    281     if not isinstance(arrs, list):\r\n    282         arrs = [arrs]\r\n--> 283     return _nx.concatenate(arrs, 0)\r\n    284\r\n    285\r\n\r\n<__array_function__ internals> in concatenate(*args, **kwargs)\r\n\r\nValueError: need at least one array to concatenate\n```\n\n\n### Anything else?\n\n_No response_\n\n### Code of Conduct\n\n- [X] I agree to follow this project's [Code of Conduct](https://github.com/DeepLabCut/DeepLabCut/blob/master/CODE_OF_CONDUCT.md)","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1457/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1457/timeline","performed_via_github_app":null,"state_reason":"completed"}