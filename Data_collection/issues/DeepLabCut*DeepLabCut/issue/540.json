{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/540","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/540/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/540/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/540/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/540","id":547809808,"node_id":"MDU6SXNzdWU1NDc4MDk4MDg=","number":540,"title":"LinAlgError when filtering DeepLabCut predictions using ARIMA","user":{"login":"johnmbarrett","id":19190699,"node_id":"MDQ6VXNlcjE5MTkwNjk5","avatar_url":"https://avatars.githubusercontent.com/u/19190699?v=4","gravatar_id":"","url":"https://api.github.com/users/johnmbarrett","html_url":"https://github.com/johnmbarrett","followers_url":"https://api.github.com/users/johnmbarrett/followers","following_url":"https://api.github.com/users/johnmbarrett/following{/other_user}","gists_url":"https://api.github.com/users/johnmbarrett/gists{/gist_id}","starred_url":"https://api.github.com/users/johnmbarrett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johnmbarrett/subscriptions","organizations_url":"https://api.github.com/users/johnmbarrett/orgs","repos_url":"https://api.github.com/users/johnmbarrett/repos","events_url":"https://api.github.com/users/johnmbarrett/events{/privacy}","received_events_url":"https://api.github.com/users/johnmbarrett/received_events","type":"User","site_admin":false},"labels":[{"id":1879321745,"node_id":"MDU6TGFiZWwxODc5MzIxNzQ1","url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/labels/Another%20package%20code%20issue","name":"Another package code issue","color":"91ff89","default":false,"description":"Bug/issue that relates to a dlc dependency"}],"state":"closed","locked":false,"assignee":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"assignees":[{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false}],"milestone":null,"comments":6,"created_at":"2020-01-10T01:13:43Z","updated_at":"2020-03-01T04:59:16Z","closed_at":"2020-03-01T04:59:16Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nIt is possible for DeepLabCut to produce a set of trajectories that, when filtered using the `method='arima'` argument to the `filter_predictions` function, throw a LinAlgError. I believe this to be related to a known bug in statsmodels: [https://github.com/statsmodels/statsmodels/issues/5459](https://github.com/statsmodels/statsmodels/issues/5459)\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Download the attached ipynb  and minimal DeepLabCut project folder needed to reproduce the error: [pathological_sarimax.zip](https://github.com/AlexEMG/DeepLabCut/files/4043439/pathological_sarimax.zip)\r\n2. Change the paths in the ipynb and config.yaml to point to wherever you downloaded them\r\n3. Run the IPython notebook\r\n4. You should get the error \"LinAlgError: LU decomposition error.\" The full stack trace can be seen in the notebook before you run it, but I've copied a snippet below:\r\n\r\n```\r\nLinAlgError                               Traceback (most recent call last)\r\n<ipython-input-1-f8cdb95d797e> in <module>\r\n      4 videosToAnalyse = [r'Z:\\LACIE\\DATA\\John\\Videos\\seed handling\\dlc\\Test-John-2020-01-05\\videos\\test.avi']\r\n      5 \r\n----> 6 deeplabcut.filterpredictions(path_config_file,videosToAnalyse,filtertype='arima')\r\n\r\n~\\Anaconda3\\envs\\dlc-windowsGPU\\lib\\site-packages\\deeplabcut\\post_processing\\filtering.py in filterpredictions(config, video, videotype, shuffle, trainingsetindex, filtertype, windowlength, p_bound, ARdegree, MAdegree, alpha, save_as_csv, destfolder)\r\n    113                         if filtertype=='arima':\r\n    114                             meanx,CIx=FitSARIMAXModel(x,p,p_bound,alpha,ARdegree,MAdegree,False)\r\n--> 115                             meany,CIy=FitSARIMAXModel(y,p,p_bound,alpha,ARdegree,MAdegree,False)\r\n    116 \r\n    117                             meanx[0]=x[0]\r\n\r\n...\r\n\r\nstatsmodels\\tsa\\statespace\\_representation.pyx in statsmodels.tsa.statespace._representation.dStatespace.initialize()\r\n\r\nstatsmodels\\tsa\\statespace\\_initialization.pyx in statsmodels.tsa.statespace._initialization.dInitialization.initialize()\r\n\r\nstatsmodels\\tsa\\statespace\\_initialization.pyx in statsmodels.tsa.statespace._initialization.dInitialization.initialize_stationary_stationary_cov()\r\n\r\nstatsmodels\\tsa\\statespace\\_tools.pyx in statsmodels.tsa.statespace._tools._dsolve_discrete_lyapunov()\r\n\r\nLinAlgError: LU decomposition error.\r\n```\r\n\r\n**Expected behavior**\r\nThe predictions are filtered without error.\r\n\r\n**Desktop (please complete the following information about your system):**\r\n - OS: Windows 10 x64\r\n - DeepLabCut Version: 2.1.4\r\n - Statsmodels Version: 0.10.1\r\n - Python Version: Python 3.6.9 :: Anaconda, Inc.\r\n - Browser: Firefox 71.0\r\n\r\n**Additional context**\r\nAdding `initialization='approximate_diffuse'` to the SARIMAX call, as suggested in the linked statsmodels issue, on line 217 of outlier_frames.py fixes the issue (for this video and every other one I've tried so far, at least), so maybe this could be an option in `filter_predictions`/`extract_outliner_frames`. A more general fix would be let the user pass through all the various options to the SARIMAX model, but obviously that's a lot of effort for a bug that apparently only affects one video (given no one else seems to have reported this issue as far as I can tell from searching).\r\n\r\nI appreciate this might be a fairly low priority issue if I am indeed the only DLC user to have ever run into it, so feel free to close/ignore, but I figure at least having this here will help point anyone who runs into it in the future to know which bit of the DLC code to fiddle to get around it :)","closed_by":{"login":"AlexEMG","id":20850270,"node_id":"MDQ6VXNlcjIwODUwMjcw","avatar_url":"https://avatars.githubusercontent.com/u/20850270?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexEMG","html_url":"https://github.com/AlexEMG","followers_url":"https://api.github.com/users/AlexEMG/followers","following_url":"https://api.github.com/users/AlexEMG/following{/other_user}","gists_url":"https://api.github.com/users/AlexEMG/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexEMG/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexEMG/subscriptions","organizations_url":"https://api.github.com/users/AlexEMG/orgs","repos_url":"https://api.github.com/users/AlexEMG/repos","events_url":"https://api.github.com/users/AlexEMG/events{/privacy}","received_events_url":"https://api.github.com/users/AlexEMG/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/540/reactions","total_count":3,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/540/timeline","performed_via_github_app":null,"state_reason":"completed"}