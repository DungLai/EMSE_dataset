{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1340","repository_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut","labels_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1340/labels{/name}","comments_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1340/comments","events_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1340/events","html_url":"https://github.com/DeepLabCut/DeepLabCut/issues/1340","id":926618750,"node_id":"MDU6SXNzdWU5MjY2MTg3NTA=","number":1340,"title":"Appropriate CSV file and labelled video produced but receiving AxisError","user":{"login":"MoritzSteinruecke","id":66881917,"node_id":"MDQ6VXNlcjY2ODgxOTE3","avatar_url":"https://avatars.githubusercontent.com/u/66881917?v=4","gravatar_id":"","url":"https://api.github.com/users/MoritzSteinruecke","html_url":"https://github.com/MoritzSteinruecke","followers_url":"https://api.github.com/users/MoritzSteinruecke/followers","following_url":"https://api.github.com/users/MoritzSteinruecke/following{/other_user}","gists_url":"https://api.github.com/users/MoritzSteinruecke/gists{/gist_id}","starred_url":"https://api.github.com/users/MoritzSteinruecke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MoritzSteinruecke/subscriptions","organizations_url":"https://api.github.com/users/MoritzSteinruecke/orgs","repos_url":"https://api.github.com/users/MoritzSteinruecke/repos","events_url":"https://api.github.com/users/MoritzSteinruecke/events{/privacy}","received_events_url":"https://api.github.com/users/MoritzSteinruecke/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false},"assignees":[{"login":"jeylau","id":30733203,"node_id":"MDQ6VXNlcjMwNzMzMjAz","avatar_url":"https://avatars.githubusercontent.com/u/30733203?v=4","gravatar_id":"","url":"https://api.github.com/users/jeylau","html_url":"https://github.com/jeylau","followers_url":"https://api.github.com/users/jeylau/followers","following_url":"https://api.github.com/users/jeylau/following{/other_user}","gists_url":"https://api.github.com/users/jeylau/gists{/gist_id}","starred_url":"https://api.github.com/users/jeylau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeylau/subscriptions","organizations_url":"https://api.github.com/users/jeylau/orgs","repos_url":"https://api.github.com/users/jeylau/repos","events_url":"https://api.github.com/users/jeylau/events{/privacy}","received_events_url":"https://api.github.com/users/jeylau/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2021-06-21T21:28:16Z","updated_at":"2021-06-30T21:13:13Z","closed_at":"2021-06-30T21:13:13Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\r\n\r\nThank you for developing this incredible software, I have thoroughly enjoyed using it.\r\n\r\n**Your Operating system and DeepLabCut version**\r\nOS: Windows 10\r\nDeepLabCut Version: 2.1.10.4\r\nAnaconda env used: DLC-CPU\r\n\r\n**Describe the problem**\r\nI have been using DLC to label 120 videos of mice. I started by training the network on Colab using frames from a subset of videos. I then used deeplabcut.analyze_videos() on the other videos in my set, which produced appropriate CSV files in the Google Drive folder. The appropriate plots are also produced with deeplabcut.plot_trajectories(). When I use deeplabcut.create_labeled_video() on these videos, it produces appropriately labelled videos, but I receive the following error message after the code has run. I'm not sure if this is an issue as I seem to receive all the information I need for my analysis (the CSV and labelled video).\r\n\r\nPlease place code inside this:\r\n\r\n<details><summary>Code output</summary><p>\r\n\r\n\r\n```python\r\nRemoteTraceback                           Traceback (most recent call last)\r\nRemoteTraceback: \r\n\"\"\"\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.7/multiprocessing/pool.py\", line 121, in worker\r\n    result = (True, func(*args, **kwds))\r\n  File \"/usr/lib/python3.7/multiprocessing/pool.py\", line 44, in mapstar\r\n    return list(map(*args))\r\n  File \"/usr/local/lib/python3.7/dist-packages/deeplabcut/utils/make_labeled_video.py\", line 671, in proc_video\r\n    color_by,\r\n  File \"/usr/local/lib/python3.7/dist-packages/deeplabcut/utils/make_labeled_video.py\", line 177, in CreateVideo\r\n    clip.save_frame(image)\r\n  File \"/usr/local/lib/python3.7/dist-packages/deeplabcut/utils/video_processor.py\", line 146, in save_frame\r\n    self.svid.write(np.flip(frame, 2))\r\n  File \"<__array_function__ internals>\", line 6, in flip\r\n  File \"/usr/local/lib/python3.7/dist-packages/numpy/lib/function_base.py\", line 249, in flip\r\n    axis = _nx.normalize_axis_tuple(axis, m.ndim)\r\n  File \"/usr/local/lib/python3.7/dist-packages/numpy/core/numeric.py\", line 1323, in normalize_axis_tuple\r\n    axis = tuple([normalize_axis_index(ax, ndim, argname) for ax in axis])\r\n  File \"/usr/local/lib/python3.7/dist-packages/numpy/core/numeric.py\", line 1323, in <listcomp>\r\n    axis = tuple([normalize_axis_index(ax, ndim, argname) for ax in axis])\r\nnumpy.AxisError: axis 2 is out of bounds for array of dimension 0\r\n\"\"\"\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nAxisError                                 Traceback (most recent call last)\r\n<ipython-input-11-2be3377f75ca> in <module>()\r\n----> 1 deeplabcut.create_labeled_video(path_config_file,videofile_path, videotype=VideoType)\r\n\r\n10 frames\r\n/usr/local/lib/python3.7/dist-packages/deeplabcut/utils/make_labeled_video.py in create_labeled_video(config, videos, videotype, shuffle, trainingsetindex, filtered, fastmode, save_frames, keypoints_only, Frames2plot, displayedbodyparts, displayedindividuals, codec, outputframerate, destfolder, draw_skeleton, trailpoints, displaycropped, color_by, modelprefix, track_method)\r\n    509 \r\n    510     with Pool(min(os.cpu_count(), len(Videos))) as pool:\r\n--> 511         pool.map(func, Videos)\r\n    512 \r\n    513     os.chdir(start_path)\r\n\r\n/usr/lib/python3.7/multiprocessing/pool.py in map(self, func, iterable, chunksize)\r\n    266         in a list that is returned.\r\n    267         '''\r\n--> 268         return self._map_async(func, iterable, mapstar, chunksize).get()\r\n    269 \r\n    270     def starmap(self, func, iterable, chunksize=None):\r\n\r\n/usr/lib/python3.7/multiprocessing/pool.py in get(self, timeout)\r\n    655             return self._value\r\n    656         else:\r\n--> 657             raise self._value\r\n    658 \r\n    659     def _set(self, i, obj):\r\n\r\n/usr/lib/python3.7/multiprocessing/pool.py in worker()\r\n    119         job, i, func, args, kwds = task\r\n    120         try:\r\n--> 121             result = (True, func(*args, **kwds))\r\n    122         except Exception as e:\r\n    123             if wrap_exception and func is not _helper_reraises_exception:\r\n\r\n/usr/lib/python3.7/multiprocessing/pool.py in mapstar()\r\n     42 \r\n     43 def mapstar(args):\r\n---> 44     return list(map(*args))\r\n     45 \r\n     46 def starmapstar(args):\r\n\r\n/usr/local/lib/python3.7/dist-packages/deeplabcut/utils/make_labeled_video.py in proc_video()\r\n    669                     draw_skeleton,\r\n    670                     displaycropped,\r\n--> 671                     color_by,\r\n    672                 )\r\n    673 \r\n\r\n/usr/local/lib/python3.7/dist-packages/deeplabcut/utils/make_labeled_video.py in CreateVideo()\r\n    175                     image[rr, cc] = color\r\n    176 \r\n--> 177             clip.save_frame(image)\r\n    178     clip.close()\r\n    179 \r\n\r\n/usr/local/lib/python3.7/dist-packages/deeplabcut/utils/video_processor.py in save_frame()\r\n    144 \r\n    145     def save_frame(self, frame):\r\n--> 146         self.svid.write(np.flip(frame, 2))\r\n    147 \r\n    148     def close(self):\r\n\r\n<__array_function__ internals> in flip()\r\n\r\n/usr/local/lib/python3.7/dist-packages/numpy/lib/function_base.py in flip()\r\n    247         indexer = (np.s_[::-1],) * m.ndim\r\n    248     else:\r\n--> 249         axis = _nx.normalize_axis_tuple(axis, m.ndim)\r\n    250         indexer = [np.s_[:]] * m.ndim\r\n    251         for ax in axis:\r\n\r\n/usr/local/lib/python3.7/dist-packages/numpy/core/numeric.py in normalize_axis_tuple()\r\n   1321             pass\r\n   1322     # Going via an iterator directly is slower than via list comprehension.\r\n-> 1323     axis = tuple([normalize_axis_index(ax, ndim, argname) for ax in axis])\r\n   1324     if not allow_duplicate and len(set(axis)) != len(axis):\r\n   1325         if argname:\r\n\r\n/usr/local/lib/python3.7/dist-packages/numpy/core/numeric.py in <listcomp>()\r\n   1321             pass\r\n   1322     # Going via an iterator directly is slower than via list comprehension.\r\n-> 1323     axis = tuple([normalize_axis_index(ax, ndim, argname) for ax in axis])\r\n   1324     if not allow_duplicate and len(set(axis)) != len(axis):\r\n   1325         if argname:\r\n\r\nAxisError: axis 2 is out of bounds for array of dimension 0\r\n```\r\n\r\n</p></details>\r\n\r\n**How to Reproduce the problem**\r\nSteps to reproduce the behavior:\r\n1. Create new project, label frames from a subset of videos and train the network on Colab\r\n2. Run deeplabcut.analyze_videos(path_config_file,videofile_path, videotype=VideoType, save_as_csv=True) and deeplabcut.create_labeled_video(path_config_file,videofile_path, videotype=VideoType) on a new video\r\n3. See error\r\n\r\n\r\nThanks very much for your help!\r\nMoritz","closed_by":{"login":"MMathisLab","id":28102185,"node_id":"MDQ6VXNlcjI4MTAyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/28102185?v=4","gravatar_id":"","url":"https://api.github.com/users/MMathisLab","html_url":"https://github.com/MMathisLab","followers_url":"https://api.github.com/users/MMathisLab/followers","following_url":"https://api.github.com/users/MMathisLab/following{/other_user}","gists_url":"https://api.github.com/users/MMathisLab/gists{/gist_id}","starred_url":"https://api.github.com/users/MMathisLab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MMathisLab/subscriptions","organizations_url":"https://api.github.com/users/MMathisLab/orgs","repos_url":"https://api.github.com/users/MMathisLab/repos","events_url":"https://api.github.com/users/MMathisLab/events{/privacy}","received_events_url":"https://api.github.com/users/MMathisLab/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/DeepLabCut/DeepLabCut/issues/1340/timeline","performed_via_github_app":null,"state_reason":"completed"}