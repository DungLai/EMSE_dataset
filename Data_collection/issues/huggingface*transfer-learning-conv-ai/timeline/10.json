[{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/495048921","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-495048921","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":495048921,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTA0ODkyMQ==","user":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false},"created_at":"2019-05-23T02:58:24Z","updated_at":"2019-05-23T03:26:25Z","author_association":"NONE","body":"Since the above stacktrace ends at the `torch.addmm()` call happening in modeling_openai.py, I hypothesized that perhaps the addmm() op doesn't play well with the pytorch_p36 env in my EC2 instance. So I tried to reproduce the above RuntimeError in the interpreter in the instance (with the pytorch_p36 env activated).\r\n\r\n```\r\n>>> import torch\r\n>>> a = torch.randn(2,3)\r\n>>> b = torch.randn(3,2)\r\n>>> c = torch.randn(2,2)\r\n>>> x = torch.addmm(c,a,b)\r\n```\r\n\r\nThe above worked perfectly fine. So I do not think the issue is due to the addmm() op itself, but I'm confused how to proceed.\r\n\r\nMy best hypothesis is that the matrix multiplication happening internally is instantiating memory, causing this failure, but if that were the case, we'd see many more similar issues on GitHub :)","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/495048921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/495391270","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-495391270","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":495391270,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTM5MTI3MA==","user":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false},"created_at":"2019-05-23T21:26:37Z","updated_at":"2019-05-23T21:26:37Z","author_association":"NONE","body":"I printed the shapes of the tensors `self.bias `, `x.view(-1, x.size(-1)) ` and `self.weight ` right before the above failure in the forward pass. The shapes were `torch.Size([2304])`, `torch.Size([12560, 768])` and `torch.Size([768, 2304])` respectively.\r\n\r\nSo I did the following test:\r\n```\r\n>>> a = torch.randn(2304).cuda()\r\n>>> b = torch.randn(12560, 768).cuda()\r\n>>> c = torch.randn(768, 2304).cuda()\r\n>>> a.shape\r\ntorch.Size([2304])\r\n>>> b.shape\r\ntorch.Size([12560, 768])\r\n>>> c.shape\r\ntorch.Size([768, 2304])\r\n>>> x = torch.addmm(a,b,c)\r\n>>>\r\n```\r\n\r\nThe above test worked fine - no CUDA resource allocation errors. So I really am clueless at this point.","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/495391270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/495425834","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-495425834","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":495425834,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTQyNTgzNA==","user":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false},"created_at":"2019-05-24T00:00:59Z","updated_at":"2019-05-24T00:00:59Z","author_association":"NONE","body":"@thomwolf do you have any thoughts?","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/495425834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false}},{"id":2364054167,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjM2NDA1NDE2Nw==","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/2364054167","actor":{"login":"thomwolf","id":7353373,"node_id":"MDQ6VXNlcjczNTMzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/7353373?v=4","gravatar_id":"","url":"https://api.github.com/users/thomwolf","html_url":"https://github.com/thomwolf","followers_url":"https://api.github.com/users/thomwolf/followers","following_url":"https://api.github.com/users/thomwolf/following{/other_user}","gists_url":"https://api.github.com/users/thomwolf/gists{/gist_id}","starred_url":"https://api.github.com/users/thomwolf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomwolf/subscriptions","organizations_url":"https://api.github.com/users/thomwolf/orgs","repos_url":"https://api.github.com/users/thomwolf/repos","events_url":"https://api.github.com/users/thomwolf/events{/privacy}","received_events_url":"https://api.github.com/users/thomwolf/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-24T00:00:59Z","performed_via_github_app":null},{"id":2364054169,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzNjQwNTQxNjk=","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/2364054169","actor":{"login":"thomwolf","id":7353373,"node_id":"MDQ6VXNlcjczNTMzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/7353373?v=4","gravatar_id":"","url":"https://api.github.com/users/thomwolf","html_url":"https://github.com/thomwolf","followers_url":"https://api.github.com/users/thomwolf/followers","following_url":"https://api.github.com/users/thomwolf/following{/other_user}","gists_url":"https://api.github.com/users/thomwolf/gists{/gist_id}","starred_url":"https://api.github.com/users/thomwolf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomwolf/subscriptions","organizations_url":"https://api.github.com/users/thomwolf/orgs","repos_url":"https://api.github.com/users/thomwolf/repos","events_url":"https://api.github.com/users/thomwolf/events{/privacy}","received_events_url":"https://api.github.com/users/thomwolf/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-24T00:00:59Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/495492799","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-495492799","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":495492799,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTQ5Mjc5OQ==","user":{"login":"thomwolf","id":7353373,"node_id":"MDQ6VXNlcjczNTMzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/7353373?v=4","gravatar_id":"","url":"https://api.github.com/users/thomwolf","html_url":"https://github.com/thomwolf","followers_url":"https://api.github.com/users/thomwolf/followers","following_url":"https://api.github.com/users/thomwolf/following{/other_user}","gists_url":"https://api.github.com/users/thomwolf/gists{/gist_id}","starred_url":"https://api.github.com/users/thomwolf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomwolf/subscriptions","organizations_url":"https://api.github.com/users/thomwolf/orgs","repos_url":"https://api.github.com/users/thomwolf/repos","events_url":"https://api.github.com/users/thomwolf/events{/privacy}","received_events_url":"https://api.github.com/users/thomwolf/received_events","type":"User","site_admin":false},"created_at":"2019-05-24T06:46:25Z","updated_at":"2019-05-24T06:47:20Z","author_association":"MEMBER","body":"You can try with:\r\n- a batch size of 1 to be sure you are not just out-of-memory (`--train_batch_size 1 --valid_batch_size 1`)\r\n- `CUDA_LAUNCH_BLOCKING=1` before the `python train.py` to be sure where the error comes from","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/495492799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"thomwolf","id":7353373,"node_id":"MDQ6VXNlcjczNTMzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/7353373?v=4","gravatar_id":"","url":"https://api.github.com/users/thomwolf","html_url":"https://github.com/thomwolf","followers_url":"https://api.github.com/users/thomwolf/followers","following_url":"https://api.github.com/users/thomwolf/following{/other_user}","gists_url":"https://api.github.com/users/thomwolf/gists{/gist_id}","starred_url":"https://api.github.com/users/thomwolf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomwolf/subscriptions","organizations_url":"https://api.github.com/users/thomwolf/orgs","repos_url":"https://api.github.com/users/thomwolf/repos","events_url":"https://api.github.com/users/thomwolf/events{/privacy}","received_events_url":"https://api.github.com/users/thomwolf/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/495666823","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-495666823","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":495666823,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTY2NjgyMw==","user":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false},"created_at":"2019-05-24T14:59:14Z","updated_at":"2019-05-24T14:59:14Z","author_association":"NONE","body":"I already tried with a batch size of 1. The tensors were smaller in shape,\nbut the exact same error repeated.\n\nOn Thu, May 23, 2019, 11:46 PM Thomas Wolf <notifications@github.com> wrote:\n\n> You can try with:\n>\n>    - a batch size of 1 to be sure you are not just out-of-memory\n>    - CUDA_LAUNCH_BLOCKING=1 before the python train.py to be sure where\n>    the error comes from\n>\n> —\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/huggingface/transfer-learning-conv-ai/issues/10?email_source=notifications&email_token=AA5MNWLLBWVPQX3XMOJIXODPW6FMFA5CNFSM4HOZKZSKYY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGODWEJ5PY#issuecomment-495492799>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AA5MNWKSA4OFMWOVKPXGDI3PW6FMFANCNFSM4HOZKZSA>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/495666823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/496111466","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-496111466","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":496111466,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjExMTQ2Ng==","user":{"login":"thomwolf","id":7353373,"node_id":"MDQ6VXNlcjczNTMzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/7353373?v=4","gravatar_id":"","url":"https://api.github.com/users/thomwolf","html_url":"https://github.com/thomwolf","followers_url":"https://api.github.com/users/thomwolf/followers","following_url":"https://api.github.com/users/thomwolf/following{/other_user}","gists_url":"https://api.github.com/users/thomwolf/gists{/gist_id}","starred_url":"https://api.github.com/users/thomwolf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomwolf/subscriptions","organizations_url":"https://api.github.com/users/thomwolf/orgs","repos_url":"https://api.github.com/users/thomwolf/repos","events_url":"https://api.github.com/users/thomwolf/events{/privacy}","received_events_url":"https://api.github.com/users/thomwolf/received_events","type":"User","site_admin":false},"created_at":"2019-05-27T07:35:52Z","updated_at":"2019-05-27T07:35:52Z","author_association":"MEMBER","body":"and with `CUDA_LAUNCH_BLOCKING=1`, What exact error message do you get?","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/496111466/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"thomwolf","id":7353373,"node_id":"MDQ6VXNlcjczNTMzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/7353373?v=4","gravatar_id":"","url":"https://api.github.com/users/thomwolf","html_url":"https://github.com/thomwolf","followers_url":"https://api.github.com/users/thomwolf/followers","following_url":"https://api.github.com/users/thomwolf/following{/other_user}","gists_url":"https://api.github.com/users/thomwolf/gists{/gist_id}","starred_url":"https://api.github.com/users/thomwolf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomwolf/subscriptions","organizations_url":"https://api.github.com/users/thomwolf/orgs","repos_url":"https://api.github.com/users/thomwolf/repos","events_url":"https://api.github.com/users/thomwolf/events{/privacy}","received_events_url":"https://api.github.com/users/thomwolf/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/496726894","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-496726894","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":496726894,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjcyNjg5NA==","user":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false},"created_at":"2019-05-28T23:27:55Z","updated_at":"2019-05-28T23:27:55Z","author_association":"NONE","body":"@thomwolf here's a part of the error I get with that flag set:\r\n\r\n```\r\n/opt/conda/conda-bld/pytorch_1544199946412/work/aten/src/THC/THCTensorIndex.cu:362: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2, IndexIsMajor = true]: block: [85,0,0], thread: [27,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\r\n/opt/conda/conda-bld/pytorch_1544199946412/work/aten/src/THC/THCTensorIndex.cu:362: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2, IndexIsMajor = true]: block: [85,0,0], thread: [28,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\r\n/opt/conda/conda-bld/pytorch_1544199946412/work/aten/src/THC/THCTensorIndex.cu:362: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2, IndexIsMajor = true]: block: [85,0,0], thread: [29,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\r\n/opt/conda/conda-bld/pytorch_1544199946412/work/aten/src/THC/THCTensorIndex.cu:362: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2, IndexIsMajor = true]: block: [85,0,0], thread: [30,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\r\n/opt/conda/conda-bld/pytorch_1544199946412/work/aten/src/THC/THCTensorIndex.cu:362: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2, IndexIsMajor = true]: block: [85,0,0], thread: [31,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\r\nERROR:ignite.engine.engine.Engine:Current run is terminating due to exception: CUDA error: device-side assert triggered.\r\nERROR:ignite.engine.engine.Engine:Engine run is terminating due to exception: CUDA error: device-side assert triggered.\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 358, in <module>\r\n    train()\r\n  File \"train.py\", line 349, in train\r\n    trainer.run(train_loader, max_epochs=args.n_epochs)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/ignite/engine/engine.py\", line 388, in run\r\n    self._handle_exception(e)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/ignite/engine/engine.py\", line 352, in _handle_exception\r\n    raise e\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/ignite/engine/engine.py\", line 375, in run\r\n    hours, mins, secs = self._run_once_on_dataset()\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/ignite/engine/engine.py\", line 341, in _run_once_on_dataset\r\n    self._handle_exception(e)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/ignite/engine/engine.py\", line 352, in _handle_exception\r\n    raise e\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/ignite/engine/engine.py\", line 333, in _run_once_on_dataset\r\n    self.state.output = self._process_function(self, batch)\r\n  File \"train.py\", line 275, in update\r\n    lm_loss, mc_loss = model(*batch)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/pytorch_pretrained_bert/modeling_openai.py\", line 811, in forward\r\n    hidden_states = self.transformer(input_ids, position_ids, token_type_ids)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/pytorch_pretrained_bert/modeling_openai.py\", line 639, in forward\r\n    token_type_embeds = self.tokens_embed(token_type_ids)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/modules/sparse.py\", line 118, in forward\r\n    self.norm_type, self.scale_grad_by_freq, self.sparse)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/functional.py\", line 1454, in embedding\r\n    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)\r\nRuntimeError: CUDA error: device-side assert triggered\r\n```","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/496726894/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false}},{"id":2373406349,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjM3MzQwNjM0OQ==","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/2373406349","actor":{"login":"thomwolf","id":7353373,"node_id":"MDQ6VXNlcjczNTMzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/7353373?v=4","gravatar_id":"","url":"https://api.github.com/users/thomwolf","html_url":"https://github.com/thomwolf","followers_url":"https://api.github.com/users/thomwolf/followers","following_url":"https://api.github.com/users/thomwolf/following{/other_user}","gists_url":"https://api.github.com/users/thomwolf/gists{/gist_id}","starred_url":"https://api.github.com/users/thomwolf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomwolf/subscriptions","organizations_url":"https://api.github.com/users/thomwolf/orgs","repos_url":"https://api.github.com/users/thomwolf/repos","events_url":"https://api.github.com/users/thomwolf/events{/privacy}","received_events_url":"https://api.github.com/users/thomwolf/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-28T23:27:56Z","performed_via_github_app":null},{"id":2373406351,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzNzM0MDYzNTE=","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/2373406351","actor":{"login":"thomwolf","id":7353373,"node_id":"MDQ6VXNlcjczNTMzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/7353373?v=4","gravatar_id":"","url":"https://api.github.com/users/thomwolf","html_url":"https://github.com/thomwolf","followers_url":"https://api.github.com/users/thomwolf/followers","following_url":"https://api.github.com/users/thomwolf/following{/other_user}","gists_url":"https://api.github.com/users/thomwolf/gists{/gist_id}","starred_url":"https://api.github.com/users/thomwolf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomwolf/subscriptions","organizations_url":"https://api.github.com/users/thomwolf/orgs","repos_url":"https://api.github.com/users/thomwolf/repos","events_url":"https://api.github.com/users/thomwolf/events{/privacy}","received_events_url":"https://api.github.com/users/thomwolf/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-28T23:27:56Z","performed_via_github_app":null},{"id":2376702379,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjM3NjcwMjM3OQ==","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/2376702379","actor":{"login":"thomwolf","id":7353373,"node_id":"MDQ6VXNlcjczNTMzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/7353373?v=4","gravatar_id":"","url":"https://api.github.com/users/thomwolf","html_url":"https://github.com/thomwolf","followers_url":"https://api.github.com/users/thomwolf/followers","following_url":"https://api.github.com/users/thomwolf/following{/other_user}","gists_url":"https://api.github.com/users/thomwolf/gists{/gist_id}","starred_url":"https://api.github.com/users/thomwolf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomwolf/subscriptions","organizations_url":"https://api.github.com/users/thomwolf/orgs","repos_url":"https://api.github.com/users/thomwolf/repos","events_url":"https://api.github.com/users/thomwolf/events{/privacy}","received_events_url":"https://api.github.com/users/thomwolf/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-29T23:29:56Z","performed_via_github_app":null},{"id":2376702381,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzNzY3MDIzODE=","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/2376702381","actor":{"login":"thomwolf","id":7353373,"node_id":"MDQ6VXNlcjczNTMzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/7353373?v=4","gravatar_id":"","url":"https://api.github.com/users/thomwolf","html_url":"https://github.com/thomwolf","followers_url":"https://api.github.com/users/thomwolf/followers","following_url":"https://api.github.com/users/thomwolf/following{/other_user}","gists_url":"https://api.github.com/users/thomwolf/gists{/gist_id}","starred_url":"https://api.github.com/users/thomwolf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomwolf/subscriptions","organizations_url":"https://api.github.com/users/thomwolf/orgs","repos_url":"https://api.github.com/users/thomwolf/repos","events_url":"https://api.github.com/users/thomwolf/events{/privacy}","received_events_url":"https://api.github.com/users/thomwolf/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-29T23:29:56Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/497457359","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-497457359","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":497457359,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzQ1NzM1OQ==","user":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false},"created_at":"2019-05-30T19:36:34Z","updated_at":"2019-05-30T19:36:34Z","author_association":"NONE","body":"Okay, I think the reason I'm facing these embedding matrix index out of bounds errors is that my dataset has really long utterances and the default config in `OpenAIGPTConfig` (like `n_positions=512`) is insufficient to handle the utterances in my dataset.","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/497457359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/497547896","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-497547896","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":497547896,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzU0Nzg5Ng==","user":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false},"created_at":"2019-05-31T02:02:13Z","updated_at":"2019-05-31T02:02:13Z","author_association":"NONE","body":"@thomwolf I think I have figured this out. Let me know what you think.\r\n\r\nhttps://github.com/huggingface/transfer-learning-conv-ai/blob/b7f295f840f719056287504554083ec3f2688651/train.py#L55\r\n\r\nIf `len(instance[\"input_ids\"])` above is greater than 512 (which is the default value of `n_positions` in `OpenAIGPTConfig` in modeling_openai.py in pytorch-pretrained-bert), then the position_ids created in the below link will contain values much larger than 512.\r\n\r\nhttps://github.com/huggingface/pytorch-pretrained-BERT/blob/372a5c1ceec49b52c503707e9657bfaae7c236a0/pytorch_pretrained_bert/modeling_openai.py#L620\r\n\r\nConsequently, this line (https://github.com/huggingface/pytorch-pretrained-BERT/blob/372a5c1ceec49b52c503707e9657bfaae7c236a0/pytorch_pretrained_bert/modeling_openai.py#L633) will fail.\r\n\r\nI think you need to add truncation logic for the `sequence` above prior to doing `instance[\"input_ids\"] = list(chain(*sequence))` so that the length is always less than or equal to 512.","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/497547896/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false}},{"id":2379744545,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjM3OTc0NDU0NQ==","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/2379744545","actor":{"login":"thomwolf","id":7353373,"node_id":"MDQ6VXNlcjczNTMzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/7353373?v=4","gravatar_id":"","url":"https://api.github.com/users/thomwolf","html_url":"https://github.com/thomwolf","followers_url":"https://api.github.com/users/thomwolf/followers","following_url":"https://api.github.com/users/thomwolf/following{/other_user}","gists_url":"https://api.github.com/users/thomwolf/gists{/gist_id}","starred_url":"https://api.github.com/users/thomwolf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomwolf/subscriptions","organizations_url":"https://api.github.com/users/thomwolf/orgs","repos_url":"https://api.github.com/users/thomwolf/repos","events_url":"https://api.github.com/users/thomwolf/events{/privacy}","received_events_url":"https://api.github.com/users/thomwolf/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-31T02:02:13Z","performed_via_github_app":null},{"id":2379744546,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzNzk3NDQ1NDY=","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/2379744546","actor":{"login":"thomwolf","id":7353373,"node_id":"MDQ6VXNlcjczNTMzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/7353373?v=4","gravatar_id":"","url":"https://api.github.com/users/thomwolf","html_url":"https://github.com/thomwolf","followers_url":"https://api.github.com/users/thomwolf/followers","following_url":"https://api.github.com/users/thomwolf/following{/other_user}","gists_url":"https://api.github.com/users/thomwolf/gists{/gist_id}","starred_url":"https://api.github.com/users/thomwolf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomwolf/subscriptions","organizations_url":"https://api.github.com/users/thomwolf/orgs","repos_url":"https://api.github.com/users/thomwolf/repos","events_url":"https://api.github.com/users/thomwolf/events{/privacy}","received_events_url":"https://api.github.com/users/thomwolf/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-31T02:02:13Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/498534683","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-498534683","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":498534683,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODUzNDY4Mw==","user":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false},"created_at":"2019-06-04T06:08:29Z","updated_at":"2019-06-04T06:08:29Z","author_association":"NONE","body":"I added some truncation code and managed to resolve the error corresponding to the previous stack trace. But I'm now facing a different stack trace (with `CUDA_LAUNCH_BLOCKING=1`):\r\n\r\n```\r\n/opt/conda/conda-bld/pytorch_1556653099582/work/aten/src/THC/THCTensorIndex.cu:362: void indexSelectLargeIndex(TensorInfo<T, IndexType>, TensorInfo<T, IndexType>, TensorInfo<long, IndexType>, int, int, IndexType, IndexType, long) [with T = float, IndexType = unsigned int, DstDim = 2, SrcDim = 2, IdxDim = -2, IndexIsMajor = true]: block: [637,0,0], thread: [63,0,0] Assertion `srcIndex < srcSelectDimSize` failed.\r\nERROR:ignite.engine.engine.Engine:Current run is terminating due to exception: CUDA error: device-side assert triggered.\r\nERROR:ignite.engine.engine.Engine:Engine run is terminating due to exception: CUDA error: device-side assert triggered.\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 376, in <module>\r\n    train()\r\n  File \"train.py\", line 367, in train\r\n    trainer.run(train_loader, max_epochs=args.n_epochs)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/ignite/engine/engine.py\", line 388, in run\r\n    self._handle_exception(e)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/ignite/engine/engine.py\", line 352, in _handle_exception\r\n    raise e\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/ignite/engine/engine.py\", line 375, in run\r\n    hours, mins, secs = self._run_once_on_dataset()\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/ignite/engine/engine.py\", line 341, in _run_once_on_dataset\r\n    self._handle_exception(e)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/ignite/engine/engine.py\", line 352, in _handle_exception\r\n    raise e\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/ignite/engine/engine.py\", line 333, in _run_once_on_dataset\r\n    self.state.output = self._process_function(self, batch)\r\n  File \"train.py\", line 293, in update\r\n    lm_loss, mc_loss = model(*batch)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 493, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/parallel/distributed.py\", line 376, in forward\r\n    output = self.module(*inputs[0], **kwargs[0])\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 493, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/pytorch_pretrained_bert/modeling_openai.py\", line 808, in forward\r\n    hidden_states = self.transformer(input_ids, position_ids, token_type_ids)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 493, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/pytorch_pretrained_bert/modeling_openai.py\", line 641, in forward\r\n    hidden_states = inputs_embeds + position_embeds + token_type_embeds\r\nRuntimeError: CUDA error: device-side assert triggered\r\n\r\n```\r\n\r\nAs a quick next step, I'm going to print the shapes of `inputs_embeds`, `position_embeds` and `token_type_embeds` to see if they're all the same shape.","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/498534683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/499296101","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-499296101","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":499296101,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTI5NjEwMQ==","user":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false},"created_at":"2019-06-05T23:45:49Z","updated_at":"2019-06-05T23:45:49Z","author_association":"NONE","body":"Not sure why I got the above failure, but things seem to be working fine now.","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/499296101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false}},{"id":2392815837,"node_id":"MDExOkNsb3NlZEV2ZW50MjM5MjgxNTgzNw==","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/2392815837","actor":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-06-05T23:45:49Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/519538580","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-519538580","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":519538580,"node_id":"MDEyOklzc3VlQ29tbWVudDUxOTUzODU4MA==","user":{"login":"sashank06","id":8636933,"node_id":"MDQ6VXNlcjg2MzY5MzM=","avatar_url":"https://avatars.githubusercontent.com/u/8636933?v=4","gravatar_id":"","url":"https://api.github.com/users/sashank06","html_url":"https://github.com/sashank06","followers_url":"https://api.github.com/users/sashank06/followers","following_url":"https://api.github.com/users/sashank06/following{/other_user}","gists_url":"https://api.github.com/users/sashank06/gists{/gist_id}","starred_url":"https://api.github.com/users/sashank06/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sashank06/subscriptions","organizations_url":"https://api.github.com/users/sashank06/orgs","repos_url":"https://api.github.com/users/sashank06/repos","events_url":"https://api.github.com/users/sashank06/events{/privacy}","received_events_url":"https://api.github.com/users/sashank06/received_events","type":"User","site_admin":false},"created_at":"2019-08-08T14:19:29Z","updated_at":"2019-08-08T14:19:29Z","author_association":"NONE","body":"@g-karthik I think the device-side assert error triggered is due to the position embedding which is limited to 512 in size and your input size dimension sequence length is greater than that in the training loader ","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/519538580/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sashank06","id":8636933,"node_id":"MDQ6VXNlcjg2MzY5MzM=","avatar_url":"https://avatars.githubusercontent.com/u/8636933?v=4","gravatar_id":"","url":"https://api.github.com/users/sashank06","html_url":"https://github.com/sashank06","followers_url":"https://api.github.com/users/sashank06/followers","following_url":"https://api.github.com/users/sashank06/following{/other_user}","gists_url":"https://api.github.com/users/sashank06/gists{/gist_id}","starred_url":"https://api.github.com/users/sashank06/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sashank06/subscriptions","organizations_url":"https://api.github.com/users/sashank06/orgs","repos_url":"https://api.github.com/users/sashank06/repos","events_url":"https://api.github.com/users/sashank06/events{/privacy}","received_events_url":"https://api.github.com/users/sashank06/received_events","type":"User","site_admin":false}},{"id":2543530471,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjU0MzUzMDQ3MQ==","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/2543530471","actor":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-08-08T14:19:29Z","performed_via_github_app":null},{"id":2543530474,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI1NDM1MzA0NzQ=","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/2543530474","actor":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-08-08T14:19:29Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/519565020","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-519565020","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":519565020,"node_id":"MDEyOklzc3VlQ29tbWVudDUxOTU2NTAyMA==","user":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false},"created_at":"2019-08-08T15:21:49Z","updated_at":"2019-08-08T15:21:49Z","author_association":"NONE","body":"@sashank06 yes that is correct, I had realized it back then after a bunch of debugging, and I forgot to update this issue! Thanks for the reminder!","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/519565020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false}},{"id":2543752536,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjU0Mzc1MjUzNg==","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/2543752536","actor":{"login":"sashank06","id":8636933,"node_id":"MDQ6VXNlcjg2MzY5MzM=","avatar_url":"https://avatars.githubusercontent.com/u/8636933?v=4","gravatar_id":"","url":"https://api.github.com/users/sashank06","html_url":"https://github.com/sashank06","followers_url":"https://api.github.com/users/sashank06/followers","following_url":"https://api.github.com/users/sashank06/following{/other_user}","gists_url":"https://api.github.com/users/sashank06/gists{/gist_id}","starred_url":"https://api.github.com/users/sashank06/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sashank06/subscriptions","organizations_url":"https://api.github.com/users/sashank06/orgs","repos_url":"https://api.github.com/users/sashank06/repos","events_url":"https://api.github.com/users/sashank06/events{/privacy}","received_events_url":"https://api.github.com/users/sashank06/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-08-08T15:21:49Z","performed_via_github_app":null},{"id":2543752538,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI1NDM3NTI1Mzg=","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/2543752538","actor":{"login":"sashank06","id":8636933,"node_id":"MDQ6VXNlcjg2MzY5MzM=","avatar_url":"https://avatars.githubusercontent.com/u/8636933?v=4","gravatar_id":"","url":"https://api.github.com/users/sashank06","html_url":"https://github.com/sashank06","followers_url":"https://api.github.com/users/sashank06/followers","following_url":"https://api.github.com/users/sashank06/following{/other_user}","gists_url":"https://api.github.com/users/sashank06/gists{/gist_id}","starred_url":"https://api.github.com/users/sashank06/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sashank06/subscriptions","organizations_url":"https://api.github.com/users/sashank06/orgs","repos_url":"https://api.github.com/users/sashank06/repos","events_url":"https://api.github.com/users/sashank06/events{/privacy}","received_events_url":"https://api.github.com/users/sashank06/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-08-08T15:21:49Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/630837012","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-630837012","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":630837012,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMDgzNzAxMg==","user":{"login":"dishavarshney082","id":57398409,"node_id":"MDQ6VXNlcjU3Mzk4NDA5","avatar_url":"https://avatars.githubusercontent.com/u/57398409?v=4","gravatar_id":"","url":"https://api.github.com/users/dishavarshney082","html_url":"https://github.com/dishavarshney082","followers_url":"https://api.github.com/users/dishavarshney082/followers","following_url":"https://api.github.com/users/dishavarshney082/following{/other_user}","gists_url":"https://api.github.com/users/dishavarshney082/gists{/gist_id}","starred_url":"https://api.github.com/users/dishavarshney082/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dishavarshney082/subscriptions","organizations_url":"https://api.github.com/users/dishavarshney082/orgs","repos_url":"https://api.github.com/users/dishavarshney082/repos","events_url":"https://api.github.com/users/dishavarshney082/events{/privacy}","received_events_url":"https://api.github.com/users/dishavarshney082/received_events","type":"User","site_admin":false},"created_at":"2020-05-19T13:58:33Z","updated_at":"2020-05-19T13:58:33Z","author_association":"NONE","body":"> @sashank06 yes that is correct, I had realized it back then after a bunch of debugging, and I forgot to update this issue! Thanks for the reminder!\r\n\r\nHow did you do the truncation? I mean wouldn't there be loss of information if we just omit the words > 512 length?","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/630837012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dishavarshney082","id":57398409,"node_id":"MDQ6VXNlcjU3Mzk4NDA5","avatar_url":"https://avatars.githubusercontent.com/u/57398409?v=4","gravatar_id":"","url":"https://api.github.com/users/dishavarshney082","html_url":"https://github.com/dishavarshney082","followers_url":"https://api.github.com/users/dishavarshney082/followers","following_url":"https://api.github.com/users/dishavarshney082/following{/other_user}","gists_url":"https://api.github.com/users/dishavarshney082/gists{/gist_id}","starred_url":"https://api.github.com/users/dishavarshney082/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dishavarshney082/subscriptions","organizations_url":"https://api.github.com/users/dishavarshney082/orgs","repos_url":"https://api.github.com/users/dishavarshney082/repos","events_url":"https://api.github.com/users/dishavarshney082/events{/privacy}","received_events_url":"https://api.github.com/users/dishavarshney082/received_events","type":"User","site_admin":false}},{"id":3351976721,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzM1MTk3NjcyMQ==","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/3351976721","actor":{"login":"sashank06","id":8636933,"node_id":"MDQ6VXNlcjg2MzY5MzM=","avatar_url":"https://avatars.githubusercontent.com/u/8636933?v=4","gravatar_id":"","url":"https://api.github.com/users/sashank06","html_url":"https://github.com/sashank06","followers_url":"https://api.github.com/users/sashank06/followers","following_url":"https://api.github.com/users/sashank06/following{/other_user}","gists_url":"https://api.github.com/users/sashank06/gists{/gist_id}","starred_url":"https://api.github.com/users/sashank06/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sashank06/subscriptions","organizations_url":"https://api.github.com/users/sashank06/orgs","repos_url":"https://api.github.com/users/sashank06/repos","events_url":"https://api.github.com/users/sashank06/events{/privacy}","received_events_url":"https://api.github.com/users/sashank06/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-05-19T13:58:33Z","performed_via_github_app":null},{"id":3351976723,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMzNTE5NzY3MjM=","url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/events/3351976723","actor":{"login":"sashank06","id":8636933,"node_id":"MDQ6VXNlcjg2MzY5MzM=","avatar_url":"https://avatars.githubusercontent.com/u/8636933?v=4","gravatar_id":"","url":"https://api.github.com/users/sashank06","html_url":"https://github.com/sashank06","followers_url":"https://api.github.com/users/sashank06/followers","following_url":"https://api.github.com/users/sashank06/following{/other_user}","gists_url":"https://api.github.com/users/sashank06/gists{/gist_id}","starred_url":"https://api.github.com/users/sashank06/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sashank06/subscriptions","organizations_url":"https://api.github.com/users/sashank06/orgs","repos_url":"https://api.github.com/users/sashank06/repos","events_url":"https://api.github.com/users/sashank06/events{/privacy}","received_events_url":"https://api.github.com/users/sashank06/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-05-19T13:58:33Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/631125209","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/10#issuecomment-631125209","issue_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/10","id":631125209,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMTEyNTIwOQ==","user":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false},"created_at":"2020-05-19T22:41:33Z","updated_at":"2020-05-19T22:41:33Z","author_association":"NONE","body":"@geekygirl123 You can do the truncation of individual components of your `input_ids`, while ensuring `len(input_ids) <= 512` for GPT. For example, you can truncate the dialog context to comprise just the recent turns.\r\n\r\nYes, there would be a loss of information if you truncated the dialog context this way, but it is something you could live with from a perf-POV.","reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/comments/631125209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"g-karthik","id":3851993,"node_id":"MDQ6VXNlcjM4NTE5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3851993?v=4","gravatar_id":"","url":"https://api.github.com/users/g-karthik","html_url":"https://github.com/g-karthik","followers_url":"https://api.github.com/users/g-karthik/followers","following_url":"https://api.github.com/users/g-karthik/following{/other_user}","gists_url":"https://api.github.com/users/g-karthik/gists{/gist_id}","starred_url":"https://api.github.com/users/g-karthik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-karthik/subscriptions","organizations_url":"https://api.github.com/users/g-karthik/orgs","repos_url":"https://api.github.com/users/g-karthik/repos","events_url":"https://api.github.com/users/g-karthik/events{/privacy}","received_events_url":"https://api.github.com/users/g-karthik/received_events","type":"User","site_admin":false}}]