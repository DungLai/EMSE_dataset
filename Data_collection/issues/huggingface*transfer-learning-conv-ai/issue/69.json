{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/69","repository_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai","labels_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/69/labels{/name}","comments_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/69/comments","events_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/69/events","html_url":"https://github.com/huggingface/transfer-learning-conv-ai/issues/69","id":591503513,"node_id":"MDU6SXNzdWU1OTE1MDM1MTM=","number":69,"title":"Model uses label to generate predictions during training?","user":{"login":"tibnb545","id":62816235,"node_id":"MDQ6VXNlcjYyODE2MjM1","avatar_url":"https://avatars.githubusercontent.com/u/62816235?v=4","gravatar_id":"","url":"https://api.github.com/users/tibnb545","html_url":"https://github.com/tibnb545","followers_url":"https://api.github.com/users/tibnb545/followers","following_url":"https://api.github.com/users/tibnb545/following{/other_user}","gists_url":"https://api.github.com/users/tibnb545/gists{/gist_id}","starred_url":"https://api.github.com/users/tibnb545/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tibnb545/subscriptions","organizations_url":"https://api.github.com/users/tibnb545/orgs","repos_url":"https://api.github.com/users/tibnb545/repos","events_url":"https://api.github.com/users/tibnb545/events{/privacy}","received_events_url":"https://api.github.com/users/tibnb545/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-03-31T23:24:39Z","updated_at":"2020-03-31T23:24:39Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"The ```input_ids``` tensor that is provided as input for the language modeling task contains the ground-truth label. Doesn't this mean the model uses the label (in addition to the other information in the ```input_ids```  tensor) to make predictions during training? I know the label is also given to the model in the ```lm_labels``` tensor and this is the tensor that the model checks its prediction against in order to calculate loss but if the model is making its prediction based on ```input_ids``` then it is making predictions with knowledge of what the correct label is. Is this correct? Or am I missing something. \r\nThe only other way I can see that this might work is if the model somehow uses the -1 (mask) values in ```lm_labels``` to see which part of ```input_ids``` it should use to make the prediction (which presumably would make the model only consider elements in ```input_ids``` that correspond to elements in ```lm_labels``` that are equal to -1 since these elements are not part of the label). \r\n\r\nAlso, its not clear how the multiple-choice prediction task is done. I know each data instance contains multiple versions of the ```input_ids``` tensor and one of them contains the true label while the others contain distractor labels. Does the model look at each of these ```input_ids``` tensors and try to select the one that contains the true label out of all the options?\r\nIf this is the case, since the ```input_ids``` tensor that contains the correct option is always the last one in the list of options, wouldn't the model just learn to always select the last option (similar to always predicting the same class for each instance) instead of actually learning anything useful?\r\n\r\nI would really like to understand how the model works in these respects so I can create a custom dataset to train on so thank you for taking the time to read these questions.\r\n\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/69/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/huggingface/transfer-learning-conv-ai/issues/69/timeline","performed_via_github_app":null,"state_reason":null}