[{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512287273","html_url":"https://github.com/f90/Wave-U-Net/issues/32#issuecomment-512287273","issue_url":"https://api.github.com/repos/f90/Wave-U-Net/issues/32","id":512287273,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMjI4NzI3Mw==","user":{"login":"f90","id":23065103,"node_id":"MDQ6VXNlcjIzMDY1MTAz","avatar_url":"https://avatars.githubusercontent.com/u/23065103?v=4","gravatar_id":"","url":"https://api.github.com/users/f90","html_url":"https://github.com/f90","followers_url":"https://api.github.com/users/f90/followers","following_url":"https://api.github.com/users/f90/following{/other_user}","gists_url":"https://api.github.com/users/f90/gists{/gist_id}","starred_url":"https://api.github.com/users/f90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/f90/subscriptions","organizations_url":"https://api.github.com/users/f90/orgs","repos_url":"https://api.github.com/users/f90/repos","events_url":"https://api.github.com/users/f90/events{/privacy}","received_events_url":"https://api.github.com/users/f90/received_events","type":"User","site_admin":false},"created_at":"2019-07-17T14:44:50Z","updated_at":"2019-07-17T14:46:41Z","author_association":"OWNER","body":"Hey,\r\nare you rewriting the mixture as well? If not, then inputs and outputs don't match anymore and my test loader reports a mismatch. If you timestretch the sources individually, then sum them to get a mixture, and then put this as training data into my code, it should work without showing these high numbers since they just check whether mix = sum of sources.\r\n\r\nRecomputing the mixture seems mandatory to do here otherwise inputs and outputs are not even on the same timescale, so training with any network won't really work.","reactions":{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512287273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"f90","id":23065103,"node_id":"MDQ6VXNlcjIzMDY1MTAz","avatar_url":"https://avatars.githubusercontent.com/u/23065103?v=4","gravatar_id":"","url":"https://api.github.com/users/f90","html_url":"https://github.com/f90","followers_url":"https://api.github.com/users/f90/followers","following_url":"https://api.github.com/users/f90/following{/other_user}","gists_url":"https://api.github.com/users/f90/gists{/gist_id}","starred_url":"https://api.github.com/users/f90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/f90/subscriptions","organizations_url":"https://api.github.com/users/f90/orgs","repos_url":"https://api.github.com/users/f90/repos","events_url":"https://api.github.com/users/f90/events{/privacy}","received_events_url":"https://api.github.com/users/f90/received_events","type":"User","site_admin":false}},{"id":2489697784,"node_id":"MDEyOkxhYmVsZWRFdmVudDI0ODk2OTc3ODQ=","url":"https://api.github.com/repos/f90/Wave-U-Net/issues/events/2489697784","actor":{"login":"f90","id":23065103,"node_id":"MDQ6VXNlcjIzMDY1MTAz","avatar_url":"https://avatars.githubusercontent.com/u/23065103?v=4","gravatar_id":"","url":"https://api.github.com/users/f90","html_url":"https://github.com/f90","followers_url":"https://api.github.com/users/f90/followers","following_url":"https://api.github.com/users/f90/following{/other_user}","gists_url":"https://api.github.com/users/f90/gists{/gist_id}","starred_url":"https://api.github.com/users/f90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/f90/subscriptions","organizations_url":"https://api.github.com/users/f90/orgs","repos_url":"https://api.github.com/users/f90/repos","events_url":"https://api.github.com/users/f90/events{/privacy}","received_events_url":"https://api.github.com/users/f90/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-07-17T14:45:16Z","label":{"name":"feature","color":"a2eeef"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512289289","html_url":"https://github.com/f90/Wave-U-Net/issues/32#issuecomment-512289289","issue_url":"https://api.github.com/repos/f90/Wave-U-Net/issues/32","id":512289289,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMjI4OTI4OQ==","user":{"login":"f90","id":23065103,"node_id":"MDQ6VXNlcjIzMDY1MTAz","avatar_url":"https://avatars.githubusercontent.com/u/23065103?v=4","gravatar_id":"","url":"https://api.github.com/users/f90","html_url":"https://github.com/f90","followers_url":"https://api.github.com/users/f90/followers","following_url":"https://api.github.com/users/f90/following{/other_user}","gists_url":"https://api.github.com/users/f90/gists{/gist_id}","starred_url":"https://api.github.com/users/f90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/f90/subscriptions","organizations_url":"https://api.github.com/users/f90/orgs","repos_url":"https://api.github.com/users/f90/repos","events_url":"https://api.github.com/users/f90/events{/privacy}","received_events_url":"https://api.github.com/users/f90/received_events","type":"User","site_admin":false},"created_at":"2019-07-17T14:49:26Z","updated_at":"2019-07-17T14:49:26Z","author_association":"OWNER","body":"FYI the code where I load the stempeg mixture audio and compare it to the sum of the sources is here:\r\n\r\nhttps://github.com/f90/Wave-U-Net/blob/master/Datasets.py#L265","reactions":{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512289289/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"f90","id":23065103,"node_id":"MDQ6VXNlcjIzMDY1MTAz","avatar_url":"https://avatars.githubusercontent.com/u/23065103?v=4","gravatar_id":"","url":"https://api.github.com/users/f90","html_url":"https://github.com/f90","followers_url":"https://api.github.com/users/f90/followers","following_url":"https://api.github.com/users/f90/following{/other_user}","gists_url":"https://api.github.com/users/f90/gists{/gist_id}","starred_url":"https://api.github.com/users/f90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/f90/subscriptions","organizations_url":"https://api.github.com/users/f90/orgs","repos_url":"https://api.github.com/users/f90/repos","events_url":"https://api.github.com/users/f90/events{/privacy}","received_events_url":"https://api.github.com/users/f90/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512348747","html_url":"https://github.com/f90/Wave-U-Net/issues/32#issuecomment-512348747","issue_url":"https://api.github.com/repos/f90/Wave-U-Net/issues/32","id":512348747,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMjM0ODc0Nw==","user":{"login":"shoegazerstella","id":22822597,"node_id":"MDQ6VXNlcjIyODIyNTk3","avatar_url":"https://avatars.githubusercontent.com/u/22822597?v=4","gravatar_id":"","url":"https://api.github.com/users/shoegazerstella","html_url":"https://github.com/shoegazerstella","followers_url":"https://api.github.com/users/shoegazerstella/followers","following_url":"https://api.github.com/users/shoegazerstella/following{/other_user}","gists_url":"https://api.github.com/users/shoegazerstella/gists{/gist_id}","starred_url":"https://api.github.com/users/shoegazerstella/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shoegazerstella/subscriptions","organizations_url":"https://api.github.com/users/shoegazerstella/orgs","repos_url":"https://api.github.com/users/shoegazerstella/repos","events_url":"https://api.github.com/users/shoegazerstella/events{/privacy}","received_events_url":"https://api.github.com/users/shoegazerstella/received_events","type":"User","site_admin":false},"created_at":"2019-07-17T16:10:40Z","updated_at":"2019-07-17T16:10:40Z","author_association":"NONE","body":"Hi, thanks a lot for replying.\r\nCorrect me if i am wrong: according to the STEM format, the mixture is the first element of the array I call `S` in my code\r\n\r\n```\r\n#process_list = [mix, drums, bass, accompaniment, vocals]\r\nprocess_list = [S[0], S[1], S[2], S[3], S[4]]\r\n```\r\n\r\nSo I am time_stretching also S[0] together with the other tracks.\r\nNow for writing the STEM I am replacing that S[0] with the sum of all the processed tracks as you suggested and the statistics changed a bit but still far from how they should be, right?\r\n\r\n```\r\nstems_augmented/train/ANiMAL - Clinic A_stretched_1.0.stem_bass.wav\r\nstems_augmented/train/ANiMAL - Clinic A_stretched_1.0.stem_drums.wav\r\nstems_augmented/train/ANiMAL - Clinic A_stretched_1.0.stem_other.wav\r\nstems_augmented/train/ANiMAL - Clinic A_stretched_1.0.stem_vocals.wav\r\nMaximum absolute deviation from source additivity constraint: 0.730133056640625\r\nMean absolute deviation from source additivity constraint:    0.05901246167623359\r\n```\r\n\r\nI should also mention that I have this warning from stempeg, could that be part of the problem?\r\n```\r\nUserWarning: For better quality, please install libfdc_aac\r\n  warnings.warn(\"For better quality, please install libfdc_aac\")\r\n```\r\n\r\nSomething I do not understand is why you are clipping `acc_audio` when generating it.\r\n\r\n```\r\nacc_audio = np.clip(sum([stem_audio[key] for key in stem_audio.keys() if key != \"vocals\"]), -1.0, 1.0)\r\n```","reactions":{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512348747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shoegazerstella","id":22822597,"node_id":"MDQ6VXNlcjIyODIyNTk3","avatar_url":"https://avatars.githubusercontent.com/u/22822597?v=4","gravatar_id":"","url":"https://api.github.com/users/shoegazerstella","html_url":"https://github.com/shoegazerstella","followers_url":"https://api.github.com/users/shoegazerstella/followers","following_url":"https://api.github.com/users/shoegazerstella/following{/other_user}","gists_url":"https://api.github.com/users/shoegazerstella/gists{/gist_id}","starred_url":"https://api.github.com/users/shoegazerstella/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shoegazerstella/subscriptions","organizations_url":"https://api.github.com/users/shoegazerstella/orgs","repos_url":"https://api.github.com/users/shoegazerstella/repos","events_url":"https://api.github.com/users/shoegazerstella/events{/privacy}","received_events_url":"https://api.github.com/users/shoegazerstella/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512804682","html_url":"https://github.com/f90/Wave-U-Net/issues/32#issuecomment-512804682","issue_url":"https://api.github.com/repos/f90/Wave-U-Net/issues/32","id":512804682,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMjgwNDY4Mg==","user":{"login":"f90","id":23065103,"node_id":"MDQ6VXNlcjIzMDY1MTAz","avatar_url":"https://avatars.githubusercontent.com/u/23065103?v=4","gravatar_id":"","url":"https://api.github.com/users/f90","html_url":"https://github.com/f90","followers_url":"https://api.github.com/users/f90/followers","following_url":"https://api.github.com/users/f90/following{/other_user}","gists_url":"https://api.github.com/users/f90/gists{/gist_id}","starred_url":"https://api.github.com/users/f90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/f90/subscriptions","organizations_url":"https://api.github.com/users/f90/orgs","repos_url":"https://api.github.com/users/f90/repos","events_url":"https://api.github.com/users/f90/events{/privacy}","received_events_url":"https://api.github.com/users/f90/received_events","type":"User","site_admin":false},"created_at":"2019-07-18T13:00:06Z","updated_at":"2019-07-18T13:01:17Z","author_association":"OWNER","body":"There might be some problem with the encoding, seeing that the mean absolute deviation is not so high but the maximum one is. So it might be alright overall  but locally some encoding inconsistencies produce a high error...\r\n\r\nSolution 1: Export your audio to wave, and modify the MUSDB data loading code to load the wave files directly, then you know there should be absolutely no deviation between sum of sources and mix as you don't have any encoding inaccuracy.\r\n\r\nSolution 2: If you are absolutely sure you are inputting \"proper\" data into the system, go ahead and ignore the warning and/or use ```output_type: direct``` in the Wave-U-Net to allow it to output all sources unconstrained, so it is capable of outputting sources that do NOT add up to the original mix as well. I would definitely listen to the dataset you produced in this case though to make sure everything is alright.\r\n\r\nI am clipping the accompaniment audio just to be sure that i don't generate values out of the [-1,1] range since it's a sum of the individual audio signals, so the amplitudes are summed up. Should not be necessary if the dataset is proper, but doesn't hurt either.","reactions":{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512804682/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"f90","id":23065103,"node_id":"MDQ6VXNlcjIzMDY1MTAz","avatar_url":"https://avatars.githubusercontent.com/u/23065103?v=4","gravatar_id":"","url":"https://api.github.com/users/f90","html_url":"https://github.com/f90","followers_url":"https://api.github.com/users/f90/followers","following_url":"https://api.github.com/users/f90/following{/other_user}","gists_url":"https://api.github.com/users/f90/gists{/gist_id}","starred_url":"https://api.github.com/users/f90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/f90/subscriptions","organizations_url":"https://api.github.com/users/f90/orgs","repos_url":"https://api.github.com/users/f90/repos","events_url":"https://api.github.com/users/f90/events{/privacy}","received_events_url":"https://api.github.com/users/f90/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512805902","html_url":"https://github.com/f90/Wave-U-Net/issues/32#issuecomment-512805902","issue_url":"https://api.github.com/repos/f90/Wave-U-Net/issues/32","id":512805902,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMjgwNTkwMg==","user":{"login":"f90","id":23065103,"node_id":"MDQ6VXNlcjIzMDY1MTAz","avatar_url":"https://avatars.githubusercontent.com/u/23065103?v=4","gravatar_id":"","url":"https://api.github.com/users/f90","html_url":"https://github.com/f90","followers_url":"https://api.github.com/users/f90/followers","following_url":"https://api.github.com/users/f90/following{/other_user}","gists_url":"https://api.github.com/users/f90/gists{/gist_id}","starred_url":"https://api.github.com/users/f90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/f90/subscriptions","organizations_url":"https://api.github.com/users/f90/orgs","repos_url":"https://api.github.com/users/f90/repos","events_url":"https://api.github.com/users/f90/events{/privacy}","received_events_url":"https://api.github.com/users/f90/received_events","type":"User","site_admin":false},"created_at":"2019-07-18T13:03:29Z","updated_at":"2019-07-18T13:03:29Z","author_association":"OWNER","body":"Wait a second I just saw your code here:\r\n\r\n```\r\nprocess_list = [S[0], S[1], S[2], S[3], S[4]]\r\nfor audio_to_process in process_list:\r\n    y_stretched = timeStretch(audio_to_process, rate=R)\r\n    stretched_list.append(y_stretched)\r\n```\r\n\r\nDoes that mean you don't compute the mix as sum of the sources but rather time-stretch it as well? That might be the reason here. The time-stretching function might stretch things a bit differently for the sources compared to the mix. You should definitely set mix = sum of sources instead!","reactions":{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512805902/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"f90","id":23065103,"node_id":"MDQ6VXNlcjIzMDY1MTAz","avatar_url":"https://avatars.githubusercontent.com/u/23065103?v=4","gravatar_id":"","url":"https://api.github.com/users/f90","html_url":"https://github.com/f90","followers_url":"https://api.github.com/users/f90/followers","following_url":"https://api.github.com/users/f90/following{/other_user}","gists_url":"https://api.github.com/users/f90/gists{/gist_id}","starred_url":"https://api.github.com/users/f90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/f90/subscriptions","organizations_url":"https://api.github.com/users/f90/orgs","repos_url":"https://api.github.com/users/f90/repos","events_url":"https://api.github.com/users/f90/events{/privacy}","received_events_url":"https://api.github.com/users/f90/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512806789","html_url":"https://github.com/f90/Wave-U-Net/issues/32#issuecomment-512806789","issue_url":"https://api.github.com/repos/f90/Wave-U-Net/issues/32","id":512806789,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMjgwNjc4OQ==","user":{"login":"f90","id":23065103,"node_id":"MDQ6VXNlcjIzMDY1MTAz","avatar_url":"https://avatars.githubusercontent.com/u/23065103?v=4","gravatar_id":"","url":"https://api.github.com/users/f90","html_url":"https://github.com/f90","followers_url":"https://api.github.com/users/f90/followers","following_url":"https://api.github.com/users/f90/following{/other_user}","gists_url":"https://api.github.com/users/f90/gists{/gist_id}","starred_url":"https://api.github.com/users/f90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/f90/subscriptions","organizations_url":"https://api.github.com/users/f90/orgs","repos_url":"https://api.github.com/users/f90/repos","events_url":"https://api.github.com/users/f90/events{/privacy}","received_events_url":"https://api.github.com/users/f90/received_events","type":"User","site_admin":false},"created_at":"2019-07-18T13:05:52Z","updated_at":"2019-07-18T13:05:52Z","author_association":"OWNER","body":"It should be something like this:\r\n```\r\nprocess_list = [S[1], S[2], S[3], S[4]]\r\nfor audio_to_process in process_list:\r\n    y_stretched = timeStretch(audio_to_process, rate=R)\r\n    stretched_list.append(y_stretched)\r\nmix_stretched = np.sum(stretched_list)\r\nstretched_list.insert(0, mix_stretched)\r\n```","reactions":{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512806789/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"f90","id":23065103,"node_id":"MDQ6VXNlcjIzMDY1MTAz","avatar_url":"https://avatars.githubusercontent.com/u/23065103?v=4","gravatar_id":"","url":"https://api.github.com/users/f90","html_url":"https://github.com/f90","followers_url":"https://api.github.com/users/f90/followers","following_url":"https://api.github.com/users/f90/following{/other_user}","gists_url":"https://api.github.com/users/f90/gists{/gist_id}","starred_url":"https://api.github.com/users/f90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/f90/subscriptions","organizations_url":"https://api.github.com/users/f90/orgs","repos_url":"https://api.github.com/users/f90/repos","events_url":"https://api.github.com/users/f90/events{/privacy}","received_events_url":"https://api.github.com/users/f90/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512808075","html_url":"https://github.com/f90/Wave-U-Net/issues/32#issuecomment-512808075","issue_url":"https://api.github.com/repos/f90/Wave-U-Net/issues/32","id":512808075,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMjgwODA3NQ==","user":{"login":"shoegazerstella","id":22822597,"node_id":"MDQ6VXNlcjIyODIyNTk3","avatar_url":"https://avatars.githubusercontent.com/u/22822597?v=4","gravatar_id":"","url":"https://api.github.com/users/shoegazerstella","html_url":"https://github.com/shoegazerstella","followers_url":"https://api.github.com/users/shoegazerstella/followers","following_url":"https://api.github.com/users/shoegazerstella/following{/other_user}","gists_url":"https://api.github.com/users/shoegazerstella/gists{/gist_id}","starred_url":"https://api.github.com/users/shoegazerstella/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shoegazerstella/subscriptions","organizations_url":"https://api.github.com/users/shoegazerstella/orgs","repos_url":"https://api.github.com/users/shoegazerstella/repos","events_url":"https://api.github.com/users/shoegazerstella/events{/privacy}","received_events_url":"https://api.github.com/users/shoegazerstella/received_events","type":"User","site_admin":false},"created_at":"2019-07-18T13:09:29Z","updated_at":"2019-07-18T13:09:29Z","author_association":"NONE","body":"> Does that mean you don't compute the mix as sum of the sources but rather time-stretch it as well? That might be the reason here. The time-stretching function might stretch things a bit differently for the sources compared to the mix. You should definitely set mix = sum of sources instead!\r\n\r\nI was doing that before, but then I replaced `mix = sum of processed sources` as you suggested yesterday. My last comment with statistics comes from this adjustment. As you can see, the mean and max values changed after doing this.\r\n\r\nThanks a lot for proposing the 2 solutions, I will try and see which one is better.\r\n","reactions":{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512808075/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shoegazerstella","id":22822597,"node_id":"MDQ6VXNlcjIyODIyNTk3","avatar_url":"https://avatars.githubusercontent.com/u/22822597?v=4","gravatar_id":"","url":"https://api.github.com/users/shoegazerstella","html_url":"https://github.com/shoegazerstella","followers_url":"https://api.github.com/users/shoegazerstella/followers","following_url":"https://api.github.com/users/shoegazerstella/following{/other_user}","gists_url":"https://api.github.com/users/shoegazerstella/gists{/gist_id}","starred_url":"https://api.github.com/users/shoegazerstella/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shoegazerstella/subscriptions","organizations_url":"https://api.github.com/users/shoegazerstella/orgs","repos_url":"https://api.github.com/users/shoegazerstella/repos","events_url":"https://api.github.com/users/shoegazerstella/events{/privacy}","received_events_url":"https://api.github.com/users/shoegazerstella/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512838624","html_url":"https://github.com/f90/Wave-U-Net/issues/32#issuecomment-512838624","issue_url":"https://api.github.com/repos/f90/Wave-U-Net/issues/32","id":512838624,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMjgzODYyNA==","user":{"login":"shoegazerstella","id":22822597,"node_id":"MDQ6VXNlcjIyODIyNTk3","avatar_url":"https://avatars.githubusercontent.com/u/22822597?v=4","gravatar_id":"","url":"https://api.github.com/users/shoegazerstella","html_url":"https://github.com/shoegazerstella","followers_url":"https://api.github.com/users/shoegazerstella/followers","following_url":"https://api.github.com/users/shoegazerstella/following{/other_user}","gists_url":"https://api.github.com/users/shoegazerstella/gists{/gist_id}","starred_url":"https://api.github.com/users/shoegazerstella/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shoegazerstella/subscriptions","organizations_url":"https://api.github.com/users/shoegazerstella/orgs","repos_url":"https://api.github.com/users/shoegazerstella/repos","events_url":"https://api.github.com/users/shoegazerstella/events{/privacy}","received_events_url":"https://api.github.com/users/shoegazerstella/received_events","type":"User","site_admin":false},"created_at":"2019-07-18T14:25:19Z","updated_at":"2019-07-18T14:25:19Z","author_association":"NONE","body":"Some updates:\r\n\r\nThis is the augmented file:\r\n\r\n```\r\nffprobe ANiMAL\\ -\\ Clinic\\ A_stretched_1.0.stem.mp4 \r\n\r\nInput #0, mov,mp4,m4a,3gp,3g2,mj2, from 'ANiMAL - Clinic A_stretched_1.0.stem.mp4':\r\n  Metadata:\r\n    major_brand     : isom\r\n    minor_version   : 512\r\n    compatible_brands: isomiso2mp41\r\n    encoder         : Lavf58.20.100\r\n  Duration: 00:03:57.89, start: 0.000000, bitrate: 1195 kb/s\r\n    Stream #0:0(und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 256 kb/s (default)\r\n    Metadata:\r\n      handler_name    : SoundHandler\r\n    Stream #0:1(und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 251 kb/s\r\n    Metadata:\r\n      handler_name    : SoundHandler\r\n    Stream #0:2(und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 224 kb/s\r\n    Metadata:\r\n      handler_name    : SoundHandler\r\n    Stream #0:3(und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 255 kb/s\r\n    Metadata:\r\n      handler_name    : SoundHandler\r\n    Stream #0:4(und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 193 kb/s\r\n    Metadata:\r\n      handler_name    : SoundHandler\r\n```\r\n\r\nThis is the original one:\r\n\r\n```\r\nffprobe ANiMAL\\ -\\ Clinic\\ A.stem.mp4 \r\n\r\nInput #0, mov,mp4,m4a,3gp,3g2,mj2, from 'ANiMAL - Clinic A.stem.mp4':\r\n  Metadata:\r\n    major_brand     : isom\r\n    minor_version   : 1\r\n    compatible_brands: isom\r\n    creation_time   : 2017-12-16T16:50:00.000000Z\r\n  Duration: 00:03:57.85, start: 0.000000, bitrate: 1288 kb/s\r\n    Stream #0:0(und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 256 kb/s (default)\r\n    Metadata:\r\n      handler_name    : SoundHandler\r\n    Stream #0:1(und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 256 kb/s\r\n    Metadata:\r\n      handler_name    : SoundHandler\r\n    Stream #0:2(und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 256 kb/s\r\n    Metadata:\r\n      handler_name    : SoundHandler\r\n    Stream #0:3(und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 256 kb/s\r\n    Metadata:\r\n      handler_name    : SoundHandler\r\n    Stream #0:4(und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 256 kb/s\r\n    Metadata:\r\n      handler_name    : SoundHandler\r\n    Stream #0:5: Video: png, rgba(pc), 512x512 [SAR 20157:20157 DAR 1:1], 90k tbr, 90k tbn, 90k tbc\r\n\r\n```\r\n\r\nI see some inconsistencies on the bitrate.\r\n\r\nAlso, I am computing the stats before writing the augmented stem and after (from your data loader):\r\n\r\n```\r\n#before \r\nMaximum absolute deviation from source additivity constraint: 5.551115123125783e-17\r\nMean absolute deviation from source additivity constraint:    2.595044779849003e-18\r\n\r\n# after\r\nMaximum absolute deviation from source additivity constraint: 0.730133056640625\r\nMean absolute deviation from source additivity constraint:    0.05901246167623359\r\n```\r\n\r\nThere must be something wrong with ffmpeg, or do you see something else that's incorrect?\r\nI am going to try solution 1.\r\nThanks a lot!","reactions":{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512838624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shoegazerstella","id":22822597,"node_id":"MDQ6VXNlcjIyODIyNTk3","avatar_url":"https://avatars.githubusercontent.com/u/22822597?v=4","gravatar_id":"","url":"https://api.github.com/users/shoegazerstella","html_url":"https://github.com/shoegazerstella","followers_url":"https://api.github.com/users/shoegazerstella/followers","following_url":"https://api.github.com/users/shoegazerstella/following{/other_user}","gists_url":"https://api.github.com/users/shoegazerstella/gists{/gist_id}","starred_url":"https://api.github.com/users/shoegazerstella/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shoegazerstella/subscriptions","organizations_url":"https://api.github.com/users/shoegazerstella/orgs","repos_url":"https://api.github.com/users/shoegazerstella/repos","events_url":"https://api.github.com/users/shoegazerstella/events{/privacy}","received_events_url":"https://api.github.com/users/shoegazerstella/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512899527","html_url":"https://github.com/f90/Wave-U-Net/issues/32#issuecomment-512899527","issue_url":"https://api.github.com/repos/f90/Wave-U-Net/issues/32","id":512899527,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMjg5OTUyNw==","user":{"login":"f90","id":23065103,"node_id":"MDQ6VXNlcjIzMDY1MTAz","avatar_url":"https://avatars.githubusercontent.com/u/23065103?v=4","gravatar_id":"","url":"https://api.github.com/users/f90","html_url":"https://github.com/f90","followers_url":"https://api.github.com/users/f90/followers","following_url":"https://api.github.com/users/f90/following{/other_user}","gists_url":"https://api.github.com/users/f90/gists{/gist_id}","starred_url":"https://api.github.com/users/f90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/f90/subscriptions","organizations_url":"https://api.github.com/users/f90/orgs","repos_url":"https://api.github.com/users/f90/repos","events_url":"https://api.github.com/users/f90/events{/privacy}","received_events_url":"https://api.github.com/users/f90/received_events","type":"User","site_admin":false},"created_at":"2019-07-18T16:53:46Z","updated_at":"2019-07-18T16:53:46Z","author_association":"OWNER","body":"I am not too well versed on the ffmpeg part of the story, but I personally wouldn't trust it to encode things to such a high degree of accuracy that we require. I also had some issues when loading encoded audio in terms of synchronisation where the audio was suddenly misaligned in time, which is obviously very bad in our setting.\r\n\r\nBut yeah it looks like ffmpeg encoding (settings) is to blame here. I decode all the stems to wave as part of data preparation anyway as it's much faster to load the audio during training that way, so you should probably use solution 1 I proposed and cut out the whole stempeg part completely.\r\n\r\nAnother solution if time-stretching is not too cpu-intensive is to put it as part of the data augmentation piopeline on-the-fly during training. Saves disk space but might slow down training since batches take longer to be prepared.","reactions":{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/512899527/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"f90","id":23065103,"node_id":"MDQ6VXNlcjIzMDY1MTAz","avatar_url":"https://avatars.githubusercontent.com/u/23065103?v=4","gravatar_id":"","url":"https://api.github.com/users/f90","html_url":"https://github.com/f90","followers_url":"https://api.github.com/users/f90/followers","following_url":"https://api.github.com/users/f90/following{/other_user}","gists_url":"https://api.github.com/users/f90/gists{/gist_id}","starred_url":"https://api.github.com/users/f90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/f90/subscriptions","organizations_url":"https://api.github.com/users/f90/orgs","repos_url":"https://api.github.com/users/f90/repos","events_url":"https://api.github.com/users/f90/events{/privacy}","received_events_url":"https://api.github.com/users/f90/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/513133137","html_url":"https://github.com/f90/Wave-U-Net/issues/32#issuecomment-513133137","issue_url":"https://api.github.com/repos/f90/Wave-U-Net/issues/32","id":513133137,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMzEzMzEzNw==","user":{"login":"shoegazerstella","id":22822597,"node_id":"MDQ6VXNlcjIyODIyNTk3","avatar_url":"https://avatars.githubusercontent.com/u/22822597?v=4","gravatar_id":"","url":"https://api.github.com/users/shoegazerstella","html_url":"https://github.com/shoegazerstella","followers_url":"https://api.github.com/users/shoegazerstella/followers","following_url":"https://api.github.com/users/shoegazerstella/following{/other_user}","gists_url":"https://api.github.com/users/shoegazerstella/gists{/gist_id}","starred_url":"https://api.github.com/users/shoegazerstella/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shoegazerstella/subscriptions","organizations_url":"https://api.github.com/users/shoegazerstella/orgs","repos_url":"https://api.github.com/users/shoegazerstella/repos","events_url":"https://api.github.com/users/shoegazerstella/events{/privacy}","received_events_url":"https://api.github.com/users/shoegazerstella/received_events","type":"User","site_admin":false},"created_at":"2019-07-19T07:58:03Z","updated_at":"2019-07-19T07:58:03Z","author_association":"NONE","body":"I am using librosa so it takes quite long, can't do it during training unless I find some other solution.\r\nThanks a lot for helping me! :) ","reactions":{"url":"https://api.github.com/repos/f90/Wave-U-Net/issues/comments/513133137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shoegazerstella","id":22822597,"node_id":"MDQ6VXNlcjIyODIyNTk3","avatar_url":"https://avatars.githubusercontent.com/u/22822597?v=4","gravatar_id":"","url":"https://api.github.com/users/shoegazerstella","html_url":"https://github.com/shoegazerstella","followers_url":"https://api.github.com/users/shoegazerstella/followers","following_url":"https://api.github.com/users/shoegazerstella/following{/other_user}","gists_url":"https://api.github.com/users/shoegazerstella/gists{/gist_id}","starred_url":"https://api.github.com/users/shoegazerstella/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shoegazerstella/subscriptions","organizations_url":"https://api.github.com/users/shoegazerstella/orgs","repos_url":"https://api.github.com/users/shoegazerstella/repos","events_url":"https://api.github.com/users/shoegazerstella/events{/privacy}","received_events_url":"https://api.github.com/users/shoegazerstella/received_events","type":"User","site_admin":false}},{"id":2495039230,"node_id":"MDExOkNsb3NlZEV2ZW50MjQ5NTAzOTIzMA==","url":"https://api.github.com/repos/f90/Wave-U-Net/issues/events/2495039230","actor":{"login":"shoegazerstella","id":22822597,"node_id":"MDQ6VXNlcjIyODIyNTk3","avatar_url":"https://avatars.githubusercontent.com/u/22822597?v=4","gravatar_id":"","url":"https://api.github.com/users/shoegazerstella","html_url":"https://github.com/shoegazerstella","followers_url":"https://api.github.com/users/shoegazerstella/followers","following_url":"https://api.github.com/users/shoegazerstella/following{/other_user}","gists_url":"https://api.github.com/users/shoegazerstella/gists{/gist_id}","starred_url":"https://api.github.com/users/shoegazerstella/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shoegazerstella/subscriptions","organizations_url":"https://api.github.com/users/shoegazerstella/orgs","repos_url":"https://api.github.com/users/shoegazerstella/repos","events_url":"https://api.github.com/users/shoegazerstella/events{/privacy}","received_events_url":"https://api.github.com/users/shoegazerstella/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-07-19T07:58:03Z","state_reason":null,"performed_via_github_app":null}]