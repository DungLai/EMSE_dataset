[{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/969840491","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-969840491","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":969840491,"node_id":"IC_kwDOCYyMws45zpdr","user":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false},"created_at":"2021-11-16T04:10:49Z","updated_at":"2021-11-16T04:10:49Z","author_association":"OWNER","body":"Если набор тикеров изменился, то на следующий торговый день начнется переобучение. \r\nПоэтому я обычно стараюсь вечером менять список тикеров.\r\nКакого-то простого способа форсировать переобучение нет.","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/969840491/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977625746","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-977625746","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":977625746,"node_id":"IC_kwDOCYyMws46RWKS","user":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false},"created_at":"2021-11-24T08:05:12Z","updated_at":"2021-11-24T08:05:12Z","author_association":"CONTRIBUTOR","body":"Прошло 2 торговых дня с момента изменения набора тикеров, старые модели так и не переобучились. Если простого способа нет, какой сложный? ","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977625746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977630712","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-977630712","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":977630712,"node_id":"IC_kwDOCYyMws46RXX4","user":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false},"created_at":"2021-11-24T08:11:51Z","updated_at":"2021-11-24T08:11:51Z","author_association":"OWNER","body":"Не очень понятно, что у вас конкретно происходит.\r\n\r\nУ вас всего сколько моделей?\r\nНи одна модель не переобучилась?","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977630712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977633836","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-977633836","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":977633836,"node_id":"IC_kwDOCYyMws46RYIs","user":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false},"created_at":"2021-11-24T08:15:47Z","updated_at":"2021-11-24T08:15:47Z","author_association":"OWNER","body":"Я видел, вы свой форк ведете - может проблема, что вы как-то не совсем правильно свои патчи налагаете. ","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977633836/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977657178","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-977657178","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":977657178,"node_id":"IC_kwDOCYyMws46Rd1a","user":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false},"created_at":"2021-11-24T08:45:31Z","updated_at":"2021-11-24T08:56:09Z","author_association":"CONTRIBUTOR","body":"> У вас всего сколько моделей?\r\n\r\nОрганизмов - 198 / Максимум оценок - 15\r\n> Ни одна модель не переобучилась?\r\n\r\nТочно сказать не могу, но есть модели с обновленным набором тикеров, а также есть со старым и они как-то существуют одновременно, эволюции это не мешает...\r\n\r\nОсновное отличие в том форке - оптимизация нескольких портфелей с различными ограничениями на используемые тикеры. Например, часть портфелей содержит только дивидендные акции / только иностранные, а другие все вместе взятые.\r\nСначала я попробовал реализовать эти ограничения на этапе обучения моделей, но потом, когда вы сказали, что просто их не переобучить не получится - перенёс эти ограничения на этап формирования рекомендаций. Так что сейчас модели обучаются на всех тикерах из всех портфелей, но старые модели, обученные на ограниченном наборе, выдают ошибки типа:\r\n````\r\nForecasts: 198it [00:00, 763.28it/s]\r\nTraceback (most recent call last):\r\n  File \"PATH_TO/poptimizer/optimize.py\", line 12, in opt\r\n    optimize(ports_to_optimize, ports_wht_lst)\r\n  File \"PATH_TO/poptimizer/poptimizer/__main__.py\", line 28, in optimize\r\n    opt = Optimizer(port, white_list_portfolio=white_list_portfolio)\r\n  File \"PATH_TO/poptimizer/poptimizer/portfolio/optimizer.py\", line 31, in __init__\r\n    self._metrics = metrics.MetricsResample(portfolio)\r\n  File \"PATH_TO/poptimizer/poptimizer/portfolio/metrics.py\", line 154, in __init__\r\n    for forecast in evolve.get_forecasts(tickers, date):\r\n  File \"PATH_TO/poptimizer/poptimizer/evolve/forecaster.py\", line 142, in get_forecasts\r\n    return cache()\r\n  File \"PATH_TO/poptimizer/poptimizer/evolve/forecaster.py\", line 98, in __call__\r\n    return self._create_cache()\r\n  File \"PATH_TO/poptimizer/poptimizer/evolve/forecaster.py\", line 116, in _create_cache\r\n    forecasts = Forecasts(self._tickers, self._date)\r\n  File \"PATH_TO/poptimizer/poptimizer/evolve/forecaster.py\", line 34, in __init__\r\n    raise population.ForecastError(f\"Отсутствуют прогнозы - необходимо обучить модели. SymDiff: {diff}\")\r\npoptimizer.evolve.population.ForecastError: Отсутствуют прогнозы - необходимо обучить модели. SymDiff: {'TCSG', 'AVGO-RM', 'TGKN', 'KMAZ', 'NEE-RM', 'SMLT', 'NEM-RM', 'NKNC', 'BANE', 'CHMK', 'SBRB', 'AMEZ', 'BA-RM', 'CSCO-RM', 'MDMG', 'PFE-RM', 'KZOS', 'MTLR', 'FB-RM', 'POGR', 'F-RM', 'LSNGP', 'NVTK', 'QIWI', 'FDX-RM', 'FIVE', 'LNZLP', 'MGTS', 'SNGS', 'NKNCP', 'NSVZ', 'T-RM', 'TATNP', 'RTKMP', 'ABRD', 'CHMF', 'CNTL', 'NKE-RM', 'TATN', 'ISKJ', 'YAKG', 'KAZT', 'KLSB', 'ATVI-RM', 'LNZL', 'RBCM', 'IBM-RM', 'LIFE', 'TGT-RM', 'SVAV', 'TGKBP', 'YNDX', 'TRNFP', 'BMY-RM', 'AMZN-RM', 'HPQ-RM', 'MSTT', 'ENPG', 'XOM-RM', 'MRSB', 'HIMCP', 'ZILL', 'RUGR', 'NVDA-RM', 'GOOG-RM', 'MU-RM', 'EA-RM', 'UNAC', 'BSPB', 'TSLA-RM', 'OGKB', 'GE-RM', 'LSNG', 'MRKC', 'APTK', 'CRM-RM', 'AFLT', 'BELU', 'EELT', 'GAZP', 'ALRS', 'QCOM-RM', 'WMT-RM', 'MAIL', 'RSTI', 'TGKB', 'BIDU-RM', 'RASP', 'SBER', 'OZON', 'INTC-RM', 'LNTA', 'SFIN', 'FESH', 'VTBB', 'SBERP', 'SELG', 'KHC-RM', 'LSRG', 'NFLX-RM', 'RSTIP', 'ORUP', 'NKHP', 'MTLRP', 'USBN', 'TWTR-RM', 'ABT-RM', 'UWGN', 'AMD-RM', 'MRKS', 'VTBM', 'FEES', 'BRZL', 'BIIB-RM', 'CNTLP', 'HHRU', 'PG-RM', 'VTBR', 'RUAL', 'IRAO', 'AFKS', 'MRKP', 'AKRN', 'KRSB', 'VTRS-RM', 'ENRU', 'AAPL-RM', 'TGKA', 'FXRU', 'ADBE-RM', 'MSRS', 'UNKL', 'UBER-RM', 'MSFT-RM', 'GTRK', 'CBOM', 'VSMO', 'JNJ-RM', 'MCD-RM', 'GMKN', 'PYPL-RM', 'DIS-RM', 'RTKM', 'KRKNP', 'PLZL', 'AQUA', 'RNFT', 'ROSN', 'ABBV-RM', 'RGSS', 'ROLO', 'INGR', 'NFAZ', 'LKOH', 'TGKD', 'FXRB', 'V-RM', 'SBUX-RM', 'AAL-RM', 'NLMK', 'FXMM'}\r\n````\r\nИ по прошествии нескольких дней ситуация не исправилась. Таким образом, мне нужно один раз всё-таки пройти этот сложный процесс переинициализации, так как с холодного старта всё теперь работает нормально.\r\n\r\nКаких-то функциональных изменений в этап обучения я не вносил, изменения есть лишь в процессе формирования рекомендаций, но и они не существенны. Могу попробовать оформить как PR, там будут видно различие.","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977657178/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977668182","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-977668182","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":977668182,"node_id":"IC_kwDOCYyMws46RghW","user":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false},"created_at":"2021-11-24T08:58:51Z","updated_at":"2021-11-24T09:02:58Z","author_association":"OWNER","body":"> Точно сказать не могу, но точно есть модели с обновленным набором тикеров, а также очень много со старым и они как-то существуют одновременно, эволюции это не мешает...\r\n\r\nПроцесс переобучения достаточно долгий, особенно если есть много моделей. Он вполне может идти несколько дней, и в это время будут существовать стратегии со старым и новым набором. В это время должно в первую очередь идти переобучение и не должны создаваться новые модели. Прогноз будет делаться по уже переученным моделям - их достаточно буквально двух, чтобы оптимизация проработала без ошибок (другое дело, что им лучше не пользоваться). Если у вас падает с ошибками, то где-то вкралась ошибка в коде - думаю в вашем патче.  \r\n\r\nМожете прислать скрин одного выполненного шага эволюции? Это позволит понять, правильно ли все у вас идет обучение - переучиваются старые модели, а не создаются новые. \r\n\r\n> Каких-то функциональных изменений в этап обучения я не вносил, изменения есть лишь в процессе формирования рекомендаций, но и они не существенны. Могу попробовать оформить как PR, там будут видно различие.\r\n\r\nТут есть тонкости, которые вы могли не учесть. Прогноз должен делаться по тем же тикерам, которые использовались в обучении. Какая-то фильтрация отображения должна выполняться после этого. ","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977668182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977687112","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-977687112","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":977687112,"node_id":"IC_kwDOCYyMws46RlJI","user":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false},"created_at":"2021-11-24T09:20:38Z","updated_at":"2021-11-24T09:22:18Z","author_association":"OWNER","body":"Из вашего PR мало чего понятно. Многое зависит от того, как вы все это запускаете. \r\n\r\nКлючевой момент - эволюция должна запускаться ровно с тем же набором тикеров, что и MetricsResample. Постарайтесь как-то понять, какие у вас наборы туда приходят. Ниже ссылки на соотвествующие строки в моем коде. \r\n\r\nhttps://github.com/WLM1ke/poptimizer/blob/5fcbd74f9102eaad8be7468ba99300f9319d5192/poptimizer/evolve/evolve.py#L81\r\n\r\nhttps://github.com/WLM1ke/poptimizer/blob/5fcbd74f9102eaad8be7468ba99300f9319d5192/poptimizer/portfolio/optimizer.py#L24\r\n\r\nЕсли это не так, то будет падать с ошибкой. ","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977687112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977764080","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-977764080","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":977764080,"node_id":"IC_kwDOCYyMws46R37w","user":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false},"created_at":"2021-11-24T10:58:25Z","updated_at":"2021-11-24T10:58:25Z","author_association":"CONTRIBUTOR","body":"> Процесс переобучения достаточно долгий, особенно если есть много моделей.\r\n\r\nПонял. \r\n\r\n> Можете прислать скрин одного выполненного шага эволюции? Это позволит понять, правильно ли все у вас идет обучение - переучиваются старые модели, а не создаются новые.\r\n\r\nНебольшое видео, так как окно достаточно маленькое и много сообщений от mongodb https://yadi.sk/i/lf9h6i8BhGf5Hg\r\n\r\n> Постарайтесь как-то понять, какие у вас наборы туда приходят.\r\n\r\nПосмотрел, да, ошибка была в том, что набор был неполным. Спасибо!\r\n","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977764080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977786566","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-977786566","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":977786566,"node_id":"IC_kwDOCYyMws46R9bG","user":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false},"created_at":"2021-11-24T11:25:55Z","updated_at":"2021-11-24T11:25:55Z","author_association":"OWNER","body":"Судя по ролику у вас идет именно переобучение - в этой части все окей.\r\n","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977786566/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977990060","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-977990060","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":977990060,"node_id":"IC_kwDOCYyMws46SvGs","user":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false},"created_at":"2021-11-24T15:35:48Z","updated_at":"2021-11-24T15:35:48Z","author_association":"CONTRIBUTOR","body":"````\r\n***2021-11-23: Шаг эволюции — 210***\r\nLLH - (0.7452, 2.5894, 2.7491)\r\nRET - (0.2295, 0.3055, 1.7552)\r\nОрганизмов - 199 / Максимум оценок - 16\r\nДоля принятых - 9.97%\r\n````\r\nЯ правильно понимаю, что на данном этапе все модели должны были переобучиться?","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977990060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977996248","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-977996248","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":977996248,"node_id":"IC_kwDOCYyMws46SwnY","user":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false},"created_at":"2021-11-24T15:42:58Z","updated_at":"2021-11-24T15:46:38Z","author_association":"OWNER","body":"Вроде да, при обычном течении процесса. Если вы там как-то нестандартно вмешивались в процесс, то всякое может быть. \r\n\r\nПонять это можно, посмотрев на вторую модель в шаге - претендента. У нового пустой заголовок и соответствующая пометка:\r\n\r\nПретендент - новый организм:\r\nLLH — -\r\nRET — -\r\nTimer — 0:00:00\r\n\r\nУ переобучающегося организма, должны быть данные о прошлых тренировках без пометки, что он новый:\r\n\r\n\r\nПретендент:\r\nLLH — 2.5586:  2.5785,  2.5983,  2.6087,  2.6236,  2.6274,  2.6250,  2.5815,  2.6052,  2.6697,  2.6943,  2.7326,  2.6525\r\nRET — 1.0189:  0.6014,  0.7336,  0.8677,  1.1824,  0.8525,  0.8907,  1.2082,  0.9837,  0.6796,  0.6521,  0.7502,  0.8319\r\nTimer — 0:03:15\r\n","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/977996248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/978074670","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-978074670","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":978074670,"node_id":"IC_kwDOCYyMws46TDwu","user":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false},"created_at":"2021-11-24T17:16:06Z","updated_at":"2021-11-24T17:16:23Z","author_association":"CONTRIBUTOR","body":"Да, теперь создаются новые, но при оптимизации получаются запредельные значения (3.42e+30) у матрицы ковариаций у части метрик (не у всех):\r\nhttps://yadi.sk/d/TRf27Do_gPvvwA\r\nhttps://github.com/WLM1ke/poptimizer/blob/5fcbd74f9102eaad8be7468ba99300f9319d5192/poptimizer/portfolio/metrics.py#L73\r\nудаление forecasts не помогло.","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/978074670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/978084688","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-978084688","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":978084688,"node_id":"IC_kwDOCYyMws46TGNQ","user":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false},"created_at":"2021-11-24T17:29:09Z","updated_at":"2021-11-24T17:31:00Z","author_association":"OWNER","body":"Возможно естественный отбор еще не убил заведомо дурацкие прогнозы - у вас достаточно не долго эволюция работала судя по максимальному количеству прогнозов. \r\n\r\nПо идее в оптимизации используется медиана именно для того, чтобы несколько совершенно неадекватных прогнозов не оказывало влияние на общую картину.  Но у вас там как-то изменена логика - не знаю насколько хорошо она справляется с выбросами. \r\n\r\nУдаление forecasts не поможет - если у вас есть неадекватные модели они снова выдадут неадекватные прогнозы. Нужно ждать их уничтожения. ","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/978084688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/978137192","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-978137192","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":978137192,"node_id":"IC_kwDOCYyMws46TTBo","user":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false},"created_at":"2021-11-24T18:47:11Z","updated_at":"2021-11-24T18:47:11Z","author_association":"CONTRIBUTOR","body":"> судя по максимальному количеству прогнозов\r\n\r\nа сколько можно считать достаточным?\r\n\r\n> Но у вас там как-то изменена логика\r\n\r\nона почти такая же, просто градиенты внутри прогноза одной модели преобразуются в квантили (что уже обеспечивает защиту от выбросов), после чего эти квантили усредняются по всем моделям.","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/978137192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/978796973","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-978796973","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":978796973,"node_id":"IC_kwDOCYyMws46V0Gt","user":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false},"created_at":"2021-11-25T03:39:57Z","updated_at":"2021-11-25T03:39:57Z","author_association":"OWNER","body":"> а сколько можно считать достаточным?\r\n\r\nНе знаю, тут какого-то формального критерия нет. Если на глаз, то у вас популяция должна быть в пару раз больше целевой, а максимальное число проверок сопоставимо с длинной прогноза.\r\n\r\n> она почти такая же, просто градиенты внутри прогноза одной модели преобразуются в квантили (что уже обеспечивает защиту от выбросов), после чего эти квантили усредняются по всем моделям.\r\n\r\nА как вы поняли, что у вас такие странные ковариационный матрицы?","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/978796973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WLM1ke","id":35304528,"node_id":"MDQ6VXNlcjM1MzA0NTI4","avatar_url":"https://avatars.githubusercontent.com/u/35304528?v=4","gravatar_id":"","url":"https://api.github.com/users/WLM1ke","html_url":"https://github.com/WLM1ke","followers_url":"https://api.github.com/users/WLM1ke/followers","following_url":"https://api.github.com/users/WLM1ke/following{/other_user}","gists_url":"https://api.github.com/users/WLM1ke/gists{/gist_id}","starred_url":"https://api.github.com/users/WLM1ke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WLM1ke/subscriptions","organizations_url":"https://api.github.com/users/WLM1ke/orgs","repos_url":"https://api.github.com/users/WLM1ke/repos","events_url":"https://api.github.com/users/WLM1ke/events{/privacy}","received_events_url":"https://api.github.com/users/WLM1ke/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/978850898","html_url":"https://github.com/WLM1ke/poptimizer/issues/70#issuecomment-978850898","issue_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/70","id":978850898,"node_id":"IC_kwDOCYyMws46WBRS","user":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false},"created_at":"2021-11-25T05:37:37Z","updated_at":"2021-11-25T07:45:35Z","author_association":"CONTRIBUTOR","body":"> А как вы поняли, что у вас такие странные ковариационный матрицы?\r\n\r\nПо ворнингам при расчете, например, STD. NA получались, с которыми hmean из коробки работать не умеет.\r\n````\r\nPATH_TO/poptimizer/poptimizer/portfolio/metrics.py:90: RuntimeWarning: invalid value encountered in matmul\r\n  beta = cov @ weight.reshape(-1, 1)\r\nPATH_TO/poptimizer/poptimizer/portfolio/metrics.py:78: RuntimeWarning: invalid value encountered in matmul\r\n  portfolio_var = weight.reshape(1, -1) @ cov @ weight.reshape(-1, 1)  # noqa: WPS221\r\nPATH_TO/anaconda3/envs/finan/lib/python3.9/site-packages/numpy/lib/nanfunctions.py:1374: RuntimeWarning: All-NaN slice encountered\r\n  r, k = function_base._ureduce(\r\n````\r\nИ ворнингов было много, так как эти метрики рассчитываются каждый раз в оптимизационном цикле.","reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/comments/978850898/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false}},{"id":5673339060,"node_id":"CE_lADOCYyMws4-0wB9zwAAAAFSKEi0","url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/events/5673339060","actor":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-11-25T14:27:39Z","state_reason":null,"performed_via_github_app":null}]