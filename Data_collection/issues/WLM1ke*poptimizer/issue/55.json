{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/55","repository_url":"https://api.github.com/repos/WLM1ke/poptimizer","labels_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/55/labels{/name}","comments_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/55/comments","events_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/55/events","html_url":"https://github.com/WLM1ke/poptimizer/issues/55","id":884417205,"node_id":"MDU6SXNzdWU4ODQ0MTcyMDU=","number":55,"title":"KeyError","user":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-05-10T15:01:45Z","updated_at":"2021-05-10T20:16:22Z","closed_at":"2021-05-10T20:16:22Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Попробовал обновиться\r\n\r\n***2021-05-07: Шаг эволюции — 1***\r\nLLH - (-, -, -)\r\nМаксимум побед - None\r\nФактор - 100.00%\r\nПереоцениваю родителя:\r\nПобед — 0\r\nData: {'batch_size': 128.2320698209353, 'history_days': 77.63810095882658, 'ticker_on': 0.7109999601234973, 'day_of_year_on': 0.8938235704831489, 'day_of_period_on': -0.7415209704374337, 'prices_on': 0.3792032610427596, 'dividends_on': 0.7597968132102717, 'turnover_on': 0.5860555137690139, 'average_turnover_on': 0.6750234817940721, 'rvi_on': -0.758365200271929, 'mcftrr_on': -0.7678090475533608, 'imoex_on': -0.5441796726478852, 'ticker_type_on': -0.09997730965326945, 'usd_on': -0.334036922316718, 'open_on': -0.27818249383845906}\r\nModel: {}\r\nOptimizer: {'betas': 0.9990053414863606, 'eps': 9.991434975458438e-09, 'weight_decay': 0.009998127788332577}\r\nScheduler: {'max_lr': 0.009314820871952526, 'epochs': 1.0009126725233755, 'pct_start': 0.30099817073495205, 'anneal_strategy': 0.9825538484814915, 'base_momentum': 0.8492757678903675, 'max_momentum': 0.9508768810821049, 'div_factor': 24.975410927815844, 'final_div_factor': 10006.218260928737}\r\nTraceback (most recent call last):\r\n  File \"path_to\\poptimizer\\poptimizer\\__main__.py\", line 19, in evolve\r\n    ev.evolve(port)\r\n  File \"path_to\\poptimizer\\poptimizer\\evolve\\evolve.py\", line 56, in evolve\r\n    if _eval_and_print(parent, tickers, end) is None:\r\n  File \"path_to\\poptimizer\\poptimizer\\evolve\\evolve.py\", line 98, in _eval_and_print\r\n    fitness = organism.evaluate_fitness(tickers, end)\r\n  File \"path_to\\poptimizer\\poptimizer\\evolve\\population.py\", line 78, in evaluate_fitness\r\n    llh = model.llh\r\n  File \"path_to\\poptimizer\\poptimizer\\dl\\model.py\", line 111, in llh\r\n    self._llh = self._eval_llh()\r\n  File \"path_to\\poptimizer\\poptimizer\\dl\\model.py\", line 145, in _eval_llh\r\n    model = self.prepare_model(loader)\r\n  File \"path_to\\poptimizer\\poptimizer\\dl\\model.py\", line 123, in prepare_model\r\n    self._model = self._train_model()\r\n  File \"path_to\\poptimizer\\poptimizer\\dl\\model.py\", line 218, in _train_model\r\n    model = self._make_untrained_model(loader)\r\n  File \"path_to\\poptimizer\\poptimizer\\dl\\model.py\", line 192, in _make_untrained_model\r\n    model = model_type(loader.history_days, loader.features_description, **self._phenotype[\"model\"])\r\nKeyError: 'model'\r\n\r\nhttps://github.com/WLM1ke/poptimizer/blob/29d901067024b57111b13ac3a5750c0f09fae7a6/poptimizer/dl/model.py#L192\r\n\r\nУдаление моделей не изменило ситуацию.\r\n\r\nВ **self._phenotype** лежит вот что:\r\n```\r\n{\r\n  'type': 'WaveNet',\r\n  'data': {\r\n    'features': {\r\n      'Label': {\r\n        'on': True\r\n      },\r\n      'Ticker': {\r\n        'on': True\r\n      },\r\n      'DayOfYear': {\r\n        'on': True\r\n      },\r\n      'DayOfPeriod': {\r\n        'on': False\r\n      },\r\n      'Prices': {\r\n        'on': True\r\n      },\r\n      'Dividends': {\r\n        'on': True\r\n      },\r\n      'Turnover': {\r\n        'on': True\r\n      },\r\n      'AverageTurnover': {\r\n        'on': True\r\n      },\r\n      'RVI': {\r\n        'on': False\r\n      },\r\n      'MCFTRR': {\r\n        'on': False\r\n      },\r\n      'IMOEX': {\r\n        'on': False\r\n      },\r\n      'TickerType': {\r\n        'on': False\r\n      },\r\n      'USD': {\r\n        'on': False\r\n      },\r\n      'Open': {\r\n        'on': False\r\n      }\r\n    },\r\n    'batch_size': 128,\r\n    'history_days': 77\r\n  },\r\n  'optimizer': {\r\n    'betas': (0.9,\r\n    0.9990053414863606),\r\n    'eps': 9.991434975458438e-09,\r\n    'weight_decay': 0.009998127788332577\r\n  },\r\n  'scheduler': {\r\n    'max_lr': 0.009314820871952526,\r\n    'epochs': 1.0009126725233755,\r\n    'pct_start': 0.30099817073495205,\r\n    'anneal_strategy': 'cos',\r\n    'base_momentum': 0.8492757678903675,\r\n    'max_momentum': 0.9508768810821049,\r\n    'div_factor': 24.975410927815844,\r\n    'final_div_factor': 10006.218260928737\r\n  }\r\n}\r\n\r\n```","closed_by":{"login":"RomaKoks","id":8873242,"node_id":"MDQ6VXNlcjg4NzMyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8873242?v=4","gravatar_id":"","url":"https://api.github.com/users/RomaKoks","html_url":"https://github.com/RomaKoks","followers_url":"https://api.github.com/users/RomaKoks/followers","following_url":"https://api.github.com/users/RomaKoks/following{/other_user}","gists_url":"https://api.github.com/users/RomaKoks/gists{/gist_id}","starred_url":"https://api.github.com/users/RomaKoks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomaKoks/subscriptions","organizations_url":"https://api.github.com/users/RomaKoks/orgs","repos_url":"https://api.github.com/users/RomaKoks/repos","events_url":"https://api.github.com/users/RomaKoks/events{/privacy}","received_events_url":"https://api.github.com/users/RomaKoks/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/55/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/55/timeline","performed_via_github_app":null,"state_reason":"completed"}