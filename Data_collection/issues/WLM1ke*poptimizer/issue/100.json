{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/100","repository_url":"https://api.github.com/repos/WLM1ke/poptimizer","labels_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/100/labels{/name}","comments_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/100/comments","events_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/100/events","html_url":"https://github.com/WLM1ke/poptimizer/issues/100","id":1120315309,"node_id":"I_kwDOCYyMws5Cxqet","number":100,"title":"TypeError: 'type' object is not subscriptable","user":{"login":"iDoka","id":4820969,"node_id":"MDQ6VXNlcjQ4MjA5Njk=","avatar_url":"https://avatars.githubusercontent.com/u/4820969?v=4","gravatar_id":"","url":"https://api.github.com/users/iDoka","html_url":"https://github.com/iDoka","followers_url":"https://api.github.com/users/iDoka/followers","following_url":"https://api.github.com/users/iDoka/following{/other_user}","gists_url":"https://api.github.com/users/iDoka/gists{/gist_id}","starred_url":"https://api.github.com/users/iDoka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iDoka/subscriptions","organizations_url":"https://api.github.com/users/iDoka/orgs","repos_url":"https://api.github.com/users/iDoka/repos","events_url":"https://api.github.com/users/iDoka/events{/privacy}","received_events_url":"https://api.github.com/users/iDoka/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-02-01T07:18:53Z","updated_at":"2022-07-19T05:10:29Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Приветствую!\r\nВ первую очередь спасибо за разработку.\r\n\r\nМой сетап:\r\n**OS: CentOS 7 64bit\r\nPython 3.6.8**\r\n\r\nПытаюсь запустить на последнем коммите из ветки мастер:\r\n\r\n```\r\n$ python3 -m poptimizer\r\nTraceback (most recent call last):\r\n  File \"/usr/lib64/python3.6/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/usr/lib64/python3.6/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/doka/proj/2022/poptimizer/poptimizer/__main__.py\", line 6, in <module>\r\n    from poptimizer import config\r\n  File \"/home/doka/proj/2022/poptimizer/poptimizer/config.py\", line 9, in <module>\r\n    from poptimizer.shared.log import get_handlers\r\n  File \"/home/doka/proj/2022/poptimizer/poptimizer/shared/log.py\", line 48, in <module>\r\n    ) -> list[Handler]:\r\nTypeError: 'type' object is not subscriptable\r\n```\r\n\r\npytest жалуется на аналогичную проблему:\r\n\r\n```\r\n$ pytest poptimizer -v --cov=poptimizer --cov-report=term-missing --cov-report=xml --setup-show\r\n================================================================================================================================== test session starts ===================================================================================================================================\r\nplatform linux -- Python 3.6.8, pytest-6.2.5, py-1.11.0, pluggy-1.0.0 -- /home/doka/proj/2022/poptimizer/.venv/bin/python3\r\ncachedir: .pytest_cache\r\nrootdir: /home/doka/proj/2022/poptimizer\r\nplugins: asyncio-0.16.0, cov-3.0.0, mock-3.6.1\r\ncollected 0 items / 1 error                                                                                                                                                                                                                                                              \r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/data/adapters/gateways/cpi.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/data/app/viewers.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/data/domain/factory.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/data/domain/tables/cbr.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/data/domain/tables/cpi.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/data/domain/tables/dividends.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/data/domain/tables/indexes.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/data/domain/tables/quotes.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/data/domain/tables/trading_dates.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/data/domain/tables/usd.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/dl/features/turnover.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/dl/model.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/evolve/evolve.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/evolve/population.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/portfolio/portfolio.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/shared/adapters.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/shared/connections.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n/home/doka/proj/2022/poptimizer/.venv/lib64/python3.6/site-packages/coverage/report.py:81: CoverageWarning: Couldn't parse Python file '/home/doka/proj/2022/poptimizer/poptimizer/store/database.py' (couldnt-parse)\r\n  coverage._warn(msg, slug=\"couldnt-parse\")\r\n\r\n========================================================================================================================================= ERRORS =========================================================================================================================================\r\n_____________________________________________________________________________________________________________________________ ERROR collecting test session ______________________________________________________________________________________________________________________________\r\n/usr/lib64/python3.6/importlib/__init__.py:126: in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n<frozen importlib._bootstrap>:994: in _gcd_import\r\n    ???\r\n<frozen importlib._bootstrap>:971: in _find_and_load\r\n    ???\r\n<frozen importlib._bootstrap>:941: in _find_and_load_unlocked\r\n    ???\r\n<frozen importlib._bootstrap>:219: in _call_with_frames_removed\r\n    ???\r\n<frozen importlib._bootstrap>:994: in _gcd_import\r\n    ???\r\n<frozen importlib._bootstrap>:971: in _find_and_load\r\n    ???\r\n<frozen importlib._bootstrap>:941: in _find_and_load_unlocked\r\n    ???\r\n<frozen importlib._bootstrap>:219: in _call_with_frames_removed\r\n    ???\r\n<frozen importlib._bootstrap>:994: in _gcd_import\r\n    ???\r\n<frozen importlib._bootstrap>:971: in _find_and_load\r\n    ???\r\n<frozen importlib._bootstrap>:955: in _find_and_load_unlocked\r\n    ???\r\n<frozen importlib._bootstrap>:665: in _load_unlocked\r\n    ???\r\n<frozen importlib._bootstrap_external>:678: in exec_module\r\n    ???\r\n<frozen importlib._bootstrap>:219: in _call_with_frames_removed\r\n    ???\r\npoptimizer/reports/__init__.py:2: in <module>\r\n    from poptimizer.reports.pdf import report\r\npoptimizer/reports/pdf.py:5: in <module>\r\n    from poptimizer.config import REPORTS_PATH, POptimizerError\r\npoptimizer/config.py:9: in <module>\r\n    from poptimizer.shared.log import get_handlers\r\npoptimizer/shared/log.py:48: in <module>\r\n    ) -> list[Handler]:\r\nE   TypeError: 'type' object is not subscriptable\r\n\r\n----------- coverage: platform linux, python 3.6.8-final-0 -----------\r\nName                                                  Stmts   Miss Branch BrPart  Cover   Missing\r\n-------------------------------------------------------------------------------------------------\r\npoptimizer/__init__.py                                    0      0      0      0   100%\r\npoptimizer/__main__.py                                   20     20      0      0     0%   2-36\r\npoptimizer/config.py                                     36     29      4      0    18%   12-65\r\npoptimizer/conftest.py                                    8      3      0      0    62%   11-13\r\npoptimizer/data/__init__.py                               0      0      0      0   100%\r\npoptimizer/data/adapters/__init__.py                      0      0      0      0   100%\r\npoptimizer/data/adapters/gateways/__init__.py             0      0      0      0   100%\r\npoptimizer/data/adapters/gateways/bcs.py                 53     53     14      0     0%   2-83\r\npoptimizer/data/adapters/gateways/cbr.py                 28     28      4      0     0%   2-57\r\npoptimizer/data/adapters/gateways/close_reestry.py       52     52     14      0     0%   2-91\r\npoptimizer/data/adapters/gateways/conomy.py              54     54      4      0     0%   2-105\r\npoptimizer/data/adapters/gateways/dividends.py           24     24      8      0     0%   2-50\r\npoptimizer/data/adapters/gateways/dohod.py               24     24      2      0     0%   2-50\r\npoptimizer/data/adapters/gateways/finrange.py            38     38      4      0     0%   2-71\r\npoptimizer/data/adapters/gateways/gateways.py            17     17      8      0     0%   2-39\r\npoptimizer/data/adapters/gateways/invest_mint.py         54     54     12      0     0%   2-111\r\npoptimizer/data/adapters/gateways/moex.py                56     56     14      0     0%   2-173\r\npoptimizer/data/adapters/gateways/moex_status.py         25     25      4      0     0%   2-58\r\npoptimizer/data/adapters/gateways/nasdaq.py              35     35      4      0     0%   2-72\r\npoptimizer/data/adapters/gateways/smart_lab.py           19     19      2      0     0%   2-48\r\npoptimizer/data/adapters/gateways/street_insider.py      25     25      2      0     0%   2-52\r\npoptimizer/data/adapters/html/__init__.py                 0      0      0      0   100%\r\npoptimizer/data/adapters/html/cell_parser.py             46     46     10      0     0%   2-64\r\npoptimizer/data/adapters/html/chromium.py                28     28      6      0     0%   2-56\r\npoptimizer/data/adapters/html/description.py             27     27     10      0     0%   2-56\r\npoptimizer/data/adapters/html/parser.py                  52     52     13      0     0%   2-87\r\npoptimizer/data/adapters/odm.py                          49     49     10      0     0%   2-107\r\npoptimizer/data/app/__init__.py                           0      0      0      0   100%\r\npoptimizer/data/app/bootstrap.py                         19     19      2      0     0%   2-47\r\npoptimizer/data/domain/__init__.py                        0      0      0      0   100%\r\npoptimizer/data/domain/events.py                         31     31     12      0     0%   2-64\r\npoptimizer/data/domain/handlers.py                       51     51     12      0     0%   2-123\r\npoptimizer/data/domain/tables/__init__.py                 0      0      0      0   100%\r\npoptimizer/data/domain/tables/base.py                    64     64     24      0     0%   2-123\r\npoptimizer/data/domain/tables/securities.py              39     39     10      0     0%   2-86\r\npoptimizer/data/ports.py                                 12     12      0      0     0%   2-15\r\npoptimizer/data/views/__init__.py                         0      0      0      0   100%\r\npoptimizer/data/views/crop/__init__.py                    0      0      0      0   100%\r\npoptimizer/data/views/crop/div.py                        17     17      2      0     0%   2-43\r\npoptimizer/data/views/crop/not_div.py                    17     17      2      0     0%   2-37\r\npoptimizer/data/views/div_status.py                      58     58     14      0     0%   2-124\r\npoptimizer/data/views/go.py                               8      8      0      0     0%   2-13\r\npoptimizer/data/views/indexes.py                         28     28      0      0     0%   2-65\r\npoptimizer/data/views/listing.py                         24     24      0      0     0%   2-52\r\npoptimizer/data/views/quotes.py                          34     34      8      0     0%   2-107\r\npoptimizer/dl/__init__.py                                 4      4      0      0     0%   2-5\r\npoptimizer/dl/data_loader.py                             38     38     12      0     0%   2-86\r\npoptimizer/dl/features/__init__.py                       18     18      0      0     0%   2-19\r\npoptimizer/dl/features/data_params.py                    79     79     12      0     0%   2-170\r\npoptimizer/dl/features/day_of_period.py                  14     14      2      0     0%   2-29\r\npoptimizer/dl/features/day_of_year.py                    16     16      2      0     0%   2-32\r\npoptimizer/dl/features/dividends.py                      16     16      2      0     0%   2-28\r\npoptimizer/dl/features/feature.py                        18     18      4      0     0%   2-40\r\npoptimizer/dl/features/high.py                           20     20      2      0     0%   2-37\r\npoptimizer/dl/features/imoex.py                          19     19      2      0     0%   2-38\r\npoptimizer/dl/features/label.py                          28     28      2      0     0%   2-41\r\npoptimizer/dl/features/low.py                            20     20      2      0     0%   2-37\r\npoptimizer/dl/features/mcftrr.py                         19     19      2      0     0%   2-37\r\npoptimizer/dl/features/meogtrr.py                        19     19      2      0     0%   2-33\r\npoptimizer/dl/features/open.py                           21     21      2      0     0%   2-39\r\npoptimizer/dl/features/prices.py                         17     17      2      0     0%   2-27\r\npoptimizer/dl/features/rvi.py                            19     19      2      0     0%   2-37\r\npoptimizer/dl/features/ticker.py                         16     16      2      0     0%   2-26\r\npoptimizer/dl/features/ticker_type.py                    17     17      2      0     0%   2-32\r\npoptimizer/dl/features/usd.py                            19     19      2      0     0%   2-38\r\npoptimizer/dl/forecast.py                                19     19      2      0     0%   2-28\r\npoptimizer/dl/ledoit_wolf.py                             33     33      0      0     0%   2-82\r\npoptimizer/dl/ledoit_wolf_nonlinear.py                   52     52      4      0     0%   1-141\r\npoptimizer/dl/models/__init__.py                          1      1      0      0     0%   2\r\npoptimizer/dl/models/wave_net.py                        112    112     42      0     0%   2-334\r\npoptimizer/evolve/__init__.py                             2      2      0      0     0%   2-3\r\npoptimizer/evolve/chromosomes/__init__.py                 6      6      0      0     0%   2-7\r\npoptimizer/evolve/chromosomes/chromosome.py              46     46     16      0     0%   2-134\r\npoptimizer/evolve/chromosomes/data.py                    22     22     34      0     0%   2-154\r\npoptimizer/evolve/chromosomes/model.py                   12     12      4      0     0%   2-75\r\npoptimizer/evolve/chromosomes/optimizer.py                6      6      4      0     0%   2-33\r\npoptimizer/evolve/chromosomes/scheduler.py               11     11      4      0     0%   2-73\r\npoptimizer/evolve/chromosomes/utility.py                  5      5      2      0     0%   2-37\r\npoptimizer/evolve/forecaster.py                          66     66     18      0     0%   2-137\r\npoptimizer/evolve/genotype.py                            33     33     10      0     0%   2-80\r\npoptimizer/evolve/seq.py                                 22     22      6      0     0%   10-109\r\npoptimizer/evolve/store.py                               79     79     20      0     0%   2-151\r\npoptimizer/portfolio/__init__.py                          1      1      0      0     0%   2\r\npoptimizer/portfolio/metrics.py                         176    176     42      0     0%   2-346\r\npoptimizer/portfolio/optimizer_hmean.py                  99     99     14      0     0%   2-199\r\npoptimizer/portfolio/optimizer_resample.py               81     81     10      0     0%   2-191\r\npoptimizer/reports/__init__.py                            2      1      0      0    50%   3\r\npoptimizer/reports/excel.py                              14     14      4      0     0%   1-25\r\npoptimizer/reports/pdf.py                                60     57     10      0     4%   6-153\r\npoptimizer/reports/pdf_lower.py                          62     62      4      0     0%   2-144\r\npoptimizer/reports/pdf_middle.py                         75     75      6      0     0%   3-130\r\npoptimizer/reports/pdf_style.py                          36     36      0      0     0%   2-76\r\npoptimizer/reports/pdf_upper.py                          85     85      8      0     0%   3-172\r\npoptimizer/reports/simple.py                             49     49      2      0     0%   2-107\r\npoptimizer/shared/__init__.py                             0      0      0      0   100%\r\npoptimizer/shared/app.py                                 60     60     22      0     0%   2-133\r\npoptimizer/shared/col.py                                 21     21      0      0     0%   2-30\r\npoptimizer/shared/domain.py                              35     35     14      0     0%   2-78\r\npoptimizer/shared/log.py                                 33     20      4      0    41%   16, 23-29, 33-37, 41, 50-65\r\npoptimizer/store/__init__.py                              0      0      0      0   100%\r\n-------------------------------------------------------------------------------------------------\r\nTOTAL                                                  3025   2996    599      0     1%\r\nCoverage XML written to file coverage.xml\r\n\r\n================================================================================================================================ short test summary info =================================================================================================================================\r\nERROR  - TypeError: 'type' object is not subscriptable\r\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n==================================================================================================================================== 1 error in 2.17s ====================================================================================================================================\r\n```\r\n\r\nЯ что-то делаю не так или есть какой-то более стабильно работающий коммит?\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/100/timeline","performed_via_github_app":null,"state_reason":null}