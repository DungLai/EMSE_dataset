{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/60","repository_url":"https://api.github.com/repos/WLM1ke/poptimizer","labels_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/60/labels{/name}","comments_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/60/comments","events_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/60/events","html_url":"https://github.com/WLM1ke/poptimizer/issues/60","id":936244870,"node_id":"MDU6SXNzdWU5MzYyNDQ4NzA=","number":60,"title":"ValueError","user":{"login":"AlexQww","id":85064291,"node_id":"MDQ6VXNlcjg1MDY0Mjkx","avatar_url":"https://avatars.githubusercontent.com/u/85064291?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexQww","html_url":"https://github.com/AlexQww","followers_url":"https://api.github.com/users/AlexQww/followers","following_url":"https://api.github.com/users/AlexQww/following{/other_user}","gists_url":"https://api.github.com/users/AlexQww/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexQww/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexQww/subscriptions","organizations_url":"https://api.github.com/users/AlexQww/orgs","repos_url":"https://api.github.com/users/AlexQww/repos","events_url":"https://api.github.com/users/AlexQww/events{/privacy}","received_events_url":"https://api.github.com/users/AlexQww/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2021-07-03T12:25:39Z","updated_at":"2021-07-22T11:13:23Z","closed_at":"2021-07-22T11:13:23Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Потомок:\r\nПобед — 0\r\nData: {'batch_size': 177.7385721058952, 'history_days': 55.70134040397355, 'ticker_on': -90.52231354907431, 'day_of_year_on': 10.266435523458313, 'day_of_period_on': -59.75439292031155, 'prices_on': 464.5733644522056, 'dividends_on': -6.221069051894889, 'turnover_on': 0.6707214118303866, 'average_turnover_on': -64.84367367009655, 'rvi_on': 451.557234503783, 'mcftrr_on': 5.060442543491146, 'imoex_on': -2605.016051899486, 'ticker_type_on': 426.15916544317963, 'usd_on': -17.02749236435758, 'open_on': 36.30055136508749, 'high_on': 41.832617063123394, 'low_on': -42.290686709031405}\r\nModel: {'start_bn': 3.68131633535158, 'kernels': 1.8169208373228016, 'sub_blocks': 1.172485135834774, 'gate_channels': 9.603954794985695, 'residual_channels': 14.822437221051137, 'skip_channels': 21.963910979579275, 'end_channels': 23.69156068767206, 'mixture_size': 12.36557598230185}\r\nOptimizer: {'betas': 0.998975098900571, 'eps': 6.043738817960838e-09, 'weight_decay': 0.017549188685557042}\r\nScheduler: {'max_lr': 0.026301493988270034, 'epochs': 0.975965210378401, 'pct_start': 0.2750600642864314, 'anneal_strategy': -58.68592289332554, 'base_momentum': 0.6260647115426332, 'max_momentum': 0.7563211017511952, 'div_factor': 23.49088257256306, 'final_div_factor': 885334.0228427305}\r\nКоличество слоев - 74\r\nКоличество параметров - 13761\r\nEpochs - 0.98\r\nTrain size - 197585\r\n~~> Train:  27%|████████████████████████                                                                 | 295/1091 [00:13<00:35, 22.13it/s, -0.22357]\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.9/runpy.py\", line 197, in _run_module_as_main\r\n    return _run_code(code, main_globals, None,\r\n  File \"/usr/lib/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/torchok/PycharmProjects/poptimizer/poptimizer/__main__.py\", line 158, in <module>\r\n    app(prog_name=\"poptimizer\")\r\n  File \"/home/torchok/PycharmProjects/poptimizer/venv/lib/python3.9/site-packages/typer/main.py\", line 214, in __call__\r\n    return get_command(self)(*args, **kwargs)\r\n  File \"/home/torchok/PycharmProjects/poptimizer/venv/lib/python3.9/site-packages/click/core.py\", line 829, in __call__\r\n    return self.main(*args, **kwargs)\r\n  File \"/home/torchok/PycharmProjects/poptimizer/venv/lib/python3.9/site-packages/click/core.py\", line 782, in main\r\n    rv = self.invoke(ctx)\r\n  File \"/home/torchok/PycharmProjects/poptimizer/venv/lib/python3.9/site-packages/click/core.py\", line 1259, in invoke\r\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\r\n  File \"/home/torchok/PycharmProjects/poptimizer/venv/lib/python3.9/site-packages/click/core.py\", line 1066, in invoke\r\n    return ctx.invoke(self.callback, **ctx.params)\r\n  File \"/home/torchok/PycharmProjects/poptimizer/venv/lib/python3.9/site-packages/click/core.py\", line 610, in invoke\r\n    return callback(*args, **kwargs)\r\n  File \"/home/torchok/PycharmProjects/poptimizer/venv/lib/python3.9/site-packages/typer/main.py\", line 497, in wrapper\r\n    return callback(**use_params)  # type: ignore\r\n  File \"/home/torchok/PycharmProjects/poptimizer/poptimizer/__main__.py\", line 17, in evolve\r\n    ev.evolve()\r\n  File \"/home/torchok/PycharmProjects/poptimizer/poptimizer/evolve/evolve.py\", line 76, in evolve\r\n    if _eval_and_print(child, tickers, end) is None:\r\n  File \"/home/torchok/PycharmProjects/poptimizer/poptimizer/evolve/evolve.py\", line 112, in _eval_and_print\r\n    fitness = organism.evaluate_fitness(tickers, end)\r\n  File \"/home/torchok/PycharmProjects/poptimizer/poptimizer/evolve/population.py\", line 83, in evaluate_fitness\r\n    llh, ir = model.quality_metrics\r\n  File \"/home/torchok/PycharmProjects/poptimizer/poptimizer/dl/model.py\", line 114, in quality_metrics\r\n    self._llh = self._eval_llh()\r\n  File \"/home/torchok/PycharmProjects/poptimizer/poptimizer/dl/model.py\", line 148, in _eval_llh\r\n    model = self.prepare_model(loader)\r\n  File \"/home/torchok/PycharmProjects/poptimizer/poptimizer/dl/model.py\", line 126, in prepare_model\r\n    self._model = self._train_model()\r\n  File \"/home/torchok/PycharmProjects/poptimizer/poptimizer/dl/model.py\", line 258, in _train_model\r\n    loss, means, _ = loss_fn(model, batch)\r\n  File \"/home/torchok/PycharmProjects/poptimizer/poptimizer/dl/model.py\", line 62, in log_normal_llh_mix\r\n    dist = model.dist(batch)\r\n  File \"/home/torchok/PycharmProjects/poptimizer/poptimizer/dl/models/wave_net.py\", line 318, in dist\r\n    weights_dist = distributions.Categorical(logits=logits)\r\n  File \"/home/torchok/PycharmProjects/poptimizer/venv/lib/python3.9/site-packages/torch/distributions/categorical.py\", line 64, in __init__\r\n    super(Categorical, self).__init__(batch_shape, validate_args=validate_args)\r\n  File \"/home/torchok/PycharmProjects/poptimizer/venv/lib/python3.9/site-packages/torch/distributions/distribution.py\", line 53, in __init__\r\n    raise ValueError(\"The parameter {} has invalid values\".format(param))\r\nValueError: The parameter logits has invalid values","closed_by":{"login":"AlexQww","id":85064291,"node_id":"MDQ6VXNlcjg1MDY0Mjkx","avatar_url":"https://avatars.githubusercontent.com/u/85064291?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexQww","html_url":"https://github.com/AlexQww","followers_url":"https://api.github.com/users/AlexQww/followers","following_url":"https://api.github.com/users/AlexQww/following{/other_user}","gists_url":"https://api.github.com/users/AlexQww/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexQww/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexQww/subscriptions","organizations_url":"https://api.github.com/users/AlexQww/orgs","repos_url":"https://api.github.com/users/AlexQww/repos","events_url":"https://api.github.com/users/AlexQww/events{/privacy}","received_events_url":"https://api.github.com/users/AlexQww/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/60/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/WLM1ke/poptimizer/issues/60/timeline","performed_via_github_app":null,"state_reason":"completed"}