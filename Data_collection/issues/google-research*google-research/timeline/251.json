[{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/623045474","html_url":"https://github.com/google-research/google-research/issues/251#issuecomment-623045474","issue_url":"https://api.github.com/repos/google-research/google-research/issues/251","id":623045474,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMzA0NTQ3NA==","user":{"login":"poset","id":5651827,"node_id":"MDQ6VXNlcjU2NTE4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/5651827?v=4","gravatar_id":"","url":"https://api.github.com/users/poset","html_url":"https://github.com/poset","followers_url":"https://api.github.com/users/poset/followers","following_url":"https://api.github.com/users/poset/following{/other_user}","gists_url":"https://api.github.com/users/poset/gists{/gist_id}","starred_url":"https://api.github.com/users/poset/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/poset/subscriptions","organizations_url":"https://api.github.com/users/poset/orgs","repos_url":"https://api.github.com/users/poset/repos","events_url":"https://api.github.com/users/poset/events{/privacy}","received_events_url":"https://api.github.com/users/poset/received_events","type":"User","site_admin":false},"created_at":"2020-05-03T02:45:49Z","updated_at":"2020-05-03T02:46:28Z","author_association":"NONE","body":"Giving more logs plus verifying it won't even go 1 step on a v3-8 with 2x2 topology config.\r\n\r\nIf I kill the process, it prints this:\r\n\r\n(edit, if there's a better way to format this please let me know)\r\n# Termination print\r\n`INFO:tensorflow:training_loop marked as finished\r\nI0503 02:43:25.864410 140402965063488 error_handling.py:108] training_loop marked as finished\r\nTraceback (most recent call last):\r\n  File \"/home/eligray2/.local/bin/t5_mesh_transformer\", line 8, in <module>\r\n    sys.exit(console_entry_point())\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/t5/models/mesh_transformer_main.py\", line 222, in console_entry_point\r\n    app.run(main)\r\n  File \"/usr/local/lib/python3.7/dist-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/usr/local/lib/python3.7/dist-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/t5/models/mesh_transformer_main.py\", line 216, in main\r\n    model_dir=FLAGS.model_dir)\r\n  File \"/usr/local/lib/python3.7/dist-packages/gin/config.py\", line 1055, in gin_wrapper\r\n    return fn(*new_args, **new_kwargs)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/mesh_tensorflow/transformer/utils.py\", line 1738, in run\r\n    train_dataset_fn, train_steps, ensemble_inputs)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/mesh_tensorflow/transformer/utils.py\", line 1132, in train_model\r\n    estimator.train(input_fn=input_fn, max_steps=train_steps)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 3030, in train\r\n    saving_listeners=saving_listeners)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_estimator/python/estimator/estimator.py\", line 374, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1164, in _train_model\r\n    return self._train_model_default(input_fn, hooks, saving_listeners)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1194, in _train_model_default\r\n    features, labels, ModeKeys.TRAIN, self.config)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 2857, in _call_model_fn\r\n    config)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1152, in _call_model_fn\r\n    model_fn_results = self._model_fn(features=features, **kwargs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 3148, in _model_fn\r\n    input_holders.generate_infeed_enqueue_ops_and_dequeue_fn())\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 1428, in generate_infeed_enqueue_ops_and_dequeue_f\r\nn\r\n    self._invoke_input_fn_and_record_structure())\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 1483, in _invoke_input_fn_and_record_structure\r\n    num_hosts))\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 1090, in generate_broadcast_enqueue_ops_fn\r\n    inputs = _Inputs.from_input_fn(input_fn(user_context))\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 3001, in _input_fn\r\n    return input_fn(**kwargs)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/mesh_tensorflow/transformer/utils.py\", line 1126, in input_fn\r\n    dataset_split=dataset_split)\r\n  File \"/usr/local/lib/python3.7/dist-packages/gin/config.py\", line 1055, in gin_wrapper\r\n    return fn(*new_args, **new_kwargs)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/t5/models/mesh_transformer.py\", line 66, in mesh_train_dataset_fn\r\n    sequence_length, split=dataset_split, use_cached=use_cached, shuffle=True)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/t5/data/utils.py\", line 637, in get_dataset\r\n    ds = self._dataset_fn(split=split, shuffle_files=shuffle)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/t5/data/utils.py\", line 739, in dataset_fn\r\n    return self._tfds_dataset.load(split, shuffle_files)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/t5/data/utils.py\", line 217, in load\r\n    try_gcs=True)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/tensorflow_datasets/core/api_utils.py\", line 69, in disallow_positional_args_dec\r\n    return fn(*args, **kwargs)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/tensorflow_datasets/core/registered.py\", line 369, in load\r\n    dbuilder.download_and_prepare(**download_and_prepare_kwargs)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/tensorflow_datasets/core/api_utils.py\", line 69, in disallow_positional_args_dec\r\n    return fn(*args, **kwargs)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/tensorflow_datasets/core/dataset_builder.py\", line 363, in download_and_prepare\r\n    download_config=download_config)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/tensorflow_datasets/core/dataset_builder.py\", line 1004, in _download_and_prepare\r\n    max_examples_per_split=download_config.max_examples_per_split,\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/tensorflow_datasets/core/dataset_builder.py\", line 924, in _download_and_prepare\r\n    dl_manager, **split_generators_kwargs):\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/tensorflow_datasets/text/movie_rationales.py\", line 71, in _split_generators\r\n    dl_dir = dl_manager.download_and_extract(_DOWNLOAD_URL)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/tensorflow_datasets/core/download/download_manager.py\", line 419, in download_and_extract\r\n    return _map_promise(self._download_extract, url_or_urls)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/tensorflow_datasets/core/download/download_manager.py\", line 462, in _map_promise\r\n    res = utils.map_nested(_wait_on_promise, all_promises)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/tensorflow_datasets/core/utils/py_utils.py\", line 169, in map_nested\r\n    return function(data_struct)\r\n  File \"/home/eligray2/.local/lib/python3.7/site-packages/tensorflow_datasets/core/download/download_manager.py\", line 446, in _wait_on_promise\r\n    return p.get()\r\n  File \"/usr/local/lib/python3.7/dist-packages/promise/promise.py\", line 511, in get\r\n    self._wait(timeout or DEFAULT_TIMEOUT)\r\n  File \"/usr/local/lib/python3.7/dist-packages/promise/promise.py\", line 506, in _wait\r\n    self.wait(self, timeout)\r\n  File \"/usr/local/lib/python3.7/dist-packages/promise/promise.py\", line 502, in wait\r\n    async_instance.wait(promise, timeout)\r\n  File \"/usr/local/lib/python3.7/dist-packages/promise/async_.py\", line 117, in wait\r\n    target.scheduler.wait(target, timeout)\r\n  File \"/usr/local/lib/python3.7/dist-packages/promise/schedulers/immediate.py\", line 25, in wait\r\n    waited = e.wait(timeout)\r\n  File \"/usr/lib/python3.7/threading.py\", line 552, in wait\r\n    signaled = self._cond.wait(timeout)\r\n  File \"/usr/lib/python3.7/threading.py\", line 296, in wait\r\n    waiter.acquire()\r\nKeyboardInterrupt\r\n`","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/623045474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"poset","id":5651827,"node_id":"MDQ6VXNlcjU2NTE4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/5651827?v=4","gravatar_id":"","url":"https://api.github.com/users/poset","html_url":"https://github.com/poset","followers_url":"https://api.github.com/users/poset/followers","following_url":"https://api.github.com/users/poset/following{/other_user}","gists_url":"https://api.github.com/users/poset/gists{/gist_id}","starred_url":"https://api.github.com/users/poset/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/poset/subscriptions","organizations_url":"https://api.github.com/users/poset/orgs","repos_url":"https://api.github.com/users/poset/repos","events_url":"https://api.github.com/users/poset/events{/privacy}","received_events_url":"https://api.github.com/users/poset/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/623070851","html_url":"https://github.com/google-research/google-research/issues/251#issuecomment-623070851","issue_url":"https://api.github.com/repos/google-research/google-research/issues/251","id":623070851,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMzA3MDg1MQ==","user":{"login":"poset","id":5651827,"node_id":"MDQ6VXNlcjU2NTE4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/5651827?v=4","gravatar_id":"","url":"https://api.github.com/users/poset","html_url":"https://github.com/poset","followers_url":"https://api.github.com/users/poset/followers","following_url":"https://api.github.com/users/poset/following{/other_user}","gists_url":"https://api.github.com/users/poset/gists{/gist_id}","starred_url":"https://api.github.com/users/poset/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/poset/subscriptions","organizations_url":"https://api.github.com/users/poset/orgs","repos_url":"https://api.github.com/users/poset/repos","events_url":"https://api.github.com/users/poset/events{/privacy}","received_events_url":"https://api.github.com/users/poset/received_events","type":"User","site_admin":false},"created_at":"2020-05-03T07:55:16Z","updated_at":"2020-05-03T07:55:16Z","author_association":"NONE","body":"Solved\r\n\r\nhttps://github.com/google-research/text-to-text-transfer-transformer/issues/205","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/623070851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"poset","id":5651827,"node_id":"MDQ6VXNlcjU2NTE4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/5651827?v=4","gravatar_id":"","url":"https://api.github.com/users/poset","html_url":"https://github.com/poset","followers_url":"https://api.github.com/users/poset/followers","following_url":"https://api.github.com/users/poset/following{/other_user}","gists_url":"https://api.github.com/users/poset/gists{/gist_id}","starred_url":"https://api.github.com/users/poset/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/poset/subscriptions","organizations_url":"https://api.github.com/users/poset/orgs","repos_url":"https://api.github.com/users/poset/repos","events_url":"https://api.github.com/users/poset/events{/privacy}","received_events_url":"https://api.github.com/users/poset/received_events","type":"User","site_admin":false}},{"id":3297169196,"node_id":"MDExOkNsb3NlZEV2ZW50MzI5NzE2OTE5Ng==","url":"https://api.github.com/repos/google-research/google-research/issues/events/3297169196","actor":{"login":"poset","id":5651827,"node_id":"MDQ6VXNlcjU2NTE4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/5651827?v=4","gravatar_id":"","url":"https://api.github.com/users/poset","html_url":"https://github.com/poset","followers_url":"https://api.github.com/users/poset/followers","following_url":"https://api.github.com/users/poset/following{/other_user}","gists_url":"https://api.github.com/users/poset/gists{/gist_id}","starred_url":"https://api.github.com/users/poset/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/poset/subscriptions","organizations_url":"https://api.github.com/users/poset/orgs","repos_url":"https://api.github.com/users/poset/repos","events_url":"https://api.github.com/users/poset/events{/privacy}","received_events_url":"https://api.github.com/users/poset/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-05-03T07:55:16Z","state_reason":null,"performed_via_github_app":null}]