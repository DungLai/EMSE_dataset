[{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/580670381","html_url":"https://github.com/google-research/google-research/issues/183#issuecomment-580670381","issue_url":"https://api.github.com/repos/google-research/google-research/issues/183","id":580670381,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDY3MDM4MQ==","user":{"login":"sjblim","id":3411074,"node_id":"MDQ6VXNlcjM0MTEwNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3411074?v=4","gravatar_id":"","url":"https://api.github.com/users/sjblim","html_url":"https://github.com/sjblim","followers_url":"https://api.github.com/users/sjblim/followers","following_url":"https://api.github.com/users/sjblim/following{/other_user}","gists_url":"https://api.github.com/users/sjblim/gists{/gist_id}","starred_url":"https://api.github.com/users/sjblim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sjblim/subscriptions","organizations_url":"https://api.github.com/users/sjblim/orgs","repos_url":"https://api.github.com/users/sjblim/repos","events_url":"https://api.github.com/users/sjblim/events{/privacy}","received_events_url":"https://api.github.com/users/sjblim/received_events","type":"User","site_admin":false},"created_at":"2020-01-31T10:08:57Z","updated_at":"2020-01-31T10:13:48Z","author_association":"NONE","body":"@hihihihiwsf -- please note that the model does separate the into the relevant categories (i.e. observed inputs, known future inputs,  targets and static inputs) as per:\r\nhttps://github.com/google-research/google-research/blob/1fec1abdc5a54d6f2ac8b5ef3420b36d4e6509f0/tft/libs/tft_model.py#L795-L796\r\n\r\nAll historical time-varying information known at forecast time (i.e. observed inputs, known inputs and target) is then combined together and fed only into the LSTM encoder, i.e.:\r\nhttps://github.com/google-research/google-research/blob/1fec1abdc5a54d6f2ac8b5ef3420b36d4e6509f0/tft/libs/tft_model.py#L800-L805\r\n\r\nKnown future information (i.e. known inputs only) is then fed into the LSTM decoder only:\r\nhttps://github.com/google-research/google-research/blob/1fec1abdc5a54d6f2ac8b5ef3420b36d4e6509f0/tft/libs/tft_model.py#L814\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/580670381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sjblim","id":3411074,"node_id":"MDQ6VXNlcjM0MTEwNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3411074?v=4","gravatar_id":"","url":"https://api.github.com/users/sjblim","html_url":"https://github.com/sjblim","followers_url":"https://api.github.com/users/sjblim/followers","following_url":"https://api.github.com/users/sjblim/following{/other_user}","gists_url":"https://api.github.com/users/sjblim/gists{/gist_id}","starred_url":"https://api.github.com/users/sjblim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sjblim/subscriptions","organizations_url":"https://api.github.com/users/sjblim/orgs","repos_url":"https://api.github.com/users/sjblim/repos","events_url":"https://api.github.com/users/sjblim/events{/privacy}","received_events_url":"https://api.github.com/users/sjblim/received_events","type":"User","site_admin":false}},{"id":2996515785,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mjk5NjUxNTc4NQ==","url":"https://api.github.com/repos/google-research/google-research/issues/events/2996515785","actor":{"login":"hihihihiwsf","id":33193751,"node_id":"MDQ6VXNlcjMzMTkzNzUx","avatar_url":"https://avatars.githubusercontent.com/u/33193751?v=4","gravatar_id":"","url":"https://api.github.com/users/hihihihiwsf","html_url":"https://github.com/hihihihiwsf","followers_url":"https://api.github.com/users/hihihihiwsf/followers","following_url":"https://api.github.com/users/hihihihiwsf/following{/other_user}","gists_url":"https://api.github.com/users/hihihihiwsf/gists{/gist_id}","starred_url":"https://api.github.com/users/hihihihiwsf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hihihihiwsf/subscriptions","organizations_url":"https://api.github.com/users/hihihihiwsf/orgs","repos_url":"https://api.github.com/users/hihihihiwsf/repos","events_url":"https://api.github.com/users/hihihihiwsf/events{/privacy}","received_events_url":"https://api.github.com/users/hihihihiwsf/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-01-31T10:08:57Z","performed_via_github_app":null},{"id":2996515790,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI5OTY1MTU3OTA=","url":"https://api.github.com/repos/google-research/google-research/issues/events/2996515790","actor":{"login":"hihihihiwsf","id":33193751,"node_id":"MDQ6VXNlcjMzMTkzNzUx","avatar_url":"https://avatars.githubusercontent.com/u/33193751?v=4","gravatar_id":"","url":"https://api.github.com/users/hihihihiwsf","html_url":"https://github.com/hihihihiwsf","followers_url":"https://api.github.com/users/hihihihiwsf/followers","following_url":"https://api.github.com/users/hihihihiwsf/following{/other_user}","gists_url":"https://api.github.com/users/hihihihiwsf/gists{/gist_id}","starred_url":"https://api.github.com/users/hihihihiwsf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hihihihiwsf/subscriptions","organizations_url":"https://api.github.com/users/hihihihiwsf/orgs","repos_url":"https://api.github.com/users/hihihihiwsf/repos","events_url":"https://api.github.com/users/hihihihiwsf/events{/privacy}","received_events_url":"https://api.github.com/users/hihihihiwsf/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-01-31T10:08:57Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/580775070","html_url":"https://github.com/google-research/google-research/issues/183#issuecomment-580775070","issue_url":"https://api.github.com/repos/google-research/google-research/issues/183","id":580775070,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDc3NTA3MA==","user":{"login":"cometta","id":187495,"node_id":"MDQ6VXNlcjE4NzQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/187495?v=4","gravatar_id":"","url":"https://api.github.com/users/cometta","html_url":"https://github.com/cometta","followers_url":"https://api.github.com/users/cometta/followers","following_url":"https://api.github.com/users/cometta/following{/other_user}","gists_url":"https://api.github.com/users/cometta/gists{/gist_id}","starred_url":"https://api.github.com/users/cometta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cometta/subscriptions","organizations_url":"https://api.github.com/users/cometta/orgs","repos_url":"https://api.github.com/users/cometta/repos","events_url":"https://api.github.com/users/cometta/events{/privacy}","received_events_url":"https://api.github.com/users/cometta/received_events","type":"User","site_admin":false},"created_at":"2020-01-31T15:17:53Z","updated_at":"2020-01-31T15:17:53Z","author_association":"NONE","body":"may i know when use this model to train on other dataset and we do not know the \r\n future_inputs because it not yet happen . Is it possible to train using this model? Any example?","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/580775070/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cometta","id":187495,"node_id":"MDQ6VXNlcjE4NzQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/187495?v=4","gravatar_id":"","url":"https://api.github.com/users/cometta","html_url":"https://github.com/cometta","followers_url":"https://api.github.com/users/cometta/followers","following_url":"https://api.github.com/users/cometta/following{/other_user}","gists_url":"https://api.github.com/users/cometta/gists{/gist_id}","starred_url":"https://api.github.com/users/cometta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cometta/subscriptions","organizations_url":"https://api.github.com/users/cometta/orgs","repos_url":"https://api.github.com/users/cometta/repos","events_url":"https://api.github.com/users/cometta/events{/privacy}","received_events_url":"https://api.github.com/users/cometta/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/580812028","html_url":"https://github.com/google-research/google-research/issues/183#issuecomment-580812028","issue_url":"https://api.github.com/repos/google-research/google-research/issues/183","id":580812028,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDgxMjAyOA==","user":{"login":"sjblim","id":3411074,"node_id":"MDQ6VXNlcjM0MTEwNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3411074?v=4","gravatar_id":"","url":"https://api.github.com/users/sjblim","html_url":"https://github.com/sjblim","followers_url":"https://api.github.com/users/sjblim/followers","following_url":"https://api.github.com/users/sjblim/following{/other_user}","gists_url":"https://api.github.com/users/sjblim/gists{/gist_id}","starred_url":"https://api.github.com/users/sjblim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sjblim/subscriptions","organizations_url":"https://api.github.com/users/sjblim/orgs","repos_url":"https://api.github.com/users/sjblim/repos","events_url":"https://api.github.com/users/sjblim/events{/privacy}","received_events_url":"https://api.github.com/users/sjblim/received_events","type":"User","site_admin":false},"created_at":"2020-01-31T16:43:37Z","updated_at":"2020-01-31T16:43:37Z","author_association":"NONE","body":"@cometta -- unfortunately the current implementation uses LSTM cells which require at least a single input at each time point. However, as a workaround, would feeding in a dummy input of all zeros do the trick?","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/580812028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sjblim","id":3411074,"node_id":"MDQ6VXNlcjM0MTEwNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3411074?v=4","gravatar_id":"","url":"https://api.github.com/users/sjblim","html_url":"https://github.com/sjblim","followers_url":"https://api.github.com/users/sjblim/followers","following_url":"https://api.github.com/users/sjblim/following{/other_user}","gists_url":"https://api.github.com/users/sjblim/gists{/gist_id}","starred_url":"https://api.github.com/users/sjblim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sjblim/subscriptions","organizations_url":"https://api.github.com/users/sjblim/orgs","repos_url":"https://api.github.com/users/sjblim/repos","events_url":"https://api.github.com/users/sjblim/events{/privacy}","received_events_url":"https://api.github.com/users/sjblim/received_events","type":"User","site_admin":false}},{"id":2997750293,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mjk5Nzc1MDI5Mw==","url":"https://api.github.com/repos/google-research/google-research/issues/events/2997750293","actor":{"login":"cometta","id":187495,"node_id":"MDQ6VXNlcjE4NzQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/187495?v=4","gravatar_id":"","url":"https://api.github.com/users/cometta","html_url":"https://github.com/cometta","followers_url":"https://api.github.com/users/cometta/followers","following_url":"https://api.github.com/users/cometta/following{/other_user}","gists_url":"https://api.github.com/users/cometta/gists{/gist_id}","starred_url":"https://api.github.com/users/cometta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cometta/subscriptions","organizations_url":"https://api.github.com/users/cometta/orgs","repos_url":"https://api.github.com/users/cometta/repos","events_url":"https://api.github.com/users/cometta/events{/privacy}","received_events_url":"https://api.github.com/users/cometta/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-01-31T16:43:37Z","performed_via_github_app":null},{"id":2997750294,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI5OTc3NTAyOTQ=","url":"https://api.github.com/repos/google-research/google-research/issues/events/2997750294","actor":{"login":"cometta","id":187495,"node_id":"MDQ6VXNlcjE4NzQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/187495?v=4","gravatar_id":"","url":"https://api.github.com/users/cometta","html_url":"https://github.com/cometta","followers_url":"https://api.github.com/users/cometta/followers","following_url":"https://api.github.com/users/cometta/following{/other_user}","gists_url":"https://api.github.com/users/cometta/gists{/gist_id}","starred_url":"https://api.github.com/users/cometta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cometta/subscriptions","organizations_url":"https://api.github.com/users/cometta/orgs","repos_url":"https://api.github.com/users/cometta/repos","events_url":"https://api.github.com/users/cometta/events{/privacy}","received_events_url":"https://api.github.com/users/cometta/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-01-31T16:43:37Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/580986529","html_url":"https://github.com/google-research/google-research/issues/183#issuecomment-580986529","issue_url":"https://api.github.com/repos/google-research/google-research/issues/183","id":580986529,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDk4NjUyOQ==","user":{"login":"cometta","id":187495,"node_id":"MDQ6VXNlcjE4NzQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/187495?v=4","gravatar_id":"","url":"https://api.github.com/users/cometta","html_url":"https://github.com/cometta","followers_url":"https://api.github.com/users/cometta/followers","following_url":"https://api.github.com/users/cometta/following{/other_user}","gists_url":"https://api.github.com/users/cometta/gists{/gist_id}","starred_url":"https://api.github.com/users/cometta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cometta/subscriptions","organizations_url":"https://api.github.com/users/cometta/orgs","repos_url":"https://api.github.com/users/cometta/repos","events_url":"https://api.github.com/users/cometta/events{/privacy}","received_events_url":"https://api.github.com/users/cometta/received_events","type":"User","site_admin":false},"created_at":"2020-02-01T03:28:40Z","updated_at":"2020-02-01T03:28:40Z","author_association":"NONE","body":"I tried both way and get different loss value\r\n\r\nfirst way :\r\n    inputs[:, self.num_encoder_steps:, :] = 0\r\n\r\nsecond way:\r\n    future_inputs =tf.random_normal([1,5, 5, 5])\r\n\r\nThe loss should be the same right?","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/580986529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cometta","id":187495,"node_id":"MDQ6VXNlcjE4NzQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/187495?v=4","gravatar_id":"","url":"https://api.github.com/users/cometta","html_url":"https://github.com/cometta","followers_url":"https://api.github.com/users/cometta/followers","following_url":"https://api.github.com/users/cometta/following{/other_user}","gists_url":"https://api.github.com/users/cometta/gists{/gist_id}","starred_url":"https://api.github.com/users/cometta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cometta/subscriptions","organizations_url":"https://api.github.com/users/cometta/orgs","repos_url":"https://api.github.com/users/cometta/repos","events_url":"https://api.github.com/users/cometta/events{/privacy}","received_events_url":"https://api.github.com/users/cometta/received_events","type":"User","site_admin":false}},{"id":2999390191,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mjk5OTM5MDE5MQ==","url":"https://api.github.com/repos/google-research/google-research/issues/events/2999390191","actor":{"login":"cometta","id":187495,"node_id":"MDQ6VXNlcjE4NzQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/187495?v=4","gravatar_id":"","url":"https://api.github.com/users/cometta","html_url":"https://github.com/cometta","followers_url":"https://api.github.com/users/cometta/followers","following_url":"https://api.github.com/users/cometta/following{/other_user}","gists_url":"https://api.github.com/users/cometta/gists{/gist_id}","starred_url":"https://api.github.com/users/cometta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cometta/subscriptions","organizations_url":"https://api.github.com/users/cometta/orgs","repos_url":"https://api.github.com/users/cometta/repos","events_url":"https://api.github.com/users/cometta/events{/privacy}","received_events_url":"https://api.github.com/users/cometta/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-02-01T14:46:44Z","performed_via_github_app":null},{"id":2999390192,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI5OTkzOTAxOTI=","url":"https://api.github.com/repos/google-research/google-research/issues/events/2999390192","actor":{"login":"cometta","id":187495,"node_id":"MDQ6VXNlcjE4NzQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/187495?v=4","gravatar_id":"","url":"https://api.github.com/users/cometta","html_url":"https://github.com/cometta","followers_url":"https://api.github.com/users/cometta/followers","following_url":"https://api.github.com/users/cometta/following{/other_user}","gists_url":"https://api.github.com/users/cometta/gists{/gist_id}","starred_url":"https://api.github.com/users/cometta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cometta/subscriptions","organizations_url":"https://api.github.com/users/cometta/orgs","repos_url":"https://api.github.com/users/cometta/repos","events_url":"https://api.github.com/users/cometta/events{/privacy}","received_events_url":"https://api.github.com/users/cometta/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-02-01T14:46:44Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/581098512","html_url":"https://github.com/google-research/google-research/issues/183#issuecomment-581098512","issue_url":"https://api.github.com/repos/google-research/google-research/issues/183","id":581098512,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTA5ODUxMg==","user":{"login":"cometta","id":187495,"node_id":"MDQ6VXNlcjE4NzQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/187495?v=4","gravatar_id":"","url":"https://api.github.com/users/cometta","html_url":"https://github.com/cometta","followers_url":"https://api.github.com/users/cometta/followers","following_url":"https://api.github.com/users/cometta/following{/other_user}","gists_url":"https://api.github.com/users/cometta/gists{/gist_id}","starred_url":"https://api.github.com/users/cometta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cometta/subscriptions","organizations_url":"https://api.github.com/users/cometta/orgs","repos_url":"https://api.github.com/users/cometta/repos","events_url":"https://api.github.com/users/cometta/events{/privacy}","received_events_url":"https://api.github.com/users/cometta/received_events","type":"User","site_admin":false},"created_at":"2020-02-02T04:53:46Z","updated_at":"2020-02-02T04:53:46Z","author_association":"NONE","body":"@sjblim can you please help to share more info about 'feeding in a dummy input of all zero' as I would like to try out not feeding future input with existing dataset?","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/581098512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cometta","id":187495,"node_id":"MDQ6VXNlcjE4NzQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/187495?v=4","gravatar_id":"","url":"https://api.github.com/users/cometta","html_url":"https://github.com/cometta","followers_url":"https://api.github.com/users/cometta/followers","following_url":"https://api.github.com/users/cometta/following{/other_user}","gists_url":"https://api.github.com/users/cometta/gists{/gist_id}","starred_url":"https://api.github.com/users/cometta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cometta/subscriptions","organizations_url":"https://api.github.com/users/cometta/orgs","repos_url":"https://api.github.com/users/cometta/repos","events_url":"https://api.github.com/users/cometta/events{/privacy}","received_events_url":"https://api.github.com/users/cometta/received_events","type":"User","site_admin":false}},{"id":2999788062,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mjk5OTc4ODA2Mg==","url":"https://api.github.com/repos/google-research/google-research/issues/events/2999788062","actor":{"login":"sjblim","id":3411074,"node_id":"MDQ6VXNlcjM0MTEwNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3411074?v=4","gravatar_id":"","url":"https://api.github.com/users/sjblim","html_url":"https://github.com/sjblim","followers_url":"https://api.github.com/users/sjblim/followers","following_url":"https://api.github.com/users/sjblim/following{/other_user}","gists_url":"https://api.github.com/users/sjblim/gists{/gist_id}","starred_url":"https://api.github.com/users/sjblim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sjblim/subscriptions","organizations_url":"https://api.github.com/users/sjblim/orgs","repos_url":"https://api.github.com/users/sjblim/repos","events_url":"https://api.github.com/users/sjblim/events{/privacy}","received_events_url":"https://api.github.com/users/sjblim/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-02-02T04:53:46Z","performed_via_github_app":null},{"id":2999788063,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI5OTk3ODgwNjM=","url":"https://api.github.com/repos/google-research/google-research/issues/events/2999788063","actor":{"login":"sjblim","id":3411074,"node_id":"MDQ6VXNlcjM0MTEwNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3411074?v=4","gravatar_id":"","url":"https://api.github.com/users/sjblim","html_url":"https://github.com/sjblim","followers_url":"https://api.github.com/users/sjblim/followers","following_url":"https://api.github.com/users/sjblim/following{/other_user}","gists_url":"https://api.github.com/users/sjblim/gists{/gist_id}","starred_url":"https://api.github.com/users/sjblim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sjblim/subscriptions","organizations_url":"https://api.github.com/users/sjblim/orgs","repos_url":"https://api.github.com/users/sjblim/repos","events_url":"https://api.github.com/users/sjblim/events{/privacy}","received_events_url":"https://api.github.com/users/sjblim/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-02-02T04:53:46Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/647422033","html_url":"https://github.com/google-research/google-research/issues/183#issuecomment-647422033","issue_url":"https://api.github.com/repos/google-research/google-research/issues/183","id":647422033,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NzQyMjAzMw==","user":{"login":"CalogeroZarbo","id":4557464,"node_id":"MDQ6VXNlcjQ1NTc0NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/4557464?v=4","gravatar_id":"","url":"https://api.github.com/users/CalogeroZarbo","html_url":"https://github.com/CalogeroZarbo","followers_url":"https://api.github.com/users/CalogeroZarbo/followers","following_url":"https://api.github.com/users/CalogeroZarbo/following{/other_user}","gists_url":"https://api.github.com/users/CalogeroZarbo/gists{/gist_id}","starred_url":"https://api.github.com/users/CalogeroZarbo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CalogeroZarbo/subscriptions","organizations_url":"https://api.github.com/users/CalogeroZarbo/orgs","repos_url":"https://api.github.com/users/CalogeroZarbo/repos","events_url":"https://api.github.com/users/CalogeroZarbo/events{/privacy}","received_events_url":"https://api.github.com/users/CalogeroZarbo/received_events","type":"User","site_admin":false},"created_at":"2020-06-22T10:11:34Z","updated_at":"2020-06-22T10:11:34Z","author_association":"NONE","body":"Hi @cometta, I extensively worked on the TFT code recently, and I tested all sorts of biases that came up in my mind. In my experiment I have a history of 1 sample that predicts the next 4 time steps in the future, having in total 5 timesteps. To see whether or not it used information from the future I obscured in prediction the 4future time steps feeding vector with all 0s. I had the same results as the normal evaluation code. Amazing.\r\n\r\nYou have to do this in the function _batch_data() of the tft_model.py. There the model is gathering the samples from the dataset grouping them by the ID and ordering them by the TIME column. At some point, it calls the function to _batch_single_entity(), if that particular time series has enough time point it will return them otherwise will return None.\r\nIf you substitute the in the output vector from _batch_single_entity() function the original values with all 0 from the Encoder Step index till the end, you are feeding 0s to the model for the future. \r\nRemember to do this only in Evaluation / Prediction otherwise, you will obscuring also training batches since that function is called many times. \r\n\r\nLet me know if you need further details.\r\n\r\nThank you @sjblim for the amazing work.\r\n\r\nCheers,\r\nCal","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/647422033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"CalogeroZarbo","id":4557464,"node_id":"MDQ6VXNlcjQ1NTc0NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/4557464?v=4","gravatar_id":"","url":"https://api.github.com/users/CalogeroZarbo","html_url":"https://github.com/CalogeroZarbo","followers_url":"https://api.github.com/users/CalogeroZarbo/followers","following_url":"https://api.github.com/users/CalogeroZarbo/following{/other_user}","gists_url":"https://api.github.com/users/CalogeroZarbo/gists{/gist_id}","starred_url":"https://api.github.com/users/CalogeroZarbo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CalogeroZarbo/subscriptions","organizations_url":"https://api.github.com/users/CalogeroZarbo/orgs","repos_url":"https://api.github.com/users/CalogeroZarbo/repos","events_url":"https://api.github.com/users/CalogeroZarbo/events{/privacy}","received_events_url":"https://api.github.com/users/CalogeroZarbo/received_events","type":"User","site_admin":false}},{"id":3467614451,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzQ2NzYxNDQ1MQ==","url":"https://api.github.com/repos/google-research/google-research/issues/events/3467614451","actor":{"login":"cometta","id":187495,"node_id":"MDQ6VXNlcjE4NzQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/187495?v=4","gravatar_id":"","url":"https://api.github.com/users/cometta","html_url":"https://github.com/cometta","followers_url":"https://api.github.com/users/cometta/followers","following_url":"https://api.github.com/users/cometta/following{/other_user}","gists_url":"https://api.github.com/users/cometta/gists{/gist_id}","starred_url":"https://api.github.com/users/cometta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cometta/subscriptions","organizations_url":"https://api.github.com/users/cometta/orgs","repos_url":"https://api.github.com/users/cometta/repos","events_url":"https://api.github.com/users/cometta/events{/privacy}","received_events_url":"https://api.github.com/users/cometta/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-06-22T10:11:35Z","performed_via_github_app":null},{"id":3467614454,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM0Njc2MTQ0NTQ=","url":"https://api.github.com/repos/google-research/google-research/issues/events/3467614454","actor":{"login":"cometta","id":187495,"node_id":"MDQ6VXNlcjE4NzQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/187495?v=4","gravatar_id":"","url":"https://api.github.com/users/cometta","html_url":"https://github.com/cometta","followers_url":"https://api.github.com/users/cometta/followers","following_url":"https://api.github.com/users/cometta/following{/other_user}","gists_url":"https://api.github.com/users/cometta/gists{/gist_id}","starred_url":"https://api.github.com/users/cometta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cometta/subscriptions","organizations_url":"https://api.github.com/users/cometta/orgs","repos_url":"https://api.github.com/users/cometta/repos","events_url":"https://api.github.com/users/cometta/events{/privacy}","received_events_url":"https://api.github.com/users/cometta/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-06-22T10:11:35Z","performed_via_github_app":null},{"id":3467614458,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzQ2NzYxNDQ1OA==","url":"https://api.github.com/repos/google-research/google-research/issues/events/3467614458","actor":{"login":"sjblim","id":3411074,"node_id":"MDQ6VXNlcjM0MTEwNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3411074?v=4","gravatar_id":"","url":"https://api.github.com/users/sjblim","html_url":"https://github.com/sjblim","followers_url":"https://api.github.com/users/sjblim/followers","following_url":"https://api.github.com/users/sjblim/following{/other_user}","gists_url":"https://api.github.com/users/sjblim/gists{/gist_id}","starred_url":"https://api.github.com/users/sjblim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sjblim/subscriptions","organizations_url":"https://api.github.com/users/sjblim/orgs","repos_url":"https://api.github.com/users/sjblim/repos","events_url":"https://api.github.com/users/sjblim/events{/privacy}","received_events_url":"https://api.github.com/users/sjblim/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-06-22T10:11:35Z","performed_via_github_app":null},{"id":3467614462,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM0Njc2MTQ0NjI=","url":"https://api.github.com/repos/google-research/google-research/issues/events/3467614462","actor":{"login":"sjblim","id":3411074,"node_id":"MDQ6VXNlcjM0MTEwNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3411074?v=4","gravatar_id":"","url":"https://api.github.com/users/sjblim","html_url":"https://github.com/sjblim","followers_url":"https://api.github.com/users/sjblim/followers","following_url":"https://api.github.com/users/sjblim/following{/other_user}","gists_url":"https://api.github.com/users/sjblim/gists{/gist_id}","starred_url":"https://api.github.com/users/sjblim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sjblim/subscriptions","organizations_url":"https://api.github.com/users/sjblim/orgs","repos_url":"https://api.github.com/users/sjblim/repos","events_url":"https://api.github.com/users/sjblim/events{/privacy}","received_events_url":"https://api.github.com/users/sjblim/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-06-22T10:11:35Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/650566589","html_url":"https://github.com/google-research/google-research/issues/183#issuecomment-650566589","issue_url":"https://api.github.com/repos/google-research/google-research/issues/183","id":650566589,"node_id":"MDEyOklzc3VlQ29tbWVudDY1MDU2NjU4OQ==","user":{"login":"josesydor","id":53540944,"node_id":"MDQ6VXNlcjUzNTQwOTQ0","avatar_url":"https://avatars.githubusercontent.com/u/53540944?v=4","gravatar_id":"","url":"https://api.github.com/users/josesydor","html_url":"https://github.com/josesydor","followers_url":"https://api.github.com/users/josesydor/followers","following_url":"https://api.github.com/users/josesydor/following{/other_user}","gists_url":"https://api.github.com/users/josesydor/gists{/gist_id}","starred_url":"https://api.github.com/users/josesydor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/josesydor/subscriptions","organizations_url":"https://api.github.com/users/josesydor/orgs","repos_url":"https://api.github.com/users/josesydor/repos","events_url":"https://api.github.com/users/josesydor/events{/privacy}","received_events_url":"https://api.github.com/users/josesydor/received_events","type":"User","site_admin":false},"created_at":"2020-06-27T14:16:53Z","updated_at":"2020-06-27T14:16:53Z","author_association":"NONE","body":"Hi @CalogeroZarbo , I too share a great interest in this model and I can corroborate your findings. I've been using it to forecast multivariate timeseries 5 time-steps in the future using 252 time-steps into the past as look-back (this is the _num_encoder_steps_) , much like their volatility dataset example and I got stuck into how to actually use it in production with out-of-sample data to forecast into the future. Bryan helped me on this regard. He said \"_The TFT does filter out any observed inputs and targets in the forecast horizon by default, so you can debug by ensuring that any value used does not modify the predictions._\" and what I did to verify this was to have a date on my test dataset set as the \"present day\" and, per identifier, have \"present day\" - _num_encoder_steps_ (252 in my case) as the past and \"present day\" + 5 as my \"future\" horizon. Note that it has to be done **per identifier.**\r\nNext, I've set to ZERO all my observed inputs and the targets where datetime > \"present day\" (i.e.) info that we couldn't have known in advance. Note that known and static inputs were kept unchanged.\r\n\r\nThe TFT outuput (model.predict(test, return_targets=True)) when compared with the one produced with the unchanged test dataset was pretty much the same! That confirms what he and you said.\r\n\r\nWhat still bothers me is the fact that the TFT predict() absolutely needs the total_time_steps (num_encoder_steps + horizon).  That doesn't make much sense to me since one are interested in predicting only the horizon, why would one wants to predict data that is in the past?!? But I guess the LSTMs are inherently built this way... I've found some solace when I took a closer look into the function that computes the normalised quantile loss, called numpy_normalised_quantile_loss(). I've noticed that the quantile_loss is roughly the same for all the time-steps (t+0, t+1... t+n). Additionally, I've checked the quantile loss per row and it kept roughly the same along the results. Amazing! My intuition was that as the days go by, the loss would be greater, but it doesn't seem to be the case and I can't say why... \r\n\r\nHope that helps.","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/650566589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"josesydor","id":53540944,"node_id":"MDQ6VXNlcjUzNTQwOTQ0","avatar_url":"https://avatars.githubusercontent.com/u/53540944?v=4","gravatar_id":"","url":"https://api.github.com/users/josesydor","html_url":"https://github.com/josesydor","followers_url":"https://api.github.com/users/josesydor/followers","following_url":"https://api.github.com/users/josesydor/following{/other_user}","gists_url":"https://api.github.com/users/josesydor/gists{/gist_id}","starred_url":"https://api.github.com/users/josesydor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/josesydor/subscriptions","organizations_url":"https://api.github.com/users/josesydor/orgs","repos_url":"https://api.github.com/users/josesydor/repos","events_url":"https://api.github.com/users/josesydor/events{/privacy}","received_events_url":"https://api.github.com/users/josesydor/received_events","type":"User","site_admin":false}},{"id":3489011338,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzQ4OTAxMTMzOA==","url":"https://api.github.com/repos/google-research/google-research/issues/events/3489011338","actor":{"login":"CalogeroZarbo","id":4557464,"node_id":"MDQ6VXNlcjQ1NTc0NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/4557464?v=4","gravatar_id":"","url":"https://api.github.com/users/CalogeroZarbo","html_url":"https://github.com/CalogeroZarbo","followers_url":"https://api.github.com/users/CalogeroZarbo/followers","following_url":"https://api.github.com/users/CalogeroZarbo/following{/other_user}","gists_url":"https://api.github.com/users/CalogeroZarbo/gists{/gist_id}","starred_url":"https://api.github.com/users/CalogeroZarbo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CalogeroZarbo/subscriptions","organizations_url":"https://api.github.com/users/CalogeroZarbo/orgs","repos_url":"https://api.github.com/users/CalogeroZarbo/repos","events_url":"https://api.github.com/users/CalogeroZarbo/events{/privacy}","received_events_url":"https://api.github.com/users/CalogeroZarbo/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-06-27T14:16:53Z","performed_via_github_app":null},{"id":3489011339,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM0ODkwMTEzMzk=","url":"https://api.github.com/repos/google-research/google-research/issues/events/3489011339","actor":{"login":"CalogeroZarbo","id":4557464,"node_id":"MDQ6VXNlcjQ1NTc0NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/4557464?v=4","gravatar_id":"","url":"https://api.github.com/users/CalogeroZarbo","html_url":"https://github.com/CalogeroZarbo","followers_url":"https://api.github.com/users/CalogeroZarbo/followers","following_url":"https://api.github.com/users/CalogeroZarbo/following{/other_user}","gists_url":"https://api.github.com/users/CalogeroZarbo/gists{/gist_id}","starred_url":"https://api.github.com/users/CalogeroZarbo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CalogeroZarbo/subscriptions","organizations_url":"https://api.github.com/users/CalogeroZarbo/orgs","repos_url":"https://api.github.com/users/CalogeroZarbo/repos","events_url":"https://api.github.com/users/CalogeroZarbo/events{/privacy}","received_events_url":"https://api.github.com/users/CalogeroZarbo/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-06-27T14:16:53Z","performed_via_github_app":null}]