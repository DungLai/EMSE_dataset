[{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/992892720","html_url":"https://github.com/google-research/google-research/issues/914#issuecomment-992892720","issue_url":"https://api.github.com/repos/google-research/google-research/issues/914","id":992892720,"node_id":"IC_kwDOCQmIhc47Llcw","user":{"login":"TimHunt12","id":2401628,"node_id":"MDQ6VXNlcjI0MDE2Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/2401628?v=4","gravatar_id":"","url":"https://api.github.com/users/TimHunt12","html_url":"https://github.com/TimHunt12","followers_url":"https://api.github.com/users/TimHunt12/followers","following_url":"https://api.github.com/users/TimHunt12/following{/other_user}","gists_url":"https://api.github.com/users/TimHunt12/gists{/gist_id}","starred_url":"https://api.github.com/users/TimHunt12/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TimHunt12/subscriptions","organizations_url":"https://api.github.com/users/TimHunt12/orgs","repos_url":"https://api.github.com/users/TimHunt12/repos","events_url":"https://api.github.com/users/TimHunt12/events{/privacy}","received_events_url":"https://api.github.com/users/TimHunt12/received_events","type":"User","site_admin":false},"created_at":"2021-12-13T20:48:11Z","updated_at":"2021-12-13T20:48:11Z","author_association":"NONE","body":"@junjiek \r\nI understand if you can't share the script that you used to train the model.  I have been studying the paper and the code and feel I can perhaps now come up with a script to do training.  However, I have a question. I suspect that to train the model I would need to provide the images and our MOS scores.  However, I am not sure what format they need to be in. Do the images need to be .jpg?  How about the MOS scores.  What is the best way to provide the model the MOS score for each image?  If you can help I would appreciate it as I would like to see if I can make this model focus on a specific kind of image and use the existing models as a transformer to focus the MOS scores for these images.    Thanks.","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/992892720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"TimHunt12","id":2401628,"node_id":"MDQ6VXNlcjI0MDE2Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/2401628?v=4","gravatar_id":"","url":"https://api.github.com/users/TimHunt12","html_url":"https://github.com/TimHunt12","followers_url":"https://api.github.com/users/TimHunt12/followers","following_url":"https://api.github.com/users/TimHunt12/following{/other_user}","gists_url":"https://api.github.com/users/TimHunt12/gists{/gist_id}","starred_url":"https://api.github.com/users/TimHunt12/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TimHunt12/subscriptions","organizations_url":"https://api.github.com/users/TimHunt12/orgs","repos_url":"https://api.github.com/users/TimHunt12/repos","events_url":"https://api.github.com/users/TimHunt12/events{/privacy}","received_events_url":"https://api.github.com/users/TimHunt12/received_events","type":"User","site_admin":false}},{"id":5759708608,"node_id":"MEE_lADOCQmIhc5AM3jCzwAAAAFXTi3A","url":"https://api.github.com/repos/google-research/google-research/issues/events/5759708608","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-12-13T20:48:11Z","performed_via_github_app":null},{"id":5759708616,"node_id":"SE_lADOCQmIhc5AM3jCzwAAAAFXTi3I","url":"https://api.github.com/repos/google-research/google-research/issues/events/5759708616","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-12-13T20:48:11Z","performed_via_github_app":null},{"id":5759714013,"node_id":"MEE_lADOCQmIhc5AM3jCzwAAAAFXTkLd","url":"https://api.github.com/repos/google-research/google-research/issues/events/5759714013","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-12-13T20:48:57Z","performed_via_github_app":null},{"id":5759714019,"node_id":"SE_lADOCQmIhc5AM3jCzwAAAAFXTkLj","url":"https://api.github.com/repos/google-research/google-research/issues/events/5759714019","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-12-13T20:48:57Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/992930108","html_url":"https://github.com/google-research/google-research/issues/914#issuecomment-992930108","issue_url":"https://api.github.com/repos/google-research/google-research/issues/914","id":992930108,"node_id":"IC_kwDOCQmIhc47Luk8","user":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"created_at":"2021-12-13T21:32:48Z","updated_at":"2021-12-13T21:32:48Z","author_association":"CONTRIBUTOR","body":"Hi Tim,\n\nThanks a lot for your interest in the paper and code. At this point we\ndon't have plans to open source the training code yet.\n\nFor training the model, the image format can be anything. In our code we\nuse tf.image.decode_jpeg() by default. The MOS is a single value for each\nimage. For AVA, the label for each image is a score distribution.  In\ntraining, we just feed the (image, MOS) pair to the model.\n\nHope it helps,\nJunjie\n\nOn Mon, Dec 13, 2021 at 12:48 PM Tim Hunt ***@***.***> wrote:\n\n> @junjiek <https://github.com/junjiek>\n> I understand if you can't share the script that you used to train the\n> model. I have been studying the paper and the code and feel I can perhaps\n> now come up with a script to do training. However, I have a question. I\n> suspect that to train the model I would need to provide the images and our\n> MOS scores. However, I am not sure what format they need to be in. Do the\n> images need to be .jpg? How about the MOS scores. What is the best way to\n> provide the model the MOS score for each image? If you can help I would\n> appreciate it as I would like to see if I can make this model focus on a\n> specific kind of image and use the existing models as a transformer to\n> focus the MOS scores for these images. Thanks.\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/google-research/google-research/issues/914#issuecomment-992892720>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ACHYBJ36KOV7RKCAITAH5FTUQZLZNANCNFSM5JZX34SQ>\n> .\n> Triage notifications on the go with GitHub Mobile for iOS\n> <https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>\n> or Android\n> <https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>.\n>\n>\n","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/992930108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false}},{"id":5759948104,"node_id":"MEE_lADOCQmIhc5AM3jCzwAAAAFXUdVI","url":"https://api.github.com/repos/google-research/google-research/issues/events/5759948104","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-12-13T21:32:48Z","performed_via_github_app":null},{"id":5759948111,"node_id":"SE_lADOCQmIhc5AM3jCzwAAAAFXUdVP","url":"https://api.github.com/repos/google-research/google-research/issues/events/5759948111","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-12-13T21:32:48Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/994192977","html_url":"https://github.com/google-research/google-research/issues/914#issuecomment-994192977","issue_url":"https://api.github.com/repos/google-research/google-research/issues/914","id":994192977,"node_id":"IC_kwDOCQmIhc47Qi5R","user":{"login":"TimHunt12","id":2401628,"node_id":"MDQ6VXNlcjI0MDE2Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/2401628?v=4","gravatar_id":"","url":"https://api.github.com/users/TimHunt12","html_url":"https://github.com/TimHunt12","followers_url":"https://api.github.com/users/TimHunt12/followers","following_url":"https://api.github.com/users/TimHunt12/following{/other_user}","gists_url":"https://api.github.com/users/TimHunt12/gists{/gist_id}","starred_url":"https://api.github.com/users/TimHunt12/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TimHunt12/subscriptions","organizations_url":"https://api.github.com/users/TimHunt12/orgs","repos_url":"https://api.github.com/users/TimHunt12/repos","events_url":"https://api.github.com/users/TimHunt12/events{/privacy}","received_events_url":"https://api.github.com/users/TimHunt12/received_events","type":"User","site_admin":false},"created_at":"2021-12-15T01:08:29Z","updated_at":"2021-12-15T01:08:29Z","author_association":"NONE","body":"@junjiek  \r\nXie Xie Junjie,\r\n\r\nI appreciate you getting back to me.  \r\n\r\nI saw the use of tf.image.decode_jpeg() in the preprocessor.py and I think I can change it to tf.image.decode_image to handle .png and .bmp along with .jpg or jpeg.  That will save me from prepping images to be in a specific format. Provided that the encoding of those files don't require additional handling of the features in preprocessing.  I haven't tested that yet so I will have to see if I can do that.\r\n\r\nI also have another question.  Is there a reason in the preprocessor.py file under the get_hashed_spactial_pos_emb_index function your team repeated this line of code `pos_emb_hash_h = tf.cast(pos_emb_hash_h, dtype=tf.int32)`. I'm not sure I understand the benefit of running the same code here twice.\r\n\r\nYou mentioned above that you just sent in the (image, MOS) pair to the model for training.  I assume the image was the \"image path\" to an image based on how the code processes it and the MOS or (mean opinion score) was just a float value between 1 and 5.  To feed in a whole batch of images did you just feed in an array of image path/names and MOS scores in a list of tuples or did you feed each in as an array and zip them together or did you prepare a dictionary file of them to feed to the application?  Sorry rather long question.\r\n\r\nActually I am not even sure my question above is the right one.  How the data is fed into the model is more determined by how I prepare it to train.  I can see points in the code where possibly training type code was potentially removed.  Since you aren't going to release that code I will have to figure out if I can come up with it on my own training code based on the paper and the code you have released.\r\n\r\nI have learned so much studying your team's code.  I love your use of Jax to speed up GPU processing of images and I didn't even know until now that Tensorflow had a tf.image.extract_patches() function.  That must the advantage of working with Google.  You either learn quickly about the advances the Google Research team does in expanding Tensorflow or you are able to suggest and maybe help them build them.  Either way it is very nice work.\r\n\r\nPlease again accept my appreciation for your team's great skill in building such a clean simple model.  It is very impressive.  I may not be able to come up with a way to leverage it and extend it into other fields of use and may have to use another model to meet my short term needs but nice work and I am enjoying studying your code.\r\n\r\nThanks\r\nTim\r\n","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/994192977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"TimHunt12","id":2401628,"node_id":"MDQ6VXNlcjI0MDE2Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/2401628?v=4","gravatar_id":"","url":"https://api.github.com/users/TimHunt12","html_url":"https://github.com/TimHunt12","followers_url":"https://api.github.com/users/TimHunt12/followers","following_url":"https://api.github.com/users/TimHunt12/following{/other_user}","gists_url":"https://api.github.com/users/TimHunt12/gists{/gist_id}","starred_url":"https://api.github.com/users/TimHunt12/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TimHunt12/subscriptions","organizations_url":"https://api.github.com/users/TimHunt12/orgs","repos_url":"https://api.github.com/users/TimHunt12/repos","events_url":"https://api.github.com/users/TimHunt12/events{/privacy}","received_events_url":"https://api.github.com/users/TimHunt12/received_events","type":"User","site_admin":false}},{"id":5768119687,"node_id":"MEE_lADOCQmIhc5AM3jCzwAAAAFXzoWH","url":"https://api.github.com/repos/google-research/google-research/issues/events/5768119687","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-12-15T01:08:29Z","performed_via_github_app":null},{"id":5768119689,"node_id":"SE_lADOCQmIhc5AM3jCzwAAAAFXzoWJ","url":"https://api.github.com/repos/google-research/google-research/issues/events/5768119689","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-12-15T01:08:29Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/995078367","html_url":"https://github.com/google-research/google-research/issues/914#issuecomment-995078367","issue_url":"https://api.github.com/repos/google-research/google-research/issues/914","id":995078367,"node_id":"IC_kwDOCQmIhc47T7Df","user":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"created_at":"2021-12-15T18:49:24Z","updated_at":"2021-12-15T18:49:24Z","author_association":"CONTRIBUTOR","body":"Hi Tim,\n\nThank you for the recognition for the paper and code.\n\n1) pos_emb_hash_h = tf.cast(pos_emb_hash_h, dtype=tf.int32) should just be\ncalled once. I will remove the redundant line. Thanks for pointing it out.\n\n2) We save each (image, MOS) pair as tf records.\nhttps://www.tensorflow.org/tutorials/load_data/tfrecord#reading_a_tfrecord_file.\nMore specifically, we use the API of tensorflow dataset. For example, this\nis the publicly available imagenet dataset :\nhttps://www.tensorflow.org/datasets/catalog/imagenet2012\n\nThanks again for the kind words. Hope the answers are helpful.\n\nBest,\nJunjie\n\n\n\nOn Tue, Dec 14, 2021 at 5:08 PM Tim Hunt ***@***.***> wrote:\n\n> @junjiek <https://github.com/junjiek>\n> Xie Xie Junjie,\n>\n> I appreciate you getting back to me.\n>\n> I saw the use of tf.image.decode_jpeg() in the preprocessor.py and I think\n> I can change it to tf.image.decode_image to handle .png and .bmp along with\n> .jpg or jpeg. That will save me from prepping images to be in a specific\n> format. Provided that the encoding of those files don't require additional\n> handling of the features in preprocessing. I haven't tested that yet so I\n> will have to see if I can do that.\n>\n> I also have another question. Is there a reason in the preprocessor.py\n> file under the get_hashed_spactial_pos_emb_index function your team\n> repeated this line of code pos_emb_hash_h = tf.cast(pos_emb_hash_h,\n> dtype=tf.int32). I'm not sure I understand the benefit of running the\n> same code here twice.\n>\n> You mentioned above that you just sent in the (image, MOS) pair to the\n> model for training. I assume the image was the \"image path\" to an image\n> based on how the code processes it and the MOS or (mean opinion score) was\n> just a float value between 1 and 5. To feed in a whole batch of images did\n> you just feed in an array of image path/names and MOS scores in a list of\n> tuples or did you feed each in as an array and zip them together or did you\n> prepare a dictionary file of them to feed to the application? Sorry rather\n> long question.\n>\n> Actually I am not even sure my question above is the right one. How the\n> data is fed into the model is more determined by how I prepare it to train.\n> I can see points in the code where possibly training type code was\n> potentially removed. Since you aren't going to release that code I will\n> have to figure out if I can come up with it on my own training code based\n> on the paper and the code you have released.\n>\n> I have learned so much studying your team's code. I love your use of Jax\n> to speed up GPU processing of images and I didn't even know until now that\n> Tensorflow had a tf.image.extract_patches() function. That must the\n> advantage of working with Google. You either learn quickly about the\n> advances the Google Research team does in expanding Tensorflow or you are\n> able to suggest and maybe help them build them. Either way it is very nice\n> work.\n>\n> Please again accept my appreciation for your team's great skill in\n> building such a clean simple model. It is very impressive. I may not be\n> able to come up with a way to leverage it and extend it into other fields\n> of use and may have to use another model to meet my short term needs but\n> nice work and I am enjoying studying your code.\n>\n> Thanks\n> Tim\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/google-research/google-research/issues/914#issuecomment-994192977>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ACHYBJYIYQA4NE243ZVXL5TUQ7TBRANCNFSM5JZX34SQ>\n> .\n> Triage notifications on the go with GitHub Mobile for iOS\n> <https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>\n> or Android\n> <https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>.\n>\n>\n","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/995078367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false}},{"id":5773430576,"node_id":"MEE_lADOCQmIhc5AM3jCzwAAAAFYH48w","url":"https://api.github.com/repos/google-research/google-research/issues/events/5773430576","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-12-15T18:49:24Z","performed_via_github_app":null},{"id":5773430583,"node_id":"SE_lADOCQmIhc5AM3jCzwAAAAFYH483","url":"https://api.github.com/repos/google-research/google-research/issues/events/5773430583","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-12-15T18:49:24Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/1002195075","html_url":"https://github.com/google-research/google-research/issues/914#issuecomment-1002195075","issue_url":"https://api.github.com/repos/google-research/google-research/issues/914","id":1002195075,"node_id":"IC_kwDOCQmIhc47vEiD","user":{"login":"TimHunt12","id":2401628,"node_id":"MDQ6VXNlcjI0MDE2Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/2401628?v=4","gravatar_id":"","url":"https://api.github.com/users/TimHunt12","html_url":"https://github.com/TimHunt12","followers_url":"https://api.github.com/users/TimHunt12/followers","following_url":"https://api.github.com/users/TimHunt12/following{/other_user}","gists_url":"https://api.github.com/users/TimHunt12/gists{/gist_id}","starred_url":"https://api.github.com/users/TimHunt12/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TimHunt12/subscriptions","organizations_url":"https://api.github.com/users/TimHunt12/orgs","repos_url":"https://api.github.com/users/TimHunt12/repos","events_url":"https://api.github.com/users/TimHunt12/events{/privacy}","received_events_url":"https://api.github.com/users/TimHunt12/received_events","type":"User","site_admin":false},"created_at":"2021-12-28T16:53:03Z","updated_at":"2021-12-28T16:53:03Z","author_association":"NONE","body":"@junjiek \r\n\r\nThank you.  You have been very helpful.  Again I am very impressed with your teams work.  Thanks,\r\n\r\nTim\r\n","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/1002195075/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"TimHunt12","id":2401628,"node_id":"MDQ6VXNlcjI0MDE2Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/2401628?v=4","gravatar_id":"","url":"https://api.github.com/users/TimHunt12","html_url":"https://github.com/TimHunt12","followers_url":"https://api.github.com/users/TimHunt12/followers","following_url":"https://api.github.com/users/TimHunt12/following{/other_user}","gists_url":"https://api.github.com/users/TimHunt12/gists{/gist_id}","starred_url":"https://api.github.com/users/TimHunt12/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TimHunt12/subscriptions","organizations_url":"https://api.github.com/users/TimHunt12/orgs","repos_url":"https://api.github.com/users/TimHunt12/repos","events_url":"https://api.github.com/users/TimHunt12/events{/privacy}","received_events_url":"https://api.github.com/users/TimHunt12/received_events","type":"User","site_admin":false}},{"id":5822031257,"node_id":"MEE_lADOCQmIhc5AM3jCzwAAAAFbBSWZ","url":"https://api.github.com/repos/google-research/google-research/issues/events/5822031257","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-12-28T16:53:03Z","performed_via_github_app":null},{"id":5822031258,"node_id":"SE_lADOCQmIhc5AM3jCzwAAAAFbBSWa","url":"https://api.github.com/repos/google-research/google-research/issues/events/5822031258","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-12-28T16:53:03Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/1154453815","html_url":"https://github.com/google-research/google-research/issues/914#issuecomment-1154453815","issue_url":"https://api.github.com/repos/google-research/google-research/issues/914","id":1154453815,"node_id":"IC_kwDOCQmIhc5Ez5E3","user":{"login":"TimHunt12","id":2401628,"node_id":"MDQ6VXNlcjI0MDE2Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/2401628?v=4","gravatar_id":"","url":"https://api.github.com/users/TimHunt12","html_url":"https://github.com/TimHunt12","followers_url":"https://api.github.com/users/TimHunt12/followers","following_url":"https://api.github.com/users/TimHunt12/following{/other_user}","gists_url":"https://api.github.com/users/TimHunt12/gists{/gist_id}","starred_url":"https://api.github.com/users/TimHunt12/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TimHunt12/subscriptions","organizations_url":"https://api.github.com/users/TimHunt12/orgs","repos_url":"https://api.github.com/users/TimHunt12/repos","events_url":"https://api.github.com/users/TimHunt12/events{/privacy}","received_events_url":"https://api.github.com/users/TimHunt12/received_events","type":"User","site_admin":false},"created_at":"2022-06-13T21:23:54Z","updated_at":"2022-06-13T21:23:54Z","author_association":"NONE","body":"@junjiek\r\n\r\nI was taken off of this project for a little while and just got reassigned.  I am trying to run a prediction with the MUSIQ code here using one of the existing checkpoints.  \r\n\r\nI discovered quickly that some of the library references were depreciated and I have update the libraries as well as TensorFlow to 2.9.1.  I am trying to get an MOS score on 1 image and when the code gets to line 143 of run_predict_image.py\r\n'model = model_mod.Model.partial(\r\n      num_classes=num_classes, train=False, **model_config)'\r\n it is trying to call the .partial attribute of the Model class from multiscale_transformer.py and it fails.  When I look in the code for multiscale_transformer.py there is no class function partial.\r\n \r\nWhen the prediction code for MUSIQ was posted to the GitHub, was there some code left out that was supposed to be here to run the prediction or am I missing something?\r\n\r\nThanks,   Tim","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/1154453815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"TimHunt12","id":2401628,"node_id":"MDQ6VXNlcjI0MDE2Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/2401628?v=4","gravatar_id":"","url":"https://api.github.com/users/TimHunt12","html_url":"https://github.com/TimHunt12","followers_url":"https://api.github.com/users/TimHunt12/followers","following_url":"https://api.github.com/users/TimHunt12/following{/other_user}","gists_url":"https://api.github.com/users/TimHunt12/gists{/gist_id}","starred_url":"https://api.github.com/users/TimHunt12/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TimHunt12/subscriptions","organizations_url":"https://api.github.com/users/TimHunt12/orgs","repos_url":"https://api.github.com/users/TimHunt12/repos","events_url":"https://api.github.com/users/TimHunt12/events{/privacy}","received_events_url":"https://api.github.com/users/TimHunt12/received_events","type":"User","site_admin":false}},{"id":6799342596,"node_id":"MEE_lADOCQmIhc5AM3jCzwAAAAGVRbwE","url":"https://api.github.com/repos/google-research/google-research/issues/events/6799342596","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-06-13T21:23:54Z","performed_via_github_app":null},{"id":6799342602,"node_id":"SE_lADOCQmIhc5AM3jCzwAAAAGVRbwK","url":"https://api.github.com/repos/google-research/google-research/issues/events/6799342602","actor":{"login":"junjiek","id":9404583,"node_id":"MDQ6VXNlcjk0MDQ1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/9404583?v=4","gravatar_id":"","url":"https://api.github.com/users/junjiek","html_url":"https://github.com/junjiek","followers_url":"https://api.github.com/users/junjiek/followers","following_url":"https://api.github.com/users/junjiek/following{/other_user}","gists_url":"https://api.github.com/users/junjiek/gists{/gist_id}","starred_url":"https://api.github.com/users/junjiek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junjiek/subscriptions","organizations_url":"https://api.github.com/users/junjiek/orgs","repos_url":"https://api.github.com/users/junjiek/repos","events_url":"https://api.github.com/users/junjiek/events{/privacy}","received_events_url":"https://api.github.com/users/junjiek/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-06-13T21:23:54Z","performed_via_github_app":null}]