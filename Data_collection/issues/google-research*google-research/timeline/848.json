[{"id":5478836724,"node_id":"MEE_lADOCQmIhc49WD-fzwAAAAFGkGn0","url":"https://api.github.com/repos/google-research/google-research/issues/events/5478836724","actor":{"login":"rybakov","id":6813603,"node_id":"MDQ6VXNlcjY4MTM2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6813603?v=4","gravatar_id":"","url":"https://api.github.com/users/rybakov","html_url":"https://github.com/rybakov","followers_url":"https://api.github.com/users/rybakov/followers","following_url":"https://api.github.com/users/rybakov/following{/other_user}","gists_url":"https://api.github.com/users/rybakov/gists{/gist_id}","starred_url":"https://api.github.com/users/rybakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rybakov/subscriptions","organizations_url":"https://api.github.com/users/rybakov/orgs","repos_url":"https://api.github.com/users/rybakov/repos","events_url":"https://api.github.com/users/rybakov/events{/privacy}","received_events_url":"https://api.github.com/users/rybakov/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-18T14:26:33Z","performed_via_github_app":null},{"id":5478836731,"node_id":"SE_lADOCQmIhc49WD-fzwAAAAFGkGn7","url":"https://api.github.com/repos/google-research/google-research/issues/events/5478836731","actor":{"login":"rybakov","id":6813603,"node_id":"MDQ6VXNlcjY4MTM2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6813603?v=4","gravatar_id":"","url":"https://api.github.com/users/rybakov","html_url":"https://github.com/rybakov","followers_url":"https://api.github.com/users/rybakov/followers","following_url":"https://api.github.com/users/rybakov/following{/other_user}","gists_url":"https://api.github.com/users/rybakov/gists{/gist_id}","starred_url":"https://api.github.com/users/rybakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rybakov/subscriptions","organizations_url":"https://api.github.com/users/rybakov/orgs","repos_url":"https://api.github.com/users/rybakov/repos","events_url":"https://api.github.com/users/rybakov/events{/privacy}","received_events_url":"https://api.github.com/users/rybakov/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-18T14:26:33Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/946094494","html_url":"https://github.com/google-research/google-research/issues/848#issuecomment-946094494","issue_url":"https://api.github.com/repos/google-research/google-research/issues/848","id":946094494,"node_id":"IC_kwDOCQmIhc44ZEGe","user":{"login":"rybakov","id":6813603,"node_id":"MDQ6VXNlcjY4MTM2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6813603?v=4","gravatar_id":"","url":"https://api.github.com/users/rybakov","html_url":"https://github.com/rybakov","followers_url":"https://api.github.com/users/rybakov/followers","following_url":"https://api.github.com/users/rybakov/following{/other_user}","gists_url":"https://api.github.com/users/rybakov/gists{/gist_id}","starred_url":"https://api.github.com/users/rybakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rybakov/subscriptions","organizations_url":"https://api.github.com/users/rybakov/orgs","repos_url":"https://api.github.com/users/rybakov/repos","events_url":"https://api.github.com/users/rybakov/events{/privacy}","received_events_url":"https://api.github.com/users/rybakov/received_events","type":"User","site_admin":false},"created_at":"2021-10-18T19:26:35Z","updated_at":"2021-10-18T19:26:35Z","author_association":"CONTRIBUTOR","body":"@vishalkevat007 If you are using the same tf version for training and loading then it looks like a bug in h5 weights saver/loader, please feel free to file it for keras team. kws_streaming uses default version (not h5) of save_weights and [load_weights](https://github.com/google-research/google-research/blob/master/kws_streaming/train/test.py#L67) and it works ok, I would suggest to try it in your use case.","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/946094494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rybakov","id":6813603,"node_id":"MDQ6VXNlcjY4MTM2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6813603?v=4","gravatar_id":"","url":"https://api.github.com/users/rybakov","html_url":"https://github.com/rybakov","followers_url":"https://api.github.com/users/rybakov/followers","following_url":"https://api.github.com/users/rybakov/following{/other_user}","gists_url":"https://api.github.com/users/rybakov/gists{/gist_id}","starred_url":"https://api.github.com/users/rybakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rybakov/subscriptions","organizations_url":"https://api.github.com/users/rybakov/orgs","repos_url":"https://api.github.com/users/rybakov/repos","events_url":"https://api.github.com/users/rybakov/events{/privacy}","received_events_url":"https://api.github.com/users/rybakov/received_events","type":"User","site_admin":false}},{"id":5480740102,"node_id":"MEE_lADOCQmIhc49WD-fzwAAAAFGrXUG","url":"https://api.github.com/repos/google-research/google-research/issues/events/5480740102","actor":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-18T19:26:35Z","performed_via_github_app":null},{"id":5480740112,"node_id":"SE_lADOCQmIhc49WD-fzwAAAAFGrXUQ","url":"https://api.github.com/repos/google-research/google-research/issues/events/5480740112","actor":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-18T19:26:35Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/946108417","html_url":"https://github.com/google-research/google-research/issues/848#issuecomment-946108417","issue_url":"https://api.github.com/repos/google-research/google-research/issues/848","id":946108417,"node_id":"IC_kwDOCQmIhc44ZHgB","user":{"login":"rybakov","id":6813603,"node_id":"MDQ6VXNlcjY4MTM2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6813603?v=4","gravatar_id":"","url":"https://api.github.com/users/rybakov","html_url":"https://github.com/rybakov","followers_url":"https://api.github.com/users/rybakov/followers","following_url":"https://api.github.com/users/rybakov/following{/other_user}","gists_url":"https://api.github.com/users/rybakov/gists{/gist_id}","starred_url":"https://api.github.com/users/rybakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rybakov/subscriptions","organizations_url":"https://api.github.com/users/rybakov/orgs","repos_url":"https://api.github.com/users/rybakov/repos","events_url":"https://api.github.com/users/rybakov/events{/privacy}","received_events_url":"https://api.github.com/users/rybakov/received_events","type":"User","site_admin":false},"created_at":"2021-10-18T19:47:30Z","updated_at":"2021-10-18T19:47:30Z","author_association":"CONTRIBUTOR","body":"I would also suggest to train a model on small/toy data sets first, validate that it all works on small data and then scale it to larger one.","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/946108417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rybakov","id":6813603,"node_id":"MDQ6VXNlcjY4MTM2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6813603?v=4","gravatar_id":"","url":"https://api.github.com/users/rybakov","html_url":"https://github.com/rybakov","followers_url":"https://api.github.com/users/rybakov/followers","following_url":"https://api.github.com/users/rybakov/following{/other_user}","gists_url":"https://api.github.com/users/rybakov/gists{/gist_id}","starred_url":"https://api.github.com/users/rybakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rybakov/subscriptions","organizations_url":"https://api.github.com/users/rybakov/orgs","repos_url":"https://api.github.com/users/rybakov/repos","events_url":"https://api.github.com/users/rybakov/events{/privacy}","received_events_url":"https://api.github.com/users/rybakov/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/948834419","html_url":"https://github.com/google-research/google-research/issues/848#issuecomment-948834419","issue_url":"https://api.github.com/repos/google-research/google-research/issues/848","id":948834419,"node_id":"IC_kwDOCQmIhc44jhBz","user":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"created_at":"2021-10-21T17:15:35Z","updated_at":"2021-10-21T17:15:35Z","author_association":"NONE","body":"> @vishalkevat007 If you are using the same tf version for training and loading then it looks like a bug in h5 weights saver/loader, please feel free to file it for keras team. kws_streaming uses default version (not h5) of save_weights and [load_weights](https://github.com/google-research/google-research/blob/master/kws_streaming/train/test.py#L67) and it works ok, I would suggest to try it in your use case.\r\n\r\nIf I use the default tensorflow saving and loading weights format its still showing error.\r\n`InvalidArgumentError: Cannot colocate nodes node training/Adam/stream/conv2d/kernel/m (defined at C:\\Users\\Vishal\\anaconda3\\envs\\tf-nightly\\lib\\site-packages\\keras\\optimizer_v2\\optimizer_v2.py:916) placed on device No device assignments were active during op 'training/Adam/stream/conv2d/kernel/m' creation.  and node stream/conv2d/kernel/Initializer/random_uniform/shape (defined at C:\\Users\\Vishal\\anaconda3\\envs\\tf-nightly\\lib\\site-packages\\keras\\backend.py:1831) placed on device Device assignments active during op 'stream/conv2d/kernel/Initializer/random_uniform/shape' creation:\r\n  with tf.device(None): <C:\\Users\\Vishal\\anaconda3\\envs\\tf-nightly\\lib\\site-packages\\tensorflow\\python\\ops\\resource_variable_ops.py:1774> : Cannot merge devices with incompatible types: '/job:localhost/replica:0/task:0/device:GPU:0' and '/device:CPU:0'\r\n\t [[node training/Adam/stream/conv2d/kernel/m\r\n (defined at C:\\Users\\Vishal\\anaconda3\\envs\\tf-nightly\\lib\\site-packages\\keras\\optimizer_v2\\optimizer_v2.py:916)\r\n]]`\r\n\r\nFirstly, I was trying the load weights using the default one, as this error occurred, I switched to .h5 format. But some models like crnn cannot load weights in .h5 format. ","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/948834419/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false}},{"id":5500032808,"node_id":"MEE_lADOCQmIhc49WD-fzwAAAAFH09co","url":"https://api.github.com/repos/google-research/google-research/issues/events/5500032808","actor":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-21T17:15:35Z","performed_via_github_app":null},{"id":5500032814,"node_id":"SE_lADOCQmIhc49WD-fzwAAAAFH09cu","url":"https://api.github.com/repos/google-research/google-research/issues/events/5500032814","actor":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-21T17:15:35Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/949188610","html_url":"https://github.com/google-research/google-research/issues/848#issuecomment-949188610","issue_url":"https://api.github.com/repos/google-research/google-research/issues/848","id":949188610,"node_id":"IC_kwDOCQmIhc44k3gC","user":{"login":"rybakov","id":6813603,"node_id":"MDQ6VXNlcjY4MTM2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6813603?v=4","gravatar_id":"","url":"https://api.github.com/users/rybakov","html_url":"https://github.com/rybakov","followers_url":"https://api.github.com/users/rybakov/followers","following_url":"https://api.github.com/users/rybakov/following{/other_user}","gists_url":"https://api.github.com/users/rybakov/gists{/gist_id}","starred_url":"https://api.github.com/users/rybakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rybakov/subscriptions","organizations_url":"https://api.github.com/users/rybakov/orgs","repos_url":"https://api.github.com/users/rybakov/repos","events_url":"https://api.github.com/users/rybakov/events{/privacy}","received_events_url":"https://api.github.com/users/rybakov/received_events","type":"User","site_admin":false},"created_at":"2021-10-22T01:44:38Z","updated_at":"2021-10-22T07:28:30Z","author_association":"CONTRIBUTOR","body":"@vishalkevat007 The only option I can suggest is to use different optimizer, for example --optimizer 'momentum', shown below (it is a hack, but this way you should be able to load model weights and resume training):\r\n```\r\n$CMD_TRAIN \\\r\n...\r\n--optimizer 'momentum' \\\r\ncrnn \\\r\n--cnn_filters '16,16' \\\r\n...\r\n```\r\n\r\nI already commented about it in the past: you should use a checkpointer, model weights are not enough to resume model training: the error message you shared complains about adam optimizer and its states which were not saved and can not be restored. In the latest version I added an example with model checkpointing, you can enable it with flag restore_checkpoint, example shown below:\r\n```\r\n...\r\n--frequency_mask_max_size 5 \\\r\n--restore_checkpoint 1 \\\r\ncrnn \\\r\n--cnn_filters '16,16' \\\r\n...\r\n```\r\nIf you plan to train your model at scale on large data, then it is better to design own data loader and training script with scaling support. We could make further improvements in training script, but in the future.\r\n","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/949188610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rybakov","id":6813603,"node_id":"MDQ6VXNlcjY4MTM2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6813603?v=4","gravatar_id":"","url":"https://api.github.com/users/rybakov","html_url":"https://github.com/rybakov","followers_url":"https://api.github.com/users/rybakov/followers","following_url":"https://api.github.com/users/rybakov/following{/other_user}","gists_url":"https://api.github.com/users/rybakov/gists{/gist_id}","starred_url":"https://api.github.com/users/rybakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rybakov/subscriptions","organizations_url":"https://api.github.com/users/rybakov/orgs","repos_url":"https://api.github.com/users/rybakov/repos","events_url":"https://api.github.com/users/rybakov/events{/privacy}","received_events_url":"https://api.github.com/users/rybakov/received_events","type":"User","site_admin":false}},{"id":5502026308,"node_id":"MEE_lADOCQmIhc49WD-fzwAAAAFH8kJE","url":"https://api.github.com/repos/google-research/google-research/issues/events/5502026308","actor":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-22T01:44:38Z","performed_via_github_app":null},{"id":5502026310,"node_id":"SE_lADOCQmIhc49WD-fzwAAAAFH8kJG","url":"https://api.github.com/repos/google-research/google-research/issues/events/5502026310","actor":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-22T01:44:38Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/950112253","html_url":"https://github.com/google-research/google-research/issues/848#issuecomment-950112253","issue_url":"https://api.github.com/repos/google-research/google-research/issues/848","id":950112253,"node_id":"IC_kwDOCQmIhc44oY_9","user":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"created_at":"2021-10-23T07:49:02Z","updated_at":"2021-10-23T07:49:02Z","author_association":"NONE","body":"@rybakov The checkpointer which you have added is working fine, but the file `checkpoint` which is saved by the checkpointer using checkpoint.save [here](https://github.com/google-research/google-research/blob/master/kws_streaming/train/train.py#L213) is getting overwritten by the model.save_weights [here](https://github.com/google-research/google-research/blob/master/kws_streaming/train/train.py#L200) which also saves `checkpoint` file type of the same format. So the best checkpointer file gets lost and we cannot resume the training properly. I would suggest to change the checkpointer directory specified in this [line](https://github.com/google-research/google-research/blob/master/kws_streaming/train/train.py#L129) different from model.save_weights directory. Temporarily, I solved this problem by commenting the [line](https://github.com/google-research/google-research/blob/master/kws_streaming/train/train.py#L200) and its working fine now.","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/950112253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false}},{"id":5507970592,"node_id":"MEE_lADOCQmIhc49WD-fzwAAAAFITPYg","url":"https://api.github.com/repos/google-research/google-research/issues/events/5507970592","actor":{"login":"rybakov","id":6813603,"node_id":"MDQ6VXNlcjY4MTM2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6813603?v=4","gravatar_id":"","url":"https://api.github.com/users/rybakov","html_url":"https://github.com/rybakov","followers_url":"https://api.github.com/users/rybakov/followers","following_url":"https://api.github.com/users/rybakov/following{/other_user}","gists_url":"https://api.github.com/users/rybakov/gists{/gist_id}","starred_url":"https://api.github.com/users/rybakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rybakov/subscriptions","organizations_url":"https://api.github.com/users/rybakov/orgs","repos_url":"https://api.github.com/users/rybakov/repos","events_url":"https://api.github.com/users/rybakov/events{/privacy}","received_events_url":"https://api.github.com/users/rybakov/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-23T07:49:03Z","performed_via_github_app":null},{"id":5507970594,"node_id":"SE_lADOCQmIhc49WD-fzwAAAAFITPYi","url":"https://api.github.com/repos/google-research/google-research/issues/events/5507970594","actor":{"login":"rybakov","id":6813603,"node_id":"MDQ6VXNlcjY4MTM2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6813603?v=4","gravatar_id":"","url":"https://api.github.com/users/rybakov","html_url":"https://github.com/rybakov","followers_url":"https://api.github.com/users/rybakov/followers","following_url":"https://api.github.com/users/rybakov/following{/other_user}","gists_url":"https://api.github.com/users/rybakov/gists{/gist_id}","starred_url":"https://api.github.com/users/rybakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rybakov/subscriptions","organizations_url":"https://api.github.com/users/rybakov/orgs","repos_url":"https://api.github.com/users/rybakov/repos","events_url":"https://api.github.com/users/rybakov/events{/privacy}","received_events_url":"https://api.github.com/users/rybakov/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-23T07:49:03Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/951377304","html_url":"https://github.com/google-research/google-research/issues/848#issuecomment-951377304","issue_url":"https://api.github.com/repos/google-research/google-research/issues/848","id":951377304,"node_id":"IC_kwDOCQmIhc44tN2Y","user":{"login":"rybakov","id":6813603,"node_id":"MDQ6VXNlcjY4MTM2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6813603?v=4","gravatar_id":"","url":"https://api.github.com/users/rybakov","html_url":"https://github.com/rybakov","followers_url":"https://api.github.com/users/rybakov/followers","following_url":"https://api.github.com/users/rybakov/following{/other_user}","gists_url":"https://api.github.com/users/rybakov/gists{/gist_id}","starred_url":"https://api.github.com/users/rybakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rybakov/subscriptions","organizations_url":"https://api.github.com/users/rybakov/orgs","repos_url":"https://api.github.com/users/rybakov/repos","events_url":"https://api.github.com/users/rybakov/events{/privacy}","received_events_url":"https://api.github.com/users/rybakov/received_events","type":"User","site_admin":false},"created_at":"2021-10-25T22:19:31Z","updated_at":"2021-10-25T22:19:31Z","author_association":"CONTRIBUTOR","body":"@vishalkevat007 thank you validating the checkpointing!\r\nPlease pull the latest version: checkpointing is moved into different folder, so there will be no overwriting from model.save_weights.","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/951377304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rybakov","id":6813603,"node_id":"MDQ6VXNlcjY4MTM2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6813603?v=4","gravatar_id":"","url":"https://api.github.com/users/rybakov","html_url":"https://github.com/rybakov","followers_url":"https://api.github.com/users/rybakov/followers","following_url":"https://api.github.com/users/rybakov/following{/other_user}","gists_url":"https://api.github.com/users/rybakov/gists{/gist_id}","starred_url":"https://api.github.com/users/rybakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rybakov/subscriptions","organizations_url":"https://api.github.com/users/rybakov/orgs","repos_url":"https://api.github.com/users/rybakov/repos","events_url":"https://api.github.com/users/rybakov/events{/privacy}","received_events_url":"https://api.github.com/users/rybakov/received_events","type":"User","site_admin":false}},{"id":5516628615,"node_id":"MEE_lADOCQmIhc49WD-fzwAAAAFI0RKH","url":"https://api.github.com/repos/google-research/google-research/issues/events/5516628615","actor":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-25T22:19:31Z","performed_via_github_app":null},{"id":5516628621,"node_id":"SE_lADOCQmIhc49WD-fzwAAAAFI0RKN","url":"https://api.github.com/repos/google-research/google-research/issues/events/5516628621","actor":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-25T22:19:31Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/954341726","html_url":"https://github.com/google-research/google-research/issues/848#issuecomment-954341726","issue_url":"https://api.github.com/repos/google-research/google-research/issues/848","id":954341726,"node_id":"IC_kwDOCQmIhc444hle","user":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"created_at":"2021-10-29T01:38:26Z","updated_at":"2021-10-29T01:38:26Z","author_association":"NONE","body":"> @vishalkevat007 thank you validating the checkpointing! Please pull the latest version: checkpointing is moved into different folder, so there will be no overwriting from model.save_weights.\r\n\r\n@rybakov Thank you, its working totally fine now👍","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/954341726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false}},{"id":5537771723,"node_id":"CE_lADOCQmIhc49WD-fzwAAAAFKE7DL","url":"https://api.github.com/repos/google-research/google-research/issues/events/5537771723","actor":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-10-29T01:38:27Z","state_reason":null,"performed_via_github_app":null},{"id":5537771733,"node_id":"MEE_lADOCQmIhc49WD-fzwAAAAFKE7DV","url":"https://api.github.com/repos/google-research/google-research/issues/events/5537771733","actor":{"login":"rybakov","id":6813603,"node_id":"MDQ6VXNlcjY4MTM2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6813603?v=4","gravatar_id":"","url":"https://api.github.com/users/rybakov","html_url":"https://github.com/rybakov","followers_url":"https://api.github.com/users/rybakov/followers","following_url":"https://api.github.com/users/rybakov/following{/other_user}","gists_url":"https://api.github.com/users/rybakov/gists{/gist_id}","starred_url":"https://api.github.com/users/rybakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rybakov/subscriptions","organizations_url":"https://api.github.com/users/rybakov/orgs","repos_url":"https://api.github.com/users/rybakov/repos","events_url":"https://api.github.com/users/rybakov/events{/privacy}","received_events_url":"https://api.github.com/users/rybakov/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-29T01:38:27Z","performed_via_github_app":null},{"id":5537771735,"node_id":"SE_lADOCQmIhc49WD-fzwAAAAFKE7DX","url":"https://api.github.com/repos/google-research/google-research/issues/events/5537771735","actor":{"login":"rybakov","id":6813603,"node_id":"MDQ6VXNlcjY4MTM2MDM=","avatar_url":"https://avatars.githubusercontent.com/u/6813603?v=4","gravatar_id":"","url":"https://api.github.com/users/rybakov","html_url":"https://github.com/rybakov","followers_url":"https://api.github.com/users/rybakov/followers","following_url":"https://api.github.com/users/rybakov/following{/other_user}","gists_url":"https://api.github.com/users/rybakov/gists{/gist_id}","starred_url":"https://api.github.com/users/rybakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rybakov/subscriptions","organizations_url":"https://api.github.com/users/rybakov/orgs","repos_url":"https://api.github.com/users/rybakov/repos","events_url":"https://api.github.com/users/rybakov/events{/privacy}","received_events_url":"https://api.github.com/users/rybakov/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-29T01:38:27Z","performed_via_github_app":null},{"id":5537771739,"node_id":"MEE_lADOCQmIhc49WD-fzwAAAAFKE7Db","url":"https://api.github.com/repos/google-research/google-research/issues/events/5537771739","actor":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-29T01:38:27Z","performed_via_github_app":null},{"id":5537771741,"node_id":"SE_lADOCQmIhc49WD-fzwAAAAFKE7Dd","url":"https://api.github.com/repos/google-research/google-research/issues/events/5537771741","actor":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-29T01:38:27Z","performed_via_github_app":null}]