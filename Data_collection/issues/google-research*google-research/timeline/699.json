[{"id":4735291679,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDczNTI5MTY3OQ==","url":"https://api.github.com/repos/google-research/google-research/issues/events/4735291679","actor":{"login":"debidatta","id":900350,"node_id":"MDQ6VXNlcjkwMDM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/900350?v=4","gravatar_id":"","url":"https://api.github.com/users/debidatta","html_url":"https://github.com/debidatta","followers_url":"https://api.github.com/users/debidatta/followers","following_url":"https://api.github.com/users/debidatta/following{/other_user}","gists_url":"https://api.github.com/users/debidatta/gists{/gist_id}","starred_url":"https://api.github.com/users/debidatta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debidatta/subscriptions","organizations_url":"https://api.github.com/users/debidatta/orgs","repos_url":"https://api.github.com/users/debidatta/repos","events_url":"https://api.github.com/users/debidatta/events{/privacy}","received_events_url":"https://api.github.com/users/debidatta/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-05-12T10:07:25Z","performed_via_github_app":null},{"id":4735291685,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ3MzUyOTE2ODU=","url":"https://api.github.com/repos/google-research/google-research/issues/events/4735291685","actor":{"login":"debidatta","id":900350,"node_id":"MDQ6VXNlcjkwMDM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/900350?v=4","gravatar_id":"","url":"https://api.github.com/users/debidatta","html_url":"https://github.com/debidatta","followers_url":"https://api.github.com/users/debidatta/followers","following_url":"https://api.github.com/users/debidatta/following{/other_user}","gists_url":"https://api.github.com/users/debidatta/gists{/gist_id}","starred_url":"https://api.github.com/users/debidatta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debidatta/subscriptions","organizations_url":"https://api.github.com/users/debidatta/orgs","repos_url":"https://api.github.com/users/debidatta/repos","events_url":"https://api.github.com/users/debidatta/events{/privacy}","received_events_url":"https://api.github.com/users/debidatta/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-05-12T10:07:25Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/840911128","html_url":"https://github.com/google-research/google-research/issues/699#issuecomment-840911128","issue_url":"https://api.github.com/repos/google-research/google-research/issues/699","id":840911128,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDkxMTEyOA==","user":{"login":"debidatta","id":900350,"node_id":"MDQ6VXNlcjkwMDM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/900350?v=4","gravatar_id":"","url":"https://api.github.com/users/debidatta","html_url":"https://github.com/debidatta","followers_url":"https://api.github.com/users/debidatta/followers","following_url":"https://api.github.com/users/debidatta/following{/other_user}","gists_url":"https://api.github.com/users/debidatta/gists{/gist_id}","starred_url":"https://api.github.com/users/debidatta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debidatta/subscriptions","organizations_url":"https://api.github.com/users/debidatta/orgs","repos_url":"https://api.github.com/users/debidatta/repos","events_url":"https://api.github.com/users/debidatta/events{/privacy}","received_events_url":"https://api.github.com/users/debidatta/received_events","type":"User","site_admin":false},"created_at":"2021-05-14T00:17:11Z","updated_at":"2021-05-14T00:17:11Z","author_association":"CONTRIBUTOR","body":"Hi @yongwanlim thanks for reaching out. \r\n\r\nCan you check the logs of the evaluate script to see if the checkpoint is getting loaded properly? Another thing to check would be if the function calls in eval script are being run in eval mode (training=False in Keras model calls). This used to happen implicitly before due to tf.keras.backend.set_learning_phase(0) but this feature was supposed to be deprecated in newer TF versions.","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/840911128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"debidatta","id":900350,"node_id":"MDQ6VXNlcjkwMDM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/900350?v=4","gravatar_id":"","url":"https://api.github.com/users/debidatta","html_url":"https://github.com/debidatta","followers_url":"https://api.github.com/users/debidatta/followers","following_url":"https://api.github.com/users/debidatta/following{/other_user}","gists_url":"https://api.github.com/users/debidatta/gists{/gist_id}","starred_url":"https://api.github.com/users/debidatta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debidatta/subscriptions","organizations_url":"https://api.github.com/users/debidatta/orgs","repos_url":"https://api.github.com/users/debidatta/repos","events_url":"https://api.github.com/users/debidatta/events{/privacy}","received_events_url":"https://api.github.com/users/debidatta/received_events","type":"User","site_admin":false}},{"id":4744462127,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDc0NDQ2MjEyNw==","url":"https://api.github.com/repos/google-research/google-research/issues/events/4744462127","actor":{"login":"yongwanlim","id":19750614,"node_id":"MDQ6VXNlcjE5NzUwNjE0","avatar_url":"https://avatars.githubusercontent.com/u/19750614?v=4","gravatar_id":"","url":"https://api.github.com/users/yongwanlim","html_url":"https://github.com/yongwanlim","followers_url":"https://api.github.com/users/yongwanlim/followers","following_url":"https://api.github.com/users/yongwanlim/following{/other_user}","gists_url":"https://api.github.com/users/yongwanlim/gists{/gist_id}","starred_url":"https://api.github.com/users/yongwanlim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yongwanlim/subscriptions","organizations_url":"https://api.github.com/users/yongwanlim/orgs","repos_url":"https://api.github.com/users/yongwanlim/repos","events_url":"https://api.github.com/users/yongwanlim/events{/privacy}","received_events_url":"https://api.github.com/users/yongwanlim/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-05-14T00:17:12Z","performed_via_github_app":null},{"id":4744462131,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ3NDQ0NjIxMzE=","url":"https://api.github.com/repos/google-research/google-research/issues/events/4744462131","actor":{"login":"yongwanlim","id":19750614,"node_id":"MDQ6VXNlcjE5NzUwNjE0","avatar_url":"https://avatars.githubusercontent.com/u/19750614?v=4","gravatar_id":"","url":"https://api.github.com/users/yongwanlim","html_url":"https://github.com/yongwanlim","followers_url":"https://api.github.com/users/yongwanlim/followers","following_url":"https://api.github.com/users/yongwanlim/following{/other_user}","gists_url":"https://api.github.com/users/yongwanlim/gists{/gist_id}","starred_url":"https://api.github.com/users/yongwanlim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yongwanlim/subscriptions","organizations_url":"https://api.github.com/users/yongwanlim/orgs","repos_url":"https://api.github.com/users/yongwanlim/repos","events_url":"https://api.github.com/users/yongwanlim/events{/privacy}","received_events_url":"https://api.github.com/users/yongwanlim/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-05-14T00:17:12Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/842058545","html_url":"https://github.com/google-research/google-research/issues/699#issuecomment-842058545","issue_url":"https://api.github.com/repos/google-research/google-research/issues/699","id":842058545,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjA1ODU0NQ==","user":{"login":"yongwanlim","id":19750614,"node_id":"MDQ6VXNlcjE5NzUwNjE0","avatar_url":"https://avatars.githubusercontent.com/u/19750614?v=4","gravatar_id":"","url":"https://api.github.com/users/yongwanlim","html_url":"https://github.com/yongwanlim","followers_url":"https://api.github.com/users/yongwanlim/followers","following_url":"https://api.github.com/users/yongwanlim/following{/other_user}","gists_url":"https://api.github.com/users/yongwanlim/gists{/gist_id}","starred_url":"https://api.github.com/users/yongwanlim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yongwanlim/subscriptions","organizations_url":"https://api.github.com/users/yongwanlim/orgs","repos_url":"https://api.github.com/users/yongwanlim/repos","events_url":"https://api.github.com/users/yongwanlim/events{/privacy}","received_events_url":"https://api.github.com/users/yongwanlim/received_events","type":"User","site_admin":false},"created_at":"2021-05-17T06:56:28Z","updated_at":"2021-05-17T06:56:28Z","author_association":"NONE","body":"Hi @debidatta, \r\n\r\nThanks for the suggestions. \r\n\r\nI think I resolved the issue. I had an issue in the following line: \r\n`restore_ckpt(logdir=CONFIG.LOGDIR, optimizer=optimizer, **algo.model)` in `evaluate_once` function.\r\n\r\n`CONFIG.LOGDIR` is being updated in `evaluate()` by assigning `CONFIG.LOGDIR = FLAGS.logdif` but in `evaluate_once()` when loading the checkpoint, `CONFIG.LOGDIR` was not actually `FLAGS.logdir` so I happened to refer to a wrong `logdir`.  I had to add `CONFIG.LOGDIR = FLAGS.logdir` again at the beginning of `evaluate_once` function.\r\n\r\nRegarding your second suggestion, I have questions. \r\n\r\nShouldn't the following update make the base_model be operated in eval mode?     \r\n```\r\ntraining = (tf.keras.backend.learning_phase() and CONFIG.MODEL.TRAIN_BASE != 'frozen')\r\nx = self.base_model(images, training=training)\r\n```\r\n\r\nShould I additionally modify ConvEmbedder for the eval mode? For example, turning off fc_dropout and/or inputting training=false for batch normalization? \r\n\r\nAny feedback would be appreciated. Thank you!","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/842058545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yongwanlim","id":19750614,"node_id":"MDQ6VXNlcjE5NzUwNjE0","avatar_url":"https://avatars.githubusercontent.com/u/19750614?v=4","gravatar_id":"","url":"https://api.github.com/users/yongwanlim","html_url":"https://github.com/yongwanlim","followers_url":"https://api.github.com/users/yongwanlim/followers","following_url":"https://api.github.com/users/yongwanlim/following{/other_user}","gists_url":"https://api.github.com/users/yongwanlim/gists{/gist_id}","starred_url":"https://api.github.com/users/yongwanlim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yongwanlim/subscriptions","organizations_url":"https://api.github.com/users/yongwanlim/orgs","repos_url":"https://api.github.com/users/yongwanlim/repos","events_url":"https://api.github.com/users/yongwanlim/events{/privacy}","received_events_url":"https://api.github.com/users/yongwanlim/received_events","type":"User","site_admin":false}},{"id":4752553944,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDc1MjU1Mzk0NA==","url":"https://api.github.com/repos/google-research/google-research/issues/events/4752553944","actor":{"login":"debidatta","id":900350,"node_id":"MDQ6VXNlcjkwMDM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/900350?v=4","gravatar_id":"","url":"https://api.github.com/users/debidatta","html_url":"https://github.com/debidatta","followers_url":"https://api.github.com/users/debidatta/followers","following_url":"https://api.github.com/users/debidatta/following{/other_user}","gists_url":"https://api.github.com/users/debidatta/gists{/gist_id}","starred_url":"https://api.github.com/users/debidatta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debidatta/subscriptions","organizations_url":"https://api.github.com/users/debidatta/orgs","repos_url":"https://api.github.com/users/debidatta/repos","events_url":"https://api.github.com/users/debidatta/events{/privacy}","received_events_url":"https://api.github.com/users/debidatta/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-05-17T06:56:28Z","performed_via_github_app":null},{"id":4752553951,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ3NTI1NTM5NTE=","url":"https://api.github.com/repos/google-research/google-research/issues/events/4752553951","actor":{"login":"debidatta","id":900350,"node_id":"MDQ6VXNlcjkwMDM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/900350?v=4","gravatar_id":"","url":"https://api.github.com/users/debidatta","html_url":"https://github.com/debidatta","followers_url":"https://api.github.com/users/debidatta/followers","following_url":"https://api.github.com/users/debidatta/following{/other_user}","gists_url":"https://api.github.com/users/debidatta/gists{/gist_id}","starred_url":"https://api.github.com/users/debidatta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debidatta/subscriptions","organizations_url":"https://api.github.com/users/debidatta/orgs","repos_url":"https://api.github.com/users/debidatta/repos","events_url":"https://api.github.com/users/debidatta/events{/privacy}","received_events_url":"https://api.github.com/users/debidatta/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-05-17T06:56:28Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/843439911","html_url":"https://github.com/google-research/google-research/issues/699#issuecomment-843439911","issue_url":"https://api.github.com/repos/google-research/google-research/issues/699","id":843439911,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzQzOTkxMQ==","user":{"login":"debidatta","id":900350,"node_id":"MDQ6VXNlcjkwMDM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/900350?v=4","gravatar_id":"","url":"https://api.github.com/users/debidatta","html_url":"https://github.com/debidatta","followers_url":"https://api.github.com/users/debidatta/followers","following_url":"https://api.github.com/users/debidatta/following{/other_user}","gists_url":"https://api.github.com/users/debidatta/gists{/gist_id}","starred_url":"https://api.github.com/users/debidatta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debidatta/subscriptions","organizations_url":"https://api.github.com/users/debidatta/orgs","repos_url":"https://api.github.com/users/debidatta/repos","events_url":"https://api.github.com/users/debidatta/events{/privacy}","received_events_url":"https://api.github.com/users/debidatta/received_events","type":"User","site_admin":false},"created_at":"2021-05-18T18:42:51Z","updated_at":"2021-05-18T18:42:51Z","author_association":"CONTRIBUTOR","body":"Yes you are right. That is the reason the eval is off.\r\n\r\nI rechecked the second suggestion and you don't need to change anything if you are using the version of TF mentioned in requirements.txt.\r\n\r\nFor newer versions, tf.keras.backend.learning_phase() will be deprecated and you need to pass training=True/False explicity. The part you pasted already does this, so that's ok. The part that will need changing in the future is https://github.com/google-research/google-research/blob/master/tcc/utils.py#L302 and https://github.com/google-research/google-research/blob/master/tcc/utils.py#L396 where training=False needs to be passed. \r\n\r\nLet me know if eval works for you now.","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/843439911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"debidatta","id":900350,"node_id":"MDQ6VXNlcjkwMDM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/900350?v=4","gravatar_id":"","url":"https://api.github.com/users/debidatta","html_url":"https://github.com/debidatta","followers_url":"https://api.github.com/users/debidatta/followers","following_url":"https://api.github.com/users/debidatta/following{/other_user}","gists_url":"https://api.github.com/users/debidatta/gists{/gist_id}","starred_url":"https://api.github.com/users/debidatta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debidatta/subscriptions","organizations_url":"https://api.github.com/users/debidatta/orgs","repos_url":"https://api.github.com/users/debidatta/repos","events_url":"https://api.github.com/users/debidatta/events{/privacy}","received_events_url":"https://api.github.com/users/debidatta/received_events","type":"User","site_admin":false}}]