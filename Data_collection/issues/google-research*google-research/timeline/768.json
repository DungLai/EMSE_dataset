[{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/886419682","html_url":"https://github.com/google-research/google-research/issues/768#issuecomment-886419682","issue_url":"https://api.github.com/repos/google-research/google-research/issues/768","id":886419682,"node_id":"IC_kwDOCQmIhc401bDi","user":{"login":"qinyang39","id":69283864,"node_id":"MDQ6VXNlcjY5MjgzODY0","avatar_url":"https://avatars.githubusercontent.com/u/69283864?v=4","gravatar_id":"","url":"https://api.github.com/users/qinyang39","html_url":"https://github.com/qinyang39","followers_url":"https://api.github.com/users/qinyang39/followers","following_url":"https://api.github.com/users/qinyang39/following{/other_user}","gists_url":"https://api.github.com/users/qinyang39/gists{/gist_id}","starred_url":"https://api.github.com/users/qinyang39/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qinyang39/subscriptions","organizations_url":"https://api.github.com/users/qinyang39/orgs","repos_url":"https://api.github.com/users/qinyang39/repos","events_url":"https://api.github.com/users/qinyang39/events{/privacy}","received_events_url":"https://api.github.com/users/qinyang39/received_events","type":"User","site_admin":false},"created_at":"2021-07-26T06:36:29Z","updated_at":"2021-07-26T06:36:29Z","author_association":"NONE","body":"> Hello,\r\n> I am trying to apply FAD but facing the Fatal Python error: Segmentation fault here.\r\n> Currently I am using tf 2.5.0 and apache-beam 2.24.0 with python 3.7.\r\n> \r\n> I am stuck on the step > **Compute embeddings and eastimate multivariate Gaussians**\r\n> `python -m frechet_audio_distance.create_embeddings_main --input_files test_audio/test_files_background.cvs --stats stats/background_stats`\r\n> \r\n> I found the problem **Fatal Python error** happened in `def create_pipeline()` of `create_embeddings_beam.py` :\r\n> \r\n> > if files_input_list:\r\n> > examples = (\r\n> > pipeline\r\n> > | 'Read File List' >> ReadFromText(files_input_list)\r\n> > | 'Read Files' >> beam.ParDo(ReadWavFiles()))\r\n> \r\n> Cause I am really not an expert using apache so couldn't figure it out what's going on.\r\n> \r\n> Also by googling it, it seems something wrong with stack memory which may cause the **Segmentation fault** problem,\r\n> so I have tried to increase the stack that my operating system allocates for the python process ended by `ulimit -s 262140`.\r\n> But it's still not working.\r\n> \r\n> I will be appreciate if someone has any ideas.\r\n> Thank you!!\r\n\r\nI attached my log here:\r\n> (fad-env) kp1@nipa2021-1226:~/google-research$ python -m frechet_audio_distance.create_embeddings_main --input_files test_audio/test_files_background.cvs --stats stats/background_stats  2021-07-26 15:34:57.534827: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\r\n2021-07-26 15:34:57.534877: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\r\nI0726 15:34:58.903872 140039776012032 pipeline.py:190] Missing pipeline option (runner). Executing pipeline using the default runner: DirectRunner.\r\nFatal Python error: Segmentation fault\r\nCurrent thread 0x00007f5d8d1a8700 (most recent call first):\r\n  File \"/usr/local/lib/python3.7/bz2.py\", line 346 in decompress\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/internal/pickler.py\", line 274 in loads\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/transforms/ptransform.py\", line 787 in __init__\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/transforms/core.py\", line 1266 in __init__\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/io/iobase.py\", line 1544 in expand\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/runners/runner.py\", line 228 in apply_PTransform\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/runners/runner.py\", line 198 in apply\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/pipeline.py\", line 664 in apply\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/pvalue.py\", line 141 in __or__\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/io/iobase.py\", line 892 in expand\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/runners/runner.py\", line 228 in apply_PTransform\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/runners/runner.py\", line 198 in apply\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/pipeline.py\", line 664 in apply\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/transforms/ptransform.py\", line 561 in __ror__\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/io/textio.py\", line 564 in expand\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/runners/runner.py\", line 228 in apply_PTransform\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/runners/runner.py\", line 198 in apply\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/pipeline.py\", line 664 in apply\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/pipeline.py\", line 621 in apply\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/transforms/ptransform.py\", line 561 in __ror__\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/transforms/ptransform.py\", line 997 in __ror__\r\n  File \"/home/kp1/google-research/frechet_audio_distance/create_embeddings_beam.py\", line 359 in create_pipeline\r\n  File \"/home/kp1/google-research/frechet_audio_distance/create_embeddings_main.py\", line 69 in main\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/absl/app.py\", line 258 in _run_main\r\n  File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/absl/app.py\", line 312 in run\r\n  File \"/home/kp1/google-research/frechet_audio_distance/create_embeddings_main.py\", line 75 in <module>\r\n  File \"/usr/local/lib/python3.7/runpy.py\", line 85 in _run_code\r\n  File \"/usr/local/lib/python3.7/runpy.py\", line 193 in _run_module_as_main\r\nSegmentation fault (core dumped)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/886419682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"qinyang39","id":69283864,"node_id":"MDQ6VXNlcjY5MjgzODY0","avatar_url":"https://avatars.githubusercontent.com/u/69283864?v=4","gravatar_id":"","url":"https://api.github.com/users/qinyang39","html_url":"https://github.com/qinyang39","followers_url":"https://api.github.com/users/qinyang39/followers","following_url":"https://api.github.com/users/qinyang39/following{/other_user}","gists_url":"https://api.github.com/users/qinyang39/gists{/gist_id}","starred_url":"https://api.github.com/users/qinyang39/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qinyang39/subscriptions","organizations_url":"https://api.github.com/users/qinyang39/orgs","repos_url":"https://api.github.com/users/qinyang39/repos","events_url":"https://api.github.com/users/qinyang39/events{/privacy}","received_events_url":"https://api.github.com/users/qinyang39/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/893872331","html_url":"https://github.com/google-research/google-research/issues/768#issuecomment-893872331","issue_url":"https://api.github.com/repos/google-research/google-research/issues/768","id":893872331,"node_id":"IC_kwDOCQmIhc41R2jL","user":{"login":"RussellSB","id":35470600,"node_id":"MDQ6VXNlcjM1NDcwNjAw","avatar_url":"https://avatars.githubusercontent.com/u/35470600?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSB","html_url":"https://github.com/RussellSB","followers_url":"https://api.github.com/users/RussellSB/followers","following_url":"https://api.github.com/users/RussellSB/following{/other_user}","gists_url":"https://api.github.com/users/RussellSB/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSB/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSB/subscriptions","organizations_url":"https://api.github.com/users/RussellSB/orgs","repos_url":"https://api.github.com/users/RussellSB/repos","events_url":"https://api.github.com/users/RussellSB/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSB/received_events","type":"User","site_admin":false},"created_at":"2021-08-05T22:56:35Z","updated_at":"2021-08-05T22:56:35Z","author_association":"NONE","body":"> > Hello,\r\n> > I am trying to apply FAD but facing the Fatal Python error: Segmentation fault here.\r\n> > Currently I am using tf 2.5.0 and apache-beam 2.24.0 with python 3.7.\r\n> > I am stuck on the step > **Compute embeddings and eastimate multivariate Gaussians**\r\n> > `python -m frechet_audio_distance.create_embeddings_main --input_files test_audio/test_files_background.cvs --stats stats/background_stats`\r\n> > I found the problem **Fatal Python error** happened in `def create_pipeline()` of `create_embeddings_beam.py` :\r\n> > > if files_input_list:\r\n> > > examples = (\r\n> > > pipeline\r\n> > > | 'Read File List' >> ReadFromText(files_input_list)\r\n> > > | 'Read Files' >> beam.ParDo(ReadWavFiles()))\r\n> > \r\n> > \r\n> > Cause I am really not an expert using apache so couldn't figure it out what's going on.\r\n> > Also by googling it, it seems something wrong with stack memory which may cause the **Segmentation fault** problem,\r\n> > so I have tried to increase the stack that my operating system allocates for the python process ended by `ulimit -s 262140`.\r\n> > But it's still not working.\r\n> > I will be appreciate if someone has any ideas.\r\n> > Thank you!!\r\n> \r\n> I attached my log here:\r\n> \r\n> > (fad-env) kp1@nipa2021-1226:~/google-research$ python -m frechet_audio_distance.create_embeddings_main --input_files test_audio/test_files_background.cvs --stats stats/background_stats  2021-07-26 15:34:57.534827: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\r\n> > 2021-07-26 15:34:57.534877: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\r\n> > I0726 15:34:58.903872 140039776012032 pipeline.py:190] Missing pipeline option (runner). Executing pipeline using the default runner: DirectRunner.\r\n> > Fatal Python error: Segmentation fault\r\n> > Current thread 0x00007f5d8d1a8700 (most recent call first):\r\n> > File \"/usr/local/lib/python3.7/bz2.py\", line 346 in decompress\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/internal/pickler.py\", line 274 in loads\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/transforms/ptransform.py\", line 787 in **init**\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/transforms/core.py\", line 1266 in **init**\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/io/iobase.py\", line 1544 in expand\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/runners/runner.py\", line 228 in apply_PTransform\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/runners/runner.py\", line 198 in apply\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/pipeline.py\", line 664 in apply\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/pvalue.py\", line 141 in **or**\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/io/iobase.py\", line 892 in expand\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/runners/runner.py\", line 228 in apply_PTransform\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/runners/runner.py\", line 198 in apply\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/pipeline.py\", line 664 in apply\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/transforms/ptransform.py\", line 561 in **ror**\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/io/textio.py\", line 564 in expand\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/runners/runner.py\", line 228 in apply_PTransform\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/runners/runner.py\", line 198 in apply\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/pipeline.py\", line 664 in apply\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/pipeline.py\", line 621 in apply\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/transforms/ptransform.py\", line 561 in **ror**\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/apache_beam/transforms/ptransform.py\", line 997 in **ror**\r\n> > File \"/home/kp1/google-research/frechet_audio_distance/create_embeddings_beam.py\", line 359 in create_pipeline\r\n> > File \"/home/kp1/google-research/frechet_audio_distance/create_embeddings_main.py\", line 69 in main\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/absl/app.py\", line 258 in _run_main\r\n> > File \"/home/kp1/google-research/fad-env/lib/python3.7/site-packages/absl/app.py\", line 312 in run\r\n> > File \"/home/kp1/google-research/frechet_audio_distance/create_embeddings_main.py\", line 75 in \r\n> > File \"/usr/local/lib/python3.7/runpy.py\", line 85 in _run_code\r\n> > File \"/usr/local/lib/python3.7/runpy.py\", line 193 in _run_module_as_main\r\n> > Segmentation fault (core dumped)\r\n\r\nSame issue for me","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/893872331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"RussellSB","id":35470600,"node_id":"MDQ6VXNlcjM1NDcwNjAw","avatar_url":"https://avatars.githubusercontent.com/u/35470600?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSB","html_url":"https://github.com/RussellSB","followers_url":"https://api.github.com/users/RussellSB/followers","following_url":"https://api.github.com/users/RussellSB/following{/other_user}","gists_url":"https://api.github.com/users/RussellSB/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSB/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSB/subscriptions","organizations_url":"https://api.github.com/users/RussellSB/orgs","repos_url":"https://api.github.com/users/RussellSB/repos","events_url":"https://api.github.com/users/RussellSB/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSB/received_events","type":"User","site_admin":false}}]