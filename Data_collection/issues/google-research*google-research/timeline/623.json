[{"actor":{"login":"dagleaves","id":68761152,"node_id":"MDQ6VXNlcjY4NzYxMTUy","avatar_url":"https://avatars.githubusercontent.com/u/68761152?v=4","gravatar_id":"","url":"https://api.github.com/users/dagleaves","html_url":"https://github.com/dagleaves","followers_url":"https://api.github.com/users/dagleaves/followers","following_url":"https://api.github.com/users/dagleaves/following{/other_user}","gists_url":"https://api.github.com/users/dagleaves/gists{/gist_id}","starred_url":"https://api.github.com/users/dagleaves/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagleaves/subscriptions","organizations_url":"https://api.github.com/users/dagleaves/orgs","repos_url":"https://api.github.com/users/dagleaves/repos","events_url":"https://api.github.com/users/dagleaves/events{/privacy}","received_events_url":"https://api.github.com/users/dagleaves/received_events","type":"User","site_admin":false},"created_at":"2021-03-16T19:56:04Z","updated_at":"2021-03-16T19:56:04Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/google-research/google-research/issues/534","repository_url":"https://api.github.com/repos/google-research/google-research","labels_url":"https://api.github.com/repos/google-research/google-research/issues/534/labels{/name}","comments_url":"https://api.github.com/repos/google-research/google-research/issues/534/comments","events_url":"https://api.github.com/repos/google-research/google-research/issues/534/events","html_url":"https://github.com/google-research/google-research/issues/534","id":789736483,"node_id":"MDU6SXNzdWU3ODk3MzY0ODM=","number":534,"title":"Question about Meta Pseudo Labels gradient signal","user":{"login":"HansPinckaers","id":70747,"node_id":"MDQ6VXNlcjcwNzQ3","avatar_url":"https://avatars.githubusercontent.com/u/70747?v=4","gravatar_id":"","url":"https://api.github.com/users/HansPinckaers","html_url":"https://github.com/HansPinckaers","followers_url":"https://api.github.com/users/HansPinckaers/followers","following_url":"https://api.github.com/users/HansPinckaers/following{/other_user}","gists_url":"https://api.github.com/users/HansPinckaers/gists{/gist_id}","starred_url":"https://api.github.com/users/HansPinckaers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HansPinckaers/subscriptions","organizations_url":"https://api.github.com/users/HansPinckaers/orgs","repos_url":"https://api.github.com/users/HansPinckaers/repos","events_url":"https://api.github.com/users/HansPinckaers/events{/privacy}","received_events_url":"https://api.github.com/users/HansPinckaers/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":32,"created_at":"2021-01-20T08:00:29Z","updated_at":"2022-03-18T02:58:40Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"repository":{"id":151619717,"node_id":"MDEwOlJlcG9zaXRvcnkxNTE2MTk3MTc=","name":"google-research","full_name":"google-research/google-research","private":false,"owner":{"login":"google-research","id":43830688,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQzODMwNjg4","avatar_url":"https://avatars.githubusercontent.com/u/43830688?v=4","gravatar_id":"","url":"https://api.github.com/users/google-research","html_url":"https://github.com/google-research","followers_url":"https://api.github.com/users/google-research/followers","following_url":"https://api.github.com/users/google-research/following{/other_user}","gists_url":"https://api.github.com/users/google-research/gists{/gist_id}","starred_url":"https://api.github.com/users/google-research/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/google-research/subscriptions","organizations_url":"https://api.github.com/users/google-research/orgs","repos_url":"https://api.github.com/users/google-research/repos","events_url":"https://api.github.com/users/google-research/events{/privacy}","received_events_url":"https://api.github.com/users/google-research/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/google-research/google-research","description":"Google Research","fork":false,"url":"https://api.github.com/repos/google-research/google-research","forks_url":"https://api.github.com/repos/google-research/google-research/forks","keys_url":"https://api.github.com/repos/google-research/google-research/keys{/key_id}","collaborators_url":"https://api.github.com/repos/google-research/google-research/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/google-research/google-research/teams","hooks_url":"https://api.github.com/repos/google-research/google-research/hooks","issue_events_url":"https://api.github.com/repos/google-research/google-research/issues/events{/number}","events_url":"https://api.github.com/repos/google-research/google-research/events","assignees_url":"https://api.github.com/repos/google-research/google-research/assignees{/user}","branches_url":"https://api.github.com/repos/google-research/google-research/branches{/branch}","tags_url":"https://api.github.com/repos/google-research/google-research/tags","blobs_url":"https://api.github.com/repos/google-research/google-research/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/google-research/google-research/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/google-research/google-research/git/refs{/sha}","trees_url":"https://api.github.com/repos/google-research/google-research/git/trees{/sha}","statuses_url":"https://api.github.com/repos/google-research/google-research/statuses/{sha}","languages_url":"https://api.github.com/repos/google-research/google-research/languages","stargazers_url":"https://api.github.com/repos/google-research/google-research/stargazers","contributors_url":"https://api.github.com/repos/google-research/google-research/contributors","subscribers_url":"https://api.github.com/repos/google-research/google-research/subscribers","subscription_url":"https://api.github.com/repos/google-research/google-research/subscription","commits_url":"https://api.github.com/repos/google-research/google-research/commits{/sha}","git_commits_url":"https://api.github.com/repos/google-research/google-research/git/commits{/sha}","comments_url":"https://api.github.com/repos/google-research/google-research/comments{/number}","issue_comment_url":"https://api.github.com/repos/google-research/google-research/issues/comments{/number}","contents_url":"https://api.github.com/repos/google-research/google-research/contents/{+path}","compare_url":"https://api.github.com/repos/google-research/google-research/compare/{base}...{head}","merges_url":"https://api.github.com/repos/google-research/google-research/merges","archive_url":"https://api.github.com/repos/google-research/google-research/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/google-research/google-research/downloads","issues_url":"https://api.github.com/repos/google-research/google-research/issues{/number}","pulls_url":"https://api.github.com/repos/google-research/google-research/pulls{/number}","milestones_url":"https://api.github.com/repos/google-research/google-research/milestones{/number}","notifications_url":"https://api.github.com/repos/google-research/google-research/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/google-research/google-research/labels{/name}","releases_url":"https://api.github.com/repos/google-research/google-research/releases{/id}","deployments_url":"https://api.github.com/repos/google-research/google-research/deployments","created_at":"2018-10-04T18:42:48Z","updated_at":"2023-01-20T00:41:48Z","pushed_at":"2023-01-19T23:45:46Z","git_url":"git://github.com/google-research/google-research.git","ssh_url":"git@github.com:google-research/google-research.git","clone_url":"https://github.com/google-research/google-research.git","svn_url":"https://github.com/google-research/google-research","homepage":"https://research.google","size":371210,"stargazers_count":26828,"watchers_count":26828,"language":"Jupyter Notebook","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6663,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":904,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["ai","machine-learning","research"],"visibility":"public","forks":6663,"open_issues":904,"watchers":26828,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Hi there,\r\n\r\nI really enjoyed reading the paper by @hyhieu et al.! I don't have the resources to train the models, or even run the code, but I do have some questions about the code. Especially about the loss of the teacher model. If I'm understanding correctly, the final loss is defined here: \r\n\r\nhttps://github.com/google-research/google-research/blob/ec13eb6661a7b9500016cc6d7e3ab940c2dbf184/meta_pseudo_labels/training_utils.py#L494-L496\r\n\r\nI have a question about the MPL term. `cross_entropy['mpl'] * dot_product`.\r\n\r\n`dot_product` seems to be a scalar (like mentioned in the paper), without gradient computation:\r\n\r\nhttps://github.com/google-research/google-research/blob/ec13eb6661a7b9500016cc6d7e3ab940c2dbf184/meta_pseudo_labels/training_utils.py#L483\r\n\r\n`cross_entropy['mpl']` seems to be defined a few lines above:\r\nhttps://github.com/google-research/google-research/blob/ec13eb6661a7b9500016cc6d7e3ab940c2dbf184/meta_pseudo_labels/training_utils.py#L484-L487\r\n\r\nThis seems to be a cross-entropy where the logits and targets are the same (since `softmax_cross_entropy` also applies a softmax to the logits). This loss can be non-zero when the targets are not 'hard' (soft targets), however, I don't think there is any signal in that case? Since the logits and targets seem to be equal. \r\n\r\nMy question is — if I'm understanding the code correctly — if there is no signal and it's scaled by the `dot_product`, I do not know what the value is of this term in the optimization?\r\n\r\nThanks again for your work!\r\nHans\r\n\r\nP.S. small side question: in the paper, it is mentioned the method uses hard-targets, but I cannot find this in the code.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/534/reactions","total_count":6,"+1":6,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/google-research/google-research/issues/534/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/800595154","html_url":"https://github.com/google-research/google-research/issues/623#issuecomment-800595154","issue_url":"https://api.github.com/repos/google-research/google-research/issues/623","id":800595154,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDU5NTE1NA==","user":{"login":"hyhieu","id":5642307,"node_id":"MDQ6VXNlcjU2NDIzMDc=","avatar_url":"https://avatars.githubusercontent.com/u/5642307?v=4","gravatar_id":"","url":"https://api.github.com/users/hyhieu","html_url":"https://github.com/hyhieu","followers_url":"https://api.github.com/users/hyhieu/followers","following_url":"https://api.github.com/users/hyhieu/following{/other_user}","gists_url":"https://api.github.com/users/hyhieu/gists{/gist_id}","starred_url":"https://api.github.com/users/hyhieu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hyhieu/subscriptions","organizations_url":"https://api.github.com/users/hyhieu/orgs","repos_url":"https://api.github.com/users/hyhieu/repos","events_url":"https://api.github.com/users/hyhieu/events{/privacy}","received_events_url":"https://api.github.com/users/hyhieu/received_events","type":"User","site_admin":false},"created_at":"2021-03-16T20:50:13Z","updated_at":"2021-03-16T20:50:31Z","author_association":"NONE","body":"Please correct me if I misunderstand your question.\r\n\r\nIf the student is trained on **augmented unlabeled data** and its **training** loss consistently goes down, then the student does produce reliable labels for these images, no?","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/800595154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hyhieu","id":5642307,"node_id":"MDQ6VXNlcjU2NDIzMDc=","avatar_url":"https://avatars.githubusercontent.com/u/5642307?v=4","gravatar_id":"","url":"https://api.github.com/users/hyhieu","html_url":"https://github.com/hyhieu","followers_url":"https://api.github.com/users/hyhieu/followers","following_url":"https://api.github.com/users/hyhieu/following{/other_user}","gists_url":"https://api.github.com/users/hyhieu/gists{/gist_id}","starred_url":"https://api.github.com/users/hyhieu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hyhieu/subscriptions","organizations_url":"https://api.github.com/users/hyhieu/orgs","repos_url":"https://api.github.com/users/hyhieu/repos","events_url":"https://api.github.com/users/hyhieu/events{/privacy}","received_events_url":"https://api.github.com/users/hyhieu/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/800634170","html_url":"https://github.com/google-research/google-research/issues/623#issuecomment-800634170","issue_url":"https://api.github.com/repos/google-research/google-research/issues/623","id":800634170,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDYzNDE3MA==","user":{"login":"dagleaves","id":68761152,"node_id":"MDQ6VXNlcjY4NzYxMTUy","avatar_url":"https://avatars.githubusercontent.com/u/68761152?v=4","gravatar_id":"","url":"https://api.github.com/users/dagleaves","html_url":"https://github.com/dagleaves","followers_url":"https://api.github.com/users/dagleaves/followers","following_url":"https://api.github.com/users/dagleaves/following{/other_user}","gists_url":"https://api.github.com/users/dagleaves/gists{/gist_id}","starred_url":"https://api.github.com/users/dagleaves/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagleaves/subscriptions","organizations_url":"https://api.github.com/users/dagleaves/orgs","repos_url":"https://api.github.com/users/dagleaves/repos","events_url":"https://api.github.com/users/dagleaves/events{/privacy}","received_events_url":"https://api.github.com/users/dagleaves/received_events","type":"User","site_admin":false},"created_at":"2021-03-16T21:47:41Z","updated_at":"2021-03-16T21:48:55Z","author_association":"NONE","body":"I see my improper phrasing now. You have allowed me to reach the heart of my question that I could not think of. \r\n\r\nWhen provided with a suboptimal teacher, is the student be able to provide **more** reliable labels for the augmented data than the teacher?\r\n\r\nThis is in reference to the lines \"Despite the strong performance of Pseudo Labels methods, they have one main drawback: if the pseudo labels are inaccurate, the student will learn from inaccurate data. As a result, the student may not get significantly better than the teacher\" from the original paper.\r\n\r\nDoes the student achieve better performance than the teacher in this manner? With only the pseudo labels method, this would be more clear, but the student and the teacher both improve due to MPL. Was this confirmed?\r\n\r\nWere there any tests or results showing the teacher's improvement with MPL or just the student?","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/800634170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dagleaves","id":68761152,"node_id":"MDQ6VXNlcjY4NzYxMTUy","avatar_url":"https://avatars.githubusercontent.com/u/68761152?v=4","gravatar_id":"","url":"https://api.github.com/users/dagleaves","html_url":"https://github.com/dagleaves","followers_url":"https://api.github.com/users/dagleaves/followers","following_url":"https://api.github.com/users/dagleaves/following{/other_user}","gists_url":"https://api.github.com/users/dagleaves/gists{/gist_id}","starred_url":"https://api.github.com/users/dagleaves/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagleaves/subscriptions","organizations_url":"https://api.github.com/users/dagleaves/orgs","repos_url":"https://api.github.com/users/dagleaves/repos","events_url":"https://api.github.com/users/dagleaves/events{/privacy}","received_events_url":"https://api.github.com/users/dagleaves/received_events","type":"User","site_admin":false}}]