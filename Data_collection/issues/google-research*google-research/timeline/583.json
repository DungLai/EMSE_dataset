[{"id":4363818795,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDM2MzgxODc5NQ==","url":"https://api.github.com/repos/google-research/google-research/issues/events/4363818795","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-02-23T08:25:51Z","performed_via_github_app":null},{"id":4363818797,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQzNjM4MTg3OTc=","url":"https://api.github.com/repos/google-research/google-research/issues/events/4363818797","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-02-23T08:25:51Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/784115297","html_url":"https://github.com/google-research/google-research/issues/583#issuecomment-784115297","issue_url":"https://api.github.com/repos/google-research/google-research/issues/583","id":784115297,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDExNTI5Nw==","user":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"created_at":"2021-02-23T10:57:53Z","updated_at":"2021-02-23T14:22:05Z","author_association":"CONTRIBUTOR","body":"Hi @ccpocker, thanks for your interest in our paper. Yes it is true, I did not open source any script for a single gray-scale image inference. However, it should not be too difficult to achieve that.\r\n\r\nYou can adapt sample.py in the following way.\r\n\r\n-  Remove all the code depending on datasets.get_datasets (https://github.com/google-research/google-research/blob/master/coltran/sample.py#L223). This will prevent downloading ImageNet.\r\n-  For the **colorizer**:\r\n    - **input** - 64x64 grayscale image. You need to provide inputs here https://github.com/google-research/google-research/blob/master/coltran/sample.py#L186.\r\n    -  **output['sample']** will output a 64x64 colorized sample. - \r\n- For the **color upsampler**\r\n    - You need to provide inputs here (https://github.com/google-research/google-research/blob/master/coltran/sample.py#L172)\r\n    - **input: gray_cond** - 64x64 grayscale image.\r\n    - **input: bit_cond** - 64x64 sample from the colorizer.\r\n    -  **output['argmax']** will output a 64x64 RGB image.\r\n - For the **spatial upsampler**\r\n     - You need to provide inputs here (https://github.com/google-research/google-research/blob/master/coltran/sample.py#L183)\r\n     - **input: gray_cond** - 256x256 grayscale image.\r\n     - **input: low_res**\r\n         - Let the 64x64 output from the color upsampler be `cup_out`\r\n         - Use `low_res=datasets_utils.change_resolution(cup_out, 256)`  to convert it to a blurry 256x256 colorized image.\r\n     - **output['argmax']** - 256x256 final image.\r\n\r\nYou can save the intermediate images at each stage to disk and then reload them to avoid issues with memory. Let me know if you want to take a stab at it and if you wish to contribute a script. If not, I will try to write one after a couple of weeks.\r\n\r\nRe: **inference** vs **sampling**, I think the word inference is used broadly these days. It was used in a probabilistic sense to infer unobserved latent variables but now it can just mean to use the trained model for predictions (incl sampling)","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/784115297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false}},{"id":4364506927,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDM2NDUwNjkyNw==","url":"https://api.github.com/repos/google-research/google-research/issues/events/4364506927","actor":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-02-23T10:57:53Z","performed_via_github_app":null},{"id":4364506935,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQzNjQ1MDY5MzU=","url":"https://api.github.com/repos/google-research/google-research/issues/events/4364506935","actor":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-02-23T10:57:53Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/784710463","html_url":"https://github.com/google-research/google-research/issues/583#issuecomment-784710463","issue_url":"https://api.github.com/repos/google-research/google-research/issues/583","id":784710463,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDcxMDQ2Mw==","user":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false},"created_at":"2021-02-24T02:51:58Z","updated_at":"2021-02-24T02:51:58Z","author_association":"NONE","body":"Hi @MechCoder, thank you so much for such quick reply. \r\n\r\nYes i will have a try to write a script for single gray-scale image inference  following your instructions. Due to unfamiliar with TF2.0 and limitation of time, i am not sure that i can achieve it.\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/784710463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false}},{"id":4368489013,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDM2ODQ4OTAxMw==","url":"https://api.github.com/repos/google-research/google-research/issues/events/4368489013","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-02-24T02:51:58Z","performed_via_github_app":null},{"id":4368489015,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQzNjg0ODkwMTU=","url":"https://api.github.com/repos/google-research/google-research/issues/events/4368489015","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-02-24T02:51:58Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/789511021","html_url":"https://github.com/google-research/google-research/issues/583#issuecomment-789511021","issue_url":"https://api.github.com/repos/google-research/google-research/issues/583","id":789511021,"node_id":"MDEyOklzc3VlQ29tbWVudDc4OTUxMTAyMQ==","user":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false},"created_at":"2021-03-03T07:43:38Z","updated_at":"2021-03-03T07:43:38Z","author_association":"NONE","body":"hi @MechCoder, i follow your instruction and write a script：\r\n\r\nI adopt the sample.py，just change depending on the datasets.get_datasets.\r\n\r\nCode are below here:\r\n\r\n```python\r\ndef load_and_preprocess_image(path):\r\n    image_str = tf.io.read_file(path)\r\n    image = tf.image.decode_image(image_str)\r\n    image = tf.image.grayscale_to_rgb(image)\r\n    example = {}\r\n    example['image'] = image\r\n    return example\r\n\r\n\r\ndef get_dataset_from_dir(config):\r\n    \"\"\"\r\n\r\n    \"\"\"\r\n    downsample = config.get('downsample', False)\r\n    downsample_res = config.get('downsample_res', 64)\r\n    downsample_method = config.get('downsample_method', 'area')\r\n    dir = config.get('dir', input_dir)\r\n    dir = Path(dir)\r\n    auto = tf.data.experimental.AUTOTUNE\r\n\r\n    fileList = sorted([str(file) for file in dir.rglob('*.*')])\r\n\r\n    path_ds = tf.data.Dataset.from_tensor_slices(fileList)\r\n    image_ds = path_ds.map(load_and_preprocess_image)\r\n    ds = image_ds.map(lambda x: datasets.preprocess(x, train=False))\r\n    if downsample:\r\n        downsample_part = functools.partial(\r\n            datasets_utils.downsample_and_upsample,\r\n            train=False,\r\n            downsample_res=downsample_res,\r\n            upsample_res=256,\r\n            method=downsample_method)\r\n        ds = ds.map(downsample_part, num_parallel_calls=100)\r\n    ds = ds.batch(1, drop_remainder=True)\r\n    ds = ds.prefetch(auto)\r\n    return ds\r\n```\r\n\r\nThe output for this line is dict:\r\nhttps://github.com/google-research/google-research/blob/f2b680b0a8422ba852fd268829a127a41ebe4414/coltran/sample.py#L186 \r\n\r\noutput=\r\n{'parallel': <tf.Tensor: shape=(1, 64, 64, 3), dtype=uint8，\r\n'auto_sample': <tf.Tensor: shape=(1, 64, 64, 3),dtype=uint8,\r\n'proba': <tf.Tensor: shape=(1, 64, 64, 512), dtype=float32}\r\n\r\nwhen i save the output['parallel'] or output['auto_sample'] are colorful noisy picture( just meanless colorful noisy picture).\r\n\r\nIt is not the coarsely colorization for the input gray-scale image.\r\n\r\nIs there any misunderstanding or wrong for my code? \r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/789511021/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false}},{"id":4400084116,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDQwMDA4NDExNg==","url":"https://api.github.com/repos/google-research/google-research/issues/events/4400084116","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-03T07:43:39Z","performed_via_github_app":null},{"id":4400084118,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ0MDAwODQxMTg=","url":"https://api.github.com/repos/google-research/google-research/issues/events/4400084118","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-03T07:43:39Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/789525006","html_url":"https://github.com/google-research/google-research/issues/583#issuecomment-789525006","issue_url":"https://api.github.com/repos/google-research/google-research/issues/583","id":789525006,"node_id":"MDEyOklzc3VlQ29tbWVudDc4OTUyNTAwNg==","user":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"created_at":"2021-03-03T08:11:00Z","updated_at":"2021-03-03T08:11:52Z","author_association":"CONTRIBUTOR","body":"Quick questions before I look into detail.\r\n\r\n1. Can you verify that the input gray-image has int32 dtype.\r\n\r\n2. Is the checkpoint being restored correctly?You can use our latest checkpoints from here (https://console.cloud.google.com/storage/browser/gresearch/coltran/colorizer_v2) which have better results. You should be able to see logs such as \"Producing sample after 601000 training steps.\" (https://github.com/google-research/google-research/blob/master/coltran/sample.py#L146)\r\n","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/789525006/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/789587199","html_url":"https://github.com/google-research/google-research/issues/583#issuecomment-789587199","issue_url":"https://api.github.com/repos/google-research/google-research/issues/583","id":789587199,"node_id":"MDEyOklzc3VlQ29tbWVudDc4OTU4NzE5OQ==","user":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false},"created_at":"2021-03-03T09:52:57Z","updated_at":"2021-03-03T09:52:57Z","author_association":"NONE","body":"I debug the code and found the problem is exactly the model don't load the checkpoint correctly.\r\n\r\nMy log infomation  is \"Producing sample after 0 training steps\".\r\n\r\nThe problem is this line:\r\nhttps://github.com/google-research/google-research/blob/2d5a316a758d2b27b745bc5857503fd822592fa5/coltran/utils/train_utils.py#L186\r\n\r\ntf.train.latest_checkpoint(ckpt_dir_) return None\r\n\r\nwhile ckpt_dir_  is the abosolute dir of the colorizer_v2 dir, just like this:\r\n\r\nckpt_dir_  =”/data/glusterfs_hz_cv/11119980/google-research-master/coltran/colorizer_v2“\r\n\r\nAny suggestion to fix this problem？\r\n","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/789587199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/789605613","html_url":"https://github.com/google-research/google-research/issues/583#issuecomment-789605613","issue_url":"https://api.github.com/repos/google-research/google-research/issues/583","id":789605613,"node_id":"MDEyOklzc3VlQ29tbWVudDc4OTYwNTYxMw==","user":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"created_at":"2021-03-03T10:22:09Z","updated_at":"2021-03-03T10:22:09Z","author_association":"CONTRIBUTOR","body":"Could you provide the command-line that you are using to run the code?","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/789605613/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/789679484","html_url":"https://github.com/google-research/google-research/issues/583#issuecomment-789679484","issue_url":"https://api.github.com/repos/google-research/google-research/issues/583","id":789679484,"node_id":"MDEyOklzc3VlQ29tbWVudDc4OTY3OTQ4NA==","user":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false},"created_at":"2021-03-03T12:27:27Z","updated_at":"2021-03-03T12:27:27Z","author_association":"NONE","body":"The pwd dir is /data/glusterfs_hz_cv/11119980/google-research-master/\r\nThe command-line code is:\r\n```bash\r\npython -m coltran.infer --config=coltran/configs/colorizer.py --mode=infer --logdir=/data/glusterfs_hz_cv/11119980/google-research-master/coltran/colorizer_v2\r\n```\r\n\r\nand the infer.py some code is \r\n\r\n```python\r\ndef infer(logdir):\r\n    \"Executes infering for single gray-scale image\"\r\n    logging.info('begingning the infer single image')\r\n    config = FLAGS.config\r\n    batch_size = config.sample.get('batch_size', 1)\r\n    # used to parallelize sampling jobs.\r\n    skip_batches = config.sample.get('skip_batches', 0)\r\n    gen_data_dir = config.sample.get('gen_data_dir', None)\r\n    is_gen = gen_data_dir is not None\r\n\r\n    model_name = config.model.get('name')\r\n\r\n    dir = config.get('dir', input_dir)\r\n    total_number = len(os.listdir(dir))\r\n    config.sample.num_outputs = total_number\r\n\r\n    if not is_gen and 'upsampler' in model_name:\r\n        logging.info('Generated low resolution not provided, using ground '\r\n                     'truth input.')\r\n\r\n    # input image to ten\r\n    img_ds = get_dataset_from_dir(config)\r\n    data_iter = iter(img_ds)\r\n\r\n    gen_iter = None\r\n    if is_gen:\r\n        pass\r\n    store_samples(data_iter, config, logdir, gen_iter)\r\n\r\ndef main(_):\r\n    logging.info('Logging to %s.', FLAGS.logdir)\r\n    if FLAGS.mode == 'sample':\r\n        logging.info('[main] I am the sampler.')\r\n        sample(FLAGS.logdir, subset='valid')\r\n    if FLAGS.mode == 'sample_test':\r\n        logging.info('[main] I am the sampler test.')\r\n        sample(FLAGS.logdir, subset='test')\r\n    if FLAGS.mode == 'infer':\r\n        logging.info('[main] i am the inferecen')\r\n        infer(FLAGS.logdir)\r\n    else:\r\n        raise ValueError(\r\n            'Unknown mode {}. '\r\n            'Must be one of [sample, sample_test]'.format(FLAGS.mode))\r\n```","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/789679484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/789691874","html_url":"https://github.com/google-research/google-research/issues/583#issuecomment-789691874","issue_url":"https://api.github.com/repos/google-research/google-research/issues/583","id":789691874,"node_id":"MDEyOklzc3VlQ29tbWVudDc4OTY5MTg3NA==","user":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"created_at":"2021-03-03T12:50:11Z","updated_at":"2021-03-03T13:07:13Z","author_association":"CONTRIBUTOR","body":"1. Can you verify that the logdir is passed correctly to the script by printing it inside the infer function?\r\n2. Can you also just try\r\n```\r\nckpt_dir = '/data/glusterfs_hz_cv/11119980/google-research-master/coltran/colorizer_v2'\r\nout = tf.train.latest_checkpoint(ckpt_dir)\r\nprint(out)\r\n```\r\n\r\nThis should print `/data/glusterfs_hz_cv/11119980/google-research-master/coltran/colorizer_v2/model-302` if the checkpoint is downloaded correctly","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/789691874/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/790392659","html_url":"https://github.com/google-research/google-research/issues/583#issuecomment-790392659","issue_url":"https://api.github.com/repos/google-research/google-research/issues/583","id":790392659,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MDM5MjY1OQ==","user":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false},"created_at":"2021-03-04T07:38:09Z","updated_at":"2021-03-04T07:38:35Z","author_association":"NONE","body":"Another new day, @MechCoder Good morning!\r\n\r\nI check my code and answer is:\r\n\r\n1. The logdir is passed correctly to the infer function and this line: https://github.com/google-research/google-research/blob/cbdffab5084e4d823f0c917be01d07969e6460a9/coltran/sample.py#L144\r\n2. I have try your code: and the output is None.  \r\n\r\nFirstly, i think i downloaded checkpoint incorrectly, so i have redownload the checkpoint three times from this link you provided, but the output is still None.\r\n\r\nThe checkpoint dir information in my machine is：\r\n```\r\ntotal 542905\r\ndrwxr-xr-x  2 root root      4096 Mar  4 15:35 ./\r\ndrwxr-xr-x 13 root root      4096 Mar  4 15:04 ../\r\n-rw-r--r--  1 root root       997 Mar  3 16:41 coltran-colorizer_v2-checkpoint\r\n-rw-r--r--  1 root root 555911401 Mar  3 16:43 coltran-colorizer_v2-model-302.data-00000-of-00001\r\n-rw-r--r--  1 root root     13521 Mar  3 16:41 coltran-colorizer_v2-model-302.index\r\n```\r\n\r\ncould you help me check the checkpoint information is correctly?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/790392659/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false}},{"id":4406297301,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDQwNjI5NzMwMQ==","url":"https://api.github.com/repos/google-research/google-research/issues/events/4406297301","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-04T07:38:09Z","performed_via_github_app":null},{"id":4406297310,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ0MDYyOTczMTA=","url":"https://api.github.com/repos/google-research/google-research/issues/events/4406297310","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-04T07:38:09Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/790445881","html_url":"https://github.com/google-research/google-research/issues/583#issuecomment-790445881","issue_url":"https://api.github.com/repos/google-research/google-research/issues/583","id":790445881,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MDQ0NTg4MQ==","user":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"created_at":"2021-03-04T08:54:09Z","updated_at":"2021-03-04T08:54:09Z","author_association":"CONTRIBUTOR","body":"good morning! I can reproduce the issue. It seems on downloading the checkpoints from the cloud, it adds the prefix ''coltran-colorizer_v2-\". \r\n\r\nCan you rename the files, removing the prefixes and make sure that this is the directory information.\r\n\r\n```\r\ntotal 542905\r\ndrwxr-xr-x  2 root root      4096 Mar  4 15:35 ./\r\ndrwxr-xr-x 13 root root      4096 Mar  4 15:04 ../\r\n-rw-r--r--  1 root root       997 Mar  3 16:41 checkpoint\r\n-rw-r--r--  1 root root 555911401 Mar  3 16:43 model-302.data-00000-of-00001\r\n-rw-r--r--  1 root root     13521 Mar  3 16:41 model-302.index\r\n```\r\n\r\nLet me know if it works and I will think of a permanent fix.","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/790445881/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/790474300","html_url":"https://github.com/google-research/google-research/issues/583#issuecomment-790474300","issue_url":"https://api.github.com/repos/google-research/google-research/issues/583","id":790474300,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MDQ3NDMwMA==","user":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false},"created_at":"2021-03-04T09:35:55Z","updated_at":"2021-03-04T09:35:55Z","author_association":"NONE","body":"Yes, it works! Thank you so much for quick reply and kind help.\r\n\r\nAfter i finished all the inferecen pipeline, i'll cloesd the issue immediately.","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/790474300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/790477457","html_url":"https://github.com/google-research/google-research/issues/583#issuecomment-790477457","issue_url":"https://api.github.com/repos/google-research/google-research/issues/583","id":790477457,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MDQ3NzQ1Nw==","user":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"created_at":"2021-03-04T09:40:12Z","updated_at":"2021-03-04T09:40:12Z","author_association":"CONTRIBUTOR","body":"Thanks @ccpocker. Would you like to contribute a Pull Request with your changes to sample colorizations for single/custom grayscale images? It will be very helpful for others.","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/790477457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false}},{"id":4406988740,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDQwNjk4ODc0MA==","url":"https://api.github.com/repos/google-research/google-research/issues/events/4406988740","actor":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-04T09:40:12Z","performed_via_github_app":null},{"id":4406988752,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ0MDY5ODg3NTI=","url":"https://api.github.com/repos/google-research/google-research/issues/events/4406988752","actor":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-04T09:40:12Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/790501890","html_url":"https://github.com/google-research/google-research/issues/583#issuecomment-790501890","issue_url":"https://api.github.com/repos/google-research/google-research/issues/583","id":790501890,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MDUwMTg5MA==","user":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false},"created_at":"2021-03-04T10:16:45Z","updated_at":"2021-03-04T10:16:45Z","author_association":"NONE","body":"Definitely yes.","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/790501890/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ccpocker","id":24786402,"node_id":"MDQ6VXNlcjI0Nzg2NDAy","avatar_url":"https://avatars.githubusercontent.com/u/24786402?v=4","gravatar_id":"","url":"https://api.github.com/users/ccpocker","html_url":"https://github.com/ccpocker","followers_url":"https://api.github.com/users/ccpocker/followers","following_url":"https://api.github.com/users/ccpocker/following{/other_user}","gists_url":"https://api.github.com/users/ccpocker/gists{/gist_id}","starred_url":"https://api.github.com/users/ccpocker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccpocker/subscriptions","organizations_url":"https://api.github.com/users/ccpocker/orgs","repos_url":"https://api.github.com/users/ccpocker/repos","events_url":"https://api.github.com/users/ccpocker/events{/privacy}","received_events_url":"https://api.github.com/users/ccpocker/received_events","type":"User","site_admin":false}},{"id":4407585214,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ0MDc1ODUyMTQ=","url":"https://api.github.com/repos/google-research/google-research/issues/events/4407585214","actor":{"login":"tensorflow-copybara","id":33434372,"node_id":"MDQ6VXNlcjMzNDM0Mzcy","avatar_url":"https://avatars.githubusercontent.com/u/33434372?v=4","gravatar_id":"","url":"https://api.github.com/users/tensorflow-copybara","html_url":"https://github.com/tensorflow-copybara","followers_url":"https://api.github.com/users/tensorflow-copybara/followers","following_url":"https://api.github.com/users/tensorflow-copybara/following{/other_user}","gists_url":"https://api.github.com/users/tensorflow-copybara/gists{/gist_id}","starred_url":"https://api.github.com/users/tensorflow-copybara/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tensorflow-copybara/subscriptions","organizations_url":"https://api.github.com/users/tensorflow-copybara/orgs","repos_url":"https://api.github.com/users/tensorflow-copybara/repos","events_url":"https://api.github.com/users/tensorflow-copybara/events{/privacy}","received_events_url":"https://api.github.com/users/tensorflow-copybara/received_events","type":"User","site_admin":false},"event":"referenced","commit_id":"856563cba4b03d0921be60d17faa275fb600b61a","commit_url":"https://api.github.com/repos/google-research/google-research/commits/856563cba4b03d0921be60d17faa275fb600b61a","created_at":"2021-03-04T11:43:36Z","performed_via_github_app":null},{"actor":{"login":"xc-csc101","id":54133031,"node_id":"MDQ6VXNlcjU0MTMzMDMx","avatar_url":"https://avatars.githubusercontent.com/u/54133031?v=4","gravatar_id":"","url":"https://api.github.com/users/xc-csc101","html_url":"https://github.com/xc-csc101","followers_url":"https://api.github.com/users/xc-csc101/followers","following_url":"https://api.github.com/users/xc-csc101/following{/other_user}","gists_url":"https://api.github.com/users/xc-csc101/gists{/gist_id}","starred_url":"https://api.github.com/users/xc-csc101/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xc-csc101/subscriptions","organizations_url":"https://api.github.com/users/xc-csc101/orgs","repos_url":"https://api.github.com/users/xc-csc101/repos","events_url":"https://api.github.com/users/xc-csc101/events{/privacy}","received_events_url":"https://api.github.com/users/xc-csc101/received_events","type":"User","site_admin":false},"created_at":"2021-03-10T17:06:40Z","updated_at":"2021-03-10T17:06:40Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/google-research/google-research/issues/619","repository_url":"https://api.github.com/repos/google-research/google-research","labels_url":"https://api.github.com/repos/google-research/google-research/issues/619/labels{/name}","comments_url":"https://api.github.com/repos/google-research/google-research/issues/619/comments","events_url":"https://api.github.com/repos/google-research/google-research/issues/619/events","html_url":"https://github.com/google-research/google-research/issues/619","id":828034959,"node_id":"MDU6SXNzdWU4MjgwMzQ5NTk=","number":619,"title":"Colorization Transformer: About some bad case","user":{"login":"xc-csc101","id":54133031,"node_id":"MDQ6VXNlcjU0MTMzMDMx","avatar_url":"https://avatars.githubusercontent.com/u/54133031?v=4","gravatar_id":"","url":"https://api.github.com/users/xc-csc101","html_url":"https://github.com/xc-csc101","followers_url":"https://api.github.com/users/xc-csc101/followers","following_url":"https://api.github.com/users/xc-csc101/following{/other_user}","gists_url":"https://api.github.com/users/xc-csc101/gists{/gist_id}","starred_url":"https://api.github.com/users/xc-csc101/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xc-csc101/subscriptions","organizations_url":"https://api.github.com/users/xc-csc101/orgs","repos_url":"https://api.github.com/users/xc-csc101/repos","events_url":"https://api.github.com/users/xc-csc101/events{/privacy}","received_events_url":"https://api.github.com/users/xc-csc101/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2021-03-10T16:51:57Z","updated_at":"2021-03-12T06:12:42Z","closed_at":"2021-03-12T06:12:42Z","author_association":"NONE","active_lock_reason":null,"repository":{"id":151619717,"node_id":"MDEwOlJlcG9zaXRvcnkxNTE2MTk3MTc=","name":"google-research","full_name":"google-research/google-research","private":false,"owner":{"login":"google-research","id":43830688,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQzODMwNjg4","avatar_url":"https://avatars.githubusercontent.com/u/43830688?v=4","gravatar_id":"","url":"https://api.github.com/users/google-research","html_url":"https://github.com/google-research","followers_url":"https://api.github.com/users/google-research/followers","following_url":"https://api.github.com/users/google-research/following{/other_user}","gists_url":"https://api.github.com/users/google-research/gists{/gist_id}","starred_url":"https://api.github.com/users/google-research/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/google-research/subscriptions","organizations_url":"https://api.github.com/users/google-research/orgs","repos_url":"https://api.github.com/users/google-research/repos","events_url":"https://api.github.com/users/google-research/events{/privacy}","received_events_url":"https://api.github.com/users/google-research/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/google-research/google-research","description":"Google Research","fork":false,"url":"https://api.github.com/repos/google-research/google-research","forks_url":"https://api.github.com/repos/google-research/google-research/forks","keys_url":"https://api.github.com/repos/google-research/google-research/keys{/key_id}","collaborators_url":"https://api.github.com/repos/google-research/google-research/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/google-research/google-research/teams","hooks_url":"https://api.github.com/repos/google-research/google-research/hooks","issue_events_url":"https://api.github.com/repos/google-research/google-research/issues/events{/number}","events_url":"https://api.github.com/repos/google-research/google-research/events","assignees_url":"https://api.github.com/repos/google-research/google-research/assignees{/user}","branches_url":"https://api.github.com/repos/google-research/google-research/branches{/branch}","tags_url":"https://api.github.com/repos/google-research/google-research/tags","blobs_url":"https://api.github.com/repos/google-research/google-research/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/google-research/google-research/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/google-research/google-research/git/refs{/sha}","trees_url":"https://api.github.com/repos/google-research/google-research/git/trees{/sha}","statuses_url":"https://api.github.com/repos/google-research/google-research/statuses/{sha}","languages_url":"https://api.github.com/repos/google-research/google-research/languages","stargazers_url":"https://api.github.com/repos/google-research/google-research/stargazers","contributors_url":"https://api.github.com/repos/google-research/google-research/contributors","subscribers_url":"https://api.github.com/repos/google-research/google-research/subscribers","subscription_url":"https://api.github.com/repos/google-research/google-research/subscription","commits_url":"https://api.github.com/repos/google-research/google-research/commits{/sha}","git_commits_url":"https://api.github.com/repos/google-research/google-research/git/commits{/sha}","comments_url":"https://api.github.com/repos/google-research/google-research/comments{/number}","issue_comment_url":"https://api.github.com/repos/google-research/google-research/issues/comments{/number}","contents_url":"https://api.github.com/repos/google-research/google-research/contents/{+path}","compare_url":"https://api.github.com/repos/google-research/google-research/compare/{base}...{head}","merges_url":"https://api.github.com/repos/google-research/google-research/merges","archive_url":"https://api.github.com/repos/google-research/google-research/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/google-research/google-research/downloads","issues_url":"https://api.github.com/repos/google-research/google-research/issues{/number}","pulls_url":"https://api.github.com/repos/google-research/google-research/pulls{/number}","milestones_url":"https://api.github.com/repos/google-research/google-research/milestones{/number}","notifications_url":"https://api.github.com/repos/google-research/google-research/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/google-research/google-research/labels{/name}","releases_url":"https://api.github.com/repos/google-research/google-research/releases{/id}","deployments_url":"https://api.github.com/repos/google-research/google-research/deployments","created_at":"2018-10-04T18:42:48Z","updated_at":"2023-01-20T00:41:48Z","pushed_at":"2023-01-19T23:45:46Z","git_url":"git://github.com/google-research/google-research.git","ssh_url":"git@github.com:google-research/google-research.git","clone_url":"https://github.com/google-research/google-research.git","svn_url":"https://github.com/google-research/google-research","homepage":"https://research.google","size":371210,"stargazers_count":26828,"watchers_count":26828,"language":"Jupyter Notebook","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6663,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":904,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["ai","machine-learning","research"],"visibility":"public","forks":6663,"open_issues":904,"watchers":26828,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"@MechCoder \r\nThanks for your impressive work. I first sample som images from the imagenet dataset, when i try to visualize the intermediate images of them at stage one, I find some images are successfully colored, but some are failed. I am confused about it. Could you give me some suggestions?","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/619/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/google-research/google-research/issues/619/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/801898768","html_url":"https://github.com/google-research/google-research/issues/583#issuecomment-801898768","issue_url":"https://api.github.com/repos/google-research/google-research/issues/583","id":801898768,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMTg5ODc2OA==","user":{"login":"stopsilver","id":17037811,"node_id":"MDQ6VXNlcjE3MDM3ODEx","avatar_url":"https://avatars.githubusercontent.com/u/17037811?v=4","gravatar_id":"","url":"https://api.github.com/users/stopsilver","html_url":"https://github.com/stopsilver","followers_url":"https://api.github.com/users/stopsilver/followers","following_url":"https://api.github.com/users/stopsilver/following{/other_user}","gists_url":"https://api.github.com/users/stopsilver/gists{/gist_id}","starred_url":"https://api.github.com/users/stopsilver/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stopsilver/subscriptions","organizations_url":"https://api.github.com/users/stopsilver/orgs","repos_url":"https://api.github.com/users/stopsilver/repos","events_url":"https://api.github.com/users/stopsilver/events{/privacy}","received_events_url":"https://api.github.com/users/stopsilver/received_events","type":"User","site_admin":false},"created_at":"2021-03-18T12:50:19Z","updated_at":"2021-03-18T12:50:19Z","author_association":"NONE","body":"@MechCoder \r\nHello, I'm trying to colorize custom images using Coltran. I checked 'colorizer', 'color_upsampler', and 'spatial_upsampler' codes are all working without any error and also checked that each pretrained model is loaded. (checked by `Restoring from ~` and `Producing sample after ### training steps` messages)\r\n\r\nBut my problem is that colorization doesn't work. My output files(after each steep) only contain bw image with 3 channels. For example, output of coltran_core model has ['parallel', 'auto_sample', 'proba'] keys and 'parallel', 'auto_sample' are gray image in (64, 64, 3) shape. I used gray as input.\r\n\r\nAny advice?","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/801898768/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"stopsilver","id":17037811,"node_id":"MDQ6VXNlcjE3MDM3ODEx","avatar_url":"https://avatars.githubusercontent.com/u/17037811?v=4","gravatar_id":"","url":"https://api.github.com/users/stopsilver","html_url":"https://github.com/stopsilver","followers_url":"https://api.github.com/users/stopsilver/followers","following_url":"https://api.github.com/users/stopsilver/following{/other_user}","gists_url":"https://api.github.com/users/stopsilver/gists{/gist_id}","starred_url":"https://api.github.com/users/stopsilver/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stopsilver/subscriptions","organizations_url":"https://api.github.com/users/stopsilver/orgs","repos_url":"https://api.github.com/users/stopsilver/repos","events_url":"https://api.github.com/users/stopsilver/events{/privacy}","received_events_url":"https://api.github.com/users/stopsilver/received_events","type":"User","site_admin":false}},{"id":4475862139,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDQ3NTg2MjEzOQ==","url":"https://api.github.com/repos/google-research/google-research/issues/events/4475862139","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-18T12:50:20Z","performed_via_github_app":null},{"id":4475862143,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ0NzU4NjIxNDM=","url":"https://api.github.com/repos/google-research/google-research/issues/events/4475862143","actor":{"login":"MechCoder","id":1867024,"node_id":"MDQ6VXNlcjE4NjcwMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1867024?v=4","gravatar_id":"","url":"https://api.github.com/users/MechCoder","html_url":"https://github.com/MechCoder","followers_url":"https://api.github.com/users/MechCoder/followers","following_url":"https://api.github.com/users/MechCoder/following{/other_user}","gists_url":"https://api.github.com/users/MechCoder/gists{/gist_id}","starred_url":"https://api.github.com/users/MechCoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MechCoder/subscriptions","organizations_url":"https://api.github.com/users/MechCoder/orgs","repos_url":"https://api.github.com/users/MechCoder/repos","events_url":"https://api.github.com/users/MechCoder/events{/privacy}","received_events_url":"https://api.github.com/users/MechCoder/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-18T12:50:20Z","performed_via_github_app":null}]