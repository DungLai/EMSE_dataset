[{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/1092304289","html_url":"https://github.com/google-research/google-research/issues/1060#issuecomment-1092304289","issue_url":"https://api.github.com/repos/google-research/google-research/issues/1060","id":1092304289,"node_id":"IC_kwDOCQmIhc5BGz2h","user":{"login":"ajayjain","id":921393,"node_id":"MDQ6VXNlcjkyMTM5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/921393?v=4","gravatar_id":"","url":"https://api.github.com/users/ajayjain","html_url":"https://github.com/ajayjain","followers_url":"https://api.github.com/users/ajayjain/followers","following_url":"https://api.github.com/users/ajayjain/following{/other_user}","gists_url":"https://api.github.com/users/ajayjain/gists{/gist_id}","starred_url":"https://api.github.com/users/ajayjain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajayjain/subscriptions","organizations_url":"https://api.github.com/users/ajayjain/orgs","repos_url":"https://api.github.com/users/ajayjain/repos","events_url":"https://api.github.com/users/ajayjain/events{/privacy}","received_events_url":"https://api.github.com/users/ajayjain/received_events","type":"User","site_admin":false},"created_at":"2022-04-07T23:42:17Z","updated_at":"2022-04-07T23:42:17Z","author_association":"CONTRIBUTOR","body":"Hi @derrick-xwp, I don't see this error with our Colab notebook. Could you provide a full stack trace? Are you running the code on your own server?","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/1092304289/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ajayjain","id":921393,"node_id":"MDQ6VXNlcjkyMTM5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/921393?v=4","gravatar_id":"","url":"https://api.github.com/users/ajayjain","html_url":"https://github.com/ajayjain","followers_url":"https://api.github.com/users/ajayjain/followers","following_url":"https://api.github.com/users/ajayjain/following{/other_user}","gists_url":"https://api.github.com/users/ajayjain/gists{/gist_id}","starred_url":"https://api.github.com/users/ajayjain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajayjain/subscriptions","organizations_url":"https://api.github.com/users/ajayjain/orgs","repos_url":"https://api.github.com/users/ajayjain/repos","events_url":"https://api.github.com/users/ajayjain/events{/privacy}","received_events_url":"https://api.github.com/users/ajayjain/received_events","type":"User","site_admin":false}},{"id":6392636468,"node_id":"MEE_lADOCQmIhc5HK61WzwAAAAF9B-Q0","url":"https://api.github.com/repos/google-research/google-research/issues/events/6392636468","actor":{"login":"derrick-xwp","id":53371723,"node_id":"MDQ6VXNlcjUzMzcxNzIz","avatar_url":"https://avatars.githubusercontent.com/u/53371723?v=4","gravatar_id":"","url":"https://api.github.com/users/derrick-xwp","html_url":"https://github.com/derrick-xwp","followers_url":"https://api.github.com/users/derrick-xwp/followers","following_url":"https://api.github.com/users/derrick-xwp/following{/other_user}","gists_url":"https://api.github.com/users/derrick-xwp/gists{/gist_id}","starred_url":"https://api.github.com/users/derrick-xwp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/derrick-xwp/subscriptions","organizations_url":"https://api.github.com/users/derrick-xwp/orgs","repos_url":"https://api.github.com/users/derrick-xwp/repos","events_url":"https://api.github.com/users/derrick-xwp/events{/privacy}","received_events_url":"https://api.github.com/users/derrick-xwp/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-04-07T23:42:17Z","performed_via_github_app":null},{"id":6392636471,"node_id":"SE_lADOCQmIhc5HK61WzwAAAAF9B-Q3","url":"https://api.github.com/repos/google-research/google-research/issues/events/6392636471","actor":{"login":"derrick-xwp","id":53371723,"node_id":"MDQ6VXNlcjUzMzcxNzIz","avatar_url":"https://avatars.githubusercontent.com/u/53371723?v=4","gravatar_id":"","url":"https://api.github.com/users/derrick-xwp","html_url":"https://github.com/derrick-xwp","followers_url":"https://api.github.com/users/derrick-xwp/followers","following_url":"https://api.github.com/users/derrick-xwp/following{/other_user}","gists_url":"https://api.github.com/users/derrick-xwp/gists{/gist_id}","starred_url":"https://api.github.com/users/derrick-xwp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/derrick-xwp/subscriptions","organizations_url":"https://api.github.com/users/derrick-xwp/orgs","repos_url":"https://api.github.com/users/derrick-xwp/repos","events_url":"https://api.github.com/users/derrick-xwp/events{/privacy}","received_events_url":"https://api.github.com/users/derrick-xwp/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-04-07T23:42:17Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/1176044694","html_url":"https://github.com/google-research/google-research/issues/1060#issuecomment-1176044694","issue_url":"https://api.github.com/repos/google-research/google-research/issues/1060","id":1176044694,"node_id":"IC_kwDOCQmIhc5GGQSW","user":{"login":"zloc-alz","id":100560065,"node_id":"U_kgDOBf5swQ","avatar_url":"https://avatars.githubusercontent.com/u/100560065?v=4","gravatar_id":"","url":"https://api.github.com/users/zloc-alz","html_url":"https://github.com/zloc-alz","followers_url":"https://api.github.com/users/zloc-alz/followers","following_url":"https://api.github.com/users/zloc-alz/following{/other_user}","gists_url":"https://api.github.com/users/zloc-alz/gists{/gist_id}","starred_url":"https://api.github.com/users/zloc-alz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zloc-alz/subscriptions","organizations_url":"https://api.github.com/users/zloc-alz/orgs","repos_url":"https://api.github.com/users/zloc-alz/repos","events_url":"https://api.github.com/users/zloc-alz/events{/privacy}","received_events_url":"https://api.github.com/users/zloc-alz/received_events","type":"User","site_admin":false},"created_at":"2022-07-06T10:15:53Z","updated_at":"2022-07-06T10:15:53Z","author_association":"NONE","body":"I have the same issue when running on our own server. \r\nFull stacktrace looks like this:\r\n```\r\nTraceback (most recent call last):\r\n  File \"run.py\", line 136, in <module>\r\n    run(train=lib.run_train, eval=lib.run_eval)\r\n  File \"run.py\", line 132, in run\r\n    app.run(functools.partial(main, executable_dict))\r\n  File \"/home/jovyan/.conda_envs/dreamfieldsgg/lib/python3.7/site-packages/absl/app.py\", line 312, in run\r\n    _run_main(main, args)\r\n  File \"/home/jovyan/.conda_envs/dreamfieldsgg/lib/python3.7/site-packages/absl/app.py\", line 258, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"run.py\", line 124, in main\r\n    **extra_args)\r\n  File \"/home/jovyan/alz/dreamfields_gg/gh/dreamfields/dreamfields/lib.py\", line 809, in run_train\r\n    yield_results=False):\r\n  File \"/home/jovyan/alz/dreamfields_gg/gh/dreamfields/dreamfields/lib.py\", line 426, in run_train\r\n    state, rays_in, keys_pstep, lrs, scs, sns, mrs, betas, accts, acclams)\r\n  File \"/home/jovyan/alz/dreamfields_gg/gh/dreamfields/dreamfields/lib.py\", line 220, in train_step\r\n    state, aux = body_fn(state, np.squeeze(multistep_constants))\r\n  File \"/home/jovyan/alz/dreamfields_gg/gh/dreamfields/dreamfields/lib.py\", line 209, in body_fn\r\n    (_, aux), grad = grad_fn(state.target, grad_fn_key, *step_constants)\r\n  File \"/home/jovyan/alz/dreamfields_gg/gh/dreamfields/dreamfields/lib.py\", line 151, in loss_fn\r\n    augs = augment.augment_rendering(config, rgb_est, acc_est, aug_key)\r\n  File \"/home/jovyan/alz/dreamfields_gg/gh/dreamfields/dreamfields/augment.py\", line 144, in augment_rendering\r\n    return jax.vmap(random_aug)(random.split(key, config.n_local_aug))\r\n  File \"/home/jovyan/alz/dreamfields_gg/gh/dreamfields/dreamfields/augment.py\", line 139, in random_aug\r\n    bg = random_bg(bg_key)\r\n  File \"/home/jovyan/alz/dreamfields_gg/gh/dreamfields/dreamfields/augment.py\", line 96, in random_bg\r\n    bg = random.choice(bg_sel_key, bgs, p=np.array(probs))\r\n  File \"/home/jovyan/.conda_envs/dreamfieldsgg/lib/python3.7/site-packages/jax/_src/random.py\", line 459, in choice\r\n    raise ValueError(\"a must be an integer or 1-dimensional\")\r\nValueError: a must be an integer or 1-dimensional\r\n```","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/1176044694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zloc-alz","id":100560065,"node_id":"U_kgDOBf5swQ","avatar_url":"https://avatars.githubusercontent.com/u/100560065?v=4","gravatar_id":"","url":"https://api.github.com/users/zloc-alz","html_url":"https://github.com/zloc-alz","followers_url":"https://api.github.com/users/zloc-alz/followers","following_url":"https://api.github.com/users/zloc-alz/following{/other_user}","gists_url":"https://api.github.com/users/zloc-alz/gists{/gist_id}","starred_url":"https://api.github.com/users/zloc-alz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zloc-alz/subscriptions","organizations_url":"https://api.github.com/users/zloc-alz/orgs","repos_url":"https://api.github.com/users/zloc-alz/repos","events_url":"https://api.github.com/users/zloc-alz/events{/privacy}","received_events_url":"https://api.github.com/users/zloc-alz/received_events","type":"User","site_admin":false}}]