[{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/797656303","html_url":"https://github.com/google-research/google-research/issues/626#issuecomment-797656303","issue_url":"https://api.github.com/repos/google-research/google-research/issues/626","id":797656303,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzY1NjMwMw==","user":{"login":"afathi3","id":1303096,"node_id":"MDQ6VXNlcjEzMDMwOTY=","avatar_url":"https://avatars.githubusercontent.com/u/1303096?v=4","gravatar_id":"","url":"https://api.github.com/users/afathi3","html_url":"https://github.com/afathi3","followers_url":"https://api.github.com/users/afathi3/followers","following_url":"https://api.github.com/users/afathi3/following{/other_user}","gists_url":"https://api.github.com/users/afathi3/gists{/gist_id}","starred_url":"https://api.github.com/users/afathi3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/afathi3/subscriptions","organizations_url":"https://api.github.com/users/afathi3/orgs","repos_url":"https://api.github.com/users/afathi3/repos","events_url":"https://api.github.com/users/afathi3/events{/privacy}","received_events_url":"https://api.github.com/users/afathi3/received_events","type":"User","site_admin":false},"created_at":"2021-03-12T17:55:32Z","updated_at":"2021-03-12T17:55:32Z","author_association":"NONE","body":"Hi @FrancescoMandru,\r\n\r\nThis is the function that is used for voxelization:\r\nhttps://github.com/google-research/google-research/blob/master/tf3d/utils/voxel_utils.py#L305\r\n\r\nThis is the function for going back to point cloud from voxels:\r\nhttps://github.com/google-research/google-research/blob/master/tf3d/utils/voxel_utils.py#L373\r\n\r\nLet us know if you have more questions.\r\n","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/797656303/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"afathi3","id":1303096,"node_id":"MDQ6VXNlcjEzMDMwOTY=","avatar_url":"https://avatars.githubusercontent.com/u/1303096?v=4","gravatar_id":"","url":"https://api.github.com/users/afathi3","html_url":"https://github.com/afathi3","followers_url":"https://api.github.com/users/afathi3/followers","following_url":"https://api.github.com/users/afathi3/following{/other_user}","gists_url":"https://api.github.com/users/afathi3/gists{/gist_id}","starred_url":"https://api.github.com/users/afathi3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/afathi3/subscriptions","organizations_url":"https://api.github.com/users/afathi3/orgs","repos_url":"https://api.github.com/users/afathi3/repos","events_url":"https://api.github.com/users/afathi3/events{/privacy}","received_events_url":"https://api.github.com/users/afathi3/received_events","type":"User","site_admin":false}},{"id":4451977573,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDQ1MTk3NzU3Mw==","url":"https://api.github.com/repos/google-research/google-research/issues/events/4451977573","actor":{"login":"FrancescoMandru","id":43784964,"node_id":"MDQ6VXNlcjQzNzg0OTY0","avatar_url":"https://avatars.githubusercontent.com/u/43784964?v=4","gravatar_id":"","url":"https://api.github.com/users/FrancescoMandru","html_url":"https://github.com/FrancescoMandru","followers_url":"https://api.github.com/users/FrancescoMandru/followers","following_url":"https://api.github.com/users/FrancescoMandru/following{/other_user}","gists_url":"https://api.github.com/users/FrancescoMandru/gists{/gist_id}","starred_url":"https://api.github.com/users/FrancescoMandru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FrancescoMandru/subscriptions","organizations_url":"https://api.github.com/users/FrancescoMandru/orgs","repos_url":"https://api.github.com/users/FrancescoMandru/repos","events_url":"https://api.github.com/users/FrancescoMandru/events{/privacy}","received_events_url":"https://api.github.com/users/FrancescoMandru/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-12T17:55:32Z","performed_via_github_app":null},{"id":4451977575,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ0NTE5Nzc1NzU=","url":"https://api.github.com/repos/google-research/google-research/issues/events/4451977575","actor":{"login":"FrancescoMandru","id":43784964,"node_id":"MDQ6VXNlcjQzNzg0OTY0","avatar_url":"https://avatars.githubusercontent.com/u/43784964?v=4","gravatar_id":"","url":"https://api.github.com/users/FrancescoMandru","html_url":"https://github.com/FrancescoMandru","followers_url":"https://api.github.com/users/FrancescoMandru/followers","following_url":"https://api.github.com/users/FrancescoMandru/following{/other_user}","gists_url":"https://api.github.com/users/FrancescoMandru/gists{/gist_id}","starred_url":"https://api.github.com/users/FrancescoMandru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FrancescoMandru/subscriptions","organizations_url":"https://api.github.com/users/FrancescoMandru/orgs","repos_url":"https://api.github.com/users/FrancescoMandru/repos","events_url":"https://api.github.com/users/FrancescoMandru/events{/privacy}","received_events_url":"https://api.github.com/users/FrancescoMandru/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-12T17:55:32Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/808709303","html_url":"https://github.com/google-research/google-research/issues/626#issuecomment-808709303","issue_url":"https://api.github.com/repos/google-research/google-research/issues/626","id":808709303,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODcwOTMwMw==","user":{"login":"FrancescoMandru","id":43784964,"node_id":"MDQ6VXNlcjQzNzg0OTY0","avatar_url":"https://avatars.githubusercontent.com/u/43784964?v=4","gravatar_id":"","url":"https://api.github.com/users/FrancescoMandru","html_url":"https://github.com/FrancescoMandru","followers_url":"https://api.github.com/users/FrancescoMandru/followers","following_url":"https://api.github.com/users/FrancescoMandru/following{/other_user}","gists_url":"https://api.github.com/users/FrancescoMandru/gists{/gist_id}","starred_url":"https://api.github.com/users/FrancescoMandru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FrancescoMandru/subscriptions","organizations_url":"https://api.github.com/users/FrancescoMandru/orgs","repos_url":"https://api.github.com/users/FrancescoMandru/repos","events_url":"https://api.github.com/users/FrancescoMandru/events{/privacy}","received_events_url":"https://api.github.com/users/FrancescoMandru/received_events","type":"User","site_admin":false},"created_at":"2021-03-27T10:39:30Z","updated_at":"2021-03-27T13:06:44Z","author_association":"NONE","body":"Thank you @afathi3. I opened a new issue asking you if you can provide a detailed example from scratch about the usage of tf3d. Anyway. Suppose I have a LiDAR dataset (x,y,z,r) where r is the reflectance, this comes from semantic KITTI (which is not a dataset considered on this repository), and I have labels associated to each of these points. What I would like to do is using your U-Net to perform semantic segmentation or in general to use the sparse convolution. So the first thing is voxelize the input point cloud and the corresponding labels, I show you my attempt:\r\n\r\n```\r\n    data_root = \"../data/sequences\"\r\n    data = glob.glob(os.path.join(data_root, \"00/velodyne/*.bin\"))\r\n    labels = glob.glob(os.path.join(data_root, \"00/labels/*.label\"))\r\n\r\n    ptc = load_velo_scan(data[0])\r\n    lab = load_velo_label(labels[0])\r\n\r\n    lab = tf.constant(lab, dtype=tf.int32)\r\n    # lab = instance_segmentation_utils.map_labels_to_0_to_n(lab) ---> TOO SLOW\r\n    #voxel_lab = preprocessor_utils.voxelize_semantic_labels(lab, None, (0.5, 0.5, 0.5)) --> DON'T KNOW HOW IT WORKS (Cannot convert 'object_class_points' to EagerTensor of dtype int32)\r\n\r\n    # Encode 3D coordinates\r\n    points = tf.expand_dims(tf.constant(ptc[:, 0:3], dtype=tf.float32), axis=0)\r\n    # Encode reflectance\r\n    features = tf.expand_dims(tf.constant(ptc[:, 3], dtype=tf.float32), axis=0)\r\n    features = tf.expand_dims(features, axis=-1)\r\n    num_valid_points = tf.constant([len(ptc)], dtype=tf.int32)\r\n    grid_cell_size = (0.5, 0.5, 0.5)\r\n    (voxel_features, voxel_indices, num_valid_voxels, segment_ids,\r\n     voxel_start_locations) = voxel_utils.pointcloud_to_sparse_voxel_grid(\r\n        points=points,\r\n        features=features,\r\n        num_valid_points=num_valid_points,\r\n        grid_cell_size=grid_cell_size,\r\n        voxels_pad_or_clip_size=None,\r\n        segment_func=tf.math.unsorted_segment_max)\r\n```","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/808709303/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"FrancescoMandru","id":43784964,"node_id":"MDQ6VXNlcjQzNzg0OTY0","avatar_url":"https://avatars.githubusercontent.com/u/43784964?v=4","gravatar_id":"","url":"https://api.github.com/users/FrancescoMandru","html_url":"https://github.com/FrancescoMandru","followers_url":"https://api.github.com/users/FrancescoMandru/followers","following_url":"https://api.github.com/users/FrancescoMandru/following{/other_user}","gists_url":"https://api.github.com/users/FrancescoMandru/gists{/gist_id}","starred_url":"https://api.github.com/users/FrancescoMandru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FrancescoMandru/subscriptions","organizations_url":"https://api.github.com/users/FrancescoMandru/orgs","repos_url":"https://api.github.com/users/FrancescoMandru/repos","events_url":"https://api.github.com/users/FrancescoMandru/events{/privacy}","received_events_url":"https://api.github.com/users/FrancescoMandru/received_events","type":"User","site_admin":false}},{"id":4516928806,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDUxNjkyODgwNg==","url":"https://api.github.com/repos/google-research/google-research/issues/events/4516928806","actor":{"login":"afathi3","id":1303096,"node_id":"MDQ6VXNlcjEzMDMwOTY=","avatar_url":"https://avatars.githubusercontent.com/u/1303096?v=4","gravatar_id":"","url":"https://api.github.com/users/afathi3","html_url":"https://github.com/afathi3","followers_url":"https://api.github.com/users/afathi3/followers","following_url":"https://api.github.com/users/afathi3/following{/other_user}","gists_url":"https://api.github.com/users/afathi3/gists{/gist_id}","starred_url":"https://api.github.com/users/afathi3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/afathi3/subscriptions","organizations_url":"https://api.github.com/users/afathi3/orgs","repos_url":"https://api.github.com/users/afathi3/repos","events_url":"https://api.github.com/users/afathi3/events{/privacy}","received_events_url":"https://api.github.com/users/afathi3/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-27T10:39:30Z","performed_via_github_app":null},{"id":4516928807,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1MTY5Mjg4MDc=","url":"https://api.github.com/repos/google-research/google-research/issues/events/4516928807","actor":{"login":"afathi3","id":1303096,"node_id":"MDQ6VXNlcjEzMDMwOTY=","avatar_url":"https://avatars.githubusercontent.com/u/1303096?v=4","gravatar_id":"","url":"https://api.github.com/users/afathi3","html_url":"https://github.com/afathi3","followers_url":"https://api.github.com/users/afathi3/followers","following_url":"https://api.github.com/users/afathi3/following{/other_user}","gists_url":"https://api.github.com/users/afathi3/gists{/gist_id}","starred_url":"https://api.github.com/users/afathi3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/afathi3/subscriptions","organizations_url":"https://api.github.com/users/afathi3/orgs","repos_url":"https://api.github.com/users/afathi3/repos","events_url":"https://api.github.com/users/afathi3/events{/privacy}","received_events_url":"https://api.github.com/users/afathi3/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-27T10:39:30Z","performed_via_github_app":null}]