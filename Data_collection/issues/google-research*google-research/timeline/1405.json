[{"id":7927939636,"node_id":"MEE_lADOCQmIhc5XpKGFzwAAAAHYisI0","url":"https://api.github.com/repos/google-research/google-research/issues/events/7927939636","actor":{"login":"vanzytay","id":19285148,"node_id":"MDQ6VXNlcjE5Mjg1MTQ4","avatar_url":"https://avatars.githubusercontent.com/u/19285148?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzytay","html_url":"https://github.com/vanzytay","followers_url":"https://api.github.com/users/vanzytay/followers","following_url":"https://api.github.com/users/vanzytay/following{/other_user}","gists_url":"https://api.github.com/users/vanzytay/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzytay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzytay/subscriptions","organizations_url":"https://api.github.com/users/vanzytay/orgs","repos_url":"https://api.github.com/users/vanzytay/repos","events_url":"https://api.github.com/users/vanzytay/events{/privacy}","received_events_url":"https://api.github.com/users/vanzytay/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-12-01T03:58:00Z","performed_via_github_app":null},{"id":7927939638,"node_id":"SE_lADOCQmIhc5XpKGFzwAAAAHYisI2","url":"https://api.github.com/repos/google-research/google-research/issues/events/7927939638","actor":{"login":"vanzytay","id":19285148,"node_id":"MDQ6VXNlcjE5Mjg1MTQ4","avatar_url":"https://avatars.githubusercontent.com/u/19285148?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzytay","html_url":"https://github.com/vanzytay","followers_url":"https://api.github.com/users/vanzytay/followers","following_url":"https://api.github.com/users/vanzytay/following{/other_user}","gists_url":"https://api.github.com/users/vanzytay/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzytay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzytay/subscriptions","organizations_url":"https://api.github.com/users/vanzytay/orgs","repos_url":"https://api.github.com/users/vanzytay/repos","events_url":"https://api.github.com/users/vanzytay/events{/privacy}","received_events_url":"https://api.github.com/users/vanzytay/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-12-01T03:58:00Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/1336323973","html_url":"https://github.com/google-research/google-research/issues/1405#issuecomment-1336323973","issue_url":"https://api.github.com/repos/google-research/google-research/issues/1405","id":1336323973,"node_id":"IC_kwDOCQmIhc5Ppq-F","user":{"login":"conceptofmind","id":25208228,"node_id":"MDQ6VXNlcjI1MjA4MjI4","avatar_url":"https://avatars.githubusercontent.com/u/25208228?v=4","gravatar_id":"","url":"https://api.github.com/users/conceptofmind","html_url":"https://github.com/conceptofmind","followers_url":"https://api.github.com/users/conceptofmind/followers","following_url":"https://api.github.com/users/conceptofmind/following{/other_user}","gists_url":"https://api.github.com/users/conceptofmind/gists{/gist_id}","starred_url":"https://api.github.com/users/conceptofmind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/conceptofmind/subscriptions","organizations_url":"https://api.github.com/users/conceptofmind/orgs","repos_url":"https://api.github.com/users/conceptofmind/repos","events_url":"https://api.github.com/users/conceptofmind/events{/privacy}","received_events_url":"https://api.github.com/users/conceptofmind/received_events","type":"User","site_admin":false},"created_at":"2022-12-04T05:10:21Z","updated_at":"2022-12-04T05:10:21Z","author_association":"NONE","body":"Fortunately, a peer was able to provide me with the code for the full ul2 objective.\r\n\r\n```python\r\n# found this function and modified from https://github.com/GoogleCloudPlatform/t5x-on-vertex-ai/blob/main/tasks/custom_tasks.py#L78\r\n# UL2 paper appendix code missed this function\r\ndef prepend_prompt(dataset: tf.data.Dataset,\r\n                   output_features: seqio.preprocessors.OutputFeaturesType,\r\n                   sequence_length: Optional[\r\n                       seqio.preprocessors.SequenceLengthType] = None,\r\n                   prompt_mode: str = \"\",\r\n                   key: str = \"inputs\",\r\n                   mode: str = \"\") -> tf.data.Dataset:\r\n    \"\"\"Prepends a prompt at the beginning of an input sequence.\"\"\"\r\n    del sequence_length\r\n    if prompt_mode and mode:\r\n        # output_features may not have inputs key\r\n        out_keys = list(output_features.keys())\r\n        prompt_tokens = output_features[out_keys[0]\r\n                                        ].vocabulary.encode_tf(prompt_mode)\r\n\r\n        def add_to_inputs(x):\r\n            x[key] = tf.concat([prompt_tokens, x[key]], axis=0)\r\n            return x\r\n\r\n        dataset = dataset.map(add_to_inputs)\r\n    return dataset\r\n```","reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/comments/1336323973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"conceptofmind","id":25208228,"node_id":"MDQ6VXNlcjI1MjA4MjI4","avatar_url":"https://avatars.githubusercontent.com/u/25208228?v=4","gravatar_id":"","url":"https://api.github.com/users/conceptofmind","html_url":"https://github.com/conceptofmind","followers_url":"https://api.github.com/users/conceptofmind/followers","following_url":"https://api.github.com/users/conceptofmind/following{/other_user}","gists_url":"https://api.github.com/users/conceptofmind/gists{/gist_id}","starred_url":"https://api.github.com/users/conceptofmind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/conceptofmind/subscriptions","organizations_url":"https://api.github.com/users/conceptofmind/orgs","repos_url":"https://api.github.com/users/conceptofmind/repos","events_url":"https://api.github.com/users/conceptofmind/events{/privacy}","received_events_url":"https://api.github.com/users/conceptofmind/received_events","type":"User","site_admin":false}},{"id":7947601240,"node_id":"CE_lADOCQmIhc5XpKGFzwAAAAHZtsVY","url":"https://api.github.com/repos/google-research/google-research/issues/events/7947601240","actor":{"login":"conceptofmind","id":25208228,"node_id":"MDQ6VXNlcjI1MjA4MjI4","avatar_url":"https://avatars.githubusercontent.com/u/25208228?v=4","gravatar_id":"","url":"https://api.github.com/users/conceptofmind","html_url":"https://github.com/conceptofmind","followers_url":"https://api.github.com/users/conceptofmind/followers","following_url":"https://api.github.com/users/conceptofmind/following{/other_user}","gists_url":"https://api.github.com/users/conceptofmind/gists{/gist_id}","starred_url":"https://api.github.com/users/conceptofmind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/conceptofmind/subscriptions","organizations_url":"https://api.github.com/users/conceptofmind/orgs","repos_url":"https://api.github.com/users/conceptofmind/repos","events_url":"https://api.github.com/users/conceptofmind/events{/privacy}","received_events_url":"https://api.github.com/users/conceptofmind/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-12-04T05:10:31Z","state_reason":null,"performed_via_github_app":null}]