{"url":"https://api.github.com/repos/google-research/google-research/issues/605","repository_url":"https://api.github.com/repos/google-research/google-research","labels_url":"https://api.github.com/repos/google-research/google-research/issues/605/labels{/name}","comments_url":"https://api.github.com/repos/google-research/google-research/issues/605/comments","events_url":"https://api.github.com/repos/google-research/google-research/issues/605/events","html_url":"https://github.com/google-research/google-research/issues/605","id":822785029,"node_id":"MDU6SXNzdWU4MjI3ODUwMjk=","number":605,"title":"[TFT] Input data include label?","user":{"login":"avpeiron","id":38582128,"node_id":"MDQ6VXNlcjM4NTgyMTI4","avatar_url":"https://avatars.githubusercontent.com/u/38582128?v=4","gravatar_id":"","url":"https://api.github.com/users/avpeiron","html_url":"https://github.com/avpeiron","followers_url":"https://api.github.com/users/avpeiron/followers","following_url":"https://api.github.com/users/avpeiron/following{/other_user}","gists_url":"https://api.github.com/users/avpeiron/gists{/gist_id}","starred_url":"https://api.github.com/users/avpeiron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avpeiron/subscriptions","organizations_url":"https://api.github.com/users/avpeiron/orgs","repos_url":"https://api.github.com/users/avpeiron/repos","events_url":"https://api.github.com/users/avpeiron/events{/privacy}","received_events_url":"https://api.github.com/users/avpeiron/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-03-05T06:18:14Z","updated_at":"2021-11-01T02:22:37Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hello, I am new here and studying the TFT project. \r\nI encounter a problem in _batch_sampled_data() which convert time-series data input model inputs and outputs. \r\n\r\nLet me copy and code in here first.\r\n\r\n```\r\n    id_col = self._get_single_col_by_type(InputTypes.ID)\r\n    time_col = self._get_single_col_by_type(InputTypes.TIME)\r\n    target_col = self._get_single_col_by_type(InputTypes.TARGET)\r\n    input_cols = [\r\n        tup[0]\r\n        for tup in self.column_definition\r\n        if tup[2] not in {InputTypes.ID, InputTypes.TIME}\r\n    ]\r\n\r\n    for i, tup in enumerate(ranges):\r\n      if (i + 1 % 1000) == 0:\r\n        print(i + 1, 'of', max_samples, 'samples done...')\r\n      identifier, start_idx = tup\r\n      sliced = split_data_map[identifier].iloc[start_idx -\r\n                                               self.time_steps:start_idx]\r\n      inputs[i, :, :] = sliced[input_cols]\r\n      outputs[i, :, :] = sliced[[target_col]]\r\n      time[i, :, 0] = sliced[time_col]\r\n      identifiers[i, :, 0] = sliced[id_col]\r\n\r\n    sampled_data = {\r\n        'inputs': inputs,\r\n        'outputs': outputs[:, self.num_encoder_steps:, :],\r\n        'active_entries': np.ones_like(outputs[:, self.num_encoder_steps:, :]),\r\n        'time': time,\r\n        'identifier': identifiers\r\n    }\r\n```\r\n\r\nIn the Volatility dateset, the target_col is 'log_vol' while input_cols are ['log_vol', 'open_to_close', 'days_from_start', 'day_of_week', 'day_of_month', 'week_of_year', 'month', 'Region']\r\n\r\nIt is reasonable to have 'log_vol' in input data as it is the observation of past timestep. \r\nHowever, it is not removed in the period of target. \r\nAs you can see, the outputs is cropped but not inputs in the line of sample_data.\r\n\r\nSo, I am wonder if the label is removed somewhere else? If not, then it seems strange to include the label in inputs? \r\n\r\nThank you for your attentions. ","closed_by":null,"reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/605/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/google-research/google-research/issues/605/timeline","performed_via_github_app":null,"state_reason":null}