{"url":"https://api.github.com/repos/google-research/google-research/issues/158","repository_url":"https://api.github.com/repos/google-research/google-research","labels_url":"https://api.github.com/repos/google-research/google-research/issues/158/labels{/name}","comments_url":"https://api.github.com/repos/google-research/google-research/issues/158/comments","events_url":"https://api.github.com/repos/google-research/google-research/issues/158/events","html_url":"https://github.com/google-research/google-research/issues/158","id":530429782,"node_id":"MDU6SXNzdWU1MzA0Mjk3ODI=","number":158,"title":"[dual_pixels] pgm files not saved on my pixel 3a ","user":{"login":"jimmy899","id":195527,"node_id":"MDQ6VXNlcjE5NTUyNw==","avatar_url":"https://avatars.githubusercontent.com/u/195527?v=4","gravatar_id":"","url":"https://api.github.com/users/jimmy899","html_url":"https://github.com/jimmy899","followers_url":"https://api.github.com/users/jimmy899/followers","following_url":"https://api.github.com/users/jimmy899/following{/other_user}","gists_url":"https://api.github.com/users/jimmy899/gists{/gist_id}","starred_url":"https://api.github.com/users/jimmy899/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimmy899/subscriptions","organizations_url":"https://api.github.com/users/jimmy899/orgs","repos_url":"https://api.github.com/users/jimmy899/repos","events_url":"https://api.github.com/users/jimmy899/events{/privacy}","received_events_url":"https://api.github.com/users/jimmy899/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-11-29T16:44:40Z","updated_at":"2020-03-10T18:45:59Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I tried to build and run the dual_pixel on my Google Pixel 3a, and the preview of dual pixel works.\r\nbut no matter how many times I push the \"capture\" button, the pgm file are not generated.\r\n\r\nand I try to add the following codes, and I found `onCaptureFailed` occurs on my Pixel 3a.\r\nCan anybody help me to make it works on my phone? Thank you.\r\n\r\n```\r\n     try {\r\n       final CaptureRequest.Builder captureBuilder =\r\n           cameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_STILL_CAPTURE);\r\n       captureBuilder.addTarget(imageReader.getSurface());\r\n       captureBuilder.addTarget(new Surface(viewfinderTextureView.getSurfaceTexture()));\r\n       captureBuilder.set(CaptureRequest.CONTROL_MODE, CameraMetadata.CONTROL_MODE_AUTO);\r\n-      cameraCaptureSession.capture(captureBuilder.build(), null, cameraHandler);\r\n+\r\n+      CameraCaptureSession.CaptureCallback captureCallback = new CameraCaptureSession.CaptureCallback() {\r\n+        @Override\r\n+        public void onCaptureCompleted(CameraCaptureSession session, CaptureRequest request, TotalCaptureResult result) {\r\n+          super.onCaptureCompleted(session, request, result);\r\n+        }\r\n+\r\n+        @Override\r\n+        public void onCaptureStarted(@NonNull CameraCaptureSession session, @NonNull CaptureRequest request, long timestamp, long frameNumber) {\r\n+          super.onCaptureStarted(session, request, timestamp, frameNumber);\r\n+          Log.d(TAG, \"onCaptureStarted\");\r\n+        }\r\n+\r\n+        @Override\r\n+        public void onCaptureFailed(@NonNull CameraCaptureSession session, @NonNull CaptureRequest request, @NonNull CaptureFailure failure) {\r\n+          super.onCaptureFailed(session, request, failure);\r\n+          Log.d(TAG, \"onCaptureFailed:\" + failure.getReason());\r\n+          Log.d(TAG, \"onCaptureFailed:\" + failure.toString());\r\n+        }\r\n          cameraCaptureSession.capture(captureBuilder.build(), captureCallback, cameraHandler);\r\n```\r\n\r\nexcept the above code, I also get many messages in the logcat, but I do not know if that are related to this issue or not.\r\n\r\n```\r\n2019-11-29 23:53:14.685 828-1099/? E/CamX: [ERROR][HAL    ] camxmetadatapool.cpp:1556 SetMetadataByTag() Invalid slot; cannot set metadata tag 80210000\r\n2019-11-29 23:53:14.685 828-1099/? E/CamX: [ERROR][HAL    ] camxmetadatapool.cpp:1720 PublishMetadataList() Invalid slot, cannot publish metadata list\r\n2019-11-29 23:53:14.718 828-1099/? E/CamX: [ERROR][HAL    ] camxmetadatapool.cpp:1556 SetMetadataByTag() Invalid slot; cannot set metadata tag 80210000\r\n2019-11-29 23:53:14.718 828-1099/? E/CamX: [ERROR][HAL    ] camxmetadatapool.cpp:1720 PublishMetadataList() Invalid slot, cannot publish metadata list\r\n```\r\n\r\n```\r\n2019-11-29 23:53:11.553 828-828/? E/CamX: [ERROR][HAL    ] camxmetadatapool.cpp:1556 SetMetadataByTag() Invalid slot; cannot set metadata tag 80090003\r\n2019-11-29 23:53:11.553 828-828/? E/CamX: [ERROR][HAL    ] camxmetadatapool.cpp:1720 PublishMetadataList() Invalid slot, cannot publish metadata list\r\n2019-11-29 23:53:11.553 828-828/? E/CamX: [ERROR][SENSOR ] camxsensornode.cpp:2174 LoadPDlibrary() PD library CreateLib failure result=0, m_pPDLib=0x73e8735040\r\n```\r\n\r\n```\r\n2019-11-29 23:53:17.664 848-1016/? I/sensors-hal: activate_physical_sensor:155, com.google.sensor.camera_vsync/7 en=0\r\n2019-11-29 23:53:17.665 848-1016/? I/sensors-hal: activate_physical_sensor:166, com.google.sensor.camera_vsync/7 en=0 completed\r\n2019-11-29 23:53:17.665 828-828/? I/GoogSensorSync: ~GoogSensorSync 72 Total failure/sync for camera 0: 0/58\r\n```","closed_by":null,"reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/google-research/google-research/issues/158/timeline","performed_via_github_app":null,"state_reason":null}