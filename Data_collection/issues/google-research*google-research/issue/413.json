{"url":"https://api.github.com/repos/google-research/google-research/issues/413","repository_url":"https://api.github.com/repos/google-research/google-research","labels_url":"https://api.github.com/repos/google-research/google-research/issues/413/labels{/name}","comments_url":"https://api.github.com/repos/google-research/google-research/issues/413/comments","events_url":"https://api.github.com/repos/google-research/google-research/issues/413/events","html_url":"https://github.com/google-research/google-research/issues/413","id":717907449,"node_id":"MDU6SXNzdWU3MTc5MDc0NDk=","number":413,"title":"AttributeError: module 'tensorflow.keras.layers' has no attribute 'CuDNNLSTM","user":{"login":"Alla-Abdella","id":19640509,"node_id":"MDQ6VXNlcjE5NjQwNTA5","avatar_url":"https://avatars.githubusercontent.com/u/19640509?v=4","gravatar_id":"","url":"https://api.github.com/users/Alla-Abdella","html_url":"https://github.com/Alla-Abdella","followers_url":"https://api.github.com/users/Alla-Abdella/followers","following_url":"https://api.github.com/users/Alla-Abdella/following{/other_user}","gists_url":"https://api.github.com/users/Alla-Abdella/gists{/gist_id}","starred_url":"https://api.github.com/users/Alla-Abdella/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Alla-Abdella/subscriptions","organizations_url":"https://api.github.com/users/Alla-Abdella/orgs","repos_url":"https://api.github.com/users/Alla-Abdella/repos","events_url":"https://api.github.com/users/Alla-Abdella/events{/privacy}","received_events_url":"https://api.github.com/users/Alla-Abdella/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-10-09T07:00:47Z","updated_at":"2021-12-20T18:14:31Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Selecting GPU ID=0\r\n*** Training from defined parameters for electricity ***\r\nLoading & splitting data...\r\n/usr/local/lib/python3.6/dist-packages/numpy/lib/arraysetops.py:569: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison\r\n  mask |= (ar1 == a)\r\nFormatting train-valid-test splits.\r\nSetting scalers with training data...\r\n*** Loading hyperparm manager ***\r\n*** Running calibration ***\r\nParams Selected:\r\ndropout_rate: 0.1\r\nhidden_layer_size: 5\r\nlearning_rate: 0.001\r\nminibatch_size: 64\r\nmax_gradient_norm: 0.01\r\nnum_heads: 4\r\nstack_size: 1\r\nmodel_folder: data/saved_models/electricity/fixed\r\nWARNING:tensorflow:From /content/google-research/tft/script_train_fixed_params.py:121: The name tf.keras.backend.set_session is deprecated. Please use tf.compat.v1.keras.backend.set_session instead.\r\n\r\nResetting temp folder...\r\n*** TemporalFusionTransformer params ***\r\n# dropout_rate = 0.1\r\n# hidden_layer_size = 5\r\n# learning_rate = 0.001\r\n# max_gradient_norm = 0.01\r\n# minibatch_size = 64\r\n# model_folder = data/saved_models/electricity/fixed\r\n# num_heads = 4\r\n# stack_size = 1\r\n# total_time_steps = 192\r\n# num_encoder_steps = 168\r\n# num_epochs = 1\r\n# early_stopping_patience = 5\r\n# multiprocessing_workers = 5\r\n# column_definition = [('id', <DataTypes.REAL_VALUED: 0>, <InputTypes.ID: 4>), ('hours_from_start', <DataTypes.REAL_VALUED: 0>, <InputTypes.TIME: 5>), ('power_usage', <DataTypes.REAL_VALUED: 0>, <InputTypes.TARGET: 0>), ('hour', <DataTypes.REAL_VALUED: 0>, <InputTypes.KNOWN_INPUT: 2>), ('day_of_week', <DataTypes.REAL_VALUED: 0>, <InputTypes.KNOWN_INPUT: 2>), ('hours_from_start', <DataTypes.REAL_VALUED: 0>, <InputTypes.KNOWN_INPUT: 2>), ('categorical_id', <DataTypes.CATEGORICAL: 1>, <InputTypes.STATIC_INPUT: 3>)]\r\n# input_size = 5\r\n# output_size = 1\r\n# category_counts = [369]\r\n# input_obs_loc = [0]\r\n# static_input_loc = [4]\r\n# known_regular_inputs = [1, 2, 3]\r\n# known_categorical_inputs = [0]\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.6/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/usr/lib/python3.6/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/content/google-research/tft/script_train_fixed_params.py\", line 238, in <module>\r\n    use_testing_mode=True)  # Change to false to use original default params\r\n  File \"/content/google-research/tft/script_train_fixed_params.py\", line 124, in main\r\n    model = ModelClass(params, use_cudnn=use_gpu)\r\n  File \"/content/google-research/tft/libs/tft_model.py\", line 456, in __init__\r\n    self.model = self.build_model()\r\n  File \"/content/google-research/tft/libs/tft_model.py\", line 1006, in build_model\r\n    = self._build_base_graph()\r\n  File \"/content/google-research/tft/libs/tft_model.py\", line 929, in _build_base_graph\r\n    = get_lstm(return_state=True)(historical_features,\r\n  File \"/content/google-research/tft/libs/tft_model.py\", line 907, in get_lstm\r\n    lstm = tf.keras.layers.CuDNNLSTM(\r\nAttributeError: module 'tensorflow.keras.layers' has no attribute 'CuDNNLSTM","closed_by":null,"reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/google-research/google-research/issues/413/timeline","performed_via_github_app":null,"state_reason":null}