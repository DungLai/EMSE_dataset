{"url":"https://api.github.com/repos/google-research/google-research/issues/1138","repository_url":"https://api.github.com/repos/google-research/google-research","labels_url":"https://api.github.com/repos/google-research/google-research/issues/1138/labels{/name}","comments_url":"https://api.github.com/repos/google-research/google-research/issues/1138/comments","events_url":"https://api.github.com/repos/google-research/google-research/issues/1138/events","html_url":"https://github.com/google-research/google-research/issues/1138","id":1253205558,"node_id":"I_kwDOCQmIhc5KsmY2","number":1138,"title":"Perhaps input is empty or misspecified","user":{"login":"robertmckean","id":748085,"node_id":"MDQ6VXNlcjc0ODA4NQ==","avatar_url":"https://avatars.githubusercontent.com/u/748085?v=4","gravatar_id":"","url":"https://api.github.com/users/robertmckean","html_url":"https://github.com/robertmckean","followers_url":"https://api.github.com/users/robertmckean/followers","following_url":"https://api.github.com/users/robertmckean/following{/other_user}","gists_url":"https://api.github.com/users/robertmckean/gists{/gist_id}","starred_url":"https://api.github.com/users/robertmckean/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/robertmckean/subscriptions","organizations_url":"https://api.github.com/users/robertmckean/orgs","repos_url":"https://api.github.com/users/robertmckean/repos","events_url":"https://api.github.com/users/robertmckean/events{/privacy}","received_events_url":"https://api.github.com/users/robertmckean/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-05-31T00:23:13Z","updated_at":"2022-05-31T00:23:13Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I keep getting the following problem when trying to use the train function. I've tried everything I can think of.\r\n\r\nINFO:tensorflow:Saving dict for global step 0: absolute_difference = 0.0, bass_spectrogram = 0.0, drums_spectrogram = 0.0, global_step = 0, loss = 0.0, other_spectrogram = 0.0, vocals_spectrogram = 0.0\r\nINFO:tensorflow:Saving 'checkpoint_path' summary for global step 0: musdb_model\\model.ckpt-0\r\nWARNING:tensorflow:Training with estimator made no steps. Perhaps input is empty or misspecified.\r\nINFO:tensorflow:Loss for final step: None.\r\nINFO:spleeter:Model training done\r\n\r\nI am running on Windows 10. I get the same issue with whatever version of Python/Tensorflow I use. This is my command line:\r\n\r\npython -m spleeter train -p configs/musdb_config.json -d C:\\Python\\spleeter\\configs --verbose\r\n\r\nIs there anything anyone can think of for me to try?\r\n\r\nI added extra print statements to try to track down. Here is the output:\r\n\r\nWe are in:  __main__\r\nEntered entrypoint:  __main__\r\nSomeone called spleeter_callback:   __main__\r\nLet us train:  __main__\r\nINFO:spleeter:Just imported TF\r\nDid this instantiate_pre?\r\nWe are in class InstrumentDatasetBuilder spleeter.dataset\r\nWe are in class class DatasetBuilder spleeter.dataset\r\nDid this instantiate?\r\nINFO:tensorflow:Using config: {'_model_dir': 'musdb_model', '_tf_random_seed': 3, '_save_summary_steps': 5, '_save_checkpoints_steps': 1000, '_save_checkpoints_secs': None, '_session_config': gpu_options {\r\n  per_process_gpu_memory_fraction: 0.45\r\n}\r\n, '_keep_checkpoint_max': 2, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 10, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_checkpoint_save_graph_def': True, '_service': None, '_cluster_spec': ClusterSpec({}), '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}\r\nReady to jump?......\r\nJust jumped?......\r\nINFO:spleeter:Start model training\r\nestimator........:  <tensorflow_estimator.python.estimator.estimator.EstimatorV2 object at 0x0000028688343E50>\r\ntrain_spec.......:  TrainSpec(input_fn=functools.partial(<function get_training_dataset at 0x00000286ABE050D0>, {'train_csv': 'configs/musdb_train.csv', 'validation_csv': 'configs/musdb_validation.csv', 'model_dir': 'musdb_model', 'mix_name': 'mix', 'instrument_list': ['vocals', 'drums', 'bass', 'other'], 'sample_rate': 44100, 'frame_length': 4096, 'frame_step': 1024, 'T': 512, 'F': 1024, 'n_channels': 2, 'n_chunks_per_song': 40, 'separation_exponent': 2, 'mask_extension': 'zeros', 'learning_rate': 0.0001, 'batch_size': 4, 'training_cache': 'cache/training', 'validation_cache': 'cache/validation', 'train_max_steps': 200000, 'throttle_secs': 1800, 'random_seed': 3, 'save_checkpoints_steps': 1000, 'save_summary_steps': 5, 'model': {'type': 'unet.unet', 'params': {'conv_activation': 'ELU', 'deconv_activation': 'ELU'}}}, <spleeter.audio.ffmpeg.FFMPEGProcessAudioAdapter object at 0x0000028688343DC0>, 'C:\\\\Python\\\\spleeter\\\\configs'), max_steps=200000, hooks=(), saving_listeners=())\r\nevaluation_spec..:  EvalSpec(input_fn=functools.partial(<function get_validation_dataset at 0x00000286AD9AA9D0>, {'train_csv': 'configs/musdb_train.csv', 'validation_csv': 'configs/musdb_validation.csv', 'model_dir': 'musdb_model', 'mix_name': 'mix', 'instrument_list': ['vocals', 'drums', 'bass', 'other'], 'sample_rate': 44100, 'frame_length': 4096, 'frame_step': 1024, 'T': 512, 'F': 1024, 'n_channels': 2, 'n_chunks_per_song': 40, 'separation_exponent': 2, 'mask_extension': 'zeros', 'learning_rate': 0.0001, 'batch_size': 4, 'training_cache': 'cache/training', 'validation_cache': 'cache/validation', 'train_max_steps': 200000, 'throttle_secs': 1800, 'random_seed': 3, 'save_checkpoints_steps': 1000, 'save_summary_steps': 5, 'model': {'type': 'unet.unet', 'params': {'conv_activation': 'ELU', 'deconv_activation': 'ELU'}}}, <spleeter.audio.ffmpeg.FFMPEGProcessAudioAdapter object at 0x0000028688343DC0>, 'C:\\\\Python\\\\spleeter\\\\configs'), steps=None, name=None, hooks=(), exporters=(), start_delay_secs=120, throttle_secs=1800)\r\n\r\nINFO:tensorflow:Not using Distribute Coordinator.\r\nINFO:tensorflow:Running training and evaluation locally (non-distributed).\r\nINFO:tensorflow:Start train and evaluate loop. The evaluate will happen after every checkpoint. \r\n        Checkpoint frequency is determined based on RunConfig arguments: \r\n            save_checkpoints_steps 1000 or save_checkpoints_secs None.\r\nWARNING:tensorflow:From C:\\Users\\windo\\anaconda3\\envs\\g397\\lib\\site-packages\\tensorflow\\python\\training\\training_util.py:\r\n                235: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be \r\n                    removed in a future version.\r\nInstructions for updating:\r\nUse Variable.read_value. \r\nVariables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.\r\n\r\nWe are in get_training_dataset:  spleeter.dataset\r\nLoaded from:  C:\\Python\\spleeter\\spleeter\\dataset.py\r\nHere is df:  \r\n                                              mix_path  ...    duration\r\n0    train\\A Classic Education - NightOwl\\mixture.wav  ...  171.247166\r\n1                 train\\ANiMAL - Clinic A\\mixture.wav  ...  237.865215\r\n2               train\\ANiMAL - Easy Tiger\\mixture.wav  ...  205.473379\r\n3           train\\Actions - Devil's Words\\mixture.wav  ...  196.626576\r\n4      train\\Actions - South Of The Water\\mixture.wav  ...  176.610975\r\n..                                                ...  ...         ...\r\n81                train\\Triviul - Dorothy\\mixture.wav  ...  187.361814\r\n82  train\\Voelund - Comfort Lives In Belief\\mixtur...  ...  209.908390\r\n83            train\\Wall Of Death - Femme\\mixture.wav  ...  238.933333\r\n84     train\\Young Griffo - Blood To Bone\\mixture.wav  ...  254.397823\r\n85            train\\Young Griffo - Facade\\mixture.wav  ...  167.857052\r\n\r\n[86 rows x 6 columns]\r\ndataset....................... <TensorSliceDataset shapes: {mix_path: (), vocals_path: (), drums_path: (), bass_path: (), other_path: (), duration: ()}, types: {mix_path: tf.string, vocals_path: tf.string, drums_path: tf.string, bass_path: tf.string, other_path: tf.string, duration: tf.float64}>\r\nLoaded from:  C:\\Python\\spleeter\\spleeter\\utils\\tensor.py\r\ndataset:   <TensorSliceDataset shapes: {mix_path: (), vocals_path: (), drums_path: (), bass_path: (), other_path: (), duration: ()}, types: {mix_path: tf.string, vocals_path: tf.string, drums_path: tf.string, bass_path: tf.string, other_path: tf.string, duration: tf.float64}>\r\ndataset before:  <ShuffleDataset shapes: {mix_path: (), vocals_path: (), drums_path: (), bass_path: (), other_path: (), duration: (), start: ()}, types: {mix_path: tf.string, vocals_path: tf.string, drums_path: tf.string, bass_path: tf.string, other_path: tf.string, duration: tf.float64, start: tf.float64}>\r\nWe are in load_waveform:  spleeter.dataset\r\nWe are in compute_spectrogram:  spleeter.dataset\r\nWe are in compute_spectrogram_tf in:  spleeter.audio.spectrogram\r\nhere is the tensor:   Tensor(\"transpose_1:0\", shape=(None, None, None), dtype=complex64)\r\nWe are in load_waveform:  spleeter.dataset\r\nWe are in compute_spectrogram:  spleeter.dataset\r\nWe are in compute_spectrogram_tf in:  spleeter.audio.spectrogram\r\nhere is the tensor:   Tensor(\"transpose_1:0\", shape=(None, None, None), dtype=complex64)\r\nWe are in load_waveform:  spleeter.dataset\r\nWe are in compute_spectrogram:  spleeter.dataset\r\nWe are in compute_spectrogram_tf in:  spleeter.audio.spectrogram\r\nhere is the tensor:   Tensor(\"transpose_1:0\", shape=(None, None, None), dtype=complex64)\r\nWe are in load_waveform:  spleeter.dataset\r\nWe are in compute_spectrogram:  spleeter.dataset\r\nWe are in compute_spectrogram_tf in:  spleeter.audio.spectrogram\r\nhere is the tensor:   Tensor(\"transpose_1:0\", shape=(None, None, None), dtype=complex64)\r\nWe are in load_waveform:  spleeter.dataset\r\nWe are in compute_spectrogram:  spleeter.dataset\r\nWe are in compute_spectrogram_tf in:  spleeter.audio.spectrogram\r\nhere is the tensor:   Tensor(\"transpose_1:0\", shape=(None, None, None), dtype=complex64)\r\nINFO:tensorflow:Calling model_fn.\r\nWe are in:  spleeter.model\r\nWe are in:  spleeter.model\r\nWe are in:  spleeter.model\r\nWe are in:  spleeter.model\r\nWe are in:  spleeter.model\r\nWe are in:  spleeter.model.functions.unet\r\nWe are in apply_unet:  spleeter.model.functions.unet\r\nINFO:tensorflow:Apply unet for vocals_spectrogram\r\nWe are in _get_conv_activation_layer spleeter.model.functions.unet\r\nWe are in _get_deconv_activation_layer:  spleeter.model.functions.unet\r\nWARNING:tensorflow:From C:\\Users\\windo\\anaconda3\\envs\\g397\\lib\\site-packages\\tensorflow\\python\\keras\\layers\\normalization.py:534: _colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\nWe are in apply_unet:  spleeter.model.functions.unet\r\nINFO:tensorflow:Apply unet for drums_spectrogram\r\nWe are in _get_conv_activation_layer spleeter.model.functions.unet\r\nWe are in _get_deconv_activation_layer:  spleeter.model.functions.unet\r\nWe are in apply_unet:  spleeter.model.functions.unet\r\nINFO:tensorflow:Apply unet for bass_spectrogram\r\nWe are in _get_conv_activation_layer spleeter.model.functions.unet\r\nWe are in _get_deconv_activation_layer:  spleeter.model.functions.unet\r\nWe are in apply_unet:  spleeter.model.functions.unet\r\nINFO:tensorflow:Apply unet for other_spectrogram\r\nWe are in _get_conv_activation_layer spleeter.model.functions.unet\r\nWe are in _get_deconv_activation_layer:  spleeter.model.functions.unet\r\nWe are in:  spleeter.model\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Create CheckpointSaverHook.\r\nINFO:tensorflow:Graph was finalized.\r\nINFO:tensorflow:Restoring parameters from musdb_model\\model.ckpt-0\r\nWARNING:tensorflow:From C:\\Users\\windo\\anaconda3\\envs\\g397\\lib\\site-packages\\tensorflow\\python\\training\\saver.py:1078: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse standard file utilities to get mtimes.\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Calling checkpoint listeners before saving checkpoint 0...\r\nINFO:tensorflow:Saving checkpoints for 0 into musdb_model\\model.ckpt.\r\nINFO:tensorflow:Calling checkpoint listeners after saving checkpoint 0...\r\nWe are in get_validation_dataset:  spleeter.dataset\r\nLoaded from:  C:\\Python\\spleeter\\spleeter\\dataset.py\r\nHere is df:  \r\n                                              mix_path  ...    duration\r\n0                 train\\ANiMAL - Rockshow\\mixture.wav  ...  165.511837\r\n1        train\\Actions - One Minute Smile\\mixture.wav  ...  163.375601\r\n2   train\\Alexander Ross - Goodbye Bolero\\mixture.wav  ...  418.632562\r\n3   train\\Clara Berry And Wooldog - Waltz For My V...  ...  175.240998\r\n4        train\\Fergessen - Nos Palpitants\\mixture.wav  ...  198.228753\r\n5           train\\James May - On The Line\\mixture.wav  ...  256.092880\r\n6    train\\Johnny Lokke - Promises & Lies\\mixture.wav  ...  285.814422\r\n7                train\\Leaf - Summerghost\\mixture.wav  ...  231.804807\r\n8              train\\Meaxic - Take A Step\\mixture.wav  ...  282.517188\r\n9   train\\Patrick Talbot - A Reason To Leave\\mixtu...  ...  259.552653\r\n10        train\\Skelpolu - Human Mistakes\\mixture.wav  ...  324.498866\r\n11      train\\Traffic Experiment - Sirens\\mixture.wav  ...  421.279637\r\n12             train\\Triviul - Angelsaint\\mixture.wav  ...  236.704218\r\n13           train\\Young Griffo - Pennies\\mixture.wav  ...  277.803537\r\n\r\n[14 rows x 6 columns]\r\ndataset....................... <TensorSliceDataset shapes: {mix_path: (), vocals_path: (), drums_path: (), bass_path: (), other_path: (), duration: ()}, types: {mix_path: tf.string, vocals_path: tf.string, drums_path: tf.string, bass_path: tf.string, other_path: tf.string, duration: tf.float64}>\r\nLoaded from:  C:\\Python\\spleeter\\spleeter\\utils\\tensor.py\r\ndataset:   <TensorSliceDataset shapes: {mix_path: (), vocals_path: (), drums_path: (), bass_path: (), other_path: (), duration: ()}, types: {mix_path: tf.string, vocals_path: tf.string, drums_path: tf.string, bass_path: tf.string, other_path: tf.string, duration: tf.float64}>\r\ndataset before:  <MapDataset shapes: {mix_path: (), vocals_path: (), drums_path: (), bass_path: (), other_path: (), duration: (), start: ()}, types: {mix_path: tf.string, vocals_path: tf.string, drums_path: tf.string, bass_path: tf.string, other_path: tf.string, duration: tf.float64, start: tf.float64}>\r\nWe are in load_waveform:  spleeter.dataset\r\nWe are in compute_spectrogram:  spleeter.dataset\r\nWe are in compute_spectrogram_tf in:  spleeter.audio.spectrogram\r\nhere is the tensor:   Tensor(\"transpose_1:0\", shape=(None, None, None), dtype=complex64)\r\nWe are in load_waveform:  spleeter.dataset\r\nWe are in compute_spectrogram:  spleeter.dataset\r\nWe are in compute_spectrogram_tf in:  spleeter.audio.spectrogram\r\nhere is the tensor:   Tensor(\"transpose_1:0\", shape=(None, None, None), dtype=complex64)\r\nWe are in load_waveform:  spleeter.dataset\r\nWe are in compute_spectrogram:  spleeter.dataset\r\nWe are in compute_spectrogram_tf in:  spleeter.audio.spectrogram\r\nhere is the tensor:   Tensor(\"transpose_1:0\", shape=(None, None, None), dtype=complex64)\r\nWe are in load_waveform:  spleeter.dataset\r\nWe are in compute_spectrogram:  spleeter.dataset\r\nWe are in compute_spectrogram_tf in:  spleeter.audio.spectrogram\r\nhere is the tensor:   Tensor(\"transpose_1:0\", shape=(None, None, None), dtype=complex64)\r\nWe are in load_waveform:  spleeter.dataset\r\nWe are in compute_spectrogram:  spleeter.dataset\r\nWe are in compute_spectrogram_tf in:  spleeter.audio.spectrogram\r\nhere is the tensor:   Tensor(\"transpose_1:0\", shape=(None, None, None), dtype=complex64)\r\nINFO:tensorflow:Calling model_fn.\r\nWe are in:  spleeter.model\r\nWe are in:  spleeter.model\r\nWe are in:  spleeter.model\r\nWe are in:  spleeter.model\r\nWe are in:  spleeter.model\r\nWe are in:  spleeter.model.functions.unet\r\nWe are in apply_unet:  spleeter.model.functions.unet\r\nINFO:tensorflow:Apply unet for vocals_spectrogram\r\nWe are in _get_conv_activation_layer spleeter.model.functions.unet\r\nWe are in _get_deconv_activation_layer:  spleeter.model.functions.unet\r\nWe are in apply_unet:  spleeter.model.functions.unet\r\nINFO:tensorflow:Apply unet for drums_spectrogram\r\nWe are in _get_conv_activation_layer spleeter.model.functions.unet\r\nWe are in _get_deconv_activation_layer:  spleeter.model.functions.unet\r\nWe are in apply_unet:  spleeter.model.functions.unet\r\nINFO:tensorflow:Apply unet for bass_spectrogram\r\nWe are in _get_conv_activation_layer spleeter.model.functions.unet\r\nWe are in _get_deconv_activation_layer:  spleeter.model.functions.unet\r\nWe are in apply_unet:  spleeter.model.functions.unet\r\nINFO:tensorflow:Apply unet for other_spectrogram\r\nWe are in _get_conv_activation_layer spleeter.model.functions.unet\r\nWe are in _get_deconv_activation_layer:  spleeter.model.functions.unet\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Starting evaluation at 2022-05-29T18:24:50\r\nINFO:tensorflow:Graph was finalized.\r\nINFO:tensorflow:Restoring parameters from musdb_model\\model.ckpt-0\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Inference Time : 4.72633s\r\nINFO:tensorflow:Finished evaluation at 2022-05-29-18:24:54\r\nINFO:tensorflow:Saving dict for global step 0: absolute_difference = 0.0, bass_spectrogram = 0.0, drums_spectrogram = 0.0, global_step = 0, loss = 0.0, other_spectrogram = 0.0, vocals_spectrogram = 0.0\r\nINFO:tensorflow:Saving 'checkpoint_path' summary for global step 0: musdb_model\\model.ckpt-0\r\nWARNING:tensorflow:Training with estimator made no steps. Perhaps input is empty or misspecified.\r\nINFO:tensorflow:Loss for final step: None.\r\nINFO:spleeter:Model training done","closed_by":null,"reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/1138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/google-research/google-research/issues/1138/timeline","performed_via_github_app":null,"state_reason":null}