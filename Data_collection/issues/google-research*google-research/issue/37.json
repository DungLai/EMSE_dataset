{"url":"https://api.github.com/repos/google-research/google-research/issues/37","repository_url":"https://api.github.com/repos/google-research/google-research","labels_url":"https://api.github.com/repos/google-research/google-research/issues/37/labels{/name}","comments_url":"https://api.github.com/repos/google-research/google-research/issues/37/comments","events_url":"https://api.github.com/repos/google-research/google-research/issues/37/events","html_url":"https://github.com/google-research/google-research/issues/37","id":471605559,"node_id":"MDU6SXNzdWU0NzE2MDU1NTk=","number":37,"title":"bam/run_classifier.py model always load distill_outputs from _train_predictions_1.pkl","user":{"login":"SanPianWang","id":52482863,"node_id":"MDQ6VXNlcjUyNDgyODYz","avatar_url":"https://avatars.githubusercontent.com/u/52482863?v=4","gravatar_id":"","url":"https://api.github.com/users/SanPianWang","html_url":"https://github.com/SanPianWang","followers_url":"https://api.github.com/users/SanPianWang/followers","following_url":"https://api.github.com/users/SanPianWang/following{/other_user}","gists_url":"https://api.github.com/users/SanPianWang/gists{/gist_id}","starred_url":"https://api.github.com/users/SanPianWang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SanPianWang/subscriptions","organizations_url":"https://api.github.com/users/SanPianWang/orgs","repos_url":"https://api.github.com/users/SanPianWang/repos","events_url":"https://api.github.com/users/SanPianWang/events{/privacy}","received_events_url":"https://api.github.com/users/SanPianWang/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-07-23T10:09:02Z","updated_at":"2021-01-28T15:26:22Z","closed_at":"2019-07-30T15:21:43Z","author_association":"NONE","active_lock_reason":null,"body":"I was trying to train a BAM model using the command like `python -m bam.run_classifier rte-mrpc-bam-model $BAM_DIR '{\"task_names\": [\"rte\", \"mrpc\"], \"distill\": true, \"teachers\": {\"rte\": \"rte-model\", \"mrpc\": \"mrpc-model\"}}'` given in the Readme.mdï¼Œan error occured like:\r\n```\r\nTraceback (most recent call last):\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm Community Edition 2019.1.2\\helpers\\pydev\\pydevd.py\", line 1758, in <module>\r\n    main()\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm Community Edition 2019.1.2\\helpers\\pydev\\pydevd.py\", line 1752, in main\r\n    globals = debugger.run(setup['file'], None, None, is_module)\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm Community Edition 2019.1.2\\helpers\\pydev\\pydevd.py\", line 1147, in run\r\n    pydev_imports.execfile(file, globals, locals)  # execute the script\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm Community Edition 2019.1.2\\helpers\\pydev\\_pydev_imps\\_pydev_execfile.py\", line 18, in execfile\r\n    exec(compile(contents+\"\\n\", file, 'exec'), glob, loc)\r\n  File \"C:/Users/yirongli/Desktop/bam/run_classifier.py\", line 281, in <module>\r\n    tf.app.run()\r\n  File \"C:\\Python36\\lib\\site-packages\\tensorflow\\python\\platform\\app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"C:/Users/yirongli/Desktop/bam/run_classifier.py\", line 274, in main\r\n    model_runner.write_outputs([task], trial, split)\r\n  File \"C:/Users/yirongli/Desktop/bam/run_classifier.py\", line 196, in write_outputs\r\n    distill_input_fn, _, _ = self._preprocessor.prepare_predict(tasks, split)\r\n  File \"C:\\Users\\yirongli\\Desktop\\bam\\data\\preprocessing.py\", line 69, in prepare_predict\r\n    return self._serialize_dataset(tasks, False, split)\r\n  File \"C:\\Users\\yirongli\\Desktop\\bam\\data\\preprocessing.py\", line 108, in _serialize_dataset\r\n    self.serialize_examples(examples, is_training, tfrecords_path)\r\n  File \"C:\\Users\\yirongli\\Desktop\\bam\\data\\preprocessing.py\", line 127, in serialize_examples\r\n    tf_example = self._example_to_tf_example(example, is_training)\r\n  File \"C:\\Users\\yirongli\\Desktop\\bam\\data\\preprocessing.py\", line 136, in _example_to_tf_example\r\n    example, is_training))\r\n  File \"C:\\Users\\yirongli\\Desktop\\bam\\task_specific\\classification\\classification_tasks.py\", line 136, in featurize\r\n    self._distill_inputs[eid])\r\nKeyError: 2490\r\n```\r\nWhen I tried to figure out, i found that in `configure.py` line 131, model always load distill_outputs from _train_predictions_1.pkl no matter the student model requiring training or testing prediction by teacher model in `run_classifier.py` line 269. \r\nSo it obviously goes wrong when get the testing prediction, hope to fix it","closed_by":{"login":"SanPianWang","id":52482863,"node_id":"MDQ6VXNlcjUyNDgyODYz","avatar_url":"https://avatars.githubusercontent.com/u/52482863?v=4","gravatar_id":"","url":"https://api.github.com/users/SanPianWang","html_url":"https://github.com/SanPianWang","followers_url":"https://api.github.com/users/SanPianWang/followers","following_url":"https://api.github.com/users/SanPianWang/following{/other_user}","gists_url":"https://api.github.com/users/SanPianWang/gists{/gist_id}","starred_url":"https://api.github.com/users/SanPianWang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SanPianWang/subscriptions","organizations_url":"https://api.github.com/users/SanPianWang/orgs","repos_url":"https://api.github.com/users/SanPianWang/repos","events_url":"https://api.github.com/users/SanPianWang/events{/privacy}","received_events_url":"https://api.github.com/users/SanPianWang/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/37/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/google-research/google-research/issues/37/timeline","performed_via_github_app":null,"state_reason":"completed"}