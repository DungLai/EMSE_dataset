{"url":"https://api.github.com/repos/google-research/google-research/issues/717","repository_url":"https://api.github.com/repos/google-research/google-research","labels_url":"https://api.github.com/repos/google-research/google-research/issues/717/labels{/name}","comments_url":"https://api.github.com/repos/google-research/google-research/issues/717/comments","events_url":"https://api.github.com/repos/google-research/google-research/issues/717/events","html_url":"https://github.com/google-research/google-research/issues/717","id":906524977,"node_id":"MDU6SXNzdWU5MDY1MjQ5Nzc=","number":717,"title":"Inconsistency on tabnet between paper and code","user":{"login":"titobrezende","id":7241076,"node_id":"MDQ6VXNlcjcyNDEwNzY=","avatar_url":"https://avatars.githubusercontent.com/u/7241076?v=4","gravatar_id":"","url":"https://api.github.com/users/titobrezende","html_url":"https://github.com/titobrezende","followers_url":"https://api.github.com/users/titobrezende/followers","following_url":"https://api.github.com/users/titobrezende/following{/other_user}","gists_url":"https://api.github.com/users/titobrezende/gists{/gist_id}","starred_url":"https://api.github.com/users/titobrezende/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/titobrezende/subscriptions","organizations_url":"https://api.github.com/users/titobrezende/orgs","repos_url":"https://api.github.com/users/titobrezende/repos","events_url":"https://api.github.com/users/titobrezende/events{/privacy}","received_events_url":"https://api.github.com/users/titobrezende/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-05-29T17:49:41Z","updated_at":"2021-10-31T03:03:15Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi\r\n\r\nFor me there are two items on [https://github.com/google-research/google-research/blob/master/tabnet/tabnet_model.py](url)  that are different from what was reported in the paper [https://arxiv.org/pdf/1908.07442.pdf](url) \r\n\r\nOn **interpretability** section the author @soarik  says that:\r\n<img src=\"https://render.githubusercontent.com/render/math?math=\\sum_{c=1}^{N_d} ReLU(d_{b,c}[i])\">\r\nBut the given code in github is dividing this sum by the number of steps:\r\n(line 177)\r\n`# Aggregated masks are used for visualization of the`\r\n` # feature importance attributes.`\r\n `         scale_agg = tf.reduce_sum(\r\n              decision_out, axis=1, keep_dims=True) / (\r\n                  self.num_decision_steps - 1)`\r\nAlso, for the aggregate feature importance mask, it looks like the normalization is missing. The paper states:\r\n<img src=\"https://render.githubusercontent.com/render/math?math=\\frac{ \\sum_{i=1}^{N_{steps}} \\eta_b[i]M_{b,j}[i]} {\\sum_{j=1}^{D}\\sum_{i=1}^{N_{steps}} \\eta_b[i]M_{b,j}[i]}\">\r\nBut the give code is:\r\n(line 182)\r\n`aggregated_mask_values += mask_values * scale_agg`\r\nInside a for looping over each step, which will give only the top part of the equation.\r\n\r\nAm I missing something or the paper and code are really different?\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/google-research/google-research/issues/717/timeline","performed_via_github_app":null,"state_reason":null}