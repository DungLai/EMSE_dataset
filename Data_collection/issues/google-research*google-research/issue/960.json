{"url":"https://api.github.com/repos/google-research/google-research/issues/960","repository_url":"https://api.github.com/repos/google-research/google-research","labels_url":"https://api.github.com/repos/google-research/google-research/issues/960/labels{/name}","comments_url":"https://api.github.com/repos/google-research/google-research/issues/960/comments","events_url":"https://api.github.com/repos/google-research/google-research/issues/960/events","html_url":"https://github.com/google-research/google-research/issues/960","id":1115701860,"node_id":"I_kwDOCQmIhc5CgEJk","number":960,"title":"Process Darmstadt raw data to RGB color image","user":{"login":"pkchen53","id":34348942,"node_id":"MDQ6VXNlcjM0MzQ4OTQy","avatar_url":"https://avatars.githubusercontent.com/u/34348942?v=4","gravatar_id":"","url":"https://api.github.com/users/pkchen53","html_url":"https://github.com/pkchen53","followers_url":"https://api.github.com/users/pkchen53/followers","following_url":"https://api.github.com/users/pkchen53/following{/other_user}","gists_url":"https://api.github.com/users/pkchen53/gists{/gist_id}","starred_url":"https://api.github.com/users/pkchen53/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pkchen53/subscriptions","organizations_url":"https://api.github.com/users/pkchen53/orgs","repos_url":"https://api.github.com/users/pkchen53/repos","events_url":"https://api.github.com/users/pkchen53/events{/privacy}","received_events_url":"https://api.github.com/users/pkchen53/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-01-27T02:34:45Z","updated_at":"2022-01-27T02:34:45Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I tried reading the raw data and converting it to RGGB Bayer domain, like dnd_denoise.py does, and feeding the data to process.py to get an RGB color image, but I get weird colors. However, if I swap the flip direction of the two bayer_pattern cases, I get the correct color.\r\n\r\nI'm just wondering if it's because we do the transpose on the image matrix but not on the bayer_pattern or I do something wrong?\r\nBelow is part of the code I used to convert the raw data to an RGB image.\r\n\r\n```\r\nimg = h5py.File(filename, 'r')\r\nInoisy = np.float32(np.array(img['Inoisy']).T)\r\nbayer_pattern = np.asarray(info[info['camera'][0][i]]['pattern']).tolist()\r\n\r\nif (bayer_pattern == [[1, 2], [2, 3]]):\r\n    pass\r\nelif (bayer_pattern == [[2, 1], [3, 2]]):\r\n    Inoisy = np.flipud(Inoisy)                <==== Here I change the flip direction\r\nelif (bayer_pattern == [[2, 3], [1, 2]]):\r\n    Inoisy = np.fliplr(Inoisy)                <==== Here I change the flip direction\r\nelse:\r\n    print('Warning: assuming unknown Bayer pattern is RGGB.')\r\n\r\nheight, width = Inoisy.shape\r\nchannels = []\r\nfor yy in range(2):\r\n    for xx in range(2):\r\n        noisy_crop_c = Inoisy[yy:height:2, xx:width:2].copy()\r\n        channels.append(noisy_crop_c)\r\nchannels = np.stack(channels, axis=-1)\r\n\r\nInoisy = process.process(channels, red_gains, blue_gains, cam2rgbs)\r\n\r\n```\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/google-research/google-research/issues/960/timeline","performed_via_github_app":null,"state_reason":null}