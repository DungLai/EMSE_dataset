{"url":"https://api.github.com/repos/google-research/google-research/issues/1002","repository_url":"https://api.github.com/repos/google-research/google-research","labels_url":"https://api.github.com/repos/google-research/google-research/issues/1002/labels{/name}","comments_url":"https://api.github.com/repos/google-research/google-research/issues/1002/comments","events_url":"https://api.github.com/repos/google-research/google-research/issues/1002/events","html_url":"https://github.com/google-research/google-research/issues/1002","id":1133628793,"node_id":"I_kwDOCQmIhc5Dkc15","number":1002,"title":"[Error] mobilebert/run_classifier.py : 'NoneType' object has no attribute 'op'","user":{"login":"yuchiwang","id":7112114,"node_id":"MDQ6VXNlcjcxMTIxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/7112114?v=4","gravatar_id":"","url":"https://api.github.com/users/yuchiwang","html_url":"https://github.com/yuchiwang","followers_url":"https://api.github.com/users/yuchiwang/followers","following_url":"https://api.github.com/users/yuchiwang/following{/other_user}","gists_url":"https://api.github.com/users/yuchiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/yuchiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yuchiwang/subscriptions","organizations_url":"https://api.github.com/users/yuchiwang/orgs","repos_url":"https://api.github.com/users/yuchiwang/repos","events_url":"https://api.github.com/users/yuchiwang/events{/privacy}","received_events_url":"https://api.github.com/users/yuchiwang/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-02-12T05:50:26Z","updated_at":"2022-02-14T07:12:57Z","closed_at":"2022-02-14T07:12:47Z","author_association":"NONE","active_lock_reason":null,"body":"SST-2 and CoLA both.  PLZ help. Thanks\r\n\r\n**[LOG]**\r\nPlease use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.\r\nINFO:tensorflow:**** Trainable Variables ****\r\nI0212 13:33:31.735677 139904805205824 run_classifier.py:770] **** Trainable Variables ****\r\nERROR:tensorflow:Error recorded from training_loop: 'NoneType' object has no attribute 'op'\r\nE0212 13:33:31.758976 139904805205824 error_handling.py:75] Error recorded from training_loop: 'NoneType' object has no attribute 'op'\r\nINFO:tensorflow:training_loop marked as finished\r\nI0212 13:33:31.759163 139904805205824 error_handling.py:101] training_loop marked as finished\r\nWARNING:tensorflow:Reraising captured error\r\nW0212 13:33:31.759236 139904805205824 error_handling.py:135] Reraising captured error\r\nTraceback (most recent call last):\r\n  File \"run_classifier.py\", line 1219, in <module>\r\n    tf.app.run()\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_core/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/absl/app.py\", line 312, in run\r\n    _run_main(main, args)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/absl/app.py\", line 258, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"run_classifier.py\", line 1082, in main\r\n    estimator.train(input_fn=train_input_fn, max_steps=num_train_steps)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 3035, in train\r\n    rendezvous.raise_errors()\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/tpu/error_handling.py\", line 136, in raise_errors\r\n    six.reraise(typ, value, traceback)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/six.py\", line 719, in reraise\r\n    raise value\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 3030, in train\r\n    saving_listeners=saving_listeners)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 370, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1161, in _train_model\r\n    return self._train_model_default(input_fn, hooks, saving_listeners)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1191, in _train_model_default\r\n    features, labels, ModeKeys.TRAIN, self.config)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 2857, in _call_model_fn\r\n    config)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1149, in _call_model_fn\r\n    model_fn_results = self._model_fn(features=features, **kwargs)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 3126, in _model_fn\r\n    features, labels, is_export_mode=is_export_mode)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 1663, in call_without_tpu\r\n    return self._call_model_fn(features, labels, is_export_mode=is_export_mode)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py\", line 1994, in _call_model_fn\r\n    estimator_spec = self._model_fn(features=features, **kwargs)\r\n  File \"run_classifier.py\", line 782, in model_fn\r\n    total_loss, learning_rate, num_train_steps, num_warmup_steps, use_tpu)\r\n  File \"/data/wangyuchi/google_research/mobilebert/optimization.py\", line 96, in create_optimizer\r\n    grads = tf.gradients(loss, tvars)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_core/python/ops/gradients_impl.py\", line 158, in gradients\r\n    unconnected_gradients)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_core/python/ops/gradients_util.py\", line 550, in _GradientsHelper\r\n    gradient_uid)\r\n  File \"/root/anaconda3/envs/mobilebert/lib/python3.6/site-packages/tensorflow_core/python/ops/gradients_util.py\", line 166, in _DefaultGradYs\r\n    with _maybe_colocate_with(y.op, gradient_uid, colocate_gradients_with_ops):\r\nAttributeError: 'NoneType' object has no attribute 'op'\r\n\r\n**[CMD]**\r\npython run_classifier.py \\\r\n--bert_config_file=config/uncased_L-24_H-128_B-512_A-4_F-4_OPT_QAT.json \\\r\n--data_dir=data/CoLA \\\r\n--task_name=cola \\\r\n--do_train \\\r\n--do_lower_case \\\r\n--init_checkpoint=mobilebert/mobilebert_variables.ckpt \\\r\n--learning_rate=5e-5 \\\r\n--max_seq_length=64 \\\r\n--num_train_epochs=5 \\\r\n--output_dir=cola_output \\\r\n--train_batch_size=96 \\\r\n--vocab_file=mobilebert/vocab.txt \\\r\n--warmup_proportion=0.1 \\\r\n--export_dir=cola_export \\\r\n--verbose_logging=True \\\r\n--use_quantized_training=true","closed_by":{"login":"yuchiwang","id":7112114,"node_id":"MDQ6VXNlcjcxMTIxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/7112114?v=4","gravatar_id":"","url":"https://api.github.com/users/yuchiwang","html_url":"https://github.com/yuchiwang","followers_url":"https://api.github.com/users/yuchiwang/followers","following_url":"https://api.github.com/users/yuchiwang/following{/other_user}","gists_url":"https://api.github.com/users/yuchiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/yuchiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yuchiwang/subscriptions","organizations_url":"https://api.github.com/users/yuchiwang/orgs","repos_url":"https://api.github.com/users/yuchiwang/repos","events_url":"https://api.github.com/users/yuchiwang/events{/privacy}","received_events_url":"https://api.github.com/users/yuchiwang/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/1002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/google-research/google-research/issues/1002/timeline","performed_via_github_app":null,"state_reason":"completed"}