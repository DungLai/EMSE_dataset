{"url":"https://api.github.com/repos/google-research/google-research/issues/612","repository_url":"https://api.github.com/repos/google-research/google-research","labels_url":"https://api.github.com/repos/google-research/google-research/issues/612/labels{/name}","comments_url":"https://api.github.com/repos/google-research/google-research/issues/612/comments","events_url":"https://api.github.com/repos/google-research/google-research/issues/612/events","html_url":"https://github.com/google-research/google-research/issues/612","id":824409367,"node_id":"MDU6SXNzdWU4MjQ0MDkzNjc=","number":612,"title":"[BiGG] RuntimeError: CUDA error: no kernel image is available for execution on the device","user":{"login":"xiangsheng1325","id":32408309,"node_id":"MDQ6VXNlcjMyNDA4MzA5","avatar_url":"https://avatars.githubusercontent.com/u/32408309?v=4","gravatar_id":"","url":"https://api.github.com/users/xiangsheng1325","html_url":"https://github.com/xiangsheng1325","followers_url":"https://api.github.com/users/xiangsheng1325/followers","following_url":"https://api.github.com/users/xiangsheng1325/following{/other_user}","gists_url":"https://api.github.com/users/xiangsheng1325/gists{/gist_id}","starred_url":"https://api.github.com/users/xiangsheng1325/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiangsheng1325/subscriptions","organizations_url":"https://api.github.com/users/xiangsheng1325/orgs","repos_url":"https://api.github.com/users/xiangsheng1325/repos","events_url":"https://api.github.com/users/xiangsheng1325/events{/privacy}","received_events_url":"https://api.github.com/users/xiangsheng1325/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-03-08T10:15:11Z","updated_at":"2021-03-09T02:09:16Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi, I install the BiGG in my new machine.\r\n\r\nThis is my Environment:\r\n* RTX3090, cuda 11.1\r\n* CentOS7\r\n* Python3.6\r\n* PyTorch1.8\r\n\r\nI can run the test code normally on cpu:\r\n`python -m bigg.unit_test.lib_test`\r\n\r\nBut I get error on gpu:\r\n`python -m bigg.unit_test.lib_test -gpu 0`\r\nThis is Error message:\r\n```\r\n$ python -m bigg.unit_test.lib_test -gpu 0\r\nNamespace(accum_grad=1, batch_exec=False, batch_size=10, bfs_permute=False, bits_compress=256, blksize=-1, data_dir='.', dev_ratio=0.2, directed=False, display=False, dist_backend='gloo', embed_dim=256, epoch_load=None, epoch_save=100, eval_folder=None, g_type=None, gpu=0, grad_clip=5, greedy_frac=0, learning_rate=0.001, max_num_nodes=-1, model_dump=None, node_order='default', num_epochs=100000, num_proc=1, num_test_gen=-1, old_model=False, param_layers=1, phase='train', pos_base=10000, pos_enc=True, rnn_layers=2, save_dir='.', seed=34, self_loop=False, share_param=True, train_method='full', train_ratio=0.8, tree_pos_enc=False)\r\nuse gpu indexed: 0\r\n====== begin of tree_clib configuration ======\r\n| bfs_permute = 0\r\n| max_num_nodes = 1000000\r\n| bits_compress = 256\r\n| dim_embed = 256\r\n| gpu = 0\r\n| seed = 34\r\n======   end of tree_clib configuration ======\r\nvenv_of_bigg/lib/python3.6/site-packages/torch/cuda/__init__.py:104: UserWarning: \r\nGeForce RTX 3090 with CUDA capability sm_86 is not compatible with the current PyTorch installation.\r\nThe current PyTorch install supports CUDA capabilities sm_37 sm_50 sm_60 sm_70.\r\nIf you want to use the GeForce RTX 3090 GPU with PyTorch, please check the instructions at https://pytorch.org/get-started/locally/\r\n\r\n  warnings.warn(incompatible_device_warn.format(device_name, capability, \" \".join(arch_list), device_name))\r\nTraceback (most recent call last):\r\n  File \"venv_of_bigg/bigg/bigg/unit_test/lib_test.py\", line 47, in <module>\r\n    ll, _ = model.forward_train([0])\r\n  File \"venv_of_bigg/bigg/bigg/model/tree_model.py\", line 470, in forward_train\r\n    fn_hc_bot, h_buf_list, c_buf_list = self.forward_row_trees(graph_ids, list_node_starts, num_nodes, list_col_ranges)\r\n  File \"venv_of_bigg/bigg/bigg/model/tree_model.py\", line 445, in forward_row_trees\r\n    binary_embeds, base_feat = TreeLib.PrepareBinary()\r\n  File \"venv_of_bigg/bigg/bigg/model/tree_clib/tree_lib.py\", line 176, in PrepareBinary\r\n    feat = torch.cuda.FloatTensor(num_nodes + 2, self.embed_dim).fill_(0)\r\nRuntimeError: CUDA error: no kernel image is available for execution on the device\r\n```\r\n\r\nCould you please help fix this error or tell me how to avoid this problem?\r\nThank you for your excellent work.\r\nI am looking forward to your reply.","closed_by":null,"reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/google-research/google-research/issues/612/timeline","performed_via_github_app":null,"state_reason":null}