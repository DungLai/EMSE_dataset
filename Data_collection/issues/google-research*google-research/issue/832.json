{"url":"https://api.github.com/repos/google-research/google-research/issues/832","repository_url":"https://api.github.com/repos/google-research/google-research","labels_url":"https://api.github.com/repos/google-research/google-research/issues/832/labels{/name}","comments_url":"https://api.github.com/repos/google-research/google-research/issues/832/comments","events_url":"https://api.github.com/repos/google-research/google-research/issues/832/events","html_url":"https://github.com/google-research/google-research/issues/832","id":1007174144,"node_id":"I_kwDOCQmIhc48CEIA","number":832,"title":"[kws_streaming] Training CRNN model on custom dataset","user":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-09-25T19:16:52Z","updated_at":"2021-10-18T13:51:37Z","closed_at":"2021-10-18T13:51:37Z","author_association":"NONE","active_lock_reason":null,"body":"@rybakov  \r\nI am trying to train the CRNN model on custom dataset having approximately 30,000 .wav files (SR=16KHz). The duration of the audios are within 4 seconds.\r\nI have changed the [clip_duration_ms](https://github.com/google-research/google-research/blob/master/kws_streaming/models/model_params.py#L36) to 4000 ms , [wanted_words](https://github.com/google-research/google-research/blob/e9ca68693aff711f830f196b2c9a6563fdd520ee/kws_streaming/models/model_params.py#L32) as per my dataset and changed the speech extraction properties to 4 times of default parameters.\r\nSome of the flags are listed below\r\n```\r\n# set speech feature extractor properties\r\nFLAGS.mel_upper_edge_hertz = 7600\r\nFLAGS.window_size_ms = 160.0\r\nFLAGS.window_stride_ms = 80.0\r\nFLAGS.mel_num_bins = 160\r\nFLAGS.dct_num_features = 80\r\nFLAGS.feature_type = 'mfcc_tf'\r\nFLAGS.preprocess = 'raw'\r\nFLAGS.causal_data_frame_padding = 0\r\nFLAGS.use_tf_fft = False\r\nFLAGS.mel_non_zero_only = not FLAGS.use_tf_fft\r\n\r\n# set training settings\r\nFLAGS.train = 1\r\nFLAGS.how_many_training_steps = '5000,5000'\r\nFLAGS.learning_rate = '0.001,0.0005'\r\nFLAGS.lr_schedule = 'exp'\r\nFLAGS.verbosity = logging.INFO\r\n\r\n# data augmentation parameters\r\nFLAGS.resample = 0.15\r\nFLAGS.time_shift_ms = 100\r\nFLAGS.use_spec_augment = 0\r\nFLAGS.time_masks_number = 2\r\nFLAGS.time_mask_max_size = 10\r\nFLAGS.frequency_masks_number = 2\r\nFLAGS.frequency_mask_max_size = 15\r\nFLAGS.pick_deterministically = 0\r\n\r\n# CRNN model paramters\r\n FLAGS.cnn_filters = '16,16'\r\n FLAGS.cnn_kernel_size = '(3,3),(5,3)'\r\n FLAGS.cnn_act = \"'relu','relu'\"\r\n FLAGS.cnn_dilation_rate = '(1,1),(1,1)'\r\n FLAGS.cnn_strides = '(1,1),(1,1)'\r\n FLAGS.gru_units = '256'\r\n FLAGS.return_sequences = '0'\r\n FLAGS.dropout1 = 0.1\r\n FLAGS.units1 = '128,256'\r\n FLAGS.act1 = \"'linear','relu'\"\r\n FLAGS.stateful = 1\r\n```\r\n\r\nThe model summary is\r\n```\r\n\r\nModel: \"model_1\"\r\n_________________________________________________________________\r\nLayer (type)                 Output Shape              Param #   \r\n=================================================================\r\ninput_2 (InputLayer)         [(100, 64000)]            0         \r\n_________________________________________________________________\r\nspeech_features_1 (SpeechFea (100, 49, 80)             0         \r\n_________________________________________________________________\r\ntf_op_layer_ExpandDims_1 (Te [(100, 49, 80, 1)]        0         \r\n_________________________________________________________________\r\nstream_3 (Stream)            (100, 47, 78, 16)         160       \r\n_________________________________________________________________\r\nstream_4 (Stream)            (100, 43, 76, 16)         3856      \r\n_________________________________________________________________\r\nreshape_1 (Reshape)          (100, 43, 1216)           0         \r\n_________________________________________________________________\r\ngru_1 (GRU)                  (100, 1, 256)             1132032   \r\n_________________________________________________________________\r\nstream_5 (Stream)            (100, 256)                0         \r\n_________________________________________________________________\r\ndropout_1 (Dropout)          (100, 256)                0         \r\n_________________________________________________________________\r\ndense_3 (Dense)              (100, 128)                32896     \r\n_________________________________________________________________\r\ndense_4 (Dense)              (100, 256)                33024     \r\n_________________________________________________________________\r\ndense_5 (Dense)              (100, 24)                 6168      \r\n=================================================================\r\nTotal params: 1,208,136\r\nTrainable params: 1,208,136\r\nNon-trainable params: 0\r\n_________________________________________________________________\r\n\r\n```\r\nCurrently I am getting accuracy around 93.5%. Can you please suggest what are the other parameters of the model I need to change in order to get a accuracy more than 95% for the mentioned model.\r\n\r\n","closed_by":{"login":"vishalkevat007","id":29162378,"node_id":"MDQ6VXNlcjI5MTYyMzc4","avatar_url":"https://avatars.githubusercontent.com/u/29162378?v=4","gravatar_id":"","url":"https://api.github.com/users/vishalkevat007","html_url":"https://github.com/vishalkevat007","followers_url":"https://api.github.com/users/vishalkevat007/followers","following_url":"https://api.github.com/users/vishalkevat007/following{/other_user}","gists_url":"https://api.github.com/users/vishalkevat007/gists{/gist_id}","starred_url":"https://api.github.com/users/vishalkevat007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vishalkevat007/subscriptions","organizations_url":"https://api.github.com/users/vishalkevat007/orgs","repos_url":"https://api.github.com/users/vishalkevat007/repos","events_url":"https://api.github.com/users/vishalkevat007/events{/privacy}","received_events_url":"https://api.github.com/users/vishalkevat007/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/google-research/google-research/issues/832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/google-research/google-research/issues/832/timeline","performed_via_github_app":null,"state_reason":"completed"}