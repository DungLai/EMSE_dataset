{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/825","repository_url":"https://api.github.com/repos/dmlc/gluon-nlp","labels_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/825/labels{/name}","comments_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/825/comments","events_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/825/events","html_url":"https://github.com/dmlc/gluon-nlp/issues/825","id":467097744,"node_id":"MDU6SXNzdWU0NjcwOTc3NDQ=","number":825,"title":"[CI] Notebook compilation on AWS Batch fails sometimes with \"Job attempt duration exceeded timeout\"","user":{"login":"leezu","id":946903,"node_id":"MDQ6VXNlcjk0NjkwMw==","avatar_url":"https://avatars.githubusercontent.com/u/946903?v=4","gravatar_id":"","url":"https://api.github.com/users/leezu","html_url":"https://github.com/leezu","followers_url":"https://api.github.com/users/leezu/followers","following_url":"https://api.github.com/users/leezu/following{/other_user}","gists_url":"https://api.github.com/users/leezu/gists{/gist_id}","starred_url":"https://api.github.com/users/leezu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leezu/subscriptions","organizations_url":"https://api.github.com/users/leezu/orgs","repos_url":"https://api.github.com/users/leezu/repos","events_url":"https://api.github.com/users/leezu/events{/privacy}","received_events_url":"https://api.github.com/users/leezu/received_events","type":"User","site_admin":false},"labels":[{"id":890393501,"node_id":"MDU6TGFiZWw4OTAzOTM1MDE=","url":"https://api.github.com/repos/dmlc/gluon-nlp/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-07-11T20:44:36Z","updated_at":"2019-07-11T20:44:36Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"## Description\r\nTime to time, the AWS Batch job fail without obvious reason. It seems the instance hangs and is finally killed due to timeout.\r\n\r\nExample:\r\n- http://ci.mxnet.io/blue/organizations/jenkins/GluonNLP-py3-master-gpu-doc/detail/PR-823/5/pipeline\r\n- ECS Task https://console.aws.amazon.com/ecs/home?region=us-east-1#/clusters/gluon-nlp-p3-2x_Batch_6e228b9e-367a-31de-9da7-5f50d2e5eb96/tasks/2413c68a-9519-4d40-a977-7681fb3a667d/details\r\n- Cloudwatch log https://us-east-1.console.aws.amazon.com/cloudwatch/home?region=us-east-1#logEventViewer:group=/aws/batch/job;stream=gluon-nlp-jobs/default/2413c68a-9519-4d40-a977-7681fb3a667d\r\n\r\nThe cloudwatch log only contains output from the conda activation\r\n\r\nThe last few lines of the log are\r\n\r\n```\r\n\r\n19:15:02\r\nCollecting colorama<=0.3.9,>=0.2.5 (from awscli)\r\n\r\n19:15:02\r\nUsing cached https://files.pythonhosted.org/packages/db/c8/7dcf9dbcb22429512708fe3a547f8b6101c0d02137acbd892505aee57adf/colorama-0.3.9-py2.py3-none-any.whl\r\n\r\n19:15:02\r\nRequirement already satisfied: s3transfer<0.3.0,>=0.2.0 in ./conda/docker/py3/lib/python3.6/site-packages (from awscli) (0.2.1)\r\n\r\n19:15:02\r\nRequirement already satisfied: docutils>=0.10 in ./conda/docker/py3/lib/python3.6/site-packages (from awscli) (0.14)\r\n\r\n19:15:02\r\nCollecting rsa<=3.5.0,>=3.1.2 (from awscli)\r\n\r\n19:15:02\r\nUsing cached https://files.pythonhosted.org/packages/e1/ae/baedc9cb175552e95f3395c43055a6a5e125ae4d48a1d7a924baca83e92e/rsa-3.4.2-py2.py3-none-any.whl\r\n\r\n19:15:02\r\nRequirement already satisfied: jmespath<1.0.0,>=0.7.1 in ./conda/docker/py3/lib/python3.6/site-packages (from botocore==1.12.187->awscli) (0.9.4)\r\n\r\n19:15:02\r\nRequirement already satisfied: python-dateutil<3.0.0,>=2.1 in ./conda/docker/py3/lib/python3.6/site-packages (from botocore==1.12.187->awscli) (2.8.0)\r\n\r\n19:15:02\r\nRequirement already satisfied: urllib3<1.26,>=1.20 in ./conda/docker/py3/lib/python3.6/site-packages (from botocore==1.12.187->awscli) (1.24.3)\r\n\r\n19:15:02\r\nCollecting pyasn1>=0.1.3 (from rsa<=3.5.0,>=3.1.2->awscli)\r\n\r\n19:15:02\r\nUsing cached https://files.pythonhosted.org/packages/7b/7c/c9386b82a25115cccf1903441bba3cbadcfae7b678a20167347fa8ded34c/pyasn1-0.4.5-py2.py3-none-any.whl\r\n\r\n19:15:02\r\nRequirement already satisfied: six>=1.5 in ./conda/docker/py3/lib/python3.6/site-packages (from python-dateutil<3.0.0,>=2.1->botocore==1.12.187->awscli) (1.12.0)\r\n\r\n19:15:03\r\nInstalling collected packages: PyYAML, colorama, pyasn1, rsa, awscli\r\n\r\n19:15:04\r\nSuccessfully installed PyYAML-5.1 awscli-1.16.197 colorama-0.3.9 pyasn1-0.4.5 rsa-3.4.2\r\n```\r\n\r\n\r\n```\r\n Cluster\r\ngluon-nlp-p3-2x_Batch_6e228b9e-367a-31de-9da7-5f50d2e5eb96\r\nContainer instance\r\n6603f018-fc08-4e63-8bb6-3f71559dbc26\r\nEC2 instance id\r\ni-03d4e39ec97552537\r\nLaunch type\r\nEC2\r\nTask definition\r\ngluon-nlp-jobs:11\r\nGroup\r\nfamily:gluon-nlp-jobs\r\nTask role\r\nECSContainerPowerUser\r\nLast status\r\nSTOPPED\r\nDesired status\r\nSTOPPED\r\nCreated at\r\n2019-07-11 12:08:05 -0700\r\nStarted at\r\n2019-07-11 12:10:49 -0700\r\nStopped at\r\n2019-07-11 12:41:24 -0700\r\nStopped reason\r\nJob attempt duration exceeded timeout\r\n\r\n```","closed_by":null,"reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/825/timeline","performed_via_github_app":null,"state_reason":null}