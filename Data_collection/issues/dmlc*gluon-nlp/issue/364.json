{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/364","repository_url":"https://api.github.com/repos/dmlc/gluon-nlp","labels_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/364/labels{/name}","comments_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/364/comments","events_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/364/events","html_url":"https://github.com/dmlc/gluon-nlp/issues/364","id":370686430,"node_id":"MDU6SXNzdWUzNzA2ODY0MzA=","number":364,"title":"awd-lstm training results on wikitext-2 do not match those in documentation","user":{"login":"dingran","id":12864782,"node_id":"MDQ6VXNlcjEyODY0Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/12864782?v=4","gravatar_id":"","url":"https://api.github.com/users/dingran","html_url":"https://github.com/dingran","followers_url":"https://api.github.com/users/dingran/followers","following_url":"https://api.github.com/users/dingran/following{/other_user}","gists_url":"https://api.github.com/users/dingran/gists{/gist_id}","starred_url":"https://api.github.com/users/dingran/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dingran/subscriptions","organizations_url":"https://api.github.com/users/dingran/orgs","repos_url":"https://api.github.com/users/dingran/repos","events_url":"https://api.github.com/users/dingran/events{/privacy}","received_events_url":"https://api.github.com/users/dingran/received_events","type":"User","site_admin":false},"labels":[{"id":890393501,"node_id":"MDU6TGFiZWw4OTAzOTM1MDE=","url":"https://api.github.com/repos/dmlc/gluon-nlp/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":997120945,"node_id":"MDU6TGFiZWw5OTcxMjA5NDU=","url":"https://api.github.com/repos/dmlc/gluon-nlp/labels/release%20focus","name":"release focus","color":"fbca04","default":false,"description":"Progress focus for release"}],"state":"closed","locked":false,"assignee":{"login":"cgraywang","id":25714264,"node_id":"MDQ6VXNlcjI1NzE0MjY0","avatar_url":"https://avatars.githubusercontent.com/u/25714264?v=4","gravatar_id":"","url":"https://api.github.com/users/cgraywang","html_url":"https://github.com/cgraywang","followers_url":"https://api.github.com/users/cgraywang/followers","following_url":"https://api.github.com/users/cgraywang/following{/other_user}","gists_url":"https://api.github.com/users/cgraywang/gists{/gist_id}","starred_url":"https://api.github.com/users/cgraywang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cgraywang/subscriptions","organizations_url":"https://api.github.com/users/cgraywang/orgs","repos_url":"https://api.github.com/users/cgraywang/repos","events_url":"https://api.github.com/users/cgraywang/events{/privacy}","received_events_url":"https://api.github.com/users/cgraywang/received_events","type":"User","site_admin":false},"assignees":[{"login":"cgraywang","id":25714264,"node_id":"MDQ6VXNlcjI1NzE0MjY0","avatar_url":"https://avatars.githubusercontent.com/u/25714264?v=4","gravatar_id":"","url":"https://api.github.com/users/cgraywang","html_url":"https://github.com/cgraywang","followers_url":"https://api.github.com/users/cgraywang/followers","following_url":"https://api.github.com/users/cgraywang/following{/other_user}","gists_url":"https://api.github.com/users/cgraywang/gists{/gist_id}","starred_url":"https://api.github.com/users/cgraywang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cgraywang/subscriptions","organizations_url":"https://api.github.com/users/cgraywang/orgs","repos_url":"https://api.github.com/users/cgraywang/repos","events_url":"https://api.github.com/users/cgraywang/events{/privacy}","received_events_url":"https://api.github.com/users/cgraywang/received_events","type":"User","site_admin":false}],"milestone":null,"comments":12,"created_at":"2018-10-16T16:04:50Z","updated_at":"2019-02-20T19:47:38Z","closed_at":"2019-02-20T19:47:38Z","author_association":"NONE","active_lock_reason":null,"body":"Listed on https://gluon-nlp.mxnet.io/scripts/index.html#language-model\r\n\r\n[2] awd_lstm_lm_600_wikitext-2 (Val PPL 84.61 Test PPL 80.96)\r\n`python word_language_model.py --gpus 0 --emsize 200 --nhid 600 --epochs 750 --dropout 0.2 --dropout_h 0.1 --dropout_i 0.3 --dropout_e 0.05 --weight_drop 0.2 --tied --save awd_lstm_lm_600_wikitext-2`\r\n\r\nI'm getting near zero lr pretty early on and validation ppl is substantially higher (see below) than the published training log here: https://github.com/dmlc/web-data/blob/master/gluonnlp/logs/language_model/awd_lstm_lm_600_wikitext-2.log\r\n\r\nMy training log\r\n> [Epoch 169] time cost 306.39s, valid loss 6.06, valid ppl 429.32，lr 0.03\r\n[Epoch 170 Batch 200/372] current loss 5.69, ppl 296.66, throughput 102.99 samples/s, lr 0.03\r\n[Epoch 170] throughput 7052.65 samples/s\r\n[Epoch 170] time cost 309.12s, valid loss 6.06, valid ppl 428.84，lr 0.03\r\nLearning rate after interval update 0.003000\r\n[Epoch 171 Batch 200/372] current loss 5.70, ppl 297.69, throughput 102.76 samples/s, lr 0.00\r\n[Epoch 171] throughput 7029.03 samples/s\r\n[Epoch 171] time cost 310.24s, valid loss 6.06, valid ppl 428.85，lr 0.00\r\n[Epoch 172 Batch 200/372] current loss 5.69, ppl 295.60, throughput 106.35 samples/s, lr 0.00\r\n\r\n\r\nSimilar issue occurred for  awd_lstm_lm_1150_wikitext-2, i.e. learning rate substantially lower and ppl substantially higher compared to published log. \r\n\r\nMy training log\r\n\r\n>[Epoch 95] time cost 540.07s, valid loss 5.50, valid ppl 243.47，lr 3.00\r\n[Epoch 96 Batch 200/372] current loss 5.33, ppl 207.33, throughput 61.25 samples/s, lr 3.17\r\n[Epoch 96] throughput 4152.54 samples/s\r\n[Epoch 96] time cost 536.21s, valid loss 5.48, valid ppl 240.60，lr 3.00\r\n[Epoch 97 Batch 200/372] current loss 5.31, ppl 202.84, throughput 60.55 samples/s, lr 3.43\r\n[Epoch 97] throughput 4136.88 samples/s\r\n[Epoch 97] time cost 538.99s, valid loss 5.47, valid ppl 238.03，lr 3.00\r\n[Epoch 98 Batch 200/372] current loss 5.30, ppl 199.51, throughput 60.91 samples/s, lr 1.54\r\n\r\n\r\nBTW \"--gpus\" flag in the documentation page should be changed to \"--gpu\"\r\n\r\n\r\nThe training progress of standard-lstm models appear to match pretty well to the published training log.","closed_by":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/364/timeline","performed_via_github_app":null,"state_reason":"completed"}