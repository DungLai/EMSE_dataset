{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/1253","repository_url":"https://api.github.com/repos/dmlc/gluon-nlp","labels_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/1253/labels{/name}","comments_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/1253/comments","events_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/1253/events","html_url":"https://github.com/dmlc/gluon-nlp/issues/1253","id":647684327,"node_id":"MDU6SXNzdWU2NDc2ODQzMjc=","number":1253,"title":"Implementation of Non-monotonically Triggered AvSGD mismatches the ICLR paper","user":{"login":"xcgoner","id":6704257,"node_id":"MDQ6VXNlcjY3MDQyNTc=","avatar_url":"https://avatars.githubusercontent.com/u/6704257?v=4","gravatar_id":"","url":"https://api.github.com/users/xcgoner","html_url":"https://github.com/xcgoner","followers_url":"https://api.github.com/users/xcgoner/followers","following_url":"https://api.github.com/users/xcgoner/following{/other_user}","gists_url":"https://api.github.com/users/xcgoner/gists{/gist_id}","starred_url":"https://api.github.com/users/xcgoner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xcgoner/subscriptions","organizations_url":"https://api.github.com/users/xcgoner/orgs","repos_url":"https://api.github.com/users/xcgoner/repos","events_url":"https://api.github.com/users/xcgoner/events{/privacy}","received_events_url":"https://api.github.com/users/xcgoner/received_events","type":"User","site_admin":false},"labels":[{"id":890393503,"node_id":"MDU6TGFiZWw4OTAzOTM1MDM=","url":"https://api.github.com/repos/dmlc/gluon-nlp/labels/enhancement","name":"enhancement","color":"135caf","default":true,"description":"New feature or request"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2020-06-29T21:30:08Z","updated_at":"2020-07-27T22:54:06Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"## Description\r\nIn [1], the NTA implementation uses the algorithm from [3], where the average trigger checks “v > logs[-n:]”.\r\nHowever, in the version published in ICLR, [2], the algorithms is actually “v > logs[:-n]”, which is also used in Salesforce’s source code: [4]\r\nThere is a mismatch between the arxiv version and the ICLR version.\r\nNote that in gluonnlp website [5], the ICLR paper [2] is cited, but the implementation matches the arxiv version [3].\r\nIn the paper, the authors mentioned that the trigger should be “However, instead of averaging immediately after the validation metric worsens, we propose a non-monotonic criterion that conservatively triggers the averaging when the validation metric fails to improve for multiple cycles; see Algorithm 1. Given that the choice of triggering is irreversible, this conservatism ensures that the randomness of training does not play a major role in the decision.”\r\nThus, I think the ICLR/Salesforce source code version makes more sense, considering the description in the paper.\r\n\r\nI also did some experiment by myself, but it is hard to tell which one is better.\r\nThe results (valid ppl/test ppl) are obtained from mxnet 1.7, gluonnlp 0.9.x\r\n| nhid/NTA             | 200           | 600         | 650         | 1150        | 1500        |\r\n|----------------------|---------------|-------------|-------------|-------------|-------------|\r\n| website              | 107.59/101.64 | 84.89/80.67 | 90.96/86.91 | 68.71/65.62 | 86.51/82.29 |\r\n| arxiv,test by myself | 106.97/100.32 | 80.13/76.26 | 90.89/85.54 | 73.43/70.12 | 86.50/82.23 |\r\n| ICLR,test by myself  | 108.21/101.40 | 79.79/76.06 | 91.44/86.03 | 71.78/68.55 | 86.27/82.16 |\r\n\r\n\r\n## References\r\n[1] https://github.com/dmlc/gluon-nlp/blob/v0.9.x/scripts/language_model/word_language_model.py\r\n[2] https://openreview.net/pdf?id=SyyGPP0TZ\r\n[3] https://arxiv.org/pdf/1708.02182.pdf\r\n[4] https://github.com/salesforce/awd-lstm-lm/blob/master/main.py, line 275\r\n[5] https://gluon-nlp.mxnet.io/model_zoo/language_model/index.html\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/1253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/1253/timeline","performed_via_github_app":null,"state_reason":null}