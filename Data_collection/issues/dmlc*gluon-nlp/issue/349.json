{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/349","repository_url":"https://api.github.com/repos/dmlc/gluon-nlp","labels_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/349/labels{/name}","comments_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/349/comments","events_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/349/events","html_url":"https://github.com/dmlc/gluon-nlp/issues/349","id":363868058,"node_id":"MDU6SXNzdWUzNjM4NjgwNTg=","number":349,"title":"Transformer script doesn't run with py3","user":{"login":"eric-haibin-lin","id":5545640,"node_id":"MDQ6VXNlcjU1NDU2NDA=","avatar_url":"https://avatars.githubusercontent.com/u/5545640?v=4","gravatar_id":"","url":"https://api.github.com/users/eric-haibin-lin","html_url":"https://github.com/eric-haibin-lin","followers_url":"https://api.github.com/users/eric-haibin-lin/followers","following_url":"https://api.github.com/users/eric-haibin-lin/following{/other_user}","gists_url":"https://api.github.com/users/eric-haibin-lin/gists{/gist_id}","starred_url":"https://api.github.com/users/eric-haibin-lin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eric-haibin-lin/subscriptions","organizations_url":"https://api.github.com/users/eric-haibin-lin/orgs","repos_url":"https://api.github.com/users/eric-haibin-lin/repos","events_url":"https://api.github.com/users/eric-haibin-lin/events{/privacy}","received_events_url":"https://api.github.com/users/eric-haibin-lin/received_events","type":"User","site_admin":false},"labels":[{"id":890393501,"node_id":"MDU6TGFiZWw4OTAzOTM1MDE=","url":"https://api.github.com/repos/dmlc/gluon-nlp/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2018-09-26T05:51:23Z","updated_at":"2018-09-28T13:05:14Z","closed_at":"2018-09-28T13:05:14Z","author_association":"MEMBER","active_lock_reason":null,"body":"```\r\nMXNET_GPU_MEM_POOL_TYPE=Round python3 train_transformer.py --dataset WMT2014BPE                        -$\r\nsrc_lang en --tgt_lang de --batch_size 2700                        --optimizer adam --num_accumulated 16 --lr 2.0 --warmup_steps 4000                        --save_dir transformer_$\r\nn_de_u512 --epochs 30 --gpus 0,1,2,3,4,5,6,7 --scaled                        --average_start 5 --num_buckets 20 --bucket_scheme exp --bleu 13a --log_interval 10 2>&1 | tee base.log\r\n```\r\n\r\n```\r\n2018-09-26 05:38:28,761 - root - Namespace(average_checkpoint=False, average_start=5, batch_size=2700, beam_size=4, bleu='13a', bucket_ratio=0.0, bucket_scheme='exp', dataset='WMT2$\r\n14BPE', dropout=0.1, epochs=30, epsilon=0.1, full=False, gpus='0,1,2,3,4,5,6,7', hidden_size=2048, log_interval=10, lp_alpha=0.6, lp_k=5, lr=2.0, magnitude=3.0, num_accumulated=16,\r\nnum_averages=5, num_buckets=20, num_heads=8, num_layers=6, num_units=512, optimizer='adam', save_dir='transformer_en_de_u512', scaled=True, src_lang='en', src_max_len=-1, test_batc$\r\n_size=256, tgt_lang='de', tgt_max_len=-1, warmup_steps=4000.0)\r\nAll Logs will be saved to transformer_en_de_u512/train_transformer.log\r\nLoad cached data from /home/ubuntu/transformer/scripts/nmt/cached/WMT2014BPE_en_de_-1_-1_train.npz\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.5/dist-packages/numpy/lib/format.py\", line 650, in read_array\r\n    array = pickle.load(fp, **pickle_kwargs)\r\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xfa in position 8: ordinal not in range(128)\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"train_transformer.py\", line 304, in <module>\r\n    = load_translation_data(dataset=args.dataset, src_lang=args.src_lang, tgt_lang=args.tgt_lang)\r\n  File \"train_transformer.py\", line 260, in load_translation_data\r\n    data_train_processed = load_cached_dataset(common_prefix + '_train')\r\n  File \"train_transformer.py\", line 167, in load_cached_dataset\r\n    return ArrayDataset(np.array(dat['src_data']), np.array(dat['tgt_data']))\r\n  File \"/usr/local/lib/python3.5/dist-packages/numpy/lib/npyio.py\", line 235, in __getitem__\r\n    pickle_kwargs=self.pickle_kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/numpy/lib/format.py\", line 656, in read_array\r\n    \"to numpy.load\" % (err,))\r\nUnicodeError: Unpickling a python object failed: UnicodeDecodeError('ascii', b'\\x07 \\x00\\x00ls\\x00\\x00\\xfab\\x00\\x00k]\\x00\\x00`p\\x00\\x00fi\\x00\\x00\\x03\\x00\\x00\\x00', 8, 9, 'ordinal n$\r\nt in range(128)')\r\nYou may need to pass the encoding= option to numpy.load\r\n```","closed_by":{"login":"szhengac","id":3960020,"node_id":"MDQ6VXNlcjM5NjAwMjA=","avatar_url":"https://avatars.githubusercontent.com/u/3960020?v=4","gravatar_id":"","url":"https://api.github.com/users/szhengac","html_url":"https://github.com/szhengac","followers_url":"https://api.github.com/users/szhengac/followers","following_url":"https://api.github.com/users/szhengac/following{/other_user}","gists_url":"https://api.github.com/users/szhengac/gists{/gist_id}","starred_url":"https://api.github.com/users/szhengac/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szhengac/subscriptions","organizations_url":"https://api.github.com/users/szhengac/orgs","repos_url":"https://api.github.com/users/szhengac/repos","events_url":"https://api.github.com/users/szhengac/events{/privacy}","received_events_url":"https://api.github.com/users/szhengac/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/349/timeline","performed_via_github_app":null,"state_reason":"completed"}