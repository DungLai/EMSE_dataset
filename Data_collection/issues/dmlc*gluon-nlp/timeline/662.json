[{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483495830","html_url":"https://github.com/dmlc/gluon-nlp/issues/662#issuecomment-483495830","issue_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/662","id":483495830,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MzQ5NTgzMA==","user":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"created_at":"2019-04-16T03:19:26Z","updated_at":"2019-04-16T03:19:26Z","author_association":"MEMBER","body":"I was able to reproduce the problem. Also, I noticed a warning:\r\n```\r\ngluon-nlp/scripts/bert/dataset.py:91: UserWarning: 1063 samples have been filtered out due to parsing error.\r\n```","reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483495830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483496666","html_url":"https://github.com/dmlc/gluon-nlp/issues/662#issuecomment-483496666","issue_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/662","id":483496666,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MzQ5NjY2Ng==","user":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"created_at":"2019-04-16T03:24:39Z","updated_at":"2019-04-16T03:24:39Z","author_association":"MEMBER","body":"Looks like the test.tsv file for CoLA only has two columns, so this index is a typo (which should have been 1): https://github.com/dmlc/gluon-nlp/blob/master/scripts/bert/dataset.py#L301","reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483496666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483496746","html_url":"https://github.com/dmlc/gluon-nlp/issues/662#issuecomment-483496746","issue_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/662","id":483496746,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MzQ5Njc0Ng==","user":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"created_at":"2019-04-16T03:25:13Z","updated_at":"2019-04-16T03:25:13Z","author_association":"MEMBER","body":"cc'd @haven-jeon @eric-haibin-lin ","reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483496746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false}},{"id":2278405920,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI3ODQwNTkyMA==","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2278405920","actor":{"login":"haven-jeon","id":957840,"node_id":"MDQ6VXNlcjk1Nzg0MA==","avatar_url":"https://avatars.githubusercontent.com/u/957840?v=4","gravatar_id":"","url":"https://api.github.com/users/haven-jeon","html_url":"https://github.com/haven-jeon","followers_url":"https://api.github.com/users/haven-jeon/followers","following_url":"https://api.github.com/users/haven-jeon/following{/other_user}","gists_url":"https://api.github.com/users/haven-jeon/gists{/gist_id}","starred_url":"https://api.github.com/users/haven-jeon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haven-jeon/subscriptions","organizations_url":"https://api.github.com/users/haven-jeon/orgs","repos_url":"https://api.github.com/users/haven-jeon/repos","events_url":"https://api.github.com/users/haven-jeon/events{/privacy}","received_events_url":"https://api.github.com/users/haven-jeon/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-16T03:25:13Z","performed_via_github_app":null},{"id":2278405921,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyNzg0MDU5MjE=","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2278405921","actor":{"login":"haven-jeon","id":957840,"node_id":"MDQ6VXNlcjk1Nzg0MA==","avatar_url":"https://avatars.githubusercontent.com/u/957840?v=4","gravatar_id":"","url":"https://api.github.com/users/haven-jeon","html_url":"https://github.com/haven-jeon","followers_url":"https://api.github.com/users/haven-jeon/followers","following_url":"https://api.github.com/users/haven-jeon/following{/other_user}","gists_url":"https://api.github.com/users/haven-jeon/gists{/gist_id}","starred_url":"https://api.github.com/users/haven-jeon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haven-jeon/subscriptions","organizations_url":"https://api.github.com/users/haven-jeon/orgs","repos_url":"https://api.github.com/users/haven-jeon/repos","events_url":"https://api.github.com/users/haven-jeon/events{/privacy}","received_events_url":"https://api.github.com/users/haven-jeon/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-16T03:25:13Z","performed_via_github_app":null},{"id":2278405923,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI3ODQwNTkyMw==","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2278405923","actor":{"login":"eric-haibin-lin","id":5545640,"node_id":"MDQ6VXNlcjU1NDU2NDA=","avatar_url":"https://avatars.githubusercontent.com/u/5545640?v=4","gravatar_id":"","url":"https://api.github.com/users/eric-haibin-lin","html_url":"https://github.com/eric-haibin-lin","followers_url":"https://api.github.com/users/eric-haibin-lin/followers","following_url":"https://api.github.com/users/eric-haibin-lin/following{/other_user}","gists_url":"https://api.github.com/users/eric-haibin-lin/gists{/gist_id}","starred_url":"https://api.github.com/users/eric-haibin-lin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eric-haibin-lin/subscriptions","organizations_url":"https://api.github.com/users/eric-haibin-lin/orgs","repos_url":"https://api.github.com/users/eric-haibin-lin/repos","events_url":"https://api.github.com/users/eric-haibin-lin/events{/privacy}","received_events_url":"https://api.github.com/users/eric-haibin-lin/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-16T03:25:13Z","performed_via_github_app":null},{"id":2278405924,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyNzg0MDU5MjQ=","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2278405924","actor":{"login":"eric-haibin-lin","id":5545640,"node_id":"MDQ6VXNlcjU1NDU2NDA=","avatar_url":"https://avatars.githubusercontent.com/u/5545640?v=4","gravatar_id":"","url":"https://api.github.com/users/eric-haibin-lin","html_url":"https://github.com/eric-haibin-lin","followers_url":"https://api.github.com/users/eric-haibin-lin/followers","following_url":"https://api.github.com/users/eric-haibin-lin/following{/other_user}","gists_url":"https://api.github.com/users/eric-haibin-lin/gists{/gist_id}","starred_url":"https://api.github.com/users/eric-haibin-lin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eric-haibin-lin/subscriptions","organizations_url":"https://api.github.com/users/eric-haibin-lin/orgs","repos_url":"https://api.github.com/users/eric-haibin-lin/repos","events_url":"https://api.github.com/users/eric-haibin-lin/events{/privacy}","received_events_url":"https://api.github.com/users/eric-haibin-lin/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-16T03:25:13Z","performed_via_github_app":null},{"id":2278406021,"node_id":"MDEyOkxhYmVsZWRFdmVudDIyNzg0MDYwMjE=","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2278406021","actor":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-04-16T03:25:18Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483498028","html_url":"https://github.com/dmlc/gluon-nlp/issues/662#issuecomment-483498028","issue_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/662","id":483498028,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MzQ5ODAyOA==","user":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false},"created_at":"2019-04-16T03:32:59Z","updated_at":"2019-04-16T03:32:59Z","author_association":"NONE","body":"> I was able to reproduce the problem. Also, I noticed a warning:\r\n> \r\n> ```\r\n> gluon-nlp/scripts/bert/dataset.py:91: UserWarning: 1063 samples have been filtered out due to parsing error.\r\n> ```\r\n\r\n\r\n\r\n\r\n\r\n@szha So how to solve it? \r\n\r\n","reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483498028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false}},{"id":2278414065,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI3ODQxNDA2NQ==","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2278414065","actor":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-16T03:32:59Z","performed_via_github_app":null},{"id":2278414066,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyNzg0MTQwNjY=","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2278414066","actor":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-16T03:32:59Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483498688","html_url":"https://github.com/dmlc/gluon-nlp/issues/662#issuecomment-483498688","issue_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/662","id":483498688,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MzQ5ODY4OA==","user":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false},"created_at":"2019-04-16T03:37:20Z","updated_at":"2019-04-16T03:37:20Z","author_association":"NONE","body":"@szha  When I come to the test.tsv in CoLA dataset,I found the indice of sentense is 1,So I change the code in class COLADataset：\r\n\r\n  ```\r\n  def __init__(self,\r\n                 segment='train',\r\n                 root=os.path.join(\r\n                     os.getenv('GLUE_DIR', 'glue_data'), task_name)):\r\n        self._supported_segments = ['train', 'dev', 'test']\r\n        assert segment in self._supported_segments, 'Unsupported segment: %s' % segment\r\n        path = os.path.join(root, '%s.tsv' % segment)\r\n        if segment in ['train', 'dev']:\r\n            A_IDX, LABEL_IDX = 3, 1\r\n            fields = [A_IDX, LABEL_IDX]\r\n            super(COLADataset, self).__init__(\r\n                path, num_discard_samples=0, fields=fields)\r\n        elif segment == 'test':\r\n            A_IDX = 1\r\n            fields = [A_IDX]\r\n            super(COLADataset, self).__init__(\r\n                path, num_discard_samples=1, fields=fields)\r\n```\r\n\r\nBut it did not work .","reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483498688/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false}},{"id":2278418439,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI3ODQxODQzOQ==","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2278418439","actor":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-16T03:37:21Z","performed_via_github_app":null},{"id":2278418441,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyNzg0MTg0NDE=","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2278418441","actor":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-16T03:37:21Z","performed_via_github_app":null},{"id":2278426422,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjI3ODQyNjQyMg==","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2278426422","actor":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2019-04-16T03:44:09Z","rename":{"from":"how to inference after finetune a classifier in the secipt of bert?","to":"how to inference after finetune a classifier in the script of bert?"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483501067","html_url":"https://github.com/dmlc/gluon-nlp/issues/662#issuecomment-483501067","issue_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/662","id":483501067,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MzUwMTA2Nw==","user":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"created_at":"2019-04-16T03:51:59Z","updated_at":"2019-04-16T03:51:59Z","author_association":"MEMBER","body":"@Gpwner this is the fix that I was alluding to in my previous comment, and in my case it fixed the problem. Are you using the class that you edited and it's still not work?","reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483501067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false}},{"id":2278434863,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI3ODQzNDg2Mw==","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2278434863","actor":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-16T03:51:59Z","performed_via_github_app":null},{"id":2278434864,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyNzg0MzQ4NjQ=","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2278434864","actor":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-16T03:51:59Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483520249","html_url":"https://github.com/dmlc/gluon-nlp/issues/662#issuecomment-483520249","issue_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/662","id":483520249,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MzUyMDI0OQ==","user":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false},"created_at":"2019-04-16T05:49:00Z","updated_at":"2019-04-16T05:49:00Z","author_association":"NONE","body":"> sing the class that you edited and it's still not work\r\n\r\n@szha yes it is still not work.\r\n\r\nHere is my _preprocess_data():_\r\n```\r\ndef preprocess_data(tokenizer, task, batch_size, dev_batch_size, max_len):\r\n    \"\"\"Data preparation function.\"\"\"\r\n    # transformation\r\n    trans = BERTDatasetTransform(\r\n        tokenizer,\r\n        max_len,\r\n        labels=task.get_labels(),\r\n        pad=False,\r\n        pair=task.is_pair,\r\n        label_dtype='float32' if not task.get_labels() else 'int32')\r\n\r\n    data_train = task('train').transform(trans, lazy=False)\r\n    data_train_len = data_train.transform(\r\n        lambda input_id, length, segment_id, label_id: length)\r\n\r\n    num_samples_train = len(data_train)\r\n    # bucket sampler\r\n    batchify_fn = nlp.data.batchify.Tuple(\r\n        nlp.data.batchify.Pad(axis=0), nlp.data.batchify.Stack(),\r\n        nlp.data.batchify.Pad(axis=0),\r\n        nlp.data.batchify.Stack(\r\n            'float32' if not task.get_labels() else 'int32'))\r\n    batch_sampler = nlp.data.sampler.FixedBucketSampler(\r\n        data_train_len,\r\n        batch_size=batch_size,\r\n        num_buckets=10,\r\n        ratio=0,\r\n        shuffle=True)\r\n    # data loaders\r\n    dataloader_train = gluon.data.DataLoader(\r\n        dataset=data_train,\r\n        num_workers=1,\r\n        batch_sampler=batch_sampler,\r\n        batchify_fn=batchify_fn)\r\n\r\n\r\n\r\n    data_dev = task('dev').transform(trans, lazy=False)\r\n    dataloader_dev = mx.gluon.data.DataLoader(\r\n        data_dev,\r\n        batch_size=dev_batch_size,\r\n        num_workers=1,\r\n        shuffle=False,\r\n        batchify_fn=batchify_fn)\r\n\r\n\r\n    data_rest = task('test').transform(trans, lazy=False)\r\n    dataloader_test = mx.gluon.data.DataLoader(\r\n        data_rest,\r\n        batch_size=dev_batch_size,\r\n        num_workers=1,\r\n        shuffle=False,\r\n        batchify_fn=batchify_fn)\r\n    print('dataloader_train:{}'.format(len(dataloader_train)))\r\n    print('dataloader_dev:{}'.format(len(dataloader_dev)))\r\n    print('dataloader_test:{}'.format(len(dataloader_test)))\r\n    return dataloader_train, dataloader_dev, num_samples_train\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483520249/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false}},{"id":2278563766,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI3ODU2Mzc2Ng==","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2278563766","actor":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-16T05:49:01Z","performed_via_github_app":null},{"id":2278563768,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyNzg1NjM3Njg=","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2278563768","actor":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-16T05:49:01Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483872597","html_url":"https://github.com/dmlc/gluon-nlp/issues/662#issuecomment-483872597","issue_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/662","id":483872597,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4Mzg3MjU5Nw==","user":{"login":"eric-haibin-lin","id":5545640,"node_id":"MDQ6VXNlcjU1NDU2NDA=","avatar_url":"https://avatars.githubusercontent.com/u/5545640?v=4","gravatar_id":"","url":"https://api.github.com/users/eric-haibin-lin","html_url":"https://github.com/eric-haibin-lin","followers_url":"https://api.github.com/users/eric-haibin-lin/followers","following_url":"https://api.github.com/users/eric-haibin-lin/following{/other_user}","gists_url":"https://api.github.com/users/eric-haibin-lin/gists{/gist_id}","starred_url":"https://api.github.com/users/eric-haibin-lin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eric-haibin-lin/subscriptions","organizations_url":"https://api.github.com/users/eric-haibin-lin/orgs","repos_url":"https://api.github.com/users/eric-haibin-lin/repos","events_url":"https://api.github.com/users/eric-haibin-lin/events{/privacy}","received_events_url":"https://api.github.com/users/eric-haibin-lin/received_events","type":"User","site_admin":false},"created_at":"2019-04-16T22:51:14Z","updated_at":"2019-04-16T22:51:14Z","author_association":"MEMBER","body":"@Gpwner thanks for raising this issue. It looks like the test set does not have any label, and the implementation of `BERTDatasetTransform ` always return labels (see https://github.com/dmlc/gluon-nlp/blob/master/scripts/bert/dataset.py#L544-L551) \r\nTherefore, you cannot reuse the `trans` obj to read the test set. Could you try to change \r\n```\r\n        input_ids, valid_length, segment_ids = self._bert_xform(line[:-1])\r\n\r\n        label = line[-1]\r\n        if self.labels:  # for classification task\r\n            label = self._label_map[label]\r\n        label = np.array([label], dtype=self.label_dtype)\r\n\r\n        return input_ids, valid_length, segment_ids, label\r\n\r\n```\r\nto \r\n```\r\n        input_ids, valid_length, segment_ids = self._bert_xform(line[:-1])\r\n        if self.labels:\r\n            label = line[-1]\r\n            label = self._label_map[label]\r\n            label = np.array([label], dtype=self.label_dtype)\r\n            return input_ids, valid_length, segment_ids, label\r\n        else:\r\n            return input_ids, valid_length, segment_ids\r\n\r\n```\r\nand use a separate transform just for the test set:\r\n```\r\n    trans_test = BERTDatasetTransform(\r\n        tokenizer,\r\n        max_len,\r\n        labels=None,\r\n        pad=False,\r\n        pair=task.is_pair)\r\n```","reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483872597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"eric-haibin-lin","id":5545640,"node_id":"MDQ6VXNlcjU1NDU2NDA=","avatar_url":"https://avatars.githubusercontent.com/u/5545640?v=4","gravatar_id":"","url":"https://api.github.com/users/eric-haibin-lin","html_url":"https://github.com/eric-haibin-lin","followers_url":"https://api.github.com/users/eric-haibin-lin/followers","following_url":"https://api.github.com/users/eric-haibin-lin/following{/other_user}","gists_url":"https://api.github.com/users/eric-haibin-lin/gists{/gist_id}","starred_url":"https://api.github.com/users/eric-haibin-lin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eric-haibin-lin/subscriptions","organizations_url":"https://api.github.com/users/eric-haibin-lin/orgs","repos_url":"https://api.github.com/users/eric-haibin-lin/repos","events_url":"https://api.github.com/users/eric-haibin-lin/events{/privacy}","received_events_url":"https://api.github.com/users/eric-haibin-lin/received_events","type":"User","site_admin":false}},{"id":2281162423,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI4MTE2MjQyMw==","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2281162423","actor":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-16T22:51:14Z","performed_via_github_app":null},{"id":2281162424,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyODExNjI0MjQ=","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2281162424","actor":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-16T22:51:14Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483903393","html_url":"https://github.com/dmlc/gluon-nlp/issues/662#issuecomment-483903393","issue_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/662","id":483903393,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MzkwMzM5Mw==","user":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false},"created_at":"2019-04-17T01:34:08Z","updated_at":"2019-04-17T01:36:05Z","author_association":"NONE","body":"@eric-haibin-lin I try your solution ，But It is still not work.\r\nHere are my  code:\r\n\r\n_finetune_classify.py:_\r\n\r\n```\r\n...\r\ndef preprocess_data(tokenizer, task, batch_size, dev_batch_size, max_len, root_path):\r\n    \"\"\"Data preparation function.\"\"\"\r\n    # transformation\r\n    trans = BERTDatasetTransform(\r\n        tokenizer,\r\n        max_len,\r\n        labels=task.get_labels(),\r\n        pad=False,\r\n        pair=task.is_pair,\r\n        label_dtype='float32' if not task.get_labels() else 'int32')\r\n\r\n    data_train = task('train', root=root_path).transform(trans, lazy=False)\r\n    data_train_len = data_train.transform(\r\n        lambda input_id, length, segment_id, label_id: length)\r\n\r\n    num_samples_train = len(data_train)\r\n    # bucket sampler\r\n    batchify_fn = nlp.data.batchify.Tuple(\r\n        nlp.data.batchify.Pad(axis=0), nlp.data.batchify.Stack(),\r\n        nlp.data.batchify.Pad(axis=0),\r\n        nlp.data.batchify.Stack(\r\n            'float32' if not task.get_labels() else 'int32'))\r\n    batch_sampler = nlp.data.sampler.FixedBucketSampler(\r\n        data_train_len,\r\n        batch_size=batch_size,\r\n        num_buckets=10,\r\n        ratio=0,\r\n        shuffle=True)\r\n    # data loaders\r\n    dataloader_train = gluon.data.DataLoader(\r\n        dataset=data_train,\r\n        num_workers=1,\r\n        batch_sampler=batch_sampler,\r\n        batchify_fn=batchify_fn)\r\n\r\n    data_dev = task('dev', root=root_path).transform(trans, lazy=False)\r\n    dataloader_dev = mx.gluon.data.DataLoader(\r\n        data_dev,\r\n        batch_size=dev_batch_size,\r\n        num_workers=1,\r\n        shuffle=False,\r\n        batchify_fn=batchify_fn)\r\n\r\n    trans_test = BERTDatasetTransform(\r\n        tokenizer,\r\n        max_len,\r\n        labels=None,\r\n        pad=False,\r\n        pair=task.is_pair)\r\n\r\n    data_test = task('test', root=root_path).transform(trans_test, lazy=False)\r\n    dataloader_test = mx.gluon.data.DataLoader(\r\n        data_test,\r\n        batch_size=dev_batch_size,\r\n        num_workers=1,\r\n        shuffle=False,\r\n        batchify_fn=batchify_fn)\r\n    print('dataloader_train:{}'.format(len(dataloader_train)))\r\n    print('dataloader_dev:{}'.format(len(dataloader_dev)))\r\n    print('dataloader_test:{}'.format(len(dataloader_test)))\r\n    return dataloader_train, dataloader_dev, dataloader_test, num_samples_train\r\n```\r\n_dataset.py:_\r\n\r\n```\r\n@register(segment=['train', 'dev', 'test'])\r\nclass COLADataset(GLUEDataset):\r\n    \"\"\"Class for Warstdadt acceptability task\r\n\r\n    Parameters\r\n    ----------\r\n    segment : str or list of str, default 'train'\r\n        Dataset segment. Options are 'train', 'dev', 'test' or their combinations.\r\n    root : str, default '$GLUE_DIR/CoLA\r\n        Path to the folder which stores the CoLA dataset.\r\n        The datset can be downloaded by the following script:\r\n        https://gist.github.com/W4ngatang/60c2bdb54d156a41194446737ce03e2e\r\n    \"\"\"\r\n    task_name = 'CoLA'\r\n    is_pair = False\r\n\r\n    def __init__(self,\r\n                 segment='train',\r\n                 root=os.path.join(\r\n                     os.getenv('GLUE_DIR', 'glue_data'), task_name)):\r\n        self._supported_segments = ['train', 'dev', 'test']\r\n        assert segment in self._supported_segments, 'Unsupported segment: %s' % segment\r\n        path = os.path.join(root, '%s.tsv' % segment)\r\n        if segment in ['train', 'dev']:\r\n            A_IDX, LABEL_IDX = 3, 1\r\n            fields = [A_IDX, LABEL_IDX]\r\n            super(COLADataset, self).__init__(\r\n                path, num_discard_samples=0, fields=fields)\r\n        elif segment == 'test':\r\n            A_IDX = 1\r\n            fields = [A_IDX]\r\n            super(COLADataset, self).__init__(\r\n                path, num_discard_samples=1, fields=fields)\r\n\r\n    @staticmethod\r\n    def get_metric():\r\n        \"\"\"Get metrics  Matthews Correlation Coefficient\"\"\"\r\n        return MCC(average='micro')\r\n\r\n    @staticmethod\r\n    def get_labels():\r\n        \"\"\"Get classification label ids of the dataset.\"\"\"\r\n        return ['0', '1']\r\n\r\n\r\n...\r\n\r\nclass BERTDatasetTransform(object):\r\n    \"\"\"Dataset Transformation for BERT-style Sentence Classification or Regression.\r\n\r\n    Parameters\r\n    ----------\r\n    tokenizer : BERTTokenizer.\r\n        Tokenizer for the sentences.\r\n    max_seq_length : int.\r\n        Maximum sequence length of the sentences.\r\n    labels : list of int , float or None. defaults None\r\n        List of all label ids for the classification task and regressing task.\r\n        If labels is None, the default task is regression\r\n    pad : bool, default True\r\n        Whether to pad the sentences to maximum length.\r\n    pair : bool, default True\r\n        Whether to transform sentences or sentence pairs.\r\n    label_dtype: int32 or float32, default float32\r\n        label_dtype = int32 for classification task\r\n        label_dtype = float32 for regression task\r\n    \"\"\"\r\n\r\n    def __init__(self,\r\n                 tokenizer,\r\n                 max_seq_length,\r\n                 labels=None,\r\n                 pad=True,\r\n                 pair=True,\r\n                 label_dtype='float32'):\r\n        self.label_dtype = label_dtype\r\n        self.labels = labels\r\n        if self.labels:\r\n            self._label_map = {}\r\n            for (i, label) in enumerate(labels):\r\n                self._label_map[label] = i\r\n        self._bert_xform = BERTSentenceTransform(\r\n            tokenizer, max_seq_length, pad=pad, pair=pair)\r\n\r\n    def __call__(self, line):\r\n       '''\r\n       ...\r\n       '''\r\n        input_ids, valid_length, segment_ids = self._bert_xform(line[:-1])\r\n        if self.labels:\r\n            label = line[-1]\r\n            label = self._label_map[label]\r\n            label = np.array([label], dtype=self.label_dtype)\r\n            return input_ids, valid_length, segment_ids, label\r\n        else:\r\n            return input_ids, valid_length, segment_ids\r\n\r\n```\r\n\r\nhere is my output:\r\n```\r\nINFO:root:processing dataset...\r\ndataloader_train:540\r\ndataloader_dev:131\r\ndataloader_test:0\r\n```","reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/483903393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false}},{"id":2281364287,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI4MTM2NDI4Nw==","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2281364287","actor":{"login":"eric-haibin-lin","id":5545640,"node_id":"MDQ6VXNlcjU1NDU2NDA=","avatar_url":"https://avatars.githubusercontent.com/u/5545640?v=4","gravatar_id":"","url":"https://api.github.com/users/eric-haibin-lin","html_url":"https://github.com/eric-haibin-lin","followers_url":"https://api.github.com/users/eric-haibin-lin/followers","following_url":"https://api.github.com/users/eric-haibin-lin/following{/other_user}","gists_url":"https://api.github.com/users/eric-haibin-lin/gists{/gist_id}","starred_url":"https://api.github.com/users/eric-haibin-lin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eric-haibin-lin/subscriptions","organizations_url":"https://api.github.com/users/eric-haibin-lin/orgs","repos_url":"https://api.github.com/users/eric-haibin-lin/repos","events_url":"https://api.github.com/users/eric-haibin-lin/events{/privacy}","received_events_url":"https://api.github.com/users/eric-haibin-lin/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-17T01:34:08Z","performed_via_github_app":null},{"id":2281364288,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyODEzNjQyODg=","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2281364288","actor":{"login":"eric-haibin-lin","id":5545640,"node_id":"MDQ6VXNlcjU1NDU2NDA=","avatar_url":"https://avatars.githubusercontent.com/u/5545640?v=4","gravatar_id":"","url":"https://api.github.com/users/eric-haibin-lin","html_url":"https://github.com/eric-haibin-lin","followers_url":"https://api.github.com/users/eric-haibin-lin/followers","following_url":"https://api.github.com/users/eric-haibin-lin/following{/other_user}","gists_url":"https://api.github.com/users/eric-haibin-lin/gists{/gist_id}","starred_url":"https://api.github.com/users/eric-haibin-lin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eric-haibin-lin/subscriptions","organizations_url":"https://api.github.com/users/eric-haibin-lin/orgs","repos_url":"https://api.github.com/users/eric-haibin-lin/repos","events_url":"https://api.github.com/users/eric-haibin-lin/events{/privacy}","received_events_url":"https://api.github.com/users/eric-haibin-lin/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-17T01:34:08Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/484754012","html_url":"https://github.com/dmlc/gluon-nlp/issues/662#issuecomment-484754012","issue_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/662","id":484754012,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4NDc1NDAxMg==","user":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false},"created_at":"2019-04-19T03:10:08Z","updated_at":"2019-04-19T03:10:29Z","author_association":"NONE","body":"@szha  @eric-haibin-lin For now ，my solution is add  fake labels for test data .And change init function in CoLA code in dataset.py.And it work.\r\n ","reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/484754012/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null,"event":"commented","actor":{"login":"Gpwner","id":19349207,"node_id":"MDQ6VXNlcjE5MzQ5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/19349207?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpwner","html_url":"https://github.com/Gpwner","followers_url":"https://api.github.com/users/Gpwner/followers","following_url":"https://api.github.com/users/Gpwner/following{/other_user}","gists_url":"https://api.github.com/users/Gpwner/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpwner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpwner/subscriptions","organizations_url":"https://api.github.com/users/Gpwner/orgs","repos_url":"https://api.github.com/users/Gpwner/repos","events_url":"https://api.github.com/users/Gpwner/events{/privacy}","received_events_url":"https://api.github.com/users/Gpwner/received_events","type":"User","site_admin":false}},{"id":2287354745,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjI4NzM1NDc0NQ==","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2287354745","actor":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-04-19T03:10:08Z","performed_via_github_app":null},{"id":2287354746,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyODczNTQ3NDY=","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/2287354746","actor":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-04-19T03:10:08Z","performed_via_github_app":null}]