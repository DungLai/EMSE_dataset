[{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/409390277","html_url":"https://github.com/dmlc/gluon-nlp/issues/238#issuecomment-409390277","issue_url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/238","id":409390277,"node_id":"MDEyOklzc3VlQ29tbWVudDQwOTM5MDI3Nw==","user":{"login":"szhengac","id":3960020,"node_id":"MDQ6VXNlcjM5NjAwMjA=","avatar_url":"https://avatars.githubusercontent.com/u/3960020?v=4","gravatar_id":"","url":"https://api.github.com/users/szhengac","html_url":"https://github.com/szhengac","followers_url":"https://api.github.com/users/szhengac/followers","following_url":"https://api.github.com/users/szhengac/following{/other_user}","gists_url":"https://api.github.com/users/szhengac/gists{/gist_id}","starred_url":"https://api.github.com/users/szhengac/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szhengac/subscriptions","organizations_url":"https://api.github.com/users/szhengac/orgs","repos_url":"https://api.github.com/users/szhengac/repos","events_url":"https://api.github.com/users/szhengac/events{/privacy}","received_events_url":"https://api.github.com/users/szhengac/received_events","type":"User","site_admin":false},"created_at":"2018-07-31T22:35:45Z","updated_at":"2018-07-31T22:36:45Z","author_association":"MEMBER","body":"@JulianSlzr , in the current nmt scripts, the token loss is averaged by the total number of the tokens in the mini-batch. You can imagine it by concatenating all the sequences in the mini-batch to a single one and taking average. You can find it in the following code.\r\n`loss = loss * (tgt_seq.shape[1] - 1) / (tgt_valid_length - 1).mean()`\r\nThis ensures that all the tokens are equally weighted. In fact, we are minimizing the following objective:\r\n`\\sum_{i=1}^N\\sum_{t=1}^{T_i}\\logP(y_t^i|y_1^i, ...y_{t-1}^i, X^i, \\Theta)`\r\nBut sure, what you propose can be useful in some scenarios. A PR is always welcome.","reactions":{"url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/comments/409390277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"szhengac","id":3960020,"node_id":"MDQ6VXNlcjM5NjAwMjA=","avatar_url":"https://avatars.githubusercontent.com/u/3960020?v=4","gravatar_id":"","url":"https://api.github.com/users/szhengac","html_url":"https://github.com/szhengac","followers_url":"https://api.github.com/users/szhengac/followers","following_url":"https://api.github.com/users/szhengac/following{/other_user}","gists_url":"https://api.github.com/users/szhengac/gists{/gist_id}","starred_url":"https://api.github.com/users/szhengac/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szhengac/subscriptions","organizations_url":"https://api.github.com/users/szhengac/orgs","repos_url":"https://api.github.com/users/szhengac/repos","events_url":"https://api.github.com/users/szhengac/events{/privacy}","received_events_url":"https://api.github.com/users/szhengac/received_events","type":"User","site_admin":false}},{"id":1763929563,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTc2MzkyOTU2Mw==","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/1763929563","actor":{"login":"JulianSlzr","id":4734836,"node_id":"MDQ6VXNlcjQ3MzQ4MzY=","avatar_url":"https://avatars.githubusercontent.com/u/4734836?v=4","gravatar_id":"","url":"https://api.github.com/users/JulianSlzr","html_url":"https://github.com/JulianSlzr","followers_url":"https://api.github.com/users/JulianSlzr/followers","following_url":"https://api.github.com/users/JulianSlzr/following{/other_user}","gists_url":"https://api.github.com/users/JulianSlzr/gists{/gist_id}","starred_url":"https://api.github.com/users/JulianSlzr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JulianSlzr/subscriptions","organizations_url":"https://api.github.com/users/JulianSlzr/orgs","repos_url":"https://api.github.com/users/JulianSlzr/repos","events_url":"https://api.github.com/users/JulianSlzr/events{/privacy}","received_events_url":"https://api.github.com/users/JulianSlzr/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-07-31T22:35:45Z","performed_via_github_app":null},{"id":1763929564,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE3NjM5Mjk1NjQ=","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/1763929564","actor":{"login":"JulianSlzr","id":4734836,"node_id":"MDQ6VXNlcjQ3MzQ4MzY=","avatar_url":"https://avatars.githubusercontent.com/u/4734836?v=4","gravatar_id":"","url":"https://api.github.com/users/JulianSlzr","html_url":"https://github.com/JulianSlzr","followers_url":"https://api.github.com/users/JulianSlzr/followers","following_url":"https://api.github.com/users/JulianSlzr/following{/other_user}","gists_url":"https://api.github.com/users/JulianSlzr/gists{/gist_id}","starred_url":"https://api.github.com/users/JulianSlzr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JulianSlzr/subscriptions","organizations_url":"https://api.github.com/users/JulianSlzr/orgs","repos_url":"https://api.github.com/users/JulianSlzr/repos","events_url":"https://api.github.com/users/JulianSlzr/events{/privacy}","received_events_url":"https://api.github.com/users/JulianSlzr/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-07-31T22:35:45Z","performed_via_github_app":null},{"id":1784262932,"node_id":"MDEyOkxhYmVsZWRFdmVudDE3ODQyNjI5MzI=","url":"https://api.github.com/repos/dmlc/gluon-nlp/issues/events/1784262932","actor":{"login":"szha","id":2626883,"node_id":"MDQ6VXNlcjI2MjY4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/2626883?v=4","gravatar_id":"","url":"https://api.github.com/users/szha","html_url":"https://github.com/szha","followers_url":"https://api.github.com/users/szha/followers","following_url":"https://api.github.com/users/szha/following{/other_user}","gists_url":"https://api.github.com/users/szha/gists{/gist_id}","starred_url":"https://api.github.com/users/szha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szha/subscriptions","organizations_url":"https://api.github.com/users/szha/orgs","repos_url":"https://api.github.com/users/szha/repos","events_url":"https://api.github.com/users/szha/events{/privacy}","received_events_url":"https://api.github.com/users/szha/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2018-08-12T19:52:42Z","label":{"name":"discussion","color":"c5def5"},"performed_via_github_app":null}]