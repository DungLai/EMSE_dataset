[{"url":"https://api.github.com/repos/DrSleep/light-weight-refinenet/issues/comments/720984525","html_url":"https://github.com/DrSleep/light-weight-refinenet/issues/62#issuecomment-720984525","issue_url":"https://api.github.com/repos/DrSleep/light-weight-refinenet/issues/62","id":720984525,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDk4NDUyNQ==","user":{"login":"DrSleep","id":7841432,"node_id":"MDQ6VXNlcjc4NDE0MzI=","avatar_url":"https://avatars.githubusercontent.com/u/7841432?v=4","gravatar_id":"","url":"https://api.github.com/users/DrSleep","html_url":"https://github.com/DrSleep","followers_url":"https://api.github.com/users/DrSleep/followers","following_url":"https://api.github.com/users/DrSleep/following{/other_user}","gists_url":"https://api.github.com/users/DrSleep/gists{/gist_id}","starred_url":"https://api.github.com/users/DrSleep/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DrSleep/subscriptions","organizations_url":"https://api.github.com/users/DrSleep/orgs","repos_url":"https://api.github.com/users/DrSleep/repos","events_url":"https://api.github.com/users/DrSleep/events{/privacy}","received_events_url":"https://api.github.com/users/DrSleep/received_events","type":"User","site_admin":false},"created_at":"2020-11-03T08:52:25Z","updated_at":"2020-11-03T08:52:25Z","author_association":"OWNER","body":"You first need to define the model you trained (i.e. MBv2, or RF-LW-50/101/152) with the appropriate number of classes.\r\nIn the notebook I show how to do it for each network, using this: `net = fun(n_classes, pretrained=True).eval().cuda()`.\r\n\r\nYou should replace `fun` with the appropriate network function and set `pretrained=False`\r\nThen you need to load the checkpoint file, e.g. via `ckpt = torch.load(checkpoint)`\r\nIf you trained your model with GPU, then you will need to do `net = nn.DataParallel(net)` before restoring the state dict `net.load_state_dict(ckpt[\"model\"])` (if you were not training with GPU, you can just skip the first step)\r\n\r\nYou can also see how I am loading the checkpoint here: https://github.com/DrSleep/light-weight-refinenet/blob/b6871c2d5ff84b5a22b4461deb2827a69a02a072/src_v2/train.py#L40\r\n","reactions":{"url":"https://api.github.com/repos/DrSleep/light-weight-refinenet/issues/comments/720984525/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"DrSleep","id":7841432,"node_id":"MDQ6VXNlcjc4NDE0MzI=","avatar_url":"https://avatars.githubusercontent.com/u/7841432?v=4","gravatar_id":"","url":"https://api.github.com/users/DrSleep","html_url":"https://github.com/DrSleep","followers_url":"https://api.github.com/users/DrSleep/followers","following_url":"https://api.github.com/users/DrSleep/following{/other_user}","gists_url":"https://api.github.com/users/DrSleep/gists{/gist_id}","starred_url":"https://api.github.com/users/DrSleep/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DrSleep/subscriptions","organizations_url":"https://api.github.com/users/DrSleep/orgs","repos_url":"https://api.github.com/users/DrSleep/repos","events_url":"https://api.github.com/users/DrSleep/events{/privacy}","received_events_url":"https://api.github.com/users/DrSleep/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DrSleep/light-weight-refinenet/issues/comments/721088909","html_url":"https://github.com/DrSleep/light-weight-refinenet/issues/62#issuecomment-721088909","issue_url":"https://api.github.com/repos/DrSleep/light-weight-refinenet/issues/62","id":721088909,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTA4ODkwOQ==","user":{"login":"hyclover","id":44492334,"node_id":"MDQ6VXNlcjQ0NDkyMzM0","avatar_url":"https://avatars.githubusercontent.com/u/44492334?v=4","gravatar_id":"","url":"https://api.github.com/users/hyclover","html_url":"https://github.com/hyclover","followers_url":"https://api.github.com/users/hyclover/followers","following_url":"https://api.github.com/users/hyclover/following{/other_user}","gists_url":"https://api.github.com/users/hyclover/gists{/gist_id}","starred_url":"https://api.github.com/users/hyclover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hyclover/subscriptions","organizations_url":"https://api.github.com/users/hyclover/orgs","repos_url":"https://api.github.com/users/hyclover/repos","events_url":"https://api.github.com/users/hyclover/events{/privacy}","received_events_url":"https://api.github.com/users/hyclover/received_events","type":"User","site_admin":false},"created_at":"2020-11-03T12:33:11Z","updated_at":"2020-11-03T12:33:11Z","author_association":"NONE","body":"Thanks for your reply! I have achieved it successfully according to your guidance.","reactions":{"url":"https://api.github.com/repos/DrSleep/light-weight-refinenet/issues/comments/721088909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hyclover","id":44492334,"node_id":"MDQ6VXNlcjQ0NDkyMzM0","avatar_url":"https://avatars.githubusercontent.com/u/44492334?v=4","gravatar_id":"","url":"https://api.github.com/users/hyclover","html_url":"https://github.com/hyclover","followers_url":"https://api.github.com/users/hyclover/followers","following_url":"https://api.github.com/users/hyclover/following{/other_user}","gists_url":"https://api.github.com/users/hyclover/gists{/gist_id}","starred_url":"https://api.github.com/users/hyclover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hyclover/subscriptions","organizations_url":"https://api.github.com/users/hyclover/orgs","repos_url":"https://api.github.com/users/hyclover/repos","events_url":"https://api.github.com/users/hyclover/events{/privacy}","received_events_url":"https://api.github.com/users/hyclover/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/DrSleep/light-weight-refinenet/issues/comments/830924532","html_url":"https://github.com/DrSleep/light-weight-refinenet/issues/62#issuecomment-830924532","issue_url":"https://api.github.com/repos/DrSleep/light-weight-refinenet/issues/62","id":830924532,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMDkyNDUzMg==","user":{"login":"DrSleep","id":7841432,"node_id":"MDQ6VXNlcjc4NDE0MzI=","avatar_url":"https://avatars.githubusercontent.com/u/7841432?v=4","gravatar_id":"","url":"https://api.github.com/users/DrSleep","html_url":"https://github.com/DrSleep","followers_url":"https://api.github.com/users/DrSleep/followers","following_url":"https://api.github.com/users/DrSleep/following{/other_user}","gists_url":"https://api.github.com/users/DrSleep/gists{/gist_id}","starred_url":"https://api.github.com/users/DrSleep/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DrSleep/subscriptions","organizations_url":"https://api.github.com/users/DrSleep/orgs","repos_url":"https://api.github.com/users/DrSleep/repos","events_url":"https://api.github.com/users/DrSleep/events{/privacy}","received_events_url":"https://api.github.com/users/DrSleep/received_events","type":"User","site_admin":false},"created_at":"2021-05-02T23:20:00Z","updated_at":"2021-05-02T23:20:00Z","author_association":"OWNER","body":"Marking it as resolved","reactions":{"url":"https://api.github.com/repos/DrSleep/light-weight-refinenet/issues/comments/830924532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"DrSleep","id":7841432,"node_id":"MDQ6VXNlcjc4NDE0MzI=","avatar_url":"https://avatars.githubusercontent.com/u/7841432?v=4","gravatar_id":"","url":"https://api.github.com/users/DrSleep","html_url":"https://github.com/DrSleep","followers_url":"https://api.github.com/users/DrSleep/followers","following_url":"https://api.github.com/users/DrSleep/following{/other_user}","gists_url":"https://api.github.com/users/DrSleep/gists{/gist_id}","starred_url":"https://api.github.com/users/DrSleep/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DrSleep/subscriptions","organizations_url":"https://api.github.com/users/DrSleep/orgs","repos_url":"https://api.github.com/users/DrSleep/repos","events_url":"https://api.github.com/users/DrSleep/events{/privacy}","received_events_url":"https://api.github.com/users/DrSleep/received_events","type":"User","site_admin":false}},{"id":4675574149,"node_id":"MDExOkNsb3NlZEV2ZW50NDY3NTU3NDE0OQ==","url":"https://api.github.com/repos/DrSleep/light-weight-refinenet/issues/events/4675574149","actor":{"login":"DrSleep","id":7841432,"node_id":"MDQ6VXNlcjc4NDE0MzI=","avatar_url":"https://avatars.githubusercontent.com/u/7841432?v=4","gravatar_id":"","url":"https://api.github.com/users/DrSleep","html_url":"https://github.com/DrSleep","followers_url":"https://api.github.com/users/DrSleep/followers","following_url":"https://api.github.com/users/DrSleep/following{/other_user}","gists_url":"https://api.github.com/users/DrSleep/gists{/gist_id}","starred_url":"https://api.github.com/users/DrSleep/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DrSleep/subscriptions","organizations_url":"https://api.github.com/users/DrSleep/orgs","repos_url":"https://api.github.com/users/DrSleep/repos","events_url":"https://api.github.com/users/DrSleep/events{/privacy}","received_events_url":"https://api.github.com/users/DrSleep/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-05-02T23:20:00Z","state_reason":null,"performed_via_github_app":null}]