{"url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/16","repository_url":"https://api.github.com/repos/Farama-Foundation/Miniworld","labels_url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/16/labels{/name}","comments_url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/16/comments","events_url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/16/events","html_url":"https://github.com/Farama-Foundation/Miniworld/issues/16","id":467176641,"node_id":"MDU6SXNzdWU0NjcxNzY2NDE=","number":16,"title":"EOFError with multiprocessing","user":{"login":"yding5","id":26913453,"node_id":"MDQ6VXNlcjI2OTEzNDUz","avatar_url":"https://avatars.githubusercontent.com/u/26913453?v=4","gravatar_id":"","url":"https://api.github.com/users/yding5","html_url":"https://github.com/yding5","followers_url":"https://api.github.com/users/yding5/followers","following_url":"https://api.github.com/users/yding5/following{/other_user}","gists_url":"https://api.github.com/users/yding5/gists{/gist_id}","starred_url":"https://api.github.com/users/yding5/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yding5/subscriptions","organizations_url":"https://api.github.com/users/yding5/orgs","repos_url":"https://api.github.com/users/yding5/repos","events_url":"https://api.github.com/users/yding5/events{/privacy}","received_events_url":"https://api.github.com/users/yding5/received_events","type":"User","site_admin":false},"labels":[{"id":1037461124,"node_id":"MDU6TGFiZWwxMDM3NDYxMTI0","url":"https://api.github.com/repos/Farama-Foundation/Miniworld/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"maximecb","id":713766,"node_id":"MDQ6VXNlcjcxMzc2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/713766?v=4","gravatar_id":"","url":"https://api.github.com/users/maximecb","html_url":"https://github.com/maximecb","followers_url":"https://api.github.com/users/maximecb/followers","following_url":"https://api.github.com/users/maximecb/following{/other_user}","gists_url":"https://api.github.com/users/maximecb/gists{/gist_id}","starred_url":"https://api.github.com/users/maximecb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maximecb/subscriptions","organizations_url":"https://api.github.com/users/maximecb/orgs","repos_url":"https://api.github.com/users/maximecb/repos","events_url":"https://api.github.com/users/maximecb/events{/privacy}","received_events_url":"https://api.github.com/users/maximecb/received_events","type":"User","site_admin":false},"assignees":[{"login":"maximecb","id":713766,"node_id":"MDQ6VXNlcjcxMzc2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/713766?v=4","gravatar_id":"","url":"https://api.github.com/users/maximecb","html_url":"https://github.com/maximecb","followers_url":"https://api.github.com/users/maximecb/followers","following_url":"https://api.github.com/users/maximecb/following{/other_user}","gists_url":"https://api.github.com/users/maximecb/gists{/gist_id}","starred_url":"https://api.github.com/users/maximecb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maximecb/subscriptions","organizations_url":"https://api.github.com/users/maximecb/orgs","repos_url":"https://api.github.com/users/maximecb/repos","events_url":"https://api.github.com/users/maximecb/events{/privacy}","received_events_url":"https://api.github.com/users/maximecb/received_events","type":"User","site_admin":false}],"milestone":null,"comments":6,"created_at":"2019-07-12T01:28:58Z","updated_at":"2019-07-19T14:40:18Z","closed_at":"2019-07-15T20:47:02Z","author_association":"NONE","active_lock_reason":null,"body":"Thanks for your great work. I find this environment very useful for our research. When I tried the training example, I got EOFError whenever the num-processes > 1. The error happens when the training is finished and seems to related to the multiprocessing. The same error seems also happens in a Macbook.\r\n\r\nI find some similar problem through search as below, but none of them solve the problem. Could you please take a look at that? Thanks.\r\n\r\nhttps://github.com/duckietown/gym-duckietown/issues/75\r\nhttps://github.com/openai/baselines/issues/640\r\n\r\n### Linux\r\n\r\nEnvironment info:\r\nUbuntu 18.04.2 LTS\r\npython 3.7.3\r\ngym 0.13.0\r\npyglet 1.2.4\r\n\r\nError message:\r\n(tensorflow_yukun) akash@a1:~/Documents/yukun/miniWorld/gym-miniworld/pytorch-a2c-ppo-acktr$ python main.py --algo ppo --num-frames 4000 --num-processes 2 --num-steps 80 --lr 0.00005 --env-name MiniWorld-Hallway-v0\r\nFalling back to num_samples=1\r\nFalling back to num_samples=1\r\nFalling back to num_samples=1\r\nFalling back to num_samples=1\r\nCreating frame stacking wrapper\r\nSaving model\r\n\r\nUpdates 10, num timesteps 1760, FPS 61\r\n Last 7 training episodes: mean/median reward 0.14/0.00, min/max reward 0.00/0.96, success rate 0.14\r\n\r\nUpdates 20, num timesteps 3360, FPS 61\r\n Last 14 training episodes: mean/median reward 0.14/0.00, min/max reward 0.00/0.98, success rate 0.14\r\n\r\nProcess Process-2:\r\nProcess Process-1:\r\nTraceback (most recent call last):\r\nTraceback (most recent call last):\r\n  File \"/home/akash/.conda/envs/tensorflow_yukun/lib/python3.7/multiprocessing/process.py\", line 297, in _bootstrap\r\n    self.run()\r\n  File \"/home/akash/.conda/envs/tensorflow_yukun/lib/python3.7/multiprocessing/process.py\", line 297, in _bootstrap\r\n    self.run()\r\n  File \"/home/akash/.conda/envs/tensorflow_yukun/lib/python3.7/multiprocessing/process.py\", line 99, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"/home/akash/.conda/envs/tensorflow_yukun/lib/python3.7/multiprocessing/process.py\", line 99, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"/home/akash/Documents/yukun/miniWorld/gym-miniworld/pytorch-a2c-ppo-acktr/vec_env/subproc_vec_env.py\", line 9, in worker\r\n    cmd, data = remote.recv()\r\n  File \"/home/akash/Documents/yukun/miniWorld/gym-miniworld/pytorch-a2c-ppo-acktr/vec_env/subproc_vec_env.py\", line 9, in worker\r\n    cmd, data = remote.recv()\r\n  File \"/home/akash/.conda/envs/tensorflow_yukun/lib/python3.7/multiprocessing/connection.py\", line 250, in recv\r\n    buf = self._recv_bytes()\r\n  File \"/home/akash/.conda/envs/tensorflow_yukun/lib/python3.7/multiprocessing/connection.py\", line 250, in recv\r\n    buf = self._recv_bytes()\r\n  File \"/home/akash/.conda/envs/tensorflow_yukun/lib/python3.7/multiprocessing/connection.py\", line 407, in _recv_bytes\r\n    buf = self._recv(4)\r\n  File \"/home/akash/.conda/envs/tensorflow_yukun/lib/python3.7/multiprocessing/connection.py\", line 407, in _recv_bytes\r\n    buf = self._recv(4)\r\n  File \"/home/akash/.conda/envs/tensorflow_yukun/lib/python3.7/multiprocessing/connection.py\", line 383, in _recv\r\n    raise EOFError\r\n  File \"/home/akash/.conda/envs/tensorflow_yukun/lib/python3.7/multiprocessing/connection.py\", line 383, in _recv\r\n    raise EOFError\r\nEOFError\r\nEOFError\r\n\r\n\r\n\r\n### Mac\r\n\r\nmacOS 10.14.5 (18F132)\r\npython 3.6.8\r\ngym 0.13.1\r\npyglet 1.4.1\r\n\r\n\r\n(miniWorld1) yukuns-mbp:pytorch-a2c-ppo-acktr yukun.ding1@ibm.com$ python main.py --algo ppo --num-frames 2000 --num-processes 2 --num-steps 80 --lr 0.00005 --env-name MiniWorld-Hallway-v0\r\nFalling back to non-multisampled frame buffer\r\nFalling back to num_samples=8\r\nFalling back to non-multisampled frame buffer\r\nFalling back to non-multisampled frame buffer\r\nFalling back to num_samples=8\r\nFalling back to non-multisampled frame buffer\r\nCreating frame stacking wrapper\r\nSaving model\r\n\r\nUpdates 0, num timesteps 160, FPS 53 \r\n Last 4 training episodes: mean/median reward 0.98/0.98, min/max reward 0.97/1.00, success rate 1.00\r\n\r\nUpdates 10, num timesteps 1760, FPS 56 \r\n Last 12 training episodes: mean/median reward 0.64/0.94, min/max reward 0.00/1.00, success rate 0.67\r\n\r\nProcess Process-2:\r\nProcess Process-1:\r\nTraceback (most recent call last):\r\n  File \"/anaconda3/envs/miniWorld1/lib/python3.6/multiprocessing/process.py\", line 258, in _bootstrap\r\n    self.run()\r\n  File \"/anaconda3/envs/miniWorld1/lib/python3.6/multiprocessing/process.py\", line 93, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"/Users/yukun.ding1@ibm.com/Documents/Code/yding5/miniWorld/gym-miniworld/pytorch-a2c-ppo-acktr/vec_env/subproc_vec_env.py\", line 9, in worker\r\n    cmd, data = remote.recv()\r\n  File \"/anaconda3/envs/miniWorld1/lib/python3.6/multiprocessing/connection.py\", line 250, in recv\r\n    buf = self._recv_bytes()\r\n  File \"/anaconda3/envs/miniWorld1/lib/python3.6/multiprocessing/connection.py\", line 407, in _recv_bytes\r\n    buf = self._recv(4)\r\n  File \"/anaconda3/envs/miniWorld1/lib/python3.6/multiprocessing/connection.py\", line 383, in _recv\r\n    raise EOFError\r\nTraceback (most recent call last):\r\nEOFError\r\n  File \"/anaconda3/envs/miniWorld1/lib/python3.6/multiprocessing/process.py\", line 258, in _bootstrap\r\n    self.run()\r\n  File \"/anaconda3/envs/miniWorld1/lib/python3.6/multiprocessing/process.py\", line 93, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"/Users/yukun.ding1@ibm.com/Documents/Code/yding5/miniWorld/gym-miniworld/pytorch-a2c-ppo-acktr/vec_env/subproc_vec_env.py\", line 9, in worker\r\n    cmd, data = remote.recv()\r\n  File \"/anaconda3/envs/miniWorld1/lib/python3.6/multiprocessing/connection.py\", line 250, in recv\r\n    buf = self._recv_bytes()\r\n  File \"/anaconda3/envs/miniWorld1/lib/python3.6/multiprocessing/connection.py\", line 407, in _recv_bytes\r\n    buf = self._recv(4)\r\n  File \"/anaconda3/envs/miniWorld1/lib/python3.6/multiprocessing/connection.py\", line 383, in _recv\r\n    raise EOFError\r\nEOFError","closed_by":{"login":"maximecb","id":713766,"node_id":"MDQ6VXNlcjcxMzc2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/713766?v=4","gravatar_id":"","url":"https://api.github.com/users/maximecb","html_url":"https://github.com/maximecb","followers_url":"https://api.github.com/users/maximecb/followers","following_url":"https://api.github.com/users/maximecb/following{/other_user}","gists_url":"https://api.github.com/users/maximecb/gists{/gist_id}","starred_url":"https://api.github.com/users/maximecb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maximecb/subscriptions","organizations_url":"https://api.github.com/users/maximecb/orgs","repos_url":"https://api.github.com/users/maximecb/repos","events_url":"https://api.github.com/users/maximecb/events{/privacy}","received_events_url":"https://api.github.com/users/maximecb/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/16/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/16/timeline","performed_via_github_app":null,"state_reason":"completed"}