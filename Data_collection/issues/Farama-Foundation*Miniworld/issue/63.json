{"url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/63","repository_url":"https://api.github.com/repos/Farama-Foundation/Miniworld","labels_url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/63/labels{/name}","comments_url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/63/comments","events_url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/63/events","html_url":"https://github.com/Farama-Foundation/Miniworld/issues/63","id":1237215191,"node_id":"I_kwDOCLmp285JvmfX","number":63,"title":"Modify environments so they can be deepcopied","user":{"login":"CarlosGual","id":89967429,"node_id":"MDQ6VXNlcjg5OTY3NDI5","avatar_url":"https://avatars.githubusercontent.com/u/89967429?v=4","gravatar_id":"","url":"https://api.github.com/users/CarlosGual","html_url":"https://github.com/CarlosGual","followers_url":"https://api.github.com/users/CarlosGual/followers","following_url":"https://api.github.com/users/CarlosGual/following{/other_user}","gists_url":"https://api.github.com/users/CarlosGual/gists{/gist_id}","starred_url":"https://api.github.com/users/CarlosGual/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CarlosGual/subscriptions","organizations_url":"https://api.github.com/users/CarlosGual/orgs","repos_url":"https://api.github.com/users/CarlosGual/repos","events_url":"https://api.github.com/users/CarlosGual/events{/privacy}","received_events_url":"https://api.github.com/users/CarlosGual/received_events","type":"User","site_admin":false},"labels":[{"id":1037461127,"node_id":"MDU6TGFiZWwxMDM3NDYxMTI3","url":"https://api.github.com/repos/Farama-Foundation/Miniworld/labels/help%20wanted","name":"help wanted","color":"008672","default":true,"description":"Extra attention is needed"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-05-16T14:06:14Z","updated_at":"2022-10-17T15:21:22Z","closed_at":"2022-10-17T15:21:21Z","author_association":"NONE","active_lock_reason":null,"body":"First of all, thank you very much for your work and contribution to the reinforcement learning community! :cowboy_hat_face: \r\n\r\n### Problem\r\n\r\nI am trying to use the Mazes environments into [garage library](https://github.com/rlworkgroup/garage). However, I've been strugling a lot until I found what I think it is the main issue. In garage, some algorithms implement a task sampler to create different instances of the environments. **To achieve this, they do a deepcopy of the environments**. Here is where I found that MiniWorld environments can't be deepcopied. **I just would like to know how to modify them in order to be deepcopied.**\r\n\r\n### Code Snippet\r\n\r\nHere you are a code snippet to reproduce the issue:\r\n\r\n```python\r\nimport gym\r\nimport gym_miniworld\r\nimport copy\r\n\r\nenv = gym.make('MiniWorld-MazeS3Fast-v0')\r\ncopy.deepcopy(env)\r\n```\r\n\r\n### Traceback\r\n\r\nIf you execute the previous code, you will see an error traceback like this one:\r\n\r\n```python\r\nTraceback (most recent call last):\r\n  File \"/home/carlos/repositorios/garage/development/pruebas_envdeepcopy.py\", line 6, in <module>\r\n    copy.deepcopy(env)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 180, in deepcopy\r\n    y = _reconstruct(x, memo, *rv)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 281, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 150, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 241, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 180, in deepcopy\r\n    y = _reconstruct(x, memo, *rv)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 281, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 150, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 241, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 180, in deepcopy\r\n    y = _reconstruct(x, memo, *rv)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 281, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 150, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 241, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 180, in deepcopy\r\n    y = _reconstruct(x, memo, *rv)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 281, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 150, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 241, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 180, in deepcopy\r\n    y = _reconstruct(x, memo, *rv)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 281, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 150, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 241, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 180, in deepcopy\r\n    y = _reconstruct(x, memo, *rv)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 281, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 150, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 241, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 180, in deepcopy\r\n    y = _reconstruct(x, memo, *rv)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 281, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 150, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 241, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/home/carlos/miniconda3/envs/garage/lib/python3.7/copy.py\", line 169, in deepcopy\r\n    rv = reductor(4)\r\nValueError: ctypes objects containing pointers cannot be pickled\r\n```\r\n\r\n### Solution\r\n\r\nFor the moment I haven't been able to find any solution to this problem. It is the first time I use deepcopy, so I am not an expert. Also, I do not know enough of the MiniWorld internal workings, so I can't figure where to start out. I just would like to ask you to suggest me some hints in order to know where to start modifying the environments. **Maybe just some kind of wrapper will make it work.**\r\n\r\nThanks in advance! :smile_cat: \r\n","closed_by":{"login":"jkterry1","id":19422700,"node_id":"MDQ6VXNlcjE5NDIyNzAw","avatar_url":"https://avatars.githubusercontent.com/u/19422700?v=4","gravatar_id":"","url":"https://api.github.com/users/jkterry1","html_url":"https://github.com/jkterry1","followers_url":"https://api.github.com/users/jkterry1/followers","following_url":"https://api.github.com/users/jkterry1/following{/other_user}","gists_url":"https://api.github.com/users/jkterry1/gists{/gist_id}","starred_url":"https://api.github.com/users/jkterry1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkterry1/subscriptions","organizations_url":"https://api.github.com/users/jkterry1/orgs","repos_url":"https://api.github.com/users/jkterry1/repos","events_url":"https://api.github.com/users/jkterry1/events{/privacy}","received_events_url":"https://api.github.com/users/jkterry1/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/63/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/63/timeline","performed_via_github_app":null,"state_reason":"completed"}