{"url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/44","repository_url":"https://api.github.com/repos/Farama-Foundation/Miniworld","labels_url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/44/labels{/name}","comments_url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/44/comments","events_url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/44/events","html_url":"https://github.com/Farama-Foundation/Miniworld/issues/44","id":892838854,"node_id":"MDU6SXNzdWU4OTI4Mzg4NTQ=","number":44,"title":"Parallel environment with multiprocessing.Pipe?","user":{"login":"ruoshiliu","id":25470644,"node_id":"MDQ6VXNlcjI1NDcwNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/25470644?v=4","gravatar_id":"","url":"https://api.github.com/users/ruoshiliu","html_url":"https://github.com/ruoshiliu","followers_url":"https://api.github.com/users/ruoshiliu/followers","following_url":"https://api.github.com/users/ruoshiliu/following{/other_user}","gists_url":"https://api.github.com/users/ruoshiliu/gists{/gist_id}","starred_url":"https://api.github.com/users/ruoshiliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ruoshiliu/subscriptions","organizations_url":"https://api.github.com/users/ruoshiliu/orgs","repos_url":"https://api.github.com/users/ruoshiliu/repos","events_url":"https://api.github.com/users/ruoshiliu/events{/privacy}","received_events_url":"https://api.github.com/users/ruoshiliu/received_events","type":"User","site_admin":false},"labels":[{"id":1037461124,"node_id":"MDU6TGFiZWwxMDM3NDYxMTI0","url":"https://api.github.com/repos/Farama-Foundation/Miniworld/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2021-05-17T02:49:06Z","updated_at":"2021-05-19T23:10:40Z","closed_at":"2021-05-19T23:10:40Z","author_association":"NONE","active_lock_reason":null,"body":"Hi there, thank you so much for sharing the code! I was trying to run parallel environment using pipe as done in: https://github.com/lcswillems/rl-starter-files. However, that doesn't seem to work. I got EOFerror for all process other than the main one. Any idea why and how to fix it? Thanks in advanced!\r\n\r\nHere's the relevant code:\r\n\r\n```\r\nclass ParallelEnv(gym.Env):\r\n    def __init__(self, envs):\r\n        assert len(envs) >= 1,\r\n        self.envs = envs\r\n        self.observation_space = self.envs[0].observation_space\r\n        self.action_space = self.envs[0].action_space\r\n\r\n        self.locals = []\r\n        for env in self.envs[1:]:\r\n            local, remote = Pipe()\r\n            self.locals.append(local)\r\n            p = Process(target=worker, args=(remote, env))\r\n            p.daemon = True\r\n            p.start()\r\n            remote.close()\r\n\r\n    def reset(self):\r\n        for local in self.locals:\r\n            local.send((\"reset\", None))\r\n        results = [self.envs[0].reset()] + [local.recv() for local in self.locals]\r\n        return results\r\n\r\n    def step(self, actions):\r\n        for local, action in zip(self.locals, actions[1:]):\r\n            local.send((\"step\", action))\r\n        obs, reward, done, info = self.envs[0].step(actions[0])\r\n        print(obs.shape)\r\n        if done:\r\n            obs = self.envs[0].reset()\r\n        results = zip(*[(obs, reward, done, info)] + [local.recv() for local in self.locals])\r\n        return results\r\n\r\n    def render(self):\r\n        raise NotImplementedError\r\n```","closed_by":{"login":"maximecb","id":713766,"node_id":"MDQ6VXNlcjcxMzc2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/713766?v=4","gravatar_id":"","url":"https://api.github.com/users/maximecb","html_url":"https://github.com/maximecb","followers_url":"https://api.github.com/users/maximecb/followers","following_url":"https://api.github.com/users/maximecb/following{/other_user}","gists_url":"https://api.github.com/users/maximecb/gists{/gist_id}","starred_url":"https://api.github.com/users/maximecb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maximecb/subscriptions","organizations_url":"https://api.github.com/users/maximecb/orgs","repos_url":"https://api.github.com/users/maximecb/repos","events_url":"https://api.github.com/users/maximecb/events{/privacy}","received_events_url":"https://api.github.com/users/maximecb/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/44/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Farama-Foundation/Miniworld/issues/44/timeline","performed_via_github_app":null,"state_reason":"completed"}