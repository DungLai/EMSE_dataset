{"url":"https://api.github.com/repos/uber-research/deep-neuroevolution/issues/27","repository_url":"https://api.github.com/repos/uber-research/deep-neuroevolution","labels_url":"https://api.github.com/repos/uber-research/deep-neuroevolution/issues/27/labels{/name}","comments_url":"https://api.github.com/repos/uber-research/deep-neuroevolution/issues/27/comments","events_url":"https://api.github.com/repos/uber-research/deep-neuroevolution/issues/27/events","html_url":"https://github.com/uber-research/deep-neuroevolution/issues/27","id":452092258,"node_id":"MDU6SXNzdWU0NTIwOTIyNTg=","number":27,"title":"[Local ES Frostbite] Value Error, Dimension Mismatch","user":{"login":"artofbeinghuman","id":19737739,"node_id":"MDQ6VXNlcjE5NzM3NzM5","avatar_url":"https://avatars.githubusercontent.com/u/19737739?v=4","gravatar_id":"","url":"https://api.github.com/users/artofbeinghuman","html_url":"https://github.com/artofbeinghuman","followers_url":"https://api.github.com/users/artofbeinghuman/followers","following_url":"https://api.github.com/users/artofbeinghuman/following{/other_user}","gists_url":"https://api.github.com/users/artofbeinghuman/gists{/gist_id}","starred_url":"https://api.github.com/users/artofbeinghuman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/artofbeinghuman/subscriptions","organizations_url":"https://api.github.com/users/artofbeinghuman/orgs","repos_url":"https://api.github.com/users/artofbeinghuman/repos","events_url":"https://api.github.com/users/artofbeinghuman/events{/privacy}","received_events_url":"https://api.github.com/users/artofbeinghuman/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-06-04T16:26:08Z","updated_at":"2019-06-07T15:25:57Z","closed_at":"2019-06-07T15:25:57Z","author_association":"NONE","active_lock_reason":null,"body":"When running\r\n`. scripts/local_run_exp.sh es configurations/frostbite_es.json `\r\n\r\nI get a Value Error/Dimension Mismatch. Here is the full output of the redis master:\r\n\r\n```\r\n. scripts/local_env_setup.sh                                                                                                                                                                                 [29/29]\r\npython -m es_distributed.main master --master_socket_path /tmp/es_redis_master.sock --algo es --exp_file configurations/frostbite_es.json\r\nmarvin@mlpad:~/code/deep-neuroevolution$ . scripts/local_env_setup.sh\r\nSetting up local environment\r\n(env) marvin@mlpad:~/code/deep-neuroevolution$ python -m es_distributed.main master --master_socket_path /tmp/es_redis_master.sock --algo es --exp_file configurations/frostbite_es.json\r\n[2019-06-04 18:12:12,474 pid=5654] run_master: {'master_redis_cfg': {'unix_socket_path': '/tmp/es_redis_master.sock'}, 'log_dir': '/tmp/es_master_5654', 'exp': {'config': {'calc_obstat_prob': 0.0, 'episodes_per_$\r\natch': 5000, 'eval_prob': 0.01, 'l2coeff': 0.005, 'noise_stdev': 0.005, 'snapshot_freq': 20, 'timesteps_per_batch': 10000, 'return_proc_mode': 'centered_rank', 'episode_cutoff_mode': 5000}, 'env_id': 'FrostbiteN$\r\nFrameskip-v4', 'optimizer': {'args': {'stepsize': 0.01}, 'type': 'adam'}, 'policy': {'args': {}, 'type': 'ESAtariPolicy'}}}\r\n[2019-06-04 18:12:13,773 pid=5654] Tabular logging to /tmp/es_master_5654\r\n2019-06-04 18:12:14.669307: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-06-04 18:12:14.700165: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2496000000 Hz\r\n2019-06-04 18:12:14.700767: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x3ad73d0 executing computations on platform Host. Devices:\r\n2019-06-04 18:12:14.700785: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>\r\n[2019-06-04 18:12:14,711 pid=5654] From /home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops\r\n) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\n[2019-06-04 18:12:14,854 pid=5654] From /home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1624: flatten (from tensorflow.python.layers.core) i\r\ns deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse keras.layers.flatten instead.\r\n[2019-06-04 18:12:14,939 pid=5654] From /home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/util/decorator_utils.py:145: GraphKeys.VARIABLES (from tensorflow.python.framework.o\r\nps) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse `tf.GraphKeys.GLOBAL_VARIABLES` instead.\r\nTraceback (most recent call last):\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 1659, in _create_c_op\r\n    c_op = c_api.TF_FinishOperation(op_desc)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Dimension 0 in both shapes must be equal, but are 4608 and 18. Shapes are [4608] and [18].\r\n\tFrom merging shape 12 with other shapes. for 'concat/concat_dim' (op: 'Pack') with input shapes: [4096], [16], [16], [16], [8192], [32], [32], [32], [991232], [256], [256], [256], [4608], [18].\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/usr/local/lib/python3.7/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/marvin/code/deep-neuroevolution/es_distributed/main.py\", line 90, in <module>\r\n    cli()\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/click/core.py\", line 764, in __call__\r\n    return self.main(*args, **kwargs)\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/click/core.py\", line 717, in main\r\n    rv = self.invoke(ctx)\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/click/core.py\", line 1137, in invoke\r\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/click/core.py\", line 956, in invoke\r\n    return ctx.invoke(self.callback, **ctx.params)\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/click/core.py\", line 555, in invoke\r\n    return callback(*args, **kwargs)\r\n  File \"/home/marvin/code/deep-neuroevolution/es_distributed/main.py\", line 61, in master\r\n    algo.run_master({'unix_socket_path': master_socket_path}, log_dir, exp)\r\n  File \"/home/marvin/code/deep-neuroevolution/es_distributed/es.py\", line 147, in run_master\r\n    config, env, sess, policy = setup(exp, single_threaded=False)\r\n  File \"/home/marvin/code/deep-neuroevolution/es_distributed/es.py\", line 136, in setup\r\n    policy = getattr(policies, exp['policy']['type'])(env.observation_space, env.action_space, **exp['policy']['args'])\r\n  File \"/home/marvin/code/deep-neuroevolution/es_distributed/policies.py\", line 24, in __init__\r\n    self._getflat = U.GetFlat(self.trainable_variables)\r\n  File \"/home/marvin/code/deep-neuroevolution/es_distributed/tf_util.py\", line 244, in __init__\r\n    self.op = tf.concat(0, [tf.reshape(v, [numel(v)]) for v in var_list])\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/util/dispatch.py\", line 180, in wrapper\r\n    return target(*args, **kwargs)\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/ops/array_ops.py\", line 1253, in concat\r\n    dtype=dtypes.int32).get_shape().assert_is_compatible_with(\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 1039, in convert_to_tensor\r\n    return convert_to_tensor_v2(value, dtype, preferred_dtype, name)\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 1097, in convert_to_tensor_v2\r\n    as_ref=False)\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 1175, in internal_convert_to_tensor\r\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/ops/array_ops.py\", line 1102, in _autopacking_conversion_function\r\n    return _autopacking_helper(v, dtype, name or \"packed\")\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/ops/array_ops.py\", line 1054, in _autopacking_helper\r\n    return gen_array_ops.pack(elems_as_tensors, name=scope)\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 5448, in pack\r\n    \"Pack\", values=values, axis=axis, name=name)\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 788, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 3300, in create_op\r\n    op_def=op_def)\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 1823, in __init__\r\n    control_input_ops)\r\n  File \"/home/marvin/code/deep-neuroevolution/env/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 1662, in _create_c_op\r\n    raise ValueError(str(e))\r\nValueError: Dimension 0 in both shapes must be equal, but are 4608 and 18. Shapes are [4608] and [18].\r\n\tFrom merging shape 12 with other shapes. for 'concat/concat_dim' (op: 'Pack') with input shapes: [4096], [16], [16], [16], [8192], [32], [32], [32], [991232], [256], [256], [256], [4608], [18].\r\n\r\n```\r\n\r\nHow do I fix this and get the example up and running? I'd be grateful for any help!\r\n\r\nCheers,\r\nMarvin","closed_by":{"login":"artofbeinghuman","id":19737739,"node_id":"MDQ6VXNlcjE5NzM3NzM5","avatar_url":"https://avatars.githubusercontent.com/u/19737739?v=4","gravatar_id":"","url":"https://api.github.com/users/artofbeinghuman","html_url":"https://github.com/artofbeinghuman","followers_url":"https://api.github.com/users/artofbeinghuman/followers","following_url":"https://api.github.com/users/artofbeinghuman/following{/other_user}","gists_url":"https://api.github.com/users/artofbeinghuman/gists{/gist_id}","starred_url":"https://api.github.com/users/artofbeinghuman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/artofbeinghuman/subscriptions","organizations_url":"https://api.github.com/users/artofbeinghuman/orgs","repos_url":"https://api.github.com/users/artofbeinghuman/repos","events_url":"https://api.github.com/users/artofbeinghuman/events{/privacy}","received_events_url":"https://api.github.com/users/artofbeinghuman/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/uber-research/deep-neuroevolution/issues/27/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/uber-research/deep-neuroevolution/issues/27/timeline","performed_via_github_app":null,"state_reason":"completed"}