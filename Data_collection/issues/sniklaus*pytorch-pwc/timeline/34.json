[{"id":3013528767,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzAxMzUyODc2Nw==","url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/events/3013528767","actor":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-02-06T11:33:36Z","performed_via_github_app":null},{"id":3013528771,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMwMTM1Mjg3NzE=","url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/events/3013528771","actor":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-02-06T11:33:36Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/comments/583815631","html_url":"https://github.com/sniklaus/pytorch-pwc/issues/34#issuecomment-583815631","issue_url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/34","id":583815631,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MzgxNTYzMQ==","user":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false},"created_at":"2020-02-09T07:49:45Z","updated_at":"2020-02-09T07:49:45Z","author_association":"OWNER","body":"Thank you for investigating this, I greatly appreciate it! I found a typo on my end and updated the provided models. I also updated the flow visualization but it remains unaffected from this bug. Would you mind downloading the provided models again to see whether they are correct now? Thanks!","reactions":{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/comments/583815631/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/comments/583948251","html_url":"https://github.com/sniklaus/pytorch-pwc/issues/34#issuecomment-583948251","issue_url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/34","id":583948251,"node_id":"MDEyOklzc3VlQ29tbWVudDU4Mzk0ODI1MQ==","user":{"login":"lhao0301","id":10356897,"node_id":"MDQ6VXNlcjEwMzU2ODk3","avatar_url":"https://avatars.githubusercontent.com/u/10356897?v=4","gravatar_id":"","url":"https://api.github.com/users/lhao0301","html_url":"https://github.com/lhao0301","followers_url":"https://api.github.com/users/lhao0301/followers","following_url":"https://api.github.com/users/lhao0301/following{/other_user}","gists_url":"https://api.github.com/users/lhao0301/gists{/gist_id}","starred_url":"https://api.github.com/users/lhao0301/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lhao0301/subscriptions","organizations_url":"https://api.github.com/users/lhao0301/orgs","repos_url":"https://api.github.com/users/lhao0301/repos","events_url":"https://api.github.com/users/lhao0301/events{/privacy}","received_events_url":"https://api.github.com/users/lhao0301/received_events","type":"User","site_admin":false},"created_at":"2020-02-10T04:17:16Z","updated_at":"2020-02-10T04:17:16Z","author_association":"NONE","body":"Thanks for your reply!\r\n\r\nThe updated model works well and is identical with the official model. Visualizing the flow, it changes a little only, which can be ignored. \r\n\r\nflow_viz_before:\r\n![viz_flow_raw](https://user-images.githubusercontent.com/10356897/74120511-99109a80-4bfe-11ea-953a-eb1ceeb3004d.png)\r\nflow_viz_updated:\r\n![viz_flow_updated](https://user-images.githubusercontent.com/10356897/74120523-9e6de500-4bfe-11ea-9c46-1f81306bca0d.png)\r\n","reactions":{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/comments/583948251/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lhao0301","id":10356897,"node_id":"MDQ6VXNlcjEwMzU2ODk3","avatar_url":"https://avatars.githubusercontent.com/u/10356897?v=4","gravatar_id":"","url":"https://api.github.com/users/lhao0301","html_url":"https://github.com/lhao0301","followers_url":"https://api.github.com/users/lhao0301/followers","following_url":"https://api.github.com/users/lhao0301/following{/other_user}","gists_url":"https://api.github.com/users/lhao0301/gists{/gist_id}","starred_url":"https://api.github.com/users/lhao0301/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lhao0301/subscriptions","organizations_url":"https://api.github.com/users/lhao0301/orgs","repos_url":"https://api.github.com/users/lhao0301/repos","events_url":"https://api.github.com/users/lhao0301/events{/privacy}","received_events_url":"https://api.github.com/users/lhao0301/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/comments/583948865","html_url":"https://github.com/sniklaus/pytorch-pwc/issues/34#issuecomment-583948865","issue_url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/34","id":583948865,"node_id":"MDEyOklzc3VlQ29tbWVudDU4Mzk0ODg2NQ==","user":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false},"created_at":"2020-02-10T04:20:58Z","updated_at":"2020-02-10T04:20:58Z","author_association":"OWNER","body":"Thank you for confirming, and thanks again for bringing this to my attention!","reactions":{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/comments/583948865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false}},{"id":3021271382,"node_id":"MDExOkNsb3NlZEV2ZW50MzAyMTI3MTM4Mg==","url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/events/3021271382","actor":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-02-10T04:20:58Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/comments/601591448","html_url":"https://github.com/sniklaus/pytorch-pwc/issues/34#issuecomment-601591448","issue_url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/34","id":601591448,"node_id":"MDEyOklzc3VlQ29tbWVudDYwMTU5MTQ0OA==","user":{"login":"lhao0301","id":10356897,"node_id":"MDQ6VXNlcjEwMzU2ODk3","avatar_url":"https://avatars.githubusercontent.com/u/10356897?v=4","gravatar_id":"","url":"https://api.github.com/users/lhao0301","html_url":"https://github.com/lhao0301","followers_url":"https://api.github.com/users/lhao0301/followers","following_url":"https://api.github.com/users/lhao0301/following{/other_user}","gists_url":"https://api.github.com/users/lhao0301/gists{/gist_id}","starred_url":"https://api.github.com/users/lhao0301/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lhao0301/subscriptions","organizations_url":"https://api.github.com/users/lhao0301/orgs","repos_url":"https://api.github.com/users/lhao0301/repos","events_url":"https://api.github.com/users/lhao0301/events{/privacy}","received_events_url":"https://api.github.com/users/lhao0301/received_events","type":"User","site_admin":false},"created_at":"2020-03-20T08:49:15Z","updated_at":"2020-03-20T08:51:29Z","author_association":"NONE","body":"This problem is also found when I compare your repo and the official repo. Hence, I just propose it here. \r\n\r\nAfter looking into the official `pwc-net` and `flownet2` repo, I find that the `mean_subtraction` is omitted in the image preprocessing period in this repo. What is interesting is that the predicted optical flow seems not so bad, when `mean_subtraction` is omitted (Actually, rgb or bgr is also not so important for optical flow's prediction). I'm a litte confused about the `mean_subtraction` because I didn't find it in the [original pytorch implementation](https://github.com/NVlabs/PWC-Net/blob/185b0e2beb45ad029bb66d818812f8dcc2aed9c6/PyTorch/script_pwc.py#L58.) as well.\r\n\r\nIn the [pwc_net_test.prototxt](https://github.com/NVlabs/PWC-Net/blob/185b0e2beb45ad029bb66d818812f8dcc2aed9c6/Caffe/model/pwc_net_test.prototxt#L61), `recompute_mean` is not zero. And as the code in [data_augmentation_layer.cu](https://github.com/lmb-freiburg/flownet2/blob/b92e198b56b0e52e1ba0a5a98dc0e39fa5ae70cc/src/caffe/layers/data_augmentation_layer.cu#L592), both the training and test periods in official caffe version have `mean_subtraction`.\r\n@sniklaus ","reactions":{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/comments/601591448/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lhao0301","id":10356897,"node_id":"MDQ6VXNlcjEwMzU2ODk3","avatar_url":"https://avatars.githubusercontent.com/u/10356897?v=4","gravatar_id":"","url":"https://api.github.com/users/lhao0301","html_url":"https://github.com/lhao0301","followers_url":"https://api.github.com/users/lhao0301/followers","following_url":"https://api.github.com/users/lhao0301/following{/other_user}","gists_url":"https://api.github.com/users/lhao0301/gists{/gist_id}","starred_url":"https://api.github.com/users/lhao0301/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lhao0301/subscriptions","organizations_url":"https://api.github.com/users/lhao0301/orgs","repos_url":"https://api.github.com/users/lhao0301/repos","events_url":"https://api.github.com/users/lhao0301/events{/privacy}","received_events_url":"https://api.github.com/users/lhao0301/received_events","type":"User","site_admin":false}},{"id":3148465653,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzE0ODQ2NTY1Mw==","url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/events/3148465653","actor":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-03-20T08:49:15Z","performed_via_github_app":null},{"id":3148465656,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMxNDg0NjU2NTY=","url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/events/3148465656","actor":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-03-20T08:49:15Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/comments/601812054","html_url":"https://github.com/sniklaus/pytorch-pwc/issues/34#issuecomment-601812054","issue_url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/34","id":601812054,"node_id":"MDEyOklzc3VlQ29tbWVudDYwMTgxMjA1NA==","user":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false},"created_at":"2020-03-20T17:08:12Z","updated_at":"2020-03-20T17:08:12Z","author_association":"OWNER","body":"Thank you for your message! I was wondering that too when I converted the Caffe model, but I noticed that the results from this reimplementation are different from the official Caffe model if I add the following lines to the preprocessing.\r\n\r\n```\r\ntensorPreprocessedFirst = tensorPreprocessedFirst - tensorPreprocessedFirst.view(1, 3, -1).mean(2).view(1, 3, 1, 1)\r\ntensorPreprocessedSecond = tensorPreprocessedSecond - tensorPreprocessedSecond.view(1, 3, -1).mean(2).view(1, 3, 1, 1)\r\n```\r\n\r\nOutput from the official Caffe implementation:\r\n![official - caffe](https://user-images.githubusercontent.com/1238034/77187766-37abd900-6a92-11ea-832d-3e12201b95db.png)\r\n\r\nOutput from this reimplementation:\r\n![out2](https://user-images.githubusercontent.com/1238034/77187726-282c9000-6a92-11ea-9f6d-d3f4dc43620b.png)\r\n\r\nOutput from this reimplementation with the additonal mean subtraction:\r\n![out](https://user-images.githubusercontent.com/1238034/77187711-2367dc00-6a92-11ea-854e-575a7a94e45b.png)\r\n\r\nI never bothered to look into this further, Deqing stated that it makes no difference whether or not they use the mean subtraction: https://github.com/NVlabs/PWC-Net/issues/40\r\n\r\nI would be happy if you can find the reason behind this, I am afraid that I am a little busy at the moment.","reactions":{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/comments/601812054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false}}]