[{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/comments/1081281108","html_url":"https://github.com/sniklaus/pytorch-pwc/issues/59#issuecomment-1081281108","issue_url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/59","id":1081281108,"node_id":"IC_kwDOCGqm2c5AcwpU","user":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false},"created_at":"2022-03-29T00:32:21Z","updated_at":"2022-03-29T00:34:33Z","author_association":"OWNER","body":"Don't forget that the input to backwarp isn't normalized images but features - and I also appended an additional channel:\r\nhttps://github.com/sniklaus/pytorch-pwc/blob/7023ad121644cd460fc72c8bb38a9fa988fe7398/run.py#L57\r\n\r\nAnyways, the reason I added this additional channel and why I mask the output based on this auxiliary channel is because the goal of this repository is to mimic the original Caffe implementation in PyTorch. That includes being able to use the weights from the model trained in Caffe and executing it in PyTorch. For that to work, all details need to be the same. This being said, the original Caffe implementation uses a custom backwarp implementation that only backwarps pixels if all four pixels that are being sampled reside inside of the image: https://github.com/NVlabs/PWC-Net/blob/185b0e2beb45ad029bb66d818812f8dcc2aed9c6/Caffe/warping_code/warp_layer.cu#L54-L85\r\n\r\nThe auxiliary channel/mask that I introduced is used to zero out pixels that sample from the boundary where the original implementation yields zero but PyTorch's grid sampler yields something different. If you train a PWC-Net from scratch then you can safely remove this mechanism.","reactions":{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/comments/1081281108/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false}},{"id":6322554416,"node_id":"CE_lADOCGqm2c5GlA8uzwAAAAF42oYw","url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/events/6322554416","actor":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-03-29T00:32:21Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/comments/1081283256","html_url":"https://github.com/sniklaus/pytorch-pwc/issues/59#issuecomment-1081283256","issue_url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/59","id":1081283256,"node_id":"IC_kwDOCGqm2c5AcxK4","user":{"login":"Etienne66","id":52262160,"node_id":"MDQ6VXNlcjUyMjYyMTYw","avatar_url":"https://avatars.githubusercontent.com/u/52262160?v=4","gravatar_id":"","url":"https://api.github.com/users/Etienne66","html_url":"https://github.com/Etienne66","followers_url":"https://api.github.com/users/Etienne66/followers","following_url":"https://api.github.com/users/Etienne66/following{/other_user}","gists_url":"https://api.github.com/users/Etienne66/gists{/gist_id}","starred_url":"https://api.github.com/users/Etienne66/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Etienne66/subscriptions","organizations_url":"https://api.github.com/users/Etienne66/orgs","repos_url":"https://api.github.com/users/Etienne66/repos","events_url":"https://api.github.com/users/Etienne66/events{/privacy}","received_events_url":"https://api.github.com/users/Etienne66/received_events","type":"User","site_admin":false},"created_at":"2022-03-29T00:36:58Z","updated_at":"2022-03-29T00:36:58Z","author_association":"CONTRIBUTOR","body":"Thanks @sniklaus, I'm training from scratch and I did notice a slight improvement in the losses when I removed that. Glad to know it is safe to remove for a fresh training.","reactions":{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/comments/1081283256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Etienne66","id":52262160,"node_id":"MDQ6VXNlcjUyMjYyMTYw","avatar_url":"https://avatars.githubusercontent.com/u/52262160?v=4","gravatar_id":"","url":"https://api.github.com/users/Etienne66","html_url":"https://github.com/Etienne66","followers_url":"https://api.github.com/users/Etienne66/followers","following_url":"https://api.github.com/users/Etienne66/following{/other_user}","gists_url":"https://api.github.com/users/Etienne66/gists{/gist_id}","starred_url":"https://api.github.com/users/Etienne66/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Etienne66/subscriptions","organizations_url":"https://api.github.com/users/Etienne66/orgs","repos_url":"https://api.github.com/users/Etienne66/repos","events_url":"https://api.github.com/users/Etienne66/events{/privacy}","received_events_url":"https://api.github.com/users/Etienne66/received_events","type":"User","site_admin":false}},{"id":6322568002,"node_id":"MEE_lADOCGqm2c5GlA8uzwAAAAF42rtC","url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/events/6322568002","actor":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-03-29T00:36:59Z","performed_via_github_app":null},{"id":6322568004,"node_id":"SE_lADOCGqm2c5GlA8uzwAAAAF42rtE","url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/events/6322568004","actor":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-03-29T00:36:59Z","performed_via_github_app":null}]