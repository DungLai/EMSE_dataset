{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/47","repository_url":"https://api.github.com/repos/sniklaus/pytorch-pwc","labels_url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/47/labels{/name}","comments_url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/47/comments","events_url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/47/events","html_url":"https://github.com/sniklaus/pytorch-pwc/issues/47","id":854536562,"node_id":"MDU6SXNzdWU4NTQ1MzY1NjI=","number":47,"title":"Cannot inspect the model using TensorBoard","user":{"login":"lollows","id":31273965,"node_id":"MDQ6VXNlcjMxMjczOTY1","avatar_url":"https://avatars.githubusercontent.com/u/31273965?v=4","gravatar_id":"","url":"https://api.github.com/users/lollows","html_url":"https://github.com/lollows","followers_url":"https://api.github.com/users/lollows/followers","following_url":"https://api.github.com/users/lollows/following{/other_user}","gists_url":"https://api.github.com/users/lollows/gists{/gist_id}","starred_url":"https://api.github.com/users/lollows/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lollows/subscriptions","organizations_url":"https://api.github.com/users/lollows/orgs","repos_url":"https://api.github.com/users/lollows/repos","events_url":"https://api.github.com/users/lollows/events{/privacy}","received_events_url":"https://api.github.com/users/lollows/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2021-04-09T13:40:41Z","updated_at":"2022-03-09T19:22:23Z","closed_at":"2021-04-09T15:51:20Z","author_association":"NONE","active_lock_reason":null,"body":"**I want to visualize the model using tensorboard. And some error happens:**\r\n```\r\nC:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\torch\\tensor.py:455: RuntimeWarning: Iterating over a tensor might cause the trace to be incorrect. Passing a tensor of different shape won't change the number of iterations executed (and might lead to errors or silently give incorrect results).\r\n  'incorrect results).', category=RuntimeWarning)\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\cupy\\cuda\\compiler.py\", line 549, in compile\r\n    nvrtc.compileProgram(self.ptr, options)\r\n  File \"cupy_backends\\cuda\\libs\\nvrtc.pyx\", line 112, in cupy_backends.cuda.libs.nvrtc.compileProgram\r\n  File \"cupy_backends\\cuda\\libs\\nvrtc.pyx\", line 124, in cupy_backends.cuda.libs.nvrtc.compileProgram\r\n  File \"cupy_backends\\cuda\\libs\\nvrtc.pyx\", line 58, in cupy_backends.cuda.libs.nvrtc.check_status\r\ncupy_backends.cuda.libs.nvrtc.NVRTCError: NVRTC_ERROR_COMPILATION (6)\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"D:/workspace/pycharm/pytorch-pwc-master/check_model.py\", line 354, in <module>\r\n    writer.add_graph(netNetwork, (tenPreprocessedFirst, tenPreprocessedSecond))\r\n  File \"C:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\torch\\utils\\tensorboard\\writer.py\", line 714, in add_graph\r\n    self._get_file_writer().add_graph(graph(model, input_to_model, verbose))\r\n  File \"C:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\torch\\utils\\tensorboard\\_pytorch_graph.py\", line 285, in graph\r\n    trace = torch.jit.trace(model, args)\r\n  File \"C:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\torch\\jit\\__init__.py\", line 955, in trace\r\n    check_tolerance, strict, _force_outplace, _module_class)\r\n  File \"C:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\torch\\jit\\__init__.py\", line 1109, in trace_module\r\n    module._c._create_method_from_trace(method_name, func, example_inputs, var_lookup_fn, strict, _force_outplace)\r\n  File \"C:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 720, in _call_impl\r\n    result = self._slow_forward(*input, **kwargs)\r\n  File \"C:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 704, in _slow_forward\r\n    result = self.forward(*input, **kwargs)\r\n  File \"D:/workspace/pycharm/pytorch-pwc-master/check_model.py\", line 307, in forward\r\n    objEstimate = self.netSix(tenFirst[-1], tenSecond[-1], None)\r\n  File \"C:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 720, in _call_impl\r\n    result = self._slow_forward(*input, **kwargs)\r\n  File \"C:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 704, in _slow_forward\r\n    result = self.forward(*input, **kwargs)\r\n  File \"D:/workspace/pycharm/pytorch-pwc-master/check_model.py\", line 215, in forward\r\n    input=correlation.FunctionCorrelation(tenFirst=tenFirst, tenSecond=tenSecond),\r\n  File \"./correlation\\correlation.py\", line 386, in FunctionCorrelation\r\n    return _FunctionCorrelation.apply(tenFirst, tenSecond)\r\n  File \"./correlation\\correlation.py\", line 295, in forward\r\n    'output': rbot0\r\n  File \"cupy\\_util.pyx\", line 59, in cupy._util.memoize.decorator.ret\r\n  File \"./correlation\\correlation.py\", line 275, in cupy_launch\r\n    return cupy.cuda.compile_with_cache(strKernel).get_function(strFunction)\r\n  File \"C:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\cupy\\cuda\\compiler.py\", line 373, in compile_with_cache\r\n    cache_in_memory)\r\n  File \"C:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\cupy\\cuda\\compiler.py\", line 437, in _compile_with_cache_cuda\r\n    log_stream, cache_in_memory)\r\n  File \"C:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\cupy\\cuda\\compiler.py\", line 212, in compile_using_nvrtc\r\n    name_expressions, log_stream)\r\n  File \"C:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\cupy\\cuda\\compiler.py\", line 195, in _compile\r\n    ptx, mapping = prog.compile(options, log_stream)\r\n  File \"C:\\Users\\Administrator\\anaconda3\\envs\\pwc\\lib\\site-packages\\cupy\\cuda\\compiler.py\", line 561, in compile\r\n    'nvrtc' if not runtime.is_hip else 'hiprtc')\r\ncupy.cuda.compiler.CompileException: C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\tmpthz_eabd\\256b2afebe918404edfb6592392d441b_2.cubin.cu(16): error: identifier \"tensor\" is undefined\r\n\r\n1 error detected in the compilation of \"C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\tmpthz_eabd\\256b2afebe918404edfb6592392d441b_2.cubin.cu\".\r\n\r\n```\r\n**Here is some of the code I used.**\r\n```\r\nfrom torch.utils.tensorboard import SummaryWriter\r\n\r\nwriter = SummaryWriter('runs/test')\r\nwriter.add_graph(netNetwork, (tenPreprocessedFirst, tenPreprocessedSecond))\r\nwriter.close()\r\n```\r\n**I have tested the run.py, it works well.**  Please let me know if I missed something. Thank you.","closed_by":{"login":"sniklaus","id":1238034,"node_id":"MDQ6VXNlcjEyMzgwMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1238034?v=4","gravatar_id":"","url":"https://api.github.com/users/sniklaus","html_url":"https://github.com/sniklaus","followers_url":"https://api.github.com/users/sniklaus/followers","following_url":"https://api.github.com/users/sniklaus/following{/other_user}","gists_url":"https://api.github.com/users/sniklaus/gists{/gist_id}","starred_url":"https://api.github.com/users/sniklaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sniklaus/subscriptions","organizations_url":"https://api.github.com/users/sniklaus/orgs","repos_url":"https://api.github.com/users/sniklaus/repos","events_url":"https://api.github.com/users/sniklaus/events{/privacy}","received_events_url":"https://api.github.com/users/sniklaus/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/47/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sniklaus/pytorch-pwc/issues/47/timeline","performed_via_github_app":null,"state_reason":"completed"}