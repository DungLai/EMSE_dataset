{"url":"https://api.github.com/repos/intel/dffml/issues/1203","repository_url":"https://api.github.com/repos/intel/dffml","labels_url":"https://api.github.com/repos/intel/dffml/issues/1203/labels{/name}","comments_url":"https://api.github.com/repos/intel/dffml/issues/1203/comments","events_url":"https://api.github.com/repos/intel/dffml/issues/1203/events","html_url":"https://github.com/intel/dffml/issues/1203","id":978273592,"node_id":"MDU6SXNzdWU5NzgyNzM1OTI=","number":1203,"title":"ci: run: consoletest: Hang on exit creates timeout failure","user":{"login":"pdxjohnny","id":5950433,"node_id":"MDQ6VXNlcjU5NTA0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/5950433?v=4","gravatar_id":"","url":"https://api.github.com/users/pdxjohnny","html_url":"https://github.com/pdxjohnny","followers_url":"https://api.github.com/users/pdxjohnny/followers","following_url":"https://api.github.com/users/pdxjohnny/following{/other_user}","gists_url":"https://api.github.com/users/pdxjohnny/gists{/gist_id}","starred_url":"https://api.github.com/users/pdxjohnny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pdxjohnny/subscriptions","organizations_url":"https://api.github.com/users/pdxjohnny/orgs","repos_url":"https://api.github.com/users/pdxjohnny/repos","events_url":"https://api.github.com/users/pdxjohnny/events{/privacy}","received_events_url":"https://api.github.com/users/pdxjohnny/received_events","type":"User","site_admin":false},"labels":[{"id":2570298492,"node_id":"MDU6TGFiZWwyNTcwMjk4NDky","url":"https://api.github.com/repos/intel/dffml/labels/kind/ci/failing","name":"kind/ci/failing","color":"d31f04","default":false,"description":"CI is currently failing due to one of these issues"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-08-24T16:21:56Z","updated_at":"2021-08-31T16:28:35Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"Had a similar issue with commit linting where a git command failed from a\nsubprocess run, causing the CI the hang until the job as canceled.\n\nhttps://github.com/intel/dffml/runs/3395514117\n\n```\n2021-08-20T16:25:06.3462470Z Traceback (most recent call last):\n2021-08-20T16:25:06.3463972Z   File \"/home/runner/work/dffml/dffml/dffml/util/testing/consoletest/builder.py\", line 129, in test_doc\n2021-08-20T16:25:06.3464772Z     setup=self.consoletest_test_setup,\n2021-08-20T16:25:06.3465622Z   File \"/opt/hostedtoolcache/Python/3.7.11/x64/lib/python3.7/asyncio/base_events.py\", line 587, in run_until_complete\n2021-08-20T16:25:06.3466468Z     return future.result()\n2021-08-20T16:25:06.3467184Z   File \"/home/runner/work/dffml/dffml/dffml/util/testing/consoletest/runner.py\", line 105, in run_nodes\n2021-08-20T16:25:06.3467847Z     await command.run(ctx)\n2021-08-20T16:25:06.3468531Z   File \"/home/runner/work/dffml/dffml/dffml/util/testing/consoletest/commands.py\", line 412, in run\n2021-08-20T16:25:06.3469195Z     daemon=bool(self.daemon),\n2021-08-20T16:25:06.3469933Z   File \"/home/runner/work/dffml/dffml/dffml/util/testing/consoletest/commands.py\", line 336, in run_commands\n2021-08-20T16:25:06.3470695Z     raise RuntimeError(\"\\n\".join(errors))\n2021-08-20T16:25:06.3472181Z RuntimeError: Failed to run: ['dffml', 'list', 'records', '-sources', 'portal=sources.sap_portal_repos_json:SAPPortalReposJSONSource', '-source-portal-filename', 'html-client/repos.json']\n2021-08-20T16:25:06.3473155Z \n2021-08-20T16:25:06.3473480Z No more tempdir\n2021-08-20T16:25:06.3473728Z \n2021-08-20T16:25:06.3473920Z \n2021-08-20T16:25:06.3474255Z consoletest summary\n2021-08-20T16:25:06.3474615Z ===================\n2021-08-20T16:25:06.3474922Z     1 test\n2021-08-20T16:25:06.3475258Z     1 failure in tests\n2021-08-20T16:25:06.3475906Z [01mbuild finished with problems, 19 warnings.[39;49;00m\n2021-08-20T16:25:06.3476363Z FAIL\n2021-08-20T16:25:06.3476562Z \n2021-08-20T16:25:06.3476884Z ======================================================================\n2021-08-20T16:25:06.3477521Z FAIL: test_examples_swportal (tests.docs.test_consoletest.TestDocs)\n2021-08-20T16:25:06.3478416Z ----------------------------------------------------------------------\n2021-08-20T16:25:06.3479083Z Traceback (most recent call last):\n2021-08-20T16:25:06.3479834Z   File \"/home/runner/work/dffml/dffml/tests/docs/test_consoletest.py\", line 150, in builder_testcase\n2021-08-20T16:25:06.3480589Z     self.assertFalse(app.statuscode)\n2021-08-20T16:25:06.3481135Z AssertionError: 1 is not false\n2021-08-20T16:25:06.3481499Z \n2021-08-20T16:25:06.3482104Z ----------------------------------------------------------------------\n2021-08-20T16:25:06.3482571Z Ran 1 test in 16.299s\n2021-08-20T16:25:06.3482807Z \n2021-08-20T16:25:06.3483136Z FAILED (failures=1)\n2021-08-20T22:21:55.7311955Z ##[error]The operation was canceled.\n```\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/intel/dffml/issues/1203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/intel/dffml/issues/1203/timeline","performed_via_github_app":null,"state_reason":null}