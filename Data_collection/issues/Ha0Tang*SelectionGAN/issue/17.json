{"url":"https://api.github.com/repos/Ha0Tang/SelectionGAN/issues/17","repository_url":"https://api.github.com/repos/Ha0Tang/SelectionGAN","labels_url":"https://api.github.com/repos/Ha0Tang/SelectionGAN/issues/17/labels{/name}","comments_url":"https://api.github.com/repos/Ha0Tang/SelectionGAN/issues/17/comments","events_url":"https://api.github.com/repos/Ha0Tang/SelectionGAN/issues/17/events","html_url":"https://github.com/Ha0Tang/SelectionGAN/issues/17","id":1147640238,"node_id":"I_kwDOCs1-Uc5EZ5mu","number":17,"title":"CNDNN_ERROR ?","user":{"login":"edwardcho","id":29569662,"node_id":"MDQ6VXNlcjI5NTY5NjYy","avatar_url":"https://avatars.githubusercontent.com/u/29569662?v=4","gravatar_id":"","url":"https://api.github.com/users/edwardcho","html_url":"https://github.com/edwardcho","followers_url":"https://api.github.com/users/edwardcho/followers","following_url":"https://api.github.com/users/edwardcho/following{/other_user}","gists_url":"https://api.github.com/users/edwardcho/gists{/gist_id}","starred_url":"https://api.github.com/users/edwardcho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edwardcho/subscriptions","organizations_url":"https://api.github.com/users/edwardcho/orgs","repos_url":"https://api.github.com/users/edwardcho/repos","events_url":"https://api.github.com/users/edwardcho/events{/privacy}","received_events_url":"https://api.github.com/users/edwardcho/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2022-02-23T05:14:40Z","updated_at":"2022-08-28T00:50:37Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hello Sir,\r\n\r\nUsing my-datasets, I tried to train your code.\r\nBut I met CUDNN-ERROR.\r\n\r\n```python\r\n...\r\n/pytorch/aten/src/ATen/native/cuda/ScatterGatherKernel.cu:312: operator(): block: [374,0,0], thread: [62,0,0] Assertion `idx_dim >= 0 && idx_dim < index_size && \"index out of bounds\"` failed.\r\n/pytorch/aten/src/ATen/native/cuda/ScatterGatherKernel.cu:312: operator(): block: [374,0,0], thread: [63,0,0] Assertion `idx_dim >= 0 && idx_dim < index_size && \"index out of bounds\"` failed.\r\nTraceback (most recent call last):\r\n  File \"/data1/TESTBOARD/additional_networks/generation/SelectionGAN_Ha0Tang/semantic_synthesis/train.py\", line 40, in <module>\r\n    trainer.run_generator_one_step(data_i)\r\n  File \"/data1/TESTBOARD/additional_networks/generation/SelectionGAN_Ha0Tang/semantic_synthesis/trainers/pix2pix_trainer.py\", line 35, in run_generator_one_step\r\n    g_losses, generated = self.pix2pix_model(data, mode='generator')\r\n  File \"/home/itsme/anaconda3/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 1051, in _call_impl\r\n    return forward_call(*input, **kwargs)\r\n  File \"/home/itsme/anaconda3/lib/python3.7/site-packages/torch/nn/parallel/data_parallel.py\", line 166, in forward\r\n    return self.module(*inputs[0], **kwargs[0])\r\n  File \"/home/itsme/anaconda3/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 1051, in _call_impl\r\n    return forward_call(*input, **kwargs)\r\n  File \"/data1/TESTBOARD/additional_networks/generation/SelectionGAN_Ha0Tang/semantic_synthesis/models/pix2pix_model.py\", line 46, in forward\r\n    input_semantics, real_image)\r\n  File \"/data1/TESTBOARD/additional_networks/generation/SelectionGAN_Ha0Tang/semantic_synthesis/models/pix2pix_model.py\", line 136, in compute_generator_loss\r\n    input_semantics, real_image, compute_kld_loss=self.opt.use_vae)\r\n  File \"/data1/TESTBOARD/additional_networks/generation/SelectionGAN_Ha0Tang/semantic_synthesis/models/pix2pix_model.py\", line 198, in generate_fake\r\n    fake_image = self.netG(input_semantics, z=z)\r\n  File \"/home/itsme/anaconda3/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 1051, in _call_impl\r\n    return forward_call(*input, **kwargs)\r\n  File \"/data1/TESTBOARD/additional_networks/generation/SelectionGAN_Ha0Tang/semantic_synthesis/models/networks/generator.py\", line 90, in forward\r\n    x = self.fc(x)\r\n  File \"/home/itsme/anaconda3/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 1051, in _call_impl\r\n    return forward_call(*input, **kwargs)\r\n  File \"/home/itsme/anaconda3/lib/python3.7/site-packages/torch/nn/modules/conv.py\", line 443, in forward\r\n    return self._conv_forward(input, self.weight, self.bias)\r\n  File \"/home/itsme/anaconda3/lib/python3.7/site-packages/torch/nn/modules/conv.py\", line 440, in _conv_forward\r\n    self.padding, self.dilation, self.groups)\r\nRuntimeError: cuDNN error: CUDNN_STATUS_NOT_INITIALIZED\r\nterminate called after throwing an instance of 'c10::CUDAError'\r\n  what():  CUDA error: device-side assert triggered\r\nCUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.\r\nFor debugging consider passing CUDA_LAUNCH_BLOCKING=1.\r\nException raised from create_event_internal at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1055 (most recent call first):\r\nframe #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7f44b3256a22 in /home/itsme/anaconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\r\nframe #1: <unknown function> + 0x10aa3 (0x7f44b34b7aa3 in /home/itsme/anaconda3/lib/python3.7/site-packages/torch/lib/libc10_cuda.so)\r\nframe #2: c10::cuda::CUDACachingAllocator::raw_delete(void*) + 0x1a7 (0x7f44b34b9147 in /home/itsme/anaconda3/lib/python3.7/site-packages/torch/lib/libc10_cuda.so)\r\nframe #3: c10::TensorImpl::release_resources() + 0x54 (0x7f44b32405a4 in /home/itsme/anaconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\r\nframe #4: <unknown function> + 0xa2f382 (0x7f4558065382 in /home/itsme/anaconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\r\nframe #5: <unknown function> + 0xa2f421 (0x7f4558065421 in /home/itsme/anaconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\r\n<omitting python frames>\r\nframe #21: __libc_start_main + 0xe7 (0x7f455add0b97 in /lib/x86_64-linux-gnu/libc.so.6)\r\n```\r\n\r\nHow to solve it??\r\n\r\nThanks,\r\nEdward Cho.","closed_by":null,"reactions":{"url":"https://api.github.com/repos/Ha0Tang/SelectionGAN/issues/17/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Ha0Tang/SelectionGAN/issues/17/timeline","performed_via_github_app":null,"state_reason":null}