[{"id":5325443439,"node_id":"LE_lADOCpNhO847ofy2zwAAAAE9a9Fv","url":"https://api.github.com/repos/pmariglia/showdown/issues/events/5325443439","actor":{"login":"pmariglia","id":25304649,"node_id":"MDQ6VXNlcjI1MzA0NjQ5","avatar_url":"https://avatars.githubusercontent.com/u/25304649?v=4","gravatar_id":"","url":"https://api.github.com/users/pmariglia","html_url":"https://github.com/pmariglia","followers_url":"https://api.github.com/users/pmariglia/followers","following_url":"https://api.github.com/users/pmariglia/following{/other_user}","gists_url":"https://api.github.com/users/pmariglia/gists{/gist_id}","starred_url":"https://api.github.com/users/pmariglia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pmariglia/subscriptions","organizations_url":"https://api.github.com/users/pmariglia/orgs","repos_url":"https://api.github.com/users/pmariglia/repos","events_url":"https://api.github.com/users/pmariglia/events{/privacy}","received_events_url":"https://api.github.com/users/pmariglia/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-09-20T00:48:09Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/pmariglia/showdown/issues/comments/950862387","html_url":"https://github.com/pmariglia/showdown/issues/78#issuecomment-950862387","issue_url":"https://api.github.com/repos/pmariglia/showdown/issues/78","id":950862387,"node_id":"IC_kwDOCpNhO844rQIz","user":{"login":"mancho2000","id":81579146,"node_id":"MDQ6VXNlcjgxNTc5MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/81579146?v=4","gravatar_id":"","url":"https://api.github.com/users/mancho2000","html_url":"https://github.com/mancho2000","followers_url":"https://api.github.com/users/mancho2000/followers","following_url":"https://api.github.com/users/mancho2000/following{/other_user}","gists_url":"https://api.github.com/users/mancho2000/gists{/gist_id}","starred_url":"https://api.github.com/users/mancho2000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mancho2000/subscriptions","organizations_url":"https://api.github.com/users/mancho2000/orgs","repos_url":"https://api.github.com/users/mancho2000/repos","events_url":"https://api.github.com/users/mancho2000/events{/privacy}","received_events_url":"https://api.github.com/users/mancho2000/received_events","type":"User","site_admin":false},"created_at":"2021-10-25T12:12:38Z","updated_at":"2021-10-25T12:12:55Z","author_association":"NONE","body":"Hey, I tried solving this but not sure if its correct. Let me know what you think:\r\n\r\n```\r\nmoves = [get_move_information(m) for m in msg_lines if m.startswith('|move|')]\r\n#get any switches\r\nswitch_moves = [m for m in msg_lines if m.startswith('|switch|')]\r\n\r\n#check if the only attack is from opponent and there are no switches\r\nif moves[0][0].startswith(battle.opponent.name) and len(moves) == 1 and len(switch_moves) == 0:\r\n    pass\r\nelif len(switch_moves) > 0 or moves[0][0].startswith(battle.user.name) or moves[0][1][constants.PRIORITY] != moves[1][1][constants.PRIORITY]: # return if there are any switches \r\n    return\r\n```","reactions":{"url":"https://api.github.com/repos/pmariglia/showdown/issues/comments/950862387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mancho2000","id":81579146,"node_id":"MDQ6VXNlcjgxNTc5MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/81579146?v=4","gravatar_id":"","url":"https://api.github.com/users/mancho2000","html_url":"https://github.com/mancho2000","followers_url":"https://api.github.com/users/mancho2000/followers","following_url":"https://api.github.com/users/mancho2000/following{/other_user}","gists_url":"https://api.github.com/users/mancho2000/gists{/gist_id}","starred_url":"https://api.github.com/users/mancho2000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mancho2000/subscriptions","organizations_url":"https://api.github.com/users/mancho2000/orgs","repos_url":"https://api.github.com/users/mancho2000/repos","events_url":"https://api.github.com/users/mancho2000/events{/privacy}","received_events_url":"https://api.github.com/users/mancho2000/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/pmariglia/showdown/issues/comments/968104573","html_url":"https://github.com/pmariglia/showdown/issues/78#issuecomment-968104573","issue_url":"https://api.github.com/repos/pmariglia/showdown/issues/78","id":968104573,"node_id":"IC_kwDOCpNhO845tBp9","user":{"login":"pmariglia","id":25304649,"node_id":"MDQ6VXNlcjI1MzA0NjQ5","avatar_url":"https://avatars.githubusercontent.com/u/25304649?v=4","gravatar_id":"","url":"https://api.github.com/users/pmariglia","html_url":"https://github.com/pmariglia","followers_url":"https://api.github.com/users/pmariglia/followers","following_url":"https://api.github.com/users/pmariglia/following{/other_user}","gists_url":"https://api.github.com/users/pmariglia/gists{/gist_id}","starred_url":"https://api.github.com/users/pmariglia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pmariglia/subscriptions","organizations_url":"https://api.github.com/users/pmariglia/orgs","repos_url":"https://api.github.com/users/pmariglia/repos","events_url":"https://api.github.com/users/pmariglia/events{/privacy}","received_events_url":"https://api.github.com/users/pmariglia/received_events","type":"User","site_admin":false},"created_at":"2021-11-13T17:28:47Z","updated_at":"2021-11-13T17:28:47Z","author_association":"OWNER","body":"This alone isn't enough. As it is, it will actually error in certain situations because it is trying to access `moves[0][0]` before checking that there is at least 1 move with `if len(moves) == 2`.\r\n\r\nA small refactor of what you have here would _in theory_ work, but I remembered why this was something I didn't add in the first place.\r\n\r\nIn the event that the opponent moves first and knocks out the user's active pokemon, the move that the user selected isn't available in the battle-log (because it never got a chance to occur). The decision is important however because the priority of the moves need to be compared to ensure that the bot would've gone first in the event that the opponent didn't have a choicescarf. This requires using the `LastUsedMove` attribute of the `Battler` object.\r\n\r\nThere's a bunch more edge cases that need to be considered when 2 moves aren't shown in the log. For example if the opponent knocked you out with sucker-punch, the move you choice is important in inferring a choice scarf.","reactions":{"url":"https://api.github.com/repos/pmariglia/showdown/issues/comments/968104573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pmariglia","id":25304649,"node_id":"MDQ6VXNlcjI1MzA0NjQ5","avatar_url":"https://avatars.githubusercontent.com/u/25304649?v=4","gravatar_id":"","url":"https://api.github.com/users/pmariglia","html_url":"https://github.com/pmariglia","followers_url":"https://api.github.com/users/pmariglia/followers","following_url":"https://api.github.com/users/pmariglia/following{/other_user}","gists_url":"https://api.github.com/users/pmariglia/gists{/gist_id}","starred_url":"https://api.github.com/users/pmariglia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pmariglia/subscriptions","organizations_url":"https://api.github.com/users/pmariglia/orgs","repos_url":"https://api.github.com/users/pmariglia/repos","events_url":"https://api.github.com/users/pmariglia/events{/privacy}","received_events_url":"https://api.github.com/users/pmariglia/received_events","type":"User","site_admin":false}}]