{"url":"https://api.github.com/repos/shaoxiongji/federated-learning/issues/4","repository_url":"https://api.github.com/repos/shaoxiongji/federated-learning","labels_url":"https://api.github.com/repos/shaoxiongji/federated-learning/issues/4/labels{/name}","comments_url":"https://api.github.com/repos/shaoxiongji/federated-learning/issues/4/comments","events_url":"https://api.github.com/repos/shaoxiongji/federated-learning/issues/4/events","html_url":"https://github.com/shaoxiongji/federated-learning/issues/4","id":447281839,"node_id":"MDU6SXNzdWU0NDcyODE4Mzk=","number":4,"title":"Runtime error on cuda","user":{"login":"SohamMazumder","id":19251191,"node_id":"MDQ6VXNlcjE5MjUxMTkx","avatar_url":"https://avatars.githubusercontent.com/u/19251191?v=4","gravatar_id":"","url":"https://api.github.com/users/SohamMazumder","html_url":"https://github.com/SohamMazumder","followers_url":"https://api.github.com/users/SohamMazumder/followers","following_url":"https://api.github.com/users/SohamMazumder/following{/other_user}","gists_url":"https://api.github.com/users/SohamMazumder/gists{/gist_id}","starred_url":"https://api.github.com/users/SohamMazumder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SohamMazumder/subscriptions","organizations_url":"https://api.github.com/users/SohamMazumder/orgs","repos_url":"https://api.github.com/users/SohamMazumder/repos","events_url":"https://api.github.com/users/SohamMazumder/events{/privacy}","received_events_url":"https://api.github.com/users/SohamMazumder/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-05-22T18:29:52Z","updated_at":"2019-08-22T03:05:49Z","closed_at":"2019-08-22T03:05:49Z","author_association":"NONE","active_lock_reason":null,"body":"`bin/bash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8)\r\n\r\ncuda:0\r\n\r\nCNNMnist(\r\n\r\n(conv1): Conv2d(1, 10, kernel_size=(5, 5), stride=(1, 1))\r\n\r\n(conv2): Conv2d(10, 20, kernel_size=(5, 5), stride=(1, 1))\r\n\r\n(conv2_drop): Dropout2d(p=0.5)\r\n\r\n(fc1): Linear(in_features=320, out_features=50, bias=True)\r\n\r\n(fc2): Linear(in_features=50, out_features=10, bias=True)\r\n\r\n)\r\n\r\n/opt/conda/lib/python3.6/site-packages/torchvision/datasets/mnist.py:43: UserWarning: train_labels has been renamed targets\r\n\r\nwarnings.warn(\"train_labels has been renamed targets\")\r\n\r\nTraceback (most recent call last):\r\n\r\nFile \"main_fed.py\", line 113, in <module>\r\n\r\nw, loss = local.train(net=copy.deepcopy(net_glob).to(args.device))\r\n\r\nFile \"/code/models/Update.py\", line 48, in train\r\n\r\nloss = self.loss_func(log_probs, labels)\r\n\r\nFile \"/opt/conda/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n\r\nresult = self.forward(*input, **kwargs)\r\n\r\nFile \"/opt/conda/lib/python3.6/site-packages/torch/nn/modules/loss.py\", line 904, in forward\r\n\r\nignore_index=self.ignore_index, reduction=self.reduction)\r\n\r\nFile \"/opt/conda/lib/python3.6/site-packages/torch/nn/functional.py\", line 1970, in cross_entropy\r\n\r\nreturn nll_loss(log_softmax(input, 1), target, weight, None, ignore_index, None, reduction)\r\n\r\nFile \"/opt/conda/lib/python3.6/site-packages/torch/nn/functional.py\", line 1790, in nll_loss\r\n\r\nret = torch._C._nn.nll_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index)\r\n\r\nRuntimeError: Expected object of backend CUDA but got backend CPU for argument  'weight'`\r\n\r\n\r\nI get the above error, only when trying to run it on CUDA.","closed_by":{"login":"shaoxiongji","id":18508057,"node_id":"MDQ6VXNlcjE4NTA4MDU3","avatar_url":"https://avatars.githubusercontent.com/u/18508057?v=4","gravatar_id":"","url":"https://api.github.com/users/shaoxiongji","html_url":"https://github.com/shaoxiongji","followers_url":"https://api.github.com/users/shaoxiongji/followers","following_url":"https://api.github.com/users/shaoxiongji/following{/other_user}","gists_url":"https://api.github.com/users/shaoxiongji/gists{/gist_id}","starred_url":"https://api.github.com/users/shaoxiongji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shaoxiongji/subscriptions","organizations_url":"https://api.github.com/users/shaoxiongji/orgs","repos_url":"https://api.github.com/users/shaoxiongji/repos","events_url":"https://api.github.com/users/shaoxiongji/events{/privacy}","received_events_url":"https://api.github.com/users/shaoxiongji/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/shaoxiongji/federated-learning/issues/4/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/shaoxiongji/federated-learning/issues/4/timeline","performed_via_github_app":null,"state_reason":"completed"}