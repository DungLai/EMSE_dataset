{"url":"https://api.github.com/repos/shaoxiongji/federated-learning/issues/13","repository_url":"https://api.github.com/repos/shaoxiongji/federated-learning","labels_url":"https://api.github.com/repos/shaoxiongji/federated-learning/issues/13/labels{/name}","comments_url":"https://api.github.com/repos/shaoxiongji/federated-learning/issues/13/comments","events_url":"https://api.github.com/repos/shaoxiongji/federated-learning/issues/13/events","html_url":"https://github.com/shaoxiongji/federated-learning/issues/13","id":673517243,"node_id":"MDU6SXNzdWU2NzM1MTcyNDM=","number":13,"title":"模型聚合这个步骤感觉和FedAvg原文上描述的不一样","user":{"login":"downing19","id":33869161,"node_id":"MDQ6VXNlcjMzODY5MTYx","avatar_url":"https://avatars.githubusercontent.com/u/33869161?v=4","gravatar_id":"","url":"https://api.github.com/users/downing19","html_url":"https://github.com/downing19","followers_url":"https://api.github.com/users/downing19/followers","following_url":"https://api.github.com/users/downing19/following{/other_user}","gists_url":"https://api.github.com/users/downing19/gists{/gist_id}","starred_url":"https://api.github.com/users/downing19/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/downing19/subscriptions","organizations_url":"https://api.github.com/users/downing19/orgs","repos_url":"https://api.github.com/users/downing19/repos","events_url":"https://api.github.com/users/downing19/events{/privacy}","received_events_url":"https://api.github.com/users/downing19/received_events","type":"User","site_admin":false},"labels":[{"id":884730267,"node_id":"MDU6TGFiZWw4ODQ3MzAyNjc=","url":"https://api.github.com/repos/shaoxiongji/federated-learning/labels/enhancement","name":"enhancement","color":"a2eeef","default":true,"description":"New feature or request"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-08-05T12:54:27Z","updated_at":"2020-10-03T16:50:49Z","closed_at":"2020-10-03T16:50:49Z","author_association":"NONE","active_lock_reason":null,"body":"最近参考大佬您的这个代码学习联邦学习，偶然发现一点令我疑惑的地方。原文中每一个global epoch会随机指定所有clients中的一个fraction进行更新（并不是所有clients都参与更新），聚合的时候原文描述的是所有clients的模型都进行聚合，即没有参与更新的clients的模型也都会参与平均。而代码中的聚合步骤只考虑了参与更新的clients的模型平均。请问代码是不是有问题，还是我的理解错误呢？\r\n\r\n    for iter in range(args.epochs):\r\n        w_locals, loss_locals = [], []\r\n        m = max(int(args.frac * args.num_users), 1)\r\n        idxs_users = np.random.choice(range(args.num_users), m, replace=False)\r\n        for idx in idxs_users:\r\n            local = LocalUpdate(args=args, dataset=dataset_train, idxs=dict_users[idx])\r\n            w, loss = local.train(net=copy.deepcopy(net_glob).to(args.device))\r\n            w_locals.append(copy.deepcopy(w))\r\n            loss_locals.append(copy.deepcopy(loss))\r\n        # update global weights\r\n        w_glob = FedAvg(w_locals)\r\n\r\n        # copy weight to net_glob\r\n        net_glob.load_state_dict(w_glob)\r\n","closed_by":{"login":"shaoxiongji","id":18508057,"node_id":"MDQ6VXNlcjE4NTA4MDU3","avatar_url":"https://avatars.githubusercontent.com/u/18508057?v=4","gravatar_id":"","url":"https://api.github.com/users/shaoxiongji","html_url":"https://github.com/shaoxiongji","followers_url":"https://api.github.com/users/shaoxiongji/followers","following_url":"https://api.github.com/users/shaoxiongji/following{/other_user}","gists_url":"https://api.github.com/users/shaoxiongji/gists{/gist_id}","starred_url":"https://api.github.com/users/shaoxiongji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shaoxiongji/subscriptions","organizations_url":"https://api.github.com/users/shaoxiongji/orgs","repos_url":"https://api.github.com/users/shaoxiongji/repos","events_url":"https://api.github.com/users/shaoxiongji/events{/privacy}","received_events_url":"https://api.github.com/users/shaoxiongji/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/shaoxiongji/federated-learning/issues/13/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/shaoxiongji/federated-learning/issues/13/timeline","performed_via_github_app":null,"state_reason":"completed"}