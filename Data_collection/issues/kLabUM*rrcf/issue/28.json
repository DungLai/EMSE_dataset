{"url":"https://api.github.com/repos/kLabUM/rrcf/issues/28","repository_url":"https://api.github.com/repos/kLabUM/rrcf","labels_url":"https://api.github.com/repos/kLabUM/rrcf/issues/28/labels{/name}","comments_url":"https://api.github.com/repos/kLabUM/rrcf/issues/28/comments","events_url":"https://api.github.com/repos/kLabUM/rrcf/issues/28/events","html_url":"https://github.com/kLabUM/rrcf/issues/28","id":381907884,"node_id":"MDU6SXNzdWUzODE5MDc4ODQ=","number":28,"title":"insert_point is slow","user":{"login":"mdbartos","id":8175317,"node_id":"MDQ6VXNlcjgxNzUzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/8175317?v=4","gravatar_id":"","url":"https://api.github.com/users/mdbartos","html_url":"https://github.com/mdbartos","followers_url":"https://api.github.com/users/mdbartos/followers","following_url":"https://api.github.com/users/mdbartos/following{/other_user}","gists_url":"https://api.github.com/users/mdbartos/gists{/gist_id}","starred_url":"https://api.github.com/users/mdbartos/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdbartos/subscriptions","organizations_url":"https://api.github.com/users/mdbartos/orgs","repos_url":"https://api.github.com/users/mdbartos/repos","events_url":"https://api.github.com/users/mdbartos/events{/privacy}","received_events_url":"https://api.github.com/users/mdbartos/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2018-11-17T22:35:57Z","updated_at":"2019-05-28T17:05:19Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"Running a line profiler on insert_point shows the top time consumers:\r\n\r\n```\r\n%lprun -f tree.insert_point tree.insert_point(inlier, index='inlier')\r\n```\r\n```\r\nLine #      Hits         Time  Per Hit   % Time  Line Contents\r\n==============================================================\r\n   ...\r\n   302        13       6400.0    492.3     69.6              bbox = self.get_bbox(node)\r\n   303        13       2214.0    170.3     24.1              cut_dimension, cut = self._insert_point_cut(point, bbox)\r\n   ...\r\n```\r\n\r\nWithin _insert_point_cut:\r\n```\r\n%lprun -f tree._insert_point_cut tree.insert_point(inlier, index='inlier')\r\n```\r\n\r\n```\r\nLine #      Hits         Time  Per Hit   % Time  Line Contents\r\n==============================================================\r\n   ...\r\n   520        13        267.0     20.5     10.1          bbox_hat = np.empty(bbox.shape)\r\n   521                                                   # Update the bounding box based on the internal point\r\n   522        13        363.0     27.9     13.8          bbox_hat[0, :] = np.minimum(bbox[0, :], point)\r\n   523        13        808.0     62.2     30.7          bbox_hat[1, :] = np.maximum(bbox[1, :], point)\r\n   524        13         85.0      6.5      3.2          b_span = bbox_hat[1, :] - bbox_hat[0, :]\r\n   525        13        309.0     23.8     11.7          b_range = b_span.sum()\r\n   526        13        213.0     16.4      8.1          r = np.random.uniform(0, b_range)\r\n   527        13        246.0     18.9      9.3          span_sum = np.cumsum(b_span)\r\n   ...\r\n```","closed_by":null,"reactions":{"url":"https://api.github.com/repos/kLabUM/rrcf/issues/28/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/kLabUM/rrcf/issues/28/timeline","performed_via_github_app":null,"state_reason":null}