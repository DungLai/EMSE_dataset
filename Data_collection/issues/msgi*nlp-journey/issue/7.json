{"url":"https://api.github.com/repos/msgi/nlp-journey/issues/7","repository_url":"https://api.github.com/repos/msgi/nlp-journey","labels_url":"https://api.github.com/repos/msgi/nlp-journey/issues/7/labels{/name}","comments_url":"https://api.github.com/repos/msgi/nlp-journey/issues/7/comments","events_url":"https://api.github.com/repos/msgi/nlp-journey/issues/7/events","html_url":"https://github.com/msgi/nlp-journey/issues/7","id":614534759,"node_id":"MDU6SXNzdWU2MTQ1MzQ3NTk=","number":7,"title":"tensorflow.python.framework.errors_impl.InvalidArgumentError: indices[0,77] = -1 is not in [0, 49) [Op:GatherV2]","user":{"login":"huaji1992","id":30308645,"node_id":"MDQ6VXNlcjMwMzA4NjQ1","avatar_url":"https://avatars.githubusercontent.com/u/30308645?v=4","gravatar_id":"","url":"https://api.github.com/users/huaji1992","html_url":"https://github.com/huaji1992","followers_url":"https://api.github.com/users/huaji1992/followers","following_url":"https://api.github.com/users/huaji1992/following{/other_user}","gists_url":"https://api.github.com/users/huaji1992/gists{/gist_id}","starred_url":"https://api.github.com/users/huaji1992/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaji1992/subscriptions","organizations_url":"https://api.github.com/users/huaji1992/orgs","repos_url":"https://api.github.com/users/huaji1992/repos","events_url":"https://api.github.com/users/huaji1992/events{/privacy}","received_events_url":"https://api.github.com/users/huaji1992/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-05-08T06:27:04Z","updated_at":"2020-05-08T12:01:03Z","closed_at":"2020-05-08T12:01:03Z","author_association":"NONE","active_lock_reason":null,"body":"tf.Tensor(\r\n[[  57  327  630 ...    0    0    0]\r\n [ 850 1979 2299 ...    0    0    0]\r\n [ 474  814   91 ...    0    0    0]\r\n ...\r\n [  44  110  881 ...    0    0    0]\r\n [   0   33  825 ...    0    0    0]\r\n [1787 1895  119 ...    0    0    0]], shape=(64, 100), dtype=int32)\r\ntf.Tensor(\r\n[[ 0  0  0 ... -1 -1 -1]\r\n [ 1  2  2 ... -1 -1 -1]\r\n [ 0  0  0 ... -1 -1 -1]\r\n ...\r\n [ 0  0  3 ... -1 -1 -1]\r\n [ 0  0  0 ... -1 -1 -1]\r\n [ 3  4  0 ... -1 -1 -1]], shape=(64, 100), dtype=int32)\r\nTraceback (most recent call last):\r\n  File \"c:\\Users\\Administrator\\Desktop\\keras_ner\\ner.py\", line 213, in <module>\r\n    file_path='data')\r\n  File \"c:\\Users\\Administrator\\Desktop\\keras_ner\\ner.py\", line 77, in __init__\r\n    self.model = self.train()\r\n  File \"c:\\Users\\Administrator\\Desktop\\keras_ner\\ner.py\", line 103, in train\r\n    loss, logits, text_lens = self.train_one_step(model, optimizer, text_batch, labels_batch)\r\n  File \"c:\\Users\\Administrator\\Desktop\\keras_ner\\ner.py\", line 117, in train_one_step\r\n    logits, text_lens, log_likelihood = model(text_batch, labels_batch, training=True)\r\n  File \"D:\\anaconda3\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\base_layer.py\", line 822, in __call__\r\n    outputs = self.call(cast_inputs, *args, **kwargs)\r\n  File \"c:\\Users\\Administrator\\Desktop\\keras_ner\\ner.py\", line 41, in call\r\n    log_likelihood, self.transition_params = ta.text.crf_log_likelihood(logits, label_sequences, text_lens)\r\n  File \"D:\\anaconda3\\lib\\site-packages\\tensorflow_addons\\text\\crf.py\", line 214, in crf_log_likelihood\r\n    inputs, tag_indices, sequence_lengths, transition_params\r\n  File \"D:\\anaconda3\\lib\\site-packages\\tensorflow_addons\\text\\crf.py\", line 77, in crf_sequence_score\r\n    return tf.cond(tf.equal(tf.shape(inputs)[1], 1), _single_seq_fn, _multi_seq_fn)\r\n  File \"D:\\anaconda3\\lib\\site-packages\\tensorflow_core\\python\\ops\\control_flow_ops.py\", line 1389, in cond_for_tf_v2\r\n    return cond(pred, true_fn=true_fn, false_fn=false_fn, strict=True, name=name)\r\n  File \"D:\\anaconda3\\lib\\site-packages\\tensorflow_core\\python\\util\\deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"D:\\anaconda3\\lib\\site-packages\\tensorflow_core\\python\\ops\\control_flow_ops.py\", line 1204, in cond\r\n    result = false_fn()\r\n  File \"D:\\anaconda3\\lib\\site-packages\\tensorflow_addons\\text\\crf.py\", line 72, in _multi_seq_fn\r\n    tag_indices, sequence_lengths, transition_params\r\n  File \"D:\\anaconda3\\lib\\site-packages\\tensorflow_addons\\text\\crf.py\", line 291, in crf_binary_score\r\n    binary_scores = tf.gather(flattened_transition_params, flattened_transition_indices)\r\n  File \"D:\\anaconda3\\lib\\site-packages\\tensorflow_core\\python\\util\\dispatch.py\", line 180, in wrapper\r\n    return target(*args, **kwargs)\r\n  File \"D:\\anaconda3\\lib\\site-packages\\tensorflow_core\\python\\ops\\array_ops.py\", line 4125, in gather_v2\r\n    batch_dims=batch_dims)\r\n  File \"D:\\anaconda3\\lib\\site-packages\\tensorflow_core\\python\\util\\dispatch.py\", line 180, in wrapper\r\n    return target(*args, **kwargs)\r\n  File \"D:\\anaconda3\\lib\\site-packages\\tensorflow_core\\python\\ops\\array_ops.py\", line 4108, in gather\r\n    return gen_array_ops.gather_v2(params, indices, axis, name=name)\r\n  File \"D:\\anaconda3\\lib\\site-packages\\tensorflow_core\\python\\ops\\gen_array_ops.py\", line 3683, in gather_v2\r\n    _ops.raise_from_not_ok_status(e, name)\r\n  File \"D:\\anaconda3\\lib\\site-packages\\tensorflow_core\\python\\framework\\ops.py\", line 6606, in raise_from_not_ok_status\r\n    six.raise_from(core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: indices[0,77] = -1 is not in [0, 49) [Op:GatherV2]\r\n\r\n\r\n大神，这是数据集问题吗？","closed_by":{"login":"msgi","id":15954140,"node_id":"MDQ6VXNlcjE1OTU0MTQw","avatar_url":"https://avatars.githubusercontent.com/u/15954140?v=4","gravatar_id":"","url":"https://api.github.com/users/msgi","html_url":"https://github.com/msgi","followers_url":"https://api.github.com/users/msgi/followers","following_url":"https://api.github.com/users/msgi/following{/other_user}","gists_url":"https://api.github.com/users/msgi/gists{/gist_id}","starred_url":"https://api.github.com/users/msgi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/msgi/subscriptions","organizations_url":"https://api.github.com/users/msgi/orgs","repos_url":"https://api.github.com/users/msgi/repos","events_url":"https://api.github.com/users/msgi/events{/privacy}","received_events_url":"https://api.github.com/users/msgi/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/msgi/nlp-journey/issues/7/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/msgi/nlp-journey/issues/7/timeline","performed_via_github_app":null,"state_reason":"completed"}