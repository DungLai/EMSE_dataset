{"url":"https://api.github.com/repos/benedekrozemberczki/role2vec/issues/1","repository_url":"https://api.github.com/repos/benedekrozemberczki/role2vec","labels_url":"https://api.github.com/repos/benedekrozemberczki/role2vec/issues/1/labels{/name}","comments_url":"https://api.github.com/repos/benedekrozemberczki/role2vec/issues/1/comments","events_url":"https://api.github.com/repos/benedekrozemberczki/role2vec/issues/1/events","html_url":"https://github.com/benedekrozemberczki/role2vec/issues/1","id":516772881,"node_id":"MDU6SXNzdWU1MTY3NzI4ODE=","number":1,"title":"How to use the trained model for infering nodes structural representation in new graphs. i.e. transfer learning","user":{"login":"ShengdingHu","id":32740627,"node_id":"MDQ6VXNlcjMyNzQwNjI3","avatar_url":"https://avatars.githubusercontent.com/u/32740627?v=4","gravatar_id":"","url":"https://api.github.com/users/ShengdingHu","html_url":"https://github.com/ShengdingHu","followers_url":"https://api.github.com/users/ShengdingHu/followers","following_url":"https://api.github.com/users/ShengdingHu/following{/other_user}","gists_url":"https://api.github.com/users/ShengdingHu/gists{/gist_id}","starred_url":"https://api.github.com/users/ShengdingHu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ShengdingHu/subscriptions","organizations_url":"https://api.github.com/users/ShengdingHu/orgs","repos_url":"https://api.github.com/users/ShengdingHu/repos","events_url":"https://api.github.com/users/ShengdingHu/events{/privacy}","received_events_url":"https://api.github.com/users/ShengdingHu/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-11-03T02:47:33Z","updated_at":"2019-11-17T19:20:50Z","closed_at":"2019-11-17T19:20:50Z","author_association":"NONE","active_lock_reason":null,"body":"I tried to use the trained model for new graphs. What I first tried was:\r\n``` python\r\n def infer_embedding(self,learned_model = \"doc2vec4role2vec\"):\r\n        \"\"\"\r\n        Pooling the features and infer an embedding using trained model\r\n        \"\"\"\r\n        self.pooled_features = self.create_pooled_features()\r\n        model = Doc2Vec.load(learned_model)\r\n        inferlist = []\r\n        print(\"begin infering...\")\r\n        for node in self.graph.nodes():\r\n            inferlist.append(model.infer_vector(self.pooled_features[str(node)]))\r\n        self.embedding = np.array(inferlist)\r\n        return self.embedding\r\n```\r\nAnd then use the `save_embedding` function to save the embedding. But the embedding I got was quite different from the training time output, which was generated by\r\n``` python\r\nembedding = np.array([model.docvecs[str(node)] for node in self.graph.nodes()])\r\n```\r\nThen I tried not using the pooled_features generated by random walk.\r\n``` python\r\n def infer_embedding(self,learned_model = \"doc2vec4role2vec\"):\r\n        \"\"\"\r\n        Pooling the features and infer an embedding using trained model\r\n        \"\"\"\r\n        model = Doc2Vec.load(learned_model)\r\n        inferlist = []\r\n        print(\"begin infering...\")\r\n        for node in self.graph.nodes():\r\n            inferlist.append(model.infer_vector(self.features[str(node)]))\r\n        self.embedding = np.array(inferlist)\r\n        return self.embedding\r\n```\r\nBut it's still different from the trained model. \r\n\r\nAs the author said in their paper, the framework is naturally inductive. So can anyone hint me how to use it in a transfer learning way? Thanks in advance.\r\n","closed_by":{"login":"benedekrozemberczki","id":17380887,"node_id":"MDQ6VXNlcjE3MzgwODg3","avatar_url":"https://avatars.githubusercontent.com/u/17380887?v=4","gravatar_id":"","url":"https://api.github.com/users/benedekrozemberczki","html_url":"https://github.com/benedekrozemberczki","followers_url":"https://api.github.com/users/benedekrozemberczki/followers","following_url":"https://api.github.com/users/benedekrozemberczki/following{/other_user}","gists_url":"https://api.github.com/users/benedekrozemberczki/gists{/gist_id}","starred_url":"https://api.github.com/users/benedekrozemberczki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benedekrozemberczki/subscriptions","organizations_url":"https://api.github.com/users/benedekrozemberczki/orgs","repos_url":"https://api.github.com/users/benedekrozemberczki/repos","events_url":"https://api.github.com/users/benedekrozemberczki/events{/privacy}","received_events_url":"https://api.github.com/users/benedekrozemberczki/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/benedekrozemberczki/role2vec/issues/1/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/benedekrozemberczki/role2vec/issues/1/timeline","performed_via_github_app":null,"state_reason":"completed"}