{"url":"https://api.github.com/repos/beringresearch/ivis/issues/118","repository_url":"https://api.github.com/repos/beringresearch/ivis","labels_url":"https://api.github.com/repos/beringresearch/ivis/issues/118/labels{/name}","comments_url":"https://api.github.com/repos/beringresearch/ivis/issues/118/comments","events_url":"https://api.github.com/repos/beringresearch/ivis/issues/118/events","html_url":"https://github.com/beringresearch/ivis/issues/118","id":1358551764,"node_id":"I_kwDOCJ2sz85Q-drU","number":118,"title":"InternalError: Graph execution error:","user":{"login":"bitcometz","id":13601652,"node_id":"MDQ6VXNlcjEzNjAxNjUy","avatar_url":"https://avatars.githubusercontent.com/u/13601652?v=4","gravatar_id":"","url":"https://api.github.com/users/bitcometz","html_url":"https://github.com/bitcometz","followers_url":"https://api.github.com/users/bitcometz/followers","following_url":"https://api.github.com/users/bitcometz/following{/other_user}","gists_url":"https://api.github.com/users/bitcometz/gists{/gist_id}","starred_url":"https://api.github.com/users/bitcometz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitcometz/subscriptions","organizations_url":"https://api.github.com/users/bitcometz/orgs","repos_url":"https://api.github.com/users/bitcometz/repos","events_url":"https://api.github.com/users/bitcometz/events{/privacy}","received_events_url":"https://api.github.com/users/bitcometz/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-09-01T09:39:53Z","updated_at":"2023-01-11T12:16:12Z","closed_at":"2023-01-11T12:16:11Z","author_association":"NONE","active_lock_reason":null,"body":"Helloï¼Œ\r\nI want to use `ivis` to do the analysis for my scRNA-seq data.\r\n\r\nHere is my code:\r\n```python\r\ndef getReduction(X):\r\n    #X = PCA(n_components=4, copy=True, random_state=1).fit_transform(X)\r\n    from ivis import Ivis\r\n    model = Ivis(embedding_dims=4, k=15)\r\n    X = model.fit_transform(X)\r\n    print(X.shape)\r\n    return X\r\n```\r\n\r\nbut I got some errors:\r\n```\r\n---------------------------------------------------------------------------\r\nInternalError                             Traceback (most recent call last)\r\nInput In [9], in <cell line: 1>()\r\n----> 1 multi_train_x = getReduction(train_x)\r\n\r\nInput In [8], in getReduction(X)\r\n      3 from ivis import Ivis\r\n      4 model = Ivis(embedding_dims=6, k=15)\r\n----> 5 X = model.fit_transform(X)\r\n      6 print(X.shape)\r\n      7 return X\r\n\r\nFile /opt/conda/lib/python3.8/site-packages/ivis/ivis.py:368, in Ivis.fit_transform(self, X, Y, shuffle_mode)\r\n    349 def fit_transform(self, X, Y=None, shuffle_mode=True):\r\n    350     \"\"\"Fit to data then transform\r\n    351 \r\n    352     Parameters\r\n   (...)\r\n    365         Embedding of the data in low-dimensional space.\r\n    366     \"\"\"\r\n--> 368     self.fit(X, Y, shuffle_mode)\r\n    369     return self.transform(X)\r\n\r\nFile /opt/conda/lib/python3.8/site-packages/ivis/ivis.py:346, in Ivis.fit(self, X, Y, shuffle_mode)\r\n    328 def fit(self, X, Y=None, shuffle_mode=True):\r\n    329     \"\"\"Fit an ivis model.\r\n    330 \r\n    331     Parameters\r\n   (...)\r\n    343         Returns estimator instance.\r\n    344     \"\"\"\r\n--> 346     self._fit(X, Y, shuffle_mode)\r\n    347     return self\r\n\r\nFile /opt/conda/lib/python3.8/site-packages/ivis/ivis.py:318, in Ivis._fit(self, X, Y, shuffle_mode)\r\n    315 if self.verbose > 0:\r\n    316     print('Training neural network')\r\n--> 318 hist = self.model_.fit(\r\n    319     datagen,\r\n    320     epochs=self.epochs,\r\n    321     callbacks=self.callbacks_ + [EarlyStopping(monitor='loss',\r\n    322                                                patience=self.n_epochs_without_progress)],\r\n    323     shuffle=shuffle_mode,\r\n    324     steps_per_epoch=int(np.ceil(X.shape[0] / self.batch_size)),\r\n    325     verbose=self.verbose)\r\n    326 self.loss_history_ += hist.history['loss']\r\n\r\nFile /opt/conda/lib/python3.8/site-packages/keras/utils/traceback_utils.py:67, in filter_traceback.<locals>.error_handler(*args, **kwargs)\r\n     65 except Exception as e:  # pylint: disable=broad-except\r\n     66   filtered_tb = _process_traceback_frames(e.__traceback__)\r\n---> 67   raise e.with_traceback(filtered_tb) from None\r\n     68 finally:\r\n     69   del filtered_tb\r\n\r\nFile /opt/conda/lib/python3.8/site-packages/tensorflow/python/eager/execute.py:54, in quick_execute(op_name, num_outputs, inputs, attrs, ctx, name)\r\n     52 try:\r\n     53   ctx.ensure_initialized()\r\n---> 54   tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,\r\n     55                                       inputs, attrs, num_outputs)\r\n     56 except core._NotOkStatusException as e:\r\n     57   if name is not None:\r\n\r\nInternalError: Graph execution error:\r\n\r\nDetected at node 'model_1/model/dense/MatMul' defined at (most recent call last):\r\n    File \"/opt/conda/lib/python3.8/runpy.py\", line 194, in _run_module_as_main\r\n      return _run_code(code, main_globals, None,\r\n    File \"/opt/conda/lib/python3.8/runpy.py\", line 87, in _run_code\r\n      exec(code, run_globals)\r\n    File \"/opt/conda/lib/python3.8/site-packages/ipykernel_launcher.py\", line 17, in <module>\r\n      app.launch_new_instance()\r\n    File \"/opt/conda/lib/python3.8/site-packages/traitlets/config/application.py\", line 846, in launch_instance\r\n      app.start()\r\n    File \"/opt/conda/lib/python3.8/site-packages/ipykernel/kernelapp.py\", line 712, in start\r\n      self.io_loop.start()\r\n    File \"/opt/conda/lib/python3.8/site-packages/tornado/platform/asyncio.py\", line 199, in start\r\n      self.asyncio_loop.run_forever()\r\n    File \"/opt/conda/lib/python3.8/asyncio/base_events.py\", line 570, in run_forever\r\n      self._run_once()\r\n    File \"/opt/conda/lib/python3.8/asyncio/base_events.py\", line 1859, in _run_once\r\n      handle._run()\r\n    File \"/opt/conda/lib/python3.8/asyncio/events.py\", line 81, in _run\r\n      self._context.run(self._callback, *self._args)\r\n    File \"/opt/conda/lib/python3.8/site-packages/ipykernel/kernelbase.py\", line 504, in dispatch_queue\r\n      await self.process_one()\r\n    File \"/opt/conda/lib/python3.8/site-packages/ipykernel/kernelbase.py\", line 493, in process_one\r\n      await dispatch(*args)\r\n    File \"/opt/conda/lib/python3.8/site-packages/ipykernel/kernelbase.py\", line 400, in dispatch_shell\r\n      await result\r\n    File \"/opt/conda/lib/python3.8/site-packages/ipykernel/kernelbase.py\", line 724, in execute_request\r\n      reply_content = await reply_content\r\n    File \"/opt/conda/lib/python3.8/site-packages/ipykernel/ipkernel.py\", line 383, in do_execute\r\n      res = shell.run_cell(\r\n    File \"/opt/conda/lib/python3.8/site-packages/ipykernel/zmqshell.py\", line 528, in run_cell\r\n      return super().run_cell(*args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 2880, in run_cell\r\n      result = self._run_cell(\r\n    File \"/opt/conda/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 2935, in _run_cell\r\n      return runner(coro)\r\n    File \"/opt/conda/lib/python3.8/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\r\n      coro.send(None)\r\n    File \"/opt/conda/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 3134, in run_cell_async\r\n      has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\r\n    File \"/opt/conda/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 3337, in run_ast_nodes\r\n      if await self.run_code(code, result, async_=asy):\r\n    File \"/opt/conda/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 3397, in run_code\r\n      exec(code_obj, self.user_global_ns, self.user_ns)\r\n    File \"/tmp/ipykernel_1917/2291785529.py\", line 1, in <cell line: 1>\r\n      multi_train_x = getReduction(train_x)\r\n    File \"/tmp/ipykernel_1917/2290316524.py\", line 5, in getReduction\r\n      X = model.fit_transform(X)\r\n    File \"/opt/conda/lib/python3.8/site-packages/ivis/ivis.py\", line 368, in fit_transform\r\n      self.fit(X, Y, shuffle_mode)\r\n    File \"/opt/conda/lib/python3.8/site-packages/ivis/ivis.py\", line 346, in fit\r\n      self._fit(X, Y, shuffle_mode)\r\n    File \"/opt/conda/lib/python3.8/site-packages/ivis/ivis.py\", line 318, in _fit\r\n      hist = self.model_.fit(\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/utils/traceback_utils.py\", line 64, in error_handler\r\n      return fn(*args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/engine/training.py\", line 1409, in fit\r\n      tmp_logs = self.train_function(iterator)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/engine/training.py\", line 1051, in train_function\r\n      return step_function(self, iterator)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/engine/training.py\", line 1040, in step_function\r\n      outputs = model.distribute_strategy.run(run_step, args=(data,))\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/engine/training.py\", line 1030, in run_step\r\n      outputs = model.train_step(data)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/engine/training.py\", line 889, in train_step\r\n      y_pred = self(x, training=True)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/utils/traceback_utils.py\", line 64, in error_handler\r\n      return fn(*args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/engine/training.py\", line 490, in __call__\r\n      return super().__call__(*args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/utils/traceback_utils.py\", line 64, in error_handler\r\n      return fn(*args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/engine/base_layer.py\", line 1014, in __call__\r\n      outputs = call_fn(inputs, *args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/utils/traceback_utils.py\", line 92, in error_handler\r\n      return fn(*args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/engine/functional.py\", line 458, in call\r\n      return self._run_internal_graph(\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/engine/functional.py\", line 596, in _run_internal_graph\r\n      outputs = node.layer(*args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/utils/traceback_utils.py\", line 64, in error_handler\r\n      return fn(*args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/engine/training.py\", line 490, in __call__\r\n      return super().__call__(*args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/utils/traceback_utils.py\", line 64, in error_handler\r\n      return fn(*args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/engine/base_layer.py\", line 1014, in __call__\r\n      outputs = call_fn(inputs, *args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/utils/traceback_utils.py\", line 92, in error_handler\r\n      return fn(*args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/engine/functional.py\", line 458, in call\r\n      return self._run_internal_graph(\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/engine/functional.py\", line 596, in _run_internal_graph\r\n      outputs = node.layer(*args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/utils/traceback_utils.py\", line 64, in error_handler\r\n      return fn(*args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/engine/base_layer.py\", line 1014, in __call__\r\n      outputs = call_fn(inputs, *args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/utils/traceback_utils.py\", line 92, in error_handler\r\n      return fn(*args, **kwargs)\r\n    File \"/opt/conda/lib/python3.8/site-packages/keras/layers/core/dense.py\", line 221, in call\r\n      outputs = tf.matmul(a=inputs, b=self.kernel)\r\nNode: 'model_1/model/dense/MatMul'\r\nAttempting to perform BLAS operation using StreamExecutor without BLAS support\r\n\t [[{{node model_1/model/dense/MatMul}}]] [Op:__inference_train_function_1703]\r\n\r\n```\r\n\r\nThanks !!!","closed_by":{"login":"Szubie","id":13461031,"node_id":"MDQ6VXNlcjEzNDYxMDMx","avatar_url":"https://avatars.githubusercontent.com/u/13461031?v=4","gravatar_id":"","url":"https://api.github.com/users/Szubie","html_url":"https://github.com/Szubie","followers_url":"https://api.github.com/users/Szubie/followers","following_url":"https://api.github.com/users/Szubie/following{/other_user}","gists_url":"https://api.github.com/users/Szubie/gists{/gist_id}","starred_url":"https://api.github.com/users/Szubie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Szubie/subscriptions","organizations_url":"https://api.github.com/users/Szubie/orgs","repos_url":"https://api.github.com/users/Szubie/repos","events_url":"https://api.github.com/users/Szubie/events{/privacy}","received_events_url":"https://api.github.com/users/Szubie/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/beringresearch/ivis/issues/118/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/beringresearch/ivis/issues/118/timeline","performed_via_github_app":null,"state_reason":"completed"}