{"url":"https://api.github.com/repos/beringresearch/ivis/issues/29","repository_url":"https://api.github.com/repos/beringresearch/ivis","labels_url":"https://api.github.com/repos/beringresearch/ivis/issues/29/labels{/name}","comments_url":"https://api.github.com/repos/beringresearch/ivis/issues/29/comments","events_url":"https://api.github.com/repos/beringresearch/ivis/issues/29/events","html_url":"https://github.com/beringresearch/ivis/issues/29","id":473765813,"node_id":"MDU6SXNzdWU0NzM3NjU4MTM=","number":29,"title":"Issue running the example code to test the R package","user":{"login":"kevinrue","id":5769108,"node_id":"MDQ6VXNlcjU3NjkxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/5769108?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrue","html_url":"https://github.com/kevinrue","followers_url":"https://api.github.com/users/kevinrue/followers","following_url":"https://api.github.com/users/kevinrue/following{/other_user}","gists_url":"https://api.github.com/users/kevinrue/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrue/subscriptions","organizations_url":"https://api.github.com/users/kevinrue/orgs","repos_url":"https://api.github.com/users/kevinrue/repos","events_url":"https://api.github.com/users/kevinrue/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrue/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-07-28T17:14:23Z","updated_at":"2019-07-28T18:27:50Z","closed_at":"2019-07-28T18:27:50Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Hello,\r\n\r\nFor [JOSS review](https://github.com/openjournals/joss-reviews/issues/1596).\r\n\r\nI am running into the following issue when running the example R code (given in this [README.md](https://github.com/beringresearch/ivis/blob/master/R-package/README.md)) in an R console in my terminal.\r\n\r\nThe package was successfully installed in an R console in my terminal as described in #28 \r\n\r\nThe main error below seems to be: `UnboundLocalError: local variable 'a' referenced before assignment`.\r\n\r\n```\r\n> library(ivis)\r\n> \r\n> model <- ivis(k = 3, batch_size = 3)\r\nUsing TensorFlow backend.\r\n/Users/kevin/miniconda3/envs/ivis/lib/python3.7/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.6 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.7\r\n  return f(*args, **kwds)\r\n> \r\n> X = data.matrix(iris[, 1:4])\r\n> model = model$fit(X)\r\nBuilding KNN index\r\n/Users/kevin/miniconda3/envs/ivis/lib/python3.7/site-packages/ivis/data/knn.py:15: FutureWarning: The default argument for metric will be removed in future version of Annoy. Please pass metric='angular' explicitly.\r\n  index = AnnoyIndex(X.shape[1])\r\n100%|███████████████████████████████████████████████████████████████████████| 150/150 [00:00<00:00, 127667.53it/s]\r\nExtracting KNN from index\r\n/Users/kevin/miniconda3/envs/ivis/lib/python3.7/site-packages/ivis/data/knn.py:92: FutureWarning: The default argument for metric will be removed in future version of Annoy. Please pass metric='angular' explicitly.\r\n  self.index = AnnoyIndex(n_dims)\r\n 11%|████████▌                                                                  | 17/150 [00:00<00:00, 141.19it/s]\r\nWARNING:tensorflow:From /Users/kevin/miniconda3/envs/ivis/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\nError in py_call_impl(callable, dots$args, dots$keywords) : \r\n  UnboundLocalError: local variable 'a' referenced before assignment\r\n\r\nDetailed traceback: \r\n  File \"/Users/kevin/miniconda3/envs/ivis/lib/python3.7/site-packages/ivis/ivis.py\", line 209, in fit\r\n    self._fit(X, Y, shuffle_mode)\r\n  File \"/Users/kevin/miniconda3/envs/ivis/lib/python3.7/site-packages/ivis/ivis.py\", line 147, in _fit\r\n    triplet_network(base_network(self.model_def, input_size),\r\n  File \"/Users/kevin/miniconda3/envs/ivis/lib/python3.7/site-packages/ivis/nn/network.py\", line 41, in base_network\r\n    return default_base_network(input_shape)\r\n  File \"/Users/kevin/miniconda3/envs/ivis/lib/python3.7/site-packages/ivis/nn/network.py\", line 61, in default_base_network\r\n    x = AlphaDropout(0.1)(x)\r\n  File \"/Users/kevin/miniconda3/envs/ivis/lib/python3.7/site-packages/keras/engine/base_layer.py\", line 457, in __call__\r\n    output = self.call(inputs, **kwargs)\r\n  File \"/Users/kevin/miniconda3/envs/ivis/lib/python3.7/site-packages/keras/layers/noise.py\", line 165, in call\r\n    return K\r\n> \r\n> xy = model$transform(X)\r\nError in py_call_impl(callable, dots$args, dots$keywords) : \r\n  AttributeError: 'NoneType' object has no attribute 'predict'\r\n\r\nDetailed traceback: \r\n  File \"/Users/kevin/miniconda3/envs/ivis/lib/python3.7/site-packages/ivis/ivis.py\", line 248, in transform\r\n    embedding = self.encoder.predict(X, verbose=self.verbose)\r\n```\r\n\r\nSession info reported below\r\n```\r\n> sessionInfo()\r\nR version 3.6.0 (2019-04-26)\r\nPlatform: x86_64-apple-darwin18.5.0 (64-bit)\r\nRunning under: macOS Mojave 10.14.5\r\n\r\nMatrix products: default\r\nBLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib\r\nLAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib\r\n\r\nlocale:\r\n[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8\r\n\r\nattached base packages:\r\n[1] stats     graphics  grDevices utils     datasets  methods   base     \r\n\r\nother attached packages:\r\n[1] ivis_1.1.3\r\n\r\nloaded via a namespace (and not attached):\r\n[1] compiler_3.6.0     BiocManager_1.30.4 Matrix_1.2-17      tools_3.6.0       \r\n[5] Rcpp_1.0.2         reticulate_1.13    grid_3.6.0         jsonlite_1.6      \r\n[9] lattice_0.20-38  \r\n```","closed_by":{"login":"idroz","id":12413294,"node_id":"MDQ6VXNlcjEyNDEzMjk0","avatar_url":"https://avatars.githubusercontent.com/u/12413294?v=4","gravatar_id":"","url":"https://api.github.com/users/idroz","html_url":"https://github.com/idroz","followers_url":"https://api.github.com/users/idroz/followers","following_url":"https://api.github.com/users/idroz/following{/other_user}","gists_url":"https://api.github.com/users/idroz/gists{/gist_id}","starred_url":"https://api.github.com/users/idroz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/idroz/subscriptions","organizations_url":"https://api.github.com/users/idroz/orgs","repos_url":"https://api.github.com/users/idroz/repos","events_url":"https://api.github.com/users/idroz/events{/privacy}","received_events_url":"https://api.github.com/users/idroz/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/beringresearch/ivis/issues/29/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/beringresearch/ivis/issues/29/timeline","performed_via_github_app":null,"state_reason":"completed"}