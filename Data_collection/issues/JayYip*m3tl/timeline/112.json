[{"url":"https://api.github.com/repos/JayYip/m3tl/issues/comments/1274194256","html_url":"https://github.com/JayYip/m3tl/issues/112#issuecomment-1274194256","issue_url":"https://api.github.com/repos/JayYip/m3tl/issues/112","id":1274194256,"node_id":"IC_kwDOCYOcXc5L8qlQ","user":{"login":"JayYip","id":15050572,"node_id":"MDQ6VXNlcjE1MDUwNTcy","avatar_url":"https://avatars.githubusercontent.com/u/15050572?v=4","gravatar_id":"","url":"https://api.github.com/users/JayYip","html_url":"https://github.com/JayYip","followers_url":"https://api.github.com/users/JayYip/followers","following_url":"https://api.github.com/users/JayYip/following{/other_user}","gists_url":"https://api.github.com/users/JayYip/gists{/gist_id}","starred_url":"https://api.github.com/users/JayYip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JayYip/subscriptions","organizations_url":"https://api.github.com/users/JayYip/orgs","repos_url":"https://api.github.com/users/JayYip/repos","events_url":"https://api.github.com/users/JayYip/events{/privacy}","received_events_url":"https://api.github.com/users/JayYip/received_events","type":"User","site_admin":false},"created_at":"2022-10-11T07:13:57Z","updated_at":"2022-10-11T07:13:57Z","author_association":"OWNER","body":"好的，我下周看看\n\nOn Thu, Sep 22, 2022, 8:35 PM Edward Chan ***@***.***> wrote:\n\n> code from https://github.com/EdwardChan5000/m3tl_run\n>\n> 错误show below\n>\n> 2022-09-21 16:17:06.321 | INFO | m3tl.utils:set_phase:478 - Setting phase\n> to infer\n> 2022-09-21 16:17:06.345 | CRITICAL | m3tl.model_fn:compile:271 - Initial\n> lr: 2e-05\n> 2022-09-21 16:17:06.345 | CRITICAL | m3tl.model_fn:compile:272 - Train\n> steps: 408675\n> 2022-09-21 16:17:06.345 | CRITICAL | m3tl.model_fn:compile:273 - Warmup\n> steps: 40867\n> 2022-09-21 16:17:06.361554: I\n> tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session\n> initializing.\n> 2022-09-21 16:17:06.361588: I\n> tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session\n> started.\n> 2022-09-21 16:17:06.361613: I\n> tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found\n> 1 GPUs\n> 2022-09-21 16:17:06.369724: I\n> tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully\n> opened dynamic library libcupti.so.11.0\n> 2022-09-21 16:17:06.655982: I\n> tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear\n> down.\n> 2022-09-21 16:17:06.656157: I\n> tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity\n> buffer flushed\n> 2022-09-21 16:17:07.017 | INFO | m3tl.utils:set_phase:478 - Setting phase\n> to train\n> WARNING:tensorflow:The parameters output_attentions, output_hidden_states\n> and use_cache cannot be updated when calling a model.They have to be set\n> to True/False in the config object (i.e.: config=XConfig.from_pretrained('name',\n> output_attentions=True)).\n> WARNING:tensorflow:The parameter return_dict cannot be set in graph mode\n> and will always be set to True.\n> 2022-09-21 16:17:19.175 | INFO | m3tl.utils:set_phase:478 - Setting phase\n> to train\n> Traceback (most recent call last):\n> File \"m3tl_4room_rdrop.py\", line 195, in\n> main(args)\n> File \"m3tl_4room_rdrop.py\", line 149, in main\n> create_tf_record_only=False, model_dir=model_dir,\n> mirrored_strategy=mirrored_strategy)\n> File \"/usr/local/lib/python3.6/site-packages/m3tl/run_bert_multitask.py\",\n> line 319, in train_bert_multitask\n> verbose=verbose\n> File \"/usr/local/lib/python3.6/site-packages/m3tl/run_bert_multitask.py\",\n> line 163, in _train_bert_multitask_keras_model\n> validation_steps=validation_steps\n> File\n> \"/usr/local/lib64/python3.6/site-packages/tensorflow/python/keras/engine/training.py\",\n> line 1100, in fit\n> tmp_logs = self.train_function(iterator)\n> File\n> \"/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/def_function.py\",\n> line 828, in *call*\n> result = self._call(*args, **kwds)\n> File\n> \"/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/def_function.py\",\n> line 855, in _call\n> return self._stateless_fn(*args, **kwds) # pylint: disable=not-callable\n> File\n> \"/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py\",\n> line 2943, in *call*\n> filtered_flat_args, captured_inputs=graph_function.captured_inputs) #\n> pylint: disable=protected-access\n> File\n> \"/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py\",\n> line 1919, in _call_flat\n> ctx, args, cancellation_manager=cancellation_manager))\n> File\n> \"/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py\",\n> line 560, in call\n> ctx=ctx)\n> File\n> \"/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/execute.py\",\n> line 60, in quick_execute\n> inputs, attrs, num_outputs)\n> tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root\n> error(s) found.\n> (0) Invalid argument: Number of ways to split should evenly divide the\n> split dimension, but got split_dim 0 (size = 7) and num_split 2\n> [[node\n> BertMultiTask/BertMultiTaskTop/rdrop_preprocess/rdrop_preprocess/split_1\n> (defined at data/yard/workspace/vega/m3tl_run/custom_top.py:250) ]]\n> (1) Invalid argument: Number of ways to split should evenly divide the\n> split dimension, but got split_dim 0 (size = 7) and num_split 2\n> [[node\n> BertMultiTask/BertMultiTaskTop/rdrop_preprocess/rdrop_preprocess/split_1\n> (defined at data/yard/workspace/vega/m3tl_run/custom_top.py:250) ]]\n>\n> [[BertMultiTask/BertMultiTaskTop/rdrop_preprocess/rdrop_preprocess/split_1/_44]]\n> 0 successful operations.\n> 0 derived errors ignored. [Op:__inference_train_function_423171]\n>\n> Errors may have originated from an input operation.\n> Input Source operations connected to node\n> BertMultiTask/BertMultiTaskTop/rdrop_preprocess/rdrop_preprocess/split_1:\n> BertMultiTask/basic_mtl/GatherNd (defined at\n> usr/local/lib/python3.6/site-packages/m3tl/utils.py:412)\n>\n> Input Source operations connected to node\n> BertMultiTask/BertMultiTaskTop/rdrop_preprocess/rdrop_preprocess/split_1:\n> BertMultiTask/basic_mtl/GatherNd (defined at\n> usr/local/lib/python3.6/site-packages/m3tl/utils.py:412)\n>\n> Function call stack:\n> train_function -> train_function\n>\n> —\n> Reply to this email directly, view it on GitHub\n> <https://github.com/JayYip/m3tl/issues/112>, or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ADS2OTDITUG23H7HZGCEYTDV7RHADANCNFSM6AAAAAAQTAIMCM>\n> .\n> You are receiving this because you are subscribed to this thread.Message\n> ID: ***@***.***>\n>\n","reactions":{"url":"https://api.github.com/repos/JayYip/m3tl/issues/comments/1274194256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"JayYip","id":15050572,"node_id":"MDQ6VXNlcjE1MDUwNTcy","avatar_url":"https://avatars.githubusercontent.com/u/15050572?v=4","gravatar_id":"","url":"https://api.github.com/users/JayYip","html_url":"https://github.com/JayYip","followers_url":"https://api.github.com/users/JayYip/followers","following_url":"https://api.github.com/users/JayYip/following{/other_user}","gists_url":"https://api.github.com/users/JayYip/gists{/gist_id}","starred_url":"https://api.github.com/users/JayYip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JayYip/subscriptions","organizations_url":"https://api.github.com/users/JayYip/orgs","repos_url":"https://api.github.com/users/JayYip/repos","events_url":"https://api.github.com/users/JayYip/events{/privacy}","received_events_url":"https://api.github.com/users/JayYip/received_events","type":"User","site_admin":false}}]