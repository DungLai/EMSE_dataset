{"url":"https://api.github.com/repos/JayYip/m3tl/issues/112","repository_url":"https://api.github.com/repos/JayYip/m3tl","labels_url":"https://api.github.com/repos/JayYip/m3tl/issues/112/labels{/name}","comments_url":"https://api.github.com/repos/JayYip/m3tl/issues/112/comments","events_url":"https://api.github.com/repos/JayYip/m3tl/issues/112/events","html_url":"https://github.com/JayYip/m3tl/issues/112","id":1382378337,"node_id":"I_kwDOCYOcXc5SZWth","number":112,"title":"使用rdrop, it shows a tf.split error. 大佬帮忙看看","user":{"login":"EdwardChan5000","id":23416947,"node_id":"MDQ6VXNlcjIzNDE2OTQ3","avatar_url":"https://avatars.githubusercontent.com/u/23416947?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardChan5000","html_url":"https://github.com/EdwardChan5000","followers_url":"https://api.github.com/users/EdwardChan5000/followers","following_url":"https://api.github.com/users/EdwardChan5000/following{/other_user}","gists_url":"https://api.github.com/users/EdwardChan5000/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardChan5000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardChan5000/subscriptions","organizations_url":"https://api.github.com/users/EdwardChan5000/orgs","repos_url":"https://api.github.com/users/EdwardChan5000/repos","events_url":"https://api.github.com/users/EdwardChan5000/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardChan5000/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-09-22T12:35:01Z","updated_at":"2022-10-11T07:13:57Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"code from https://github.com/EdwardChan5000/m3tl_run\r\n\r\n错误show below\r\n\r\n2022-09-21 16:17:06.321 | INFO     | m3tl.utils:set_phase:478 - Setting phase to infer\r\n2022-09-21 16:17:06.345 | CRITICAL | m3tl.model_fn:compile:271 - Initial lr: 2e-05\r\n2022-09-21 16:17:06.345 | CRITICAL | m3tl.model_fn:compile:272 - Train steps: 408675\r\n2022-09-21 16:17:06.345 | CRITICAL | m3tl.model_fn:compile:273 - Warmup steps: 40867\r\n2022-09-21 16:17:06.361554: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.\r\n2022-09-21 16:17:06.361588: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.\r\n2022-09-21 16:17:06.361613: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs\r\n2022-09-21 16:17:06.369724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so.11.0\r\n2022-09-21 16:17:06.655982: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.\r\n2022-09-21 16:17:06.656157: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1487] CUPTI activity buffer flushed\r\n2022-09-21 16:17:07.017 | INFO     | m3tl.utils:set_phase:478 - Setting phase to train\r\nWARNING:tensorflow:The parameters `output_attentions`, `output_hidden_states` and `use_cache` cannot be updated when calling a model.They have to be set to True/False in the config object (i.e.: `config=XConfig.from_pretrained('name', output_attentions=True)`).\r\nWARNING:tensorflow:The parameter `return_dict` cannot be set in graph mode and will always be set to `True`.\r\n2022-09-21 16:17:19.175 | INFO     | m3tl.utils:set_phase:478 - Setting phase to train\r\nTraceback (most recent call last):\r\n  File \"m3tl_4room_rdrop.py\", line 195, in <module>\r\n    main(args)\r\n  File \"m3tl_4room_rdrop.py\", line 149, in main\r\n    create_tf_record_only=False, model_dir=model_dir, mirrored_strategy=mirrored_strategy)\r\n  File \"/usr/local/lib/python3.6/site-packages/m3tl/run_bert_multitask.py\", line 319, in train_bert_multitask\r\n    verbose=verbose\r\n  File \"/usr/local/lib/python3.6/site-packages/m3tl/run_bert_multitask.py\", line 163, in _train_bert_multitask_keras_model\r\n    validation_steps=validation_steps\r\n  File \"/usr/local/lib64/python3.6/site-packages/tensorflow/python/keras/engine/training.py\", line 1100, in fit\r\n    tmp_logs = self.train_function(iterator)\r\n  File \"/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/def_function.py\", line 828, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/def_function.py\", line 855, in _call\r\n    return self._stateless_fn(*args, **kwds)  # pylint: disable=not-callable\r\n  File \"/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py\", line 2943, in __call__\r\n    filtered_flat_args, captured_inputs=graph_function.captured_inputs)  # pylint: disable=protected-access\r\n  File \"/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py\", line 1919, in _call_flat\r\n    ctx, args, cancellation_manager=cancellation_manager))\r\n  File \"/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py\", line 560, in call\r\n    ctx=ctx)\r\n  File \"/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/execute.py\", line 60, in quick_execute\r\n    inputs, attrs, num_outputs)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.\r\n  (0) Invalid argument:  Number of ways to split should evenly divide the split dimension, but got split_dim 0 (size = 7) and num_split 2\r\n\t [[node BertMultiTask/BertMultiTaskTop/rdrop_preprocess/rdrop_preprocess/split_1 (defined at data/yard/workspace/vega/m3tl_run/custom_top.py:250) ]]\r\n  (1) Invalid argument:  Number of ways to split should evenly divide the split dimension, but got split_dim 0 (size = 7) and num_split 2\r\n\t [[node BertMultiTask/BertMultiTaskTop/rdrop_preprocess/rdrop_preprocess/split_1 (defined at data/yard/workspace/vega/m3tl_run/custom_top.py:250) ]]\r\n\t [[BertMultiTask/BertMultiTaskTop/rdrop_preprocess/rdrop_preprocess/split_1/_44]]\r\n0 successful operations.\r\n0 derived errors ignored. [Op:__inference_train_function_423171]\r\n\r\nErrors may have originated from an input operation.\r\nInput Source operations connected to node BertMultiTask/BertMultiTaskTop/rdrop_preprocess/rdrop_preprocess/split_1:\r\n BertMultiTask/basic_mtl/GatherNd (defined at usr/local/lib/python3.6/site-packages/m3tl/utils.py:412)\r\n\r\nInput Source operations connected to node BertMultiTask/BertMultiTaskTop/rdrop_preprocess/rdrop_preprocess/split_1:\r\n BertMultiTask/basic_mtl/GatherNd (defined at usr/local/lib/python3.6/site-packages/m3tl/utils.py:412)\r\n\r\nFunction call stack:\r\ntrain_function -> train_function","closed_by":null,"reactions":{"url":"https://api.github.com/repos/JayYip/m3tl/issues/112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/JayYip/m3tl/issues/112/timeline","performed_via_github_app":null,"state_reason":null}