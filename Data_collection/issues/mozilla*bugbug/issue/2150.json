{"url":"https://api.github.com/repos/mozilla/bugbug/issues/2150","repository_url":"https://api.github.com/repos/mozilla/bugbug","labels_url":"https://api.github.com/repos/mozilla/bugbug/issues/2150/labels{/name}","comments_url":"https://api.github.com/repos/mozilla/bugbug/issues/2150/comments","events_url":"https://api.github.com/repos/mozilla/bugbug/issues/2150/events","html_url":"https://github.com/mozilla/bugbug/issues/2150","id":805395053,"node_id":"MDU6SXNzdWU4MDUzOTUwNTM=","number":2150,"title":"HTTP service failing when a revision is on central but not autoland","user":{"login":"marco-c","id":1616846,"node_id":"MDQ6VXNlcjE2MTY4NDY=","avatar_url":"https://avatars.githubusercontent.com/u/1616846?v=4","gravatar_id":"","url":"https://api.github.com/users/marco-c","html_url":"https://github.com/marco-c","followers_url":"https://api.github.com/users/marco-c/followers","following_url":"https://api.github.com/users/marco-c/following{/other_user}","gists_url":"https://api.github.com/users/marco-c/gists{/gist_id}","starred_url":"https://api.github.com/users/marco-c/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marco-c/subscriptions","organizations_url":"https://api.github.com/users/marco-c/orgs","repos_url":"https://api.github.com/users/marco-c/repos","events_url":"https://api.github.com/users/marco-c/events{/privacy}","received_events_url":"https://api.github.com/users/marco-c/received_events","type":"User","site_admin":false},"labels":[{"id":864568507,"node_id":"MDU6TGFiZWw4NjQ1Njg1MDc=","url":"https://api.github.com/repos/mozilla/bugbug/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"marco-c","id":1616846,"node_id":"MDQ6VXNlcjE2MTY4NDY=","avatar_url":"https://avatars.githubusercontent.com/u/1616846?v=4","gravatar_id":"","url":"https://api.github.com/users/marco-c","html_url":"https://github.com/marco-c","followers_url":"https://api.github.com/users/marco-c/followers","following_url":"https://api.github.com/users/marco-c/following{/other_user}","gists_url":"https://api.github.com/users/marco-c/gists{/gist_id}","starred_url":"https://api.github.com/users/marco-c/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marco-c/subscriptions","organizations_url":"https://api.github.com/users/marco-c/orgs","repos_url":"https://api.github.com/users/marco-c/repos","events_url":"https://api.github.com/users/marco-c/events{/privacy}","received_events_url":"https://api.github.com/users/marco-c/received_events","type":"User","site_admin":false},"assignees":[{"login":"marco-c","id":1616846,"node_id":"MDQ6VXNlcjE2MTY4NDY=","avatar_url":"https://avatars.githubusercontent.com/u/1616846?v=4","gravatar_id":"","url":"https://api.github.com/users/marco-c","html_url":"https://github.com/marco-c","followers_url":"https://api.github.com/users/marco-c/followers","following_url":"https://api.github.com/users/marco-c/following{/other_user}","gists_url":"https://api.github.com/users/marco-c/gists{/gist_id}","starred_url":"https://api.github.com/users/marco-c/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marco-c/subscriptions","organizations_url":"https://api.github.com/users/marco-c/orgs","repos_url":"https://api.github.com/users/marco-c/repos","events_url":"https://api.github.com/users/marco-c/events{/privacy}","received_events_url":"https://api.github.com/users/marco-c/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2021-02-10T10:43:51Z","updated_at":"2021-02-10T11:37:03Z","closed_at":"2021-02-10T11:37:03Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"In the totally unlucky case where we run the commit retrieval task and got a commit which landed on central but not yet on autoland, the HTTP service can fail with `abort: unknown revision '89c5f958a3ac4795109acf1f9dff1c8026bb82fe'`.\r\n\r\n```\r\nFeb 10 09:47:50 bugbug app/worker.1: 2021-02-10 09:47:50,179:INFO:bugbug.repository:/tmp/bugbug-hg cloned \r\nFeb 10 09:47:50 bugbug app/worker.1: 2021-02-10 09:47:50,183:INFO:bugbug_http.boot:Updating commits DB... \r\nFeb 10 09:47:51 bugbug app/worker.1: 2021-02-10 09:47:50,893:INFO:bugbug.repository:Getting revs from children(89c5f958a3ac4795109acf1f9dff1c8026bb82fe) to tip... \r\nFeb 10 09:47:51 bugbug app/worker.1: Traceback (most recent call last): \r\nFeb 10 09:47:51 bugbug app/worker.1:   File \"/usr/local/bin/bugbug-http-worker\", line 8, in <module> \r\nFeb 10 09:47:51 bugbug app/worker.1:     sys.exit(main()) \r\nFeb 10 09:47:51 bugbug app/worker.1:   File \"/usr/local/lib/python3.8/site-packages/bugbug_http/worker.py\", line 23, in main \r\nFeb 10 09:47:51 bugbug app/worker.1:     bugbug_http.boot.boot_worker() \r\nFeb 10 09:47:51 bugbug app/worker.1:   File \"/usr/local/lib/python3.8/site-packages/bugbug_http/boot.py\", line 164, in boot_worker \r\nFeb 10 09:47:51 bugbug app/worker.1:     commits = repository.download_commits( \r\nFeb 10 09:47:51 bugbug app/worker.1:   File \"/usr/local/lib/python3.8/site-packages/bugbug/repository.py\", line 1168, in download_commits \r\nFeb 10 09:47:51 bugbug app/worker.1:     revs = get_revs(hg, rev_start) \r\nFeb 10 09:47:51 bugbug app/worker.1:   File \"/usr/local/lib/python3.8/site-packages/bugbug/repository.py\", line 794, in get_revs \r\nFeb 10 09:47:51 bugbug app/worker.1:     x = hg.rawcommand(args) \r\nFeb 10 09:47:51 bugbug app/worker.1:   File \"/usr/local/lib/python3.8/site-packages/hglib/client.py\", line 263, in rawcommand \r\nFeb 10 09:47:51 bugbug app/worker.1:     raise error.CommandError(args, ret, out, err) \r\nFeb 10 09:47:51 bugbug app/worker.1: hglib.error.CommandError: (255, b'', b\"obsolete feature not enabled but 46 markers found!\\nabort: unknown revision '89c5f958a3ac4795109acf1f9dff1c8026bb82fe'!\") \r\n```","closed_by":{"login":"marco-c","id":1616846,"node_id":"MDQ6VXNlcjE2MTY4NDY=","avatar_url":"https://avatars.githubusercontent.com/u/1616846?v=4","gravatar_id":"","url":"https://api.github.com/users/marco-c","html_url":"https://github.com/marco-c","followers_url":"https://api.github.com/users/marco-c/followers","following_url":"https://api.github.com/users/marco-c/following{/other_user}","gists_url":"https://api.github.com/users/marco-c/gists{/gist_id}","starred_url":"https://api.github.com/users/marco-c/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marco-c/subscriptions","organizations_url":"https://api.github.com/users/marco-c/orgs","repos_url":"https://api.github.com/users/marco-c/repos","events_url":"https://api.github.com/users/marco-c/events{/privacy}","received_events_url":"https://api.github.com/users/marco-c/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mozilla/bugbug/issues/2150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mozilla/bugbug/issues/2150/timeline","performed_via_github_app":null,"state_reason":"completed"}