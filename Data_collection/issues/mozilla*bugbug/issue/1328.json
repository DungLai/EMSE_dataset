{"url":"https://api.github.com/repos/mozilla/bugbug/issues/1328","repository_url":"https://api.github.com/repos/mozilla/bugbug","labels_url":"https://api.github.com/repos/mozilla/bugbug/issues/1328/labels{/name}","comments_url":"https://api.github.com/repos/mozilla/bugbug/issues/1328/comments","events_url":"https://api.github.com/repos/mozilla/bugbug/issues/1328/events","html_url":"https://github.com/mozilla/bugbug/issues/1328","id":572265817,"node_id":"MDU6SXNzdWU1NzIyNjU4MTc=","number":1328,"title":"Generate the test scheduling DB directly while getting data using mozci","user":{"login":"marco-c","id":1616846,"node_id":"MDQ6VXNlcjE2MTY4NDY=","avatar_url":"https://avatars.githubusercontent.com/u/1616846?v=4","gravatar_id":"","url":"https://api.github.com/users/marco-c","html_url":"https://github.com/marco-c","followers_url":"https://api.github.com/users/marco-c/followers","following_url":"https://api.github.com/users/marco-c/following{/other_user}","gists_url":"https://api.github.com/users/marco-c/gists{/gist_id}","starred_url":"https://api.github.com/users/marco-c/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marco-c/subscriptions","organizations_url":"https://api.github.com/users/marco-c/orgs","repos_url":"https://api.github.com/users/marco-c/repos","events_url":"https://api.github.com/users/marco-c/events{/privacy}","received_events_url":"https://api.github.com/users/marco-c/received_events","type":"User","site_admin":false},"labels":[{"id":864568511,"node_id":"MDU6TGFiZWw4NjQ1Njg1MTE=","url":"https://api.github.com/repos/mozilla/bugbug/labels/enhancement","name":"enhancement","color":"a2eeef","default":true,"description":"New feature or request"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-02-27T18:17:49Z","updated_at":"2020-02-27T18:17:49Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"Currently the two things are split in two separate tasks:\r\n1) The first task downloads the data from AD and generates a summary artifact;\r\n2) The second task retrieves the summary artifact and generates the test scheduling DB.\r\n\r\nInstead, we could generate the test scheduling DB directly while we're getting data from AD.\r\n\r\nWe are currently using LMDB and the memory usage is quite high with the current settings. We needed the task to be fast (we would pay too much otherwise for the cloud machine with high memory). If we move the DB generation code directly in the task which gets data from AD, then we don't need it to be fast anymore and we could probably reduce the memory usage: either by tweaking the LMDB settings, or more preferably by storing the key/values in S3 (preferably because this way in the evaluation phase we won't need to download the whole DB, but just they keys we need).","closed_by":null,"reactions":{"url":"https://api.github.com/repos/mozilla/bugbug/issues/1328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mozilla/bugbug/issues/1328/timeline","performed_via_github_app":null,"state_reason":null}