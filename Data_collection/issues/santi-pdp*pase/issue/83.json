{"url":"https://api.github.com/repos/santi-pdp/pase/issues/83","repository_url":"https://api.github.com/repos/santi-pdp/pase","labels_url":"https://api.github.com/repos/santi-pdp/pase/issues/83/labels{/name}","comments_url":"https://api.github.com/repos/santi-pdp/pase/issues/83/comments","events_url":"https://api.github.com/repos/santi-pdp/pase/issues/83/events","html_url":"https://github.com/santi-pdp/pase/issues/83","id":565734578,"node_id":"MDU6SXNzdWU1NjU3MzQ1Nzg=","number":83,"title":"Trying to load the pretained model","user":{"login":"MittalShruti","id":5301961,"node_id":"MDQ6VXNlcjUzMDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5301961?v=4","gravatar_id":"","url":"https://api.github.com/users/MittalShruti","html_url":"https://github.com/MittalShruti","followers_url":"https://api.github.com/users/MittalShruti/followers","following_url":"https://api.github.com/users/MittalShruti/following{/other_user}","gists_url":"https://api.github.com/users/MittalShruti/gists{/gist_id}","starred_url":"https://api.github.com/users/MittalShruti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MittalShruti/subscriptions","organizations_url":"https://api.github.com/users/MittalShruti/orgs","repos_url":"https://api.github.com/users/MittalShruti/repos","events_url":"https://api.github.com/users/MittalShruti/events{/privacy}","received_events_url":"https://api.github.com/users/MittalShruti/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-02-15T11:20:27Z","updated_at":"2020-03-04T08:14:20Z","closed_at":"2020-02-16T04:35:18Z","author_association":"NONE","active_lock_reason":null,"body":"I run the following code in google colab (Cuda 10.0)\r\n\r\n```\r\nfrom pase.models.frontend import wf_builder\r\npase = wf_builder('cfg/frontend/PASE+.cfg').eval()\r\npase.load_pretrained('FE_e199.ckpt', load_last=True, verbose=True)\r\n\r\n# Now we can forward waveforms as Torch tensors\r\nimport torch\r\nx = torch.randn(1, 1, 100000) # example with random noise to check shape\r\n# y size will be (1, 256, 625), which are 625 frames of 256 dims each\r\ny = pase(x)\r\n```\r\n\r\nI tried both ```pase(x)``` and ```pase(x.cuda())```\r\n\r\nFor ```pase(x)``` I get the following error \r\n\r\n```\r\nAssertionError                            Traceback (most recent call last)\r\n<ipython-input-11-eae0f995c36c> in <module>()\r\n      2 x = torch.randn(1, 1, 100000) # example with random noise to check shape\r\n      3 # y size will be (1, 256, 625), which are 625 frames of 256 dims each\r\n----> 4 y = pase(x)\r\n\r\n7 frames\r\n/usr/local/lib/python3.6/dist-packages/torchqrnn/forget_mult.py in forward(self, f, x, hidden_init, use_cuda)\r\n    173         use_cuda = use_cuda and torch.cuda.is_available()\r\n    174         # Ensure the user is aware when ForgetMult is not GPU version as it's far faster\r\n--> 175         if use_cuda: assert f.is_cuda and x.is_cuda, 'GPU ForgetMult with fast element-wise CUDA kernel requested but tensors not on GPU'\r\n    176         ###\r\n    177         # Avoiding 'RuntimeError: expected a Variable argument, but got NoneType' when hidden_init is None\r\n\r\nAssertionError: GPU ForgetMult with fast element-wise CUDA kernel requested but tensors not on GPU\r\n```\r\n\r\nfor ```pase(x.cuda())``` I get the following error\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-12-5f65b8d305f3> in <module>()\r\n      2 x = torch.randn(1, 1, 100000) # example with random noise to check shape\r\n      3 # y size will be (1, 256, 625), which are 625 frames of 256 dims each\r\n----> 4 y = pase(x.cuda())\r\n\r\n5 frames\r\n/content/pase/pase/models/modules.py in forward(self, waveforms)\r\n    900         band=(high-low)[:,0]\r\n    901 \r\n--> 902         f_times_t_low = torch.matmul(low, self.n_)\r\n    903         f_times_t_high = torch.matmul(high, self.n_)\r\n    904                 # Equivalent of Eq.4 of the reference paper (SPEAKER RECOGNITION FROM RAW WAVEFORM WITH SINCNET).\r\n\r\nRuntimeError: Expected object of device type cuda but got device type cpu for argument #1 'self' in call to _th_mm\r\n```\r\nAny suggestions?\r\n","closed_by":{"login":"MittalShruti","id":5301961,"node_id":"MDQ6VXNlcjUzMDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5301961?v=4","gravatar_id":"","url":"https://api.github.com/users/MittalShruti","html_url":"https://github.com/MittalShruti","followers_url":"https://api.github.com/users/MittalShruti/followers","following_url":"https://api.github.com/users/MittalShruti/following{/other_user}","gists_url":"https://api.github.com/users/MittalShruti/gists{/gist_id}","starred_url":"https://api.github.com/users/MittalShruti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MittalShruti/subscriptions","organizations_url":"https://api.github.com/users/MittalShruti/orgs","repos_url":"https://api.github.com/users/MittalShruti/repos","events_url":"https://api.github.com/users/MittalShruti/events{/privacy}","received_events_url":"https://api.github.com/users/MittalShruti/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/santi-pdp/pase/issues/83/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/santi-pdp/pase/issues/83/timeline","performed_via_github_app":null,"state_reason":"completed"}