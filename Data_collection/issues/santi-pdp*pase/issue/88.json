{"url":"https://api.github.com/repos/santi-pdp/pase/issues/88","repository_url":"https://api.github.com/repos/santi-pdp/pase","labels_url":"https://api.github.com/repos/santi-pdp/pase/issues/88/labels{/name}","comments_url":"https://api.github.com/repos/santi-pdp/pase/issues/88/comments","events_url":"https://api.github.com/repos/santi-pdp/pase/issues/88/events","html_url":"https://github.com/santi-pdp/pase/issues/88","id":569487861,"node_id":"MDU6SXNzdWU1Njk0ODc4NjE=","number":88,"title":"load pretrained worker weights","user":{"login":"MittalShruti","id":5301961,"node_id":"MDQ6VXNlcjUzMDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5301961?v=4","gravatar_id":"","url":"https://api.github.com/users/MittalShruti","html_url":"https://github.com/MittalShruti","followers_url":"https://api.github.com/users/MittalShruti/followers","following_url":"https://api.github.com/users/MittalShruti/following{/other_user}","gists_url":"https://api.github.com/users/MittalShruti/gists{/gist_id}","starred_url":"https://api.github.com/users/MittalShruti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MittalShruti/subscriptions","organizations_url":"https://api.github.com/users/MittalShruti/orgs","repos_url":"https://api.github.com/users/MittalShruti/repos","events_url":"https://api.github.com/users/MittalShruti/events{/privacy}","received_events_url":"https://api.github.com/users/MittalShruti/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-02-23T12:29:37Z","updated_at":"2020-05-02T17:12:45Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi, \r\n\r\nI am trying to load the pretrained workers (from [#85](https://github.com/santi-pdp/pase/issues/85))\r\n\r\nModel that I am using:\r\n```\r\nfrom pase.models.pase import *\r\n\r\nps = pase(frontend=None,\r\n      frontend_cfg=frontend_cfg,\r\n      minions_cfg=minions_cfg,\r\n      cls_lst=cls_lst, regr_lst=regr_lst,\r\n      pretrained_ckpt=None,\r\n      name='Pase_base')\r\n```\r\nTo import worker weight (for 1 worker):\r\n\r\n```\r\nfor m in ps.classification_workers:\r\n  m.load_pretrained(ckpt_path='/workers/weights_M-mi-M-mi-721872.ckpt', load_last=True, verbose=True)\r\n  break\r\n```\r\n\r\nError I am getting: \r\n```\r\nCurrent Model keys:  5\r\nCurrent Pt keys:  4\r\nLoading matching keys:  ['minion.blocks.0.W.bias', 'minion.blocks.0.act.weight', 'minion.W.weight', 'minion.W.bias']\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-35-3cc20e1ab527> in <module>()\r\n      1 for m in ps.classification_workers:\r\n----> 2   m.load_pretrained(ckpt_path='/content/workers/weights_M-mi-M-mi-721872.ckpt', load_last=True, verbose=True)\r\n      3   break\r\n\r\n1 frames\r\n/content/pase/models/modules.py in load_pretrained_ckpt(self, ckpt_file, load_last, load_opt, verbose)\r\n    289             print('Loading matching keys: ', list(pt_dict.keys()))\r\n    290         if len(pt_dict.keys()) != len(model_dict.keys()):\r\n--> 291             raise ValueError('WARNING: LOADING DIFFERENT NUM OF KEYS')\r\n    292             print('WARNING: LOADING DIFFERENT NUM OF KEYS')\r\n    293         # overwrite entries in existing dict\r\n\r\nValueError: WARNING: LOADING DIFFERENT NUM OF KEYS\r\n```\r\n\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/santi-pdp/pase/issues/88/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/santi-pdp/pase/issues/88/timeline","performed_via_github_app":null,"state_reason":null}