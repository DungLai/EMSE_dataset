[{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/636582792","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/479#issuecomment-636582792","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/479","id":636582792,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjU4Mjc5Mg==","user":{"login":"oyxuan-11","id":26322278,"node_id":"MDQ6VXNlcjI2MzIyMjc4","avatar_url":"https://avatars.githubusercontent.com/u/26322278?v=4","gravatar_id":"","url":"https://api.github.com/users/oyxuan-11","html_url":"https://github.com/oyxuan-11","followers_url":"https://api.github.com/users/oyxuan-11/followers","following_url":"https://api.github.com/users/oyxuan-11/following{/other_user}","gists_url":"https://api.github.com/users/oyxuan-11/gists{/gist_id}","starred_url":"https://api.github.com/users/oyxuan-11/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oyxuan-11/subscriptions","organizations_url":"https://api.github.com/users/oyxuan-11/orgs","repos_url":"https://api.github.com/users/oyxuan-11/repos","events_url":"https://api.github.com/users/oyxuan-11/events{/privacy}","received_events_url":"https://api.github.com/users/oyxuan-11/received_events","type":"User","site_admin":false},"created_at":"2020-06-01T02:41:30Z","updated_at":"2020-06-01T02:41:30Z","author_association":"NONE","body":"给出几个建议\r\n1. 试着调小一点max_seq_len\r\n2. 请问显存大小是多少呢，如果不够的话可以放在AI Studio上运行，显存16G\r\n3. 试着跑一下ernie 自带的例程脚本，排查一下是机器问题还是代码问题","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/636582792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"oyxuan-11","id":26322278,"node_id":"MDQ6VXNlcjI2MzIyMjc4","avatar_url":"https://avatars.githubusercontent.com/u/26322278?v=4","gravatar_id":"","url":"https://api.github.com/users/oyxuan-11","html_url":"https://github.com/oyxuan-11","followers_url":"https://api.github.com/users/oyxuan-11/followers","following_url":"https://api.github.com/users/oyxuan-11/following{/other_user}","gists_url":"https://api.github.com/users/oyxuan-11/gists{/gist_id}","starred_url":"https://api.github.com/users/oyxuan-11/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oyxuan-11/subscriptions","organizations_url":"https://api.github.com/users/oyxuan-11/orgs","repos_url":"https://api.github.com/users/oyxuan-11/repos","events_url":"https://api.github.com/users/oyxuan-11/events{/privacy}","received_events_url":"https://api.github.com/users/oyxuan-11/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/636657650","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/479#issuecomment-636657650","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/479","id":636657650,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjY1NzY1MA==","user":{"login":"Firework471","id":30025892,"node_id":"MDQ6VXNlcjMwMDI1ODky","avatar_url":"https://avatars.githubusercontent.com/u/30025892?v=4","gravatar_id":"","url":"https://api.github.com/users/Firework471","html_url":"https://github.com/Firework471","followers_url":"https://api.github.com/users/Firework471/followers","following_url":"https://api.github.com/users/Firework471/following{/other_user}","gists_url":"https://api.github.com/users/Firework471/gists{/gist_id}","starred_url":"https://api.github.com/users/Firework471/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Firework471/subscriptions","organizations_url":"https://api.github.com/users/Firework471/orgs","repos_url":"https://api.github.com/users/Firework471/repos","events_url":"https://api.github.com/users/Firework471/events{/privacy}","received_events_url":"https://api.github.com/users/Firework471/received_events","type":"User","site_admin":false},"created_at":"2020-06-01T07:15:08Z","updated_at":"2020-06-01T07:15:08Z","author_association":"NONE","body":"> 给出几个建议\r\n> \r\n> 1. 试着调小一点max_seq_len\r\n> 2. 请问显存大小是多少呢，如果不够的话可以放在AI Studio上运行，显存16G\r\n> 3. 试着跑一下ernie 自带的例程脚本，排查一下是机器问题还是代码问题\r\n\r\n谢谢您的建议，我的显存是8G，目前来看不像是显存大小问题，因为当我不管是调小batch size还是max_seq_len的时候，都会出现这个错误，并且“Out of memory error on GPU 0. Cannot allocate 25.000244MB memory on GPU 0, available memory is only 2.349999MB.”这段话中的那两个数值会随着batch size和max_seq_len的减小而减小，但始终是Out of memory error。之前有相同问题的issue中提到可以通过设置FLAGS_fraction_of_gpu_memory_to_use等方法来解决，但是目前看来对于我的程序似乎是不起作用的。","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/636657650/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Firework471","id":30025892,"node_id":"MDQ6VXNlcjMwMDI1ODky","avatar_url":"https://avatars.githubusercontent.com/u/30025892?v=4","gravatar_id":"","url":"https://api.github.com/users/Firework471","html_url":"https://github.com/Firework471","followers_url":"https://api.github.com/users/Firework471/followers","following_url":"https://api.github.com/users/Firework471/following{/other_user}","gists_url":"https://api.github.com/users/Firework471/gists{/gist_id}","starred_url":"https://api.github.com/users/Firework471/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Firework471/subscriptions","organizations_url":"https://api.github.com/users/Firework471/orgs","repos_url":"https://api.github.com/users/Firework471/repos","events_url":"https://api.github.com/users/Firework471/events{/privacy}","received_events_url":"https://api.github.com/users/Firework471/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/636663955","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/479#issuecomment-636663955","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/479","id":636663955,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjY2Mzk1NQ==","user":{"login":"Firework471","id":30025892,"node_id":"MDQ6VXNlcjMwMDI1ODky","avatar_url":"https://avatars.githubusercontent.com/u/30025892?v=4","gravatar_id":"","url":"https://api.github.com/users/Firework471","html_url":"https://github.com/Firework471","followers_url":"https://api.github.com/users/Firework471/followers","following_url":"https://api.github.com/users/Firework471/following{/other_user}","gists_url":"https://api.github.com/users/Firework471/gists{/gist_id}","starred_url":"https://api.github.com/users/Firework471/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Firework471/subscriptions","organizations_url":"https://api.github.com/users/Firework471/orgs","repos_url":"https://api.github.com/users/Firework471/repos","events_url":"https://api.github.com/users/Firework471/events{/privacy}","received_events_url":"https://api.github.com/users/Firework471/received_events","type":"User","site_admin":false},"created_at":"2020-06-01T07:28:10Z","updated_at":"2020-06-01T07:28:10Z","author_association":"NONE","body":"> 给出几个建议\r\n> \r\n> 1. 试着调小一点max_seq_len\r\n> 2. 请问显存大小是多少呢，如果不够的话可以放在AI Studio上运行，显存16G\r\n> 3. 试着跑一下ernie 自带的例程脚本，排查一下是机器问题还是代码问题\r\n\r\n另外我直接跑https://aistudio.baidu.com/aistudio/projectdetail/515168这个连接中的教程代码也会出现同样的问题，请问这是因为我的机器不行吗？","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/636663955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Firework471","id":30025892,"node_id":"MDQ6VXNlcjMwMDI1ODky","avatar_url":"https://avatars.githubusercontent.com/u/30025892?v=4","gravatar_id":"","url":"https://api.github.com/users/Firework471","html_url":"https://github.com/Firework471","followers_url":"https://api.github.com/users/Firework471/followers","following_url":"https://api.github.com/users/Firework471/following{/other_user}","gists_url":"https://api.github.com/users/Firework471/gists{/gist_id}","starred_url":"https://api.github.com/users/Firework471/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Firework471/subscriptions","organizations_url":"https://api.github.com/users/Firework471/orgs","repos_url":"https://api.github.com/users/Firework471/repos","events_url":"https://api.github.com/users/Firework471/events{/privacy}","received_events_url":"https://api.github.com/users/Firework471/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/636696047","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/479#issuecomment-636696047","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/479","id":636696047,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjY5NjA0Nw==","user":{"login":"Meiyim","id":10281949,"node_id":"MDQ6VXNlcjEwMjgxOTQ5","avatar_url":"https://avatars.githubusercontent.com/u/10281949?v=4","gravatar_id":"","url":"https://api.github.com/users/Meiyim","html_url":"https://github.com/Meiyim","followers_url":"https://api.github.com/users/Meiyim/followers","following_url":"https://api.github.com/users/Meiyim/following{/other_user}","gists_url":"https://api.github.com/users/Meiyim/gists{/gist_id}","starred_url":"https://api.github.com/users/Meiyim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Meiyim/subscriptions","organizations_url":"https://api.github.com/users/Meiyim/orgs","repos_url":"https://api.github.com/users/Meiyim/repos","events_url":"https://api.github.com/users/Meiyim/events{/privacy}","received_events_url":"https://api.github.com/users/Meiyim/received_events","type":"User","site_admin":false},"created_at":"2020-06-01T08:30:00Z","updated_at":"2020-06-01T08:30:00Z","author_association":"COLLABORATOR","body":"8G显存应该足以运行大部分的demo；\r\n考虑同一时期有其他进程占用显卡；\r\n另外设置环境变量的时机，要放在`import paddle`之前才能管用；或者在启动脚本的时候加入`export FLAGS_fraction_of_gpu_memory_to_use=1.0`\r\n另外请用最新的paddle版本(1.8+)；\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/636696047/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Meiyim","id":10281949,"node_id":"MDQ6VXNlcjEwMjgxOTQ5","avatar_url":"https://avatars.githubusercontent.com/u/10281949?v=4","gravatar_id":"","url":"https://api.github.com/users/Meiyim","html_url":"https://github.com/Meiyim","followers_url":"https://api.github.com/users/Meiyim/followers","following_url":"https://api.github.com/users/Meiyim/following{/other_user}","gists_url":"https://api.github.com/users/Meiyim/gists{/gist_id}","starred_url":"https://api.github.com/users/Meiyim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Meiyim/subscriptions","organizations_url":"https://api.github.com/users/Meiyim/orgs","repos_url":"https://api.github.com/users/Meiyim/repos","events_url":"https://api.github.com/users/Meiyim/events{/privacy}","received_events_url":"https://api.github.com/users/Meiyim/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/636726658","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/479#issuecomment-636726658","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/479","id":636726658,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjcyNjY1OA==","user":{"login":"Firework471","id":30025892,"node_id":"MDQ6VXNlcjMwMDI1ODky","avatar_url":"https://avatars.githubusercontent.com/u/30025892?v=4","gravatar_id":"","url":"https://api.github.com/users/Firework471","html_url":"https://github.com/Firework471","followers_url":"https://api.github.com/users/Firework471/followers","following_url":"https://api.github.com/users/Firework471/following{/other_user}","gists_url":"https://api.github.com/users/Firework471/gists{/gist_id}","starred_url":"https://api.github.com/users/Firework471/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Firework471/subscriptions","organizations_url":"https://api.github.com/users/Firework471/orgs","repos_url":"https://api.github.com/users/Firework471/repos","events_url":"https://api.github.com/users/Firework471/events{/privacy}","received_events_url":"https://api.github.com/users/Firework471/received_events","type":"User","site_admin":false},"created_at":"2020-06-01T09:17:32Z","updated_at":"2020-06-01T09:17:32Z","author_association":"NONE","body":"> 8G显存应该足以运行大部分的demo；\r\n> 考虑同一时期有其他进程占用显卡；\r\n> 另外设置环境变量的时机，要放在`import paddle`之前才能管用；或者在启动脚本的时候加入`export FLAGS_fraction_of_gpu_memory_to_use=1.0`\r\n> 另外请用最新的paddle版本(1.8+)；\r\n\r\n您好，谢谢您的建议。\r\n我用的paddle版本是1.8.1\r\n也把环境变量设置放在了import paddle之前，但还是出现了同样的问题。以下是我的代码，基本上是按照demo写的，只进行了少量的修改，代码中的BATCH和\r\nMAX_SEQLEN我即使调成1和30仍然出现如下的报错信息：\r\n\r\n```\r\nOut of memory error on GPU 0. Cannot allocate 4.000244MB memory on GPU 0, available memory is only 3.349999MB.\r\n\r\nPlease check whether there is any other process using GPU 0.\r\n1. If yes, please stop them, or start PaddlePaddle on another GPU.\r\n2. If no, please decrease the batch size of your model. \r\n```\r\n\r\n这种情况下是只能换个机器试一试了吗？但是报错信息里面显示的“available memory is only 3.349999MB.”感觉显然是不现实的啊。\r\n```\r\n...\r\nimport os\r\nos.environ['FLAGS_fraction_of_gpu_memory_to_use'] = \"0.99\"\r\nos.environ[\"FLAGS_eager_delete_tensor_gb\"] = \"0\"\r\n...\r\nBATCH=32\r\nMAX_SEQLEN=100\r\nLR=3e-5\r\nEPOCH=10\r\n\r\nD.guard().__enter__() # 为了让Paddle进入动态图模式，需要添加这一行在最前面\r\n\r\nernie = ErnieModelForSequenceClassification.from_pretrained('ernie-1.0', num_labels=3)\r\noptimizer = F.optimizer.Adam(LR, parameter_list=ernie.parameters())\r\ntokenizer = ErnieTokenizer.from_pretrained('ernie-1.0')\r\n\r\ndef make_data(path):\r\n    data = []\r\n    for i, l in enumerate(open(path, encoding='UTF-8')):\r\n        if i == 0:\r\n            continue\r\n        l = l.strip().split('\\t')\r\n        text, label = l[3], int(l[1])\r\n        text_id, _ = tokenizer.encode(text)\r\n        text_id = text_id[:MAX_SEQLEN]\r\n        text_id = np.pad(text_id, [0, MAX_SEQLEN-len(text_id)], mode='constant') \r\n        label_id = np.array(label+1, dtype='int64')\r\n        data.append((text_id, label_id))\r\n    return data\r\n    \r\ntrain_data = ...\r\ntest_data = ...\r\n\r\ndef get_batch_data(data, i):\r\n    d = data[i*BATCH: (i + 1) * BATCH]\r\n    feature, label = zip(*d)\r\n    feature = np.stack(feature) \r\n    label = np.stack(list(label))\r\n    feature = D.to_variable(feature) \r\n    label = D.to_variable(label)\r\n    return feature, label\r\n\r\nfor i in range(EPOCH):\r\n\r\n    np.random.shuffle(train_data) # 每个epoch都shuffle数据以获得最佳训练效果；\r\n    #train\r\n    for j in range(len(train_data) // BATCH):\r\n        feature, label = get_batch_data(train_data, j)\r\n        loss, _ = ernie(feature, labels=label) # ernie模型的返回值包含(loss, logits)；\r\n        loss.backward()\r\n        optimizer.minimize(loss)\r\n        ernie.clear_gradients()\r\n        if j % 10 == 0:\r\n            print('train %d: loss %.5f' % (j, loss.numpy()))\r\n        # evaluate\r\n        if j % 100 == 0:\r\n            all_pred, all_label = [], []\r\n            with D.base._switch_tracer_mode_guard_(is_train=False):\r\n                ernie.eval() \r\n                for j in range(len(test_data) // BATCH):\r\n                    feature, label = get_batch_data(test_data, j)\r\n                    loss, logits = ernie(feature, labels=label)\r\n                    all_pred.extend(L.argmax(logits, -1).numpy())\r\n                    all_label.extend(label.numpy())\r\n                ernie.train()\r\n            f1 = f1_score(all_label, all_pred, average='macro')\r\n            acc = (np.array(all_label) == np.array(all_pred)).astype(np.float32).mean()\r\n            print('acc %.5f' % acc)\r\n```","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/636726658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Firework471","id":30025892,"node_id":"MDQ6VXNlcjMwMDI1ODky","avatar_url":"https://avatars.githubusercontent.com/u/30025892?v=4","gravatar_id":"","url":"https://api.github.com/users/Firework471","html_url":"https://github.com/Firework471","followers_url":"https://api.github.com/users/Firework471/followers","following_url":"https://api.github.com/users/Firework471/following{/other_user}","gists_url":"https://api.github.com/users/Firework471/gists{/gist_id}","starred_url":"https://api.github.com/users/Firework471/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Firework471/subscriptions","organizations_url":"https://api.github.com/users/Firework471/orgs","repos_url":"https://api.github.com/users/Firework471/repos","events_url":"https://api.github.com/users/Firework471/events{/privacy}","received_events_url":"https://api.github.com/users/Firework471/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/637281528","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/479#issuecomment-637281528","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/479","id":637281528,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNzI4MTUyOA==","user":{"login":"Meiyim","id":10281949,"node_id":"MDQ6VXNlcjEwMjgxOTQ5","avatar_url":"https://avatars.githubusercontent.com/u/10281949?v=4","gravatar_id":"","url":"https://api.github.com/users/Meiyim","html_url":"https://github.com/Meiyim","followers_url":"https://api.github.com/users/Meiyim/followers","following_url":"https://api.github.com/users/Meiyim/following{/other_user}","gists_url":"https://api.github.com/users/Meiyim/gists{/gist_id}","starred_url":"https://api.github.com/users/Meiyim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Meiyim/subscriptions","organizations_url":"https://api.github.com/users/Meiyim/orgs","repos_url":"https://api.github.com/users/Meiyim/repos","events_url":"https://api.github.com/users/Meiyim/events{/privacy}","received_events_url":"https://api.github.com/users/Meiyim/received_events","type":"User","site_admin":false},"created_at":"2020-06-02T05:17:29Z","updated_at":"2020-06-02T05:17:29Z","author_association":"COLLABORATOR","body":"> vailable memory is only 3.349999MB\r\n\r\n对于这个warning不用太在意，它只是说执行到这一时刻时只剩3.34M显存；\r\n\r\n从log里看你是在windows操作系统上运行的；这个代码库还没有在windows上测试过。\r\n方便提供一下你的运行环境帮助我们收集一下信息么；\r\n包括windows版本、cuda版本、显卡具体型号等。\r\n\r\n另外除了减小`BATCH`, `MAX_SEQLEN` 以外还有一种办法是修改ernie_config.json文件的`num_hidden_layers`(在预训练模型包里) 从而减少transfomer的层数。\r\n","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/637281528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Meiyim","id":10281949,"node_id":"MDQ6VXNlcjEwMjgxOTQ5","avatar_url":"https://avatars.githubusercontent.com/u/10281949?v=4","gravatar_id":"","url":"https://api.github.com/users/Meiyim","html_url":"https://github.com/Meiyim","followers_url":"https://api.github.com/users/Meiyim/followers","following_url":"https://api.github.com/users/Meiyim/following{/other_user}","gists_url":"https://api.github.com/users/Meiyim/gists{/gist_id}","starred_url":"https://api.github.com/users/Meiyim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Meiyim/subscriptions","organizations_url":"https://api.github.com/users/Meiyim/orgs","repos_url":"https://api.github.com/users/Meiyim/repos","events_url":"https://api.github.com/users/Meiyim/events{/privacy}","received_events_url":"https://api.github.com/users/Meiyim/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/637553014","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/479#issuecomment-637553014","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/479","id":637553014,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNzU1MzAxNA==","user":{"login":"Firework471","id":30025892,"node_id":"MDQ6VXNlcjMwMDI1ODky","avatar_url":"https://avatars.githubusercontent.com/u/30025892?v=4","gravatar_id":"","url":"https://api.github.com/users/Firework471","html_url":"https://github.com/Firework471","followers_url":"https://api.github.com/users/Firework471/followers","following_url":"https://api.github.com/users/Firework471/following{/other_user}","gists_url":"https://api.github.com/users/Firework471/gists{/gist_id}","starred_url":"https://api.github.com/users/Firework471/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Firework471/subscriptions","organizations_url":"https://api.github.com/users/Firework471/orgs","repos_url":"https://api.github.com/users/Firework471/repos","events_url":"https://api.github.com/users/Firework471/events{/privacy}","received_events_url":"https://api.github.com/users/Firework471/received_events","type":"User","site_admin":false},"created_at":"2020-06-02T13:44:36Z","updated_at":"2020-06-02T13:44:36Z","author_association":"NONE","body":"> > vailable memory is only 3.349999MB\r\n> \r\n> 对于这个warning不用太在意，它只是说执行到这一时刻时只剩3.34M显存；\r\n> \r\n> 从log里看你是在windows操作系统上运行的；这个代码库还没有在windows上测试过。\r\n> 方便提供一下你的运行环境帮助我们收集一下信息么；\r\n> 包括windows版本、cuda版本、显卡具体型号等。\r\n> \r\n> 另外除了减小`BATCH`, `MAX_SEQLEN` 以外还有一种办法是修改ernie_config.json文件的`num_hidden_layers`(在预训练模型包里) 从而减少transfomer的层数。\r\n\r\n你好，我是python3.7，win10， paddle1.8.1，cuda10，GTX 1660 Ti","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/637553014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Firework471","id":30025892,"node_id":"MDQ6VXNlcjMwMDI1ODky","avatar_url":"https://avatars.githubusercontent.com/u/30025892?v=4","gravatar_id":"","url":"https://api.github.com/users/Firework471","html_url":"https://github.com/Firework471","followers_url":"https://api.github.com/users/Firework471/followers","following_url":"https://api.github.com/users/Firework471/following{/other_user}","gists_url":"https://api.github.com/users/Firework471/gists{/gist_id}","starred_url":"https://api.github.com/users/Firework471/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Firework471/subscriptions","organizations_url":"https://api.github.com/users/Firework471/orgs","repos_url":"https://api.github.com/users/Firework471/repos","events_url":"https://api.github.com/users/Firework471/events{/privacy}","received_events_url":"https://api.github.com/users/Firework471/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/638665481","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/479#issuecomment-638665481","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/479","id":638665481,"node_id":"MDEyOklzc3VlQ29tbWVudDYzODY2NTQ4MQ==","user":{"login":"Firework471","id":30025892,"node_id":"MDQ6VXNlcjMwMDI1ODky","avatar_url":"https://avatars.githubusercontent.com/u/30025892?v=4","gravatar_id":"","url":"https://api.github.com/users/Firework471","html_url":"https://github.com/Firework471","followers_url":"https://api.github.com/users/Firework471/followers","following_url":"https://api.github.com/users/Firework471/following{/other_user}","gists_url":"https://api.github.com/users/Firework471/gists{/gist_id}","starred_url":"https://api.github.com/users/Firework471/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Firework471/subscriptions","organizations_url":"https://api.github.com/users/Firework471/orgs","repos_url":"https://api.github.com/users/Firework471/repos","events_url":"https://api.github.com/users/Firework471/events{/privacy}","received_events_url":"https://api.github.com/users/Firework471/received_events","type":"User","site_admin":false},"created_at":"2020-06-04T07:38:03Z","updated_at":"2020-06-04T07:38:03Z","author_association":"NONE","body":"我修改了ernie_config.json文件的num_hidden_layers，即便没有减小BATCH, MAX_SEQLEN也可以正常运行了，虽然我也不知道为什么，不过修改num_hidden_layers是可行的。","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/638665481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Firework471","id":30025892,"node_id":"MDQ6VXNlcjMwMDI1ODky","avatar_url":"https://avatars.githubusercontent.com/u/30025892?v=4","gravatar_id":"","url":"https://api.github.com/users/Firework471","html_url":"https://github.com/Firework471","followers_url":"https://api.github.com/users/Firework471/followers","following_url":"https://api.github.com/users/Firework471/following{/other_user}","gists_url":"https://api.github.com/users/Firework471/gists{/gist_id}","starred_url":"https://api.github.com/users/Firework471/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Firework471/subscriptions","organizations_url":"https://api.github.com/users/Firework471/orgs","repos_url":"https://api.github.com/users/Firework471/repos","events_url":"https://api.github.com/users/Firework471/events{/privacy}","received_events_url":"https://api.github.com/users/Firework471/received_events","type":"User","site_admin":false}},{"id":3405503375,"node_id":"MDExOkNsb3NlZEV2ZW50MzQwNTUwMzM3NQ==","url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/events/3405503375","actor":{"login":"Firework471","id":30025892,"node_id":"MDQ6VXNlcjMwMDI1ODky","avatar_url":"https://avatars.githubusercontent.com/u/30025892?v=4","gravatar_id":"","url":"https://api.github.com/users/Firework471","html_url":"https://github.com/Firework471","followers_url":"https://api.github.com/users/Firework471/followers","following_url":"https://api.github.com/users/Firework471/following{/other_user}","gists_url":"https://api.github.com/users/Firework471/gists{/gist_id}","starred_url":"https://api.github.com/users/Firework471/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Firework471/subscriptions","organizations_url":"https://api.github.com/users/Firework471/orgs","repos_url":"https://api.github.com/users/Firework471/repos","events_url":"https://api.github.com/users/Firework471/events{/privacy}","received_events_url":"https://api.github.com/users/Firework471/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-06-04T07:38:16Z","state_reason":null,"performed_via_github_app":null}]