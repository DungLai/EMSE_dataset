[{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/546180737","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/351#issuecomment-546180737","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/351","id":546180737,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NjE4MDczNw==","user":{"login":"dingsiyu","id":21340925,"node_id":"MDQ6VXNlcjIxMzQwOTI1","avatar_url":"https://avatars.githubusercontent.com/u/21340925?v=4","gravatar_id":"","url":"https://api.github.com/users/dingsiyu","html_url":"https://github.com/dingsiyu","followers_url":"https://api.github.com/users/dingsiyu/followers","following_url":"https://api.github.com/users/dingsiyu/following{/other_user}","gists_url":"https://api.github.com/users/dingsiyu/gists{/gist_id}","starred_url":"https://api.github.com/users/dingsiyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dingsiyu/subscriptions","organizations_url":"https://api.github.com/users/dingsiyu/orgs","repos_url":"https://api.github.com/users/dingsiyu/repos","events_url":"https://api.github.com/users/dingsiyu/events{/privacy}","received_events_url":"https://api.github.com/users/dingsiyu/received_events","type":"User","site_admin":false},"created_at":"2019-10-25T03:02:08Z","updated_at":"2019-10-25T03:02:08Z","author_association":"COLLABORATOR","body":"1、padding一般不会影响结果，input_mask会把padding的部分掩盖掉。\r\n2、批量预测的结果和单条数据预测 --- 我是不是可以理解为batch_size=1和batch_size>1时的结果差异比较大？\r\n3、有具体的log打印信息吗？或者能提供一个最小可复现单元吗","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/546180737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dingsiyu","id":21340925,"node_id":"MDQ6VXNlcjIxMzQwOTI1","avatar_url":"https://avatars.githubusercontent.com/u/21340925?v=4","gravatar_id":"","url":"https://api.github.com/users/dingsiyu","html_url":"https://github.com/dingsiyu","followers_url":"https://api.github.com/users/dingsiyu/followers","following_url":"https://api.github.com/users/dingsiyu/following{/other_user}","gists_url":"https://api.github.com/users/dingsiyu/gists{/gist_id}","starred_url":"https://api.github.com/users/dingsiyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dingsiyu/subscriptions","organizations_url":"https://api.github.com/users/dingsiyu/orgs","repos_url":"https://api.github.com/users/dingsiyu/repos","events_url":"https://api.github.com/users/dingsiyu/events{/privacy}","received_events_url":"https://api.github.com/users/dingsiyu/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/548652358","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/351#issuecomment-548652358","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/351","id":548652358,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODY1MjM1OA==","user":{"login":"semal","id":5009351,"node_id":"MDQ6VXNlcjUwMDkzNTE=","avatar_url":"https://avatars.githubusercontent.com/u/5009351?v=4","gravatar_id":"","url":"https://api.github.com/users/semal","html_url":"https://github.com/semal","followers_url":"https://api.github.com/users/semal/followers","following_url":"https://api.github.com/users/semal/following{/other_user}","gists_url":"https://api.github.com/users/semal/gists{/gist_id}","starred_url":"https://api.github.com/users/semal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/semal/subscriptions","organizations_url":"https://api.github.com/users/semal/orgs","repos_url":"https://api.github.com/users/semal/repos","events_url":"https://api.github.com/users/semal/events{/privacy}","received_events_url":"https://api.github.com/users/semal/received_events","type":"User","site_admin":false},"created_at":"2019-11-01T03:26:00Z","updated_at":"2019-11-01T03:26:00Z","author_association":"NONE","body":"> 1、padding一般不会影响结果，input_mask会把padding的部分掩盖掉。\r\n> 2、批量预测的结果和单条数据预测 --- 我是不是可以理解为batch_size=1和batch_size>1时的结果差异比较大？\r\n> 3、有具体的log打印信息吗？或者能提供一个最小可复现单元吗\r\n\r\n可以理解为2，预测时输入数据的长度是单条字符串的长度，批量时长度都会扩展到最长字符串的长度，ERNIE 默认的日志没有相关的输出，我可以提供一下接口返回的结果对比：\r\n![image](https://user-images.githubusercontent.com/5009351/68000230-383a0380-fc9a-11e9-8812-e52168583174.png)\r\n![image](https://user-images.githubusercontent.com/5009351/68000237-44be5c00-fc9a-11e9-8342-03119d0ebea4.png)\r\n这是一个分类任务模型推理的结果，可以看到 embedding 发生的微小的变化..","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/548652358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"semal","id":5009351,"node_id":"MDQ6VXNlcjUwMDkzNTE=","avatar_url":"https://avatars.githubusercontent.com/u/5009351?v=4","gravatar_id":"","url":"https://api.github.com/users/semal","html_url":"https://github.com/semal","followers_url":"https://api.github.com/users/semal/followers","following_url":"https://api.github.com/users/semal/following{/other_user}","gists_url":"https://api.github.com/users/semal/gists{/gist_id}","starred_url":"https://api.github.com/users/semal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/semal/subscriptions","organizations_url":"https://api.github.com/users/semal/orgs","repos_url":"https://api.github.com/users/semal/repos","events_url":"https://api.github.com/users/semal/events{/privacy}","received_events_url":"https://api.github.com/users/semal/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/548681257","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/351#issuecomment-548681257","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/351","id":548681257,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODY4MTI1Nw==","user":{"login":"Meiyim","id":10281949,"node_id":"MDQ6VXNlcjEwMjgxOTQ5","avatar_url":"https://avatars.githubusercontent.com/u/10281949?v=4","gravatar_id":"","url":"https://api.github.com/users/Meiyim","html_url":"https://github.com/Meiyim","followers_url":"https://api.github.com/users/Meiyim/followers","following_url":"https://api.github.com/users/Meiyim/following{/other_user}","gists_url":"https://api.github.com/users/Meiyim/gists{/gist_id}","starred_url":"https://api.github.com/users/Meiyim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Meiyim/subscriptions","organizations_url":"https://api.github.com/users/Meiyim/orgs","repos_url":"https://api.github.com/users/Meiyim/repos","events_url":"https://api.github.com/users/Meiyim/events{/privacy}","received_events_url":"https://api.github.com/users/Meiyim/received_events","type":"User","site_admin":false},"created_at":"2019-11-01T06:24:49Z","updated_at":"2019-11-01T06:24:49Z","author_association":"COLLABORATOR","body":"这可能是一个潜在的问题，请问是使用哪个工具预测的打分结果？\r\n是命名实体识别任务还是分类任务有此问题，或者说都有此问题？\r\n另外您使用的是哪一个版本的paddle？","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/548681257/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Meiyim","id":10281949,"node_id":"MDQ6VXNlcjEwMjgxOTQ5","avatar_url":"https://avatars.githubusercontent.com/u/10281949?v=4","gravatar_id":"","url":"https://api.github.com/users/Meiyim","html_url":"https://github.com/Meiyim","followers_url":"https://api.github.com/users/Meiyim/followers","following_url":"https://api.github.com/users/Meiyim/following{/other_user}","gists_url":"https://api.github.com/users/Meiyim/gists{/gist_id}","starred_url":"https://api.github.com/users/Meiyim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Meiyim/subscriptions","organizations_url":"https://api.github.com/users/Meiyim/orgs","repos_url":"https://api.github.com/users/Meiyim/repos","events_url":"https://api.github.com/users/Meiyim/events{/privacy}","received_events_url":"https://api.github.com/users/Meiyim/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/549203952","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/351#issuecomment-549203952","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/351","id":549203952,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTIwMzk1Mg==","user":{"login":"semal","id":5009351,"node_id":"MDQ6VXNlcjUwMDkzNTE=","avatar_url":"https://avatars.githubusercontent.com/u/5009351?v=4","gravatar_id":"","url":"https://api.github.com/users/semal","html_url":"https://github.com/semal","followers_url":"https://api.github.com/users/semal/followers","following_url":"https://api.github.com/users/semal/following{/other_user}","gists_url":"https://api.github.com/users/semal/gists{/gist_id}","starred_url":"https://api.github.com/users/semal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/semal/subscriptions","organizations_url":"https://api.github.com/users/semal/orgs","repos_url":"https://api.github.com/users/semal/repos","events_url":"https://api.github.com/users/semal/events{/privacy}","received_events_url":"https://api.github.com/users/semal/received_events","type":"User","site_admin":false},"created_at":"2019-11-04T01:52:07Z","updated_at":"2019-11-04T01:52:07Z","author_association":"NONE","body":"> 这可能是一个潜在的问题，请问是使用哪个工具预测的打分结果？\r\n> 是命名实体识别任务还是分类任务有此问题，或者说都有此问题？\r\n> 另外您使用的是哪一个版本的paddle？\r\n\r\n我使用的 load_inference_model 函数和 GPU executor。两个任务都有此问题，另外我使用的是 1.5.1 版本的 paddlepaddle。","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/549203952/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"semal","id":5009351,"node_id":"MDQ6VXNlcjUwMDkzNTE=","avatar_url":"https://avatars.githubusercontent.com/u/5009351?v=4","gravatar_id":"","url":"https://api.github.com/users/semal","html_url":"https://github.com/semal","followers_url":"https://api.github.com/users/semal/followers","following_url":"https://api.github.com/users/semal/following{/other_user}","gists_url":"https://api.github.com/users/semal/gists{/gist_id}","starred_url":"https://api.github.com/users/semal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/semal/subscriptions","organizations_url":"https://api.github.com/users/semal/orgs","repos_url":"https://api.github.com/users/semal/repos","events_url":"https://api.github.com/users/semal/events{/privacy}","received_events_url":"https://api.github.com/users/semal/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/549269625","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/351#issuecomment-549269625","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/351","id":549269625,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTI2OTYyNQ==","user":{"login":"Meiyim","id":10281949,"node_id":"MDQ6VXNlcjEwMjgxOTQ5","avatar_url":"https://avatars.githubusercontent.com/u/10281949?v=4","gravatar_id":"","url":"https://api.github.com/users/Meiyim","html_url":"https://github.com/Meiyim","followers_url":"https://api.github.com/users/Meiyim/followers","following_url":"https://api.github.com/users/Meiyim/following{/other_user}","gists_url":"https://api.github.com/users/Meiyim/gists{/gist_id}","starred_url":"https://api.github.com/users/Meiyim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Meiyim/subscriptions","organizations_url":"https://api.github.com/users/Meiyim/orgs","repos_url":"https://api.github.com/users/Meiyim/repos","events_url":"https://api.github.com/users/Meiyim/events{/privacy}","received_events_url":"https://api.github.com/users/Meiyim/received_events","type":"User","site_admin":false},"created_at":"2019-11-04T09:10:39Z","updated_at":"2019-11-04T09:10:39Z","author_association":"COLLABORATOR","body":"如果是自己调用的paddle API。可以再检查下：是否同一条输入每次预测都会有偏差；还是不同的padding方式导致预测结果有偏差。\r\n另外可以的话再贴一下复现代码。","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/549269625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Meiyim","id":10281949,"node_id":"MDQ6VXNlcjEwMjgxOTQ5","avatar_url":"https://avatars.githubusercontent.com/u/10281949?v=4","gravatar_id":"","url":"https://api.github.com/users/Meiyim","html_url":"https://github.com/Meiyim","followers_url":"https://api.github.com/users/Meiyim/followers","following_url":"https://api.github.com/users/Meiyim/following{/other_user}","gists_url":"https://api.github.com/users/Meiyim/gists{/gist_id}","starred_url":"https://api.github.com/users/Meiyim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Meiyim/subscriptions","organizations_url":"https://api.github.com/users/Meiyim/orgs","repos_url":"https://api.github.com/users/Meiyim/repos","events_url":"https://api.github.com/users/Meiyim/events{/privacy}","received_events_url":"https://api.github.com/users/Meiyim/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/549798383","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/351#issuecomment-549798383","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/351","id":549798383,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTc5ODM4Mw==","user":{"login":"semal","id":5009351,"node_id":"MDQ6VXNlcjUwMDkzNTE=","avatar_url":"https://avatars.githubusercontent.com/u/5009351?v=4","gravatar_id":"","url":"https://api.github.com/users/semal","html_url":"https://github.com/semal","followers_url":"https://api.github.com/users/semal/followers","following_url":"https://api.github.com/users/semal/following{/other_user}","gists_url":"https://api.github.com/users/semal/gists{/gist_id}","starred_url":"https://api.github.com/users/semal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/semal/subscriptions","organizations_url":"https://api.github.com/users/semal/orgs","repos_url":"https://api.github.com/users/semal/repos","events_url":"https://api.github.com/users/semal/events{/privacy}","received_events_url":"https://api.github.com/users/semal/received_events","type":"User","site_admin":false},"created_at":"2019-11-05T12:15:13Z","updated_at":"2019-11-05T12:15:13Z","author_association":"NONE","body":"> 如果是自己调用的paddle API。可以再检查下：是否同一条输入每次预测都会有偏差；还是不同的padding方式导致预测结果有偏差。\r\n> 另外可以的话再贴一下复现代码。\r\n\r\n同样的输入每一次预测都是相同的结果，只有批量和单条的区别。","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/549798383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"semal","id":5009351,"node_id":"MDQ6VXNlcjUwMDkzNTE=","avatar_url":"https://avatars.githubusercontent.com/u/5009351?v=4","gravatar_id":"","url":"https://api.github.com/users/semal","html_url":"https://github.com/semal","followers_url":"https://api.github.com/users/semal/followers","following_url":"https://api.github.com/users/semal/following{/other_user}","gists_url":"https://api.github.com/users/semal/gists{/gist_id}","starred_url":"https://api.github.com/users/semal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/semal/subscriptions","organizations_url":"https://api.github.com/users/semal/orgs","repos_url":"https://api.github.com/users/semal/repos","events_url":"https://api.github.com/users/semal/events{/privacy}","received_events_url":"https://api.github.com/users/semal/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/552295666","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/351#issuecomment-552295666","issue_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/351","id":552295666,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjI5NTY2Ng==","user":{"login":"semal","id":5009351,"node_id":"MDQ6VXNlcjUwMDkzNTE=","avatar_url":"https://avatars.githubusercontent.com/u/5009351?v=4","gravatar_id":"","url":"https://api.github.com/users/semal","html_url":"https://github.com/semal","followers_url":"https://api.github.com/users/semal/followers","following_url":"https://api.github.com/users/semal/following{/other_user}","gists_url":"https://api.github.com/users/semal/gists{/gist_id}","starred_url":"https://api.github.com/users/semal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/semal/subscriptions","organizations_url":"https://api.github.com/users/semal/orgs","repos_url":"https://api.github.com/users/semal/repos","events_url":"https://api.github.com/users/semal/events{/privacy}","received_events_url":"https://api.github.com/users/semal/received_events","type":"User","site_admin":false},"created_at":"2019-11-11T05:11:08Z","updated_at":"2019-11-11T05:11:08Z","author_association":"NONE","body":"> 如果是自己调用的paddle API。可以再检查下：是否同一条输入每次预测都会有偏差；还是不同的padding方式导致预测结果有偏差。\r\n> 另外可以的话再贴一下复现代码。\r\n\r\n找到原因了，原来是 input_mask 生成的代码有问题..","reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/comments/552295666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"semal","id":5009351,"node_id":"MDQ6VXNlcjUwMDkzNTE=","avatar_url":"https://avatars.githubusercontent.com/u/5009351?v=4","gravatar_id":"","url":"https://api.github.com/users/semal","html_url":"https://github.com/semal","followers_url":"https://api.github.com/users/semal/followers","following_url":"https://api.github.com/users/semal/following{/other_user}","gists_url":"https://api.github.com/users/semal/gists{/gist_id}","starred_url":"https://api.github.com/users/semal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/semal/subscriptions","organizations_url":"https://api.github.com/users/semal/orgs","repos_url":"https://api.github.com/users/semal/repos","events_url":"https://api.github.com/users/semal/events{/privacy}","received_events_url":"https://api.github.com/users/semal/received_events","type":"User","site_admin":false}},{"id":2787550349,"node_id":"MDExOkNsb3NlZEV2ZW50Mjc4NzU1MDM0OQ==","url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/events/2787550349","actor":{"login":"semal","id":5009351,"node_id":"MDQ6VXNlcjUwMDkzNTE=","avatar_url":"https://avatars.githubusercontent.com/u/5009351?v=4","gravatar_id":"","url":"https://api.github.com/users/semal","html_url":"https://github.com/semal","followers_url":"https://api.github.com/users/semal/followers","following_url":"https://api.github.com/users/semal/following{/other_user}","gists_url":"https://api.github.com/users/semal/gists{/gist_id}","starred_url":"https://api.github.com/users/semal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/semal/subscriptions","organizations_url":"https://api.github.com/users/semal/orgs","repos_url":"https://api.github.com/users/semal/repos","events_url":"https://api.github.com/users/semal/events{/privacy}","received_events_url":"https://api.github.com/users/semal/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-11-11T11:10:25Z","state_reason":null,"performed_via_github_app":null}]