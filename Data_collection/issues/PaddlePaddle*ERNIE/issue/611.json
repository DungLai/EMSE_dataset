{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/611","repository_url":"https://api.github.com/repos/PaddlePaddle/ERNIE","labels_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/611/labels{/name}","comments_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/611/comments","events_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/611/events","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/611","id":781911039,"node_id":"MDU6SXNzdWU3ODE5MTEwMzk=","number":611,"title":"ernie 1.0 使用InferenceClient请求推理服务，服务出core报错","user":{"login":"lonelydancer","id":548443,"node_id":"MDQ6VXNlcjU0ODQ0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/548443?v=4","gravatar_id":"","url":"https://api.github.com/users/lonelydancer","html_url":"https://github.com/lonelydancer","followers_url":"https://api.github.com/users/lonelydancer/followers","following_url":"https://api.github.com/users/lonelydancer/following{/other_user}","gists_url":"https://api.github.com/users/lonelydancer/gists{/gist_id}","starred_url":"https://api.github.com/users/lonelydancer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lonelydancer/subscriptions","organizations_url":"https://api.github.com/users/lonelydancer/orgs","repos_url":"https://api.github.com/users/lonelydancer/repos","events_url":"https://api.github.com/users/lonelydancer/events{/privacy}","received_events_url":"https://api.github.com/users/lonelydancer/received_events","type":"User","site_admin":false},"labels":[{"id":1256169225,"node_id":"MDU6TGFiZWwxMjU2MTY5MjI1","url":"https://api.github.com/repos/PaddlePaddle/ERNIE/labels/wontfix","name":"wontfix","color":"ffffff","default":true,"description":"This will not be worked on"},{"id":2076974904,"node_id":"MDU6TGFiZWwyMDc2OTc0OTA0","url":"https://api.github.com/repos/PaddlePaddle/ERNIE/labels/Paddle-Issue","name":"Paddle-Issue","color":"7ce28f","default":false,"description":"可以向PaddlePaddle方面提出此问题以获得更准确回复"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2021-01-08T07:23:12Z","updated_at":"2021-03-21T16:06:35Z","closed_at":"2021-03-21T16:06:35Z","author_association":"NONE","active_lock_reason":null,"body":"你好，\r\n我finetune了 zh_task/ernie_base/run_ChnSentiCorp.sh 任务，用infer_classiyer.py生成model后，启动服务。\r\n用inferernce_client 请求服务，出core\r\ncore信息：\r\nW0108 15:06:05.752475 12697 naive_executor.cc:50] Please re-compile the inference library by setting the cmake flag ON_INFER=ON if you are running Paddle Inference\r\nW0108 15:06:05.754022 12697 init.cc:209] Warning: PaddlePaddle catches a failure signal, it may not work properly\r\nW0108 15:06:05.754050 12697 init.cc:211] You could check whether you killed PaddlePaddle thread/process accidentally or report the case to PaddlePaddle\r\nW0108 15:06:05.754053 12697 init.cc:214] The detail failure signal is:\r\n\r\nW0108 15:06:05.754058 12697 init.cc:217] *** Aborted at 1610089565 (unix time) try \"date -d @1610089565\" if you are using GNU date ***\r\nW0108 15:06:05.754962 12697 init.cc:217] PC: @                0x0 (unknown)\r\nW0108 15:06:05.765040 12697 init.cc:217] *** SIGSEGV (@0x50) received by PID 12697 (TID 0x7fc77e498740) from PID 80; stack trace: ***\r\nW0108 15:06:05.767349 12697 init.cc:217]     @     0x7fc77ded2040 (unknown)\r\nW0108 15:06:05.770890 12697 init.cc:217]     @     0x7fc77e290c98 (unknown)\r\nW0108 15:06:05.773365 12697 init.cc:217]     @     0x7fc77e29927d (unknown)\r\nW0108 15:06:05.774482 12697 init.cc:217]     @     0x7fc77dffa1ef _dl_catch_exception\r\nW0108 15:06:05.775518 12697 init.cc:217]     @     0x7fc77e29898a (unknown)\r\nW0108 15:06:05.776628 12697 init.cc:217]     @     0x7fc77dff92bd (unknown)\r\nW0108 15:06:05.777694 12697 init.cc:217]     @     0x7fc77dffa1ef _dl_catch_exception\r\nW0108 15:06:05.778731 12697 init.cc:217]     @     0x7fc77dffa27f _dl_catch_error\r\nW0108 15:06:05.779821 12697 init.cc:217]     @     0x7fc77dff93e9 __libc_dlopen_mode\r\nW0108 15:06:05.780933 12697 init.cc:217]     @     0x7fc77dfc3f05 (unknown)\r\nW0108 15:06:05.781955 12697 init.cc:217]     @     0x7fc77dc83907 __pthread_once_slow\r\nW0108 15:06:05.783041 12697 init.cc:217]     @     0x7fc77dfc3fdf backtrace\r\nW0108 15:06:05.789768 12697 init.cc:217]     @     0x7fc681d83815 paddle::platform::GetTraceBackString<>()\r\nW0108 15:06:05.796608 12697 init.cc:217]     @     0x7fc681d83ba1 paddle::platform::EnforceNotMet::EnforceNotMet()\r\nW0108 15:06:05.800225 12697 init.cc:217]     @     0x7fc683a6a7ea paddle::operators::MultiHeadMatMulOp::InferShape()\r\nW0108 15:06:05.802749 12697 init.cc:217]     @     0x7fc684a54c06 paddle::framework::OperatorWithKernel::RunImpl()\r\nW0108 15:06:05.806273 12697 init.cc:217]     @     0x7fc684a55193 paddle::framework::OperatorWithKernel::RunImpl()\r\nW0108 15:06:05.807960 12697 init.cc:217]     @     0x7fc684a4e3d0 paddle::framework::OperatorBase::Run()\r\nW0108 15:06:05.814075 12697 init.cc:217]     @     0x7fc6849f1cc3 paddle::framework::NaiveExecutor::Run()\r\nW0108 15:06:05.820092 12697 init.cc:217]     @     0x7fc68218d66c paddle::AnalysisPredictor::Run()\r\nW0108 15:06:05.822775 12697 init.cc:217]     @     0x7fc682062326 _ZZN8pybind1112cpp_function10initializeIZN6paddle6pybind12_GLOBAL__N_121BindAnalysisPredictorEPNS_6moduleEEUlRNS2_17AnalysisPredictorERKSt6vectorINS2_12PaddleTensorESaISA_EEE_SC_IS8_SE_EINS_4nameENS_9is_methodENS_7siblingEEEEvOT_PFT0_DpT1_EDpRKT2_ENUlRNS_6detail13function_callEE1_4_FUNESW_\r\nW0108 15:06:05.823576 12697 init.cc:217]     @     0x7fc681dbe221 pybind11::cpp_function::dispatcher()\r\nW0108 15:06:05.823698 12697 init.cc:217]     @     0x559f5899dac8 PyEval_EvalFrameEx\r\nW0108 15:06:05.823783 12697 init.cc:217]     @     0x559f58993e0a PyEval_EvalCodeEx\r\nW0108 15:06:05.823876 12697 init.cc:217]     @     0x559f589af94c (unknown)\r\nW0108 15:06:05.823938 12697 init.cc:217]     @     0x559f5897f70e PyObject_Call\r\nW0108 15:06:05.824028 12697 init.cc:217]     @     0x559f58998a29 PyEval_EvalFrameEx\r\nW0108 15:06:05.824107 12697 init.cc:217]     @     0x559f58993e0a PyEval_EvalCodeEx\r\nW0108 15:06:05.824198 12697 init.cc:217]     @     0x559f589af6a9 (unknown)\r\nW0108 15:06:05.824290 12697 init.cc:217]     @     0x559f589c7e1e (unknown)\r\nW0108 15:06:05.824349 12697 init.cc:217]     @     0x559f5897f70e PyObject_Call\r\nW0108 15:06:05.824440 12697 init.cc:217]     @     0x559f58a2480b (unknown)\r\n\r\n生成model命令：\r\npython -u infer_classifyer.py \\\r\n    --ernie_config_path ${MODEL_PATH}/ernie_config.json \\\r\n    --init_checkpoint \"../checkpoints/step_1000\" \\\r\n    --save_inference_model_path ./saved_model \\\r\n    --predict_set  ${TASK_DATA_PATH}/chnsenticorp/test.tsv \\\r\n    --vocab_path ${MODEL_PATH}/vocab.txt \\\r\n    --num_labels 2\r\n\r\n服务端：\r\n环境python2.7、paddle1.7.2\r\n启动服务命令：python -m propeller.tools.start_server -m ernie/saved_model//step_1000_inference_model -p 9999\r\n\r\n客户端\r\npython3.7， paddle1.8.1\r\n\r\n","closed_by":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/611/timeline","performed_via_github_app":null,"state_reason":"completed"}