{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/222","repository_url":"https://api.github.com/repos/PaddlePaddle/ERNIE","labels_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/222/labels{/name}","comments_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/222/comments","events_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/222/events","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/222","id":472065161,"node_id":"MDU6SXNzdWU0NzIwNjUxNjE=","number":222,"title":"BERT、ERNIE、TextCNN做文本分类任务性能对比","user":{"login":"Biaocsu","id":45280752,"node_id":"MDQ6VXNlcjQ1MjgwNzUy","avatar_url":"https://avatars.githubusercontent.com/u/45280752?v=4","gravatar_id":"","url":"https://api.github.com/users/Biaocsu","html_url":"https://github.com/Biaocsu","followers_url":"https://api.github.com/users/Biaocsu/followers","following_url":"https://api.github.com/users/Biaocsu/following{/other_user}","gists_url":"https://api.github.com/users/Biaocsu/gists{/gist_id}","starred_url":"https://api.github.com/users/Biaocsu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Biaocsu/subscriptions","organizations_url":"https://api.github.com/users/Biaocsu/orgs","repos_url":"https://api.github.com/users/Biaocsu/repos","events_url":"https://api.github.com/users/Biaocsu/events{/privacy}","received_events_url":"https://api.github.com/users/Biaocsu/received_events","type":"User","site_admin":false},"labels":[{"id":1256169225,"node_id":"MDU6TGFiZWwxMjU2MTY5MjI1","url":"https://api.github.com/repos/PaddlePaddle/ERNIE/labels/wontfix","name":"wontfix","color":"ffffff","default":true,"description":"This will not be worked on"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":17,"created_at":"2019-07-24T03:48:11Z","updated_at":"2020-05-28T09:52:45Z","closed_at":"2020-05-28T09:52:45Z","author_association":"NONE","active_lock_reason":null,"body":"以下模型的推理速度、内存占用等均在‘CPU’上考察\r\n【TextCNN、pytorch_bert、tensorflow_bert、ERNIE文本分类任务性能对比】\r\n【以下性能考察结果均经过多次测试】\r\n\r\n推理时的数据最长文本有75万中文字符，利用100个文本进行测试。\r\n从内存占用及推理速度指标来看，四种算法中，TextCNN均是最优的。\r\n由于bert及ERNIE并未经过多次fine-tune就已经达到较好泛化效果，因此可以认为其泛化能力会相对textcnn更好些。\r\npytorch_bert、tensorflow_bert、ERNIE三者相比较，在内存占用方面相差不是很大；但ERNIE在推理速度方面稍差（**这个蛮重要**），不过ERNIE版本更新很快、另可直接联系其工作团队解答疑问\r\n**长文本预测时**，尝试了将文本截断（例如：文本长度100000， 则分n=100000//510次）预测，因为长文本前510长度有可能没有重要信息。（例如：【‘娱乐’， ‘赌博’】二分类，截断n次，只要有一次预测为‘赌博’那文本就是赌博类别）\r\n\r\n【TextCNN】\r\n推理时模型占用内存大约：546M（稳定）\r\n推理时预测一个文件（完整长文本）平均所需时间：0.095s\r\n多次训练，保存泛化效果最好模型，其在测试集上准确率：95.312%\r\n\r\n【Pytorch_bert】\r\n推理时模型占用内存：942M（峰值）\r\n推理时预测一个文本（前128+后382字符）平均所需时间：1.149S\r\n推理时预测一个文本（前510   *  1长度+尾部数据；相当于预测截断成n个510文本）平均所需时间：2.658s\r\n推理时预测一个文本（前510   *  2长度+尾部数据）平均所需时间：3.529s\r\n推理时预测一个文本（前510   *  5长度+尾部数据）平均所需时间：5.233s\r\n推理时预测一个文本（完整长文本）平均所需时间：38.77s\r\nfine-tune模型，其在测试集上准确率：98.82%\r\n\t\r\n【tensorflow_bert】\r\n推理时模型占用内存：988M（峰值）\r\n推理时预测一个文本（前128+后382字符）平均所需时间：1.332S\r\n推理时预测一个文本（前510  *  1长度+尾部数据）平均所需时间：1.485s\r\n推理时预测一个文本（前510  *  2长度+尾部数据）平均所需时间：3.570s\r\n推理时预测一个文本（前510  *  5长度+尾部数据）平均所需时间：7.033s\r\n推理时预测一个文本（完整长文本）平均所需时间：56.18s\r\nfine-tune模型(调节的参数与pytorch_bert一致)，其在测试集上准确率：98.90%\r\n\r\n【ERNIE】\r\n推理时模型占用内存：1072M（峰值）\r\n推理时预测一个文本（前128+后382字符）平均所需时间：2.227s\r\n推理时预测一个文本（前510  *  1长度+尾部数据）平均所需时间：3.934s\r\n推理时预测一个文本（前510  *  2长度+尾部数据）平均所需时间：6.001s\r\n推理时预测一个文本（前510  *  5长度+尾部数据）平均所需时间：9.835s\r\n推理时预测一个文本（完整长文本）平均所需时间：\r\nfine-tune模型，其在测试集上准确率：98.74%\r\n\r\n\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t","closed_by":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/222/timeline","performed_via_github_app":null,"state_reason":"completed"}