{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/552","repository_url":"https://api.github.com/repos/PaddlePaddle/ERNIE","labels_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/552/labels{/name}","comments_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/552/comments","events_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/552/events","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/552","id":689476697,"node_id":"MDU6SXNzdWU2ODk0NzY2OTc=","number":552,"title":"ERNIE is not using GPU?","user":{"login":"monk1337","id":17107749,"node_id":"MDQ6VXNlcjE3MTA3NzQ5","avatar_url":"https://avatars.githubusercontent.com/u/17107749?v=4","gravatar_id":"","url":"https://api.github.com/users/monk1337","html_url":"https://github.com/monk1337","followers_url":"https://api.github.com/users/monk1337/followers","following_url":"https://api.github.com/users/monk1337/following{/other_user}","gists_url":"https://api.github.com/users/monk1337/gists{/gist_id}","starred_url":"https://api.github.com/users/monk1337/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/monk1337/subscriptions","organizations_url":"https://api.github.com/users/monk1337/orgs","repos_url":"https://api.github.com/users/monk1337/repos","events_url":"https://api.github.com/users/monk1337/events{/privacy}","received_events_url":"https://api.github.com/users/monk1337/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-08-31T20:14:51Z","updated_at":"2020-09-01T22:40:03Z","closed_at":"2020-09-01T22:40:02Z","author_association":"NONE","active_lock_reason":null,"body":"I am using this code to extract the embeddings for my dataset. It's quite slow and running on CPU only. \r\nI am able to use TensorFlow and PyTorch with GPU. How I can enable GPU for ERNIE?\r\n\r\n```\r\nimport numpy as np\r\nimport paddle.fluid.dygraph as D\r\nfrom ernie.tokenizing_ernie import ErnieTokenizer\r\nfrom ernie.modeling_ernie import ErnieModel\r\n\r\nD.guard().__enter__() # activate paddle `dygrpah` mode\r\n\r\nmodel = ErnieModel.from_pretrained('ernie-1.0')    # Try to get pretrained model from server, make sure you have network connection\r\nmodel.eval()\r\ntokenizer = ErnieTokenizer.from_pretrained('ernie-1.0')\r\n\r\nids, _ = tokenizer.encode('hello world')\r\nids = D.to_variable(np.expand_dims(ids, 0))  # insert extra `batch` dimension\r\npooled, encoded = model(ids)                 # eager execution\r\nprint(pooled.numpy())                        # convert  results to numpy\r\n```\r\n\r\nTo verify the gpu I ran this script :\r\n\r\n`python3 -c 'import paddle.fluid as f;f.install_check.run_check()'`\r\n\r\nOutput is\r\n\r\n```\r\nRunning Verify Fluid Program ... \r\nYour Paddle Fluid works well on SINGLE GPU or CPU.\r\nW0831 20:17:07.630717 23699 build_strategy.cc:170] fusion_group is not enabled for Windows/MacOS now, and only effective when running with CUDA GPU.\r\nW0831 20:17:07.653642 23699 fuse_all_reduce_op_pass.cc:74] Find all_reduce operators: 2. To make the speed faster, some all_reduce ops are fused during training, af\r\nter fusion, the number of all_reduce ops is 1.\r\nYour Paddle Fluid works well on MUTIPLE GPU or CPU.\r\nYour Paddle Fluid is installed successfully! Let's start deep Learning with Paddle Fluid now\r\n```","closed_by":{"login":"monk1337","id":17107749,"node_id":"MDQ6VXNlcjE3MTA3NzQ5","avatar_url":"https://avatars.githubusercontent.com/u/17107749?v=4","gravatar_id":"","url":"https://api.github.com/users/monk1337","html_url":"https://github.com/monk1337","followers_url":"https://api.github.com/users/monk1337/followers","following_url":"https://api.github.com/users/monk1337/following{/other_user}","gists_url":"https://api.github.com/users/monk1337/gists{/gist_id}","starred_url":"https://api.github.com/users/monk1337/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/monk1337/subscriptions","organizations_url":"https://api.github.com/users/monk1337/orgs","repos_url":"https://api.github.com/users/monk1337/repos","events_url":"https://api.github.com/users/monk1337/events{/privacy}","received_events_url":"https://api.github.com/users/monk1337/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/552/timeline","performed_via_github_app":null,"state_reason":"completed"}