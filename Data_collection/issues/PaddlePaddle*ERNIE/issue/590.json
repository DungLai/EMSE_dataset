{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/590","repository_url":"https://api.github.com/repos/PaddlePaddle/ERNIE","labels_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/590/labels{/name}","comments_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/590/comments","events_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/590/events","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/590","id":739600836,"node_id":"MDU6SXNzdWU3Mzk2MDA4MzY=","number":590,"title":"Single GPU with error no nranks","user":{"login":"tuority","id":74225979,"node_id":"MDQ6VXNlcjc0MjI1OTc5","avatar_url":"https://avatars.githubusercontent.com/u/74225979?v=4","gravatar_id":"","url":"https://api.github.com/users/tuority","html_url":"https://github.com/tuority","followers_url":"https://api.github.com/users/tuority/followers","following_url":"https://api.github.com/users/tuority/following{/other_user}","gists_url":"https://api.github.com/users/tuority/gists{/gist_id}","starred_url":"https://api.github.com/users/tuority/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tuority/subscriptions","organizations_url":"https://api.github.com/users/tuority/orgs","repos_url":"https://api.github.com/users/tuority/repos","events_url":"https://api.github.com/users/tuority/events{/privacy}","received_events_url":"https://api.github.com/users/tuority/received_events","type":"User","site_admin":false},"labels":[{"id":1256169225,"node_id":"MDU6TGFiZWwxMjU2MTY5MjI1","url":"https://api.github.com/repos/PaddlePaddle/ERNIE/labels/wontfix","name":"wontfix","color":"ffffff","default":true,"description":"This will not be worked on"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2020-11-10T05:53:10Z","updated_at":"2021-01-31T06:34:14Z","closed_at":"2021-01-31T06:34:14Z","author_association":"NONE","active_lock_reason":null,"body":"While retraining i met this issues:\r\n**Command:**\r\n!python3 -m paddle.distributed.launch \\\r\n--log_dir ./log  \\\r\n-- ./ERNIE/demo/seq2seq/finetune_seq2seq_dygraph.py \\\r\n--data_dir ./cnndm/cnndm \\\r\n--save_dir ./model \\\r\n--noise_prob 0.7 \\\r\n--label_smooth 0.1 \\\r\n--predict_output_dir ./pred \\\r\n--max_steps $((287113*30/64)) \\\r\n--from_pretrained ./ernie \r\n\r\n**Error:**\r\nINFO 2020-11-10 03:51:16,368 launch.py:213] get cluster from args:job_server:None pods:['rank:0 id:None addr:127.0.0.1 port:None visible_gpu:[] trainers:[\"gpu:[\\'0\\'] endpoint:127.0.0.1:51215 rank:0\"]'] job_stage_flag:None hdfs:None\r\nINFO 2020-11-10 03:51:16,368 utils.py:372] start trainer proc:['/usr/bin/python3', '-u', './ERNIE/demo/seq2seq/finetune_seq2seq_dygraph.py', '--data_dir', './cnndm/cnndm', '--save_dir', './model', '--noise_prob', '0.7', '--label_smooth', '0.1', '--predict_output_dir', './pred', '--max_steps', '134584', '--from_pretrained', './ernie'] env:{'FLAGS_selected_gpus': '0', 'PADDLE_TRAINER_ID': '0', 'PADDLE_CURRENT_ENDPOINT': '127.0.0.1:51215', 'PADDLE_TRAINERS_NUM': '1', 'PADDLE_TRAINER_ENDPOINTS': '127.0.0.1:51215'}\r\nINFO 2020-11-10 03:51:37,404 utils.py:274] terminate all the procs\r\nERROR 2020-11-10 03:51:37,404 utils.py:418] ABORT!!! Out of all 1 trainers, the trainer process with rank=[0] was aborted. Please check its log.\r\nINFO 2020-11-10 03:51:40,407 utils.py:274] terminate all the procs\r\n\r\n**Log file:**\r\nTraceback (most recent call last):\r\n  File \"./ERNIE/demo/seq2seq/finetune_seq2seq_dygraph.py\", line 319, in <module>\r\n    seq2seq(ernie, tokenizer, args)\r\n  File \"./ERNIE/demo/seq2seq/finetune_seq2seq_dygraph.py\", line 254, in seq2seq\r\n    scaled_loss = model.scale_loss(loss)\r\n  File \"/usr/local/lib/python3.6/dist-packages/paddle/fluid/dygraph/parallel.py\", line 333, in scale_loss\r\n    if not self._is_data_parallel_mode():\r\n  File \"/usr/local/lib/python3.6/dist-packages/paddle/fluid/dygraph/parallel.py\", line 457, in _is_data_parallel_mode\r\n    return self._strategy.nranks > 1\r\nAttributeError: 'NoneType' object has no attribute 'nranks'","closed_by":{"login":"stale[bot]","id":26384082,"node_id":"MDM6Qm90MjYzODQwODI=","avatar_url":"https://avatars.githubusercontent.com/in/1724?v=4","gravatar_id":"","url":"https://api.github.com/users/stale%5Bbot%5D","html_url":"https://github.com/apps/stale","followers_url":"https://api.github.com/users/stale%5Bbot%5D/followers","following_url":"https://api.github.com/users/stale%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stale%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/stale%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/stale%5Bbot%5D/repos","events_url":"https://api.github.com/users/stale%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/stale%5Bbot%5D/received_events","type":"Bot","site_admin":false},"reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/590/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/590/timeline","performed_via_github_app":null,"state_reason":"completed"}