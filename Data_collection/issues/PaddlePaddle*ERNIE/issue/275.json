{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/275","repository_url":"https://api.github.com/repos/PaddlePaddle/ERNIE","labels_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/275/labels{/name}","comments_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/275/comments","events_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/275/events","html_url":"https://github.com/PaddlePaddle/ERNIE/issues/275","id":479451479,"node_id":"MDU6SXNzdWU0Nzk0NTE0Nzk=","number":275,"title":"LARK/BERT finetune 阅读理解任务，多卡预测发现出现数据丢失","user":{"login":"Steffy-zxf","id":48793257,"node_id":"MDQ6VXNlcjQ4NzkzMjU3","avatar_url":"https://avatars.githubusercontent.com/u/48793257?v=4","gravatar_id":"","url":"https://api.github.com/users/Steffy-zxf","html_url":"https://github.com/Steffy-zxf","followers_url":"https://api.github.com/users/Steffy-zxf/followers","following_url":"https://api.github.com/users/Steffy-zxf/following{/other_user}","gists_url":"https://api.github.com/users/Steffy-zxf/gists{/gist_id}","starred_url":"https://api.github.com/users/Steffy-zxf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Steffy-zxf/subscriptions","organizations_url":"https://api.github.com/users/Steffy-zxf/orgs","repos_url":"https://api.github.com/users/Steffy-zxf/repos","events_url":"https://api.github.com/users/Steffy-zxf/events{/privacy}","received_events_url":"https://api.github.com/users/Steffy-zxf/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"zhanghan1992","id":40751364,"node_id":"MDQ6VXNlcjQwNzUxMzY0","avatar_url":"https://avatars.githubusercontent.com/u/40751364?v=4","gravatar_id":"","url":"https://api.github.com/users/zhanghan1992","html_url":"https://github.com/zhanghan1992","followers_url":"https://api.github.com/users/zhanghan1992/followers","following_url":"https://api.github.com/users/zhanghan1992/following{/other_user}","gists_url":"https://api.github.com/users/zhanghan1992/gists{/gist_id}","starred_url":"https://api.github.com/users/zhanghan1992/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhanghan1992/subscriptions","organizations_url":"https://api.github.com/users/zhanghan1992/orgs","repos_url":"https://api.github.com/users/zhanghan1992/repos","events_url":"https://api.github.com/users/zhanghan1992/events{/privacy}","received_events_url":"https://api.github.com/users/zhanghan1992/received_events","type":"User","site_admin":false},"assignees":[{"login":"zhanghan1992","id":40751364,"node_id":"MDQ6VXNlcjQwNzUxMzY0","avatar_url":"https://avatars.githubusercontent.com/u/40751364?v=4","gravatar_id":"","url":"https://api.github.com/users/zhanghan1992","html_url":"https://github.com/zhanghan1992","followers_url":"https://api.github.com/users/zhanghan1992/followers","following_url":"https://api.github.com/users/zhanghan1992/following{/other_user}","gists_url":"https://api.github.com/users/zhanghan1992/gists{/gist_id}","starred_url":"https://api.github.com/users/zhanghan1992/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhanghan1992/subscriptions","organizations_url":"https://api.github.com/users/zhanghan1992/orgs","repos_url":"https://api.github.com/users/zhanghan1992/repos","events_url":"https://api.github.com/users/zhanghan1992/events{/privacy}","received_events_url":"https://api.github.com/users/zhanghan1992/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2019-08-12T03:11:58Z","updated_at":"2019-08-12T08:26:37Z","closed_at":"2019-08-12T08:26:37Z","author_association":"NONE","active_lock_reason":null,"body":"利用BERT finetune阅读理解任务（SQuAD），发现源码run_squad.py 预测时用的时单卡，训练时用的是可以多卡，我试着按照多卡训练的方式改写预测，使得预测时也可以支持多卡。以下是 我改写的 多卡预测：\r\n![image](https://user-images.githubusercontent.com/48793257/62844157-ea90a900-bcf1-11e9-9963-79fd645d05a8.png)\r\n\r\n并且同时将batching.py/pad_batch_data()方法的max_len改为 全局的max_seq_len，而不是每个batch下sample的最大长度，\r\n最后运行发现错误，输入的all_features和返回的all_results，数量不一致：\r\n![image](https://user-images.githubusercontent.com/48793257/62844143-caf98080-bcf1-11e9-8168-17eac3b99e6e.png)\r\n\r\n","closed_by":{"login":"zhanghan1992","id":40751364,"node_id":"MDQ6VXNlcjQwNzUxMzY0","avatar_url":"https://avatars.githubusercontent.com/u/40751364?v=4","gravatar_id":"","url":"https://api.github.com/users/zhanghan1992","html_url":"https://github.com/zhanghan1992","followers_url":"https://api.github.com/users/zhanghan1992/followers","following_url":"https://api.github.com/users/zhanghan1992/following{/other_user}","gists_url":"https://api.github.com/users/zhanghan1992/gists{/gist_id}","starred_url":"https://api.github.com/users/zhanghan1992/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhanghan1992/subscriptions","organizations_url":"https://api.github.com/users/zhanghan1992/orgs","repos_url":"https://api.github.com/users/zhanghan1992/repos","events_url":"https://api.github.com/users/zhanghan1992/events{/privacy}","received_events_url":"https://api.github.com/users/zhanghan1992/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/275/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PaddlePaddle/ERNIE/issues/275/timeline","performed_via_github_app":null,"state_reason":"completed"}