{"url":"https://api.github.com/repos/thushv89/attention_keras/issues/32","repository_url":"https://api.github.com/repos/thushv89/attention_keras","labels_url":"https://api.github.com/repos/thushv89/attention_keras/issues/32/labels{/name}","comments_url":"https://api.github.com/repos/thushv89/attention_keras/issues/32/comments","events_url":"https://api.github.com/repos/thushv89/attention_keras/issues/32/events","html_url":"https://github.com/thushv89/attention_keras/issues/32","id":566095794,"node_id":"MDU6SXNzdWU1NjYwOTU3OTQ=","number":32,"title":"TypeError: object of type 'Concatenate' has no len()","user":{"login":"sainikmahata","id":16027591,"node_id":"MDQ6VXNlcjE2MDI3NTkx","avatar_url":"https://avatars.githubusercontent.com/u/16027591?v=4","gravatar_id":"","url":"https://api.github.com/users/sainikmahata","html_url":"https://github.com/sainikmahata","followers_url":"https://api.github.com/users/sainikmahata/followers","following_url":"https://api.github.com/users/sainikmahata/following{/other_user}","gists_url":"https://api.github.com/users/sainikmahata/gists{/gist_id}","starred_url":"https://api.github.com/users/sainikmahata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sainikmahata/subscriptions","organizations_url":"https://api.github.com/users/sainikmahata/orgs","repos_url":"https://api.github.com/users/sainikmahata/repos","events_url":"https://api.github.com/users/sainikmahata/events{/privacy}","received_events_url":"https://api.github.com/users/sainikmahata/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-02-17T07:02:36Z","updated_at":"2020-02-23T02:18:43Z","closed_at":"2020-02-23T02:18:30Z","author_association":"NONE","active_lock_reason":null,"body":"I was trying to run a NMT model using GRU and the posted Attention Layer. But I am getting an issue citing \"TypeError: object of type 'Concatenate' has no len()\" . I am using sparse_categorical_crossentropy as my data is integer encoded and not one-hot encoded. I am very new to keras, and it would be helpful if you can point out my mistake. I am attaching the code snippet below. Another question is that, since I have written return_sequences=True in the case of decoder, do I need to use TimeDistributed Dense?\r\n\r\nenc_inp=Input(shape=(286,))\r\nenc_emb=Embedding(input_dim=91,output_dim=100)(enc_inp)\r\nenc_out,forward_h,backward_h=Bidirectional(GRU(64, return_sequences=True,return_state=True))(enc_emb)\r\nstate_h = Concatenate()([forward_h, backward_h])\r\nencoder_states=[state_h] \r\n\r\ndec_inp=Input(shape=(352,))\r\ndec_emb=Embedding(input_dim=117,output_dim=100)(dec_inp)\r\ndec_out,_=GRU(128,return_sequences=True,return_state=True)(dec_emb,initial_state=encoder_states)\r\n\r\nattn_layer = AttentionLayer(name='attention_layer') \r\nattn_out, attn_states = attn_layer([enc_out, dec_out]) \r\n\r\ndecoder_concat_input = Concatenate(axis=-1, name='concat_layer')([dec_out, attn_out])\r\n\r\ndec_dense=TimeDistributed(Dense(117, activation='softmax'))(decoder_concat_input)\r\n\r\nmodel=Model([enc_inp,dec_inp],dec_dense)\r\nmodel.compile(optimizer='nadam', loss='sparse_categorical_crossentropy', metrics=[\"sparse_categorical_accuracy\"])\r\nmodel.fit([en_inp,fr_inp],fr_out, batch_size=512, epochs=25, validation_split=0.1)\r\nmodel.save('model.h5')`","closed_by":{"login":"sainikmahata","id":16027591,"node_id":"MDQ6VXNlcjE2MDI3NTkx","avatar_url":"https://avatars.githubusercontent.com/u/16027591?v=4","gravatar_id":"","url":"https://api.github.com/users/sainikmahata","html_url":"https://github.com/sainikmahata","followers_url":"https://api.github.com/users/sainikmahata/followers","following_url":"https://api.github.com/users/sainikmahata/following{/other_user}","gists_url":"https://api.github.com/users/sainikmahata/gists{/gist_id}","starred_url":"https://api.github.com/users/sainikmahata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sainikmahata/subscriptions","organizations_url":"https://api.github.com/users/sainikmahata/orgs","repos_url":"https://api.github.com/users/sainikmahata/repos","events_url":"https://api.github.com/users/sainikmahata/events{/privacy}","received_events_url":"https://api.github.com/users/sainikmahata/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/thushv89/attention_keras/issues/32/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/thushv89/attention_keras/issues/32/timeline","performed_via_github_app":null,"state_reason":"completed"}