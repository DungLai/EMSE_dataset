{"url":"https://api.github.com/repos/mikgroup/sigpy/issues/62","repository_url":"https://api.github.com/repos/mikgroup/sigpy","labels_url":"https://api.github.com/repos/mikgroup/sigpy/issues/62/labels{/name}","comments_url":"https://api.github.com/repos/mikgroup/sigpy/issues/62/comments","events_url":"https://api.github.com/repos/mikgroup/sigpy/issues/62/events","html_url":"https://github.com/mikgroup/sigpy/issues/62","id":716991452,"node_id":"MDU6SXNzdWU3MTY5OTE0NTI=","number":62,"title":"RuntimeError: No available algorithm found.","user":{"login":"ltorres6","id":37592711,"node_id":"MDQ6VXNlcjM3NTkyNzEx","avatar_url":"https://avatars.githubusercontent.com/u/37592711?v=4","gravatar_id":"","url":"https://api.github.com/users/ltorres6","html_url":"https://github.com/ltorres6","followers_url":"https://api.github.com/users/ltorres6/followers","following_url":"https://api.github.com/users/ltorres6/following{/other_user}","gists_url":"https://api.github.com/users/ltorres6/gists{/gist_id}","starred_url":"https://api.github.com/users/ltorres6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ltorres6/subscriptions","organizations_url":"https://api.github.com/users/ltorres6/orgs","repos_url":"https://api.github.com/users/ltorres6/repos","events_url":"https://api.github.com/users/ltorres6/events{/privacy}","received_events_url":"https://api.github.com/users/ltorres6/received_events","type":"User","site_admin":false},"labels":[{"id":983094941,"node_id":"MDU6TGFiZWw5ODMwOTQ5NDE=","url":"https://api.github.com/repos/mikgroup/sigpy/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-10-08T03:30:50Z","updated_at":"2020-10-13T18:06:12Z","closed_at":"2020-10-13T18:04:59Z","author_association":"NONE","active_lock_reason":null,"body":"I updated sigpy to 0.1.21 (from 0.1.18) and now I can't run the JsenseRecon app on the GPU. I've tried downgrading sigpy again, and installing in a fresh environment and still get the same error, so I'm stuck, even though it was working fine before I upgraded (via conda). Maybe someone can help me figure out what's going on.\r\n\r\nCode used to reproduce:\r\n```\r\nimport numpy as np\r\nimport sigpy as sp\r\nimport sigpy.mri as mri\r\nimport sigpy.plot as plt\r\n\r\ndataInDir = \"/home/ltorres/data/forMatt/\"\r\nksp = np.load(\"{}ksp.npy\".format(dataInDir))\r\ncoord = np.load(\"{}coord.npy\".format(dataInDir))\r\ndcf = np.load(\"{}dcf.npy\".format(dataInDir))\r\n\r\ndevice = 0\r\nksp = sp.to_device(ksp, device)\r\ncoord = sp.to_device(coord, device)\r\ndcf = sp.to_device(dcf, device)\r\nmps = mri.app.JsenseRecon(\r\n    ksp,\r\n    coord=coord,\r\n    weights=dcf,\r\n    device=device,\r\n).run()\r\n```\r\n\r\nResulting Error:\r\n```\r\nJsenseRecon:   0%|                                                         | 0/10 [00:00<?, ?it/s]Traceback (most recent call last):\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/linop.py\", line 95, in apply\r\n    output = self._apply(input)\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/linop.py\", line 1657, in _apply\r\n    multi_channel=self.multi_channel)\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/conv.py\", line 143, in convolve_filter_adjoint\r\n    multi_channel=multi_channel)\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/conv.py\", line 311, in _complex\r\n    outputr = func(data1r, data2r, *kargs, **kwargs)\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/conv.py\", line 412, in _convolve_filter_adjoint_cuda\r\n    tensor_core=tensor_core)\r\n  File \"cupy/cudnn.pyx\", line 1817, in cupy.cudnn.convolution_backward_filter\r\n  File \"cupy/cudnn.pyx\", line 1469, in cupy.cudnn._find_algorithm_bwd_filter\r\nRuntimeError: No available algorithm found.\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/linop.py\", line 95, in apply\r\n    output = self._apply(input)\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/linop.py\", line 362, in _apply\r\n    output = linop(output)\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/linop.py\", line 122, in __call__\r\n    return self.__mul__(input)\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/linop.py\", line 131, in __mul__\r\n    return self.apply(input)\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/linop.py\", line 98, in apply\r\n    raise RuntimeError('Exceptions from {}.'.format(self)) from e\r\nRuntimeError: Exceptions from <[8, 1, 16, 16, 16]x[8, 23, 23, 23]> ConvolveFilterAdjoint Linop>.\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/ltorres/projects/extreme_mri/bug.py\", line 22, in <module>\r\n    device=device,\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/app.py\", line 85, in run\r\n    self.alg.update()\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/alg.py\", line 63, in update\r\n    self._update()\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/alg.py\", line 414, in _update\r\n    self.min1()\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/mri/app.py\", line 336, in min_mps_ker\r\n    show_pbar=False).run()\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/app.py\", line 213, in __init__\r\n    self._get_alg()\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/app.py\", line 247, in _get_alg\r\n    self._get_ConjugateGradient()\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/app.py\", line 264, in _get_ConjugateGradient\r\n    AHy = self.A.H(self.y)\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/linop.py\", line 122, in __call__\r\n    return self.__mul__(input)\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/linop.py\", line 131, in __mul__\r\n    return self.apply(input)\r\n  File \"/home/ltorres/anaconda3/envs/sigpyUpdated/lib/python3.7/site-packages/sigpy/linop.py\", line 98, in apply\r\n    raise RuntimeError('Exceptions from {}.'.format(self)) from e\r\nRuntimeError: Exceptions from <[8, 16, 16, 16]x[8, 14827820]> Reshape * ConvolveFilterAdjoint * FFT * NUFFTAdjoint * Reshape * Sum * Multiply Linop>.\r\nJsenseRecon:   0%|                                                         | 0/10 [00:01<?, ?it/s]```\r\n```\r\nIn case it's relevant, data is non-cartesian, downsampled to fit on GPU and organized as:\r\n```\r\nksp: [coils, spokes, readouts]\r\ncoord:[spokes, readouts, dimension]\r\ndcf: [spokes, readouts]\r\n```\r\n\r\nPackage versions:\r\n```\r\ncudatoolkit - 10.2.89 \r\ncudnn - 7.6.5 \r\ncupy - 8.0.0\r\nnumba - 0.51.2\r\nnumpy - 1.19.1\r\nsigpy - 0.1.18/0.1.21\r\n```","closed_by":{"login":"ltorres6","id":37592711,"node_id":"MDQ6VXNlcjM3NTkyNzEx","avatar_url":"https://avatars.githubusercontent.com/u/37592711?v=4","gravatar_id":"","url":"https://api.github.com/users/ltorres6","html_url":"https://github.com/ltorres6","followers_url":"https://api.github.com/users/ltorres6/followers","following_url":"https://api.github.com/users/ltorres6/following{/other_user}","gists_url":"https://api.github.com/users/ltorres6/gists{/gist_id}","starred_url":"https://api.github.com/users/ltorres6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ltorres6/subscriptions","organizations_url":"https://api.github.com/users/ltorres6/orgs","repos_url":"https://api.github.com/users/ltorres6/repos","events_url":"https://api.github.com/users/ltorres6/events{/privacy}","received_events_url":"https://api.github.com/users/ltorres6/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mikgroup/sigpy/issues/62/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mikgroup/sigpy/issues/62/timeline","performed_via_github_app":null,"state_reason":"completed"}