[{"id":3276045513,"node_id":"MDEyOkxhYmVsZWRFdmVudDMyNzYwNDU1MTM=","url":"https://api.github.com/repos/mikgroup/sigpy/issues/events/3276045513","actor":{"login":"valeryozenne","id":7050315,"node_id":"MDQ6VXNlcjcwNTAzMTU=","avatar_url":"https://avatars.githubusercontent.com/u/7050315?v=4","gravatar_id":"","url":"https://api.github.com/users/valeryozenne","html_url":"https://github.com/valeryozenne","followers_url":"https://api.github.com/users/valeryozenne/followers","following_url":"https://api.github.com/users/valeryozenne/following{/other_user}","gists_url":"https://api.github.com/users/valeryozenne/gists{/gist_id}","starred_url":"https://api.github.com/users/valeryozenne/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/valeryozenne/subscriptions","organizations_url":"https://api.github.com/users/valeryozenne/orgs","repos_url":"https://api.github.com/users/valeryozenne/repos","events_url":"https://api.github.com/users/valeryozenne/events{/privacy}","received_events_url":"https://api.github.com/users/valeryozenne/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-04-27T14:26:33Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/mikgroup/sigpy/issues/comments/620092192","html_url":"https://github.com/mikgroup/sigpy/issues/47#issuecomment-620092192","issue_url":"https://api.github.com/repos/mikgroup/sigpy/issues/47","id":620092192,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMDA5MjE5Mg==","user":{"login":"frankong","id":9143405,"node_id":"MDQ6VXNlcjkxNDM0MDU=","avatar_url":"https://avatars.githubusercontent.com/u/9143405?v=4","gravatar_id":"","url":"https://api.github.com/users/frankong","html_url":"https://github.com/frankong","followers_url":"https://api.github.com/users/frankong/followers","following_url":"https://api.github.com/users/frankong/following{/other_user}","gists_url":"https://api.github.com/users/frankong/gists{/gist_id}","starred_url":"https://api.github.com/users/frankong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/frankong/subscriptions","organizations_url":"https://api.github.com/users/frankong/orgs","repos_url":"https://api.github.com/users/frankong/repos","events_url":"https://api.github.com/users/frankong/events{/privacy}","received_events_url":"https://api.github.com/users/frankong/received_events","type":"User","site_admin":false},"created_at":"2020-04-27T16:26:24Z","updated_at":"2020-04-27T16:26:24Z","author_association":"MEMBER","body":"SigPy by default only uses one CPU. To use multi-CPU, you'll need to use MPI with [sigpy.Communicator](https://sigpy.readthedocs.io/en/latest/generated/sigpy.Communicator.html#sigpy.Communicator).\r\n\r\nThere isn't a demo for it right now, but I'm willing to help. To start, you'll need to install MPI and `mpi4py`. Then to launch your script with say 8 CPUs, you can do:\r\n`mpiexec -n 8 python main.py`\r\n\r\nYour script will be launched 8 times with different threads. Inside your code, you'll need to create a Communicator object. You can then use the communicator object to split and combine results between threads.","reactions":{"url":"https://api.github.com/repos/mikgroup/sigpy/issues/comments/620092192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"frankong","id":9143405,"node_id":"MDQ6VXNlcjkxNDM0MDU=","avatar_url":"https://avatars.githubusercontent.com/u/9143405?v=4","gravatar_id":"","url":"https://api.github.com/users/frankong","html_url":"https://github.com/frankong","followers_url":"https://api.github.com/users/frankong/followers","following_url":"https://api.github.com/users/frankong/following{/other_user}","gists_url":"https://api.github.com/users/frankong/gists{/gist_id}","starred_url":"https://api.github.com/users/frankong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/frankong/subscriptions","organizations_url":"https://api.github.com/users/frankong/orgs","repos_url":"https://api.github.com/users/frankong/repos","events_url":"https://api.github.com/users/frankong/events{/privacy}","received_events_url":"https://api.github.com/users/frankong/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mikgroup/sigpy/issues/comments/621077206","html_url":"https://github.com/mikgroup/sigpy/issues/47#issuecomment-621077206","issue_url":"https://api.github.com/repos/mikgroup/sigpy/issues/47","id":621077206,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTA3NzIwNg==","user":{"login":"valeryozenne","id":7050315,"node_id":"MDQ6VXNlcjcwNTAzMTU=","avatar_url":"https://avatars.githubusercontent.com/u/7050315?v=4","gravatar_id":"","url":"https://api.github.com/users/valeryozenne","html_url":"https://github.com/valeryozenne","followers_url":"https://api.github.com/users/valeryozenne/followers","following_url":"https://api.github.com/users/valeryozenne/following{/other_user}","gists_url":"https://api.github.com/users/valeryozenne/gists{/gist_id}","starred_url":"https://api.github.com/users/valeryozenne/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/valeryozenne/subscriptions","organizations_url":"https://api.github.com/users/valeryozenne/orgs","repos_url":"https://api.github.com/users/valeryozenne/repos","events_url":"https://api.github.com/users/valeryozenne/events{/privacy}","received_events_url":"https://api.github.com/users/valeryozenne/received_events","type":"User","site_admin":false},"created_at":"2020-04-29T09:00:02Z","updated_at":"2020-04-29T09:00:02Z","author_association":"NONE","body":"Thanks for the answer. Just some thoughts below:\r\n\r\nI guess this is not straightforward. Splitting the data need to be done carefully, depending the operation I'm doing, it might be difficult to split matrix along the encoding and channel dimension. It will work only if I have independent datasets (like 2D multi-slice) but what is the preferable way if want to reconstruct one dataset with regularization on subsampled dimension: [kx, ky, kz, cha, contrast] ?\r\n\r\nI would like to have your opinion, if we consider a 5D dataset with random acceleration along ky and kz and multiple contrasts. Do you think that it is possible to split the data along the readout direction (fully sampled) for non linear reconstruction? I know it is possible for standard 3D GRAPPA as the kernel application is the same in every location but here I'm not really sure. \r\n\r\nIf you have any example regarding the communicator object I will be interested to use it. This might be particularly usefull for optimizing parameters as the reconstruction time seems relatively long on one CPU.   \r\n\r\nThanks in advance,\r\nValéry","reactions":{"url":"https://api.github.com/repos/mikgroup/sigpy/issues/comments/621077206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"valeryozenne","id":7050315,"node_id":"MDQ6VXNlcjcwNTAzMTU=","avatar_url":"https://avatars.githubusercontent.com/u/7050315?v=4","gravatar_id":"","url":"https://api.github.com/users/valeryozenne","html_url":"https://github.com/valeryozenne","followers_url":"https://api.github.com/users/valeryozenne/followers","following_url":"https://api.github.com/users/valeryozenne/following{/other_user}","gists_url":"https://api.github.com/users/valeryozenne/gists{/gist_id}","starred_url":"https://api.github.com/users/valeryozenne/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/valeryozenne/subscriptions","organizations_url":"https://api.github.com/users/valeryozenne/orgs","repos_url":"https://api.github.com/users/valeryozenne/repos","events_url":"https://api.github.com/users/valeryozenne/events{/privacy}","received_events_url":"https://api.github.com/users/valeryozenne/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mikgroup/sigpy/issues/comments/621229198","html_url":"https://github.com/mikgroup/sigpy/issues/47#issuecomment-621229198","issue_url":"https://api.github.com/repos/mikgroup/sigpy/issues/47","id":621229198,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTIyOTE5OA==","user":{"login":"sidward","id":7364812,"node_id":"MDQ6VXNlcjczNjQ4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/7364812?v=4","gravatar_id":"","url":"https://api.github.com/users/sidward","html_url":"https://github.com/sidward","followers_url":"https://api.github.com/users/sidward/followers","following_url":"https://api.github.com/users/sidward/following{/other_user}","gists_url":"https://api.github.com/users/sidward/gists{/gist_id}","starred_url":"https://api.github.com/users/sidward/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sidward/subscriptions","organizations_url":"https://api.github.com/users/sidward/orgs","repos_url":"https://api.github.com/users/sidward/repos","events_url":"https://api.github.com/users/sidward/events{/privacy}","received_events_url":"https://api.github.com/users/sidward/received_events","type":"User","site_admin":false},"created_at":"2020-04-29T14:00:46Z","updated_at":"2020-04-29T14:00:46Z","author_association":"COLLABORATOR","body":"Hi,\r\n\r\nAs long as there is no correlation between the readout and phase encodes (like with wave for example), you should be able to process the data slice by slice after taking the inverse Fourier transform along the readout direction.","reactions":{"url":"https://api.github.com/repos/mikgroup/sigpy/issues/comments/621229198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sidward","id":7364812,"node_id":"MDQ6VXNlcjczNjQ4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/7364812?v=4","gravatar_id":"","url":"https://api.github.com/users/sidward","html_url":"https://github.com/sidward","followers_url":"https://api.github.com/users/sidward/followers","following_url":"https://api.github.com/users/sidward/following{/other_user}","gists_url":"https://api.github.com/users/sidward/gists{/gist_id}","starred_url":"https://api.github.com/users/sidward/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sidward/subscriptions","organizations_url":"https://api.github.com/users/sidward/orgs","repos_url":"https://api.github.com/users/sidward/repos","events_url":"https://api.github.com/users/sidward/events{/privacy}","received_events_url":"https://api.github.com/users/sidward/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mikgroup/sigpy/issues/comments/621687474","html_url":"https://github.com/mikgroup/sigpy/issues/47#issuecomment-621687474","issue_url":"https://api.github.com/repos/mikgroup/sigpy/issues/47","id":621687474,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTY4NzQ3NA==","user":{"login":"valeryozenne","id":7050315,"node_id":"MDQ6VXNlcjcwNTAzMTU=","avatar_url":"https://avatars.githubusercontent.com/u/7050315?v=4","gravatar_id":"","url":"https://api.github.com/users/valeryozenne","html_url":"https://github.com/valeryozenne","followers_url":"https://api.github.com/users/valeryozenne/followers","following_url":"https://api.github.com/users/valeryozenne/following{/other_user}","gists_url":"https://api.github.com/users/valeryozenne/gists{/gist_id}","starred_url":"https://api.github.com/users/valeryozenne/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/valeryozenne/subscriptions","organizations_url":"https://api.github.com/users/valeryozenne/orgs","repos_url":"https://api.github.com/users/valeryozenne/repos","events_url":"https://api.github.com/users/valeryozenne/events{/privacy}","received_events_url":"https://api.github.com/users/valeryozenne/received_events","type":"User","site_admin":false},"created_at":"2020-04-30T08:18:47Z","updated_at":"2020-04-30T08:18:47Z","author_association":"NONE","body":"Nice, basically, if I can split the data along the readout direction, I might also be able to do the operation slice by slice also in the GPU device where memory size is generally too small for large datasets. It will depend from which point I can split the data. \r\n\r\nJust to be 100% sure, if I go back to the demo 03-building-an-l1-wavelet-recon-app.ipynb with a 5D dataset [kx, ky, kz, cha, contrast], dividing a 256 readout into blocks of 32 , and doing the L1Wavelet reco on the block of readout (32 voxels, ky, kz, cha, contrast) will result in the same result ? \r\n\r\nFor my understanding , coil sensitivity map and wavelet are related to spatial information so splitting the data could result in different values. Assuming the size of block of readout is larger that the actual kernel operation inside the functions (a spatial derivative for instance), it could work. Do you confirm my thought.   \r\n\r\nDo you have any articles to refer  / demo that my help me to understand why it is working?\r\nThanks in advance,\r\nValéry\r\n ","reactions":{"url":"https://api.github.com/repos/mikgroup/sigpy/issues/comments/621687474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"valeryozenne","id":7050315,"node_id":"MDQ6VXNlcjcwNTAzMTU=","avatar_url":"https://avatars.githubusercontent.com/u/7050315?v=4","gravatar_id":"","url":"https://api.github.com/users/valeryozenne","html_url":"https://github.com/valeryozenne","followers_url":"https://api.github.com/users/valeryozenne/followers","following_url":"https://api.github.com/users/valeryozenne/following{/other_user}","gists_url":"https://api.github.com/users/valeryozenne/gists{/gist_id}","starred_url":"https://api.github.com/users/valeryozenne/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/valeryozenne/subscriptions","organizations_url":"https://api.github.com/users/valeryozenne/orgs","repos_url":"https://api.github.com/users/valeryozenne/repos","events_url":"https://api.github.com/users/valeryozenne/events{/privacy}","received_events_url":"https://api.github.com/users/valeryozenne/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mikgroup/sigpy/issues/comments/621914511","html_url":"https://github.com/mikgroup/sigpy/issues/47#issuecomment-621914511","issue_url":"https://api.github.com/repos/mikgroup/sigpy/issues/47","id":621914511,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTkxNDUxMQ==","user":{"login":"sidward","id":7364812,"node_id":"MDQ6VXNlcjczNjQ4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/7364812?v=4","gravatar_id":"","url":"https://api.github.com/users/sidward","html_url":"https://github.com/sidward","followers_url":"https://api.github.com/users/sidward/followers","following_url":"https://api.github.com/users/sidward/following{/other_user}","gists_url":"https://api.github.com/users/sidward/gists{/gist_id}","starred_url":"https://api.github.com/users/sidward/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sidward/subscriptions","organizations_url":"https://api.github.com/users/sidward/orgs","repos_url":"https://api.github.com/users/sidward/repos","events_url":"https://api.github.com/users/sidward/events{/privacy}","received_events_url":"https://api.github.com/users/sidward/received_events","type":"User","site_admin":false},"created_at":"2020-04-30T15:08:06Z","updated_at":"2020-04-30T15:08:27Z","author_association":"COLLABORATOR","body":"Hi,\r\n\r\nIf you ignore the wavelet penalty, in principle, solving the least squares problem slice-by-slice, or block-by-block, should result in the same answer. You are correct in that applying a 3D regularizer will result in slightly different solutions based on how you partition your data. I would personally expect better wavelet sparsity the larger the readout block, but I would test this.\r\n\r\nThat being said, in my experience, most of the computational burden comes from the least squares (or data consistency) term. If A is your forward operator, I would recommend that you use the ```ToDevice``` Linop along with the ```Diag```, ```Hstack``` and ```Vstack``` to break a large problem into smaller ones so that Ax, AHx and AHA that can be processed on the GPU.  For most kinds of problems in MRI, this ```ToDevice``` trick will work directly for the coil dimension.  I would also recommend looking into the communicator object, as described by Frank, to use multiple CPUs in a similar manner.\r\n\r\nLikewise, if you would like to use a full volume wavelet transform and it does not fit on the GPU, you can process it on the CPU while still taking advantage of the GPU for the data-consistency term.\r\n\r\nNote that there will be some penalty to moving data around.\r\n\r\nFor an example of splitting multi-contrast data to perform non-linear reconstruction, please take a look at the following. An example reconstruction pipeline is discussed in-depth.\r\n\r\nhttps://arxiv.org/pdf/1809.04195.pdf\r\n\r\nHope this helps!","reactions":{"url":"https://api.github.com/repos/mikgroup/sigpy/issues/comments/621914511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sidward","id":7364812,"node_id":"MDQ6VXNlcjczNjQ4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/7364812?v=4","gravatar_id":"","url":"https://api.github.com/users/sidward","html_url":"https://github.com/sidward","followers_url":"https://api.github.com/users/sidward/followers","following_url":"https://api.github.com/users/sidward/following{/other_user}","gists_url":"https://api.github.com/users/sidward/gists{/gist_id}","starred_url":"https://api.github.com/users/sidward/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sidward/subscriptions","organizations_url":"https://api.github.com/users/sidward/orgs","repos_url":"https://api.github.com/users/sidward/repos","events_url":"https://api.github.com/users/sidward/events{/privacy}","received_events_url":"https://api.github.com/users/sidward/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mikgroup/sigpy/issues/comments/621946287","html_url":"https://github.com/mikgroup/sigpy/issues/47#issuecomment-621946287","issue_url":"https://api.github.com/repos/mikgroup/sigpy/issues/47","id":621946287,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTk0NjI4Nw==","user":{"login":"valeryozenne","id":7050315,"node_id":"MDQ6VXNlcjcwNTAzMTU=","avatar_url":"https://avatars.githubusercontent.com/u/7050315?v=4","gravatar_id":"","url":"https://api.github.com/users/valeryozenne","html_url":"https://github.com/valeryozenne","followers_url":"https://api.github.com/users/valeryozenne/followers","following_url":"https://api.github.com/users/valeryozenne/following{/other_user}","gists_url":"https://api.github.com/users/valeryozenne/gists{/gist_id}","starred_url":"https://api.github.com/users/valeryozenne/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/valeryozenne/subscriptions","organizations_url":"https://api.github.com/users/valeryozenne/orgs","repos_url":"https://api.github.com/users/valeryozenne/repos","events_url":"https://api.github.com/users/valeryozenne/events{/privacy}","received_events_url":"https://api.github.com/users/valeryozenne/received_events","type":"User","site_admin":false},"created_at":"2020-04-30T16:01:29Z","updated_at":"2020-04-30T16:01:29Z","author_association":"NONE","body":"Yes, it helps a lot. Thanks. \r\nI close the issue.","reactions":{"url":"https://api.github.com/repos/mikgroup/sigpy/issues/comments/621946287/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"valeryozenne","id":7050315,"node_id":"MDQ6VXNlcjcwNTAzMTU=","avatar_url":"https://avatars.githubusercontent.com/u/7050315?v=4","gravatar_id":"","url":"https://api.github.com/users/valeryozenne","html_url":"https://github.com/valeryozenne","followers_url":"https://api.github.com/users/valeryozenne/followers","following_url":"https://api.github.com/users/valeryozenne/following{/other_user}","gists_url":"https://api.github.com/users/valeryozenne/gists{/gist_id}","starred_url":"https://api.github.com/users/valeryozenne/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/valeryozenne/subscriptions","organizations_url":"https://api.github.com/users/valeryozenne/orgs","repos_url":"https://api.github.com/users/valeryozenne/repos","events_url":"https://api.github.com/users/valeryozenne/events{/privacy}","received_events_url":"https://api.github.com/users/valeryozenne/received_events","type":"User","site_admin":false}},{"id":3290211333,"node_id":"MDExOkNsb3NlZEV2ZW50MzI5MDIxMTMzMw==","url":"https://api.github.com/repos/mikgroup/sigpy/issues/events/3290211333","actor":{"login":"valeryozenne","id":7050315,"node_id":"MDQ6VXNlcjcwNTAzMTU=","avatar_url":"https://avatars.githubusercontent.com/u/7050315?v=4","gravatar_id":"","url":"https://api.github.com/users/valeryozenne","html_url":"https://github.com/valeryozenne","followers_url":"https://api.github.com/users/valeryozenne/followers","following_url":"https://api.github.com/users/valeryozenne/following{/other_user}","gists_url":"https://api.github.com/users/valeryozenne/gists{/gist_id}","starred_url":"https://api.github.com/users/valeryozenne/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/valeryozenne/subscriptions","organizations_url":"https://api.github.com/users/valeryozenne/orgs","repos_url":"https://api.github.com/users/valeryozenne/repos","events_url":"https://api.github.com/users/valeryozenne/events{/privacy}","received_events_url":"https://api.github.com/users/valeryozenne/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-04-30T16:01:29Z","state_reason":null,"performed_via_github_app":null}]