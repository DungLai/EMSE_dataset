{"url":"https://api.github.com/repos/TimoBolkart/voca/issues/11","repository_url":"https://api.github.com/repos/TimoBolkart/voca","labels_url":"https://api.github.com/repos/TimoBolkart/voca/issues/11/labels{/name}","comments_url":"https://api.github.com/repos/TimoBolkart/voca/issues/11/comments","events_url":"https://api.github.com/repos/TimoBolkart/voca/issues/11/events","html_url":"https://github.com/TimoBolkart/voca/issues/11","id":471518005,"node_id":"MDU6SXNzdWU0NzE1MTgwMDU=","number":11,"title":"cuDNN launch failure : input shape ([306,1,16,29])","user":{"login":"qianyunw","id":19343286,"node_id":"MDQ6VXNlcjE5MzQzMjg2","avatar_url":"https://avatars.githubusercontent.com/u/19343286?v=4","gravatar_id":"","url":"https://api.github.com/users/qianyunw","html_url":"https://github.com/qianyunw","followers_url":"https://api.github.com/users/qianyunw/followers","following_url":"https://api.github.com/users/qianyunw/following{/other_user}","gists_url":"https://api.github.com/users/qianyunw/gists{/gist_id}","starred_url":"https://api.github.com/users/qianyunw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qianyunw/subscriptions","organizations_url":"https://api.github.com/users/qianyunw/orgs","repos_url":"https://api.github.com/users/qianyunw/repos","events_url":"https://api.github.com/users/qianyunw/events{/privacy}","received_events_url":"https://api.github.com/users/qianyunw/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-07-23T06:57:31Z","updated_at":"2019-08-08T11:12:23Z","closed_at":"2019-08-08T11:12:22Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\r\n\r\nthanks for sharing! Sorry to bother you againT_T.\r\n\r\nI am currently trying to run your code on my machine(Python 2.7& Tensorflow 1.12.0).\r\nWhen I run command line \"python run_voca.py\", there are some problems, The following is the output, is there something wrong with my settings?\r\n\r\nThank you so much!!\r\n\r\n<\r\npython run_voca.py --tf_model_fname './model/gstep_52280.model' --ds_fname './ds_graph/output_graph.pb' --audio_fname './audio/test_sentence.wav' --template_fname './template/FLAME_sample.ply' --condition_idx 3 --out_path './animation_output'\r\n2019-07-23 06:49:29.981799: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA\r\n2019-07-23 06:49:34.971252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: \r\nname: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545\r\npciBusID: 0000:18:00.0\r\ntotalMemory: 10.76GiB freeMemory: 1.87GiB\r\n2019-07-23 06:49:35.165961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 1 with properties: \r\nname: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545\r\npciBusID: 0000:3b:00.0\r\ntotalMemory: 10.76GiB freeMemory: 1.77GiB\r\n2019-07-23 06:49:35.287032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 2 with properties: \r\nname: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545\r\npciBusID: 0000:86:00.0\r\ntotalMemory: 10.76GiB freeMemory: 10.60GiB\r\n2019-07-23 06:49:35.287328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0, 1, 2\r\n2019-07-23 06:50:29.496448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-07-23 06:50:29.496516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 1 2 \r\n2019-07-23 06:50:29.496526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N N N \r\n2019-07-23 06:50:29.496549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 1:   N N N \r\n2019-07-23 06:50:29.496557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 2:   N N N \r\n2019-07-23 06:50:29.496791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 1607 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:18:00.0, compute capability: 7.5)\r\n2019-07-23 06:50:31.759153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 1503 MB memory) -> physical GPU (device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:3b:00.0, compute capability: 7.5)\r\n2019-07-23 06:50:31.759597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10232 MB memory) -> physical GPU (device: 2, name: GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5)\r\nprocess subj - seq\r\n2019-07-23 06:50:41.148658: W tensorflow/core/framework/allocator.cc:122] Allocation of 201326592 exceeds 10% of system memory.\r\n2019-07-23 06:50:41.449976: W tensorflow/core/framework/allocator.cc:122] Allocation of 201326592 exceeds 10% of system memory.\r\n2019-07-23 06:50:42.074583: W tensorflow/core/framework/allocator.cc:122] Allocation of 201326592 exceeds 10% of system memory.\r\n2019-07-23 06:50:42.386122: W tensorflow/core/framework/allocator.cc:122] Allocation of 201326592 exceeds 10% of system memory.\r\n2019-07-23 06:50:42.732171: W tensorflow/core/framework/allocator.cc:122] Allocation of 201326592 exceeds 10% of system memory.\r\n2019-07-23 06:51:52.237460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0, 1, 2\r\n2019-07-23 06:51:52.237883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-07-23 06:51:52.237898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 1 2 \r\n2019-07-23 06:51:52.237909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N N N \r\n2019-07-23 06:51:52.237916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 1:   N N N \r\n2019-07-23 06:51:52.237924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 2:   N N N \r\n2019-07-23 06:51:52.238128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 1607 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:18:00.0, compute capability: 7.5)\r\n2019-07-23 06:51:52.238453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 1503 MB memory) -> physical GPU (device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:3b:00.0, compute capability: 7.5)\r\n2019-07-23 06:51:52.238653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10232 MB memory) -> physical GPU (device: 2, name: GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5)\r\n2019-07-23 06:52:12.202266: E tensorflow/stream_executor/cuda/cuda_dnn.cc:373] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2019-07-23 06:52:12.202348: W ./tensorflow/stream_executor/stream.h:2093] attempting to perform DNN operation using StreamExecutor without DNN support\r\nTraceback (most recent call last):\r\n  File \"run_voca.py\", line 44, in <module>\r\n    inference(tf_model_fname, ds_fname, audio_fname, template_fname, condition_idx, out_path)\r\n  File \"/home/wangqianyun/voca/utils/inference.py\", line 83, in inference\r\n    predicted_vertices = np.squeeze(session.run(output_decoder, feed_dict))\r\n  File \"/home/wangqianyun/voca/voca/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 929, in run\r\n    run_metadata_ptr)\r\n  File \"/home/wangqianyun/voca/voca/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1152, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/wangqianyun/voca/voca/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1328, in _do_run\r\n    run_metadata)\r\n  File \"/home/wangqianyun/voca/voca/local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1348, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InternalError: cuDNN launch failure : input shape ([306,1,16,29])\r\n\t [[node VOCA/SpeechEncoder/batch_norm_1/cond/FusedBatchNorm_1 (defined at /home/wangqianyun/voca/utils/inference.py:65)  = FusedBatchNorm[T=DT_FLOAT, data_format=\"NCHW\", epsilon=1.001e-05, is_training=false, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](VOCA/SpeechEncoder/batch_norm_1/cond/FusedBatchNorm_1-0-TransposeNHWCToNCHW-LayoutOptimizer, VOCA/SpeechEncoder/batch_norm_1/cond/FusedBatchNorm_1/Switch_1, VOCA/SpeechEncoder/batch_norm_1/cond/FusedBatchNorm_1/Switch_2, VOCA/SpeechEncoder/batch_norm_1/cond_1/AssignMovingAvg/sub/Switch, VOCA/SpeechEncoder/batch_norm_1/cond_1/AssignMovingAvg_1/sub/Switch)]]\r\n\r\nCaused by op u'VOCA/SpeechEncoder/batch_norm_1/cond/FusedBatchNorm_1', defined at:\r\n  File \"run_voca.py\", line 44, in <module>\r\n    inference(tf_model_fname, ds_fname, audio_fname, template_fname, condition_idx, out_path)\r\n  File \"/home/wangqianyun/voca/utils/inference.py\", line 65, in inference\r\n    saver = tf.train.import_meta_graph(tf_model_fname + '.meta')\r\n  File \"/home/wangqianyun/voca/voca/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1674, in import_meta_graph\r\n    meta_graph_or_file, clear_devices, import_scope, **kwargs)[0]\r\n  File \"/home/wangqianyun/voca/voca/local/lib/python2.7/site-packages/tensorflow/python/training/saver.py\", line 1696, in _import_meta_graph_with_return_elements\r\n    **kwargs))\r\n  File \"/home/wangqianyun/voca/voca/local/lib/python2.7/site-packages/tensorflow/python/framework/meta_graph.py\", line 806, in import_scoped_meta_graph_with_return_elements\r\n    return_elements=return_elements)\r\n  File \"/home/wangqianyun/voca/voca/local/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/wangqianyun/voca/voca/local/lib/python2.7/site-packages/tensorflow/python/framework/importer.py\", line 442, in import_graph_def\r\n    _ProcessNewOps(graph)\r\n  File \"/home/wangqianyun/voca/voca/local/lib/python2.7/site-packages/tensorflow/python/framework/importer.py\", line 234, in _ProcessNewOps\r\n    for new_op in graph._add_new_tf_operations(compute_devices=False):  # pylint: disable=protected-access\r\n  File \"/home/wangqianyun/voca/voca/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 3440, in _add_new_tf_operations\r\n    for c_op in c_api_util.new_tf_operations(self)\r\n  File \"/home/wangqianyun/voca/voca/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 3299, in _create_op_from_tf_operation\r\n    ret = Operation(c_op, self)\r\n  File \"/home/wangqianyun/voca/voca/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1770, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nInternalError (see above for traceback): cuDNN launch failure : input shape ([306,1,16,29])\r\n\t [[node VOCA/SpeechEncoder/batch_norm_1/cond/FusedBatchNorm_1 (defined at /home/wangqianyun/voca/utils/inference.py:65)  = FusedBatchNorm[T=DT_FLOAT, data_format=\"NCHW\", epsilon=1.001e-05, is_training=false, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](VOCA/SpeechEncoder/batch_norm_1/cond/FusedBatchNorm_1-0-TransposeNHWCToNCHW-LayoutOptimizer, VOCA/SpeechEncoder/batch_norm_1/cond/FusedBatchNorm_1/Switch_1, VOCA/SpeechEncoder/batch_norm_1/cond/FusedBatchNorm_1/Switch_2, VOCA/SpeechEncoder/batch_norm_1/cond_1/AssignMovingAvg/sub/Switch, VOCA/SpeechEncoder/batch_norm_1/cond_1/AssignMovingAvg_1/sub/Switch)]]\r\n>","closed_by":{"login":"TimoBolkart","id":26549953,"node_id":"MDQ6VXNlcjI2NTQ5OTUz","avatar_url":"https://avatars.githubusercontent.com/u/26549953?v=4","gravatar_id":"","url":"https://api.github.com/users/TimoBolkart","html_url":"https://github.com/TimoBolkart","followers_url":"https://api.github.com/users/TimoBolkart/followers","following_url":"https://api.github.com/users/TimoBolkart/following{/other_user}","gists_url":"https://api.github.com/users/TimoBolkart/gists{/gist_id}","starred_url":"https://api.github.com/users/TimoBolkart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TimoBolkart/subscriptions","organizations_url":"https://api.github.com/users/TimoBolkart/orgs","repos_url":"https://api.github.com/users/TimoBolkart/repos","events_url":"https://api.github.com/users/TimoBolkart/events{/privacy}","received_events_url":"https://api.github.com/users/TimoBolkart/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/TimoBolkart/voca/issues/11/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/TimoBolkart/voca/issues/11/timeline","performed_via_github_app":null,"state_reason":"completed"}