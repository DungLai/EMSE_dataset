{"url":"https://api.github.com/repos/TimoBolkart/voca/issues/36","repository_url":"https://api.github.com/repos/TimoBolkart/voca","labels_url":"https://api.github.com/repos/TimoBolkart/voca/issues/36/labels{/name}","comments_url":"https://api.github.com/repos/TimoBolkart/voca/issues/36/comments","events_url":"https://api.github.com/repos/TimoBolkart/voca/issues/36/events","html_url":"https://github.com/TimoBolkart/voca/issues/36","id":607786925,"node_id":"MDU6SXNzdWU2MDc3ODY5MjU=","number":36,"title":"Implementation mistake in _validation_step function ","user":{"login":"mrkoujan","id":53237962,"node_id":"MDQ6VXNlcjUzMjM3OTYy","avatar_url":"https://avatars.githubusercontent.com/u/53237962?v=4","gravatar_id":"","url":"https://api.github.com/users/mrkoujan","html_url":"https://github.com/mrkoujan","followers_url":"https://api.github.com/users/mrkoujan/followers","following_url":"https://api.github.com/users/mrkoujan/following{/other_user}","gists_url":"https://api.github.com/users/mrkoujan/gists{/gist_id}","starred_url":"https://api.github.com/users/mrkoujan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrkoujan/subscriptions","organizations_url":"https://api.github.com/users/mrkoujan/orgs","repos_url":"https://api.github.com/users/mrkoujan/repos","events_url":"https://api.github.com/users/mrkoujan/events{/privacy}","received_events_url":"https://api.github.com/users/mrkoujan/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-04-27T19:16:26Z","updated_at":"2020-04-28T14:35:13Z","closed_at":"2020-04-28T14:35:13Z","author_association":"NONE","active_lock_reason":null,"body":"Hey,\r\n\r\nCongratulations on this excellent work and thanks for sharing your code and results.\r\n\r\nAs far as I understand, the _validation_step funtion in the voca_model class is intended to compute the validation error conditioned on all training subjects and return the average over all. Towards that, the elements of each of the validation batch variables (processed_audio, vertices, templates, conditions) were repeated according to 'num_training_subjects' parameter. For that, the np.repeat method was used. However, given the way you create conditions (see below), the np.repeat will repeat each single element along axis 0 (as you define it in your code) a 'repeats' number of times. \r\n\r\nconditions = np.reshape(np.repeat(np.arange(num_training_subjects)[:,np.newaxis],\r\n                                          repeats=self.config['num_consecutive_frames']*self.config['batch_size'], axis=-1), [-1,])\r\n\r\nInstead, we would like to repeat the elements along axis 0 in blocks to match with 'conditions' so that each data frame is conditioned on all training subjects. Currently, for example, the first  'num_training_subjects' elements of 'conditions' are all zeros, while the first 'num_training_subjects'  elements along axis 0 of , e.g., self.speech_features, after repeating them the way you do currently, are all exactly the same. This means you will condition the same data frame repeatedly by 'num_training_subjects' on subject number 0. This will also produce wrong results when computing the velocity loss, as consequtive data frames are the same after following this way of repeatition.\r\n\r\n\r\nAlternatively, np.tile could be use as a solution to this. For example, the new way of creating self.speech_features could be as follows:\r\n\r\n self.speech_features = np.expand_dims(np.tile(processed_audio, (num_training_subjects, 1, 1)), -1)\r\n\r\nDo you agree?","closed_by":{"login":"mrkoujan","id":53237962,"node_id":"MDQ6VXNlcjUzMjM3OTYy","avatar_url":"https://avatars.githubusercontent.com/u/53237962?v=4","gravatar_id":"","url":"https://api.github.com/users/mrkoujan","html_url":"https://github.com/mrkoujan","followers_url":"https://api.github.com/users/mrkoujan/followers","following_url":"https://api.github.com/users/mrkoujan/following{/other_user}","gists_url":"https://api.github.com/users/mrkoujan/gists{/gist_id}","starred_url":"https://api.github.com/users/mrkoujan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrkoujan/subscriptions","organizations_url":"https://api.github.com/users/mrkoujan/orgs","repos_url":"https://api.github.com/users/mrkoujan/repos","events_url":"https://api.github.com/users/mrkoujan/events{/privacy}","received_events_url":"https://api.github.com/users/mrkoujan/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/TimoBolkart/voca/issues/36/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/TimoBolkart/voca/issues/36/timeline","performed_via_github_app":null,"state_reason":"completed"}