{"url":"https://api.github.com/repos/theislab/scgen/issues/1","repository_url":"https://api.github.com/repos/theislab/scgen","labels_url":"https://api.github.com/repos/theislab/scgen/issues/1/labels{/name}","comments_url":"https://api.github.com/repos/theislab/scgen/issues/1/comments","events_url":"https://api.github.com/repos/theislab/scgen/issues/1/events","html_url":"https://github.com/theislab/scgen/issues/1","id":421889203,"node_id":"MDU6SXNzdWU0MjE4ODkyMDM=","number":1,"title":"Issue with scgen.batch_removal function","user":{"login":"nhuhoa","id":8064672,"node_id":"MDQ6VXNlcjgwNjQ2NzI=","avatar_url":"https://avatars.githubusercontent.com/u/8064672?v=4","gravatar_id":"","url":"https://api.github.com/users/nhuhoa","html_url":"https://github.com/nhuhoa","followers_url":"https://api.github.com/users/nhuhoa/followers","following_url":"https://api.github.com/users/nhuhoa/following{/other_user}","gists_url":"https://api.github.com/users/nhuhoa/gists{/gist_id}","starred_url":"https://api.github.com/users/nhuhoa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nhuhoa/subscriptions","organizations_url":"https://api.github.com/users/nhuhoa/orgs","repos_url":"https://api.github.com/users/nhuhoa/repos","events_url":"https://api.github.com/users/nhuhoa/events{/privacy}","received_events_url":"https://api.github.com/users/nhuhoa/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-03-17T06:50:49Z","updated_at":"2019-06-22T00:28:28Z","closed_at":"2019-06-22T00:28:28Z","author_association":"NONE","active_lock_reason":null,"body":"Dear Naghipourfar and M0hammadL, \r\n\r\nThanks for very nice work. It will be very useful for my work. \r\nI have tested scGen and there is a small bug at the \"batch_removal\" function. So I just want to let you know here. \r\n\r\nI just test scGen with 2 batches, batch 0 and batch 1 and only one cell type with index 1. Training process goes well, but the batch removal step has a bug: \r\nThe bug is at line 291 of util.py: \r\n all_shared_ann = sc.AnnData.concatenate(*shared_ct, batch_key=\"concat_batch\")\r\n// after concatenate function, we suppose to have a pandas dataframe: all_shared_ann.obs[\"concat_batch\"], but the program do not return this dataframe, only return all_shared_ann.obs[\"batch\"], and all_shared_ann.obs[\"cell_type\"]. \r\n\r\nSo at the next line: \r\ndel all_shared_ann.obs[\"concat_batch\"]  \r\n// this dataframe does not exist, program throw error here. \r\n\r\nThe same idea with the line 301 of util.py: \r\ndel all_corrected_data.obs[\"concat_batch\"]\r\n\r\nWhen I comment 2 bugs above, the program works well and give me a corrected matrix.  \r\nThe versions of package I use are:\r\nscgen:  1.0.0.dev25+347e176\r\nanndata:  0.6.18\r\nscanpy:  1.4\r\nnumpy:  1.14.5\r\n\r\nThanks, \r\nHoa Tran","closed_by":{"login":"M0hammadL","id":33202701,"node_id":"MDQ6VXNlcjMzMjAyNzAx","avatar_url":"https://avatars.githubusercontent.com/u/33202701?v=4","gravatar_id":"","url":"https://api.github.com/users/M0hammadL","html_url":"https://github.com/M0hammadL","followers_url":"https://api.github.com/users/M0hammadL/followers","following_url":"https://api.github.com/users/M0hammadL/following{/other_user}","gists_url":"https://api.github.com/users/M0hammadL/gists{/gist_id}","starred_url":"https://api.github.com/users/M0hammadL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/M0hammadL/subscriptions","organizations_url":"https://api.github.com/users/M0hammadL/orgs","repos_url":"https://api.github.com/users/M0hammadL/repos","events_url":"https://api.github.com/users/M0hammadL/events{/privacy}","received_events_url":"https://api.github.com/users/M0hammadL/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/theislab/scgen/issues/1/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/theislab/scgen/issues/1/timeline","performed_via_github_app":null,"state_reason":"completed"}