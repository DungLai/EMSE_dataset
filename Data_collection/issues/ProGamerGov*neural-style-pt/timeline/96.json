[{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/1239813037","html_url":"https://github.com/ProGamerGov/neural-style-pt/issues/96#issuecomment-1239813037","issue_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/96","id":1239813037,"node_id":"IC_kwDOCHwEic5J5gut","user":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false},"created_at":"2022-09-07T19:58:42Z","updated_at":"2022-09-07T19:58:42Z","author_association":"OWNER","body":"@ProGamerGov Yeah it should be relatively straight forward, however I currently don't have a way to test it.\r\n","reactions":{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/1239813037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false}},{"id":7341772680,"node_id":"MEE_lADOCHwEic5RW2ImzwAAAAG1mo-I","url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/events/7341772680","actor":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-09-07T19:58:42Z","performed_via_github_app":null},{"id":7341772685,"node_id":"SE_lADOCHwEic5RW2ImzwAAAAG1mo-N","url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/events/7341772685","actor":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-09-07T19:58:42Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/1242759212","html_url":"https://github.com/ProGamerGov/neural-style-pt/issues/96#issuecomment-1242759212","issue_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/96","id":1242759212,"node_id":"IC_kwDOCHwEic5KEwAs","user":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false},"created_at":"2022-09-10T16:02:08Z","updated_at":"2022-09-10T16:02:08Z","author_association":"OWNER","body":"@trbutler Try running this WIP neural-style-pt branch on MPS: https://github.com/ProGamerGov/neural-style-pt/tree/master-2","reactions":{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/1242759212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false}},{"id":7361116673,"node_id":"MEE_lADOCHwEic5RW2ImzwAAAAG2wboB","url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/events/7361116673","actor":{"login":"trbutler","id":4777803,"node_id":"MDQ6VXNlcjQ3Nzc4MDM=","avatar_url":"https://avatars.githubusercontent.com/u/4777803?v=4","gravatar_id":"","url":"https://api.github.com/users/trbutler","html_url":"https://github.com/trbutler","followers_url":"https://api.github.com/users/trbutler/followers","following_url":"https://api.github.com/users/trbutler/following{/other_user}","gists_url":"https://api.github.com/users/trbutler/gists{/gist_id}","starred_url":"https://api.github.com/users/trbutler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trbutler/subscriptions","organizations_url":"https://api.github.com/users/trbutler/orgs","repos_url":"https://api.github.com/users/trbutler/repos","events_url":"https://api.github.com/users/trbutler/events{/privacy}","received_events_url":"https://api.github.com/users/trbutler/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-09-10T16:02:08Z","performed_via_github_app":null},{"id":7361116676,"node_id":"SE_lADOCHwEic5RW2ImzwAAAAG2wboE","url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/events/7361116676","actor":{"login":"trbutler","id":4777803,"node_id":"MDQ6VXNlcjQ3Nzc4MDM=","avatar_url":"https://avatars.githubusercontent.com/u/4777803?v=4","gravatar_id":"","url":"https://api.github.com/users/trbutler","html_url":"https://github.com/trbutler","followers_url":"https://api.github.com/users/trbutler/followers","following_url":"https://api.github.com/users/trbutler/following{/other_user}","gists_url":"https://api.github.com/users/trbutler/gists{/gist_id}","starred_url":"https://api.github.com/users/trbutler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trbutler/subscriptions","organizations_url":"https://api.github.com/users/trbutler/orgs","repos_url":"https://api.github.com/users/trbutler/repos","events_url":"https://api.github.com/users/trbutler/events{/privacy}","received_events_url":"https://api.github.com/users/trbutler/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-09-10T16:02:08Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/1246101059","html_url":"https://github.com/ProGamerGov/neural-style-pt/issues/96#issuecomment-1246101059","issue_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/96","id":1246101059,"node_id":"IC_kwDOCHwEic5KRf5D","user":{"login":"trbutler","id":4777803,"node_id":"MDQ6VXNlcjQ3Nzc4MDM=","avatar_url":"https://avatars.githubusercontent.com/u/4777803?v=4","gravatar_id":"","url":"https://api.github.com/users/trbutler","html_url":"https://github.com/trbutler","followers_url":"https://api.github.com/users/trbutler/followers","following_url":"https://api.github.com/users/trbutler/following{/other_user}","gists_url":"https://api.github.com/users/trbutler/gists{/gist_id}","starred_url":"https://api.github.com/users/trbutler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trbutler/subscriptions","organizations_url":"https://api.github.com/users/trbutler/orgs","repos_url":"https://api.github.com/users/trbutler/repos","events_url":"https://api.github.com/users/trbutler/events{/privacy}","received_events_url":"https://api.github.com/users/trbutler/received_events","type":"User","site_admin":false},"created_at":"2022-09-14T00:56:02Z","updated_at":"2022-09-14T01:01:10Z","author_association":"NONE","body":"@ProGamerGov Thanks! I just tried it and it doesn't seem to be paying attention to my request to switch backends. For example upon typing:\r\n\r\n`python neural_style.py -style_image /Users/timothybutler/Downloads/f24.jpg  -content_image /Users/timothybutler/Downloads/SCAN22122008_00000.tif -backend mps`\r\n\r\nIt starts and then gives the same error:\r\n\r\n> Traceback (most recent call last):\r\n>   File \"/Users/timothybutler/Experiments/neural-style-pt/neural_style.py\", line 500, in <module>\r\n>     main()\r\n>   File \"/Users/timothybutler/Experiments/neural-style-pt/neural_style.py\", line 62, in main\r\n>     content_image = preprocess(params.content_image, params.image_size).to(backward_device)\r\n>   File \"/Users/timothybutler/Experiments/miniconda3/envs/ldm/lib/python3.10/site-packages/torch/cuda/__init__.py\", line 211, in _lazy_init\r\n>     raise AssertionError(\"Torch not compiled with CUDA enabled\")\r\n> AssertionError: Torch not compiled with CUDA enabled\r\n\r\nPerhaps the backend isn't getting passed along?","reactions":{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/1246101059/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"trbutler","id":4777803,"node_id":"MDQ6VXNlcjQ3Nzc4MDM=","avatar_url":"https://avatars.githubusercontent.com/u/4777803?v=4","gravatar_id":"","url":"https://api.github.com/users/trbutler","html_url":"https://github.com/trbutler","followers_url":"https://api.github.com/users/trbutler/followers","following_url":"https://api.github.com/users/trbutler/following{/other_user}","gists_url":"https://api.github.com/users/trbutler/gists{/gist_id}","starred_url":"https://api.github.com/users/trbutler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trbutler/subscriptions","organizations_url":"https://api.github.com/users/trbutler/orgs","repos_url":"https://api.github.com/users/trbutler/repos","events_url":"https://api.github.com/users/trbutler/events{/privacy}","received_events_url":"https://api.github.com/users/trbutler/received_events","type":"User","site_admin":false}},{"id":7381081982,"node_id":"MEE_lADOCHwEic5RW2ImzwAAAAG38l9-","url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/events/7381081982","actor":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-09-14T00:56:02Z","performed_via_github_app":null},{"id":7381081985,"node_id":"SE_lADOCHwEic5RW2ImzwAAAAG38l-B","url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/events/7381081985","actor":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-09-14T00:56:02Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/1246106424","html_url":"https://github.com/ProGamerGov/neural-style-pt/issues/96#issuecomment-1246106424","issue_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/96","id":1246106424,"node_id":"IC_kwDOCHwEic5KRhM4","user":{"login":"trbutler","id":4777803,"node_id":"MDQ6VXNlcjQ3Nzc4MDM=","avatar_url":"https://avatars.githubusercontent.com/u/4777803?v=4","gravatar_id":"","url":"https://api.github.com/users/trbutler","html_url":"https://github.com/trbutler","followers_url":"https://api.github.com/users/trbutler/followers","following_url":"https://api.github.com/users/trbutler/following{/other_user}","gists_url":"https://api.github.com/users/trbutler/gists{/gist_id}","starred_url":"https://api.github.com/users/trbutler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trbutler/subscriptions","organizations_url":"https://api.github.com/users/trbutler/orgs","repos_url":"https://api.github.com/users/trbutler/repos","events_url":"https://api.github.com/users/trbutler/events{/privacy}","received_events_url":"https://api.github.com/users/trbutler/received_events","type":"User","site_admin":false},"created_at":"2022-09-14T01:05:39Z","updated_at":"2022-09-14T01:05:39Z","author_association":"NONE","body":"@ProGamerGov I just realized if I set both `-backend` _and_ `-gpu` to `mps` it does seem to work. Should setting `backend` to mps set `gpu` to the same in `setup_gpu` if nothing is specified in the `gpu` parameter? \r\n\r\nCurrently running `neural_style` on an image to see what happens, but it does show 97% GPU usage from the python process in MacOS's Activity Monitor.","reactions":{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/1246106424/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"trbutler","id":4777803,"node_id":"MDQ6VXNlcjQ3Nzc4MDM=","avatar_url":"https://avatars.githubusercontent.com/u/4777803?v=4","gravatar_id":"","url":"https://api.github.com/users/trbutler","html_url":"https://github.com/trbutler","followers_url":"https://api.github.com/users/trbutler/followers","following_url":"https://api.github.com/users/trbutler/following{/other_user}","gists_url":"https://api.github.com/users/trbutler/gists{/gist_id}","starred_url":"https://api.github.com/users/trbutler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trbutler/subscriptions","organizations_url":"https://api.github.com/users/trbutler/orgs","repos_url":"https://api.github.com/users/trbutler/repos","events_url":"https://api.github.com/users/trbutler/events{/privacy}","received_events_url":"https://api.github.com/users/trbutler/received_events","type":"User","site_admin":false}},{"id":7381113221,"node_id":"MEE_lADOCHwEic5RW2ImzwAAAAG38tmF","url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/events/7381113221","actor":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-09-14T01:05:39Z","performed_via_github_app":null},{"id":7381113224,"node_id":"SE_lADOCHwEic5RW2ImzwAAAAG38tmI","url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/events/7381113224","actor":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-09-14T01:05:39Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/1246116202","html_url":"https://github.com/ProGamerGov/neural-style-pt/issues/96#issuecomment-1246116202","issue_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/96","id":1246116202,"node_id":"IC_kwDOCHwEic5KRjlq","user":{"login":"trbutler","id":4777803,"node_id":"MDQ6VXNlcjQ3Nzc4MDM=","avatar_url":"https://avatars.githubusercontent.com/u/4777803?v=4","gravatar_id":"","url":"https://api.github.com/users/trbutler","html_url":"https://github.com/trbutler","followers_url":"https://api.github.com/users/trbutler/followers","following_url":"https://api.github.com/users/trbutler/following{/other_user}","gists_url":"https://api.github.com/users/trbutler/gists{/gist_id}","starred_url":"https://api.github.com/users/trbutler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trbutler/subscriptions","organizations_url":"https://api.github.com/users/trbutler/orgs","repos_url":"https://api.github.com/users/trbutler/repos","events_url":"https://api.github.com/users/trbutler/events{/privacy}","received_events_url":"https://api.github.com/users/trbutler/received_events","type":"User","site_admin":false},"created_at":"2022-09-14T01:24:49Z","updated_at":"2022-09-14T01:24:49Z","author_association":"NONE","body":"Results using mps vs. cpu: \r\n\r\n> python neural_style.py -style_image /Users/timothybutler/Downloads/f24.jpg     77.40s user 81.96s system 45% cpu 5:52.32 total\r\n> python neural_style.py -style_image /Users/timothybutler/Downloads/f24.jpg     856.05s user 451.82s system 261% cpu 8:20.04 total\r\n\r\nI couldn't get `-gpu mps,cpu` to work -- I thought I'd try that out of curiosity, too, but that reports that `AssertionError: The number of -multidevice_strategy layer indices minus 1, must be equal to the number of -gpu devices.`","reactions":{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/1246116202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"trbutler","id":4777803,"node_id":"MDQ6VXNlcjQ3Nzc4MDM=","avatar_url":"https://avatars.githubusercontent.com/u/4777803?v=4","gravatar_id":"","url":"https://api.github.com/users/trbutler","html_url":"https://github.com/trbutler","followers_url":"https://api.github.com/users/trbutler/followers","following_url":"https://api.github.com/users/trbutler/following{/other_user}","gists_url":"https://api.github.com/users/trbutler/gists{/gist_id}","starred_url":"https://api.github.com/users/trbutler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trbutler/subscriptions","organizations_url":"https://api.github.com/users/trbutler/orgs","repos_url":"https://api.github.com/users/trbutler/repos","events_url":"https://api.github.com/users/trbutler/events{/privacy}","received_events_url":"https://api.github.com/users/trbutler/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/1353863053","html_url":"https://github.com/ProGamerGov/neural-style-pt/issues/96#issuecomment-1353863053","issue_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/96","id":1353863053,"node_id":"IC_kwDOCHwEic5Qsk-N","user":{"login":"evanphilipsmith","id":12199891,"node_id":"MDQ6VXNlcjEyMTk5ODkx","avatar_url":"https://avatars.githubusercontent.com/u/12199891?v=4","gravatar_id":"","url":"https://api.github.com/users/evanphilipsmith","html_url":"https://github.com/evanphilipsmith","followers_url":"https://api.github.com/users/evanphilipsmith/followers","following_url":"https://api.github.com/users/evanphilipsmith/following{/other_user}","gists_url":"https://api.github.com/users/evanphilipsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/evanphilipsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/evanphilipsmith/subscriptions","organizations_url":"https://api.github.com/users/evanphilipsmith/orgs","repos_url":"https://api.github.com/users/evanphilipsmith/repos","events_url":"https://api.github.com/users/evanphilipsmith/events{/privacy}","received_events_url":"https://api.github.com/users/evanphilipsmith/received_events","type":"User","site_admin":false},"created_at":"2022-12-15T23:37:48Z","updated_at":"2022-12-15T23:37:48Z","author_association":"NONE","body":"> I couldn't get `-gpu mps,cpu` to work -- I thought I'd try that out of curiosity, too, but that reports that `AssertionError: The number of -multidevice_strategy layer indices minus 1, must be equal to the number of -gpu devices.`\r\n\r\nI think this this because the default for `-multidevice_strategy` is `4,7,29`, which implies you are using 4 devices. If using `-gpu mps,cpu`, try using a setting `-multidevice_strategy` to a single number (like `7` for example).\r\n\r\n---\r\n\r\nHowever, this leads to another error\r\n```\r\nRuntimeError: Invalid device string: 'cuda:mps'\r\n```\r\nBut this can be easily resolved by modifying these lines...\r\nhttps://github.com/ProGamerGov/neural-style-pt/blob/639fa264f74cdb061dd4beee480b7f9126ab3f05/CaffeLoader.py#L113-L120\r\n...to the following:\r\n```python\r\n    def name_devices(self, input_list):\r\n        device_list = []\r\n        for i, device in enumerate(input_list):\r\n            if str(device).lower() not in (\"cpu\", \"mps\"):\r\n                device_list.append(\"cuda:\" + str(device))\r\n            else:\r\n                device_list.append(device)\r\n        return device_list\r\n```","reactions":{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/1353863053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"evanphilipsmith","id":12199891,"node_id":"MDQ6VXNlcjEyMTk5ODkx","avatar_url":"https://avatars.githubusercontent.com/u/12199891?v=4","gravatar_id":"","url":"https://api.github.com/users/evanphilipsmith","html_url":"https://github.com/evanphilipsmith","followers_url":"https://api.github.com/users/evanphilipsmith/followers","following_url":"https://api.github.com/users/evanphilipsmith/following{/other_user}","gists_url":"https://api.github.com/users/evanphilipsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/evanphilipsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/evanphilipsmith/subscriptions","organizations_url":"https://api.github.com/users/evanphilipsmith/orgs","repos_url":"https://api.github.com/users/evanphilipsmith/repos","events_url":"https://api.github.com/users/evanphilipsmith/events{/privacy}","received_events_url":"https://api.github.com/users/evanphilipsmith/received_events","type":"User","site_admin":false}}]