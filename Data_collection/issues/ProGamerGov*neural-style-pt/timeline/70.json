[{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/624329343","html_url":"https://github.com/ProGamerGov/neural-style-pt/issues/70#issuecomment-624329343","issue_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/70","id":624329343,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDMyOTM0Mw==","user":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false},"created_at":"2020-05-05T22:00:12Z","updated_at":"2020-05-05T22:13:15Z","author_association":"OWNER","body":"First you should check if PyTorch sees your devices correctly and that CUDA works. Try running this in the Python interpreter and seeing what it shows:\r\n\r\n```\r\nimport torch\r\ntorch.__version__ # Get PyTorch and CUDA version\r\ntorch.cuda.is_available() # Check that CUDA works\r\ntorch.cuda.device_count() # Check how many CUDA capable devices you have\r\n\r\n# Print device human readable names\r\ntorch.cuda.get_device_name(0)\r\ntorch.cuda.get_device_name(1)\r\n# Add more lines with +1 like get_device_name(3), get_device_name(4) if you have more devices.\r\n```\r\n\r\nIf the devices exist and CUDA works, then it's probably just an issue with the ID you are using. CUDA can sometimes be a bit weird with how it sets GPU IDs: https://stackoverflow.com/questions/13781738/how-does-cuda-assign-device-ids-to-gpus\r\n\r\nYou fix the GPU device order by `CUDA_DEVICE_ORDER=PCI_BUS_ID` before the command:\r\n\r\n```\r\nCUDA_DEVICE_ORDER=PCI_BUS_ID python3 neural_style.py\r\n```\r\n\r\nYou can also use `CUDA_VISIBLE_DEVICES` before the command to make sure that PyTorch can only see the specified device:\r\n\r\n```\r\n# Only make GPU ID 1 visible to PyTorch\r\nCUDA_VISIBLE_DEVICES=1 python3 neural_style.py\r\n```","reactions":{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/624329343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/624339829","html_url":"https://github.com/ProGamerGov/neural-style-pt/issues/70#issuecomment-624339829","issue_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/70","id":624339829,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDMzOTgyOQ==","user":{"login":"gateway","id":519563,"node_id":"MDQ6VXNlcjUxOTU2Mw==","avatar_url":"https://avatars.githubusercontent.com/u/519563?v=4","gravatar_id":"","url":"https://api.github.com/users/gateway","html_url":"https://github.com/gateway","followers_url":"https://api.github.com/users/gateway/followers","following_url":"https://api.github.com/users/gateway/following{/other_user}","gists_url":"https://api.github.com/users/gateway/gists{/gist_id}","starred_url":"https://api.github.com/users/gateway/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gateway/subscriptions","organizations_url":"https://api.github.com/users/gateway/orgs","repos_url":"https://api.github.com/users/gateway/repos","events_url":"https://api.github.com/users/gateway/events{/privacy}","received_events_url":"https://api.github.com/users/gateway/received_events","type":"User","site_admin":false},"created_at":"2020-05-05T22:27:40Z","updated_at":"2020-05-05T22:27:40Z","author_association":"NONE","body":"ahh.. never knew that about PyTorch, it seems that the device id's compared to what nvidia-smi are swapped.\r\n\r\n```\r\n>>> torch.cuda.get_device_name(0)\r\n'GeForce GTX 1080'\r\n>>> torch.cuda.get_device_name(1)\r\n'GeForce GTX 1060 6GB'\r\n```\r\n\r\nhmm so in my case adding maybe this. CUDA_DEVICE_ORDER=0 python3 neural_style.py would be the 1060, and CUDA_DEVICE_ORDER=1 python3 neural_style.py should be the 1080? \r\n\r\nshould I make any changed to the GPU value in the script? Thanks for your timely response.. btw has anyone used your version of style transfer for video? ","reactions":{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/624339829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gateway","id":519563,"node_id":"MDQ6VXNlcjUxOTU2Mw==","avatar_url":"https://avatars.githubusercontent.com/u/519563?v=4","gravatar_id":"","url":"https://api.github.com/users/gateway","html_url":"https://github.com/gateway","followers_url":"https://api.github.com/users/gateway/followers","following_url":"https://api.github.com/users/gateway/following{/other_user}","gists_url":"https://api.github.com/users/gateway/gists{/gist_id}","starred_url":"https://api.github.com/users/gateway/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gateway/subscriptions","organizations_url":"https://api.github.com/users/gateway/orgs","repos_url":"https://api.github.com/users/gateway/repos","events_url":"https://api.github.com/users/gateway/events{/privacy}","received_events_url":"https://api.github.com/users/gateway/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/624378127","html_url":"https://github.com/ProGamerGov/neural-style-pt/issues/70#issuecomment-624378127","issue_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/70","id":624378127,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDM3ODEyNw==","user":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false},"created_at":"2020-05-06T00:27:44Z","updated_at":"2020-05-06T00:36:59Z","author_association":"OWNER","body":"The invalid device ordinal is error is normally given when you specify a non existent GPU ID.\r\n\r\nThe GPU value in the script should be set to the PyTorch GPU ID that you want to use as PyTorch shows the device you want to use as having an ID of `0`. The order and GPU values available to PyTorch will change based on the CUDA environment variables you specify.\r\n\r\n`CUDA_DEVICE_ORDER=PCI_BUS_ID` will swap the GPU order if the existing order is not based on the PCI Bus order. \r\n\r\n`CUDA_VISIBLE_DEVICES=1` will make GPU 0 in PyTorch be your second GPU. \r\n\r\n`CUDA_DEVICE_ORDER=PCI_BUS_ID CUDA_VISIBLE_DEVICES=1`  will only give PyTorch the second GPU device based on the PCI Bus order, but that second GPU will listed as GPU 0 so you'll need to use `-gpu 0`.\r\n\r\n\r\n> btw has anyone used your version of style transfer for video?\r\n\r\nYes, but those individuals tend to use techniques like rotoscoping to create video to avoid the flicking effect. I'm not knowledgeable enough yet to translate [artistic-videos](https://github.com/manuelruder/artistic-videos) to PyTorch. But it should easier for someone who better understands the video aspect of the code, as both artistic-videos and neural-style-pt are based on the same original code (neural-style). ","reactions":{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/624378127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/624382262","html_url":"https://github.com/ProGamerGov/neural-style-pt/issues/70#issuecomment-624382262","issue_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/70","id":624382262,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDM4MjI2Mg==","user":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false},"created_at":"2020-05-06T00:45:59Z","updated_at":"2020-05-06T00:47:16Z","author_association":"OWNER","body":"Basically this is what neural-style-pt does with GPU IDs (example with the Python Interpreter):\r\n\r\n```\r\nimport torch\r\na = torch.randn(3)\r\na.to('cpu') # Puts tensor 'a' on the CPU if it wasn't already\r\na.to('cuda:0') # Puts tensor 'a' on device 0\r\na.to('cuda:1') # Puts tensor 'a' on device 1\r\n```\r\n\r\nWhen I specify a valid GPU, I get something like this:\r\n\r\n```\r\n>>> a.to('cuda:0')\r\ntensor([ 0.8459, -0.2027,  0.6153], device='cuda:0')\r\n```\r\n\r\nAnd when I specify a GPU that doesn't exist on my computer, I get this:\r\n\r\n```\r\n>>> a.to('cuda:1')\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nRuntimeError: CUDA error: invalid device ordinal\r\n```","reactions":{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/comments/624382262/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ProGamerGov","id":10626398,"node_id":"MDQ6VXNlcjEwNjI2Mzk4","avatar_url":"https://avatars.githubusercontent.com/u/10626398?v=4","gravatar_id":"","url":"https://api.github.com/users/ProGamerGov","html_url":"https://github.com/ProGamerGov","followers_url":"https://api.github.com/users/ProGamerGov/followers","following_url":"https://api.github.com/users/ProGamerGov/following{/other_user}","gists_url":"https://api.github.com/users/ProGamerGov/gists{/gist_id}","starred_url":"https://api.github.com/users/ProGamerGov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ProGamerGov/subscriptions","organizations_url":"https://api.github.com/users/ProGamerGov/orgs","repos_url":"https://api.github.com/users/ProGamerGov/repos","events_url":"https://api.github.com/users/ProGamerGov/events{/privacy}","received_events_url":"https://api.github.com/users/ProGamerGov/received_events","type":"User","site_admin":false}}]