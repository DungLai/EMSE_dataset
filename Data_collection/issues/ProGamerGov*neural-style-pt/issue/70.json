{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/70","repository_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt","labels_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/70/labels{/name}","comments_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/70/comments","events_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/70/events","html_url":"https://github.com/ProGamerGov/neural-style-pt/issues/70","id":612909960,"node_id":"MDU6SXNzdWU2MTI5MDk5NjA=","number":70,"title":"RuntimeError: CUDA error: invalid device ordinal with starry_stanford.sh","user":{"login":"gateway","id":519563,"node_id":"MDQ6VXNlcjUxOTU2Mw==","avatar_url":"https://avatars.githubusercontent.com/u/519563?v=4","gravatar_id":"","url":"https://api.github.com/users/gateway","html_url":"https://github.com/gateway","followers_url":"https://api.github.com/users/gateway/followers","following_url":"https://api.github.com/users/gateway/following{/other_user}","gists_url":"https://api.github.com/users/gateway/gists{/gist_id}","starred_url":"https://api.github.com/users/gateway/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gateway/subscriptions","organizations_url":"https://api.github.com/users/gateway/orgs","repos_url":"https://api.github.com/users/gateway/repos","events_url":"https://api.github.com/users/gateway/events{/privacy}","received_events_url":"https://api.github.com/users/gateway/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-05-05T21:35:48Z","updated_at":"2020-05-06T00:47:16Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi, I'm trying to run the script above to see if my system can handle and create larger images based upon your script.\r\n\r\nI added -optimizer adam and using the NIN model for lower memory gpus.\r\n\r\nHere is my output that fails eventually...\r\n\r\n```\r\nRuntimeError: CUDA error: invalid device ordinal\r\nNIN Architecture Detected\r\nSuccessfully loaded models/nin_imagenet.pth\r\nconv1: 96 3 11 11\r\ncccp1: 96 96 1 1\r\ncccp2: 96 96 1 1\r\nconv2: 256 96 5 5\r\ncccp3: 256 256 1 1\r\ncccp4: 256 256 1 1\r\nconv3: 384 256 3 3\r\ncccp5: 384 384 1 1\r\ncccp6: 384 384 1 1\r\nconv4-1024: 1024 384 3 3\r\ncccp7-1024: 1024 1024 1 1\r\ncccp8-1024: 1000 1024 1 1\r\nTraceback (most recent call last):\r\n  File \"/home/gateway/work/neural-style-software/neural-style-pt/neural_style.py\", line 468, in <module>\r\n    main()\r\n  File \"/home/gateway/work/neural-style-software/neural-style-pt/neural_style.py\", line 157, in main\r\n    net = setup_multi_device(net)\r\n  File \"/home/gateway/work/neural-style-software/neural-style-pt/neural_style.py\", line 328, in setup_multi_device\r\n    new_net = ModelParallel(net, params.gpu, params.multidevice_strategy)\r\n  File \"/home/gateway/work/neural-style-software/neural-style-pt/CaffeLoader.py\", line 110, in __init__\r\n    self.chunks = self.chunks_to_devices(self.split_net(net, device_splits.split(',')))\r\n  File \"/home/gateway/work/neural-style-software/neural-style-pt/CaffeLoader.py\", line 134, in chunks_to_devices\r\n    chunk.to(self.device_list[i])\r\n  File \"/home/gateway/anaconda3/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 426, in to\r\n    return self._apply(convert)\r\n  File \"/home/gateway/anaconda3/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 202, in _apply\r\n    module._apply(fn)\r\n  File \"/home/gateway/anaconda3/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 224, in _apply\r\n    param_applied = fn(param)\r\n  File \"/home/gateway/anaconda3/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 424, in convert\r\n    return t.to(device, dtype if t.is_floating_point() else None, non_blocking)\r\nRuntimeError: CUDA error: invalid device ordinal\r\n```\r\nhttps://github.com/ProGamerGov/neural-style-pt/blob/master/examples/scripts/starry_stanford.sh\r\n\r\nNvidia info\r\n\r\nbtw I'm using GPU 1 since it has the most memory and not using the primary display..\r\n\r\n```\r\n(base) gateway@gateway-media:~/work/neural-style-software/neural-style-pt$ nvidia-smi\r\nTue May  5 14:34:21 2020       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 440.82       Driver Version: 440.82       CUDA Version: 10.2     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 106...  Off  | 00000000:01:00.0 Off |                  N/A |\r\n|  0%   54C    P8     4W / 120W |    195MiB /  6078MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   1  GeForce GTX 1080    Off  | 00000000:02:00.0 Off |                  N/A |\r\n| 21%   56C    P8     6W / 180W |      2MiB /  8119MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|    0      2161      G   /usr/lib/xorg/Xorg                           101MiB |\r\n|    0      2661      G                                                 11MiB |\r\n|    0      2856      G   /usr/bin/gnome-shell                          77MiB |\r\n+-----------------------------------------------------------------------------+\r\n(base) gateway@gateway-media:~/work/neural-style-software/neural-style-pt$ \r\n```\r\n\r\nthoughts?","closed_by":null,"reactions":{"url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/70/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ProGamerGov/neural-style-pt/issues/70/timeline","performed_via_github_app":null,"state_reason":null}