{"url":"https://api.github.com/repos/qubvel/efficientnet/issues/101","repository_url":"https://api.github.com/repos/qubvel/efficientnet","labels_url":"https://api.github.com/repos/qubvel/efficientnet/issues/101/labels{/name}","comments_url":"https://api.github.com/repos/qubvel/efficientnet/issues/101/comments","events_url":"https://api.github.com/repos/qubvel/efficientnet/issues/101/events","html_url":"https://github.com/qubvel/efficientnet/issues/101","id":572150459,"node_id":"MDU6SXNzdWU1NzIxNTA0NTk=","number":101,"title":" Model not learning after upgrade to tensorflow 2 and version 1.0.0","user":{"login":"digital-thinking","id":7263915,"node_id":"MDQ6VXNlcjcyNjM5MTU=","avatar_url":"https://avatars.githubusercontent.com/u/7263915?v=4","gravatar_id":"","url":"https://api.github.com/users/digital-thinking","html_url":"https://github.com/digital-thinking","followers_url":"https://api.github.com/users/digital-thinking/followers","following_url":"https://api.github.com/users/digital-thinking/following{/other_user}","gists_url":"https://api.github.com/users/digital-thinking/gists{/gist_id}","starred_url":"https://api.github.com/users/digital-thinking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/digital-thinking/subscriptions","organizations_url":"https://api.github.com/users/digital-thinking/orgs","repos_url":"https://api.github.com/users/digital-thinking/repos","events_url":"https://api.github.com/users/digital-thinking/events{/privacy}","received_events_url":"https://api.github.com/users/digital-thinking/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2020-02-27T15:17:52Z","updated_at":"2020-04-26T11:34:58Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I have just upgraded from TensorFlow 1 with efficientnet 0.0.4 to the TensorFlow 2 version of the model. The model looks identical (besides the names of the tensors), params are equal, training data is equal.\r\nHowever, with TensorFlow 2.0 the model does not learn anymore. I have tried TensorFlow 2.0 with CUDA 10.0 and TensorFlow 2.1 with CUDA 10.1 both with the same results. I wonder if anyone else has also noticed issues like that. With TF1 and the 0.0.4 model everything works fine. Also the training is slower than before. (RTX 2080Ti)\r\n\r\nTF2(efficientnet 1.0.0)\r\n```\r\nfrom efficientnet.tfkeras import EfficientNetB5\r\nbase_model = EfficientNetB5(weights='imagenet', include_top=False)\r\nx = base_model.output\r\nx = tf.keras.layers.GlobalAveragePooling2D()(x)\r\nx = tf.keras.layers.Dense(len(class_weights), activation='softmax')(x)\r\nmodel = tf.keras.models.Model(inputs=base_model.get_input_at(0), outputs=x)\r\nmodel.compile(optimizer=tf.keras.optimizers.Adam(lr=0.01), loss='categorical_crossentropy',  metrics=['accuracy'])\r\n\r\n```\r\n\r\nTF1(efficientnet 0.0.4): \r\n```\r\nfrom efficientnet import EfficientNetB5\r\nbase_model = EfficientNetB5(include_top=False)\r\nx = base_model.output\r\nx = GlobalAveragePooling2D()(x)\r\nx = Dense(len(class_weights), activation='softmax')(x)\r\nmodel = Model(inputs=base_model.get_input_at(0), outputs=x)\r\nmodel.compile(optimizer=optimizers.Adam(lr=0.01), loss='categorical_crossentropy',  metrics=['accuracy'])\r\n```\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/qubvel/efficientnet/issues/101/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/qubvel/efficientnet/issues/101/timeline","performed_via_github_app":null,"state_reason":null}