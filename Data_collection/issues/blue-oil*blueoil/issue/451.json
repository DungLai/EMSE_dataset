{"url":"https://api.github.com/repos/blue-oil/blueoil/issues/451","repository_url":"https://api.github.com/repos/blue-oil/blueoil","labels_url":"https://api.github.com/repos/blue-oil/blueoil/issues/451/labels{/name}","comments_url":"https://api.github.com/repos/blue-oil/blueoil/issues/451/comments","events_url":"https://api.github.com/repos/blue-oil/blueoil/issues/451/events","html_url":"https://github.com/blue-oil/blueoil/issues/451","id":496261627,"node_id":"MDU6SXNzdWU0OTYyNjE2Mjc=","number":451,"title":"Test failed on a server which has no dataset in specific directory","user":{"login":"suttang","id":40326,"node_id":"MDQ6VXNlcjQwMzI2","avatar_url":"https://avatars.githubusercontent.com/u/40326?v=4","gravatar_id":"","url":"https://api.github.com/users/suttang","html_url":"https://github.com/suttang","followers_url":"https://api.github.com/users/suttang/followers","following_url":"https://api.github.com/users/suttang/following{/other_user}","gists_url":"https://api.github.com/users/suttang/gists{/gist_id}","starred_url":"https://api.github.com/users/suttang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/suttang/subscriptions","organizations_url":"https://api.github.com/users/suttang/orgs","repos_url":"https://api.github.com/users/suttang/repos","events_url":"https://api.github.com/users/suttang/events{/privacy}","received_events_url":"https://api.github.com/users/suttang/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":{"login":"ruimashita","id":138891,"node_id":"MDQ6VXNlcjEzODg5MQ==","avatar_url":"https://avatars.githubusercontent.com/u/138891?v=4","gravatar_id":"","url":"https://api.github.com/users/ruimashita","html_url":"https://github.com/ruimashita","followers_url":"https://api.github.com/users/ruimashita/followers","following_url":"https://api.github.com/users/ruimashita/following{/other_user}","gists_url":"https://api.github.com/users/ruimashita/gists{/gist_id}","starred_url":"https://api.github.com/users/ruimashita/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ruimashita/subscriptions","organizations_url":"https://api.github.com/users/ruimashita/orgs","repos_url":"https://api.github.com/users/ruimashita/repos","events_url":"https://api.github.com/users/ruimashita/events{/privacy}","received_events_url":"https://api.github.com/users/ruimashita/received_events","type":"User","site_admin":false},"assignees":[{"login":"ruimashita","id":138891,"node_id":"MDQ6VXNlcjEzODg5MQ==","avatar_url":"https://avatars.githubusercontent.com/u/138891?v=4","gravatar_id":"","url":"https://api.github.com/users/ruimashita","html_url":"https://github.com/ruimashita","followers_url":"https://api.github.com/users/ruimashita/followers","following_url":"https://api.github.com/users/ruimashita/following{/other_user}","gists_url":"https://api.github.com/users/ruimashita/gists{/gist_id}","starred_url":"https://api.github.com/users/ruimashita/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ruimashita/subscriptions","organizations_url":"https://api.github.com/users/ruimashita/orgs","repos_url":"https://api.github.com/users/ruimashita/repos","events_url":"https://api.github.com/users/ruimashita/events{/privacy}","received_events_url":"https://api.github.com/users/ruimashita/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2019-09-20T09:58:45Z","updated_at":"2019-09-20T13:21:54Z","closed_at":"2019-09-20T13:21:54Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**System information**\r\n\r\n* Blueoil version: [master](https://github.com/blue-oil/blueoil/tree/a7be11110ae290bc8bea8b9111d5fc5203648ac5)\r\n* Environment: lmsvr23\r\n\r\n**Describe the problem**\r\n\r\nIf you run `$ make test-lmnet` on a server which has no dataset in `/storage/dataset` like lmsvr23, the test will fail.\r\n\r\n**How to reproduce**\r\n\r\n```\r\n# Connect to server and run command below\r\n$ cd your-own-bluoil-directory\r\n$ make test-lmnet\r\n```\r\n\r\n**Error log**\r\n\r\n```\r\ndocker run --runtime=nvidia -v /storage/dataset:/storage/dataset -e CUDA_VISIBLE_DEVICES= -e DATA_DIR=/storage/dataset --rm blueoil_$(id -un):v0.11.0-12-g098b780 /bin/bash -c \"cd lmnet; tox -e py36-check_dataset_storage\"\r\npy36-check_dataset_storage create: /home/blueoil/lmnet/.tox/py36-check_dataset_storage\r\npy36-check_dataset_storage installdeps: -r/home/blueoil/lmnet/gpu.requirements.txt\r\nWARNING:Discarding $PYTHONPATH from environment, to override specify PYTHONPATH in 'passenv' in your configuration.\r\npy36-check_dataset_storage installed: absl-py==0.8.0,alabaster==0.7.12,argh==0.26.2,astor==0.8.0,attrs==19.1.0,Babel==2.7.0,backcall==0.1.0,better-apidoc==0.1.2,certifi==2019.9.11,chardet==3.0.4,click==6.7,colorama==0.4.1,cycler==0.10.0,DataProperty==0.43.1,decorator==4.4.0,dill==0.3.0,docutils==0.15.2,dominate==2.4.0,easydict==1.6,filelock==3.0.12,flake8==3.5.0,flatbuffers==1.11,funcsigs==1.0.2,future==0.17.1,gast==0.3.2,google-pasta==0.1.7,googleapis-common-protos==1.6.0,grpcio==1.23.0,h5py==2.10.0,hyperopt==0.1.2,idna==2.8,imagesize==1.1.0,importlib-metadata==0.23,ipdb==0.10.2,ipython==7.8.0,ipython-genutils==0.2.0,jedi==0.15.1,Jinja2==2.10.1,Keras-Applications==1.0.8,Keras-Preprocessing==1.1.0,kiwisolver==1.1.0,livereload==2.6.1,Logbook==1.5.2,Markdown==3.1.1,MarkupSafe==1.1.1,matplotlib==2.2.2,mbstrdecoder==0.8.1,mccabe==0.6.1,more-itertools==7.2.0,msgfy==0.0.7,networkx==2.3,numpy==1.15.0,packaging==19.2,pandas==0.19.2,parso==0.5.1,pathtools==0.1.2,pathvalidate==0.29.0,pexpect==4.7.0,pickleshare==0.7.5,Pillow==6.0.0,pluggy==0.13.0,port-for==0.3.1,promise==2.2.1,prompt-toolkit==2.0.9,protobuf==3.9.1,psutil==5.6.1,ptyprocess==0.6.0,py==1.8.0,pycocotools==2.0,pycodestyle==2.3.1,pyflakes==1.6.0,Pygments==2.4.2,pymongo==3.9.0,pyparsing==2.4.2,pytablewriter==0.35.0,pytest==3.3.2,python-dateutil==2.8.0,pytz==2019.2,PyYAML==4.2b4,ray==0.6.4,redis==3.3.8,requests==2.22.0,scipy==1.3.1,setproctitle==1.1.10,six==1.12.0,snowballstemmer==1.9.1,Sphinx==1.7.2,sphinx-autobuild==0.7.1,sphinx-rtd-theme==0.2.4,sphinxcontrib-websupport==1.1.2,tabledata==0.9.1,tensorboard==1.14.0,tensorflow-datasets==1.0.2,tensorflow-estimator==1.14.0,tensorflow-gpu==1.14.0,tensorflow-metadata==0.14.0,termcolor==1.1.0,tornado==6.0.3,tox==2.9.1,tqdm==4.36.1,traitlets==4.3.2,typepy==0.6.0,typing==3.7.4.1,urllib3==1.25.5,virtualenv==16.7.5,watchdog==0.9.0,wcwidth==0.1.7,Werkzeug==0.16.0,wrapt==1.11.2,zipp==0.6.0\r\npy36-check_dataset_storage runtests: PYTHONHASHSEED='1170988246'\r\npy36-check_dataset_storage runtests: commands[0] | pytest tests/check_dataset_storage.py\r\n============================= test session starts ==============================\r\nplatform linux -- Python 3.6.3, pytest-3.3.2, py-1.8.0, pluggy-0.13.0\r\nrootdir: /home/blueoil, inifile:\r\ncollected 17 items\r\n\r\ntests/check_dataset_storage.py ...............FF                         [100%]\r\n\r\n=================================== FAILURES ===================================\r\n________________________________ test_widerface ________________________________\r\n\r\n    def test_widerface():\r\n        batch_size = 3\r\n        image_size = [160, 160]\r\n    \r\n        num_max_boxes = 3\r\n    \r\n        num_train = 7250\r\n        num_val = 1758\r\n    \r\n        dataset = WiderFace(batch_size=batch_size,\r\n                            max_boxes=num_max_boxes,\r\n>                           pre_processor=ResizeWithGtBoxes(image_size))\r\n\r\ntests/check_dataset_storage.py:800: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\nlmnet/datasets/widerface.py:78: in __init__\r\n    self._init_files_and_annotations()\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nself = <lmnet.datasets.widerface.WiderFace object at 0x7f439f8cba20>\r\n\r\n    def _init_files_and_annotations(self):\r\n    \r\n        base_dir = os.path.join(self.data_dir, \"wider_face_split\")\r\n    \r\n        if self.subset == \"train\":\r\n            file_name = os.path.join(base_dir, \"wider_face_train_bbx_gt.txt\")\r\n    \r\n        if self.subset == \"validation\":\r\n            file_name = os.path.join(base_dir, \"wider_face_val_bbx_gt.txt\")\r\n    \r\n        paths = []\r\n        bboxs = []\r\n        labels = []\r\n    \r\n>       with open(file_name) as f:\r\nE       FileNotFoundError: [Errno 2] No such file or directory: '/storage/dataset/WIDER_FACE/wider_face_split/wider_face_train_bbx_gt.txt'\r\n\r\nlmnet/datasets/widerface.py:94: FileNotFoundError\r\n_________________________________ test_bdd100k _________________________________\r\n\r\n    def test_bdd100k():\r\n        batch_size = 3\r\n        image_size = [320, 320]\r\n    \r\n        num_max_boxes = 100\r\n    \r\n        num_train = 70000\r\n        num_val = 10000\r\n    \r\n        dataset = BDD100K(batch_size=batch_size,\r\n                          max_boxes=num_max_boxes,\r\n                          pre_processor=ResizeWithGtBoxes(image_size))\r\n        dataset = DatasetIterator(dataset)\r\n    \r\n        assert dataset.num_max_boxes == num_max_boxes\r\n>       assert dataset.num_per_epoch == num_train\r\nE       assert 0 == 70000\r\nE        +  where 0 = <lmnet.datasets.dataset_iterator.DatasetIterator object at 0x7f43bfdbf2b0>.num_per_epoch\r\n\r\ntests/check_dataset_storage.py:856: AssertionError\r\n----------------------------- Captured stdout call -----------------------------\r\nDISABLE prefetch\r\n==================== 2 failed, 15 passed in 159.99 seconds =====================\r\nERROR: InvocationError: '/home/blueoil/lmnet/.tox/py36-check_dataset_storage/bin/pytest tests/check_dataset_storage.py'\r\n___________________________________ summary ____________________________________\r\nERROR:   py36-check_dataset_storage: commands failed\r\nMakefile:50: recipe for target 'test-lmnet-check-dataset-storage' failed\r\nmake: *** [test-lmnet-check-dataset-storage] Error 1\r\n```","closed_by":{"login":"tkng","id":96674,"node_id":"MDQ6VXNlcjk2Njc0","avatar_url":"https://avatars.githubusercontent.com/u/96674?v=4","gravatar_id":"","url":"https://api.github.com/users/tkng","html_url":"https://github.com/tkng","followers_url":"https://api.github.com/users/tkng/followers","following_url":"https://api.github.com/users/tkng/following{/other_user}","gists_url":"https://api.github.com/users/tkng/gists{/gist_id}","starred_url":"https://api.github.com/users/tkng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tkng/subscriptions","organizations_url":"https://api.github.com/users/tkng/orgs","repos_url":"https://api.github.com/users/tkng/repos","events_url":"https://api.github.com/users/tkng/events{/privacy}","received_events_url":"https://api.github.com/users/tkng/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/blue-oil/blueoil/issues/451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/blue-oil/blueoil/issues/451/timeline","performed_via_github_app":null,"state_reason":"completed"}