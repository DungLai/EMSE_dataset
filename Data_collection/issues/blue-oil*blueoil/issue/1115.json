{"url":"https://api.github.com/repos/blue-oil/blueoil/issues/1115","repository_url":"https://api.github.com/repos/blue-oil/blueoil","labels_url":"https://api.github.com/repos/blue-oil/blueoil/issues/1115/labels{/name}","comments_url":"https://api.github.com/repos/blue-oil/blueoil/issues/1115/comments","events_url":"https://api.github.com/repos/blue-oil/blueoil/issues/1115/events","html_url":"https://github.com/blue-oil/blueoil/issues/1115","id":652025298,"node_id":"MDU6SXNzdWU2NTIwMjUyOTg=","number":1115,"title":"error could not find terminal under horovodrun training","user":{"login":"joelN123","id":32167300,"node_id":"MDQ6VXNlcjMyMTY3MzAw","avatar_url":"https://avatars.githubusercontent.com/u/32167300?v=4","gravatar_id":"","url":"https://api.github.com/users/joelN123","html_url":"https://github.com/joelN123","followers_url":"https://api.github.com/users/joelN123/followers","following_url":"https://api.github.com/users/joelN123/following{/other_user}","gists_url":"https://api.github.com/users/joelN123/gists{/gist_id}","starred_url":"https://api.github.com/users/joelN123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joelN123/subscriptions","organizations_url":"https://api.github.com/users/joelN123/orgs","repos_url":"https://api.github.com/users/joelN123/repos","events_url":"https://api.github.com/users/joelN123/events{/privacy}","received_events_url":"https://api.github.com/users/joelN123/received_events","type":"User","site_admin":false},"labels":[{"id":1095590109,"node_id":"MDU6TGFiZWwxMDk1NTkwMTA5","url":"https://api.github.com/repos/blue-oil/blueoil/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"open","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-07-07T05:54:19Z","updated_at":"2020-07-07T05:54:19Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"This occurs when using horovodrun, when running train command:\r\n```\r\ndocker run --runtime=nvidia -e CUDA_VISIBLE_DEVICES=\"0,1\" -v `pwd`:/home/blueoil -v <dataset dir>:/home/blueoil/dataset:ro --user=$(id -u):$(id -g) <docker image> horovodrun -np 2 python blueoil/cmd/main.py train -c blueoil/configs/core/classification/lmnet_quantize_cifar100.py -e testing123 --recreate\r\n```\r\ncauses error:\r\n```\r\n[1,0]<stderr>:Traceback (most recent call last):\r\n[1,0]<stderr>:  File \"blueoil/cmd/main.py\", line 23, in <module>\r\n[1,0]<stderr>:    from blueoil.cmd.init import ask_questions, save_config\r\n[1,0]<stderr>:  File \"/home/blueoil/blueoil/cmd/init.py\", line 21, in <module>\r\n[1,0]<stderr>:    import inquirer\r\n[1,0]<stderr>:  File \"/usr/local/pyenv/versions/python3.6/lib/python3.6/site-packages/inquirer/__init__.py\", line 6, in <module>\r\n[1,0]<stderr>:    from .prompt import prompt\r\n[1,0]<stderr>:  File \"/usr/local/pyenv/versions/python3.6/lib/python3.6/site-packages/inquirer/prompt.py\", line 3, in <module>\r\n[1,0]<stderr>:    from .render.console import ConsoleRender\r\n[1,0]<stderr>:  File \"/usr/local/pyenv/versions/python3.6/lib/python3.6/site-packages/inquirer/render/__init__.py\", line 2, in <module>\r\n[1,0]<stderr>:    from .console import ConsoleRender\r\n[1,0]<stderr>:  File \"/usr/local/pyenv/versions/python3.6/lib/python3.6/site-packages/inquirer/render/console/__init__.py\", line 9, in <module>\r\n[1,0]<stderr>:    from inquirer import themes\r\n[1,0]<stderr>:  File \"/usr/local/pyenv/versions/python3.6/lib/python3.6/site-packages/inquirer/themes.py\", line 9, in <module>\r\n[1,0]<stderr>:    term = Terminal()\r\n[1,0]<stderr>:  File \"/usr/local/pyenv/versions/python3.6/lib/python3.6/site-packages/blessings/__init__.py\", line 98, in __init__\r\n[1,0]<stderr>:    self._init_descriptor)\r\n[1,0]<stderr>:_curses.error: setupterm: could not find terminal\r\n```\r\n### workaround\r\nThere's a couple of workarounds that seem to be fine in the short term. So, this is maybe not a high priority issue.\r\n1. set the `TERM` environment variable `-e TERM=linux`\r\n2. open the docker container in interactive mode, and do `horovodrun` from inside that.\r\n\r\n### solution\r\nI'm not sure the best solution. I suppose one way is including the `TERM` environment variable to the [dockerfile](https://github.com/blue-oil/blueoil/blob/51d7ad144d6ecf951f7555c1c4be9d4a13e6a447/docker/Dockerfile), to be used as standard. However, it's strange, when running Blueoil train without the `horovodrun`, and printing out the environment variables using `os.environ`, you can see that `TERM` is not included. So, it seems ultimately not necessary. Somehow the `inquirer` module gets this error under the `horovodrun` process, but not under the plain `python` process.","closed_by":null,"reactions":{"url":"https://api.github.com/repos/blue-oil/blueoil/issues/1115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/blue-oil/blueoil/issues/1115/timeline","performed_via_github_app":null,"state_reason":null}