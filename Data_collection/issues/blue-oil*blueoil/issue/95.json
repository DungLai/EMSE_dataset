{"url":"https://api.github.com/repos/blue-oil/blueoil/issues/95","repository_url":"https://api.github.com/repos/blue-oil/blueoil","labels_url":"https://api.github.com/repos/blue-oil/blueoil/issues/95/labels{/name}","comments_url":"https://api.github.com/repos/blue-oil/blueoil/issues/95/comments","events_url":"https://api.github.com/repos/blue-oil/blueoil/issues/95/events","html_url":"https://github.com/blue-oil/blueoil/issues/95","id":397212483,"node_id":"MDU6SXNzdWUzOTcyMTI0ODM=","number":95,"title":"ARM binary bug(?)","user":{"login":"lm-konda","id":43975451,"node_id":"MDQ6VXNlcjQzOTc1NDUx","avatar_url":"https://avatars.githubusercontent.com/u/43975451?v=4","gravatar_id":"","url":"https://api.github.com/users/lm-konda","html_url":"https://github.com/lm-konda","followers_url":"https://api.github.com/users/lm-konda/followers","following_url":"https://api.github.com/users/lm-konda/following{/other_user}","gists_url":"https://api.github.com/users/lm-konda/gists{/gist_id}","starred_url":"https://api.github.com/users/lm-konda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lm-konda/subscriptions","organizations_url":"https://api.github.com/users/lm-konda/orgs","repos_url":"https://api.github.com/users/lm-konda/repos","events_url":"https://api.github.com/users/lm-konda/events{/privacy}","received_events_url":"https://api.github.com/users/lm-konda/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-01-09T04:59:57Z","updated_at":"2019-01-09T18:54:30Z","closed_at":"2019-01-09T18:54:15Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Original GCC binary is probably buggy.\r\nThese\r\n```\r\npack_input_to_qwords\r\nquantized-kn2row\r\nquantized_matrix_multiplication\r\nquantized_ohwi_to_hwoi\r\n```\r\nare missing.\r\n\r\nexecution time\r\nbefore (GCC)\r\n```\r\nroot@DE10_NANO:~# ./lm_arm.elf input.npy output.npy \r\n-------------------------------------------------------------\r\nComparison: Default network test  succeeded!!!\r\n-------------------------------------------------------------\r\nApplyThresholds,129743,60370,18041,8221,  sum:216.375ms\r\nAveragePool,88,  sum:0.088ms\r\nBatchNorm,5259,133,  sum:5.392ms\r\nConvolution,160444,2118,  sum:162.562ms\r\nExtractImagePatches,3909,908,357,  sum:5.174ms\r\nQTZ_linear_mid_tread_half,6809,  sum:6.809ms\r\nQuantizedConv2D,6920,  sum:6.92ms\r\nQuantizedConv2D_ApplyScalingFactor,195,  sum:0.195ms\r\nReLu,164,  sum:0.164ms\r\nSoftMax,132,  sum:0.132ms\r\nTotalInitTime,38875,  sum:38.875ms\r\nTotalRunTime,727769,  sum:727.769ms\r\nkn2row,159046,  sum:159.046ms\r\nkn2row-1x1,2109,  sum:2.109ms\r\nkn2row-buf,4,  sum:0.004ms\r\nmatrix_multiplication,107636,2099,  sum:109.735ms\r\nmatrix_shift_add_f1,3533,  sum:3.533ms\r\nmatrix_shift_add_f2,47828,  sum:47.828ms\r\nmatrix_transpose (row_major),25,  sum:0.025ms\r\n```\r\nafter\r\n```\r\nroot@DE10_NANO:~# ./lm_arm.elf input.npy output.npy \r\n-------------------------------------------------------------\r\nComparison: Default network test  succeeded!!!\r\n-------------------------------------------------------------\r\nApplyThresholds,129287,59816,17804,8256,  sum:215.163ms\r\nAveragePool,201,  sum:0.201ms\r\nBatchNorm,6333,166,  sum:6.499ms\r\nConvolution,126709,2100,  sum:128.809ms\r\nExtractImagePatches,4275,884,352,  sum:5.511ms\r\nQTZ_linear_mid_tread_half,8011,  sum:8.011ms\r\nQuantizedConv2D,15747,  sum:15.747ms\r\nQuantizedConv2D_ApplyScalingFactor,317,  sum:0.317ms\r\nReLu,154,  sum:0.154ms\r\nSoftMax,16,  sum:0.016ms\r\nTotalInitTime,15021,  sum:15.021ms\r\nTotalRunTime,1.58807e+06,  sum:1588.07ms\r\nkn2row,125490,  sum:125.49ms\r\nkn2row-1x1,2095,  sum:2.095ms\r\nkn2row-buf,4,  sum:0.004ms\r\nmatrix_multiplication,69543,2085,  sum:71.628ms\r\nmatrix_shift_add1,4683,4159,2177,2048,  sum:13.067ms\r\nmatrix_shift_add2,141684,70508,34615,17354,  sum:264.161ms\r\nmatrix_shift_add_f1,3352,  sum:3.352ms\r\nmatrix_shift_add_f2,52553,  sum:52.553ms\r\nmatrix_transpose (row_major),20,  sum:0.02ms\r\npack_input_to_qwords,2141,4250,2127,985,380,  sum:9.883ms\r\nquantized-kn2row,589501,521899,169143,125074,15722,  sum:1421.34ms\r\nquantized_matrix_multiplication,275754,364921,103367,91567,15289,  sum:850.898ms\r\nquantized_ohwi_to_hwoi,30,195,45,160,20,  sum:0.45ms\r\n```\r\nbenchmark configuration\r\n```\r\nnetwork\r\n　LmnetV1Quantize\r\ndataset I used\r\n　Caltech101\r\ntraining configurattion\r\n　epoch is 2. other is default.\r\nhardware\r\n　DE10-nano\r\nhow many times you run the benchmark\r\n　As much as average average value is known (around 10 or more)\r\n```\r\n\r\nCompiler (before)\r\n```\r\nkonda@leapmind-server-08:~/work/blueoil$ /usr/bin/arm-linux-gnueabihf-gcc-5 -v\r\nUsing built-in specs.\r\nCOLLECT_GCC=/usr/bin/arm-linux-gnueabihf-gcc-5\r\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc-cross/arm-linux-gnueabihf/5/lto-wrapper\r\nTarget: arm-linux-gnueabihf\r\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu/Linaro 5.4.0-6ubuntu1~16.04.9' --with-bugurl=file:///usr/share/doc/gcc-5/README.Bugs --enable-languages=c,ada,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-5 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-libitm --disable-libquadmath --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-5-armhf-cross/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-5-armhf-cross --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-5-armhf-cross --with-arch-directory=arm --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --disable-libgcj --enable-objc-gc --enable-multiarch --enable-multilib --disable-sjlj-exceptions --with-arch=armv7-a --with-fpu=vfpv3-d16 --with-float=hard --with-mode=thumb --disable-werror --enable-multilib --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=arm-linux-gnueabihf --program-prefix=arm-linux-gnueabihf- --includedir=/usr/arm-linux-gnueabihf/include\r\nThread model: posix\r\ngcc version 5.4.0 20160609 (Ubuntu/Linaro 5.4.0-6ubuntu1~16.04.9) \r\n```\r\nCompiler (after)\r\n```\r\nllvm pre-built binary\r\nhttp://releases.llvm.org/7.0.0/clang+llvm-7.0.0-armv7a-linux-gnueabihf.tar.xz\r\n```\r\n\r\nAnd It's may be a compiler problem.","closed_by":{"login":"lm-konda","id":43975451,"node_id":"MDQ6VXNlcjQzOTc1NDUx","avatar_url":"https://avatars.githubusercontent.com/u/43975451?v=4","gravatar_id":"","url":"https://api.github.com/users/lm-konda","html_url":"https://github.com/lm-konda","followers_url":"https://api.github.com/users/lm-konda/followers","following_url":"https://api.github.com/users/lm-konda/following{/other_user}","gists_url":"https://api.github.com/users/lm-konda/gists{/gist_id}","starred_url":"https://api.github.com/users/lm-konda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lm-konda/subscriptions","organizations_url":"https://api.github.com/users/lm-konda/orgs","repos_url":"https://api.github.com/users/lm-konda/repos","events_url":"https://api.github.com/users/lm-konda/events{/privacy}","received_events_url":"https://api.github.com/users/lm-konda/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/blue-oil/blueoil/issues/95/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/blue-oil/blueoil/issues/95/timeline","performed_via_github_app":null,"state_reason":"completed"}