{"url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/219","repository_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch","labels_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/219/labels{/name}","comments_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/219/comments","events_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/219/events","html_url":"https://github.com/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/219","id":1044171505,"node_id":"I_kwDOCldfCM4-PMrx","number":219,"title":"Why is it splitting the same person into multiple pose entries?","user":{"login":"yolo765","id":84425052,"node_id":"MDQ6VXNlcjg0NDI1MDUy","avatar_url":"https://avatars.githubusercontent.com/u/84425052?v=4","gravatar_id":"","url":"https://api.github.com/users/yolo765","html_url":"https://github.com/yolo765","followers_url":"https://api.github.com/users/yolo765/followers","following_url":"https://api.github.com/users/yolo765/following{/other_user}","gists_url":"https://api.github.com/users/yolo765/gists{/gist_id}","starred_url":"https://api.github.com/users/yolo765/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yolo765/subscriptions","organizations_url":"https://api.github.com/users/yolo765/orgs","repos_url":"https://api.github.com/users/yolo765/repos","events_url":"https://api.github.com/users/yolo765/events{/privacy}","received_events_url":"https://api.github.com/users/yolo765/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-11-03T22:25:54Z","updated_at":"2021-11-21T07:28:31Z","closed_at":"2021-11-21T07:28:31Z","author_association":"NONE","active_lock_reason":null,"body":"Actually splitting the same hand for my case. Showing 2 examples below:\r\n\r\nI was able to solve this case by increasing the heatmap peaks suppression threshold from 6 to 10, that way one of the two wrists is gone. But that's not good because I can have very close joints in the fingers for some other hand gestures, or there could still be 2 wrist keypoints that are farther apart.\r\n![Screen Shot 2021-11-03 at 2 26 36 PM](https://user-images.githubusercontent.com/84425052/140201198-24ff0d01-1b1a-44fe-83c6-25278074b0b1.png)\r\n\r\nThis one has 6 pose entries, not sure how to fix or tune it. Or are my models not accurate to begin with? \r\n![Screen Shot 2021-11-03 at 2 41 14 PM](https://user-images.githubusercontent.com/84425052/140204235-7c8496e0-1edd-4e42-b6d7-96138c6a9281.png)\r\n\r\nWhat went wrong? What can I do to eliminate erroneous cases like these? It happens quite often. I can assume there is only one hand in each frame.\r\n\r\nSome changes I made:\r\n\r\n1. - 21 heatmaps for 21 keypoints (nothingfor background)\r\n2. - Shrink the network for a smaller mobilenet, with these, num_channels=32, num_heatmaps=21, num_pafs=40\r\n3. - In the dataloader, mask is always 1's: mask = np.ones(shape=(orig_height, orig_width), dtype=np.float32)\r\n4. - In the dataloader, objpos: label['objpos'] = [int(orig_height/2), int(orig_width/2)]\r\n5. - In the dataloader, I used a smaller crop, CropPad(pad=(128, 128, 128), crop_x=128, crop_y=128)\r\nI also use 128 for inference.\r\n \r\nHAND_PARTS_KPT_IDS =[[0, 1], [1, 2], [2, 3], [3, 4], \\\r\n                    [0, 5], [5, 6], [6, 7], [7, 8], \\\r\n                    [0, 9], [9, 10], [10, 11], [11, 12], \\\r\n                    [0, 13], [13, 14], [14, 15], [15, 16], \\\r\n                    [0, 17], [17, 18], [18, 19], [19, 20]]\r\n\r\nHAND_PARTS_PAF_IDS =[[0, 1], [2, 3], [4, 5], [6, 7], \\\r\n                    [8, 9], [10, 11], [12, 13], [14, 15], \\\r\n                    [16, 17], [18, 19], [20, 21], [22, 23], \\\r\n                    [24, 25], [26, 27], [28, 29], [30, 31], \\\r\n                    [32, 33], [34, 35], [36, 37], [38, 39]]\r\n\r\nBecause I can assume there is only one hand, I tried to use the global max of each heatmap but that still doesn't work well. Maybe my models are not good?\r\n\r\nThank you!","closed_by":{"login":"Daniil-Osokin","id":2491976,"node_id":"MDQ6VXNlcjI0OTE5NzY=","avatar_url":"https://avatars.githubusercontent.com/u/2491976?v=4","gravatar_id":"","url":"https://api.github.com/users/Daniil-Osokin","html_url":"https://github.com/Daniil-Osokin","followers_url":"https://api.github.com/users/Daniil-Osokin/followers","following_url":"https://api.github.com/users/Daniil-Osokin/following{/other_user}","gists_url":"https://api.github.com/users/Daniil-Osokin/gists{/gist_id}","starred_url":"https://api.github.com/users/Daniil-Osokin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Daniil-Osokin/subscriptions","organizations_url":"https://api.github.com/users/Daniil-Osokin/orgs","repos_url":"https://api.github.com/users/Daniil-Osokin/repos","events_url":"https://api.github.com/users/Daniil-Osokin/events{/privacy}","received_events_url":"https://api.github.com/users/Daniil-Osokin/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/219/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/219/timeline","performed_via_github_app":null,"state_reason":"completed"}