{"url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/198","repository_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch","labels_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/198/labels{/name}","comments_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/198/comments","events_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/198/events","html_url":"https://github.com/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/198","id":941742503,"node_id":"MDU6SXNzdWU5NDE3NDI1MDM=","number":198,"title":"Incomplete keypoints generated","user":{"login":"renziver","id":13497174,"node_id":"MDQ6VXNlcjEzNDk3MTc0","avatar_url":"https://avatars.githubusercontent.com/u/13497174?v=4","gravatar_id":"","url":"https://api.github.com/users/renziver","html_url":"https://github.com/renziver","followers_url":"https://api.github.com/users/renziver/followers","following_url":"https://api.github.com/users/renziver/following{/other_user}","gists_url":"https://api.github.com/users/renziver/gists{/gist_id}","starred_url":"https://api.github.com/users/renziver/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/renziver/subscriptions","organizations_url":"https://api.github.com/users/renziver/orgs","repos_url":"https://api.github.com/users/renziver/repos","events_url":"https://api.github.com/users/renziver/events{/privacy}","received_events_url":"https://api.github.com/users/renziver/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-07-12T07:08:45Z","updated_at":"2021-07-13T03:26:28Z","closed_at":"2021-07-13T03:26:27Z","author_association":"NONE","active_lock_reason":null,"body":"I have trained a custom dataset that follows the COCO format. It consists of 18 Keypoints:\r\n\r\n```\r\n0: 'Head'\r\n1:'neck'\r\n2:'right_shoulder'\r\n3:'right_elbow'\r\n4:'right_wrist'\r\n5:'left_shoulder'\r\n6:\"left_elbow\"\r\n7:\"left_wrist\"\r\n8:\"right_hip\"\r\n9:\"right_knee\"\r\n10:\"right_ankle\"\r\n11:\"left_hip\"\r\n12:\"left_knee\"\r\n13:\"left_ankle\"\r\n14:\"right_eye\"\r\n15:\"left_eye\"\r\n16:\"right_ear\"\r\n17:\"left_ear\"\r\n----\r\n\r\nSkeleton = [ [0, 1], [1, 2], [2, 3], [3, 4,], [1, 5], [5, 6], [6, 7], [1, 8], [8, 9], \r\n[9, 10], [1, 11],[11, 12], [12, 13], [0, 14], [0, 15], [16, 14], [17, 15] ]\r\n```\r\n\r\nGiven the 18 keypoints and their visibility values, the model consumes `54 keypoints` but the trained model only outputs `51 keypoints` as shown in the `detections.json` output which causes an error in the coco validation module of the `val.py`.\r\n\r\n```\r\ndetections.json\r\n---\r\nimage_id:11991\r\ncategory_id:1\r\n> keypoints: [] 51 items\r\nscore:401.3296689142792\r\n```\r\n```\r\nRunning test for keypoints results.\r\nloading annotations into memory...\r\nDone (t=0.00s)\r\ncreating index...\r\nindex created!\r\nLoading and preparing results...\r\nDONE (t=0.00s)\r\ncreating index...\r\nindex created!\r\nRunning per image evaluation...\r\nEvaluate annotation type *keypoints*\r\nTraceback (most recent call last):\r\n  File \"val.py\", line 179, in <module>\r\n    evaluate(args.labels, args.output_name, args.images_folder, net, args.multiscale, args.visualize)\r\n  File \"val.py\", line 161, in evaluate\r\n    run_coco_eval(labels, output_name) #change output_name to labels\r\n  File \"val.py\", line 25, in run_coco_eval\r\n    result.evaluate()\r\n  File \"/opt/conda/lib/python3.7/site-packages/pycocotools/cocoeval.py\", line 150, in evaluate\r\n    for imgId in p.imgIds\r\n  File \"/opt/conda/lib/python3.7/site-packages/pycocotools/cocoeval.py\", line 151, in <dictcomp>\r\n    for catId in catIds}\r\n  File \"/opt/conda/lib/python3.7/site-packages/pycocotools/cocoeval.py\", line 223, in computeOks\r\n    dx = xd - xg\r\nValueError: operands could not be broadcast together with shapes (17,) (18,) \r\n```\r\n\r\n\r\nI did not change the values in:\r\n```\r\nBODY_PARTS_KPT_IDS = [[1, 2], [1, 5], [2, 3], [3, 4], [5, 6], [6, 7], [1, 8], [8, 9], [9, 10], [1, 11],\r\n                      [11, 12], [12, 13], [1, 0], [0, 14], [14, 16], [0, 15], [15, 17], [2, 16], [5, 17]]\r\nBODY_PARTS_PAF_IDS = ([12, 13], [20, 21], [14, 15], [16, 17], [22, 23], [24, 25], [0, 1], [2, 3], [4, 5],\r\n                      [6, 7], [8, 9], [10, 11], [28, 29], [30, 31], [34, 35], [32, 33], [36, 37], [18, 19], [26, 27])\r\n```\r\nAs I have similar keypoints from the expected COCO+Neck dataset. But I'd want to know if this is a potential issue.\r\n\r\nIt may be important to mention that I manually added `neck` keypoints in my custom dataset, i'm currently checking as well if this causes an issue since the codebase seems to automatically add a `neck` keypoint based on the shoulders as shown in `_convert` function of `transformations.py`","closed_by":{"login":"renziver","id":13497174,"node_id":"MDQ6VXNlcjEzNDk3MTc0","avatar_url":"https://avatars.githubusercontent.com/u/13497174?v=4","gravatar_id":"","url":"https://api.github.com/users/renziver","html_url":"https://github.com/renziver","followers_url":"https://api.github.com/users/renziver/followers","following_url":"https://api.github.com/users/renziver/following{/other_user}","gists_url":"https://api.github.com/users/renziver/gists{/gist_id}","starred_url":"https://api.github.com/users/renziver/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/renziver/subscriptions","organizations_url":"https://api.github.com/users/renziver/orgs","repos_url":"https://api.github.com/users/renziver/repos","events_url":"https://api.github.com/users/renziver/events{/privacy}","received_events_url":"https://api.github.com/users/renziver/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/198/timeline","performed_via_github_app":null,"state_reason":"completed"}