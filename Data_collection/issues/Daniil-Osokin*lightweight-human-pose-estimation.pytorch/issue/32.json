{"url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/32","repository_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch","labels_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/32/labels{/name}","comments_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/32/comments","events_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/32/events","html_url":"https://github.com/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/32","id":453979202,"node_id":"MDU6SXNzdWU0NTM5NzkyMDI=","number":32,"title":"Very Slow Inference on CPU ","user":{"login":"xuexingyu24","id":45990015,"node_id":"MDQ6VXNlcjQ1OTkwMDE1","avatar_url":"https://avatars.githubusercontent.com/u/45990015?v=4","gravatar_id":"","url":"https://api.github.com/users/xuexingyu24","html_url":"https://github.com/xuexingyu24","followers_url":"https://api.github.com/users/xuexingyu24/followers","following_url":"https://api.github.com/users/xuexingyu24/following{/other_user}","gists_url":"https://api.github.com/users/xuexingyu24/gists{/gist_id}","starred_url":"https://api.github.com/users/xuexingyu24/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuexingyu24/subscriptions","organizations_url":"https://api.github.com/users/xuexingyu24/orgs","repos_url":"https://api.github.com/users/xuexingyu24/repos","events_url":"https://api.github.com/users/xuexingyu24/events{/privacy}","received_events_url":"https://api.github.com/users/xuexingyu24/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2019-06-10T03:07:23Z","updated_at":"2019-06-17T04:06:55Z","closed_at":"2019-06-17T04:06:55Z","author_association":"NONE","active_lock_reason":null,"body":"Hi  I found the model is very very slow on CPU using the pretrained weight \"checkpoint_iter_370000.pth\". I have attached the code below.  I have tested different scenarios, and summarize the results below:\r\nGPU w pretrained weight:   0.007 sec \r\nGPU w/o pretrained weight: 0.007 sec \r\n**CPU w pretrained weight: 2.829 sec** \r\nCPU w/o pretrained weight: 0.376 sec \r\n\r\nCould you kindly explain why the inference time using CPU and pretrained weight is so slow ? \r\n\r\n```\r\nimport argparse\r\nimport cv2\r\nimport numpy as np\r\nimport torch\r\nfrom models.with_mobilenet import PoseEstimationWithMobileNet\r\nfrom modules.keypoints import extract_keypoints, group_keypoints\r\nfrom modules.load_state import load_state\r\nfrom modules.pose import Pose, propagate_ids\r\nimport time\r\n#from val import normalize, pad_width\r\ndevice = torch.device('cpu')\r\nmodel_Mobilenet = PoseEstimationWithMobileNet().to(device)\r\ncheckpoint = torch.load('checkpoint_iter_370000.pth', map_location=lambda storage, loc: storage)\r\nload_state(model_Mobilenet, checkpoint)\r\nmodel_Mobilenet.eval()\r\ninput = torch.Tensor(2, 3, 368, 368).to(device)\r\n\r\nsince = time.time()\r\nstages_output= model_Mobilenet(input)\r\nPAF_Mobilenet, Heatmap_Mobilenet = stages_output[-1], stages_output[-2]\r\nprint('Mobilenet Inference time is {:2.3f} seconds'.format(time.time() - since))\r\n```\r\n\r\n\r\n","closed_by":{"login":"Daniil-Osokin","id":2491976,"node_id":"MDQ6VXNlcjI0OTE5NzY=","avatar_url":"https://avatars.githubusercontent.com/u/2491976?v=4","gravatar_id":"","url":"https://api.github.com/users/Daniil-Osokin","html_url":"https://github.com/Daniil-Osokin","followers_url":"https://api.github.com/users/Daniil-Osokin/followers","following_url":"https://api.github.com/users/Daniil-Osokin/following{/other_user}","gists_url":"https://api.github.com/users/Daniil-Osokin/gists{/gist_id}","starred_url":"https://api.github.com/users/Daniil-Osokin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Daniil-Osokin/subscriptions","organizations_url":"https://api.github.com/users/Daniil-Osokin/orgs","repos_url":"https://api.github.com/users/Daniil-Osokin/repos","events_url":"https://api.github.com/users/Daniil-Osokin/events{/privacy}","received_events_url":"https://api.github.com/users/Daniil-Osokin/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/32/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Daniil-Osokin/lightweight-human-pose-estimation.pytorch/issues/32/timeline","performed_via_github_app":null,"state_reason":"completed"}