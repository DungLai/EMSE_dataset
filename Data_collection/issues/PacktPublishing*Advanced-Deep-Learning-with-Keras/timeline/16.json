[{"url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/comments/813575843","html_url":"https://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/16#issuecomment-813575843","issue_url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/16","id":813575843,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMzU3NTg0Mw==","user":{"login":"MLHafizur","id":45520794,"node_id":"MDQ6VXNlcjQ1NTIwNzk0","avatar_url":"https://avatars.githubusercontent.com/u/45520794?v=4","gravatar_id":"","url":"https://api.github.com/users/MLHafizur","html_url":"https://github.com/MLHafizur","followers_url":"https://api.github.com/users/MLHafizur/followers","following_url":"https://api.github.com/users/MLHafizur/following{/other_user}","gists_url":"https://api.github.com/users/MLHafizur/gists{/gist_id}","starred_url":"https://api.github.com/users/MLHafizur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MLHafizur/subscriptions","organizations_url":"https://api.github.com/users/MLHafizur/orgs","repos_url":"https://api.github.com/users/MLHafizur/repos","events_url":"https://api.github.com/users/MLHafizur/events{/privacy}","received_events_url":"https://api.github.com/users/MLHafizur/received_events","type":"User","site_admin":false},"created_at":"2021-04-05T18:56:01Z","updated_at":"2021-04-05T18:57:35Z","author_association":"NONE","body":"@roatienza Here are the codes used to convert to .npy\r\n\r\n```\r\nef generate_dataset(args):\r\n    data_dict = {}\r\n    js = load_json(args.data_path, args.json)\r\n    #js = js[\"_via_img_metadata\"]\r\n    keys = js.keys()\r\n    rgb = rgb = [(255, 0, 0), (0, 255, 0), (0, 0, 255), (255, 255, 0), (255, 0, 255), (0, 255, 255)]\r\n    images_no_objs = []\r\n    for key in keys:\r\n        entry = js[key]\r\n        filename = entry[\"filename\"]\r\n        path = os.path.join(args.data_path, filename)\r\n        regions = entry[\"regions\"]\r\n        masks = []\r\n        for region in regions:\r\n            shape = region[\"shape_attributes\"]\r\n            x = shape[\"all_points_x\"]\r\n            y = shape[\"all_points_y\"]\r\n            name = region[\"region_attributes\"]\r\n            class_id = name[\"Crimps\"]\r\n            #class_id = 1 if class_id == \"Copper\" else 2\r\n            #print(class_id)\r\n            fmt = \"%s,%s,%s,%s\"\r\n            line = fmt % (filename, x, y, class_id)\r\n            #print(line)\r\n            xy = np.array([x, y], dtype=np.int32)\r\n            xy = np.transpose(xy)\r\n            xy = np.reshape(xy, [1, -1, 2])\r\n            mask = { class_id : xy }\r\n            #print(mask)\r\n            masks.append(mask)\r\n\r\n        image = plt.imread(path)\r\n        #dim = (512, 420)\r\n        #image = cv2.resize(image, dim, interpolation = cv2.INTER_AREA)\r\n        if args.show:\r\n            plt.xlabel('x')\r\n            plt.ylabel('y')\r\n            plt.title('Input image', fontsize=14)\r\n            fname = os.path.splitext(filename)[0]\r\n            fname = fname + \"-input.png\"\r\n            path = os.path.join(\"images\", fname)\r\n            plt.imshow(image)\r\n            plt.savefig(path)\r\n            plt.show()\r\n        else:\r\n            image = np.zeros_like(image)\r\n\r\n        shape = image.shape\r\n        shape = (shape[0], shape[1])\r\n        bg = np.ones(shape, dtype=\"uint8\")\r\n        bg.fill(255)\r\n        i = 0\r\n        image = np.zeros_like(image)\r\n        #image[:] = [128, 0, 128]\r\n        for mask in masks:\r\n            name = list(mask)[0]\r\n            #print(name)\r\n            mask = mask[name]\r\n            #cv2.fillPoly(image, mask, rgb[int(name)-1])\r\n            cv2.fillPoly(image, mask, rgb[i - 1])\r\n            i += 1\r\n            cv2.fillPoly(bg, mask, 0)\r\n\r\n        if args.show:\r\n            name = os.path.splitext(filename)[0]\r\n\r\n            plt.xlabel('x')\r\n            plt.ylabel('y')\r\n            plt.title('Ground truth semantic segmentation', fontsize=14)\r\n            fname = name + \"-semantic.png\"\r\n            path = os.path.join(\"images\", fname)\r\n            plt.imshow(image)\r\n            plt.savefig(path)\r\n            #plt.show()\r\n\r\n            #plt.xlabel('x')\r\n            #plt.ylabel('y')\r\n            #plt.title('Background segmentation', fontsize=14)\r\n            #fname = name + \"-bg.png\"\r\n            #path = os.path.join(\"images\", fname)\r\n            #plt.imshow(bg, cmap='gray', vmin=0, vmax=255)\r\n            #plt.savefig(path)\r\n            #plt.show()\r\n\r\n\r\n        shape = (*shape, 1)\r\n        bg = np.reshape(bg, shape)\r\n        #print(bg.shape)\r\n        data = np.concatenate((bg, image), axis=-1)\r\n        data = data.astype('float32') / 255\r\n        data = data.astype('uint8')\r\n        data_dict[filename] = data\r\n        print(filename, len(masks))\r\n        if len(masks) == 0:\r\n            images_no_objs.append(filename)\r\n\r\n    if not args.show:\r\n        np.save(args.save_filename, data_dict)\r\n```","reactions":{"url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/comments/813575843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MLHafizur","id":45520794,"node_id":"MDQ6VXNlcjQ1NTIwNzk0","avatar_url":"https://avatars.githubusercontent.com/u/45520794?v=4","gravatar_id":"","url":"https://api.github.com/users/MLHafizur","html_url":"https://github.com/MLHafizur","followers_url":"https://api.github.com/users/MLHafizur/followers","following_url":"https://api.github.com/users/MLHafizur/following{/other_user}","gists_url":"https://api.github.com/users/MLHafizur/gists{/gist_id}","starred_url":"https://api.github.com/users/MLHafizur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MLHafizur/subscriptions","organizations_url":"https://api.github.com/users/MLHafizur/orgs","repos_url":"https://api.github.com/users/MLHafizur/repos","events_url":"https://api.github.com/users/MLHafizur/events{/privacy}","received_events_url":"https://api.github.com/users/MLHafizur/received_events","type":"User","site_admin":false}},{"id":4552932409,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDU1MjkzMjQwOQ==","url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/events/4552932409","actor":{"login":"roatienza","id":8848769,"node_id":"MDQ6VXNlcjg4NDg3Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8848769?v=4","gravatar_id":"","url":"https://api.github.com/users/roatienza","html_url":"https://github.com/roatienza","followers_url":"https://api.github.com/users/roatienza/followers","following_url":"https://api.github.com/users/roatienza/following{/other_user}","gists_url":"https://api.github.com/users/roatienza/gists{/gist_id}","starred_url":"https://api.github.com/users/roatienza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roatienza/subscriptions","organizations_url":"https://api.github.com/users/roatienza/orgs","repos_url":"https://api.github.com/users/roatienza/repos","events_url":"https://api.github.com/users/roatienza/events{/privacy}","received_events_url":"https://api.github.com/users/roatienza/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-05T18:56:01Z","performed_via_github_app":null},{"id":4552932411,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1NTI5MzI0MTE=","url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/events/4552932411","actor":{"login":"roatienza","id":8848769,"node_id":"MDQ6VXNlcjg4NDg3Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8848769?v=4","gravatar_id":"","url":"https://api.github.com/users/roatienza","html_url":"https://github.com/roatienza","followers_url":"https://api.github.com/users/roatienza/followers","following_url":"https://api.github.com/users/roatienza/following{/other_user}","gists_url":"https://api.github.com/users/roatienza/gists{/gist_id}","starred_url":"https://api.github.com/users/roatienza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roatienza/subscriptions","organizations_url":"https://api.github.com/users/roatienza/orgs","repos_url":"https://api.github.com/users/roatienza/repos","events_url":"https://api.github.com/users/roatienza/events{/privacy}","received_events_url":"https://api.github.com/users/roatienza/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-05T18:56:01Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/comments/814076270","html_url":"https://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/16#issuecomment-814076270","issue_url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/16","id":814076270,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDA3NjI3MA==","user":{"login":"roatienza","id":8848769,"node_id":"MDQ6VXNlcjg4NDg3Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8848769?v=4","gravatar_id":"","url":"https://api.github.com/users/roatienza","html_url":"https://github.com/roatienza","followers_url":"https://api.github.com/users/roatienza/followers","following_url":"https://api.github.com/users/roatienza/following{/other_user}","gists_url":"https://api.github.com/users/roatienza/gists{/gist_id}","starred_url":"https://api.github.com/users/roatienza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roatienza/subscriptions","organizations_url":"https://api.github.com/users/roatienza/orgs","repos_url":"https://api.github.com/users/roatienza/repos","events_url":"https://api.github.com/users/roatienza/events{/privacy}","received_events_url":"https://api.github.com/users/roatienza/received_events","type":"User","site_admin":false},"created_at":"2021-04-06T12:22:20Z","updated_at":"2021-04-06T12:22:20Z","author_association":"COLLABORATOR","body":"Hi, For the OOM problem, pls adjust the batch size. The default is 4 for big memory GPUs like V100. For smaller GPUs like 1060Ti, pls use 1. \r\nFor the number of classes, the data generator reads the npy file and automatically computes the number of unique classes based on the GT mask.\r\nhttps://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras/blob/5d97af8ef5d8b32bda38bdaeb9137fb4f49674a1/chapter12-segmentation/data_generator.py#L51\r\n\r\nTherefore, if you want to make n_classes=3 (inc bg), you have to prepare dataset with key=image_file_name and value=tensor_mask where the dim of tensor_mask is image_dim x 3. The tensor_mask defines the segmentation mask of each object in the image.","reactions":{"url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/comments/814076270/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roatienza","id":8848769,"node_id":"MDQ6VXNlcjg4NDg3Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8848769?v=4","gravatar_id":"","url":"https://api.github.com/users/roatienza","html_url":"https://github.com/roatienza","followers_url":"https://api.github.com/users/roatienza/followers","following_url":"https://api.github.com/users/roatienza/following{/other_user}","gists_url":"https://api.github.com/users/roatienza/gists{/gist_id}","starred_url":"https://api.github.com/users/roatienza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roatienza/subscriptions","organizations_url":"https://api.github.com/users/roatienza/orgs","repos_url":"https://api.github.com/users/roatienza/repos","events_url":"https://api.github.com/users/roatienza/events{/privacy}","received_events_url":"https://api.github.com/users/roatienza/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/comments/814108378","html_url":"https://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/16#issuecomment-814108378","issue_url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/16","id":814108378,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDEwODM3OA==","user":{"login":"MLHafizur","id":45520794,"node_id":"MDQ6VXNlcjQ1NTIwNzk0","avatar_url":"https://avatars.githubusercontent.com/u/45520794?v=4","gravatar_id":"","url":"https://api.github.com/users/MLHafizur","html_url":"https://github.com/MLHafizur","followers_url":"https://api.github.com/users/MLHafizur/followers","following_url":"https://api.github.com/users/MLHafizur/following{/other_user}","gists_url":"https://api.github.com/users/MLHafizur/gists{/gist_id}","starred_url":"https://api.github.com/users/MLHafizur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MLHafizur/subscriptions","organizations_url":"https://api.github.com/users/MLHafizur/orgs","repos_url":"https://api.github.com/users/MLHafizur/repos","events_url":"https://api.github.com/users/MLHafizur/events{/privacy}","received_events_url":"https://api.github.com/users/MLHafizur/received_events","type":"User","site_admin":false},"created_at":"2021-04-06T13:11:58Z","updated_at":"2021-04-06T13:20:09Z","author_association":"NONE","body":"Hi @roatienza Thank you for your help. For the number of classes, I am bit confused. Can you please tell me in where of the code, I have to change? I am very new in Computer Vision.","reactions":{"url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/comments/814108378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MLHafizur","id":45520794,"node_id":"MDQ6VXNlcjQ1NTIwNzk0","avatar_url":"https://avatars.githubusercontent.com/u/45520794?v=4","gravatar_id":"","url":"https://api.github.com/users/MLHafizur","html_url":"https://github.com/MLHafizur","followers_url":"https://api.github.com/users/MLHafizur/followers","following_url":"https://api.github.com/users/MLHafizur/following{/other_user}","gists_url":"https://api.github.com/users/MLHafizur/gists{/gist_id}","starred_url":"https://api.github.com/users/MLHafizur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MLHafizur/subscriptions","organizations_url":"https://api.github.com/users/MLHafizur/orgs","repos_url":"https://api.github.com/users/MLHafizur/repos","events_url":"https://api.github.com/users/MLHafizur/events{/privacy}","received_events_url":"https://api.github.com/users/MLHafizur/received_events","type":"User","site_admin":false}},{"id":4556702229,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDU1NjcwMjIyOQ==","url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/events/4556702229","actor":{"login":"roatienza","id":8848769,"node_id":"MDQ6VXNlcjg4NDg3Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8848769?v=4","gravatar_id":"","url":"https://api.github.com/users/roatienza","html_url":"https://github.com/roatienza","followers_url":"https://api.github.com/users/roatienza/followers","following_url":"https://api.github.com/users/roatienza/following{/other_user}","gists_url":"https://api.github.com/users/roatienza/gists{/gist_id}","starred_url":"https://api.github.com/users/roatienza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roatienza/subscriptions","organizations_url":"https://api.github.com/users/roatienza/orgs","repos_url":"https://api.github.com/users/roatienza/repos","events_url":"https://api.github.com/users/roatienza/events{/privacy}","received_events_url":"https://api.github.com/users/roatienza/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-06T13:11:58Z","performed_via_github_app":null},{"id":4556702236,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1NTY3MDIyMzY=","url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/events/4556702236","actor":{"login":"roatienza","id":8848769,"node_id":"MDQ6VXNlcjg4NDg3Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8848769?v=4","gravatar_id":"","url":"https://api.github.com/users/roatienza","html_url":"https://github.com/roatienza","followers_url":"https://api.github.com/users/roatienza/followers","following_url":"https://api.github.com/users/roatienza/following{/other_user}","gists_url":"https://api.github.com/users/roatienza/gists{/gist_id}","starred_url":"https://api.github.com/users/roatienza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roatienza/subscriptions","organizations_url":"https://api.github.com/users/roatienza/orgs","repos_url":"https://api.github.com/users/roatienza/repos","events_url":"https://api.github.com/users/roatienza/events{/privacy}","received_events_url":"https://api.github.com/users/roatienza/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-06T13:11:58Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/comments/814535389","html_url":"https://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/16#issuecomment-814535389","issue_url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/16","id":814535389,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDUzNTM4OQ==","user":{"login":"roatienza","id":8848769,"node_id":"MDQ6VXNlcjg4NDg3Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8848769?v=4","gravatar_id":"","url":"https://api.github.com/users/roatienza","html_url":"https://github.com/roatienza","followers_url":"https://api.github.com/users/roatienza/followers","following_url":"https://api.github.com/users/roatienza/following{/other_user}","gists_url":"https://api.github.com/users/roatienza/gists{/gist_id}","starred_url":"https://api.github.com/users/roatienza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roatienza/subscriptions","organizations_url":"https://api.github.com/users/roatienza/orgs","repos_url":"https://api.github.com/users/roatienza/repos","events_url":"https://api.github.com/users/roatienza/events{/privacy}","received_events_url":"https://api.github.com/users/roatienza/received_events","type":"User","site_admin":false},"created_at":"2021-04-07T01:27:22Z","updated_at":"2021-04-07T01:27:22Z","author_association":"COLLABORATOR","body":"Hi, The short answer is - unfortunately, it is not straightforward. You must change the image variable:\r\n\r\nhttps://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras/blob/5d97af8ef5d8b32bda38bdaeb9137fb4f49674a1/chapter12-segmentation/utils/generate_gt_segmentation.py#L51\r\n\r\nto something like:\r\n`image = np.ones((w, h, n_classes), dtype=\"uint8\")`\r\n\r\nIn your case,  `(w,h)` is your image dim and `n_classes = 3`, or 2 classes + 1 bg class.  \r\n\r\nAssuming you have the polygon annotation using via tool, the mask will be set on the `bg` variable:\r\n\r\nhttps://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras/blob/5d97af8ef5d8b32bda38bdaeb9137fb4f49674a1/chapter12-segmentation/utils/generate_gt_segmentation.py#L67\r\n\r\nRowel","reactions":{"url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/comments/814535389/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roatienza","id":8848769,"node_id":"MDQ6VXNlcjg4NDg3Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8848769?v=4","gravatar_id":"","url":"https://api.github.com/users/roatienza","html_url":"https://github.com/roatienza","followers_url":"https://api.github.com/users/roatienza/followers","following_url":"https://api.github.com/users/roatienza/following{/other_user}","gists_url":"https://api.github.com/users/roatienza/gists{/gist_id}","starred_url":"https://api.github.com/users/roatienza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roatienza/subscriptions","organizations_url":"https://api.github.com/users/roatienza/orgs","repos_url":"https://api.github.com/users/roatienza/repos","events_url":"https://api.github.com/users/roatienza/events{/privacy}","received_events_url":"https://api.github.com/users/roatienza/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/comments/816331730","html_url":"https://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/16#issuecomment-816331730","issue_url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/16","id":816331730,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNjMzMTczMA==","user":{"login":"MLHafizur","id":45520794,"node_id":"MDQ6VXNlcjQ1NTIwNzk0","avatar_url":"https://avatars.githubusercontent.com/u/45520794?v=4","gravatar_id":"","url":"https://api.github.com/users/MLHafizur","html_url":"https://github.com/MLHafizur","followers_url":"https://api.github.com/users/MLHafizur/followers","following_url":"https://api.github.com/users/MLHafizur/following{/other_user}","gists_url":"https://api.github.com/users/MLHafizur/gists{/gist_id}","starred_url":"https://api.github.com/users/MLHafizur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MLHafizur/subscriptions","organizations_url":"https://api.github.com/users/MLHafizur/orgs","repos_url":"https://api.github.com/users/MLHafizur/repos","events_url":"https://api.github.com/users/MLHafizur/events{/privacy}","received_events_url":"https://api.github.com/users/MLHafizur/received_events","type":"User","site_admin":false},"created_at":"2021-04-09T01:06:53Z","updated_at":"2021-04-09T01:06:53Z","author_association":"NONE","body":"Hi @roatienza I am getting following error when trying to train Mask-RCNN model with customs images.I tried with different version of tensorflow, keras and open cv, but no luck yet. All it seems that all x values are under 1280 and y values are under 720. My image sizes are 1280 * 720. How may I solve this issue?\r\n\r\nAssertionError: Assertion failed.\r\nwarning: source train not part of our classes, delegating to parent.\r\nERROR:root:Error processing image {'id': 'WIN_20210309_14_32_19_Pro.jpg', 'source': 'train', 'path': '/content/gdrive/MyDrive/vgg_promark/Image_Segmentation/train/train/WIN_20210309_14_32_19_Pro.jpg', 'width': 1280, 'height': 720, 'polygons': [{'name': 'polygon', 'all_points_x': [428, 357, 349, 347, 359, 339, 349, 340, 338, 346, 356, 349, 359, 360, 359, 354, 361, 372, 396, 415, 427, 429, 422, 410, 417, 423, 429], 'all_points_y': [190, 189, 189, 202, 220, 232, 255, 262, 280, 289, 291, 305, 320, 335, 357, 374, 385, 394, 398, 398, 381, 360, 325, 294, 276, 228, 214]}, {'name': 'polygon', 'all_points_x': [499, 442, 423, 419, 420, 439, 431, 423, 420, 416, 434, 426, 415, 419, 430, 457, 482, 506, 511, 527, 528, 519], 'all_points_y': [145, 139, 139, 155, 172, 184, 216, 254, 288, 303, 348, 397, 412, 423, 430, 422, 411, 404, 318, 249, 182, 151]}, {'name': 'polygon', 'all_points_x': [504, 463, 446, 445, 438, 445, 458, 475, 484, 490, 493, 498, 499, 496, 486, 483, 499], 'all_points_y': [504, 497, 501, 553, 609, 667, 665, 675, 680, 680, 669, 637, 616, 590, 547, 528, 524]}, {'name': 'polygon', 'all_points_x': [255, 233, 217, 204, 187, 154, 143, 140, 141, 155, 163, 159, 153, 154, 172, 261, 261, 256, 247, 253], 'all_points_y': [552, 552, 542, 536, 538, 541, 545, 568, 582, 592, 594, 607, 619, 632, 631, 642, 622, 602, 587, 568]}], 'r_object_name': ['Copper', 'Belmouth', 'Belmouth', 'Copper']}\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/dist-packages/mrcnn/model.py\", line 1704, in data_generator\r\n    use_mini_mask=config.USE_MINI_MASK)\r\n  File \"/usr/local/lib/python3.7/dist-packages/mrcnn/model.py\", line 1261, in load_image_gt\r\n    hooks=imgaug.HooksImages(activator=hook))\r\n  File \"/usr/local/lib/python3.7/dist-packages/imgaug/augmenters/meta.py\", line 470, in augment_image\r\n    return self.augment_images([image], hooks=hooks)[0]\r\n  File \"/usr/local/lib/python3.7/dist-packages/imgaug/augmenters/meta.py\", line 603, in augment_images\r\n    hooks=hooks\r\n  File \"/usr/local/lib/python3.7/dist-packages/imgaug/augmenters/meta.py\", line 2816, in _augment_images\r\n    hooks=hooks\r\n  File \"/usr/local/lib/python3.7/dist-packages/imgaug/augmenters/meta.py\", line 603, in augment_images\r\n    hooks=hooks\r\n  File \"/usr/local/lib/python3.7/dist-packages/imgaug/augmenters/geometric.py\", line 620, in _augment_images\r\n    shear_samples, cval_samples, mode_samples, order_samples)\r\n  File \"/usr/local/lib/python3.7/dist-packages/imgaug/augmenters/geometric.py\", line 689, in _augment_images_by_samples\r\n    return_matrix=return_matrices,\r\n  File \"/usr/local/lib/python3.7/dist-packages/imgaug/augmenters/geometric.py\", line 956, in _warp_cv2\r\n    borderValue=cval\r\ncv2.error: OpenCV(3.4.2) /io/opencv/modules/imgproc/src/imgwarp.cpp:2610: error: (-215:Assertion failed) src.cols > 0 && src.rows > 0 in function 'warpAffine'\r\n\r\nProcess Process-1:\r\n---------------------------------------------------------------------------\r\nStopIteration                             Traceback (most recent call last)\r\n<ipython-input-25-616aafa67c99> in <module>()\r\n----> 1 history = train(model, dataset_path, 5)\r\n\r\n3 frames\r\n/usr/local/lib/python3.7/dist-packages/keras/engine/training.py in fit_generator(self, generator, steps_per_epoch, epochs, verbose, callbacks, validation_data, validation_steps, class_weight, max_queue_size, workers, use_multiprocessing, shuffle, initial_epoch)\r\n   2009                 batch_index = 0\r\n   2010                 while steps_done < steps_per_epoch:\r\n-> 2011                     generator_output = next(output_generator)\r\n   2012 \r\n   2013                     if not hasattr(generator_output, '__len__'):\r\n\r\nStopIteration: ","reactions":{"url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/comments/816331730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MLHafizur","id":45520794,"node_id":"MDQ6VXNlcjQ1NTIwNzk0","avatar_url":"https://avatars.githubusercontent.com/u/45520794?v=4","gravatar_id":"","url":"https://api.github.com/users/MLHafizur","html_url":"https://github.com/MLHafizur","followers_url":"https://api.github.com/users/MLHafizur/followers","following_url":"https://api.github.com/users/MLHafizur/following{/other_user}","gists_url":"https://api.github.com/users/MLHafizur/gists{/gist_id}","starred_url":"https://api.github.com/users/MLHafizur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MLHafizur/subscriptions","organizations_url":"https://api.github.com/users/MLHafizur/orgs","repos_url":"https://api.github.com/users/MLHafizur/repos","events_url":"https://api.github.com/users/MLHafizur/events{/privacy}","received_events_url":"https://api.github.com/users/MLHafizur/received_events","type":"User","site_admin":false}},{"id":4571859684,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDU3MTg1OTY4NA==","url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/events/4571859684","actor":{"login":"roatienza","id":8848769,"node_id":"MDQ6VXNlcjg4NDg3Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8848769?v=4","gravatar_id":"","url":"https://api.github.com/users/roatienza","html_url":"https://github.com/roatienza","followers_url":"https://api.github.com/users/roatienza/followers","following_url":"https://api.github.com/users/roatienza/following{/other_user}","gists_url":"https://api.github.com/users/roatienza/gists{/gist_id}","starred_url":"https://api.github.com/users/roatienza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roatienza/subscriptions","organizations_url":"https://api.github.com/users/roatienza/orgs","repos_url":"https://api.github.com/users/roatienza/repos","events_url":"https://api.github.com/users/roatienza/events{/privacy}","received_events_url":"https://api.github.com/users/roatienza/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-09T01:06:53Z","performed_via_github_app":null},{"id":4571859689,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1NzE4NTk2ODk=","url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/events/4571859689","actor":{"login":"roatienza","id":8848769,"node_id":"MDQ6VXNlcjg4NDg3Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8848769?v=4","gravatar_id":"","url":"https://api.github.com/users/roatienza","html_url":"https://github.com/roatienza","followers_url":"https://api.github.com/users/roatienza/followers","following_url":"https://api.github.com/users/roatienza/following{/other_user}","gists_url":"https://api.github.com/users/roatienza/gists{/gist_id}","starred_url":"https://api.github.com/users/roatienza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roatienza/subscriptions","organizations_url":"https://api.github.com/users/roatienza/orgs","repos_url":"https://api.github.com/users/roatienza/repos","events_url":"https://api.github.com/users/roatienza/events{/privacy}","received_events_url":"https://api.github.com/users/roatienza/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-09T01:06:53Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/comments/817402955","html_url":"https://github.com/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/16#issuecomment-817402955","issue_url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/16","id":817402955,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNzQwMjk1NQ==","user":{"login":"roatienza","id":8848769,"node_id":"MDQ6VXNlcjg4NDg3Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8848769?v=4","gravatar_id":"","url":"https://api.github.com/users/roatienza","html_url":"https://github.com/roatienza","followers_url":"https://api.github.com/users/roatienza/followers","following_url":"https://api.github.com/users/roatienza/following{/other_user}","gists_url":"https://api.github.com/users/roatienza/gists{/gist_id}","starred_url":"https://api.github.com/users/roatienza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roatienza/subscriptions","organizations_url":"https://api.github.com/users/roatienza/orgs","repos_url":"https://api.github.com/users/roatienza/repos","events_url":"https://api.github.com/users/roatienza/events{/privacy}","received_events_url":"https://api.github.com/users/roatienza/received_events","type":"User","site_admin":false},"created_at":"2021-04-12T00:26:54Z","updated_at":"2021-04-12T00:26:54Z","author_association":"COLLABORATOR","body":"It appears that the input to your MaskRCNN model is None. Pls check your input data just before it is passed to the model.\r\n\r\nThis issue is no longer about the book content and example code so I am closing it. Thank you.","reactions":{"url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/comments/817402955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roatienza","id":8848769,"node_id":"MDQ6VXNlcjg4NDg3Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8848769?v=4","gravatar_id":"","url":"https://api.github.com/users/roatienza","html_url":"https://github.com/roatienza","followers_url":"https://api.github.com/users/roatienza/followers","following_url":"https://api.github.com/users/roatienza/following{/other_user}","gists_url":"https://api.github.com/users/roatienza/gists{/gist_id}","starred_url":"https://api.github.com/users/roatienza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roatienza/subscriptions","organizations_url":"https://api.github.com/users/roatienza/orgs","repos_url":"https://api.github.com/users/roatienza/repos","events_url":"https://api.github.com/users/roatienza/events{/privacy}","received_events_url":"https://api.github.com/users/roatienza/received_events","type":"User","site_admin":false}},{"id":4579184406,"node_id":"MDExOkNsb3NlZEV2ZW50NDU3OTE4NDQwNg==","url":"https://api.github.com/repos/PacktPublishing/Advanced-Deep-Learning-with-Keras/issues/events/4579184406","actor":{"login":"roatienza","id":8848769,"node_id":"MDQ6VXNlcjg4NDg3Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8848769?v=4","gravatar_id":"","url":"https://api.github.com/users/roatienza","html_url":"https://github.com/roatienza","followers_url":"https://api.github.com/users/roatienza/followers","following_url":"https://api.github.com/users/roatienza/following{/other_user}","gists_url":"https://api.github.com/users/roatienza/gists{/gist_id}","starred_url":"https://api.github.com/users/roatienza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roatienza/subscriptions","organizations_url":"https://api.github.com/users/roatienza/orgs","repos_url":"https://api.github.com/users/roatienza/repos","events_url":"https://api.github.com/users/roatienza/events{/privacy}","received_events_url":"https://api.github.com/users/roatienza/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-04-12T00:26:54Z","state_reason":null,"performed_via_github_app":null}]