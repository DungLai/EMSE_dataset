{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/18","repository_url":"https://api.github.com/repos/nanoporetech/taiyaki","labels_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/18/labels{/name}","comments_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/18/comments","events_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/18/events","html_url":"https://github.com/nanoporetech/taiyaki/issues/18","id":448458647,"node_id":"MDU6SXNzdWU0NDg0NTg2NDc=","number":18,"title":"prepare_mapped_reads.py on RNA fails with TypeError: '<' not supported between instances of 'numpy.str_' and 'int' ","user":{"login":"lpryszcz","id":988152,"node_id":"MDQ6VXNlcjk4ODE1Mg==","avatar_url":"https://avatars.githubusercontent.com/u/988152?v=4","gravatar_id":"","url":"https://api.github.com/users/lpryszcz","html_url":"https://github.com/lpryszcz","followers_url":"https://api.github.com/users/lpryszcz/followers","following_url":"https://api.github.com/users/lpryszcz/following{/other_user}","gists_url":"https://api.github.com/users/lpryszcz/gists{/gist_id}","starred_url":"https://api.github.com/users/lpryszcz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lpryszcz/subscriptions","organizations_url":"https://api.github.com/users/lpryszcz/orgs","repos_url":"https://api.github.com/users/lpryszcz/repos","events_url":"https://api.github.com/users/lpryszcz/events{/privacy}","received_events_url":"https://api.github.com/users/lpryszcz/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-05-25T12:08:17Z","updated_at":"2019-06-25T10:58:44Z","closed_at":"2019-06-25T10:58:44Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Hi, I get an error when running `prepare_mapped_reads.py` on direct RNA reads with m6A. [I've run it previously with DNA without any problem](https://github.com/nanoporetech/taiyaki/blob/master/docs/modbase.rst), so that's odd to me. \r\n\r\n```\r\nprepare_mapped_reads.py --jobs 6 --mod = A 6mA reads read_params.tsv mapped_reads.hdf5 pretrained/r941_rna_minion.checkpoint read_references.fasta\r\n\r\n\"\"\"\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.6/multiprocessing/pool.py\", line 119, in worker\r\n    result = (True, func(*args, **kwds))\r\n  File \"/usr/lib/python3.6/multiprocessing/pool.py\", line 44, in mapstar\r\n    return list(map(*args))\r\n  File \"/home/lpryszcz/src/taiyaki/taiyaki/prepare_mapping_funcs.py\", line 50, in oneread_remap\r\n    sig.set_trim_absolute(read_params_dict['trim_start'], read_params_dict['trim_end'])\r\n  File \"/home/lpryszcz/src/taiyaki/taiyaki/signal.py\", line 66, in set_trim_absolute\r\n    if trimstart < 0 or trimend < 0:\r\nTypeError: '<' not supported between instances of 'numpy.str_' and 'int'\r\n\"\"\"\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/lpryszcz/src/taiyaki/venv/bin/prepare_mapped_reads.py\", line 7, in <module>\r\n    exec(compile(f.read(), __file__, 'exec'))\r\n  File \"/home/lpryszcz/src/taiyaki/bin/prepare_mapped_reads.py\", line 83, in <module>\r\n    main()\r\n  File \"/home/lpryszcz/src/taiyaki/bin/prepare_mapped_reads.py\", line 79, in main\r\n    results, args.output, alphabet_info)\r\n  File \"/home/lpryszcz/src/taiyaki/taiyaki/prepare_mapping_funcs.py\", line 101, in generate_output_from_results\r\n    for resultdict, mesg in results:\r\n  File \"/home/lpryszcz/src/taiyaki/taiyaki/iterators.py\", line 361, in imap_mp\r\n    for r in mapper(my_function, args, chunksize=chunksize):\r\n  File \"/usr/lib/python3.6/multiprocessing/pool.py\", line 369, in <genexpr>\r\n    return (item for chunk in result for item in chunk)\r\n  File \"/usr/lib/python3.6/multiprocessing/pool.py\", line 761, in next\r\n    raise value\r\nTypeError: '<' not supported between instances of 'numpy.str_' and 'int'\r\nException ignored in: <generator object iterate_files_reads_unpaired at 0x7f6eef0176d0>\r\nTraceback (most recent call last):\r\n  File \"/home/lpryszcz/src/taiyaki/taiyaki/fast5utils.py\", line 63, in iterate_files_reads_unpaired\r\n  File \"/home/lpryszcz/src/taiyaki/venv/lib/python3.6/site-packages/ont_fast5_api/fast5_file.py\", line 52, in __exit__\r\n  File \"/home/lpryszcz/src/taiyaki/venv/lib/python3.6/site-packages/ont_fast5_api/fast5_file.py\", line 78, in close\r\n  File \"/home/lpryszcz/src/taiyaki/venv/lib/python3.6/site-packages/h5py/_hl/files.py\", line 289, in close\r\n  File \"h5py/_objects.pyx\", line 54, in h5py._objects.with_phil.wrapper (/tmp/pip-tnf92dft-build/h5py/_objects.c:2853)\r\n  File \"h5py/_objects.pyx\", line 55, in h5py._objects.with_phil.wrapper (/tmp/pip-tnf92dft-build/h5py/_objects.c:2811)\r\n  File \"h5py/h5f.pyx\", line 234, in h5py.h5f.get_obj_ids (/tmp/pip-tnf92dft-build/h5py/h5f.c:3450)\r\n  File \"h5py/h5i.pyx\", line 37, in h5py.h5i.wrap_identifier (/tmp/pip-tnf92dft-build/h5py/h5i.c:1145)\r\nImportError: sys.meta_path is None, Python is likely shutting down\r\n```","closed_by":{"login":"lpryszcz","id":988152,"node_id":"MDQ6VXNlcjk4ODE1Mg==","avatar_url":"https://avatars.githubusercontent.com/u/988152?v=4","gravatar_id":"","url":"https://api.github.com/users/lpryszcz","html_url":"https://github.com/lpryszcz","followers_url":"https://api.github.com/users/lpryszcz/followers","following_url":"https://api.github.com/users/lpryszcz/following{/other_user}","gists_url":"https://api.github.com/users/lpryszcz/gists{/gist_id}","starred_url":"https://api.github.com/users/lpryszcz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lpryszcz/subscriptions","organizations_url":"https://api.github.com/users/lpryszcz/orgs","repos_url":"https://api.github.com/users/lpryszcz/repos","events_url":"https://api.github.com/users/lpryszcz/events{/privacy}","received_events_url":"https://api.github.com/users/lpryszcz/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/18/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/18/timeline","performed_via_github_app":null,"state_reason":"completed"}