{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/69","repository_url":"https://api.github.com/repos/nanoporetech/taiyaki","labels_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/69/labels{/name}","comments_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/69/comments","events_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/69/events","html_url":"https://github.com/nanoporetech/taiyaki/issues/69","id":579406651,"node_id":"MDU6SXNzdWU1Nzk0MDY2NTE=","number":69,"title":"--fastq output throws numpy error","user":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":{"login":"aevansNP","id":45230403,"node_id":"MDQ6VXNlcjQ1MjMwNDAz","avatar_url":"https://avatars.githubusercontent.com/u/45230403?v=4","gravatar_id":"","url":"https://api.github.com/users/aevansNP","html_url":"https://github.com/aevansNP","followers_url":"https://api.github.com/users/aevansNP/followers","following_url":"https://api.github.com/users/aevansNP/following{/other_user}","gists_url":"https://api.github.com/users/aevansNP/gists{/gist_id}","starred_url":"https://api.github.com/users/aevansNP/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aevansNP/subscriptions","organizations_url":"https://api.github.com/users/aevansNP/orgs","repos_url":"https://api.github.com/users/aevansNP/repos","events_url":"https://api.github.com/users/aevansNP/events{/privacy}","received_events_url":"https://api.github.com/users/aevansNP/received_events","type":"User","site_admin":false},"assignees":[{"login":"aevansNP","id":45230403,"node_id":"MDQ6VXNlcjQ1MjMwNDAz","avatar_url":"https://avatars.githubusercontent.com/u/45230403?v=4","gravatar_id":"","url":"https://api.github.com/users/aevansNP","html_url":"https://github.com/aevansNP","followers_url":"https://api.github.com/users/aevansNP/followers","following_url":"https://api.github.com/users/aevansNP/following{/other_user}","gists_url":"https://api.github.com/users/aevansNP/gists{/gist_id}","starred_url":"https://api.github.com/users/aevansNP/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aevansNP/subscriptions","organizations_url":"https://api.github.com/users/aevansNP/orgs","repos_url":"https://api.github.com/users/aevansNP/repos","events_url":"https://api.github.com/users/aevansNP/events{/privacy}","received_events_url":"https://api.github.com/users/aevansNP/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2020-03-11T16:51:12Z","updated_at":"2020-03-16T09:08:33Z","closed_at":"2020-03-16T09:08:33Z","author_association":"NONE","active_lock_reason":null,"body":"I rerun basecall.py since the update of taiyaki to output fastq output. I tried this just on some test data include in taiyaki repository and using the flipflop remap model_checkpoint file. This throws an area relating to tensor and numpy. I have little idea of how to go about fixing. \r\n\r\n`\r\n(taiyaki) (base) callum@dgt-gpu1:~$ basecall.py --device cuda:0 --fastq taiyaki/test/data/reads/0f776a08-1101-41d4-8097-89136494a46e.fast5 taiyaki/models/mGru_flipflop_remapping_model_r9_DNA.checkpoint > basecalls.fastq\r\n* Loading model.\r\n/usr/local/src/taiyaki/venv/lib/python3.5/site-packages/torch/serialization.py:453: SourceChangeWarning: source code of class 'taiyaki.layers.Serial' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.\r\n  warnings.warn(msg, SourceChangeWarning)\r\n/usr/local/src/taiyaki/venv/lib/python3.5/site-packages/torch/serialization.py:453: SourceChangeWarning: source code of class 'torch.nn.modules.container.ModuleList' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.\r\n  warnings.warn(msg, SourceChangeWarning)\r\n/usr/local/src/taiyaki/venv/lib/python3.5/site-packages/torch/serialization.py:453: SourceChangeWarning: source code of class 'taiyaki.layers.Convolution' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.\r\n  warnings.warn(msg, SourceChangeWarning)\r\n/usr/local/src/taiyaki/venv/lib/python3.5/site-packages/torch/serialization.py:453: SourceChangeWarning: source code of class 'torch.nn.modules.padding.ConstantPad1d' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.\r\n  warnings.warn(msg, SourceChangeWarning)\r\n/usr/local/src/taiyaki/venv/lib/python3.5/site-packages/torch/serialization.py:453: SourceChangeWarning: source code of class 'torch.nn.modules.conv.Conv1d' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.\r\n  warnings.warn(msg, SourceChangeWarning)\r\n/usr/local/src/taiyaki/venv/lib/python3.5/site-packages/torch/serialization.py:453: SourceChangeWarning: source code of class 'taiyaki.layers.Reverse' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.\r\n  warnings.warn(msg, SourceChangeWarning)\r\n/usr/local/src/taiyaki/venv/lib/python3.5/site-packages/torch/serialization.py:453: SourceChangeWarning: source code of class 'taiyaki.layers.GruMod' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.\r\n  warnings.warn(msg, SourceChangeWarning)\r\n/usr/local/src/taiyaki/venv/lib/python3.5/site-packages/torch/serialization.py:453: SourceChangeWarning: source code of class 'torch.nn.modules.rnn.GRU' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.\r\n  warnings.warn(msg, SourceChangeWarning)\r\n/usr/local/src/taiyaki/venv/lib/python3.5/site-packages/torch/serialization.py:453: SourceChangeWarning: source code of class 'taiyaki.layers.GlobalNormFlipFlop' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.\r\n  warnings.warn(msg, SourceChangeWarning)\r\n/usr/local/src/taiyaki/venv/lib/python3.5/site-packages/torch/serialization.py:453: SourceChangeWarning: source code of class 'torch.nn.modules.linear.Linear' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.\r\n  warnings.warn(msg, SourceChangeWarning)\r\n* Initializing reads file search.\r\n* Found 1 reads.\r\n* Calling reads.\r\nTraceback (most recent call last):\r\n  File \"/usr/local/src/taiyaki/venv/bin/basecall.py\", line 7, in <module>\r\n    exec(compile(f.read(), __file__, 'exec'))\r\n  File \"/usr/local/src/taiyaki/bin/basecall.py\", line 271, in <module>\r\n    main()\r\n  File \"/usr/local/src/taiyaki/bin/basecall.py\", line 245, in main\r\n    args.fastq, args.qscore_scale, args.qscore_offset)\r\n  File \"/usr/local/src/taiyaki/bin/basecall.py\", line 159, in process_read\r\n    qscore_offset)\r\n  File \"/usr/local/src/taiyaki/taiyaki/qscores.py\", line 153, in path_errprobs_to_qstring\r\n    return qchar_from_errprob(filtered_probs, qscore_scale, qscore_offset)\r\n  File \"/usr/local/src/taiyaki/taiyaki/qscores.py\", line 44, in qchar_from_errprob\r\n    qscore = qscore_scale * qscore_from_errprob(errprob) + qscore_offset\r\n  File \"/usr/local/src/taiyaki/taiyaki/qscores.py\", line 31, in qscore_from_errprob\r\n    return -10.0 * np.log10(errprob)\r\n  File \"/usr/local/src/taiyaki/venv/lib/python3.5/site-packages/torch/tensor.py\", line 412, in __array__\r\n    return self.numpy()\r\nTypeError: can't convert CUDA tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.\r\n`","closed_by":{"login":"aevansNP","id":45230403,"node_id":"MDQ6VXNlcjQ1MjMwNDAz","avatar_url":"https://avatars.githubusercontent.com/u/45230403?v=4","gravatar_id":"","url":"https://api.github.com/users/aevansNP","html_url":"https://github.com/aevansNP","followers_url":"https://api.github.com/users/aevansNP/followers","following_url":"https://api.github.com/users/aevansNP/following{/other_user}","gists_url":"https://api.github.com/users/aevansNP/gists{/gist_id}","starred_url":"https://api.github.com/users/aevansNP/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aevansNP/subscriptions","organizations_url":"https://api.github.com/users/aevansNP/orgs","repos_url":"https://api.github.com/users/aevansNP/repos","events_url":"https://api.github.com/users/aevansNP/events{/privacy}","received_events_url":"https://api.github.com/users/aevansNP/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/69/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/69/timeline","performed_via_github_app":null,"state_reason":"completed"}