{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/11","repository_url":"https://api.github.com/repos/nanoporetech/taiyaki","labels_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/11/labels{/name}","comments_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/11/comments","events_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/11/events","html_url":"https://github.com/nanoporetech/taiyaki/issues/11","id":443819308,"node_id":"MDU6SXNzdWU0NDM4MTkzMDg=","number":11,"title":"Error in modbase-walkthrough","user":{"login":"fneuh","id":39982768,"node_id":"MDQ6VXNlcjM5OTgyNzY4","avatar_url":"https://avatars.githubusercontent.com/u/39982768?v=4","gravatar_id":"","url":"https://api.github.com/users/fneuh","html_url":"https://github.com/fneuh","followers_url":"https://api.github.com/users/fneuh/followers","following_url":"https://api.github.com/users/fneuh/following{/other_user}","gists_url":"https://api.github.com/users/fneuh/gists{/gist_id}","starred_url":"https://api.github.com/users/fneuh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fneuh/subscriptions","organizations_url":"https://api.github.com/users/fneuh/orgs","repos_url":"https://api.github.com/users/fneuh/repos","events_url":"https://api.github.com/users/fneuh/events{/privacy}","received_events_url":"https://api.github.com/users/fneuh/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-05-14T09:52:43Z","updated_at":"2019-05-15T11:59:40Z","closed_at":"2019-05-15T11:59:40Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\r\nI am trying to run taiyaki on the data provided in the walkthrough for modified base detection. I installed taiyaki in a virtual environment (taiyaki 4.1.0, torch 1.1.0, numpy 1.16.3).\r\n\r\nWhen running prepare_mapped_reads.py, like this on a GPU, I get the following error message:\r\n\r\nprepare_mapped_reads.py --limit 100 --mod Z C 5mC --mod Y A 6mA reads flo_files/read_params.tsv flo_files/mapped_reads.hdf5 pretrained/r941_dna_minion.checkpoint modbase_references.fasta --overwrite\r\n\r\nRunning prepare_mapping using flip-flop remapping\r\nConverting references to labels using canonical alphabet ACGT with modified base(s) Y=6mA (alt to A), Z=5mC (alt to C)\r\n~/miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/torch-1.1.0-py3.6-linux-x86_64.egg/torch/serialization.py:454: SourceChangeWarning: source code of class 'taiyaki.layers.Serial' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.\r\n  warnings.warn(msg, SourceChangeWarning)\r\n.... more _SourceChangeWarnings_\r\n~/miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/torch-1.1.0-py3.6-linux-x86_64.egg/torch/serialization.py:454: SourceChangeWarning: source code of class 'torch.nn.modules.linear.Linear' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.\r\n  warnings.warn(msg, SourceChangeWarning)\r\n* 82 reads failed to produce remapping results due to: Failure applying basecall network to remap read.\r\n* 18 reads failed to produce remapping results due to: No fasta reference found.\r\n\r\nI narrowed the problem down to line 65 in prepare_mapping_funcs.py:\r\ntransweights = modelOnDevice(signalTensor).cpu().numpy()\r\n\r\nFile \"/users/bsg/kjv309/miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/taiyaki-4.1.0-py3.6-linux-x86_64.egg/taiyaki/prepare_mapping_funcs.py\", line 65, in oneread_remap\r\n    transweights = modelOnDevice(signalTensor).cpu().numpy()\r\n\r\nWhen removing the try .. except statement for this line I get the following error text:\r\n\r\nTraceback (most recent call last):\r\n  File \"./miniconda3/envs/flo_taiyaki/bin/prepare_mapped_reads.py\", line 4, in <module>\r\n    \\__import__('pkg_resources').run_script('taiyaki==4.1.0', 'prepare_mapped_reads.py')\r\n  File \"./miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/pkg_resources/\\__init__.py\", line 666, in run_script\r\n    self.require(requires)[0].run_script(script_name, ns)\r\n  File \"./miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/pkg_resources/\\__init__.py\", line 1453, in run_script\r\n    exec(code, namespace, namespace)\r\n  File \"/gpfs0/./miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/taiyaki-4.1.0-py3.6-linux-x86_64.egg/EGG-INFO/scripts/prepare_mapped_reads.py\", line 83, in <module>\r\n    main()\r\n  File \"/gpfs0/./miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/taiyaki-4.1.0-py3.6-linux-x86_64.egg/EGG-INFO/scripts/prepare_mapped_reads.py\", line 79, in main\r\n    results, args.output, alphabet_info)\r\n  File \"./miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/taiyaki-4.1.0-py3.6-linux-x86_64.egg/taiyaki/prepare_mapping_funcs.py\", line 102, in generate_output_from_results\r\n    for resultdict, mesg in results:\r\n  File \"./miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/taiyaki-4.1.0-py3.6-linux-x86_64.egg/taiyaki/iterators.py\", line 353, in imap_mp\r\n    for r in map(my_function, args):\r\n  File \"./miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/taiyaki-4.1.0-py3.6-linux-x86_64.egg/taiyaki/prepare_mapping_funcs.py\", line 65, in oneread_remap\r\n    transweights = modelOnDevice(signalTensor).cpu().numpy()\r\n  File \"./miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/torch-1.1.0-py3.6-linux-x86_64.egg/torch/nn/modules/module.py\", line 493, in \\__call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"./miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/taiyaki-4.1.0-py3.6-linux-x86_64.egg/taiyaki/layers.py\", line 487, in forward\r\n    x = layer(x)\r\n  File \"./miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/torch-1.1.0-py3.6-linux-x86_64.egg/torch/nn/modules/module.py\", line 493, in \\__call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"./miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/taiyaki-4.1.0-py3.6-linux-x86_64.egg/taiyaki/layers.py\", line 426, in forward\r\n    out = self.activation(self.conv(self.pad(x)))\r\n  File \"./miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/torch-1.1.0-py3.6-linux-x86_64.egg/torch/nn/modules/module.py\", line 493, in \\__call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"./miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/torch-1.1.0-py3.6-linux-x86_64.egg/torch/nn/modules/conv.py\", line 190, in forward\r\n    if self.padding_mode == 'circular':\r\n  File \"./miniconda3/envs/flo_taiyaki/lib/python3.6/site-packages/torch-1.1.0-py3.6-linux-x86_64.egg/torch/nn/modules/module.py\", line 539, in \\__getattr__\r\n    type(self).\\__name__, name))\r\nAttributeError: 'Conv1d' object has no attribute 'padding_mode'\r\n\r\nIs this an issue concerning torch (related to the warnings) or something else? Do you have ideas on this issue?\r\n\r\nThanks,\r\nFlorian","closed_by":{"login":"fneuh","id":39982768,"node_id":"MDQ6VXNlcjM5OTgyNzY4","avatar_url":"https://avatars.githubusercontent.com/u/39982768?v=4","gravatar_id":"","url":"https://api.github.com/users/fneuh","html_url":"https://github.com/fneuh","followers_url":"https://api.github.com/users/fneuh/followers","following_url":"https://api.github.com/users/fneuh/following{/other_user}","gists_url":"https://api.github.com/users/fneuh/gists{/gist_id}","starred_url":"https://api.github.com/users/fneuh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fneuh/subscriptions","organizations_url":"https://api.github.com/users/fneuh/orgs","repos_url":"https://api.github.com/users/fneuh/repos","events_url":"https://api.github.com/users/fneuh/events{/privacy}","received_events_url":"https://api.github.com/users/fneuh/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/11/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/11/timeline","performed_via_github_app":null,"state_reason":"completed"}