[{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/535754494","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-535754494","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":535754494,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTc1NDQ5NA==","user":{"login":"weir12","id":37523816,"node_id":"MDQ6VXNlcjM3NTIzODE2","avatar_url":"https://avatars.githubusercontent.com/u/37523816?v=4","gravatar_id":"","url":"https://api.github.com/users/weir12","html_url":"https://github.com/weir12","followers_url":"https://api.github.com/users/weir12/followers","following_url":"https://api.github.com/users/weir12/following{/other_user}","gists_url":"https://api.github.com/users/weir12/gists{/gist_id}","starred_url":"https://api.github.com/users/weir12/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weir12/subscriptions","organizations_url":"https://api.github.com/users/weir12/orgs","repos_url":"https://api.github.com/users/weir12/repos","events_url":"https://api.github.com/users/weir12/events{/privacy}","received_events_url":"https://api.github.com/users/weir12/received_events","type":"User","site_admin":false},"created_at":"2019-09-27T02:10:53Z","updated_at":"2019-09-27T02:10:53Z","author_association":"NONE","body":"I have a question,for the RNA sample, should the alphabet be '**ACGT**' or '**ACGU**'?","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/535754494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"weir12","id":37523816,"node_id":"MDQ6VXNlcjM3NTIzODE2","avatar_url":"https://avatars.githubusercontent.com/u/37523816?v=4","gravatar_id":"","url":"https://api.github.com/users/weir12","html_url":"https://github.com/weir12","followers_url":"https://api.github.com/users/weir12/followers","following_url":"https://api.github.com/users/weir12/following{/other_user}","gists_url":"https://api.github.com/users/weir12/gists{/gist_id}","starred_url":"https://api.github.com/users/weir12/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weir12/subscriptions","organizations_url":"https://api.github.com/users/weir12/orgs","repos_url":"https://api.github.com/users/weir12/repos","events_url":"https://api.github.com/users/weir12/events{/privacy}","received_events_url":"https://api.github.com/users/weir12/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/535758209","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-535758209","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":535758209,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTc1ODIwOQ==","user":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"created_at":"2019-09-27T02:25:09Z","updated_at":"2019-09-27T02:25:41Z","author_association":"NONE","body":"> I have a question,for the RNA sample, should the alphabet be '**ACGT**' or '**ACGU**'?\r\n\r\nFrom my understanding, in essence you can choose so long as its maintained through the initial base calling with guppy, Resquiggle, and then training.\r\n\r\nI am unsure what guppy is doing underneath as the RNA config files defaults to convert U to T unless you turn it off with the `--u_substitution false`. Thats why I think there may be conflict with my model being used with any RNA config file for guppy. \r\n\r\nIn principle its probably best to stick to ACGU for RNA in hindsight. I think I may start again. \r\n\r\nDid you notice any low base call qualities output by guppy with your ACGU alphabet model? ","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/535758209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/535778844","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-535778844","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":535778844,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTc3ODg0NA==","user":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"created_at":"2019-09-27T04:17:11Z","updated_at":"2019-09-27T04:17:11Z","author_association":"NONE","body":"This is the output of mapped signal and output of training 1 and 2 \r\n\r\n<img width=\"1195\" alt=\"Screen Shot 2019-09-27 at 5 05 22 AM\" src=\"https://user-images.githubusercontent.com/41637575/65741598-7ca71200-e0e4-11e9-81f6-8ef8713fc4b5.png\">\r\n\r\n<img width=\"639\" alt=\"Screen Shot 2019-09-27 at 5 10 20 AM\" src=\"https://user-images.githubusercontent.com/41637575/65741862-9dbc3280-e0e5-11e9-97dd-981c9547ffcb.png\">\r\n\r\n<img width=\"638\" alt=\"Screen Shot 2019-09-27 at 5 10 46 AM\" src=\"https://user-images.githubusercontent.com/41637575/65741969-086d6e00-e0e6-11e9-89af-48c5e3f8b5c6.png\">\r\n","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/535778844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/535881057","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-535881057","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":535881057,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTg4MTA1Nw==","user":{"login":"myrtlecat","id":1001949,"node_id":"MDQ6VXNlcjEwMDE5NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1001949?v=4","gravatar_id":"","url":"https://api.github.com/users/myrtlecat","html_url":"https://github.com/myrtlecat","followers_url":"https://api.github.com/users/myrtlecat/followers","following_url":"https://api.github.com/users/myrtlecat/following{/other_user}","gists_url":"https://api.github.com/users/myrtlecat/gists{/gist_id}","starred_url":"https://api.github.com/users/myrtlecat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/myrtlecat/subscriptions","organizations_url":"https://api.github.com/users/myrtlecat/orgs","repos_url":"https://api.github.com/users/myrtlecat/repos","events_url":"https://api.github.com/users/myrtlecat/events{/privacy}","received_events_url":"https://api.github.com/users/myrtlecat/received_events","type":"User","site_admin":false},"created_at":"2019-09-27T10:14:56Z","updated_at":"2019-09-27T10:14:56Z","author_association":"CONTRIBUTOR","body":"The choice between ACGT and ACGU should not matter, as long as the alphabet used for `prepare_mapped_reads.py` is consistent with the per-read references you provide (i.e. if you use Ts in the references then use `ACGT`).\r\n\r\nThe accuracy of the basecalls is much better than the Q-scores imply, which indicates a problem with the calibration of the Q-scores. We don't calculate Q-scores in taiyaki, this is only done in guppy, so I'm afraid I don't know exactly why this could happen.\r\n\r\nI note however that guppy applies a shift and scale to the Q-scores, and these seem to be different for each model. If you ask on the community you may get an answer from the guppy devs about how these are determined. In the meantime you can adjust these with the command line arguments for guppy: `--qscore_offset` and `--qscore_scale`, or you can adjust the pass/fail cutoff with `--min_qscore`.","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/535881057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"myrtlecat","id":1001949,"node_id":"MDQ6VXNlcjEwMDE5NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1001949?v=4","gravatar_id":"","url":"https://api.github.com/users/myrtlecat","html_url":"https://github.com/myrtlecat","followers_url":"https://api.github.com/users/myrtlecat/followers","following_url":"https://api.github.com/users/myrtlecat/following{/other_user}","gists_url":"https://api.github.com/users/myrtlecat/gists{/gist_id}","starred_url":"https://api.github.com/users/myrtlecat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/myrtlecat/subscriptions","organizations_url":"https://api.github.com/users/myrtlecat/orgs","repos_url":"https://api.github.com/users/myrtlecat/repos","events_url":"https://api.github.com/users/myrtlecat/events{/privacy}","received_events_url":"https://api.github.com/users/myrtlecat/received_events","type":"User","site_admin":false}},{"id":2679508236,"node_id":"MDExOkNsb3NlZEV2ZW50MjY3OTUwODIzNg==","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/2679508236","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-10-02T06:59:56Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/634014383","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-634014383","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":634014383,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDAxNDM4Mw==","user":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false},"created_at":"2020-05-26T13:09:33Z","updated_at":"2020-05-26T13:10:52Z","author_association":"NONE","body":"Hi @callumparr \r\n\r\nDid the U to T substitution help in the end?\r\n\r\nThanks a lot for describing your workflow above. I am working as well with IVT RNA (U or modified U) and I would like to train guppy to recognize the modified U as canonical U/T. I struggle with creating the reference files for the reads. Would you be open for sharing your detailed protocol?\r\n\r\nAt the moment I do the following steps.\r\n\r\nguppy_basecaller -i ~fast5/ --config rna_r9.4.1_70bps_hac.cfg --reverse_sequence 1  --min_qscore 7 --calib_detect 1\r\nminimap2 -ax splice -uf -k14 ~/RNA_reference.fasta ~/*.fastq > ~/reads.sam\r\n\r\nThen I convert all T to Y and modify to a file = >ID and sequence below --> save as read_referencs.fasta\r\n\r\ngenerate_per_read_params.py --jobs 32 ~/fast5/ > read_params.tsv\r\nprepare_mapped_reads.py  --jobs 32 ~/fast5/ read_params.tsv mapped_reads.hdf5  pretrained/r941_rna_minion.checkpoint read_references.fasta\r\ntrain_flipflop.py --size 256 --stride 10 --winlen 31 --device 1 --mod_factor 0.01 --outdir ~/output/training1/ ~/taiyaki/models/mGru_flipflop.py mapped_reads.hdf5\r\ntrain_flipflop.py --size 256 --stride 10 --winlen 31 --device 1 --mod_factor 1.0 --outdir ~/output/  ~/training1/model_final.checkpoint mapped_reads.hdf5\r\n\r\n#Export and run guppy\r\ndump_json.py training/model_final.checkpoint > model.json\r\nguppy_basecaller -i reads -s basecalls_new -c /opt/ont/guppy/data/rna_r9.4.1_70bps_hac.cfg -m /model.json --device cuda:0 --reverse_sequence 1 --u_subsitution 1 --min_qscore 7 --calib_detect 1\r\n\r\nMany thanks in advance for your inputs!\r\n","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/634014383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false}},{"id":3373467869,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzM3MzQ2Nzg2OQ==","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3373467869","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-05-26T13:09:33Z","performed_via_github_app":null},{"id":3373467872,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMzNzM0Njc4NzI=","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3373467872","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-05-26T13:09:33Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/634033582","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-634033582","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":634033582,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDAzMzU4Mg==","user":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"created_at":"2020-05-26T13:43:30Z","updated_at":"2020-05-26T14:34:57Z","author_association":"NONE","body":"After some further reading the U:T substitution was the not problem but rather the scaling factors that guppy requires to calibrate suitable basecall qualities (i.e. to give fastq format instead of fasta). Since I posted this there has been an update of taiyak that generates a scaling factor but I have not actually gone back and redone this. I kind of lost track with it all.\r\n\r\nhttps://github.com/nanoporetech/taiyaki/issues/56#issuecomment-544411746 \r\nhttps://github.com/nanoporetech/taiyaki/blob/master/misc/calibrate_qscores_byread.py \r\nI think the basecall.py script nows supports FASTQ output now anyhow\r\n\r\nAre you working with 100% modified transcripts from IVT?\r\n\r\nSorry maybe I misread but it sounds like you don't care so much where the modification is just you want to basecall quality to be recovered when using modified nucleotides in your IVT reactions? May ask what is the final endpoint? In this case, I think you can generate a much simpler model following the normal walkthrough documentation. This will generate a model where the modified base is flattened and relearnt as canonical (I think? Maybe better to confirm this with taiyaki author). However if at the end you are interested in the modifications themselves, i.e. you want to know where it is modified you will need to do what you are doing as a way to get there. I think this is correct what you are doing. \r\n\r\nSorry, the reply sent before I could finish. To generate the reference fasta you actually need to go back to the canonical basecaller training. \r\n\r\nhttps://github.com/nanoporetech/taiyaki/blob/master/docs/walkthrough.rst \r\n\r\n```\r\nbin/get_refs_from_sam.py <genomic references fasta> <one or more SAM/BAM files> --output \r\n<name of output reference_fasta>\r\n```\r\n\r\nThere is a script that will output for the input reads you have, a readID and the mapped reference sequence (not the actual guppy basecall output). One additional thing is that these reference sequences need to be reversed to match the physical processing of direct RNA sequencing reads in nanopore chemistry, guppy by default will reverse the output for you to match the reference. I then manually (of course not manually but without a script and using seqkit convert 'T' to 'Y'. Then proceed as you have described. If you made an obviously mistake it will likely say your signals are out of the variation expected when you go to train. \r\n\r\nIf you do not have 100% modified U replacement. Then this gets more tricky. And to be honest I gave up from here. To generate the reference fasta containing the locations of modifications (your ground truth) I believe it's possible to use tools like Tombo to tell you at a per read level where modifications are located (just not what the modification is). I heard Tombo has a fairly high false discovery rate though so I am unsure how helpful this will be. You could simply also mark modified U by basecall quality and alignment with reference. I guess a lot of this time you will get genuine sequencing errors though which will be mislabelled as modified U. \r\n\r\nI should say this model I generated is very limited as it was only trained with a few genes so it did very badly when applying to an entire cDNA library. This is when I moved onto generating a whole transcriptome IVT library with just 30% modification and I got demoralized. ","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/634033582/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/634050484","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-634050484","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":634050484,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDA1MDQ4NA==","user":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false},"created_at":"2020-05-26T14:11:45Z","updated_at":"2020-05-26T14:11:45Z","author_association":"NONE","body":"@callumparr Thanks for your prompt feedback!\r\n\r\nHow did you create the file with the reference for each read? ","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/634050484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false}},{"id":3373745307,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzM3Mzc0NTMwNw==","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3373745307","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-05-26T14:11:45Z","performed_via_github_app":null},{"id":3373745310,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMzNzM3NDUzMTA=","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3373745310","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-05-26T14:11:45Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/634056976","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-634056976","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":634056976,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDA1Njk3Ng==","user":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"created_at":"2020-05-26T14:22:38Z","updated_at":"2020-05-26T14:22:38Z","author_association":"NONE","body":"> @callumparr Thanks for your prompt feedback!\r\n> \r\n> How did you create the file with the reference for each read?\r\n\r\nSorry I keep pressing ctrl return before finishing the reply. Please see above. ","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/634056976/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false}},{"id":3373794149,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzM3Mzc5NDE0OQ==","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3373794149","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-05-26T14:22:38Z","performed_via_github_app":null},{"id":3373794157,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMzNzM3OTQxNTc=","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3373794157","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-05-26T14:22:38Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/634075760","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-634075760","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":634075760,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDA3NTc2MA==","user":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false},"created_at":"2020-05-26T14:53:05Z","updated_at":"2020-05-26T14:53:47Z","author_association":"NONE","body":"Your explanations are all very helpful!\r\n\r\nYes, its 100% IVT RNA where all U are modified and I don't care of finding the position where the modification is, but rather having a correct basecalling when performing guppy. \r\n\r\nbin/get_refs_from_sam.py <genomic references fasta> <one or more SAM/BAM files> --output \r\n<name of output reference_fasta>\r\n\r\nCreating the <one or more SAM/BAM files> is for me difficult to follow. As guppy is not calling the ground truth of the bases correct in the first place as its a non-trained model. You are saying, that I don't have to use the actual guppy output. What then?\r\n\r\nThanks!","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/634075760/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/634096018","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-634096018","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":634096018,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDA5NjAxOA==","user":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"created_at":"2020-05-26T15:26:06Z","updated_at":"2020-05-26T15:26:06Z","author_association":"NONE","body":"Ah OK I follow you. So depending on the % of modified rNTP replacement you would expect that the basecall quality to be way off so you are kinda restricted in the number of reads you can use. \r\n\r\nYou have to use the guppy output pass reads that you can get (even if this 30% of the original total read number). You should still be able to map these reads, although they, of course, will have many 'mutations' relative to unmodified UTP mRNA.  Minimap2 will still give you something to work with, i.e. the start and endpoint of mapped read that is extracted by `get_refs_from_sam.py`\r\n\r\nThe rest of the training will then get you to a point where you can rebasecall your test set. \r\n\r\nBased on your reply I think you can follow the normal walthrough.rst instead of generating a modbase model. But if you do want to generate a mod base model, there is something I forgot. \r\n\r\nIf you generated reads with 100% modified UTP you also need to provide the training with some unmodified reads as well, otherwise it will never learn what a canonical UTP raw signal look like. So you need to in parallel generate some read chunks and a match reference sequence but of course **not** substituting T for Y. You can then combine the reads together in a single directory and proceed with the following steps. For simplicity I did 50:50 (reads w/ 100% mod rUTP: reads w/ rUTP). You can imagine that this whole process may be biased as the unmodified reads will be a more broad dataset because it has no issues with being mapped. Perhaps you can do this to generate a model that you can later use for a second round of training on new data, like an intermediate. \r\n\r\nMake sure to partition any useable FASTQ data from the beginning, so you have some to test your brand spanking new model on. I may have got too excited and not realised this until the end and had to start again.  ","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/634096018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/634102319","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-634102319","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":634102319,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDEwMjMxOQ==","user":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false},"created_at":"2020-05-26T15:35:46Z","updated_at":"2020-05-26T15:35:46Z","author_association":"NONE","body":"That makes absolutely sense! I will try as you described and keep you posted how it goes!\r\n\r\nThanks a lot!","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/634102319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/636834316","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-636834316","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":636834316,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjgzNDMxNg==","user":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false},"created_at":"2020-06-01T12:32:54Z","updated_at":"2020-06-01T12:32:54Z","author_association":"NONE","body":"Hi @callumparr \r\n\r\nYou are correct that the normal walkthrough should work as all U are modified and the purpose is to read the modified U as canonical U.\r\n\r\nI struggle always with the get_refs_from_sam.py is always blank, which I dont understand. The reference RNA is flipped to 3' to 5'. Is something wrong with my input bam file?\r\n\r\nguppy_basecaller -i ~/fast5/ --config rna_r9.4.1_70bps_hac.cfg --reverse_sequence 1 --u_substitution 1 --min_qscore 7 \r\nminimap2 -ax map-ont -t 8 ~/RNA_reference.fasta ~/guppy/*.fastq | samtools sort -o reads.sorted.bam -T reads.tmp\r\nget_refs_from_sam.py ~/RNA_reference.fasta ~/reads.sorted.bam --output ~/reads.references.fasta --reverse \r\n\r\nThanks for your inputs!","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/636834316/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false}},{"id":3392922122,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzM5MjkyMjEyMg==","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3392922122","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-06-01T12:32:54Z","performed_via_github_app":null},{"id":3392922123,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMzOTI5MjIxMjM=","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3392922123","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-06-01T12:32:54Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/637574170","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-637574170","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":637574170,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNzU3NDE3MA==","user":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"created_at":"2020-06-02T14:20:14Z","updated_at":"2020-06-02T14:20:14Z","author_association":"NONE","body":"Guppy with RNA config will reverse the sequence by default and will also substitute T > U by default as well. May save you a seconds typing. \r\n\r\nJust for clarification because was a little unsure from what you wrote. The input for minimap2 should be the standard FASTQ you'd normally use (i.e. 5' -> 3' in respect to the genome/transcriptome reference). The `get_refs_from_sam.py` will then match read ID with the reference sequence and also flip it from the normal 5' -> to 3' to 3' -> 5' that is required for the `prepare_mapped_reads.py`\r\n\r\nWhat kind of reference are you using? Do you see any mapped reads? or just the `*` in the matches. Even with 100% replacement, I could at least get 30 ~ 40% of 'passed' reads mappable to a custom transcriptome I provided. \r\n\r\nHere is one of the BAM files I have for example with a few lines. It includes reads unable to be mapped. \r\n\r\ncommand was \r\n\r\n```\r\n@PG     ID:minimap2     PN:minimap2     VN:2.16-r922    CL:minimap2 -t 8 -2 -ax map-ont -I 16G -uf --secondary=no Documents/multi_reads/IVT_minus_polyA.fasta Documents/multi_reads/taiyaki_input/190417_5EU_modified_RNA/190417_5EU_mo\r\n\r\n```\r\n\r\n```\r\n97cc7475-4359-4a32-ad49-59f706b352c4    0       IVT_ALKBH5      168     60      99S22M2D1M2D10M1D3M1D2M2D5M1I4M3D2M2D28M3I15M2I13M1I3M1I6M1I4M3D55M3D21M1I1M2D12M1I26M1D2M1D8M2I2M1D20M2I3M1I13M1I11M1D1M1D11M1D4M1I6M1D14M1I4M1I5M1D3M\r\n0c70109f-3014-4a48-8c1b-ba6a6dd3b0b1    0       IVT_ALKBH5      117     51      62S29M1D11M1I2M2D3M2D20M1I3M2D1M1D7M2D7M3I8M1D14M1I20M1I7M1D4M1D11M1I2M2D5M1I2M3D5M2D1M1D7M3I19M1D12M1I1M2I27M1D14M1I15M1D4M1D17M1I15M2I16M4D5M2I13M1I9\r\nc5a2d0a8-abc3-44e3-aaf5-a913f0088b07    0       IVT_ALKBH5      117     57      70S22M1D4M1D3M1I10M3I1M1D2M3D21M1D3M2D1M2D13M1D11M1D32M4I5M2I19M1I3M2D13M1D3M3D29M1I41M2I30M1D18M1I28M1D7M1I4M1I12M1I25M1D4M1I2M1I5M2I16M1D9M1I16M1D5M1\r\n9830c133-c960-4ff3-8151-e5ba4d9fa0d8    0       IVT_ALKBH5      42      49      20M3D25M4D4M1D11M3D3M2D6M3D6M1I9M1I6M1I10M1I5M1D20M2D7M2I11M1I3M2D41M1I4M2D2M3I16M1I12M1D6M2D3M1D55M1I11M3I17M1D6M3D10M1D4M2I13M1D19M3D18M1I2M1I10M1D12\r\n73afc69e-e88a-4c3e-afe4-9f7e3ff7ecfb    0       IVT_ALKBH5      172     35      127S13M4D5M1I30M2D19M1I8M1I5M2I19M2D2M1I14M1D5M3I4M1D6M1D26M1I17M1I11M1D2M2D4M1D20M1D4M1D54M1I3M1I2M3I11M1I3M1I5M1D6M1D14M1I11M3I20M3D11M2I3M1D10M1D10M\r\na20077aa-fce1-418c-bbe1-ebbc961952c7    0       IVT_ALKBH5      168     58      112S22M2I44M1D6M1I17M1I6M1D7M1D4M1D8M1D10M4D32M1I12M1D9M1I23M2D15M1D6M1I14M1I2M1D29M5D6M1D7M3I6M1I9M1I6M1D37M2D13M1D7M1D17M1I8M1I10M1I5M2D9M4D8M8I8M3I2\r\n74cbec58-8464-4450-a3ba-77ee3c5e92dd    0       IVT_ALKBH5      613     29      34S9M1I3M1I2M2D6M1D25M2I5M2D5M2D25M1I12M1D14M2D5M2D7M1D19M2D1M2D11M1D10M1D7M1I12M1I3M1D4M1D12M1D5M1I40M1D9M1I9M8I7M4I6M1D15M1D24M5I9M2D2M1I24M1I18M3I5M\r\ne06c67bf-cbea-42fa-9381-fee81c8b98ba    0       IVT_ALKBH5      167     20      118S11M1I8M1D17M1I2M4D10M1D7M1D10M1D11M1I1M1I8M4I17M1D8M2D12M1D1M2I27M1I2M3D48M1D6M3D7M2I22M1I4M3D12M3D16M3I2M1I6M1I6M1I10M1I3M2I18M2D5M2I7M1I8M2D3M1I1\r\n995edd5b-725b-49d1-8258-54ad54ba6840    0       IVT_ALKBH5      120     8       70S16M1D24M1D3M1D24M2D13M1I20M2I8M1I7M1I10M1D7M2I8M1I5M3I6M1I9M1I3M1I11M1I33M2D2M3D11M1I6M3I19M1D5M2I6M2D31M1I28M1D3M2I7M2I21M3I8M4I3M1D10M1I21M1D3M1I9\r\nd6d92aea-229a-4fae-b777-f315ccb9e324    0       IVT_ALKBH5      113     2       63S4M1I22M1D7M1I4M2D3M1I5M1D21M4D4M5I9M2D4M1I14M1D8M2I10M1D7M1I3M1D7M2I6M1D12M1I8M2I4M1I12M1D25M3I2M1D1M2D24M1D11M1I6M2I2M1I7M1D2M1I12M3I3M1D8M1D5M1I2M\r\n448ffc64-86bb-4eb6-9d1a-7f683096635a    4       *       0       0       *       *       0       0       ACTTAACCTGAGCCCTAACATTGAACAGATTGAACTCAAAAAGAACACCCTTCAGAAATCAGAAGCGAGGGGCCCGGGCTGAAGGAGAACGTCCTGTCCACACCGTACATCAGCTCCCCGAAAAGAA\r\n19e38287-d98e-4c30-aa9d-8d18c976fa84    4       *       0       0       *       *       0       0       AAACACTCCTCCCATTTAACCTGAGCTCCAACACATAACTAGATTGAACAAAAAGAACACATCCTCTAGAAATCAGAGCGAGGGCACCTAGGCTGGGAAGGAGAATGCTCAGCACACATCAGCATTA\r\n6bbf5b3a-a7a7-4f74-bc59-45cfbe286a19    0       IVT_ALKBH5      106     60      49S12M1I21M4I5M2D13M3I3M1I3M3D7M1I9M2I9M1D11M1D21M1I23M1D7M1D4M2D14M2D17M3D20M1I30M2D3M4D7M1I15M1D14M1D9M1D13M1I10M1I3M1I12M1D3M1I23M1I9M2I7M2I3M2D9M1I\r\naf1ffab6-d9f2-4e83-94cf-0d6a0a79cf31    0       IVT_ALKBH5      118     1       75S16M1D9M1D13M1I6M3D16M4D4M1D2M1I26M1D6M1I32M1I5M2I10M1I3M1D4M3D2M2D8M1D48M2D15M2D11M1D5M1I13M1D6M1D16M1D9M2D1M2D1M1D19M1I2M1I16M1I8M1D7M1I13M1D12M2I8\r\n915819b7-3304-4c25-a831-52373c837c3d    0       IVT_ALKBH5      201     1       133S11M1D7M1D12M2I31M5I1M2I8M1D3M1I9M1D11M1D1M1D5M2I21M1I5M2D5M1I2M1D15M1D5M1D3M1D14M3D1M1I9M2D19M2D16M1I5M1D20M2D11M1I4M1I6M1I5M1D1M1D20M1I24M1I6M1D21\r\ncc078043-229e-4e2a-a38a-c38c740feb0c    4       *       0       0       *       *       0       0       CGTGACAAGACTGCTGGAACGTGGGCCAGGACTACACTGCCAATATCCTCTTGGAGCCATCTACCCATCGAGCACTTTCCCAAGGCAGCCCCTACCACGGGGACTACCCCCACCAGGGCCACGTACC\r\n40b56031-92a7-467e-95d2-3aa7ab2b5dc7    4       *       0       0       *       *       0       0       CAGCCAGGACGAGCGCGCCAGAACCGAGGCCCATCTGACGGGTGGCGCCCGCGCTGAGAAGGGCCCGGCAACGAGCACACTGTGGACATGGGCCCCTGCGCAACAAGATCCCACTGCGAAGGCCATA\r\neb795138-e3e0-4ee0-8899-b99d58eec89a    4       *       0       0       *       *       0       0       ACAAAGCAGCCTACAGCTTTCCCGGTCGTCTTTAGTGGATCTCATAAAGAGGTCCCCTGCCACCCATCCCTCAACAGCCCTGCTCTAGTGGCATCAATATAGAAGCATCAGCAGCCGGAAGGCTCCT\r\n1d59f2ee-e36c-4b53-b266-14f09ac4151d    4       *       0       0       *       *       0       0       AGGCATGAGCACAGGAGAACACCCCAGAAATGCATTGCTACAGCCATAAGGAACAATTCTGCCGAAAAACACCGCCTCGAGGTCGGGCCTCAGTGCTGGATTCCTGGTGCTTGGAACCAAGAGGAAG\r\n43b7f273-125a-425f-9508-114ac4d6ef09    4       *       0       0       *       *       0       0       GAGAGAAAGAAGAAGTGGATAGAAATTGGACTTCGAATACCGTTCACTTGCTTCTTCTTCTTCTTTTTTTTCCTGGACTTACAAGGACGATGGTTGTTTGACCCCCGTGATGTGCTAGGCTGTATGT\r\nbebb6d3f-f3b0-435b-9ea4-a64ec4fe7916    4       *       0       0       *       *       0       0       GGGACGATTCTCGCAGCGTATCCTTATGCGAGCACTTTCAAACGTGGACGGTGGCGCTGCAAGGGAGCGGCTGCTCTCTGCCCCCGCTGAACAAGTTGCTGGAACGCTGGCCATCCAGGAACACTGC\r\n6630e873-2bd5-4111-a625-252a377c6721    4       *       0       0       *       *       0       0       CTCCCCCTCATCGACGTGCCTGCATATCCCGAACCAGACATTCATCGTCCGTACAAAAAGCAGGCCCTTTCCTTGGGAACCATCAGCCGCCCGGCGGCCGCCAGCGGCATCACGGACCCCCGCGCTG\r\n128adcb3-0ac1-46e0-a6ef-04ba6154b3dd    4       *       0       0       *       *       0       0       GACCCTGGCAAAGCGACCATCGAGGAGCAGCGGCTGCAGGAAGGGGAGGAGGCGCGCTGTGAAGGCGGCATCCGCCAGATGCGCCCCTCCCACAGCCAGGATGAGCGCCAAGAACCGAGGCCCGTCT\r\ndafd69ab-4cf1-4555-88e8-3a7f42c32ed4    4       *       0       0       *       *       0       0       TGGACGTCATGGACAACCCTGGGCAGGGTCCGCTGATGTGATGGCTGACCTCTCCCCGGGAACCACTTGGAAACCCTGCCCCACCATGGGACCCTGACAGACTGTCGAGACCGCGCAGGGCTCAAAC\r\n3c237095-da6c-4d22-a13d-263a4f1a6172    0 \r\n\r\n```\r\n\r\nI remembered to additional things I did. \r\n\r\n1. \r\n\r\nI noticed from my in vitro transcription reaction there were lots of small read fragments. I think this quite common within _in vitro_ transcription, there are lots of false starts from the T7 promoter.  I did not want these reads so I filtered them out using `NanoFilt` using a minimum basecall length. I followed this by then filtering out these reads from my raw fast5 data using `fast5_fetcher` (at the time these had to be in single fast5 files rather than multi_fast5 I think this is still the case, not sure). At the same time, I also filtered the fast5 files that were mapped in the initial mapping from guppy step. I think this step is unnecessary but just to make it cleaner. \r\n\r\n1. Additionally, during the mapping, I used a transcriptome without poly-A tails. I think ultimately this makes no difference as these are usually not mapped anyway because guppy still does a poor job of basecalling this part of the read won't align whatever.  Again in my head, this seemed cleaner but I have no idea. \r\n\r\nI still unsure how taiyaki and guppy deals with poly-A tails or if direct RNA sequencing just ignores this and you still have to use tools like nanopolish to go into the raw data. ","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/637574170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/637635318","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-637635318","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":637635318,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNzYzNTMxOA==","user":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false},"created_at":"2020-06-02T15:42:11Z","updated_at":"2020-06-02T15:42:11Z","author_association":"NONE","body":"Thanks for the feedback.\r\n\r\nFor the reference I use the RNA (1.4kb, tried both 5'to3' and 3'to5'). The reference has a polyA.\r\n\r\nThe minimap2 seems to work. Just an example of my output:\r\n\r\nPG     ID:minimap2     PN:minimap2     VN:2.17-r941    CL:minimap2 -ax splice -uf -k14 --secondary=no /Sequencing/References/RNA.fasta /guppy_firstround/subsampling/pass.fastq\r\n719640bb-b4b2-4a8c-9543-348ff0f5d3b2    4       *       0       0       *       *       0       0       TACGCTACTACCTA....etc\r\n\r\nThe sequences in the minimap2 output are up to 1.4kb long. So that seems to work. But when I do \"get_refs_from_sam.py\" as describe in the box above, I get:\r\n\r\n>eb708d03-19f6-493a-bf23-154c36aac378\r\nNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\r\n>f5dece0f-baac-444c-94df-5b5e913d035e\r\nNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\r\n>139a9a7b-6f44-4b5d-af85-c39ab2454561\r\nNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\r\n\r\netc...\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/637635318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/638006201","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-638006201","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":638006201,"node_id":"MDEyOklzc3VlQ29tbWVudDYzODAwNjIwMQ==","user":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"created_at":"2020-06-03T07:15:37Z","updated_at":"2020-06-03T07:15:37Z","author_association":"NONE","body":"hmmm that's weird. Not sure why you are getting undetermined bases in the end. \r\n\r\nYou definitely do not need to reverse the reference though. The reference file stays static throughout, the get_refs_from_sam.py will reverse the ground truth sequence for each read (this sequence is lifted from the reference file to where your read maps). What is your reference? \r\n\r\nIt's a bit difficult to tell from the line of the SAM/BAM if this is working. You can run `samtools stats` to see the overall summary of mapping statistics. I haven't used the script since August last year so maybe there is something weird happening. Better to raise an issue specific to the Ns being output. ","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/638006201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/638029203","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-638029203","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":638029203,"node_id":"MDEyOklzc3VlQ29tbWVudDYzODAyOTIwMw==","user":{"login":"tmassingham-ont","id":19410440,"node_id":"MDQ6VXNlcjE5NDEwNDQw","avatar_url":"https://avatars.githubusercontent.com/u/19410440?v=4","gravatar_id":"","url":"https://api.github.com/users/tmassingham-ont","html_url":"https://github.com/tmassingham-ont","followers_url":"https://api.github.com/users/tmassingham-ont/followers","following_url":"https://api.github.com/users/tmassingham-ont/following{/other_user}","gists_url":"https://api.github.com/users/tmassingham-ont/gists{/gist_id}","starred_url":"https://api.github.com/users/tmassingham-ont/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmassingham-ont/subscriptions","organizations_url":"https://api.github.com/users/tmassingham-ont/orgs","repos_url":"https://api.github.com/users/tmassingham-ont/repos","events_url":"https://api.github.com/users/tmassingham-ont/events{/privacy}","received_events_url":"https://api.github.com/users/tmassingham-ont/received_events","type":"User","site_admin":false},"created_at":"2020-06-03T07:57:14Z","updated_at":"2020-06-03T08:26:54Z","author_association":"CONTRIBUTOR","body":"Hello @Wildstrubu .  Are the sequences in your reference file lower case?  There is a  misbehaviour in the current release of Taiyaki that causes lowercase bases to be mapped to ambiguity characters, which could explain what you are seeing.\r\n\r\n@callumparr many thanks for the excellent help you've been giving so far.  ","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/638029203/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tmassingham-ont","id":19410440,"node_id":"MDQ6VXNlcjE5NDEwNDQw","avatar_url":"https://avatars.githubusercontent.com/u/19410440?v=4","gravatar_id":"","url":"https://api.github.com/users/tmassingham-ont","html_url":"https://github.com/tmassingham-ont","followers_url":"https://api.github.com/users/tmassingham-ont/followers","following_url":"https://api.github.com/users/tmassingham-ont/following{/other_user}","gists_url":"https://api.github.com/users/tmassingham-ont/gists{/gist_id}","starred_url":"https://api.github.com/users/tmassingham-ont/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmassingham-ont/subscriptions","organizations_url":"https://api.github.com/users/tmassingham-ont/orgs","repos_url":"https://api.github.com/users/tmassingham-ont/repos","events_url":"https://api.github.com/users/tmassingham-ont/events{/privacy}","received_events_url":"https://api.github.com/users/tmassingham-ont/received_events","type":"User","site_admin":false}},{"id":3400909476,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzQwMDkwOTQ3Ng==","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3400909476","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-06-03T07:57:14Z","performed_via_github_app":null},{"id":3400909479,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM0MDA5MDk0Nzk=","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3400909479","actor":{"login":"callumparr","id":41637575,"node_id":"MDQ6VXNlcjQxNjM3NTc1","avatar_url":"https://avatars.githubusercontent.com/u/41637575?v=4","gravatar_id":"","url":"https://api.github.com/users/callumparr","html_url":"https://github.com/callumparr","followers_url":"https://api.github.com/users/callumparr/followers","following_url":"https://api.github.com/users/callumparr/following{/other_user}","gists_url":"https://api.github.com/users/callumparr/gists{/gist_id}","starred_url":"https://api.github.com/users/callumparr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callumparr/subscriptions","organizations_url":"https://api.github.com/users/callumparr/orgs","repos_url":"https://api.github.com/users/callumparr/repos","events_url":"https://api.github.com/users/callumparr/events{/privacy}","received_events_url":"https://api.github.com/users/callumparr/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-06-03T07:57:14Z","performed_via_github_app":null},{"id":3400909481,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzQwMDkwOTQ4MQ==","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3400909481","actor":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-06-03T07:57:14Z","performed_via_github_app":null},{"id":3400909486,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM0MDA5MDk0ODY=","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3400909486","actor":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-06-03T07:57:14Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/638161567","html_url":"https://github.com/nanoporetech/taiyaki/issues/53#issuecomment-638161567","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/53","id":638161567,"node_id":"MDEyOklzc3VlQ29tbWVudDYzODE2MTU2Nw==","user":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false},"created_at":"2020-06-03T12:22:19Z","updated_at":"2020-06-03T12:22:19Z","author_association":"NONE","body":"Yes, the reference file had lower case. Now its working :) That simple, cant believe it. I am new to this type of analysis and thought that I miss something more substantial, but its in the details...\r\n\r\nThanks @callumparr for your insightful inputs, learned a lot!\r\n\r\n@tmassingham-ont maybe if I can double check that my reference file is correct.\r\n\r\nReference file:\r\n- upper case letters :)\r\n- Type: RNA\r\n- Orientation: 5' to 3'\r\n- T/U should not make a difference (?)\r\n- Since all U are modified, should they stay as U or need they to be converted to Y (for example) to tell taiyaki that this type of nucleotide are modified?\r\n\r\nThanks!\r\n","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/638161567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Wildstrubu","id":61328723,"node_id":"MDQ6VXNlcjYxMzI4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/61328723?v=4","gravatar_id":"","url":"https://api.github.com/users/Wildstrubu","html_url":"https://github.com/Wildstrubu","followers_url":"https://api.github.com/users/Wildstrubu/followers","following_url":"https://api.github.com/users/Wildstrubu/following{/other_user}","gists_url":"https://api.github.com/users/Wildstrubu/gists{/gist_id}","starred_url":"https://api.github.com/users/Wildstrubu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wildstrubu/subscriptions","organizations_url":"https://api.github.com/users/Wildstrubu/orgs","repos_url":"https://api.github.com/users/Wildstrubu/repos","events_url":"https://api.github.com/users/Wildstrubu/events{/privacy}","received_events_url":"https://api.github.com/users/Wildstrubu/received_events","type":"User","site_admin":false}}]