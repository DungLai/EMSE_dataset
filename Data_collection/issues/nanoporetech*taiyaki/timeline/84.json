[{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/712879112","html_url":"https://github.com/nanoporetech/taiyaki/issues/84#issuecomment-712879112","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/84","id":712879112,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjg3OTExMg==","user":{"login":"Haemmhoff","id":68926831,"node_id":"MDQ6VXNlcjY4OTI2ODMx","avatar_url":"https://avatars.githubusercontent.com/u/68926831?v=4","gravatar_id":"","url":"https://api.github.com/users/Haemmhoff","html_url":"https://github.com/Haemmhoff","followers_url":"https://api.github.com/users/Haemmhoff/followers","following_url":"https://api.github.com/users/Haemmhoff/following{/other_user}","gists_url":"https://api.github.com/users/Haemmhoff/gists{/gist_id}","starred_url":"https://api.github.com/users/Haemmhoff/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Haemmhoff/subscriptions","organizations_url":"https://api.github.com/users/Haemmhoff/orgs","repos_url":"https://api.github.com/users/Haemmhoff/repos","events_url":"https://api.github.com/users/Haemmhoff/events{/privacy}","received_events_url":"https://api.github.com/users/Haemmhoff/received_events","type":"User","site_admin":false},"created_at":"2020-10-20T14:07:19Z","updated_at":"2020-10-20T14:07:19Z","author_association":"NONE","body":"Hi @tmassingham-ont,\r\n\r\nThis seems to be a reoccurring problem the above mentioned compromise on the 3'end after two rounds of training for different independent runs and sequences. This problem does not occur with canonical bases, there the coverage towards the ends is also not perfect, but more in the range of 10-20nt and not 100-150nt. \r\n\r\nThanks for any inputs on this!\r\n\r\n","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/712879112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Haemmhoff","id":68926831,"node_id":"MDQ6VXNlcjY4OTI2ODMx","avatar_url":"https://avatars.githubusercontent.com/u/68926831?v=4","gravatar_id":"","url":"https://api.github.com/users/Haemmhoff","html_url":"https://github.com/Haemmhoff","followers_url":"https://api.github.com/users/Haemmhoff/followers","following_url":"https://api.github.com/users/Haemmhoff/following{/other_user}","gists_url":"https://api.github.com/users/Haemmhoff/gists{/gist_id}","starred_url":"https://api.github.com/users/Haemmhoff/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Haemmhoff/subscriptions","organizations_url":"https://api.github.com/users/Haemmhoff/orgs","repos_url":"https://api.github.com/users/Haemmhoff/repos","events_url":"https://api.github.com/users/Haemmhoff/events{/privacy}","received_events_url":"https://api.github.com/users/Haemmhoff/received_events","type":"User","site_admin":false}},{"id":3898940085,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mzg5ODk0MDA4NQ==","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3898940085","actor":{"login":"tmassingham-ont","id":19410440,"node_id":"MDQ6VXNlcjE5NDEwNDQw","avatar_url":"https://avatars.githubusercontent.com/u/19410440?v=4","gravatar_id":"","url":"https://api.github.com/users/tmassingham-ont","html_url":"https://github.com/tmassingham-ont","followers_url":"https://api.github.com/users/tmassingham-ont/followers","following_url":"https://api.github.com/users/tmassingham-ont/following{/other_user}","gists_url":"https://api.github.com/users/tmassingham-ont/gists{/gist_id}","starred_url":"https://api.github.com/users/tmassingham-ont/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmassingham-ont/subscriptions","organizations_url":"https://api.github.com/users/tmassingham-ont/orgs","repos_url":"https://api.github.com/users/tmassingham-ont/repos","events_url":"https://api.github.com/users/tmassingham-ont/events{/privacy}","received_events_url":"https://api.github.com/users/tmassingham-ont/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-10-20T14:07:19Z","performed_via_github_app":null},{"id":3898940091,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM4OTg5NDAwOTE=","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3898940091","actor":{"login":"tmassingham-ont","id":19410440,"node_id":"MDQ6VXNlcjE5NDEwNDQw","avatar_url":"https://avatars.githubusercontent.com/u/19410440?v=4","gravatar_id":"","url":"https://api.github.com/users/tmassingham-ont","html_url":"https://github.com/tmassingham-ont","followers_url":"https://api.github.com/users/tmassingham-ont/followers","following_url":"https://api.github.com/users/tmassingham-ont/following{/other_user}","gists_url":"https://api.github.com/users/tmassingham-ont/gists{/gist_id}","starred_url":"https://api.github.com/users/tmassingham-ont/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmassingham-ont/subscriptions","organizations_url":"https://api.github.com/users/tmassingham-ont/orgs","repos_url":"https://api.github.com/users/tmassingham-ont/repos","events_url":"https://api.github.com/users/tmassingham-ont/events{/privacy}","received_events_url":"https://api.github.com/users/tmassingham-ont/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-10-20T14:07:20Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/716486663","html_url":"https://github.com/nanoporetech/taiyaki/issues/84#issuecomment-716486663","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/84","id":716486663,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNjQ4NjY2Mw==","user":{"login":"tmassingham-ont","id":19410440,"node_id":"MDQ6VXNlcjE5NDEwNDQw","avatar_url":"https://avatars.githubusercontent.com/u/19410440?v=4","gravatar_id":"","url":"https://api.github.com/users/tmassingham-ont","html_url":"https://github.com/tmassingham-ont","followers_url":"https://api.github.com/users/tmassingham-ont/followers","following_url":"https://api.github.com/users/tmassingham-ont/following{/other_user}","gists_url":"https://api.github.com/users/tmassingham-ont/gists{/gist_id}","starred_url":"https://api.github.com/users/tmassingham-ont/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmassingham-ont/subscriptions","organizations_url":"https://api.github.com/users/tmassingham-ont/orgs","repos_url":"https://api.github.com/users/tmassingham-ont/repos","events_url":"https://api.github.com/users/tmassingham-ont/events{/privacy}","received_events_url":"https://api.github.com/users/tmassingham-ont/received_events","type":"User","site_admin":false},"created_at":"2020-10-26T11:26:12Z","updated_at":"2020-10-26T11:26:12Z","author_association":"CONTRIBUTOR","body":"No mismatches suggest that the model has been over-trained to specific sequence:  we're good but we're not _that_ good!   \r\n\r\nWhat does your training data comprise of?  Do any of the training reads map to region 5' upstream of the polyA region?  One possibility is that the training reads are not trimmed well to their reference sequence â€“ when the read contains signal from bases that are not present in the reference, it can learn to ignore them.  An example of this occurs with adapter sequence: failure to trim off the signal corresponding to it leads to model that apparently base calls well but calls no bases for the adapter with consequent disastrous results for bar coding (we trim very carefully).  The tool `misc/plot_mapped_signals.py` may be useful to interrogate where and how well the reads map to the reference. \r\n\r\nAssuming trimming is the issue, the reads can be hard-trimmed by altering the coordinates in the file produced by `generate_per_read_params.py`; alternatively, the amount of automatic trimming during data set preparation can be altered by adjusting the `--localpen` parameter of `prepare_mapped_reads.py` (I would recommend running on a small set first and analysing the results before processing a large batch of reads).   Megalodon, with its `--outputs signal_mappings`, provides an alternative tool chain and may produce more specific mappings near the start and end of reads since it is first filtered by the base-space mapping. \r\n\r\nA separate issue to be careful of is that the training data comes from a sufficiently diverse set of sequences.  A typical training set would contain several thousand different sequences, so that the model is pushed to learned how call the sequence from the reads, rather than just memorizing a small set of sequences and returning the appropriate one.  You could test this by deliberately removing part of the test sequence from the training data, and then seeing how the network behaves when presented with test data from that part of the sequence. If the diversity of the training data is low, then this sort of hold-out validation is essential to establish the validity of the trained network. \r\n\r\nHope this is useful. ","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/716486663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tmassingham-ont","id":19410440,"node_id":"MDQ6VXNlcjE5NDEwNDQw","avatar_url":"https://avatars.githubusercontent.com/u/19410440?v=4","gravatar_id":"","url":"https://api.github.com/users/tmassingham-ont","html_url":"https://github.com/tmassingham-ont","followers_url":"https://api.github.com/users/tmassingham-ont/followers","following_url":"https://api.github.com/users/tmassingham-ont/following{/other_user}","gists_url":"https://api.github.com/users/tmassingham-ont/gists{/gist_id}","starred_url":"https://api.github.com/users/tmassingham-ont/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmassingham-ont/subscriptions","organizations_url":"https://api.github.com/users/tmassingham-ont/orgs","repos_url":"https://api.github.com/users/tmassingham-ont/repos","events_url":"https://api.github.com/users/tmassingham-ont/events{/privacy}","received_events_url":"https://api.github.com/users/tmassingham-ont/received_events","type":"User","site_admin":false}},{"id":3993746563,"node_id":"MDExOkNsb3NlZEV2ZW50Mzk5Mzc0NjU2Mw==","url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/events/3993746563","actor":{"login":"tmassingham-ont","id":19410440,"node_id":"MDQ6VXNlcjE5NDEwNDQw","avatar_url":"https://avatars.githubusercontent.com/u/19410440?v=4","gravatar_id":"","url":"https://api.github.com/users/tmassingham-ont","html_url":"https://github.com/tmassingham-ont","followers_url":"https://api.github.com/users/tmassingham-ont/followers","following_url":"https://api.github.com/users/tmassingham-ont/following{/other_user}","gists_url":"https://api.github.com/users/tmassingham-ont/gists{/gist_id}","starred_url":"https://api.github.com/users/tmassingham-ont/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmassingham-ont/subscriptions","organizations_url":"https://api.github.com/users/tmassingham-ont/orgs","repos_url":"https://api.github.com/users/tmassingham-ont/repos","events_url":"https://api.github.com/users/tmassingham-ont/events{/privacy}","received_events_url":"https://api.github.com/users/tmassingham-ont/received_events","type":"User","site_admin":false},"event":"closed","commit_id":"646dc978f5252d0b4aec60fc426becb1f9ff6018","commit_url":"https://api.github.com/repos/nanoporetech/taiyaki/commits/646dc978f5252d0b4aec60fc426becb1f9ff6018","created_at":"2020-11-13T14:35:24Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/727043923","html_url":"https://github.com/nanoporetech/taiyaki/issues/84#issuecomment-727043923","issue_url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/84","id":727043923,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzA0MzkyMw==","user":{"login":"Haemmhoff","id":68926831,"node_id":"MDQ6VXNlcjY4OTI2ODMx","avatar_url":"https://avatars.githubusercontent.com/u/68926831?v=4","gravatar_id":"","url":"https://api.github.com/users/Haemmhoff","html_url":"https://github.com/Haemmhoff","followers_url":"https://api.github.com/users/Haemmhoff/followers","following_url":"https://api.github.com/users/Haemmhoff/following{/other_user}","gists_url":"https://api.github.com/users/Haemmhoff/gists{/gist_id}","starred_url":"https://api.github.com/users/Haemmhoff/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Haemmhoff/subscriptions","organizations_url":"https://api.github.com/users/Haemmhoff/orgs","repos_url":"https://api.github.com/users/Haemmhoff/repos","events_url":"https://api.github.com/users/Haemmhoff/events{/privacy}","received_events_url":"https://api.github.com/users/Haemmhoff/received_events","type":"User","site_admin":false},"created_at":"2020-11-13T21:27:57Z","updated_at":"2020-11-13T21:27:57Z","author_association":"NONE","body":"Thanks a lot for your inputs!\r\n\r\nTo answer your questions:\r\n- What does your training data comprise of? -> only one gene. I tried now several genes, but result was not different. As you say, it probably requires several thousand different sequences.\r\n- Do any of the training reads map to region 5' upstream of the polyA region? -> yes, this region is there for training.\r\n\r\nI did not trim the reads before the training in the first place. After doing this, it also did not improve the coverage directly upstream of the polyA. I will look at your other recommendations and keep you posted if any significant improvement. To exclude a set of reads from training and use it for later validation is a great idea. \r\n\r\nIt seems that from one IVT gene the sequence pool is not diverse enough and then I overtrain the model.\r\n\r\nThanks again, was very helpful your thoughts!","reactions":{"url":"https://api.github.com/repos/nanoporetech/taiyaki/issues/comments/727043923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Haemmhoff","id":68926831,"node_id":"MDQ6VXNlcjY4OTI2ODMx","avatar_url":"https://avatars.githubusercontent.com/u/68926831?v=4","gravatar_id":"","url":"https://api.github.com/users/Haemmhoff","html_url":"https://github.com/Haemmhoff","followers_url":"https://api.github.com/users/Haemmhoff/followers","following_url":"https://api.github.com/users/Haemmhoff/following{/other_user}","gists_url":"https://api.github.com/users/Haemmhoff/gists{/gist_id}","starred_url":"https://api.github.com/users/Haemmhoff/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Haemmhoff/subscriptions","organizations_url":"https://api.github.com/users/Haemmhoff/orgs","repos_url":"https://api.github.com/users/Haemmhoff/repos","events_url":"https://api.github.com/users/Haemmhoff/events{/privacy}","received_events_url":"https://api.github.com/users/Haemmhoff/received_events","type":"User","site_admin":false}}]