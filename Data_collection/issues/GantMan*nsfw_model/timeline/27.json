[{"url":"https://api.github.com/repos/GantMan/nsfw_model/issues/comments/497429120","html_url":"https://github.com/GantMan/nsfw_model/issues/27#issuecomment-497429120","issue_url":"https://api.github.com/repos/GantMan/nsfw_model/issues/27","id":497429120,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzQyOTEyMA==","user":{"login":"shmakovigor","id":10052224,"node_id":"MDQ6VXNlcjEwMDUyMjI0","avatar_url":"https://avatars.githubusercontent.com/u/10052224?v=4","gravatar_id":"","url":"https://api.github.com/users/shmakovigor","html_url":"https://github.com/shmakovigor","followers_url":"https://api.github.com/users/shmakovigor/followers","following_url":"https://api.github.com/users/shmakovigor/following{/other_user}","gists_url":"https://api.github.com/users/shmakovigor/gists{/gist_id}","starred_url":"https://api.github.com/users/shmakovigor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shmakovigor/subscriptions","organizations_url":"https://api.github.com/users/shmakovigor/orgs","repos_url":"https://api.github.com/users/shmakovigor/repos","events_url":"https://api.github.com/users/shmakovigor/events{/privacy}","received_events_url":"https://api.github.com/users/shmakovigor/received_events","type":"User","site_admin":false},"created_at":"2019-05-30T18:14:14Z","updated_at":"2019-05-30T18:14:14Z","author_association":"NONE","body":"I found that OpenCV dnn only allow inference, so the model need to be optimized for inference. Any ideas how to achieve that?","reactions":{"url":"https://api.github.com/repos/GantMan/nsfw_model/issues/comments/497429120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shmakovigor","id":10052224,"node_id":"MDQ6VXNlcjEwMDUyMjI0","avatar_url":"https://avatars.githubusercontent.com/u/10052224?v=4","gravatar_id":"","url":"https://api.github.com/users/shmakovigor","html_url":"https://github.com/shmakovigor","followers_url":"https://api.github.com/users/shmakovigor/followers","following_url":"https://api.github.com/users/shmakovigor/following{/other_user}","gists_url":"https://api.github.com/users/shmakovigor/gists{/gist_id}","starred_url":"https://api.github.com/users/shmakovigor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shmakovigor/subscriptions","organizations_url":"https://api.github.com/users/shmakovigor/orgs","repos_url":"https://api.github.com/users/shmakovigor/repos","events_url":"https://api.github.com/users/shmakovigor/events{/privacy}","received_events_url":"https://api.github.com/users/shmakovigor/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/GantMan/nsfw_model/issues/comments/498097647","html_url":"https://github.com/GantMan/nsfw_model/issues/27#issuecomment-498097647","issue_url":"https://api.github.com/repos/GantMan/nsfw_model/issues/27","id":498097647,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODA5NzY0Nw==","user":{"login":"GantMan","id":997157,"node_id":"MDQ6VXNlcjk5NzE1Nw==","avatar_url":"https://avatars.githubusercontent.com/u/997157?v=4","gravatar_id":"","url":"https://api.github.com/users/GantMan","html_url":"https://github.com/GantMan","followers_url":"https://api.github.com/users/GantMan/followers","following_url":"https://api.github.com/users/GantMan/following{/other_user}","gists_url":"https://api.github.com/users/GantMan/gists{/gist_id}","starred_url":"https://api.github.com/users/GantMan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GantMan/subscriptions","organizations_url":"https://api.github.com/users/GantMan/orgs","repos_url":"https://api.github.com/users/GantMan/repos","events_url":"https://api.github.com/users/GantMan/events{/privacy}","received_events_url":"https://api.github.com/users/GantMan/received_events","type":"User","site_admin":false},"created_at":"2019-06-03T03:04:25Z","updated_at":"2019-06-03T03:04:25Z","author_association":"OWNER","body":"That's new to me.  But from some googling I saw this script\r\n\r\n```\r\npython -m tensorflow.python.tools.optimize_for_inference --input output_graph.pb --output g.pb --input_names=input_1 --output_names=dense_1/Softmax,dense_2/Softmax\r\n```\r\n\r\nApparently, you can take any Tensorflow model and optimize for inference: https://medium.com/@prasadpal107/saving-freezing-optimizing-for-inference-restoring-of-tensorflow-models-b4146deb21b5","reactions":{"url":"https://api.github.com/repos/GantMan/nsfw_model/issues/comments/498097647/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"GantMan","id":997157,"node_id":"MDQ6VXNlcjk5NzE1Nw==","avatar_url":"https://avatars.githubusercontent.com/u/997157?v=4","gravatar_id":"","url":"https://api.github.com/users/GantMan","html_url":"https://github.com/GantMan","followers_url":"https://api.github.com/users/GantMan/followers","following_url":"https://api.github.com/users/GantMan/following{/other_user}","gists_url":"https://api.github.com/users/GantMan/gists{/gist_id}","starred_url":"https://api.github.com/users/GantMan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GantMan/subscriptions","organizations_url":"https://api.github.com/users/GantMan/orgs","repos_url":"https://api.github.com/users/GantMan/repos","events_url":"https://api.github.com/users/GantMan/events{/privacy}","received_events_url":"https://api.github.com/users/GantMan/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/GantMan/nsfw_model/issues/comments/498127871","html_url":"https://github.com/GantMan/nsfw_model/issues/27#issuecomment-498127871","issue_url":"https://api.github.com/repos/GantMan/nsfw_model/issues/27","id":498127871,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODEyNzg3MQ==","user":{"login":"shmakovigor","id":10052224,"node_id":"MDQ6VXNlcjEwMDUyMjI0","avatar_url":"https://avatars.githubusercontent.com/u/10052224?v=4","gravatar_id":"","url":"https://api.github.com/users/shmakovigor","html_url":"https://github.com/shmakovigor","followers_url":"https://api.github.com/users/shmakovigor/followers","following_url":"https://api.github.com/users/shmakovigor/following{/other_user}","gists_url":"https://api.github.com/users/shmakovigor/gists{/gist_id}","starred_url":"https://api.github.com/users/shmakovigor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shmakovigor/subscriptions","organizations_url":"https://api.github.com/users/shmakovigor/orgs","repos_url":"https://api.github.com/users/shmakovigor/repos","events_url":"https://api.github.com/users/shmakovigor/events{/privacy}","received_events_url":"https://api.github.com/users/shmakovigor/received_events","type":"User","site_admin":false},"created_at":"2019-06-03T06:22:12Z","updated_at":"2019-06-03T06:24:52Z","author_association":"NONE","body":"I have already tried doing this, but with ```--output_names=dense_3/Softmax``` and it throws many warnings like:\r\n> WARNING:tensorflow:Didn't find expected gamma Constant input to 'batch_normalization_93/FusedBatchNorm_1', found name: \"batch_normalization_93/ones_like\"  instead. Maybe because freeze_graph wasn't run first?\r\n\r\nAnd \"optimised\" model still work with OpenCV.\r\n\r\nWith ```--output_names=dense_1/Softmax,dense_2/Softmax``` it throws errors:\r\n> dense_1/Softmax is not in graph; dense_2/Softmax is not in graph\r\n\r\nMay be we need to run ```freeze_graph``` first as it suggests? Prob I need some checkpoint for that which I can not find in the repo.","reactions":{"url":"https://api.github.com/repos/GantMan/nsfw_model/issues/comments/498127871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shmakovigor","id":10052224,"node_id":"MDQ6VXNlcjEwMDUyMjI0","avatar_url":"https://avatars.githubusercontent.com/u/10052224?v=4","gravatar_id":"","url":"https://api.github.com/users/shmakovigor","html_url":"https://github.com/shmakovigor","followers_url":"https://api.github.com/users/shmakovigor/followers","following_url":"https://api.github.com/users/shmakovigor/following{/other_user}","gists_url":"https://api.github.com/users/shmakovigor/gists{/gist_id}","starred_url":"https://api.github.com/users/shmakovigor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shmakovigor/subscriptions","organizations_url":"https://api.github.com/users/shmakovigor/orgs","repos_url":"https://api.github.com/users/shmakovigor/repos","events_url":"https://api.github.com/users/shmakovigor/events{/privacy}","received_events_url":"https://api.github.com/users/shmakovigor/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/GantMan/nsfw_model/issues/comments/508038744","html_url":"https://github.com/GantMan/nsfw_model/issues/27#issuecomment-508038744","issue_url":"https://api.github.com/repos/GantMan/nsfw_model/issues/27","id":508038744,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODAzODc0NA==","user":{"login":"Scorpionchiques","id":15703294,"node_id":"MDQ6VXNlcjE1NzAzMjk0","avatar_url":"https://avatars.githubusercontent.com/u/15703294?v=4","gravatar_id":"","url":"https://api.github.com/users/Scorpionchiques","html_url":"https://github.com/Scorpionchiques","followers_url":"https://api.github.com/users/Scorpionchiques/followers","following_url":"https://api.github.com/users/Scorpionchiques/following{/other_user}","gists_url":"https://api.github.com/users/Scorpionchiques/gists{/gist_id}","starred_url":"https://api.github.com/users/Scorpionchiques/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Scorpionchiques/subscriptions","organizations_url":"https://api.github.com/users/Scorpionchiques/orgs","repos_url":"https://api.github.com/users/Scorpionchiques/repos","events_url":"https://api.github.com/users/Scorpionchiques/events{/privacy}","received_events_url":"https://api.github.com/users/Scorpionchiques/received_events","type":"User","site_admin":false},"created_at":"2019-07-03T10:33:48Z","updated_at":"2019-07-03T10:33:48Z","author_association":"NONE","body":"@shmakovigor Same issue. did you solve this?","reactions":{"url":"https://api.github.com/repos/GantMan/nsfw_model/issues/comments/508038744/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Scorpionchiques","id":15703294,"node_id":"MDQ6VXNlcjE1NzAzMjk0","avatar_url":"https://avatars.githubusercontent.com/u/15703294?v=4","gravatar_id":"","url":"https://api.github.com/users/Scorpionchiques","html_url":"https://github.com/Scorpionchiques","followers_url":"https://api.github.com/users/Scorpionchiques/followers","following_url":"https://api.github.com/users/Scorpionchiques/following{/other_user}","gists_url":"https://api.github.com/users/Scorpionchiques/gists{/gist_id}","starred_url":"https://api.github.com/users/Scorpionchiques/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Scorpionchiques/subscriptions","organizations_url":"https://api.github.com/users/Scorpionchiques/orgs","repos_url":"https://api.github.com/users/Scorpionchiques/repos","events_url":"https://api.github.com/users/Scorpionchiques/events{/privacy}","received_events_url":"https://api.github.com/users/Scorpionchiques/received_events","type":"User","site_admin":false}},{"id":2457112141,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQ1NzExMjE0MQ==","url":"https://api.github.com/repos/GantMan/nsfw_model/issues/events/2457112141","actor":{"login":"shmakovigor","id":10052224,"node_id":"MDQ6VXNlcjEwMDUyMjI0","avatar_url":"https://avatars.githubusercontent.com/u/10052224?v=4","gravatar_id":"","url":"https://api.github.com/users/shmakovigor","html_url":"https://github.com/shmakovigor","followers_url":"https://api.github.com/users/shmakovigor/followers","following_url":"https://api.github.com/users/shmakovigor/following{/other_user}","gists_url":"https://api.github.com/users/shmakovigor/gists{/gist_id}","starred_url":"https://api.github.com/users/shmakovigor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shmakovigor/subscriptions","organizations_url":"https://api.github.com/users/shmakovigor/orgs","repos_url":"https://api.github.com/users/shmakovigor/repos","events_url":"https://api.github.com/users/shmakovigor/events{/privacy}","received_events_url":"https://api.github.com/users/shmakovigor/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-07-03T10:33:48Z","performed_via_github_app":null},{"id":2457112143,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0NTcxMTIxNDM=","url":"https://api.github.com/repos/GantMan/nsfw_model/issues/events/2457112143","actor":{"login":"shmakovigor","id":10052224,"node_id":"MDQ6VXNlcjEwMDUyMjI0","avatar_url":"https://avatars.githubusercontent.com/u/10052224?v=4","gravatar_id":"","url":"https://api.github.com/users/shmakovigor","html_url":"https://github.com/shmakovigor","followers_url":"https://api.github.com/users/shmakovigor/followers","following_url":"https://api.github.com/users/shmakovigor/following{/other_user}","gists_url":"https://api.github.com/users/shmakovigor/gists{/gist_id}","starred_url":"https://api.github.com/users/shmakovigor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shmakovigor/subscriptions","organizations_url":"https://api.github.com/users/shmakovigor/orgs","repos_url":"https://api.github.com/users/shmakovigor/repos","events_url":"https://api.github.com/users/shmakovigor/events{/privacy}","received_events_url":"https://api.github.com/users/shmakovigor/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-07-03T10:33:48Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/GantMan/nsfw_model/issues/comments/595510087","html_url":"https://github.com/GantMan/nsfw_model/issues/27#issuecomment-595510087","issue_url":"https://api.github.com/repos/GantMan/nsfw_model/issues/27","id":595510087,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTUxMDA4Nw==","user":{"login":"TechnikEmpire","id":11234763,"node_id":"MDQ6VXNlcjExMjM0NzYz","avatar_url":"https://avatars.githubusercontent.com/u/11234763?v=4","gravatar_id":"","url":"https://api.github.com/users/TechnikEmpire","html_url":"https://github.com/TechnikEmpire","followers_url":"https://api.github.com/users/TechnikEmpire/followers","following_url":"https://api.github.com/users/TechnikEmpire/following{/other_user}","gists_url":"https://api.github.com/users/TechnikEmpire/gists{/gist_id}","starred_url":"https://api.github.com/users/TechnikEmpire/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TechnikEmpire/subscriptions","organizations_url":"https://api.github.com/users/TechnikEmpire/orgs","repos_url":"https://api.github.com/users/TechnikEmpire/repos","events_url":"https://api.github.com/users/TechnikEmpire/events{/privacy}","received_events_url":"https://api.github.com/users/TechnikEmpire/received_events","type":"User","site_admin":false},"created_at":"2020-03-06T00:15:16Z","updated_at":"2020-04-28T19:36:49Z","author_association":"CONTRIBUTOR","body":"All of this should be solved with the latest OpenCV dldt project code (Release 2020-R1).\r\n\r\nThe command to convert the current Tensorflow 2.1 model is:\r\n\r\n`python mo_tf.py --input_model frozen_graph.pb --model_name YOUR_DESIRED_NAME --data_type FP16 --mean_values=[0,0,0] --input_shape=[1,224,224,3] --scale_values=[255,255,255] --enable_concat_optimization --reverse_input_channels`\r\n\r\nThe scale, mean and reverse_input values are critical or your model won't work properly, you'll get trash. Do not do mean subtraction or scale specification in opencv's code before running inference, or again, you'll blow things up because that nfo is inside the inference_engine pipeline already. They become part of the model because you passed them on the command line.\r\n\r\n@GantMan You can close this out if OP doesn't.","reactions":{"url":"https://api.github.com/repos/GantMan/nsfw_model/issues/comments/595510087/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"TechnikEmpire","id":11234763,"node_id":"MDQ6VXNlcjExMjM0NzYz","avatar_url":"https://avatars.githubusercontent.com/u/11234763?v=4","gravatar_id":"","url":"https://api.github.com/users/TechnikEmpire","html_url":"https://github.com/TechnikEmpire","followers_url":"https://api.github.com/users/TechnikEmpire/followers","following_url":"https://api.github.com/users/TechnikEmpire/following{/other_user}","gists_url":"https://api.github.com/users/TechnikEmpire/gists{/gist_id}","starred_url":"https://api.github.com/users/TechnikEmpire/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TechnikEmpire/subscriptions","organizations_url":"https://api.github.com/users/TechnikEmpire/orgs","repos_url":"https://api.github.com/users/TechnikEmpire/repos","events_url":"https://api.github.com/users/TechnikEmpire/events{/privacy}","received_events_url":"https://api.github.com/users/TechnikEmpire/received_events","type":"User","site_admin":false}},{"id":3103376230,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzEwMzM3NjIzMA==","url":"https://api.github.com/repos/GantMan/nsfw_model/issues/events/3103376230","actor":{"login":"GantMan","id":997157,"node_id":"MDQ6VXNlcjk5NzE1Nw==","avatar_url":"https://avatars.githubusercontent.com/u/997157?v=4","gravatar_id":"","url":"https://api.github.com/users/GantMan","html_url":"https://github.com/GantMan","followers_url":"https://api.github.com/users/GantMan/followers","following_url":"https://api.github.com/users/GantMan/following{/other_user}","gists_url":"https://api.github.com/users/GantMan/gists{/gist_id}","starred_url":"https://api.github.com/users/GantMan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GantMan/subscriptions","organizations_url":"https://api.github.com/users/GantMan/orgs","repos_url":"https://api.github.com/users/GantMan/repos","events_url":"https://api.github.com/users/GantMan/events{/privacy}","received_events_url":"https://api.github.com/users/GantMan/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-03-06T00:15:16Z","performed_via_github_app":null},{"id":3103376234,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMxMDMzNzYyMzQ=","url":"https://api.github.com/repos/GantMan/nsfw_model/issues/events/3103376234","actor":{"login":"GantMan","id":997157,"node_id":"MDQ6VXNlcjk5NzE1Nw==","avatar_url":"https://avatars.githubusercontent.com/u/997157?v=4","gravatar_id":"","url":"https://api.github.com/users/GantMan","html_url":"https://github.com/GantMan","followers_url":"https://api.github.com/users/GantMan/followers","following_url":"https://api.github.com/users/GantMan/following{/other_user}","gists_url":"https://api.github.com/users/GantMan/gists{/gist_id}","starred_url":"https://api.github.com/users/GantMan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GantMan/subscriptions","organizations_url":"https://api.github.com/users/GantMan/orgs","repos_url":"https://api.github.com/users/GantMan/repos","events_url":"https://api.github.com/users/GantMan/events{/privacy}","received_events_url":"https://api.github.com/users/GantMan/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-03-06T00:15:16Z","performed_via_github_app":null}]