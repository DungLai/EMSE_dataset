[{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/1226873495","html_url":"https://github.com/openvinotoolkit/model_server/issues/1365#issuecomment-1226873495","issue_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/1365","id":1226873495,"node_id":"IC_kwDOCPfP385JIJqX","user":{"login":"mzegla","id":41325006,"node_id":"MDQ6VXNlcjQxMzI1MDA2","avatar_url":"https://avatars.githubusercontent.com/u/41325006?v=4","gravatar_id":"","url":"https://api.github.com/users/mzegla","html_url":"https://github.com/mzegla","followers_url":"https://api.github.com/users/mzegla/followers","following_url":"https://api.github.com/users/mzegla/following{/other_user}","gists_url":"https://api.github.com/users/mzegla/gists{/gist_id}","starred_url":"https://api.github.com/users/mzegla/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mzegla/subscriptions","organizations_url":"https://api.github.com/users/mzegla/orgs","repos_url":"https://api.github.com/users/mzegla/repos","events_url":"https://api.github.com/users/mzegla/events{/privacy}","received_events_url":"https://api.github.com/users/mzegla/received_events","type":"User","site_admin":false},"created_at":"2022-08-25T07:19:41Z","updated_at":"2022-08-25T07:19:41Z","author_association":"COLLABORATOR","body":"Did you try setting `timeout` parameter?\r\nhttps://grpc.github.io/grpc/python/grpc.html#multi-callable-interfaces\r\nAlso, you might consider not sending all 100 request at once, but let's say, in batches of 20 and after every 20 requests, read responses.","reactions":{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/1226873495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mzegla","id":41325006,"node_id":"MDQ6VXNlcjQxMzI1MDA2","avatar_url":"https://avatars.githubusercontent.com/u/41325006?v=4","gravatar_id":"","url":"https://api.github.com/users/mzegla","html_url":"https://github.com/mzegla","followers_url":"https://api.github.com/users/mzegla/followers","following_url":"https://api.github.com/users/mzegla/following{/other_user}","gists_url":"https://api.github.com/users/mzegla/gists{/gist_id}","starred_url":"https://api.github.com/users/mzegla/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mzegla/subscriptions","organizations_url":"https://api.github.com/users/mzegla/orgs","repos_url":"https://api.github.com/users/mzegla/repos","events_url":"https://api.github.com/users/mzegla/events{/privacy}","received_events_url":"https://api.github.com/users/mzegla/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/1226900837","html_url":"https://github.com/openvinotoolkit/model_server/issues/1365#issuecomment-1226900837","issue_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/1365","id":1226900837,"node_id":"IC_kwDOCPfP385JIQVl","user":{"login":"imZEH","id":7591030,"node_id":"MDQ6VXNlcjc1OTEwMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7591030?v=4","gravatar_id":"","url":"https://api.github.com/users/imZEH","html_url":"https://github.com/imZEH","followers_url":"https://api.github.com/users/imZEH/followers","following_url":"https://api.github.com/users/imZEH/following{/other_user}","gists_url":"https://api.github.com/users/imZEH/gists{/gist_id}","starred_url":"https://api.github.com/users/imZEH/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imZEH/subscriptions","organizations_url":"https://api.github.com/users/imZEH/orgs","repos_url":"https://api.github.com/users/imZEH/repos","events_url":"https://api.github.com/users/imZEH/events{/privacy}","received_events_url":"https://api.github.com/users/imZEH/received_events","type":"User","site_admin":false},"created_at":"2022-08-25T07:46:59Z","updated_at":"2022-08-25T07:46:59Z","author_association":"NONE","body":"> \r\n\r\nThank you for the response @mzegla \r\n\r\nyeah, I applied it lately. Just realize it took so long when using the default value. Does the value of 10.0 timeout would be enough ?\r\n\r\nOn the OVMS side, How would I setup my device If it has 4 cores ? \r\nWould you think 20 request is the max request at a time base on the cores ?\r\nDoes setting CPU_THROUGHPUT_STREAMS to 2 would suffice or set it to AUTO ? ","reactions":{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/1226900837/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"imZEH","id":7591030,"node_id":"MDQ6VXNlcjc1OTEwMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7591030?v=4","gravatar_id":"","url":"https://api.github.com/users/imZEH","html_url":"https://github.com/imZEH","followers_url":"https://api.github.com/users/imZEH/followers","following_url":"https://api.github.com/users/imZEH/following{/other_user}","gists_url":"https://api.github.com/users/imZEH/gists{/gist_id}","starred_url":"https://api.github.com/users/imZEH/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imZEH/subscriptions","organizations_url":"https://api.github.com/users/imZEH/orgs","repos_url":"https://api.github.com/users/imZEH/repos","events_url":"https://api.github.com/users/imZEH/events{/privacy}","received_events_url":"https://api.github.com/users/imZEH/received_events","type":"User","site_admin":false}},{"id":7256952791,"node_id":"MEE_lADOCPfP385QdGbuzwAAAAGwjE_X","url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/events/7256952791","actor":{"login":"mzegla","id":41325006,"node_id":"MDQ6VXNlcjQxMzI1MDA2","avatar_url":"https://avatars.githubusercontent.com/u/41325006?v=4","gravatar_id":"","url":"https://api.github.com/users/mzegla","html_url":"https://github.com/mzegla","followers_url":"https://api.github.com/users/mzegla/followers","following_url":"https://api.github.com/users/mzegla/following{/other_user}","gists_url":"https://api.github.com/users/mzegla/gists{/gist_id}","starred_url":"https://api.github.com/users/mzegla/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mzegla/subscriptions","organizations_url":"https://api.github.com/users/mzegla/orgs","repos_url":"https://api.github.com/users/mzegla/repos","events_url":"https://api.github.com/users/mzegla/events{/privacy}","received_events_url":"https://api.github.com/users/mzegla/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-08-25T07:46:59Z","performed_via_github_app":null},{"id":7256952798,"node_id":"SE_lADOCPfP385QdGbuzwAAAAGwjE_e","url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/events/7256952798","actor":{"login":"mzegla","id":41325006,"node_id":"MDQ6VXNlcjQxMzI1MDA2","avatar_url":"https://avatars.githubusercontent.com/u/41325006?v=4","gravatar_id":"","url":"https://api.github.com/users/mzegla","html_url":"https://github.com/mzegla","followers_url":"https://api.github.com/users/mzegla/followers","following_url":"https://api.github.com/users/mzegla/following{/other_user}","gists_url":"https://api.github.com/users/mzegla/gists{/gist_id}","starred_url":"https://api.github.com/users/mzegla/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mzegla/subscriptions","organizations_url":"https://api.github.com/users/mzegla/orgs","repos_url":"https://api.github.com/users/mzegla/repos","events_url":"https://api.github.com/users/mzegla/events{/privacy}","received_events_url":"https://api.github.com/users/mzegla/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-08-25T07:46:59Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/1226973155","html_url":"https://github.com/openvinotoolkit/model_server/issues/1365#issuecomment-1226973155","issue_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/1365","id":1226973155,"node_id":"IC_kwDOCPfP385JIh_j","user":{"login":"mzegla","id":41325006,"node_id":"MDQ6VXNlcjQxMzI1MDA2","avatar_url":"https://avatars.githubusercontent.com/u/41325006?v=4","gravatar_id":"","url":"https://api.github.com/users/mzegla","html_url":"https://github.com/mzegla","followers_url":"https://api.github.com/users/mzegla/followers","following_url":"https://api.github.com/users/mzegla/following{/other_user}","gists_url":"https://api.github.com/users/mzegla/gists{/gist_id}","starred_url":"https://api.github.com/users/mzegla/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mzegla/subscriptions","organizations_url":"https://api.github.com/users/mzegla/orgs","repos_url":"https://api.github.com/users/mzegla/repos","events_url":"https://api.github.com/users/mzegla/events{/privacy}","received_events_url":"https://api.github.com/users/mzegla/received_events","type":"User","site_admin":false},"created_at":"2022-08-25T08:52:27Z","updated_at":"2022-08-25T08:52:27Z","author_association":"COLLABORATOR","body":"It depends on how long it takes for OVMS to process the request and it varies depending on the model you use, hardware you have, networking overhead etc.\r\nTry with different timeout values and see what will be enough in your environment.\r\n\r\nWhen it comes to OVMS configuration. Do you use latest OVMS - 2022.1? \r\nIf so, instead of using `CPU_THROUGHPUT_STREAMS` you can try with `PERFORMANCE_HINT`.\r\nIt takes one of two values: `LATENCY` or `THROUGHPUT` and adjusts the model to optimize for one of these metrics. \r\n\r\nFor 4 cores it seems that there's no point in having more than 1 stream, so I think in your case this setting will be almost identical for both latency and throughput optimization. Setting streams manually to 2 seems like a bad idea for a 4 cores CPU. \r\nAs far as I know optimal way is having 1 CPU Stream per 4 physical cores and having to many streams compared to the amount of cores will most likely decrease performance. \r\n\r\nI hope it's not too messy and you don't get confused. When you try to figure out the best configuration for your model served in OVMS you can try benchmark client that will utilize the model to the fullest and give you information on what kind of numbers you can expect:\r\n\r\nhttps://github.com/openvinotoolkit/model_server/tree/main/demos/benchmark/cpp\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/1226973155/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mzegla","id":41325006,"node_id":"MDQ6VXNlcjQxMzI1MDA2","avatar_url":"https://avatars.githubusercontent.com/u/41325006?v=4","gravatar_id":"","url":"https://api.github.com/users/mzegla","html_url":"https://github.com/mzegla","followers_url":"https://api.github.com/users/mzegla/followers","following_url":"https://api.github.com/users/mzegla/following{/other_user}","gists_url":"https://api.github.com/users/mzegla/gists{/gist_id}","starred_url":"https://api.github.com/users/mzegla/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mzegla/subscriptions","organizations_url":"https://api.github.com/users/mzegla/orgs","repos_url":"https://api.github.com/users/mzegla/repos","events_url":"https://api.github.com/users/mzegla/events{/privacy}","received_events_url":"https://api.github.com/users/mzegla/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/1227075838","html_url":"https://github.com/openvinotoolkit/model_server/issues/1365#issuecomment-1227075838","issue_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/1365","id":1227075838,"node_id":"IC_kwDOCPfP385JI7D-","user":{"login":"imZEH","id":7591030,"node_id":"MDQ6VXNlcjc1OTEwMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7591030?v=4","gravatar_id":"","url":"https://api.github.com/users/imZEH","html_url":"https://github.com/imZEH","followers_url":"https://api.github.com/users/imZEH/followers","following_url":"https://api.github.com/users/imZEH/following{/other_user}","gists_url":"https://api.github.com/users/imZEH/gists{/gist_id}","starred_url":"https://api.github.com/users/imZEH/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imZEH/subscriptions","organizations_url":"https://api.github.com/users/imZEH/orgs","repos_url":"https://api.github.com/users/imZEH/repos","events_url":"https://api.github.com/users/imZEH/events{/privacy}","received_events_url":"https://api.github.com/users/imZEH/received_events","type":"User","site_admin":false},"created_at":"2022-08-25T10:28:29Z","updated_at":"2022-08-25T10:28:29Z","author_association":"NONE","body":"Thank you for the suggestions.\r\nI'll try to setup those things and observe.\r\nFor OVMS , Currently I installed OVMS 2021.4.2.","reactions":{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/1227075838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"imZEH","id":7591030,"node_id":"MDQ6VXNlcjc1OTEwMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7591030?v=4","gravatar_id":"","url":"https://api.github.com/users/imZEH","html_url":"https://github.com/imZEH","followers_url":"https://api.github.com/users/imZEH/followers","following_url":"https://api.github.com/users/imZEH/following{/other_user}","gists_url":"https://api.github.com/users/imZEH/gists{/gist_id}","starred_url":"https://api.github.com/users/imZEH/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imZEH/subscriptions","organizations_url":"https://api.github.com/users/imZEH/orgs","repos_url":"https://api.github.com/users/imZEH/repos","events_url":"https://api.github.com/users/imZEH/events{/privacy}","received_events_url":"https://api.github.com/users/imZEH/received_events","type":"User","site_admin":false}},{"id":7258199902,"node_id":"CE_lADOCPfP385QdGbuzwAAAAGwn1de","url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/events/7258199902","actor":{"login":"imZEH","id":7591030,"node_id":"MDQ6VXNlcjc1OTEwMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7591030?v=4","gravatar_id":"","url":"https://api.github.com/users/imZEH","html_url":"https://github.com/imZEH","followers_url":"https://api.github.com/users/imZEH/followers","following_url":"https://api.github.com/users/imZEH/following{/other_user}","gists_url":"https://api.github.com/users/imZEH/gists{/gist_id}","starred_url":"https://api.github.com/users/imZEH/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imZEH/subscriptions","organizations_url":"https://api.github.com/users/imZEH/orgs","repos_url":"https://api.github.com/users/imZEH/repos","events_url":"https://api.github.com/users/imZEH/events{/privacy}","received_events_url":"https://api.github.com/users/imZEH/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-08-25T10:28:29Z","state_reason":null,"performed_via_github_app":null}]