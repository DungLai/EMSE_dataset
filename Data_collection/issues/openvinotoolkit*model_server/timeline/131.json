[{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/579610954","html_url":"https://github.com/openvinotoolkit/model_server/issues/131#issuecomment-579610954","issue_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/131","id":579610954,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTYxMDk1NA==","user":{"login":"brmarkus","id":29976962,"node_id":"MDQ6VXNlcjI5OTc2OTYy","avatar_url":"https://avatars.githubusercontent.com/u/29976962?v=4","gravatar_id":"","url":"https://api.github.com/users/brmarkus","html_url":"https://github.com/brmarkus","followers_url":"https://api.github.com/users/brmarkus/followers","following_url":"https://api.github.com/users/brmarkus/following{/other_user}","gists_url":"https://api.github.com/users/brmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/brmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brmarkus/subscriptions","organizations_url":"https://api.github.com/users/brmarkus/orgs","repos_url":"https://api.github.com/users/brmarkus/repos","events_url":"https://api.github.com/users/brmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/brmarkus/received_events","type":"User","site_admin":false},"created_at":"2020-01-29T06:13:55Z","updated_at":"2020-01-29T06:13:55Z","author_association":"NONE","body":"Would you have a chance to test NCS/NCS2 outside your container first, on the host?\r\nDo you see it with \"lsusb\" before starting an OpenVINO application?\r\nDo you see the device being reset when starting the OpenVINO application (with lsusb, with dmesg)?\r\nThis is to check first, whether the setup is correct (udev-rule, USB, power, USB3, ldconfig, etc.).","reactions":{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/579610954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"brmarkus","id":29976962,"node_id":"MDQ6VXNlcjI5OTc2OTYy","avatar_url":"https://avatars.githubusercontent.com/u/29976962?v=4","gravatar_id":"","url":"https://api.github.com/users/brmarkus","html_url":"https://github.com/brmarkus","followers_url":"https://api.github.com/users/brmarkus/followers","following_url":"https://api.github.com/users/brmarkus/following{/other_user}","gists_url":"https://api.github.com/users/brmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/brmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brmarkus/subscriptions","organizations_url":"https://api.github.com/users/brmarkus/orgs","repos_url":"https://api.github.com/users/brmarkus/repos","events_url":"https://api.github.com/users/brmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/brmarkus/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/579612539","html_url":"https://github.com/openvinotoolkit/model_server/issues/131#issuecomment-579612539","issue_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/131","id":579612539,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTYxMjUzOQ==","user":{"login":"jiria","id":18746096,"node_id":"MDQ6VXNlcjE4NzQ2MDk2","avatar_url":"https://avatars.githubusercontent.com/u/18746096?v=4","gravatar_id":"","url":"https://api.github.com/users/jiria","html_url":"https://github.com/jiria","followers_url":"https://api.github.com/users/jiria/followers","following_url":"https://api.github.com/users/jiria/following{/other_user}","gists_url":"https://api.github.com/users/jiria/gists{/gist_id}","starred_url":"https://api.github.com/users/jiria/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiria/subscriptions","organizations_url":"https://api.github.com/users/jiria/orgs","repos_url":"https://api.github.com/users/jiria/repos","events_url":"https://api.github.com/users/jiria/events{/privacy}","received_events_url":"https://api.github.com/users/jiria/received_events","type":"User","site_admin":false},"created_at":"2020-01-29T06:20:40Z","updated_at":"2020-01-29T06:20:40Z","author_association":"NONE","body":"I can confirm that on host lsusb prints out Intel for the device and I can use the NCSv2 stick to run the demos from the toolking on the host. I can also use it in a container when I run it directly with Docker (privileges, host network). But when I try with Kubernetes, it fails to init the device.\r\n\r\nI can double check on the reset tomorrow, do not have the device on me now. But given that it works from Docker containers directly, I think the setup is ok.","reactions":{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/579612539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jiria","id":18746096,"node_id":"MDQ6VXNlcjE4NzQ2MDk2","avatar_url":"https://avatars.githubusercontent.com/u/18746096?v=4","gravatar_id":"","url":"https://api.github.com/users/jiria","html_url":"https://github.com/jiria","followers_url":"https://api.github.com/users/jiria/followers","following_url":"https://api.github.com/users/jiria/following{/other_user}","gists_url":"https://api.github.com/users/jiria/gists{/gist_id}","starred_url":"https://api.github.com/users/jiria/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiria/subscriptions","organizations_url":"https://api.github.com/users/jiria/orgs","repos_url":"https://api.github.com/users/jiria/repos","events_url":"https://api.github.com/users/jiria/events{/privacy}","received_events_url":"https://api.github.com/users/jiria/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/579615883","html_url":"https://github.com/openvinotoolkit/model_server/issues/131#issuecomment-579615883","issue_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/131","id":579615883,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTYxNTg4Mw==","user":{"login":"brmarkus","id":29976962,"node_id":"MDQ6VXNlcjI5OTc2OTYy","avatar_url":"https://avatars.githubusercontent.com/u/29976962?v=4","gravatar_id":"","url":"https://api.github.com/users/brmarkus","html_url":"https://github.com/brmarkus","followers_url":"https://api.github.com/users/brmarkus/followers","following_url":"https://api.github.com/users/brmarkus/following{/other_user}","gists_url":"https://api.github.com/users/brmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/brmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brmarkus/subscriptions","organizations_url":"https://api.github.com/users/brmarkus/orgs","repos_url":"https://api.github.com/users/brmarkus/repos","events_url":"https://api.github.com/users/brmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/brmarkus/received_events","type":"User","site_admin":false},"created_at":"2020-01-29T06:36:13Z","updated_at":"2020-01-29T06:36:13Z","author_association":"NONE","body":"Could you share logs/console-output, please?\r\nIt might be helpful if you share your yaml/json config file(s) of your Kubernetes setup.","reactions":{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/579615883/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"brmarkus","id":29976962,"node_id":"MDQ6VXNlcjI5OTc2OTYy","avatar_url":"https://avatars.githubusercontent.com/u/29976962?v=4","gravatar_id":"","url":"https://api.github.com/users/brmarkus","html_url":"https://github.com/brmarkus","followers_url":"https://api.github.com/users/brmarkus/followers","following_url":"https://api.github.com/users/brmarkus/following{/other_user}","gists_url":"https://api.github.com/users/brmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/brmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brmarkus/subscriptions","organizations_url":"https://api.github.com/users/brmarkus/orgs","repos_url":"https://api.github.com/users/brmarkus/repos","events_url":"https://api.github.com/users/brmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/brmarkus/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/579951394","html_url":"https://github.com/openvinotoolkit/model_server/issues/131#issuecomment-579951394","issue_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/131","id":579951394,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTk1MTM5NA==","user":{"login":"jiria","id":18746096,"node_id":"MDQ6VXNlcjE4NzQ2MDk2","avatar_url":"https://avatars.githubusercontent.com/u/18746096?v=4","gravatar_id":"","url":"https://api.github.com/users/jiria","html_url":"https://github.com/jiria","followers_url":"https://api.github.com/users/jiria/followers","following_url":"https://api.github.com/users/jiria/following{/other_user}","gists_url":"https://api.github.com/users/jiria/gists{/gist_id}","starred_url":"https://api.github.com/users/jiria/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiria/subscriptions","organizations_url":"https://api.github.com/users/jiria/orgs","repos_url":"https://api.github.com/users/jiria/repos","events_url":"https://api.github.com/users/jiria/events{/privacy}","received_events_url":"https://api.github.com/users/jiria/received_events","type":"User","site_admin":false},"created_at":"2020-01-29T20:46:08Z","updated_at":"2020-01-29T20:46:08Z","author_association":"NONE","body":"Here is `lsusb` output:\r\n```\r\n# lsusb\r\nBus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub\r\nBus 001 Device 003: ID 8087:0a2b Intel Corp.\r\nBus 001 Device 002: ID 03e7:2485 Intel\r\nBus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub\r\n```\r\nAfter removing and readding the pod, the id changes:\r\n```\r\nBus 002 Device 003: ID 03e7:f63b Intel\r\nBus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub\r\nBus 001 Device 003: ID 8087:0a2b Intel Corp.\r\nBus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub\r\n```\r\nHere is the output of openvino-model-server:\r\n```\r\n$ kubectl logs openvino-openvino-5a58c82-c78b4459b-fpwst -c openvino-model-server\r\n2020-01-29 19:58:05,939 - ie_serving.main - INFO - Log level set: DEBUG\r\n2020-01-29 19:58:05,939 - ie_serving.main - DEBUG - ie_serving_py arguments: Namespace(batch_size=None, func=<function parse_one_model at 0x7fc4c4ea6a60>, grpc_workers=1, model_name='squeezenet1.1', model_path='/opt/ml/squeezenet', model_version_policy='{\"latest\": { \"num_versions\":1 }}', nireq=1, plugin_config=None, port=8001, rest_port=0, rest_workers=1, shape=None, target_device='MYRIAD')\r\n2020-01-29 19:58:05,939 - ie_serving.main - DEBUG - configured environment variables: environ({'AMBASSADOR_PORT_443_TCP': 'tcp://10.102.13.172:443', 'AMBASSADOR_SERVICE_PORT_HTTPS': '443', 'KUBERNETES_SERVICE_PORT': '443', 'KUBERNETES_PORT': 'tcp://10.96.0.1:443', 'LOG_LEVEL': 'DEBUG', 'AMBASSADOR_SERVICE_HOST': '10.102.13.172', 'HOSTNAME': 'brainbox2', 'AMBASSADOR_ADMIN_PORT_8877_TCP_ADDR': '10.104.38.98', 'LD_LIBRARY_PATH': '/opt/intel/openvino/deployment_tools/inference_engine/external/tbb/lib:/opt/intel/openvino/deployment_tools/inference_engine/external/mkltiny_lnx/lib:/opt/intel/openvino/deployment_tools/inference_engine/lib/intel64', 'HOME': '/root', 'OLDPWD': '/ie-serving-py', 'AMBASSADOR_ADMIN_PORT_8877_TCP_PORT': '8877', 'AMBASSADOR_ADMIN_PORT_8877_TCP_PROTO': 'tcp', 'AMBASSADOR_PORT': 'tcp://10.102.13.172:80', 'AMBASSADOR_SERVICE_PORT': '80', 'PS1': '(.venv) # ', 'OPENVINO_OPENVINO_TFSERVING_PROXY_SELDONIO_TFSERVING_PROXY_0_2_PORT_9000_TCP_ADDR': '10.102.148.129', 'AMBASSADOR_PORT_80_TCP_ADDR': '10.102.13.172', 'AMBASSADOR_ADMIN_PORT_8877_TCP': 'tcp://10.104.38.98:8877', 'OPENVINO_OPENVINO_TFSERVING_PROXY_SELDONIO_TFSERVING_PROXY_0_2_PORT_9000_TCP_PORT': '9000', 'AMBASSADOR_PORT_80_TCP_PORT': '80', 'OPENVINO_OPENVINO_TFSERVING_PROXY_SELDONIO_TFSERVING_PROXY_0_2_PORT_9000_TCP_PROTO': 'tcp', 'KUBERNETES_PORT_443_TCP_ADDR': '10.96.0.1', 'AMBASSADOR_PORT_80_TCP_PROTO': 'tcp', 'PATH': '/ie-serving-py/.venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'OPENVINO_OPENVINO_TFSERVING_PROXY_SELDONIO_TFSERVING_PROXY_0_2_SERVICE_HOST': '10.102.148.129', 'KUBERNETES_PORT_443_TCP_PORT': '443', 'KUBERNETES_PORT_443_TCP_PROTO': 'tcp', 'AMBASSADOR_ADMIN_SERVICE_PORT_ADMIN': '8877', 'OPENVINO_OPENVINO_TFSERVING_PROXY_SELDONIO_TFSERVING_PROXY_0_2_PORT_9000_TCP': 'tcp://10.102.148.129:9000', 'AMBASSADOR_PORT_80_TCP': 'tcp://10.102.13.172:80', 'AMBASSADOR_PORT_443_TCP_ADDR': '10.102.13.172', 'OPENVINO_OPENVINO_TFSERVING_PROXY_SELDONIO_TFSERVING_PROXY_0_2_SERVICE_PORT': '9000', 'OPENVINO_OPENVINO_TFSERVING_PROXY_SELDONIO_TFSERVING_PROXY_0_2_PORT': 'tcp://10.102.148.129:9000', 'AMBASSADOR_ADMIN_SERVICE_HOST': '10.104.38.98', 'AMBASSADOR_PORT_443_TCP_PORT': '443', 'KUBERNETES_SERVICE_PORT_HTTPS': '443', 'KUBERNETES_PORT_443_TCP': 'tcp://10.96.0.1:443', 'AMBASSADOR_PORT_443_TCP_PROTO': 'tcp', 'VIRTUAL_ENV': '/ie-serving-py/.venv', 'OPENVINO_OPENVINO_TFSERVING_PROXY_SELDONIO_TFSERVING_PROXY_0_2_SERVICE_PORT_GRPC': '9000', 'KUBERNETES_SERVICE_HOST': '10.96.0.1', 'PWD': '/ie-serving-py', 'AMBASSADOR_SERVICE_PORT_HTTP': '80', 'PYTHONPATH': '/opt/intel/openvino/python/python3.6', 'AMBASSADOR_ADMIN_PORT': 'tcp://10.104.38.98:8877', 'AMBASSADOR_ADMIN_SERVICE_PORT': '8877'})\r\n2020-01-29 19:58:05,940 - ie_serving.models.model - INFO - Server start loading model: squeezenet1.1\r\n2020-01-29 19:58:05,941 - ie_serving.models.model - DEBUG - ['/opt/ml/squeezenet/1/']\r\n2020-01-29 19:58:05,942 - ie_serving.models.model_version_status - DEBUG - STATUS CHANGE: Version 1 of model squeezenet1.1 status change. New status: {'state': 'START', 'status': {'error_code': 'OK', 'error_message': ''}}\r\n2020-01-29 19:58:05,942 - ie_serving.models.model - INFO - Creating inference engine object for version: 1\r\n2020-01-29 19:58:05,942 - ie_serving.models.model_version_status - DEBUG - STATUS CHANGE: Version 1 of model squeezenet1.1 status change. New status: {'state': 'LOADING', 'status': {'error_code': 'OK', 'error_message': ''}}\r\n2020-01-29 19:58:05,970 - ie_serving.models.ir_engine - DEBUG - [Model: squeezenet1.1, version: 1] --- effective batch size - 1\r\n2020-01-29 19:58:08,163 - ie_serving.models.model - ERROR - Error occurred while loading model version: {'xml_file': '/opt/ml/squeezenet/1/squeezenet1.1.xml', 'bin_file': '/opt/ml/squeezenet/1/squeezenet1.1.bin', 'mapping_config': None, 'version_number': 1, 'batch_size_param': None, 'shape_param': None, 'num_ireq': 1, 'target_device': 'MYRIAD', 'plugin_config': None}\r\n2020-01-29 19:58:08,163 - ie_serving.models.model - ERROR - Content error: Can not init Myriad device: NC_ERROR\r\n2020-01-29 19:58:08,163 - ie_serving.models.model_version_status - DEBUG - STATUS CHANGE: Version 1 of model squeezenet1.1 status change. New status: {'state': 'LOADING', 'status': {'error_code': 'UNKNOWN', 'error_message': 'Error occurred while loading version'}}\r\n2020-01-29 19:58:08,164 - ie_serving.models.model - INFO - List of available versions for squeezenet1.1 model: []\r\n2020-01-29 19:58:08,164 - ie_serving.models.model - INFO - Default version for squeezenet1.1 model is -1\r\n2020-01-29 19:58:08,176 - ie_serving.server.start - INFO - gRPC server listens on port 8001 and will be serving models: ['squeezenet1.1']\r\n2020-01-29 19:58:09,178 - ie_serving.models.model - DEBUG - ['/opt/ml/squeezenet/1/']\r\n2020-01-29 19:58:09,178 - ie_serving.models.model - INFO - Server will start updating model: squeezenet1.1\r\n2020-01-29 19:58:09,178 - ie_serving.models.model_version_status - DEBUG - STATUS CHANGE: Version 1 of model squeezenet1.1 status change. New status: {'state': 'START', 'status': {'error_code': 'OK', 'error_message': ''}}\r\n2020-01-29 19:58:09,178 - ie_serving.models.model - DEBUG - Server will try to add [1] versions\r\n2020-01-29 19:58:09,178 - ie_serving.models.model - DEBUG - Server will try to delete [] versions\r\n2020-01-29 19:58:09,179 - ie_serving.models.model - INFO - Creating inference engine object for version: 1\r\n2020-01-29 19:58:09,179 - ie_serving.models.model_version_status - DEBUG - STATUS CHANGE: Version 1 of model squeezenet1.1 status change. New status: {'state': 'LOADING', 'status': {'error_code': 'OK', 'error_message': ''}}\r\n2020-01-29 19:58:09,185 - ie_serving.models.ir_engine - DEBUG - [Model: squeezenet1.1, version: 1] --- effective batch size - 1\r\n2020-01-29 19:58:11,187 - ie_serving.models.model - ERROR - Error occurred while loading model version: {'xml_file': '/opt/ml/squeezenet/1/squeezenet1.1.xml', 'bin_file': '/opt/ml/squeezenet/1/squeezenet1.1.bin', 'mapping_config': None, 'version_number': 1, 'batch_size_param': None, 'shape_param': None, 'num_ireq': 1, 'target_device': 'MYRIAD', 'plugin_config': None}\r\n2020-01-29 19:58:11,187 - ie_serving.models.model - ERROR - Content error: Can not init Myriad device: NC_ERROR\r\n...\r\n```\r\nAnd it just keeps retrying.\r\n\r\nHere is the yaml file:\r\n```\r\nkubectl get pod openvino-openvino-5a58c82-c78b4459b-kxkhp -o yaml\r\napiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  annotations:\r\n    prometheus.io/path: prometheus\r\n    prometheus.io/port: \"8000\"\r\n    prometheus.io/scrape: \"true\"\r\n  creationTimestamp: \"2020-01-29T20:33:42Z\"\r\n  generateName: openvino-openvino-5a58c82-c78b4459b-\r\n  labels:\r\n    app: openvino-openvino-5a58c82\r\n    fluentd: \"true\"\r\n    pod-template-hash: c78b4459b\r\n    seldon-app: openvino-model-openvino-openvino\r\n    seldon-app-tfserving-proxy: openvino-openvino-tfserving-proxy-seldonio-tfserving-proxy-0-2\r\n    seldon-deployment-id: openvino-openvino-model\r\n    version: v1\r\n  name: openvino-openvino-5a58c82-c78b4459b-kxkhp\r\n  namespace: seldon\r\n  ownerReferences:\r\n  - apiVersion: apps/v1\r\n    blockOwnerDeletion: true\r\n    controller: true\r\n    kind: ReplicaSet\r\n    name: openvino-openvino-5a58c82-c78b4459b\r\n    uid: a3e27156-42d6-11ea-8d14-94c691188103\r\n  resourceVersion: \"244796\"\r\n  selfLink: /api/v1/namespaces/seldon/pods/openvino-openvino-5a58c82-c78b4459b-kxkhp\r\n  uid: a3e2e8a6-42d6-11ea-8d14-94c691188103\r\nspec:\r\n  containers:\r\n  - env:\r\n    - name: PREDICTIVE_UNIT_SERVICE_PORT\r\n      value: \"9000\"\r\n    - name: PREDICTIVE_UNIT_ID\r\n      value: tfserving-proxy\r\n    - name: PREDICTOR_ID\r\n      value: openvino\r\n    - name: SELDON_DEPLOYMENT_ID\r\n      value: openvino-model\r\n    - name: PREDICTIVE_UNIT_PARAMETERS\r\n      value: '[{\"name\":\"grpc_endpoint\",\"value\":\"localhost:8001\",\"type\":\"STRING\"},{\"name\":\"model_name\",\"value\":\"squeezenet1.1\",\"type\":\"STRING\"},{\"name\":\"model_output\",\"value\":\"prob\",\"type\":\"STRING\"},{\"name\":\"model_input\",\"value\":\"data\",\"type\":\"STRING\"}]'\r\n    image: seldonio/tfserving-proxy:0.2\r\n    imagePullPolicy: IfNotPresent\r\n    lifecycle:\r\n      preStop:\r\n        exec:\r\n          command:\r\n          - /bin/sh\r\n          - -c\r\n          - /bin/sleep 10\r\n    livenessProbe:\r\n      failureThreshold: 3\r\n      initialDelaySeconds: 60\r\n      periodSeconds: 5\r\n      successThreshold: 1\r\n      tcpSocket:\r\n        port: grpc\r\n      timeoutSeconds: 1\r\n    name: tfserving-proxy\r\n    ports:\r\n    - containerPort: 9000\r\n      hostPort: 9000\r\n      name: grpc\r\n      protocol: TCP\r\n    readinessProbe:\r\n      failureThreshold: 3\r\n      initialDelaySeconds: 20\r\n      periodSeconds: 5\r\n      successThreshold: 1\r\n      tcpSocket:\r\n        port: grpc\r\n      timeoutSeconds: 1\r\n    resources: {}\r\n    terminationMessagePath: /dev/termination-log\r\n    terminationMessagePolicy: File\r\n    volumeMounts:\r\n    - mountPath: /etc/podinfo\r\n      name: podinfo\r\n    - mountPath: /var/run/secrets/kubernetes.io/serviceaccount\r\n      name: default-token-25tbg\r\n      readOnly: true\r\n  - args:\r\n    - ie_serving\r\n    - model\r\n    - --model_path\r\n    - /opt/ml/squeezenet\r\n    - --model_name\r\n    - squeezenet1.1\r\n    - --port\r\n    - \"8001\"\r\n    - --target_device\r\n    - MYRIAD\r\n    command:\r\n    - /ie-serving-py/start_server.sh\r\n    env:\r\n    - name: LOG_LEVEL\r\n      value: DEBUG\r\n    image: deviceplugin.azurecr.io/openvino-model-server:latest\r\n    imagePullPolicy: Always\r\n    name: openvino-model-server\r\n    ports:\r\n    - containerPort: 8001\r\n      hostPort: 8001\r\n      name: grpc\r\n      protocol: TCP\r\n    resources:\r\n      limits:\r\n        intel/ncs: \"1\"\r\n      requests:\r\n        intel/ncs: \"1\"\r\n    securityContext:\r\n      privileged: true\r\n    terminationMessagePath: /dev/termination-log\r\n    terminationMessagePolicy: File\r\n    volumeMounts:\r\n    - mountPath: /opt/ml\r\n      name: modelstore\r\n    - mountPath: /var/run/secrets/kubernetes.io/serviceaccount\r\n      name: default-token-25tbg\r\n      readOnly: true\r\n  - env:\r\n    - name: ENGINE_PREDICTOR\r\n      value: ...\r\n    - name: DEPLOYMENT_NAME\r\n      value: openvino\r\n    - name: DEPLOYMENT_NAMESPACE\r\n      value: seldon\r\n    - name: ENGINE_SERVER_PORT\r\n      value: \"8000\"\r\n    - name: ENGINE_SERVER_GRPC_PORT\r\n      value: \"5001\"\r\n    - name: JAVA_OPTS\r\n      value: -server -Dcom.sun.management.jmxremote.rmi.port=9090 -Dcom.sun.management.jmxremote\r\n        -Dcom.sun.management.jmxremote.port=9090 -Dcom.sun.management.jmxremote.ssl=false\r\n        -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.local.only=false\r\n        -Djava.rmi.server.hostname=127.0.0.1\r\n    - name: SELDON_LOG_MESSAGES_EXTERNALLY\r\n      value: \"false\"\r\n    - name: SELDON_LOG_REQUESTS\r\n      value: \"false\"\r\n    - name: SELDON_LOG_RESPONSES\r\n      value: \"false\"\r\n    image: docker.io/seldonio/engine:1.0.1\r\n    imagePullPolicy: IfNotPresent\r\n    lifecycle:\r\n      preStop:\r\n        exec:\r\n          command:\r\n          - /bin/sh\r\n          - -c\r\n          - curl 127.0.0.1:8000/pause; /bin/sleep 10\r\n    livenessProbe:\r\n      failureThreshold: 3\r\n      httpGet:\r\n        path: /live\r\n        port: admin\r\n        scheme: HTTP\r\n      initialDelaySeconds: 20\r\n      periodSeconds: 5\r\n      successThreshold: 1\r\n      timeoutSeconds: 60\r\n    name: seldon-container-engine\r\n    ports:\r\n    - containerPort: 8000\r\n      hostPort: 8000\r\n      protocol: TCP\r\n    - containerPort: 5001\r\n      hostPort: 5001\r\n      protocol: TCP\r\n    - containerPort: 8082\r\n      hostPort: 8082\r\n      name: admin\r\n      protocol: TCP\r\n    - containerPort: 9090\r\n      hostPort: 9090\r\n      name: jmx\r\n      protocol: TCP\r\n    readinessProbe:\r\n      failureThreshold: 3\r\n      httpGet:\r\n        path: /ready\r\n        port: admin\r\n        scheme: HTTP\r\n      initialDelaySeconds: 20\r\n      periodSeconds: 5\r\n      successThreshold: 1\r\n      timeoutSeconds: 60\r\n    resources:\r\n      requests:\r\n        cpu: 100m\r\n    securityContext:\r\n      runAsUser: 8888\r\n    terminationMessagePath: /dev/termination-log\r\n    terminationMessagePolicy: File\r\n    volumeMounts:\r\n    - mountPath: /etc/podinfo\r\n      name: podinfo\r\n    - mountPath: /var/run/secrets/kubernetes.io/serviceaccount\r\n      name: default-token-25tbg\r\n      readOnly: true\r\n  dnsPolicy: ClusterFirst\r\n  enableServiceLinks: true\r\n  hostNetwork: true\r\n  imagePullSecrets:\r\n  - name: regcred\r\n  nodeName: brainbox2\r\n  priority: 0\r\n  restartPolicy: Always\r\n  schedulerName: default-scheduler\r\n  securityContext: {}\r\n  serviceAccount: default\r\n  serviceAccountName: default\r\n  terminationGracePeriodSeconds: 20\r\n  tolerations:\r\n  - effect: NoExecute\r\n    key: node.kubernetes.io/not-ready\r\n    operator: Exists\r\n    tolerationSeconds: 300\r\n  - effect: NoExecute\r\n    key: node.kubernetes.io/unreachable\r\n    operator: Exists\r\n    tolerationSeconds: 300\r\n  volumes:\r\n  - name: modelstore\r\n    persistentVolumeClaim:\r\n      claimName: model-store-pvc\r\n  - downwardAPI:\r\n      defaultMode: 420\r\n      items:\r\n      - fieldRef:\r\n          apiVersion: v1\r\n          fieldPath: metadata.annotations\r\n        path: annotations\r\n    name: podinfo\r\n  - name: default-token-25tbg\r\n    secret:\r\n      defaultMode: 420\r\n      secretName: default-token-25tbg\r\nstatus:\r\n  ...\r\n```\r\nJust to note, this has been deployed through Seldon-Core.\r\n\r\nI have a simple device plugin that serves `intel/ncs` resource and mounts `/dev` into the container. Also notice that I am using my own build of the `openvino-model-server`. As per https://github.com/IntelAI/OpenVINO-model-server/issues/128 I had to rebuild it. The rebuild also includes the `libusb` patch as per here: https://docs.openvinotoolkit.org/latest/_docs_install_guides_installing_openvino_docker_linux.html though I got the same results without it as well.","reactions":{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/579951394/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jiria","id":18746096,"node_id":"MDQ6VXNlcjE4NzQ2MDk2","avatar_url":"https://avatars.githubusercontent.com/u/18746096?v=4","gravatar_id":"","url":"https://api.github.com/users/jiria","html_url":"https://github.com/jiria","followers_url":"https://api.github.com/users/jiria/followers","following_url":"https://api.github.com/users/jiria/following{/other_user}","gists_url":"https://api.github.com/users/jiria/gists{/gist_id}","starred_url":"https://api.github.com/users/jiria/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiria/subscriptions","organizations_url":"https://api.github.com/users/jiria/orgs","repos_url":"https://api.github.com/users/jiria/repos","events_url":"https://api.github.com/users/jiria/events{/privacy}","received_events_url":"https://api.github.com/users/jiria/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/580643790","html_url":"https://github.com/openvinotoolkit/model_server/issues/131#issuecomment-580643790","issue_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/131","id":580643790,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDY0Mzc5MA==","user":{"login":"mzegla","id":41325006,"node_id":"MDQ6VXNlcjQxMzI1MDA2","avatar_url":"https://avatars.githubusercontent.com/u/41325006?v=4","gravatar_id":"","url":"https://api.github.com/users/mzegla","html_url":"https://github.com/mzegla","followers_url":"https://api.github.com/users/mzegla/followers","following_url":"https://api.github.com/users/mzegla/following{/other_user}","gists_url":"https://api.github.com/users/mzegla/gists{/gist_id}","starred_url":"https://api.github.com/users/mzegla/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mzegla/subscriptions","organizations_url":"https://api.github.com/users/mzegla/orgs","repos_url":"https://api.github.com/users/mzegla/repos","events_url":"https://api.github.com/users/mzegla/events{/privacy}","received_events_url":"https://api.github.com/users/mzegla/received_events","type":"User","site_admin":false},"created_at":"2020-01-31T08:54:14Z","updated_at":"2020-01-31T08:54:14Z","author_association":"COLLABORATOR","body":"Hmm, if you managed to make it work with Docker itself, then I guess your model server image is fine. I recall there were some issues with NCS in Kubernetes, but it was a long time ago and maybe something has changed. I guess we'll have to reach out to NCS team to get update on that. \r\n\r\n@dtrawins do you have any idea what could be the issue here?","reactions":{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/580643790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mzegla","id":41325006,"node_id":"MDQ6VXNlcjQxMzI1MDA2","avatar_url":"https://avatars.githubusercontent.com/u/41325006?v=4","gravatar_id":"","url":"https://api.github.com/users/mzegla","html_url":"https://github.com/mzegla","followers_url":"https://api.github.com/users/mzegla/followers","following_url":"https://api.github.com/users/mzegla/following{/other_user}","gists_url":"https://api.github.com/users/mzegla/gists{/gist_id}","starred_url":"https://api.github.com/users/mzegla/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mzegla/subscriptions","organizations_url":"https://api.github.com/users/mzegla/orgs","repos_url":"https://api.github.com/users/mzegla/repos","events_url":"https://api.github.com/users/mzegla/events{/privacy}","received_events_url":"https://api.github.com/users/mzegla/received_events","type":"User","site_admin":false}},{"id":2996284238,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mjk5NjI4NDIzOA==","url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/events/2996284238","actor":{"login":"dtrawins","id":20400806,"node_id":"MDQ6VXNlcjIwNDAwODA2","avatar_url":"https://avatars.githubusercontent.com/u/20400806?v=4","gravatar_id":"","url":"https://api.github.com/users/dtrawins","html_url":"https://github.com/dtrawins","followers_url":"https://api.github.com/users/dtrawins/followers","following_url":"https://api.github.com/users/dtrawins/following{/other_user}","gists_url":"https://api.github.com/users/dtrawins/gists{/gist_id}","starred_url":"https://api.github.com/users/dtrawins/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dtrawins/subscriptions","organizations_url":"https://api.github.com/users/dtrawins/orgs","repos_url":"https://api.github.com/users/dtrawins/repos","events_url":"https://api.github.com/users/dtrawins/events{/privacy}","received_events_url":"https://api.github.com/users/dtrawins/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-01-31T08:54:14Z","performed_via_github_app":null},{"id":2996284239,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI5OTYyODQyMzk=","url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/events/2996284239","actor":{"login":"dtrawins","id":20400806,"node_id":"MDQ6VXNlcjIwNDAwODA2","avatar_url":"https://avatars.githubusercontent.com/u/20400806?v=4","gravatar_id":"","url":"https://api.github.com/users/dtrawins","html_url":"https://github.com/dtrawins","followers_url":"https://api.github.com/users/dtrawins/followers","following_url":"https://api.github.com/users/dtrawins/following{/other_user}","gists_url":"https://api.github.com/users/dtrawins/gists{/gist_id}","starred_url":"https://api.github.com/users/dtrawins/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dtrawins/subscriptions","organizations_url":"https://api.github.com/users/dtrawins/orgs","repos_url":"https://api.github.com/users/dtrawins/repos","events_url":"https://api.github.com/users/dtrawins/events{/privacy}","received_events_url":"https://api.github.com/users/dtrawins/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-01-31T08:54:14Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/581394397","html_url":"https://github.com/openvinotoolkit/model_server/issues/131#issuecomment-581394397","issue_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/131","id":581394397,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTM5NDM5Nw==","user":{"login":"mzegla","id":41325006,"node_id":"MDQ6VXNlcjQxMzI1MDA2","avatar_url":"https://avatars.githubusercontent.com/u/41325006?v=4","gravatar_id":"","url":"https://api.github.com/users/mzegla","html_url":"https://github.com/mzegla","followers_url":"https://api.github.com/users/mzegla/followers","following_url":"https://api.github.com/users/mzegla/following{/other_user}","gists_url":"https://api.github.com/users/mzegla/gists{/gist_id}","starred_url":"https://api.github.com/users/mzegla/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mzegla/subscriptions","organizations_url":"https://api.github.com/users/mzegla/orgs","repos_url":"https://api.github.com/users/mzegla/repos","events_url":"https://api.github.com/users/mzegla/events{/privacy}","received_events_url":"https://api.github.com/users/mzegla/received_events","type":"User","site_admin":false},"created_at":"2020-02-03T12:37:25Z","updated_at":"2020-02-03T12:37:25Z","author_association":"COLLABORATOR","body":"So from what I got to know about NCS in Kuberentes in general:\r\n\r\n> ...to use NCS devices, you basically need\r\n> to deal with the USB device resets and to allow udev events to the workload. Such\r\n> Privileges are not reasonable in cloud environments....\r\n\r\nBut it might be possible to make it work. \r\nCould you share some logs about device reset, udev events etc.? \r\n","reactions":{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/581394397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mzegla","id":41325006,"node_id":"MDQ6VXNlcjQxMzI1MDA2","avatar_url":"https://avatars.githubusercontent.com/u/41325006?v=4","gravatar_id":"","url":"https://api.github.com/users/mzegla","html_url":"https://github.com/mzegla","followers_url":"https://api.github.com/users/mzegla/followers","following_url":"https://api.github.com/users/mzegla/following{/other_user}","gists_url":"https://api.github.com/users/mzegla/gists{/gist_id}","starred_url":"https://api.github.com/users/mzegla/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mzegla/subscriptions","organizations_url":"https://api.github.com/users/mzegla/orgs","repos_url":"https://api.github.com/users/mzegla/repos","events_url":"https://api.github.com/users/mzegla/events{/privacy}","received_events_url":"https://api.github.com/users/mzegla/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/718744146","html_url":"https://github.com/openvinotoolkit/model_server/issues/131#issuecomment-718744146","issue_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/131","id":718744146,"node_id":"MDEyOklzc3VlQ29tbWVudDcxODc0NDE0Ng==","user":{"login":"rasapala","id":58549742,"node_id":"MDQ6VXNlcjU4NTQ5NzQy","avatar_url":"https://avatars.githubusercontent.com/u/58549742?v=4","gravatar_id":"","url":"https://api.github.com/users/rasapala","html_url":"https://github.com/rasapala","followers_url":"https://api.github.com/users/rasapala/followers","following_url":"https://api.github.com/users/rasapala/following{/other_user}","gists_url":"https://api.github.com/users/rasapala/gists{/gist_id}","starred_url":"https://api.github.com/users/rasapala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rasapala/subscriptions","organizations_url":"https://api.github.com/users/rasapala/orgs","repos_url":"https://api.github.com/users/rasapala/repos","events_url":"https://api.github.com/users/rasapala/events{/privacy}","received_events_url":"https://api.github.com/users/rasapala/received_events","type":"User","site_admin":false},"created_at":"2020-10-29T13:14:16Z","updated_at":"2020-10-29T13:14:16Z","author_association":"COLLABORATOR","body":"Closing the issue due no response from author.","reactions":{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/comments/718744146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rasapala","id":58549742,"node_id":"MDQ6VXNlcjU4NTQ5NzQy","avatar_url":"https://avatars.githubusercontent.com/u/58549742?v=4","gravatar_id":"","url":"https://api.github.com/users/rasapala","html_url":"https://github.com/rasapala","followers_url":"https://api.github.com/users/rasapala/followers","following_url":"https://api.github.com/users/rasapala/following{/other_user}","gists_url":"https://api.github.com/users/rasapala/gists{/gist_id}","starred_url":"https://api.github.com/users/rasapala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rasapala/subscriptions","organizations_url":"https://api.github.com/users/rasapala/orgs","repos_url":"https://api.github.com/users/rasapala/repos","events_url":"https://api.github.com/users/rasapala/events{/privacy}","received_events_url":"https://api.github.com/users/rasapala/received_events","type":"User","site_admin":false}},{"id":3936259660,"node_id":"MDExOkNsb3NlZEV2ZW50MzkzNjI1OTY2MA==","url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/events/3936259660","actor":{"login":"rasapala","id":58549742,"node_id":"MDQ6VXNlcjU4NTQ5NzQy","avatar_url":"https://avatars.githubusercontent.com/u/58549742?v=4","gravatar_id":"","url":"https://api.github.com/users/rasapala","html_url":"https://github.com/rasapala","followers_url":"https://api.github.com/users/rasapala/followers","following_url":"https://api.github.com/users/rasapala/following{/other_user}","gists_url":"https://api.github.com/users/rasapala/gists{/gist_id}","starred_url":"https://api.github.com/users/rasapala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rasapala/subscriptions","organizations_url":"https://api.github.com/users/rasapala/orgs","repos_url":"https://api.github.com/users/rasapala/repos","events_url":"https://api.github.com/users/rasapala/events{/privacy}","received_events_url":"https://api.github.com/users/rasapala/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-10-29T13:14:16Z","state_reason":null,"performed_via_github_app":null}]