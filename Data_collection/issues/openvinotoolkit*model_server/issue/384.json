{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/384","repository_url":"https://api.github.com/repos/openvinotoolkit/model_server","labels_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/384/labels{/name}","comments_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/384/comments","events_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/384/events","html_url":"https://github.com/openvinotoolkit/model_server/issues/384","id":755336263,"node_id":"MDU6SXNzdWU3NTUzMzYyNjM=","number":384,"title":"Error when calling REST or GRPC API from python clients","user":{"login":"magallardo","id":4683095,"node_id":"MDQ6VXNlcjQ2ODMwOTU=","avatar_url":"https://avatars.githubusercontent.com/u/4683095?v=4","gravatar_id":"","url":"https://api.github.com/users/magallardo","html_url":"https://github.com/magallardo","followers_url":"https://api.github.com/users/magallardo/followers","following_url":"https://api.github.com/users/magallardo/following{/other_user}","gists_url":"https://api.github.com/users/magallardo/gists{/gist_id}","starred_url":"https://api.github.com/users/magallardo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/magallardo/subscriptions","organizations_url":"https://api.github.com/users/magallardo/orgs","repos_url":"https://api.github.com/users/magallardo/repos","events_url":"https://api.github.com/users/magallardo/events{/privacy}","received_events_url":"https://api.github.com/users/magallardo/received_events","type":"User","site_admin":false},"labels":[{"id":1070321713,"node_id":"MDU6TGFiZWwxMDcwMzIxNzEz","url":"https://api.github.com/repos/openvinotoolkit/model_server/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2020-12-02T14:46:19Z","updated_at":"2021-06-29T07:13:39Z","closed_at":"2021-06-29T07:13:39Z","author_association":"NONE","active_lock_reason":null,"body":"Hello,\r\n\r\nI have started using the latest docker image of model-server and running into several issues and would appreciate any help to get this working.\r\n\r\nI am running the docker image on a Mac and the docker image starts fine.  Following the output from the console:\r\n\r\n```\r\ndocker run --user $(id -u):$(id -g) -v ~/models/server/face-detection:/models -p 9000:9000 -p 9001:9001 openvino/model_server:latest --model_path /models --model_name face-detection --port 9000 --rest_port 9001 --log_level DEBUG\r\n[2020-12-01 20:06:44.764] [serving] [debug] CLI parameters passed to ovms server\r\n[2020-12-01 20:06:44.764] [serving] [debug] model_path: /models\r\n[2020-12-01 20:06:44.764] [serving] [debug] model_name: face-detection\r\n[2020-12-01 20:06:44.764] [serving] [debug] batch_size: 0\r\n[2020-12-01 20:06:44.764] [serving] [debug] shape: \r\n[2020-12-01 20:06:44.764] [serving] [debug] model_version_policy: \r\n[2020-12-01 20:06:44.764] [serving] [debug] nireq: 0\r\n[2020-12-01 20:06:44.764] [serving] [debug] target_device: CPU\r\n[2020-12-01 20:06:44.764] [serving] [debug] plugin_config: \r\n[2020-12-01 20:06:44.764] [serving] [debug] gRPC port: 9000\r\n[2020-12-01 20:06:44.764] [serving] [debug] REST port: 9001\r\n[2020-12-01 20:06:44.764] [serving] [debug] REST workers: 24\r\n[2020-12-01 20:06:44.764] [serving] [debug] gRPC workers: 1\r\n[2020-12-01 20:06:44.764] [serving] [debug] gRPC channel arguments: \r\n[2020-12-01 20:06:44.764] [serving] [debug] log level: DEBUG\r\n[2020-12-01 20:06:44.764] [serving] [debug] log path: \r\n[2020-12-01 20:06:44.764] [serving] [debug] Batch size set: false, shape set: false\r\n[2020-12-01 20:06:44.766] [serving] [debug] Currently registered versions count:0\r\n[2020-12-01 20:06:44.766] [serving] [info] Getting model from /models\r\n[2020-12-01 20:06:44.766] [serving] [info] Model downloaded to /models\r\n[2020-12-01 20:06:44.766] [serving] [info] Will add model: face-detection; version: 1 ...\r\n[2020-12-01 20:06:44.767] [serving] [info] Loading model: face-detection, version: 1, from path: /models/1, with target device: CPU ...\r\n[2020-12-01 20:06:44.768] [serving] [info] STATUS CHANGE: Version 1 of model face-detection status change. New status: ( \"state\": \"START\", \"error_code\": \"OK\" )\r\n[2020-12-01 20:06:44.768] [serving] [debug] setLoading: face-detection - 1 (previous state: START) -> error: OK\r\n[2020-12-01 20:06:44.768] [serving] [info] STATUS CHANGE: Version 1 of model face-detection status change. New status: ( \"state\": \"LOADING\", \"error_code\": \"OK\" )\r\n[2020-12-01 20:06:44.768] [serving] [debug] Getting model files from path:/models/1\r\n[2020-12-01 20:06:44.770] [serving] [debug] Try reading model file:/models/1/face-detection-retail-0004.xml\r\n[2020-12-01 20:06:44.857] [serving] [debug] Network shape - (1,3,300,300); Final shape - (1,3,300,300)\r\n[2020-12-01 20:06:44.857] [serving] [info] Input name: data; mapping_name: ; shape: 1 3 300 300 ; precision: FP32, layout:NCHW\r\n[2020-12-01 20:06:44.857] [serving] [debug] model: face-detection, version: 1; reshaping inputs is not required\r\n[2020-12-01 20:06:44.857] [serving] [info] Output name: detection_out ; mapping name: ; shape: 1 1 200 7  ; precision: FP32, layout:NCHW\r\n```\r\n\r\nHowever, when I try to use the sample REST and gRPC python clients, I am getting errors and the clients can't connect to the server.  Following is the output for the REST client to get model status:\r\n\r\n```\r\npython rest_get_model_status.py --rest_port 9001 --model_name face-detection --model_version 1\r\nTraceback (most recent call last):\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/urllib3/connectionpool.py\", line 706, in urlopen\r\n    chunked=chunked,\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/urllib3/connectionpool.py\", line 445, in _make_request\r\n    six.raise_from(e, None)\r\n  File \"<string>\", line 3, in raise_from\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/urllib3/connectionpool.py\", line 440, in _make_request\r\n    httplib_response = conn.getresponse()\r\n  File \"/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.7/lib/python3.7/http/client.py\", line 1321, in getresponse\r\n    response.begin()\r\n  File \"/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.7/lib/python3.7/http/client.py\", line 296, in begin\r\n    version, status, reason = self._read_status()\r\n  File \"/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.7/lib/python3.7/http/client.py\", line 265, in _read_status\r\n    raise RemoteDisconnected(\"Remote end closed connection without\"\r\nhttp.client.RemoteDisconnected: Remote end closed connection without response\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/requests/adapters.py\", line 449, in send\r\n    timeout=timeout\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/urllib3/connectionpool.py\", line 756, in urlopen\r\n    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/urllib3/util/retry.py\", line 531, in increment\r\n    raise six.reraise(type(error), error, _stacktrace)\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/urllib3/packages/six.py\", line 734, in reraise\r\n    raise value.with_traceback(tb)\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/urllib3/connectionpool.py\", line 706, in urlopen\r\n    chunked=chunked,\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/urllib3/connectionpool.py\", line 445, in _make_request\r\n    six.raise_from(e, None)\r\n  File \"<string>\", line 3, in raise_from\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/urllib3/connectionpool.py\", line 440, in _make_request\r\n    httplib_response = conn.getresponse()\r\n  File \"/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.7/lib/python3.7/http/client.py\", line 1321, in getresponse\r\n    response.begin()\r\n  File \"/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.7/lib/python3.7/http/client.py\", line 296, in begin\r\n    version, status, reason = self._read_status()\r\n  File \"/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.7/lib/python3.7/http/client.py\", line 265, in _read_status\r\n    raise RemoteDisconnected(\"Remote end closed connection without\"\r\nurllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"rest_get_model_status.py\", line 35, in <module>\r\n    result = requests.get(\"{}:{}/v1/models/{}{}\".format(args['rest_url'], args['rest_port'], args['model_name'], version))\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/requests/api.py\", line 76, in get\r\n    return request('get', url, params=params, **kwargs)\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/requests/api.py\", line 61, in request\r\n    return session.request(method=method, url=url, **kwargs)\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/requests/sessions.py\", line 542, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/requests/sessions.py\", line 655, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/Users/mg/virtualenvs/openvino/venv/lib/python3.7/site-packages/requests/adapters.py\", line 498, in send\r\n    raise ConnectionError(err, request=request)\r\nrequests.exceptions.ConnectionError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))\r\n```\r\n\r\nPlease advise.\r\n\r\nMarcelo","closed_by":{"login":"rasapala","id":58549742,"node_id":"MDQ6VXNlcjU4NTQ5NzQy","avatar_url":"https://avatars.githubusercontent.com/u/58549742?v=4","gravatar_id":"","url":"https://api.github.com/users/rasapala","html_url":"https://github.com/rasapala","followers_url":"https://api.github.com/users/rasapala/followers","following_url":"https://api.github.com/users/rasapala/following{/other_user}","gists_url":"https://api.github.com/users/rasapala/gists{/gist_id}","starred_url":"https://api.github.com/users/rasapala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rasapala/subscriptions","organizations_url":"https://api.github.com/users/rasapala/orgs","repos_url":"https://api.github.com/users/rasapala/repos","events_url":"https://api.github.com/users/rasapala/events{/privacy}","received_events_url":"https://api.github.com/users/rasapala/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/openvinotoolkit/model_server/issues/384/timeline","performed_via_github_app":null,"state_reason":"completed"}