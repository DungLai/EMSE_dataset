[{"id":5904131089,"node_id":"MEE_lADOCQLq_c5B528BzwAAAAFf6eQR","url":"https://api.github.com/repos/kymatio/kymatio/issues/events/5904131089","actor":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-01-17T12:34:27Z","performed_via_github_app":null},{"id":5904131095,"node_id":"SE_lADOCQLq_c5B528BzwAAAAFf6eQX","url":"https://api.github.com/repos/kymatio/kymatio/issues/events/5904131095","actor":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-01-17T12:34:27Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1014481120","html_url":"https://github.com/kymatio/kymatio/issues/790#issuecomment-1014481120","issue_url":"https://api.github.com/repos/kymatio/kymatio/issues/790","id":1014481120,"node_id":"IC_kwDOCQLq_c48d8Dg","user":{"login":"lostanlen","id":3943142,"node_id":"MDQ6VXNlcjM5NDMxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/3943142?v=4","gravatar_id":"","url":"https://api.github.com/users/lostanlen","html_url":"https://github.com/lostanlen","followers_url":"https://api.github.com/users/lostanlen/followers","following_url":"https://api.github.com/users/lostanlen/following{/other_user}","gists_url":"https://api.github.com/users/lostanlen/gists{/gist_id}","starred_url":"https://api.github.com/users/lostanlen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lostanlen/subscriptions","organizations_url":"https://api.github.com/users/lostanlen/orgs","repos_url":"https://api.github.com/users/lostanlen/repos","events_url":"https://api.github.com/users/lostanlen/events{/privacy}","received_events_url":"https://api.github.com/users/lostanlen/received_events","type":"User","site_admin":false},"created_at":"2022-01-17T12:44:58Z","updated_at":"2022-01-17T12:44:58Z","author_association":"COLLABORATOR","body":"Hello @OverLordGoldDragon \r\n\r\n> Note the left-most blue psi2 is almost entirely outside the support of blue psi1s, yet it's omitted from second order scattering because its support doesn't fully decay into the j=0 octave. That's a potentially heavy loss of information.\r\n\r\nI don't understand your observation.\r\n\r\n\"the left-most blue psi2 is almost entirely outside the support of blue psi1s\" OK but remember that there is complex modulus in between, which demodulates the first-order to the base-band. So what matters is not `xi1` vs. `xi2` but `bw1` vs. `xi2`, where `bw1` is the first-order bandwidth (typically `bw1=xi1/Q` in the octaves you're looking at)\r\n\r\nThe reason why Kymatio looks at `j1` vs.  `j2` is that we haven't implemented the possibility to _up_-sample the coefficients between the first and the second order. Kymatio only allows to downsample or keep at same sample rate. I don't see that as a big limitation, but you're right that it should be possible to relax the `j1 < j2` hypothesis by over-sampling the first-order a bit.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1014481120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lostanlen","id":3943142,"node_id":"MDQ6VXNlcjM5NDMxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/3943142?v=4","gravatar_id":"","url":"https://api.github.com/users/lostanlen","html_url":"https://github.com/lostanlen","followers_url":"https://api.github.com/users/lostanlen/followers","following_url":"https://api.github.com/users/lostanlen/following{/other_user}","gists_url":"https://api.github.com/users/lostanlen/gists{/gist_id}","starred_url":"https://api.github.com/users/lostanlen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lostanlen/subscriptions","organizations_url":"https://api.github.com/users/lostanlen/orgs","repos_url":"https://api.github.com/users/lostanlen/repos","events_url":"https://api.github.com/users/lostanlen/events{/privacy}","received_events_url":"https://api.github.com/users/lostanlen/received_events","type":"User","site_admin":false}},{"id":5904188221,"node_id":"MEE_lADOCQLq_c5B528BzwAAAAFf6sM9","url":"https://api.github.com/repos/kymatio/kymatio/issues/events/5904188221","actor":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-01-17T12:44:58Z","performed_via_github_app":null},{"id":5904188224,"node_id":"SE_lADOCQLq_c5B528BzwAAAAFf6sNA","url":"https://api.github.com/repos/kymatio/kymatio/issues/events/5904188224","actor":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-01-17T12:44:58Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1015933247","html_url":"https://github.com/kymatio/kymatio/issues/790#issuecomment-1015933247","issue_url":"https://api.github.com/repos/kymatio/kymatio/issues/790","id":1015933247,"node_id":"IC_kwDOCQLq_c48jek_","user":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"created_at":"2022-01-18T23:41:54Z","updated_at":"2022-01-18T23:41:54Z","author_association":"COLLABORATOR","body":"> `bw1` vs. `xi2`\r\n\r\nInteresting point. While I can see dependence on `bw1`, I cannot refute dependence on `xi1`: one won't see a 1Hz carrier with a 100Hz modulator. In the time-frequency plane, the greater component will always manifest as the modulator (`xi2`), won't it? Then `xi2 < xi1` is a strong prior. It also follows from [Waldspurger's proof](https://arxiv.org/abs/1605.07464), which is exact in continuous time and approximate in discrete - does it not?\r\n\r\nIf `bw1` was the end of story, then Kymatio's even worse off, as `bw1` depends on `Q`, which is only partly captured by `j`.\r\n\r\n> `j1` vs. `j2` is that we haven't implemented the possibility to up-sample\r\n\r\nI don't see how this is related - why not just use `j2 > 0` for all `xi1` then?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1015933247/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1016433495","html_url":"https://github.com/kymatio/kymatio/issues/790#issuecomment-1016433495","issue_url":"https://api.github.com/repos/kymatio/kymatio/issues/790","id":1016433495,"node_id":"IC_kwDOCQLq_c48lYtX","user":{"login":"lostanlen","id":3943142,"node_id":"MDQ6VXNlcjM5NDMxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/3943142?v=4","gravatar_id":"","url":"https://api.github.com/users/lostanlen","html_url":"https://github.com/lostanlen","followers_url":"https://api.github.com/users/lostanlen/followers","following_url":"https://api.github.com/users/lostanlen/following{/other_user}","gists_url":"https://api.github.com/users/lostanlen/gists{/gist_id}","starred_url":"https://api.github.com/users/lostanlen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lostanlen/subscriptions","organizations_url":"https://api.github.com/users/lostanlen/orgs","repos_url":"https://api.github.com/users/lostanlen/repos","events_url":"https://api.github.com/users/lostanlen/events{/privacy}","received_events_url":"https://api.github.com/users/lostanlen/received_events","type":"User","site_admin":false},"created_at":"2022-01-19T12:47:41Z","updated_at":"2022-01-19T12:47:41Z","author_association":"COLLABORATOR","body":"> Interesting point. While I can see dependence on bw1, I cannot refute dependence on xi1: one won't see a 1Hz carrier with a 100Hz modulator. In the time-frequency plane, the greater component will always manifest as the modulator (xi2), won't it? Then xi2 < xi1 is a strong prior.\r\n\r\nI wasn't talking about the signal but about the wavelets. \r\n\r\nThe first wavelet has frequency `xi1` and bandwidth `bw1` (typically `bw1 = xi1/Q1`)\r\nThe first wavelet has frequency `xi2` and bandwidth `bw2` (typically `bw2 = xi2/Q2`)\r\n\r\nWhat i'm saying is that for _any_ signal `x`, `xi2>bw1` implies `||x*psi1| * psi2| ~= 0 `.\r\n(of course, the reciprocal isn't true: depending on the signal `x`, you might find null coefficients ||x*psi1| * psi2|=0 despite xi2<bw1`)\r\n\r\nYour observation about carrier frequency and modulation frequency is correct. In practice, if `x` has the form `cos(a t) cos(b t)`, there will be a strong nonzero coefficient at the path `(psi1,psi2)` such that `xi1 = max(a,b)` and `xi2 = min(a, b)`. Vice-versa the path `(psi1,psi2)` such that `xi1 = min(a,b)` and `xi2 = max(a, b)` will be zero. There is a fundamental asymmetry in the way these frequencies interact. (in fact, Mallat showed that there is more than asymmetry, there is a natural order structure; but i digress).\r\n\r\n\r\n> If bw1 was the end of story, then Kymatio's even worse off, as bw1 depends on Q, which is only partly captured by j.\r\n\r\nI'm not sure. I would try to trigger the bug by setting `Q1 = 1` and `Q2 > 1` (Q2=8), which is an edge case. \r\nI don't think the bug can happen as long as `Q2=1`. I might be wrong.\r\n\r\n\r\n> I don't see how this is related\r\n\r\nIn Kymatio, `j` encodes the (log2 of) the amount of downsampling with respect to the original sample rate.\r\nThe design is as follows: `0 = j0 <= j1 < j2 <= J` (i could be wrong about `<` vs. `<=`)\r\nHence, it's a cascade of downsampling operations: from `sr` to `sr/2**j1`, to `sr/2**j2`, to `sr**J`.\r\nIf we allow `j2 < j1` we need an _up_sampling operation in the middle:\r\n* downsample from `sr` to `sr/2**j1`\r\n* up-sample from `sr/2**j2`\r\n* dowsample from `sr/2**J`\r\n\r\nI don't really see a justification for that intermediate upsampling. If anything i would prefer to lower the `j1` down to the desired `j2 ` so that the amount of downsampling in the first order is reduced. Then the second-order would be performed with neither downsampling nor upsampling: `j1=j2` by definition.\r\n\r\n\r\n>  why not just use j2 > 0 for all xi1 then?\r\n\r\nThat's the limit case. It's `bank.behavior.U_log2_oversampling = inf` in scattering.m\r\nAnd something like `psi_mask_factor = inf` in ScatNet\r\n\r\nIn most cases it involves a lot of unnecessary computations (to say nothing of RAM usage) but it can be useful for debugging and for visualizing the asymmetry i was talking about earlier.\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1016433495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lostanlen","id":3943142,"node_id":"MDQ6VXNlcjM5NDMxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/3943142?v=4","gravatar_id":"","url":"https://api.github.com/users/lostanlen","html_url":"https://github.com/lostanlen","followers_url":"https://api.github.com/users/lostanlen/followers","following_url":"https://api.github.com/users/lostanlen/following{/other_user}","gists_url":"https://api.github.com/users/lostanlen/gists{/gist_id}","starred_url":"https://api.github.com/users/lostanlen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lostanlen/subscriptions","organizations_url":"https://api.github.com/users/lostanlen/orgs","repos_url":"https://api.github.com/users/lostanlen/repos","events_url":"https://api.github.com/users/lostanlen/events{/privacy}","received_events_url":"https://api.github.com/users/lostanlen/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1016445003","html_url":"https://github.com/kymatio/kymatio/issues/790#issuecomment-1016445003","issue_url":"https://api.github.com/repos/kymatio/kymatio/issues/790","id":1016445003,"node_id":"IC_kwDOCQLq_c48lbhL","user":{"login":"lostanlen","id":3943142,"node_id":"MDQ6VXNlcjM5NDMxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/3943142?v=4","gravatar_id":"","url":"https://api.github.com/users/lostanlen","html_url":"https://github.com/lostanlen","followers_url":"https://api.github.com/users/lostanlen/followers","following_url":"https://api.github.com/users/lostanlen/following{/other_user}","gists_url":"https://api.github.com/users/lostanlen/gists{/gist_id}","starred_url":"https://api.github.com/users/lostanlen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lostanlen/subscriptions","organizations_url":"https://api.github.com/users/lostanlen/orgs","repos_url":"https://api.github.com/users/lostanlen/repos","events_url":"https://api.github.com/users/lostanlen/events{/privacy}","received_events_url":"https://api.github.com/users/lostanlen/received_events","type":"User","site_admin":false},"created_at":"2022-01-19T13:03:17Z","updated_at":"2022-01-19T17:25:45Z","author_association":"COLLABORATOR","body":"An attempt at graphical explanation:\r\n\r\n<img width=\"652\" alt=\"Screenshot 2022-01-19 at 18 18 28\" src=\"https://user-images.githubusercontent.com/3943142/150181386-5e3a2c3c-e2df-4c6d-8639-04bbf18344b7.png\">\r\n\r\n\r\nIIUC \"why not just use j2 > 0 for all xi1 then?\" would make the orange region above a rectangle.\r\n\r\nRelatedly: it's not easy to control xi1max and xi2max in kymatio without breaking everything, unfortunately.\r\nIt is also difficult to raise `xi1min` above `1/T`.","reactions":{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1016445003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lostanlen","id":3943142,"node_id":"MDQ6VXNlcjM5NDMxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/3943142?v=4","gravatar_id":"","url":"https://api.github.com/users/lostanlen","html_url":"https://github.com/lostanlen","followers_url":"https://api.github.com/users/lostanlen/followers","following_url":"https://api.github.com/users/lostanlen/following{/other_user}","gists_url":"https://api.github.com/users/lostanlen/gists{/gist_id}","starred_url":"https://api.github.com/users/lostanlen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lostanlen/subscriptions","organizations_url":"https://api.github.com/users/lostanlen/orgs","repos_url":"https://api.github.com/users/lostanlen/repos","events_url":"https://api.github.com/users/lostanlen/events{/privacy}","received_events_url":"https://api.github.com/users/lostanlen/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1017081306","html_url":"https://github.com/kymatio/kymatio/issues/790#issuecomment-1017081306","issue_url":"https://api.github.com/repos/kymatio/kymatio/issues/790","id":1017081306,"node_id":"IC_kwDOCQLq_c48n23a","user":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"created_at":"2022-01-20T03:21:24Z","updated_at":"2022-01-20T03:32:01Z","author_association":"COLLABORATOR","body":"> Your observation about carrier frequency and modulation frequency is correct\r\n\r\n> you might find null coefficients ||x*psi1| * psi2|=0 despite xi2<bw1\r\n\r\nThen we agree. What I'm further saying is, the missing piece is `xi1`: a `bw1` at `xi1` can capture a much higher AM than a `bw1` at `xi1/10`. By itself, `bw1` is an overly conservative upper bound.\r\n\r\n> I'm not sure.\r\n\r\nHigher `Q` means packing more wavelets in the same log-frequency interval, which means each wavelet's `bw` must be reduced if the same redundancy (`r_psi`) is to be retained - hence, `high Q` -> `low bw`. If only `bw` matters, then for high `Q` we have filters near Nyquist with same bandwidth as filters near DC for `Q=1`, that in Kymatio are treated very differently via `j2 > j1`.\r\n\r\n> If we allow `j2 < j1` we need an _up_sampling operation in the middle\r\n\r\nYes, I've realized - but currently we have `j2 > j1` rather than `j2 >= j1`, and latter doesn't require upsampling. I agree the performance consideration is important and we shouldn't `j2 < j1` by default unless we can show that `j2 = j1` is insufficient. Also we'd not need to upsample - just downsample less.\r\n\r\nWhat I was saying is that this is _only_ a performance perspective, rather than following `~= 0`.\r\n\r\n> It is also difficult to raise `xi1min` above `1/T`.\r\n\r\nDid you mean `1/N`? `xi` is independent of `T`. We can always lower `xi_min` by padding more, but the current limit of `1/N` already requires x16 padding, so _lowering_ it is a bad idea, but unsure what's your point for increasing it.","reactions":{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1017081306/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1017741102","html_url":"https://github.com/kymatio/kymatio/issues/790#issuecomment-1017741102","issue_url":"https://api.github.com/repos/kymatio/kymatio/issues/790","id":1017741102,"node_id":"IC_kwDOCQLq_c48qX8u","user":{"login":"lostanlen","id":3943142,"node_id":"MDQ6VXNlcjM5NDMxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/3943142?v=4","gravatar_id":"","url":"https://api.github.com/users/lostanlen","html_url":"https://github.com/lostanlen","followers_url":"https://api.github.com/users/lostanlen/followers","following_url":"https://api.github.com/users/lostanlen/following{/other_user}","gists_url":"https://api.github.com/users/lostanlen/gists{/gist_id}","starred_url":"https://api.github.com/users/lostanlen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lostanlen/subscriptions","organizations_url":"https://api.github.com/users/lostanlen/orgs","repos_url":"https://api.github.com/users/lostanlen/repos","events_url":"https://api.github.com/users/lostanlen/events{/privacy}","received_events_url":"https://api.github.com/users/lostanlen/received_events","type":"User","site_admin":false},"created_at":"2022-01-20T17:23:33Z","updated_at":"2022-01-20T17:23:33Z","author_association":"COLLABORATOR","body":"> the missing piece is xi1: a bw1 at xi1 can capture a much higher AM than a bw1 at xi1/10. By itself, bw1 is an overly conservative upper bound.\r\n\r\nNo, i don't think this is the case? The former writes as `g(t) cos(xi1 t)` whereas the latter writes as `g(t) cos(xi1 t/10)`, with `g_hat(omega)` spanning an effective bandwidth of `bw1` in both cases. These two signals have the same amplitude modulation spectrum at `lambda1 = xi1` or `lambda1 = xi1/10. They only differ in terms of their carrier.\r\n\r\nDo you have a different example in mind?\r\n\r\n\r\n> Higher Q means packing more wavelets in the same log-frequency interval, which means each wavelet's bw must be reduced if the same redundancy (r_psi) is to be retained - hence, high Q -> low bw. If only bw matters, then for high Q we have filters near Nyquist with same bandwidth as filters near DC for Q=1\r\n\r\nYes, all of this is right.\r\nI don't know how `j1` (sampling) comes into play, because i don't understand the code for deciding about `j1` from wavelet characteristics. I thought that it was made according to an aliasing argument, like `(xi1+bw1) * 2**j1` should be below Nyquist, or something like that? (i'm using xi1+bw1 to describe the upper cutoff of psi1, though in practice the cutoff is above that)\r\nAssuming for simplicity that we reach Nyquist exactly, we have\r\n`(xi1+bw1) * 2**j1 = (xi1+bw1) * 2**j1 = Nyquist`\r\nHence, `j1<j2` implies `(xi1+bw1) > (xi2+bw2)`.\r\nThis criterion is incorrect for `Q1>1`.\r\n\r\nIt would be much better to examine the truth value of the inequality `bw1 > xi2` on a per-`psi2` basis, as i did here: https://github.com/lostanlen/scattering.m/blob/master/lib/operators/secondborn_scatter.m#L43\r\n\r\n\r\n> I agree the performance consideration is important and we shouldn't j2 < j1 by default unless we can show that j2 = j1 is insufficient.\r\n\r\nWe shouldn't allow `j2 < j1`, period; since that would require writing another Kymatio primitive `conv_upsample`. It's not just a performance matter, it's also a question of codebase size and maintanability.\r\n\r\nIf we want paths with higher modulation frequencies `xi2`, just downsample less the first order carrying those modulation frequencies. This is the role of `U_log2_oversampling` in scattering.m and `oversampling` in ScatNet.\r\n\r\n-----\r\n\r\nIt is also difficult to raise xi1min above 1/T.\r\n\r\n> Did you mean 1/N? xi is independent of T. We can always lower xi_min by padding more, but the current limit of 1/N already requires x16 padding, so lowering it is a bad idea, but unsure what's your point for increasing it.\r\n\r\nI did mean `1/T` (to be more precise: `xi_max / 2**J_psi` and i did mean raising it). The use case is simply that there might not be energy in the lowest-frequency range. \r\nThis is very typical in audio: carrier frequencies xi1 only go down to `Nyquist/2**10` or so, whereas modulation frequencies (\"rates\") xi2 easily down to `Nyquist/2**15`. In the interets of time complexity and memory usage, it might be preferable to restrict the first order to its upper `J1=10` octaves while going up to `J2=15` octaves of scattering for the second order. Difficult to do in current Kymatio :((\r\n\r\nLikewise, it is difficult to set an _upper_ bound for `xi2`. Maybe we only care about modulation frequencies below `Nyquist/2**8`, in which case we can skip a good number of paths in `U2` which turn out to be very costly. We lose energy conservation for Diracs, of course, but may not lose much in real-world signals, while enjoying a good speed boost.\r\n\r\n(what i'm describing is supported by `scattering.m` via `bank.behavior.gamma_bounds`)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1017741102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lostanlen","id":3943142,"node_id":"MDQ6VXNlcjM5NDMxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/3943142?v=4","gravatar_id":"","url":"https://api.github.com/users/lostanlen","html_url":"https://github.com/lostanlen","followers_url":"https://api.github.com/users/lostanlen/followers","following_url":"https://api.github.com/users/lostanlen/following{/other_user}","gists_url":"https://api.github.com/users/lostanlen/gists{/gist_id}","starred_url":"https://api.github.com/users/lostanlen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lostanlen/subscriptions","organizations_url":"https://api.github.com/users/lostanlen/orgs","repos_url":"https://api.github.com/users/lostanlen/repos","events_url":"https://api.github.com/users/lostanlen/events{/privacy}","received_events_url":"https://api.github.com/users/lostanlen/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1031484517","html_url":"https://github.com/kymatio/kymatio/issues/790#issuecomment-1031484517","issue_url":"https://api.github.com/repos/kymatio/kymatio/issues/790","id":1031484517,"node_id":"IC_kwDOCQLq_c49ezRl","user":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"created_at":"2022-02-07T13:44:22Z","updated_at":"2022-02-07T13:44:22Z","author_association":"COLLABORATOR","body":"> same amplitude modulation spectrum\r\n\r\nNo? I thought we agreed at\r\n\r\n> Your observation about carrier frequency and modulation frequency is correct\r\n\r\n<hr>\r\n\r\n> We shouldn't allow j2 < j1, period; since that would require writing another Kymatio primitive conv_upsample\r\n\r\nAgain I don't see how this is true. We can just downsample less, which makes it only a performance matter. But you seem to agree immediately after...?\r\n\r\n> If we want paths with higher modulation frequencies xi2, just downsample less the first order\r\n\r\n<hr>\r\n\r\n> I did mean 1/T (to be more precise: xi_max / 2**J_psi and i did mean raising it). The use case is simply that there might not be energy in the lowest-frequency range.\r\n\r\nThen why not let the user set `J=log2(T)`? `xi_min` should not be tied to `T`: this ties modulation filterbank design to the scale of invariance, and the two should be independent. We want scattering to be a general transform, not just audio; human iEEG is low-freq heavy.\r\n\r\n> Likewise, it is difficult to set an upper bound for xi2\r\n\r\nYes, #791 -- while Kymatio can't currently do it, I wouldn't say it's hard to do.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1031484517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false}},{"id":6703858664,"node_id":"CE_lADOCQLq_c5B528BzwAAAAGPlMPo","url":"https://api.github.com/repos/kymatio/kymatio/issues/events/6703858664","actor":{"login":"MuawizChaudhary","id":39755015,"node_id":"MDQ6VXNlcjM5NzU1MDE1","avatar_url":"https://avatars.githubusercontent.com/u/39755015?v=4","gravatar_id":"","url":"https://api.github.com/users/MuawizChaudhary","html_url":"https://github.com/MuawizChaudhary","followers_url":"https://api.github.com/users/MuawizChaudhary/followers","following_url":"https://api.github.com/users/MuawizChaudhary/following{/other_user}","gists_url":"https://api.github.com/users/MuawizChaudhary/gists{/gist_id}","starred_url":"https://api.github.com/users/MuawizChaudhary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MuawizChaudhary/subscriptions","organizations_url":"https://api.github.com/users/MuawizChaudhary/orgs","repos_url":"https://api.github.com/users/MuawizChaudhary/repos","events_url":"https://api.github.com/users/MuawizChaudhary/events{/privacy}","received_events_url":"https://api.github.com/users/MuawizChaudhary/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-05-30T15:15:06Z","state_reason":"not_planned","performed_via_github_app":null}]