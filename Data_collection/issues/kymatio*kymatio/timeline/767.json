[{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/888648663","html_url":"https://github.com/kymatio/kymatio/issues/767#issuecomment-888648663","issue_url":"https://api.github.com/repos/kymatio/kymatio/issues/767","id":888648663,"node_id":"IC_kwDOCQLq_c4097PX","user":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"created_at":"2021-07-28T21:59:06Z","updated_at":"2021-07-28T21:59:06Z","author_association":"COLLABORATOR","body":"Only the Torch backend is differentiable - no other backend supports gradient-based reconstruction. Other algorithms exist but there aren't any examples in Kymatio.","reactions":{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/888648663/reactions","total_count":2,"+1":1,"-1":1,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false}},{"id":5088534574,"node_id":"MDExOkNsb3NlZEV2ZW50NTA4ODUzNDU3NA==","url":"https://api.github.com/repos/kymatio/kymatio/issues/events/5088534574","actor":{"login":"Vin-itall","id":12558361,"node_id":"MDQ6VXNlcjEyNTU4MzYx","avatar_url":"https://avatars.githubusercontent.com/u/12558361?v=4","gravatar_id":"","url":"https://api.github.com/users/Vin-itall","html_url":"https://github.com/Vin-itall","followers_url":"https://api.github.com/users/Vin-itall/followers","following_url":"https://api.github.com/users/Vin-itall/following{/other_user}","gists_url":"https://api.github.com/users/Vin-itall/gists{/gist_id}","starred_url":"https://api.github.com/users/Vin-itall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Vin-itall/subscriptions","organizations_url":"https://api.github.com/users/Vin-itall/orgs","repos_url":"https://api.github.com/users/Vin-itall/repos","events_url":"https://api.github.com/users/Vin-itall/events{/privacy}","received_events_url":"https://api.github.com/users/Vin-itall/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-07-29T22:08:32Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/906942045","html_url":"https://github.com/kymatio/kymatio/issues/767#issuecomment-906942045","issue_url":"https://api.github.com/repos/kymatio/kymatio/issues/767","id":906942045,"node_id":"IC_kwDOCQLq_c42DtZd","user":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"created_at":"2021-08-27T05:47:03Z","updated_at":"2021-08-27T05:47:03Z","author_association":"COLLABORATOR","body":"Actually TF is differentiable, my mistake. I provided an example below, should be adaptable to Keras. Note it is significantly slower than torch mainly per not storing filters as tensors or on GPU.\r\n\r\n<details>\r\n  <summary><b>code</b></summary>\r\n\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\nimport matplotlib.pyplot as plt\r\nfrom kymatio.tensorflow import Scattering1D\r\n\r\n#%% prepare for training #####################################################\r\nN, n_iters, lr = 512, 60, 250\r\nsc = Scattering1D(shape=N, J=5, Q=8)\r\n\r\n# create data\r\nx_original = tf.constant(np.cos(2*np.pi * 32 * np.linspace(0, 1, N, 0)))\r\nx_reconstructed = tf.Variable(tf.random.normal([N]), trainable=True)\r\n# loss function and optimizer\r\nloss_fn = tf.keras.losses.MeanSquaredError()\r\noptimizer = tf.keras.optimizers.SGD(learning_rate=lr, momentum=.9)\r\n\r\n# scattering of original\r\nsc_original = sc(x_original)\r\n\r\n#%% train loop ###############################################################\r\nfor _ in range(n_iters):\r\n    with tf.GradientTape(persistent=True) as g:\r\n        g.watch(x_reconstructed)\r\n        sc_reconstructed = sc(x_reconstructed)\r\n        loss = loss_fn(sc_original, sc_reconstructed)\r\n\r\n    grads = g.gradient(loss, x_reconstructed)\r\n    optimizer.apply_gradients(zip([grads], [x_reconstructed]))\r\n    \r\n#%% visualize results ########################################################\r\nplt.plot(x_original.numpy())\r\nplt.plot(x_reconstructed.numpy())\r\nplt.title(\"Original vs reconstructed\", loc='left', weight='bold', fontsize=17)\r\nplt.show()\r\n```\r\n</details>\r\n\r\n<img src=\"https://user-images.githubusercontent.com/16495490/131078136-ea20a694-fa07-45e9-8adc-f6d3f71ff7ac.png\" width=\"450\">\r\n","reactions":{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/906942045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false}},{"id":5216639182,"node_id":"MDEzOlJlb3BlbmVkRXZlbnQ1MjE2NjM5MTgy","url":"https://api.github.com/repos/kymatio/kymatio/issues/events/5216639182","actor":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"event":"reopened","commit_id":null,"commit_url":null,"created_at":"2021-08-27T05:47:03Z","state_reason":null,"performed_via_github_app":null},{"id":5216639708,"node_id":"MDEyOkxhYmVsZWRFdmVudDUyMTY2Mzk3MDg=","url":"https://api.github.com/repos/kymatio/kymatio/issues/events/5216639708","actor":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-08-27T05:47:15Z","label":{"name":"doc","color":"7ee851"},"performed_via_github_app":null},{"id":5216640258,"node_id":"MDEyOkxhYmVsZWRFdmVudDUyMTY2NDAyNTg=","url":"https://api.github.com/repos/kymatio/kymatio/issues/events/5216640258","actor":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-08-27T05:47:29Z","label":{"name":"enhancement","color":"a2eeef"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1003771727","html_url":"https://github.com/kymatio/kymatio/issues/767#issuecomment-1003771727","issue_url":"https://api.github.com/repos/kymatio/kymatio/issues/767","id":1003771727,"node_id":"IC_kwDOCQLq_c471FdP","user":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"created_at":"2022-01-02T20:38:06Z","updated_at":"2022-01-02T20:38:06Z","author_association":"COLLABORATOR","body":"Marking as resolved, feel free to open if further concerns.","reactions":{"url":"https://api.github.com/repos/kymatio/kymatio/issues/comments/1003771727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false}},{"id":5833028208,"node_id":"CE_lADOCQLq_c447yUrzwAAAAFbrPJw","url":"https://api.github.com/repos/kymatio/kymatio/issues/events/5833028208","actor":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-01-02T20:38:06Z","state_reason":null,"performed_via_github_app":null}]