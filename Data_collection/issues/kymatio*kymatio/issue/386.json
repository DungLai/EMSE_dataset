{"url":"https://api.github.com/repos/kymatio/kymatio/issues/386","repository_url":"https://api.github.com/repos/kymatio/kymatio","labels_url":"https://api.github.com/repos/kymatio/kymatio/issues/386/labels{/name}","comments_url":"https://api.github.com/repos/kymatio/kymatio/issues/386/comments","events_url":"https://api.github.com/repos/kymatio/kymatio/issues/386/events","html_url":"https://github.com/kymatio/kymatio/issues/386","id":448500312,"node_id":"MDU6SXNzdWU0NDg1MDAzMTI=","number":386,"title":"Inverse fft in 2D backend","user":{"login":"nshervt","id":30446938,"node_id":"MDQ6VXNlcjMwNDQ2OTM4","avatar_url":"https://avatars.githubusercontent.com/u/30446938?v=4","gravatar_id":"","url":"https://api.github.com/users/nshervt","html_url":"https://github.com/nshervt","followers_url":"https://api.github.com/users/nshervt/followers","following_url":"https://api.github.com/users/nshervt/following{/other_user}","gists_url":"https://api.github.com/users/nshervt/gists{/gist_id}","starred_url":"https://api.github.com/users/nshervt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nshervt/subscriptions","organizations_url":"https://api.github.com/users/nshervt/orgs","repos_url":"https://api.github.com/users/nshervt/repos","events_url":"https://api.github.com/users/nshervt/events{/privacy}","received_events_url":"https://api.github.com/users/nshervt/received_events","type":"User","site_admin":false},"labels":[{"id":1076176418,"node_id":"MDU6TGFiZWwxMDc2MTc2NDE4","url":"https://api.github.com/repos/kymatio/kymatio/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1163515489,"node_id":"MDU6TGFiZWwxMTYzNTE1NDg5","url":"https://api.github.com/repos/kymatio/kymatio/labels/2D","name":"2D","color":"74ed7c","default":false,"description":"Issue with 2D scattering code"}],"state":"closed","locked":false,"assignee":{"login":"nshervt","id":30446938,"node_id":"MDQ6VXNlcjMwNDQ2OTM4","avatar_url":"https://avatars.githubusercontent.com/u/30446938?v=4","gravatar_id":"","url":"https://api.github.com/users/nshervt","html_url":"https://github.com/nshervt","followers_url":"https://api.github.com/users/nshervt/followers","following_url":"https://api.github.com/users/nshervt/following{/other_user}","gists_url":"https://api.github.com/users/nshervt/gists{/gist_id}","starred_url":"https://api.github.com/users/nshervt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nshervt/subscriptions","organizations_url":"https://api.github.com/users/nshervt/orgs","repos_url":"https://api.github.com/users/nshervt/repos","events_url":"https://api.github.com/users/nshervt/events{/privacy}","received_events_url":"https://api.github.com/users/nshervt/received_events","type":"User","site_admin":false},"assignees":[{"login":"nshervt","id":30446938,"node_id":"MDQ6VXNlcjMwNDQ2OTM4","avatar_url":"https://avatars.githubusercontent.com/u/30446938?v=4","gravatar_id":"","url":"https://api.github.com/users/nshervt","html_url":"https://github.com/nshervt","followers_url":"https://api.github.com/users/nshervt/followers","following_url":"https://api.github.com/users/nshervt/following{/other_user}","gists_url":"https://api.github.com/users/nshervt/gists{/gist_id}","starred_url":"https://api.github.com/users/nshervt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nshervt/subscriptions","organizations_url":"https://api.github.com/users/nshervt/orgs","repos_url":"https://api.github.com/users/nshervt/repos","events_url":"https://api.github.com/users/nshervt/events{/privacy}","received_events_url":"https://api.github.com/users/nshervt/received_events","type":"User","site_admin":false}],"milestone":null,"comments":7,"created_at":"2019-05-25T20:34:40Z","updated_at":"2020-01-23T19:35:57Z","closed_at":"2020-01-23T19:35:57Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"EDIT by EO:\r\n- [x] Using the appropriate normalization for the ifft (ie both backend files)\r\n- [x] Adding a unit test in 2d/test for testing the fft, which is not currently tested \r\n- [x] Normalizing the wavelet in the Fourier domain (ie the file filter_bank.py) to avoid the new code to break and satisfy the previous unit tests\r\nNOTE: this might lead to a small(not to say tiny) speed-up, because the dot-wise multiplication usually use quite some resources!\r\n\r\nIn 2D backend code, in\r\n`            output = torch.ifft(input, 2, normalized=False)*input.size(-2)*input.size(-3)\r\n`\r\nwhy is the inverse fft routine multiplied by the term *input.size(-2)*input.size(-3)? I was expecting that transforming a matrix back and forth to the Fourier domain give the same result. In other words, I was expecting outputs of the following test code match.\r\n\r\n```\r\nimport torch\r\nfrom kymatio.scattering2d import backend as bd2\r\n\r\npad = bd2.Pad(2 ** 0, pre_pad=False)\r\n\r\n# -- parameters\r\nM = 8\r\nN = 8\r\nL = 8\r\nJ = 4\r\n\r\n# -- synthesise data\r\ny = torch.rand(1, 1, M, N)\r\nfor i in range(M):\r\n    for j in range(N):\r\n        y[:,:,i,j] = i+j\r\n\r\ny_pad = pad(y)                                    # pad to add complex dimension\r\ny_fft = bd2.fft(y_pad, 'C2C')                     # fft\r\ny_fft_inv = bd2.fft(y_fft, 'C2C', inverse=True)   # inverse fft\r\ny_fft_inv_un = y_fft_inv[..., 1:-1, 1:-1, 0]      # unpad\r\n\r\n# -- print\r\nprint(y)\r\nprint(y_fft_inv_un)\r\n```","closed_by":{"login":"edouardoyallon","id":4263222,"node_id":"MDQ6VXNlcjQyNjMyMjI=","avatar_url":"https://avatars.githubusercontent.com/u/4263222?v=4","gravatar_id":"","url":"https://api.github.com/users/edouardoyallon","html_url":"https://github.com/edouardoyallon","followers_url":"https://api.github.com/users/edouardoyallon/followers","following_url":"https://api.github.com/users/edouardoyallon/following{/other_user}","gists_url":"https://api.github.com/users/edouardoyallon/gists{/gist_id}","starred_url":"https://api.github.com/users/edouardoyallon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edouardoyallon/subscriptions","organizations_url":"https://api.github.com/users/edouardoyallon/orgs","repos_url":"https://api.github.com/users/edouardoyallon/repos","events_url":"https://api.github.com/users/edouardoyallon/events{/privacy}","received_events_url":"https://api.github.com/users/edouardoyallon/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/kymatio/kymatio/issues/386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/kymatio/kymatio/issues/386/timeline","performed_via_github_app":null,"state_reason":"completed"}