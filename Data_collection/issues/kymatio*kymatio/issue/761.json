{"url":"https://api.github.com/repos/kymatio/kymatio/issues/761","repository_url":"https://api.github.com/repos/kymatio/kymatio","labels_url":"https://api.github.com/repos/kymatio/kymatio/issues/761/labels{/name}","comments_url":"https://api.github.com/repos/kymatio/kymatio/issues/761/comments","events_url":"https://api.github.com/repos/kymatio/kymatio/issues/761/events","html_url":"https://github.com/kymatio/kymatio/issues/761","id":949700110,"node_id":"MDU6SXNzdWU5NDk3MDAxMTA=","number":761,"title":"Keras generators does not work","user":{"login":"robertanto","id":23097044,"node_id":"MDQ6VXNlcjIzMDk3MDQ0","avatar_url":"https://avatars.githubusercontent.com/u/23097044?v=4","gravatar_id":"","url":"https://api.github.com/users/robertanto","html_url":"https://github.com/robertanto","followers_url":"https://api.github.com/users/robertanto/followers","following_url":"https://api.github.com/users/robertanto/following{/other_user}","gists_url":"https://api.github.com/users/robertanto/gists{/gist_id}","starred_url":"https://api.github.com/users/robertanto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/robertanto/subscriptions","organizations_url":"https://api.github.com/users/robertanto/orgs","repos_url":"https://api.github.com/users/robertanto/repos","events_url":"https://api.github.com/users/robertanto/events{/privacy}","received_events_url":"https://api.github.com/users/robertanto/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-07-21T13:19:43Z","updated_at":"2021-08-08T00:01:49Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Dear kymatio team,\r\n\r\nI am trying to train a Keras Neural Network based on the Scattering1D layer. Due to the huge quantity of data, I have implemented a keras.utils.Sequence generator for accessing to my data. But I got the following error:\r\n\r\n```bash\r\nTrain for 10 steps\r\n 1/10 [==>...........................] - ETA: 0s\r\n\r\n---------------------------------------------------------------------------\r\n\r\nTypeError                                 Traceback (most recent call last)\r\n\r\n<ipython-input-5-ef3a40a87ee6> in <module>()\r\n      5 )\r\n      6 \r\n----> 7 model.fit(DataGenerator())\r\n ----------------------------- STACK --------------------------------------\r\n/usr/local/lib/python3.7/dist-packages/kymatio/scattering1d/backend/tensorflow_backend.py in pad_1d(x, pad_left, pad_right, mode, value)\r\n     62         The tensor passed along the third dimension.\r\n     63     \"\"\"\r\n---> 64     if (pad_left >= x.shape[-1]) or (pad_right >= x.shape[-1]):\r\n     65         if mode == 'reflect':\r\n     66             raise ValueError('Indefinite padding size (larger than tensor).')\r\n\r\nTypeError: '>=' not supported between instances of 'int' and 'NoneType'\r\n```\r\n\r\nI am using Tensorflow 2.0.0, in particular, tensorflow.keras together with kymatio-0.2.1.\r\n\r\nHere a simple code to reproduce the error (I tried on google colab, if you try it on colab remember to downgrade tensorflow to 2.0.0).\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\nfrom kymatio.keras import Scattering1D\r\nfrom tensorflow import keras\r\nfrom tensorflow.keras.models import Model\r\nfrom tensorflow.keras.layers import Input,Dense, Flatten\r\nfrom tensorflow.keras.utils import Sequence\r\n\r\nclass DataGenerator(Sequence):\r\n\r\n    def __len__(self):\r\n        'Denotes the number of batches per epoch'\r\n        return 10\r\n\r\n    def __getitem__(self, index):\r\n        'Generate one batch of data'\r\n        X = np.random.rand(1000,3200)\r\n        y = np.random.rand(1000,1024)\r\n        return X, y\r\n\r\n# Params\r\nJ=9\r\nQ=8\r\n\r\n# Model\r\ninputs = Input(shape=(3200,))\r\n  \r\nx = Scattering1D(J,Q)(inputs)\r\nx = Flatten()(x)\r\ny = Dense(1024,'softmax')(x)\r\n\r\n# Final Model\r\nmodel = Model(inputs=inputs,outputs = y)\r\n\r\nmodel.compile(\r\n    loss=keras.losses.CategoricalCrossentropy(),\r\n    optimizer=keras.optimizers.RMSprop(),\r\n    metrics=[\"accuracy\"],\r\n)\r\n\r\nmodel.fit(DataGenerator())\r\n```\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/kymatio/kymatio/issues/761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/kymatio/kymatio/issues/761/timeline","performed_via_github_app":null,"state_reason":null}