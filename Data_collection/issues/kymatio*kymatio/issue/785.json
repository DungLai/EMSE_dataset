{"url":"https://api.github.com/repos/kymatio/kymatio/issues/785","repository_url":"https://api.github.com/repos/kymatio/kymatio","labels_url":"https://api.github.com/repos/kymatio/kymatio/issues/785/labels{/name}","comments_url":"https://api.github.com/repos/kymatio/kymatio/issues/785/comments","events_url":"https://api.github.com/repos/kymatio/kymatio/issues/785/events","html_url":"https://github.com/kymatio/kymatio/issues/785","id":1022025328,"node_id":"I_kwDOCQLq_c486t5w","number":785,"title":"Reviewing `core` JTFS","user":{"login":"OverLordGoldDragon","id":16495490,"node_id":"MDQ6VXNlcjE2NDk1NDkw","avatar_url":"https://avatars.githubusercontent.com/u/16495490?v=4","gravatar_id":"","url":"https://api.github.com/users/OverLordGoldDragon","html_url":"https://github.com/OverLordGoldDragon","followers_url":"https://api.github.com/users/OverLordGoldDragon/followers","following_url":"https://api.github.com/users/OverLordGoldDragon/following{/other_user}","gists_url":"https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OverLordGoldDragon/subscriptions","organizations_url":"https://api.github.com/users/OverLordGoldDragon/orgs","repos_url":"https://api.github.com/users/OverLordGoldDragon/repos","events_url":"https://api.github.com/users/OverLordGoldDragon/events{/privacy}","received_events_url":"https://api.github.com/users/OverLordGoldDragon/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-10-10T16:12:06Z","updated_at":"2022-05-30T15:18:10Z","closed_at":"2022-05-30T15:18:09Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"I recommend focusing on the \"standard\" variant:\r\n\r\n - `average=True; average_fr=True/False; aligned=True; out_3D=False; sampling_filters_fr='resample'; out_exclude=None`\r\n\r\nAll other code can be ignored (e.g. `if out_3D: ...`). This should cut code to under 25% of full size. The rest can be validated via `test_jtfs.py`.\r\n\r\n### Pseudocode\r\n\r\nUp to a spinned pair:\r\n\r\n```python\r\n# first order time scattering\r\nU1 = []\r\nfor p1t in psi1_t:\r\n    U1.append(abs(conv(x, p1t)))\r\n\r\n# joint scattering\r\nU2 = []\r\nfor p2t in psi2_t:\r\n    # second order time scattering\r\n    U2_tm = []\r\n    for u1 in U1:\r\n        U2_tm.append(conv(u1, p2t))\r\n    U2_tm = array(U2_tm)  # shape == (freq, time)\r\n\r\n    # frequential scattering\r\n    for p1f in psi1_fr_up:\r\n        U2.append(abs(conv(U2_tm, p1f, axis=-2)))\r\n```\r\nJTFS is exactly this, but with\r\n\r\n 1. padding, unpadding\r\n 2. lowpass filtering\r\n 3. subsampling\r\n 4. other joint pairs\r\n\r\nMajority of complexity goes into 3; implementation subsamples as much as possible, ~losslessly, which is very complicated in light of all variants.\r\n\r\n### Complete validation\r\n\r\nThe most complicated method, by far, is `_get_stride` in `timefrequency_scattering1d.py`; a 300+ line docstring dedicates to explaining it. Validating this requires familiarity with the entire implementation, and accounting for every possible kwarg combination.\r\n\r\nThe rest can be traversed in an exploratory fashion: picking a test signal, and tracking the output back to input - breakpointing into various stages, and printing all pertinent attributes and plotting intermediate outputs.\r\n\r\nIt's also helpful to familiarize with `compute_meta_jtfs`, which encodes the entire computational graph into a dictionary.\r\n\r\nLastly, majority of features are explained in depth in [Discussions](https://github.com/kymatio/kymatio/discussions) via my posts and discussions with @lostanlen. For those without an IDE preference, I recommend [Spyder](https://github.com/kymatio/kymatio/discussions/782).","closed_by":{"login":"MuawizChaudhary","id":39755015,"node_id":"MDQ6VXNlcjM5NzU1MDE1","avatar_url":"https://avatars.githubusercontent.com/u/39755015?v=4","gravatar_id":"","url":"https://api.github.com/users/MuawizChaudhary","html_url":"https://github.com/MuawizChaudhary","followers_url":"https://api.github.com/users/MuawizChaudhary/followers","following_url":"https://api.github.com/users/MuawizChaudhary/following{/other_user}","gists_url":"https://api.github.com/users/MuawizChaudhary/gists{/gist_id}","starred_url":"https://api.github.com/users/MuawizChaudhary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MuawizChaudhary/subscriptions","organizations_url":"https://api.github.com/users/MuawizChaudhary/orgs","repos_url":"https://api.github.com/users/MuawizChaudhary/repos","events_url":"https://api.github.com/users/MuawizChaudhary/events{/privacy}","received_events_url":"https://api.github.com/users/MuawizChaudhary/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/kymatio/kymatio/issues/785/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/kymatio/kymatio/issues/785/timeline","performed_via_github_app":null,"state_reason":"not_planned"}