{"url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter/issues/199","repository_url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter","labels_url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter/issues/199/labels{/name}","comments_url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter/issues/199/comments","events_url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter/issues/199/events","html_url":"https://github.com/HunterMcGushion/hyperparameter_hunter/issues/199","id":499155286,"node_id":"MDU6SXNzdWU0OTkxNTUyODY=","number":199,"title":"Metaclass conflict with Keras 2.3.0","user":{"login":"HunterMcGushion","id":11300915,"node_id":"MDQ6VXNlcjExMzAwOTE1","avatar_url":"https://avatars.githubusercontent.com/u/11300915?v=4","gravatar_id":"","url":"https://api.github.com/users/HunterMcGushion","html_url":"https://github.com/HunterMcGushion","followers_url":"https://api.github.com/users/HunterMcGushion/followers","following_url":"https://api.github.com/users/HunterMcGushion/following{/other_user}","gists_url":"https://api.github.com/users/HunterMcGushion/gists{/gist_id}","starred_url":"https://api.github.com/users/HunterMcGushion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HunterMcGushion/subscriptions","organizations_url":"https://api.github.com/users/HunterMcGushion/orgs","repos_url":"https://api.github.com/users/HunterMcGushion/repos","events_url":"https://api.github.com/users/HunterMcGushion/events{/privacy}","received_events_url":"https://api.github.com/users/HunterMcGushion/received_events","type":"User","site_admin":false},"labels":[{"id":951977098,"node_id":"MDU6TGFiZWw5NTE5NzcwOTg=","url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter/labels/Bug","name":"Bug","color":"d73a4a","default":false,"description":"Something isn't working"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-09-26T23:05:46Z","updated_at":"2019-11-04T02:12:27Z","closed_at":null,"author_association":"OWNER","active_lock_reason":null,"body":"- Using HyperparameterHunter with the recently released Keras version 2.3.0 raises metaclass conflict error, breaking Keras compatibility\r\n- **TEMPORARY WORKAROUND: Use Keras 2.2.5**\r\n\r\n## Error Traceback\r\n- From executing `examples/keras_examples/experiment_example.py`\r\n```\r\nTraceback (most recent call last):\r\n  File \"keras_examples/experiment_example.py\", line 1, in <module>\r\n    from hyperparameter_hunter import Environment, CVExperiment\r\n  File \"/Users/Hunter/hyperparameter_hunter/hyperparameter_hunter/__init__.py\", line 29, in <module>\r\n    from .environment import Environment\r\n  File \"/Users/Hunter/hyperparameter_hunter/hyperparameter_hunter/environment.py\", line 27, in <module>\r\n    from hyperparameter_hunter.keys.makers import CrossExperimentKeyMaker\r\n  File \"/Users/Hunter/hyperparameter_hunter/hyperparameter_hunter/keys/makers.py\", line 28, in <module>\r\n    from hyperparameter_hunter.library_helpers.keras_optimization_helper import initialize_dummy_model\r\n  File \"/Users/Hunter/hyperparameter_hunter/hyperparameter_hunter/library_helpers/keras_optimization_helper.py\", line 52, in <module>\r\n    from keras.callbacks import Callback as base_keras_callback\r\n  File \"/Users/Hunter/hyperparameter_hunter/env/lib/python3.7/site-packages/keras/__init__.py\", line 3, in <module>\r\n    from . import utils\r\n  File \"/Users/Hunter/hyperparameter_hunter/env/lib/python3.7/site-packages/keras/utils/__init__.py\", line 26, in <module>\r\n    from .vis_utils import model_to_dot\r\n  File \"/Users/Hunter/hyperparameter_hunter/env/lib/python3.7/site-packages/keras/utils/vis_utils.py\", line 7, in <module>\r\n    from ..models import Model\r\n  File \"/Users/Hunter/hyperparameter_hunter/env/lib/python3.7/site-packages/keras/models.py\", line 10, in <module>\r\n    from .engine.input_layer import Input\r\n  File \"/Users/Hunter/hyperparameter_hunter/env/lib/python3.7/site-packages/keras/engine/__init__.py\", line 8, in <module>\r\n    from .training import Model\r\n  File \"/Users/Hunter/hyperparameter_hunter/env/lib/python3.7/site-packages/keras/engine/training.py\", line 14, in <module>\r\n    from . import training_utils\r\n  File \"/Users/Hunter/hyperparameter_hunter/env/lib/python3.7/site-packages/keras/engine/training_utils.py\", line 17, in <module>\r\n    from .. import metrics as metrics_module\r\n  File \"/Users/Hunter/hyperparameter_hunter/env/lib/python3.7/site-packages/keras/metrics.py\", line 34, in <module>\r\n    class Metric(Layer):\r\n  File \"/Users/Hunter/hyperparameter_hunter/env/lib/python3.7/site-packages/six.py\", line 849, in wrapper\r\n    return metaclass(cls.__name__, cls.__bases__, orig_vars)\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/abc.py\", line 126, in __new__\r\n    cls = super().__new__(mcls, name, bases, namespace, **kwargs)\r\nTypeError: metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases\r\n```\r\n\r\n## Bug Hunt Notes\r\n- Updating `tracers.ArgumentTracer` to descend from `ABCMeta` does resolve the metaclass conflict, but leads to different errors regarding the usage of `__deepcopy__` in TensorFlow:\r\n   - `NotImplementedError: __deepcopy__() is only available when eager execution is enabled.`\r\n- Further changes to the Keras API cause some unrelated tests to fail\r\n- Noteworthy changes in Keras 2.3.0 that will require HH fixes:\r\n   - Introduced class-based losses\r\n   - Introduced class-based metrics\r\n   - Renamed `lr` to `learning_rate` for all optimizers\r\n   - Deprecated `decay` argument for all optimizers\r\n   - Changed how metric names are reported to use the exact string given by the user (\"acc\" vs. \"accuracy\")","closed_by":null,"reactions":{"url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter/issues/199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter/issues/199/timeline","performed_via_github_app":null,"state_reason":null}