{"url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter/issues/166","repository_url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter","labels_url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter/issues/166/labels{/name}","comments_url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter/issues/166/comments","events_url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter/issues/166/events","html_url":"https://github.com/HunterMcGushion/hyperparameter_hunter/issues/166","id":473564913,"node_id":"MDU6SXNzdWU0NzM1NjQ5MTM=","number":166,"title":"Dataset hashes change between Pandas versions","user":{"login":"HunterMcGushion","id":11300915,"node_id":"MDQ6VXNlcjExMzAwOTE1","avatar_url":"https://avatars.githubusercontent.com/u/11300915?v=4","gravatar_id":"","url":"https://api.github.com/users/HunterMcGushion","html_url":"https://github.com/HunterMcGushion","followers_url":"https://api.github.com/users/HunterMcGushion/followers","following_url":"https://api.github.com/users/HunterMcGushion/following{/other_user}","gists_url":"https://api.github.com/users/HunterMcGushion/gists{/gist_id}","starred_url":"https://api.github.com/users/HunterMcGushion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HunterMcGushion/subscriptions","organizations_url":"https://api.github.com/users/HunterMcGushion/orgs","repos_url":"https://api.github.com/users/HunterMcGushion/repos","events_url":"https://api.github.com/users/HunterMcGushion/events{/privacy}","received_events_url":"https://api.github.com/users/HunterMcGushion/received_events","type":"User","site_admin":false},"labels":[{"id":951977098,"node_id":"MDU6TGFiZWw5NTE5NzcwOTg=","url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter/labels/Bug","name":"Bug","color":"d73a4a","default":false,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-07-26T23:04:15Z","updated_at":"2019-07-27T05:09:55Z","closed_at":"2019-07-27T05:09:55Z","author_association":"OWNER","active_lock_reason":null,"body":"# Problem\r\n- Updating Pandas from 0.24.2 to 0.25.0 produces different `Environment.cross_experiment_key` values\r\n   - Of all parameters included in the `cross_experiment_key`, only the (hashed) values of the \r\n      datasets actually changed\r\n- This can be seen in the [broken TravisCI build \\#738](https://travis-ci.org/HunterMcGushion/hyperparameter_hunter/builds/563928131?utm_source=github_status&utm_medium=notification)\r\n   - Note: This was made for PR #165, fixing an unrelated bug concerning `Categorical.optional` Feature Engineering steps\r\n- Specifically, the following tests in `tests.test_environment` are failing:\r\n   - `test_environment_init_cv_params` (both scenarios)\r\n   - `test_environment_init_metrics` (both scenarios)\r\n   - `test_environment_init_cross_experiment_params` (both scenarios)\r\n- All six of the failing tests are checking for expected `Environment.cross_experiment_key`\r\n\r\n# Battle-Plan\r\n- Need dataset hashes to be consistent across different Pandas versions\r\n- Add new clause to :func:`hyperparameter_hunter.keys.hashing.to_hashable` to handle DataFrames\r\n   - Because `to_hashable` is used by `make_hash_sha256`, this change will apply not only to key hashes, but also to the WIP hashes generated by :mod:`feature_engineering` to track changes made by different `EngineerStep`s\r\n\r\n# Options for New DataFrame Clause\r\n```python\r\nreturn hashlib.sha256(\r\n    pd.util.hash_pandas_object(obj, index=True).values\r\n).hexdigest()\r\n```\r\n\r\nor something like \r\n\r\n```python\r\nreturn obj.to_csv().encode(\"utf-8\")\r\n```\r\n\r\nBoth produce consistent values for datasets for Pandas 0.24.2 and 0.25.0. However, the first feels safer, whereas the second is easier to understand and follows some representation of the object, rather than an actual hash, which is the intended purpose of `to_hashable`","closed_by":{"login":"HunterMcGushion","id":11300915,"node_id":"MDQ6VXNlcjExMzAwOTE1","avatar_url":"https://avatars.githubusercontent.com/u/11300915?v=4","gravatar_id":"","url":"https://api.github.com/users/HunterMcGushion","html_url":"https://github.com/HunterMcGushion","followers_url":"https://api.github.com/users/HunterMcGushion/followers","following_url":"https://api.github.com/users/HunterMcGushion/following{/other_user}","gists_url":"https://api.github.com/users/HunterMcGushion/gists{/gist_id}","starred_url":"https://api.github.com/users/HunterMcGushion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HunterMcGushion/subscriptions","organizations_url":"https://api.github.com/users/HunterMcGushion/orgs","repos_url":"https://api.github.com/users/HunterMcGushion/repos","events_url":"https://api.github.com/users/HunterMcGushion/events{/privacy}","received_events_url":"https://api.github.com/users/HunterMcGushion/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter/issues/166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/HunterMcGushion/hyperparameter_hunter/issues/166/timeline","performed_via_github_app":null,"state_reason":"completed"}