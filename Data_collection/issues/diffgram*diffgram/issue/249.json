{"url":"https://api.github.com/repos/diffgram/diffgram/issues/249","repository_url":"https://api.github.com/repos/diffgram/diffgram","labels_url":"https://api.github.com/repos/diffgram/diffgram/issues/249/labels{/name}","comments_url":"https://api.github.com/repos/diffgram/diffgram/issues/249/comments","events_url":"https://api.github.com/repos/diffgram/diffgram/issues/249/events","html_url":"https://github.com/diffgram/diffgram/issues/249","id":975808301,"node_id":"MDU6SXNzdWU5NzU4MDgzMDE=","number":249,"title":"[backlog] Fix Query for WorkingDirFileLink.file_list() when using job_id as a filter","user":{"login":"PJEstrada","id":6606958,"node_id":"MDQ6VXNlcjY2MDY5NTg=","avatar_url":"https://avatars.githubusercontent.com/u/6606958?v=4","gravatar_id":"","url":"https://api.github.com/users/PJEstrada","html_url":"https://github.com/PJEstrada","followers_url":"https://api.github.com/users/PJEstrada/followers","following_url":"https://api.github.com/users/PJEstrada/following{/other_user}","gists_url":"https://api.github.com/users/PJEstrada/gists{/gist_id}","starred_url":"https://api.github.com/users/PJEstrada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PJEstrada/subscriptions","organizations_url":"https://api.github.com/users/PJEstrada/orgs","repos_url":"https://api.github.com/users/PJEstrada/repos","events_url":"https://api.github.com/users/PJEstrada/events{/privacy}","received_events_url":"https://api.github.com/users/PJEstrada/received_events","type":"User","site_admin":false},"labels":[{"id":1048365660,"node_id":"MDU6TGFiZWwxMDQ4MzY1NjYw","url":"https://api.github.com/repos/diffgram/diffgram/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":3095735901,"node_id":"MDU6TGFiZWwzMDk1NzM1OTAx","url":"https://api.github.com/repos/diffgram/diffgram/labels/backlog","name":"backlog","color":"58E97A","default":false,"description":""},{"id":3280404168,"node_id":"MDU6TGFiZWwzMjgwNDA0MTY4","url":"https://api.github.com/repos/diffgram/diffgram/labels/backend","name":"backend","color":"3D08AB","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-08-20T17:51:14Z","updated_at":"2021-08-20T17:53:42Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"In this file: \r\n\r\nhttps://github.com/diffgram/diffgram/blob/8de4c0cb7eb94857e34dfb527c271a641f1dabcf/shared/database/source_control/working_dir.py#L532-L549\r\n\r\nThe query is doing a search with the job_id column of the file. I think the job_id column might need to be deprecated as now one file could potentially be in multiple jobs.\r\n\r\nWe would need to refactor this to use the `JobWorkingDir` relation to get the files from the attached directories.\r\n\r\nLet me know if this is valid, and if there are other concerns that might be to be taken into account before doing the change as the file_list function is a core function in the system that should be updated carefully.\r\n\r\nThis query is currently used in the export section, so I think exports that have files that are present in 2 or more jobs will not include all the data.","closed_by":null,"reactions":{"url":"https://api.github.com/repos/diffgram/diffgram/issues/249/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/diffgram/diffgram/issues/249/timeline","performed_via_github_app":null,"state_reason":null}