{"url":"https://api.github.com/repos/diffgram/diffgram/issues/919","repository_url":"https://api.github.com/repos/diffgram/diffgram","labels_url":"https://api.github.com/repos/diffgram/diffgram/issues/919/labels{/name}","comments_url":"https://api.github.com/repos/diffgram/diffgram/issues/919/comments","events_url":"https://api.github.com/repos/diffgram/diffgram/issues/919/events","html_url":"https://github.com/diffgram/diffgram/issues/919","id":1271463663,"node_id":"I_kwDOCM48Rc5LyP7v","number":919,"title":"Docker Compose Migration Timing","user":{"login":"anthony-sarkis","id":18080164,"node_id":"MDQ6VXNlcjE4MDgwMTY0","avatar_url":"https://avatars.githubusercontent.com/u/18080164?v=4","gravatar_id":"","url":"https://api.github.com/users/anthony-sarkis","html_url":"https://github.com/anthony-sarkis","followers_url":"https://api.github.com/users/anthony-sarkis/followers","following_url":"https://api.github.com/users/anthony-sarkis/following{/other_user}","gists_url":"https://api.github.com/users/anthony-sarkis/gists{/gist_id}","starred_url":"https://api.github.com/users/anthony-sarkis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anthony-sarkis/subscriptions","organizations_url":"https://api.github.com/users/anthony-sarkis/orgs","repos_url":"https://api.github.com/users/anthony-sarkis/repos","events_url":"https://api.github.com/users/anthony-sarkis/events{/privacy}","received_events_url":"https://api.github.com/users/anthony-sarkis/received_events","type":"User","site_admin":false},"labels":[{"id":3292370374,"node_id":"MDU6TGFiZWwzMjkyMzcwMzc0","url":"https://api.github.com/repos/diffgram/diffgram/labels/docker-compose","name":"docker-compose","color":"1109CA","default":false,"description":""},{"id":3537555989,"node_id":"LA_kwDOCM48Rc7S2tIV","url":"https://api.github.com/repos/diffgram/diffgram/labels/developer-experience","name":"developer-experience","color":"EF116A","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-06-14T23:22:36Z","updated_at":"2022-06-15T20:56:14Z","closed_at":"2022-06-15T20:56:14Z","author_association":"MEMBER","active_lock_reason":null,"body":"### In the docker compose context:\r\nA table doesn't exist error when walrus and event service are first starting.\r\nCurrent theory is this is due to default service doing the migration on db, and those services not waiting on default\r\n\r\nIn the docker compose file https://github.com/diffgram/diffgram/blob/ec1c422996dbe4b77369bc70816d39274306727b/docker-compose.yaml#L162\r\nthis loops through the migrations\r\nhttps://github.com/diffgram/diffgram/blob/ec1c422996dbe4b77369bc70816d39274306727b/default/db-init.sh#L15\r\n\r\nThe compose file already uses the `depends_on` but perhaps whatever that \"ready\" aspect is not enough in that case\r\n\r\n### Current workaround\r\nis to restart the services\r\n\r\n","closed_by":{"login":"anthony-sarkis","id":18080164,"node_id":"MDQ6VXNlcjE4MDgwMTY0","avatar_url":"https://avatars.githubusercontent.com/u/18080164?v=4","gravatar_id":"","url":"https://api.github.com/users/anthony-sarkis","html_url":"https://github.com/anthony-sarkis","followers_url":"https://api.github.com/users/anthony-sarkis/followers","following_url":"https://api.github.com/users/anthony-sarkis/following{/other_user}","gists_url":"https://api.github.com/users/anthony-sarkis/gists{/gist_id}","starred_url":"https://api.github.com/users/anthony-sarkis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anthony-sarkis/subscriptions","organizations_url":"https://api.github.com/users/anthony-sarkis/orgs","repos_url":"https://api.github.com/users/anthony-sarkis/repos","events_url":"https://api.github.com/users/anthony-sarkis/events{/privacy}","received_events_url":"https://api.github.com/users/anthony-sarkis/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/diffgram/diffgram/issues/919/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/diffgram/diffgram/issues/919/timeline","performed_via_github_app":null,"state_reason":"completed"}