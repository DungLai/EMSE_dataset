{"url":"https://api.github.com/repos/justinshenk/fer/issues/24","repository_url":"https://api.github.com/repos/justinshenk/fer","labels_url":"https://api.github.com/repos/justinshenk/fer/issues/24/labels{/name}","comments_url":"https://api.github.com/repos/justinshenk/fer/issues/24/comments","events_url":"https://api.github.com/repos/justinshenk/fer/issues/24/events","html_url":"https://github.com/justinshenk/fer/issues/24","id":925928275,"node_id":"MDU6SXNzdWU5MjU5MjgyNzU=","number":24,"title":"Feature: Analyse only the part of an image/video","user":{"login":"Owlwasrowk","id":9198741,"node_id":"MDQ6VXNlcjkxOTg3NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9198741?v=4","gravatar_id":"","url":"https://api.github.com/users/Owlwasrowk","html_url":"https://github.com/Owlwasrowk","followers_url":"https://api.github.com/users/Owlwasrowk/followers","following_url":"https://api.github.com/users/Owlwasrowk/following{/other_user}","gists_url":"https://api.github.com/users/Owlwasrowk/gists{/gist_id}","starred_url":"https://api.github.com/users/Owlwasrowk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Owlwasrowk/subscriptions","organizations_url":"https://api.github.com/users/Owlwasrowk/orgs","repos_url":"https://api.github.com/users/Owlwasrowk/repos","events_url":"https://api.github.com/users/Owlwasrowk/events{/privacy}","received_events_url":"https://api.github.com/users/Owlwasrowk/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-06-21T07:47:07Z","updated_at":"2021-07-13T19:57:09Z","closed_at":"2021-07-13T19:57:09Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I'm currently try to analyse Let's Plays videos. It would be very usefull, if i can provide an additional paremter for the Video analysis with something like a detection box to ensure, that i alwalys analyse only the overlay with the streamer face. I see 2 possible workarounds here:\r\n\r\n1. Perform the video analysis for full images and only return the emotions, where the face box is inside a given box\r\n2. Perform the video analysis only for the given box to reduce unnecessary calculations.\r\n\r\nMy actual workaround for 2. is the following snippet:\r\n```python\r\nDETECTION_BOX = {\"x_min\": 0, \"x_max\": 150, \"y_min\": 100, \"y_max\": 275}\r\ndef analyse_emotions(self, detection_box, frequency=None, detector=None):\r\n       #...\r\n        for fno in range(0, total_frames, frequency):\r\n            self.cap.set(cv2.CAP_PROP_POS_FRAMES, fno)\r\n            _, img = self.cap.read()\r\n            detections = self._get_emotions_image(image=img, detection_box=detection_box)\r\n       #...\r\ndef _get_emotions_image(self, image, detection_box):\r\n        crop_img = image[\r\n                   detection_box.get(\"y_min\"): detection_box.get(\"y_max\"),\r\n                   detection_box.get(\"x_min\"): detection_box.get(\"x_max\")]\r\n        emotions = self.detector.detect_emotions(crop_img)\r\n        for emotion in emotions:\r\n            original_box = emotion.get(\"box\")\r\n            emotion[\"box\"] = (\r\n                original_box[0] + detection_box.get(\"x_min\"), original_box[1] + detection_box.get(\"y_min\"),\r\n                original_box[2], original_box[3])\r\n        return emotions\r\n```","closed_by":{"login":"justinshenk","id":10270308,"node_id":"MDQ6VXNlcjEwMjcwMzA4","avatar_url":"https://avatars.githubusercontent.com/u/10270308?v=4","gravatar_id":"","url":"https://api.github.com/users/justinshenk","html_url":"https://github.com/justinshenk","followers_url":"https://api.github.com/users/justinshenk/followers","following_url":"https://api.github.com/users/justinshenk/following{/other_user}","gists_url":"https://api.github.com/users/justinshenk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinshenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinshenk/subscriptions","organizations_url":"https://api.github.com/users/justinshenk/orgs","repos_url":"https://api.github.com/users/justinshenk/repos","events_url":"https://api.github.com/users/justinshenk/events{/privacy}","received_events_url":"https://api.github.com/users/justinshenk/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/justinshenk/fer/issues/24/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/justinshenk/fer/issues/24/timeline","performed_via_github_app":null,"state_reason":"completed"}