{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/50","repository_url":"https://api.github.com/repos/salesforce/decaNLP","labels_url":"https://api.github.com/repos/salesforce/decaNLP/issues/50/labels{/name}","comments_url":"https://api.github.com/repos/salesforce/decaNLP/issues/50/comments","events_url":"https://api.github.com/repos/salesforce/decaNLP/issues/50/events","html_url":"https://github.com/salesforce/decaNLP/issues/50","id":422138906,"node_id":"MDU6SXNzdWU0MjIxMzg5MDY=","number":50,"title":"cannot reproduce output for custom dataset from example","user":{"login":"smsalaken","id":14285677,"node_id":"MDQ6VXNlcjE0Mjg1Njc3","avatar_url":"https://avatars.githubusercontent.com/u/14285677?v=4","gravatar_id":"","url":"https://api.github.com/users/smsalaken","html_url":"https://github.com/smsalaken","followers_url":"https://api.github.com/users/smsalaken/followers","following_url":"https://api.github.com/users/smsalaken/following{/other_user}","gists_url":"https://api.github.com/users/smsalaken/gists{/gist_id}","starred_url":"https://api.github.com/users/smsalaken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smsalaken/subscriptions","organizations_url":"https://api.github.com/users/smsalaken/orgs","repos_url":"https://api.github.com/users/smsalaken/repos","events_url":"https://api.github.com/users/smsalaken/events{/privacy}","received_events_url":"https://api.github.com/users/smsalaken/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-03-18T10:23:46Z","updated_at":"2019-03-18T10:23:46Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I am trying to reproduce the output using example inference code for custom dataset. Followed the shown process to generate `my_custom_dataset` but the output does not match. \r\n\r\nCommand:\r\n`docker run -it --rm -v `pwd`:/decaNLP/ -u $(id -u):$(id -g) bmccann/decanlp:torch041 bash -c \"python /decaNLP/predict.py --evaluate valid --path /decaNLP/squad_mqan_cove_cpu --checkpoint_name iteration_39000.pth --tasks my_custom_dataset --device -1\"` \r\n\r\nHere is the output I am getting, which does not show the prediction at all. It also keeps expanding the vocabulary everytime I run the above command.\r\n\r\n```\r\n39000\r\n77.18\r\nArguments:\r\n{'best_checkpoint': '/decaNLP/squad_mqan_cove_cpu/iteration_39000.pth',\r\n 'bleu': False,\r\n 'checkpoint_name': 'iteration_39000.pth',\r\n 'cove': True,\r\n 'data': '/decaNLP/.data/',\r\n 'devices': [-1],\r\n 'dimension': 200,\r\n 'dropout_ratio': 0.0,\r\n 'embeddings': '/decaNLP/.embeddings',\r\n 'evaluate': 'valid',\r\n 'intermediate_cove': False,\r\n 'load': None,\r\n 'lower': True,\r\n 'max_generative_vocab': 50000,\r\n 'max_output_length': 100,\r\n 'max_val_context_length': 400,\r\n 'model': 'MultitaskQuestionAnsweringNetwork',\r\n 'overwrite_predictions': False,\r\n 'path': '/decaNLP/squad_mqan_cove_cpu',\r\n 'rnn_layers': 1,\r\n 'rouge': False,\r\n 'seed': 123,\r\n 'silent': False,\r\n 'task_to_metric': {'cnn_dailymail': 'avg_rouge',\r\n                    'iwslt.en.de': 'bleu',\r\n                    'multinli.in.out': 'em',\r\n                    'schema': 'em',\r\n                    'squad': 'nf1',\r\n                    'srl': 'nf1',\r\n                    'sst': 'em',\r\n                    'wikisql': 'lfem',\r\n                    'woz.en': 'joint_goal_em',\r\n                    'zre': 'corpus_f1'},\r\n 'tasks': ['my_custom_dataset'],\r\n 'transformer_heads': 3,\r\n 'transformer_hidden': 150,\r\n 'transformer_layers': 2,\r\n 'val_batch_size': [256]}\r\nLoading from /decaNLP/squad_mqan_cove_cpu/iteration_39000.pth\r\nInitializing Model\r\nLoading my_custom_dataset\r\nCaching data to /decaNLP/.data/my_custom_dataset/.cache/val.jsonl/None\r\nVocabulary has 87176 tokens from training\r\nVocabulary has expanded to 87176 tokens\r\n100%|█████████████████████████████████████████████████████████████████████████████████████| 874474/874474 [00:30<00:00, 28815.11it/s]\r\n```\r\n\r\nI am running this on Macbook Pro with Anaconda. Here is the output for `conda list`:\r\n\r\n```\r\n\r\n# packages in environment at /Users/MY_USER_NAME/anaconda3:\r\n#\r\n# Name                    Version                   Build  Channel\r\n_ipyw_jlab_nb_ext_conf    0.1.0                    py36_0\r\nalabaster                 0.7.12                   py36_0\r\nanaconda                  5.0.1            py36h6e48e2d_1\r\nanaconda-client           1.7.2                    py36_0\r\nanaconda-navigator        1.9.2                    py36_0\r\nanaconda-project          0.8.2                    py36_0\r\nappnope                   0.1.0            py36hf537a9a_0\r\nappscript                 1.0.1            py36h1de35cc_1\r\nasn1crypto                0.24.0                   py36_0\r\nastroid                   2.1.0                    py36_0\r\nastropy                   3.0.5            py36h1de35cc_0\r\natomicwrites              1.2.1                    py36_0\r\nattrs                     18.2.0           py36h28b3542_0\r\nbabel                     2.6.0                    py36_0\r\nbackcall                  0.1.0                    py36_0\r\nbackports                 1.0                      py36_1\r\nbackports.os              0.1.1                    py36_0\r\nbackports.shutil_get_terminal_size 1.0.0                    py36_2\r\nbeautifulsoup4            4.6.3                    py36_0\r\nbitarray                  0.8.3            py36h1de35cc_0\r\nbkcharts                  0.2              py36h073222e_0\r\nblas                      1.0                         mkl\r\nblaze                     0.11.3           py36h02e7a37_0\r\nbleach                    3.0.2                    py36_0\r\nblosc                     1.14.4               hd9629dc_0\r\nbokeh                     1.0.2                    py36_0\r\nboto                      2.49.0                   py36_0\r\nbottleneck                1.2.1            py36h1d22016_1\r\nbzip2                     1.0.6                h1de35cc_5\r\nca-certificates           2019.1.23                     0\r\ncertifi                   2018.11.29               py36_0\r\ncffi                      1.11.5           py36h6174b99_1\r\nchardet                   3.0.4                    py36_1\r\nclick                     7.0                      py36_0\r\ncloudpickle               0.6.1                    py36_0\r\nclyent                    1.2.2                    py36_1\r\ncolorama                  0.4.0                    py36_0\r\nconda                     4.6.3                    py36_0\r\nconda-build               3.17.1                   py36_0\r\nconda-env                 2.6.0                         1\r\nconda-verify              3.1.1                    py36_0\r\ncontextlib2               0.5.5            py36hd66e5e7_0\r\ncryptography              2.5              py36ha12b0ac_0\r\ncurl                      7.63.0            ha441bb4_1000\r\ncycler                    0.10.0           py36hfc81398_0\r\ncython                    0.29             py36h0a44026_0\r\ncytoolz                   0.9.0.1          py36h1de35cc_1\r\ndask                      1.0.0                    py36_0\r\ndask-core                 1.0.0                    py36_0\r\ndatashape                 0.5.4                    py36_1\r\ndbus                      1.13.2               h760590f_1\r\ndecorator                 4.3.0                    py36_0\r\ndistributed               1.25.0                   py36_0\r\ndocutils                  0.14             py36hbfde631_0\r\nentrypoints               0.2.3                    py36_2\r\net_xmlfile                1.0.1            py36h1315bdc_0\r\nexpat                     2.2.6                h0a44026_0\r\nfastcache                 1.0.2            py36h1de35cc_2\r\nfilelock                  3.0.10                   py36_0\r\nflake8                    3.6.0                    py36_0\r\nflask                     1.0.2                    py36_1\r\nflask-cors                3.0.7                    py36_0\r\nfreetype                  2.9.1                hb4e5f40_0\r\nfuture                    0.17.1                   py36_0\r\nget_terminal_size         1.0.0                h7520d66_0\r\ngettext                   0.19.8.1             h15daf44_3\r\ngevent                    1.3.7            py36h1de35cc_1\r\nglib                      2.56.2               hd9629dc_0\r\nglob2                     0.6                      py36_1\r\ngmp                       6.1.2                hb37e062_1\r\ngmpy2                     2.0.8            py36h6ef4df4_2\r\ngreenlet                  0.4.15           py36h1de35cc_0\r\nh5py                      2.8.0            py36h878fce3_3\r\nhdf5                      1.10.2               hfa1e0ec_1\r\nheapdict                  1.0.0                    py36_2\r\nhtml5lib                  1.0.1                    py36_0\r\nicu                       58.2                 h4b95b61_1\r\nidna                      2.7                      py36_0\r\nimageio                   2.4.1                    py36_0\r\nimagesize                 1.1.0                    py36_0\r\nimportlib_metadata        0.6                      py36_0\r\nintel-openmp              2019.1                      144\r\nipykernel                 5.1.0            py36h39e3cac_0\r\nipython                   7.2.0            py36h39e3cac_0\r\nipython_genutils          0.2.0            py36h241746c_0\r\nipywidgets                7.4.2                    py36_0\r\nisort                     4.3.4                    py36_0\r\nitsdangerous              1.1.0                    py36_0\r\njbig                      2.1                  h4d881f8_0\r\njdcal                     1.4                      py36_0\r\njedi                      0.13.1                   py36_0\r\njinja2                    2.10                     py36_0\r\njpeg                      9b                   he5867d9_2\r\njsonschema                2.6.0            py36hb385e00_0\r\njupyter                   1.0.0                    py36_7\r\njupyter_client            5.2.3                    py36_0\r\njupyter_console           6.0.0                    py36_0\r\njupyter_core              4.4.0                    py36_0\r\njupyterlab                0.35.3                   py36_0\r\njupyterlab_launcher       0.13.1                   py36_0\r\njupyterlab_server         0.2.0                    py36_0\r\nkeyring                   16.1.1                   py36_0\r\nkiwisolver                1.0.1            py36h0a44026_0\r\nkrb5                      1.16.1               hddcf347_7\r\nlazy-object-proxy         1.3.1            py36h1de35cc_2\r\nlibarchive                3.3.3                he8b1da1_2\r\nlibcurl                   7.63.0            h051b688_1000\r\nlibcxx                    4.0.1                hcfea43d_1\r\nlibcxxabi                 4.0.1                hcfea43d_1\r\nlibedit                   3.1.20170329         hb402a30_2\r\nlibffi                    3.2.1                h475c297_4\r\nlibgfortran               3.0.1                h93005f0_2\r\nlibiconv                  1.15                 hdd342a3_7\r\nliblief                   0.9.0                h2a1bed3_0\r\nlibpng                    1.6.35               ha441bb4_0\r\nlibsodium                 1.0.16               h3efe00b_0\r\nlibssh2                   1.8.0                ha12b0ac_4\r\nlibtiff                   4.0.9                hcb84e12_2\r\nlibxml2                   2.9.8                hab757c2_1\r\nlibxslt                   1.1.32               hb819dd2_0\r\nllvmlite                  0.26.0           py36h8c7ce04_0\r\nlocket                    0.2.0            py36hca03003_1\r\nlxml                      4.2.5            py36hef8c89e_0\r\nlz4-c                     1.8.1.2              h1de35cc_0\r\nlzo                       2.10                 h362108e_2\r\nmarkupsafe                1.1.0            py36h1de35cc_0\r\nmatplotlib                3.0.1            py36h54f8f79_0\r\nmccabe                    0.6.1                    py36_1\r\nmistune                   0.8.4            py36h1de35cc_0\r\nmkl                       2018.0.3                      1\r\nmkl-service               1.1.2            py36h6b9c3cc_5\r\nmkl_fft                   1.0.6            py36hb8a8100_0\r\nmkl_random                1.0.1            py36h5d10147_1\r\nmore-itertools            4.3.0                    py36_0\r\nmpc                       1.1.0                h6ef4df4_1\r\nmpfr                      4.0.1                h3018a27_3\r\nmpmath                    1.0.0                    py36_2\r\nmsgpack-python            0.5.6            py36h04f5b5a_1\r\nmultipledispatch          0.6.0                    py36_0\r\nnavigator-updater         0.2.1                    py36_0\r\nnbconvert                 5.3.1                    py36_0\r\nnbformat                  4.4.0            py36h827af21_0\r\nncurses                   6.1                  h0a44026_1\r\nnetworkx                  2.2                      py36_1\r\nninja                     1.8.2            py36h04f5b5a_1\r\nnltk                      3.3.0                    py36_0\r\nnose                      1.3.7                    py36_2\r\nnotebook                  5.7.2                    py36_0\r\nnumba                     0.35.0              np113py36_6\r\nnumexpr                   2.6.8            py36h1dc9127_0\r\nnumpy                     1.15.4           py36h6a91979_0\r\nnumpy-base                1.15.4           py36h8a80b8c_0\r\nnumpydoc                  0.8.0                    py36_0\r\nodo                       0.5.1            py36hc1af34a_0\r\nolefile                   0.46                     py36_0\r\nopenpyxl                  2.5.11                   py36_0\r\nopenssl                   1.1.1a               h1de35cc_0\r\npackaging                 18.0                     py36_0\r\npandas                    0.23.4           py36h6440ff4_0\r\npandoc                    2.2.3.2                       0\r\npandocfilters             1.4.2                    py36_1\r\nparso                     0.3.1                    py36_0\r\npartd                     0.3.9                    py36_0\r\npath.py                   11.5.0                   py36_0\r\npathlib2                  2.3.2                    py36_0\r\npatsy                     0.5.1                    py36_0\r\npcre                      8.42                 h378b8a2_0\r\npep8                      1.7.1                    py36_0\r\npexpect                   4.6.0                    py36_0\r\npickleshare               0.7.5                    py36_0\r\npillow                    5.3.0            py36hb68e598_0\r\npip                       18.1                     py36_0\r\npkginfo                   1.4.2                    py36_1\r\npluggy                    0.8.0                    py36_0\r\nply                       3.11                     py36_0\r\nprometheus_client         0.4.2                    py36_0\r\nprompt_toolkit            2.0.7                    py36_0\r\npsutil                    5.4.8            py36h1de35cc_0\r\nptyprocess                0.6.0                    py36_0\r\npy                        1.7.0                    py36_0\r\npy-lief                   0.9.0            py36hd4eaf27_0\r\npycodestyle               2.4.0                    py36_0\r\npycosat                   0.6.3            py36h1de35cc_0\r\npycparser                 2.19                     py36_0\r\npycrypto                  2.6.1            py36h1de35cc_9\r\npycurl                    7.43.0.2         py36ha12b0ac_0\r\npyflakes                  2.0.0                    py36_0\r\npygments                  2.2.0            py36h240cd3f_0\r\npylint                    2.2.2                    py36_0\r\npyodbc                    4.0.24           py36h0a44026_0\r\npyopenssl                 18.0.0                   py36_0\r\npyparsing                 2.3.0                    py36_0\r\npyqt                      5.9.2            py36h655552a_2\r\npysocks                   1.6.8                    py36_0\r\npytables                  3.4.4            py36h13cba08_0\r\npytest                    4.0.1                    py36_0\r\npytest-arraydiff          0.2              py36h39e3cac_0\r\npytest-astropy            0.4.0                    py36_0\r\npytest-doctestplus        0.2.0                    py36_0\r\npytest-openfiles          0.3.1                    py36_0\r\npytest-remotedata         0.3.1                    py36_0\r\npython                    3.6.7                haf84260_0\r\npython-dateutil           2.7.5                    py36_0\r\npython-libarchive-c       2.8                      py36_6\r\npython.app                2                        py36_9\r\npytorch                   0.4.1           py36_cuda0.0_cudnn0.0_1    pytorch\r\npytz                      2018.7                   py36_0\r\npywavelets                1.0.1            py36h1d22016_0\r\npyyaml                    3.13             py36h1de35cc_0\r\npyzmq                     17.1.2           py36h1de35cc_0\r\nqt                        5.9.6                h45cd832_2\r\nqtawesome                 0.5.3                    py36_0\r\nqtconsole                 4.4.2                    py36_0\r\nqtpy                      1.5.2                    py36_0\r\nreadline                  7.0                  h1de35cc_5\r\nrequests                  2.20.1                   py36_0\r\nrope                      0.11.0                   py36_0\r\nruamel_yaml               0.15.46          py36h1de35cc_0\r\nscikit-image              0.14.0           py36h0a44026_1\r\nscikit-learn              0.20.1           py36h4f467ca_0\r\nscipy                     1.1.0            py36h28f7352_1\r\nseaborn                   0.9.0                    py36_0\r\nsend2trash                1.5.0                    py36_0\r\nsetuptools                40.6.2                   py36_0\r\nsimplegeneric             0.8.1                    py36_2\r\nsingledispatch            3.4.0.3          py36hf20db9d_0\r\nsip                       4.19.8           py36h0a44026_0\r\nsix                       1.11.0                   py36_1\r\nsnappy                    1.1.7                he62c110_3\r\nsnowballstemmer           1.2.1            py36h6c7b616_0\r\nsortedcollections         1.0.1                    py36_0\r\nsortedcontainers          2.1.0                    py36_0\r\nsphinx                    1.8.2                    py36_0\r\nsphinxcontrib             1.0                      py36_1\r\nsphinxcontrib-websupport  1.1.0                    py36_1\r\nspyder                    3.3.2                    py36_0\r\nspyder-kernels            0.3.0                    py36_0\r\nsqlalchemy                1.2.14           py36h1de35cc_0\r\nsqlite                    3.25.3               ha441bb4_0\r\nstatsmodels               0.9.0            py36h1d22016_0\r\nsympy                     1.3                      py36_0\r\ntblib                     1.3.2            py36hda67792_0\r\nterminado                 0.8.1                    py36_1\r\ntestpath                  0.4.2                    py36_0\r\ntk                        8.6.8                ha441bb4_0\r\ntoolz                     0.9.0                    py36_0\r\ntorchvision               0.2.1                    py36_1    pytorch\r\ntornado                   5.1.1            py36h1de35cc_0\r\ntqdm                      4.28.1           py36h28b3542_0\r\ntraitlets                 4.3.2            py36h65bd3ce_0\r\ntyped-ast                 1.1.0            py36h1de35cc_0\r\ntyping                    3.6.4                    py36_0\r\nunicodecsv                0.14.1           py36he531d66_0\r\nunixodbc                  2.3.7                h1de35cc_0\r\nurllib3                   1.23                     py36_0\r\nwcwidth                   0.1.7            py36h8c6ec74_0\r\nwebencodings              0.5.1                    py36_1\r\nwerkzeug                  0.14.1                   py36_0\r\nwheel                     0.32.3                   py36_0\r\nwidgetsnbextension        3.4.2                    py36_0\r\nwrapt                     1.10.11          py36h1de35cc_2\r\nwurlitzer                 1.0.2                    py36_0\r\nxlrd                      1.1.0                    py36_1\r\nxlsxwriter                1.1.2                    py36_0\r\nxlwings                   0.15.0                   py36_0\r\nxlwt                      1.2.0            py36h5ad1178_0\r\nxz                        5.2.4                h1de35cc_4\r\nyaml                      0.1.7                hc338f04_2\r\nzeromq                    4.2.5                h0a44026_1\r\nzict                      0.1.3                    py36_0\r\nzlib                      1.2.11               h1de35cc_3\r\nzstd                      1.3.3                h2a6be3a_0\r\n\r\n```","closed_by":null,"reactions":{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/50/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/salesforce/decaNLP/issues/50/timeline","performed_via_github_app":null,"state_reason":null}