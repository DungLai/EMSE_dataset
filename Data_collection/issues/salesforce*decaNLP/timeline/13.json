[{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/comments/406098981","html_url":"https://github.com/salesforce/decaNLP/issues/13#issuecomment-406098981","issue_url":"https://api.github.com/repos/salesforce/decaNLP/issues/13","id":406098981,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjA5ODk4MQ==","user":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false},"created_at":"2018-07-18T22:54:13Z","updated_at":"2018-07-18T22:54:13Z","author_association":"CONTRIBUTOR","body":"At what point d you run out of CPU memory? This is most likely going to happen while ROUGE is being computed. If that is the case for you, then you can turn off ROUGE evaluation and only do it at the end of training. If you could provide more detail about when/where it runs out of memory I might be able to help more. ","reactions":{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/comments/406098981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/comments/411595386","html_url":"https://github.com/salesforce/decaNLP/issues/13#issuecomment-411595386","issue_url":"https://api.github.com/repos/salesforce/decaNLP/issues/13","id":411595386,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTU5NTM4Ng==","user":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false},"created_at":"2018-08-09T00:15:39Z","updated_at":"2018-08-09T00:15:39Z","author_association":"CONTRIBUTOR","body":"Hi @t-vi, just checking in. Were you able to resolve this by turning off ROUGE. If not, at what point were you running out of RAM? Loading the datasets or during training/validation?","reactions":{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/comments/411595386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false}},{"id":1779061655,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTc3OTA2MTY1NQ==","url":"https://api.github.com/repos/salesforce/decaNLP/issues/events/1779061655","actor":{"login":"t-vi","id":20787943,"node_id":"MDQ6VXNlcjIwNzg3OTQz","avatar_url":"https://avatars.githubusercontent.com/u/20787943?v=4","gravatar_id":"","url":"https://api.github.com/users/t-vi","html_url":"https://github.com/t-vi","followers_url":"https://api.github.com/users/t-vi/followers","following_url":"https://api.github.com/users/t-vi/following{/other_user}","gists_url":"https://api.github.com/users/t-vi/gists{/gist_id}","starred_url":"https://api.github.com/users/t-vi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/t-vi/subscriptions","organizations_url":"https://api.github.com/users/t-vi/orgs","repos_url":"https://api.github.com/users/t-vi/repos","events_url":"https://api.github.com/users/t-vi/events{/privacy}","received_events_url":"https://api.github.com/users/t-vi/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-08-09T00:15:39Z","performed_via_github_app":null},{"id":1779061656,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE3NzkwNjE2NTY=","url":"https://api.github.com/repos/salesforce/decaNLP/issues/events/1779061656","actor":{"login":"t-vi","id":20787943,"node_id":"MDQ6VXNlcjIwNzg3OTQz","avatar_url":"https://avatars.githubusercontent.com/u/20787943?v=4","gravatar_id":"","url":"https://api.github.com/users/t-vi","html_url":"https://github.com/t-vi","followers_url":"https://api.github.com/users/t-vi/followers","following_url":"https://api.github.com/users/t-vi/following{/other_user}","gists_url":"https://api.github.com/users/t-vi/gists{/gist_id}","starred_url":"https://api.github.com/users/t-vi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/t-vi/subscriptions","organizations_url":"https://api.github.com/users/t-vi/orgs","repos_url":"https://api.github.com/users/t-vi/repos","events_url":"https://api.github.com/users/t-vi/events{/privacy}","received_events_url":"https://api.github.com/users/t-vi/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-08-09T00:15:39Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/comments/412068317","html_url":"https://github.com/salesforce/decaNLP/issues/13#issuecomment-412068317","issue_url":"https://api.github.com/repos/salesforce/decaNLP/issues/13","id":412068317,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMjA2ODMxNw==","user":{"login":"delldu","id":31266222,"node_id":"MDQ6VXNlcjMxMjY2MjIy","avatar_url":"https://avatars.githubusercontent.com/u/31266222?v=4","gravatar_id":"","url":"https://api.github.com/users/delldu","html_url":"https://github.com/delldu","followers_url":"https://api.github.com/users/delldu/followers","following_url":"https://api.github.com/users/delldu/following{/other_user}","gists_url":"https://api.github.com/users/delldu/gists{/gist_id}","starred_url":"https://api.github.com/users/delldu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/delldu/subscriptions","organizations_url":"https://api.github.com/users/delldu/orgs","repos_url":"https://api.github.com/users/delldu/repos","events_url":"https://api.github.com/users/delldu/events{/privacy}","received_events_url":"https://api.github.com/users/delldu/received_events","type":"User","site_admin":false},"created_at":"2018-08-10T12:31:46Z","updated_at":"2018-08-10T12:31:46Z","author_association":"NONE","body":"GPU out of memory, How to fix it ? \r\nError message is:\r\nprocess_0 - Begin Training\r\nTHCudaCheck FAIL file=/opt/conda/conda-bld/pytorch_1518244421288/work/torch/lib/THC/generic/THCStorage.cu line=58 error=2 : out of memory\r\nTraceback (most recent call last):\r\n  File \"/decaNLP/train.py\", line 365, in <module>\r\n    main()\r\n  File \"/decaNLP/train.py\", line 361, in main\r\n    run(args, run_args, world_size=args.world_size)\r\n  File \"/decaNLP/train.py\", line 309, in run\r\n    writer=writer if rank==0 else None, save_every=args.save_every, start_iteration=start_iteration)\r\n  File \"/decaNLP/train.py\", line 220, in train\r\n    loss, train_metric_dict = step(model, batch, opt, iteration, field, task, lr=lr, grad_clip=args.grad_clip, writer=writer, it=train_iter)\r\n  File \"/decaNLP/train.py\", line 131, in step\r\n    loss.backward()\r\n  File \"/opt/conda/lib/python3.6/site-packages/torch/autograd/variable.py\", line 167, in backward\r\n    torch.autograd.backward(self, gradient, retain_graph, create_graph, retain_variables)\r\n  File \"/opt/conda/lib/python3.6/site-packages/torch/autograd/__init__.py\", line 99, in backward\r\n    variables, grad_variables, retain_graph)\r\n  File \"/opt/conda/lib/python3.6/site-packages/torch/autograd/function.py\", line 91, in apply\r\n    return self._forward_cls.backward(self, *args)\r\n  File \"/opt/conda/lib/python3.6/site-packages/torch/autograd/_functions/tensor.py\", line 481, in backward\r\n    grad_tensor = grad_tensor.masked_scatter(mask, grad_output)\r\n  File \"/opt/conda/lib/python3.6/site-packages/torch/autograd/variable.py\", line 427, in masked_scatter\r\n    return self.clone().masked_scatter_(mask, variable)\r\nRuntimeError: cuda runtime error (2) : **out of memory** at **/opt/conda/conda-bld/pytorch_1518244421288/work/torch/lib/THC/generic/THCStorage.cu:58**\r\n","reactions":{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/comments/412068317/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"delldu","id":31266222,"node_id":"MDQ6VXNlcjMxMjY2MjIy","avatar_url":"https://avatars.githubusercontent.com/u/31266222?v=4","gravatar_id":"","url":"https://api.github.com/users/delldu","html_url":"https://github.com/delldu","followers_url":"https://api.github.com/users/delldu/followers","following_url":"https://api.github.com/users/delldu/following{/other_user}","gists_url":"https://api.github.com/users/delldu/gists{/gist_id}","starred_url":"https://api.github.com/users/delldu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/delldu/subscriptions","organizations_url":"https://api.github.com/users/delldu/orgs","repos_url":"https://api.github.com/users/delldu/repos","events_url":"https://api.github.com/users/delldu/events{/privacy}","received_events_url":"https://api.github.com/users/delldu/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/comments/412069071","html_url":"https://github.com/salesforce/decaNLP/issues/13#issuecomment-412069071","issue_url":"https://api.github.com/repos/salesforce/decaNLP/issues/13","id":412069071,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMjA2OTA3MQ==","user":{"login":"delldu","id":31266222,"node_id":"MDQ6VXNlcjMxMjY2MjIy","avatar_url":"https://avatars.githubusercontent.com/u/31266222?v=4","gravatar_id":"","url":"https://api.github.com/users/delldu","html_url":"https://github.com/delldu","followers_url":"https://api.github.com/users/delldu/followers","following_url":"https://api.github.com/users/delldu/following{/other_user}","gists_url":"https://api.github.com/users/delldu/gists{/gist_id}","starred_url":"https://api.github.com/users/delldu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/delldu/subscriptions","organizations_url":"https://api.github.com/users/delldu/orgs","repos_url":"https://api.github.com/users/delldu/repos","events_url":"https://api.github.com/users/delldu/events{/privacy}","received_events_url":"https://api.github.com/users/delldu/received_events","type":"User","site_admin":false},"created_at":"2018-08-10T12:34:53Z","updated_at":"2018-08-10T12:34:53Z","author_association":"NONE","body":"Some information about:\r\n1) Task\r\npython /decaNLP/train.py --train_tasks squad --gpu 0\r\n2) GPU\r\nroot@e7ebc34933bd:/# nvidia-smi \r\nFri Aug 10 12:33:36 2018       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 384.130                Driver Version: 384.130                   |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 1060    Off  | 00000000:01:00.0  On |                  N/A |\r\n| N/A   45C    P8     9W /  N/A |    364MiB /  6070MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n+-----------------------------------------------------------------------------+\r\n3) Train parameters:\r\n{'backend': 'gloo',\r\n 'beta0': 0.9,\r\n 'commit': '704ce1360d1cd49bc838a1da03decf06620b563b',\r\n 'data': '/decaNLP/.data/',\r\n 'dimension': 200,\r\n 'dist_sync_file': '/decaNLP/results/18/08/10/03/58/49.865648/squad,MultitaskQuestionAnsweringNetwork,1g/704ce13/distributed_sync_file',\r\n 'dropout_ratio': 0.2,\r\n 'embeddings': '/decaNLP/.embeddings',\r\n 'exist_ok': False,\r\n 'gpus': [0],\r\n 'grad_clip': 1.0,\r\n 'jump_start': 0,\r\n 'load': None,\r\n 'log_dir': '/decaNLP/results/18/08/10/03/58/49.865648/squad,MultitaskQuestionAnsweringNetwork,1g/704ce13',\r\n 'log_every': 100,\r\n 'lower': True,\r\n 'max_answer_length': 50,\r\n 'max_effective_vocab': 1000000,\r\n 'max_generative_vocab': 50000,\r\n 'max_output_length': 100,\r\n 'max_train_context_length': 400,\r\n 'max_val_context_length': 400,\r\n 'model': 'MultitaskQuestionAnsweringNetwork',\r\n 'n_jump_start': 0,\r\n 'num_print': 15,\r\n 'resume': False,\r\n 'reverse': False,\r\n 'rnn_layers': 1,\r\n 'save': '/decaNLP/results',\r\n 'save_every': 1000,\r\n 'seed': 123,\r\n 'subsample': 20000000,\r\n 'timestamp': '18/08/10/03/58/49.865648',\r\n 'token_testing': False,\r\n 'train_batch_tokens': [10000],\r\n 'train_iterations': None,\r\n 'train_tasks': ['squad'],\r\n 'transformer_heads': 3,\r\n 'transformer_hidden': 150,\r\n 'transformer_layers': 2,\r\n 'transformer_lr': True,\r\n 'val_batch_size': [32],\r\n 'val_every': 1000,\r\n 'val_filter': True,\r\n 'val_tasks': ['squad'],\r\n 'vocab_tasks': None,\r\n 'warmup': 800,\r\n 'world_size': 1}\r\n\r\n","reactions":{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/comments/412069071/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"delldu","id":31266222,"node_id":"MDQ6VXNlcjMxMjY2MjIy","avatar_url":"https://avatars.githubusercontent.com/u/31266222?v=4","gravatar_id":"","url":"https://api.github.com/users/delldu","html_url":"https://github.com/delldu","followers_url":"https://api.github.com/users/delldu/followers","following_url":"https://api.github.com/users/delldu/following{/other_user}","gists_url":"https://api.github.com/users/delldu/gists{/gist_id}","starred_url":"https://api.github.com/users/delldu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/delldu/subscriptions","organizations_url":"https://api.github.com/users/delldu/orgs","repos_url":"https://api.github.com/users/delldu/repos","events_url":"https://api.github.com/users/delldu/events{/privacy}","received_events_url":"https://api.github.com/users/delldu/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/comments/414532396","html_url":"https://github.com/salesforce/decaNLP/issues/13#issuecomment-414532396","issue_url":"https://api.github.com/repos/salesforce/decaNLP/issues/13","id":414532396,"node_id":"MDEyOklzc3VlQ29tbWVudDQxNDUzMjM5Ng==","user":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false},"created_at":"2018-08-21T02:48:55Z","updated_at":"2018-08-22T21:36:57Z","author_association":"CONTRIBUTOR","body":"@t-vi This was a problem with the memory consumption of the tokenizer we were using (revtok). It was creating too many short strings during tokenization. For now, a quick fix (1f83b7a739502d2d826a0a2a95452a66dbf58273), but we'll get this fixed in revtok (update: https://github.com/jekbradbury/revtok/commit/f1998b72a941d1e5f9578a66dc1c20b01913caab).\r\n\r\nLet me know if this fixes your issue!","reactions":{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/comments/414532396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false}},{"id":1799117346,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTc5OTExNzM0Ng==","url":"https://api.github.com/repos/salesforce/decaNLP/issues/events/1799117346","actor":{"login":"t-vi","id":20787943,"node_id":"MDQ6VXNlcjIwNzg3OTQz","avatar_url":"https://avatars.githubusercontent.com/u/20787943?v=4","gravatar_id":"","url":"https://api.github.com/users/t-vi","html_url":"https://github.com/t-vi","followers_url":"https://api.github.com/users/t-vi/followers","following_url":"https://api.github.com/users/t-vi/following{/other_user}","gists_url":"https://api.github.com/users/t-vi/gists{/gist_id}","starred_url":"https://api.github.com/users/t-vi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/t-vi/subscriptions","organizations_url":"https://api.github.com/users/t-vi/orgs","repos_url":"https://api.github.com/users/t-vi/repos","events_url":"https://api.github.com/users/t-vi/events{/privacy}","received_events_url":"https://api.github.com/users/t-vi/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-08-21T02:48:55Z","performed_via_github_app":null},{"id":1799117347,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE3OTkxMTczNDc=","url":"https://api.github.com/repos/salesforce/decaNLP/issues/events/1799117347","actor":{"login":"t-vi","id":20787943,"node_id":"MDQ6VXNlcjIwNzg3OTQz","avatar_url":"https://avatars.githubusercontent.com/u/20787943?v=4","gravatar_id":"","url":"https://api.github.com/users/t-vi","html_url":"https://github.com/t-vi","followers_url":"https://api.github.com/users/t-vi/followers","following_url":"https://api.github.com/users/t-vi/following{/other_user}","gists_url":"https://api.github.com/users/t-vi/gists{/gist_id}","starred_url":"https://api.github.com/users/t-vi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/t-vi/subscriptions","organizations_url":"https://api.github.com/users/t-vi/orgs","repos_url":"https://api.github.com/users/t-vi/repos","events_url":"https://api.github.com/users/t-vi/events{/privacy}","received_events_url":"https://api.github.com/users/t-vi/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-08-21T02:48:55Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/comments/414532579","html_url":"https://github.com/salesforce/decaNLP/issues/13#issuecomment-414532579","issue_url":"https://api.github.com/repos/salesforce/decaNLP/issues/13","id":414532579,"node_id":"MDEyOklzc3VlQ29tbWVudDQxNDUzMjU3OQ==","user":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false},"created_at":"2018-08-21T02:50:09Z","updated_at":"2018-08-21T02:51:37Z","author_association":"CONTRIBUTOR","body":"@delldu You'll need to run with a smaller --train_batch_tokens value than the default of 10k or you'll need to reduce the size of the model --dimension or one of the other arguments listed in lines 58-62 of https://github.com/salesforce/decaNLP/blob/1f83b7a739502d2d826a0a2a95452a66dbf58273/arguments.py#L58.","reactions":{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/comments/414532579/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false}},{"id":1799118436,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTc5OTExODQzNg==","url":"https://api.github.com/repos/salesforce/decaNLP/issues/events/1799118436","actor":{"login":"delldu","id":31266222,"node_id":"MDQ6VXNlcjMxMjY2MjIy","avatar_url":"https://avatars.githubusercontent.com/u/31266222?v=4","gravatar_id":"","url":"https://api.github.com/users/delldu","html_url":"https://github.com/delldu","followers_url":"https://api.github.com/users/delldu/followers","following_url":"https://api.github.com/users/delldu/following{/other_user}","gists_url":"https://api.github.com/users/delldu/gists{/gist_id}","starred_url":"https://api.github.com/users/delldu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/delldu/subscriptions","organizations_url":"https://api.github.com/users/delldu/orgs","repos_url":"https://api.github.com/users/delldu/repos","events_url":"https://api.github.com/users/delldu/events{/privacy}","received_events_url":"https://api.github.com/users/delldu/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-08-21T02:50:09Z","performed_via_github_app":null},{"id":1799118437,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE3OTkxMTg0Mzc=","url":"https://api.github.com/repos/salesforce/decaNLP/issues/events/1799118437","actor":{"login":"delldu","id":31266222,"node_id":"MDQ6VXNlcjMxMjY2MjIy","avatar_url":"https://avatars.githubusercontent.com/u/31266222?v=4","gravatar_id":"","url":"https://api.github.com/users/delldu","html_url":"https://github.com/delldu","followers_url":"https://api.github.com/users/delldu/followers","following_url":"https://api.github.com/users/delldu/following{/other_user}","gists_url":"https://api.github.com/users/delldu/gists{/gist_id}","starred_url":"https://api.github.com/users/delldu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/delldu/subscriptions","organizations_url":"https://api.github.com/users/delldu/orgs","repos_url":"https://api.github.com/users/delldu/repos","events_url":"https://api.github.com/users/delldu/events{/privacy}","received_events_url":"https://api.github.com/users/delldu/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-08-21T02:50:09Z","performed_via_github_app":null},{"id":1799122708,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQxNzk5MTIyNzA4","url":"https://api.github.com/repos/salesforce/decaNLP/issues/events/1799122708","actor":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2018-08-21T02:54:41Z","assignee":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"id":1799123044,"node_id":"MDEyOkxhYmVsZWRFdmVudDE3OTkxMjMwNDQ=","url":"https://api.github.com/repos/salesforce/decaNLP/issues/events/1799123044","actor":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2018-08-21T02:54:55Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"id":1799125768,"node_id":"MDEyOkxhYmVsZWRFdmVudDE3OTkxMjU3Njg=","url":"https://api.github.com/repos/salesforce/decaNLP/issues/events/1799125768","actor":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2018-08-21T02:57:44Z","label":{"name":"duplicate","color":"cfd3d7"},"performed_via_github_app":null},{"actor":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false},"created_at":"2018-08-21T02:58:45Z","updated_at":"2018-08-21T02:58:45Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/20","repository_url":"https://api.github.com/repos/salesforce/decaNLP","labels_url":"https://api.github.com/repos/salesforce/decaNLP/issues/20/labels{/name}","comments_url":"https://api.github.com/repos/salesforce/decaNLP/issues/20/comments","events_url":"https://api.github.com/repos/salesforce/decaNLP/issues/20/events","html_url":"https://github.com/salesforce/decaNLP/issues/20","id":346237661,"node_id":"MDU6SXNzdWUzNDYyMzc2NjE=","number":20,"title":"Unable to load cnn_dailymail","user":{"login":"xuf12","id":3258243,"node_id":"MDQ6VXNlcjMyNTgyNDM=","avatar_url":"https://avatars.githubusercontent.com/u/3258243?v=4","gravatar_id":"","url":"https://api.github.com/users/xuf12","html_url":"https://github.com/xuf12","followers_url":"https://api.github.com/users/xuf12/followers","following_url":"https://api.github.com/users/xuf12/following{/other_user}","gists_url":"https://api.github.com/users/xuf12/gists{/gist_id}","starred_url":"https://api.github.com/users/xuf12/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuf12/subscriptions","organizations_url":"https://api.github.com/users/xuf12/orgs","repos_url":"https://api.github.com/users/xuf12/repos","events_url":"https://api.github.com/users/xuf12/events{/privacy}","received_events_url":"https://api.github.com/users/xuf12/received_events","type":"User","site_admin":false},"labels":[{"id":969829425,"node_id":"MDU6TGFiZWw5Njk4Mjk0MjU=","url":"https://api.github.com/repos/salesforce/decaNLP/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false},"assignees":[{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2018-07-31T15:23:12Z","updated_at":"2018-08-22T21:36:08Z","closed_at":"2018-08-21T03:04:14Z","author_association":"NONE","active_lock_reason":null,"repository":{"id":137988610,"node_id":"MDEwOlJlcG9zaXRvcnkxMzc5ODg2MTA=","name":"decaNLP","full_name":"salesforce/decaNLP","private":false,"owner":{"login":"salesforce","id":453694,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ1MzY5NA==","avatar_url":"https://avatars.githubusercontent.com/u/453694?v=4","gravatar_id":"","url":"https://api.github.com/users/salesforce","html_url":"https://github.com/salesforce","followers_url":"https://api.github.com/users/salesforce/followers","following_url":"https://api.github.com/users/salesforce/following{/other_user}","gists_url":"https://api.github.com/users/salesforce/gists{/gist_id}","starred_url":"https://api.github.com/users/salesforce/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/salesforce/subscriptions","organizations_url":"https://api.github.com/users/salesforce/orgs","repos_url":"https://api.github.com/users/salesforce/repos","events_url":"https://api.github.com/users/salesforce/events{/privacy}","received_events_url":"https://api.github.com/users/salesforce/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/salesforce/decaNLP","description":"The Natural Language Decathlon: A Multitask Challenge for NLP","fork":false,"url":"https://api.github.com/repos/salesforce/decaNLP","forks_url":"https://api.github.com/repos/salesforce/decaNLP/forks","keys_url":"https://api.github.com/repos/salesforce/decaNLP/keys{/key_id}","collaborators_url":"https://api.github.com/repos/salesforce/decaNLP/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/salesforce/decaNLP/teams","hooks_url":"https://api.github.com/repos/salesforce/decaNLP/hooks","issue_events_url":"https://api.github.com/repos/salesforce/decaNLP/issues/events{/number}","events_url":"https://api.github.com/repos/salesforce/decaNLP/events","assignees_url":"https://api.github.com/repos/salesforce/decaNLP/assignees{/user}","branches_url":"https://api.github.com/repos/salesforce/decaNLP/branches{/branch}","tags_url":"https://api.github.com/repos/salesforce/decaNLP/tags","blobs_url":"https://api.github.com/repos/salesforce/decaNLP/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/salesforce/decaNLP/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/salesforce/decaNLP/git/refs{/sha}","trees_url":"https://api.github.com/repos/salesforce/decaNLP/git/trees{/sha}","statuses_url":"https://api.github.com/repos/salesforce/decaNLP/statuses/{sha}","languages_url":"https://api.github.com/repos/salesforce/decaNLP/languages","stargazers_url":"https://api.github.com/repos/salesforce/decaNLP/stargazers","contributors_url":"https://api.github.com/repos/salesforce/decaNLP/contributors","subscribers_url":"https://api.github.com/repos/salesforce/decaNLP/subscribers","subscription_url":"https://api.github.com/repos/salesforce/decaNLP/subscription","commits_url":"https://api.github.com/repos/salesforce/decaNLP/commits{/sha}","git_commits_url":"https://api.github.com/repos/salesforce/decaNLP/git/commits{/sha}","comments_url":"https://api.github.com/repos/salesforce/decaNLP/comments{/number}","issue_comment_url":"https://api.github.com/repos/salesforce/decaNLP/issues/comments{/number}","contents_url":"https://api.github.com/repos/salesforce/decaNLP/contents/{+path}","compare_url":"https://api.github.com/repos/salesforce/decaNLP/compare/{base}...{head}","merges_url":"https://api.github.com/repos/salesforce/decaNLP/merges","archive_url":"https://api.github.com/repos/salesforce/decaNLP/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/salesforce/decaNLP/downloads","issues_url":"https://api.github.com/repos/salesforce/decaNLP/issues{/number}","pulls_url":"https://api.github.com/repos/salesforce/decaNLP/pulls{/number}","milestones_url":"https://api.github.com/repos/salesforce/decaNLP/milestones{/number}","notifications_url":"https://api.github.com/repos/salesforce/decaNLP/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/salesforce/decaNLP/labels{/name}","releases_url":"https://api.github.com/repos/salesforce/decaNLP/releases{/id}","deployments_url":"https://api.github.com/repos/salesforce/decaNLP/deployments","created_at":"2018-06-20T06:19:43Z","updated_at":"2023-01-07T22:23:06Z","pushed_at":"2022-10-26T06:45:48Z","git_url":"git://github.com/salesforce/decaNLP.git","ssh_url":"git@github.com:salesforce/decaNLP.git","clone_url":"https://github.com/salesforce/decaNLP.git","svn_url":"https://github.com/salesforce/decaNLP","homepage":"","size":848,"stargazers_count":2284,"watchers_count":2284,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":false,"forks_count":426,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":8,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause","node_id":"MDc6TGljZW5zZTU="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["deep-learning","multitask-learning","natural-language-processing"],"visibility":"public","forks":426,"open_issues":8,"watchers":2284,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"I ran the following command just to train on cnn_dailymail:\r\n```nvidia-docker run -it --rm -v `pwd`:/decaNLP/ -u $(id -u):$(id -g) decanlp bash -c \"python /decaNLP/train.py --train_tasks cnn_dailymail --train_iterations 1 --gpu 0\"```\r\n\r\nand I got the following error message:\r\n```process_main - Constructing field\r\nprocess_main - Loading cnn_dailymail\r\nprocess_main - Adding cnn_dailymail to training datasets\r\nTraceback (most recent call last):\r\n  File \"/decaNLP/train.py\", line 365, in <module>\r\n    main()\r\n  File \"/decaNLP/train.py\", line 352, in main\r\n    field, train_sets, val_sets = prepare_data(args, field, logger)\r\n  File \"/decaNLP/train.py\", line 67, in prepare_data\r\n    split = get_splits(args, task, FIELD, **kwargs)[0]\r\n  File \"/decaNLP/util.py\", line 161, in get_splits\r\n    fields=FIELD, root=args.data, **kwargs)\r\n  File \"/decaNLP/text/torchtext/datasets/generic.py\", line 426, in splits\r\n    os.path.join(path, 'training.jsonl'), fields, **kwargs)\r\n  File \"/decaNLP/text/torchtext/datasets/generic.py\", line 353, in __init__\r\n    examples = torch.load(cache_name)\r\n  File \"/opt/conda/lib/python3.6/site-packages/torch/serialization.py\", line 267, in load\r\n    return _load(f, map_location, pickle_module)\r\n  File \"/opt/conda/lib/python3.6/site-packages/torch/serialization.py\", line 420, in _load\r\n    result = unpickler.load()\r\nEOFError: Ran out of input\r\n```\r\nI tried running cnn only without any issue. However, when I train for dailymail only, I ran out of RAM (I have 32GB). So the 2 questions I have are:\r\n\r\n1. How much RAM do we need to load dailymail alone? \r\n2. How to load the cnn_dailymail data without EOFError?\r\n\r\nThank you.","reactions":{"url":"https://api.github.com/repos/salesforce/decaNLP/issues/20/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/salesforce/decaNLP/issues/20/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":1799132170,"node_id":"MDExOkNsb3NlZEV2ZW50MTc5OTEzMjE3MA==","url":"https://api.github.com/repos/salesforce/decaNLP/issues/events/1799132170","actor":{"login":"bmccann","id":3359909,"node_id":"MDQ6VXNlcjMzNTk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3359909?v=4","gravatar_id":"","url":"https://api.github.com/users/bmccann","html_url":"https://github.com/bmccann","followers_url":"https://api.github.com/users/bmccann/followers","following_url":"https://api.github.com/users/bmccann/following{/other_user}","gists_url":"https://api.github.com/users/bmccann/gists{/gist_id}","starred_url":"https://api.github.com/users/bmccann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmccann/subscriptions","organizations_url":"https://api.github.com/users/bmccann/orgs","repos_url":"https://api.github.com/users/bmccann/repos","events_url":"https://api.github.com/users/bmccann/events{/privacy}","received_events_url":"https://api.github.com/users/bmccann/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2018-08-21T03:04:21Z","state_reason":null,"performed_via_github_app":null}]