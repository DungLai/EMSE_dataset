{"url":"https://api.github.com/repos/mozilla/TTS/issues/374","repository_url":"https://api.github.com/repos/mozilla/TTS","labels_url":"https://api.github.com/repos/mozilla/TTS/issues/374/labels{/name}","comments_url":"https://api.github.com/repos/mozilla/TTS/issues/374/comments","events_url":"https://api.github.com/repos/mozilla/TTS/issues/374/events","html_url":"https://github.com/mozilla/TTS/issues/374","id":575530005,"node_id":"MDU6SXNzdWU1NzU1MzAwMDU=","number":374,"title":"Cannot start training on LibriTTS when enabling phonemizer ","user":{"login":"george-roussos","id":25833833,"node_id":"MDQ6VXNlcjI1ODMzODMz","avatar_url":"https://avatars.githubusercontent.com/u/25833833?v=4","gravatar_id":"","url":"https://api.github.com/users/george-roussos","html_url":"https://github.com/george-roussos","followers_url":"https://api.github.com/users/george-roussos/followers","following_url":"https://api.github.com/users/george-roussos/following{/other_user}","gists_url":"https://api.github.com/users/george-roussos/gists{/gist_id}","starred_url":"https://api.github.com/users/george-roussos/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/george-roussos/subscriptions","organizations_url":"https://api.github.com/users/george-roussos/orgs","repos_url":"https://api.github.com/users/george-roussos/repos","events_url":"https://api.github.com/users/george-roussos/events{/privacy}","received_events_url":"https://api.github.com/users/george-roussos/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-03-04T15:57:14Z","updated_at":"2020-03-04T17:06:33Z","closed_at":"2020-03-04T17:06:32Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"If I disable the phonemizer, training starts okay, but I enable it, I get an error that one of the .npy files weren't found: \r\n\r\n````\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 715, in <module>\r\n    main(args)\r\n  File \"train.py\", line 631, in main\r\n    global_step, epoch)\r\n  File \"train.py\", line 144, in train\r\n    for num_iter, data in enumerate(data_loader):\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 345, in __next__\r\n    data = self._next_data()\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 856, in _next_data\r\n    return self._process_data(data)\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 881, in _process_data\r\n    data.reraise()\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/torch/_utils.py\", line 394, in reraise\r\n    raise self.exc_type(msg)\r\nIndexError: Caught IndexError in DataLoader worker process 0.\r\nOriginal Traceback (most recent call last):\r\n  File \"/home/georgios_roussos/TTS_m/tts_namespace/TTS/datasets/TTSDataset.py\", line 94, in _load_or_generate_phoneme_sequence\r\n    phonemes = np.load(cache_path)\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/numpy/lib/npyio.py\", line 428, in load\r\n    fid = open(os_fspath(file), \"rb\")\r\nFileNotFoundError: [Errno 2] No such file or directory: '/mozilla_us_phonemes_2_1/5339_14134_000072_000000_phoneme.npy'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/torch/utils/data/_utils/worker.py\", line 178, in _worker_loop\r\n    data = fetcher.fetch(index)\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py\", line 44, in fetch\r\n    data = [self.dataset[idx] for idx in possibly_batched_index]\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py\", line 44, in <listcomp>\r\n    data = [self.dataset[idx] for idx in possibly_batched_index]\r\n  File \"/home/georgios_roussos/TTS_m/tts_namespace/TTS/datasets/TTSDataset.py\", line 164, in __getitem__\r\n    return self.load_data(idx)\r\n  File \"/home/georgios_roussos/TTS_m/tts_namespace/TTS/datasets/TTSDataset.py\", line 113, in load_data\r\n    text = self._load_or_generate_phoneme_sequence(wav_file, text)\r\n  File \"/home/georgios_roussos/TTS_m/tts_namespace/TTS/datasets/TTSDataset.py\", line 97, in _load_or_generate_phoneme_sequence\r\n    cache_path)\r\n  File \"/home/georgios_roussos/TTS_m/tts_namespace/TTS/datasets/TTSDataset.py\", line 84, in _generate_and_cache_phoneme_sequence\r\n    enable_eos_bos=False)\r\n  File \"/home/georgios_roussos/TTS_m/tts_namespace/TTS/utils/text/__init__.py\", line 68, in phoneme_to_sequence\r\n    to_phonemes = text2phone(clean_text, language)\r\n  File \"/home/georgios_roussos/TTS_m/tts_namespace/TTS/utils/text/__init__.py\", line 47, in text2phone\r\n    ph = phonemize(text, separator=seperator, strip=False, njobs=1, backend='espeak', language=language, preserve_punctuation=True)\r\n  File \"/usr/local/lib/python3.6/dist-packages/phonemizer/phonemize.py\", line 172, in phonemize\r\n    text, separator=separator, strip=strip, njobs=njobs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/phonemizer/backend/base.py\", line 126, in phonemize\r\n    text = self._punctuator.restore(text, punctuation_marks)\r\n  File \"/usr/local/lib/python3.6/dist-packages/phonemizer/punctuation.py\", line 146, in restore\r\n    return cls._restore_aux(str2list(text), marks, 0)\r\n  File \"/usr/local/lib/python3.6/dist-packages/phonemizer/punctuation.py\", line 166, in _restore_aux\r\n    [text[0] + m.mark + text[1]] + text[2:], marks[1:], n)\r\nIndexError: list index out of range\r\n\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 715, in <module>\r\n    main(args)\r\n  File \"train.py\", line 631, in main\r\n    global_step, epoch)\r\n  File \"train.py\", line 144, in train\r\n    for num_iter, data in enumerate(data_loader):\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 345, in __next__\r\n    data = self._next_data()\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 856, in _next_data\r\n    return self._process_data(data)\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/torch/utils/data/dataloader.py\", line 881, in _process_data\r\n    data.reraise()\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/torch/_utils.py\", line 394, in reraise\r\n    raise self.exc_type(msg)\r\nIndexError: Caught IndexError in DataLoader worker process 0.\r\nOriginal Traceback (most recent call last):\r\n  File \"/home/georgios_roussos/TTS_m/tts_namespace/TTS/datasets/TTSDataset.py\", line 94, in _load_or_generate_phoneme_sequence\r\n    phonemes = np.load(cache_path)\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/numpy/lib/npyio.py\", line 428, in load\r\n    fid = open(os_fspath(file), \"rb\")\r\nFileNotFoundError: [Errno 2] No such file or directory: '/mozilla_us_phonemes_2_1/5339_14134_000072_000000_phoneme.npy'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/torch/utils/data/_utils/worker.py\", line 178, in _worker_loop\r\n    data = fetcher.fetch(index)\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py\", line 44, in fetch\r\n    data = [self.dataset[idx] for idx in possibly_batched_index]\r\n  File \"/home/georgios_roussos/.local/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py\", line 44, in <listcomp>\r\n    data = [self.dataset[idx] for idx in possibly_batched_index]\r\n  File \"/home/georgios_roussos/TTS_m/tts_namespace/TTS/datasets/TTSDataset.py\", line 164, in __getitem__\r\n    return self.load_data(idx)\r\n  File \"/home/georgios_roussos/TTS_m/tts_namespace/TTS/datasets/TTSDataset.py\", line 113, in load_data\r\n    text = self._load_or_generate_phoneme_sequence(wav_file, text)\r\n  File \"/home/georgios_roussos/TTS_m/tts_namespace/TTS/datasets/TTSDataset.py\", line 97, in _load_or_generate_phoneme_sequence\r\n    cache_path)\r\n  File \"/home/georgios_roussos/TTS_m/tts_namespace/TTS/datasets/TTSDataset.py\", line 84, in _generate_and_cache_phoneme_sequence\r\n    enable_eos_bos=False)\r\n  File \"/home/georgios_roussos/TTS_m/tts_namespace/TTS/utils/text/__init__.py\", line 68, in phoneme_to_sequence\r\n    to_phonemes = text2phone(clean_text, language)\r\n  File \"/home/georgios_roussos/TTS_m/tts_namespace/TTS/utils/text/__init__.py\", line 47, in text2phone\r\n    ph = phonemize(text, separator=seperator, strip=False, njobs=1, backend='espeak', language=language, preserve_punctuation=True)\r\n  File \"/usr/local/lib/python3.6/dist-packages/phonemizer/phonemize.py\", line 172, in phonemize\r\n    text, separator=separator, strip=strip, njobs=njobs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/phonemizer/backend/base.py\", line 126, in phonemize\r\n    text = self._punctuator.restore(text, punctuation_marks)\r\n  File \"/usr/local/lib/python3.6/dist-packages/phonemizer/punctuation.py\", line 146, in restore\r\n    return cls._restore_aux(str2list(text), marks, 0)\r\n  File \"/usr/local/lib/python3.6/dist-packages/phonemizer/punctuation.py\", line 166, in _restore_aux\r\n    [text[0] + m.mark + text[1]] + text[2:], marks[1:], n)\r\nIndexError: list index out of range\r\n````\r\n\r\nI don't really wanna train without the phonemizer. Is there any reason why this is showing up? It goes away when I disable use of phonemes in the config file.","closed_by":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mozilla/TTS/issues/374/timeline","performed_via_github_app":null,"state_reason":"completed"}