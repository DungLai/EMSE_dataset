{"url":"https://api.github.com/repos/mozilla/TTS/issues/659","repository_url":"https://api.github.com/repos/mozilla/TTS","labels_url":"https://api.github.com/repos/mozilla/TTS/issues/659/labels{/name}","comments_url":"https://api.github.com/repos/mozilla/TTS/issues/659/comments","events_url":"https://api.github.com/repos/mozilla/TTS/issues/659/events","html_url":"https://github.com/mozilla/TTS/issues/659","id":810502685,"node_id":"MDU6SXNzdWU4MTA1MDI2ODU=","number":659,"title":"cuDNN error: CUDNN_STATUS_BAD_PARAM","user":{"login":"luis-vera","id":62342745,"node_id":"MDQ6VXNlcjYyMzQyNzQ1","avatar_url":"https://avatars.githubusercontent.com/u/62342745?v=4","gravatar_id":"","url":"https://api.github.com/users/luis-vera","html_url":"https://github.com/luis-vera","followers_url":"https://api.github.com/users/luis-vera/followers","following_url":"https://api.github.com/users/luis-vera/following{/other_user}","gists_url":"https://api.github.com/users/luis-vera/gists{/gist_id}","starred_url":"https://api.github.com/users/luis-vera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luis-vera/subscriptions","organizations_url":"https://api.github.com/users/luis-vera/orgs","repos_url":"https://api.github.com/users/luis-vera/repos","events_url":"https://api.github.com/users/luis-vera/events{/privacy}","received_events_url":"https://api.github.com/users/luis-vera/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-02-17T20:11:24Z","updated_at":"2021-02-18T09:35:51Z","closed_at":"2021-02-18T09:35:51Z","author_association":"NONE","active_lock_reason":null,"body":"Hi. I tried training to tacotron (Windows 10 and one GPU GeForce RTX2080 Ti) and I got the following error message:\r\n\r\nThanks a lot for your help\r\n\r\npython TTS/bin/train_tacotron.py --config_path TTS/tts/configs/config.json\r\n2021-02-17 17:09:11.997602: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cudart64_101.dll\r\n > Using CUDA:  True\r\n > Number of GPUs:  1\r\n   >  Mixed precision mode is ON\r\n > Git Hash: e9e0784\r\n > Experiment folder: Models/LJSpeech/ljspeech-ddc-February-17-2021_05+09PM-e9e0784\r\n > Setting up Audio Processor...\r\n | > sample_rate:22050\r\n | > resample:False\r\n | > num_mels:80\r\n | > min_level_db:-100\r\n | > frame_shift_ms:None\r\n | > frame_length_ms:None\r\n | > ref_level_db:20\r\n | > fft_size:1024\r\n | > power:1.5\r\n | > preemphasis:0.0\r\n | > griffin_lim_iters:60\r\n | > signal_norm:True\r\n | > symmetric_norm:True\r\n | > mel_fmin:50.0\r\n | > mel_fmax:7600.0\r\n | > spec_gain:1.0\r\n | > stft_pad_mode:reflect\r\n | > max_norm:4.0\r\n | > clip_norm:True\r\n | > do_trim_silence:True\r\n | > trim_db:60\r\n | > do_sound_norm:False\r\n | > stats_path:scale_stats.npy\r\n | > hop_length:256\r\n | > win_length:1024\r\n | > Found 13100 files in C:\\Users\\Voice-trainner\\MozillaTTS\\TTS\\LJSpeech-1.1\r\n > Using model: Tacotron2\r\n\r\n > Model has 47914548 parameters\r\n\r\n > DataLoader initialization\r\n | > Use phonemes: True\r\n   | > phoneme language: en-us\r\n | > Number of instances : 12969\r\n | > Max length sequence: 187\r\n | > Min length sequence: 5\r\n | > Avg length sequence: 98.3403500655409\r\n | > Num. instances discarded by max-min (max=153, min=6) seq limits: 476\r\n | > Batch group size: 16.\r\n\r\n > EPOCH: 0/1000\r\n\r\n > Number of output frames: 7\r\n\r\n > TRAINING (2021-02-17 17:09:17)\r\n2021-02-17 17:09:18.517650: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cudart64_101.dll\r\n > Using CUDA:  True\r\n > Number of GPUs:  1\r\n2021-02-17 17:09:21.598745: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cudart64_101.dll\r\n > Using CUDA:  True\r\n > Number of GPUs:  1\r\n2021-02-17 17:09:24.553649: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cudart64_101.dll\r\n > Using CUDA:  True\r\n > Number of GPUs:  1\r\n2021-02-17 17:09:27.454550: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library cudart64_101.dll\r\n > Using CUDA:  True\r\n > Number of GPUs:  1\r\n ! Run is removed from Models/LJSpeech/ljspeech-ddc-February-17-2021_05+09PM-e9e0784\r\nTraceback (most recent call last):\r\n  File \"TTS/bin/train_tacotron.py\", line 721, in <module>\r\n    main(args)\r\n  File \"TTS/bin/train_tacotron.py\", line 619, in main\r\n    train_avg_loss_dict, global_step = train(train_loader, model,\r\n  File \"TTS/bin/train_tacotron.py\", line 165, in train\r\n    decoder_output, postnet_output, alignments, stop_tokens, decoder_backward_output, alignments_backward = model(\r\n  File \"C:\\Users\\Voice-trainner\\anaconda3\\envs\\TF2\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 722, in _call_impl\r\n    result = self.forward(*input, **kwargs)\r\n  File \"c:\\users\\voice-trainner\\proyecto\\tts\\TTS\\tts\\models\\tacotron2.py\", line 148, in forward\r\n    encoder_outputs = self.encoder(embedded_inputs, text_lengths)\r\n  File \"C:\\Users\\Voice-trainner\\anaconda3\\envs\\TF2\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 722, in _call_impl\r\n    result = self.forward(*input, **kwargs)\r\n  File \"c:\\users\\voice-trainner\\proyecto\\tts\\TTS\\tts\\layers\\tacotron2.py\", line 109, in forward\r\n    o, _ = self.lstm(o)\r\n  File \"C:\\Users\\Voice-trainner\\anaconda3\\envs\\TF2\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 722, in _call_impl\r\n    result = self.forward(*input, **kwargs)\r\n  File \"C:\\Users\\Voice-trainner\\anaconda3\\envs\\TF2\\lib\\site-packages\\torch\\nn\\modules\\rnn.py\", line 579, in forward\r\n    result = _VF.lstm(input, batch_sizes, hx, self._flat_weights, self.bias,\r\n**RuntimeError: cuDNN error: CUDNN_STATUS_BAD_PARAM**","closed_by":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/659/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mozilla/TTS/issues/659/timeline","performed_via_github_app":null,"state_reason":"completed"}