{"url":"https://api.github.com/repos/mozilla/TTS/issues/473","repository_url":"https://api.github.com/repos/mozilla/TTS","labels_url":"https://api.github.com/repos/mozilla/TTS/issues/473/labels{/name}","comments_url":"https://api.github.com/repos/mozilla/TTS/issues/473/comments","events_url":"https://api.github.com/repos/mozilla/TTS/issues/473/events","html_url":"https://github.com/mozilla/TTS/issues/473","id":669363144,"node_id":"MDU6SXNzdWU2NjkzNjMxNDQ=","number":473,"title":"RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!","user":{"login":"ngthuong45","id":66929261,"node_id":"MDQ6VXNlcjY2OTI5MjYx","avatar_url":"https://avatars.githubusercontent.com/u/66929261?v=4","gravatar_id":"","url":"https://api.github.com/users/ngthuong45","html_url":"https://github.com/ngthuong45","followers_url":"https://api.github.com/users/ngthuong45/followers","following_url":"https://api.github.com/users/ngthuong45/following{/other_user}","gists_url":"https://api.github.com/users/ngthuong45/gists{/gist_id}","starred_url":"https://api.github.com/users/ngthuong45/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ngthuong45/subscriptions","organizations_url":"https://api.github.com/users/ngthuong45/orgs","repos_url":"https://api.github.com/users/ngthuong45/repos","events_url":"https://api.github.com/users/ngthuong45/events{/privacy}","received_events_url":"https://api.github.com/users/ngthuong45/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2020-07-31T03:04:26Z","updated_at":"2020-08-04T09:05:53Z","closed_at":"2020-08-03T10:29:11Z","author_association":"NONE","active_lock_reason":null,"body":" > Using CUDA:  True\r\n > Number of GPUs:  1\r\n > Git Hash: 599c2db\r\n > Experiment folder: /home/ngthuong/Desktop/LJSpeech/ljspeech-July-31-2020_09+38AM-599c2db\r\n > Setting up Audio Processor...\r\n | > sample_rate:22050\r\n | > num_mels:80\r\n | > min_level_db:-100\r\n | > frame_shift_ms:None\r\n | > frame_length_ms:None\r\n | > ref_level_db:20\r\n | > num_freq:513\r\n | > power:1.5\r\n | > preemphasis:0.0\r\n | > griffin_lim_iters:60\r\n | > signal_norm:True\r\n | > symmetric_norm:True\r\n | > mel_fmin:0\r\n | > mel_fmax:8000.0\r\n | > max_norm:4.0\r\n | > clip_norm:True\r\n | > do_trim_silence:True\r\n | > trim_db:60\r\n | > do_sound_norm:False\r\n | > stats_path:None\r\n | > hop_length:256\r\n | > win_length:1024\r\n | > n_fft:1024\r\n > Using model: Tacotron2\r\n | > Num output units : 513\r\n\r\n > Model has 28947858 parameters\r\n\r\n > EPOCH: 0/1000\r\n\r\n > Number of output frames: 7\r\n\r\n > DataLoader initialization\r\n | > Use phonemes: False\r\n | > Number of instances : 12969\r\n | > Max length sequence: 187\r\n | > Min length sequence: 5\r\n | > Avg length sequence: 98.3403500655409\r\n | > Num. instances discarded by max-min (max=153, min=6) seq limits: 476\r\n | > Batch group size: 0.\r\n\r\n > TRAINING (2020-07-31 09:38:21) \r\nTraceback (most recent call last):\r\n  File \"train.py\", line 676, in <module>\r\n    main(args)\r\n  File \"train.py\", line 589, in main\r\n    train_avg_loss_dict, global_step = train(model, criterion, optimizer,\r\n  File \"train.py\", line 180, in train\r\n    loss_dict = criterion(postnet_output, decoder_output, mel_input,\r\n  File \"/home/ngthuong/Desktop/my_projects/AI/TTS/venv/lib/python3.8/site-packages/torch/nn/modules/module.py\", line 722, in _call_impl\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ngthuong/Desktop/my_projects/AI/TTS/layers/losses.py\", line 231, in forward\r\n    ga_loss = self.criterion_ga(alignments, input_lens, alignment_lens)\r\n  File \"/home/ngthuong/Desktop/my_projects/AI/TTS/venv/lib/python3.8/site-packages/torch/nn/modules/module.py\", line 722, in _call_impl\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ngthuong/Desktop/my_projects/AI/TTS/layers/losses.py\", line 145, in forward\r\n    ga_masks = self._make_ga_masks(ilens, olens).to(att_ws.device)\r\n  File \"/home/ngthuong/Desktop/my_projects/AI/TTS/layers/losses.py\", line 141, in _make_ga_masks\r\n    ga_masks[idx, :olen, :ilen] = self._make_ga_mask(ilen, olen, self.sigma)\r\n  File \"/home/ngthuong/Desktop/my_projects/AI/TTS/layers/losses.py\", line 155, in _make_ga_mask\r\n    return 1.0 - torch.exp(-(grid_y / ilen - grid_x / olen) ** 2 / (2 * (sigma ** 2)))\r\nRuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!\r\n\r\nHow to fix it?","closed_by":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mozilla/TTS/issues/473/timeline","performed_via_github_app":null,"state_reason":"completed"}