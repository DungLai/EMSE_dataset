{"url":"https://api.github.com/repos/mozilla/TTS/issues/567","repository_url":"https://api.github.com/repos/mozilla/TTS","labels_url":"https://api.github.com/repos/mozilla/TTS/issues/567/labels{/name}","comments_url":"https://api.github.com/repos/mozilla/TTS/issues/567/comments","events_url":"https://api.github.com/repos/mozilla/TTS/issues/567/events","html_url":"https://github.com/mozilla/TTS/issues/567","id":740875505,"node_id":"MDU6SXNzdWU3NDA4NzU1MDU=","number":567,"title":"Encountering ' RuntimeError: 'lengths' argument should be a 1D CPU int64 tensor, but got 1D cuda:0 Long tensor' when trying to run 'train_tts.py'","user":{"login":"khalilRhouma","id":35801846,"node_id":"MDQ6VXNlcjM1ODAxODQ2","avatar_url":"https://avatars.githubusercontent.com/u/35801846?v=4","gravatar_id":"","url":"https://api.github.com/users/khalilRhouma","html_url":"https://github.com/khalilRhouma","followers_url":"https://api.github.com/users/khalilRhouma/followers","following_url":"https://api.github.com/users/khalilRhouma/following{/other_user}","gists_url":"https://api.github.com/users/khalilRhouma/gists{/gist_id}","starred_url":"https://api.github.com/users/khalilRhouma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khalilRhouma/subscriptions","organizations_url":"https://api.github.com/users/khalilRhouma/orgs","repos_url":"https://api.github.com/users/khalilRhouma/repos","events_url":"https://api.github.com/users/khalilRhouma/events{/privacy}","received_events_url":"https://api.github.com/users/khalilRhouma/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-11-11T15:55:23Z","updated_at":"2020-11-13T09:47:47Z","closed_at":"2020-11-13T09:47:47Z","author_association":"NONE","active_lock_reason":null,"body":"I have recently discovered your TTS repo. When I started a run with 'train_tts.py' using LJSpeech to explore your work I encounter this error:\r\n`2020-11-11 15:37:37.753288: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory\r\n2020-11-11 15:37:37.753334: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\r\n > Using CUDA:  True\r\n > Number of GPUs:  1\r\nfatal: not a git repository (or any of the parent directories): .git\r\n > Git Hash: 0000000\r\n > Experiment folder: output/ljspeech-ddc-November-11-2020_03+37PM-0000000\r\nfatal: not a git repository (or any of the parent directories): .git\r\n > Setting up Audio Processor...\r\n | > sample_rate:22050\r\n | > num_mels:80\r\n | > min_level_db:-100\r\n | > frame_shift_ms:None\r\n | > frame_length_ms:None\r\n | > ref_level_db:20\r\n | > fft_size:1024\r\n | > power:1.5\r\n | > preemphasis:0.0\r\n | > griffin_lim_iters:60\r\n | > signal_norm:True\r\n | > symmetric_norm:True\r\n | > mel_fmin:50.0\r\n | > mel_fmax:7600.0\r\n | > spec_gain:1.0\r\n | > stft_pad_mode:reflect\r\n | > max_norm:4.0\r\n | > clip_norm:True\r\n | > do_trim_silence:True\r\n | > trim_db:60\r\n | > do_sound_norm:False\r\n | > stats_path:LJSpeech-1.1/scale_stats.npy\r\n | > hop_length:256\r\n | > win_length:1024\r\n | > Found 12000 files in /home/khalil/Mozilla_TTS/LJSpeech-1.1\r\n > Using model: Tacotron2\r\n\r\n > Model has 47914548 parameters\r\n\r\n > EPOCH: 0/1000\r\n\r\n > Number of output frames: 7\r\n\r\n > DataLoader initialization\r\n | > Use phonemes: True\r\n   | > phoneme language: en-us\r\n | > Number of instances : 12000\r\n | > Max length sequence: 187\r\n | > Min length sequence: 5\r\n | > Avg length sequence: 98.45766666666667\r\n | > Num. instances discarded by max-min (max=153, min=6) seq limits: 438\r\n | > Batch group size: 256.\r\n\r\n > TRAINING (2020-11-11 15:37:43) \r\n ! Run is removed from output/ljspeech-ddc-November-11-2020_03+37PM-0000000\r\nTraceback (most recent call last):\r\n  File \"TTS/TTS/bin/train_tts.py\", line 715, in <module>\r\n    main(args)\r\n  File \"TTS/TTS/bin/train_tts.py\", line 627, in main\r\n    global_step, epoch, amp, speaker_mapping)\r\n  File \"TTS/TTS/bin/train_tts.py\", line 163, in train\r\n    text_input, text_lengths, mel_input, mel_lengths, speaker_ids=speaker_ids, speaker_embeddings=speaker_embeddings)\r\n  File \"/home/khalil/anaconda3/envs/mozilla_tts/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 727, in _call_impl\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/khalil/anaconda3/envs/mozilla_tts/lib/python3.7/site-packages/TTS-0.0.5+79ce06c-py3.7-linux-x86_64.egg/TTS/tts/models/tacotron2.py\", line 102, in forward\r\n    encoder_outputs = self.encoder(embedded_inputs, text_lengths)\r\n  File \"/home/khalil/anaconda3/envs/mozilla_tts/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 727, in _call_impl\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/khalil/anaconda3/envs/mozilla_tts/lib/python3.7/site-packages/TTS-0.0.5+79ce06c-py3.7-linux-x86_64.egg/TTS/tts/layers/tacotron2.py\", line 106, in forward\r\n    batch_first=True)\r\n  File \"/home/khalil/anaconda3/envs/mozilla_tts/lib/python3.7/site-packages/torch/nn/utils/rnn.py\", line 244, in pack_padded_sequence\r\n    _VF._pack_padded_sequence(input, lengths, batch_first)\r\nRuntimeError: 'lengths' argument should be a 1D CPU int64 tensor, but got 1D cuda:0 Long tensor`\r\n\r\n**Cloned the TTS repo with**: `git clone https://github.com/mozilla/TTS`\r\n**Pytorch version:** 1.7.0\r\n\r\nPS: I have created an environment and Installed all  packages requirements","closed_by":{"login":"khalilRhouma","id":35801846,"node_id":"MDQ6VXNlcjM1ODAxODQ2","avatar_url":"https://avatars.githubusercontent.com/u/35801846?v=4","gravatar_id":"","url":"https://api.github.com/users/khalilRhouma","html_url":"https://github.com/khalilRhouma","followers_url":"https://api.github.com/users/khalilRhouma/followers","following_url":"https://api.github.com/users/khalilRhouma/following{/other_user}","gists_url":"https://api.github.com/users/khalilRhouma/gists{/gist_id}","starred_url":"https://api.github.com/users/khalilRhouma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khalilRhouma/subscriptions","organizations_url":"https://api.github.com/users/khalilRhouma/orgs","repos_url":"https://api.github.com/users/khalilRhouma/repos","events_url":"https://api.github.com/users/khalilRhouma/events{/privacy}","received_events_url":"https://api.github.com/users/khalilRhouma/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mozilla/TTS/issues/567/timeline","performed_via_github_app":null,"state_reason":"completed"}