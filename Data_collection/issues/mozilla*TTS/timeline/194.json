[{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/492390273","html_url":"https://github.com/mozilla/TTS/issues/194#issuecomment-492390273","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/194","id":492390273,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjM5MDI3Mw==","user":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"created_at":"2019-05-14T20:08:35Z","updated_at":"2019-05-14T20:08:35Z","author_association":"CONTRIBUTOR","body":"It gave an almost 1sec boost for a 6 secs run. Nice trick! Do you have any reference to point about this issue?","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/492390273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/492712773","html_url":"https://github.com/mozilla/TTS/issues/194#issuecomment-492712773","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/194","id":492712773,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjcxMjc3Mw==","user":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false},"created_at":"2019-05-15T15:50:58Z","updated_at":"2019-05-15T16:15:16Z","author_association":"NONE","body":"Does it depends on hardware or sentence length?\r\n\r\nI can't see any difference on 8 core mac notebook running on CPU:\r\n```\r\nBenchmark on 824c09120b6e6bf4be99d03cc07e611ecbf140fe on dev-tacotron2:\r\n\r\npretrained_models\r\n├── ljspeech-260k\r\n│   ├── checkpoint_260000.pth.tar\r\n│   ├── config.json\r\n│   └── events.out.tfevents.1554744767.erogol-desktop\r\n└── mold_ljspeech_best_model\r\n    ├── checkpoint_393000.pth.tar\r\n    ├── checkpoint_433000.pth.tar\r\n    └── config.json\r\n    \r\nCONFIG {'github_branch': 'dev-tacotron2', 'restore_path': '/media/erogol/data_ssd/Data/models/ljspeech_models/4241_best_t2_model/best_model.pth.tar', 'run_name': 'ljspeech', 'run_description': 'finetune 4241 for align with architectural changes', 'audio': {'num_mels': 80, 'num_freq': 1025, 'sample_rate': 22050, 'frame_length_ms': 50, 'frame_shift_ms': 12.5, 'preemphasis': 0.98, 'min_level_db': -100, 'ref_level_db': 20, 'power': 1.5, 'griffin_lim_iters': 60, 'signal_norm': True, 'symmetric_norm': False, 'max_norm': 1, 'clip_norm': True, 'mel_fmin': 0.0, 'mel_fmax': 8000.0, 'do_trim_silence': True}, 'distributed': {'backend': 'nccl', 'url': 'tcp://localhost:54321'}, 'reinit_layers': [], 'model': 'Tacotron2', 'grad_clip': 1, 'epochs': 1000, 'lr': 0.0001, 'lr_decay': False, 'warmup_steps': 4000, 'windowing': True, 'memory_size': 5, 'attention_norm': 'softmax', 'prenet_type': 'bn', 'use_forward_attn': True, 'transition_agent': False, 'loss_masking': False, 'enable_eos_bos_chars': True, 'batch_size': 16, 'eval_batch_size': 16, 'r': 1, 'wd': 1e-06, 'checkpoint': True, 'save_step': 1000, 'print_step': 100, 'tb_model_param_stats': True, 'batch_group_size': 8, 'run_eval': True, 'test_delay_epochs': 2, 'data_path': '/home/erogol/Data/LJSpeech-1.1', 'meta_file_train': 'metadata_train.csv', 'meta_file_val': 'metadata_val.csv', 'dataset': 'ljspeech', 'min_seq_len': 0, 'max_seq_len': 150, 'output_path': '/media/erogol/data_ssd/Data/models/ljspeech_models/', 'num_loader_workers': 8, 'num_val_loader_workers': 4, 'phoneme_cache_path': 'ljspeech_phonemes', 'use_phonemes': True, 'phoneme_language': 'en-us', 'text_cleaner': 'phoneme_cleaners'}\r\n\r\nDefault:\r\n\tTacotron2 model load time: 0.51 sec\r\n\tTacotron2 inference time warmup: 0.91 sec\r\n\tTacotron2 inference time short sentence: 0.38 sec\r\n\tTacotron2 inference time long sentence: 2.93 sec\r\n\r\nos.environ[\"OMP_NUM_THREADS\"] = \"1\" in python script\r\n\tTacotron2 model load time: 0.51 sec\r\n\tTacotron2 inference time warmup: 0.74 sec\r\n\tTacotron2 inference time short sentence: 0.37 sec\r\n\tTacotron2 inference time long sentence: 2.91 sec\r\n\r\nRun like time OMP_NUM_THREADS=1 python demo_tts_cpu.py\r\n\tTacotron2 model load time: 0.5 sec\r\n\tTacotron2 inference time warmup: 0.69 sec\r\n\tTacotron2 inference time short sentence: 0.37 sec\r\n\tTacotron2 inference time long sentence: 2.91 sec\r\n\r\nRunining via bash script with setted env variables:\r\ncat run_tts_demo.sh\r\nexport MKL_NUM_THREADS=1\r\nexport NUMEXPR_NUM_THREADS=1\r\nexport OMP_NUM_THREADS=1\r\ntime python3 demo_tts_cpu.py\r\n\tTacotron2 model load time: 0.51 sec\r\n\tTacotron2 inference time warmup: 0.7 sec\r\n\tTacotron2 inference time short sentence: 0.37 sec\r\n\tTacotron2 inference time long sentence: 2.9 sec\r\n```\r\n\r\nMy test code:\r\n```\r\ndef load_tocotron_2_model():\r\n    from utils.text.symbols import symbols, phonemes\r\n    from models.tacotron2 import Tacotron2\r\n\r\n    n_chars = len(phonemes) if CONFIG.use_phonemes else len(symbols) # 'use_phonemes': True\r\n    print('n_chars', n_chars) #\r\n\r\n    model = Tacotron2(num_chars=n_chars, r=CONFIG.r, attn_win=CONFIG.windowing, attn_norm=CONFIG.attention_norm,\r\n                      prenet_type=CONFIG.prenet_type, forward_attn=CONFIG.use_forward_attn,\r\n                      trans_agent=CONFIG.transition_agent)\r\n\r\n    # load model state\r\n    if use_cuda:\r\n        cp = torch.load(MODEL_PATH)\r\n    else:\r\n        cp = torch.load(MODEL_PATH, map_location='cpu')\r\n\r\n    # load the model\r\n    model.load_state_dict(cp['model'])\r\n\r\n    if use_cuda:\r\n        model.cuda()\r\n\r\n    model.eval() # Set eval mode\r\n\r\n    print(\"cp['step']\", cp['step']) #\r\n\r\n    return model\r\n\r\ndef benchmark_tacotron2(model, text):\r\n    start = time.time()\r\n\r\n    waveform, alignment, mel_spec, mel_postnet_spec, stop_tokens = synthesis(model, text, CONFIG, use_cuda, ap,\r\n                                                                             truncated=False,\r\n                                                                             enable_eos_bos_chars=CONFIG.enable_eos_bos_chars,\r\n                                                                             trim_silence=False)\r\n    t = round(time.time()-start, 2)\r\n\r\n    return t\r\n\r\nif __name__ == '__main__':\r\n    start = time.time()\r\n    tacotron_model = load_tocotron_2_model()\r\n    print('Tacotron2 model load time:', round(time.time()-start,2), 'sec')\r\n\r\n    # Warmup\r\n    t = benchmark_tacotron2(tacotron_model, \"Warmup!\")\r\n    print('Tacotron2 inference time warmup:', t, 'sec')\r\n\r\n    # Short sentence\r\n    t = benchmark_tacotron2(tacotron_model, \"Hello!\")\r\n    print('Tacotron2 inference time short sentence:', t, 'sec')\r\n\r\n    # Long sentence\r\n    t = benchmark_tacotron2(tacotron_model, \"Quick brown fox jumps over the lazy dog.\")\r\n    print('Tacotron2 inference time long sentence:', t, 'sec')\r\n```\r\nAlso as I can see here GL is done on CPU:\r\nhttps://github.com/mozilla/TTS/blob/618b2808127f6fd00fe643fe6e852ddf1d2986e1/utils/audio.py#L155\r\n\r\nAlso I wonder is this (https://github.com/mozilla/TTS/tree/dev-tacotron2#runtime) reported time for GL on GPU only or for Tacotron2 on GPU + GL on GPU, also is it's only inference time without model loading time? an for which sentence?\r\n\r\nAlso I wonder maybe something can be tuned in tacotron2 parameters for faster inference for short sentences?\r\n","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/492712773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/492721752","html_url":"https://github.com/mozilla/TTS/issues/194#issuecomment-492721752","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/194","id":492721752,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjcyMTc1Mg==","user":{"login":"geneing","id":10255558,"node_id":"MDQ6VXNlcjEwMjU1NTU4","avatar_url":"https://avatars.githubusercontent.com/u/10255558?v=4","gravatar_id":"","url":"https://api.github.com/users/geneing","html_url":"https://github.com/geneing","followers_url":"https://api.github.com/users/geneing/followers","following_url":"https://api.github.com/users/geneing/following{/other_user}","gists_url":"https://api.github.com/users/geneing/gists{/gist_id}","starred_url":"https://api.github.com/users/geneing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/geneing/subscriptions","organizations_url":"https://api.github.com/users/geneing/orgs","repos_url":"https://api.github.com/users/geneing/repos","events_url":"https://api.github.com/users/geneing/events{/privacy}","received_events_url":"https://api.github.com/users/geneing/received_events","type":"User","site_admin":false},"created_at":"2019-05-15T16:14:20Z","updated_at":"2019-05-15T16:14:20Z","author_association":"CONTRIBUTOR","body":"@erogol I don't have a reference. I was trying to understand why inference on my computer was much slower than expected. While profiling I noticed many openmp library hits. I tried using openmp in other projects and performance was always abysmal - too much threading overhead. Lowering openmp thread count improved the perfomance.  \r\n\r\n@mrgloom Are pytorch and blas libraries built with OpenMP support on the Mac? I see an open feature request to add openmp support: https://github.com/pytorch/pytorch/issues/6328. You could check by looking at cpu utilization during inference. If it looks like only one core is used, then probably openmp is not used in your setup. ","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/492721752/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"geneing","id":10255558,"node_id":"MDQ6VXNlcjEwMjU1NTU4","avatar_url":"https://avatars.githubusercontent.com/u/10255558?v=4","gravatar_id":"","url":"https://api.github.com/users/geneing","html_url":"https://github.com/geneing","followers_url":"https://api.github.com/users/geneing/followers","following_url":"https://api.github.com/users/geneing/following{/other_user}","gists_url":"https://api.github.com/users/geneing/gists{/gist_id}","starred_url":"https://api.github.com/users/geneing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/geneing/subscriptions","organizations_url":"https://api.github.com/users/geneing/orgs","repos_url":"https://api.github.com/users/geneing/repos","events_url":"https://api.github.com/users/geneing/events{/privacy}","received_events_url":"https://api.github.com/users/geneing/received_events","type":"User","site_admin":false}},{"id":2343857561,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjM0Mzg1NzU2MQ==","url":"https://api.github.com/repos/mozilla/TTS/issues/events/2343857561","actor":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-15T16:14:20Z","performed_via_github_app":null},{"id":2343857562,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzNDM4NTc1NjI=","url":"https://api.github.com/repos/mozilla/TTS/issues/events/2343857562","actor":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-15T16:14:20Z","performed_via_github_app":null},{"id":2343857564,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjM0Mzg1NzU2NA==","url":"https://api.github.com/repos/mozilla/TTS/issues/events/2343857564","actor":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-15T16:14:21Z","performed_via_github_app":null},{"id":2343857565,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzNDM4NTc1NjU=","url":"https://api.github.com/repos/mozilla/TTS/issues/events/2343857565","actor":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-15T16:14:21Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/492725896","html_url":"https://github.com/mozilla/TTS/issues/194#issuecomment-492725896","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/194","id":492725896,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjcyNTg5Ng==","user":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"created_at":"2019-05-15T16:25:45Z","updated_at":"2019-05-15T16:25:45Z","author_association":"CONTRIBUTOR","body":"I can verify that it improves the performance slightly on Linux.","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/492725896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/492740432","html_url":"https://github.com/mozilla/TTS/issues/194#issuecomment-492740432","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/194","id":492740432,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Mjc0MDQzMg==","user":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false},"created_at":"2019-05-15T17:07:25Z","updated_at":"2019-05-15T17:07:25Z","author_association":"NONE","body":"On Linux 12-core machine with installed cpu only version of pytorch under virtualenv:\r\n\r\nStill can't see any speedup, actually it runs even slower.\r\nIn default setting I see in htop that more than 1 core is busy.\r\nAlso as I can see `ap.inv_mel_spectrogram` take more than half of time.\r\n\r\n```\r\npython3 -m venv my_env_cpu\r\nsource my_env_cpu/bin/activate\r\npip3 install https://download.pytorch.org/whl/cpu/torch-1.1.0-cp35-cp35m-linux_x86_64.whl\r\npip3 install torchvision\r\npython -c \"import torch; print(torch.__version__)\"\r\n1.1.0\r\n\r\nDefault:\r\n\tTacotron2 model load time: 0.33 sec\r\n\tap.inv_mel_spectrogram time: 0.49 sec\r\n\tTacotron2 inference time warmup: 0.72 sec\r\n\tap.inv_mel_spectrogram time: 0.2 sec\r\n\tTacotron2 inference time short sentence: 0.37 sec\r\n\tap.inv_mel_spectrogram time: 1.9 sec\r\n\tTacotron2 inference time long sentence: 3.15 sec\r\n\r\nSet os.environ[\"OMP_NUM_THREADS\"] = \"1\" in python script\r\n\tTacotron2 model load time: 0.34 sec\r\n\tap.inv_mel_spectrogram time: 0.47 sec\r\n\tTacotron2 inference time warmup: 0.74 sec\r\n\tap.inv_mel_spectrogram time: 0.19 sec\r\n\tTacotron2 inference time short sentence: 0.4 sec\r\n\tap.inv_mel_spectrogram time: 1.88 sec\r\n\tTacotron2 inference time long sentence: 3.52 sec\r\n\r\nRun like time OMP_NUM_THREADS=1 python demo_tts_cpu.py\r\n\tTacotron2 model load time: 0.35 sec\r\n\tap.inv_mel_spectrogram time: 0.46 sec\r\n\tTacotron2 inference time warmup: 0.74 sec\r\n\tap.inv_mel_spectrogram time: 0.18 sec\r\n\tTacotron2 inference time short sentence: 0.38 sec\r\n\tap.inv_mel_spectrogram time: 1.87 sec\r\n\tTacotron2 inference time long sentence: 3.49 sec\r\n\r\nRunining via bash script with setted env variables:\r\ncat run_tts_demo.sh\r\nexport MKL_NUM_THREADS=1\r\nexport NUMEXPR_NUM_THREADS=1\r\nexport OMP_NUM_THREADS=1\r\ntime python3 demo_tts_cpu.py\r\n\tTacotron2 model load time: 0.35 sec\r\n\tap.inv_mel_spectrogram time: 0.54 sec\r\n\tTacotron2 inference time warmup: 0.83 sec\r\n\tap.inv_mel_spectrogram time: 0.18 sec\r\n\tTacotron2 inference time short sentence: 0.41 sec\r\n\tap.inv_mel_spectrogram time: 1.87 sec\r\n\tTacotron2 inference time long sentence: 3.51 sec\r\n```","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/492740432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/492840580","html_url":"https://github.com/mozilla/TTS/issues/194#issuecomment-492840580","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/194","id":492840580,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Mjg0MDU4MA==","user":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false},"created_at":"2019-05-15T22:04:03Z","updated_at":"2019-05-15T22:04:28Z","author_association":"NONE","body":"Also I have checked CPU vs GPU speed:\r\n\r\nModel load+init and warmup model run is faster on CPU, but for longer sentence inference is faster on GPU.\r\nBut not sure why `ap.inv_mel_spectrogram` time is also increased.\r\n\r\n```\r\nCPU:\r\nTacotron2 model load time: 0.34 sec\r\nap.inv_mel_spectrogram time: 0.5 sec\r\nTacotron2 inference time warmup: 0.73 sec\r\nap.inv_mel_spectrogram time: 0.2 sec\r\nTacotron2 inference time short sentence: 0.38 sec\r\nap.inv_mel_spectrogram time: 1.91 sec\r\nTacotron2 inference time long sentence: 3.17 sec\r\n\r\nGPU:\r\nTacotron2 model load time: 3.89 sec\r\nap.inv_mel_spectrogram time: 0.87 sec\r\nTacotron2 inference time warmup: 1.45 sec\r\nap.inv_mel_spectrogram time: 0.41 sec\r\nTacotron2 inference time short sentence: 0.83 sec\r\nap.inv_mel_spectrogram time: 1.97 sec\r\nTacotron2 inference time long sentence: 2.88 sec\r\n```","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/492840580/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/493106326","html_url":"https://github.com/mozilla/TTS/issues/194#issuecomment-493106326","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/194","id":493106326,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzEwNjMyNg==","user":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false},"created_at":"2019-05-16T15:05:13Z","updated_at":"2019-05-16T15:05:13Z","author_association":"NONE","body":"Also I have tried to add `with torch.no_grad():` https://discuss.pytorch.org/t/model-eval-vs-with-torch-no-grad/19615/2\r\nHere:\r\nhttps://github.com/mozilla/TTS/blob/dev-tacotron2/models/tacotron2.py#L42\r\nand here:\r\nhttps://github.com/mozilla/TTS/blob/dev-tacotron2/models/tacotron2.py#L54\r\n\r\nSeems times don't changed much:\r\n```\r\nCPU:\r\nTacotron2 model load time: 0.34 sec\r\nap.inv_mel_spectrogram time: 0.5 sec\r\nTacotron2 inference time warmup: 0.74 sec\r\nap.inv_mel_spectrogram time: 0.2 sec\r\nTacotron2 inference time short sentence: 0.37 sec\r\nap.inv_mel_spectrogram time: 1.93 sec\r\nTacotron2 inference time long sentence: 3.13 sec\r\n\r\nGPU:\r\nTacotron2 model load time: 4.29 sec\r\nap.inv_mel_spectrogram time: 0.85 sec\r\nTacotron2 inference time warmup: 1.38 sec\r\nap.inv_mel_spectrogram time: 0.43 sec\r\nTacotron2 inference time short sentence: 0.95 sec\r\nap.inv_mel_spectrogram time: 2.02 sec\r\nTacotron2 inference time long sentence: 2.91 sec\r\n```","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/493106326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/494746646","html_url":"https://github.com/mozilla/TTS/issues/194#issuecomment-494746646","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/194","id":494746646,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDc0NjY0Ng==","user":{"login":"zhang-yunke","id":39864480,"node_id":"MDQ6VXNlcjM5ODY0NDgw","avatar_url":"https://avatars.githubusercontent.com/u/39864480?v=4","gravatar_id":"","url":"https://api.github.com/users/zhang-yunke","html_url":"https://github.com/zhang-yunke","followers_url":"https://api.github.com/users/zhang-yunke/followers","following_url":"https://api.github.com/users/zhang-yunke/following{/other_user}","gists_url":"https://api.github.com/users/zhang-yunke/gists{/gist_id}","starred_url":"https://api.github.com/users/zhang-yunke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhang-yunke/subscriptions","organizations_url":"https://api.github.com/users/zhang-yunke/orgs","repos_url":"https://api.github.com/users/zhang-yunke/repos","events_url":"https://api.github.com/users/zhang-yunke/events{/privacy}","received_events_url":"https://api.github.com/users/zhang-yunke/received_events","type":"User","site_admin":false},"created_at":"2019-05-22T10:29:48Z","updated_at":"2019-05-22T10:29:48Z","author_association":"NONE","body":"@mrgloom Hi there, I am a little bit confused about your speed test. As in your result, after loading and warmup, tacotron2 inference spend half time on CPU than GPU for short sentence. Can you please post your test sample and your device parameter? I am facing inference on CPU problem too.","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/494746646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zhang-yunke","id":39864480,"node_id":"MDQ6VXNlcjM5ODY0NDgw","avatar_url":"https://avatars.githubusercontent.com/u/39864480?v=4","gravatar_id":"","url":"https://api.github.com/users/zhang-yunke","html_url":"https://github.com/zhang-yunke","followers_url":"https://api.github.com/users/zhang-yunke/followers","following_url":"https://api.github.com/users/zhang-yunke/following{/other_user}","gists_url":"https://api.github.com/users/zhang-yunke/gists{/gist_id}","starred_url":"https://api.github.com/users/zhang-yunke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhang-yunke/subscriptions","organizations_url":"https://api.github.com/users/zhang-yunke/orgs","repos_url":"https://api.github.com/users/zhang-yunke/repos","events_url":"https://api.github.com/users/zhang-yunke/events{/privacy}","received_events_url":"https://api.github.com/users/zhang-yunke/received_events","type":"User","site_admin":false}},{"id":2358841157,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjM1ODg0MTE1Nw==","url":"https://api.github.com/repos/mozilla/TTS/issues/events/2358841157","actor":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-22T10:29:48Z","performed_via_github_app":null},{"id":2358841158,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzNTg4NDExNTg=","url":"https://api.github.com/repos/mozilla/TTS/issues/events/2358841158","actor":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-22T10:29:48Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/494759123","html_url":"https://github.com/mozilla/TTS/issues/194#issuecomment-494759123","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/194","id":494759123,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDc1OTEyMw==","user":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false},"created_at":"2019-05-22T11:13:44Z","updated_at":"2019-05-22T11:13:44Z","author_association":"NONE","body":"```\r\nCPU: Intel(R) Core(TM) i7-5820K CPU @ 3.30GHz\r\nGPU: NVIDIA Corporation GM200 [GeForce GTX TITAN X] (rev a1)\r\n```\r\n\r\n```\r\n\"Hello!\" - short sentence\r\n\"Quick brown fox jumps over the lazy dog.\" - long sentence\r\n```","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/494759123/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/494764640","html_url":"https://github.com/mozilla/TTS/issues/194#issuecomment-494764640","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/194","id":494764640,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDc2NDY0MA==","user":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false},"created_at":"2019-05-22T11:33:26Z","updated_at":"2019-05-22T13:16:56Z","author_association":"NONE","body":"Actually I have 2 GPU in my system:\r\n\r\n```\r\nNVIDIA Corporation GM200 [GeForce GTX TITAN X] (rev a1)\r\nNVIDIA Corporation Device 1b06 (rev a1) (it's actually GeForce GTX 1080 Ti)\r\n```\r\n\r\nGeForce GTX TITAN X is older generation and I don't know why it's faster.\r\nIt can be faster on GPU (than on CPU) for long sentences, maybe it's because of RNN layers.\r\n\r\nWith removed GL part, only tacotron2 inference:\r\n\r\n```\r\nCPU:\r\n\tTacotron2 model load time: 0.36 sec\r\n\tTacotron2 inference time warmup: 0.34 sec\r\n\tTacotron2 inference time short sentence: 0.18 sec\r\n\tTacotron2 inference time long sentence: 1.19 sec\r\n\r\nGPU:\r\n\tTacotron2 model load time: 4.02 sec\r\n\tTacotron2 inference time warmup: 0.64 sec\r\n\tTacotron2 inference time short sentence: 0.58 sec\r\n\tTacotron2 inference time long sentence: 1.1 sec\r\n\r\nGPU:\r\n\tSetting device explicitly: torch.cuda.set_device(0)\r\n\tTacotron2 model load time: 2.75 sec\r\n\tTacotron2 inference time warmup: 0.59 sec\r\n\tTacotron2 inference time short sentence: 0.56 sec\r\n\tTacotron2 inference time long sentence: 1.03 sec\r\n\r\nGPU: \r\n\tSetting device explicitly: torch.cuda.set_device(1)\r\n\tTacotron2 model load time: 4.91 sec\r\n\tTacotron2 inference time warmup: 1.04 sec\r\n\tTacotron2 inference time short sentence: 1.01 sec\r\n\tTacotron2 inference time long sentence: 1.44 sec\r\n```\r\n\r\n**Update:**\r\nActually\r\n```\r\n>>> torch.cuda.get_device_name(0)\r\n'GeForce GTX 1080 Ti'\r\n>>> torch.cuda.get_device_name(1)\r\n'GeForce GTX TITAN X'\r\n```\r\n`GeForce GTX 1080 Ti` is faster then `GeForce GTX TITAN X` and it's make sense.","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/494764640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false}},{"id":2369866111,"node_id":"MDExOkNsb3NlZEV2ZW50MjM2OTg2NjExMQ==","url":"https://api.github.com/repos/mozilla/TTS/issues/events/2369866111","actor":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-05-27T16:46:02Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/496500869","html_url":"https://github.com/mozilla/TTS/issues/194#issuecomment-496500869","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/194","id":496500869,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjUwMDg2OQ==","user":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false},"created_at":"2019-05-28T12:44:52Z","updated_at":"2019-05-28T12:44:52Z","author_association":"NONE","body":"Effect of using `torch.backends.cudnn.benchmark`, looks like there is not much difference, but seems better to disable it.\r\n\r\n```\r\ntorch.backends.cudnn.benchmark = False\r\ntorch.cuda.set_device(0)\r\n\t------------------------------------------------------------\r\n\tTacotron2 model load time: 2.69 sec\r\n\t------------------------------------------------------------\r\n\tDEBUG: iters_count: 36\r\n\tTacotron2 inference time warmup: 0.47 sec\r\n\tDEBUG: iters_count: 20\r\n\tTacotron2 inference time short sentence: 0.48 sec\r\n\tDEBUG: iters_count: 223\r\n\tTacotron2 inference time long sentence: 0.95 sec\r\n\r\n\t------------------------------------------------------------\r\n\tTacotron2 model load time: 2.8 sec\r\n\t------------------------------------------------------------\r\n\tDEBUG: iters_count: 36\r\n\tTacotron2 inference time warmup: 0.42 sec\r\n\tDEBUG: iters_count: 20\r\n\tTacotron2 inference time short sentence: 0.43 sec\r\n\tDEBUG: iters_count: 223\r\n\tTacotron2 inference time long sentence: 0.75 sec\r\n\r\n\t------------------------------------------------------------\r\n\tTacotron2 model load time: 2.7 sec\r\n\t------------------------------------------------------------\r\n\tDEBUG: iters_count: 36\r\n\tTacotron2 inference time warmup: 0.35 sec\r\n\tDEBUG: iters_count: 20\r\n\tTacotron2 inference time short sentence: 0.4 sec\r\n\tDEBUG: iters_count: 223\r\n\tTacotron2 inference time long sentence: 0.75 sec\r\n\r\ntorch.backends.cudnn.benchmark = False\r\ntorch.cuda.set_device(1)\r\n\t------------------------------------------------------------\r\n\tTacotron2 model load time: 19.48 sec\r\n\t------------------------------------------------------------\r\n\tDEBUG: iters_count: 36\r\n\tTacotron2 inference time warmup: 1.03 sec\r\n\tDEBUG: iters_count: 20\r\n\tTacotron2 inference time short sentence: 0.68 sec\r\n\tDEBUG: iters_count: 223\r\n\tTacotron2 inference time long sentence: 1.14 sec\r\n\r\n\t------------------------------------------------------------\r\n\tTacotron2 model load time: 5.0 sec\r\n\t------------------------------------------------------------\r\n\tDEBUG: iters_count: 36\r\n\tTacotron2 inference time warmup: 0.68 sec\r\n\tDEBUG: iters_count: 20\r\n\tTacotron2 inference time short sentence: 0.61 sec\r\n\tDEBUG: iters_count: 223\r\n\tTacotron2 inference time long sentence: 1.1 sec\r\n\r\n\t------------------------------------------------------------\r\n\tTacotron2 model load time: 5.06 sec\r\n\t------------------------------------------------------------\r\n\tDEBUG: iters_count: 36\r\n\tTacotron2 inference time warmup: 0.5 sec\r\n\tDEBUG: iters_count: 20\r\n\tTacotron2 inference time short sentence: 0.44 sec\r\n\tDEBUG: iters_count: 223\r\n\tTacotron2 inference time long sentence: 1.01 sec\r\n\r\n\r\ntorch.backends.cudnn.benchmark = True\r\ntorch.cuda.set_device(0)\r\n\t------------------------------------------------------------\r\n\tTacotron2 model load time: 2.7 sec\r\n\t------------------------------------------------------------\r\n\tDEBUG: iters_count: 36\r\n\tTacotron2 inference time warmup: 0.76 sec\r\n\tDEBUG: iters_count: 20\r\n\tTacotron2 inference time short sentence: 0.43 sec\r\n\tDEBUG: iters_count: 223\r\n\tTacotron2 inference time long sentence: 0.93 sec\r\n\r\n\t------------------------------------------------------------\r\n\tTacotron2 model load time: 2.87 sec\r\n\t------------------------------------------------------------\r\n\tDEBUG: iters_count: 36\r\n\tTacotron2 inference time warmup: 0.75 sec\r\n\tDEBUG: iters_count: 20\r\n\tTacotron2 inference time short sentence: 0.47 sec\r\n\tDEBUG: iters_count: 223\r\n\tTacotron2 inference time long sentence: 1.02 sec\r\n\r\n\t------------------------------------------------------------\r\n\tTacotron2 model load time: 2.92 sec\r\n\t------------------------------------------------------------\r\n\tDEBUG: iters_count: 36\r\n\tTacotron2 inference time warmup: 0.76 sec\r\n\tDEBUG: iters_count: 20\r\n\tTacotron2 inference time short sentence: 0.53 sec\r\n\tDEBUG: iters_count: 223\r\n\tTacotron2 inference time long sentence: 1.03 sec\r\n\r\n\r\ntorch.backends.cudnn.benchmark = True\r\ntorch.cuda.set_device(1)\r\n\t------------------------------------------------------------\r\n\tTacotron2 model load time: 4.85 sec\r\n\t------------------------------------------------------------\r\n\tDEBUG: iters_count: 36\r\n\tTacotron2 inference time warmup: 0.83 sec\r\n\tDEBUG: iters_count: 20\r\n\tTacotron2 inference time short sentence: 0.77 sec\r\n\tDEBUG: iters_count: 223\r\n\tTacotron2 inference time long sentence: 1.69 sec\r\n\r\n\t------------------------------------------------------------\r\n\tTacotron2 model load time: 5.23 sec\r\n\t------------------------------------------------------------\r\n\tDEBUG: iters_count: 36\r\n\tTacotron2 inference time warmup: 1.54 sec\r\n\tDEBUG: iters_count: 20\r\n\tTacotron2 inference time short sentence: 0.71 sec\r\n\tDEBUG: iters_count: 223\r\n\tTacotron2 inference time long sentence: 1.42 sec\r\n\r\n\t------------------------------------------------------------\r\n\tTacotron2 model load time: 4.91 sec\r\n\t------------------------------------------------------------\r\n\tDEBUG: iters_count: 36\r\n\tTacotron2 inference time warmup: 0.94 sec\r\n\tDEBUG: iters_count: 20\r\n\tTacotron2 inference time short sentence: 0.73 sec\r\n\tDEBUG: iters_count: 223\r\n\tTacotron2 inference time long sentence: 1.57 sec\r\n```","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/496500869/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mrgloom","id":4003908,"node_id":"MDQ6VXNlcjQwMDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4003908?v=4","gravatar_id":"","url":"https://api.github.com/users/mrgloom","html_url":"https://github.com/mrgloom","followers_url":"https://api.github.com/users/mrgloom/followers","following_url":"https://api.github.com/users/mrgloom/following{/other_user}","gists_url":"https://api.github.com/users/mrgloom/gists{/gist_id}","starred_url":"https://api.github.com/users/mrgloom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrgloom/subscriptions","organizations_url":"https://api.github.com/users/mrgloom/orgs","repos_url":"https://api.github.com/users/mrgloom/repos","events_url":"https://api.github.com/users/mrgloom/events{/privacy}","received_events_url":"https://api.github.com/users/mrgloom/received_events","type":"User","site_admin":false}}]