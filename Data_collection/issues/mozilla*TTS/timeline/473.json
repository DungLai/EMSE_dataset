[{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/667007560","html_url":"https://github.com/mozilla/TTS/issues/473#issuecomment-667007560","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/473","id":667007560,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NzAwNzU2MA==","user":{"login":"lexkoro","id":6319070,"node_id":"MDQ6VXNlcjYzMTkwNzA=","avatar_url":"https://avatars.githubusercontent.com/u/6319070?v=4","gravatar_id":"","url":"https://api.github.com/users/lexkoro","html_url":"https://github.com/lexkoro","followers_url":"https://api.github.com/users/lexkoro/followers","following_url":"https://api.github.com/users/lexkoro/following{/other_user}","gists_url":"https://api.github.com/users/lexkoro/gists{/gist_id}","starred_url":"https://api.github.com/users/lexkoro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lexkoro/subscriptions","organizations_url":"https://api.github.com/users/lexkoro/orgs","repos_url":"https://api.github.com/users/lexkoro/repos","events_url":"https://api.github.com/users/lexkoro/events{/privacy}","received_events_url":"https://api.github.com/users/lexkoro/received_events","type":"User","site_admin":false},"created_at":"2020-07-31T08:39:57Z","updated_at":"2020-07-31T08:40:18Z","author_association":"CONTRIBUTOR","body":"I checked the error message and it seems like [torch.arange](https://pytorch.org/docs/master/generated/torch.arange.html) returns the tensors mapped to cpu even though the input was passed as gpu?\r\nhttps://github.com/mozilla/TTS/blob/599c2dbcff757582092975369705e71da42ae3a0/layers/losses.py#L153 \r\n\r\n\r\nYou could go ahead an try to make the following changes to the line\r\n`grid_x, grid_y = torch.meshgrid(torch.arange(olen, device=olen.device), torch.arange(ilen, device=ilen.device))`\r\nThis should map the tensor to the currently used device.","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/667007560/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lexkoro","id":6319070,"node_id":"MDQ6VXNlcjYzMTkwNzA=","avatar_url":"https://avatars.githubusercontent.com/u/6319070?v=4","gravatar_id":"","url":"https://api.github.com/users/lexkoro","html_url":"https://github.com/lexkoro","followers_url":"https://api.github.com/users/lexkoro/followers","following_url":"https://api.github.com/users/lexkoro/following{/other_user}","gists_url":"https://api.github.com/users/lexkoro/gists{/gist_id}","starred_url":"https://api.github.com/users/lexkoro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lexkoro/subscriptions","organizations_url":"https://api.github.com/users/lexkoro/orgs","repos_url":"https://api.github.com/users/lexkoro/repos","events_url":"https://api.github.com/users/lexkoro/events{/privacy}","received_events_url":"https://api.github.com/users/lexkoro/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/667023524","html_url":"https://github.com/mozilla/TTS/issues/473#issuecomment-667023524","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/473","id":667023524,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NzAyMzUyNA==","user":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"created_at":"2020-07-31T09:16:11Z","updated_at":"2020-07-31T09:16:11Z","author_association":"CONTRIBUTOR","body":"You need to give system defition always as you create an issue. For example pytorch version?","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/667023524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/667610319","html_url":"https://github.com/mozilla/TTS/issues/473#issuecomment-667610319","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/473","id":667610319,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NzYxMDMxOQ==","user":{"login":"jyegerlehner","id":2138320,"node_id":"MDQ6VXNlcjIxMzgzMjA=","avatar_url":"https://avatars.githubusercontent.com/u/2138320?v=4","gravatar_id":"","url":"https://api.github.com/users/jyegerlehner","html_url":"https://github.com/jyegerlehner","followers_url":"https://api.github.com/users/jyegerlehner/followers","following_url":"https://api.github.com/users/jyegerlehner/following{/other_user}","gists_url":"https://api.github.com/users/jyegerlehner/gists{/gist_id}","starred_url":"https://api.github.com/users/jyegerlehner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jyegerlehner/subscriptions","organizations_url":"https://api.github.com/users/jyegerlehner/orgs","repos_url":"https://api.github.com/users/jyegerlehner/repos","events_url":"https://api.github.com/users/jyegerlehner/events{/privacy}","received_events_url":"https://api.github.com/users/jyegerlehner/received_events","type":"User","site_admin":false},"created_at":"2020-08-02T01:33:56Z","updated_at":"2020-08-02T01:33:56Z","author_association":"CONTRIBUTOR","body":"I just setup TTS for the first time in a new virtual environment and also saw this error with the same stack trace.\r\n\r\n```\r\nubuntu 18.04\r\nconda 4.8.3\r\npytorch 1.6.0\r\ncudatoolkit 10.1.243\r\n```\r\nI tried  @SanjaESC suggestion and it resolved the problem. I'll submit it as a PR.\r\n","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/667610319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jyegerlehner","id":2138320,"node_id":"MDQ6VXNlcjIxMzgzMjA=","avatar_url":"https://avatars.githubusercontent.com/u/2138320?v=4","gravatar_id":"","url":"https://api.github.com/users/jyegerlehner","html_url":"https://github.com/jyegerlehner","followers_url":"https://api.github.com/users/jyegerlehner/followers","following_url":"https://api.github.com/users/jyegerlehner/following{/other_user}","gists_url":"https://api.github.com/users/jyegerlehner/gists{/gist_id}","starred_url":"https://api.github.com/users/jyegerlehner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jyegerlehner/subscriptions","organizations_url":"https://api.github.com/users/jyegerlehner/orgs","repos_url":"https://api.github.com/users/jyegerlehner/repos","events_url":"https://api.github.com/users/jyegerlehner/events{/privacy}","received_events_url":"https://api.github.com/users/jyegerlehner/received_events","type":"User","site_admin":false}},{"id":3612782245,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzYxMjc4MjI0NQ==","url":"https://api.github.com/repos/mozilla/TTS/issues/events/3612782245","actor":{"login":"lexkoro","id":6319070,"node_id":"MDQ6VXNlcjYzMTkwNzA=","avatar_url":"https://avatars.githubusercontent.com/u/6319070?v=4","gravatar_id":"","url":"https://api.github.com/users/lexkoro","html_url":"https://github.com/lexkoro","followers_url":"https://api.github.com/users/lexkoro/followers","following_url":"https://api.github.com/users/lexkoro/following{/other_user}","gists_url":"https://api.github.com/users/lexkoro/gists{/gist_id}","starred_url":"https://api.github.com/users/lexkoro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lexkoro/subscriptions","organizations_url":"https://api.github.com/users/lexkoro/orgs","repos_url":"https://api.github.com/users/lexkoro/repos","events_url":"https://api.github.com/users/lexkoro/events{/privacy}","received_events_url":"https://api.github.com/users/lexkoro/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-08-02T01:33:57Z","performed_via_github_app":null},{"id":3612782246,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM2MTI3ODIyNDY=","url":"https://api.github.com/repos/mozilla/TTS/issues/events/3612782246","actor":{"login":"lexkoro","id":6319070,"node_id":"MDQ6VXNlcjYzMTkwNzA=","avatar_url":"https://avatars.githubusercontent.com/u/6319070?v=4","gravatar_id":"","url":"https://api.github.com/users/lexkoro","html_url":"https://github.com/lexkoro","followers_url":"https://api.github.com/users/lexkoro/followers","following_url":"https://api.github.com/users/lexkoro/following{/other_user}","gists_url":"https://api.github.com/users/lexkoro/gists{/gist_id}","starred_url":"https://api.github.com/users/lexkoro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lexkoro/subscriptions","organizations_url":"https://api.github.com/users/lexkoro/orgs","repos_url":"https://api.github.com/users/lexkoro/repos","events_url":"https://api.github.com/users/lexkoro/events{/privacy}","received_events_url":"https://api.github.com/users/lexkoro/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-08-02T01:33:57Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/667623598","html_url":"https://github.com/mozilla/TTS/issues/473#issuecomment-667623598","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/473","id":667623598,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NzYyMzU5OA==","user":{"login":"jyegerlehner","id":2138320,"node_id":"MDQ6VXNlcjIxMzgzMjA=","avatar_url":"https://avatars.githubusercontent.com/u/2138320?v=4","gravatar_id":"","url":"https://api.github.com/users/jyegerlehner","html_url":"https://github.com/jyegerlehner","followers_url":"https://api.github.com/users/jyegerlehner/followers","following_url":"https://api.github.com/users/jyegerlehner/following{/other_user}","gists_url":"https://api.github.com/users/jyegerlehner/gists{/gist_id}","starred_url":"https://api.github.com/users/jyegerlehner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jyegerlehner/subscriptions","organizations_url":"https://api.github.com/users/jyegerlehner/orgs","repos_url":"https://api.github.com/users/jyegerlehner/repos","events_url":"https://api.github.com/users/jyegerlehner/events{/privacy}","received_events_url":"https://api.github.com/users/jyegerlehner/received_events","type":"User","site_admin":false},"created_at":"2020-08-02T04:03:27Z","updated_at":"2020-08-03T01:39:53Z","author_association":"CONTRIBUTOR","body":"I expect this is an issue that may be fixed in both master and dev, though I'm not entirely clear on the relationship between those two branches. Maybe master is more like a stable release and dev is where the all the bleeding edge changes go? I'll open PRs for both in case that helpful.","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/667623598/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jyegerlehner","id":2138320,"node_id":"MDQ6VXNlcjIxMzgzMjA=","avatar_url":"https://avatars.githubusercontent.com/u/2138320?v=4","gravatar_id":"","url":"https://api.github.com/users/jyegerlehner","html_url":"https://github.com/jyegerlehner","followers_url":"https://api.github.com/users/jyegerlehner/followers","following_url":"https://api.github.com/users/jyegerlehner/following{/other_user}","gists_url":"https://api.github.com/users/jyegerlehner/gists{/gist_id}","starred_url":"https://api.github.com/users/jyegerlehner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jyegerlehner/subscriptions","organizations_url":"https://api.github.com/users/jyegerlehner/orgs","repos_url":"https://api.github.com/users/jyegerlehner/repos","events_url":"https://api.github.com/users/jyegerlehner/events{/privacy}","received_events_url":"https://api.github.com/users/jyegerlehner/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/667922624","html_url":"https://github.com/mozilla/TTS/issues/473#issuecomment-667922624","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/473","id":667922624,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NzkyMjYyNA==","user":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"created_at":"2020-08-03T09:42:47Z","updated_at":"2020-08-03T09:42:47Z","author_association":"CONTRIBUTOR","body":"Please send a PR to the dev branch.","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/667922624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/667945542","html_url":"https://github.com/mozilla/TTS/issues/473#issuecomment-667945542","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/473","id":667945542,"node_id":"MDEyOklzc3VlQ29tbWVudDY2Nzk0NTU0Mg==","user":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"created_at":"2020-08-03T10:29:11Z","updated_at":"2020-08-03T10:29:11Z","author_association":"CONTRIBUTOR","body":"this should be fixed with #476 ","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/667945542/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false}},{"id":3615316983,"node_id":"MDExOkNsb3NlZEV2ZW50MzYxNTMxNjk4Mw==","url":"https://api.github.com/repos/mozilla/TTS/issues/events/3615316983","actor":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-08-03T10:29:11Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/668083232","html_url":"https://github.com/mozilla/TTS/issues/473#issuecomment-668083232","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/473","id":668083232,"node_id":"MDEyOklzc3VlQ29tbWVudDY2ODA4MzIzMg==","user":{"login":"WeberJulian","id":17219561,"node_id":"MDQ6VXNlcjE3MjE5NTYx","avatar_url":"https://avatars.githubusercontent.com/u/17219561?v=4","gravatar_id":"","url":"https://api.github.com/users/WeberJulian","html_url":"https://github.com/WeberJulian","followers_url":"https://api.github.com/users/WeberJulian/followers","following_url":"https://api.github.com/users/WeberJulian/following{/other_user}","gists_url":"https://api.github.com/users/WeberJulian/gists{/gist_id}","starred_url":"https://api.github.com/users/WeberJulian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeberJulian/subscriptions","organizations_url":"https://api.github.com/users/WeberJulian/orgs","repos_url":"https://api.github.com/users/WeberJulian/repos","events_url":"https://api.github.com/users/WeberJulian/events{/privacy}","received_events_url":"https://api.github.com/users/WeberJulian/received_events","type":"User","site_admin":false},"created_at":"2020-08-03T15:22:34Z","updated_at":"2020-08-03T15:31:28Z","author_association":"CONTRIBUTOR","body":"Hi, I just pulled dev and I have the same problem. I don't think #476 solved the issue. Even though the changes are presents.\r\n\r\n``` python\r\n@staticmethod\r\n    def _make_ga_mask(ilen, olen, sigma):\r\n        grid_x, grid_y = torch.meshgrid(torch.arange(olen, device=olen.device), torch.arange(ilen, device=ilen.device))\r\n        grid_x, grid_y = grid_x.float(), grid_y.float()\r\n        return 1.0 - torch.exp(-(grid_y / ilen - grid_x / olen) ** 2 / (2 * (sigma ** 2)))\r\n```\r\n\r\n``` sh\r\nTraceback (most recent call last):\r\n  File \"train_tts.py\", line 645, in <module>\r\n    main(args)\r\n  File \"train_tts.py\", line 560, in main\r\n    global_step, epoch)\r\n  File \"train_tts.py\", line 170, in train\r\n    text_lengths)\r\n  File \"/home/ubuntu/miniconda3/envs/dev/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 722, in _call_impl\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ubuntu/TTS/TTS/tts/layers/losses.py\", line 240, in forward\r\n    ga_loss = self.criterion_ga(alignments, input_lens, alignment_lens)\r\n  File \"/home/ubuntu/miniconda3/envs/dev/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 722, in _call_impl\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ubuntu/TTS/TTS/tts/layers/losses.py\", line 145, in forward\r\n    ga_masks = self._make_ga_masks(ilens, olens).to(att_ws.device)\r\n  File \"/home/ubuntu/TTS/TTS/tts/layers/losses.py\", line 141, in _make_ga_masks\r\n    ga_masks[idx, :olen, :ilen] = self._make_ga_mask(ilen, olen, self.sigma)\r\n  File \"/home/ubuntu/TTS/TTS/tts/layers/losses.py\", line 155, in _make_ga_mask\r\n    return 1.0 - torch.exp(-(grid_y / ilen - grid_x / olen) ** 2 / (2 * (sigma ** 2)))\r\nRuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!\r\n```","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/668083232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WeberJulian","id":17219561,"node_id":"MDQ6VXNlcjE3MjE5NTYx","avatar_url":"https://avatars.githubusercontent.com/u/17219561?v=4","gravatar_id":"","url":"https://api.github.com/users/WeberJulian","html_url":"https://github.com/WeberJulian","followers_url":"https://api.github.com/users/WeberJulian/followers","following_url":"https://api.github.com/users/WeberJulian/following{/other_user}","gists_url":"https://api.github.com/users/WeberJulian/gists{/gist_id}","starred_url":"https://api.github.com/users/WeberJulian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeberJulian/subscriptions","organizations_url":"https://api.github.com/users/WeberJulian/orgs","repos_url":"https://api.github.com/users/WeberJulian/repos","events_url":"https://api.github.com/users/WeberJulian/events{/privacy}","received_events_url":"https://api.github.com/users/WeberJulian/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/668099946","html_url":"https://github.com/mozilla/TTS/issues/473#issuecomment-668099946","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/473","id":668099946,"node_id":"MDEyOklzc3VlQ29tbWVudDY2ODA5OTk0Ng==","user":{"login":"WeberJulian","id":17219561,"node_id":"MDQ6VXNlcjE3MjE5NTYx","avatar_url":"https://avatars.githubusercontent.com/u/17219561?v=4","gravatar_id":"","url":"https://api.github.com/users/WeberJulian","html_url":"https://github.com/WeberJulian","followers_url":"https://api.github.com/users/WeberJulian/followers","following_url":"https://api.github.com/users/WeberJulian/following{/other_user}","gists_url":"https://api.github.com/users/WeberJulian/gists{/gist_id}","starred_url":"https://api.github.com/users/WeberJulian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeberJulian/subscriptions","organizations_url":"https://api.github.com/users/WeberJulian/orgs","repos_url":"https://api.github.com/users/WeberJulian/repos","events_url":"https://api.github.com/users/WeberJulian/events{/privacy}","received_events_url":"https://api.github.com/users/WeberJulian/received_events","type":"User","site_admin":false},"created_at":"2020-08-03T15:53:36Z","updated_at":"2020-08-03T15:53:36Z","author_association":"CONTRIBUTOR","body":"forcing `device='cuda'` solves the issue but it's obviously not a valid fix.\r\n\r\n``` python\r\ngrid_x, grid_y = torch.meshgrid(torch.arange(olen, device='cuda'), torch.arange(ilen, device='cuda'))\r\n```","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/668099946/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WeberJulian","id":17219561,"node_id":"MDQ6VXNlcjE3MjE5NTYx","avatar_url":"https://avatars.githubusercontent.com/u/17219561?v=4","gravatar_id":"","url":"https://api.github.com/users/WeberJulian","html_url":"https://github.com/WeberJulian","followers_url":"https://api.github.com/users/WeberJulian/followers","following_url":"https://api.github.com/users/WeberJulian/following{/other_user}","gists_url":"https://api.github.com/users/WeberJulian/gists{/gist_id}","starred_url":"https://api.github.com/users/WeberJulian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeberJulian/subscriptions","organizations_url":"https://api.github.com/users/WeberJulian/orgs","repos_url":"https://api.github.com/users/WeberJulian/repos","events_url":"https://api.github.com/users/WeberJulian/events{/privacy}","received_events_url":"https://api.github.com/users/WeberJulian/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/668120770","html_url":"https://github.com/mozilla/TTS/issues/473#issuecomment-668120770","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/473","id":668120770,"node_id":"MDEyOklzc3VlQ29tbWVudDY2ODEyMDc3MA==","user":{"login":"jyegerlehner","id":2138320,"node_id":"MDQ6VXNlcjIxMzgzMjA=","avatar_url":"https://avatars.githubusercontent.com/u/2138320?v=4","gravatar_id":"","url":"https://api.github.com/users/jyegerlehner","html_url":"https://github.com/jyegerlehner","followers_url":"https://api.github.com/users/jyegerlehner/followers","following_url":"https://api.github.com/users/jyegerlehner/following{/other_user}","gists_url":"https://api.github.com/users/jyegerlehner/gists{/gist_id}","starred_url":"https://api.github.com/users/jyegerlehner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jyegerlehner/subscriptions","organizations_url":"https://api.github.com/users/jyegerlehner/orgs","repos_url":"https://api.github.com/users/jyegerlehner/repos","events_url":"https://api.github.com/users/jyegerlehner/events{/privacy}","received_events_url":"https://api.github.com/users/jyegerlehner/received_events","type":"User","site_admin":false},"created_at":"2020-08-03T16:35:39Z","updated_at":"2020-08-03T16:35:39Z","author_association":"CONTRIBUTOR","body":"I'm new to torch, but I'm guessing this must mean that `ilen` and `olen` were on different devices coming in to` _make_ga_mask`. One could check by printing out the device:\r\n```\r\n        print(\"grid_y.device={}\".format(grid_y.device))\r\n        print(\"grid_x.device={}\".format(grid_x.device))\r\n        print(\"olen.device={}\".format(olen.device))\r\n        print(\"ilen.device={}\".format(ilen.device))\r\n        return 1.0 - torch.exp(-(grid_y / ilen - grid_x / olen) ** 2 / (2 * (sigma ** 2)))\r\n```\r\n\r\nIn which case I see \r\n```\r\ngrid_y.device=cuda:0\r\ngrid_x.device=cuda:0\r\nolen.device=cuda:0\r\nilen.device=cuda:0\r\n\r\n```\r\nand in your case they are not all on the same device.\r\n\r\nBut I imagine a work around might be, instead of setting the `arange` results passed to `meshgrid` to the device of ilen and olen, just choose one of them and use it's device, e.g.:\r\n\r\n`grid_x, grid_y = torch.meshgrid(torch.arange(olen, device=ilen.device), torch.arange(ilen, device=ilen.device))\r\n`\r\nBut it does seems like a hack that shouldn't be necessary considering the code that produces them. And perhaps a performance hit since it's going to be moving stuff between CPU and GPU mem. \r\n\r\nIf it's not too much trouble maybe you could go up the call stack and see which line  causes ilen and olen to end up on different devices.","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/668120770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jyegerlehner","id":2138320,"node_id":"MDQ6VXNlcjIxMzgzMjA=","avatar_url":"https://avatars.githubusercontent.com/u/2138320?v=4","gravatar_id":"","url":"https://api.github.com/users/jyegerlehner","html_url":"https://github.com/jyegerlehner","followers_url":"https://api.github.com/users/jyegerlehner/followers","following_url":"https://api.github.com/users/jyegerlehner/following{/other_user}","gists_url":"https://api.github.com/users/jyegerlehner/gists{/gist_id}","starred_url":"https://api.github.com/users/jyegerlehner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jyegerlehner/subscriptions","organizations_url":"https://api.github.com/users/jyegerlehner/orgs","repos_url":"https://api.github.com/users/jyegerlehner/repos","events_url":"https://api.github.com/users/jyegerlehner/events{/privacy}","received_events_url":"https://api.github.com/users/jyegerlehner/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/668465166","html_url":"https://github.com/mozilla/TTS/issues/473#issuecomment-668465166","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/473","id":668465166,"node_id":"MDEyOklzc3VlQ29tbWVudDY2ODQ2NTE2Ng==","user":{"login":"WeberJulian","id":17219561,"node_id":"MDQ6VXNlcjE3MjE5NTYx","avatar_url":"https://avatars.githubusercontent.com/u/17219561?v=4","gravatar_id":"","url":"https://api.github.com/users/WeberJulian","html_url":"https://github.com/WeberJulian","followers_url":"https://api.github.com/users/WeberJulian/followers","following_url":"https://api.github.com/users/WeberJulian/following{/other_user}","gists_url":"https://api.github.com/users/WeberJulian/gists{/gist_id}","starred_url":"https://api.github.com/users/WeberJulian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeberJulian/subscriptions","organizations_url":"https://api.github.com/users/WeberJulian/orgs","repos_url":"https://api.github.com/users/WeberJulian/repos","events_url":"https://api.github.com/users/WeberJulian/events{/privacy}","received_events_url":"https://api.github.com/users/WeberJulian/received_events","type":"User","site_admin":false},"created_at":"2020-08-04T08:39:24Z","updated_at":"2020-08-04T08:39:24Z","author_association":"CONTRIBUTOR","body":"I'm sorry it's really weird, I can't get it to crash again... I tried this and even starting a new train from scratch.\r\n\r\n```python \r\n    @staticmethod\r\n    def _make_ga_mask(ilen, olen, sigma):\r\n        if ilen.device != olen.device:\r\n            pdb.set_trace()\r\n        grid_x, grid_y = torch.meshgrid(torch.arange(olen, device=olen.device), torch.arange(ilen, device=ilen.device))\r\n        grid_x, grid_y = grid_x.float(), grid_y.float()\r\n        return 1.0 - torch.exp(-(grid_y / ilen - grid_x / olen) ** 2 / (2 * (sigma ** 2)))\r\n```\r\n\r\nI reverted all the changes and it still works","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/668465166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WeberJulian","id":17219561,"node_id":"MDQ6VXNlcjE3MjE5NTYx","avatar_url":"https://avatars.githubusercontent.com/u/17219561?v=4","gravatar_id":"","url":"https://api.github.com/users/WeberJulian","html_url":"https://github.com/WeberJulian","followers_url":"https://api.github.com/users/WeberJulian/followers","following_url":"https://api.github.com/users/WeberJulian/following{/other_user}","gists_url":"https://api.github.com/users/WeberJulian/gists{/gist_id}","starred_url":"https://api.github.com/users/WeberJulian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeberJulian/subscriptions","organizations_url":"https://api.github.com/users/WeberJulian/orgs","repos_url":"https://api.github.com/users/WeberJulian/repos","events_url":"https://api.github.com/users/WeberJulian/events{/privacy}","received_events_url":"https://api.github.com/users/WeberJulian/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/668477364","html_url":"https://github.com/mozilla/TTS/issues/473#issuecomment-668477364","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/473","id":668477364,"node_id":"MDEyOklzc3VlQ29tbWVudDY2ODQ3NzM2NA==","user":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"created_at":"2020-08-04T09:03:12Z","updated_at":"2020-08-04T09:03:12Z","author_association":"CONTRIBUTOR","body":"so there is not problem ?","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/668477364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/668478711","html_url":"https://github.com/mozilla/TTS/issues/473#issuecomment-668478711","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/473","id":668478711,"node_id":"MDEyOklzc3VlQ29tbWVudDY2ODQ3ODcxMQ==","user":{"login":"WeberJulian","id":17219561,"node_id":"MDQ6VXNlcjE3MjE5NTYx","avatar_url":"https://avatars.githubusercontent.com/u/17219561?v=4","gravatar_id":"","url":"https://api.github.com/users/WeberJulian","html_url":"https://github.com/WeberJulian","followers_url":"https://api.github.com/users/WeberJulian/followers","following_url":"https://api.github.com/users/WeberJulian/following{/other_user}","gists_url":"https://api.github.com/users/WeberJulian/gists{/gist_id}","starred_url":"https://api.github.com/users/WeberJulian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeberJulian/subscriptions","organizations_url":"https://api.github.com/users/WeberJulian/orgs","repos_url":"https://api.github.com/users/WeberJulian/repos","events_url":"https://api.github.com/users/WeberJulian/events{/privacy}","received_events_url":"https://api.github.com/users/WeberJulian/received_events","type":"User","site_admin":false},"created_at":"2020-08-04T09:05:53Z","updated_at":"2020-08-04T09:05:53Z","author_association":"CONTRIBUTOR","body":"Not anymore, I didn't reset the phoneme cash between the runs but I don't think it matters","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/668478711/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"WeberJulian","id":17219561,"node_id":"MDQ6VXNlcjE3MjE5NTYx","avatar_url":"https://avatars.githubusercontent.com/u/17219561?v=4","gravatar_id":"","url":"https://api.github.com/users/WeberJulian","html_url":"https://github.com/WeberJulian","followers_url":"https://api.github.com/users/WeberJulian/followers","following_url":"https://api.github.com/users/WeberJulian/following{/other_user}","gists_url":"https://api.github.com/users/WeberJulian/gists{/gist_id}","starred_url":"https://api.github.com/users/WeberJulian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeberJulian/subscriptions","organizations_url":"https://api.github.com/users/WeberJulian/orgs","repos_url":"https://api.github.com/users/WeberJulian/repos","events_url":"https://api.github.com/users/WeberJulian/events{/privacy}","received_events_url":"https://api.github.com/users/WeberJulian/received_events","type":"User","site_admin":false}},{"id":3913653808,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDM5MTM2NTM4MDg=","url":"https://api.github.com/repos/mozilla/TTS/issues/events/3913653808","actor":{"login":"lexkoro","id":6319070,"node_id":"MDQ6VXNlcjYzMTkwNzA=","avatar_url":"https://avatars.githubusercontent.com/u/6319070?v=4","gravatar_id":"","url":"https://api.github.com/users/lexkoro","html_url":"https://github.com/lexkoro","followers_url":"https://api.github.com/users/lexkoro/followers","following_url":"https://api.github.com/users/lexkoro/following{/other_user}","gists_url":"https://api.github.com/users/lexkoro/gists{/gist_id}","starred_url":"https://api.github.com/users/lexkoro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lexkoro/subscriptions","organizations_url":"https://api.github.com/users/lexkoro/orgs","repos_url":"https://api.github.com/users/lexkoro/repos","events_url":"https://api.github.com/users/lexkoro/events{/privacy}","received_events_url":"https://api.github.com/users/lexkoro/received_events","type":"User","site_admin":false},"event":"referenced","commit_id":"47d74ced1c0cc462590a51817bbc31617ce97a30","commit_url":"https://api.github.com/repos/lexkoro/TTS/commits/47d74ced1c0cc462590a51817bbc31617ce97a30","created_at":"2020-10-23T12:15:03Z","performed_via_github_app":null}]