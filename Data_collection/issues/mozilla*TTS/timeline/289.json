[{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/535466575","html_url":"https://github.com/mozilla/TTS/issues/289#issuecomment-535466575","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/289","id":535466575,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTQ2NjU3NQ==","user":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"created_at":"2019-09-26T11:46:17Z","updated_at":"2019-09-26T11:46:17Z","author_association":"CONTRIBUTOR","body":"Here it tells the problem. \r\n\r\n\r\nRuntimeError: [enforce fail at CPUAllocator.cpp:64] . DefaultCPUAllocator: can't allocate memory: you tried to allocate 99187200 bytes. Error code 12 (Cannot allocate memory)\r\n\r\n\r\ntry a smaller batch size or reduce num_workers and be sure there is enough space in RAM.","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/535466575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false}},{"id":2664957892,"node_id":"MDExOkNsb3NlZEV2ZW50MjY2NDk1Nzg5Mg==","url":"https://api.github.com/repos/mozilla/TTS/issues/events/2664957892","actor":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-09-26T11:46:17Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/535468417","html_url":"https://github.com/mozilla/TTS/issues/289#issuecomment-535468417","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/289","id":535468417,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTQ2ODQxNw==","user":{"login":"vcjob","id":51916323,"node_id":"MDQ6VXNlcjUxOTE2MzIz","avatar_url":"https://avatars.githubusercontent.com/u/51916323?v=4","gravatar_id":"","url":"https://api.github.com/users/vcjob","html_url":"https://github.com/vcjob","followers_url":"https://api.github.com/users/vcjob/followers","following_url":"https://api.github.com/users/vcjob/following{/other_user}","gists_url":"https://api.github.com/users/vcjob/gists{/gist_id}","starred_url":"https://api.github.com/users/vcjob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vcjob/subscriptions","organizations_url":"https://api.github.com/users/vcjob/orgs","repos_url":"https://api.github.com/users/vcjob/repos","events_url":"https://api.github.com/users/vcjob/events{/privacy}","received_events_url":"https://api.github.com/users/vcjob/received_events","type":"User","site_admin":false},"created_at":"2019-09-26T11:52:38Z","updated_at":"2019-09-26T11:53:40Z","author_association":"NONE","body":"> Here it tells the problem.\r\n> \r\n> RuntimeError: [enforce fail at CPUAllocator.cpp:64] . DefaultCPUAllocator: can't allocate memory: you tried to allocate 99187200 bytes. Error code 12 (Cannot allocate memory)\r\n> \r\n> try a smaller batch size or reduce num_workers and be sure there is enough space in RAM.\r\n\r\nThe thing is, with a batch size = 24 it uses 31gb RAM and 27 GB swap on RTX2080TI server by the end of the 2nd epoch.  It seems like in dev branch it is not going to release memory at all. Just consumes more and more. On V100 server we have only 32 gb ram and no swap at all, that's why we had that error occurred.\r\nNow, with num_worker=0 it consumes 12.5 GB ram on Tesla V100 after 1st epoch is finished. I'm afraid that by the end of 2nd epoch it will ask for another 12.5 (25GB in total) and so on. \r\nI will keep you updated!","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/535468417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vcjob","id":51916323,"node_id":"MDQ6VXNlcjUxOTE2MzIz","avatar_url":"https://avatars.githubusercontent.com/u/51916323?v=4","gravatar_id":"","url":"https://api.github.com/users/vcjob","html_url":"https://github.com/vcjob","followers_url":"https://api.github.com/users/vcjob/followers","following_url":"https://api.github.com/users/vcjob/following{/other_user}","gists_url":"https://api.github.com/users/vcjob/gists{/gist_id}","starred_url":"https://api.github.com/users/vcjob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vcjob/subscriptions","organizations_url":"https://api.github.com/users/vcjob/orgs","repos_url":"https://api.github.com/users/vcjob/repos","events_url":"https://api.github.com/users/vcjob/events{/privacy}","received_events_url":"https://api.github.com/users/vcjob/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/535497674","html_url":"https://github.com/mozilla/TTS/issues/289#issuecomment-535497674","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/289","id":535497674,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTQ5NzY3NA==","user":{"login":"vcjob","id":51916323,"node_id":"MDQ6VXNlcjUxOTE2MzIz","avatar_url":"https://avatars.githubusercontent.com/u/51916323?v=4","gravatar_id":"","url":"https://api.github.com/users/vcjob","html_url":"https://github.com/vcjob","followers_url":"https://api.github.com/users/vcjob/followers","following_url":"https://api.github.com/users/vcjob/following{/other_user}","gists_url":"https://api.github.com/users/vcjob/gists{/gist_id}","starred_url":"https://api.github.com/users/vcjob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vcjob/subscriptions","organizations_url":"https://api.github.com/users/vcjob/orgs","repos_url":"https://api.github.com/users/vcjob/repos","events_url":"https://api.github.com/users/vcjob/events{/privacy}","received_events_url":"https://api.github.com/users/vcjob/received_events","type":"User","site_admin":false},"created_at":"2019-09-26T13:17:35Z","updated_at":"2019-09-26T13:18:01Z","author_association":"NONE","body":"I've checked, it is not consuming more memory. On RTX it went down to ~10gb RAM,  on V100 it remained on the same level - 12.5 gb (number of workers = 0). Seems like I need to extend my RAM. But is it strange, isn't it? Does it really suppose to consume 64gb?","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/535497674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vcjob","id":51916323,"node_id":"MDQ6VXNlcjUxOTE2MzIz","avatar_url":"https://avatars.githubusercontent.com/u/51916323?v=4","gravatar_id":"","url":"https://api.github.com/users/vcjob","html_url":"https://github.com/vcjob","followers_url":"https://api.github.com/users/vcjob/followers","following_url":"https://api.github.com/users/vcjob/following{/other_user}","gists_url":"https://api.github.com/users/vcjob/gists{/gist_id}","starred_url":"https://api.github.com/users/vcjob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vcjob/subscriptions","organizations_url":"https://api.github.com/users/vcjob/orgs","repos_url":"https://api.github.com/users/vcjob/repos","events_url":"https://api.github.com/users/vcjob/events{/privacy}","received_events_url":"https://api.github.com/users/vcjob/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/618115279","html_url":"https://github.com/mozilla/TTS/issues/289#issuecomment-618115279","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/289","id":618115279,"node_id":"MDEyOklzc3VlQ29tbWVudDYxODExNTI3OQ==","user":{"login":"machineko","id":42299606,"node_id":"MDQ6VXNlcjQyMjk5NjA2","avatar_url":"https://avatars.githubusercontent.com/u/42299606?v=4","gravatar_id":"","url":"https://api.github.com/users/machineko","html_url":"https://github.com/machineko","followers_url":"https://api.github.com/users/machineko/followers","following_url":"https://api.github.com/users/machineko/following{/other_user}","gists_url":"https://api.github.com/users/machineko/gists{/gist_id}","starred_url":"https://api.github.com/users/machineko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/machineko/subscriptions","organizations_url":"https://api.github.com/users/machineko/orgs","repos_url":"https://api.github.com/users/machineko/repos","events_url":"https://api.github.com/users/machineko/events{/privacy}","received_events_url":"https://api.github.com/users/machineko/received_events","type":"User","site_admin":false},"created_at":"2020-04-23T00:57:11Z","updated_at":"2020-04-23T00:57:11Z","author_association":"NONE","body":"For people from future.\r\nIf u have same problem change gradual_training to null in config file :)","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/618115279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"machineko","id":42299606,"node_id":"MDQ6VXNlcjQyMjk5NjA2","avatar_url":"https://avatars.githubusercontent.com/u/42299606?v=4","gravatar_id":"","url":"https://api.github.com/users/machineko","html_url":"https://github.com/machineko","followers_url":"https://api.github.com/users/machineko/followers","following_url":"https://api.github.com/users/machineko/following{/other_user}","gists_url":"https://api.github.com/users/machineko/gists{/gist_id}","starred_url":"https://api.github.com/users/machineko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/machineko/subscriptions","organizations_url":"https://api.github.com/users/machineko/orgs","repos_url":"https://api.github.com/users/machineko/repos","events_url":"https://api.github.com/users/machineko/events{/privacy}","received_events_url":"https://api.github.com/users/machineko/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/618371495","html_url":"https://github.com/mozilla/TTS/issues/289#issuecomment-618371495","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/289","id":618371495,"node_id":"MDEyOklzc3VlQ29tbWVudDYxODM3MTQ5NQ==","user":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"created_at":"2020-04-23T12:23:52Z","updated_at":"2020-04-23T12:23:52Z","author_association":"CONTRIBUTOR","body":"Just checked with ```null``` but it did not happen. So I'd suggest anyone having this problem to re-install the environment and PyTorch as the first step.","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/618371495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/618380252","html_url":"https://github.com/mozilla/TTS/issues/289#issuecomment-618380252","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/289","id":618380252,"node_id":"MDEyOklzc3VlQ29tbWVudDYxODM4MDI1Mg==","user":{"login":"machineko","id":42299606,"node_id":"MDQ6VXNlcjQyMjk5NjA2","avatar_url":"https://avatars.githubusercontent.com/u/42299606?v=4","gravatar_id":"","url":"https://api.github.com/users/machineko","html_url":"https://github.com/machineko","followers_url":"https://api.github.com/users/machineko/followers","following_url":"https://api.github.com/users/machineko/following{/other_user}","gists_url":"https://api.github.com/users/machineko/gists{/gist_id}","starred_url":"https://api.github.com/users/machineko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/machineko/subscriptions","organizations_url":"https://api.github.com/users/machineko/orgs","repos_url":"https://api.github.com/users/machineko/repos","events_url":"https://api.github.com/users/machineko/events{/privacy}","received_events_url":"https://api.github.com/users/machineko/received_events","type":"User","site_admin":false},"created_at":"2020-04-23T12:42:41Z","updated_at":"2020-04-23T12:43:53Z","author_association":"NONE","body":"I was working some time on RTX 2080ti  and gradual_training is set in config file to  [[0, 7, 64], [1, 5, 64], [50000, 3, 32], [130000, 2, 16], [290000, 1, 32]] \r\nso first batch size is set to 64 and it broke my memory limit.\r\nAfter changing gradual_training to null in config file batch size was set to normal value (in my case 38) and everything worked fine :)\r\n[trained on arch linux with Pytorch 1.4 cuda 10.1, and all newest possible requirments] ","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/618380252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"machineko","id":42299606,"node_id":"MDQ6VXNlcjQyMjk5NjA2","avatar_url":"https://avatars.githubusercontent.com/u/42299606?v=4","gravatar_id":"","url":"https://api.github.com/users/machineko","html_url":"https://github.com/machineko","followers_url":"https://api.github.com/users/machineko/followers","following_url":"https://api.github.com/users/machineko/following{/other_user}","gists_url":"https://api.github.com/users/machineko/gists{/gist_id}","starred_url":"https://api.github.com/users/machineko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/machineko/subscriptions","organizations_url":"https://api.github.com/users/machineko/orgs","repos_url":"https://api.github.com/users/machineko/repos","events_url":"https://api.github.com/users/machineko/events{/privacy}","received_events_url":"https://api.github.com/users/machineko/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/618417343","html_url":"https://github.com/mozilla/TTS/issues/289#issuecomment-618417343","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/289","id":618417343,"node_id":"MDEyOklzc3VlQ29tbWVudDYxODQxNzM0Mw==","user":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false},"created_at":"2020-04-23T14:11:22Z","updated_at":"2020-04-23T14:11:22Z","author_association":"CONTRIBUTOR","body":"So then the problem is not gradual_training, it is being not setting the right batch size in gradual training schedule, which was too big in your case.","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/618417343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"erogol","id":1402048,"node_id":"MDQ6VXNlcjE0MDIwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1402048?v=4","gravatar_id":"","url":"https://api.github.com/users/erogol","html_url":"https://github.com/erogol","followers_url":"https://api.github.com/users/erogol/followers","following_url":"https://api.github.com/users/erogol/following{/other_user}","gists_url":"https://api.github.com/users/erogol/gists{/gist_id}","starred_url":"https://api.github.com/users/erogol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erogol/subscriptions","organizations_url":"https://api.github.com/users/erogol/orgs","repos_url":"https://api.github.com/users/erogol/repos","events_url":"https://api.github.com/users/erogol/events{/privacy}","received_events_url":"https://api.github.com/users/erogol/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/618418380","html_url":"https://github.com/mozilla/TTS/issues/289#issuecomment-618418380","issue_url":"https://api.github.com/repos/mozilla/TTS/issues/289","id":618418380,"node_id":"MDEyOklzc3VlQ29tbWVudDYxODQxODM4MA==","user":{"login":"machineko","id":42299606,"node_id":"MDQ6VXNlcjQyMjk5NjA2","avatar_url":"https://avatars.githubusercontent.com/u/42299606?v=4","gravatar_id":"","url":"https://api.github.com/users/machineko","html_url":"https://github.com/machineko","followers_url":"https://api.github.com/users/machineko/followers","following_url":"https://api.github.com/users/machineko/following{/other_user}","gists_url":"https://api.github.com/users/machineko/gists{/gist_id}","starred_url":"https://api.github.com/users/machineko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/machineko/subscriptions","organizations_url":"https://api.github.com/users/machineko/orgs","repos_url":"https://api.github.com/users/machineko/repos","events_url":"https://api.github.com/users/machineko/events{/privacy}","received_events_url":"https://api.github.com/users/machineko/received_events","type":"User","site_admin":false},"created_at":"2020-04-23T14:13:12Z","updated_at":"2020-04-23T14:14:24Z","author_association":"NONE","body":"Yup it is not gradual_training per se but basic config of it :)\r\nI'm just saying it for people with same problem in future so they didnt need to look for solution in cuda/pytorch etc.","reactions":{"url":"https://api.github.com/repos/mozilla/TTS/issues/comments/618418380/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"machineko","id":42299606,"node_id":"MDQ6VXNlcjQyMjk5NjA2","avatar_url":"https://avatars.githubusercontent.com/u/42299606?v=4","gravatar_id":"","url":"https://api.github.com/users/machineko","html_url":"https://github.com/machineko","followers_url":"https://api.github.com/users/machineko/followers","following_url":"https://api.github.com/users/machineko/following{/other_user}","gists_url":"https://api.github.com/users/machineko/gists{/gist_id}","starred_url":"https://api.github.com/users/machineko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/machineko/subscriptions","organizations_url":"https://api.github.com/users/machineko/orgs","repos_url":"https://api.github.com/users/machineko/repos","events_url":"https://api.github.com/users/machineko/events{/privacy}","received_events_url":"https://api.github.com/users/machineko/received_events","type":"User","site_admin":false}}]