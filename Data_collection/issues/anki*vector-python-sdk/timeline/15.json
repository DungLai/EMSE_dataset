[{"url":"https://api.github.com/repos/anki/vector-python-sdk/issues/comments/458246992","html_url":"https://github.com/anki/vector-python-sdk/issues/15#issuecomment-458246992","issue_url":"https://api.github.com/repos/anki/vector-python-sdk/issues/15","id":458246992,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1ODI0Njk5Mg==","user":{"login":"shawnblakesley","id":1229637,"node_id":"MDQ6VXNlcjEyMjk2Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/1229637?v=4","gravatar_id":"","url":"https://api.github.com/users/shawnblakesley","html_url":"https://github.com/shawnblakesley","followers_url":"https://api.github.com/users/shawnblakesley/followers","following_url":"https://api.github.com/users/shawnblakesley/following{/other_user}","gists_url":"https://api.github.com/users/shawnblakesley/gists{/gist_id}","starred_url":"https://api.github.com/users/shawnblakesley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shawnblakesley/subscriptions","organizations_url":"https://api.github.com/users/shawnblakesley/orgs","repos_url":"https://api.github.com/users/shawnblakesley/repos","events_url":"https://api.github.com/users/shawnblakesley/events{/privacy}","received_events_url":"https://api.github.com/users/shawnblakesley/received_events","type":"User","site_admin":false},"created_at":"2019-01-28T18:29:44Z","updated_at":"2019-01-28T18:29:44Z","author_association":"CONTRIBUTOR","body":"@Rafiot thanks for the report. It looks like this example didn't get updated when we made a change to the way the event callbacks works.\r\n\r\nThere are a couple of ways to get that current example working:\r\n\r\n1. (Recommended) change from an async function to a sync function. This has a few drawbacks when doing more complicated things. Primary among them being it blocks the event thread preventing other callbacks from firing (such as ones updating the state of the robot).\r\n\r\n```python\r\nimport time\r\n\r\nimport anki_vector\r\n\r\nif __name__ == \"__main__\":\r\n    with anki_vector.Robot(requires_behavior_control=False) as robot:\r\n        def callback(event_type, event):\r\n            robot.conn.request_control()\r\n            print(robot.conn.requires_behavior_control) # Will print True\r\n            robot.anim.play_animation('anim_pounce_success_02')\r\n            robot.conn.release_control()\r\n\r\n        print(robot.conn.requires_behavior_control) # Will print False\r\n        robot.events.subscribe(callback, anki_vector.events.Events.robot_observed_face)\r\n\r\n        # Waits 10 seconds. Show Vector your face.\r\n        time.sleep(10)\r\n```\r\n\r\n2. (Advanced) wrap the concurrent futures in async futures and use an AsyncRobot. This will allow other callbacks to fire while we await each robot call, but is a little extra syntax.\r\n\r\n```python\r\nimport asyncio\r\nimport time\r\n\r\nimport anki_vector\r\n\r\nif __name__ == \"__main__\":\r\n    with anki_vector.AsyncRobot(requires_behavior_control=False) as robot:\r\n        async def callback(event_type, event):\r\n            await asyncio.wrap_future(robot.conn.request_control())\r\n            print(robot.conn.requires_behavior_control) # Will print True\r\n            await asyncio.wrap_future(robot.anim.play_animation('anim_pounce_success_02'))\r\n            await asyncio.wrap_future(robot.conn.release_control())\r\n\r\n        print(robot.conn.requires_behavior_control) # Will print False\r\n        robot.events.subscribe(callback, anki_vector.events.Events.robot_observed_face)\r\n\r\n        # Waits 10 seconds. Show Vector your face.\r\n        time.sleep(10)\r\n```\r\n\r\nThanks again, and let me know if you encounter any issues with those solutions.\r\n\r\n-Shawn","reactions":{"url":"https://api.github.com/repos/anki/vector-python-sdk/issues/comments/458246992/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shawnblakesley","id":1229637,"node_id":"MDQ6VXNlcjEyMjk2Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/1229637?v=4","gravatar_id":"","url":"https://api.github.com/users/shawnblakesley","html_url":"https://github.com/shawnblakesley","followers_url":"https://api.github.com/users/shawnblakesley/followers","following_url":"https://api.github.com/users/shawnblakesley/following{/other_user}","gists_url":"https://api.github.com/users/shawnblakesley/gists{/gist_id}","starred_url":"https://api.github.com/users/shawnblakesley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shawnblakesley/subscriptions","organizations_url":"https://api.github.com/users/shawnblakesley/orgs","repos_url":"https://api.github.com/users/shawnblakesley/repos","events_url":"https://api.github.com/users/shawnblakesley/events{/privacy}","received_events_url":"https://api.github.com/users/shawnblakesley/received_events","type":"User","site_admin":false}},{"id":2101591736,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjEwMTU5MTczNg==","url":"https://api.github.com/repos/anki/vector-python-sdk/issues/events/2101591736","actor":{"login":"Rafiot","id":248875,"node_id":"MDQ6VXNlcjI0ODg3NQ==","avatar_url":"https://avatars.githubusercontent.com/u/248875?v=4","gravatar_id":"","url":"https://api.github.com/users/Rafiot","html_url":"https://github.com/Rafiot","followers_url":"https://api.github.com/users/Rafiot/followers","following_url":"https://api.github.com/users/Rafiot/following{/other_user}","gists_url":"https://api.github.com/users/Rafiot/gists{/gist_id}","starred_url":"https://api.github.com/users/Rafiot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rafiot/subscriptions","organizations_url":"https://api.github.com/users/Rafiot/orgs","repos_url":"https://api.github.com/users/Rafiot/repos","events_url":"https://api.github.com/users/Rafiot/events{/privacy}","received_events_url":"https://api.github.com/users/Rafiot/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-01-28T18:29:44Z","performed_via_github_app":null},{"id":2101591737,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIxMDE1OTE3Mzc=","url":"https://api.github.com/repos/anki/vector-python-sdk/issues/events/2101591737","actor":{"login":"Rafiot","id":248875,"node_id":"MDQ6VXNlcjI0ODg3NQ==","avatar_url":"https://avatars.githubusercontent.com/u/248875?v=4","gravatar_id":"","url":"https://api.github.com/users/Rafiot","html_url":"https://github.com/Rafiot","followers_url":"https://api.github.com/users/Rafiot/followers","following_url":"https://api.github.com/users/Rafiot/following{/other_user}","gists_url":"https://api.github.com/users/Rafiot/gists{/gist_id}","starred_url":"https://api.github.com/users/Rafiot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rafiot/subscriptions","organizations_url":"https://api.github.com/users/Rafiot/orgs","repos_url":"https://api.github.com/users/Rafiot/repos","events_url":"https://api.github.com/users/Rafiot/events{/privacy}","received_events_url":"https://api.github.com/users/Rafiot/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-01-28T18:29:44Z","performed_via_github_app":null},{"id":2101795749,"node_id":"MDExOkNsb3NlZEV2ZW50MjEwMTc5NTc0OQ==","url":"https://api.github.com/repos/anki/vector-python-sdk/issues/events/2101795749","actor":{"login":"msintov","id":1221526,"node_id":"MDQ6VXNlcjEyMjE1MjY=","avatar_url":"https://avatars.githubusercontent.com/u/1221526?v=4","gravatar_id":"","url":"https://api.github.com/users/msintov","html_url":"https://github.com/msintov","followers_url":"https://api.github.com/users/msintov/followers","following_url":"https://api.github.com/users/msintov/following{/other_user}","gists_url":"https://api.github.com/users/msintov/gists{/gist_id}","starred_url":"https://api.github.com/users/msintov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/msintov/subscriptions","organizations_url":"https://api.github.com/users/msintov/orgs","repos_url":"https://api.github.com/users/msintov/repos","events_url":"https://api.github.com/users/msintov/events{/privacy}","received_events_url":"https://api.github.com/users/msintov/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-01-28T19:55:28Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/anki/vector-python-sdk/issues/comments/458335010","html_url":"https://github.com/anki/vector-python-sdk/issues/15#issuecomment-458335010","issue_url":"https://api.github.com/repos/anki/vector-python-sdk/issues/15","id":458335010,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1ODMzNTAxMA==","user":{"login":"Rafiot","id":248875,"node_id":"MDQ6VXNlcjI0ODg3NQ==","avatar_url":"https://avatars.githubusercontent.com/u/248875?v=4","gravatar_id":"","url":"https://api.github.com/users/Rafiot","html_url":"https://github.com/Rafiot","followers_url":"https://api.github.com/users/Rafiot/followers","following_url":"https://api.github.com/users/Rafiot/following{/other_user}","gists_url":"https://api.github.com/users/Rafiot/gists{/gist_id}","starred_url":"https://api.github.com/users/Rafiot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rafiot/subscriptions","organizations_url":"https://api.github.com/users/Rafiot/orgs","repos_url":"https://api.github.com/users/Rafiot/repos","events_url":"https://api.github.com/users/Rafiot/events{/privacy}","received_events_url":"https://api.github.com/users/Rafiot/received_events","type":"User","site_admin":false},"created_at":"2019-01-28T22:53:38Z","updated_at":"2019-01-28T22:53:38Z","author_association":"NONE","body":"Thank you! I was looking for the async approach :) ","reactions":{"url":"https://api.github.com/repos/anki/vector-python-sdk/issues/comments/458335010/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Rafiot","id":248875,"node_id":"MDQ6VXNlcjI0ODg3NQ==","avatar_url":"https://avatars.githubusercontent.com/u/248875?v=4","gravatar_id":"","url":"https://api.github.com/users/Rafiot","html_url":"https://github.com/Rafiot","followers_url":"https://api.github.com/users/Rafiot/followers","following_url":"https://api.github.com/users/Rafiot/following{/other_user}","gists_url":"https://api.github.com/users/Rafiot/gists{/gist_id}","starred_url":"https://api.github.com/users/Rafiot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rafiot/subscriptions","organizations_url":"https://api.github.com/users/Rafiot/orgs","repos_url":"https://api.github.com/users/Rafiot/repos","events_url":"https://api.github.com/users/Rafiot/events{/privacy}","received_events_url":"https://api.github.com/users/Rafiot/received_events","type":"User","site_admin":false}},{"id":2310829560,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDIzMTA4Mjk1NjA=","url":"https://api.github.com/repos/anki/vector-python-sdk/issues/events/2310829560","actor":{"login":"msintov","id":1221526,"node_id":"MDQ6VXNlcjEyMjE1MjY=","avatar_url":"https://avatars.githubusercontent.com/u/1221526?v=4","gravatar_id":"","url":"https://api.github.com/users/msintov","html_url":"https://github.com/msintov","followers_url":"https://api.github.com/users/msintov/followers","following_url":"https://api.github.com/users/msintov/following{/other_user}","gists_url":"https://api.github.com/users/msintov/gists{/gist_id}","starred_url":"https://api.github.com/users/msintov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/msintov/subscriptions","organizations_url":"https://api.github.com/users/msintov/orgs","repos_url":"https://api.github.com/users/msintov/repos","events_url":"https://api.github.com/users/msintov/events{/privacy}","received_events_url":"https://api.github.com/users/msintov/received_events","type":"User","site_admin":false},"event":"referenced","commit_id":"ffea0ac6455f8d5a0c20ea7b359c4b8abf49dd56","commit_url":"https://api.github.com/repos/anki/vector-python-sdk/commits/ffea0ac6455f8d5a0c20ea7b359c4b8abf49dd56","created_at":"2019-04-30T21:47:14Z","performed_via_github_app":null},{"id":2310837763,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDIzMTA4Mzc3NjM=","url":"https://api.github.com/repos/anki/vector-python-sdk/issues/events/2310837763","actor":{"login":"msintov","id":1221526,"node_id":"MDQ6VXNlcjEyMjE1MjY=","avatar_url":"https://avatars.githubusercontent.com/u/1221526?v=4","gravatar_id":"","url":"https://api.github.com/users/msintov","html_url":"https://github.com/msintov","followers_url":"https://api.github.com/users/msintov/followers","following_url":"https://api.github.com/users/msintov/following{/other_user}","gists_url":"https://api.github.com/users/msintov/gists{/gist_id}","starred_url":"https://api.github.com/users/msintov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/msintov/subscriptions","organizations_url":"https://api.github.com/users/msintov/orgs","repos_url":"https://api.github.com/users/msintov/repos","events_url":"https://api.github.com/users/msintov/events{/privacy}","received_events_url":"https://api.github.com/users/msintov/received_events","type":"User","site_admin":false},"event":"referenced","commit_id":"359b1057f2d5420ea190467e9c3471a30d28f88b","commit_url":"https://api.github.com/repos/anki/vector-python-sdk/commits/359b1057f2d5420ea190467e9c3471a30d28f88b","created_at":"2019-04-30T21:51:19Z","performed_via_github_app":null},{"id":2310848042,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDIzMTA4NDgwNDI=","url":"https://api.github.com/repos/anki/vector-python-sdk/issues/events/2310848042","actor":{"login":"rmcolbert","id":11874716,"node_id":"MDQ6VXNlcjExODc0NzE2","avatar_url":"https://avatars.githubusercontent.com/u/11874716?v=4","gravatar_id":"","url":"https://api.github.com/users/rmcolbert","html_url":"https://github.com/rmcolbert","followers_url":"https://api.github.com/users/rmcolbert/followers","following_url":"https://api.github.com/users/rmcolbert/following{/other_user}","gists_url":"https://api.github.com/users/rmcolbert/gists{/gist_id}","starred_url":"https://api.github.com/users/rmcolbert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmcolbert/subscriptions","organizations_url":"https://api.github.com/users/rmcolbert/orgs","repos_url":"https://api.github.com/users/rmcolbert/repos","events_url":"https://api.github.com/users/rmcolbert/events{/privacy}","received_events_url":"https://api.github.com/users/rmcolbert/received_events","type":"User","site_admin":false},"event":"referenced","commit_id":"0e54a9ccd037d98fc8d0d1c0f204e4d0d9ce21e5","commit_url":"https://api.github.com/repos/rmcolbert/vector-python-sdk/commits/0e54a9ccd037d98fc8d0d1c0f204e4d0d9ce21e5","created_at":"2019-04-30T21:56:34Z","performed_via_github_app":null}]