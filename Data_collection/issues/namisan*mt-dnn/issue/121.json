{"url":"https://api.github.com/repos/namisan/mt-dnn/issues/121","repository_url":"https://api.github.com/repos/namisan/mt-dnn","labels_url":"https://api.github.com/repos/namisan/mt-dnn/issues/121/labels{/name}","comments_url":"https://api.github.com/repos/namisan/mt-dnn/issues/121/comments","events_url":"https://api.github.com/repos/namisan/mt-dnn/issues/121/events","html_url":"https://github.com/namisan/mt-dnn/issues/121","id":517362651,"node_id":"MDU6SXNzdWU1MTczNjI2NTE=","number":121,"title":"prepro_std.py does not support sequence tasks","user":{"login":"antgr","id":2175768,"node_id":"MDQ6VXNlcjIxNzU3Njg=","avatar_url":"https://avatars.githubusercontent.com/u/2175768?v=4","gravatar_id":"","url":"https://api.github.com/users/antgr","html_url":"https://github.com/antgr","followers_url":"https://api.github.com/users/antgr/followers","following_url":"https://api.github.com/users/antgr/following{/other_user}","gists_url":"https://api.github.com/users/antgr/gists{/gist_id}","starred_url":"https://api.github.com/users/antgr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antgr/subscriptions","organizations_url":"https://api.github.com/users/antgr/orgs","repos_url":"https://api.github.com/users/antgr/repos","events_url":"https://api.github.com/users/antgr/events{/privacy}","received_events_url":"https://api.github.com/users/antgr/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-11-04T19:47:40Z","updated_at":"2019-12-14T10:14:02Z","closed_at":"2019-11-20T18:20:08Z","author_association":"NONE","active_lock_reason":null,"body":"running prepro_std.py  for sequence task, gives an error:\r\n(also the spelling is incorrect: Seqence --> Sequence)\r\n```\r\npython prepro_std.py --model bert-base-uncased --root_dir ner --task_def experiments/ner/ner_task_def.yml \r\nBetter speed can be achieved with apex installed from https://www.github.com/nvidia/apex.\r\n11/04/2019 09:31:52 Task ner\r\ndata_format:  DataFormat.Seqence\r\nTraceback (most recent call last):\r\n  File \"prepro_std.py\", line 551, in <module>\r\n    main(args)\r\n  File \"prepro_std.py\", line 536, in main\r\n    label_mapper)\r\n  File \"prepro_std.py\", line 433, in load_data\r\n    raise ValueError(data_format)\r\nValueError: DataFormat.Seqence\r\n```\r\n\r\nThe missing implementation I think is in load data, in final else (implementation for data_format `Seqence` is missing):\r\n```\r\n    if task_type == TaskType.Ranking:\r\n        assert data_format == DataFormat.PremiseAndMultiHypothesis\r\n\r\n    rows = []\r\n    for line in open(file_path, encoding=\"utf-8\"):\r\n        fields = line.strip(\"\\n\").split(\"\\t\")\r\n        if data_format == DataFormat.PremiseOnly:\r\n            assert len(fields) == 3\r\n            row = {\"uid\": fields[0], \"label\": fields[1], \"premise\": fields[2]}\r\n        elif data_format == DataFormat.PremiseAndOneHypothesis:\r\n            assert len(fields) == 4\r\n            row = {\r\n                \"uid\": fields[0],\r\n                \"label\": fields[1],\r\n                \"premise\": fields[2],\r\n                \"hypothesis\": fields[3]}\r\n        elif data_format == DataFormat.PremiseAndMultiHypothesis:\r\n            assert len(fields) > 5\r\n            row = {\"uid\": fields[0], \"ruid\": fields[1].split(\",\"), \"label\": fields[2], \"premise\": fields[3],\r\n                   \"hypothesis\": fields[4:]}\r\n        else:\r\n            print (\"data_format: \", data_format)\r\n            raise ValueError(data_format) <---- here is the exception\r\n```","closed_by":{"login":"namisan","id":3060273,"node_id":"MDQ6VXNlcjMwNjAyNzM=","avatar_url":"https://avatars.githubusercontent.com/u/3060273?v=4","gravatar_id":"","url":"https://api.github.com/users/namisan","html_url":"https://github.com/namisan","followers_url":"https://api.github.com/users/namisan/followers","following_url":"https://api.github.com/users/namisan/following{/other_user}","gists_url":"https://api.github.com/users/namisan/gists{/gist_id}","starred_url":"https://api.github.com/users/namisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namisan/subscriptions","organizations_url":"https://api.github.com/users/namisan/orgs","repos_url":"https://api.github.com/users/namisan/repos","events_url":"https://api.github.com/users/namisan/events{/privacy}","received_events_url":"https://api.github.com/users/namisan/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/namisan/mt-dnn/issues/121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/namisan/mt-dnn/issues/121/timeline","performed_via_github_app":null,"state_reason":"completed"}