[{"url":"https://api.github.com/repos/namisan/mt-dnn/issues/comments/1125658097","html_url":"https://github.com/namisan/mt-dnn/issues/234#issuecomment-1125658097","issue_url":"https://api.github.com/repos/namisan/mt-dnn/issues/234","id":1125658097,"node_id":"IC_kwDOCjnaNM5DGC3x","user":{"login":"namisan","id":3060273,"node_id":"MDQ6VXNlcjMwNjAyNzM=","avatar_url":"https://avatars.githubusercontent.com/u/3060273?v=4","gravatar_id":"","url":"https://api.github.com/users/namisan","html_url":"https://github.com/namisan","followers_url":"https://api.github.com/users/namisan/followers","following_url":"https://api.github.com/users/namisan/following{/other_user}","gists_url":"https://api.github.com/users/namisan/gists{/gist_id}","starred_url":"https://api.github.com/users/namisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namisan/subscriptions","organizations_url":"https://api.github.com/users/namisan/orgs","repos_url":"https://api.github.com/users/namisan/repos","events_url":"https://api.github.com/users/namisan/events{/privacy}","received_events_url":"https://api.github.com/users/namisan/received_events","type":"User","site_admin":false},"created_at":"2022-05-13T05:00:18Z","updated_at":"2022-05-13T05:00:18Z","author_association":"OWNER","body":"If you have e.g., 3 task A, B, C during the training, the task id for A, B, C is 0, 1, 2 respectively which is used to select the correct task header. ","reactions":{"url":"https://api.github.com/repos/namisan/mt-dnn/issues/comments/1125658097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"namisan","id":3060273,"node_id":"MDQ6VXNlcjMwNjAyNzM=","avatar_url":"https://avatars.githubusercontent.com/u/3060273?v=4","gravatar_id":"","url":"https://api.github.com/users/namisan","html_url":"https://github.com/namisan","followers_url":"https://api.github.com/users/namisan/followers","following_url":"https://api.github.com/users/namisan/following{/other_user}","gists_url":"https://api.github.com/users/namisan/gists{/gist_id}","starred_url":"https://api.github.com/users/namisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namisan/subscriptions","organizations_url":"https://api.github.com/users/namisan/orgs","repos_url":"https://api.github.com/users/namisan/repos","events_url":"https://api.github.com/users/namisan/events{/privacy}","received_events_url":"https://api.github.com/users/namisan/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/namisan/mt-dnn/issues/comments/1126978236","html_url":"https://github.com/namisan/mt-dnn/issues/234#issuecomment-1126978236","issue_url":"https://api.github.com/repos/namisan/mt-dnn/issues/234","id":1126978236,"node_id":"IC_kwDOCjnaNM5DLFK8","user":{"login":"hoangthangta","id":37979473,"node_id":"MDQ6VXNlcjM3OTc5NDcz","avatar_url":"https://avatars.githubusercontent.com/u/37979473?v=4","gravatar_id":"","url":"https://api.github.com/users/hoangthangta","html_url":"https://github.com/hoangthangta","followers_url":"https://api.github.com/users/hoangthangta/followers","following_url":"https://api.github.com/users/hoangthangta/following{/other_user}","gists_url":"https://api.github.com/users/hoangthangta/gists{/gist_id}","starred_url":"https://api.github.com/users/hoangthangta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hoangthangta/subscriptions","organizations_url":"https://api.github.com/users/hoangthangta/orgs","repos_url":"https://api.github.com/users/hoangthangta/repos","events_url":"https://api.github.com/users/hoangthangta/events{/privacy}","received_events_url":"https://api.github.com/users/hoangthangta/received_events","type":"User","site_admin":false},"created_at":"2022-05-15T16:56:06Z","updated_at":"2022-05-15T16:56:06Z","author_association":"NONE","body":"I use this command:\r\n\r\n`python3 predict.py --task homicide --task_def dataset/all_task_def.yml  --max_seq_len 128 --batch_size_eval 8 --checkpoint checkpoint/model_2.pt --prep_input dataset/bert-base-multilingual-cased/test.json --with_label --task_id 1 --score dataset/bert-base-multilingual-cased/test_pred.json `\r\n\r\nand here is an error:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"predict.py\", line 108, in <module>\r\n    with_label=args.with_label,\r\n  File \"/home/thang/mt-dnn/mt_dnn/inference.py\", line 97, in eval_model\r\n    score, pred, gold = model.predict(batch_info, batch_data)\r\n  File \"/home/thang/mt-dnn/mt_dnn/model.py\", line 421, in predict\r\n    score = self.mnetwork(*inputs)\r\n  File \"/home/thang/.env/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 1102, in _call_impl\r\n    return forward_call(*input, **kwargs)\r\n  File \"/home/thang/.env/lib/python3.6/site-packages/torch/nn/parallel/data_parallel.py\", line 166, in forward\r\n    return self.module(*inputs[0], **kwargs[0])\r\n  File \"/home/thang/.env/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 1102, in _call_impl\r\n    return forward_call(*input, **kwargs)\r\n  File \"/home/thang/mt-dnn/mt_dnn/matcher.py\", line 204, in forward\r\n    decoder_opt = self.decoder_opt[task_id]\r\nIndexError: list index out of range\r\n```\r\nHope you can help to figure out how to fix.","reactions":{"url":"https://api.github.com/repos/namisan/mt-dnn/issues/comments/1126978236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hoangthangta","id":37979473,"node_id":"MDQ6VXNlcjM3OTc5NDcz","avatar_url":"https://avatars.githubusercontent.com/u/37979473?v=4","gravatar_id":"","url":"https://api.github.com/users/hoangthangta","html_url":"https://github.com/hoangthangta","followers_url":"https://api.github.com/users/hoangthangta/followers","following_url":"https://api.github.com/users/hoangthangta/following{/other_user}","gists_url":"https://api.github.com/users/hoangthangta/gists{/gist_id}","starred_url":"https://api.github.com/users/hoangthangta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hoangthangta/subscriptions","organizations_url":"https://api.github.com/users/hoangthangta/orgs","repos_url":"https://api.github.com/users/hoangthangta/repos","events_url":"https://api.github.com/users/hoangthangta/events{/privacy}","received_events_url":"https://api.github.com/users/hoangthangta/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/namisan/mt-dnn/issues/comments/1127193908","html_url":"https://github.com/namisan/mt-dnn/issues/234#issuecomment-1127193908","issue_url":"https://api.github.com/repos/namisan/mt-dnn/issues/234","id":1127193908,"node_id":"IC_kwDOCjnaNM5DL500","user":{"login":"hoangthangta","id":37979473,"node_id":"MDQ6VXNlcjM3OTc5NDcz","avatar_url":"https://avatars.githubusercontent.com/u/37979473?v=4","gravatar_id":"","url":"https://api.github.com/users/hoangthangta","html_url":"https://github.com/hoangthangta","followers_url":"https://api.github.com/users/hoangthangta/followers","following_url":"https://api.github.com/users/hoangthangta/following{/other_user}","gists_url":"https://api.github.com/users/hoangthangta/gists{/gist_id}","starred_url":"https://api.github.com/users/hoangthangta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hoangthangta/subscriptions","organizations_url":"https://api.github.com/users/hoangthangta/orgs","repos_url":"https://api.github.com/users/hoangthangta/repos","events_url":"https://api.github.com/users/hoangthangta/events{/privacy}","received_events_url":"https://api.github.com/users/hoangthangta/received_events","type":"User","site_admin":false},"created_at":"2022-05-16T04:08:52Z","updated_at":"2022-05-16T04:10:35Z","author_association":"NONE","body":"In the predict.py, I have to modify this:\r\n\r\n`task_def_list = [task_def]*5 # 5 is the number of tasks, here all 5 tasks are binary classification\r\n`\r\nor define your one here, or by arguments if you want.\r\n`\r\ntask_def_list = [task_def, task_def, task_def, task_def, task_def]\r\n`\r\n\r\nIt seems  `predict.py ` needed to rewrite a bit more to support multi head predictions.","reactions":{"url":"https://api.github.com/repos/namisan/mt-dnn/issues/comments/1127193908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hoangthangta","id":37979473,"node_id":"MDQ6VXNlcjM3OTc5NDcz","avatar_url":"https://avatars.githubusercontent.com/u/37979473?v=4","gravatar_id":"","url":"https://api.github.com/users/hoangthangta","html_url":"https://github.com/hoangthangta","followers_url":"https://api.github.com/users/hoangthangta/followers","following_url":"https://api.github.com/users/hoangthangta/following{/other_user}","gists_url":"https://api.github.com/users/hoangthangta/gists{/gist_id}","starred_url":"https://api.github.com/users/hoangthangta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hoangthangta/subscriptions","organizations_url":"https://api.github.com/users/hoangthangta/orgs","repos_url":"https://api.github.com/users/hoangthangta/repos","events_url":"https://api.github.com/users/hoangthangta/events{/privacy}","received_events_url":"https://api.github.com/users/hoangthangta/received_events","type":"User","site_admin":false}},{"id":6612801625,"node_id":"CE_lADOCjnaNM5JjGtozwAAAAGKJ1hZ","url":"https://api.github.com/repos/namisan/mt-dnn/issues/events/6612801625","actor":{"login":"hoangthangta","id":37979473,"node_id":"MDQ6VXNlcjM3OTc5NDcz","avatar_url":"https://avatars.githubusercontent.com/u/37979473?v=4","gravatar_id":"","url":"https://api.github.com/users/hoangthangta","html_url":"https://github.com/hoangthangta","followers_url":"https://api.github.com/users/hoangthangta/followers","following_url":"https://api.github.com/users/hoangthangta/following{/other_user}","gists_url":"https://api.github.com/users/hoangthangta/gists{/gist_id}","starred_url":"https://api.github.com/users/hoangthangta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hoangthangta/subscriptions","organizations_url":"https://api.github.com/users/hoangthangta/orgs","repos_url":"https://api.github.com/users/hoangthangta/repos","events_url":"https://api.github.com/users/hoangthangta/events{/privacy}","received_events_url":"https://api.github.com/users/hoangthangta/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-05-16T04:10:11Z","state_reason":null,"performed_via_github_app":null}]