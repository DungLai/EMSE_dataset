{"url":"https://api.github.com/repos/hackingmaterials/automatminer/issues/139","repository_url":"https://api.github.com/repos/hackingmaterials/automatminer","labels_url":"https://api.github.com/repos/hackingmaterials/automatminer/issues/139/labels{/name}","comments_url":"https://api.github.com/repos/hackingmaterials/automatminer/issues/139/comments","events_url":"https://api.github.com/repos/hackingmaterials/automatminer/issues/139/events","html_url":"https://github.com/hackingmaterials/automatminer/issues/139","id":387667105,"node_id":"MDU6SXNzdWUzODc2NjcxMDU=","number":139,"title":"metaselection needs error handling, or screening beforehand","user":{"login":"ardunn","id":19936203,"node_id":"MDQ6VXNlcjE5OTM2MjAz","avatar_url":"https://avatars.githubusercontent.com/u/19936203?v=4","gravatar_id":"","url":"https://api.github.com/users/ardunn","html_url":"https://github.com/ardunn","followers_url":"https://api.github.com/users/ardunn/followers","following_url":"https://api.github.com/users/ardunn/following{/other_user}","gists_url":"https://api.github.com/users/ardunn/gists{/gist_id}","starred_url":"https://api.github.com/users/ardunn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ardunn/subscriptions","organizations_url":"https://api.github.com/users/ardunn/orgs","repos_url":"https://api.github.com/users/ardunn/repos","events_url":"https://api.github.com/users/ardunn/events{/privacy}","received_events_url":"https://api.github.com/users/ardunn/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"ardunn","id":19936203,"node_id":"MDQ6VXNlcjE5OTM2MjAz","avatar_url":"https://avatars.githubusercontent.com/u/19936203?v=4","gravatar_id":"","url":"https://api.github.com/users/ardunn","html_url":"https://github.com/ardunn","followers_url":"https://api.github.com/users/ardunn/followers","following_url":"https://api.github.com/users/ardunn/following{/other_user}","gists_url":"https://api.github.com/users/ardunn/gists{/gist_id}","starred_url":"https://api.github.com/users/ardunn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ardunn/subscriptions","organizations_url":"https://api.github.com/users/ardunn/orgs","repos_url":"https://api.github.com/users/ardunn/repos","events_url":"https://api.github.com/users/ardunn/events{/privacy}","received_events_url":"https://api.github.com/users/ardunn/received_events","type":"User","site_admin":false},"assignees":[{"login":"ardunn","id":19936203,"node_id":"MDQ6VXNlcjE5OTM2MjAz","avatar_url":"https://avatars.githubusercontent.com/u/19936203?v=4","gravatar_id":"","url":"https://api.github.com/users/ardunn","html_url":"https://github.com/ardunn","followers_url":"https://api.github.com/users/ardunn/followers","following_url":"https://api.github.com/users/ardunn/following{/other_user}","gists_url":"https://api.github.com/users/ardunn/gists{/gist_id}","starred_url":"https://api.github.com/users/ardunn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ardunn/subscriptions","organizations_url":"https://api.github.com/users/ardunn/orgs","repos_url":"https://api.github.com/users/ardunn/repos","events_url":"https://api.github.com/users/ardunn/events{/privacy}","received_events_url":"https://api.github.com/users/ardunn/received_events","type":"User","site_admin":false},{"login":"Qi-max","id":31199563,"node_id":"MDQ6VXNlcjMxMTk5NTYz","avatar_url":"https://avatars.githubusercontent.com/u/31199563?v=4","gravatar_id":"","url":"https://api.github.com/users/Qi-max","html_url":"https://github.com/Qi-max","followers_url":"https://api.github.com/users/Qi-max/followers","following_url":"https://api.github.com/users/Qi-max/following{/other_user}","gists_url":"https://api.github.com/users/Qi-max/gists{/gist_id}","starred_url":"https://api.github.com/users/Qi-max/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Qi-max/subscriptions","organizations_url":"https://api.github.com/users/Qi-max/orgs","repos_url":"https://api.github.com/users/Qi-max/repos","events_url":"https://api.github.com/users/Qi-max/events{/privacy}","received_events_url":"https://api.github.com/users/Qi-max/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2018-12-05T09:33:03Z","updated_at":"2018-12-11T04:31:05Z","closed_at":"2018-12-11T04:31:05Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Sometimes there can be a bad composition object passed to metaselector, and it will fail. For example, try running metaselector on the `mp_all` dataset. It will give the error:\r\n\r\n```\r\n\"Traceback (most recent call last):\\n  File \\\"/global/scratch/ardunn/python/lib/python3.7/site-packages/fireworks/core/rocket.py\\\", line 262, in run\\n    m_action = t.run_task(my_spec)\\n  File \\\"/global/scratch/ardunn/codes/hmprivate/hmprivate/automatminer/benchmarking/tasks.py\\\", line 72, in run_task\\n    predicted_test_df = pipe.benchmark(df, target, test_spec=0.2)\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/utils/package_tools.py\\\", line 76, in wrapper\\n    result = func(*args, **kwargs)\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/pipeline.py\\\", line 229, in benchmark\\n    df = self.autofeaturizer.fit_transform(df, target)\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/utils/package_tools.py\\\", line 76, in wrapper\\n    result = func(*args, **kwargs)\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/featurization/core.py\\\", line 321, in fit_transform\\n    return self.fit(df, target).transform(df, target, tidy_column=False)\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/utils/package_tools.py\\\", line 76, in wrapper\\n    result = func(*args, **kwargs)\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/featurization/core.py\\\", line 259, in fit\\n    self._customize_featurizers(df)\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/featurization/core.py\\\", line 364, in _customize_featurizers\\n    auto_exclude = self.metaselector.auto_excludes(df)\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/featurization/metaselection/core.py\\\", line 172, in auto_excludes\\n    self.dataset_mfs = dataset_metafeatures(df, **mfs_kwargs)\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/featurization/metaselection/core.py\\\", line 45, in dataset_metafeatures\\n    if mfs_func is not None else {})\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/featurization/metaselection/core.py\\\", line 63, in _composition_metafeatures\\n    mfs[mf] = mf_class.calc(df[composition_col])\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/featurization/metaselection/metafeatures.py\\\", line 171, in calc\\n    stats = composition_stats(X)\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/featurization/metaselection/metafeatures.py\\\", line 137, in composition_stats\\n    return _composition_stats(tuple(X.values))\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/featurization/metaselection/metafeatures.py\\\", line 154, in _composition_stats\\n    stats = composition_statistics(X)\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/featurization/metaselection/utils.py\\\", line 23, in composition_statistics\\n    stats[idx] = _composition_summary(composition)\\n  File \\\"/global/scratch/ardunn/codes/automatminer/automatminer/featurization/metaselection/utils.py\\\", line 81, in _composition_summary\\n    c = Composition(composition)\\n  File \\\"/global/scratch/ardunn/codes/pymatgen/pymatgen/core/composition.py\\\", line 134, in __init__\\n    elmap = dict(*args, **kwargs)\\nTypeError: 'float' object is not iterable\\n\"\r\n```\r\n\r\nWhich is basically just saying it tried to do Composition(1.24) or something (i.e., the original df had a bad value). So we need to figure out a good way to do error handling here to make sure metaselection is robust","closed_by":{"login":"ardunn","id":19936203,"node_id":"MDQ6VXNlcjE5OTM2MjAz","avatar_url":"https://avatars.githubusercontent.com/u/19936203?v=4","gravatar_id":"","url":"https://api.github.com/users/ardunn","html_url":"https://github.com/ardunn","followers_url":"https://api.github.com/users/ardunn/followers","following_url":"https://api.github.com/users/ardunn/following{/other_user}","gists_url":"https://api.github.com/users/ardunn/gists{/gist_id}","starred_url":"https://api.github.com/users/ardunn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ardunn/subscriptions","organizations_url":"https://api.github.com/users/ardunn/orgs","repos_url":"https://api.github.com/users/ardunn/repos","events_url":"https://api.github.com/users/ardunn/events{/privacy}","received_events_url":"https://api.github.com/users/ardunn/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/hackingmaterials/automatminer/issues/139/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hackingmaterials/automatminer/issues/139/timeline","performed_via_github_app":null,"state_reason":"completed"}