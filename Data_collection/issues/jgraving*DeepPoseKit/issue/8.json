{"url":"https://api.github.com/repos/jgraving/DeepPoseKit/issues/8","repository_url":"https://api.github.com/repos/jgraving/DeepPoseKit","labels_url":"https://api.github.com/repos/jgraving/DeepPoseKit/issues/8/labels{/name}","comments_url":"https://api.github.com/repos/jgraving/DeepPoseKit/issues/8/comments","events_url":"https://api.github.com/repos/jgraving/DeepPoseKit/issues/8/events","html_url":"https://github.com/jgraving/DeepPoseKit/issues/8","id":494009651,"node_id":"MDU6SXNzdWU0OTQwMDk2NTE=","number":8,"title":"Issue with Step 4: Defining model: \"local variable 'idx' referenced before assignment\"","user":{"login":"davidjamespritchard","id":46787309,"node_id":"MDQ6VXNlcjQ2Nzg3MzA5","avatar_url":"https://avatars.githubusercontent.com/u/46787309?v=4","gravatar_id":"","url":"https://api.github.com/users/davidjamespritchard","html_url":"https://github.com/davidjamespritchard","followers_url":"https://api.github.com/users/davidjamespritchard/followers","following_url":"https://api.github.com/users/davidjamespritchard/following{/other_user}","gists_url":"https://api.github.com/users/davidjamespritchard/gists{/gist_id}","starred_url":"https://api.github.com/users/davidjamespritchard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidjamespritchard/subscriptions","organizations_url":"https://api.github.com/users/davidjamespritchard/orgs","repos_url":"https://api.github.com/users/davidjamespritchard/repos","events_url":"https://api.github.com/users/davidjamespritchard/events{/privacy}","received_events_url":"https://api.github.com/users/davidjamespritchard/received_events","type":"User","site_admin":false},"labels":[{"id":1348126481,"node_id":"MDU6TGFiZWwxMzQ4MTI2NDgx","url":"https://api.github.com/repos/jgraving/DeepPoseKit/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-09-16T12:09:07Z","updated_at":"2019-09-24T15:56:12Z","closed_at":"2019-09-24T15:56:12Z","author_association":"NONE","active_lock_reason":null,"body":"Hi Jake,\r\n\r\nI am running DeepPoseKit in Colab (with GPU) using Windows 10, and everything goes smoothly up until the \"Define a model\" step in the model training notebook. \r\n\r\nWhen I run:\r\n\r\nmodel = StackedDenseNet(data_generator=train_generator, n_stacks=2)\r\nmodel.get_config()\r\n\r\nI get the error message below.\r\n\r\nI have not changed any of the code other than add code to mount google drive so I can add my annotated .h5 file.\r\n\r\nfrom google.colab import drive\r\ndrive.mount('/content/drive',force_remount=True)\r\n\r\nannotations = sorted(glob.glob('/content/drive/My Drive/*.h5'))\r\n\r\nI have tried the most release release, and still have the same issue.\r\n\r\nLet me know if there is anything I can try on my end!\r\n\r\nCheers\r\n\r\nDavid\r\n\r\n---------------------------------------------------------------------------\r\nUnboundLocalError                         Traceback (most recent call last)\r\n<ipython-input-46-efacc1a0d6e8> in <module>()\r\n----> 1 model = StackedDenseNet(data_generator=train_generator, n_stacks=2)\r\n      2 # model = DeepLabCut(train_generator)\r\n      3 # model = LEAP(train_generator)\r\n      4 # model = StackedHourglass(train_generator)\r\n      5 model.get_config()\r\n\r\n3 frames\r\n/usr/local/lib/python3.6/dist-packages/deepposekit/models/StackedDenseNet.py in __init__(self, data_generator, n_stacks, n_transitions, n_layers, growth_rate, bottleneck_factor, compression_factor, batchnorm, use_bias, activation, pooling, interpolation, subpixel, initializer, separable, squeeze_excite, **kwargs)\r\n    141         self.squeeze_excite = squeeze_excite\r\n    142         self.n_transitions = n_transitions\r\n--> 143         super(StackedDenseNet, self).__init__(data_generator, subpixel, **kwargs)\r\n    144 \r\n    145     def __init_model__(self):\r\n\r\n/usr/local/lib/python3.6/dist-packages/deepposekit/models/engine.py in __init__(self, data_generator, subpixel, **kwargs)\r\n     32         self.subpixel = subpixel\r\n     33         if self.train_model is NotImplemented and 'skip_init' not in kwargs:\r\n---> 34             self.__init_model__()\r\n     35             self.__init_train_model__()\r\n     36         if self.data_generator is not None:\r\n\r\n/usr/local/lib/python3.6/dist-packages/deepposekit/models/StackedDenseNet.py in __init_model__(self)\r\n    186                                         activation=self.activation, pooling=self.pooling, interpolation=self.interpolation, batchnorm=self.batchnorm,\r\n    187                                         use_bias=self.use_bias, separable=self.separable, squeeze_excite=self.squeeze_excite,\r\n--> 188                                         stack_idx=0, multiplier=1)([normalized])\r\n    189         outputs = [output0]\r\n    190         multiplier = self.n_transitions - self.data_generator.downsample_factor\r\n\r\n/usr/local/lib/python3.6/dist-packages/deepposekit/models/layers/densenet.py in __call__(self, inputs)\r\n    321             if self.multiplier > 1:\r\n    322                 self.multiplier -= 1\r\n--> 323         transition_diff = len(down_list) + -1 * (idx + 1)\r\n    324         for idx in range(transition_diff + 1):\r\n    325             pool_size = int(2**(transition_diff - idx))\r\n\r\nUnboundLocalError: local variable 'idx' referenced before assignment","closed_by":{"login":"jgraving","id":5445636,"node_id":"MDQ6VXNlcjU0NDU2MzY=","avatar_url":"https://avatars.githubusercontent.com/u/5445636?v=4","gravatar_id":"","url":"https://api.github.com/users/jgraving","html_url":"https://github.com/jgraving","followers_url":"https://api.github.com/users/jgraving/followers","following_url":"https://api.github.com/users/jgraving/following{/other_user}","gists_url":"https://api.github.com/users/jgraving/gists{/gist_id}","starred_url":"https://api.github.com/users/jgraving/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jgraving/subscriptions","organizations_url":"https://api.github.com/users/jgraving/orgs","repos_url":"https://api.github.com/users/jgraving/repos","events_url":"https://api.github.com/users/jgraving/events{/privacy}","received_events_url":"https://api.github.com/users/jgraving/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/jgraving/DeepPoseKit/issues/8/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/jgraving/DeepPoseKit/issues/8/timeline","performed_via_github_app":null,"state_reason":"completed"}