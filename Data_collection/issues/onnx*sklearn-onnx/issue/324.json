{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/324","repository_url":"https://api.github.com/repos/onnx/sklearn-onnx","labels_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/324/labels{/name}","comments_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/324/comments","events_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/324/events","html_url":"https://github.com/onnx/sklearn-onnx/issues/324","id":526649047,"node_id":"MDU6SXNzdWU1MjY2NDkwNDc=","number":324,"title":"Deviations between the predicted probabilities of sklearn and ONNX runtime","user":{"login":"PatrickSager","id":37688286,"node_id":"MDQ6VXNlcjM3Njg4Mjg2","avatar_url":"https://avatars.githubusercontent.com/u/37688286?v=4","gravatar_id":"","url":"https://api.github.com/users/PatrickSager","html_url":"https://github.com/PatrickSager","followers_url":"https://api.github.com/users/PatrickSager/followers","following_url":"https://api.github.com/users/PatrickSager/following{/other_user}","gists_url":"https://api.github.com/users/PatrickSager/gists{/gist_id}","starred_url":"https://api.github.com/users/PatrickSager/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PatrickSager/subscriptions","organizations_url":"https://api.github.com/users/PatrickSager/orgs","repos_url":"https://api.github.com/users/PatrickSager/repos","events_url":"https://api.github.com/users/PatrickSager/events{/privacy}","received_events_url":"https://api.github.com/users/PatrickSager/received_events","type":"User","site_admin":false},"labels":[{"id":1165979599,"node_id":"MDU6TGFiZWwxMTY1OTc5NTk5","url":"https://api.github.com/repos/onnx/sklearn-onnx/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2019-11-21T15:00:06Z","updated_at":"2019-12-09T08:08:19Z","closed_at":"2019-12-09T08:08:18Z","author_association":"NONE","active_lock_reason":null,"body":"Hi all\r\n\r\nUsing skl2onnx 1.6:\r\nI've trained an AdaBoost model on the Iris data set (once using the \"SAMME\" and once the \"SAMME.R\" algorithm).\r\nThen let the model predict the probabilities for class 1 on the testing set.\r\nI've then exported the model to ONNX, created an inference session on it, and used it to predict the same probabilities.\r\nComparing the results, I've noted the following differences between the probabilities predicted by sklearn and the probabilities predicted by ONNX runtime:\r\n- SAMME algorithm: \r\n  -- max deviation: 2.5E-7\r\n  -- average deviation: 2.9E-8\r\n- SAMME.R algorithm:\r\n  -- max deviation: 1.5E-2\r\n  -- average deviation: 7.6E-3\r\n\r\nDeviations in the area of 1E-7 seem to be expected and be based on rounding errors. \r\nHowever, deviations of about 1E-2 are in my opinion too significant to be ignored.\r\n\r\nBesides, using skl2onnx 1.5.1, I'm getting a max deviation of 4.2E-8 for \"SAMME\".\r\n(The max deviation for SAMME.R, did not change).\r\n\r\nI suspect that this might be an issue that was introduced with skl2onnx 1.5.2.\r\n\r\nAttached the example code based on the Iris data set.\r\n[simple_AdaBoost.zip](https://github.com/onnx/sklearn-onnx/files/3875288/simple_AdaBoost.zip)\r\n\r\nOne additional question: What kind of deviations in the predicted probability between sklearn and ONNX runtime do I usually have to expect and is assumed to be acceptable?\r\n\r\nThanks for any help\r\n-- Patrick","closed_by":{"login":"prabhat00155","id":7043157,"node_id":"MDQ6VXNlcjcwNDMxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/7043157?v=4","gravatar_id":"","url":"https://api.github.com/users/prabhat00155","html_url":"https://github.com/prabhat00155","followers_url":"https://api.github.com/users/prabhat00155/followers","following_url":"https://api.github.com/users/prabhat00155/following{/other_user}","gists_url":"https://api.github.com/users/prabhat00155/gists{/gist_id}","starred_url":"https://api.github.com/users/prabhat00155/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prabhat00155/subscriptions","organizations_url":"https://api.github.com/users/prabhat00155/orgs","repos_url":"https://api.github.com/users/prabhat00155/repos","events_url":"https://api.github.com/users/prabhat00155/events{/privacy}","received_events_url":"https://api.github.com/users/prabhat00155/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/324/timeline","performed_via_github_app":null,"state_reason":"completed"}