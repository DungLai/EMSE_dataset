{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/912","repository_url":"https://api.github.com/repos/onnx/sklearn-onnx","labels_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/912/labels{/name}","comments_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/912/comments","events_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/912/events","html_url":"https://github.com/onnx/sklearn-onnx/issues/912","id":1373558010,"node_id":"I_kwDOCa0gS85R3tT6","number":912,"title":"OneClassSVM conversion issue","user":{"login":"Net-Mist","id":13920346,"node_id":"MDQ6VXNlcjEzOTIwMzQ2","avatar_url":"https://avatars.githubusercontent.com/u/13920346?v=4","gravatar_id":"","url":"https://api.github.com/users/Net-Mist","html_url":"https://github.com/Net-Mist","followers_url":"https://api.github.com/users/Net-Mist/followers","following_url":"https://api.github.com/users/Net-Mist/following{/other_user}","gists_url":"https://api.github.com/users/Net-Mist/gists{/gist_id}","starred_url":"https://api.github.com/users/Net-Mist/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Net-Mist/subscriptions","organizations_url":"https://api.github.com/users/Net-Mist/orgs","repos_url":"https://api.github.com/users/Net-Mist/repos","events_url":"https://api.github.com/users/Net-Mist/events{/privacy}","received_events_url":"https://api.github.com/users/Net-Mist/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"xiaowuhu","id":19218188,"node_id":"MDQ6VXNlcjE5MjE4MTg4","avatar_url":"https://avatars.githubusercontent.com/u/19218188?v=4","gravatar_id":"","url":"https://api.github.com/users/xiaowuhu","html_url":"https://github.com/xiaowuhu","followers_url":"https://api.github.com/users/xiaowuhu/followers","following_url":"https://api.github.com/users/xiaowuhu/following{/other_user}","gists_url":"https://api.github.com/users/xiaowuhu/gists{/gist_id}","starred_url":"https://api.github.com/users/xiaowuhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiaowuhu/subscriptions","organizations_url":"https://api.github.com/users/xiaowuhu/orgs","repos_url":"https://api.github.com/users/xiaowuhu/repos","events_url":"https://api.github.com/users/xiaowuhu/events{/privacy}","received_events_url":"https://api.github.com/users/xiaowuhu/received_events","type":"User","site_admin":false},"assignees":[{"login":"xiaowuhu","id":19218188,"node_id":"MDQ6VXNlcjE5MjE4MTg4","avatar_url":"https://avatars.githubusercontent.com/u/19218188?v=4","gravatar_id":"","url":"https://api.github.com/users/xiaowuhu","html_url":"https://github.com/xiaowuhu","followers_url":"https://api.github.com/users/xiaowuhu/followers","following_url":"https://api.github.com/users/xiaowuhu/following{/other_user}","gists_url":"https://api.github.com/users/xiaowuhu/gists{/gist_id}","starred_url":"https://api.github.com/users/xiaowuhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiaowuhu/subscriptions","organizations_url":"https://api.github.com/users/xiaowuhu/orgs","repos_url":"https://api.github.com/users/xiaowuhu/repos","events_url":"https://api.github.com/users/xiaowuhu/events{/privacy}","received_events_url":"https://api.github.com/users/xiaowuhu/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2022-09-14T20:38:25Z","updated_at":"2022-09-26T07:03:40Z","closed_at":"2022-09-25T07:12:08Z","author_association":"NONE","active_lock_reason":null,"body":"Hello !\r\n\r\nI have a OneClassSVM model from behave completely differently in sklearn or in onnx after conversion. \r\n\r\nI'm using : \r\npython 3.10.6\r\nscikit-learn==1.1.2\r\nskl2onnx==1.12\r\nonnxruntime==1.12.1\r\non a ubuntu 22.04\r\n\r\nThe problem can be reproduced with this code snippet : \r\n\r\n```python\r\nimport numpy as np\r\nimport onnxruntime as rt\r\nimport skl2onnx\r\nfrom skl2onnx.common.data_types import FloatTensorType\r\nfrom sklearn.datasets import load_iris\r\nfrom sklearn.svm import OneClassSVM\r\n\r\nnumpy_type = np.float32\r\nonnx_type = FloatTensorType\r\n\r\nX, y = load_iris(return_X_y=True)\r\nmodel = OneClassSVM(gamma=\"auto\", kernel=\"linear\", nu=0.01, tol=0.001)\r\nmodel.fit(X.astype(numpy_type), y)\r\nprint(model.score_samples(X[:2, :].astype(numpy_type)))\r\n\r\n# Convert into ONNX format\r\ninitial_type = [(\"input\", onnx_type([2, X.shape[1]]))]\r\nonx = skl2onnx.convert_sklearn(model, initial_types=initial_type)\r\nwith open(\"model.onnx\", \"wb\") as f:\r\n    f.write(onx.SerializeToString())\r\n\r\n# Compute the prediction with ONNX Runtime\r\nsess = rt.InferenceSession(\"model.onnx\")\r\n\r\ninput_name = sess.get_inputs()[0].name\r\nlabel_name = sess.get_outputs()[0].name\r\nscores_name = sess.get_outputs()[1].name\r\n\r\npred_onx = sess.run([label_name, scores_name], {input_name: X[:2, :].astype(numpy_type)})\r\n\r\nprint(pred_onx[1])\r\n```\r\n\r\nsklearn outputs `[49.87499932 46.64500059]`\r\nonnx outputs `[[7.8100014], [4.580002 ]]`\r\n\r\nthe label_name output is also very different than sklearn.\r\n\r\nIs it a bug in my code or in onnx ?","closed_by":{"login":"xiaowuhu","id":19218188,"node_id":"MDQ6VXNlcjE5MjE4MTg4","avatar_url":"https://avatars.githubusercontent.com/u/19218188?v=4","gravatar_id":"","url":"https://api.github.com/users/xiaowuhu","html_url":"https://github.com/xiaowuhu","followers_url":"https://api.github.com/users/xiaowuhu/followers","following_url":"https://api.github.com/users/xiaowuhu/following{/other_user}","gists_url":"https://api.github.com/users/xiaowuhu/gists{/gist_id}","starred_url":"https://api.github.com/users/xiaowuhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiaowuhu/subscriptions","organizations_url":"https://api.github.com/users/xiaowuhu/orgs","repos_url":"https://api.github.com/users/xiaowuhu/repos","events_url":"https://api.github.com/users/xiaowuhu/events{/privacy}","received_events_url":"https://api.github.com/users/xiaowuhu/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/912/timeline","performed_via_github_app":null,"state_reason":"completed"}