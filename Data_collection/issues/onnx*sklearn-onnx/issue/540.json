{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/540","repository_url":"https://api.github.com/repos/onnx/sklearn-onnx","labels_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/540/labels{/name}","comments_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/540/comments","events_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/540/events","html_url":"https://github.com/onnx/sklearn-onnx/issues/540","id":710259296,"node_id":"MDU6SXNzdWU3MTAyNTkyOTY=","number":540,"title":"GradientBoostingClassifier conversion broken (numpy.bool_)","user":{"login":"xmaayy","id":21166352,"node_id":"MDQ6VXNlcjIxMTY2MzUy","avatar_url":"https://avatars.githubusercontent.com/u/21166352?v=4","gravatar_id":"","url":"https://api.github.com/users/xmaayy","html_url":"https://github.com/xmaayy","followers_url":"https://api.github.com/users/xmaayy/followers","following_url":"https://api.github.com/users/xmaayy/following{/other_user}","gists_url":"https://api.github.com/users/xmaayy/gists{/gist_id}","starred_url":"https://api.github.com/users/xmaayy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xmaayy/subscriptions","organizations_url":"https://api.github.com/users/xmaayy/orgs","repos_url":"https://api.github.com/users/xmaayy/repos","events_url":"https://api.github.com/users/xmaayy/events{/privacy}","received_events_url":"https://api.github.com/users/xmaayy/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-09-28T13:20:13Z","updated_at":"2021-08-19T11:59:54Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"The following script leads to a model conversion error.\r\n``` python\r\n    # Create the classifier and fit it to the data\r\n    clf = GradientBoostingClassifier(\r\n        learning_rate=0.1, n_estimators=100, random_state=42, max_depth=6\r\n    )\r\n    x_train = df_train[\r\n        [\"feature1\", \"feature2\", \"feature3\", \"feature4\"]\r\n    ].values.tolist()\r\n    # x_train example : [0.13402061855670105, 0.0, 0.0, 0.3375]\r\n    # y_train example: [False]\r\n    y_train = df_train[\"is_correct_prediction\"]\r\n    input_size = len(x_train[1])\r\n    clf.fit(x_train, y_train)\r\n    initial_type = [('float_input', FloatTensorType([None, input_size]))]\r\n    onx = convert_sklearn(clf, initial_types=initial_type)\r\n```\r\n\r\nError:\r\n``` python\r\n  File \"create_random_forest_classifer.py\", line 160, in main\r\n    onx = convert_sklearn(clf, initial_types=initial_type)\r\n  File \"/home/xander/.py3-env/lib64/python3.7/site-packages/skl2onnx/convert.py\", line 153, in convert_sklearn\r\n    final_types=final_types)\r\n  File \"/home/xander/.py3-env/lib64/python3.7/site-packages/skl2onnx/_parse.py\", line 593, in parse_sklearn_model\r\n    final_types=final_types)\r\n  File \"/home/xander/.py3-env/lib64/python3.7/site-packages/skl2onnx/_parse.py\", line 500, in parse_sklearn\r\n    final_types=final_types)\r\n  File \"/home/xander/.py3-env/lib64/python3.7/site-packages/skl2onnx/_parse.py\", line 455, in _parse_sklearn\r\n    custom_parsers=custom_parsers)\r\n  File \"/home/xander/.py3-env/lib64/python3.7/site-packages/skl2onnx/_parse.py\", line 365, in _parse_sklearn_classifier\r\n    classes = np.array([s.encode('utf-8') for s in classes])\r\n  File \"/home/xander/.py3-env/lib64/python3.7/site-packages/skl2onnx/_parse.py\", line 365, in <listcomp>\r\n    classes = np.array([s.encode('utf-8') for s in classes])\r\nAttributeError: 'numpy.bool_' object has no attribute 'encode'\r\n```","closed_by":null,"reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/540/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/540/timeline","performed_via_github_app":null,"state_reason":null}