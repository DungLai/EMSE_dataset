{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/534","repository_url":"https://api.github.com/repos/onnx/sklearn-onnx","labels_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/534/labels{/name}","comments_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/534/comments","events_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/534/events","html_url":"https://github.com/onnx/sklearn-onnx/issues/534","id":703745863,"node_id":"MDU6SXNzdWU3MDM3NDU4NjM=","number":534,"title":"Conversion of classifier with boolean output produces AttributeError: 'numpy.bool_' object has no attribute 'encode' ","user":{"login":"OlivierLoison","id":40994856,"node_id":"MDQ6VXNlcjQwOTk0ODU2","avatar_url":"https://avatars.githubusercontent.com/u/40994856?v=4","gravatar_id":"","url":"https://api.github.com/users/OlivierLoison","html_url":"https://github.com/OlivierLoison","followers_url":"https://api.github.com/users/OlivierLoison/followers","following_url":"https://api.github.com/users/OlivierLoison/following{/other_user}","gists_url":"https://api.github.com/users/OlivierLoison/gists{/gist_id}","starred_url":"https://api.github.com/users/OlivierLoison/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OlivierLoison/subscriptions","organizations_url":"https://api.github.com/users/OlivierLoison/orgs","repos_url":"https://api.github.com/users/OlivierLoison/repos","events_url":"https://api.github.com/users/OlivierLoison/events{/privacy}","received_events_url":"https://api.github.com/users/OlivierLoison/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-09-17T16:41:55Z","updated_at":"2020-09-17T17:28:12Z","closed_at":"2020-09-17T17:28:12Z","author_association":"NONE","active_lock_reason":null,"body":"Hello,\r\n\r\nI got this issue when I tried to convert a LogisticRegression model with a boolean in output: \r\n\r\nfrom sklearn.datasets import load_iris\r\nfrom sklearn.linear_model import LogisticRegression\r\nfrom skl2onnx import convert_sklearn\r\nfrom skl2onnx.common.data_types import FloatTensorType\r\n\r\niris = load_iris()\r\nX, y = iris.data, iris.target\r\nclr = LogisticRegression()\r\nclr.fit(X, y==0)\r\nX_train.shape\r\n\r\ninitial_type = [('float_input', FloatTensorType([None, 4]))]\r\nonx = convert_sklearn(clr, initial_types=initial_type)\r\nwith open(\"rf_iris.onnx\", \"wb\") as f:\r\n    f.write(onx.SerializeToString())\r\n\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-26-c8af288be6e9> in <module>\r\n     11 \r\n     12 initial_type = [('float_input', FloatTensorType([None, 4]))]\r\n---> 13 onx = convert_sklearn(clr, initial_types=initial_type)\r\n     14 with open(\"rf_iris.onnx\", \"wb\") as f:\r\n     15     f.write(onx.SerializeToString())\r\n\r\n~/anaconda3/envs/sdk_like_2/lib/python3.6/site-packages/skl2onnx/convert.py in convert_sklearn(model, name, initial_types, doc_string, target_opset, custom_conversion_functions, custom_shape_calculators, custom_parsers, options, dtype, intermediate, white_op, black_op, final_types)\r\n    145         custom_shape_calculators, custom_parsers, options=options,\r\n    146         dtype=dtype, white_op=white_op, black_op=black_op,\r\n--> 147         final_types=final_types)\r\n    148 \r\n    149     # Infer variable shapes\r\n\r\n~/anaconda3/envs/sdk_like_2/lib/python3.6/site-packages/skl2onnx/_parse.py in parse_sklearn_model(model, initial_types, target_opset, custom_conversion_functions, custom_shape_calculators, custom_parsers, dtype, options, white_op, black_op, final_types)\r\n    523     outputs = parse_sklearn(scope, model, inputs,\r\n    524                             custom_parsers=custom_parsers,\r\n--> 525                             final_types=final_types)\r\n    526 \r\n    527     # The object raw_model_container is a part of the topology we're\r\n\r\n~/anaconda3/envs/sdk_like_2/lib/python3.6/site-packages/skl2onnx/_parse.py in parse_sklearn(scope, model, inputs, custom_parsers, final_types)\r\n    441     elif tmodel in sklearn_parsers_map:\r\n    442         outputs = sklearn_parsers_map[tmodel](scope, model, inputs,\r\n--> 443                                               custom_parsers=custom_parsers)\r\n    444     elif isinstance(model, pipeline.Pipeline):\r\n    445         parser = sklearn_parsers_map[pipeline.Pipeline]\r\n\r\n~/anaconda3/envs/sdk_like_2/lib/python3.6/site-packages/skl2onnx/_parse.py in _parse_sklearn_classifier(scope, model, inputs, custom_parsers)\r\n    355         this_operator.classlabels_int64s = classes\r\n    356     else:\r\n--> 357         classes = np.array([s.encode('utf-8') for s in classes])\r\n    358         this_operator.classlabels_strings = classes\r\n    359         label_type = StringTensorType([None])\r\n\r\n~/anaconda3/envs/sdk_like_2/lib/python3.6/site-packages/skl2onnx/_parse.py in <listcomp>(.0)\r\n    355         this_operator.classlabels_int64s = classes\r\n    356     else:\r\n--> 357         classes = np.array([s.encode('utf-8') for s in classes])\r\n    358         this_operator.classlabels_strings = classes\r\n    359         label_type = StringTensorType([None])\r\n\r\nAttributeError: 'numpy.bool_' object has no attribute 'encode'","closed_by":{"login":"OlivierLoison","id":40994856,"node_id":"MDQ6VXNlcjQwOTk0ODU2","avatar_url":"https://avatars.githubusercontent.com/u/40994856?v=4","gravatar_id":"","url":"https://api.github.com/users/OlivierLoison","html_url":"https://github.com/OlivierLoison","followers_url":"https://api.github.com/users/OlivierLoison/followers","following_url":"https://api.github.com/users/OlivierLoison/following{/other_user}","gists_url":"https://api.github.com/users/OlivierLoison/gists{/gist_id}","starred_url":"https://api.github.com/users/OlivierLoison/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OlivierLoison/subscriptions","organizations_url":"https://api.github.com/users/OlivierLoison/orgs","repos_url":"https://api.github.com/users/OlivierLoison/repos","events_url":"https://api.github.com/users/OlivierLoison/events{/privacy}","received_events_url":"https://api.github.com/users/OlivierLoison/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/534/timeline","performed_via_github_app":null,"state_reason":"completed"}