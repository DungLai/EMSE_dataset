{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/462","repository_url":"https://api.github.com/repos/onnx/sklearn-onnx","labels_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/462/labels{/name}","comments_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/462/comments","events_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/462/events","html_url":"https://github.com/onnx/sklearn-onnx/issues/462","id":618029001,"node_id":"MDU6SXNzdWU2MTgwMjkwMDE=","number":462,"title":"Possible bug in convert_sklearn_array_feature_extractor(), operator.inputs not reshaped","user":{"login":"ubomuc","id":65332226,"node_id":"MDQ6VXNlcjY1MzMyMjI2","avatar_url":"https://avatars.githubusercontent.com/u/65332226?v=4","gravatar_id":"","url":"https://api.github.com/users/ubomuc","html_url":"https://github.com/ubomuc","followers_url":"https://api.github.com/users/ubomuc/followers","following_url":"https://api.github.com/users/ubomuc/following{/other_user}","gists_url":"https://api.github.com/users/ubomuc/gists{/gist_id}","starred_url":"https://api.github.com/users/ubomuc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ubomuc/subscriptions","organizations_url":"https://api.github.com/users/ubomuc/orgs","repos_url":"https://api.github.com/users/ubomuc/repos","events_url":"https://api.github.com/users/ubomuc/events{/privacy}","received_events_url":"https://api.github.com/users/ubomuc/received_events","type":"User","site_admin":false},"labels":[{"id":1165979599,"node_id":"MDU6TGFiZWwxMTY1OTc5NTk5","url":"https://api.github.com/repos/onnx/sklearn-onnx/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-05-14T08:25:23Z","updated_at":"2020-06-01T23:39:12Z","closed_at":"2020-06-01T23:39:12Z","author_association":"NONE","active_lock_reason":null,"body":"Hi, \r\nbefore the issue report: skl2onnx is just great, so much better than pickling sklearn models.\r\n\r\n/Users/XXXX/.conda/envs/cfserver/lib/python3.7/site-packages/sklearn/mixture/gaussian_mixture.py:366: RuntimeWarning: divide by zero encountered in log n_components, -1)[:, ::n_features + 1]), 1)) \r\ncame up when I converted a pipeline. The resulting onnx model does not work properly and returns '0' as prediction results. I think it is caused when converting a ColumnTransformer in a \r\npipeline because convert_sklearn_array_feature_extractor() does not reshape the inputs variable size as in other converters. \r\n\r\nI'm by no means an onnx expert but tried to dig through the code and attached an explanation of what I think happens and a code snippet that in essence replicates the issue.\r\n\r\nCheers\r\n\r\n[column_transformer_bug.txt](https://github.com/onnx/sklearn-onnx/files/4626917/column_transformer_bug.txt)\r\n[column_transformer_snippet_py.txt](https://github.com/onnx/sklearn-onnx/files/4626918/column_transformer_snippet_py.txt)\r\n","closed_by":{"login":"xadupre","id":22452781,"node_id":"MDQ6VXNlcjIyNDUyNzgx","avatar_url":"https://avatars.githubusercontent.com/u/22452781?v=4","gravatar_id":"","url":"https://api.github.com/users/xadupre","html_url":"https://github.com/xadupre","followers_url":"https://api.github.com/users/xadupre/followers","following_url":"https://api.github.com/users/xadupre/following{/other_user}","gists_url":"https://api.github.com/users/xadupre/gists{/gist_id}","starred_url":"https://api.github.com/users/xadupre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xadupre/subscriptions","organizations_url":"https://api.github.com/users/xadupre/orgs","repos_url":"https://api.github.com/users/xadupre/repos","events_url":"https://api.github.com/users/xadupre/events{/privacy}","received_events_url":"https://api.github.com/users/xadupre/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/462/timeline","performed_via_github_app":null,"state_reason":"completed"}