{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/806","repository_url":"https://api.github.com/repos/onnx/sklearn-onnx","labels_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/806/labels{/name}","comments_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/806/comments","events_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/806/events","html_url":"https://github.com/onnx/sklearn-onnx/issues/806","id":1090461178,"node_id":"I_kwDOCa0gS85A_x36","number":806,"title":"Conversion fails with supported type of DictVectorizer","user":{"login":"dafajon","id":25409216,"node_id":"MDQ6VXNlcjI1NDA5MjE2","avatar_url":"https://avatars.githubusercontent.com/u/25409216?v=4","gravatar_id":"","url":"https://api.github.com/users/dafajon","html_url":"https://github.com/dafajon","followers_url":"https://api.github.com/users/dafajon/followers","following_url":"https://api.github.com/users/dafajon/following{/other_user}","gists_url":"https://api.github.com/users/dafajon/gists{/gist_id}","starred_url":"https://api.github.com/users/dafajon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dafajon/subscriptions","organizations_url":"https://api.github.com/users/dafajon/orgs","repos_url":"https://api.github.com/users/dafajon/repos","events_url":"https://api.github.com/users/dafajon/events{/privacy}","received_events_url":"https://api.github.com/users/dafajon/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2021-12-29T11:38:07Z","updated_at":"2022-01-10T09:44:38Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"### Bug\r\n\r\nI wanted to try conversion with various supported mappings on the DictVectorizer [spec](https://github.com/onnx/onnx/blob/master/docs/Operators-ml.md#aionnxmldictvectorizer). Appearently there is support of `map(int64, string)`. However the conversion fails.\r\n\r\n### Code \r\n\r\n```python\r\n_, y = make_classification(n_samples=5, n_classes=2)\r\n\r\nX = [{0: \"triangle\", 3:\"europe\"},\r\n     {1: \"horror\", 2: \"rock\"},\r\n     {0: \"circle\", 1: \"comedy\", 2: \"pop\", 3: \"asia\"},\r\n     {1: \"action\", 2: \"rap\", 3: \"australia\"},\r\n     {2: \"rock\"}]\r\n\r\npipeline = Pipeline([(\"dvec\", DictVectorizer()),\r\n                     (\"lorgreg\", LogisticRegression(C=0.123))])\r\n\r\ninitial_type = [('dvec_inp', DictionaryType(Int64Type(), StringTensorType()))]\r\nonx = convert_sklearn(pipeline, initial_types=initial_type)\r\nwith open(f\"mdl.onnx\", \"wb\") as f:\r\n    f.write(onx.SerializeToString())\r\n\r\n```\r\n\r\n### Output\r\n`RuntimeError: All categories contain a separator '='. This case is not supported by the converter. The mapping must map to numbers not string.\r\n`\r\n\r\n### System\r\n\r\nSystem information\r\n\r\nOS Platform and Distribution: MacOS 10.14.2\r\nONNX Runtime installed from (source or binary): PyPI 1.10.0\r\nONNX Runtime version: 1.10.0\r\nPython version: 3.8.12\r\nVisual Studio version (if applicable): None\r\nGCC/Compiler version (if compiling from source): None\r\nCUDA/cuDNN version: None\r\nGPU model and memory: None\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/806/timeline","performed_via_github_app":null,"state_reason":null}