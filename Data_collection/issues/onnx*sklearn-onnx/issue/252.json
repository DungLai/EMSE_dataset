{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/252","repository_url":"https://api.github.com/repos/onnx/sklearn-onnx","labels_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/252/labels{/name}","comments_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/252/comments","events_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/252/events","html_url":"https://github.com/onnx/sklearn-onnx/issues/252","id":492391324,"node_id":"MDU6SXNzdWU0OTIzOTEzMjQ=","number":252,"title":"Convert MultinomialNB Model to ONNX Prediction Error","user":{"login":"ikestevens","id":12886679,"node_id":"MDQ6VXNlcjEyODg2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/12886679?v=4","gravatar_id":"","url":"https://api.github.com/users/ikestevens","html_url":"https://github.com/ikestevens","followers_url":"https://api.github.com/users/ikestevens/followers","following_url":"https://api.github.com/users/ikestevens/following{/other_user}","gists_url":"https://api.github.com/users/ikestevens/gists{/gist_id}","starred_url":"https://api.github.com/users/ikestevens/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ikestevens/subscriptions","organizations_url":"https://api.github.com/users/ikestevens/orgs","repos_url":"https://api.github.com/users/ikestevens/repos","events_url":"https://api.github.com/users/ikestevens/events{/privacy}","received_events_url":"https://api.github.com/users/ikestevens/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-09-11T18:16:03Z","updated_at":"2019-09-13T20:15:36Z","closed_at":"2019-09-12T18:46:16Z","author_association":"NONE","active_lock_reason":null,"body":"When converting a MultinomialNB model to ONNX, I'm able to convert the model, but when trying to get a prediction, I get the error:\r\n\r\n**Method run failed due to: [ONNXRuntimeError] : 1 : GENERAL ERROR : Non-zero status code returned while running No de: MatMul Status Message: Not satsified: K_ == right_shape[right_num_dims - 2] matmul_helper.h:38 onnxruntime::MatMulComputeHelper::ComputeMatMul dimension mismatch**\r\n\r\nThe dimension of the FloatTensorType is correct, because if I change it, I get a different error (about incompatible dimensions for matrix multiplication). If I use my same data with a LinearSVC model, the prediction works fine. Also, when I create a small dummy model (7 samples, 5 features) the MultinomialNB model works fine (I get a prediction).\r\n\r\nI've compared the inputs (train_X, train_y) of both the dummy MultinomialNB and my model, and they are both sparse matrix in csr (train X). So I'm not sure why one works fine, and the other does not. My model has 10,000 features and 10 million samples. I've also made a medium size model with 1000 samples and 20 features and that one doesn't work either.\r\n\r\n","closed_by":{"login":"ikestevens","id":12886679,"node_id":"MDQ6VXNlcjEyODg2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/12886679?v=4","gravatar_id":"","url":"https://api.github.com/users/ikestevens","html_url":"https://github.com/ikestevens","followers_url":"https://api.github.com/users/ikestevens/followers","following_url":"https://api.github.com/users/ikestevens/following{/other_user}","gists_url":"https://api.github.com/users/ikestevens/gists{/gist_id}","starred_url":"https://api.github.com/users/ikestevens/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ikestevens/subscriptions","organizations_url":"https://api.github.com/users/ikestevens/orgs","repos_url":"https://api.github.com/users/ikestevens/repos","events_url":"https://api.github.com/users/ikestevens/events{/privacy}","received_events_url":"https://api.github.com/users/ikestevens/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/252/timeline","performed_via_github_app":null,"state_reason":"completed"}