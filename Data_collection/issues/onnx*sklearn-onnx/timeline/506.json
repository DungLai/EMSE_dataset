[{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/654654290","html_url":"https://github.com/onnx/sklearn-onnx/issues/506#issuecomment-654654290","issue_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/506","id":654654290,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NDY1NDI5MA==","user":{"login":"hanzigs","id":30790120,"node_id":"MDQ6VXNlcjMwNzkwMTIw","avatar_url":"https://avatars.githubusercontent.com/u/30790120?v=4","gravatar_id":"","url":"https://api.github.com/users/hanzigs","html_url":"https://github.com/hanzigs","followers_url":"https://api.github.com/users/hanzigs/followers","following_url":"https://api.github.com/users/hanzigs/following{/other_user}","gists_url":"https://api.github.com/users/hanzigs/gists{/gist_id}","starred_url":"https://api.github.com/users/hanzigs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanzigs/subscriptions","organizations_url":"https://api.github.com/users/hanzigs/orgs","repos_url":"https://api.github.com/users/hanzigs/repos","events_url":"https://api.github.com/users/hanzigs/events{/privacy}","received_events_url":"https://api.github.com/users/hanzigs/received_events","type":"User","site_admin":false},"created_at":"2020-07-07T07:26:35Z","updated_at":"2020-07-07T07:27:11Z","author_association":"NONE","body":"I have a somewhat like issue, but I am not sure how to extract the probability values,\r\nI have sklearn RandomForestClassifier\r\n```\r\ninitial_type = [('float_input', FloatTensorType([None, 21]))]\r\nRFOnnx_model = skl2onnx.convert_sklearn(RF_model, initial_types=initial_type)\r\ncontent = RFOnnx_model.SerializeToString()\r\nsess = onnxruntime.InferenceSession(content)\r\ninput_name = sess.get_inputs()[0].name\r\nlabel_name = sess.get_outputs()[0].name\r\npayload = [[6.23825461e-01,-1.26414939e-02,-2.98698634e-01,7.49970172e-01,9.77326200e-02,1.70205380e-02,2.48707775e+00,2.07501365e+00,2.70571484e-01,2.41767187e+00,4.42420606e-01,-5.39277508e-01,-7.73496115e-02,2.77599946e-01,-2.68517817e-02,2.72781908e-01,2.22730821e+00,8.44443394e-01,-5.75698893e-02,-3.34715704e-01,1.09698389e-01]]\r\npred_onnx = sess.run([label_name], {input_name: payload})[0]\r\npred_onnx[0]\r\n```\r\nthis returns 1, but if I do with regular model predict_proba\r\n```\r\ndf = pandas.DataFrame(data=payload,columns=cols)\r\nRF_model.predict_proba(df.values)\r\n```\r\nI get\r\n```\r\narray([[0.02219565, 0.97780435]])\r\n```\r\nmay I know how to extract the probability values from onnx model","reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/654654290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hanzigs","id":30790120,"node_id":"MDQ6VXNlcjMwNzkwMTIw","avatar_url":"https://avatars.githubusercontent.com/u/30790120?v=4","gravatar_id":"","url":"https://api.github.com/users/hanzigs","html_url":"https://github.com/hanzigs","followers_url":"https://api.github.com/users/hanzigs/followers","following_url":"https://api.github.com/users/hanzigs/following{/other_user}","gists_url":"https://api.github.com/users/hanzigs/gists{/gist_id}","starred_url":"https://api.github.com/users/hanzigs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanzigs/subscriptions","organizations_url":"https://api.github.com/users/hanzigs/orgs","repos_url":"https://api.github.com/users/hanzigs/repos","events_url":"https://api.github.com/users/hanzigs/events{/privacy}","received_events_url":"https://api.github.com/users/hanzigs/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/654709826","html_url":"https://github.com/onnx/sklearn-onnx/issues/506#issuecomment-654709826","issue_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/506","id":654709826,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NDcwOTgyNg==","user":{"login":"siddharth98765","id":34968251,"node_id":"MDQ6VXNlcjM0OTY4MjUx","avatar_url":"https://avatars.githubusercontent.com/u/34968251?v=4","gravatar_id":"","url":"https://api.github.com/users/siddharth98765","html_url":"https://github.com/siddharth98765","followers_url":"https://api.github.com/users/siddharth98765/followers","following_url":"https://api.github.com/users/siddharth98765/following{/other_user}","gists_url":"https://api.github.com/users/siddharth98765/gists{/gist_id}","starred_url":"https://api.github.com/users/siddharth98765/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/siddharth98765/subscriptions","organizations_url":"https://api.github.com/users/siddharth98765/orgs","repos_url":"https://api.github.com/users/siddharth98765/repos","events_url":"https://api.github.com/users/siddharth98765/events{/privacy}","received_events_url":"https://api.github.com/users/siddharth98765/received_events","type":"User","site_admin":false},"created_at":"2020-07-07T09:04:59Z","updated_at":"2020-07-07T09:04:59Z","author_association":"NONE","body":"> I have a somewhat like issue, but I am not sure how to extract the probability values,\r\n> I have sklearn RandomForestClassifier\r\n> \r\n> ```\r\n> initial_type = [('float_input', FloatTensorType([None, 21]))]\r\n> RFOnnx_model = skl2onnx.convert_sklearn(RF_model, initial_types=initial_type)\r\n> content = RFOnnx_model.SerializeToString()\r\n> sess = onnxruntime.InferenceSession(content)\r\n> input_name = sess.get_inputs()[0].name\r\n> label_name = sess.get_outputs()[0].name\r\n> payload = [[6.23825461e-01,-1.26414939e-02,-2.98698634e-01,7.49970172e-01,9.77326200e-02,1.70205380e-02,2.48707775e+00,2.07501365e+00,2.70571484e-01,2.41767187e+00,4.42420606e-01,-5.39277508e-01,-7.73496115e-02,2.77599946e-01,-2.68517817e-02,2.72781908e-01,2.22730821e+00,8.44443394e-01,-5.75698893e-02,-3.34715704e-01,1.09698389e-01]]\r\n> pred_onnx = sess.run([label_name], {input_name: payload})[0]\r\n> pred_onnx[0]\r\n> ```\r\n> \r\n> this returns 1, but if I do with regular model predict_proba\r\n> \r\n> ```\r\n> df = pandas.DataFrame(data=payload,columns=cols)\r\n> RF_model.predict_proba(df.values)\r\n> ```\r\n> \r\n> I get\r\n> \r\n> ```\r\n> array([[0.02219565, 0.97780435]])\r\n> ```\r\n> \r\n> may I know how to extract the probability values from onnx model\r\n\r\n@hanzigs check pred_onnx[1] you might get what you want\r\n\r\n","reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/654709826/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"siddharth98765","id":34968251,"node_id":"MDQ6VXNlcjM0OTY4MjUx","avatar_url":"https://avatars.githubusercontent.com/u/34968251?v=4","gravatar_id":"","url":"https://api.github.com/users/siddharth98765","html_url":"https://github.com/siddharth98765","followers_url":"https://api.github.com/users/siddharth98765/followers","following_url":"https://api.github.com/users/siddharth98765/following{/other_user}","gists_url":"https://api.github.com/users/siddharth98765/gists{/gist_id}","starred_url":"https://api.github.com/users/siddharth98765/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/siddharth98765/subscriptions","organizations_url":"https://api.github.com/users/siddharth98765/orgs","repos_url":"https://api.github.com/users/siddharth98765/repos","events_url":"https://api.github.com/users/siddharth98765/events{/privacy}","received_events_url":"https://api.github.com/users/siddharth98765/received_events","type":"User","site_admin":false}},{"id":3519405657,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzUxOTQwNTY1Nw==","url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/events/3519405657","actor":{"login":"hanzigs","id":30790120,"node_id":"MDQ6VXNlcjMwNzkwMTIw","avatar_url":"https://avatars.githubusercontent.com/u/30790120?v=4","gravatar_id":"","url":"https://api.github.com/users/hanzigs","html_url":"https://github.com/hanzigs","followers_url":"https://api.github.com/users/hanzigs/followers","following_url":"https://api.github.com/users/hanzigs/following{/other_user}","gists_url":"https://api.github.com/users/hanzigs/gists{/gist_id}","starred_url":"https://api.github.com/users/hanzigs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanzigs/subscriptions","organizations_url":"https://api.github.com/users/hanzigs/orgs","repos_url":"https://api.github.com/users/hanzigs/repos","events_url":"https://api.github.com/users/hanzigs/events{/privacy}","received_events_url":"https://api.github.com/users/hanzigs/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-07-07T09:04:59Z","performed_via_github_app":null},{"id":3519405661,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM1MTk0MDU2NjE=","url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/events/3519405661","actor":{"login":"hanzigs","id":30790120,"node_id":"MDQ6VXNlcjMwNzkwMTIw","avatar_url":"https://avatars.githubusercontent.com/u/30790120?v=4","gravatar_id":"","url":"https://api.github.com/users/hanzigs","html_url":"https://github.com/hanzigs","followers_url":"https://api.github.com/users/hanzigs/followers","following_url":"https://api.github.com/users/hanzigs/following{/other_user}","gists_url":"https://api.github.com/users/hanzigs/gists{/gist_id}","starred_url":"https://api.github.com/users/hanzigs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanzigs/subscriptions","organizations_url":"https://api.github.com/users/hanzigs/orgs","repos_url":"https://api.github.com/users/hanzigs/repos","events_url":"https://api.github.com/users/hanzigs/events{/privacy}","received_events_url":"https://api.github.com/users/hanzigs/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-07-07T09:04:59Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/654741014","html_url":"https://github.com/onnx/sklearn-onnx/issues/506#issuecomment-654741014","issue_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/506","id":654741014,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NDc0MTAxNA==","user":{"login":"hanzigs","id":30790120,"node_id":"MDQ6VXNlcjMwNzkwMTIw","avatar_url":"https://avatars.githubusercontent.com/u/30790120?v=4","gravatar_id":"","url":"https://api.github.com/users/hanzigs","html_url":"https://github.com/hanzigs","followers_url":"https://api.github.com/users/hanzigs/followers","following_url":"https://api.github.com/users/hanzigs/following{/other_user}","gists_url":"https://api.github.com/users/hanzigs/gists{/gist_id}","starred_url":"https://api.github.com/users/hanzigs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanzigs/subscriptions","organizations_url":"https://api.github.com/users/hanzigs/orgs","repos_url":"https://api.github.com/users/hanzigs/repos","events_url":"https://api.github.com/users/hanzigs/events{/privacy}","received_events_url":"https://api.github.com/users/hanzigs/received_events","type":"User","site_admin":false},"created_at":"2020-07-07T09:56:52Z","updated_at":"2020-07-07T09:57:09Z","author_association":"NONE","body":"pred_onnx[1] is IndexError: index 1 is out of bounds for axis 0 with size 1","reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/654741014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hanzigs","id":30790120,"node_id":"MDQ6VXNlcjMwNzkwMTIw","avatar_url":"https://avatars.githubusercontent.com/u/30790120?v=4","gravatar_id":"","url":"https://api.github.com/users/hanzigs","html_url":"https://github.com/hanzigs","followers_url":"https://api.github.com/users/hanzigs/followers","following_url":"https://api.github.com/users/hanzigs/following{/other_user}","gists_url":"https://api.github.com/users/hanzigs/gists{/gist_id}","starred_url":"https://api.github.com/users/hanzigs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanzigs/subscriptions","organizations_url":"https://api.github.com/users/hanzigs/orgs","repos_url":"https://api.github.com/users/hanzigs/repos","events_url":"https://api.github.com/users/hanzigs/events{/privacy}","received_events_url":"https://api.github.com/users/hanzigs/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/654751215","html_url":"https://github.com/onnx/sklearn-onnx/issues/506#issuecomment-654751215","issue_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/506","id":654751215,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NDc1MTIxNQ==","user":{"login":"Karnav123","id":36244620,"node_id":"MDQ6VXNlcjM2MjQ0NjIw","avatar_url":"https://avatars.githubusercontent.com/u/36244620?v=4","gravatar_id":"","url":"https://api.github.com/users/Karnav123","html_url":"https://github.com/Karnav123","followers_url":"https://api.github.com/users/Karnav123/followers","following_url":"https://api.github.com/users/Karnav123/following{/other_user}","gists_url":"https://api.github.com/users/Karnav123/gists{/gist_id}","starred_url":"https://api.github.com/users/Karnav123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Karnav123/subscriptions","organizations_url":"https://api.github.com/users/Karnav123/orgs","repos_url":"https://api.github.com/users/Karnav123/repos","events_url":"https://api.github.com/users/Karnav123/events{/privacy}","received_events_url":"https://api.github.com/users/Karnav123/received_events","type":"User","site_admin":false},"created_at":"2020-07-07T10:14:39Z","updated_at":"2020-07-07T10:14:39Z","author_association":"NONE","body":"> pred_onnx[1] is IndexError: index 1 is out of bounds for axis 0 with size 1\r\n\r\nCheck the size of the output node and then try to find it.","reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/654751215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Karnav123","id":36244620,"node_id":"MDQ6VXNlcjM2MjQ0NjIw","avatar_url":"https://avatars.githubusercontent.com/u/36244620?v=4","gravatar_id":"","url":"https://api.github.com/users/Karnav123","html_url":"https://github.com/Karnav123","followers_url":"https://api.github.com/users/Karnav123/followers","following_url":"https://api.github.com/users/Karnav123/following{/other_user}","gists_url":"https://api.github.com/users/Karnav123/gists{/gist_id}","starred_url":"https://api.github.com/users/Karnav123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Karnav123/subscriptions","organizations_url":"https://api.github.com/users/Karnav123/orgs","repos_url":"https://api.github.com/users/Karnav123/repos","events_url":"https://api.github.com/users/Karnav123/events{/privacy}","received_events_url":"https://api.github.com/users/Karnav123/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/654763393","html_url":"https://github.com/onnx/sklearn-onnx/issues/506#issuecomment-654763393","issue_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/506","id":654763393,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NDc2MzM5Mw==","user":{"login":"hanzigs","id":30790120,"node_id":"MDQ6VXNlcjMwNzkwMTIw","avatar_url":"https://avatars.githubusercontent.com/u/30790120?v=4","gravatar_id":"","url":"https://api.github.com/users/hanzigs","html_url":"https://github.com/hanzigs","followers_url":"https://api.github.com/users/hanzigs/followers","following_url":"https://api.github.com/users/hanzigs/following{/other_user}","gists_url":"https://api.github.com/users/hanzigs/gists{/gist_id}","starred_url":"https://api.github.com/users/hanzigs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanzigs/subscriptions","organizations_url":"https://api.github.com/users/hanzigs/orgs","repos_url":"https://api.github.com/users/hanzigs/repos","events_url":"https://api.github.com/users/hanzigs/events{/privacy}","received_events_url":"https://api.github.com/users/hanzigs/received_events","type":"User","site_admin":false},"created_at":"2020-07-07T10:37:38Z","updated_at":"2020-07-07T10:43:10Z","author_association":"NONE","body":"without index\r\n![image](https://user-images.githubusercontent.com/30790120/86768868-8dcc7880-c091-11ea-86c2-e58ec37206c6.png)\r\nand sess parameters\r\n![image](https://user-images.githubusercontent.com/30790120/86768953-b05e9180-c091-11ea-8a9c-d99dfa682ba2.png)\r\ndon't understand why \r\noutput shape is [None] and\r\noutput type supposed to be float may be","reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/654763393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hanzigs","id":30790120,"node_id":"MDQ6VXNlcjMwNzkwMTIw","avatar_url":"https://avatars.githubusercontent.com/u/30790120?v=4","gravatar_id":"","url":"https://api.github.com/users/hanzigs","html_url":"https://github.com/hanzigs","followers_url":"https://api.github.com/users/hanzigs/followers","following_url":"https://api.github.com/users/hanzigs/following{/other_user}","gists_url":"https://api.github.com/users/hanzigs/gists{/gist_id}","starred_url":"https://api.github.com/users/hanzigs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanzigs/subscriptions","organizations_url":"https://api.github.com/users/hanzigs/orgs","repos_url":"https://api.github.com/users/hanzigs/repos","events_url":"https://api.github.com/users/hanzigs/events{/privacy}","received_events_url":"https://api.github.com/users/hanzigs/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/654823767","html_url":"https://github.com/onnx/sklearn-onnx/issues/506#issuecomment-654823767","issue_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/506","id":654823767,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NDgyMzc2Nw==","user":{"login":"Karnav123","id":36244620,"node_id":"MDQ6VXNlcjM2MjQ0NjIw","avatar_url":"https://avatars.githubusercontent.com/u/36244620?v=4","gravatar_id":"","url":"https://api.github.com/users/Karnav123","html_url":"https://github.com/Karnav123","followers_url":"https://api.github.com/users/Karnav123/followers","following_url":"https://api.github.com/users/Karnav123/following{/other_user}","gists_url":"https://api.github.com/users/Karnav123/gists{/gist_id}","starred_url":"https://api.github.com/users/Karnav123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Karnav123/subscriptions","organizations_url":"https://api.github.com/users/Karnav123/orgs","repos_url":"https://api.github.com/users/Karnav123/repos","events_url":"https://api.github.com/users/Karnav123/events{/privacy}","received_events_url":"https://api.github.com/users/Karnav123/received_events","type":"User","site_admin":false},"created_at":"2020-07-07T12:32:08Z","updated_at":"2020-07-07T12:32:08Z","author_association":"NONE","body":"> without index\r\n> ![image](https://user-images.githubusercontent.com/30790120/86768868-8dcc7880-c091-11ea-86c2-e58ec37206c6.png)\r\n> and sess parameters\r\n> ![image](https://user-images.githubusercontent.com/30790120/86768953-b05e9180-c091-11ea-8a9c-d99dfa682ba2.png)\r\n> don't understand why\r\n> output shape is [None] and\r\n> output type supposed to be float may be\r\n\r\nuse as following:\r\n\r\n```\r\nsess = rt.InferenceSession(\"your_model.onnx\")\r\ninput_name = sess.get_inputs()[0].name\r\nlabel_name = sess.get_outputs()[0].name\r\noutput_probability = sess.get_outputs()[1].name\r\n\r\npred_onx = sess.run([label_name, output_probability], {input_name: X_test_.astype(np.int64)})\r\nprint(\"predict\", pred_onx[0][:])\r\nprint(\"predict_proba\", pred_onx[1][:])\r\n```","reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/654823767/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Karnav123","id":36244620,"node_id":"MDQ6VXNlcjM2MjQ0NjIw","avatar_url":"https://avatars.githubusercontent.com/u/36244620?v=4","gravatar_id":"","url":"https://api.github.com/users/Karnav123","html_url":"https://github.com/Karnav123","followers_url":"https://api.github.com/users/Karnav123/followers","following_url":"https://api.github.com/users/Karnav123/following{/other_user}","gists_url":"https://api.github.com/users/Karnav123/gists{/gist_id}","starred_url":"https://api.github.com/users/Karnav123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Karnav123/subscriptions","organizations_url":"https://api.github.com/users/Karnav123/orgs","repos_url":"https://api.github.com/users/Karnav123/repos","events_url":"https://api.github.com/users/Karnav123/events{/privacy}","received_events_url":"https://api.github.com/users/Karnav123/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/654826565","html_url":"https://github.com/onnx/sklearn-onnx/issues/506#issuecomment-654826565","issue_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/506","id":654826565,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NDgyNjU2NQ==","user":{"login":"hanzigs","id":30790120,"node_id":"MDQ6VXNlcjMwNzkwMTIw","avatar_url":"https://avatars.githubusercontent.com/u/30790120?v=4","gravatar_id":"","url":"https://api.github.com/users/hanzigs","html_url":"https://github.com/hanzigs","followers_url":"https://api.github.com/users/hanzigs/followers","following_url":"https://api.github.com/users/hanzigs/following{/other_user}","gists_url":"https://api.github.com/users/hanzigs/gists{/gist_id}","starred_url":"https://api.github.com/users/hanzigs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanzigs/subscriptions","organizations_url":"https://api.github.com/users/hanzigs/orgs","repos_url":"https://api.github.com/users/hanzigs/repos","events_url":"https://api.github.com/users/hanzigs/events{/privacy}","received_events_url":"https://api.github.com/users/hanzigs/received_events","type":"User","site_admin":false},"created_at":"2020-07-07T12:36:56Z","updated_at":"2020-07-07T12:36:56Z","author_association":"NONE","body":"That's perfect, Thank you very much","reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/654826565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hanzigs","id":30790120,"node_id":"MDQ6VXNlcjMwNzkwMTIw","avatar_url":"https://avatars.githubusercontent.com/u/30790120?v=4","gravatar_id":"","url":"https://api.github.com/users/hanzigs","html_url":"https://github.com/hanzigs","followers_url":"https://api.github.com/users/hanzigs/followers","following_url":"https://api.github.com/users/hanzigs/following{/other_user}","gists_url":"https://api.github.com/users/hanzigs/gists{/gist_id}","starred_url":"https://api.github.com/users/hanzigs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanzigs/subscriptions","organizations_url":"https://api.github.com/users/hanzigs/orgs","repos_url":"https://api.github.com/users/hanzigs/repos","events_url":"https://api.github.com/users/hanzigs/events{/privacy}","received_events_url":"https://api.github.com/users/hanzigs/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/655780505","html_url":"https://github.com/onnx/sklearn-onnx/issues/506#issuecomment-655780505","issue_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/506","id":655780505,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NTc4MDUwNQ==","user":{"login":"prabhat00155","id":7043157,"node_id":"MDQ6VXNlcjcwNDMxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/7043157?v=4","gravatar_id":"","url":"https://api.github.com/users/prabhat00155","html_url":"https://github.com/prabhat00155","followers_url":"https://api.github.com/users/prabhat00155/followers","following_url":"https://api.github.com/users/prabhat00155/following{/other_user}","gists_url":"https://api.github.com/users/prabhat00155/gists{/gist_id}","starred_url":"https://api.github.com/users/prabhat00155/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prabhat00155/subscriptions","organizations_url":"https://api.github.com/users/prabhat00155/orgs","repos_url":"https://api.github.com/users/prabhat00155/repos","events_url":"https://api.github.com/users/prabhat00155/events{/privacy}","received_events_url":"https://api.github.com/users/prabhat00155/received_events","type":"User","site_admin":false},"created_at":"2020-07-08T22:01:01Z","updated_at":"2020-07-08T22:01:01Z","author_association":"COLLABORATOR","body":"> See the difference in output in following image.\r\n> ![onnxVSpkl](https://user-images.githubusercontent.com/36244620/86598792-47a4e580-bfbb-11ea-8da5-1173bca6923a.PNG)\r\n> The dataset is for binary classification. The code to generate the model is:\r\n> \r\n> ```\r\n> categorical_pipeline_onehot = Pipeline([\r\n>              ('OneHot', OneHotEncoder( handle_unknown='ignore'))\r\n>         ])\r\n> preprocessor = ColumnTransformer(\r\n>     transformers=[('Onehot', categorical_pipeline_onehot, CATEGORICAL_ATTRIBUTES_ONEHOT)],\r\n>     remainder='passthrough')\r\n> from xgboost import XGBClassifier\r\n> xgb = XGBClassifier()\r\n> \r\n> clf = Pipeline(steps=[('preprocessor', preprocessor),('cls', xgb)])\r\n> clf.fit(df_train[predictors], df_train[\"IsSelected\"])\r\n> \r\n> update_registered_converter(\r\n>     XGBClassifier, 'XGBoostXGBClassifier',\r\n>     calculate_linear_classifier_output_shapes, convert_xgboost,\r\n>     options={'nocl': [True, False], 'zipmap': [True, False]})\r\n> ```\r\n> \r\n> To convert this model to ONNX the code is:\r\n> \r\n> ```\r\n> def convert_dataframe_schema(df, drop=None):\r\n>     inputs = []\r\n>     for k, v in zip(df.columns, df.dtypes):\r\n>         if drop is not None and k in drop:\r\n>             continue\r\n>         if v == 'int64':\r\n>             t = Int64TensorType([None, 1])\r\n>         elif v == 'float64':\r\n>             t = FloatTensorType([None, 1])\r\n>         else:\r\n>             t = StringTensorType([None, 1])\r\n>         inputs.append((k, t))\r\n>     return inputs\r\n> \r\n> try:\r\n>     model_onnx_wholed = convert_sklearn(model, 'pipeline_with_onehot', inputs)\r\n> except Exception as e:\r\n>     print(e)\r\n> \r\n> with open(\"XGB_onehot_wholedata.onnx\", \"wb\") as f:\r\n>     f.write(model_onnx_wholed.SerializeToString())\r\n> ```\r\n> \r\n> While prediction I am using C++ APIs as well as Python for onnxruntime. The prediction output generated by the onnx model is all 0 for both C++ and Python which do not match with that of the trained sklearn model.\r\n> \r\n> The ONNX model adds Cast operator for features. It may be due to this but I am not sure.\r\n> \r\n> The C++ onnxruntime API log is as following:\r\n> \r\n> ```\r\n> 2020-07-06 18:50:47.2890620 [W:onnxruntime:test, abi_session_options.cc:147 OrtApis::SetIntraOpNumThreads] Since openmp is enabled in this build, this API cannot be used to configure intra op num threads. Please use the openmp environment variables to control the number of threads.\r\n> Using Onnxruntime C++ API\r\n> 2020-07-06 18:50:55.2296864 [I:onnxruntime:, inference_session.cc:174 onnxruntime::InferenceSession::ConstructorCommon] Creating and using per session threadpools since use_per_session_threads_ is true\r\n> 2020-07-06 18:50:55.4219403 [I:onnxruntime:, inference_session.cc:830 onnxruntime::InferenceSession::Initialize] Initializing session.\r\n> 2020-07-06 18:50:55.4220585 [I:onnxruntime:, inference_session.cc:848 onnxruntime::InferenceSession::Initialize] Adding default CPU execution provider.\r\n> 2020-07-06 18:50:55.4224222 [I:onnxruntime:test, bfc_arena.cc:15 onnxruntime::BFCArena::BFCArena] Creating BFCArena for Cpu\r\n> 2020-07-06 18:50:55.4224870 [V:onnxruntime:test, bfc_arena.cc:32 onnxruntime::BFCArena::BFCArena] Creating 21 bins of max chunk size 256 to 268435456\r\n> 2020-07-06 18:50:55.4247204 [V:onnxruntime:, inference_session.cc:671 onnxruntime::InferenceSession::TransformGraph] Node placements\r\n> 2020-07-06 18:50:55.4248273 [V:onnxruntime:, inference_session.cc:673 onnxruntime::InferenceSession::TransformGraph] All nodes have been placed on [CPUExecutionProvider].\r\n> 2020-07-06 18:50:55.4249199 [I:onnxruntime:, session_state.cc:25 onnxruntime::SessionState::SetGraph] SaveMLValueNameIndexMapping\r\n> 2020-07-06 18:50:55.4250567 [I:onnxruntime:, session_state.cc:70 onnxruntime::SessionState::SetGraph] Done saving OrtValue mappings.\r\n> 2020-07-06 18:50:55.4266916 [I:onnxruntime:, session_state_initializer.cc:178 onnxruntime::SaveInitializedTensors] Saving initialized tensors.\r\n> 2020-07-06 18:50:55.4268214 [I:onnxruntime:, session_state_initializer.cc:223 onnxruntime::SaveInitializedTensors] Done saving initialized tensors\r\n> 2020-07-06 18:50:55.7311821 [I:onnxruntime:, inference_session.cc:919 onnxruntime::InferenceSession::Initialize] Session successfully initialized.\r\n> Number of inputs = 22\r\n> Number of outputs = 2\r\n> Output 0 : name=label\r\n> Output 1 : name=probabilities\r\n> \r\n> 2020-07-06 18:51:18.7355209 [I:onnxruntime:, sequential_executor.cc:145 onnxruntime::SequentialExecutor::Execute] Begin execution\r\n> 2020-07-06 18:51:27.4858870 [I:onnxruntime:test, bfc_arena.cc:259 onnxruntime::BFCArena::AllocateRawInternal] Extending BFCArena for Cpu. bin_num:0 rounded_bytes:256\r\n> 2020-07-06 18:51:27.4867688 [I:onnxruntime:test, bfc_arena.cc:143 onnxruntime::BFCArena::Extend] Extended allocation by 1048576 bytes.\r\n> 2020-07-06 18:51:27.4871985 [I:onnxruntime:test, bfc_arena.cc:147 onnxruntime::BFCArena::Extend] Total allocated bytes: 1048832\r\n> 2020-07-06 18:51:27.4872666 [I:onnxruntime:test, bfc_arena.cc:150 onnxruntime::BFCArena::Extend] Allocated memory at 000001D54AC25060 to 000001D54AD25060\r\n> Predicted Class:\r\n> 0\r\n> 0\r\n> 0\r\n> 0\r\n> 0\r\n> 0\r\n> 0\r\n> 0\r\n> 0\r\n> 0\r\n> 0\r\n> 0\r\n> ```\r\n> \r\n> ```\r\n> Versions: \r\n> skl2onnx: 1.7.0\r\n> onnxruntime: 1.3.0\r\n> ```\r\n\r\nDo you see this with other classifiers as well or just XGBoost?","reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/655780505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"prabhat00155","id":7043157,"node_id":"MDQ6VXNlcjcwNDMxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/7043157?v=4","gravatar_id":"","url":"https://api.github.com/users/prabhat00155","html_url":"https://github.com/prabhat00155","followers_url":"https://api.github.com/users/prabhat00155/followers","following_url":"https://api.github.com/users/prabhat00155/following{/other_user}","gists_url":"https://api.github.com/users/prabhat00155/gists{/gist_id}","starred_url":"https://api.github.com/users/prabhat00155/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prabhat00155/subscriptions","organizations_url":"https://api.github.com/users/prabhat00155/orgs","repos_url":"https://api.github.com/users/prabhat00155/repos","events_url":"https://api.github.com/users/prabhat00155/events{/privacy}","received_events_url":"https://api.github.com/users/prabhat00155/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/655938128","html_url":"https://github.com/onnx/sklearn-onnx/issues/506#issuecomment-655938128","issue_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/506","id":655938128,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NTkzODEyOA==","user":{"login":"Karnav123","id":36244620,"node_id":"MDQ6VXNlcjM2MjQ0NjIw","avatar_url":"https://avatars.githubusercontent.com/u/36244620?v=4","gravatar_id":"","url":"https://api.github.com/users/Karnav123","html_url":"https://github.com/Karnav123","followers_url":"https://api.github.com/users/Karnav123/followers","following_url":"https://api.github.com/users/Karnav123/following{/other_user}","gists_url":"https://api.github.com/users/Karnav123/gists{/gist_id}","starred_url":"https://api.github.com/users/Karnav123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Karnav123/subscriptions","organizations_url":"https://api.github.com/users/Karnav123/orgs","repos_url":"https://api.github.com/users/Karnav123/repos","events_url":"https://api.github.com/users/Karnav123/events{/privacy}","received_events_url":"https://api.github.com/users/Karnav123/received_events","type":"User","site_admin":false},"created_at":"2020-07-09T06:53:46Z","updated_at":"2020-07-09T06:53:46Z","author_association":"NONE","body":"> > See the difference in output in following image.\r\n> > ![onnxVSpkl](https://user-images.githubusercontent.com/36244620/86598792-47a4e580-bfbb-11ea-8da5-1173bca6923a.PNG)\r\n> > The dataset is for binary classification. The code to generate the model is:\r\n> > ```\r\n> > categorical_pipeline_onehot = Pipeline([\r\n> >              ('OneHot', OneHotEncoder( handle_unknown='ignore'))\r\n> >         ])\r\n> > preprocessor = ColumnTransformer(\r\n> >     transformers=[('Onehot', categorical_pipeline_onehot, CATEGORICAL_ATTRIBUTES_ONEHOT)],\r\n> >     remainder='passthrough')\r\n> > from xgboost import XGBClassifier\r\n> > xgb = XGBClassifier()\r\n> > \r\n> > clf = Pipeline(steps=[('preprocessor', preprocessor),('cls', xgb)])\r\n> > clf.fit(df_train[predictors], df_train[\"IsSelected\"])\r\n> > \r\n> > update_registered_converter(\r\n> >     XGBClassifier, 'XGBoostXGBClassifier',\r\n> >     calculate_linear_classifier_output_shapes, convert_xgboost,\r\n> >     options={'nocl': [True, False], 'zipmap': [True, False]})\r\n> > ```\r\n> > \r\n> > \r\n> > To convert this model to ONNX the code is:\r\n> > ```\r\n> > def convert_dataframe_schema(df, drop=None):\r\n> >     inputs = []\r\n> >     for k, v in zip(df.columns, df.dtypes):\r\n> >         if drop is not None and k in drop:\r\n> >             continue\r\n> >         if v == 'int64':\r\n> >             t = Int64TensorType([None, 1])\r\n> >         elif v == 'float64':\r\n> >             t = FloatTensorType([None, 1])\r\n> >         else:\r\n> >             t = StringTensorType([None, 1])\r\n> >         inputs.append((k, t))\r\n> >     return inputs\r\n> > \r\n> > try:\r\n> >     model_onnx_wholed = convert_sklearn(model, 'pipeline_with_onehot', inputs)\r\n> > except Exception as e:\r\n> >     print(e)\r\n> > \r\n> > with open(\"XGB_onehot_wholedata.onnx\", \"wb\") as f:\r\n> >     f.write(model_onnx_wholed.SerializeToString())\r\n> > ```\r\n> > \r\n> > \r\n> > While prediction I am using C++ APIs as well as Python for onnxruntime. The prediction output generated by the onnx model is all 0 for both C++ and Python which do not match with that of the trained sklearn model.\r\n> > The ONNX model adds Cast operator for features. It may be due to this but I am not sure.\r\n> > The C++ onnxruntime API log is as following:\r\n> > ```\r\n> > 2020-07-06 18:50:47.2890620 [W:onnxruntime:test, abi_session_options.cc:147 OrtApis::SetIntraOpNumThreads] Since openmp is enabled in this build, this API cannot be used to configure intra op num threads. Please use the openmp environment variables to control the number of threads.\r\n> > Using Onnxruntime C++ API\r\n> > 2020-07-06 18:50:55.2296864 [I:onnxruntime:, inference_session.cc:174 onnxruntime::InferenceSession::ConstructorCommon] Creating and using per session threadpools since use_per_session_threads_ is true\r\n> > 2020-07-06 18:50:55.4219403 [I:onnxruntime:, inference_session.cc:830 onnxruntime::InferenceSession::Initialize] Initializing session.\r\n> > 2020-07-06 18:50:55.4220585 [I:onnxruntime:, inference_session.cc:848 onnxruntime::InferenceSession::Initialize] Adding default CPU execution provider.\r\n> > 2020-07-06 18:50:55.4224222 [I:onnxruntime:test, bfc_arena.cc:15 onnxruntime::BFCArena::BFCArena] Creating BFCArena for Cpu\r\n> > 2020-07-06 18:50:55.4224870 [V:onnxruntime:test, bfc_arena.cc:32 onnxruntime::BFCArena::BFCArena] Creating 21 bins of max chunk size 256 to 268435456\r\n> > 2020-07-06 18:50:55.4247204 [V:onnxruntime:, inference_session.cc:671 onnxruntime::InferenceSession::TransformGraph] Node placements\r\n> > 2020-07-06 18:50:55.4248273 [V:onnxruntime:, inference_session.cc:673 onnxruntime::InferenceSession::TransformGraph] All nodes have been placed on [CPUExecutionProvider].\r\n> > 2020-07-06 18:50:55.4249199 [I:onnxruntime:, session_state.cc:25 onnxruntime::SessionState::SetGraph] SaveMLValueNameIndexMapping\r\n> > 2020-07-06 18:50:55.4250567 [I:onnxruntime:, session_state.cc:70 onnxruntime::SessionState::SetGraph] Done saving OrtValue mappings.\r\n> > 2020-07-06 18:50:55.4266916 [I:onnxruntime:, session_state_initializer.cc:178 onnxruntime::SaveInitializedTensors] Saving initialized tensors.\r\n> > 2020-07-06 18:50:55.4268214 [I:onnxruntime:, session_state_initializer.cc:223 onnxruntime::SaveInitializedTensors] Done saving initialized tensors\r\n> > 2020-07-06 18:50:55.7311821 [I:onnxruntime:, inference_session.cc:919 onnxruntime::InferenceSession::Initialize] Session successfully initialized.\r\n> > Number of inputs = 22\r\n> > Number of outputs = 2\r\n> > Output 0 : name=label\r\n> > Output 1 : name=probabilities\r\n> > \r\n> > 2020-07-06 18:51:18.7355209 [I:onnxruntime:, sequential_executor.cc:145 onnxruntime::SequentialExecutor::Execute] Begin execution\r\n> > 2020-07-06 18:51:27.4858870 [I:onnxruntime:test, bfc_arena.cc:259 onnxruntime::BFCArena::AllocateRawInternal] Extending BFCArena for Cpu. bin_num:0 rounded_bytes:256\r\n> > 2020-07-06 18:51:27.4867688 [I:onnxruntime:test, bfc_arena.cc:143 onnxruntime::BFCArena::Extend] Extended allocation by 1048576 bytes.\r\n> > 2020-07-06 18:51:27.4871985 [I:onnxruntime:test, bfc_arena.cc:147 onnxruntime::BFCArena::Extend] Total allocated bytes: 1048832\r\n> > 2020-07-06 18:51:27.4872666 [I:onnxruntime:test, bfc_arena.cc:150 onnxruntime::BFCArena::Extend] Allocated memory at 000001D54AC25060 to 000001D54AD25060\r\n> > Predicted Class:\r\n> > 0\r\n> > 0\r\n> > 0\r\n> > 0\r\n> > 0\r\n> > 0\r\n> > 0\r\n> > 0\r\n> > 0\r\n> > 0\r\n> > 0\r\n> > 0\r\n> > ```\r\n> > \r\n> > \r\n> > ```\r\n> > Versions: \r\n> > skl2onnx: 1.7.0\r\n> > onnxruntime: 1.3.0\r\n> > ```\r\n> \r\n> Do you see this with other classifiers as well or just XGBoost?\r\n\r\nI have seen this with RandomForest too.","reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/655938128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Karnav123","id":36244620,"node_id":"MDQ6VXNlcjM2MjQ0NjIw","avatar_url":"https://avatars.githubusercontent.com/u/36244620?v=4","gravatar_id":"","url":"https://api.github.com/users/Karnav123","html_url":"https://github.com/Karnav123","followers_url":"https://api.github.com/users/Karnav123/followers","following_url":"https://api.github.com/users/Karnav123/following{/other_user}","gists_url":"https://api.github.com/users/Karnav123/gists{/gist_id}","starred_url":"https://api.github.com/users/Karnav123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Karnav123/subscriptions","organizations_url":"https://api.github.com/users/Karnav123/orgs","repos_url":"https://api.github.com/users/Karnav123/repos","events_url":"https://api.github.com/users/Karnav123/events{/privacy}","received_events_url":"https://api.github.com/users/Karnav123/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/656391039","html_url":"https://github.com/onnx/sklearn-onnx/issues/506#issuecomment-656391039","issue_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/506","id":656391039,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NjM5MTAzOQ==","user":{"login":"prabhat00155","id":7043157,"node_id":"MDQ6VXNlcjcwNDMxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/7043157?v=4","gravatar_id":"","url":"https://api.github.com/users/prabhat00155","html_url":"https://github.com/prabhat00155","followers_url":"https://api.github.com/users/prabhat00155/followers","following_url":"https://api.github.com/users/prabhat00155/following{/other_user}","gists_url":"https://api.github.com/users/prabhat00155/gists{/gist_id}","starred_url":"https://api.github.com/users/prabhat00155/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prabhat00155/subscriptions","organizations_url":"https://api.github.com/users/prabhat00155/orgs","repos_url":"https://api.github.com/users/prabhat00155/repos","events_url":"https://api.github.com/users/prabhat00155/events{/privacy}","received_events_url":"https://api.github.com/users/prabhat00155/received_events","type":"User","site_admin":false},"created_at":"2020-07-09T22:59:36Z","updated_at":"2020-07-09T22:59:57Z","author_association":"COLLABORATOR","body":"Can you give a complete example to reproduce the issue with RandomForestClassifier? I tried the following and didn't see the issue:\r\n```\r\nimport numpy as np\r\nimport pandas as pd\r\nfrom onnxmltools import save_model\r\nfrom onnxruntime import InferenceSession\r\nfrom skl2onnx.common.data_types import StringTensorType, Int64TensorType\r\nfrom skl2onnx.convert import convert_sklearn\r\nfrom sklearn.compose import ColumnTransformer\r\nfrom sklearn.ensemble import RandomForestClassifier\r\nfrom sklearn.pipeline import Pipeline\r\nfrom sklearn.preprocessing import OneHotEncoder\r\n\r\ndata = pd.DataFrame({'gender': ['male', 'female', 'male', 'female', 'male'],\r\n              'age': [19, 22, 34, 55, 67],\r\n              'profession': ['student', 'student', 'teacher', 'teacher', 'teacher']\r\n             })\r\nlabels = [1, 0, 0, 1, 1]\r\n\r\n\r\ncategorical_pipeline_onehot = Pipeline([('OneHot', OneHotEncoder(handle_unknown='ignore'))])\r\npreprocessor = ColumnTransformer(\r\n    transformers=[('Onehot', OneHotEncoder(), [0, 2])],\r\n    remainder='passthrough')\r\nmodel = RandomForestClassifier()\r\n\r\nclf = Pipeline(steps=[('preprocessor', preprocessor),('cls', model)])\r\nclf.fit(data, labels)\r\n\r\nonnx_fs = convert_sklearn(clf, 'ada',\r\n                          [\r\n                              ('float_input1', StringTensorType([None, 1])),\r\n                              ('float_input2', Int64TensorType([None, 1])),\r\n                              ('float_input3', StringTensorType([None, 1]))\r\n                          ])\r\n\r\nsave_model(onnx_fs, 'onnx_model.onnx')\r\nsess = InferenceSession('onnx_model.onnx')\r\n\r\nsess.run(None, input_feed={'float_input1': data['gender'].values.reshape((-1, 1)),\r\n                           'float_input2': data['age'].values.reshape((-1, 1)),\r\n                          'float_input3': data['profession'].values.reshape((-1, 1))})\r\n```\r\nOutput:\r\n```\r\n[array([1, 0, 0, 1, 1], dtype=int64),\r\n [{0: 0.3600003123283386, 1: 0.6399996876716614},\r\n  {0: 0.7100000381469727, 1: 0.28999999165534973},\r\n  {0: 0.690000057220459, 1: 0.3099999725818634},\r\n  {0: 0.1300005316734314, 1: 0.8699994683265686},\r\n  {0: 0.1600005030632019, 1: 0.8399994969367981}]]\r\n```","reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/656391039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"prabhat00155","id":7043157,"node_id":"MDQ6VXNlcjcwNDMxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/7043157?v=4","gravatar_id":"","url":"https://api.github.com/users/prabhat00155","html_url":"https://github.com/prabhat00155","followers_url":"https://api.github.com/users/prabhat00155/followers","following_url":"https://api.github.com/users/prabhat00155/following{/other_user}","gists_url":"https://api.github.com/users/prabhat00155/gists{/gist_id}","starred_url":"https://api.github.com/users/prabhat00155/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prabhat00155/subscriptions","organizations_url":"https://api.github.com/users/prabhat00155/orgs","repos_url":"https://api.github.com/users/prabhat00155/repos","events_url":"https://api.github.com/users/prabhat00155/events{/privacy}","received_events_url":"https://api.github.com/users/prabhat00155/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/781434688","html_url":"https://github.com/onnx/sklearn-onnx/issues/506#issuecomment-781434688","issue_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/506","id":781434688,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTQzNDY4OA==","user":{"login":"xadupre","id":22452781,"node_id":"MDQ6VXNlcjIyNDUyNzgx","avatar_url":"https://avatars.githubusercontent.com/u/22452781?v=4","gravatar_id":"","url":"https://api.github.com/users/xadupre","html_url":"https://github.com/xadupre","followers_url":"https://api.github.com/users/xadupre/followers","following_url":"https://api.github.com/users/xadupre/following{/other_user}","gists_url":"https://api.github.com/users/xadupre/gists{/gist_id}","starred_url":"https://api.github.com/users/xadupre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xadupre/subscriptions","organizations_url":"https://api.github.com/users/xadupre/orgs","repos_url":"https://api.github.com/users/xadupre/repos","events_url":"https://api.github.com/users/xadupre/events{/privacy}","received_events_url":"https://api.github.com/users/xadupre/received_events","type":"User","site_admin":false},"created_at":"2021-02-18T15:42:51Z","updated_at":"2021-02-18T15:42:51Z","author_association":"COLLABORATOR","body":"May I close the issue?","reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/781434688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"xadupre","id":22452781,"node_id":"MDQ6VXNlcjIyNDUyNzgx","avatar_url":"https://avatars.githubusercontent.com/u/22452781?v=4","gravatar_id":"","url":"https://api.github.com/users/xadupre","html_url":"https://github.com/xadupre","followers_url":"https://api.github.com/users/xadupre/followers","following_url":"https://api.github.com/users/xadupre/following{/other_user}","gists_url":"https://api.github.com/users/xadupre/gists{/gist_id}","starred_url":"https://api.github.com/users/xadupre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xadupre/subscriptions","organizations_url":"https://api.github.com/users/xadupre/orgs","repos_url":"https://api.github.com/users/xadupre/repos","events_url":"https://api.github.com/users/xadupre/events{/privacy}","received_events_url":"https://api.github.com/users/xadupre/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/781477748","html_url":"https://github.com/onnx/sklearn-onnx/issues/506#issuecomment-781477748","issue_url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/506","id":781477748,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTQ3Nzc0OA==","user":{"login":"Karnav123","id":36244620,"node_id":"MDQ6VXNlcjM2MjQ0NjIw","avatar_url":"https://avatars.githubusercontent.com/u/36244620?v=4","gravatar_id":"","url":"https://api.github.com/users/Karnav123","html_url":"https://github.com/Karnav123","followers_url":"https://api.github.com/users/Karnav123/followers","following_url":"https://api.github.com/users/Karnav123/following{/other_user}","gists_url":"https://api.github.com/users/Karnav123/gists{/gist_id}","starred_url":"https://api.github.com/users/Karnav123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Karnav123/subscriptions","organizations_url":"https://api.github.com/users/Karnav123/orgs","repos_url":"https://api.github.com/users/Karnav123/repos","events_url":"https://api.github.com/users/Karnav123/events{/privacy}","received_events_url":"https://api.github.com/users/Karnav123/received_events","type":"User","site_admin":false},"created_at":"2021-02-18T16:42:31Z","updated_at":"2021-02-18T16:42:31Z","author_association":"NONE","body":"> May I close the issue?\n\nYes","reactions":{"url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/comments/781477748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Karnav123","id":36244620,"node_id":"MDQ6VXNlcjM2MjQ0NjIw","avatar_url":"https://avatars.githubusercontent.com/u/36244620?v=4","gravatar_id":"","url":"https://api.github.com/users/Karnav123","html_url":"https://github.com/Karnav123","followers_url":"https://api.github.com/users/Karnav123/followers","following_url":"https://api.github.com/users/Karnav123/following{/other_user}","gists_url":"https://api.github.com/users/Karnav123/gists{/gist_id}","starred_url":"https://api.github.com/users/Karnav123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Karnav123/subscriptions","organizations_url":"https://api.github.com/users/Karnav123/orgs","repos_url":"https://api.github.com/users/Karnav123/repos","events_url":"https://api.github.com/users/Karnav123/events{/privacy}","received_events_url":"https://api.github.com/users/Karnav123/received_events","type":"User","site_admin":false}},{"id":4347846148,"node_id":"MDExOkNsb3NlZEV2ZW50NDM0Nzg0NjE0OA==","url":"https://api.github.com/repos/onnx/sklearn-onnx/issues/events/4347846148","actor":{"login":"xadupre","id":22452781,"node_id":"MDQ6VXNlcjIyNDUyNzgx","avatar_url":"https://avatars.githubusercontent.com/u/22452781?v=4","gravatar_id":"","url":"https://api.github.com/users/xadupre","html_url":"https://github.com/xadupre","followers_url":"https://api.github.com/users/xadupre/followers","following_url":"https://api.github.com/users/xadupre/following{/other_user}","gists_url":"https://api.github.com/users/xadupre/gists{/gist_id}","starred_url":"https://api.github.com/users/xadupre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xadupre/subscriptions","organizations_url":"https://api.github.com/users/xadupre/orgs","repos_url":"https://api.github.com/users/xadupre/repos","events_url":"https://api.github.com/users/xadupre/events{/privacy}","received_events_url":"https://api.github.com/users/xadupre/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-02-18T16:50:43Z","state_reason":null,"performed_via_github_app":null}]