[{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/968914269","html_url":"https://github.com/dbiir/UER-py/issues/222#issuecomment-968914269","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/222","id":968914269,"node_id":"IC_kwDOCsNQKM45wHVd","user":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"created_at":"2021-11-15T13:32:21Z","updated_at":"2021-11-15T13:32:21Z","author_association":"COLLABORATOR","body":"您好，我们在训练时开头都加了CLS，所以严格意义上开头都是需要加CLS，不过由于古诗对联存在对仗之类的问题，少输入一位影响会特别明显，所以在readme特别强调了，而通用模型少输入CLS对生成效果影响并不大。使用Transformers库时也是同理\r\n\r\n\r\n\r\n发自我的iPhone\r\n\r\n\r\n------------------ 原始邮件 ------------------\r\n发件人: Pure White ***@***.***&gt;\r\n发送时间: 2021年11月15日 20:17\r\n收件人: dbiir/UER-py ***@***.***&gt;\r\n抄送: Subscribed ***@***.***&gt;\r\n主题: Re: [dbiir/UER-py] 文本生成中前置[CLS]的问题 (Issue #222)\r\n\r\n\r\n\r\n\r\n\r\n \r\n你们好，首先感谢你们的工作，让预训练语言模型能被更多人了解和使用。\r\n \r\n第一个问题：我注意到，在你们提供的预训练GPT2模型中：\r\n  \r\n古诗词模型、对联模型、文言文模型的输入需要在开头加入[CLS]。 \r\n\r\n通用中文模型、中文歌词模型则无这样的限制。 \r\n \r\n请问这是笔误，还是训练时预处理不同？\r\n \r\n第二个问题：我注意到，在你们提供的代码中，使用LM目标进行预训练，在预处理语料时会在开头加入[CLS]，同样在解码时（scripts/generate_lm.py）也有如此设定。若是我使用HuggingFace的Transformers库加载模型（已转换），调用其TextGenerationPipeline，是否同样需要我在输入的文本前手动加入[CLS]呢？\r\n \r\n—\r\nYou are receiving this because you are subscribed to this thread.\r\nReply to this email directly, view it on GitHub, or unsubscribe.\r\nTriage notifications on the go with GitHub Mobile for iOS or Android.","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/968914269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/969634969","html_url":"https://github.com/dbiir/UER-py/issues/222#issuecomment-969634969","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/222","id":969634969,"node_id":"IC_kwDOCsNQKM45y3SZ","user":{"login":"huhk-sysu","id":14769033,"node_id":"MDQ6VXNlcjE0NzY5MDMz","avatar_url":"https://avatars.githubusercontent.com/u/14769033?v=4","gravatar_id":"","url":"https://api.github.com/users/huhk-sysu","html_url":"https://github.com/huhk-sysu","followers_url":"https://api.github.com/users/huhk-sysu/followers","following_url":"https://api.github.com/users/huhk-sysu/following{/other_user}","gists_url":"https://api.github.com/users/huhk-sysu/gists{/gist_id}","starred_url":"https://api.github.com/users/huhk-sysu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huhk-sysu/subscriptions","organizations_url":"https://api.github.com/users/huhk-sysu/orgs","repos_url":"https://api.github.com/users/huhk-sysu/repos","events_url":"https://api.github.com/users/huhk-sysu/events{/privacy}","received_events_url":"https://api.github.com/users/huhk-sysu/received_events","type":"User","site_admin":false},"created_at":"2021-11-16T01:39:23Z","updated_at":"2021-11-17T03:03:24Z","author_association":"NONE","body":"谢谢你的回答@hhou435。我还有另一个问题：\r\n假若我希望训练语言模型同时基于标题和内容进行生成，是否可以如此组织训练语料（作为preprocess.py的输入）？\r\n\r\n```\r\n标题1 [SEP] 篇章内容1\r\n标题2 [SEP] 篇章内容2\r\n标题3 [SEP] 篇章内容3\r\n```\r\n\r\n当前预处理程序在篇章内容超出窗口范围时，后面的窗口将丢失掉标题信息，有什么好的处理方法呢？","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/969634969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"huhk-sysu","id":14769033,"node_id":"MDQ6VXNlcjE0NzY5MDMz","avatar_url":"https://avatars.githubusercontent.com/u/14769033?v=4","gravatar_id":"","url":"https://api.github.com/users/huhk-sysu","html_url":"https://github.com/huhk-sysu","followers_url":"https://api.github.com/users/huhk-sysu/followers","following_url":"https://api.github.com/users/huhk-sysu/following{/other_user}","gists_url":"https://api.github.com/users/huhk-sysu/gists{/gist_id}","starred_url":"https://api.github.com/users/huhk-sysu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huhk-sysu/subscriptions","organizations_url":"https://api.github.com/users/huhk-sysu/orgs","repos_url":"https://api.github.com/users/huhk-sysu/repos","events_url":"https://api.github.com/users/huhk-sysu/events{/privacy}","received_events_url":"https://api.github.com/users/huhk-sysu/received_events","type":"User","site_admin":false}},{"id":5629014598,"node_id":"MEE_lADOCsNQKM4-zKhNzwAAAAFPg_JG","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/5629014598","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-11-17T03:03:24Z","performed_via_github_app":null},{"id":5629014599,"node_id":"SE_lADOCsNQKM4-zKhNzwAAAAFPg_JH","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/5629014599","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-11-17T03:03:24Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/971211135","html_url":"https://github.com/dbiir/UER-py/issues/222#issuecomment-971211135","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/222","id":971211135,"node_id":"IC_kwDOCsNQKM4544F_","user":{"login":"ydli-ai","id":20391895,"node_id":"MDQ6VXNlcjIwMzkxODk1","avatar_url":"https://avatars.githubusercontent.com/u/20391895?v=4","gravatar_id":"","url":"https://api.github.com/users/ydli-ai","html_url":"https://github.com/ydli-ai","followers_url":"https://api.github.com/users/ydli-ai/followers","following_url":"https://api.github.com/users/ydli-ai/following{/other_user}","gists_url":"https://api.github.com/users/ydli-ai/gists{/gist_id}","starred_url":"https://api.github.com/users/ydli-ai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ydli-ai/subscriptions","organizations_url":"https://api.github.com/users/ydli-ai/orgs","repos_url":"https://api.github.com/users/ydli-ai/repos","events_url":"https://api.github.com/users/ydli-ai/events{/privacy}","received_events_url":"https://api.github.com/users/ydli-ai/received_events","type":"User","site_admin":false},"created_at":"2021-11-17T05:46:28Z","updated_at":"2021-11-17T05:46:28Z","author_association":"COLLABORATOR","body":"> 谢谢你的回答@hhou435。我还有另一个问题： 假若我希望训练语言模型同时基于标题和内容进行生成，是否可以如此组织训练语料（作为preprocess.py的输入）？\r\n> \r\n> ```\r\n> 标题1 [SEP] 篇章内容1\r\n> 标题2 [SEP] 篇章内容2\r\n> 标题3 [SEP] 篇章内容3\r\n> ```\r\n> \r\n> 当前预处理程序在篇章内容超出窗口范围时，后面的窗口将丢失掉标题信息，有什么好的处理方法呢？\r\n\r\n1. 可以\r\n2. 改用相对位置编码，不限长度，或者滑动窗口标题不动","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/971211135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ydli-ai","id":20391895,"node_id":"MDQ6VXNlcjIwMzkxODk1","avatar_url":"https://avatars.githubusercontent.com/u/20391895?v=4","gravatar_id":"","url":"https://api.github.com/users/ydli-ai","html_url":"https://github.com/ydli-ai","followers_url":"https://api.github.com/users/ydli-ai/followers","following_url":"https://api.github.com/users/ydli-ai/following{/other_user}","gists_url":"https://api.github.com/users/ydli-ai/gists{/gist_id}","starred_url":"https://api.github.com/users/ydli-ai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ydli-ai/subscriptions","organizations_url":"https://api.github.com/users/ydli-ai/orgs","repos_url":"https://api.github.com/users/ydli-ai/repos","events_url":"https://api.github.com/users/ydli-ai/events{/privacy}","received_events_url":"https://api.github.com/users/ydli-ai/received_events","type":"User","site_admin":false}},{"id":5629461620,"node_id":"MEE_lADOCsNQKM4-zKhNzwAAAAFPisR0","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/5629461620","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-11-17T05:46:28Z","performed_via_github_app":null},{"id":5629461623,"node_id":"SE_lADOCsNQKM4-zKhNzwAAAAFPisR3","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/5629461623","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-11-17T05:46:28Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/971271508","html_url":"https://github.com/dbiir/UER-py/issues/222#issuecomment-971271508","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/222","id":971271508,"node_id":"IC_kwDOCsNQKM455G1U","user":{"login":"huhk-sysu","id":14769033,"node_id":"MDQ6VXNlcjE0NzY5MDMz","avatar_url":"https://avatars.githubusercontent.com/u/14769033?v=4","gravatar_id":"","url":"https://api.github.com/users/huhk-sysu","html_url":"https://github.com/huhk-sysu","followers_url":"https://api.github.com/users/huhk-sysu/followers","following_url":"https://api.github.com/users/huhk-sysu/following{/other_user}","gists_url":"https://api.github.com/users/huhk-sysu/gists{/gist_id}","starred_url":"https://api.github.com/users/huhk-sysu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huhk-sysu/subscriptions","organizations_url":"https://api.github.com/users/huhk-sysu/orgs","repos_url":"https://api.github.com/users/huhk-sysu/repos","events_url":"https://api.github.com/users/huhk-sysu/events{/privacy}","received_events_url":"https://api.github.com/users/huhk-sysu/received_events","type":"User","site_admin":false},"created_at":"2021-11-17T07:03:08Z","updated_at":"2021-11-17T07:03:08Z","author_association":"NONE","body":"> > 谢谢你的回答@hhou435。我还有另一个问题： 假若我希望训练语言模型同时基于标题和内容进行生成，是否可以如此组织训练语料（作为preprocess.py的输入）？\r\n> > ```\r\n> > 标题1 [SEP] 篇章内容1\r\n> > 标题2 [SEP] 篇章内容2\r\n> > 标题3 [SEP] 篇章内容3\r\n> > ```\r\n> > \r\n> > \r\n> >     \r\n> >       \r\n> >     \r\n> > \r\n> >       \r\n> >     \r\n> > \r\n> >     \r\n> >   \r\n> > 当前预处理程序在篇章内容超出窗口范围时，后面的窗口将丢失掉标题信息，有什么好的处理方法呢？\r\n> \r\n> 1. 可以\r\n> 2. 改用相对位置编码，不限长度，或者滑动窗口标题不动\r\n\r\n感谢，通过修改data.py，使用滑动窗口标题不动的方法解决了。","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/971271508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"huhk-sysu","id":14769033,"node_id":"MDQ6VXNlcjE0NzY5MDMz","avatar_url":"https://avatars.githubusercontent.com/u/14769033?v=4","gravatar_id":"","url":"https://api.github.com/users/huhk-sysu","html_url":"https://github.com/huhk-sysu","followers_url":"https://api.github.com/users/huhk-sysu/followers","following_url":"https://api.github.com/users/huhk-sysu/following{/other_user}","gists_url":"https://api.github.com/users/huhk-sysu/gists{/gist_id}","starred_url":"https://api.github.com/users/huhk-sysu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huhk-sysu/subscriptions","organizations_url":"https://api.github.com/users/huhk-sysu/orgs","repos_url":"https://api.github.com/users/huhk-sysu/repos","events_url":"https://api.github.com/users/huhk-sysu/events{/privacy}","received_events_url":"https://api.github.com/users/huhk-sysu/received_events","type":"User","site_admin":false}},{"id":5629729059,"node_id":"MEE_lADOCsNQKM4-zKhNzwAAAAFPjtkj","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/5629729059","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-11-17T07:03:09Z","performed_via_github_app":null},{"id":5629729062,"node_id":"SE_lADOCsNQKM4-zKhNzwAAAAFPjtkm","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/5629729062","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-11-17T07:03:09Z","performed_via_github_app":null},{"id":5629730104,"node_id":"CE_lADOCsNQKM4-zKhNzwAAAAFPjt04","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/5629730104","actor":{"login":"huhk-sysu","id":14769033,"node_id":"MDQ6VXNlcjE0NzY5MDMz","avatar_url":"https://avatars.githubusercontent.com/u/14769033?v=4","gravatar_id":"","url":"https://api.github.com/users/huhk-sysu","html_url":"https://github.com/huhk-sysu","followers_url":"https://api.github.com/users/huhk-sysu/followers","following_url":"https://api.github.com/users/huhk-sysu/following{/other_user}","gists_url":"https://api.github.com/users/huhk-sysu/gists{/gist_id}","starred_url":"https://api.github.com/users/huhk-sysu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huhk-sysu/subscriptions","organizations_url":"https://api.github.com/users/huhk-sysu/orgs","repos_url":"https://api.github.com/users/huhk-sysu/repos","events_url":"https://api.github.com/users/huhk-sysu/events{/privacy}","received_events_url":"https://api.github.com/users/huhk-sysu/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-11-17T07:03:26Z","state_reason":null,"performed_via_github_app":null}]