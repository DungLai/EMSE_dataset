[{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/723544686","html_url":"https://github.com/dbiir/UER-py/issues/75#issuecomment-723544686","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/75","id":723544686,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMzU0NDY4Ng==","user":{"login":"zhezhaoa","id":10495098,"node_id":"MDQ6VXNlcjEwNDk1MDk4","avatar_url":"https://avatars.githubusercontent.com/u/10495098?v=4","gravatar_id":"","url":"https://api.github.com/users/zhezhaoa","html_url":"https://github.com/zhezhaoa","followers_url":"https://api.github.com/users/zhezhaoa/followers","following_url":"https://api.github.com/users/zhezhaoa/following{/other_user}","gists_url":"https://api.github.com/users/zhezhaoa/gists{/gist_id}","starred_url":"https://api.github.com/users/zhezhaoa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhezhaoa/subscriptions","organizations_url":"https://api.github.com/users/zhezhaoa/orgs","repos_url":"https://api.github.com/users/zhezhaoa/repos","events_url":"https://api.github.com/users/zhezhaoa/events{/privacy}","received_events_url":"https://api.github.com/users/zhezhaoa/received_events","type":"User","site_admin":false},"created_at":"2020-11-08T08:16:14Z","updated_at":"2020-11-08T08:16:14Z","author_association":"COLLABORATOR","body":"您好\r\n一般流程是先下载预训练模型，在领域相关的无监督语料上预训练，target可以选择bert或者mlm。不同的target需要不同格式的语料。具体的您可以在quickstart和instructions中找到相关信息。最后使用下游任务脚本run_classifier.py进行微调\r\n\r\n我们把所有的vocabulary放在models文件夹中。您看看是不是路径给错了\r\n\r\n","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/723544686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zhezhaoa","id":10495098,"node_id":"MDQ6VXNlcjEwNDk1MDk4","avatar_url":"https://avatars.githubusercontent.com/u/10495098?v=4","gravatar_id":"","url":"https://api.github.com/users/zhezhaoa","html_url":"https://github.com/zhezhaoa","followers_url":"https://api.github.com/users/zhezhaoa/followers","following_url":"https://api.github.com/users/zhezhaoa/following{/other_user}","gists_url":"https://api.github.com/users/zhezhaoa/gists{/gist_id}","starred_url":"https://api.github.com/users/zhezhaoa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhezhaoa/subscriptions","organizations_url":"https://api.github.com/users/zhezhaoa/orgs","repos_url":"https://api.github.com/users/zhezhaoa/repos","events_url":"https://api.github.com/users/zhezhaoa/events{/privacy}","received_events_url":"https://api.github.com/users/zhezhaoa/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/723546791","html_url":"https://github.com/dbiir/UER-py/issues/75#issuecomment-723546791","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/75","id":723546791,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMzU0Njc5MQ==","user":{"login":"lweicdsor","id":24553542,"node_id":"MDQ6VXNlcjI0NTUzNTQy","avatar_url":"https://avatars.githubusercontent.com/u/24553542?v=4","gravatar_id":"","url":"https://api.github.com/users/lweicdsor","html_url":"https://github.com/lweicdsor","followers_url":"https://api.github.com/users/lweicdsor/followers","following_url":"https://api.github.com/users/lweicdsor/following{/other_user}","gists_url":"https://api.github.com/users/lweicdsor/gists{/gist_id}","starred_url":"https://api.github.com/users/lweicdsor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lweicdsor/subscriptions","organizations_url":"https://api.github.com/users/lweicdsor/orgs","repos_url":"https://api.github.com/users/lweicdsor/repos","events_url":"https://api.github.com/users/lweicdsor/events{/privacy}","received_events_url":"https://api.github.com/users/lweicdsor/received_events","type":"User","site_admin":false},"created_at":"2020-11-08T08:39:41Z","updated_at":"2020-11-08T08:39:41Z","author_association":"NONE","body":"谢谢！请问对于total_steps有什么建议吗？我看到BERT的说明里提到如果语料多step不足不能收敛，语料少step太多则会过拟合，让斟酌选择，但是没有查到一般多少sentence对应多少step这样的信息","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/723546791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lweicdsor","id":24553542,"node_id":"MDQ6VXNlcjI0NTUzNTQy","avatar_url":"https://avatars.githubusercontent.com/u/24553542?v=4","gravatar_id":"","url":"https://api.github.com/users/lweicdsor","html_url":"https://github.com/lweicdsor","followers_url":"https://api.github.com/users/lweicdsor/followers","following_url":"https://api.github.com/users/lweicdsor/following{/other_user}","gists_url":"https://api.github.com/users/lweicdsor/gists{/gist_id}","starred_url":"https://api.github.com/users/lweicdsor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lweicdsor/subscriptions","organizations_url":"https://api.github.com/users/lweicdsor/orgs","repos_url":"https://api.github.com/users/lweicdsor/repos","events_url":"https://api.github.com/users/lweicdsor/events{/privacy}","received_events_url":"https://api.github.com/users/lweicdsor/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/723552394","html_url":"https://github.com/dbiir/UER-py/issues/75#issuecomment-723552394","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/75","id":723552394,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMzU1MjM5NA==","user":{"login":"zhezhaoa","id":10495098,"node_id":"MDQ6VXNlcjEwNDk1MDk4","avatar_url":"https://avatars.githubusercontent.com/u/10495098?v=4","gravatar_id":"","url":"https://api.github.com/users/zhezhaoa","html_url":"https://github.com/zhezhaoa","followers_url":"https://api.github.com/users/zhezhaoa/followers","following_url":"https://api.github.com/users/zhezhaoa/following{/other_user}","gists_url":"https://api.github.com/users/zhezhaoa/gists{/gist_id}","starred_url":"https://api.github.com/users/zhezhaoa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhezhaoa/subscriptions","organizations_url":"https://api.github.com/users/zhezhaoa/orgs","repos_url":"https://api.github.com/users/zhezhaoa/repos","events_url":"https://api.github.com/users/zhezhaoa/events{/privacy}","received_events_url":"https://api.github.com/users/zhezhaoa/received_events","type":"User","site_admin":false},"created_at":"2020-11-08T09:37:18Z","updated_at":"2020-11-08T09:37:18Z","author_association":"COLLABORATOR","body":"增量预训练，语料比较小的话（几十兆），5万步左右就可以；语料较大的话，10万步以上。可以每隔1万步就存一个checkpoint，尝试不同的checkpoint的效果","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/723552394/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zhezhaoa","id":10495098,"node_id":"MDQ6VXNlcjEwNDk1MDk4","avatar_url":"https://avatars.githubusercontent.com/u/10495098?v=4","gravatar_id":"","url":"https://api.github.com/users/zhezhaoa","html_url":"https://github.com/zhezhaoa","followers_url":"https://api.github.com/users/zhezhaoa/followers","following_url":"https://api.github.com/users/zhezhaoa/following{/other_user}","gists_url":"https://api.github.com/users/zhezhaoa/gists{/gist_id}","starred_url":"https://api.github.com/users/zhezhaoa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhezhaoa/subscriptions","organizations_url":"https://api.github.com/users/zhezhaoa/orgs","repos_url":"https://api.github.com/users/zhezhaoa/repos","events_url":"https://api.github.com/users/zhezhaoa/events{/privacy}","received_events_url":"https://api.github.com/users/zhezhaoa/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/723558689","html_url":"https://github.com/dbiir/UER-py/issues/75#issuecomment-723558689","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/75","id":723558689,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMzU1ODY4OQ==","user":{"login":"lweicdsor","id":24553542,"node_id":"MDQ6VXNlcjI0NTUzNTQy","avatar_url":"https://avatars.githubusercontent.com/u/24553542?v=4","gravatar_id":"","url":"https://api.github.com/users/lweicdsor","html_url":"https://github.com/lweicdsor","followers_url":"https://api.github.com/users/lweicdsor/followers","following_url":"https://api.github.com/users/lweicdsor/following{/other_user}","gists_url":"https://api.github.com/users/lweicdsor/gists{/gist_id}","starred_url":"https://api.github.com/users/lweicdsor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lweicdsor/subscriptions","organizations_url":"https://api.github.com/users/lweicdsor/orgs","repos_url":"https://api.github.com/users/lweicdsor/repos","events_url":"https://api.github.com/users/lweicdsor/events{/privacy}","received_events_url":"https://api.github.com/users/lweicdsor/received_events","type":"User","site_admin":false},"created_at":"2020-11-08T10:37:46Z","updated_at":"2020-11-08T10:47:29Z","author_association":"NONE","body":"多谢！","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/723558689/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lweicdsor","id":24553542,"node_id":"MDQ6VXNlcjI0NTUzNTQy","avatar_url":"https://avatars.githubusercontent.com/u/24553542?v=4","gravatar_id":"","url":"https://api.github.com/users/lweicdsor","html_url":"https://github.com/lweicdsor","followers_url":"https://api.github.com/users/lweicdsor/followers","following_url":"https://api.github.com/users/lweicdsor/following{/other_user}","gists_url":"https://api.github.com/users/lweicdsor/gists{/gist_id}","starred_url":"https://api.github.com/users/lweicdsor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lweicdsor/subscriptions","organizations_url":"https://api.github.com/users/lweicdsor/orgs","repos_url":"https://api.github.com/users/lweicdsor/repos","events_url":"https://api.github.com/users/lweicdsor/events{/privacy}","received_events_url":"https://api.github.com/users/lweicdsor/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/723817486","html_url":"https://github.com/dbiir/UER-py/issues/75#issuecomment-723817486","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/75","id":723817486,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMzgxNzQ4Ng==","user":{"login":"lweicdsor","id":24553542,"node_id":"MDQ6VXNlcjI0NTUzNTQy","avatar_url":"https://avatars.githubusercontent.com/u/24553542?v=4","gravatar_id":"","url":"https://api.github.com/users/lweicdsor","html_url":"https://github.com/lweicdsor","followers_url":"https://api.github.com/users/lweicdsor/followers","following_url":"https://api.github.com/users/lweicdsor/following{/other_user}","gists_url":"https://api.github.com/users/lweicdsor/gists{/gist_id}","starred_url":"https://api.github.com/users/lweicdsor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lweicdsor/subscriptions","organizations_url":"https://api.github.com/users/lweicdsor/orgs","repos_url":"https://api.github.com/users/lweicdsor/repos","events_url":"https://api.github.com/users/lweicdsor/events{/privacy}","received_events_url":"https://api.github.com/users/lweicdsor/received_events","type":"User","site_admin":false},"created_at":"2020-11-09T07:25:10Z","updated_at":"2020-11-09T07:25:10Z","author_association":"NONE","body":"我试图用colab的GPU做pretraining， 一直有 out of memory 问题，我将batch_size降为了8，请问这是否会影响收敛或者训练精度？除了batch_size还有哪些参数会影响memory，可以适度调整呢？\r\n我尝试了一下1000 steps，这是结果，由于我的目标是做sentences classification，请问我是不是应该看loss_mlm和acc_mlm？鉴于acc_nsp很高而acc_mlm还尚且较低，我是否应该继续训练？可以用这个训练了1000步数的model去继续训练吗？还是要用原始model？acc_mlm会像acc_nsp一样升至接近1吗？\r\n|      100/    1000 steps|  3920.18 tokens/s| loss    3.01| loss_mlm: 2.799| loss_nsp: 0.213| acc_mlm: 0.539| acc_nsp: 0.953\r\n|      200/    1000 steps|  3844.70 tokens/s| loss    2.34| loss_mlm: 2.340| loss_nsp: 0.000| acc_mlm: 0.567| acc_nsp: 1.000\r\n|      300/    1000 steps|  3826.02 tokens/s| loss    2.20| loss_mlm: 2.200| loss_nsp: 0.000| acc_mlm: 0.590| acc_nsp: 1.000\r\n|      400/    1000 steps|  3824.49 tokens/s| loss    2.16| loss_mlm: 2.160| loss_nsp: 0.002| acc_mlm: 0.593| acc_nsp: 0.999\r\n|      500/    1000 steps|  3834.08 tokens/s| loss    2.11| loss_mlm: 2.097| loss_nsp: 0.015| acc_mlm: 0.602| acc_nsp: 0.999\r\n|      600/    1000 steps|  3823.78 tokens/s| loss    2.11| loss_mlm: 2.112| loss_nsp: 0.000| acc_mlm: 0.598| acc_nsp: 1.000\r\n|      700/    1000 steps|  3814.49 tokens/s| loss    2.06| loss_mlm: 2.056| loss_nsp: 0.002| acc_mlm: 0.609| acc_nsp: 0.999\r\n|      800/    1000 steps|  3828.94 tokens/s| loss    2.03| loss_mlm: 2.033| loss_nsp: 0.000| acc_mlm: 0.611| acc_nsp: 1.000\r\n|      900/    1000 steps|  3823.42 tokens/s| loss    2.07| loss_mlm: 2.061| loss_nsp: 0.011| acc_mlm: 0.604| acc_nsp: 0.998\r\n|     1000/    1000 steps|  3830.61 tokens/s| loss    2.06| loss_mlm: 2.055| loss_nsp: 0.000| acc_mlm: 0.608| acc_nsp: 1.000\r\n另外还想请教，如果有一个很大的语料文件，是否可以将它拆分成许多个小文件？这样每个小语料文件可以用很少的步数pretrain到收敛，一个语料训练至收敛得到一个新model后，用余下的新小语料文件再pretraining这个新model。请问这样做和用一个大的语料文件相比是否结果会有区别？\r\n多谢！\r\n","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/723817486/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lweicdsor","id":24553542,"node_id":"MDQ6VXNlcjI0NTUzNTQy","avatar_url":"https://avatars.githubusercontent.com/u/24553542?v=4","gravatar_id":"","url":"https://api.github.com/users/lweicdsor","html_url":"https://github.com/lweicdsor","followers_url":"https://api.github.com/users/lweicdsor/followers","following_url":"https://api.github.com/users/lweicdsor/following{/other_user}","gists_url":"https://api.github.com/users/lweicdsor/gists{/gist_id}","starred_url":"https://api.github.com/users/lweicdsor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lweicdsor/subscriptions","organizations_url":"https://api.github.com/users/lweicdsor/orgs","repos_url":"https://api.github.com/users/lweicdsor/repos","events_url":"https://api.github.com/users/lweicdsor/events{/privacy}","received_events_url":"https://api.github.com/users/lweicdsor/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/726114757","html_url":"https://github.com/dbiir/UER-py/issues/75#issuecomment-726114757","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/75","id":726114757,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjExNDc1Nw==","user":{"login":"zhezhaoa","id":10495098,"node_id":"MDQ6VXNlcjEwNDk1MDk4","avatar_url":"https://avatars.githubusercontent.com/u/10495098?v=4","gravatar_id":"","url":"https://api.github.com/users/zhezhaoa","html_url":"https://github.com/zhezhaoa","followers_url":"https://api.github.com/users/zhezhaoa/followers","following_url":"https://api.github.com/users/zhezhaoa/following{/other_user}","gists_url":"https://api.github.com/users/zhezhaoa/gists{/gist_id}","starred_url":"https://api.github.com/users/zhezhaoa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhezhaoa/subscriptions","organizations_url":"https://api.github.com/users/zhezhaoa/orgs","repos_url":"https://api.github.com/users/zhezhaoa/repos","events_url":"https://api.github.com/users/zhezhaoa/events{/privacy}","received_events_url":"https://api.github.com/users/zhezhaoa/received_events","type":"User","site_admin":false},"created_at":"2020-11-12T14:33:21Z","updated_at":"2020-11-12T14:33:21Z","author_association":"COLLABORATOR","body":"1. batch_size低的话，对模型训练会有一定的影响，不过不大。显存不够的话，可以尝试使用小模型。\r\n2. 现在只训练了1000步，应该继续训练，acc_mlm到70甚至80以上，再去下游任务微调，可能会有更好的效果。mlm这个任务比nsp更难，一般在大语料上，acc_mlm不会超过90\r\n3. 建议直接用一个经过shuffle的大语料进行训练，拆成多个小语料没有必要，效果可能会变差，因为模型会更偏向于学习后面训练的语料","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/726114757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zhezhaoa","id":10495098,"node_id":"MDQ6VXNlcjEwNDk1MDk4","avatar_url":"https://avatars.githubusercontent.com/u/10495098?v=4","gravatar_id":"","url":"https://api.github.com/users/zhezhaoa","html_url":"https://github.com/zhezhaoa","followers_url":"https://api.github.com/users/zhezhaoa/followers","following_url":"https://api.github.com/users/zhezhaoa/following{/other_user}","gists_url":"https://api.github.com/users/zhezhaoa/gists{/gist_id}","starred_url":"https://api.github.com/users/zhezhaoa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhezhaoa/subscriptions","organizations_url":"https://api.github.com/users/zhezhaoa/orgs","repos_url":"https://api.github.com/users/zhezhaoa/repos","events_url":"https://api.github.com/users/zhezhaoa/events{/privacy}","received_events_url":"https://api.github.com/users/zhezhaoa/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/751984540","html_url":"https://github.com/dbiir/UER-py/issues/75#issuecomment-751984540","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/75","id":751984540,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MTk4NDU0MA==","user":{"login":"mynewstart","id":21351024,"node_id":"MDQ6VXNlcjIxMzUxMDI0","avatar_url":"https://avatars.githubusercontent.com/u/21351024?v=4","gravatar_id":"","url":"https://api.github.com/users/mynewstart","html_url":"https://github.com/mynewstart","followers_url":"https://api.github.com/users/mynewstart/followers","following_url":"https://api.github.com/users/mynewstart/following{/other_user}","gists_url":"https://api.github.com/users/mynewstart/gists{/gist_id}","starred_url":"https://api.github.com/users/mynewstart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mynewstart/subscriptions","organizations_url":"https://api.github.com/users/mynewstart/orgs","repos_url":"https://api.github.com/users/mynewstart/repos","events_url":"https://api.github.com/users/mynewstart/events{/privacy}","received_events_url":"https://api.github.com/users/mynewstart/received_events","type":"User","site_admin":false},"created_at":"2020-12-29T07:49:14Z","updated_at":"2020-12-29T07:52:04Z","author_association":"NONE","body":"> 1. batch_size低的话，对模型训练会有一定的影响，不过不大。显存不够的话，可以尝试使用小模型。\r\n> 2. 现在只训练了1000步，应该继续训练，acc_mlm到70甚至80以上，再去下游任务微调，可能会有更好的效果。mlm这个任务比nsp更难，一般在大语料上，acc_mlm不会超过90\r\n> 3. 建议直接用一个经过shuffle的大语料进行训练，拆成多个小语料没有必要，效果可能会变差，因为模型会更偏向于学习后面训练的语料\r\n\r\n请问预训练是不是不支持wwm，如果要对robert-wwm进行预训练，直接使用现在的版本对效果有影响吗？如果不用nsp任务，预训练数据的格式可以是一行吗？","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/751984540/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mynewstart","id":21351024,"node_id":"MDQ6VXNlcjIxMzUxMDI0","avatar_url":"https://avatars.githubusercontent.com/u/21351024?v=4","gravatar_id":"","url":"https://api.github.com/users/mynewstart","html_url":"https://github.com/mynewstart","followers_url":"https://api.github.com/users/mynewstart/followers","following_url":"https://api.github.com/users/mynewstart/following{/other_user}","gists_url":"https://api.github.com/users/mynewstart/gists{/gist_id}","starred_url":"https://api.github.com/users/mynewstart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mynewstart/subscriptions","organizations_url":"https://api.github.com/users/mynewstart/orgs","repos_url":"https://api.github.com/users/mynewstart/repos","events_url":"https://api.github.com/users/mynewstart/events{/privacy}","received_events_url":"https://api.github.com/users/mynewstart/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/752064479","html_url":"https://github.com/dbiir/UER-py/issues/75#issuecomment-752064479","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/75","id":752064479,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjA2NDQ3OQ==","user":{"login":"zhezhaoa","id":10495098,"node_id":"MDQ6VXNlcjEwNDk1MDk4","avatar_url":"https://avatars.githubusercontent.com/u/10495098?v=4","gravatar_id":"","url":"https://api.github.com/users/zhezhaoa","html_url":"https://github.com/zhezhaoa","followers_url":"https://api.github.com/users/zhezhaoa/followers","following_url":"https://api.github.com/users/zhezhaoa/following{/other_user}","gists_url":"https://api.github.com/users/zhezhaoa/gists{/gist_id}","starred_url":"https://api.github.com/users/zhezhaoa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhezhaoa/subscriptions","organizations_url":"https://api.github.com/users/zhezhaoa/orgs","repos_url":"https://api.github.com/users/zhezhaoa/repos","events_url":"https://api.github.com/users/zhezhaoa/events{/privacy}","received_events_url":"https://api.github.com/users/zhezhaoa/received_events","type":"User","site_admin":false},"created_at":"2020-12-29T12:51:37Z","updated_at":"2020-12-29T12:51:37Z","author_association":"COLLABORATOR","body":"> > 1. batch_size低的话，对模型训练会有一定的影响，不过不大。显存不够的话，可以尝试使用小模型。\r\n> > 2. 现在只训练了1000步，应该继续训练，acc_mlm到70甚至80以上，再去下游任务微调，可能会有更好的效果。mlm这个任务比nsp更难，一般在大语料上，acc_mlm不会超过90\r\n> > 3. 建议直接用一个经过shuffle的大语料进行训练，拆成多个小语料没有必要，效果可能会变差，因为模型会更偏向于学习后面训练的语料\r\n> \r\n> 请问预训练是不是不支持wwm，如果要对robert-wwm进行预训练，直接使用现在的版本对效果有影响吗？如果不用nsp任务，预训练数据的格式可以是一行吗？\r\n\r\n目前开源的版本不支持WWM\r\n可以直接加载WWM预训练模型进行预训练，模型会很快收敛\r\nquick start和instructions中给出了不同targets的使用示例（以及需要的语料格式），如果使用`--target mlm`，语料的格式是一行一个文档，和`--target bert`需要的语料格式不一样","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/752064479/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zhezhaoa","id":10495098,"node_id":"MDQ6VXNlcjEwNDk1MDk4","avatar_url":"https://avatars.githubusercontent.com/u/10495098?v=4","gravatar_id":"","url":"https://api.github.com/users/zhezhaoa","html_url":"https://github.com/zhezhaoa","followers_url":"https://api.github.com/users/zhezhaoa/followers","following_url":"https://api.github.com/users/zhezhaoa/following{/other_user}","gists_url":"https://api.github.com/users/zhezhaoa/gists{/gist_id}","starred_url":"https://api.github.com/users/zhezhaoa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhezhaoa/subscriptions","organizations_url":"https://api.github.com/users/zhezhaoa/orgs","repos_url":"https://api.github.com/users/zhezhaoa/repos","events_url":"https://api.github.com/users/zhezhaoa/events{/privacy}","received_events_url":"https://api.github.com/users/zhezhaoa/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/810715647","html_url":"https://github.com/dbiir/UER-py/issues/75#issuecomment-810715647","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/75","id":810715647,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDcxNTY0Nw==","user":{"login":"SuMeng123","id":29936015,"node_id":"MDQ6VXNlcjI5OTM2MDE1","avatar_url":"https://avatars.githubusercontent.com/u/29936015?v=4","gravatar_id":"","url":"https://api.github.com/users/SuMeng123","html_url":"https://github.com/SuMeng123","followers_url":"https://api.github.com/users/SuMeng123/followers","following_url":"https://api.github.com/users/SuMeng123/following{/other_user}","gists_url":"https://api.github.com/users/SuMeng123/gists{/gist_id}","starred_url":"https://api.github.com/users/SuMeng123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SuMeng123/subscriptions","organizations_url":"https://api.github.com/users/SuMeng123/orgs","repos_url":"https://api.github.com/users/SuMeng123/repos","events_url":"https://api.github.com/users/SuMeng123/events{/privacy}","received_events_url":"https://api.github.com/users/SuMeng123/received_events","type":"User","site_admin":false},"created_at":"2021-03-31T02:43:48Z","updated_at":"2021-03-31T03:00:01Z","author_association":"NONE","body":"> 增量预训练，语料比较小的话（几十兆），5万步左右就可以；语料较大的话，10万步以上。可以每隔1万步就存一个checkpoint，尝试不同的checkpoint的效果\r\n\r\n请问bert在预训练的时候比如有warm up机制，学习率会随着step变化而变化。在做增量训练的时候，当前step是不是又得从1开始，使得学习率初期不断变得很大。比如预训练total_step=500w, 和第一次预训练total_step=250w,增量训练又一次250w，这两者是不是还是有区别的，比如warmup导致的学习率的变化。\r\n@zhezhaoa ","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/810715647/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"SuMeng123","id":29936015,"node_id":"MDQ6VXNlcjI5OTM2MDE1","avatar_url":"https://avatars.githubusercontent.com/u/29936015?v=4","gravatar_id":"","url":"https://api.github.com/users/SuMeng123","html_url":"https://github.com/SuMeng123","followers_url":"https://api.github.com/users/SuMeng123/followers","following_url":"https://api.github.com/users/SuMeng123/following{/other_user}","gists_url":"https://api.github.com/users/SuMeng123/gists{/gist_id}","starred_url":"https://api.github.com/users/SuMeng123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SuMeng123/subscriptions","organizations_url":"https://api.github.com/users/SuMeng123/orgs","repos_url":"https://api.github.com/users/SuMeng123/repos","events_url":"https://api.github.com/users/SuMeng123/events{/privacy}","received_events_url":"https://api.github.com/users/SuMeng123/received_events","type":"User","site_admin":false}},{"id":4531628123,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDUzMTYyODEyMw==","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/4531628123","actor":{"login":"zhezhaoa","id":10495098,"node_id":"MDQ6VXNlcjEwNDk1MDk4","avatar_url":"https://avatars.githubusercontent.com/u/10495098?v=4","gravatar_id":"","url":"https://api.github.com/users/zhezhaoa","html_url":"https://github.com/zhezhaoa","followers_url":"https://api.github.com/users/zhezhaoa/followers","following_url":"https://api.github.com/users/zhezhaoa/following{/other_user}","gists_url":"https://api.github.com/users/zhezhaoa/gists{/gist_id}","starred_url":"https://api.github.com/users/zhezhaoa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhezhaoa/subscriptions","organizations_url":"https://api.github.com/users/zhezhaoa/orgs","repos_url":"https://api.github.com/users/zhezhaoa/repos","events_url":"https://api.github.com/users/zhezhaoa/events{/privacy}","received_events_url":"https://api.github.com/users/zhezhaoa/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-31T03:00:02Z","performed_via_github_app":null},{"id":4531628129,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1MzE2MjgxMjk=","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/4531628129","actor":{"login":"zhezhaoa","id":10495098,"node_id":"MDQ6VXNlcjEwNDk1MDk4","avatar_url":"https://avatars.githubusercontent.com/u/10495098?v=4","gravatar_id":"","url":"https://api.github.com/users/zhezhaoa","html_url":"https://github.com/zhezhaoa","followers_url":"https://api.github.com/users/zhezhaoa/followers","following_url":"https://api.github.com/users/zhezhaoa/following{/other_user}","gists_url":"https://api.github.com/users/zhezhaoa/gists{/gist_id}","starred_url":"https://api.github.com/users/zhezhaoa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhezhaoa/subscriptions","organizations_url":"https://api.github.com/users/zhezhaoa/orgs","repos_url":"https://api.github.com/users/zhezhaoa/repos","events_url":"https://api.github.com/users/zhezhaoa/events{/privacy}","received_events_url":"https://api.github.com/users/zhezhaoa/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-31T03:00:02Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/1120236367","html_url":"https://github.com/dbiir/UER-py/issues/75#issuecomment-1120236367","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/75","id":1120236367,"node_id":"IC_kwDOCsNQKM5CxXNP","user":{"login":"Creative-Ataraxia","id":102127487,"node_id":"U_kgDOBhZXfw","avatar_url":"https://avatars.githubusercontent.com/u/102127487?v=4","gravatar_id":"","url":"https://api.github.com/users/Creative-Ataraxia","html_url":"https://github.com/Creative-Ataraxia","followers_url":"https://api.github.com/users/Creative-Ataraxia/followers","following_url":"https://api.github.com/users/Creative-Ataraxia/following{/other_user}","gists_url":"https://api.github.com/users/Creative-Ataraxia/gists{/gist_id}","starred_url":"https://api.github.com/users/Creative-Ataraxia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Creative-Ataraxia/subscriptions","organizations_url":"https://api.github.com/users/Creative-Ataraxia/orgs","repos_url":"https://api.github.com/users/Creative-Ataraxia/repos","events_url":"https://api.github.com/users/Creative-Ataraxia/events{/privacy}","received_events_url":"https://api.github.com/users/Creative-Ataraxia/received_events","type":"User","site_admin":false},"created_at":"2022-05-07T16:24:21Z","updated_at":"2022-05-07T16:24:21Z","author_association":"CONTRIBUTOR","body":"> 我试图用colab的GPU做pretraining， 一直有 out of memory 问题，我将batch_size降为了8，请问这是否会影响收敛或者训练精度？除了batch_size还有哪些参数会影响memory，可以适度调整呢？ 我尝试了一下1000 steps，这是结果，由于我的目标是做sentences classification，请问我是不是应该看loss_mlm和acc_mlm？鉴于acc_nsp很高而acc_mlm还尚且较低，我是否应该继续训练？可以用这个训练了1000步数的model去继续训练吗？还是要用原始model？acc_mlm会像acc_nsp一样升至接近1吗？ | 100/ 1000 steps| 3920.18 tokens/s| loss 3.01| loss_mlm: 2.799| loss_nsp: 0.213| acc_mlm: 0.539| acc_nsp: 0.953 | 200/ 1000 steps| 3844.70 tokens/s| loss 2.34| loss_mlm: 2.340| loss_nsp: 0.000| acc_mlm: 0.567| acc_nsp: 1.000 | 300/ 1000 steps| 3826.02 tokens/s| loss 2.20| loss_mlm: 2.200| loss_nsp: 0.000| acc_mlm: 0.590| acc_nsp: 1.000 | 400/ 1000 steps| 3824.49 tokens/s| loss 2.16| loss_mlm: 2.160| loss_nsp: 0.002| acc_mlm: 0.593| acc_nsp: 0.999 | 500/ 1000 steps| 3834.08 tokens/s| loss 2.11| loss_mlm: 2.097| loss_nsp: 0.015| acc_mlm: 0.602| acc_nsp: 0.999 | 600/ 1000 steps| 3823.78 tokens/s| loss 2.11| loss_mlm: 2.112| loss_nsp: 0.000| acc_mlm: 0.598| acc_nsp: 1.000 | 700/ 1000 steps| 3814.49 tokens/s| loss 2.06| loss_mlm: 2.056| loss_nsp: 0.002| acc_mlm: 0.609| acc_nsp: 0.999 | 800/ 1000 steps| 3828.94 tokens/s| loss 2.03| loss_mlm: 2.033| loss_nsp: 0.000| acc_mlm: 0.611| acc_nsp: 1.000 | 900/ 1000 steps| 3823.42 tokens/s| loss 2.07| loss_mlm: 2.061| loss_nsp: 0.011| acc_mlm: 0.604| acc_nsp: 0.998 | 1000/ 1000 steps| 3830.61 tokens/s| loss 2.06| loss_mlm: 2.055| loss_nsp: 0.000| acc_mlm: 0.608| acc_nsp: 1.000 另外还想请教，如果有一个很大的语料文件，是否可以将它拆分成许多个小文件？这样每个小语料文件可以用很少的步数pretrain到收敛，一个语料训练至收敛得到一个新model后，用余下的新小语料文件再pretraining这个新model。请问这样做和用一个大的语料文件相比是否结果会有区别？ 多谢！\r\n\r\n我也一直有Cuda out of memory的问题，请问您这边一般常规本地单GPU训练的话，现存一般是会占用多少呢？除了减少batch_size, 和用小模型之外，是否还有别的减少VRAM占用的方式？（我现在是8GB VRAM，大部分训练会Cuda out of memory :(","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/1120236367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Creative-Ataraxia","id":102127487,"node_id":"U_kgDOBhZXfw","avatar_url":"https://avatars.githubusercontent.com/u/102127487?v=4","gravatar_id":"","url":"https://api.github.com/users/Creative-Ataraxia","html_url":"https://github.com/Creative-Ataraxia","followers_url":"https://api.github.com/users/Creative-Ataraxia/followers","following_url":"https://api.github.com/users/Creative-Ataraxia/following{/other_user}","gists_url":"https://api.github.com/users/Creative-Ataraxia/gists{/gist_id}","starred_url":"https://api.github.com/users/Creative-Ataraxia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Creative-Ataraxia/subscriptions","organizations_url":"https://api.github.com/users/Creative-Ataraxia/orgs","repos_url":"https://api.github.com/users/Creative-Ataraxia/repos","events_url":"https://api.github.com/users/Creative-Ataraxia/events{/privacy}","received_events_url":"https://api.github.com/users/Creative-Ataraxia/received_events","type":"User","site_admin":false}}]