[{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/1001347780","html_url":"https://github.com/dbiir/UER-py/issues/241#issuecomment-1001347780","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/241","id":1001347780,"node_id":"IC_kwDOCsNQKM47r1rE","user":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"created_at":"2021-12-27T05:42:04Z","updated_at":"2021-12-27T05:42:04Z","author_association":"COLLABORATOR","body":"1.是的，使用相同格式即可\r\n2.分词器选择和原模型保持一致即可\r\n我看了Facebook 的BART-base应该是用了bpe tokenzier\r\n您需要在预处理和预训练时指定--tokenizer bpe --vocab_path models/huggingface_gpt2_vocab.txt --merges_path models/huggingface_gpt2_merges.txt\r\nvocab_path和merges_path对应huggingface仓库中的vocab.json和merges.txt\r\nvocab.json需要转换成对应的txt文件\r\n3.同上\r\n4.可以先尝试使用中文样例中的配置，观察一下效果","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/1001347780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/1002111760","html_url":"https://github.com/dbiir/UER-py/issues/241#issuecomment-1002111760","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/241","id":1002111760,"node_id":"IC_kwDOCsNQKM47uwMQ","user":{"login":"PALIN2018","id":35458200,"node_id":"MDQ6VXNlcjM1NDU4MjAw","avatar_url":"https://avatars.githubusercontent.com/u/35458200?v=4","gravatar_id":"","url":"https://api.github.com/users/PALIN2018","html_url":"https://github.com/PALIN2018","followers_url":"https://api.github.com/users/PALIN2018/followers","following_url":"https://api.github.com/users/PALIN2018/following{/other_user}","gists_url":"https://api.github.com/users/PALIN2018/gists{/gist_id}","starred_url":"https://api.github.com/users/PALIN2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PALIN2018/subscriptions","organizations_url":"https://api.github.com/users/PALIN2018/orgs","repos_url":"https://api.github.com/users/PALIN2018/repos","events_url":"https://api.github.com/users/PALIN2018/events{/privacy}","received_events_url":"https://api.github.com/users/PALIN2018/received_events","type":"User","site_admin":false},"created_at":"2021-12-28T13:42:03Z","updated_at":"2021-12-29T06:51:17Z","author_association":"NONE","body":"@hhou435 \r\n感谢您的回复！我目前使用单机多卡进行预训练，但出现了严重的负载不均衡的问题，请问您是否有解决思路呢？谢谢！\r\n加载的是Facebook 的bart-base，batchsize=24，seq_length=128\r\n\r\n![37571640691140_ pic_hd](https://user-images.githubusercontent.com/35458200/147572268-66638c60-c49e-4d30-ba5c-889a2d2eef7e.jpg)\r\n","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/1002111760/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"PALIN2018","id":35458200,"node_id":"MDQ6VXNlcjM1NDU4MjAw","avatar_url":"https://avatars.githubusercontent.com/u/35458200?v=4","gravatar_id":"","url":"https://api.github.com/users/PALIN2018","html_url":"https://github.com/PALIN2018","followers_url":"https://api.github.com/users/PALIN2018/followers","following_url":"https://api.github.com/users/PALIN2018/following{/other_user}","gists_url":"https://api.github.com/users/PALIN2018/gists{/gist_id}","starred_url":"https://api.github.com/users/PALIN2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PALIN2018/subscriptions","organizations_url":"https://api.github.com/users/PALIN2018/orgs","repos_url":"https://api.github.com/users/PALIN2018/repos","events_url":"https://api.github.com/users/PALIN2018/events{/privacy}","received_events_url":"https://api.github.com/users/PALIN2018/received_events","type":"User","site_admin":false}},{"id":5823583551,"node_id":"MEE_lADOCsNQKM5AskxyzwAAAAFbHNU_","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/5823583551","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-12-29T06:51:17Z","performed_via_github_app":null},{"id":5823583555,"node_id":"SE_lADOCsNQKM5AskxyzwAAAAFbHNVD","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/5823583555","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-12-29T06:51:17Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/1002647572","html_url":"https://github.com/dbiir/UER-py/issues/241#issuecomment-1002647572","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/241","id":1002647572,"node_id":"IC_kwDOCsNQKM47wzAU","user":{"login":"Abigail61","id":58318782,"node_id":"MDQ6VXNlcjU4MzE4Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/58318782?v=4","gravatar_id":"","url":"https://api.github.com/users/Abigail61","html_url":"https://github.com/Abigail61","followers_url":"https://api.github.com/users/Abigail61/followers","following_url":"https://api.github.com/users/Abigail61/following{/other_user}","gists_url":"https://api.github.com/users/Abigail61/gists{/gist_id}","starred_url":"https://api.github.com/users/Abigail61/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Abigail61/subscriptions","organizations_url":"https://api.github.com/users/Abigail61/orgs","repos_url":"https://api.github.com/users/Abigail61/repos","events_url":"https://api.github.com/users/Abigail61/events{/privacy}","received_events_url":"https://api.github.com/users/Abigail61/received_events","type":"User","site_admin":false},"created_at":"2021-12-29T15:24:58Z","updated_at":"2021-12-29T15:51:46Z","author_association":"NONE","body":"您好~  想根据您的回答补充几个问题，还烦请指教\r\n1.请问一下在指定bpe tokenzier的过程中，好像代码有报错，模型中不存在bpe。\r\npreprocess.py: error: argument --tokenizer: invalid choice: 'bpe' (choose from 'bert', 'char', 'space', 'xlmroberta')，\r\n\r\n是需要像wiki文档里指出的使用另外指定的tokenizer，\"通过 --spm_model_path 指定sentencepiece模型路径，然后导入sentencepiece模块，加载sentencepiece模型，对句子进行切分\"来指定另外的tokenizer吗？\r\n如果是的话，想要使用huggingface transformer的tokenizer模型的话该怎么导入呢？\r\n\r\n2. --merges_path参数似乎在preprocess和pretrain中都不存在，该怎么办呢？","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/1002647572/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Abigail61","id":58318782,"node_id":"MDQ6VXNlcjU4MzE4Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/58318782?v=4","gravatar_id":"","url":"https://api.github.com/users/Abigail61","html_url":"https://github.com/Abigail61","followers_url":"https://api.github.com/users/Abigail61/followers","following_url":"https://api.github.com/users/Abigail61/following{/other_user}","gists_url":"https://api.github.com/users/Abigail61/gists{/gist_id}","starred_url":"https://api.github.com/users/Abigail61/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Abigail61/subscriptions","organizations_url":"https://api.github.com/users/Abigail61/orgs","repos_url":"https://api.github.com/users/Abigail61/repos","events_url":"https://api.github.com/users/Abigail61/events{/privacy}","received_events_url":"https://api.github.com/users/Abigail61/received_events","type":"User","site_admin":false}},{"actor":{"login":"PALIN2018","id":35458200,"node_id":"MDQ6VXNlcjM1NDU4MjAw","avatar_url":"https://avatars.githubusercontent.com/u/35458200?v=4","gravatar_id":"","url":"https://api.github.com/users/PALIN2018","html_url":"https://github.com/PALIN2018","followers_url":"https://api.github.com/users/PALIN2018/followers","following_url":"https://api.github.com/users/PALIN2018/following{/other_user}","gists_url":"https://api.github.com/users/PALIN2018/gists{/gist_id}","starred_url":"https://api.github.com/users/PALIN2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PALIN2018/subscriptions","organizations_url":"https://api.github.com/users/PALIN2018/orgs","repos_url":"https://api.github.com/users/PALIN2018/repos","events_url":"https://api.github.com/users/PALIN2018/events{/privacy}","received_events_url":"https://api.github.com/users/PALIN2018/received_events","type":"User","site_admin":false},"created_at":"2021-12-30T07:38:05Z","updated_at":"2021-12-30T07:38:05Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/246","repository_url":"https://api.github.com/repos/dbiir/UER-py","labels_url":"https://api.github.com/repos/dbiir/UER-py/issues/246/labels{/name}","comments_url":"https://api.github.com/repos/dbiir/UER-py/issues/246/comments","events_url":"https://api.github.com/repos/dbiir/UER-py/issues/246/events","html_url":"https://github.com/dbiir/UER-py/issues/246","id":1090427080,"node_id":"I_kwDOCsNQKM5A_pjI","number":246,"title":"多卡运行时，显存负载不均衡，且随着卡的数量增加，第一张卡的显存占用会变大","user":{"login":"cdd1993","id":28085921,"node_id":"MDQ6VXNlcjI4MDg1OTIx","avatar_url":"https://avatars.githubusercontent.com/u/28085921?v=4","gravatar_id":"","url":"https://api.github.com/users/cdd1993","html_url":"https://github.com/cdd1993","followers_url":"https://api.github.com/users/cdd1993/followers","following_url":"https://api.github.com/users/cdd1993/following{/other_user}","gists_url":"https://api.github.com/users/cdd1993/gists{/gist_id}","starred_url":"https://api.github.com/users/cdd1993/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdd1993/subscriptions","organizations_url":"https://api.github.com/users/cdd1993/orgs","repos_url":"https://api.github.com/users/cdd1993/repos","events_url":"https://api.github.com/users/cdd1993/events{/privacy}","received_events_url":"https://api.github.com/users/cdd1993/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2021-12-29T10:38:05Z","updated_at":"2022-02-06T16:09:48Z","closed_at":"2022-02-06T16:09:48Z","author_association":"NONE","active_lock_reason":null,"repository":{"id":180572200,"node_id":"MDEwOlJlcG9zaXRvcnkxODA1NzIyMDA=","name":"UER-py","full_name":"dbiir/UER-py","private":false,"owner":{"login":"dbiir","id":13671736,"node_id":"MDEyOk9yZ2FuaXphdGlvbjEzNjcxNzM2","avatar_url":"https://avatars.githubusercontent.com/u/13671736?v=4","gravatar_id":"","url":"https://api.github.com/users/dbiir","html_url":"https://github.com/dbiir","followers_url":"https://api.github.com/users/dbiir/followers","following_url":"https://api.github.com/users/dbiir/following{/other_user}","gists_url":"https://api.github.com/users/dbiir/gists{/gist_id}","starred_url":"https://api.github.com/users/dbiir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbiir/subscriptions","organizations_url":"https://api.github.com/users/dbiir/orgs","repos_url":"https://api.github.com/users/dbiir/repos","events_url":"https://api.github.com/users/dbiir/events{/privacy}","received_events_url":"https://api.github.com/users/dbiir/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/dbiir/UER-py","description":"Open Source Pre-training Model Framework in PyTorch & Pre-trained Model Zoo","fork":false,"url":"https://api.github.com/repos/dbiir/UER-py","forks_url":"https://api.github.com/repos/dbiir/UER-py/forks","keys_url":"https://api.github.com/repos/dbiir/UER-py/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dbiir/UER-py/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dbiir/UER-py/teams","hooks_url":"https://api.github.com/repos/dbiir/UER-py/hooks","issue_events_url":"https://api.github.com/repos/dbiir/UER-py/issues/events{/number}","events_url":"https://api.github.com/repos/dbiir/UER-py/events","assignees_url":"https://api.github.com/repos/dbiir/UER-py/assignees{/user}","branches_url":"https://api.github.com/repos/dbiir/UER-py/branches{/branch}","tags_url":"https://api.github.com/repos/dbiir/UER-py/tags","blobs_url":"https://api.github.com/repos/dbiir/UER-py/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dbiir/UER-py/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dbiir/UER-py/git/refs{/sha}","trees_url":"https://api.github.com/repos/dbiir/UER-py/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dbiir/UER-py/statuses/{sha}","languages_url":"https://api.github.com/repos/dbiir/UER-py/languages","stargazers_url":"https://api.github.com/repos/dbiir/UER-py/stargazers","contributors_url":"https://api.github.com/repos/dbiir/UER-py/contributors","subscribers_url":"https://api.github.com/repos/dbiir/UER-py/subscribers","subscription_url":"https://api.github.com/repos/dbiir/UER-py/subscription","commits_url":"https://api.github.com/repos/dbiir/UER-py/commits{/sha}","git_commits_url":"https://api.github.com/repos/dbiir/UER-py/git/commits{/sha}","comments_url":"https://api.github.com/repos/dbiir/UER-py/comments{/number}","issue_comment_url":"https://api.github.com/repos/dbiir/UER-py/issues/comments{/number}","contents_url":"https://api.github.com/repos/dbiir/UER-py/contents/{+path}","compare_url":"https://api.github.com/repos/dbiir/UER-py/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dbiir/UER-py/merges","archive_url":"https://api.github.com/repos/dbiir/UER-py/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dbiir/UER-py/downloads","issues_url":"https://api.github.com/repos/dbiir/UER-py/issues{/number}","pulls_url":"https://api.github.com/repos/dbiir/UER-py/pulls{/number}","milestones_url":"https://api.github.com/repos/dbiir/UER-py/milestones{/number}","notifications_url":"https://api.github.com/repos/dbiir/UER-py/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dbiir/UER-py/labels{/name}","releases_url":"https://api.github.com/repos/dbiir/UER-py/releases{/id}","deployments_url":"https://api.github.com/repos/dbiir/UER-py/deployments","created_at":"2019-04-10T12:00:20Z","updated_at":"2023-01-18T15:42:49Z","pushed_at":"2022-10-20T06:04:29Z","git_url":"git://github.com/dbiir/UER-py.git","ssh_url":"git@github.com:dbiir/UER-py.git","clone_url":"https://github.com/dbiir/UER-py.git","svn_url":"https://github.com/dbiir/UER-py","homepage":"https://github.com/dbiir/UER-py/wiki","size":47948,"stargazers_count":2369,"watchers_count":2369,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":427,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":121,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["albert","bart","bert","chinese","classification","clue","elmo","fine-tuning","gpt","gpt-2","model-zoo","natural-language-processing","ner","pegasus","pre-training","pytorch","roberta","t5","unilm","xlm-roberta"],"visibility":"public","forks":427,"open_issues":121,"watchers":2369,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"![gpu_2](https://user-images.githubusercontent.com/28085921/147653495-d8d3261d-83ad-4079-b337-47b3cdc0bd40.png)\r\n![gpu_7](https://user-images.githubusercontent.com/28085921/147653497-9dca6b63-2a34-4644-8790-32c56a37a92f.png)\r\n发现随着训练用的GPU的数量增加，第一张显卡的显存不均衡情况会更加明显，请问作者开源的时候有这个情况吗，是distributed dataparallel哪里参数有问题吗。","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dbiir/UER-py/issues/246/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/1002932181","html_url":"https://github.com/dbiir/UER-py/issues/241#issuecomment-1002932181","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/241","id":1002932181,"node_id":"IC_kwDOCsNQKM47x4fV","user":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"created_at":"2021-12-30T08:56:09Z","updated_at":"2021-12-30T08:56:09Z","author_association":"COLLABORATOR","body":"> @hhou435 感谢您的回复！我目前使用单机多卡进行预训练，但出现了严重的负载不均衡的问题，请问您是否有解决思路呢？谢谢！ 加载的是Facebook 的bart-base，batchsize=24，seq_length=128\r\n> \r\n> ![37571640691140_ pic_hd](https://user-images.githubusercontent.com/35458200/147572268-66638c60-c49e-4d30-ba5c-889a2d2eef7e.jpg)\r\n\r\n您好，我们训练BART的时候没出现这个问题，您可以提供一下训练命令，我们尝试复现一下","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/1002932181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false}},{"id":5827199546,"node_id":"MEE_lADOCsNQKM5AskxyzwAAAAFbVAI6","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/5827199546","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-12-30T08:56:10Z","performed_via_github_app":null},{"id":5827199548,"node_id":"SE_lADOCsNQKM5AskxyzwAAAAFbVAI8","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/5827199548","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-12-30T08:56:10Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/1002932427","html_url":"https://github.com/dbiir/UER-py/issues/241#issuecomment-1002932427","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/241","id":1002932427,"node_id":"IC_kwDOCsNQKM47x4jL","user":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"created_at":"2021-12-30T08:56:43Z","updated_at":"2021-12-30T08:56:43Z","author_association":"COLLABORATOR","body":"> 您好~ 想根据您的回答补充几个问题，还烦请指教 1.请问一下在指定bpe tokenzier的过程中，好像代码有报错，模型中不存在bpe。 preprocess.py: error: argument --tokenizer: invalid choice: 'bpe' (choose from 'bert', 'char', 'space', 'xlmroberta')，\r\n> \r\n> 是需要像wiki文档里指出的使用另外指定的tokenizer，\"通过 --spm_model_path 指定sentencepiece模型路径，然后导入sentencepiece模块，加载sentencepiece模型，对句子进行切分\"来指定另外的tokenizer吗？ 如果是的话，想要使用huggingface transformer的tokenizer模型的话该怎么导入呢？\r\n> \r\n> 2. --merges_path参数似乎在preprocess和pretrain中都不存在，该怎么办呢？\r\n\r\n您好，需要下载最新版本才可以使用bpe tokenizer","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/1002932427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/1003523564","html_url":"https://github.com/dbiir/UER-py/issues/241#issuecomment-1003523564","issue_url":"https://api.github.com/repos/dbiir/UER-py/issues/241","id":1003523564,"node_id":"IC_kwDOCsNQKM470I3s","user":{"login":"PALIN2018","id":35458200,"node_id":"MDQ6VXNlcjM1NDU4MjAw","avatar_url":"https://avatars.githubusercontent.com/u/35458200?v=4","gravatar_id":"","url":"https://api.github.com/users/PALIN2018","html_url":"https://github.com/PALIN2018","followers_url":"https://api.github.com/users/PALIN2018/followers","following_url":"https://api.github.com/users/PALIN2018/following{/other_user}","gists_url":"https://api.github.com/users/PALIN2018/gists{/gist_id}","starred_url":"https://api.github.com/users/PALIN2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PALIN2018/subscriptions","organizations_url":"https://api.github.com/users/PALIN2018/orgs","repos_url":"https://api.github.com/users/PALIN2018/repos","events_url":"https://api.github.com/users/PALIN2018/events{/privacy}","received_events_url":"https://api.github.com/users/PALIN2018/received_events","type":"User","site_admin":false},"created_at":"2022-01-01T08:09:46Z","updated_at":"2022-01-01T08:10:15Z","author_association":"NONE","body":"> > @hhou435 感谢您的回复！我目前使用单机多卡进行预训练，但出现了严重的负载不均衡的问题，请问您是否有解决思路呢？谢谢！ 加载的是Facebook 的bart-base，batchsize=24，seq_length=128\r\n> > ![37571640691140_ pic_hd](https://user-images.githubusercontent.com/35458200/147572268-66638c60-c49e-4d30-ba5c-889a2d2eef7e.jpg)\r\n> \r\n> 您好，我们训练BART的时候没出现这个问题，您可以提供一下训练命令，我们尝试复现一下\r\n\r\n@hhou435 您好，祝您新年快乐！我们预训练BART的采用的是增量预训练的方式，即先使用您提供的转换代码将hugging face上的facebook 提供的预训练好的bart-base模型转换为uer格式，然后使用如下指令进行预训练，您复现可以尝试这种增量预训练的方式。\r\npython pretrain.py --dataset_path ${model_name}pretrain_10000.pt \r\n--tokenizer bpe \r\n--merges_path huggingface_pretrained_models/${model_name}/merges.txt \r\n--total_steps ${total_steps} \r\n--save_checkpoint_steps 1000 \r\n--config_path models/${model_type}/${model_name}config.json \r\n--vocab_path huggingface_pretrained_models/${model_name}/vocab.txt \r\n--pretrained_model_path models/${model_type}/${model_name}.bin \r\n--output_model_path models/${model_type}/tweet${model_type}${model_size}model.bin \r\n--world_size 7 --gpu_ranks 0 1 2 3 4 5 6 --learning_rate 2e-5 \r\n--batch_size ${batch_size} \r\n--embedding word_pos_seg --encoder transformer --mask fully_visible --target mlm > exp_log/m${model_name}bs${batch_size}ts${total_steps}_multi_gpu.log 2>&1 非常感谢","reactions":{"url":"https://api.github.com/repos/dbiir/UER-py/issues/comments/1003523564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"PALIN2018","id":35458200,"node_id":"MDQ6VXNlcjM1NDU4MjAw","avatar_url":"https://avatars.githubusercontent.com/u/35458200?v=4","gravatar_id":"","url":"https://api.github.com/users/PALIN2018","html_url":"https://github.com/PALIN2018","followers_url":"https://api.github.com/users/PALIN2018/followers","following_url":"https://api.github.com/users/PALIN2018/following{/other_user}","gists_url":"https://api.github.com/users/PALIN2018/gists{/gist_id}","starred_url":"https://api.github.com/users/PALIN2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PALIN2018/subscriptions","organizations_url":"https://api.github.com/users/PALIN2018/orgs","repos_url":"https://api.github.com/users/PALIN2018/repos","events_url":"https://api.github.com/users/PALIN2018/events{/privacy}","received_events_url":"https://api.github.com/users/PALIN2018/received_events","type":"User","site_admin":false}},{"id":5831468107,"node_id":"MEE_lADOCsNQKM5AskxyzwAAAAFblSRL","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/5831468107","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-01-01T08:09:46Z","performed_via_github_app":null},{"id":5831468109,"node_id":"SE_lADOCsNQKM5AskxyzwAAAAFblSRN","url":"https://api.github.com/repos/dbiir/UER-py/issues/events/5831468109","actor":{"login":"hhou435","id":59219579,"node_id":"MDQ6VXNlcjU5MjE5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/59219579?v=4","gravatar_id":"","url":"https://api.github.com/users/hhou435","html_url":"https://github.com/hhou435","followers_url":"https://api.github.com/users/hhou435/followers","following_url":"https://api.github.com/users/hhou435/following{/other_user}","gists_url":"https://api.github.com/users/hhou435/gists{/gist_id}","starred_url":"https://api.github.com/users/hhou435/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhou435/subscriptions","organizations_url":"https://api.github.com/users/hhou435/orgs","repos_url":"https://api.github.com/users/hhou435/repos","events_url":"https://api.github.com/users/hhou435/events{/privacy}","received_events_url":"https://api.github.com/users/hhou435/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-01-01T08:09:47Z","performed_via_github_app":null}]