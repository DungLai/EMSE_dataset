{"url":"https://api.github.com/repos/plasticityai/magnitude/issues/10","repository_url":"https://api.github.com/repos/plasticityai/magnitude","labels_url":"https://api.github.com/repos/plasticityai/magnitude/issues/10/labels{/name}","comments_url":"https://api.github.com/repos/plasticityai/magnitude/issues/10/comments","events_url":"https://api.github.com/repos/plasticityai/magnitude/issues/10/events","html_url":"https://github.com/plasticityai/magnitude/issues/10","id":324521715,"node_id":"MDU6SXNzdWUzMjQ1MjE3MTU=","number":10,"title":"Query time slower than gensim?","user":{"login":"DomHudson","id":10864294,"node_id":"MDQ6VXNlcjEwODY0Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/10864294?v=4","gravatar_id":"","url":"https://api.github.com/users/DomHudson","html_url":"https://github.com/DomHudson","followers_url":"https://api.github.com/users/DomHudson/followers","following_url":"https://api.github.com/users/DomHudson/following{/other_user}","gists_url":"https://api.github.com/users/DomHudson/gists{/gist_id}","starred_url":"https://api.github.com/users/DomHudson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomHudson/subscriptions","organizations_url":"https://api.github.com/users/DomHudson/orgs","repos_url":"https://api.github.com/users/DomHudson/repos","events_url":"https://api.github.com/users/DomHudson/events{/privacy}","received_events_url":"https://api.github.com/users/DomHudson/received_events","type":"User","site_admin":false},"labels":[{"id":846895365,"node_id":"MDU6TGFiZWw4NDY4OTUzNjU=","url":"https://api.github.com/repos/plasticityai/magnitude/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"},{"id":937717439,"node_id":"MDU6TGFiZWw5Mzc3MTc0Mzk=","url":"https://api.github.com/repos/plasticityai/magnitude/labels/optimization","name":"optimization","color":"2fc691","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"AjayP13","id":5404177,"node_id":"MDQ6VXNlcjU0MDQxNzc=","avatar_url":"https://avatars.githubusercontent.com/u/5404177?v=4","gravatar_id":"","url":"https://api.github.com/users/AjayP13","html_url":"https://github.com/AjayP13","followers_url":"https://api.github.com/users/AjayP13/followers","following_url":"https://api.github.com/users/AjayP13/following{/other_user}","gists_url":"https://api.github.com/users/AjayP13/gists{/gist_id}","starred_url":"https://api.github.com/users/AjayP13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AjayP13/subscriptions","organizations_url":"https://api.github.com/users/AjayP13/orgs","repos_url":"https://api.github.com/users/AjayP13/repos","events_url":"https://api.github.com/users/AjayP13/events{/privacy}","received_events_url":"https://api.github.com/users/AjayP13/received_events","type":"User","site_admin":false},"assignees":[{"login":"AjayP13","id":5404177,"node_id":"MDQ6VXNlcjU0MDQxNzc=","avatar_url":"https://avatars.githubusercontent.com/u/5404177?v=4","gravatar_id":"","url":"https://api.github.com/users/AjayP13","html_url":"https://github.com/AjayP13","followers_url":"https://api.github.com/users/AjayP13/followers","following_url":"https://api.github.com/users/AjayP13/following{/other_user}","gists_url":"https://api.github.com/users/AjayP13/gists{/gist_id}","starred_url":"https://api.github.com/users/AjayP13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AjayP13/subscriptions","organizations_url":"https://api.github.com/users/AjayP13/orgs","repos_url":"https://api.github.com/users/AjayP13/repos","events_url":"https://api.github.com/users/AjayP13/events{/privacy}","received_events_url":"https://api.github.com/users/AjayP13/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2018-05-18T19:11:40Z","updated_at":"2018-05-23T14:27:24Z","closed_at":"2018-05-20T17:39:55Z","author_association":"NONE","active_lock_reason":null,"body":"Hi!\r\n\r\nI really hope this question doesn't come across as critical - I think this project is a great idea and really loving the speed at which it can lazy-load models. \r\n\r\nI had one question - loading the Google news vectors is massively quicker in magnitude than gensim, however I'm finding that querying is significantly slower. Is this to be expected? It's is quite possible that this is a trade-off against loading time but want to confirm that there's nothing weird going on in my environment.\r\n\r\nCode i'm using for testing:\r\n\r\n```python\r\nimport json\r\nimport os\r\nimport timeit\r\n\r\n\r\nITERATIONS = 500\r\n\r\n# Tokens are loaded from disk.\r\n# tokens = ...\r\ntokens = json.dumps(tokens)\r\n\r\nmag = timeit.timeit(\r\n'''\r\nfor token in tokens:\r\n    try:\r\n        getVector(token)\r\n    except:\r\n        pass\r\n''',\r\n    setup =\r\n'''\r\nfrom pymagnitude import Magnitude\r\nvec = Magnitude('/home/dom/Code/ner/ner/data/GoogleNews-vectors-negative300.magnitude')\r\ngetVector = vec.query\r\ntokens = {}\r\n'''.format(tokens),\r\n    number = ITERATIONS\r\n)\r\n\r\ngensim = timeit.timeit(\r\n'''\r\nfor token in tokens:\r\n    try:\r\n        getVector(token)\r\n    except:\r\n        pass\r\n''',\r\n    setup = \r\n'''\r\nfrom gensim.models import KeyedVectors\r\nvec = KeyedVectors.load('/home/dom/Code/ner/ner/data/GoogleNews-vectors-negative300.w2v', mmap='r')\r\ngetVector = vec.__getitem__\r\ntokens = {}\r\n'''.format(tokens),\r\n    number = ITERATIONS\r\n)\r\n\r\nprint('Gensim is {}x faster'.format(mag / gensim))\r\n```\r\n\r\nFor the code in the above; I get gensim being approximately 5x faster if memory-mapped and if not over 13x faster.","closed_by":{"login":"DomHudson","id":10864294,"node_id":"MDQ6VXNlcjEwODY0Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/10864294?v=4","gravatar_id":"","url":"https://api.github.com/users/DomHudson","html_url":"https://github.com/DomHudson","followers_url":"https://api.github.com/users/DomHudson/followers","following_url":"https://api.github.com/users/DomHudson/following{/other_user}","gists_url":"https://api.github.com/users/DomHudson/gists{/gist_id}","starred_url":"https://api.github.com/users/DomHudson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomHudson/subscriptions","organizations_url":"https://api.github.com/users/DomHudson/orgs","repos_url":"https://api.github.com/users/DomHudson/repos","events_url":"https://api.github.com/users/DomHudson/events{/privacy}","received_events_url":"https://api.github.com/users/DomHudson/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/plasticityai/magnitude/issues/10/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/plasticityai/magnitude/issues/10/timeline","performed_via_github_app":null,"state_reason":"completed"}