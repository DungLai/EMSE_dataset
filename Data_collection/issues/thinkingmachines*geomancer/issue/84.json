{"url":"https://api.github.com/repos/thinkingmachines/geomancer/issues/84","repository_url":"https://api.github.com/repos/thinkingmachines/geomancer","labels_url":"https://api.github.com/repos/thinkingmachines/geomancer/issues/84/labels{/name}","comments_url":"https://api.github.com/repos/thinkingmachines/geomancer/issues/84/comments","events_url":"https://api.github.com/repos/thinkingmachines/geomancer/issues/84/events","html_url":"https://github.com/thinkingmachines/geomancer/issues/84","id":589706183,"node_id":"MDU6SXNzdWU1ODk3MDYxODM=","number":84,"title":"[Bug] \"NoSuchModuleError: Can't load plugin: sqlalchemy.dialects:bigquery\" when calling the `cast` method from `DistanceToNearest`","user":{"login":"enzoampil","id":39557688,"node_id":"MDQ6VXNlcjM5NTU3Njg4","avatar_url":"https://avatars.githubusercontent.com/u/39557688?v=4","gravatar_id":"","url":"https://api.github.com/users/enzoampil","html_url":"https://github.com/enzoampil","followers_url":"https://api.github.com/users/enzoampil/followers","following_url":"https://api.github.com/users/enzoampil/following{/other_user}","gists_url":"https://api.github.com/users/enzoampil/gists{/gist_id}","starred_url":"https://api.github.com/users/enzoampil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/enzoampil/subscriptions","organizations_url":"https://api.github.com/users/enzoampil/orgs","repos_url":"https://api.github.com/users/enzoampil/repos","events_url":"https://api.github.com/users/enzoampil/events{/privacy}","received_events_url":"https://api.github.com/users/enzoampil/received_events","type":"User","site_admin":false},"labels":[{"id":1247574210,"node_id":"MDU6TGFiZWwxMjQ3NTc0MjEw","url":"https://api.github.com/repos/thinkingmachines/geomancer/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"open","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-03-29T03:18:31Z","updated_at":"2020-03-29T03:19:35Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"\r\n\r\n**After running the code below on Google Colab:**\r\n\r\n```\r\ndist_spell = DistanceToNearest(\r\n    \"hospital\",\r\n    source_table=\"phcovid.gis_osm_pois_free_1\",\r\n    feature_name=\"dist_hospital\",\r\n    dburl=\"bigquery://ml-prototypes\",\r\n).cast(df)\r\n```\r\n**The following error occurs:**\r\n\r\n2020-03-29 03:15:18.390 | ERROR    | __main__:<module>:6 - An error has been caught in function '<module>', process 'MainProcess' (119), thread 'MainThread' (140460848953216):\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.6/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n                └ ModuleSpec(name='ipykernel_launcher', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7fbf94d60cf8>, origin='...\r\n  File \"/usr/lib/python3.6/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n         │     └ {'__name__': '__main__', '__doc__': 'Entry point for launching an IPython kernel.\\n\\nThis is separate from the ipykernel pack...\r\n         └ <code object <module> at 0x7fbf94db0660, file \"/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py\", line 5>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py\", line 16, in <module>\r\n    app.launch_new_instance()\r\n    │   └ <bound method Application.launch_instance of <class 'ipykernel.kernelapp.IPKernelApp'>>\r\n    └ <module 'ipykernel.kernelapp' from '/usr/local/lib/python3.6/dist-packages/ipykernel/kernelapp.py'>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/traitlets/config/application.py\", line 664, in launch_instance\r\n    app.start()\r\n    │   └ <function IPKernelApp.start at 0x7fbf8f501ea0>\r\n    └ <ipykernel.kernelapp.IPKernelApp object at 0x7fbf94f0ac50>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/kernelapp.py\", line 477, in start\r\n    ioloop.IOLoop.instance().start()\r\n    │      │      └ <staticmethod object at 0x7fbf90622a20>\r\n    │      └ <class 'tornado.ioloop.IOLoop'>\r\n    └ <module 'tornado.ioloop' from '/usr/local/lib/python3.6/dist-packages/tornado/ioloop.py'>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/tornado/ioloop.py\", line 888, in start\r\n    handler_func(fd_obj, events)\r\n    │            │       └ 1\r\n    │            └ <zmq.sugar.socket.Socket object at 0x7fbf7f3f1660>\r\n    └ <function wrap.<locals>.null_wrapper at 0x7fbf7f3f4730>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/tornado/stack_context.py\", line 277, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n           │   │       └ {}\r\n           │   └ (<zmq.sugar.socket.Socket object at 0x7fbf7f3f1660>, 1)\r\n           └ <bound method ZMQStream._handle_events of <zmq.eventloop.zmqstream.ZMQStream object at 0x7fbf7f3deef0>>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/zmq/eventloop/zmqstream.py\", line 450, in _handle_events\r\n    self._handle_recv()\r\n    │    └ <function ZMQStream._handle_recv at 0x7fbf8fa210d0>\r\n    └ <zmq.eventloop.zmqstream.ZMQStream object at 0x7fbf7f3deef0>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/zmq/eventloop/zmqstream.py\", line 480, in _handle_recv\r\n    self._run_callback(callback, msg)\r\n    │    │             │         └ [<zmq.sugar.frame.Frame object at 0x7fbf6d6886c0>, <zmq.sugar.frame.Frame object at 0x7fbf6d688778>, <zmq.sugar.frame.Frame o...\r\n    │    │             └ <function wrap.<locals>.null_wrapper at 0x7fbf72c45730>\r\n    │    └ <function ZMQStream._run_callback at 0x7fbf8fa1bf28>\r\n    └ <zmq.eventloop.zmqstream.ZMQStream object at 0x7fbf7f3deef0>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/zmq/eventloop/zmqstream.py\", line 432, in _run_callback\r\n    callback(*args, **kwargs)\r\n    │         │       └ {}\r\n    │         └ ([<zmq.sugar.frame.Frame object at 0x7fbf6d6886c0>, <zmq.sugar.frame.Frame object at 0x7fbf6d688778>, <zmq.sugar.frame.Frame ...\r\n    └ <function wrap.<locals>.null_wrapper at 0x7fbf72c45730>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/tornado/stack_context.py\", line 277, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n           │   │       └ {}\r\n           │   └ ([<zmq.sugar.frame.Frame object at 0x7fbf6d6886c0>, <zmq.sugar.frame.Frame object at 0x7fbf6d688778>, <zmq.sugar.frame.Frame ...\r\n           └ <function Kernel.start.<locals>.make_dispatcher.<locals>.dispatcher at 0x7fbf72c456a8>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/kernelbase.py\", line 283, in dispatcher\r\n    return self.dispatch_shell(stream, msg)\r\n           │    │              │       └ [<zmq.sugar.frame.Frame object at 0x7fbf6d6886c0>, <zmq.sugar.frame.Frame object at 0x7fbf6d688778>, <zmq.sugar.frame.Frame o...\r\n           │    │              └ <zmq.eventloop.zmqstream.ZMQStream object at 0x7fbf7f3deef0>\r\n           │    └ <function Kernel.dispatch_shell at 0x7fbf8f56b1e0>\r\n           └ <google.colab._kernel.Kernel object at 0x7fbf7f183320>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/kernelbase.py\", line 235, in dispatch_shell\r\n    handler(stream, idents, msg)\r\n    │       │       │       └ {'header': {'username': 'username', 'msg_type': 'execute_request', 'msg_id': 'cf57ce7b1af942c3e5e49e6c3d24d01a', 'version': '...\r\n    │       │       └ [b'436ca7d2de314043e8098971c7ce30c9']\r\n    │       └ <zmq.eventloop.zmqstream.ZMQStream object at 0x7fbf7f3deef0>\r\n    └ <bound method Kernel.execute_request of <google.colab._kernel.Kernel object at 0x7fbf7f183320>>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/kernelbase.py\", line 399, in execute_request\r\n    user_expressions, allow_stdin)\r\n    │                 └ True\r\n    └ {}\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/ipkernel.py\", line 196, in do_execute\r\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\r\n          │     │        │                   │                     └ False\r\n          │     │        │                   └ True\r\n          │     │        └ 'dist_spell = DistanceToNearest(\\n    \"hospital\",\\n    source_table=\"phcovid.gis_osm_pois_free_1\",\\n    feature_name=\"dist_ho...\r\n          │     └ <function ZMQInteractiveShell.run_cell at 0x7fbf8f4fe158>\r\n          └ <google.colab._shell.Shell object at 0x7fbf7f183240>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/zmqshell.py\", line 533, in run_cell\r\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\r\n                 │                    │               │       └ {'store_history': True, 'silent': False}\r\n                 │                    │               └ ('dist_spell = DistanceToNearest(\\n    \"hospital\",\\n    source_table=\"phcovid.gis_osm_pois_free_1\",\\n    feature_name=\"dist_h...\r\n                 │                    └ <google.colab._shell.Shell object at 0x7fbf7f183240>\r\n                 └ <class 'ipykernel.zmqshell.ZMQInteractiveShell'>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 2718, in run_cell\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n                  │                       │                └ <ExecutionResult object at 7fbf6f4772e8, execution_count=58 error_before_exec=None error_in_exec=None result=None>\r\n                  │                       └ <IPython.core.compilerop.CachingCompiler object at 0x7fbf7f3ded68>\r\n                  └ 'last_expr'\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 2822, in run_ast_nodes\r\n    if self.run_code(code, result):\r\n       │    │        │     └ <ExecutionResult object at 7fbf6f4772e8, execution_count=58 error_before_exec=None error_in_exec=None result=None>\r\n       │    │        └ <code object <module> at 0x7fbf6e50f540, file \"<ipython-input-58-629ae4fc0050>\", line 1>\r\n       │    └ <function InteractiveShell.run_code at 0x7fbf929eb400>\r\n       └ <google.colab._shell.Shell object at 0x7fbf7f183240>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 2882, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n         │         │    │               │    └ {'__name__': '__main__', '__doc__': 'Automatically created module for IPython interactive environment', '__package__': None, ...\r\n         │         │    │               └ <google.colab._shell.Shell object at 0x7fbf7f183240>\r\n         │         │    └ <property object at 0x7fbf92f7a9a8>\r\n         │         └ <google.colab._shell.Shell object at 0x7fbf7f183240>\r\n         └ <code object <module> at 0x7fbf6e50f540, file \"<ipython-input-58-629ae4fc0050>\", line 1>\r\n\r\n> File \"<ipython-input-58-629ae4fc0050>\", line 6, in <module>\r\n    ).cast(df)\r\n           └                                    WKT  ...                                      name\r\n             0       POINT (120.6202008 14.3854827) ...\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/geomancer/spells/base.py\", line 184, in cast\r\n    engine = core.get_engine()\r\n             │    └ <function DBCore.get_engine at 0x7fbf6d68c0d0>\r\n             └ <geomancer.backend.cores.bq.BigQueryCore object at 0x7fbf6d3e1e48>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/geomancer/backend/cores/base.py\", line 108, in get_engine\r\n    return create_engine(self.dburl)\r\n           │             │    └ bigquery://ml-prototypes\r\n           │             └ <geomancer.backend.cores.bq.BigQueryCore object at 0x7fbf6d3e1e48>\r\n           └ <function create_engine at 0x7fbf6dc226a8>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/__init__.py\", line 423, in create_engine\r\n    return strategy.create(*args, **kwargs)\r\n           │        │       │       └ {}\r\n           │        │       └ (bigquery://ml-prototypes,)\r\n           │        └ <function DefaultEngineStrategy.create at 0x7fbf6d8fb620>\r\n           └ <sqlalchemy.engine.strategies.PlainEngineStrategy object at 0x7fbf6dc33cf8>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/strategies.py\", line 61, in create\r\n    entrypoint = u._get_entrypoint()\r\n                 │ └ <function URL._get_entrypoint at 0x7fbf6db5a598>\r\n                 └ bigquery://ml-prototypes\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/url.py\", line 172, in _get_entrypoint\r\n    cls = registry.load(name)\r\n          │        │    └ 'bigquery'\r\n          │        └ <function PluginLoader.load at 0x7fbf6dfeda60>\r\n          └ <sqlalchemy.util.langhelpers.PluginLoader object at 0x7fbf6db59240>\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/sqlalchemy/util/langhelpers.py\", line 240, in load\r\n    \"Can't load plugin: %s:%s\" % (self.group, name)\r\n                                  │    │      └ 'bigquery'\r\n                                  │    └ 'sqlalchemy.dialects'\r\n                                  └ <sqlalchemy.util.langhelpers.PluginLoader object at 0x7fbf6db59240>\r\n\r\nsqlalchemy.exc.NoSuchModuleError: Can't load plugin: sqlalchemy.dialects:bigquery\r\n---------------------------------------------------------------------------\r\nNoSuchModuleError                         Traceback (most recent call last)\r\n<ipython-input-58-629ae4fc0050> in <module>()\r\n      4     feature_name=\"dist_hospital\",\r\n      5     dburl=\"bigquery://ml-prototypes\",\r\n----> 6 ).cast(df)\r\n\r\n6 frames\r\n/usr/local/lib/python3.6/dist-packages/sqlalchemy/util/langhelpers.py in load(self, name)\r\n    238 \r\n    239         raise exc.NoSuchModuleError(\r\n--> 240             \"Can't load plugin: %s:%s\" % (self.group, name)\r\n    241         )\r\n    242 \r\n\r\nNoSuchModuleError: Can't load plugin: sqlalchemy.dialects:bigquery","closed_by":null,"reactions":{"url":"https://api.github.com/repos/thinkingmachines/geomancer/issues/84/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/thinkingmachines/geomancer/issues/84/timeline","performed_via_github_app":null,"state_reason":null}