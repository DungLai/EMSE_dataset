[{"url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/comments/509034097","html_url":"https://github.com/tebesu/CollaborativeMemoryNetwork/issues/5#issuecomment-509034097","issue_url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/5","id":509034097,"node_id":"MDEyOklzc3VlQ29tbWVudDUwOTAzNDA5Nw==","user":{"login":"tebesu","id":2096875,"node_id":"MDQ6VXNlcjIwOTY4NzU=","avatar_url":"https://avatars.githubusercontent.com/u/2096875?v=4","gravatar_id":"","url":"https://api.github.com/users/tebesu","html_url":"https://github.com/tebesu","followers_url":"https://api.github.com/users/tebesu/followers","following_url":"https://api.github.com/users/tebesu/following{/other_user}","gists_url":"https://api.github.com/users/tebesu/gists{/gist_id}","starred_url":"https://api.github.com/users/tebesu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tebesu/subscriptions","organizations_url":"https://api.github.com/users/tebesu/orgs","repos_url":"https://api.github.com/users/tebesu/repos","events_url":"https://api.github.com/users/tebesu/events{/privacy}","received_events_url":"https://api.github.com/users/tebesu/received_events","type":"User","site_admin":false},"created_at":"2019-07-07T22:00:43Z","updated_at":"2019-07-07T22:00:43Z","author_association":"OWNER","body":"From looking at the code, I did not run it but it seems you are applying the L2 regularization twice.\r\n\r\nThe first one you apply is in the optimizer\r\n`optimizer = torch.optim.RMSprop(model.parameters(), lr=config.learning_rate, \r\n                                momentum=config.momentum, weight_decay=config.decay_rate)`\r\n\r\nhttps://pytorch.org/docs/stable/optim.html#torch.optim.RMSprop\r\n\r\nThe parameter to `weight_decay` is the L2 regularization not decay rate. Then you add another l2 in the loss criterion and here\r\n\r\n\r\n`        batch_loss = criterion(score_pos, score_neg)\r\n        \r\n        # adding l2 regularisation\r\n        for name, param in model.named_parameters():\r\n            if name in ['mem_layer.hop_mapping.weight', \r\n                        'output_module.dense.weight', \r\n                        'output_module.out.weight']:\r\n                l2 = torch.sqrt(param.pow(2).sum())\r\n                batch_loss += (config.l2_lambda * l2)`\r\n\r\nTry removing it all together and see if it converges.","reactions":{"url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/comments/509034097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tebesu","id":2096875,"node_id":"MDQ6VXNlcjIwOTY4NzU=","avatar_url":"https://avatars.githubusercontent.com/u/2096875?v=4","gravatar_id":"","url":"https://api.github.com/users/tebesu","html_url":"https://github.com/tebesu","followers_url":"https://api.github.com/users/tebesu/followers","following_url":"https://api.github.com/users/tebesu/following{/other_user}","gists_url":"https://api.github.com/users/tebesu/gists{/gist_id}","starred_url":"https://api.github.com/users/tebesu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tebesu/subscriptions","organizations_url":"https://api.github.com/users/tebesu/orgs","repos_url":"https://api.github.com/users/tebesu/repos","events_url":"https://api.github.com/users/tebesu/events{/privacy}","received_events_url":"https://api.github.com/users/tebesu/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/comments/509035266","html_url":"https://github.com/tebesu/CollaborativeMemoryNetwork/issues/5#issuecomment-509035266","issue_url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/5","id":509035266,"node_id":"MDEyOklzc3VlQ29tbWVudDUwOTAzNTI2Ng==","user":{"login":"IamAdiSri","id":9818842,"node_id":"MDQ6VXNlcjk4MTg4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/9818842?v=4","gravatar_id":"","url":"https://api.github.com/users/IamAdiSri","html_url":"https://github.com/IamAdiSri","followers_url":"https://api.github.com/users/IamAdiSri/followers","following_url":"https://api.github.com/users/IamAdiSri/following{/other_user}","gists_url":"https://api.github.com/users/IamAdiSri/gists{/gist_id}","starred_url":"https://api.github.com/users/IamAdiSri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IamAdiSri/subscriptions","organizations_url":"https://api.github.com/users/IamAdiSri/orgs","repos_url":"https://api.github.com/users/IamAdiSri/repos","events_url":"https://api.github.com/users/IamAdiSri/events{/privacy}","received_events_url":"https://api.github.com/users/IamAdiSri/received_events","type":"User","site_admin":false},"created_at":"2019-07-07T22:21:41Z","updated_at":"2019-07-07T22:21:41Z","author_association":"NONE","body":"Thank you for taking the time to look through my code. \r\n\r\nI changed the **weight_decay** parameter from **decay_rate (0.9)** to **l2_lamba (0.1)** penalty in the optimizer.\r\n\r\n`optimizer = torch.optim.RMSprop(model.parameters(), lr=config.learning_rate, momentum=config.momentum, weight_decay=config.l2_lambda)`\r\n\r\nI also removed the manual implementation for the l2 regularization you've mentioned above.\r\n\r\nLastly, I also removed the l2_regularization when calculating Bayesian Personalized Loss.\r\n\r\nOn running the model again, the loss has decreased from the previous ~.76, but stagnates again at ~0.69; the model still doesn't converge. Do you have any other suggestions?","reactions":{"url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/comments/509035266/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"IamAdiSri","id":9818842,"node_id":"MDQ6VXNlcjk4MTg4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/9818842?v=4","gravatar_id":"","url":"https://api.github.com/users/IamAdiSri","html_url":"https://github.com/IamAdiSri","followers_url":"https://api.github.com/users/IamAdiSri/followers","following_url":"https://api.github.com/users/IamAdiSri/following{/other_user}","gists_url":"https://api.github.com/users/IamAdiSri/gists{/gist_id}","starred_url":"https://api.github.com/users/IamAdiSri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IamAdiSri/subscriptions","organizations_url":"https://api.github.com/users/IamAdiSri/orgs","repos_url":"https://api.github.com/users/IamAdiSri/repos","events_url":"https://api.github.com/users/IamAdiSri/events{/privacy}","received_events_url":"https://api.github.com/users/IamAdiSri/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/comments/509553388","html_url":"https://github.com/tebesu/CollaborativeMemoryNetwork/issues/5#issuecomment-509553388","issue_url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/5","id":509553388,"node_id":"MDEyOklzc3VlQ29tbWVudDUwOTU1MzM4OA==","user":{"login":"IamAdiSri","id":9818842,"node_id":"MDQ6VXNlcjk4MTg4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/9818842?v=4","gravatar_id":"","url":"https://api.github.com/users/IamAdiSri","html_url":"https://github.com/IamAdiSri","followers_url":"https://api.github.com/users/IamAdiSri/followers","following_url":"https://api.github.com/users/IamAdiSri/following{/other_user}","gists_url":"https://api.github.com/users/IamAdiSri/gists{/gist_id}","starred_url":"https://api.github.com/users/IamAdiSri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IamAdiSri/subscriptions","organizations_url":"https://api.github.com/users/IamAdiSri/orgs","repos_url":"https://api.github.com/users/IamAdiSri/repos","events_url":"https://api.github.com/users/IamAdiSri/events{/privacy}","received_events_url":"https://api.github.com/users/IamAdiSri/received_events","type":"User","site_admin":false},"created_at":"2019-07-09T08:51:55Z","updated_at":"2019-07-09T08:51:55Z","author_association":"NONE","body":"@tebesu Removing loss entirely from the optimizer and then performing loss calculation manually, somehow made it work. The model now trains and loss decreases.\r\n\r\nThank you for your help.","reactions":{"url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/comments/509553388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"IamAdiSri","id":9818842,"node_id":"MDQ6VXNlcjk4MTg4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/9818842?v=4","gravatar_id":"","url":"https://api.github.com/users/IamAdiSri","html_url":"https://github.com/IamAdiSri","followers_url":"https://api.github.com/users/IamAdiSri/followers","following_url":"https://api.github.com/users/IamAdiSri/following{/other_user}","gists_url":"https://api.github.com/users/IamAdiSri/gists{/gist_id}","starred_url":"https://api.github.com/users/IamAdiSri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IamAdiSri/subscriptions","organizations_url":"https://api.github.com/users/IamAdiSri/orgs","repos_url":"https://api.github.com/users/IamAdiSri/repos","events_url":"https://api.github.com/users/IamAdiSri/events{/privacy}","received_events_url":"https://api.github.com/users/IamAdiSri/received_events","type":"User","site_admin":false}},{"id":2468605798,"node_id":"MDExOkNsb3NlZEV2ZW50MjQ2ODYwNTc5OA==","url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/events/2468605798","actor":{"login":"IamAdiSri","id":9818842,"node_id":"MDQ6VXNlcjk4MTg4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/9818842?v=4","gravatar_id":"","url":"https://api.github.com/users/IamAdiSri","html_url":"https://github.com/IamAdiSri","followers_url":"https://api.github.com/users/IamAdiSri/followers","following_url":"https://api.github.com/users/IamAdiSri/following{/other_user}","gists_url":"https://api.github.com/users/IamAdiSri/gists{/gist_id}","starred_url":"https://api.github.com/users/IamAdiSri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IamAdiSri/subscriptions","organizations_url":"https://api.github.com/users/IamAdiSri/orgs","repos_url":"https://api.github.com/users/IamAdiSri/repos","events_url":"https://api.github.com/users/IamAdiSri/events{/privacy}","received_events_url":"https://api.github.com/users/IamAdiSri/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-07-09T08:51:55Z","state_reason":null,"performed_via_github_app":null},{"id":2468605809,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQ2ODYwNTgwOQ==","url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/events/2468605809","actor":{"login":"tebesu","id":2096875,"node_id":"MDQ6VXNlcjIwOTY4NzU=","avatar_url":"https://avatars.githubusercontent.com/u/2096875?v=4","gravatar_id":"","url":"https://api.github.com/users/tebesu","html_url":"https://github.com/tebesu","followers_url":"https://api.github.com/users/tebesu/followers","following_url":"https://api.github.com/users/tebesu/following{/other_user}","gists_url":"https://api.github.com/users/tebesu/gists{/gist_id}","starred_url":"https://api.github.com/users/tebesu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tebesu/subscriptions","organizations_url":"https://api.github.com/users/tebesu/orgs","repos_url":"https://api.github.com/users/tebesu/repos","events_url":"https://api.github.com/users/tebesu/events{/privacy}","received_events_url":"https://api.github.com/users/tebesu/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-07-09T08:51:56Z","performed_via_github_app":null},{"id":2468605811,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0Njg2MDU4MTE=","url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/events/2468605811","actor":{"login":"tebesu","id":2096875,"node_id":"MDQ6VXNlcjIwOTY4NzU=","avatar_url":"https://avatars.githubusercontent.com/u/2096875?v=4","gravatar_id":"","url":"https://api.github.com/users/tebesu","html_url":"https://github.com/tebesu","followers_url":"https://api.github.com/users/tebesu/followers","following_url":"https://api.github.com/users/tebesu/following{/other_user}","gists_url":"https://api.github.com/users/tebesu/gists{/gist_id}","starred_url":"https://api.github.com/users/tebesu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tebesu/subscriptions","organizations_url":"https://api.github.com/users/tebesu/orgs","repos_url":"https://api.github.com/users/tebesu/repos","events_url":"https://api.github.com/users/tebesu/events{/privacy}","received_events_url":"https://api.github.com/users/tebesu/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-07-09T08:51:56Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/comments/509668694","html_url":"https://github.com/tebesu/CollaborativeMemoryNetwork/issues/5#issuecomment-509668694","issue_url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/5","id":509668694,"node_id":"MDEyOklzc3VlQ29tbWVudDUwOTY2ODY5NA==","user":{"login":"tebesu","id":2096875,"node_id":"MDQ6VXNlcjIwOTY4NzU=","avatar_url":"https://avatars.githubusercontent.com/u/2096875?v=4","gravatar_id":"","url":"https://api.github.com/users/tebesu","html_url":"https://github.com/tebesu","followers_url":"https://api.github.com/users/tebesu/followers","following_url":"https://api.github.com/users/tebesu/following{/other_user}","gists_url":"https://api.github.com/users/tebesu/gists{/gist_id}","starred_url":"https://api.github.com/users/tebesu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tebesu/subscriptions","organizations_url":"https://api.github.com/users/tebesu/orgs","repos_url":"https://api.github.com/users/tebesu/repos","events_url":"https://api.github.com/users/tebesu/events{/privacy}","received_events_url":"https://api.github.com/users/tebesu/received_events","type":"User","site_admin":false},"created_at":"2019-07-09T14:35:45Z","updated_at":"2019-07-09T14:35:45Z","author_association":"OWNER","body":"@IamAdiSri glad you were able to get it to work, let me know if you have additional questions I will do my best to assist you.","reactions":{"url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/comments/509668694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tebesu","id":2096875,"node_id":"MDQ6VXNlcjIwOTY4NzU=","avatar_url":"https://avatars.githubusercontent.com/u/2096875?v=4","gravatar_id":"","url":"https://api.github.com/users/tebesu","html_url":"https://github.com/tebesu","followers_url":"https://api.github.com/users/tebesu/followers","following_url":"https://api.github.com/users/tebesu/following{/other_user}","gists_url":"https://api.github.com/users/tebesu/gists{/gist_id}","starred_url":"https://api.github.com/users/tebesu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tebesu/subscriptions","organizations_url":"https://api.github.com/users/tebesu/orgs","repos_url":"https://api.github.com/users/tebesu/repos","events_url":"https://api.github.com/users/tebesu/events{/privacy}","received_events_url":"https://api.github.com/users/tebesu/received_events","type":"User","site_admin":false}},{"id":2469599871,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQ2OTU5OTg3MQ==","url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/events/2469599871","actor":{"login":"IamAdiSri","id":9818842,"node_id":"MDQ6VXNlcjk4MTg4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/9818842?v=4","gravatar_id":"","url":"https://api.github.com/users/IamAdiSri","html_url":"https://github.com/IamAdiSri","followers_url":"https://api.github.com/users/IamAdiSri/followers","following_url":"https://api.github.com/users/IamAdiSri/following{/other_user}","gists_url":"https://api.github.com/users/IamAdiSri/gists{/gist_id}","starred_url":"https://api.github.com/users/IamAdiSri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IamAdiSri/subscriptions","organizations_url":"https://api.github.com/users/IamAdiSri/orgs","repos_url":"https://api.github.com/users/IamAdiSri/repos","events_url":"https://api.github.com/users/IamAdiSri/events{/privacy}","received_events_url":"https://api.github.com/users/IamAdiSri/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-07-09T14:35:45Z","performed_via_github_app":null},{"id":2469599872,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0Njk1OTk4NzI=","url":"https://api.github.com/repos/tebesu/CollaborativeMemoryNetwork/issues/events/2469599872","actor":{"login":"IamAdiSri","id":9818842,"node_id":"MDQ6VXNlcjk4MTg4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/9818842?v=4","gravatar_id":"","url":"https://api.github.com/users/IamAdiSri","html_url":"https://github.com/IamAdiSri","followers_url":"https://api.github.com/users/IamAdiSri/followers","following_url":"https://api.github.com/users/IamAdiSri/following{/other_user}","gists_url":"https://api.github.com/users/IamAdiSri/gists{/gist_id}","starred_url":"https://api.github.com/users/IamAdiSri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/IamAdiSri/subscriptions","organizations_url":"https://api.github.com/users/IamAdiSri/orgs","repos_url":"https://api.github.com/users/IamAdiSri/repos","events_url":"https://api.github.com/users/IamAdiSri/events{/privacy}","received_events_url":"https://api.github.com/users/IamAdiSri/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-07-09T14:35:45Z","performed_via_github_app":null}]