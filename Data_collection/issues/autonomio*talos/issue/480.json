{"url":"https://api.github.com/repos/autonomio/talos/issues/480","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/480/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/480/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/480/events","html_url":"https://github.com/autonomio/talos/issues/480","id":592989746,"node_id":"MDU6SXNzdWU1OTI5ODk3NDY=","number":480,"title":"Restore Function Gives \"EmptyDataError: No columns to parse from file\" - LSTM","user":{"login":"windowshopr","id":40477419,"node_id":"MDQ6VXNlcjQwNDc3NDE5","avatar_url":"https://avatars.githubusercontent.com/u/40477419?v=4","gravatar_id":"","url":"https://api.github.com/users/windowshopr","html_url":"https://github.com/windowshopr","followers_url":"https://api.github.com/users/windowshopr/followers","following_url":"https://api.github.com/users/windowshopr/following{/other_user}","gists_url":"https://api.github.com/users/windowshopr/gists{/gist_id}","starred_url":"https://api.github.com/users/windowshopr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/windowshopr/subscriptions","organizations_url":"https://api.github.com/users/windowshopr/orgs","repos_url":"https://api.github.com/users/windowshopr/repos","events_url":"https://api.github.com/users/windowshopr/events{/privacy}","received_events_url":"https://api.github.com/users/windowshopr/received_events","type":"User","site_admin":false},"labels":[{"id":1040763409,"node_id":"MDU6TGFiZWwxMDQwNzYzNDA5","url":"https://api.github.com/repos/autonomio/talos/labels/user%20support","name":"user support","color":"59db8b","default":false,"description":"nothing is wrong with Talos"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-04-03T00:01:57Z","updated_at":"2022-02-05T17:42:18Z","closed_at":"2020-11-15T11:21:37Z","author_association":"NONE","active_lock_reason":null,"body":"```\r\nPython 3.6, Windows 10,\r\n\r\ntensorflow==2.1.0\r\npandas==0.25.1\r\ntalos==1.0.0\r\n```\r\n(I realize the Talos version MAY be out of date, however I found a pip install url link in one of the past issue pages that finally got this tool to work for me, so I'm hesitant to change it, for now.)\r\n\r\nI've created an GRU/LSTM scan object that works that I found by browsing through the other issues related to LSTM devlopment and Talos. It works fine, only what I'm trying to do now is Deploy the scan package to its .zip file, Restore the model from said .zip and then Predict on a test set.\r\n\r\nI get the following traceback:\r\n\r\n```\r\n100%|████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.93s/it]\r\nScanning is complete. Check your outputted .csv file. Pick the best \"val_accuracy\".\r\nEvaluating the model...\r\nmean : 0.03\r\n std : 0.01\r\n\r\nMaking deployment package...\r\nDeploy package talos_classifier_deployment have been saved.\r\ndata is not 2d, dummy data written instead.\r\n\r\nRestoring package...\r\nTraceback (most recent call last):\r\n  File \"lstm_talos.py\", line 255, in <module>\r\n    model = Restore('talos_classifier_deployment.zip')\r\n  \r\nFile \"C:\\Users\\windowshopr\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\talos\\commands\\restore.py\", line 41, in __init__\r\n    self.x = pd.read_csv(self.file_prefix + '_x.csv', header=None)\r\n  \r\nFile \"C:\\Users\\windowshopr\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\pandas\\io\\parsers.py\", line 685, in parser_f\r\n    return _read(filepath_or_buffer, kwds)\r\n  \r\nFile \"C:\\Users\\windowshopr\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\pandas\\io\\parsers.py\", line 457, in _read\r\n    parser = TextFileReader(fp_or_buf, **kwds)\r\n  \r\nFile \"C:\\Users\\windowshopr\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\pandas\\io\\parsers.py\", line 895, in __init__\r\n    self._make_engine(self.engine)\r\n  \r\nFile \"C:\\Users\\windowshopr\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\pandas\\io\\parsers.py\", line 1135, in _make_engine\r\n    self._engine = CParserWrapper(self.f, **self.options)\r\n  \r\nFile \"C:\\Users\\windowshopr\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\pandas\\io\\parsers.py\", line 1917, in __init__\r\n    self._reader = parsers.TextReader(src, **kwds)\r\n  \r\nFile \"pandas\\_libs\\parsers.pyx\", line 545, in pandas._libs.parsers.TextReader.__cinit__\r\npandas.errors.EmptyDataError: No columns to parse from file\r\n```\r\n\r\nSo I look in the .zip file and sure enough, the X/Features .csv file has nothing in it. Wondering why that would be? I've attached what my Talos section looks like, and the function that creates my 3D data for the LSTM:\r\n\r\n```\r\n# A function to get a set of X's and Y's for training\r\ndef create_dataset(X, y, time_steps=1): # Not really 1 if defined below\r\n    Xs, ys = [], []\r\n    for i in range(len(X) - time_steps):\r\n        v = X[i:(i + time_steps)] # v = first 10 rows of X set\r\n        Xs.append(v) # Append those 10 rows to your Xs list\r\n        ys.append(y[i + time_steps]) # Append their corresponding labels to Ys list, then continue\r\n    return np.array(Xs), np.array(ys)\r\n\r\n# How many days/rows to \"look back\"\r\ntime_steps = 10\r\n\r\n# reshape to [samples, time_steps, n_features]\r\nx_train, y_train = create_dataset(train_scaled.to_numpy(), train_scaled.iloc[:,-1].to_numpy(), time_steps)\r\nx_test, y_test = create_dataset(test_scaled.to_numpy(), test_scaled.iloc[:,-1].to_numpy(), time_steps)\r\n\r\n\r\n\r\n# DEFINE OUR TALOS MODEL SAMPLE ARCHITECTURE\r\ndef the_model(x_train, y_train, x_val, y_val, params):\r\n\r\n    model = Sequential()\r\n\r\n    model.add(GRU(params['first_neuron'], \r\n                    input_shape=(x_train.shape[1], x_train.shape[2])))\r\n    \r\n    model.add(Dropout(params['dropout']))\r\n\r\n    hidden_layers(model, params, 1)\r\n\r\n    model.add(Dense(params['last_neuron']))\r\n    \r\n    model.compile(loss=params['losses'],\r\n                  optimizer=params['optimizer'](lr=lr_normalizer(params['lr'], params['optimizer'])))\r\n    \r\n    history = model.fit(x_train, y_train, \r\n                        validation_data=[x_val, y_val],\r\n                        batch_size=params['batch_size'],\r\n                        callbacks=[early_stopper(params['epochs'], mode='moderate')],\r\n                        epochs=params['epochs'],\r\n                        verbose=0)\r\n\r\n    return history, model\r\n\r\n\r\n# then we can go ahead and set the parameter space\r\np = {'first_neuron':[10],\r\n     'lr':[1],\r\n     'hidden_layers': [1],\r\n     'last_neuron': [1],\r\n     'batch_size': [64],\r\n     'epochs': [1000],\r\n     'dropout': [0], \r\n     'shapes': [0.5], \r\n     'optimizer': [Adam], # RMSprop, Adagrad, Adadelta\r\n     'losses': ['mse'], # binary_crossentropy\r\n     'activation': ['relu']} #, 'elu'],\r\n\r\n\r\n# and run the experiment\r\nt = talos.Scan(x=x_train, y=y_train,\r\n    x_val=x_test, y_val=y_test,\r\n    model=the_model, \r\n    params=p, \r\n    experiment_name='talos_stuff', \r\n    round_limit=1,      \r\n    save_weights=True,   \r\n    reduction_metric='loss',\r\n    clear_session=True)\r\n\r\nprint('Scanning is complete.')\r\n\r\nprint('Evaluating the model...')\r\ne = talos.Evaluate(t)\r\nevaluation = e.evaluate(x_test,\r\n                        y_test,\r\n                        model_id=None, \r\n                        task='continuous',\r\n                        shuffle=False, \r\n                        print_out=True,\r\n                        metric='loss', asc=False)\r\n\r\nprint('Making deployment package...')\r\nmodel = talos.Deploy(t, \"talos_classifier_deployment\", \r\n                #metric=\"val_loss\", asc=True)\r\n                metric=\"loss\", asc=False)\r\n\r\n\r\nprint('Restoring package...') \r\nmodel = Restore('talos_classifier_deployment.zip')\r\ny_preds = model.model.predict(x_test)\r\n```","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/480/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/480/timeline","performed_via_github_app":null,"state_reason":"completed"}