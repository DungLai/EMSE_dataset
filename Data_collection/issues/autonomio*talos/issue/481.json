{"url":"https://api.github.com/repos/autonomio/talos/issues/481","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/481/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/481/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/481/events","html_url":"https://github.com/autonomio/talos/issues/481","id":600649491,"node_id":"MDU6SXNzdWU2MDA2NDk0OTE=","number":481,"title":"\"Tensor() must be from the same graph as Tensor\" error","user":{"login":"BioXD","id":3811886,"node_id":"MDQ6VXNlcjM4MTE4ODY=","avatar_url":"https://avatars.githubusercontent.com/u/3811886?v=4","gravatar_id":"","url":"https://api.github.com/users/BioXD","html_url":"https://github.com/BioXD","followers_url":"https://api.github.com/users/BioXD/followers","following_url":"https://api.github.com/users/BioXD/following{/other_user}","gists_url":"https://api.github.com/users/BioXD/gists{/gist_id}","starred_url":"https://api.github.com/users/BioXD/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BioXD/subscriptions","organizations_url":"https://api.github.com/users/BioXD/orgs","repos_url":"https://api.github.com/users/BioXD/repos","events_url":"https://api.github.com/users/BioXD/events{/privacy}","received_events_url":"https://api.github.com/users/BioXD/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-04-15T23:35:29Z","updated_at":"2020-11-09T16:15:01Z","closed_at":"2020-11-09T16:15:01Z","author_association":"NONE","active_lock_reason":null,"body":"I'm trying to optimize the hyperparameters for a LSTM and I'm getting the following error:\r\n\r\n`ValueError: Tensor(\"Pow:0\", shape=(), dtype=float32) must be from the same graph as Tensor(\"lstm/kernel:0\", shape=(), dtype=resource).`\r\n\r\nI tried adding `clear_tf_session=False` and `reset_graph=False` as suggested in #330 with no luck, I get a `got an unexpected keyword argument 'clear_tf_session'` error when I try that.\r\n\r\nI'm running version 0.6.6.\r\n\r\nHere's my code:\r\n\r\n```\r\nimport talos\r\nfrom talos.utils import lr_normalizer\r\nfrom tensorflow.keras.optimizers import Adam, Nadam, Adagrad\r\nfrom tensorflow.keras.activations import softmax\r\nfrom tensorflow.keras.losses import categorical_crossentropy, logcosh\r\n\r\ndef games_model(x_train, y_train, x_test, y_test, params):\r\n    \r\n    \r\n    model = keras.Sequential()\r\n    model.add(layers.LSTM(params['first_neuron'], input_shape = (X.shape[1], X.shape[2])))\r\n    model.add(layers.Dropout(params['dropout']))\r\n    model.add(layers.Dense(params['neurons'], activation = 'tanh'))\r\n    model.add(layers.Dropout(params['dropout']))\r\n    model.add(layers.Dense(params['neurons'], activation = 'tanh'))\r\n    model.add(layers.Dropout(params['dropout']))\r\n    model.add(layers.Dense(2, activation = params['last_activation']))\r\n\r\n    model.compile(loss = params['loss'],\r\n                  optimizer = params['optimizer'],\r\n                  metrics = ['accuracy'])\r\n\r\n    history = model.fit(\r\n        x_train, keras.utils.to_categorical(y_train),\r\n        batch_size = params['batch_size'],\r\n        epochs = params['epochs'],\r\n        verbose = 0,\r\n        validation_data = (x_test, keras.utils.to_categorical(y_test)))\r\npatience = 50)])\r\n    \r\n    return history, model\r\n\r\n        \r\n\r\np = {'lr': (0.1, 10, 10),\r\n     'first_neuron': [160, 210, 260],\r\n     'neurons': [160, 120, 80, 64, 32, 16],\r\n     'batch_size': [2, 3, 4],\r\n     'epochs': [50, 75, 100, 200],\r\n     'dropout': (0, 0.1, 0.2, 0.4, 1, 10),\r\n     'optimizer': [tf.keras.optimizers.Adam(), tf.keras.optimizers.Adagrad(), tf.keras.optimizers.Nadam()],\r\n     'loss': ['categorical_crossentropy'],\r\n     'last_activation': ['softmax'],\r\n     'weight_regulizer': [None]}\r\n\r\nscan_object = talos.Scan(X, y, params = p, model = games_model, experiment_name = 'exgames', fraction_limit = 0.001, clear_tf_session = False)\r\n```","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/481/timeline","performed_via_github_app":null,"state_reason":"completed"}