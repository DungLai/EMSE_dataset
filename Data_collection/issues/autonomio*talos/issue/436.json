{"url":"https://api.github.com/repos/autonomio/talos/issues/436","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/436/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/436/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/436/events","html_url":"https://github.com/autonomio/talos/issues/436","id":533423715,"node_id":"MDU6SXNzdWU1MzM0MjM3MTU=","number":436,"title":"How to use reduction_metric? (Bug?)","user":{"login":"soliverc","id":47222261,"node_id":"MDQ6VXNlcjQ3MjIyMjYx","avatar_url":"https://avatars.githubusercontent.com/u/47222261?v=4","gravatar_id":"","url":"https://api.github.com/users/soliverc","html_url":"https://github.com/soliverc","followers_url":"https://api.github.com/users/soliverc/followers","following_url":"https://api.github.com/users/soliverc/following{/other_user}","gists_url":"https://api.github.com/users/soliverc/gists{/gist_id}","starred_url":"https://api.github.com/users/soliverc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/soliverc/subscriptions","organizations_url":"https://api.github.com/users/soliverc/orgs","repos_url":"https://api.github.com/users/soliverc/repos","events_url":"https://api.github.com/users/soliverc/events{/privacy}","received_events_url":"https://api.github.com/users/soliverc/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-12-05T15:30:18Z","updated_at":"2020-01-25T20:16:42Z","closed_at":"2020-01-25T20:16:42Z","author_association":"NONE","active_lock_reason":null,"body":"I use metrics from the keras metrics package to track model performance:\r\n\r\n```python\r\nimport keras_metrics as km\r\n\r\n    model.compile(optimizer=params['optimizer'], \r\n                  loss='binary_crossentropy', \r\n                  metrics=[km.binary_precision(), km.binary_recall(),km.binary_f1_score()])\r\n```\r\nWhen I do this I get the following output:\r\n```\r\nEpoch 00002: val_f1_score did not improve from 0.56823\r\nEpoch 3/400\r\n14296/14296 [==============================] - 0s 27us/step - loss: 0.6637 - precision: 0.5344 - recall: 0.5724 - f1_score: 0.5527 - val_loss: 0.6678 - val_precision: 0.5309 - val_recall: 0.5832 - val_f1_score: 0.5558\r\n\r\nEpoch 00003: val_f1_score did not improve from 0.56823\r\nEpoch 4/400\r\n14296/14296 [==============================] - 0s 26us/step - loss: 0.6574 - precision: 0.5430 - recall: 0.5985 - f1_score: 0.5694 - val_loss: 0.6704 - val_precision: 0.5236 - val_recall: 0.6361 - val_f1_score: 0.5744\r\n```\r\netc etc\r\n\r\nAs you can see there is a `val_f1_score` in the metrics being displayed. So that's what I've been using for the `Scan` fuction.\r\n\r\n```python\r\nh = Scan(training_features_scaled,\r\n            training_target,\r\n            model=mymodel,\r\n            params=p,\r\n            experiment_name=\"val_dropout\",\r\n            reduction_metric=\"val_f1_score\")\r\n```\r\nI think I've just discovered that this is not working. I entered `akjdfjkahd` into `reduction_metric` and it worked. The model is training now. \r\n\r\nSo what should I do if I want to use something like `val fscore`? \r\n\r\nThis is the only line I can find in the docs:\r\n\r\n> Reduction Metric: The metric against which optimization is performed (e.g. 'val_acc' or 'fmeasure')\r\n\r\nDo I just use `val_fmeasure`? I can use it, but I can't know if it's working, because this argument accepts any string. \r\n\r\nBy the way, this library is awesome. \r\n\r\nedit: just from reading issues here, I noticed that metrics are available in `ta.utils.metrics`.  So let's say I want to use `ta.utils.metrics.matthews`.\r\n\r\nIf I put `matthews` into `reduction_metric`, will it work?\r\n\r\nLike this:\r\n\r\n```python\r\n    model.compile(optimizer=params['optimizer'], \r\n                  loss='binary_crossentropy', \r\n                  metrics=[ta.utils.metrics.matthews]) # adding matthews here\r\n\r\nh = Scan(training_features_scaled,\r\n            training_target,\r\n            model=mymodel,\r\n            params=p,\r\n            experiment_name=\"my_experiment\",\r\n            reduction_metric=\"matthews\") # add \"matthews\" here\r\n```\r\nMy model is currently training with `reduction_metric=\"fgsfgsdfgsf\"` :) ","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/436/timeline","performed_via_github_app":null,"state_reason":"completed"}