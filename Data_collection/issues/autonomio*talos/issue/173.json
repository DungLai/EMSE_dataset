{"url":"https://api.github.com/repos/autonomio/talos/issues/173","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/173/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/173/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/173/events","html_url":"https://github.com/autonomio/talos/issues/173","id":400218473,"node_id":"MDU6SXNzdWU0MDAyMTg0NzM=","number":173,"title":"IndexError: single positional indexer is out-of-bounds","user":{"login":"bastianatte","id":33024301,"node_id":"MDQ6VXNlcjMzMDI0MzAx","avatar_url":"https://avatars.githubusercontent.com/u/33024301?v=4","gravatar_id":"","url":"https://api.github.com/users/bastianatte","html_url":"https://github.com/bastianatte","followers_url":"https://api.github.com/users/bastianatte/followers","following_url":"https://api.github.com/users/bastianatte/following{/other_user}","gists_url":"https://api.github.com/users/bastianatte/gists{/gist_id}","starred_url":"https://api.github.com/users/bastianatte/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bastianatte/subscriptions","organizations_url":"https://api.github.com/users/bastianatte/orgs","repos_url":"https://api.github.com/users/bastianatte/repos","events_url":"https://api.github.com/users/bastianatte/events{/privacy}","received_events_url":"https://api.github.com/users/bastianatte/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-01-17T10:52:46Z","updated_at":"2019-01-17T12:34:02Z","closed_at":"2019-01-17T12:34:02Z","author_association":"NONE","active_lock_reason":null,"body":"import uproot\r\nimport pandas\r\nimport keras\r\nimport talos as ta\r\nfrom sklearn.model_selection import train_test_split\r\n\r\nfrom keras import layers, models\r\nfrom keras.models import Sequential\r\nfrom keras.layers import Dense\r\n\r\n\r\nf = uproot.open(\"/path/to/the/root/file/test_func_94_double.root\")\r\ntree = f['Merged_Analysis;1']\r\n\r\ndataset = tree.pandas.df([\"z_pos\",\"trks\",\"spt2\",\"spt\",\"Dr\",\"clos\",\"clos_qdr\",\"clos_tp\",\"clos_a0\",\"ch\\\r\nsq\",\"ismerge\"])\r\nfeatures = dataset.loc[:, dataset.columns != \"ismerge\"].values                                      \\\r\n                                                                                                    \\\r\n\r\nlabels = dataset.loc[:, \"ismerge\"].values\r\nX_train, y_train, x_val, y_val = train_test_split(features,\r\n                                                  labels,\r\n                                                  test_size=0.8,\r\n                                                  random_state=42)\r\n\r\n\r\ndef vertex_model(x_train, y_train,x_val, y_val, params):\r\n\r\n    model = Sequential()\r\n\r\n    model.add(Dense(params['first_neuron'],\r\n                    kernel_initializer='uniform',\r\n                    activation='sigmoid'))\r\n\r\n    model.add(Dense(units=1,\r\n                    kernel_initializer='uniform',\r\n                    activation='sigmoid'))\r\n\r\n    model.compile(loss='binary_crossentropy',\r\n                  optimizer='sgd',\r\n                  metrics=['accuracy'])\r\n\r\n    out = model.fit(X_train, y_train,\r\n                    epochs=100,\r\n                    validation_data=[x_val, y_val],\r\n                    batch_size=50)\r\n    return out, model\r\n\r\nh = ta.Scan(x=X_train,\r\n            y=y_train,\r\n            params={'first_neuron': [4, 8, 16, 32, 64]},\r\n            dataset_name='first_test',\r\n            experiment_no='aaa',\r\n            model=vertex_model,\r\n            grid_downsample=0.1)\r\n\r\n\r\nthe x and y shapes are: \r\n(97010, 10)\r\n(24253, 10)\r\n\r\nthe error that I receive is:\r\n0it [00:00, ?it/s]\r\nTraceback (most recent call last):\r\n  File \"keras_talos.py\", line 57, in <module>\r\n    grid_downsample=0.1)\r\n  File \"/home/spinali/Documents/LancsUni/qual_task/virtualenv/classifier/local/lib/python2.7/site-packages/talos/scan/Scan.py\", line 163, in __init__\r\n    self._null = self.runtime()\r\n  File \"/home/spinali/Documents/LancsUni/qual_task/virtualenv/classifier/local/lib/python2.7/site-packages/talos/scan/Scan.py\", line 168, in runtime\r\n    self = scan_run(self)\r\n  File \"/home/spinali/Documents/LancsUni/qual_task/virtualenv/classifier/local/lib/python2.7/site-packages/talos/scan/scan_run.py\", line 25, in scan_run\r\n    self = result_todf(self)\r\n  File \"/home/spinali/Documents/LancsUni/qual_task/virtualenv/classifier/local/lib/python2.7/site-packages/talos/utils/results.py\", line 82, in result_todf\r\n    self.result.columns = self.result.iloc[0]\r\n  File \"/home/spinali/Documents/LancsUni/qual_task/virtualenv/classifier/local/lib/python2.7/site-packages/pandas/core/indexing.py\", line 1478, in __getitem__\r\n    return self._getitem_axis(maybe_callable, axis=axis)\r\n  File \"/home/spinali/Documents/LancsUni/qual_task/virtualenv/classifier/local/lib/python2.7/site-packages/pandas/core/indexing.py\", line 2102, in _getitem_axis\r\n    self._validate_integer(key, axis)\r\n  File \"/home/spinali/Documents/LancsUni/qual_task/virtualenv/classifier/local/lib/python2.7/site-packages/pandas/core/indexing.py\", line 2009, in _validate_integer\r\n    raise IndexError(\"single positional indexer is out-of-bounds\")\r\nIndexError: single positional indexer is out-of-bounds\r\n\r\n\r\nI also, in addtition, sometimes receive the following error:\r\nIndexError: index 88770 is out of bounds for axis 0 with size 24253\r\n\r\nThe parameter used is just the first neuron cause this was aimed as a talos test.","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/173/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/173/timeline","performed_via_github_app":null,"state_reason":"completed"}