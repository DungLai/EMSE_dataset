{"url":"https://api.github.com/repos/autonomio/talos/issues/298","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/298/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/298/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/298/events","html_url":"https://github.com/autonomio/talos/issues/298","id":437684946,"node_id":"MDU6SXNzdWU0Mzc2ODQ5NDY=","number":298,"title":"KeyError: \"None of [...] are in the [columns]\"","user":{"login":"ghost","id":10137,"node_id":"MDQ6VXNlcjEwMTM3","avatar_url":"https://avatars.githubusercontent.com/u/10137?v=4","gravatar_id":"","url":"https://api.github.com/users/ghost","html_url":"https://github.com/ghost","followers_url":"https://api.github.com/users/ghost/followers","following_url":"https://api.github.com/users/ghost/following{/other_user}","gists_url":"https://api.github.com/users/ghost/gists{/gist_id}","starred_url":"https://api.github.com/users/ghost/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghost/subscriptions","organizations_url":"https://api.github.com/users/ghost/orgs","repos_url":"https://api.github.com/users/ghost/repos","events_url":"https://api.github.com/users/ghost/events{/privacy}","received_events_url":"https://api.github.com/users/ghost/received_events","type":"User","site_admin":false},"labels":[{"id":994489876,"node_id":"MDU6TGFiZWw5OTQ0ODk4NzY=","url":"https://api.github.com/repos/autonomio/talos/labels/investigation","name":"investigation","color":"d3d3d3","default":false,"description":"gathering information"}],"state":"closed","locked":false,"assignee":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"assignees":[{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false}],"milestone":null,"comments":7,"created_at":"2019-04-26T13:54:55Z","updated_at":"2019-06-11T15:01:31Z","closed_at":"2019-06-11T15:01:30Z","author_association":"NONE","active_lock_reason":null,"body":"Thanks so much for coming here to raise an issue. Please take a moment to 'check' the below boxes:\r\n\r\n- [x] I'm up-to-date with the latest release:\r\n    \r\n      pip install -U talos\r\n\r\n- [x] I've confirmed that my Keras model works outside of Talos.\r\n\r\nIf you still have an error, please submit **complete trace** and a code with: \r\n\r\n- output of shape for x and y e.g. (212,12)\r\n- Talos params dictionary\r\n- The Keras model wired for Talos\r\n- Description of extra variables in the model\r\n\r\nYou can provide the code in pastebin / gist or any other format you like. \r\n\r\n-------------------------------------------------------------------------\r\nI'm trying to optimize only the first node count, but talos seems to return a pandas error.\r\nx shape: (6181, 24)\r\ny shape: (6181, 1)\r\n\r\n```\r\np = {\r\n    'first_neuron': [12, 24, 48],\r\n}\r\n```\r\nUsing this model: \r\n```\r\ndef build_and_fit_model(normed_train_data, train_labels, x_val, y_val, params):\r\n    model = keras.Sequential([\r\n        layers.Dense(256, activation=tf.nn.relu, input_shape=[len(train_dataset.keys())]),\r\n        layers.Dense(params['first_neuron'], activation=tf.nn.relu),\r\n        layers.Dense(1)\r\n    ])\r\n\r\n    optimizer = tf.keras.optimizers.RMSprop(0.001)\r\n\r\n    model.compile(loss='mean_squared_error',\r\n                  optimizer=optimizer,\r\n                  metrics=['mean_absolute_error', 'mean_squared_error'])\r\n    \r\n    # Saving the model during training\r\n    timestr = time.strftime(\"%Y%m%d-%H%M%S\")\r\n    checkpoint_path = \"./models/training_\" + filename + \"_\" + timestr + \"/cp-{epoch:04d}.ckpt\"\r\n    checkpoint_dir = os.path.dirname(checkpoint_path)\r\n    \r\n    # Create checkpoint callback\r\n    cp_callback = tf.keras.callbacks.ModelCheckpoint(\r\n        checkpoint_path, verbose=1, save_weights_only=True,\r\n        # Save weights, every 5-epochs.\r\n        period=15)\r\n    \r\n    # The patience parameter is the amount of epochs to check for improvement\r\n    early_stop = keras.callbacks.EarlyStopping(monitor='val_loss', patience=10)\r\n    \r\n    # With early stop\r\n    history = model.fit(normed_train_data, train_labels, epochs=1000,\r\n                        validation_data=[x_val, y_val], verbose=1, callbacks=[cp_callback, early_stop])\r\n    return history, model\r\nt = ta.Scan(x=normed_train_data, y=train_labels, params=p, model=build_and_fit_model, val_split=0.1275)\r\n```\r\nWhen trying to run the code it gives the following error:\r\n```\r\nTraceback (most recent call last):\r\n\r\n  File \"<ipython-input-30-aaab342cdb2d>\", line 86, in <module>\r\n    t = ta.Scan(x=normed_train_data, y=train_labels, params=p, model=build_and_fit_model, val_split=0.1275)\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/talos/scan/Scan.py\", line 170, in __init__\r\n    self._null = self.runtime()\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/talos/scan/Scan.py\", line 174, in runtime\r\n    self = scan_prepare(self)\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/talos/scan/scan_prepare.py\", line 59, in scan_prepare\r\n    self = validation_split(self)\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/talos/utils/validation_split.py\", line 21, in validation_split\r\n    random_shuffle(self)\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/talos/utils/validation_split.py\", line 65, in random_shuffle\r\n    self.x = self.x[ix]\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/core/frame.py\", line 2934, in __getitem__\r\n    raise_missing=True)\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/core/indexing.py\", line 1354, in _convert_to_indexer\r\n    return self._get_listlike_indexer(obj, axis, **kwargs)[1]\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/core/indexing.py\", line 1161, in _get_listlike_indexer\r\n    raise_missing=raise_missing)\r\n\r\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/core/indexing.py\", line 1246, in _validate_read_indexer\r\n    key=key, axis=self.obj._get_axis_name(axis)))\r\n\r\nKeyError: \"None of [Int64Index([1816,   97, 4076, 5584,  801, 3398, 1103, 3790,  673, 2013,\\n            ...\\n            3667, 1998, 5540, 2843, 2550,  994, 6146, 4547, 3748,  503],\\n           dtype='int64', length=6181)] are in the [columns]\"\r\n```\r\nI don't know where the problem lies, so if someone could help me that would be awesome.\r\n","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/298/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/298/timeline","performed_via_github_app":null,"state_reason":"completed"}