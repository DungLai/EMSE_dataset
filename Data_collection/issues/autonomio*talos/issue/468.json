{"url":"https://api.github.com/repos/autonomio/talos/issues/468","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/468/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/468/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/468/events","html_url":"https://github.com/autonomio/talos/issues/468","id":565569574,"node_id":"MDU6SXNzdWU1NjU1Njk1NzQ=","number":468,"title":"list index out of range when training model with multi-headed inputs, and Limiters lead to < 1 permutations when fraction limit is set on 4E41 parameter permutations","user":{"login":"daniel-corcoran","id":49919745,"node_id":"MDQ6VXNlcjQ5OTE5NzQ1","avatar_url":"https://avatars.githubusercontent.com/u/49919745?v=4","gravatar_id":"","url":"https://api.github.com/users/daniel-corcoran","html_url":"https://github.com/daniel-corcoran","followers_url":"https://api.github.com/users/daniel-corcoran/followers","following_url":"https://api.github.com/users/daniel-corcoran/following{/other_user}","gists_url":"https://api.github.com/users/daniel-corcoran/gists{/gist_id}","starred_url":"https://api.github.com/users/daniel-corcoran/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/daniel-corcoran/subscriptions","organizations_url":"https://api.github.com/users/daniel-corcoran/orgs","repos_url":"https://api.github.com/users/daniel-corcoran/repos","events_url":"https://api.github.com/users/daniel-corcoran/events{/privacy}","received_events_url":"https://api.github.com/users/daniel-corcoran/received_events","type":"User","site_admin":false},"labels":[{"id":1040763409,"node_id":"MDU6TGFiZWwxMDQwNzYzNDA5","url":"https://api.github.com/repos/autonomio/talos/labels/user%20support","name":"user support","color":"59db8b","default":false,"description":"nothing is wrong with Talos"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-02-14T21:41:56Z","updated_at":"2020-02-19T09:58:33Z","closed_at":"2020-02-19T09:58:26Z","author_association":"NONE","active_lock_reason":null,"body":"#### 1) Confirm the below\r\n\r\n- [X ] I have looked for an answer in the [Docs](https://autonomio.github.io/talos)\r\n- [X ] My Python version is 3.5 or higher\r\n- [X ] I have searched through the issues [Issues](https://github.com/autonomio/talos/issues) for a duplicate\r\n- [X ] I've tested that my Keras model works as a stand-alone\r\n\r\n#### 2) Include the output of:\r\n\r\n`talos.__version__`  0.6.4\r\n\r\n#### 3) Explain clearly what you are trying to achieve\r\n*A description of your specific use-case and what you hope to achieve with it*\r\nI have a multi-headed network with multiple inputs. Here is a simple example. \r\n```\r\n`def train_grid():\r\n    x_c = np.random.rand(7843, 8, 1)\r\n    x_p = np.random.rand(7843, 180, 1)\r\n    x_h = np.random.rand(7843, 9, 1)\r\n    shannon = np.random.rand(7843, 9, 1)\r\n    flank_h = np.random.rand(7843, 20, 1)\r\n    flank_p = np.random.rand(7843, 400, 1)\r\n    flank_s = np.random.rand(7843, 20, 1)\r\n    property = np.random.rand(7843, 8, 1)\r\n    \r\n    y_train = np.random.rand(7843)\r\n\r\n    x_train = [x_c, x_p, x_h, shannon, flank_h, flank_p, flank_s, property]\r\n\r\n    \r\n    scan_object = ta.Scan(x=x_train, y=y_train, x_val=x_train, y_val = y_train, model=get_model, params=grid_params, experiment_name = 'Multiheaded input test')\r\n    ta.Analyze(scan_object)`\r\n\r\n```\r\n\r\nI can train the network without using ta.Scan via: \r\n\r\n```\r\n`def train():\r\n    x_c = np.random.rand(7843, 8, 1)\r\n    x_p = np.random.rand(7843, 180, 1)\r\n    x_h = np.random.rand(7843, 9, 1)\r\n    shannon = np.random.rand(7843, 9, 1)\r\n    flank_h = np.random.rand(7843, 20, 1)\r\n    flank_p = np.random.rand(7843, 400, 1)\r\n    flank_s = np.random.rand(7843, 20, 1)\r\n    property = np.random.rand(7843, 8, 1)\r\n    \r\n    y_train = np.random.rand(7843)\r\n\r\n    x_train = [x_c, x_p, x_h, shannon, flank_h, flank_p, flank_s, property]\r\n    for n in x_train: \r\n        print(n.shape)\r\n    get_model(x_train, y_train, x_train, y_train, test_params)\r\n`\r\n```\r\n\r\n(In the attatched jupyter notebook you will see that I made a second dictionary, 'test_params', with single values to train my network with.)\r\n\r\n When I feed information into the model function without using ta.Scan (call the model function normally), it trains correctly. When I call the model with ta.Scan(), I get this error. \r\n\r\n```\r\n    scan_object = ta.Scan(x=x_train, y=y_train, x_val=x_train, y_val = y_train, model=get_model, params=grid_params, experiment_name=filename)\r\n  File \"/usr/local/lib/python3.6/dist-packages/talos/scan/Scan.py\", line 196, in __init__\r\n    scan_run(self)\r\n  File \"/usr/local/lib/python3.6/dist-packages/talos/scan/scan_run.py\", line 34, in scan_run\r\n    self = logging_finish(self)\r\n  File \"/usr/local/lib/python3.6/dist-packages/talos/logging/logging_finish.py\", line 6, in logging_finish\r\n    self = result_todf(self)\r\n  File \"/usr/local/lib/python3.6/dist-packages/talos/logging/results.py\", line 46, in result_todf\r\n    cols = self.result[0]\r\nIndexError: list index out of range\r\n```\r\n\r\nIndexError: list index out of range\r\n\r\nI looked in the traceback and my hypothesis is that the While loop on line 16 of talos/scan/scan_run.py gets skipped over, because self.round_params is false. I don't have a way to verify that this is true. \r\n\r\nHere's a jupyter notebook that should explain what my problem is. Run train.py to try a single shot example, and train_grid.py to see what happens when we try it with talos scan. \r\nhttps://drive.google.com/file/d/1_ycfuhxpQvho6Ws6NUp-5dY5wtOxVNFu/view?usp=sharing\r\n\r\n\r\nThank you for your time!\r\nEDIT: Since my model has a LOT (4E41) permutations, I obviously want to limit this search breadth. So when I set my fraction_limit to any number > 0 and < 1, I get this error\r\n\r\n```\r\n<ipython-input-51-e2a47d3a5ea2> in train_grid()\r\n     15     scan_object = ta.Scan(x=x_train, y=y_train, x_val=x_train,\r\n     16                           y_val = y_train,\r\n---> 17                           fraction_limit = 0.0000001, model=get_model, params=grid_params, experiment_name = 'Multiheaded input test')\r\n     18     ta.Analyze(scan_object)\r\n     19 \r\n\r\n/usr/local/lib/python3.6/dist-packages/talos/scan/Scan.py in __init__(self, x, y, params, model, experiment_name, x_val, y_val, val_split, random_method, seed, performance_target, fraction_limit, round_limit, time_limit, boolean_limit, reduction_method, reduction_interval, reduction_window, reduction_threshold, reduction_metric, minimize_loss, disable_progress_bar, print_params, clear_session, save_weights)\r\n    194         # start runtime\r\n    195         from .scan_run import scan_run\r\n--> 196         scan_run(self)\r\n\r\n/usr/local/lib/python3.6/dist-packages/talos/scan/scan_run.py in scan_run(self)\r\n      7 \r\n      8     from .scan_prepare import scan_prepare\r\n----> 9     self = scan_prepare(self)\r\n     10 \r\n     11     # initiate the progress bar\r\n\r\n/usr/local/lib/python3.6/dist-packages/talos/scan/scan_prepare.py in scan_prepare(self)\r\n     28                                    round_limit=self.round_limit,\r\n     29                                    time_limit=self.time_limit,\r\n---> 30                                    boolean_limit=self.boolean_limit\r\n     31                                    )\r\n     32 \r\n\r\n/usr/local/lib/python3.6/dist-packages/talos/parameters/ParamSpace.py in __init__(self, params, param_keys, random_method, fraction_limit, round_limit, time_limit, boolean_limit)\r\n     39 \r\n     40         # apply all the set limits\r\n---> 41         self.param_index = self._param_apply_limits()\r\n     42 \r\n     43         # create the parameter space\r\n\r\n/usr/local/lib/python3.6/dist-packages/talos/parameters/ParamSpace.py in _param_apply_limits(self)\r\n     91             return sample_reducer(self.fraction_limit,\r\n     92                                   self.dimensions,\r\n---> 93                                   self.random_method)\r\n     94 \r\n     95         # a round limit is set\r\n\r\n/usr/local/lib/python3.6/dist-packages/talos/reducers/sample_reducer.py in sample_reducer(limit, max_value, random_method)\r\n     32     from ..utils.exceptions import TalosDataError\r\n     33     if n < 1:\r\n---> 34         raise TalosDataError(\"Limiters lead to < 1 permutations.\")\r\n     35 \r\n     36     # Initialize Randomizer()\r\n\r\nTalosDataError: Limiters lead to < 1 permutations.\r\n```","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/468/timeline","performed_via_github_app":null,"state_reason":"completed"}