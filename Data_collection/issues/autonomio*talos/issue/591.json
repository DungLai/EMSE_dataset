{"url":"https://api.github.com/repos/autonomio/talos/issues/591","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/591/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/591/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/591/events","html_url":"https://github.com/autonomio/talos/issues/591","id":1341191528,"node_id":"I_kwDOB-ECn85P8PVo","number":591,"title":"Advanced hyperparameter configuration","user":{"login":"david-thrower","id":22437440,"node_id":"MDQ6VXNlcjIyNDM3NDQw","avatar_url":"https://avatars.githubusercontent.com/u/22437440?v=4","gravatar_id":"","url":"https://api.github.com/users/david-thrower","html_url":"https://github.com/david-thrower","followers_url":"https://api.github.com/users/david-thrower/followers","following_url":"https://api.github.com/users/david-thrower/following{/other_user}","gists_url":"https://api.github.com/users/david-thrower/gists{/gist_id}","starred_url":"https://api.github.com/users/david-thrower/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/david-thrower/subscriptions","organizations_url":"https://api.github.com/users/david-thrower/orgs","repos_url":"https://api.github.com/users/david-thrower/repos","events_url":"https://api.github.com/users/david-thrower/events{/privacy}","received_events_url":"https://api.github.com/users/david-thrower/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-08-17T05:35:27Z","updated_at":"2022-08-17T12:27:43Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"\r\n\r\n#### 1) I recommend:\r\n\r\nTo talos.Scan(), add a parameter: \r\n \"hyperparameter_config\": for example, a dictionary in the format:\r\n\r\nKEY: 'name of hyperparameter as listed in talos.Scan(params)' ; \r\n\r\nVALUE: list of dictionaries, one dict for each config option for the hyperparameter named in the key, to add additional options like what np.choice offers (e.g size argument allowing an array of selections from a given param, and an option for selection [with | w/o] replacement).\r\n\r\n\r\n## Example:\r\n\r\n```\r\nparams =\\\r\n    {'l4_upstream_conn_index':\n        np.arange(1,3).tolist(),\r\n     'l5_upstream_conn_index':\n        np.arange(1,4).tolist(),\r\n     'l6_upstream_conn_index':\n        np.arange(1,5)).tolist(),\r\n     'l7_upstream_conn_index':\n        np.arange(1,6).tolist()}\r\n\r\nparam_options = {\r\n\r\n    'l4_upstream_conn_index':[\r\n        {'size':3},\r\n        { 'with_replacement':1}],  # Select 3 elements with replacement from l4_upstream_conn_index \r\n\r\n    'l5_upstream_conn_index':[\r\n        {'size':4},\r\n        { 'with_replacement':1}] , # Select 4 elements with replacement from l5_upstream_conn_index\r\n# ...\r\n}\r\n\r\ndef make_skip_connection_model(params)\r\n\r\n    layers = np.ones(7).tolist()\r\n    \r\n    layers[0] = Input((5,))\r\n\r\n    layers[1] = Dense(7)(layers[0] ) \r\n    layers[2] = Dense(7)(layers[1] ) \r\n    layers[3] = Dense(7)(layers[2] ) \r\n\r\n    for i in np.arange(4,8):\r\n        layers[i] =\\\r\n            Dense(\r\n                Concatenate([layers[c]) \r\n                                          for c in params[f'l{i}_upstream_conn_index'']],\r\n                                           axis=1)\r\n            )  # To make the skip connections to myltiple predecessor layers, this needs to make multiple selections from this parameter...\r\n\r\n        out_layer = Dense(1,'sigmoid')(layers[-1])\r\n        model = Model(inputs=layers[0],\r\n                                 outputs=out_layer)\r\n\r\n        model.compile(...)\r\n        results = model.fit(...)\r\n        \r\n        return results, model \r\ntalos.scan(model=make_skip_connection_model,\r\n                 params = params,\r\n                 hyperparameter_config = param_options)\r\n\r\n```","closed_by":null,"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/591/timeline","performed_via_github_app":null,"state_reason":null}