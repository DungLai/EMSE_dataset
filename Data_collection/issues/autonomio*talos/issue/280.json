{"url":"https://api.github.com/repos/autonomio/talos/issues/280","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/280/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/280/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/280/events","html_url":"https://github.com/autonomio/talos/issues/280","id":426954998,"node_id":"MDU6SXNzdWU0MjY5NTQ5OTg=","number":280,"title":"CSV Results don't correspond to graph plot values.","user":{"login":"zutron","id":17316551,"node_id":"MDQ6VXNlcjE3MzE2NTUx","avatar_url":"https://avatars.githubusercontent.com/u/17316551?v=4","gravatar_id":"","url":"https://api.github.com/users/zutron","html_url":"https://github.com/zutron","followers_url":"https://api.github.com/users/zutron/followers","following_url":"https://api.github.com/users/zutron/following{/other_user}","gists_url":"https://api.github.com/users/zutron/gists{/gist_id}","starred_url":"https://api.github.com/users/zutron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zutron/subscriptions","organizations_url":"https://api.github.com/users/zutron/orgs","repos_url":"https://api.github.com/users/zutron/repos","events_url":"https://api.github.com/users/zutron/events{/privacy}","received_events_url":"https://api.github.com/users/zutron/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-03-29T12:05:54Z","updated_at":"2019-03-31T16:51:49Z","closed_at":"2019-03-31T16:51:49Z","author_association":"NONE","active_lock_reason":null,"body":"- [X] I'm up-to-date with the latest release:\r\n    \r\n      pip install -U talos\r\n\r\n- [X] I've confirmed that my Keras model works outside of Talos.\r\n\r\n\r\nX shape - (94776, 641)\r\nY shape - (94776,)\r\n\r\n\r\np = {'lr': [3.2],\r\n    'first_neuron':[10],\r\n     'shape':['triangle'],\r\n     'hidden_layers':[1],\r\n     'batch_size': [8096],\r\n     'epochs': [25],\r\n     'dropout': [0.1],\r\n     'kernel_initializer': ['normal'],\r\n     'optimizer': [Nadam],\r\n     'losses': [binary_crossentropy],\r\n     'activation':[elu],\r\n     'last_activation': ['sigmoid'],\r\n     'classweights':[{0:1, 1:0.5}]\r\n    }\r\n\r\n\r\n\r\n    def keras_model(x_train, y_train, x_val, y_val, params):\r\n    model = Sequential()\r\n    model.add(Dense(params['first_neuron'], input_dim=x_train.shape[1],\r\n                    activation=params['activation'],\r\n                    kernel_initializer=params['kernel_initializer']))\r\n    \r\n    model.add(Dropout(params['dropout']))\r\n\r\n    model.add(Dense(1, activation=params['last_activation'],\r\n                    kernel_initializer=params['kernel_initializer']))\r\n    \r\n    model.compile(loss=params['losses'],\r\n                  optimizer=params['optimizer'](lr=lr_normalizer(params['lr'],params['optimizer'])),\r\n                  metrics=[precision_acc,recall_acc])\r\n    \r\n    history = model.fit(x_train, y_train, \r\n                        validation_data=[x_val, y_val],\r\n                        batch_size=params['batch_size'],\r\n                        callbacks=[live()],\r\n                        epochs=params['epochs'],\r\n                        verbose=0,\r\n                        class_weight=params['classweights'])\r\n\r\n    return history, model\r\n\r\n\r\nThe dataset is an unbalanced binary problem.\r\n-------------------------------------------------------------------------\r\n\r\n\r\nHere is the csv output line for the above dictionary:\r\n\r\n\r\nround_epochs | val_loss | val_precision_acc | val_recall_acc | loss | precision_acc | recall_acc | lr | first_neuron | shape | hidden_layers | batch_size | epochs | dropout | kernel_initializer | optimizer | losses | activation | last_activation | classweights\r\n-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --\r\n25 | 0.623747 | 0.833902 | 0.265479368 | 0.400902 | 0.866431 | 0.277613 | 3.2 | 10 | triangle | 1 | 8096 | 25 | 0.1 | normal | <class 'keras.optimizers.Nadam'> | <function binary_crossentropy at 0x000001B7AC1A6488> | <function elu at 0x000001B7AC1C8EA0> | sigmoid | {0: 1,1: 0.5}\r\n\r\n\r\nAnd here are the actual plots generated during the scan:\r\n\r\nhttps://imgur.com/a/UTSutSL\r\n\r\n\r\nAs you can see - the CSV values for precision and recall do not match up to the final values on the graph.  In fact, it looks like maybe the values in the CSV results file are actually the max() Y values that the graph hits (so epoch ~3 for recall, and epoch ~22 for precision).\r\n\r\n\r\nObviously the data dictionary is just a single test for this example, but the same holds when doing thousands of iterations.   I have also tried different configurations of the model, but still end up with these types of results.  I'm assuming that the graph is the accurate source, and that the data saved to the csv is not correct.\r\n\r\nOr am I doing something wrong?\r\n\r\n","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/280/timeline","performed_via_github_app":null,"state_reason":"completed"}