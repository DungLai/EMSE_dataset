{"url":"https://api.github.com/repos/autonomio/talos/issues/505","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/505/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/505/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/505/events","html_url":"https://github.com/autonomio/talos/issues/505","id":704503069,"node_id":"MDU6SXNzdWU3MDQ1MDMwNjk=","number":505,"title":"Incompatible shape on Stacked LSTM","user":{"login":"minhng22","id":20519982,"node_id":"MDQ6VXNlcjIwNTE5OTgy","avatar_url":"https://avatars.githubusercontent.com/u/20519982?v=4","gravatar_id":"","url":"https://api.github.com/users/minhng22","html_url":"https://github.com/minhng22","followers_url":"https://api.github.com/users/minhng22/followers","following_url":"https://api.github.com/users/minhng22/following{/other_user}","gists_url":"https://api.github.com/users/minhng22/gists{/gist_id}","starred_url":"https://api.github.com/users/minhng22/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/minhng22/subscriptions","organizations_url":"https://api.github.com/users/minhng22/orgs","repos_url":"https://api.github.com/users/minhng22/repos","events_url":"https://api.github.com/users/minhng22/events{/privacy}","received_events_url":"https://api.github.com/users/minhng22/received_events","type":"User","site_admin":false},"labels":[{"id":1040763409,"node_id":"MDU6TGFiZWwxMDQwNzYzNDA5","url":"https://api.github.com/repos/autonomio/talos/labels/user%20support","name":"user support","color":"59db8b","default":false,"description":"nothing is wrong with Talos"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-09-18T16:21:39Z","updated_at":"2020-11-15T11:23:56Z","closed_at":"2020-11-15T11:23:37Z","author_association":"NONE","active_lock_reason":null,"body":"I got the following warning when optimizing LSTM model with Talos.\r\nTalos version `'1.0.0'`\r\n```WARNING:tensorflow:Model was constructed with shape (None, 9, 1) for input Tensor(\"lstm_input:0\", shape=(None, 9, 1), dtype=float32), but it was called on an input with incompatible shape (None, 6, 1).```\r\n\r\nMy model is a stacked LSTM model. The code is as such:\r\n```\r\ndef LSTMTrainOptimization(X_train, y_train, X_val, y_val, params):\r\n    #Build the model\r\n    model = Sequential()\r\n    model.add(LSTM(\r\n        params['NUM_NEURONS_FIRST_LAYER'],\r\n        input_shape=(params['LOOK_BACK'], X_train.shape[2]), \r\n        return_sequences= True))\r\n    model.add(Dropout(params['DROP_OUT']))\r\n    model.add(LSTM(params['NUM_NEURONS_SECOND_LAYER'],input_shape=(params['NUM_NEURONS_FIRST_LAYER'],X_train.shape[2])))\r\n    model.add(Dense(\r\n        params['FORWARD_DAYS'],\r\n        activation= params['DENSE_ACTIVATION']\r\n    )) \r\n    model.compile(\r\n        loss=params['LOSS'], \r\n        optimizer= params['OPTIMIZER'], \r\n        metrics= [tf.keras.metrics.RootMeanSquaredError()])\r\n\r\n    history = model.fit(\r\n        X_train,y_train,\r\n        epochs= params['EPOCHS'],batch_size= params['BATCH_SIZE'], verbose=2,\r\n        validation_data= (X_val, y_val)) \r\n    \r\n    return history, model\r\n```\r\n\r\nI am calling standard talos scan call:\r\n```\r\nh = ta.Scan(\r\n    X_train, \r\n    X_res_train, \r\n    params= PARAMS_OPTIMIZATION,\r\n    model= LSTMTrainOptimization,\r\n    experiment_name='EXP_NO1',\r\n    x_val=X_val,\r\n    y_val=X_res_val\r\n)\r\n```\r\n\r\nthe param variable is:\r\n```\r\nPARAMS_OPTIMIZATION = {\r\n    'NUM_NEURONS_FIRST_LAYER': [10, 8, 6], 'NUM_NEURONS_SECOND_LAYER': [2, 4, 6],\r\n    'BATCH_SIZE': [2, 4, 6], 'EPOCHS': [10, 200, 250], 'LOOK_BACK': [6, 9, 12],\r\n    'DROP_OUT': [0, 0.2], 'FORWARD_DAYS': [1, 3, 6], 'LOSS': ['logcosh', keras.losses.binary_crossentropy],\r\n    'OPTIMIZER': ['Adam', \"RMSprop\"],\r\n    'DENSE_ACTIVATION': ['relu', 'elu']\r\n}\r\n```\r\n\r\nDoes that affect the result of the optimization?","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/505/timeline","performed_via_github_app":null,"state_reason":"completed"}