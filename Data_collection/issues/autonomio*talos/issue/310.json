{"url":"https://api.github.com/repos/autonomio/talos/issues/310","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/310/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/310/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/310/events","html_url":"https://github.com/autonomio/talos/issues/310","id":445498521,"node_id":"MDU6SXNzdWU0NDU0OTg1MjE=","number":310,"title":"KeyError: \"['val_acc'] not in index\"","user":{"login":"troybozarth","id":36769960,"node_id":"MDQ6VXNlcjM2NzY5OTYw","avatar_url":"https://avatars.githubusercontent.com/u/36769960?v=4","gravatar_id":"","url":"https://api.github.com/users/troybozarth","html_url":"https://github.com/troybozarth","followers_url":"https://api.github.com/users/troybozarth/followers","following_url":"https://api.github.com/users/troybozarth/following{/other_user}","gists_url":"https://api.github.com/users/troybozarth/gists{/gist_id}","starred_url":"https://api.github.com/users/troybozarth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/troybozarth/subscriptions","organizations_url":"https://api.github.com/users/troybozarth/orgs","repos_url":"https://api.github.com/users/troybozarth/repos","events_url":"https://api.github.com/users/troybozarth/events{/privacy}","received_events_url":"https://api.github.com/users/troybozarth/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-05-17T15:29:18Z","updated_at":"2019-05-18T06:02:02Z","closed_at":"2019-05-18T06:02:01Z","author_association":"NONE","active_lock_reason":null,"body":"Thanks so much for coming here to raise an issue. Please take a moment to 'check' the below boxes:\r\n\r\n- [x] I'm up-to-date with the latest release:\r\n    \r\n      pip install -U talos\r\n\r\n- [x] I've confirmed that my Keras model works outside of Talos.\r\n\r\nIf you still have an error, please submit **complete trace** and a code with: \r\n\r\n- output of shape for x and y e.g. (212,12)\r\n- Talos params dictionary\r\n- The Keras model wired for Talos\r\n- Description of extra variables in the model\r\n\r\nYou can provide the code in pastebin / gist or any other format you like. \r\n\r\n-------------------------------------------------------------------------\r\nHi Mikko,\r\n\r\nI was originally receiving the error noted here: https://github.com/autonomio/talos/issues/299?_pjax=%23js-repo-pjax-container\r\n\r\nAs per your instructions I installed talos 0.6.0 which solved that error, however if I try and run Scan with reduction I know receive a new error.\r\n\r\nHere is my code:\r\nX.shape\r\nOut[13]: (84, 6)\r\n\r\ny.shape\r\nOut[14]: (84,)\r\n\r\np = {'lr': (0.1, 1, 10),\r\n     'first_neuron': [12,24,48,96],\r\n     'Dropout': (0,0.4,10),\r\n     'loss': ['mse', 'mae'],\r\n     'second_neuron': [3,6,12],\r\n     'Activation': ['relu', 'sigmoid'],\r\n     'optimizer': [rmsprop, adam, sgd],\r\n     'batch_size': [8,16,32],\r\n     'epochs': [50,100,200],\r\n     'kn_init': ['normal', 'uniform']\r\n    }\r\n\r\ndef create_model(X_train, y_train, X_val, y_val,params):\r\n    \r\n    model = Sequential()\r\n    model.add(Dense(params['first_neuron'], input_dim=6, kernel_initializer = params['kn_init']))\r\n    model.add(Activation('relu'))\r\n    model.add(Dropout(params['Dropout']))\r\n    model.add(Dense(params['second_neuron'], kernel_initializer = params['kn_init']))\r\n    model.add(Activation(params['Activation']))\r\n    model.add(Dropout(params['Dropout']))\r\n    model.add(Dense(1, activation='linear', kernel_initializer = params['kn_init']))\r\n    \r\n    model.compile(loss=params['loss'], optimizer=params['optimizer'](lr=lr_normalizer(params['lr'],params['optimizer'])))\r\n\r\n    out = model.fit(X_train, y_train,\r\n              batch_size=params['batch_size'],\r\n              epochs=params['epochs'],\r\n              verbose=0,\r\n              validation_data=(X_val, y_val))\r\n    \r\n    return(out, model)\r\n\r\nh = ta.Scan(X,y, params=p,\r\n            model = create_model,\r\n            experiment_name='NN',\r\n            random_method='quantum',\r\n            fraction_limit=0.001,\r\n            reduction_method='correlation',\r\n            reduction_interval=20,\r\n            reduction_window=10,\r\n            reduction_threshold=0.4,\r\n            reduction_metric='val_acc'\r\n            )\r\n\r\nError Trace:\r\n\r\n  7%|â–‹         | 18/259 [00:23<05:47,  1.44s/it]Traceback (most recent call last):\r\n\r\n  File \"<ipython-input-12-6c7378d70531>\", line 10, in <module>\r\n    reduction_metric='val_acc'\r\n\r\n  File \"C:\\Anaconda\\Lib\\site-packages\\talos\\scan\\Scan.py\", line 172, in __init__\r\n    self.runtime()\r\n\r\n  File \"C:\\Anaconda\\Lib\\site-packages\\talos\\scan\\Scan.py\", line 177, in runtime\r\n    self = scan_run(self)\r\n\r\n  File \"C:\\Anaconda\\Lib\\site-packages\\talos\\scan\\scan_run.py\", line 26, in scan_run\r\n    self = scan_round(self)\r\n\r\n  File \"C:\\Anaconda\\Lib\\site-packages\\talos\\scan\\scan_round.py\", line 28, in scan_round\r\n    self = reduce_run(self)\r\n\r\n  File \"C:\\Anaconda\\Lib\\site-packages\\talos\\reducers\\reduce_run.py\", line 48, in reduce_run\r\n    label_and_value = correlation(self)\r\n\r\n  File \"C:\\Anaconda\\Lib\\site-packages\\talos\\reducers\\correlation.py\", line 19, in correlation\r\n    data = data[[self.reduction_metric] + self._param_dict_keys]\r\n\r\n  File \"C:\\Anaconda\\Lib\\site-packages\\pandas\\core\\frame.py\", line 2934, in __getitem__\r\n    raise_missing=True)\r\n\r\n  File \"C:\\Anaconda\\Lib\\site-packages\\pandas\\core\\indexing.py\", line 1354, in _convert_to_indexer\r\n    return self._get_listlike_indexer(obj, axis, **kwargs)[1]\r\n\r\n  File \"C:\\Anaconda\\Lib\\site-packages\\pandas\\core\\indexing.py\", line 1161, in _get_listlike_indexer\r\n    raise_missing=raise_missing)\r\n\r\n  File \"C:\\Anaconda\\Lib\\site-packages\\pandas\\core\\indexing.py\", line 1252, in _validate_read_indexer\r\n    raise KeyError(\"{} not in index\".format(not_found))\r\n\r\nKeyError: \"['val_acc'] not in index\"\r\n\r\nI know the accuracy parameters aren't meant for regression problems but I've tried several of the metrics as listed in names.py and the same error comes up for all of them.\r\n\r\nThanks","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/310/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/310/timeline","performed_via_github_app":null,"state_reason":"completed"}