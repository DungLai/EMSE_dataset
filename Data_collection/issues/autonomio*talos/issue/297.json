{"url":"https://api.github.com/repos/autonomio/talos/issues/297","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/297/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/297/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/297/events","html_url":"https://github.com/autonomio/talos/issues/297","id":437028013,"node_id":"MDU6SXNzdWU0MzcwMjgwMTM=","number":297,"title":"CSV parsererror with TerminateOnNaN callback","user":{"login":"vendetta1987","id":1315601,"node_id":"MDQ6VXNlcjEzMTU2MDE=","avatar_url":"https://avatars.githubusercontent.com/u/1315601?v=4","gravatar_id":"","url":"https://api.github.com/users/vendetta1987","html_url":"https://github.com/vendetta1987","followers_url":"https://api.github.com/users/vendetta1987/followers","following_url":"https://api.github.com/users/vendetta1987/following{/other_user}","gists_url":"https://api.github.com/users/vendetta1987/gists{/gist_id}","starred_url":"https://api.github.com/users/vendetta1987/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vendetta1987/subscriptions","organizations_url":"https://api.github.com/users/vendetta1987/orgs","repos_url":"https://api.github.com/users/vendetta1987/repos","events_url":"https://api.github.com/users/vendetta1987/events{/privacy}","received_events_url":"https://api.github.com/users/vendetta1987/received_events","type":"User","site_admin":false},"labels":[{"id":994489876,"node_id":"MDU6TGFiZWw5OTQ0ODk4NzY=","url":"https://api.github.com/repos/autonomio/talos/labels/investigation","name":"investigation","color":"d3d3d3","default":false,"description":"gathering information"}],"state":"closed","locked":false,"assignee":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"assignees":[{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/autonomio/talos/milestones/8","html_url":"https://github.com/autonomio/talos/milestone/8","labels_url":"https://api.github.com/repos/autonomio/talos/milestones/8/labels","id":4132581,"node_id":"MDk6TWlsZXN0b25lNDEzMjU4MQ==","number":8,"title":"v.0.6.1","description":null,"creator":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"open_issues":0,"closed_issues":4,"state":"open","created_at":"2019-03-12T09:24:40Z","updated_at":"2019-07-24T11:38:18Z","due_on":null,"closed_at":null},"comments":8,"created_at":"2019-04-25T06:25:50Z","updated_at":"2019-05-21T06:28:58Z","closed_at":"2019-05-21T06:28:58Z","author_association":"NONE","active_lock_reason":null,"body":"- [x] I'm up-to-date with the latest release\r\n- [x] I've confirmed that my Keras model works outside of Talos\r\n\r\nI noticed my talos scans crashing recently and found the following stack trace:\r\n\r\n> File \"pathtomy\\script.py\", line 431, in <module>\r\n    runTalosOptimization(_TRAIN_DATA_GEN, talosParams)\r\n  File \"pathtomy\\script.py\", line 350, in runTalosOptimization\r\n    print_params=True, dataset_name=TALOS_LOG_NAME, experiment_no=str(expNr))\r\n  File \"D:\\conda\\envs\\pip_only\\lib\\site-packages\\talos\\scan\\Scan.py\", line 170, in __init__\r\n    self._null = self.runtime()\r\n  File \"D:\\conda\\envs\\pip_only\\lib\\site-packages\\talos\\scan\\Scan.py\", line 175, in runtime\r\n    self = scan_run(self)\r\n  File \"D:\\conda\\envs\\pip_only\\lib\\site-packages\\talos\\scan\\scan_run.py\", line 18, in scan_run\r\n    self = scan_round(self)\r\n  File \"D:\\conda\\envs\\pip_only\\lib\\site-packages\\talos\\scan\\scan_round.py\", line 65, in scan_round\r\n    self = reduce_run(self)\r\n  File \"D:\\conda\\envs\\pip_only\\lib\\site-packages\\talos\\reducers\\reduce_run.py\", line 16, in reduce_run\r\n    self = reduce_prepare(self)\r\n  File \"D:\\conda\\envs\\pip_only\\lib\\site-packages\\talos\\reducers\\reduce_prepare.py\", line 13, in reduce_prepare\r\n    self.data = pd.read_csv(self.experiment_name + '.csv')\r\n  File \"D:\\conda\\envs\\pip_only\\lib\\site-packages\\pandas\\io\\parsers.py\", line 702, in parser_f\r\n    return _read(filepath_or_buffer, kwds)\r\n  File \"D:\\conda\\envs\\pip_only\\lib\\site-packages\\pandas\\io\\parsers.py\", line 435, in _read\r\n    data = parser.read(nrows)\r\n  File \"D:\\conda\\envs\\pip_only\\lib\\site-packages\\pandas\\io\\parsers.py\", line 1139, in read\r\n    ret = self._engine.read(nrows)\r\n  File \"D:\\conda\\envs\\pip_only\\lib\\site-packages\\pandas\\io\\parsers.py\", line 1995, in read\r\n    data = self._reader.read(nrows)\r\n  File \"pandas\\_libs\\parsers.pyx\", line 899, in pandas._libs.parsers.TextReader.read\r\n  File \"pandas\\_libs\\parsers.pyx\", line 914, in pandas._libs.parsers.TextReader._read_low_memory\r\n  File \"pandas\\_libs\\parsers.pyx\", line 968, in pandas._libs.parsers.TextReader._read_rows\r\n  File \"pandas\\_libs\\parsers.pyx\", line 955, in pandas._libs.parsers.TextReader._tokenize_rows\r\n  File \"pandas\\_libs\\parsers.pyx\", line 2172, in pandas._libs.parsers.raise_parser_error\r\npandas.errors.ParserError: Error tokenizing data. C error: Expected 18 fields in line 5, saw 20\r\n\r\nIndeed the CSV report doesn't contain validation values for some runs that ended in NaN or Inf loss values. This seems to be related but not limited to the usage of the `TerminateOnNaN()` callback provided with keras. I thought the callback was quite helpful to shorten scanning times but if the first run gets terminated automatically, the resulting CSV report lacks the necessary columns to continue:\r\n\r\n>round_epochs,loss,mean_squared_error,convBlockCnt,filterCntStart,b1_size,b1_drop,b2_size,b2_drop,b3_size,b3_drop,b4_size,b4_drop,b5_size,b5_drop,dense_size,dense_act,dense_drop\r\n1,inf,inf,3,32,7,0.1,3,0.30000000000000004,7,0.1,3,0.5000000000000001,7,0.1,308,<function relu at 0x000001A939FF06A8>,0.30000000000000004\r\n1,nan,nan,3,32,3,0.5000000000000001,7,0.5000000000000001,5,0.30000000000000004,5,0.5000000000000001,5,0.7000000000000001,308,<function linear at 0x000001A939FF0950>,0.5000000000000001\r\n1,nan,nan,5,8,3,0.30000000000000004,5,0.30000000000000004,5,0.7000000000000001,7,0.7000000000000001,3,0.5000000000000001,308,<function linear at 0x000001A939FF0950>,0.7000000000000001\r\n1,0.028076652523707033,0.028076652523707033,0.1728719637854572,0.1728719637854572,2,8,3,0.30000000000000004,3,0.7000000000000001,5,0.5000000000000001,5,0.1,5,0.1,212,<function relu at 0x000001A939FF06A8>,0.30000000000000004\r\n1,0.047796255958774674,0.047796255958774674,0.17865630197601579,0.17865630197601579,5,16,7,0.1,3,0.7000000000000001,3,0.1,3,0.5000000000000001,7,0.5000000000000001,116,<function linear at 0x000001A939FF0950>,0.30000000000000004\r\n\r\nMaybe talos could check whether all data is available and fill gaps with something meaningful. It shouldn't crash at least.","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/297/timeline","performed_via_github_app":null,"state_reason":"completed"}