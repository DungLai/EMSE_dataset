{"url":"https://api.github.com/repos/autonomio/talos/issues/155","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/155/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/155/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/155/events","html_url":"https://github.com/autonomio/talos/issues/155","id":391397212,"node_id":"MDU6SXNzdWUzOTEzOTcyMTI=","number":155,"title":"How to run a multi-input model with talos?","user":{"login":"TianLin0509","id":34390943,"node_id":"MDQ6VXNlcjM0MzkwOTQz","avatar_url":"https://avatars.githubusercontent.com/u/34390943?v=4","gravatar_id":"","url":"https://api.github.com/users/TianLin0509","html_url":"https://github.com/TianLin0509","followers_url":"https://api.github.com/users/TianLin0509/followers","following_url":"https://api.github.com/users/TianLin0509/following{/other_user}","gists_url":"https://api.github.com/users/TianLin0509/gists{/gist_id}","starred_url":"https://api.github.com/users/TianLin0509/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TianLin0509/subscriptions","organizations_url":"https://api.github.com/users/TianLin0509/orgs","repos_url":"https://api.github.com/users/TianLin0509/repos","events_url":"https://api.github.com/users/TianLin0509/events{/privacy}","received_events_url":"https://api.github.com/users/TianLin0509/received_events","type":"User","site_admin":false},"labels":[{"id":1167739181,"node_id":"MDU6TGFiZWwxMTY3NzM5MTgx","url":"https://api.github.com/repos/autonomio/talos/labels/topic:%20data","name":"topic: data","color":"ffffff","default":false,"description":"Has to do with input or output data"}],"state":"closed","locked":false,"assignee":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"assignees":[{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/autonomio/talos/milestones/2","html_url":"https://github.com/autonomio/talos/milestone/2","labels_url":"https://api.github.com/repos/autonomio/talos/milestones/2/labels","id":3943452,"node_id":"MDk6TWlsZXN0b25lMzk0MzQ1Mg==","number":2,"title":"v0.4.7","description":null,"creator":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"open_issues":0,"closed_issues":4,"state":"closed","created_at":"2019-01-05T09:42:30Z","updated_at":"2019-07-28T18:39:09Z","due_on":null,"closed_at":"2019-07-28T18:39:09Z"},"comments":8,"created_at":"2018-12-15T17:36:33Z","updated_at":"2019-04-23T13:00:25Z","closed_at":"2019-02-21T09:11:54Z","author_association":"NONE","active_lock_reason":null,"body":"I really like talos and I'm new to it. \r\nI wonder if talos  can work at multi-input models, as I failed in my keras model. \r\n\r\nThe code is really simple as an example\r\n```\r\nx = np.random.randn(100,10);\r\ny = np.random.randn(100,1);\r\n\r\ninputs = Input(shape=(x.shape[1],))\r\ninputs_2 = Input(shape=(x.shape[1],))\r\nlayer = Dense(20)(inputs)\r\nlayer = Dropout(0.1)(layer)\r\noutputs = Dense(1)(layer)\r\nmodel = Model([inputs, inputs_2], outputs)\r\nmodel.compile(loss='mse', optimizer='adam')\r\n\r\nhistory = model.fit([x, x], y,\r\n                    batch_size=10,\r\n                    epochs=10,\r\n                    verbose=2)\r\n```\r\n\r\nIt can work well without Talos. \r\n\r\nThen, following the function Keras model example in github, I rewrite it  as follows:\r\n```\r\nx = np.random.randn(100,10);\r\ny = np.random.randn(100,1);\r\n\r\ndef breast_cancer_model(x_train, y_train, x_val, y_val, params):\r\n    inputs = Input(shape=(x_train.shape[1],))\r\n    inputs_2 = Input(shape=(x_train.shape[1],))\r\n    layer = Dense(params['first_neuron'], activation=params['activation'],\r\n                  kernel_initializer=params['kernel_initializer'])(inputs)\r\n\r\n    layer = Dropout(params['dropout'])(layer)\r\n\r\n    outputs = Dense(1, activation=params['last_activation'],\r\n                    kernel_initializer=params['kernel_initializer'])(layer)\r\n\r\n    model = Model([inputs,inputs_2], outputs)\r\n\r\n    model.compile(loss=params['losses'],\r\n                  optimizer=params['optimizer'](),\r\n                  metrics=['acc'])\r\n\r\n    history = model.fit([x_train, x_train], y_train,\r\n                        validation_data=[x_val, y_val],\r\n                        batch_size=params['batch_size'],\r\n                        epochs=params['epochs'],\r\n                        verbose=0)\r\n\r\n    return history, model\r\n\r\n\r\n# then we can go ahead and set the parameter space\r\np = {'first_neuron':[9, 10, 11],\r\n     'batch_size': [30],\r\n     'epochs': [100],\r\n     'dropout': [0],\r\n     'kernel_initializer': ['uniform','normal'],\r\n     'optimizer': [Nadam, Adam],\r\n     'losses': [binary_crossentropy],\r\n     'activation':[relu, elu],\r\n     'last_activation': [sigmoid]}\r\n\r\nt = ta.Scan(x=[x,x],\r\n            y=y,\r\n            model=breast_cancer_model,\r\n            grid_downsample=1,\r\n            params=p,\r\n            dataset_name='breast_cancer',\r\n            experiment_no='1',\r\n            functional_model=True)\r\n```\r\n\r\nUnfortunately, it can't work. \r\nI wonder if I have made some mistakes, or talos just can't support the multi-input models.\r\nPlease help\r\nThanks in advance and sorry for my English\r\n","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/155/timeline","performed_via_github_app":null,"state_reason":"completed"}