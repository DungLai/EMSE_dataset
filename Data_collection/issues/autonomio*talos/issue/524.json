{"url":"https://api.github.com/repos/autonomio/talos/issues/524","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/524/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/524/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/524/events","html_url":"https://github.com/autonomio/talos/issues/524","id":749722583,"node_id":"MDU6SXNzdWU3NDk3MjI1ODM=","number":524,"title":"TypeError: model() takes 3 positional arguments but 5 were given","user":{"login":"gireeshkbogu","id":3885659,"node_id":"MDQ6VXNlcjM4ODU2NTk=","avatar_url":"https://avatars.githubusercontent.com/u/3885659?v=4","gravatar_id":"","url":"https://api.github.com/users/gireeshkbogu","html_url":"https://github.com/gireeshkbogu","followers_url":"https://api.github.com/users/gireeshkbogu/followers","following_url":"https://api.github.com/users/gireeshkbogu/following{/other_user}","gists_url":"https://api.github.com/users/gireeshkbogu/gists{/gist_id}","starred_url":"https://api.github.com/users/gireeshkbogu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gireeshkbogu/subscriptions","organizations_url":"https://api.github.com/users/gireeshkbogu/orgs","repos_url":"https://api.github.com/users/gireeshkbogu/repos","events_url":"https://api.github.com/users/gireeshkbogu/events{/privacy}","received_events_url":"https://api.github.com/users/gireeshkbogu/received_events","type":"User","site_admin":false},"labels":[{"id":1040763409,"node_id":"MDU6TGFiZWwxMDQwNzYzNDA5","url":"https://api.github.com/repos/autonomio/talos/labels/user%20support","name":"user support","color":"59db8b","default":false,"description":"nothing is wrong with Talos"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-11-24T13:49:34Z","updated_at":"2020-11-29T12:52:56Z","closed_at":"2020-11-29T12:52:56Z","author_association":"NONE","active_lock_reason":null,"body":"\r\nHi, I am trying to run Talos on convolutional autoencoder where I use training data as both train and test to reconstruct. the error. The input data is (x,x,x) format.  I am having this strange error that says I gave more arguments than I needed. I added fully reproducible code and the error. Please let me know what's wrong here.   Thanks. \r\n\r\n\r\nError\r\n```\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-13-85f85a0c019c> in <module>\r\n    115                model=cae,\r\n    116                params=p,\r\n--> 117                experiment_name='conv_autoencoder')\r\n    118 \r\n\r\n~/miniconda2/lib/python3.6/site-packages/talos/scan/Scan.py in __init__(self, x, y, params, model, experiment_name, x_val, y_val, val_split, random_method, seed, performance_target, fraction_limit, round_limit, time_limit, boolean_limit, reduction_method, reduction_interval, reduction_window, reduction_threshold, reduction_metric, minimize_loss, disable_progress_bar, print_params, clear_session, save_weights)\r\n    194         # start runtime\r\n    195         from .scan_run import scan_run\r\n--> 196         scan_run(self)\r\n\r\n~/miniconda2/lib/python3.6/site-packages/talos/scan/scan_run.py in scan_run(self)\r\n     24         # otherwise proceed with next permutation\r\n     25         from .scan_round import scan_round\r\n---> 26         self = scan_round(self)\r\n     27         self.pbar.update(1)\r\n     28 \r\n\r\n~/miniconda2/lib/python3.6/site-packages/talos/scan/scan_round.py in scan_round(self)\r\n     17     # fit the model\r\n     18     from ..model.ingest_model import ingest_model\r\n---> 19     self.model_history, self.round_model = ingest_model(self)\r\n     20     self.round_history.append(self.model_history.history)\r\n     21 \r\n\r\n~/miniconda2/lib/python3.6/site-packages/talos/model/ingest_model.py in ingest_model(self)\r\n      8                       self.x_val,\r\n      9                       self.y_val,\r\n---> 10                       self.round_params)\r\n\r\nTypeError: cae() takes 3 positional arguments but 5 were given\r\n```\r\n\r\nCode\r\n```\r\n\"\"\"\r\n# Load libraries\r\n\"\"\"\r\nimport warnings\r\nwarnings.filterwarnings('ignore')\r\n\r\nimport talos\r\nimport numpy as np\r\nimport pandas as pd\r\nfrom tensorflow import keras\r\nfrom tensorflow.keras import layers\r\nfrom matplotlib import pyplot as plt\r\nimport numpy as np\r\n\r\n# Set random seed\r\nnp.random.seed(0)\r\n\r\n\r\n## Load the data\r\n\r\n\r\nmaster_url_root = \"https://raw.githubusercontent.com/numenta/NAB/master/data/\"\r\n\r\ndf_small_noise_url_suffix = \"artificialNoAnomaly/art_daily_small_noise.csv\"\r\ndf_small_noise_url = master_url_root + df_small_noise_url_suffix\r\ndf_small_noise = pd.read_csv(\r\n    df_small_noise_url, parse_dates=True, index_col=\"timestamp\"\r\n)\r\n\r\ndf_daily_jumpsup_url_suffix = \"artificialWithAnomaly/art_daily_jumpsup.csv\"\r\ndf_daily_jumpsup_url = master_url_root + df_daily_jumpsup_url_suffix\r\ndf_daily_jumpsup = pd.read_csv(\r\n    df_daily_jumpsup_url, parse_dates=True, index_col=\"timestamp\"\r\n)\r\n\r\n\r\n## Prepare training data\r\n\r\n\r\n# Normalize and save the mean and std we get,\r\n# for normalizing test data.\r\ntraining_mean = df_small_noise.mean()\r\ntraining_std = df_small_noise.std()\r\ndf_training_value = (df_small_noise - training_mean) / training_std\r\nprint(\"Number of training samples:\", len(df_training_value))\r\n\r\n\r\n### Create sequences\r\n\r\n\r\nTIME_STEPS = 288\r\n\r\n# Generated training sequences for use in the model.\r\ndef create_sequences(values, time_steps=TIME_STEPS):\r\n    output = []\r\n    for i in range(len(values) - time_steps):\r\n        output.append(values[i : (i + time_steps)])\r\n    return np.stack(output)\r\n\r\nx_train = create_sequences(df_training_value.values)\r\n\r\n\r\n## Build a model\r\n\r\n\r\n# Create function returning a compiled network\r\ndef cae(x_train, y_train, params):\r\n    model = keras.Sequential(\r\n        [\r\n            layers.Input(shape=(x_train.shape[1], y_train.shape[2])),\r\n            layers.Conv1D(\r\n                filters=32, kernel_size=7, padding=\"same\", strides=2, activation=\"relu\"\r\n            ),\r\n            layers.Dropout(rate=0.2),\r\n            layers.Conv1D(\r\n                filters=16, kernel_size=7, padding=\"same\", strides=2, activation=\"relu\"\r\n            ),\r\n            layers.Conv1DTranspose(\r\n                filters=16, kernel_size=7, padding=\"same\", strides=2, activation=\"relu\"\r\n            ),\r\n            layers.Dropout(rate=0.2),\r\n            layers.Conv1DTranspose(\r\n                filters=32, kernel_size=7, padding=\"same\", strides=2, activation=\"relu\"\r\n            ),\r\n            layers.Conv1DTranspose(filters=1, kernel_size=7, padding=\"same\"),\r\n        ]\r\n    )\r\n    \r\n    model.compile(optimizer=keras.optimizers.Adam(learning_rate=0.001), loss=\"mse\", metrics=['mae'])\r\n    \r\n    history = model.fit(\r\n    x_train,\r\n    x_train,\r\n    batch_size=params['batch_size'],\r\n    epochs=params['epochs'],\r\n    validation_split=0.1)\r\n    \r\n    return history, model\r\n\r\n\r\n\r\n# then we can go ahead and set the parameter space\r\np = {'batch_size': [4,8,16],\r\n     'epochs': [10,50,100]}\r\n\r\n\r\n# and run the experiment\r\nt = talos.Scan(x=x_train,\r\n               y=x_train,\r\n               model=cae,\r\n               params=p,\r\n               experiment_name='conv_autoencoder',\r\n               fraction_limit=0.5)\r\n\r\n```","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/524/timeline","performed_via_github_app":null,"state_reason":"completed"}