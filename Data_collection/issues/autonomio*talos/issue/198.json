{"url":"https://api.github.com/repos/autonomio/talos/issues/198","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/198/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/198/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/198/events","html_url":"https://github.com/autonomio/talos/issues/198","id":411180078,"node_id":"MDU6SXNzdWU0MTExODAwNzg=","number":198,"title":"IndexError: tuple index out of range when using ta.Scan","user":{"login":"17laker","id":40563079,"node_id":"MDQ6VXNlcjQwNTYzMDc5","avatar_url":"https://avatars.githubusercontent.com/u/40563079?v=4","gravatar_id":"","url":"https://api.github.com/users/17laker","html_url":"https://github.com/17laker","followers_url":"https://api.github.com/users/17laker/followers","following_url":"https://api.github.com/users/17laker/following{/other_user}","gists_url":"https://api.github.com/users/17laker/gists{/gist_id}","starred_url":"https://api.github.com/users/17laker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/17laker/subscriptions","organizations_url":"https://api.github.com/users/17laker/orgs","repos_url":"https://api.github.com/users/17laker/repos","events_url":"https://api.github.com/users/17laker/events{/privacy}","received_events_url":"https://api.github.com/users/17laker/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-02-17T12:01:16Z","updated_at":"2019-02-18T09:59:03Z","closed_at":"2019-02-17T13:35:29Z","author_association":"NONE","active_lock_reason":null,"body":"Hello, everyone. I am a beginner and learning Keras and Talos recently. \r\nI suffered a problem and can not figure out it. \r\nHere is my code.\r\n### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### \r\nimport numpy as np\r\nfrom pandas import read_csv\r\nfrom sklearn.preprocessing import MinMaxScaler\r\nfrom sklearn.model_selection import train_test_split\r\n\r\nimport talos as ta\r\nfrom keras.optimizers import Adam, RMSprop,SGD\r\nfrom keras.models import Sequential\r\nfrom keras.layers import Dense\r\nfrom keras.activations import relu, sigmoid\r\nfrom talos.model import lr_normalizer,hidden_layers\r\n\r\ndataset = open('E:\\Data.csv')\r\ndataset = read_csv(dataset)\r\n\r\nvalues = dataset.values\r\nvalues = np.delete(values, [0], axis=1)\r\nvalues = values.astype('float32')\r\nprint(values.shape)\r\n\r\nscaler = MinMaxScaler(feature_range=(0, 1))\r\nvalues = scaler.fit_transform(values)\r\n\r\nprint(values.shape)\r\nX, Y = values[:,0:4], values[:, 5]\r\nprint(X.shape, Y.shape)\r\n\r\nX_train,X_test,Y_train, Y_test = train_test_split(X,Y, test_size=0.25, shuffle=False)\r\nprint(X_train.shape, Y_train.shape, X_test.shape, Y_test.shape)\r\n\r\n\r\ndef SSHP_MPLs(X_train,Y_train,X_test,Y_test,p):\r\n    model = Sequential()\r\n    model.add(Dense(p['first_neuron'], input_dim=X_train.shape[1], activation=p['activation']))\r\n    model.add(Dropout(p['dropout']))\r\n    hidden_layers(model, p)\r\n    model.add(Dense(Y_train.shape[1], activation=params['last_activation']))\r\n    model.compile(loss='mse',optimizer=p['optimizer'](lr=lr_normalizer(p['lr'], p['optimizer'])),\r\n                  metrics=['mse','mae'])\r\n    history = model.fit(X_train, Y_train,\r\n                        validation_data=[X_test, Y_test],\r\n                        batch_size=p['batch_size'],\r\n                        epochs=p['epochs'],\r\n                        verbose=0)\r\n    return history, model\r\n\r\np = {'lr': (0.5, 5),\r\n     'first_neuron': [5, 10, 15],\r\n     'hidden_layers': [1, 2],\r\n     'batch_size': (100, 500, 1000),\r\n     'epochs': [5],\r\n     'dropout': (0, 0.1, 0.2),\r\n     'optimizer': [Adam, RMSprop,SGD],\r\n     'activation': [relu, sigmoid],\r\n     'last_activation': [relu]}\r\n\r\n**_ta.Scan(x=X_train,y=Y_train,params=p,model=SSHP_MPLs,x_val = X_test,y_val = Y_test)_**\r\n### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### \r\nHere is the error information.\r\n### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### \r\nIndexError                                Traceback (most recent call last)\r\n<ipython-input-39-75e9b3cf61b6> in <module>\r\n     65      'last_activation': [relu]}\r\n     66 \r\n---> 67 ta.Scan(x=X_train,y=Y_train,params=p,model=SSHP_MPLs,x_val = X_test,y_val = Y_test)\r\n\r\nE:\\Anaconda\\envs\\snowflakes\\lib\\site-packages\\talos\\scan\\Scan.py in __init__(self, x, y, params, model, dataset_name, experiment_no, x_val, y_val, val_split, shuffle, round_limit, grid_downsample, random_method, seed, search_method, reduction_method, reduction_interval, reduction_window, reduction_threshold, reduction_metric, reduce_loss, last_epoch_value, clear_tf_session, disable_progress_bar, print_params, debug)\r\n    161         # input parameters section ends\r\n    162 \r\n--> 163         self._null = self.runtime()\r\n    164 \r\n    165     def runtime(self):\r\n\r\nE:\\Anaconda\\envs\\snowflakes\\lib\\site-packages\\talos\\scan\\Scan.py in runtime(self)\r\n    165     def runtime(self):\r\n    166 \r\n--> 167         self = scan_prepare(self)\r\n    168         self = scan_run(self)\r\n\r\nE:\\Anaconda\\envs\\snowflakes\\lib\\site-packages\\talos\\scan\\scan_prepare.py in scan_prepare(self)\r\n     40 \r\n     41     # create the paramater object and move to self\r\n---> 42     self.paramgrid_object = ParamGrid(self)\r\n     43     self.param_log = self.paramgrid_object.param_log\r\n     44     self.param_grid = self.paramgrid_object.param_grid\r\n\r\nE:\\Anaconda\\envs\\snowflakes\\lib\\site-packages\\talos\\parameters\\ParamGrid.py in __init__(self, main_self)\r\n     20 \r\n     21         # convert the input to useful format\r\n---> 22         self._p = self._param_input_conversion()\r\n     23 \r\n     24         # build the parameter permutation grid\r\n\r\nE:\\Anaconda\\envs\\snowflakes\\lib\\site-packages\\talos\\parameters\\ParamGrid.py in _param_input_conversion(self)\r\n     69                 out[param] = self._param_range(self.main_self.params[param][0],\r\n     70                                                self.main_self.params[param][1],\r\n---> 71                                                self.main_self.params[param][2])\r\n     72             # all other input styles\r\n     73             else:\r\n\r\nIndexError: tuple index out of range\r\n### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### \r\n\r\nI really appreciate it if you can have time to help me out! \r\nThank you in advance! ","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/198/timeline","performed_via_github_app":null,"state_reason":"completed"}