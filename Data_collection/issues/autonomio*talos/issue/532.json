{"url":"https://api.github.com/repos/autonomio/talos/issues/532","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/532/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/532/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/532/events","html_url":"https://github.com/autonomio/talos/issues/532","id":786474055,"node_id":"MDU6SXNzdWU3ODY0NzQwNTU=","number":532,"title":"KeyError: 'metrics' on Kaggle & google colab","user":{"login":"SpinachXPasta","id":22673432,"node_id":"MDQ6VXNlcjIyNjczNDMy","avatar_url":"https://avatars.githubusercontent.com/u/22673432?v=4","gravatar_id":"","url":"https://api.github.com/users/SpinachXPasta","html_url":"https://github.com/SpinachXPasta","followers_url":"https://api.github.com/users/SpinachXPasta/followers","following_url":"https://api.github.com/users/SpinachXPasta/following{/other_user}","gists_url":"https://api.github.com/users/SpinachXPasta/gists{/gist_id}","starred_url":"https://api.github.com/users/SpinachXPasta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SpinachXPasta/subscriptions","organizations_url":"https://api.github.com/users/SpinachXPasta/orgs","repos_url":"https://api.github.com/users/SpinachXPasta/repos","events_url":"https://api.github.com/users/SpinachXPasta/events{/privacy}","received_events_url":"https://api.github.com/users/SpinachXPasta/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"assignees":[{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2021-01-15T02:06:20Z","updated_at":"2022-01-29T18:51:50Z","closed_at":"2022-01-29T18:51:50Z","author_association":"NONE","active_lock_reason":null,"body":"I was trying out TALOS in Kaggle, and I encountered this error. I ran the same code locally on my Mac and it worked any clue why this would happen?\r\n\r\n```\r\n# then we load the dataset\r\nx, y = talos.templates.datasets.breast_cancer()\r\n\r\n# and normalize every feature to mean 0, std 1\r\nx = talos.utils.rescale_meanzero(x)\r\n\r\ndef breast_cancer_model(x_train, y_train, x_val, y_val, params):\r\n\r\n    model = keras.models.Sequential()\r\n    model.add(keras.layers.Dense(params['first_neuron'], input_dim=x_train.shape[1],\r\n                    activation=params['activation'],\r\n                    kernel_initializer=params['kernel_initializer']))\r\n    \r\n    model.add(keras.layers.Dropout(params['dropout']))\r\n\r\n    model.add(keras.layers.Dense(1, activation=params['last_activation'],\r\n                    kernel_initializer=params['kernel_initializer']))\r\n    \r\n    model.compile(loss=params['losses'],\r\n                  optimizer=params['optimizer'],\r\n                  metrics=['acc', talos.utils.metrics.f1score])\r\n    \r\n    history = model.fit(x_train, y_train, \r\n                        validation_data=[x_val, y_val],\r\n                        batch_size=params['batch_size'],\r\n                        callbacks=[talos.utils.live()],\r\n                        epochs=params['epochs'],\r\n                        verbose=0)\r\n\r\n    return history, model\r\n\r\n# then we can go ahead and set the parameter space\r\np = {'first_neuron':[9,10,11],\r\n     'hidden_layers':[0, 1, 2],\r\n     'batch_size': [30],\r\n     'epochs': [20],\r\n     'dropout': [0],\r\n     'kernel_initializer': ['uniform','normal'],\r\n     'optimizer': ['Nadam', 'Adam'],\r\n     'losses': ['binary_crossentropy'],\r\n     'activation':['relu', 'elu'],\r\n     'last_activation': ['sigmoid']}\r\n\r\n# and run the experiment\r\nt = talos.Scan(x=x,\r\n               y=y,\r\n               model=breast_cancer_model,\r\n               params=p,\r\n               experiment_name='breast_cancer',\r\n               round_limit=10,\r\n               disable_progress_bar=True)\r\n```\r\n\r\nLog\r\n```\r\n---------------------------------------------------------------------------\r\nKeyError                                  Traceback (most recent call last)\r\n<ipython-input-6-195f1febb305> in <module>\r\n      6                experiment_name='breast_cancer',\r\n      7                round_limit=10,\r\n----> 8                disable_progress_bar=True)\r\n\r\n/opt/conda/lib/python3.7/site-packages/talos/scan/Scan.py in __init__(self, x, y, params, model, experiment_name, x_val, y_val, val_split, random_method, seed, performance_target, fraction_limit, round_limit, time_limit, boolean_limit, reduction_method, reduction_interval, reduction_window, reduction_threshold, reduction_metric, minimize_loss, disable_progress_bar, print_params, clear_session, save_weights)\r\n    194         # start runtime\r\n    195         from .scan_run import scan_run\r\n--> 196         scan_run(self)\r\n\r\n/opt/conda/lib/python3.7/site-packages/talos/scan/scan_run.py in scan_run(self)\r\n     24         # otherwise proceed with next permutation\r\n     25         from .scan_round import scan_round\r\n---> 26         self = scan_round(self)\r\n     27         self.pbar.update(1)\r\n     28 \r\n\r\n/opt/conda/lib/python3.7/site-packages/talos/scan/scan_round.py in scan_round(self)\r\n     17     # fit the model\r\n     18     from ..model.ingest_model import ingest_model\r\n---> 19     self.model_history, self.round_model = ingest_model(self)\r\n     20     self.round_history.append(self.model_history.history)\r\n     21 \r\n\r\n/opt/conda/lib/python3.7/site-packages/talos/model/ingest_model.py in ingest_model(self)\r\n      8                       self.x_val,\r\n      9                       self.y_val,\r\n---> 10                       self.round_params)\r\n\r\n<ipython-input-4-54fcf7fc51e8> in breast_cancer_model(x_train, y_train, x_val, y_val, params)\r\n     20                         callbacks=[talos.utils.live()],\r\n     21                         epochs=params['epochs'],\r\n---> 22                         verbose=0)\r\n     23 \r\n     24     return history, model\r\n\r\n/opt/conda/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py in _method_wrapper(self, *args, **kwargs)\r\n    106   def _method_wrapper(self, *args, **kwargs):\r\n    107     if not self._in_multi_worker_mode():  # pylint: disable=protected-access\r\n--> 108       return method(self, *args, **kwargs)\r\n    109 \r\n    110     # Running inside `run_distribute_coordinator` already.\r\n\r\n/opt/conda/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq, max_queue_size, workers, use_multiprocessing)\r\n   1077       train_function = self.make_train_function()\r\n   1078       self._train_counter.assign(0)\r\n-> 1079       callbacks.on_train_begin()\r\n   1080       training_logs = None\r\n   1081       # Handle fault-tolerance for multi-worker.\r\n\r\n/opt/conda/lib/python3.7/site-packages/tensorflow/python/keras/callbacks.py in on_train_begin(self, logs)\r\n    499         if numpy_logs is None:  # Only convert once.\r\n    500           numpy_logs = tf_utils.to_numpy_or_python_type(logs)\r\n--> 501         callback.on_train_begin(numpy_logs)\r\n    502 \r\n    503   def on_train_end(self, logs=None):\r\n\r\n/opt/conda/lib/python3.7/site-packages/kerasplotlib/traininglog.py in on_train_begin(self, logs)\r\n     31 \r\n     32     def on_train_begin(self, logs={}):\r\n---> 33         self.base_metrics = [metric for metric in self.params['metrics'] if not metric.startswith('val_')]\r\n     34         if self.figsize is None:\r\n     35             self.figsize = (\r\n\r\nKeyError: 'metrics'\r\n```\r\n\r\n\r\n","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/532/timeline","performed_via_github_app":null,"state_reason":"completed"}