{"url":"https://api.github.com/repos/autonomio/talos/issues/500","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/500/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/500/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/500/events","html_url":"https://github.com/autonomio/talos/issues/500","id":670337530,"node_id":"MDU6SXNzdWU2NzAzMzc1MzA=","number":500,"title":"IndexError using Talos with LSTM layer","user":{"login":"AmberSJones","id":5023186,"node_id":"MDQ6VXNlcjUwMjMxODY=","avatar_url":"https://avatars.githubusercontent.com/u/5023186?v=4","gravatar_id":"","url":"https://api.github.com/users/AmberSJones","html_url":"https://github.com/AmberSJones","followers_url":"https://api.github.com/users/AmberSJones/followers","following_url":"https://api.github.com/users/AmberSJones/following{/other_user}","gists_url":"https://api.github.com/users/AmberSJones/gists{/gist_id}","starred_url":"https://api.github.com/users/AmberSJones/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AmberSJones/subscriptions","organizations_url":"https://api.github.com/users/AmberSJones/orgs","repos_url":"https://api.github.com/users/AmberSJones/repos","events_url":"https://api.github.com/users/AmberSJones/events{/privacy}","received_events_url":"https://api.github.com/users/AmberSJones/received_events","type":"User","site_admin":false},"labels":[{"id":1040763409,"node_id":"MDU6TGFiZWwxMDQwNzYzNDA5","url":"https://api.github.com/repos/autonomio/talos/labels/user%20support","name":"user support","color":"59db8b","default":false,"description":"nothing is wrong with Talos"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-07-31T23:31:27Z","updated_at":"2020-11-15T11:28:37Z","closed_at":"2020-11-15T11:28:37Z","author_association":"NONE","active_lock_reason":null,"body":"I have a working LSTM model to which I am trying to apply Talos to tune and determine hyperparameters. The data are a time series of a single variable. My code, including model definition, parameter list, and scan call are below - I have tried diligently to follow the talos examples and documentation. When I run this, I get an error. Any help or insight is appreciated.\r\n\r\nFile \"\", line 8, in create_model_talos\r\n    model.add(LSTM(params['cells'], input_shape=(time_steps, num_features)))  # one LSTM layer\r\nIndexError: only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices\r\n\r\n```python\r\ndef create_model_talos(params, time_steps, num_features, input_loss='mae', input_optimizer='adam',\r\n                 patience=3, monitor='val_loss', mode='min', epochs=100, validation_split=0.1):\r\n    \"\"\"Uses sequential model class from keras. Adds LSTM layer. Input samples, timesteps, features.\r\n    Hyperparameters include number of cells, dropout rate. Output is encoded feature vector of the input data.\r\n    Uses autoencoder by mirroring/reversing encoder to be a decoder.\"\"\"\r\n    model = Sequential()\r\n    model.add(LSTM(params['cells'], input_shape=(time_steps, num_features)))  # one LSTM layer\r\n    model.add(Dropout(params['dropout']))  \r\n    model.add(RepeatVector(time_steps))  \r\n    model.add(LSTM(params['cells'], return_sequences=True))  # mirror the encoder in the reverse fashion to create the decoder\r\n    model.add(Dropout(params['dropout']))\r\n    model.add(TimeDistributed(Dense(num_features)))\r\n\r\n    print(model.optimizer)\r\n    model.compile(loss=input_loss, optimizer=input_optimizer)\r\n\r\n    es = tf.keras.callbacks.EarlyStopping(monitor=monitor, patience=patience, mode=mode)\r\n    history = model.fit(\r\n        X_train, y_train,\r\n        epochs=epochs,  # early stopping will monitor.\r\n        batch_size=params['batch_size'],  \r\n        validation_split=validation_split,  \r\n        callbacks=[es],  \r\n        shuffle=False  \r\n    )\r\n\r\n    return history, model\r\n\r\n\r\np = {'cells': [4, 8, 16, 32, 64, 128],\r\n     'dropout': (0, 0.4, 10),\r\n     'batch_size': [5, 10, 25, 50]}\r\n\r\nscan_object = talos.Scan(X_train, y_train, params=p, model=create_model_talos, experiment_name='test')\r\n```\r\n\r\n","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/500/timeline","performed_via_github_app":null,"state_reason":"completed"}