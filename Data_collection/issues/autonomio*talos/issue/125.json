{"url":"https://api.github.com/repos/autonomio/talos/issues/125","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/125/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/125/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/125/events","html_url":"https://github.com/autonomio/talos/issues/125","id":378884135,"node_id":"MDU6SXNzdWUzNzg4ODQxMzU=","number":125,"title":"integration with` tf.keras`","user":{"login":"lgloege","id":20347768,"node_id":"MDQ6VXNlcjIwMzQ3NzY4","avatar_url":"https://avatars.githubusercontent.com/u/20347768?v=4","gravatar_id":"","url":"https://api.github.com/users/lgloege","html_url":"https://github.com/lgloege","followers_url":"https://api.github.com/users/lgloege/followers","following_url":"https://api.github.com/users/lgloege/following{/other_user}","gists_url":"https://api.github.com/users/lgloege/gists{/gist_id}","starred_url":"https://api.github.com/users/lgloege/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lgloege/subscriptions","organizations_url":"https://api.github.com/users/lgloege/orgs","repos_url":"https://api.github.com/users/lgloege/repos","events_url":"https://api.github.com/users/lgloege/events{/privacy}","received_events_url":"https://api.github.com/users/lgloege/received_events","type":"User","site_admin":false},"labels":[{"id":923120515,"node_id":"MDU6TGFiZWw5MjMxMjA1MTU=","url":"https://api.github.com/repos/autonomio/talos/labels/question","name":"question","color":"d3d3d3","default":true,"description":""},{"id":1004957408,"node_id":"MDU6TGFiZWwxMDA0OTU3NDA4","url":"https://api.github.com/repos/autonomio/talos/labels/topic:%20tensorflow","name":"topic: tensorflow","color":"ffffff","default":false,"description":"relates with tensorflow backend"}],"state":"closed","locked":false,"assignee":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"assignees":[{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2018-11-08T19:33:26Z","updated_at":"2018-11-09T13:41:01Z","closed_at":"2018-11-09T13:40:33Z","author_association":"NONE","active_lock_reason":null,"body":"Has talos been integrated with `tf.keras`? The following example works fine when I `import keras ...` but fails when I get try to use `import tensroflow.keras ...`. \r\n\r\nHere the error I receive:\r\n```python\r\nValueError: Fetch argument <tf.Variable 'dense/kernel:0' shape=(4, 64) dtype=float32> cannot be interpreted as a Tensor. (Tensor Tensor(\"dense/kernel/Read/ReadVariableOp:0\", shape=(4, 64), dtype=float32) is not an element of this graph.)\r\n```\r\n\r\nHere is my code:\r\n```python\r\n%matplotlib inline\r\nfrom talos.model.early_stopper import early_stopper\r\nfrom talos.model.normalizers import lr_normalizer\r\nfrom tensorflow.keras.models import Sequential\r\nfrom tensorflow.keras.layers import Dropout, Dense\r\nfrom tensorflow.keras.optimizers import Adam, Nadam\r\nfrom tensorflow.keras.activations import softmax\r\nfrom tensorflow.keras.losses import categorical_crossentropy, logcosh\r\nimport talos as ta\r\nimport pandas as pd\r\nimport matplotlib.pyplot as plt\r\nimport numpy as np\r\n\r\nx,y = ta.datasets.iris()\r\n\r\ndef iris_model(x_train, y_train, x_val, y_val, params):\r\n    \r\n    model = Sequential()                            \r\n    model.add(Dense(params['first_neuron'],\r\n                    input_dim=x_train.shape[1],\r\n                    activation='relu'))\r\n    \r\n    model.add(Dropout(params['dropout']))\r\n    model.add(Dense(y_train.shape[1],\r\n                    activation=params['last_activation']))\r\n\r\n    model.compile(optimizer=params['optimizer'](lr=lr_normalizer(params['lr'], params['optimizer'])),\r\n                  loss=params['loss'],\r\n                  metrics=['acc'])\r\n\r\n    out = model.fit(x_train, y_train,\r\n                    batch_size=params['batch_size'],\r\n                    epochs=params['epochs'],\r\n                    verbose=0,\r\n                    validation_data=[x_val, y_val],\r\n                    callbacks=early_stopper(params['epochs'], mode='strict'))\r\n    \r\n    return out, model\r\n\r\n\r\np = {'lr': (0.1, 10, 10),\r\n     'first_neuron':[4, 8, 16, 32, 64, 128],\r\n     'batch_size': [2, 3, 4],\r\n     'epochs': [200],\r\n     'dropout': (0, 0.40, 10),\r\n     'optimizer': [Adam, Nadam],\r\n     'loss': [categorical_crossentropy, logcosh],\r\n     'last_activation': [softmax],\r\n     'weight_regulizer':[None]}\r\n\r\nh = ta.Scan(x, y, params=p,\r\n            model=iris_model,\r\n            dataset_name='iris',\r\n            experiment_no='1',\r\n            grid_downsample=.01)\r\n```","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/125/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/125/timeline","performed_via_github_app":null,"state_reason":"completed"}