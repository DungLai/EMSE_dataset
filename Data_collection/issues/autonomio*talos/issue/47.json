{"url":"https://api.github.com/repos/autonomio/talos/issues/47","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/47/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/47/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/47/events","html_url":"https://github.com/autonomio/talos/issues/47","id":346955951,"node_id":"MDU6SXNzdWUzNDY5NTU5NTE=","number":47,"title":"Issue with shaping ","user":{"login":"giacomotontini","id":42031947,"node_id":"MDQ6VXNlcjQyMDMxOTQ3","avatar_url":"https://avatars.githubusercontent.com/u/42031947?v=4","gravatar_id":"","url":"https://api.github.com/users/giacomotontini","html_url":"https://github.com/giacomotontini","followers_url":"https://api.github.com/users/giacomotontini/followers","following_url":"https://api.github.com/users/giacomotontini/following{/other_user}","gists_url":"https://api.github.com/users/giacomotontini/gists{/gist_id}","starred_url":"https://api.github.com/users/giacomotontini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giacomotontini/subscriptions","organizations_url":"https://api.github.com/users/giacomotontini/orgs","repos_url":"https://api.github.com/users/giacomotontini/repos","events_url":"https://api.github.com/users/giacomotontini/events{/privacy}","received_events_url":"https://api.github.com/users/giacomotontini/received_events","type":"User","site_admin":false},"labels":[{"id":1004957685,"node_id":"MDU6TGFiZWwxMDA0OTU3Njg1","url":"https://api.github.com/repos/autonomio/talos/labels/topic:%20keras","name":"topic: keras","color":"ffffff","default":false,"description":"relates with keras backend"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2018-08-02T10:39:09Z","updated_at":"2018-08-03T07:49:12Z","closed_at":"2018-08-03T07:49:12Z","author_association":"NONE","active_lock_reason":null,"body":"I keep getting this tedious error:\r\n\r\n> ValueError: Error when checking input: expected gru_1_input to have 3 dimensions, but got array with shape (35361, 21)\r\n\r\nTried reshaping in every way but the error continues to come over... In my project I was using batch generator and fit_generator as model training method but this isn't yet supported by this library, so I'm trying to use Talos without them\r\n\r\n\r\n```\r\n p = {'lr': (2, 10, 30),\r\n     'first_neuron':[4, 8, 16, 32, 64, 128],\r\n     'hidden_layers':[1,2,3,4,5,6],\r\n     'batch_size': [2, 3, 4],\r\n     'epochs': [300],\r\n     'dropout': (0, 0.40, 10),\r\n     'optimizer': [Adam],\r\n     'losses': [mae],\r\n     'activation':[relu, elu],\r\n     'last_activation': [sigmoid, softmax]}\r\n\r\ndef iris_model(x_train, y_train, x_val, y_val, params):\r\n\r\n    model = Sequential()\r\n    model.add(GRU(params['first_neuron'], input_shape=(None, x_train.shape[1]), activation=params['activation']))\r\n    model.add(Dropout(params['dropout']))\r\n    model.add(Dense(y_train.shape[1], activation=params['last_activation']))\r\n\r\n    model.compile(optimizer=params['optimizer'](),\r\n                  loss=params['losses'],\r\n                  metrics=['acc'])\r\n\r\n    history = model.fit(x_train, y_train,\r\n                    batch_size=params['batch_size'],\r\n                    epochs=params['epochs'],\r\n                    verbose=0,\r\n                    validation_data=[x_val, y_val])\r\n\r\n    return history, model\r\n\r\n#x_train = x_train.reshape(1, x_train.shape[0], x_train.shape[1])\r\n#y_train = y_train.reshape(1, y_train.shape[0], y_train.shape[1])\r\n\r\nprint(x_train_scaled.shape)\r\nprint(y_train_scaled.shape)\r\n\r\nh = ta.Scan(x_train,\r\n            y_train, \r\n            params=p,\r\n            dataset_name='first_test',\r\n            experiment_no = '1',\r\n            model=iris_model, \r\n            grid_downsample=0.5,\r\n            val_split=0.1,\r\n            shuffle = False,\r\n            reduction_metric='val_loss')\r\n```\r\n\r\nShapes output: \r\nX=> (39291, 21)\r\nY=> (39291, 3)\r\n\r\n\r\n","closed_by":{"login":"giacomotontini","id":42031947,"node_id":"MDQ6VXNlcjQyMDMxOTQ3","avatar_url":"https://avatars.githubusercontent.com/u/42031947?v=4","gravatar_id":"","url":"https://api.github.com/users/giacomotontini","html_url":"https://github.com/giacomotontini","followers_url":"https://api.github.com/users/giacomotontini/followers","following_url":"https://api.github.com/users/giacomotontini/following{/other_user}","gists_url":"https://api.github.com/users/giacomotontini/gists{/gist_id}","starred_url":"https://api.github.com/users/giacomotontini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giacomotontini/subscriptions","organizations_url":"https://api.github.com/users/giacomotontini/orgs","repos_url":"https://api.github.com/users/giacomotontini/repos","events_url":"https://api.github.com/users/giacomotontini/events{/privacy}","received_events_url":"https://api.github.com/users/giacomotontini/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/47/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/47/timeline","performed_via_github_app":null,"state_reason":"completed"}