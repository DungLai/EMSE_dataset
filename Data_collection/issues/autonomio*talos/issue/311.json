{"url":"https://api.github.com/repos/autonomio/talos/issues/311","repository_url":"https://api.github.com/repos/autonomio/talos","labels_url":"https://api.github.com/repos/autonomio/talos/issues/311/labels{/name}","comments_url":"https://api.github.com/repos/autonomio/talos/issues/311/comments","events_url":"https://api.github.com/repos/autonomio/talos/issues/311/events","html_url":"https://github.com/autonomio/talos/issues/311","id":446562158,"node_id":"MDU6SXNzdWU0NDY1NjIxNTg=","number":311,"title":"ValueError when adjust LSTM model for talos","user":{"login":"stevexxs","id":36975063,"node_id":"MDQ6VXNlcjM2OTc1MDYz","avatar_url":"https://avatars.githubusercontent.com/u/36975063?v=4","gravatar_id":"","url":"https://api.github.com/users/stevexxs","html_url":"https://github.com/stevexxs","followers_url":"https://api.github.com/users/stevexxs/followers","following_url":"https://api.github.com/users/stevexxs/following{/other_user}","gists_url":"https://api.github.com/users/stevexxs/gists{/gist_id}","starred_url":"https://api.github.com/users/stevexxs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevexxs/subscriptions","organizations_url":"https://api.github.com/users/stevexxs/orgs","repos_url":"https://api.github.com/users/stevexxs/repos","events_url":"https://api.github.com/users/stevexxs/events{/privacy}","received_events_url":"https://api.github.com/users/stevexxs/received_events","type":"User","site_admin":false},"labels":[{"id":1040763409,"node_id":"MDU6TGFiZWwxMDQwNzYzNDA5","url":"https://api.github.com/repos/autonomio/talos/labels/user%20support","name":"user support","color":"59db8b","default":false,"description":"nothing is wrong with Talos"}],"state":"closed","locked":false,"assignee":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"assignees":[{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2019-05-21T11:19:52Z","updated_at":"2020-04-28T14:43:49Z","closed_at":"2019-05-22T10:15:00Z","author_association":"NONE","active_lock_reason":null,"body":"code as below works without talos\r\n```\r\nmodel = Sequential()\r\nmodel.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2]), return_sequences=False))\r\nmodel.add(Dense(1))\r\nmodel.compile(loss='mae', optimizer='adam')\r\n    # fit network\r\nhistory = model.fit(train_X, train_y, epochs=50, batch_size=50, validation_data=(test_X, test_y), verbose=2, shuffle=False)\r\n```\r\n\r\n\r\nbut when using talos, ValueError happened, the modification is as below.\r\n```\r\n# design network\r\ndef myModel(train_X, test_X, train_y, test_y, params):\r\n    model = Sequential()\r\n    model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2]), return_sequences=False))\r\n    model.add(Dense(1))\r\n    model.compile(loss='mae', optimizer='adam')\r\n    # fit network\r\n    out = model.fit(train_X, train_y, epochs=params['epochs'], batch_size=params['batch_size'], validation_data=(test_X, test_y), verbose=2, shuffle=False)\r\n    return out, model\r\n\r\ntalos.Scan(train_X, train_y, params=p, model=myModel)\r\n```\r\n\r\nthe error message is,\r\n```\r\n  0%|          | 0/12 [00:00<?, ?it/s]\r\n[[0.06852049]]\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-17-7e98033f1bb7> in <module>\r\n     18     return out, model\r\n     19 \r\n---> 20 talos.Scan(train_X, train_y, params=p, model=myModel)\r\n     21 \r\n     22 '''\r\n\r\n~/anaconda3/envs/python36/lib/python3.6/site-packages/talos/scan/Scan.py in __init__(self, x, y, params, model, dataset_name, experiment_no, x_val, y_val, val_split, shuffle, round_limit, grid_downsample, random_method, seed, search_method, reduction_method, reduction_interval, reduction_window, reduction_threshold, reduction_metric, reduce_loss, last_epoch_value, clear_tf_session, disable_progress_bar, print_params, debug)\r\n    168         # input parameters section ends\r\n    169 \r\n--> 170         self._null = self.runtime()\r\n    171 \r\n    172     def runtime(self):\r\n\r\n~/anaconda3/envs/python36/lib/python3.6/site-packages/talos/scan/Scan.py in runtime(self)\r\n    173 \r\n    174         self = scan_prepare(self)\r\n--> 175         self = scan_run(self)\r\n\r\n~/anaconda3/envs/python36/lib/python3.6/site-packages/talos/scan/scan_run.py in scan_run(self)\r\n     16                      disable=self.disable_progress_bar)\r\n     17     while len(self.param_log) != 0:\r\n---> 18         self = scan_round(self)\r\n     19         self.pbar.update(1)\r\n     20     self.pbar.close()\r\n\r\n~/anaconda3/envs/python36/lib/python3.6/site-packages/talos/scan/scan_round.py in scan_round(self)\r\n     30     # fit the model\r\n     31     try:\r\n---> 32         _hr_out, self.keras_model = ingest_model(self)\r\n     33     except TypeError as err:\r\n     34         if err.args[0] == \"unsupported operand type(s) for +: 'int' and 'numpy.str_'\":\r\n\r\n~/anaconda3/envs/python36/lib/python3.6/site-packages/talos/model/ingest_model.py in ingest_model(self)\r\n      8                       self.x_val,\r\n      9                       self.y_val,\r\n---> 10                       self.round_params)\r\n\r\n<ipython-input-17-7e98033f1bb7> in myModel(train_X, test_X, train_y, test_y, params)\r\n     15     model.compile(loss='mae', optimizer='adam')\r\n     16     # fit network\r\n---> 17     out = model.fit(train_X, train_y, epochs=params['epochs'], batch_size=params['batch_size'], validation_data=(test_X, test_y), verbose=2, shuffle=False)\r\n     18     return out, model\r\n     19 \r\n\r\n~/anaconda3/envs/python36/lib/python3.6/site-packages/keras/engine/training.py in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, **kwargs)\r\n    950             sample_weight=sample_weight,\r\n    951             class_weight=class_weight,\r\n--> 952             batch_size=batch_size)\r\n    953         # Prepare validation data.\r\n    954         do_validation = False\r\n\r\n~/anaconda3/envs/python36/lib/python3.6/site-packages/keras/engine/training.py in _standardize_user_data(self, x, y, sample_weight, class_weight, check_array_lengths, batch_size)\r\n    787                 feed_output_shapes,\r\n    788                 check_batch_axis=False,  # Don't enforce the batch size.\r\n--> 789                 exception_prefix='target')\r\n    790 \r\n    791             # Generate sample-wise weight values given the `sample_weight` and\r\n\r\n~/anaconda3/envs/python36/lib/python3.6/site-packages/keras/engine/training_utils.py in standardize_input_data(data, names, shapes, check_batch_axis, exception_prefix)\r\n    126                         ': expected ' + names[i] + ' to have ' +\r\n    127                         str(len(shape)) + ' dimensions, but got array '\r\n--> 128                         'with shape ' + str(data_shape))\r\n    129                 if not check_batch_axis:\r\n    130                     data_shape = data_shape[1:]\r\n\r\nValueError: Error when checking target: expected dense_2 to have 2 dimensions, but got array with shape (2832, 1, 1)\r\n```\r\n\r\n\r\nis there anyone know the reason ?\r\n\r\nThanks !","closed_by":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/autonomio/talos/issues/311/timeline","performed_via_github_app":null,"state_reason":"completed"}