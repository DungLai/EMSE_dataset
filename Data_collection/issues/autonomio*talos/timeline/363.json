[{"id":2531260987,"node_id":"MDEyOkxhYmVsZWRFdmVudDI1MzEyNjA5ODc=","url":"https://api.github.com/repos/autonomio/talos/issues/events/2531260987","actor":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-08-03T10:54:45Z","label":{"name":"documentation","color":"170d70"},"performed_via_github_app":null},{"id":2531260990,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQyNTMxMjYwOTkw","url":"https://api.github.com/repos/autonomio/talos/issues/events/2531260990","actor":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2019-08-03T10:54:45Z","assignee":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/523946041","html_url":"https://github.com/autonomio/talos/issues/363#issuecomment-523946041","issue_url":"https://api.github.com/repos/autonomio/talos/issues/363","id":523946041,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzk0NjA0MQ==","user":{"login":"PiercarloSlavazza","id":3389306,"node_id":"MDQ6VXNlcjMzODkzMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3389306?v=4","gravatar_id":"","url":"https://api.github.com/users/PiercarloSlavazza","html_url":"https://github.com/PiercarloSlavazza","followers_url":"https://api.github.com/users/PiercarloSlavazza/followers","following_url":"https://api.github.com/users/PiercarloSlavazza/following{/other_user}","gists_url":"https://api.github.com/users/PiercarloSlavazza/gists{/gist_id}","starred_url":"https://api.github.com/users/PiercarloSlavazza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PiercarloSlavazza/subscriptions","organizations_url":"https://api.github.com/users/PiercarloSlavazza/orgs","repos_url":"https://api.github.com/users/PiercarloSlavazza/repos","events_url":"https://api.github.com/users/PiercarloSlavazza/events{/privacy}","received_events_url":"https://api.github.com/users/PiercarloSlavazza/received_events","type":"User","site_admin":false},"created_at":"2019-08-22T15:05:35Z","updated_at":"2019-08-22T15:05:35Z","author_association":"NONE","body":"Could you please add the example or at least give some hint about how to build the model?\r\n\r\nI - naively - tried with:\r\n\r\n```python\r\nmodel = Sequential()\r\nmodel.add(tf.keras.layers.Embedding(vocab_size, embedding_dim, input_length=max_length))\r\nmodel.add(tf.keras.layers.GlobalAveragePooling1D())\r\nmodel.add(params['first_neuron'], activation=params['activation'])\r\nmodel.add(tf.keras.layers.Dense(len(classes) + 1, activation='softmax'))\r\nmodel.compile(loss='sparse_categorical_crossentropy', optimizer=params['optimizer'], metrics=['accuracy'])\r\n```\r\n\r\nand got the error:\r\n\r\n```\r\nTypeError: The added layer must be an instance of class Layer. Found: <tensorflow.python.keras.layers.embeddings.Embedding object at 0x000001EBD4844D48>\r\n```\r\n\r\nbut I have no clue about a possible workaround.\r\n\r\nThank you.","reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/523946041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"PiercarloSlavazza","id":3389306,"node_id":"MDQ6VXNlcjMzODkzMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3389306?v=4","gravatar_id":"","url":"https://api.github.com/users/PiercarloSlavazza","html_url":"https://github.com/PiercarloSlavazza","followers_url":"https://api.github.com/users/PiercarloSlavazza/followers","following_url":"https://api.github.com/users/PiercarloSlavazza/following{/other_user}","gists_url":"https://api.github.com/users/PiercarloSlavazza/gists{/gist_id}","starred_url":"https://api.github.com/users/PiercarloSlavazza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PiercarloSlavazza/subscriptions","organizations_url":"https://api.github.com/users/PiercarloSlavazza/orgs","repos_url":"https://api.github.com/users/PiercarloSlavazza/repos","events_url":"https://api.github.com/users/PiercarloSlavazza/events{/privacy}","received_events_url":"https://api.github.com/users/PiercarloSlavazza/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/523952958","html_url":"https://github.com/autonomio/talos/issues/363#issuecomment-523952958","issue_url":"https://api.github.com/repos/autonomio/talos/issues/363","id":523952958,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzk1Mjk1OA==","user":{"login":"PiercarloSlavazza","id":3389306,"node_id":"MDQ6VXNlcjMzODkzMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3389306?v=4","gravatar_id":"","url":"https://api.github.com/users/PiercarloSlavazza","html_url":"https://github.com/PiercarloSlavazza","followers_url":"https://api.github.com/users/PiercarloSlavazza/followers","following_url":"https://api.github.com/users/PiercarloSlavazza/following{/other_user}","gists_url":"https://api.github.com/users/PiercarloSlavazza/gists{/gist_id}","starred_url":"https://api.github.com/users/PiercarloSlavazza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PiercarloSlavazza/subscriptions","organizations_url":"https://api.github.com/users/PiercarloSlavazza/orgs","repos_url":"https://api.github.com/users/PiercarloSlavazza/repos","events_url":"https://api.github.com/users/PiercarloSlavazza/events{/privacy}","received_events_url":"https://api.github.com/users/PiercarloSlavazza/received_events","type":"User","site_admin":false},"created_at":"2019-08-22T15:22:29Z","updated_at":"2019-08-22T15:22:29Z","author_association":"NONE","body":"I have now understood that I have NOT to mix tf.keras and keras.\r\n\r\nSo, I currently have:\r\n\r\n```python\r\nparams = {\r\n    'first_neuron': [100, 200, 300],\r\n    'optimizer': ['Nadam', 'Adam']\r\n}\r\n\r\nmodel = Sequential()\r\nmodel.add(keras.layers.Embedding(vocab_size, embedding_dim, input_length=max_length))\r\nmodel.add(keras.layers.GlobalAveragePooling1D())\r\nmodel.add(keras.layers.Dense(params['first_neuron'], activation='relu'))\r\n```\r\n\r\nwhich gives the error:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-36-750a3f6055be> in <module>\r\n      2 model.add(keras.layers.Embedding(vocab_size, embedding_dim, input_length=max_length))\r\n      3 model.add(keras.layers.GlobalAveragePooling1D())\r\n----> 4 model.add(keras.layers.Dense(params['first_neuron'], activation='relu'))\r\n      5 #model.add(keras.layers.Dense(len(classes) + 1, activation='softmax'))\r\n      6 #model.compile(loss='sparse_categorical_crossentropy', optimizer=params['optimizer'], metrics=['accuracy'])\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\keras\\engine\\sequential.py in add(self, layer)\r\n    179                 self.inputs = network.get_source_inputs(self.outputs[0])\r\n    180         elif self.outputs:\r\n--> 181             output_tensor = layer(self.outputs[0])\r\n    182             if isinstance(output_tensor, list):\r\n    183                 raise TypeError('All layers in a Sequential model '\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\keras\\engine\\base_layer.py in __call__(self, inputs, **kwargs)\r\n    429                                          'You can build it manually via: '\r\n    430                                          '`layer.build(batch_input_shape)`')\r\n--> 431                 self.build(unpack_singleton(input_shapes))\r\n    432                 self.built = True\r\n    433 \r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\keras\\layers\\core.py in build(self, input_shape)\r\n    864                                       name='kernel',\r\n    865                                       regularizer=self.kernel_regularizer,\r\n--> 866                                       constraint=self.kernel_constraint)\r\n    867         if self.use_bias:\r\n    868             self.bias = self.add_weight(shape=(self.units,),\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\keras\\legacy\\interfaces.py in wrapper(*args, **kwargs)\r\n     89                 warnings.warn('Update your `' + object_name + '` call to the ' +\r\n     90                               'Keras 2 API: ' + signature, stacklevel=2)\r\n---> 91             return func(*args, **kwargs)\r\n     92         wrapper._original_function = func\r\n     93         return wrapper\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\keras\\engine\\base_layer.py in add_weight(self, name, shape, dtype, initializer, regularizer, trainable, constraint)\r\n    247         if dtype is None:\r\n    248             dtype = K.floatx()\r\n--> 249         weight = K.variable(initializer(shape),\r\n    250                             dtype=dtype,\r\n    251                             name=name,\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\keras\\initializers.py in __call__(self, shape, dtype)\r\n    207             scale /= max(1., fan_out)\r\n    208         else:\r\n--> 209             scale /= max(1., float(fan_in + fan_out) / 2)\r\n    210         if self.distribution == 'normal':\r\n    211             # 0.879... = scipy.stats.truncnorm.std(a=-2, b=2, loc=0., scale=1.)\r\n\r\nTypeError: unsupported operand type(s) for +: 'int' and 'list'\r\n```","reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/523952958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"PiercarloSlavazza","id":3389306,"node_id":"MDQ6VXNlcjMzODkzMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3389306?v=4","gravatar_id":"","url":"https://api.github.com/users/PiercarloSlavazza","html_url":"https://github.com/PiercarloSlavazza","followers_url":"https://api.github.com/users/PiercarloSlavazza/followers","following_url":"https://api.github.com/users/PiercarloSlavazza/following{/other_user}","gists_url":"https://api.github.com/users/PiercarloSlavazza/gists{/gist_id}","starred_url":"https://api.github.com/users/PiercarloSlavazza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PiercarloSlavazza/subscriptions","organizations_url":"https://api.github.com/users/PiercarloSlavazza/orgs","repos_url":"https://api.github.com/users/PiercarloSlavazza/repos","events_url":"https://api.github.com/users/PiercarloSlavazza/events{/privacy}","received_events_url":"https://api.github.com/users/PiercarloSlavazza/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/523961162","html_url":"https://github.com/autonomio/talos/issues/363#issuecomment-523961162","issue_url":"https://api.github.com/repos/autonomio/talos/issues/363","id":523961162,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzk2MTE2Mg==","user":{"login":"PiercarloSlavazza","id":3389306,"node_id":"MDQ6VXNlcjMzODkzMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3389306?v=4","gravatar_id":"","url":"https://api.github.com/users/PiercarloSlavazza","html_url":"https://github.com/PiercarloSlavazza","followers_url":"https://api.github.com/users/PiercarloSlavazza/followers","following_url":"https://api.github.com/users/PiercarloSlavazza/following{/other_user}","gists_url":"https://api.github.com/users/PiercarloSlavazza/gists{/gist_id}","starred_url":"https://api.github.com/users/PiercarloSlavazza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PiercarloSlavazza/subscriptions","organizations_url":"https://api.github.com/users/PiercarloSlavazza/orgs","repos_url":"https://api.github.com/users/PiercarloSlavazza/repos","events_url":"https://api.github.com/users/PiercarloSlavazza/events{/privacy}","received_events_url":"https://api.github.com/users/PiercarloSlavazza/received_events","type":"User","site_admin":false},"created_at":"2019-08-22T15:42:52Z","updated_at":"2019-08-22T15:43:12Z","author_association":"NONE","body":"Sorry, totally on the wrong track :-(\r\n\r\nI now also understand that I have to pass a function to scan - and not a model (makes sense, of course).\r\n\r\nSo, one step closer, I now have:\r\n\r\n```python\r\np = {\r\n    'first_neuron': [100, 200, 300],\r\n    'optimizer': ['nadam', 'adam']\r\n}\r\n\r\ndef nlp_model(x_train, y_train, x_val, y_val, params):\r\n    \r\n    model = Sequential()\r\n    model.add(keras.layers.Embedding(vocab_size, embedding_dim, input_length=max_length))\r\n    model.add(keras.layers.GlobalAveragePooling1D())\r\n    model.add(keras.layers.Dense(params['first_neuron'], activation='relu'))\r\n    model.add(keras.layers.Dense(len(classes) + 1, activation='softmax'))\r\n    model.compile(loss='sparse_categorical_crossentropy', optimizer=params['optimizer'], metrics=['accuracy'])\r\n\r\n    out = model.fit(x_train, y_train, validation_data=[x_val, y_val], verbose=0)\r\n\r\n    return out, model\r\n\r\nta.Scan(training_padded, training_classes_seq, model=nlp_model, params=p, grid_downsample=0.1)\r\n```\r\n\r\nwhich gives:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nTalosDataError                            Traceback (most recent call last)\r\n<ipython-input-51-2402648ee6e6> in <module>\r\n     17     return out, model\r\n     18 \r\n---> 19 ta.Scan(training_padded, training_classes_seq, model=nlp_model, params=p, grid_downsample=0.1)\r\n     20 \r\n     21 #model = Sequential()\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\talos\\scan\\Scan.py in __init__(self, x, y, params, model, dataset_name, experiment_no, experiment_name, x_val, y_val, val_split, shuffle, round_limit, time_limit, grid_downsample, random_method, seed, search_method, permutation_filter, reduction_method, reduction_interval, reduction_window, reduction_threshold, reduction_metric, reduce_loss, last_epoch_value, clear_tf_session, disable_progress_bar, print_params, debug)\r\n    183         # input parameters section ends\r\n    184 \r\n--> 185         self._null = self.runtime()\r\n    186 \r\n    187     def runtime(self):\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\talos\\scan\\Scan.py in runtime(self)\r\n    187     def runtime(self):\r\n    188 \r\n--> 189         self = scan_prepare(self)\r\n    190         self = scan_run(self)\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\talos\\scan\\scan_prepare.py in scan_prepare(self)\r\n     42 \r\n     43     # create the paramater object and move to self\r\n---> 44     self.paramgrid_object = ParamGrid(self)\r\n     45     self.param_log = self.paramgrid_object.param_log\r\n     46     self.param_grid = self.paramgrid_object.param_grid\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\talos\\parameters\\ParamGrid.py in __init__(self, main_self)\r\n     47         self.param_grid = self._create_param_grid(ls,\r\n     48                                                   final_grid_size,\r\n---> 49                                                   virtual_grid_size)\r\n     50 \r\n     51         # handle the case where permutation filter is provided\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\talos\\parameters\\ParamGrid.py in _create_param_grid(self, ls, final_grid_size, virtual_grid_size)\r\n     70         # select permutations according to downsample\r\n     71         if final_grid_size < virtual_grid_size:\r\n---> 72             out = sample_reducer(self, final_grid_size, virtual_grid_size)\r\n     73         else:\r\n     74             out = range(0, final_grid_size)\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\talos\\reducers\\sample_reducer.py in sample_reducer(self, length, max_value)\r\n     31     # throw an error if\r\n     32     if n < 1:\r\n---> 33         raise TalosDataError(\"No permutations in grid. Incease grid_downsample\")\r\n     34 \r\n     35     # Initialize Randomizer()\r\n\r\nTalosDataError: No permutations in grid. Incease grid_downsample\r\n```","reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/523961162/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"PiercarloSlavazza","id":3389306,"node_id":"MDQ6VXNlcjMzODkzMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3389306?v=4","gravatar_id":"","url":"https://api.github.com/users/PiercarloSlavazza","html_url":"https://github.com/PiercarloSlavazza","followers_url":"https://api.github.com/users/PiercarloSlavazza/followers","following_url":"https://api.github.com/users/PiercarloSlavazza/following{/other_user}","gists_url":"https://api.github.com/users/PiercarloSlavazza/gists{/gist_id}","starred_url":"https://api.github.com/users/PiercarloSlavazza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PiercarloSlavazza/subscriptions","organizations_url":"https://api.github.com/users/PiercarloSlavazza/orgs","repos_url":"https://api.github.com/users/PiercarloSlavazza/repos","events_url":"https://api.github.com/users/PiercarloSlavazza/events{/privacy}","received_events_url":"https://api.github.com/users/PiercarloSlavazza/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/523964104","html_url":"https://github.com/autonomio/talos/issues/363#issuecomment-523964104","issue_url":"https://api.github.com/repos/autonomio/talos/issues/363","id":523964104,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzk2NDEwNA==","user":{"login":"PiercarloSlavazza","id":3389306,"node_id":"MDQ6VXNlcjMzODkzMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3389306?v=4","gravatar_id":"","url":"https://api.github.com/users/PiercarloSlavazza","html_url":"https://github.com/PiercarloSlavazza","followers_url":"https://api.github.com/users/PiercarloSlavazza/followers","following_url":"https://api.github.com/users/PiercarloSlavazza/following{/other_user}","gists_url":"https://api.github.com/users/PiercarloSlavazza/gists{/gist_id}","starred_url":"https://api.github.com/users/PiercarloSlavazza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PiercarloSlavazza/subscriptions","organizations_url":"https://api.github.com/users/PiercarloSlavazza/orgs","repos_url":"https://api.github.com/users/PiercarloSlavazza/repos","events_url":"https://api.github.com/users/PiercarloSlavazza/events{/privacy}","received_events_url":"https://api.github.com/users/PiercarloSlavazza/received_events","type":"User","site_admin":false},"created_at":"2019-08-22T15:49:53Z","updated_at":"2019-08-22T15:49:53Z","author_association":"NONE","body":"Fixed another couple of glitches, and now I have:\r\n\r\n```python\r\n\r\np = {\r\n    'first_neuron': [100, 200, 300],\r\n    'optimizer': ['nadam', 'adam'],\r\n    'epochs': [10,20]\r\n}\r\n\r\ndef nlp_model(x_train, y_train, x_val, y_val, params):\r\n    \r\n    model = Sequential()\r\n    model.add(keras.layers.Embedding(vocab_size, embedding_dim, input_length=max_length))\r\n    model.add(keras.layers.GlobalAveragePooling1D())\r\n    model.add(keras.layers.Dense(params['first_neuron'], activation='relu'))\r\n    model.add(keras.layers.Dense(len(classes) + 1, activation='softmax'))\r\n    model.compile(loss='sparse_categorical_crossentropy', optimizer=params['optimizer'], metrics=['accuracy'])\r\n\r\n    out = model.fit(x_train, y_train, validation_data=[x_val, y_val], epochs=params['epochs'], verbose=0)\r\n\r\n    return out, model\r\n\r\nta.Scan(training_padded, training_classes_seq, model=nlp_model, params=p, grid_downsample=0.5)\r\n\r\n```\r\n\r\nwhich unfortunately gives:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nInternalError                             Traceback (most recent call last)\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\r\n   1355     try:\r\n-> 1356       return fn(*args)\r\n   1357     except errors.OpError as e:\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)\r\n   1340       return self._call_tf_sessionrun(\r\n-> 1341           options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1342 \r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1428         self._session, options, feed_dict, fetch_list, target_list,\r\n-> 1429         run_metadata)\r\n   1430 \r\n\r\nInternalError: GPU sync failed\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nInternalError                             Traceback (most recent call last)\r\n<ipython-input-54-6bee7a6314b7> in <module>\r\n     18     return out, model\r\n     19 \r\n---> 20 ta.Scan(training_padded, training_classes_seq, model=nlp_model, params=p, grid_downsample=0.5)\r\n     21 \r\n     22 #model = Sequential()\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\talos\\scan\\Scan.py in __init__(self, x, y, params, model, dataset_name, experiment_no, experiment_name, x_val, y_val, val_split, shuffle, round_limit, time_limit, grid_downsample, random_method, seed, search_method, permutation_filter, reduction_method, reduction_interval, reduction_window, reduction_threshold, reduction_metric, reduce_loss, last_epoch_value, clear_tf_session, disable_progress_bar, print_params, debug)\r\n    183         # input parameters section ends\r\n    184 \r\n--> 185         self._null = self.runtime()\r\n    186 \r\n    187     def runtime(self):\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\talos\\scan\\Scan.py in runtime(self)\r\n    188 \r\n    189         self = scan_prepare(self)\r\n--> 190         self = scan_run(self)\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\talos\\scan\\scan_run.py in scan_run(self)\r\n     18     # start the main loop of the program\r\n     19     while len(self.param_log) != 0:\r\n---> 20         self = scan_round(self)\r\n     21         self.pbar.update(1)\r\n     22         if self.time_limit is not None:\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\talos\\scan\\scan_round.py in scan_round(self)\r\n     30     # fit the model\r\n     31     try:\r\n---> 32         _hr_out, self.keras_model = ingest_model(self)\r\n     33     except TypeError as err:\r\n     34         if err.args[0] == \"unsupported operand type(s) for +: 'int' and 'numpy.str_'\":\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\talos\\model\\ingest_model.py in ingest_model(self)\r\n      8                       self.x_val,\r\n      9                       self.y_val,\r\n---> 10                       self.round_params)\r\n\r\n<ipython-input-54-6bee7a6314b7> in nlp_model(x_train, y_train, x_val, y_val, params)\r\n     14     model.compile(loss='sparse_categorical_crossentropy', optimizer=params['optimizer'], metrics=['accuracy'])\r\n     15 \r\n---> 16     out = model.fit(x_train, y_train, validation_data=[x_val, y_val], epochs=params['epochs'], verbose=0)\r\n     17 \r\n     18     return out, model\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\keras\\engine\\training.py in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, **kwargs)\r\n   1037                                         initial_epoch=initial_epoch,\r\n   1038                                         steps_per_epoch=steps_per_epoch,\r\n-> 1039                                         validation_steps=validation_steps)\r\n   1040 \r\n   1041     def evaluate(self, x=None, y=None,\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\keras\\engine\\training_arrays.py in fit_loop(model, f, ins, out_labels, batch_size, epochs, verbose, callbacks, val_f, val_ins, shuffle, callback_metrics, initial_epoch, steps_per_epoch, validation_steps)\r\n    197                     ins_batch[i] = ins_batch[i].toarray()\r\n    198 \r\n--> 199                 outs = f(ins_batch)\r\n    200                 outs = to_list(outs)\r\n    201                 for l, o in zip(out_labels, outs):\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\keras\\backend\\tensorflow_backend.py in __call__(self, inputs)\r\n   2695 \r\n   2696     def __call__(self, inputs):\r\n-> 2697         if hasattr(get_session(), '_make_callable_from_options'):\r\n   2698             if py_any(is_sparse(x) for x in self.inputs):\r\n   2699                 if py_any(is_tensor(x) for x in inputs):\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\keras\\backend\\tensorflow_backend.py in get_session()\r\n    197                 # not already marked as initialized.\r\n    198                 is_initialized = session.run(\r\n--> 199                     [tf.is_variable_initialized(v) for v in candidate_vars])\r\n    200                 uninitialized_vars = []\r\n    201                 for flag, v in zip(is_initialized, candidate_vars):\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\tensorflow\\python\\client\\session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    948     try:\r\n    949       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 950                          run_metadata_ptr)\r\n    951       if run_metadata:\r\n    952         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n   1171     if final_fetches or final_targets or (handle and feed_dict_tensor):\r\n   1172       results = self._do_run(handle, final_targets, final_fetches,\r\n-> 1173                              feed_dict_tensor, options, run_metadata)\r\n   1174     else:\r\n   1175       results = []\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n   1348     if handle is None:\r\n   1349       return self._do_call(_run_fn, feeds, fetches, targets, options,\r\n-> 1350                            run_metadata)\r\n   1351     else:\r\n   1352       return self._do_call(_prun_fn, handle, feeds, fetches)\r\n\r\nC:\\tools\\Anaconda3\\envs\\talos\\lib\\site-packages\\tensorflow\\python\\client\\session.py in _do_call(self, fn, *args)\r\n   1368           pass\r\n   1369       message = error_interpolation.interpolate(message, self._graph)\r\n-> 1370       raise type(e)(node_def, op, message)\r\n   1371 \r\n   1372   def _extend_graph(self):\r\n\r\nInternalError: GPU sync failed\r\n```\r\n\r\n`InternalError: GPU sync failed`: I am using tensorflow-gpu (installed via conda) - is it a known limitation that this is incompatible with talos, or I made some other mistake?","reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/523964104/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"PiercarloSlavazza","id":3389306,"node_id":"MDQ6VXNlcjMzODkzMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3389306?v=4","gravatar_id":"","url":"https://api.github.com/users/PiercarloSlavazza","html_url":"https://github.com/PiercarloSlavazza","followers_url":"https://api.github.com/users/PiercarloSlavazza/followers","following_url":"https://api.github.com/users/PiercarloSlavazza/following{/other_user}","gists_url":"https://api.github.com/users/PiercarloSlavazza/gists{/gist_id}","starred_url":"https://api.github.com/users/PiercarloSlavazza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PiercarloSlavazza/subscriptions","organizations_url":"https://api.github.com/users/PiercarloSlavazza/orgs","repos_url":"https://api.github.com/users/PiercarloSlavazza/repos","events_url":"https://api.github.com/users/PiercarloSlavazza/events{/privacy}","received_events_url":"https://api.github.com/users/PiercarloSlavazza/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/523990843","html_url":"https://github.com/autonomio/talos/issues/363#issuecomment-523990843","issue_url":"https://api.github.com/repos/autonomio/talos/issues/363","id":523990843,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzk5MDg0Mw==","user":{"login":"PiercarloSlavazza","id":3389306,"node_id":"MDQ6VXNlcjMzODkzMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3389306?v=4","gravatar_id":"","url":"https://api.github.com/users/PiercarloSlavazza","html_url":"https://github.com/PiercarloSlavazza","followers_url":"https://api.github.com/users/PiercarloSlavazza/followers","following_url":"https://api.github.com/users/PiercarloSlavazza/following{/other_user}","gists_url":"https://api.github.com/users/PiercarloSlavazza/gists{/gist_id}","starred_url":"https://api.github.com/users/PiercarloSlavazza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PiercarloSlavazza/subscriptions","organizations_url":"https://api.github.com/users/PiercarloSlavazza/orgs","repos_url":"https://api.github.com/users/PiercarloSlavazza/repos","events_url":"https://api.github.com/users/PiercarloSlavazza/events{/privacy}","received_events_url":"https://api.github.com/users/PiercarloSlavazza/received_events","type":"User","site_admin":false},"created_at":"2019-08-22T17:01:16Z","updated_at":"2019-08-22T17:52:34Z","author_association":"NONE","body":"Finally got it working:\r\n\r\nFor the records:\r\n\r\n* conda installation (don't know if I missed it, but you should add it somewhere given that currently there are some dependencies issues, plus bugs w/ h5py 2.9):\r\n\r\n```\r\nconda create --name talos scipy=1.2.0 matplotlib=2.2.3  h5py=2.8.0 tensorflow jupyter\r\nconda activate talos\r\npip install talos\r\n```\r\n\r\n* talos/keras code:\r\n\r\n```python\r\np = {\r\n    'first_neuron': [100, 200],\r\n    'optimizer': ['nadam', 'adam'],\r\n    'epochs': [10]\r\n}\r\n\r\ndef nlp_model(x_train, y_train, x_val, y_val, params):\r\n    \r\n    model = Sequential()\r\n    model.add(keras.layers.Embedding(vocab_size, embedding_dim, input_length=max_length))\r\n    model.add(keras.layers.GlobalAveragePooling1D())\r\n    model.add(keras.layers.Dense(params['first_neuron'], activation='relu'))\r\n    model.add(keras.layers.Dense(len(classes) + 1, activation='softmax'))\r\n    model.compile(loss='sparse_categorical_crossentropy', optimizer=params['optimizer'], metrics=['accuracy'])\r\n\r\n    out = model.fit(x_train, y_train, validation_data=[x_val, y_val], epochs=params['epochs'], verbose=0)\r\n\r\n    return out, model\r\n\r\nh = ta.Scan(training_padded, training_classes_seq, model=nlp_model, params=p, grid_downsample=0.5)\r\n```\r\n\r\nOf course w/o GPU it is dead slow. I will try again - and report here if I will succeed.","reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/523990843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"PiercarloSlavazza","id":3389306,"node_id":"MDQ6VXNlcjMzODkzMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3389306?v=4","gravatar_id":"","url":"https://api.github.com/users/PiercarloSlavazza","html_url":"https://github.com/PiercarloSlavazza","followers_url":"https://api.github.com/users/PiercarloSlavazza/followers","following_url":"https://api.github.com/users/PiercarloSlavazza/following{/other_user}","gists_url":"https://api.github.com/users/PiercarloSlavazza/gists{/gist_id}","starred_url":"https://api.github.com/users/PiercarloSlavazza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PiercarloSlavazza/subscriptions","organizations_url":"https://api.github.com/users/PiercarloSlavazza/orgs","repos_url":"https://api.github.com/users/PiercarloSlavazza/repos","events_url":"https://api.github.com/users/PiercarloSlavazza/events{/privacy}","received_events_url":"https://api.github.com/users/PiercarloSlavazza/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/524009617","html_url":"https://github.com/autonomio/talos/issues/363#issuecomment-524009617","issue_url":"https://api.github.com/repos/autonomio/talos/issues/363","id":524009617,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDAwOTYxNw==","user":{"login":"PiercarloSlavazza","id":3389306,"node_id":"MDQ6VXNlcjMzODkzMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3389306?v=4","gravatar_id":"","url":"https://api.github.com/users/PiercarloSlavazza","html_url":"https://github.com/PiercarloSlavazza","followers_url":"https://api.github.com/users/PiercarloSlavazza/followers","following_url":"https://api.github.com/users/PiercarloSlavazza/following{/other_user}","gists_url":"https://api.github.com/users/PiercarloSlavazza/gists{/gist_id}","starred_url":"https://api.github.com/users/PiercarloSlavazza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PiercarloSlavazza/subscriptions","organizations_url":"https://api.github.com/users/PiercarloSlavazza/orgs","repos_url":"https://api.github.com/users/PiercarloSlavazza/repos","events_url":"https://api.github.com/users/PiercarloSlavazza/events{/privacy}","received_events_url":"https://api.github.com/users/PiercarloSlavazza/received_events","type":"User","site_admin":false},"created_at":"2019-08-22T17:50:59Z","updated_at":"2019-08-22T17:52:22Z","author_association":"NONE","body":"> Of course w/o GPU it is dead slow. I will try again - and report here if I will succeed.\r\n\r\nWith this installation command, everything went well and execution is super fast again:\r\n\r\n```\r\nconda create --name talos_gpu scipy=1.2.0 matplotlib=2.2.3  h5py=2.8.0 tensorflow-gpu jupyter\r\nconda activate talos_gpu\r\npip install talos\r\n```","reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/524009617/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"PiercarloSlavazza","id":3389306,"node_id":"MDQ6VXNlcjMzODkzMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3389306?v=4","gravatar_id":"","url":"https://api.github.com/users/PiercarloSlavazza","html_url":"https://github.com/PiercarloSlavazza","followers_url":"https://api.github.com/users/PiercarloSlavazza/followers","following_url":"https://api.github.com/users/PiercarloSlavazza/following{/other_user}","gists_url":"https://api.github.com/users/PiercarloSlavazza/gists{/gist_id}","starred_url":"https://api.github.com/users/PiercarloSlavazza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PiercarloSlavazza/subscriptions","organizations_url":"https://api.github.com/users/PiercarloSlavazza/orgs","repos_url":"https://api.github.com/users/PiercarloSlavazza/repos","events_url":"https://api.github.com/users/PiercarloSlavazza/events{/privacy}","received_events_url":"https://api.github.com/users/PiercarloSlavazza/received_events","type":"User","site_admin":false}},{"id":3020152436,"node_id":"MDEyOkxhYmVsZWRFdmVudDMwMjAxNTI0MzY=","url":"https://api.github.com/repos/autonomio/talos/issues/events/3020152436","actor":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-02-08T20:51:23Z","label":{"name":"value: ⭐⭐","color":"ffffff"},"performed_via_github_app":null},{"id":3020152501,"node_id":"MDEyOkxhYmVsZWRFdmVudDMwMjAxNTI1MDE=","url":"https://api.github.com/repos/autonomio/talos/issues/events/3020152501","actor":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-02-08T20:51:30Z","label":{"name":"priority: MEDIUM","color":"FFA500"},"performed_via_github_app":null},{"id":7318573039,"node_id":"UNLE_lADOB-ECn84cZeeOzwAAAAG0OI_v","url":"https://api.github.com/repos/autonomio/talos/issues/events/7318573039","actor":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2022-09-04T14:57:01Z","label":{"name":"priority: MEDIUM","color":"FFA500"},"performed_via_github_app":null},{"id":7318573041,"node_id":"LE_lADOB-ECn84cZeeOzwAAAAG0OI_x","url":"https://api.github.com/repos/autonomio/talos/issues/events/7318573041","actor":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-09-04T14:57:01Z","label":{"name":"priority: ICE","color":"b5edff"},"performed_via_github_app":null},{"id":7318573136,"node_id":"CE_lADOB-ECn84cZeeOzwAAAAG0OJBQ","url":"https://api.github.com/repos/autonomio/talos/issues/events/7318573136","actor":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-09-04T14:57:06Z","state_reason":null,"performed_via_github_app":null}]