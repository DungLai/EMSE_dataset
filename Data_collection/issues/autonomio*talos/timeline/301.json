[{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/490179815","html_url":"https://github.com/autonomio/talos/issues/301#issuecomment-490179815","issue_url":"https://api.github.com/repos/autonomio/talos/issues/301","id":490179815,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDE3OTgxNQ==","user":{"login":"ErikVini","id":42872619,"node_id":"MDQ6VXNlcjQyODcyNjE5","avatar_url":"https://avatars.githubusercontent.com/u/42872619?v=4","gravatar_id":"","url":"https://api.github.com/users/ErikVini","html_url":"https://github.com/ErikVini","followers_url":"https://api.github.com/users/ErikVini/followers","following_url":"https://api.github.com/users/ErikVini/following{/other_user}","gists_url":"https://api.github.com/users/ErikVini/gists{/gist_id}","starred_url":"https://api.github.com/users/ErikVini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ErikVini/subscriptions","organizations_url":"https://api.github.com/users/ErikVini/orgs","repos_url":"https://api.github.com/users/ErikVini/repos","events_url":"https://api.github.com/users/ErikVini/events{/privacy}","received_events_url":"https://api.github.com/users/ErikVini/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T17:43:54Z","updated_at":"2019-05-07T17:43:54Z","author_association":"NONE","body":"My guess (I'm not related to the development of Talos) is that you can recover the Keras model from the Talos one doing this:\r\n\r\nFirst, you get the index of the best model (given by Talos) using:\r\n```\r\nt = ta.Scan(...)\r\nbest_idx = t.best_model(metric='loss', asc=True) # Change the configurations accordingly to your case\r\n```\r\n\r\nThen transform it back to a Keras model using:\r\n```\r\nfrom talos.utils.best_model import activate_model\r\nTalos_Model = activate_model(t, best_idx)\r\n```\r\n\r\nThis way `Talos_Model` will be the Keras model corresponding to the best one trained by Talos and you can do whatever you want with it (I use `Talos_Model.predict(X)` to make my predictions).\r\n\r\nYou can also change the `best_idx` to any model that Talos has trained, in case you want to check the other trained models.","reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/490179815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ErikVini","id":42872619,"node_id":"MDQ6VXNlcjQyODcyNjE5","avatar_url":"https://avatars.githubusercontent.com/u/42872619?v=4","gravatar_id":"","url":"https://api.github.com/users/ErikVini","html_url":"https://github.com/ErikVini","followers_url":"https://api.github.com/users/ErikVini/followers","following_url":"https://api.github.com/users/ErikVini/following{/other_user}","gists_url":"https://api.github.com/users/ErikVini/gists{/gist_id}","starred_url":"https://api.github.com/users/ErikVini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ErikVini/subscriptions","organizations_url":"https://api.github.com/users/ErikVini/orgs","repos_url":"https://api.github.com/users/ErikVini/repos","events_url":"https://api.github.com/users/ErikVini/events{/privacy}","received_events_url":"https://api.github.com/users/ErikVini/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/490285949","html_url":"https://github.com/autonomio/talos/issues/301#issuecomment-490285949","issue_url":"https://api.github.com/repos/autonomio/talos/issues/301","id":490285949,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDI4NTk0OQ==","user":{"login":"ghost","id":10137,"node_id":"MDQ6VXNlcjEwMTM3","avatar_url":"https://avatars.githubusercontent.com/u/10137?v=4","gravatar_id":"","url":"https://api.github.com/users/ghost","html_url":"https://github.com/ghost","followers_url":"https://api.github.com/users/ghost/followers","following_url":"https://api.github.com/users/ghost/following{/other_user}","gists_url":"https://api.github.com/users/ghost/gists{/gist_id}","starred_url":"https://api.github.com/users/ghost/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghost/subscriptions","organizations_url":"https://api.github.com/users/ghost/orgs","repos_url":"https://api.github.com/users/ghost/repos","events_url":"https://api.github.com/users/ghost/events{/privacy}","received_events_url":"https://api.github.com/users/ghost/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T23:05:21Z","updated_at":"2019-05-07T23:05:21Z","author_association":"NONE","body":"Thank you! I get how I would retrieve the best model, however when I try to do so I get the following error:\r\n```\r\nbest_idx = t.best_model(metric='mean_absolute_error', asc=True)\r\n\r\nTalos_Model = activate_model(t, best_idx)\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/emiel/.local/lib/python3.7/site-packages/IPython/core/interactiveshell.py\", line 3296, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-13-2e176e3c01dd>\", line 3, in <module>\r\n    Talos_Model = activate_model(t, best_idx)\r\n  File \"/home/emiel/.local/lib/python3.7/site-packages/talos/utils/best_model.py\", line 20, in activate_model\r\n    model = model_from_json(self.saved_models[model_id])\r\nTypeError: list indices must be integers or slices, not Sequential\r\n```\r\n\r\nDid you encounter this as well? Let me know if you need more information! ","reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/490285949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ghost","id":10137,"node_id":"MDQ6VXNlcjEwMTM3","avatar_url":"https://avatars.githubusercontent.com/u/10137?v=4","gravatar_id":"","url":"https://api.github.com/users/ghost","html_url":"https://github.com/ghost","followers_url":"https://api.github.com/users/ghost/followers","following_url":"https://api.github.com/users/ghost/following{/other_user}","gists_url":"https://api.github.com/users/ghost/gists{/gist_id}","starred_url":"https://api.github.com/users/ghost/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghost/subscriptions","organizations_url":"https://api.github.com/users/ghost/orgs","repos_url":"https://api.github.com/users/ghost/repos","events_url":"https://api.github.com/users/ghost/events{/privacy}","received_events_url":"https://api.github.com/users/ghost/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/490292665","html_url":"https://github.com/autonomio/talos/issues/301#issuecomment-490292665","issue_url":"https://api.github.com/repos/autonomio/talos/issues/301","id":490292665,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDI5MjY2NQ==","user":{"login":"ErikVini","id":42872619,"node_id":"MDQ6VXNlcjQyODcyNjE5","avatar_url":"https://avatars.githubusercontent.com/u/42872619?v=4","gravatar_id":"","url":"https://api.github.com/users/ErikVini","html_url":"https://github.com/ErikVini","followers_url":"https://api.github.com/users/ErikVini/followers","following_url":"https://api.github.com/users/ErikVini/following{/other_user}","gists_url":"https://api.github.com/users/ErikVini/gists{/gist_id}","starred_url":"https://api.github.com/users/ErikVini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ErikVini/subscriptions","organizations_url":"https://api.github.com/users/ErikVini/orgs","repos_url":"https://api.github.com/users/ErikVini/repos","events_url":"https://api.github.com/users/ErikVini/events{/privacy}","received_events_url":"https://api.github.com/users/ErikVini/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T23:38:58Z","updated_at":"2019-05-07T23:44:28Z","author_association":"NONE","body":"The error you get means that `best_idx` is actually the model, not the index of it. My mistake, sorry. So you can just do \r\n\r\n```\r\nbest_model = t.best_model(metric='mean_absolute_error', asc=True)\r\nbest_model.predict(X)\r\n```\r\n\r\nIf you want to check other models, you can do the following:\r\n\r\n```\r\n# Make a report on the scan\r\nr = ta.Reporting(t)\r\n# Show the models\r\ndisplay(r.data)\r\n```\r\n\r\nThis will output a Pandas DataFrame with all the models and the metrics, so you can choose one of them and use the previous code:\r\n\r\n`Talos_Model = activate_model(t, best_idx)`\r\n\r\nAnd predict normally. An advantage of r.data being a Pandas DataFrame is that you can do operations with it, for example:\r\n\r\n`r.data.sort_values('loss')`\r\n\r\nThis will sort the results table by loss, in ascending order, very useful if you want to compare models.\r\n\r\nEdit: I forgot to mention another cool tip: you can get the index of the model that satisfies a condition like so:\r\n\r\n```\r\ncolumn = 'loss'\r\ndisplay(r.data.loc[r.data[column] == np.min(r.data[column])])\r\n```\r\n\r\nIn this case it will print the model with the lowest loss. You can change the np.min to np.max to get the opposite. To get the index only, simply do:\r\n\r\n`r.data.loc[r.data[column] == np.min(r.data[column])].index.values[0]`","reactions":{"url":"https://api.github.com/repos/autonomio/talos/issues/comments/490292665/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ErikVini","id":42872619,"node_id":"MDQ6VXNlcjQyODcyNjE5","avatar_url":"https://avatars.githubusercontent.com/u/42872619?v=4","gravatar_id":"","url":"https://api.github.com/users/ErikVini","html_url":"https://github.com/ErikVini","followers_url":"https://api.github.com/users/ErikVini/followers","following_url":"https://api.github.com/users/ErikVini/following{/other_user}","gists_url":"https://api.github.com/users/ErikVini/gists{/gist_id}","starred_url":"https://api.github.com/users/ErikVini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ErikVini/subscriptions","organizations_url":"https://api.github.com/users/ErikVini/orgs","repos_url":"https://api.github.com/users/ErikVini/repos","events_url":"https://api.github.com/users/ErikVini/events{/privacy}","received_events_url":"https://api.github.com/users/ErikVini/received_events","type":"User","site_admin":false}},{"id":2368381767,"node_id":"MDExOkNsb3NlZEV2ZW50MjM2ODM4MTc2Nw==","url":"https://api.github.com/repos/autonomio/talos/issues/events/2368381767","actor":{"login":"mikkokotila","id":7943188,"node_id":"MDQ6VXNlcjc5NDMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7943188?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkokotila","html_url":"https://github.com/mikkokotila","followers_url":"https://api.github.com/users/mikkokotila/followers","following_url":"https://api.github.com/users/mikkokotila/following{/other_user}","gists_url":"https://api.github.com/users/mikkokotila/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkokotila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkokotila/subscriptions","organizations_url":"https://api.github.com/users/mikkokotila/orgs","repos_url":"https://api.github.com/users/mikkokotila/repos","events_url":"https://api.github.com/users/mikkokotila/events{/privacy}","received_events_url":"https://api.github.com/users/mikkokotila/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-05-27T05:53:12Z","state_reason":null,"performed_via_github_app":null}]