{"url":"https://api.github.com/repos/scitime/scitime/issues/59","repository_url":"https://api.github.com/repos/scitime/scitime","labels_url":"https://api.github.com/repos/scitime/scitime/issues/59/labels{/name}","comments_url":"https://api.github.com/repos/scitime/scitime/issues/59/comments","events_url":"https://api.github.com/repos/scitime/scitime/issues/59/events","html_url":"https://github.com/scitime/scitime/issues/59","id":820409911,"node_id":"MDU6SXNzdWU4MjA0MDk5MTE=","number":59,"title":"ValueError: Found array with 0 sample(s) (shape=(0,)) while a minimum of 1 is required.","user":{"login":"gitv806","id":72275785,"node_id":"MDQ6VXNlcjcyMjc1Nzg1","avatar_url":"https://avatars.githubusercontent.com/u/72275785?v=4","gravatar_id":"","url":"https://api.github.com/users/gitv806","html_url":"https://github.com/gitv806","followers_url":"https://api.github.com/users/gitv806/followers","following_url":"https://api.github.com/users/gitv806/following{/other_user}","gists_url":"https://api.github.com/users/gitv806/gists{/gist_id}","starred_url":"https://api.github.com/users/gitv806/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gitv806/subscriptions","organizations_url":"https://api.github.com/users/gitv806/orgs","repos_url":"https://api.github.com/users/gitv806/repos","events_url":"https://api.github.com/users/gitv806/events{/privacy}","received_events_url":"https://api.github.com/users/gitv806/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-03-02T21:34:53Z","updated_at":"2021-03-02T22:00:28Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nOn running the sample code in the README for running _model.py, if I pass in save_model as True in the model_fit() call, I get the following error:\r\n\r\n> \r\n> Traceback (most recent call last):\r\n>   File \"//main.py\", line 8, in <module>\r\n>     meta_algo = trainer.model_fit(generate_data=False, inputs=inputs, outputs=outputs, save_model=True)\r\n>   File \"\\\\path_to_project\\venv\\lib\\site-packages\\scitime\\_log.py\", line 25, in timed\r\n>     result = method(*args, **kw)\r\n>   File \"\\\\path_to_project\\venv\\lib\\site-packages\\scitime\\_model.py\", line 524, in model_fit\r\n>     mse_tests = [mean_squared_error(y_test[bin], y_pred_test[bin])\r\n>   File \"\\\\path_to_project\\venv\\lib\\site-packages\\scitime\\_model.py\", line 524, in <listcomp>\r\n>     mse_tests = [mean_squared_error(y_test[bin], y_pred_test[bin])\r\n>   File \"\\\\path_to_project\\venv\\lib\\site-packages\\sklearn\\utils\\validation.py\", line 63, in inner_f\r\n>     return f(*args, **kwargs)\r\n>   File \"\\\\path_to_project\\venv\\lib\\site-packages\\sklearn\\metrics\\_regression.py\", line 335, in mean_squared_error\r\n>     y_type, y_true, y_pred, multioutput = _check_reg_targets(\r\n>   File \"\\\\path_to_project\\venv\\lib\\site-packages\\sklearn\\metrics\\_regression.py\", line 89, in _check_reg_targets\r\n>     y_true = check_array(y_true, ensure_2d=False, dtype=dtype)\r\n>   File \"\\\\path_to_project\\venv\\lib\\site-packages\\sklearn\\utils\\validation.py\", line 63, in inner_f\r\n>     return f(*args, **kwargs)\r\n>   File \"\\\\path_to_project\\venv\\lib\\site-packages\\sklearn\\utils\\validation.py\", line 669, in check_array\r\n>     raise ValueError(\"Found array with %d sample(s) (shape=%s) while a\"\r\n> ValueError: Found array with 0 sample(s) (shape=(0,)) while a minimum of 1 is required.\r\n> \r\n> Process finished with exit code 1\r\n\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n\r\n```\r\nfrom scitime._model import Model\r\n\r\n# example of data generation for rf regressor\r\ntrainer = Model(drop_rate=0.99999, verbose=3, algo='RandomForestRegressor')\r\ninputs, outputs, _ = trainer._generate_data()\r\n\r\n# then fitting the meta model\r\nmeta_algo = trainer.model_fit(generate_data=False, inputs=inputs, outputs=outputs, save_model=True)\r\n```\r\n\r\n**Expected behavior**\r\nNo ValueError to be thrown\r\n\r\n**Suggestion**\r\n\r\nI suspect, in the following code on line 518 of _model.py, \r\n\r\n```\r\n    mse_tests = [mean_squared_error(y_test[bin], y_pred_test[bin])\r\n                 for bin in bins_values]\r\n```\r\n\r\nthat when bin is False and y_test is empty, sklearn/validate.py throws the error.\r\n\r\nWas the intention to do something like this:\r\n\r\n```\r\n    mse_tests=[]\r\n    for bin in bins_values:\r\n        if (y_test[bin].size>0):\r\n            mse_tests.append(mean_squared_error(y_test[bin], y_pred_test[bin]))\r\n```","closed_by":null,"reactions":{"url":"https://api.github.com/repos/scitime/scitime/issues/59/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/scitime/scitime/issues/59/timeline","performed_via_github_app":null,"state_reason":null}