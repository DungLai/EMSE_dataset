{"url":"https://api.github.com/repos/netrack/keras-metrics/issues/26","repository_url":"https://api.github.com/repos/netrack/keras-metrics","labels_url":"https://api.github.com/repos/netrack/keras-metrics/issues/26/labels{/name}","comments_url":"https://api.github.com/repos/netrack/keras-metrics/issues/26/comments","events_url":"https://api.github.com/repos/netrack/keras-metrics/issues/26/events","html_url":"https://github.com/netrack/keras-metrics/issues/26","id":401178318,"node_id":"MDU6SXNzdWU0MDExNzgzMTg=","number":26,"title":"Example for how to use metric with multi-label (ValueError for more than 2 classes)","user":{"login":"NumesSanguis","id":8008618,"node_id":"MDQ6VXNlcjgwMDg2MTg=","avatar_url":"https://avatars.githubusercontent.com/u/8008618?v=4","gravatar_id":"","url":"https://api.github.com/users/NumesSanguis","html_url":"https://github.com/NumesSanguis","followers_url":"https://api.github.com/users/NumesSanguis/followers","following_url":"https://api.github.com/users/NumesSanguis/following{/other_user}","gists_url":"https://api.github.com/users/NumesSanguis/gists{/gist_id}","starred_url":"https://api.github.com/users/NumesSanguis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NumesSanguis/subscriptions","organizations_url":"https://api.github.com/users/NumesSanguis/orgs","repos_url":"https://api.github.com/users/NumesSanguis/repos","events_url":"https://api.github.com/users/NumesSanguis/events{/privacy}","received_events_url":"https://api.github.com/users/NumesSanguis/received_events","type":"User","site_admin":false},"labels":[{"id":947392021,"node_id":"MDU6TGFiZWw5NDczOTIwMjE=","url":"https://api.github.com/repos/netrack/keras-metrics/labels/kind/bug","name":"kind/bug","color":"FF5252","default":false,"description":""},{"id":1057103512,"node_id":"MDU6TGFiZWwxMDU3MTAzNTEy","url":"https://api.github.com/repos/netrack/keras-metrics/labels/area/metrics","name":"area/metrics","color":"fbca04","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-01-21T03:18:09Z","updated_at":"2019-02-21T09:53:36Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Since this issue (https://github.com/netrack/keras-metrics/pull/23) it should be possible to have a y array of longer than 2, however I cannot get it to work.\r\n\r\nI have 5 classes, so I tried to use precision for 1 label with:\r\n\r\n    precision = keras_metrics.precision(label=0)\r\n\r\nHowever, this results in the error:\r\n\r\n    ~/anaconda3/envs/dl/lib/python3.6/site-packages/keras_metrics/metrics.py in _categorical(self, y_true, y_pred, dtype)\r\n         46             return self._binary(y_true, y_pred, dtype, label=1)\r\n         47         elif labels > 2:\r\n    ---> 48             raise ValueError(\"With 2 and more output classes a \"\r\n         49                              \"metric label must be specified\")\r\n         50 \r\n\r\n    ValueError: With 2 and more output classes a metric label must be specified\r\n\r\nIt seems like it only looks at the y shape, and not whether a label is specified?\r\n\r\nWould this be better?:\r\n\r\n    def _categorical(self, y_true, y_pred, dtype, label=None):\r\n        labels = y_pred.shape[-1]\r\n        if labels == 2:\r\n            label=1\r\n\r\n        if labels > 2 and label:  # label != None\r\n            raise ValueError(\"With 2 and more output classes a metric label must be specified\")\r\n        else:\r\n            return self._binary(y_true, y_pred, dtype, label=label)","closed_by":null,"reactions":{"url":"https://api.github.com/repos/netrack/keras-metrics/issues/26/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/netrack/keras-metrics/issues/26/timeline","performed_via_github_app":null,"state_reason":null}