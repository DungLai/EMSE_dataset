{"url":"https://api.github.com/repos/yaserkl/RLSeq2Seq/issues/24","repository_url":"https://api.github.com/repos/yaserkl/RLSeq2Seq","labels_url":"https://api.github.com/repos/yaserkl/RLSeq2Seq/issues/24/labels{/name}","comments_url":"https://api.github.com/repos/yaserkl/RLSeq2Seq/issues/24/comments","events_url":"https://api.github.com/repos/yaserkl/RLSeq2Seq/issues/24/events","html_url":"https://github.com/yaserkl/RLSeq2Seq/issues/24","id":395167205,"node_id":"MDU6SXNzdWUzOTUxNjcyMDU=","number":24,"title":"Facing a issue while training for NMT ?","user":{"login":"yashkumaratri","id":8272814,"node_id":"MDQ6VXNlcjgyNzI4MTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8272814?v=4","gravatar_id":"","url":"https://api.github.com/users/yashkumaratri","html_url":"https://github.com/yashkumaratri","followers_url":"https://api.github.com/users/yashkumaratri/followers","following_url":"https://api.github.com/users/yashkumaratri/following{/other_user}","gists_url":"https://api.github.com/users/yashkumaratri/gists{/gist_id}","starred_url":"https://api.github.com/users/yashkumaratri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yashkumaratri/subscriptions","organizations_url":"https://api.github.com/users/yashkumaratri/orgs","repos_url":"https://api.github.com/users/yashkumaratri/repos","events_url":"https://api.github.com/users/yashkumaratri/events{/privacy}","received_events_url":"https://api.github.com/users/yashkumaratri/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-01-02T07:26:19Z","updated_at":"2019-01-02T13:12:22Z","closed_at":"2019-01-02T13:10:40Z","author_association":"NONE","active_lock_reason":null,"body":"I am running NMT and whenever I run this \r\n\r\n`CUDA_VISIBLE_DEVICES=0 python src/run_summarization.py --mode=train --data_path=~/finished_files/chunked/train_* --vocab_path=~/vocab --log_root=/home/ --exp_name=intradecoder-temporalattention-withpretraining --batch_size=80 --max_iter=20000 --use_temporal_attention=True --intradecoder=True --rl_training=False`\r\n\r\nI get \r\n\r\n```\r\nINFO:tensorflow:-------------------------------------------\r\nINFO:tensorflow:seconds for training step 137: 0.715314865112\r\nINFO:tensorflow:pgen_loss: 1.26063912376e-06\r\nINFO:tensorflow:-------------------------------------------\r\nINFO:tensorflow:Saving checkpoint to path /home/intradecoder-temporalattention-withpretraining/train/model.ckpt\r\nINFO:tensorflow:global_step/sec: 1.08334\r\n2019-01-02 02:23:08.042729: E tensorflow/core/kernels/check_numerics_op.cc:185] abnormal_detected_host @0x10223e38000 = {1, 0} Found Inf or NaN global norm.\r\nTraceback (most recent call last):\r\n  File \"src/run_summarization.py\", line 795, in <module>\r\n    tf.app.run()\r\n  File \"/home//.local/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"src/run_summarization.py\", line 792, in main\r\n    seq2seq.main(unused_argv)\r\n  File \"src/run_summarization.py\", line 745, in main\r\n    self.setup_training()\r\n  File \"src/run_summarization.py\", line 342, in setup_training\r\n    self.run_training() # this is an infinite loop until interrupted\r\n  File \"src/run_summarization.py\", line 431, in run_training\r\n    results = self.model.run_train_steps(self.sess, batch, self.train_step)\r\n  File \"/home/RL/RLSeq2Seq/src/model.py\", line 723, in run_train_steps\r\n    return sess.run(to_return, feed_dict)\r\n  File \"/home/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 929, in run\r\n    run_metadata_ptr)\r\n  File \"/home/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1152, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1328, in _do_run\r\n    run_metadata)\r\n  File \"/home/.local/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 1348, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Nan in summary histogram for: shared_loss/summaries_pgen_loss/histogram\r\n         [[node shared_loss/summaries_pgen_loss/histogram (defined at /hom/RL/RLSeq2Seq/src/model.py:66)  = HistogramSummary[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](shared_loss/summaries_pgen_loss/histogram/tag, shared_loss/Mean/_3277)]]\r\n\r\nCaused by op u'shared_loss/summaries_pgen_loss/histogram', defined at:\r\n  File \"src/run_summarization.py\", line 795, in <module>\r\n    tf.app.run()\r\n  File \"/home/.local/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"src/run_summarization.py\", line 792, in main\r\n    seq2seq.main(unused_argv)\r\n  File \"src/run_summarization.py\", line 745, in main\r\n    self.setup_training()\r\n  File \"src/run_summarization.py\", line 273, in setup_training\r\n    self.model.build_graph() # build the graph\r\n  File \"/home/RL/RLSeq2Seq/src/model.py\", line 468, in build_graph\r\n    self._add_shared_loss_op()\r\n  File \"/home/RL/RLSeq2Seq/src/model.py\", line 316, in _add_shared_loss_op\r\n    self.variable_summaries('pgen_loss', self._pgen_loss)\r\n  File \"/home/RL/RLSeq2Seq/src/model.py\", line 66, in variable_summaries\r\n    tf.summary.histogram('histogram', var)\r\n  File \"/home/.local/lib/python2.7/site-packages/tensorflow/python/summary/summary.py\", line 187, in histogram\r\n    tag=tag, values=values, name=scope)\r\n  File \"/home/.local/lib/python2.7/site-packages/tensorflow/python/ops/gen_logging_ops.py\", line 284, in histogram_summary\r\n    \"HistogramSummary\", tag=tag, values=values, name=name)\r\n  File \"/home/.local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/.local/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/.local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 3274, in create_op\r\n    op_def=op_def)\r\n  File \"/home/.local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 1770, in __init_   self._traceback = tf_stack.extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): Nan in summary histogram for: shared_loss/summaries_pgen_loss/histogram\r\n         [[node shared_loss/summaries_pgen_loss/histogram (defined at /home/RL/RLSeq2Seq/src/model.py:66)  = HistogramSummary[T=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](shared_loss/summaries_pgen_loss/histogram/tag, shared_loss/Mean/_3277)]]\r\n\r\n```\r\n\r\nAny idea how to solve this, I've tweaked learning rate, Batch SIze ? any other variable I need to play with?","closed_by":{"login":"yashkumaratri","id":8272814,"node_id":"MDQ6VXNlcjgyNzI4MTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8272814?v=4","gravatar_id":"","url":"https://api.github.com/users/yashkumaratri","html_url":"https://github.com/yashkumaratri","followers_url":"https://api.github.com/users/yashkumaratri/followers","following_url":"https://api.github.com/users/yashkumaratri/following{/other_user}","gists_url":"https://api.github.com/users/yashkumaratri/gists{/gist_id}","starred_url":"https://api.github.com/users/yashkumaratri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yashkumaratri/subscriptions","organizations_url":"https://api.github.com/users/yashkumaratri/orgs","repos_url":"https://api.github.com/users/yashkumaratri/repos","events_url":"https://api.github.com/users/yashkumaratri/events{/privacy}","received_events_url":"https://api.github.com/users/yashkumaratri/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/yaserkl/RLSeq2Seq/issues/24/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/yaserkl/RLSeq2Seq/issues/24/timeline","performed_via_github_app":null,"state_reason":"completed"}