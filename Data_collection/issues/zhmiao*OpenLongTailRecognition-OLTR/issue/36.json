{"url":"https://api.github.com/repos/zhmiao/OpenLongTailRecognition-OLTR/issues/36","repository_url":"https://api.github.com/repos/zhmiao/OpenLongTailRecognition-OLTR","labels_url":"https://api.github.com/repos/zhmiao/OpenLongTailRecognition-OLTR/issues/36/labels{/name}","comments_url":"https://api.github.com/repos/zhmiao/OpenLongTailRecognition-OLTR/issues/36/comments","events_url":"https://api.github.com/repos/zhmiao/OpenLongTailRecognition-OLTR/issues/36/events","html_url":"https://github.com/zhmiao/OpenLongTailRecognition-OLTR/issues/36","id":488376612,"node_id":"MDU6SXNzdWU0ODgzNzY2MTI=","number":36,"title":"Training error for stage 1","user":{"login":"daofeng2007","id":11918249,"node_id":"MDQ6VXNlcjExOTE4MjQ5","avatar_url":"https://avatars.githubusercontent.com/u/11918249?v=4","gravatar_id":"","url":"https://api.github.com/users/daofeng2007","html_url":"https://github.com/daofeng2007","followers_url":"https://api.github.com/users/daofeng2007/followers","following_url":"https://api.github.com/users/daofeng2007/following{/other_user}","gists_url":"https://api.github.com/users/daofeng2007/gists{/gist_id}","starred_url":"https://api.github.com/users/daofeng2007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/daofeng2007/subscriptions","organizations_url":"https://api.github.com/users/daofeng2007/orgs","repos_url":"https://api.github.com/users/daofeng2007/repos","events_url":"https://api.github.com/users/daofeng2007/events{/privacy}","received_events_url":"https://api.github.com/users/daofeng2007/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-09-03T03:38:53Z","updated_at":"2019-12-19T13:44:22Z","closed_at":"2019-12-19T13:44:22Z","author_association":"NONE","active_lock_reason":null,"body":"Loading dataset from: /mnt/ImageryAnalysis/t0l/OpenLongTailRecognition-OLTR-master/OpenLongTailRecognition-OLTR-master/data/train_256_places365standard\r\n{'criterions': {'PerformanceLoss': {'def_file': 'loss/SoftmaxLoss.py',\r\n                                    'loss_params': {},\r\n                                    'optim_params': None,\r\n                                    'weight': 1.0}},\r\n 'memory': {'centroids': False, 'init_centroids': False},\r\n 'networks': {'classifier': {'def_file': 'models/DotProductClassifier.py',\r\n                             'optim_params': {'lr': 0.1,\r\n                                              'momentum': 0.9,\r\n                                              'weight_decay': 0.0005},\r\n                             'params': {'dataset': 'Places_LT',\r\n                                        'in_dim': 512,\r\n                                        'num_classes': 365,\r\n                                        'stage1_weights': False}},\r\n              'feat_model': {'def_file': 'models/ResNet152Feature.py',\r\n                             'fix': True,\r\n                             'optim_params': {'lr': 0.01,\r\n                                              'momentum': 0.9,\r\n                                              'weight_decay': 0.0005},\r\n                             'params': {'caffe': True,\r\n                                        'dataset': 'Places_LT',\r\n                                        'dropout': None,\r\n                                        'stage1_weights': False,\r\n                                        'use_fc': True,\r\n                                        'use_modulatedatt': False}}},\r\n 'training_opt': {'batch_size': 256,\r\n                  'dataset': 'Places_LT',\r\n                  'display_step': 10,\r\n                  'feature_dim': 512,\r\n                  'log_dir': './logs/Places_LT/stage1',\r\n                  'num_classes': 365,\r\n                  'num_epochs': 30,\r\n                  'num_workers': 4,\r\n                  'open_threshold': 0.1,\r\n                  'sampler': None,\r\n                  'scheduler_params': {'gamma': 0.1, 'step_size': 10}}}\r\nLoading data from ./data/Places_LT/Places_LT_train.txt\r\nUse data transformation: Compose(\r\n    RandomResizedCrop(size=(224, 224), scale=(0.08, 1.0), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)\r\n    RandomHorizontalFlip(p=0.5)\r\n    ColorJitter(brightness=0.4, contrast=0.4, saturation=0.4, hue=0)\r\n    ToTensor()\r\n    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])\r\n)\r\nNo sampler.\r\nShuffle is True.\r\nLoading data from ./data/Places_LT/Places_LT_val.txt\r\nUse data transformation: Compose(\r\n    Resize(size=256, interpolation=PIL.Image.BILINEAR)\r\n    CenterCrop(size=(224, 224))\r\n    ToTensor()\r\n    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])\r\n)\r\nNo sampler.\r\nShuffle is True.\r\nUsing 1 GPUs.\r\nLoading Scratch ResNet 152 Feature Model.\r\nLoading Caffe Pretrained ResNet 152 Weights.\r\nPretrained feature model weights path: ./logs/caffe_resnet152.pth\r\nFreezing feature weights except for self attention weights (if exist).\r\nLoading Dot Product Classifier.\r\nRandom initialized classifier weights.\r\nUsing steps for training.\r\nInitializing model optimizer.\r\nLoading Softmax Loss.\r\nPhase: train\r\nTraceback (most recent call last):\r\n\r\n  File \"<ipython-input-1-76e378b0302c>\", line 1, in <module>\r\n    runfile('/mnt/ImageryAnalysis/t0l/OpenLongTailRecognition-OLTR-master/OpenLongTailRecognition-OLTR-master/main.py', wdir='/mnt/ImageryAnalysis/t0l/OpenLongTailRecognition-OLTR-master/OpenLongTailRecognition-OLTR-master')\r\n\r\n  File \"/home/t0l/anaconda3/envs/dl/lib/python3.5/site-packages/spyder_kernels/customize/spydercustomize.py\", line 668, in runfile\r\n    execfile(filename, namespace)\r\n\r\n  File \"/home/t0l/anaconda3/envs/dl/lib/python3.5/site-packages/spyder_kernels/customize/spydercustomize.py\", line 108, in execfile\r\n    exec(compile(f.read(), filename, 'exec'), namespace)\r\n\r\n  File \"/mnt/ImageryAnalysis/t0l/OpenLongTailRecognition-OLTR-master/OpenLongTailRecognition-OLTR-master/main.py\", line 62, in <module>\r\n    training_model.train()\r\n\r\n  File \"/mnt/ImageryAnalysis/t0l/OpenLongTailRecognition-OLTR-master/OpenLongTailRecognition-OLTR-master/run_networks.py\", line 212, in train\r\n    phase='train')\r\n\r\n  File \"/mnt/ImageryAnalysis/t0l/OpenLongTailRecognition-OLTR-master/OpenLongTailRecognition-OLTR-master/run_networks.py\", line 137, in batch_forward\r\n    self.logits, self.direct_memory_feature = self.networks['classifier'](self.features, self.centroids)\r\n\r\n  File \"/home/t0l/anaconda3/envs/dl/lib/python3.5/site-packages/torch/nn/modules/module.py\", line 477, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n\r\n  File \"/home/t0l/anaconda3/envs/dl/lib/python3.5/site-packages/torch/nn/parallel/data_parallel.py\", line 121, in forward\r\n    return self.module(*inputs[0], **kwargs[0])\r\n\r\n  File \"/home/t0l/anaconda3/envs/dl/lib/python3.5/site-packages/torch/nn/modules/module.py\", line 477, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n\r\n  File \"models/DotProductClassifier.py\", line 11, in forward\r\n    x = self.fc(x)\r\n\r\n  File \"/home/t0l/anaconda3/envs/dl/lib/python3.5/site-packages/torch/nn/modules/module.py\", line 477, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n\r\n  File \"/home/t0l/anaconda3/envs/dl/lib/python3.5/site-packages/torch/nn/modules/linear.py\", line 55, in forward\r\n    return F.linear(input, self.weight, self.bias)\r\n\r\n  File \"/home/t0l/anaconda3/envs/dl/lib/python3.5/site-packages/torch/nn/functional.py\", line 1024, in linear\r\n    return torch.addmm(bias, input, weight.t())\r\n\r\nRuntimeError: size mismatch, m1: [256 x 2048], m2: [512 x 365] at /opt/conda/conda-bld/pytorch_1533672544752/work/aten/src/THC/generic/THCTensorMathBlas.cu:249","closed_by":{"login":"zhmiao","id":7812475,"node_id":"MDQ6VXNlcjc4MTI0NzU=","avatar_url":"https://avatars.githubusercontent.com/u/7812475?v=4","gravatar_id":"","url":"https://api.github.com/users/zhmiao","html_url":"https://github.com/zhmiao","followers_url":"https://api.github.com/users/zhmiao/followers","following_url":"https://api.github.com/users/zhmiao/following{/other_user}","gists_url":"https://api.github.com/users/zhmiao/gists{/gist_id}","starred_url":"https://api.github.com/users/zhmiao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhmiao/subscriptions","organizations_url":"https://api.github.com/users/zhmiao/orgs","repos_url":"https://api.github.com/users/zhmiao/repos","events_url":"https://api.github.com/users/zhmiao/events{/privacy}","received_events_url":"https://api.github.com/users/zhmiao/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/zhmiao/OpenLongTailRecognition-OLTR/issues/36/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/zhmiao/OpenLongTailRecognition-OLTR/issues/36/timeline","performed_via_github_app":null,"state_reason":"completed"}