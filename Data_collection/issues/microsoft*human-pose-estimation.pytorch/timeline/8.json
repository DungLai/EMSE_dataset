[{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/416183621","html_url":"https://github.com/microsoft/human-pose-estimation.pytorch/issues/8#issuecomment-416183621","issue_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/8","id":416183621,"node_id":"MDEyOklzc3VlQ29tbWVudDQxNjE4MzYyMQ==","user":{"login":"leoxiaobin","id":5362509,"node_id":"MDQ6VXNlcjUzNjI1MDk=","avatar_url":"https://avatars.githubusercontent.com/u/5362509?v=4","gravatar_id":"","url":"https://api.github.com/users/leoxiaobin","html_url":"https://github.com/leoxiaobin","followers_url":"https://api.github.com/users/leoxiaobin/followers","following_url":"https://api.github.com/users/leoxiaobin/following{/other_user}","gists_url":"https://api.github.com/users/leoxiaobin/gists{/gist_id}","starred_url":"https://api.github.com/users/leoxiaobin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leoxiaobin/subscriptions","organizations_url":"https://api.github.com/users/leoxiaobin/orgs","repos_url":"https://api.github.com/users/leoxiaobin/repos","events_url":"https://api.github.com/users/leoxiaobin/events{/privacy}","received_events_url":"https://api.github.com/users/leoxiaobin/received_events","type":"User","site_admin":false},"created_at":"2018-08-27T10:25:21Z","updated_at":"2018-08-27T10:26:49Z","author_association":"CONTRIBUTOR","body":"we found that in our code, the global running stats of cudnn's implement for evaluation will get total wrong results when using some GPU architectures (P40, P100, V100), so we disabled the cudnn's implement for BN.    ","reactions":{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/416183621/reactions","total_count":10,"+1":10,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"leoxiaobin","id":5362509,"node_id":"MDQ6VXNlcjUzNjI1MDk=","avatar_url":"https://avatars.githubusercontent.com/u/5362509?v=4","gravatar_id":"","url":"https://api.github.com/users/leoxiaobin","html_url":"https://github.com/leoxiaobin","followers_url":"https://api.github.com/users/leoxiaobin/followers","following_url":"https://api.github.com/users/leoxiaobin/following{/other_user}","gists_url":"https://api.github.com/users/leoxiaobin/gists{/gist_id}","starred_url":"https://api.github.com/users/leoxiaobin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leoxiaobin/subscriptions","organizations_url":"https://api.github.com/users/leoxiaobin/orgs","repos_url":"https://api.github.com/users/leoxiaobin/repos","events_url":"https://api.github.com/users/leoxiaobin/events{/privacy}","received_events_url":"https://api.github.com/users/leoxiaobin/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/421042696","html_url":"https://github.com/microsoft/human-pose-estimation.pytorch/issues/8#issuecomment-421042696","issue_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/8","id":421042696,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMTA0MjY5Ng==","user":{"login":"7color94","id":24718827,"node_id":"MDQ6VXNlcjI0NzE4ODI3","avatar_url":"https://avatars.githubusercontent.com/u/24718827?v=4","gravatar_id":"","url":"https://api.github.com/users/7color94","html_url":"https://github.com/7color94","followers_url":"https://api.github.com/users/7color94/followers","following_url":"https://api.github.com/users/7color94/following{/other_user}","gists_url":"https://api.github.com/users/7color94/gists{/gist_id}","starred_url":"https://api.github.com/users/7color94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/7color94/subscriptions","organizations_url":"https://api.github.com/users/7color94/orgs","repos_url":"https://api.github.com/users/7color94/repos","events_url":"https://api.github.com/users/7color94/events{/privacy}","received_events_url":"https://api.github.com/users/7color94/received_events","type":"User","site_admin":false},"created_at":"2018-09-13T15:11:33Z","updated_at":"2018-09-13T15:11:33Z","author_association":"NONE","body":"Hi, I wonder under what circumstances will this kind of cudnn bn bug appear ? Does the cudnn bn bug appear for all tasks, not only human pose estimation ?","reactions":{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/421042696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"7color94","id":24718827,"node_id":"MDQ6VXNlcjI0NzE4ODI3","avatar_url":"https://avatars.githubusercontent.com/u/24718827?v=4","gravatar_id":"","url":"https://api.github.com/users/7color94","html_url":"https://github.com/7color94","followers_url":"https://api.github.com/users/7color94/followers","following_url":"https://api.github.com/users/7color94/following{/other_user}","gists_url":"https://api.github.com/users/7color94/gists{/gist_id}","starred_url":"https://api.github.com/users/7color94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/7color94/subscriptions","organizations_url":"https://api.github.com/users/7color94/orgs","repos_url":"https://api.github.com/users/7color94/repos","events_url":"https://api.github.com/users/7color94/events{/privacy}","received_events_url":"https://api.github.com/users/7color94/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/423824806","html_url":"https://github.com/microsoft/human-pose-estimation.pytorch/issues/8#issuecomment-423824806","issue_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/8","id":423824806,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMzgyNDgwNg==","user":{"login":"leoxiaobin","id":5362509,"node_id":"MDQ6VXNlcjUzNjI1MDk=","avatar_url":"https://avatars.githubusercontent.com/u/5362509?v=4","gravatar_id":"","url":"https://api.github.com/users/leoxiaobin","html_url":"https://github.com/leoxiaobin","followers_url":"https://api.github.com/users/leoxiaobin/followers","following_url":"https://api.github.com/users/leoxiaobin/following{/other_user}","gists_url":"https://api.github.com/users/leoxiaobin/gists{/gist_id}","starred_url":"https://api.github.com/users/leoxiaobin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leoxiaobin/subscriptions","organizations_url":"https://api.github.com/users/leoxiaobin/orgs","repos_url":"https://api.github.com/users/leoxiaobin/repos","events_url":"https://api.github.com/users/leoxiaobin/events{/privacy}","received_events_url":"https://api.github.com/users/leoxiaobin/received_events","type":"User","site_admin":false},"created_at":"2018-09-23T15:32:13Z","updated_at":"2018-09-23T15:32:13Z","author_association":"CONTRIBUTOR","body":"I am not sure if any other task has also this problem and also not know what's the root cause for this.","reactions":{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/423824806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"leoxiaobin","id":5362509,"node_id":"MDQ6VXNlcjUzNjI1MDk=","avatar_url":"https://avatars.githubusercontent.com/u/5362509?v=4","gravatar_id":"","url":"https://api.github.com/users/leoxiaobin","html_url":"https://github.com/leoxiaobin","followers_url":"https://api.github.com/users/leoxiaobin/followers","following_url":"https://api.github.com/users/leoxiaobin/following{/other_user}","gists_url":"https://api.github.com/users/leoxiaobin/gists{/gist_id}","starred_url":"https://api.github.com/users/leoxiaobin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leoxiaobin/subscriptions","organizations_url":"https://api.github.com/users/leoxiaobin/orgs","repos_url":"https://api.github.com/users/leoxiaobin/repos","events_url":"https://api.github.com/users/leoxiaobin/events{/privacy}","received_events_url":"https://api.github.com/users/leoxiaobin/received_events","type":"User","site_admin":false}},{"id":1948628407,"node_id":"MDExOkNsb3NlZEV2ZW50MTk0ODYyODQwNw==","url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/events/1948628407","actor":{"login":"leoxiaobin","id":5362509,"node_id":"MDQ6VXNlcjUzNjI1MDk=","avatar_url":"https://avatars.githubusercontent.com/u/5362509?v=4","gravatar_id":"","url":"https://api.github.com/users/leoxiaobin","html_url":"https://github.com/leoxiaobin","followers_url":"https://api.github.com/users/leoxiaobin/followers","following_url":"https://api.github.com/users/leoxiaobin/following{/other_user}","gists_url":"https://api.github.com/users/leoxiaobin/gists{/gist_id}","starred_url":"https://api.github.com/users/leoxiaobin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leoxiaobin/subscriptions","organizations_url":"https://api.github.com/users/leoxiaobin/orgs","repos_url":"https://api.github.com/users/leoxiaobin/repos","events_url":"https://api.github.com/users/leoxiaobin/events{/privacy}","received_events_url":"https://api.github.com/users/leoxiaobin/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2018-11-06T10:59:42Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/527280051","html_url":"https://github.com/microsoft/human-pose-estimation.pytorch/issues/8#issuecomment-527280051","issue_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/8","id":527280051,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNzI4MDA1MQ==","user":{"login":"makslevental","id":5657668,"node_id":"MDQ6VXNlcjU2NTc2Njg=","avatar_url":"https://avatars.githubusercontent.com/u/5657668?v=4","gravatar_id":"","url":"https://api.github.com/users/makslevental","html_url":"https://github.com/makslevental","followers_url":"https://api.github.com/users/makslevental/followers","following_url":"https://api.github.com/users/makslevental/following{/other_user}","gists_url":"https://api.github.com/users/makslevental/gists{/gist_id}","starred_url":"https://api.github.com/users/makslevental/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/makslevental/subscriptions","organizations_url":"https://api.github.com/users/makslevental/orgs","repos_url":"https://api.github.com/users/makslevental/repos","events_url":"https://api.github.com/users/makslevental/events{/privacy}","received_events_url":"https://api.github.com/users/makslevental/received_events","type":"User","site_admin":false},"created_at":"2019-09-03T02:28:11Z","updated_at":"2019-09-03T02:28:11Z","author_association":"NONE","body":"@leoxiaobin you don't need a `sed`. you can monkey patch\r\n\r\n```python\r\ndef monkey_patch_bn():\r\n    # print(inspect.getsource(torch.nn.functional.batch_norm))\r\n    def batch_norm(input, running_mean, running_var, weight=None, bias=None,\r\n                   training=False, momentum=0.1, eps=1e-5):\r\n        if training:\r\n            size = input.size()\r\n            size_prods = size[0]\r\n            for i in range(len(size) - 2):\r\n                size_prods *= size[i + 2]\r\n            if size_prods == 1:\r\n                raise ValueError('Expected more than 1 value per channel when training, got input size {}'.format(size))\r\n\r\n        return torch.batch_norm(\r\n            input, weight, bias, running_mean, running_var,\r\n            training, momentum, eps, False\r\n        )\r\n    torch.nn.functional.batch_norm = batch_norm\r\n```","reactions":{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/527280051/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null,"event":"commented","actor":{"login":"makslevental","id":5657668,"node_id":"MDQ6VXNlcjU2NTc2Njg=","avatar_url":"https://avatars.githubusercontent.com/u/5657668?v=4","gravatar_id":"","url":"https://api.github.com/users/makslevental","html_url":"https://github.com/makslevental","followers_url":"https://api.github.com/users/makslevental/followers","following_url":"https://api.github.com/users/makslevental/following{/other_user}","gists_url":"https://api.github.com/users/makslevental/gists{/gist_id}","starred_url":"https://api.github.com/users/makslevental/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/makslevental/subscriptions","organizations_url":"https://api.github.com/users/makslevental/orgs","repos_url":"https://api.github.com/users/makslevental/repos","events_url":"https://api.github.com/users/makslevental/events{/privacy}","received_events_url":"https://api.github.com/users/makslevental/received_events","type":"User","site_admin":false}},{"id":2602074629,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjYwMjA3NDYyOQ==","url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/events/2602074629","actor":{"login":"leoxiaobin","id":5362509,"node_id":"MDQ6VXNlcjUzNjI1MDk=","avatar_url":"https://avatars.githubusercontent.com/u/5362509?v=4","gravatar_id":"","url":"https://api.github.com/users/leoxiaobin","html_url":"https://github.com/leoxiaobin","followers_url":"https://api.github.com/users/leoxiaobin/followers","following_url":"https://api.github.com/users/leoxiaobin/following{/other_user}","gists_url":"https://api.github.com/users/leoxiaobin/gists{/gist_id}","starred_url":"https://api.github.com/users/leoxiaobin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leoxiaobin/subscriptions","organizations_url":"https://api.github.com/users/leoxiaobin/orgs","repos_url":"https://api.github.com/users/leoxiaobin/repos","events_url":"https://api.github.com/users/leoxiaobin/events{/privacy}","received_events_url":"https://api.github.com/users/leoxiaobin/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-09-03T02:28:11Z","performed_via_github_app":null},{"id":2602074631,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI2MDIwNzQ2MzE=","url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/events/2602074631","actor":{"login":"leoxiaobin","id":5362509,"node_id":"MDQ6VXNlcjUzNjI1MDk=","avatar_url":"https://avatars.githubusercontent.com/u/5362509?v=4","gravatar_id":"","url":"https://api.github.com/users/leoxiaobin","html_url":"https://github.com/leoxiaobin","followers_url":"https://api.github.com/users/leoxiaobin/followers","following_url":"https://api.github.com/users/leoxiaobin/following{/other_user}","gists_url":"https://api.github.com/users/leoxiaobin/gists{/gist_id}","starred_url":"https://api.github.com/users/leoxiaobin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leoxiaobin/subscriptions","organizations_url":"https://api.github.com/users/leoxiaobin/orgs","repos_url":"https://api.github.com/users/leoxiaobin/repos","events_url":"https://api.github.com/users/leoxiaobin/events{/privacy}","received_events_url":"https://api.github.com/users/leoxiaobin/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-09-03T02:28:11Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/558459370","html_url":"https://github.com/microsoft/human-pose-estimation.pytorch/issues/8#issuecomment-558459370","issue_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/8","id":558459370,"node_id":"MDEyOklzc3VlQ29tbWVudDU1ODQ1OTM3MA==","user":{"login":"LordLiang","id":14073173,"node_id":"MDQ6VXNlcjE0MDczMTcz","avatar_url":"https://avatars.githubusercontent.com/u/14073173?v=4","gravatar_id":"","url":"https://api.github.com/users/LordLiang","html_url":"https://github.com/LordLiang","followers_url":"https://api.github.com/users/LordLiang/followers","following_url":"https://api.github.com/users/LordLiang/following{/other_user}","gists_url":"https://api.github.com/users/LordLiang/gists{/gist_id}","starred_url":"https://api.github.com/users/LordLiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LordLiang/subscriptions","organizations_url":"https://api.github.com/users/LordLiang/orgs","repos_url":"https://api.github.com/users/LordLiang/repos","events_url":"https://api.github.com/users/LordLiang/events{/privacy}","received_events_url":"https://api.github.com/users/LordLiang/received_events","type":"User","site_admin":false},"created_at":"2019-11-26T04:53:37Z","updated_at":"2019-11-26T04:53:37Z","author_association":"NONE","body":"> @leoxiaobin you don't need a `sed`. you can monkey patch\r\n> \r\n> ```python\r\n> def monkey_patch_bn():\r\n>     # print(inspect.getsource(torch.nn.functional.batch_norm))\r\n>     def batch_norm(input, running_mean, running_var, weight=None, bias=None,\r\n>                    training=False, momentum=0.1, eps=1e-5):\r\n>         if training:\r\n>             size = input.size()\r\n>             size_prods = size[0]\r\n>             for i in range(len(size) - 2):\r\n>                 size_prods *= size[i + 2]\r\n>             if size_prods == 1:\r\n>                 raise ValueError('Expected more than 1 value per channel when training, got input size {}'.format(size))\r\n> \r\n>         return torch.batch_norm(\r\n>             input, weight, bias, running_mean, running_var,\r\n>             training, momentum, eps, False\r\n>         )\r\n>     torch.nn.functional.batch_norm = batch_norm\r\n> ```\r\n\r\nHi, I want to know where I should add monkey_patch_bn? main.py? call it before training?","reactions":{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/558459370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"LordLiang","id":14073173,"node_id":"MDQ6VXNlcjE0MDczMTcz","avatar_url":"https://avatars.githubusercontent.com/u/14073173?v=4","gravatar_id":"","url":"https://api.github.com/users/LordLiang","html_url":"https://github.com/LordLiang","followers_url":"https://api.github.com/users/LordLiang/followers","following_url":"https://api.github.com/users/LordLiang/following{/other_user}","gists_url":"https://api.github.com/users/LordLiang/gists{/gist_id}","starred_url":"https://api.github.com/users/LordLiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LordLiang/subscriptions","organizations_url":"https://api.github.com/users/LordLiang/orgs","repos_url":"https://api.github.com/users/LordLiang/repos","events_url":"https://api.github.com/users/LordLiang/events{/privacy}","received_events_url":"https://api.github.com/users/LordLiang/received_events","type":"User","site_admin":false}},{"id":2830512903,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjgzMDUxMjkwMw==","url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/events/2830512903","actor":{"login":"leoxiaobin","id":5362509,"node_id":"MDQ6VXNlcjUzNjI1MDk=","avatar_url":"https://avatars.githubusercontent.com/u/5362509?v=4","gravatar_id":"","url":"https://api.github.com/users/leoxiaobin","html_url":"https://github.com/leoxiaobin","followers_url":"https://api.github.com/users/leoxiaobin/followers","following_url":"https://api.github.com/users/leoxiaobin/following{/other_user}","gists_url":"https://api.github.com/users/leoxiaobin/gists{/gist_id}","starred_url":"https://api.github.com/users/leoxiaobin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leoxiaobin/subscriptions","organizations_url":"https://api.github.com/users/leoxiaobin/orgs","repos_url":"https://api.github.com/users/leoxiaobin/repos","events_url":"https://api.github.com/users/leoxiaobin/events{/privacy}","received_events_url":"https://api.github.com/users/leoxiaobin/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-11-26T04:53:37Z","performed_via_github_app":null},{"id":2830512904,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI4MzA1MTI5MDQ=","url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/events/2830512904","actor":{"login":"leoxiaobin","id":5362509,"node_id":"MDQ6VXNlcjUzNjI1MDk=","avatar_url":"https://avatars.githubusercontent.com/u/5362509?v=4","gravatar_id":"","url":"https://api.github.com/users/leoxiaobin","html_url":"https://github.com/leoxiaobin","followers_url":"https://api.github.com/users/leoxiaobin/followers","following_url":"https://api.github.com/users/leoxiaobin/following{/other_user}","gists_url":"https://api.github.com/users/leoxiaobin/gists{/gist_id}","starred_url":"https://api.github.com/users/leoxiaobin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leoxiaobin/subscriptions","organizations_url":"https://api.github.com/users/leoxiaobin/orgs","repos_url":"https://api.github.com/users/leoxiaobin/repos","events_url":"https://api.github.com/users/leoxiaobin/events{/privacy}","received_events_url":"https://api.github.com/users/leoxiaobin/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-11-26T04:53:37Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/558673805","html_url":"https://github.com/microsoft/human-pose-estimation.pytorch/issues/8#issuecomment-558673805","issue_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/8","id":558673805,"node_id":"MDEyOklzc3VlQ29tbWVudDU1ODY3MzgwNQ==","user":{"login":"makslevental","id":5657668,"node_id":"MDQ6VXNlcjU2NTc2Njg=","avatar_url":"https://avatars.githubusercontent.com/u/5657668?v=4","gravatar_id":"","url":"https://api.github.com/users/makslevental","html_url":"https://github.com/makslevental","followers_url":"https://api.github.com/users/makslevental/followers","following_url":"https://api.github.com/users/makslevental/following{/other_user}","gists_url":"https://api.github.com/users/makslevental/gists{/gist_id}","starred_url":"https://api.github.com/users/makslevental/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/makslevental/subscriptions","organizations_url":"https://api.github.com/users/makslevental/orgs","repos_url":"https://api.github.com/users/makslevental/repos","events_url":"https://api.github.com/users/makslevental/events{/privacy}","received_events_url":"https://api.github.com/users/makslevental/received_events","type":"User","site_admin":false},"created_at":"2019-11-26T15:10:42Z","updated_at":"2019-11-26T15:10:42Z","author_association":"NONE","body":"@LordLiang i would call it right after importing `torch.nn`","reactions":{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/558673805/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"makslevental","id":5657668,"node_id":"MDQ6VXNlcjU2NTc2Njg=","avatar_url":"https://avatars.githubusercontent.com/u/5657668?v=4","gravatar_id":"","url":"https://api.github.com/users/makslevental","html_url":"https://github.com/makslevental","followers_url":"https://api.github.com/users/makslevental/followers","following_url":"https://api.github.com/users/makslevental/following{/other_user}","gists_url":"https://api.github.com/users/makslevental/gists{/gist_id}","starred_url":"https://api.github.com/users/makslevental/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/makslevental/subscriptions","organizations_url":"https://api.github.com/users/makslevental/orgs","repos_url":"https://api.github.com/users/makslevental/repos","events_url":"https://api.github.com/users/makslevental/events{/privacy}","received_events_url":"https://api.github.com/users/makslevental/received_events","type":"User","site_admin":false}},{"id":2832303415,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjgzMjMwMzQxNQ==","url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/events/2832303415","actor":{"login":"LordLiang","id":14073173,"node_id":"MDQ6VXNlcjE0MDczMTcz","avatar_url":"https://avatars.githubusercontent.com/u/14073173?v=4","gravatar_id":"","url":"https://api.github.com/users/LordLiang","html_url":"https://github.com/LordLiang","followers_url":"https://api.github.com/users/LordLiang/followers","following_url":"https://api.github.com/users/LordLiang/following{/other_user}","gists_url":"https://api.github.com/users/LordLiang/gists{/gist_id}","starred_url":"https://api.github.com/users/LordLiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LordLiang/subscriptions","organizations_url":"https://api.github.com/users/LordLiang/orgs","repos_url":"https://api.github.com/users/LordLiang/repos","events_url":"https://api.github.com/users/LordLiang/events{/privacy}","received_events_url":"https://api.github.com/users/LordLiang/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-11-26T15:10:42Z","performed_via_github_app":null},{"id":2832303429,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI4MzIzMDM0Mjk=","url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/events/2832303429","actor":{"login":"LordLiang","id":14073173,"node_id":"MDQ6VXNlcjE0MDczMTcz","avatar_url":"https://avatars.githubusercontent.com/u/14073173?v=4","gravatar_id":"","url":"https://api.github.com/users/LordLiang","html_url":"https://github.com/LordLiang","followers_url":"https://api.github.com/users/LordLiang/followers","following_url":"https://api.github.com/users/LordLiang/following{/other_user}","gists_url":"https://api.github.com/users/LordLiang/gists{/gist_id}","starred_url":"https://api.github.com/users/LordLiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LordLiang/subscriptions","organizations_url":"https://api.github.com/users/LordLiang/orgs","repos_url":"https://api.github.com/users/LordLiang/repos","events_url":"https://api.github.com/users/LordLiang/events{/privacy}","received_events_url":"https://api.github.com/users/LordLiang/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-11-26T15:10:42Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/584160378","html_url":"https://github.com/microsoft/human-pose-estimation.pytorch/issues/8#issuecomment-584160378","issue_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/8","id":584160378,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDE2MDM3OA==","user":{"login":"mgarbade","id":3956593,"node_id":"MDQ6VXNlcjM5NTY1OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3956593?v=4","gravatar_id":"","url":"https://api.github.com/users/mgarbade","html_url":"https://github.com/mgarbade","followers_url":"https://api.github.com/users/mgarbade/followers","following_url":"https://api.github.com/users/mgarbade/following{/other_user}","gists_url":"https://api.github.com/users/mgarbade/gists{/gist_id}","starred_url":"https://api.github.com/users/mgarbade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgarbade/subscriptions","organizations_url":"https://api.github.com/users/mgarbade/orgs","repos_url":"https://api.github.com/users/mgarbade/repos","events_url":"https://api.github.com/users/mgarbade/events{/privacy}","received_events_url":"https://api.github.com/users/mgarbade/received_events","type":"User","site_admin":false},"created_at":"2020-02-10T14:53:16Z","updated_at":"2020-02-10T14:53:16Z","author_association":"NONE","body":"is this still relevant in higher versions of pytorch? (eg version 1.4)","reactions":{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/584160378/reactions","total_count":10,"+1":10,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mgarbade","id":3956593,"node_id":"MDQ6VXNlcjM5NTY1OTM=","avatar_url":"https://avatars.githubusercontent.com/u/3956593?v=4","gravatar_id":"","url":"https://api.github.com/users/mgarbade","html_url":"https://github.com/mgarbade","followers_url":"https://api.github.com/users/mgarbade/followers","following_url":"https://api.github.com/users/mgarbade/following{/other_user}","gists_url":"https://api.github.com/users/mgarbade/gists{/gist_id}","starred_url":"https://api.github.com/users/mgarbade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgarbade/subscriptions","organizations_url":"https://api.github.com/users/mgarbade/orgs","repos_url":"https://api.github.com/users/mgarbade/repos","events_url":"https://api.github.com/users/mgarbade/events{/privacy}","received_events_url":"https://api.github.com/users/mgarbade/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/626932671","html_url":"https://github.com/microsoft/human-pose-estimation.pytorch/issues/8#issuecomment-626932671","issue_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/8","id":626932671,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNjkzMjY3MQ==","user":{"login":"soulslicer","id":3193196,"node_id":"MDQ6VXNlcjMxOTMxOTY=","avatar_url":"https://avatars.githubusercontent.com/u/3193196?v=4","gravatar_id":"","url":"https://api.github.com/users/soulslicer","html_url":"https://github.com/soulslicer","followers_url":"https://api.github.com/users/soulslicer/followers","following_url":"https://api.github.com/users/soulslicer/following{/other_user}","gists_url":"https://api.github.com/users/soulslicer/gists{/gist_id}","starred_url":"https://api.github.com/users/soulslicer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/soulslicer/subscriptions","organizations_url":"https://api.github.com/users/soulslicer/orgs","repos_url":"https://api.github.com/users/soulslicer/repos","events_url":"https://api.github.com/users/soulslicer/events{/privacy}","received_events_url":"https://api.github.com/users/soulslicer/received_events","type":"User","site_admin":false},"created_at":"2020-05-11T20:11:31Z","updated_at":"2020-05-11T20:11:31Z","author_association":"NONE","body":"> > @leoxiaobin you don't need a `sed`. you can monkey patch\r\n> > ```python\r\n> > def monkey_patch_bn():\r\n> >     # print(inspect.getsource(torch.nn.functional.batch_norm))\r\n> >     def batch_norm(input, running_mean, running_var, weight=None, bias=None,\r\n> >                    training=False, momentum=0.1, eps=1e-5):\r\n> >         if training:\r\n> >             size = input.size()\r\n> >             size_prods = size[0]\r\n> >             for i in range(len(size) - 2):\r\n> >                 size_prods *= size[i + 2]\r\n> >             if size_prods == 1:\r\n> >                 raise ValueError('Expected more than 1 value per channel when training, got input size {}'.format(size))\r\n> > \r\n> >         return torch.batch_norm(\r\n> >             input, weight, bias, running_mean, running_var,\r\n> >             training, momentum, eps, False\r\n> >         )\r\n> >     torch.nn.functional.batch_norm = batch_norm\r\n> > ```\r\n> \r\n> Hi, I want to know where I should add monkey_patch_bn? main.py? call it before training?\r\n\r\nHow do I do this, if I am using nn.Sequential?\r\n\r\n```\r\ndef convbn(in_planes, out_planes, kernel_size, stride, pad, dilation, bn_running_avg=False):\r\n    return nn.Sequential(nn.Conv2d(in_planes, out_planes,\r\n                                   kernel_size=kernel_size, stride=stride,\r\n                                   padding=dilation if dilation > 1 else pad,\r\n                                   dilation=dilation, bias=False),\r\n                         nn.BatchNorm2d(out_planes,\r\n                                        track_running_stats=bn_running_avg))\r\n```","reactions":{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/comments/626932671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"soulslicer","id":3193196,"node_id":"MDQ6VXNlcjMxOTMxOTY=","avatar_url":"https://avatars.githubusercontent.com/u/3193196?v=4","gravatar_id":"","url":"https://api.github.com/users/soulslicer","html_url":"https://github.com/soulslicer","followers_url":"https://api.github.com/users/soulslicer/followers","following_url":"https://api.github.com/users/soulslicer/following{/other_user}","gists_url":"https://api.github.com/users/soulslicer/gists{/gist_id}","starred_url":"https://api.github.com/users/soulslicer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/soulslicer/subscriptions","organizations_url":"https://api.github.com/users/soulslicer/orgs","repos_url":"https://api.github.com/users/soulslicer/repos","events_url":"https://api.github.com/users/soulslicer/events{/privacy}","received_events_url":"https://api.github.com/users/soulslicer/received_events","type":"User","site_admin":false}},{"id":3324590060,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzMyNDU5MDA2MA==","url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/events/3324590060","actor":{"login":"leoxiaobin","id":5362509,"node_id":"MDQ6VXNlcjUzNjI1MDk=","avatar_url":"https://avatars.githubusercontent.com/u/5362509?v=4","gravatar_id":"","url":"https://api.github.com/users/leoxiaobin","html_url":"https://github.com/leoxiaobin","followers_url":"https://api.github.com/users/leoxiaobin/followers","following_url":"https://api.github.com/users/leoxiaobin/following{/other_user}","gists_url":"https://api.github.com/users/leoxiaobin/gists{/gist_id}","starred_url":"https://api.github.com/users/leoxiaobin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leoxiaobin/subscriptions","organizations_url":"https://api.github.com/users/leoxiaobin/orgs","repos_url":"https://api.github.com/users/leoxiaobin/repos","events_url":"https://api.github.com/users/leoxiaobin/events{/privacy}","received_events_url":"https://api.github.com/users/leoxiaobin/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-05-11T20:11:31Z","performed_via_github_app":null},{"id":3324590066,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMzMjQ1OTAwNjY=","url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/events/3324590066","actor":{"login":"leoxiaobin","id":5362509,"node_id":"MDQ6VXNlcjUzNjI1MDk=","avatar_url":"https://avatars.githubusercontent.com/u/5362509?v=4","gravatar_id":"","url":"https://api.github.com/users/leoxiaobin","html_url":"https://github.com/leoxiaobin","followers_url":"https://api.github.com/users/leoxiaobin/followers","following_url":"https://api.github.com/users/leoxiaobin/following{/other_user}","gists_url":"https://api.github.com/users/leoxiaobin/gists{/gist_id}","starred_url":"https://api.github.com/users/leoxiaobin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leoxiaobin/subscriptions","organizations_url":"https://api.github.com/users/leoxiaobin/orgs","repos_url":"https://api.github.com/users/leoxiaobin/repos","events_url":"https://api.github.com/users/leoxiaobin/events{/privacy}","received_events_url":"https://api.github.com/users/leoxiaobin/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-05-11T20:11:31Z","performed_via_github_app":null}]