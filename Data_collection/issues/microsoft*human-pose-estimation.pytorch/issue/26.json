{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/26","repository_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch","labels_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/26/labels{/name}","comments_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/26/comments","events_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/26/events","html_url":"https://github.com/microsoft/human-pose-estimation.pytorch/issues/26","id":360601712,"node_id":"MDU6SXNzdWUzNjA2MDE3MTI=","number":26,"title":"How to predict my own image?","user":{"login":"zyoohv","id":16134679,"node_id":"MDQ6VXNlcjE2MTM0Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16134679?v=4","gravatar_id":"","url":"https://api.github.com/users/zyoohv","html_url":"https://github.com/zyoohv","followers_url":"https://api.github.com/users/zyoohv/followers","following_url":"https://api.github.com/users/zyoohv/following{/other_user}","gists_url":"https://api.github.com/users/zyoohv/gists{/gist_id}","starred_url":"https://api.github.com/users/zyoohv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyoohv/subscriptions","organizations_url":"https://api.github.com/users/zyoohv/orgs","repos_url":"https://api.github.com/users/zyoohv/repos","events_url":"https://api.github.com/users/zyoohv/events{/privacy}","received_events_url":"https://api.github.com/users/zyoohv/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":32,"created_at":"2018-09-16T04:31:24Z","updated_at":"2022-08-16T01:45:26Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I read your code carefully, and implement with following code.\r\nBut I still get the wrong result.\r\nCould you help me?\r\n\r\n\r\n\r\n```python\r\n# config\r\nfrom lib.models.pose_resnet import get_pose_net\r\nfrom lib.core.config import config\r\nfrom lib.core.config import update_config\r\nconfig.TEST.FLIP_TEST = True\r\nconfig.TEST.MODEL_FILE = 'pose_resnet_50_256x256.pth.tar'\r\nupdate_config('experiments/mpii/resnet50/256x256_d256x3_adam_lr1e-3.yaml')\r\nmodel = get_pose_net(config, is_train=False)\r\n\r\nimport torch\r\nimport torchvision.transforms as transforms\r\nmean = [0.485, 0.456, 0.406]\r\nstd = [0.229, 0.224, 0.225]\r\ntoTensor = transforms.Compose([transforms.ToTensor(), \r\n                               transforms.Normalize(mean, std)])\r\n\r\ndef getpoint(mat):\r\n    height, width = mat.shape\r\n    mat = mat.reshape(-1)\r\n    idx = np.argmax(mat)\r\n    return idx % width, idx // width\r\n```\r\n\r\n\r\n```python\r\n# load image and predict\r\nimport cv2\r\nimport numpy as np\r\nimg = cv2.imread('0.png', cv2.IMREAD_COLOR | cv2.IMREAD_IGNORE_ORIENTATION)\r\nimg = cv2.resize(img, (256, 256))\r\nx = toTensor(img).unsqueeze(0)\r\nwith torch.no_grad():\r\n    res = model.forward(x)\r\nres = np.array(res.detach().squeeze())\r\nprint(img.shape)\r\nprint(res.shape)\r\n```\r\n\r\n    (256, 256, 3)\r\n    (16, 64, 64)\r\n\r\n\r\n\r\n```python\r\n# plot\r\nimage = cv2.resize(img, (64, 64))\r\nprint(image.shape)\r\nfor mat in res:\r\n    x, y = getpoint(mat)\r\n    print(x, y)\r\n    cv2.circle(image, (x, y), 2, (255, 0, 0), 2)\r\nimport matplotlib.pyplot as plt\r\nplt.imshow(image)\r\n```\r\n\r\n    (64, 64, 3)\r\n    10 46\r\n    8 37\r\n    27 29\r\n    13 37\r\n    33 7\r\n    30 7\r\n    25 18\r\n    17 31\r\n    31 22\r\n    29 21\r\n    15 32\r\n    12 51\r\n    23 15\r\n    36 18\r\n    13 40\r\n    12 41\r\n    <matplotlib.image.AxesImage at 0x7f14625c1160>\r\n![output_2_2](https://user-images.githubusercontent.com/16134679/45592898-61230a80-b9ac-11e8-86d9-555329aecf35.png)\r\n\r\n\r\n[LoadNet.pdf](https://github.com/Microsoft/human-pose-estimation.pytorch/files/2386300/LoadNet.pdf)\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/26/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/26/timeline","performed_via_github_app":null,"state_reason":null}