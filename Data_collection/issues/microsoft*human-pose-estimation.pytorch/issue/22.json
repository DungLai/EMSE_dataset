{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/22","repository_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch","labels_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/22/labels{/name}","comments_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/22/comments","events_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/22/events","html_url":"https://github.com/microsoft/human-pose-estimation.pytorch/issues/22","id":359732355,"node_id":"MDU6SXNzdWUzNTk3MzIzNTU=","number":22,"title":"Error Result when predicting my own image.","user":{"login":"zyoohv","id":16134679,"node_id":"MDQ6VXNlcjE2MTM0Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16134679?v=4","gravatar_id":"","url":"https://api.github.com/users/zyoohv","html_url":"https://github.com/zyoohv","followers_url":"https://api.github.com/users/zyoohv/followers","following_url":"https://api.github.com/users/zyoohv/following{/other_user}","gists_url":"https://api.github.com/users/zyoohv/gists{/gist_id}","starred_url":"https://api.github.com/users/zyoohv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyoohv/subscriptions","organizations_url":"https://api.github.com/users/zyoohv/orgs","repos_url":"https://api.github.com/users/zyoohv/repos","events_url":"https://api.github.com/users/zyoohv/events{/privacy}","received_events_url":"https://api.github.com/users/zyoohv/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-09-13T03:48:39Z","updated_at":"2018-09-19T09:44:32Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"This is my code about using your model to predict pose of my image.\r\nIs there any wrong with it ?\r\nCan you provide me a right one ?\r\n\r\n```python\r\nfrom lib.models.pose_resnet import get_pose_net\r\nfrom lib.core.config import config\r\nfrom lib.core.config import update_config\r\nconfig.TEST.FLIP_TEST = True\r\nconfig.TEST.MODEL_FILE = 'pose_resnet_50_256x256.pth.tar'\r\nupdate_config('experiments/mpii/resnet50/256x256_d256x3_adam_lr1e-3.yaml')\r\nmodel = get_pose_net(config, is_train=False)\r\n```\r\n\r\n\r\n```python\r\nimport torch\r\nimport cv2\r\nimport numpy as np\r\nimg = cv2.imread('0.png')\r\nimg = cv2.resize(img, (256, 256))\r\nimg = np.transpose(img, (2, 0, 1)).astype(np.float32)\r\nimg = (img / 255 - 0.5) * 2\r\nimg = torch.tensor(img).unsqueeze(0)\r\nwith torch.no_grad():\r\n    res = model.forward(img)\r\nprint(img.shape)\r\nprint(res.shape)\r\n```\r\n\r\n    torch.Size([1, 3, 256, 256])\r\n    torch.Size([1, 16, 64, 64])\r\n\r\n\r\n\r\n```python\r\ndef getpoint(mat):\r\n    height, width = mat.shape\r\n    mat = mat.reshape(-1)\r\n    idx = np.argmax(mat)\r\n    return idx // height, idx % width\r\n```\r\n\r\n\r\n```python\r\nraw = ((np.array(img.squeeze()) / 2 + 0.5) * 255).astype(np.uint8)\r\nraw = cv2.resize(np.transpose(raw, (1, 2, 0)), (64, 64))\r\npoi = np.array(res.detach().squeeze())\r\nprint(raw.shape)\r\nprint(poi.shape)\r\n```\r\n\r\n    (64, 64, 3)\r\n    (16, 64, 64)\r\n\r\n\r\n\r\n```python\r\nimage = raw\r\nfor mat in poi:\r\n    x, y = getpoint(mat)\r\n    print(x, y)\r\n    cv2.circle(image, (x, y), 1, (255, 0, 0))\r\nimport matplotlib.pyplot as plt\r\nplt.imshow(image)\r\n```\r\n\r\n    19 30\r\n    12 37\r\n    22 28\r\n    13 37\r\n    18 30\r\n    13 36\r\n    7 32\r\n    8 31\r\n    18 28\r\n    8 34\r\n    12 36\r\n    7 22\r\n    12 38\r\n    11 40\r\n    18 27\r\n    15 30\r\n\r\n\r\n\r\n\r\n\r\n    <matplotlib.image.AxesImage at 0x7fa42088ab00>\r\n\r\n\r\n\r\n![output_4_2](https://user-images.githubusercontent.com/16134679/45466089-b06a0080-b74a-11e8-9ae0-c210c9f13d7a.png)\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/22/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/microsoft/human-pose-estimation.pytorch/issues/22/timeline","performed_via_github_app":null,"state_reason":null}