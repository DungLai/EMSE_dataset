[{"url":"https://api.github.com/repos/BloodAxe/pytorch-toolbelt/issues/comments/1122483429","html_url":"https://github.com/BloodAxe/pytorch-toolbelt/issues/71#issuecomment-1122483429","issue_url":"https://api.github.com/repos/BloodAxe/pytorch-toolbelt/issues/71","id":1122483429,"node_id":"IC_kwDOCntH-85C57zl","user":{"login":"BloodAxe","id":532320,"node_id":"MDQ6VXNlcjUzMjMyMA==","avatar_url":"https://avatars.githubusercontent.com/u/532320?v=4","gravatar_id":"","url":"https://api.github.com/users/BloodAxe","html_url":"https://github.com/BloodAxe","followers_url":"https://api.github.com/users/BloodAxe/followers","following_url":"https://api.github.com/users/BloodAxe/following{/other_user}","gists_url":"https://api.github.com/users/BloodAxe/gists{/gist_id}","starred_url":"https://api.github.com/users/BloodAxe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BloodAxe/subscriptions","organizations_url":"https://api.github.com/users/BloodAxe/orgs","repos_url":"https://api.github.com/users/BloodAxe/repos","events_url":"https://api.github.com/users/BloodAxe/events{/privacy}","received_events_url":"https://api.github.com/users/BloodAxe/received_events","type":"User","site_admin":false},"created_at":"2022-05-10T14:36:53Z","updated_at":"2022-05-10T14:36:53Z","author_association":"OWNER","body":"There is no strict dependency on `opencv-python`, it would work perfectly with `opencv-python-headless` and even with `opencv-contrib-python[-headless]`. \r\nUnfortunately picking a correct opencv distro even programmatically inside `setup.py` is tricky since other libraries may install other versions of opencv. (Seen this many times while maintaining albumentations package). \r\n\r\nSo as temporary solution you may install toolbelt w/o deps (`pip install --no-deps pytorch-toolbelt==0.5`).\r\nAnd if know how to do setup-time checks whether any of OpenCV variants is already installed - contributions are welcome!","reactions":{"url":"https://api.github.com/repos/BloodAxe/pytorch-toolbelt/issues/comments/1122483429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"BloodAxe","id":532320,"node_id":"MDQ6VXNlcjUzMjMyMA==","avatar_url":"https://avatars.githubusercontent.com/u/532320?v=4","gravatar_id":"","url":"https://api.github.com/users/BloodAxe","html_url":"https://github.com/BloodAxe","followers_url":"https://api.github.com/users/BloodAxe/followers","following_url":"https://api.github.com/users/BloodAxe/following{/other_user}","gists_url":"https://api.github.com/users/BloodAxe/gists{/gist_id}","starred_url":"https://api.github.com/users/BloodAxe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BloodAxe/subscriptions","organizations_url":"https://api.github.com/users/BloodAxe/orgs","repos_url":"https://api.github.com/users/BloodAxe/repos","events_url":"https://api.github.com/users/BloodAxe/events{/privacy}","received_events_url":"https://api.github.com/users/BloodAxe/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/BloodAxe/pytorch-toolbelt/issues/comments/1122692666","html_url":"https://github.com/BloodAxe/pytorch-toolbelt/issues/71#issuecomment-1122692666","issue_url":"https://api.github.com/repos/BloodAxe/pytorch-toolbelt/issues/71","id":1122692666,"node_id":"IC_kwDOCntH-85C6u46","user":{"login":"MikiGrit","id":1949300,"node_id":"MDQ6VXNlcjE5NDkzMDA=","avatar_url":"https://avatars.githubusercontent.com/u/1949300?v=4","gravatar_id":"","url":"https://api.github.com/users/MikiGrit","html_url":"https://github.com/MikiGrit","followers_url":"https://api.github.com/users/MikiGrit/followers","following_url":"https://api.github.com/users/MikiGrit/following{/other_user}","gists_url":"https://api.github.com/users/MikiGrit/gists{/gist_id}","starred_url":"https://api.github.com/users/MikiGrit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikiGrit/subscriptions","organizations_url":"https://api.github.com/users/MikiGrit/orgs","repos_url":"https://api.github.com/users/MikiGrit/repos","events_url":"https://api.github.com/users/MikiGrit/events{/privacy}","received_events_url":"https://api.github.com/users/MikiGrit/received_events","type":"User","site_admin":false},"created_at":"2022-05-10T17:46:59Z","updated_at":"2022-05-10T18:36:13Z","author_association":"NONE","body":"Thanks for the fast reply and the suggestion. Would something like this be sufficient?\r\n\r\n```python\r\ndef missing_opencv_requirements():\r\n    \"\"\"\r\n    Since opencv library is distributed in several independent packages, we first check whether some of them is already installed and if not, the opencv-python-headless version will be in included.\r\n    \"\"\"\r\n    try:\r\n        import cv2\r\n        return []\r\n    except ImportError:\r\n        return [\"opencv-python-headless>=4.1\"]\r\n```\r\n\r\n```python\r\nDEPENDENCIES = [\r\n    # We rely on particular activation functions that were added in 1.8.1\r\n    \"torch>=1.8.1\",\r\n    # We use some pretrained models from torchvision\r\n    \"torchvision>=0.9.1\",\r\n    # Library uses scipy for linear_sum_assignment for match_bboxes.\r\n    # 1.4.0 is the first release where `maximize` argument gets introduced to this function\r\n    \"scipy>=1.4.0\",\r\n] + missing_opencv_requirements()\r\n```","reactions":{"url":"https://api.github.com/repos/BloodAxe/pytorch-toolbelt/issues/comments/1122692666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MikiGrit","id":1949300,"node_id":"MDQ6VXNlcjE5NDkzMDA=","avatar_url":"https://avatars.githubusercontent.com/u/1949300?v=4","gravatar_id":"","url":"https://api.github.com/users/MikiGrit","html_url":"https://github.com/MikiGrit","followers_url":"https://api.github.com/users/MikiGrit/followers","following_url":"https://api.github.com/users/MikiGrit/following{/other_user}","gists_url":"https://api.github.com/users/MikiGrit/gists{/gist_id}","starred_url":"https://api.github.com/users/MikiGrit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikiGrit/subscriptions","organizations_url":"https://api.github.com/users/MikiGrit/orgs","repos_url":"https://api.github.com/users/MikiGrit/repos","events_url":"https://api.github.com/users/MikiGrit/events{/privacy}","received_events_url":"https://api.github.com/users/MikiGrit/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/BloodAxe/pytorch-toolbelt/issues/comments/1122836143","html_url":"https://github.com/BloodAxe/pytorch-toolbelt/issues/71#issuecomment-1122836143","issue_url":"https://api.github.com/repos/BloodAxe/pytorch-toolbelt/issues/71","id":1122836143,"node_id":"IC_kwDOCntH-85C7R6v","user":{"login":"BloodAxe","id":532320,"node_id":"MDQ6VXNlcjUzMjMyMA==","avatar_url":"https://avatars.githubusercontent.com/u/532320?v=4","gravatar_id":"","url":"https://api.github.com/users/BloodAxe","html_url":"https://github.com/BloodAxe","followers_url":"https://api.github.com/users/BloodAxe/followers","following_url":"https://api.github.com/users/BloodAxe/following{/other_user}","gists_url":"https://api.github.com/users/BloodAxe/gists{/gist_id}","starred_url":"https://api.github.com/users/BloodAxe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BloodAxe/subscriptions","organizations_url":"https://api.github.com/users/BloodAxe/orgs","repos_url":"https://api.github.com/users/BloodAxe/repos","events_url":"https://api.github.com/users/BloodAxe/events{/privacy}","received_events_url":"https://api.github.com/users/BloodAxe/received_events","type":"User","site_admin":false},"created_at":"2022-05-10T20:36:15Z","updated_at":"2022-05-10T20:36:15Z","author_association":"OWNER","body":"Could you please try this branch to see whether it works on your env: https://github.com/BloodAxe/pytorch-toolbelt/tree/feature/loose-opencv-install","reactions":{"url":"https://api.github.com/repos/BloodAxe/pytorch-toolbelt/issues/comments/1122836143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"BloodAxe","id":532320,"node_id":"MDQ6VXNlcjUzMjMyMA==","avatar_url":"https://avatars.githubusercontent.com/u/532320?v=4","gravatar_id":"","url":"https://api.github.com/users/BloodAxe","html_url":"https://github.com/BloodAxe","followers_url":"https://api.github.com/users/BloodAxe/followers","following_url":"https://api.github.com/users/BloodAxe/following{/other_user}","gists_url":"https://api.github.com/users/BloodAxe/gists{/gist_id}","starred_url":"https://api.github.com/users/BloodAxe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BloodAxe/subscriptions","organizations_url":"https://api.github.com/users/BloodAxe/orgs","repos_url":"https://api.github.com/users/BloodAxe/repos","events_url":"https://api.github.com/users/BloodAxe/events{/privacy}","received_events_url":"https://api.github.com/users/BloodAxe/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/BloodAxe/pytorch-toolbelt/issues/comments/1123290843","html_url":"https://github.com/BloodAxe/pytorch-toolbelt/issues/71#issuecomment-1123290843","issue_url":"https://api.github.com/repos/BloodAxe/pytorch-toolbelt/issues/71","id":1123290843,"node_id":"IC_kwDOCntH-85C9A7b","user":{"login":"MikiGrit","id":1949300,"node_id":"MDQ6VXNlcjE5NDkzMDA=","avatar_url":"https://avatars.githubusercontent.com/u/1949300?v=4","gravatar_id":"","url":"https://api.github.com/users/MikiGrit","html_url":"https://github.com/MikiGrit","followers_url":"https://api.github.com/users/MikiGrit/followers","following_url":"https://api.github.com/users/MikiGrit/following{/other_user}","gists_url":"https://api.github.com/users/MikiGrit/gists{/gist_id}","starred_url":"https://api.github.com/users/MikiGrit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikiGrit/subscriptions","organizations_url":"https://api.github.com/users/MikiGrit/orgs","repos_url":"https://api.github.com/users/MikiGrit/repos","events_url":"https://api.github.com/users/MikiGrit/events{/privacy}","received_events_url":"https://api.github.com/users/MikiGrit/received_events","type":"User","site_admin":false},"created_at":"2022-05-11T07:33:37Z","updated_at":"2022-05-11T07:33:37Z","author_association":"NONE","body":"I've tested it and it sadly does not work for us. We are using poetry as a dependency manager and it unfortunately creates dependecy on `opencv-python` regardless `[-headless]` version is installed or not.\r\n\r\nAnd the changes in `setup.py` are not used since poetry creates list of packages to be installed (in `poetry.lock` file) globally on developer machine.\r\n\r\nWe will have to solve it some other way, but thanks for you effort anyway 👍 .","reactions":{"url":"https://api.github.com/repos/BloodAxe/pytorch-toolbelt/issues/comments/1123290843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MikiGrit","id":1949300,"node_id":"MDQ6VXNlcjE5NDkzMDA=","avatar_url":"https://avatars.githubusercontent.com/u/1949300?v=4","gravatar_id":"","url":"https://api.github.com/users/MikiGrit","html_url":"https://github.com/MikiGrit","followers_url":"https://api.github.com/users/MikiGrit/followers","following_url":"https://api.github.com/users/MikiGrit/following{/other_user}","gists_url":"https://api.github.com/users/MikiGrit/gists{/gist_id}","starred_url":"https://api.github.com/users/MikiGrit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikiGrit/subscriptions","organizations_url":"https://api.github.com/users/MikiGrit/orgs","repos_url":"https://api.github.com/users/MikiGrit/repos","events_url":"https://api.github.com/users/MikiGrit/events{/privacy}","received_events_url":"https://api.github.com/users/MikiGrit/received_events","type":"User","site_admin":false}},{"id":6597016135,"node_id":"CE_lADOCntH-85JY20ozwAAAAGJNnpH","url":"https://api.github.com/repos/BloodAxe/pytorch-toolbelt/issues/events/6597016135","actor":{"login":"MikiGrit","id":1949300,"node_id":"MDQ6VXNlcjE5NDkzMDA=","avatar_url":"https://avatars.githubusercontent.com/u/1949300?v=4","gravatar_id":"","url":"https://api.github.com/users/MikiGrit","html_url":"https://github.com/MikiGrit","followers_url":"https://api.github.com/users/MikiGrit/followers","following_url":"https://api.github.com/users/MikiGrit/following{/other_user}","gists_url":"https://api.github.com/users/MikiGrit/gists{/gist_id}","starred_url":"https://api.github.com/users/MikiGrit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikiGrit/subscriptions","organizations_url":"https://api.github.com/users/MikiGrit/orgs","repos_url":"https://api.github.com/users/MikiGrit/repos","events_url":"https://api.github.com/users/MikiGrit/events{/privacy}","received_events_url":"https://api.github.com/users/MikiGrit/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-05-12T10:16:59Z","state_reason":null,"performed_via_github_app":null}]