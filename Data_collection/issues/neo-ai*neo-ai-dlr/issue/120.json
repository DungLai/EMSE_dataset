{"url":"https://api.github.com/repos/neo-ai/neo-ai-dlr/issues/120","repository_url":"https://api.github.com/repos/neo-ai/neo-ai-dlr","labels_url":"https://api.github.com/repos/neo-ai/neo-ai-dlr/issues/120/labels{/name}","comments_url":"https://api.github.com/repos/neo-ai/neo-ai-dlr/issues/120/comments","events_url":"https://api.github.com/repos/neo-ai/neo-ai-dlr/issues/120/events","html_url":"https://github.com/neo-ai/neo-ai-dlr/issues/120","id":544086356,"node_id":"MDU6SXNzdWU1NDQwODYzNTY=","number":120,"title":"CreateDLRModel failed for cuda model","user":{"login":"apivovarov","id":218087,"node_id":"MDQ6VXNlcjIxODA4Nw==","avatar_url":"https://avatars.githubusercontent.com/u/218087?v=4","gravatar_id":"","url":"https://api.github.com/users/apivovarov","html_url":"https://github.com/apivovarov","followers_url":"https://api.github.com/users/apivovarov/followers","following_url":"https://api.github.com/users/apivovarov/following{/other_user}","gists_url":"https://api.github.com/users/apivovarov/gists{/gist_id}","starred_url":"https://api.github.com/users/apivovarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apivovarov/subscriptions","organizations_url":"https://api.github.com/users/apivovarov/orgs","repos_url":"https://api.github.com/users/apivovarov/repos","events_url":"https://api.github.com/users/apivovarov/events{/privacy}","received_events_url":"https://api.github.com/users/apivovarov/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-12-31T04:41:01Z","updated_at":"2019-12-31T18:44:18Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"I used the latest TVM to compile my model for x86_64 and for cuda_x86_64 targets (Cuda 10.2 sm_70).\r\n\r\nAfter that I tried to use `model_peeker` to check the model folders\r\nmodel_peeker works fine for `x86_64` folder but fails for `cuda_x86_64`\r\n\r\nError - `Loader of _lib(module.loadbinary__lib) is not presented` :\r\n\r\n```\r\n[04:38:07] /home/ubuntu/neo-ai-dlr/demo/cpp/model_peeker.cc:92: TVMError: Check failed: f != nullptr: Loader of _lib(module.loadbinary__lib) is not presented.\r\nStack trace:\r\n  File \"/home/ubuntu/neo-ai-dlr/3rdparty/tvm/src/runtime/library_module.cc\", line 131\r\n  [bt] (0) ./model_peeker(+0xaf5e4) [0x56423d40e5e4]\r\n  [bt] (1) ./model_peeker(+0xb0d48) [0x56423d40fd48]\r\n  [bt] (2) ./model_peeker(+0x3442e) [0x56423d39342e]\r\n  [bt] (3) ./model_peeker(+0xb5b4a) [0x56423d414b4a]\r\n  [bt] (4) ./model_peeker(+0x2fefd) [0x56423d38eefd]\r\n  [bt] (5) ./model_peeker(+0x16a8e) [0x56423d375a8e]\r\n  [bt] (6) ./model_peeker(+0xbebd) [0x56423d36aebd]\r\n  [bt] (7) /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xe7) [0x7ff9b58fcb97]\r\n  [bt] (8) ./model_peeker(+0xd97a) [0x56423d36c97a]\r\n\r\n\r\nterminate called after throwing an instance of 'std::runtime_error'\r\n  what():  Could not load DLR Model\r\nAborted (core dumped)\r\n```\r\n\r\nThe same error I got when I tried to call `CreateDLRModel` directly\r\n```\r\n  int device_type = 2;\r\n  std::string input_name = \"input\";\r\n  std::string  model_dir = \"./mobilenet_v1_1.0_224/cuda_102_sm_70_x86_64\";\r\n  std::cout << \"Loading model... \" << std::endl;\r\n  DLRModelHandle model;\r\n  if (CreateDLRModel(&model, model_dir.c_str(), device_type, 0) != 0) {\r\n    std::clog << DLRGetLastError() << std::endl;\r\n    throw std::runtime_error(\"Could not load DLR Model\");\r\n  }\r\n```\r\nError:\r\n```\r\nLoading model... \r\nTVMError: Check failed: f != nullptr: Loader of _lib(module.loadbinary__lib) is not presented.\r\nStack trace:\r\n  File \"/home/ubuntu/neo-ai-dlr/3rdparty/tvm/src/runtime/library_module.cc\", line 131\r\n  [bt] (0) ./libdlr.so(tvm::runtime::ImportModuleBlob(char const*, std::vector<tvm::runtime::Module, std::allocator<tvm::runtime::Module> >*)+0x21f4) [0x7f331285fb34]\r\n  [bt] (1) ./libdlr.so(tvm::runtime::CreateModuleFromLibrary(tvm::runtime::ObjectPtr<tvm::runtime::Library>)+0x198) [0x7f3312861298]\r\n  [bt] (2) ./libdlr.so(+0x5b6ae) [0x7f33127e46ae]\r\n  [bt] (3) ./libdlr.so(tvm::runtime::Module::LoadFromFile(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)+0x52a) [0x7f331286609a]\r\n  [bt] (4) ./libdlr.so(dlr::TVMModel::SetupTVMModule(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >)+0x1e3d) [0x7f33127e017d]\r\n  [bt] (5) ./libdlr.so(CreateDLRModel+0x1dee) [0x7f33127c527e]\r\n  [bt] (6) ./run-style-trans-dlr(+0xef6) [0x560aa80e9ef6]\r\n  [bt] (7) /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xe7) [0x7f3311e18b97]\r\n  [bt] (8) ./run-style-trans-dlr(+0x104a) [0x560aa80ea04a]\r\n\r\nterminate called after throwing an instance of 'std::runtime_error'\r\n  what():  Could not load DLR Model\r\nAborted (core dumped)\r\n```\r\n\r\nCompiled models for `x86_64` and `cuda` can be downloaded from [here](https://dlc-models.s3.us-east-2.amazonaws.com/mobilenet_v1_1.0_224.tgz)","closed_by":null,"reactions":{"url":"https://api.github.com/repos/neo-ai/neo-ai-dlr/issues/120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/neo-ai/neo-ai-dlr/issues/120/timeline","performed_via_github_app":null,"state_reason":null}