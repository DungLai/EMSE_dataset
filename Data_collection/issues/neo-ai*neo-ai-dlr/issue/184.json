{"url":"https://api.github.com/repos/neo-ai/neo-ai-dlr/issues/184","repository_url":"https://api.github.com/repos/neo-ai/neo-ai-dlr","labels_url":"https://api.github.com/repos/neo-ai/neo-ai-dlr/issues/184/labels{/name}","comments_url":"https://api.github.com/repos/neo-ai/neo-ai-dlr/issues/184/comments","events_url":"https://api.github.com/repos/neo-ai/neo-ai-dlr/issues/184/events","html_url":"https://github.com/neo-ai/neo-ai-dlr/issues/184","id":625069597,"node_id":"MDU6SXNzdWU2MjUwNjk1OTc=","number":184,"title":"ERROR error in DLRModel instantiation TVMError: key 0 is not supported","user":{"login":"gillouche","id":63115776,"node_id":"MDQ6VXNlcjYzMTE1Nzc2","avatar_url":"https://avatars.githubusercontent.com/u/63115776?v=4","gravatar_id":"","url":"https://api.github.com/users/gillouche","html_url":"https://github.com/gillouche","followers_url":"https://api.github.com/users/gillouche/followers","following_url":"https://api.github.com/users/gillouche/following{/other_user}","gists_url":"https://api.github.com/users/gillouche/gists{/gist_id}","starred_url":"https://api.github.com/users/gillouche/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gillouche/subscriptions","organizations_url":"https://api.github.com/users/gillouche/orgs","repos_url":"https://api.github.com/users/gillouche/repos","events_url":"https://api.github.com/users/gillouche/events{/privacy}","received_events_url":"https://api.github.com/users/gillouche/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-05-26T17:50:38Z","updated_at":"2020-06-24T06:30:47Z","closed_at":"2020-06-24T06:30:47Z","author_association":"NONE","active_lock_reason":null,"body":"Hello,\r\n\r\nI am building a FastAI model with SageMaker Neo for my Raspberry Pi 4 model B. I am trying to deploy it with AWS Greengrass. DLR is directly installed on my RPI4 using this [link](https://neo-ai-dlr-release.s3-us-west-2.amazonaws.com/v1.1.0/pi-armv7l-raspbian4.14.71-glibc2_24-libstdcpp3_4/dlr-1.1.0-py2.py3-none-any.whl) from this [page](https://neo-ai-dlr.readthedocs.io/en/latest/install.html).\r\n\r\nIf I connect to my RPI4 with SSH and load the model with the python interpreter, it works.\r\n\r\n```python\r\npi@raspberrypi:~/tmp $ python3\r\nPython 3.7.3 (default, Dec 20 2019, 18:57:59) \r\n[GCC 8.3.0] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import dlr\r\n>>> model = dlr.DLRModel('./cpu')\r\n>>> model\r\n<dlr.api.DLRModel object at 0xb66b1490>\r\n>>> exit()\r\n```\r\n\r\nUnfortunately, the same model downloaded from S3 in the Lambda deployed by AWS greengrass gives me that error.\r\n\r\n> [2020-05-26T19:09:49.82+02:00][INFO]-main.py:48,Starting main.\r\n[2020-05-26T19:09:52.2+02:00][INFO]-main.py:55,Webcam successfully initialized, triggering the processing.\r\n[2020-05-26T19:09:52.2+02:00][INFO]-main.py:26,Starting webcam processing and inference.\r\n[2020-05-26T19:09:52.2+02:00][INFO]-main.py:30,Initializing the process with image sampling number (15), face min confidence (0.9), mask min confidence (0.9).\r\n[2020-05-26T19:09:52.201+02:00][INFO]-inference_wrapper.py:24,The model archive does not exist at /tmp/model.zip. Downloading from S3\r\n[2020-05-26T19:09:58.352+02:00][INFO]-inference_wrapper.py:30,Unzipping done in /tmp\r\n[2020-05-26T19:09:58.352+02:00][INFO]-inference_wrapper.py:32,Loading the face detection model.\r\n[2020-05-26T19:09:58.435+02:00][INFO]-inference_wrapper.py:38,Loading the mask detection model.\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-__init__.py:1037,2020-05-26 19:09:58,831 ERROR error in DLRModel instantiation TVMError: key 0 is not supported\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-Stack trace:\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-  File \"/home/pi/workplace/neo-ai-dlr/3rdparty/tvm/src/runtime/graph/graph_runtime.h\", line 405\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-  [bt] (0) /usr/local/dlr/libdlr.so(dmlc::LogMessageFatal::~LogMessageFatal()+0x38) [0xaa4f8338]\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-  [bt] (1) /usr/local/dlr/libdlr.so(tvm::runtime::GraphRuntime::Load(dmlc::JSONReader*)+0x1c78) [0xaa5a3d6c]\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-  [bt] (2) /usr/local/dlr/libdlr.so(tvm::runtime::GraphRuntime::Init(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, tvm::runtime::Module, std::vector<DLContext, std::allocator<DLContext> > const&)+0x190) [0xaa591be0]\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-  [bt] (3) /usr/local/dlr/libdlr.so(dlr::TVMModel::SetupTVMModule(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >)+0xc88) [0xaa50bb64]\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-  [bt] (4) /usr/local/dlr/libdlr.so(CreateDLRModel+0x1bd4) [0xaa4f4dc0]\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-Traceback (most recent call last):\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-  File \"/usr/local/lib/python3.7/dist-packages/dlr/api.py\", line 82, in __init__\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-    self._impl = DLRModelImpl(model_path, dev_type, dev_id)\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-  File \"/usr/local/lib/python3.7/dist-packages/dlr/dlr_model.py\", line 111, in __init__\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-    c_int(dev_id)))\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-  File \"/usr/local/lib/python3.7/dist-packages/dlr/dlr_model.py\", line 26, in _check_call\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-    raise DLRError(_LIB.DLRGetLastError().decode('ascii'))\r\n[2020-05-26T19:09:58.981+02:00][ERROR]-dlr.dlr_model.DLRError: TVMError: key 0 is not supported\r\n\r\nI am trying to find what this error means to see if I can fix it myself. Would you have any idea of the reason I get this error in the Greengrass Lambda and not the python interpreter ?\r\n\r\nThank you.","closed_by":{"login":"gillouche","id":63115776,"node_id":"MDQ6VXNlcjYzMTE1Nzc2","avatar_url":"https://avatars.githubusercontent.com/u/63115776?v=4","gravatar_id":"","url":"https://api.github.com/users/gillouche","html_url":"https://github.com/gillouche","followers_url":"https://api.github.com/users/gillouche/followers","following_url":"https://api.github.com/users/gillouche/following{/other_user}","gists_url":"https://api.github.com/users/gillouche/gists{/gist_id}","starred_url":"https://api.github.com/users/gillouche/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gillouche/subscriptions","organizations_url":"https://api.github.com/users/gillouche/orgs","repos_url":"https://api.github.com/users/gillouche/repos","events_url":"https://api.github.com/users/gillouche/events{/privacy}","received_events_url":"https://api.github.com/users/gillouche/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/neo-ai/neo-ai-dlr/issues/184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/neo-ai/neo-ai-dlr/issues/184/timeline","performed_via_github_app":null,"state_reason":"completed"}