[{"id":4378344040,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDM3ODM0NDA0MA==","url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/events/4378344040","actor":{"login":"ymoisan","id":7468595,"node_id":"MDQ6VXNlcjc0Njg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/7468595?v=4","gravatar_id":"","url":"https://api.github.com/users/ymoisan","html_url":"https://github.com/ymoisan","followers_url":"https://api.github.com/users/ymoisan/followers","following_url":"https://api.github.com/users/ymoisan/following{/other_user}","gists_url":"https://api.github.com/users/ymoisan/gists{/gist_id}","starred_url":"https://api.github.com/users/ymoisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ymoisan/subscriptions","organizations_url":"https://api.github.com/users/ymoisan/orgs","repos_url":"https://api.github.com/users/ymoisan/repos","events_url":"https://api.github.com/users/ymoisan/events{/privacy}","received_events_url":"https://api.github.com/users/ymoisan/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-02-25T19:28:38Z","performed_via_github_app":null},{"id":4378344044,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQzNzgzNDQwNDQ=","url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/events/4378344044","actor":{"login":"ymoisan","id":7468595,"node_id":"MDQ6VXNlcjc0Njg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/7468595?v=4","gravatar_id":"","url":"https://api.github.com/users/ymoisan","html_url":"https://github.com/ymoisan","followers_url":"https://api.github.com/users/ymoisan/followers","following_url":"https://api.github.com/users/ymoisan/following{/other_user}","gists_url":"https://api.github.com/users/ymoisan/gists{/gist_id}","starred_url":"https://api.github.com/users/ymoisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ymoisan/subscriptions","organizations_url":"https://api.github.com/users/ymoisan/orgs","repos_url":"https://api.github.com/users/ymoisan/repos","events_url":"https://api.github.com/users/ymoisan/events{/privacy}","received_events_url":"https://api.github.com/users/ymoisan/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-02-25T19:28:38Z","performed_via_github_app":null},{"actor":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false},"created_at":"2021-02-25T19:41:11Z","updated_at":"2021-02-25T19:41:11Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/183","repository_url":"https://api.github.com/repos/NRCan/geo-deep-learning","labels_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/183/labels{/name}","comments_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/183/comments","events_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/183/events","html_url":"https://github.com/NRCan/geo-deep-learning/issues/183","id":816736534,"node_id":"MDU6SXNzdWU4MTY3MzY1MzQ=","number":183,"title":"Inference: run inference without yaml","user":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false},"labels":[{"id":1049334786,"node_id":"MDU6TGFiZWwxMDQ5MzM0Nzg2","url":"https://api.github.com/repos/NRCan/geo-deep-learning/labels/enhancement","name":"enhancement","color":"a2eeef","default":true,"description":"New feature or request"},{"id":1070498413,"node_id":"MDU6TGFiZWwxMDcwNDk4NDEz","url":"https://api.github.com/repos/NRCan/geo-deep-learning/labels/P1","name":"P1","color":"756bb1","default":false,"description":"High priority"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-02-25T19:41:10Z","updated_at":"2022-03-29T16:31:43Z","closed_at":"2022-03-29T16:31:43Z","author_association":"COLLABORATOR","active_lock_reason":null,"repository":{"id":147853940,"node_id":"MDEwOlJlcG9zaXRvcnkxNDc4NTM5NDA=","name":"geo-deep-learning","full_name":"NRCan/geo-deep-learning","private":false,"owner":{"login":"NRCan","id":1929244,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE5MjkyNDQ=","avatar_url":"https://avatars.githubusercontent.com/u/1929244?v=4","gravatar_id":"","url":"https://api.github.com/users/NRCan","html_url":"https://github.com/NRCan","followers_url":"https://api.github.com/users/NRCan/followers","following_url":"https://api.github.com/users/NRCan/following{/other_user}","gists_url":"https://api.github.com/users/NRCan/gists{/gist_id}","starred_url":"https://api.github.com/users/NRCan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NRCan/subscriptions","organizations_url":"https://api.github.com/users/NRCan/orgs","repos_url":"https://api.github.com/users/NRCan/repos","events_url":"https://api.github.com/users/NRCan/events{/privacy}","received_events_url":"https://api.github.com/users/NRCan/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/NRCan/geo-deep-learning","description":"Deep learning applied to georeferenced datasets","fork":false,"url":"https://api.github.com/repos/NRCan/geo-deep-learning","forks_url":"https://api.github.com/repos/NRCan/geo-deep-learning/forks","keys_url":"https://api.github.com/repos/NRCan/geo-deep-learning/keys{/key_id}","collaborators_url":"https://api.github.com/repos/NRCan/geo-deep-learning/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/NRCan/geo-deep-learning/teams","hooks_url":"https://api.github.com/repos/NRCan/geo-deep-learning/hooks","issue_events_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/events{/number}","events_url":"https://api.github.com/repos/NRCan/geo-deep-learning/events","assignees_url":"https://api.github.com/repos/NRCan/geo-deep-learning/assignees{/user}","branches_url":"https://api.github.com/repos/NRCan/geo-deep-learning/branches{/branch}","tags_url":"https://api.github.com/repos/NRCan/geo-deep-learning/tags","blobs_url":"https://api.github.com/repos/NRCan/geo-deep-learning/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/NRCan/geo-deep-learning/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/NRCan/geo-deep-learning/git/refs{/sha}","trees_url":"https://api.github.com/repos/NRCan/geo-deep-learning/git/trees{/sha}","statuses_url":"https://api.github.com/repos/NRCan/geo-deep-learning/statuses/{sha}","languages_url":"https://api.github.com/repos/NRCan/geo-deep-learning/languages","stargazers_url":"https://api.github.com/repos/NRCan/geo-deep-learning/stargazers","contributors_url":"https://api.github.com/repos/NRCan/geo-deep-learning/contributors","subscribers_url":"https://api.github.com/repos/NRCan/geo-deep-learning/subscribers","subscription_url":"https://api.github.com/repos/NRCan/geo-deep-learning/subscription","commits_url":"https://api.github.com/repos/NRCan/geo-deep-learning/commits{/sha}","git_commits_url":"https://api.github.com/repos/NRCan/geo-deep-learning/git/commits{/sha}","comments_url":"https://api.github.com/repos/NRCan/geo-deep-learning/comments{/number}","issue_comment_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments{/number}","contents_url":"https://api.github.com/repos/NRCan/geo-deep-learning/contents/{+path}","compare_url":"https://api.github.com/repos/NRCan/geo-deep-learning/compare/{base}...{head}","merges_url":"https://api.github.com/repos/NRCan/geo-deep-learning/merges","archive_url":"https://api.github.com/repos/NRCan/geo-deep-learning/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/NRCan/geo-deep-learning/downloads","issues_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues{/number}","pulls_url":"https://api.github.com/repos/NRCan/geo-deep-learning/pulls{/number}","milestones_url":"https://api.github.com/repos/NRCan/geo-deep-learning/milestones{/number}","notifications_url":"https://api.github.com/repos/NRCan/geo-deep-learning/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/NRCan/geo-deep-learning/labels{/name}","releases_url":"https://api.github.com/repos/NRCan/geo-deep-learning/releases{/id}","deployments_url":"https://api.github.com/repos/NRCan/geo-deep-learning/deployments","created_at":"2018-09-07T17:20:42Z","updated_at":"2022-11-30T19:40:39Z","pushed_at":"2023-01-17T17:37:46Z","git_url":"git://github.com/NRCan/geo-deep-learning.git","ssh_url":"git@github.com:NRCan/geo-deep-learning.git","clone_url":"https://github.com/NRCan/geo-deep-learning.git","svn_url":"https://github.com/NRCan/geo-deep-learning","homepage":"","size":107223,"stargazers_count":123,"watchers_count":123,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":42,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":54,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["cnn","deep-learning","deeplabv3","pytorch","remote-sensing","semantic-segmentation","unet"],"visibility":"public","forks":42,"open_issues":54,"watchers":123,"default_branch":"develop","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"If #154 is covered, then we can easily adapt inference.py to run without a yaml. We could think of 2 mandatory arguments:\r\n1. image url (local path or from web)\r\n2. model url (local path or from web to checkpoint.pth.tar)\r\n\r\nThere could also be a third, optional argument:\r\n- number of gpus. \r\n\r\nIf this third argument is optional though, we'd have to determine what the default behavior is:\r\n- if multiple gpus are available, run on one gpu only?\r\n- if multiple gpus are available, run on all available gpus? This implies that #182 would be solved.","reactions":{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/183/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":4378400521,"node_id":"MDEyOkxhYmVsZWRFdmVudDQzNzg0MDA1MjE=","url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/events/4378400521","actor":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-02-25T19:42:04Z","label":{"name":"enhancement","color":"a2eeef"},"performed_via_github_app":null},{"id":4378400522,"node_id":"MDEyOkxhYmVsZWRFdmVudDQzNzg0MDA1MjI=","url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/events/4378400522","actor":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-02-25T19:42:04Z","label":{"name":"P2","color":"bcbddc"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/786186691","html_url":"https://github.com/NRCan/geo-deep-learning/issues/182#issuecomment-786186691","issue_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/182","id":786186691,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjE4NjY5MQ==","user":{"login":"ymoisan","id":7468595,"node_id":"MDQ6VXNlcjc0Njg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/7468595?v=4","gravatar_id":"","url":"https://api.github.com/users/ymoisan","html_url":"https://github.com/ymoisan","followers_url":"https://api.github.com/users/ymoisan/followers","following_url":"https://api.github.com/users/ymoisan/following{/other_user}","gists_url":"https://api.github.com/users/ymoisan/gists{/gist_id}","starred_url":"https://api.github.com/users/ymoisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ymoisan/subscriptions","organizations_url":"https://api.github.com/users/ymoisan/orgs","repos_url":"https://api.github.com/users/ymoisan/repos","events_url":"https://api.github.com/users/ymoisan/events{/privacy}","received_events_url":"https://api.github.com/users/ymoisan/received_events","type":"User","site_admin":false},"created_at":"2021-02-25T20:35:50Z","updated_at":"2021-02-25T20:35:50Z","author_association":"CONTRIBUTOR","body":"I would implement DataParallel for inference and no more for now.  I think the problem is more one of maximizing inference speed rather than being able to handle huge images.  Maybe we should have a service to extract \"sub-images\" from huge COGs and supply those sub-images for inference on (potentially) more than one GPU.  That is, until we can actually stream the COGs in the inference engine dynamically.","reactions":{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/786186691/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ymoisan","id":7468595,"node_id":"MDQ6VXNlcjc0Njg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/7468595?v=4","gravatar_id":"","url":"https://api.github.com/users/ymoisan","html_url":"https://github.com/ymoisan","followers_url":"https://api.github.com/users/ymoisan/followers","following_url":"https://api.github.com/users/ymoisan/following{/other_user}","gists_url":"https://api.github.com/users/ymoisan/gists{/gist_id}","starred_url":"https://api.github.com/users/ymoisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ymoisan/subscriptions","organizations_url":"https://api.github.com/users/ymoisan/orgs","repos_url":"https://api.github.com/users/ymoisan/repos","events_url":"https://api.github.com/users/ymoisan/events{/privacy}","received_events_url":"https://api.github.com/users/ymoisan/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/786190534","html_url":"https://github.com/NRCan/geo-deep-learning/issues/182#issuecomment-786190534","issue_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/182","id":786190534,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjE5MDUzNA==","user":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false},"created_at":"2021-02-25T20:43:02Z","updated_at":"2021-02-25T20:43:02Z","author_association":"COLLABORATOR","body":"@ymoisan naturally, we will need DataParallel. The problem is Dataparallel intimately works with a Pytorch Dataloader. We don't use a Dataloader currently at inference. Therefore, I send you back to my two ideas. We'll need to elaborate on the simplest/best solution for fast/efficient inference.","reactions":{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/786190534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false}},{"id":4378651477,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDM3ODY1MTQ3Nw==","url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/events/4378651477","actor":{"login":"ymoisan","id":7468595,"node_id":"MDQ6VXNlcjc0Njg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/7468595?v=4","gravatar_id":"","url":"https://api.github.com/users/ymoisan","html_url":"https://github.com/ymoisan","followers_url":"https://api.github.com/users/ymoisan/followers","following_url":"https://api.github.com/users/ymoisan/following{/other_user}","gists_url":"https://api.github.com/users/ymoisan/gists{/gist_id}","starred_url":"https://api.github.com/users/ymoisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ymoisan/subscriptions","organizations_url":"https://api.github.com/users/ymoisan/orgs","repos_url":"https://api.github.com/users/ymoisan/repos","events_url":"https://api.github.com/users/ymoisan/events{/privacy}","received_events_url":"https://api.github.com/users/ymoisan/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-02-25T20:43:02Z","performed_via_github_app":null},{"id":4378651479,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQzNzg2NTE0Nzk=","url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/events/4378651479","actor":{"login":"ymoisan","id":7468595,"node_id":"MDQ6VXNlcjc0Njg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/7468595?v=4","gravatar_id":"","url":"https://api.github.com/users/ymoisan","html_url":"https://github.com/ymoisan","followers_url":"https://api.github.com/users/ymoisan/followers","following_url":"https://api.github.com/users/ymoisan/following{/other_user}","gists_url":"https://api.github.com/users/ymoisan/gists{/gist_id}","starred_url":"https://api.github.com/users/ymoisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ymoisan/subscriptions","organizations_url":"https://api.github.com/users/ymoisan/orgs","repos_url":"https://api.github.com/users/ymoisan/repos","events_url":"https://api.github.com/users/ymoisan/events{/privacy}","received_events_url":"https://api.github.com/users/ymoisan/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-02-25T20:43:02Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/786241280","html_url":"https://github.com/NRCan/geo-deep-learning/issues/182#issuecomment-786241280","issue_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/182","id":786241280,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjI0MTI4MA==","user":{"login":"mpelchat04","id":38693210,"node_id":"MDQ6VXNlcjM4NjkzMjEw","avatar_url":"https://avatars.githubusercontent.com/u/38693210?v=4","gravatar_id":"","url":"https://api.github.com/users/mpelchat04","html_url":"https://github.com/mpelchat04","followers_url":"https://api.github.com/users/mpelchat04/followers","following_url":"https://api.github.com/users/mpelchat04/following{/other_user}","gists_url":"https://api.github.com/users/mpelchat04/gists{/gist_id}","starred_url":"https://api.github.com/users/mpelchat04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mpelchat04/subscriptions","organizations_url":"https://api.github.com/users/mpelchat04/orgs","repos_url":"https://api.github.com/users/mpelchat04/repos","events_url":"https://api.github.com/users/mpelchat04/events{/privacy}","received_events_url":"https://api.github.com/users/mpelchat04/received_events","type":"User","site_admin":false},"created_at":"2021-02-25T21:31:20Z","updated_at":"2021-02-25T21:31:20Z","author_association":"COLLABORATOR","body":"Consideration:  \r\n* How does this conflicts/interact with test-time augmentations (which takes up quite a bit of GPU memory, same as batching the process)?  ","reactions":{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/786241280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mpelchat04","id":38693210,"node_id":"MDQ6VXNlcjM4NjkzMjEw","avatar_url":"https://avatars.githubusercontent.com/u/38693210?v=4","gravatar_id":"","url":"https://api.github.com/users/mpelchat04","html_url":"https://github.com/mpelchat04","followers_url":"https://api.github.com/users/mpelchat04/followers","following_url":"https://api.github.com/users/mpelchat04/following{/other_user}","gists_url":"https://api.github.com/users/mpelchat04/gists{/gist_id}","starred_url":"https://api.github.com/users/mpelchat04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mpelchat04/subscriptions","organizations_url":"https://api.github.com/users/mpelchat04/orgs","repos_url":"https://api.github.com/users/mpelchat04/repos","events_url":"https://api.github.com/users/mpelchat04/events{/privacy}","received_events_url":"https://api.github.com/users/mpelchat04/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/1040283577","html_url":"https://github.com/NRCan/geo-deep-learning/issues/182#issuecomment-1040283577","issue_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/182","id":1040283577,"node_id":"IC_kwDOCNASdM4-AXe5","user":{"login":"ymoisan","id":7468595,"node_id":"MDQ6VXNlcjc0Njg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/7468595?v=4","gravatar_id":"","url":"https://api.github.com/users/ymoisan","html_url":"https://github.com/ymoisan","followers_url":"https://api.github.com/users/ymoisan/followers","following_url":"https://api.github.com/users/ymoisan/following{/other_user}","gists_url":"https://api.github.com/users/ymoisan/gists{/gist_id}","starred_url":"https://api.github.com/users/ymoisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ymoisan/subscriptions","organizations_url":"https://api.github.com/users/ymoisan/orgs","repos_url":"https://api.github.com/users/ymoisan/repos","events_url":"https://api.github.com/users/ymoisan/events{/privacy}","received_events_url":"https://api.github.com/users/ymoisan/received_events","type":"User","site_admin":false},"created_at":"2022-02-15T13:37:00Z","updated_at":"2022-02-15T13:37:00Z","author_association":"CONTRIBUTOR","body":"Another consideration:\r\n- The more GPUs are required on HPC, the more the chances of delaying job execution","reactions":{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/1040283577/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ymoisan","id":7468595,"node_id":"MDQ6VXNlcjc0Njg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/7468595?v=4","gravatar_id":"","url":"https://api.github.com/users/ymoisan","html_url":"https://github.com/ymoisan","followers_url":"https://api.github.com/users/ymoisan/followers","following_url":"https://api.github.com/users/ymoisan/following{/other_user}","gists_url":"https://api.github.com/users/ymoisan/gists{/gist_id}","starred_url":"https://api.github.com/users/ymoisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ymoisan/subscriptions","organizations_url":"https://api.github.com/users/ymoisan/orgs","repos_url":"https://api.github.com/users/ymoisan/repos","events_url":"https://api.github.com/users/ymoisan/events{/privacy}","received_events_url":"https://api.github.com/users/ymoisan/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/1047162124","html_url":"https://github.com/NRCan/geo-deep-learning/issues/182#issuecomment-1047162124","issue_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/182","id":1047162124,"node_id":"IC_kwDOCNASdM4-am0M","user":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false},"created_at":"2022-02-21T19:09:40Z","updated_at":"2022-02-21T19:09:40Z","author_association":"COLLABORATOR","body":"> Consideration:\r\n> \r\n> * How does this conflicts/interact with test-time augmentations (which takes up quite a bit of GPU memory, same as batching the process)?\r\n\r\nI'm pretty sure TTA could be used easily in a multi-GPU execution (managed by pytorch/pytorch-lightning) with DataParallel or DistributedDataParallel). Using more than 1 gpu could potentially speedup the inference process when TTA is used. The simplest implementation would be for GPUs to process different tiles from the source imagery and be able to write to a common numpy array. Tests would be needed as this is not Pytorch's default use case.","reactions":{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/1047162124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/1047163291","html_url":"https://github.com/NRCan/geo-deep-learning/issues/182#issuecomment-1047163291","issue_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/182","id":1047163291,"node_id":"IC_kwDOCNASdM4-anGb","user":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false},"created_at":"2022-02-21T19:11:28Z","updated_at":"2022-02-21T19:11:51Z","author_association":"COLLABORATOR","body":"> Another consideration:\r\n> \r\n> * The more GPUs are required on HPC, the more the chances of delaying job execution\r\n\r\nIndeed. In the context or deploying on HPC, we would greatly benefit from having GPUs with 32gb ram rather than 16gb for inference (not that we have any control over that, but just to throw in here). The pros of bigger GPU would definitely outweight the pros of multi-gpu inference in our current setup, since a bigger gpu needs no further development effort... ","reactions":{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/1047163291/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/1077727872","html_url":"https://github.com/NRCan/geo-deep-learning/issues/182#issuecomment-1077727872","issue_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/182","id":1077727872,"node_id":"IC_kwDOCNASdM5APNKA","user":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false},"created_at":"2022-03-24T15:02:53Z","updated_at":"2022-03-24T15:26:51Z","author_association":"COLLABORATOR","body":"Just tested gpu inference using torchgeo templates and pytorch lightning (PL). I had in mind to make it work with a single gpu in a PL context. Then, porting to multi-gpu would have been just a question of settings gpus to more than 1 in the PL Trainer (PL default to ddp-spawn). \r\n\r\nIt seems multi-gpu feature in PL is mostly aimed at training/validation. See:\r\nhttps://stackoverflow.com/questions/65807601/output-prediction-of-pytorch-lightning-model\r\n\r\nFor example, PL-Trainer's auto_scale_batch_size is really only aimed at training. Here's the error I got when trying for inference:\r\n```\r\npytorch_lightning.utilities.exceptions.MisconfigurationException: No `training_step()` method defined. Lightning `Trainer` expects as minimum a `training_step()`, `train_dataloader()` and `configure_optimizers()` to be defined.\r\n```\r\n\r\nJust for the record here's essentially the bit of code for my best trial (see inference_segmentation.py in my 222-stac-item-input branch for the rest):\r\n\r\n```\r\n    checkpoint, hparams = gdl2pl_checkpoint(checkpoint)\r\n    [...]\r\n    task = InferenceTask(checkpoint, **hparams)\r\n    trainer_args = {}\r\n    trainer_args[\"default_root_dir\"] = dm.root_dir\r\n\r\n    dm.batch_size = task.batch_size = 4\r\n    trainer = Trainer(auto_scale_batch_size=True, gpus=0, precision=16, **trainer_args)\r\n    trainer.tune(task)\r\n    predictions = trainer.predict(model=task, datamodule=dm, return_predictions=True, ckpt_path=checkpoint)\r\n```\r\nWhen skipping the tune() method which produces the error above, here's the error I get:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/remi/PycharmProjects/geo-deep-learning/GDL.py\", line 91, in <module>\r\n    run_gdl()\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/hydra/main.py\", line 48, in decorated_main\r\n    _run_hydra(\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/hydra/_internal/utils.py\", line 377, in _run_hydra\r\n    run_and_report(\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/hydra/_internal/utils.py\", line 294, in run_and_report\r\n    raise ex\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/hydra/_internal/utils.py\", line 211, in run_and_report\r\n    return func()\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/hydra/_internal/utils.py\", line 378, in <lambda>\r\n    lambda: hydra.run(\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/hydra/_internal/hydra.py\", line 111, in run\r\n    _ = ret.return_value\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/hydra/core/utils.py\", line 233, in return_value\r\n    raise self._return_value\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/hydra/core/utils.py\", line 160, in run_job\r\n    ret.return_value = task_function(task_cfg)\r\n  File \"/home/remi/PycharmProjects/geo-deep-learning/GDL.py\", line 70, in run_gdl\r\n    task(cfg)\r\n  File \"/home/remi/PycharmProjects/geo-deep-learning/inference_segmentation.py\", line 325, in main\r\n    predictions = trainer.predict(model=task, datamodule=dm, return_predictions=True, ckpt_path=checkpoint)\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py\", line 993, in predict\r\n    return self._call_and_handle_interrupt(\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py\", line 685, in _call_and_handle_interrupt\r\n    return trainer_fn(*args, **kwargs)\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py\", line 1037, in _predict_impl\r\n    results = self._run(model, ckpt_path=self.predicted_ckpt_path)\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py\", line 1199, in _run\r\n    self._dispatch()\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py\", line 1277, in _dispatch\r\n    self.training_type_plugin.start_predicting(self)\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py\", line 210, in start_predicting\r\n    self._results = trainer.run_stage()\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py\", line 1288, in run_stage\r\n    return self._run_predict()\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py\", line 1350, in _run_predict\r\n    return self.predict_loop.run()\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/loops/base.py\", line 145, in run\r\n    self.advance(*args, **kwargs)\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/loops/dataloader/prediction_loop.py\", line 88, in advance\r\n    dl_predictions, dl_batch_indices = self.epoch_loop.run(\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/loops/base.py\", line 145, in run\r\n    self.advance(*args, **kwargs)\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/loops/epoch/prediction_epoch_loop.py\", line 101, in advance\r\n    batch = self.trainer.accelerator.batch_to_device(batch, dataloader_idx=dataloader_idx)\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/accelerators/accelerator.py\", line 206, in batch_to_device\r\n    return model._apply_batch_transfer_handler(batch, device=device, dataloader_idx=dataloader_idx)\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/core/lightning.py\", line 291, in _apply_batch_transfer_handler\r\n    batch = self.transfer_batch_to_device(batch, device, dataloader_idx)\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/core/hooks.py\", line 707, in transfer_batch_to_device\r\n    return move_data_to_device(batch, device)\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/utilities/apply_func.py\", line 285, in move_data_to_device\r\n    return apply_to_collection(batch, dtype=dtype, function=batch_to)\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/utilities/apply_func.py\", line 103, in apply_to_collection\r\n    v = apply_to_collection(\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/utilities/apply_func.py\", line 117, in apply_to_collection\r\n    v = apply_to_collection(\r\n  File \"/home/remi/miniconda3/envs/geo_deep_env_gpu/lib/python3.9/site-packages/pytorch_lightning/utilities/apply_func.py\", line 149, in apply_to_collection\r\n    setattr(result, field_name, v)\r\n  File \"<string>\", line 4, in __setattr__\r\ndataclasses.FrozenInstanceError: cannot assign to field 'minx'\r\nPredicting:   0%|          | 0/254 [00:00<?, ?it/s]\r\n```\r\n\r\nIn any case, I'm closing this issue as multi-gpu inference is not really a need we have. We'd rather run multiple inferences at once on different images and use one gpu per image, then using multigpu approach on a single image. \r\n\r\nSome useful resources that were bookmarked:\r\nhttps://pytorch-lightning.readthedocs.io/en/stable/starter/new-project.html\r\nhttps://github.com/PyTorchLightning/pytorch-lightning/discussions/9259\r\nhttps://pytorch-lightning.readthedocs.io/en/latest/notebooks/lightning_examples/cifar10-baseline.html?highlight=ligthning%20module#Lightning-Module","reactions":{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/1077727872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false}},{"id":6300261019,"node_id":"CE_lADOCNASdM4wrkcOzwAAAAF3hlqb","url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/events/6300261019","actor":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-03-24T15:02:53Z","state_reason":null,"performed_via_github_app":null}]