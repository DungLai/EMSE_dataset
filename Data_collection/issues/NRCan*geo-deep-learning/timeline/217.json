[{"id":5774278090,"node_id":"LE_lADOCNASdM5AdnN3zwAAAAFYLH3K","url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/events/5774278090","actor":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-12-15T20:54:11Z","label":{"name":"P2","color":"bcbddc"},"performed_via_github_app":null},{"id":5774278121,"node_id":"ATPE_lADOCNASdM5AdnN3zwAAAAFYLH3p","url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/events/5774278121","actor":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false},"event":"added_to_project","commit_id":null,"commit_url":null,"created_at":"2021-12-15T20:54:11Z","project_card":{"id":74860449,"url":"https://api.github.com/projects/columns/cards/74860449","project_id":13915781,"project_url":"https://api.github.com/projects/13915781","column_name":"To do"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/995872206","html_url":"https://github.com/NRCan/geo-deep-learning/issues/217#issuecomment-995872206","issue_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/217","id":995872206,"node_id":"IC_kwDOCNASdM47W83O","user":{"login":"ymoisan","id":7468595,"node_id":"MDQ6VXNlcjc0Njg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/7468595?v=4","gravatar_id":"","url":"https://api.github.com/users/ymoisan","html_url":"https://github.com/ymoisan","followers_url":"https://api.github.com/users/ymoisan/followers","following_url":"https://api.github.com/users/ymoisan/following{/other_user}","gists_url":"https://api.github.com/users/ymoisan/gists{/gist_id}","starred_url":"https://api.github.com/users/ymoisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ymoisan/subscriptions","organizations_url":"https://api.github.com/users/ymoisan/orgs","repos_url":"https://api.github.com/users/ymoisan/repos","events_url":"https://api.github.com/users/ymoisan/events{/privacy}","received_events_url":"https://api.github.com/users/ymoisan/received_events","type":"User","site_admin":false},"created_at":"2021-12-16T14:32:38Z","updated_at":"2021-12-16T14:32:38Z","author_association":"CONTRIBUTOR","body":"Looks like a debug level setting : info, verbose, etc.  Using that kind of terminology for command line arguments -- as opposed to something like *heatmap* or *probability map* -- would likely make the use of the script easier.  It would be specified somewhere what the \"output level\" settings map to technically, e.g. *verbose* means heatmaps are saved together with the final segmentation results.  \r\n\r\nHeatmap values give indications to technicians as to potential feature type commissions.  Would they need some intermediate result to help them with feature delineation too ?  I suggest we have them document their needs in this ticket.","reactions":{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/995872206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ymoisan","id":7468595,"node_id":"MDQ6VXNlcjc0Njg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/7468595?v=4","gravatar_id":"","url":"https://api.github.com/users/ymoisan","html_url":"https://github.com/ymoisan","followers_url":"https://api.github.com/users/ymoisan/followers","following_url":"https://api.github.com/users/ymoisan/following{/other_user}","gists_url":"https://api.github.com/users/ymoisan/gists{/gist_id}","starred_url":"https://api.github.com/users/ymoisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ymoisan/subscriptions","organizations_url":"https://api.github.com/users/ymoisan/orgs","repos_url":"https://api.github.com/users/ymoisan/repos","events_url":"https://api.github.com/users/ymoisan/events{/privacy}","received_events_url":"https://api.github.com/users/ymoisan/received_events","type":"User","site_admin":false}},{"id":6075242046,"node_id":"MIE_lADOCNASdM5AdnN3zwAAAAFqHNY-","url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/events/6075242046","actor":{"login":"ymoisan","id":7468595,"node_id":"MDQ6VXNlcjc0Njg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/7468595?v=4","gravatar_id":"","url":"https://api.github.com/users/ymoisan","html_url":"https://github.com/ymoisan","followers_url":"https://api.github.com/users/ymoisan/followers","following_url":"https://api.github.com/users/ymoisan/following{/other_user}","gists_url":"https://api.github.com/users/ymoisan/gists{/gist_id}","starred_url":"https://api.github.com/users/ymoisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ymoisan/subscriptions","organizations_url":"https://api.github.com/users/ymoisan/orgs","repos_url":"https://api.github.com/users/ymoisan/repos","events_url":"https://api.github.com/users/ymoisan/events{/privacy}","received_events_url":"https://api.github.com/users/ymoisan/received_events","type":"User","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2022-02-15T14:09:24Z","milestone":{"title":"Inference as a Service"},"performed_via_github_app":null},{"id":6163425928,"node_id":"LE_lADOCNASdM5AdnN3zwAAAAFvXmqI","url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/events/6163425928","actor":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-03-01T16:45:48Z","label":{"name":"enhancement","color":"a2eeef"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/1055784324","html_url":"https://github.com/NRCan/geo-deep-learning/issues/217#issuecomment-1055784324","issue_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/217","id":1055784324,"node_id":"IC_kwDOCNASdM4-7f2E","user":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false},"created_at":"2022-03-01T19:30:12Z","updated_at":"2022-03-01T19:39:36Z","author_association":"COLLABORATOR","body":"Here's an idea for implementing this:\r\n1. write raw inference as raster, before argmax but after sigmoid/softmax, as .tif (currently it is written as .dat file with numpy memmap, and is deleted at end of inference)\r\n2. write the final inference as gpkg\r\n3. read final inference as geopandas dataframe.\r\n4. for each feature saved in gpkg:\r\n\r\n4.1. get bounds of feature and from those bounds read rasterio window of the raw inference (with per-class, per-pixel confidence levels)\r\n4.2 rasterize the single feature with its bounds (rectangular area) and create numpy mask from output (true where feature is, false where background)\r\n4.3. using numpy, calculate the mean confidence for all pixels where mask values are True\r\n4.4. write that mean value as integer attribute value for a \"confidence\" attribute\r\n\r\nStep 4 could be parallelized using python multiprocessing and would speed up the whole process. See example of multiprocessing implementation [in my solaris_tiling branch](https://github.com/remtav/geo-deep-learning/blob/215-solaris-tiling/tiling_segmentation.py#L705).\r\n\r\nIt goes without saying that, in our use case (semantic segmentation), this would be pretty \"calculation\" and \"memory\" intensive. \r\nTests need to be done.","reactions":{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/1055784324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"remtav","id":34774759,"node_id":"MDQ6VXNlcjM0Nzc0NzU5","avatar_url":"https://avatars.githubusercontent.com/u/34774759?v=4","gravatar_id":"","url":"https://api.github.com/users/remtav","html_url":"https://github.com/remtav","followers_url":"https://api.github.com/users/remtav/followers","following_url":"https://api.github.com/users/remtav/following{/other_user}","gists_url":"https://api.github.com/users/remtav/gists{/gist_id}","starred_url":"https://api.github.com/users/remtav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remtav/subscriptions","organizations_url":"https://api.github.com/users/remtav/orgs","repos_url":"https://api.github.com/users/remtav/repos","events_url":"https://api.github.com/users/remtav/events{/privacy}","received_events_url":"https://api.github.com/users/remtav/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/1055833530","html_url":"https://github.com/NRCan/geo-deep-learning/issues/217#issuecomment-1055833530","issue_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/217","id":1055833530,"node_id":"IC_kwDOCNASdM4-7r26","user":{"login":"ymoisan","id":7468595,"node_id":"MDQ6VXNlcjc0Njg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/7468595?v=4","gravatar_id":"","url":"https://api.github.com/users/ymoisan","html_url":"https://github.com/ymoisan","followers_url":"https://api.github.com/users/ymoisan/followers","following_url":"https://api.github.com/users/ymoisan/following{/other_user}","gists_url":"https://api.github.com/users/ymoisan/gists{/gist_id}","starred_url":"https://api.github.com/users/ymoisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ymoisan/subscriptions","organizations_url":"https://api.github.com/users/ymoisan/orgs","repos_url":"https://api.github.com/users/ymoisan/repos","events_url":"https://api.github.com/users/ymoisan/events{/privacy}","received_events_url":"https://api.github.com/users/ymoisan/received_events","type":"User","site_admin":false},"created_at":"2022-03-01T20:32:14Z","updated_at":"2022-03-01T20:32:14Z","author_association":"CONTRIBUTOR","body":"Could we avoid vectorizing then re-rasterizing by writing a 2-channel raster with prediction class value in channel 1 and a confidence value in channel 2 ?  We could use a flag (e.g. `verbose=true` ?) as a runtime parameter that would mean the raster output would be kept.  That parameter would default to false.","reactions":{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/comments/1055833530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ymoisan","id":7468595,"node_id":"MDQ6VXNlcjc0Njg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/7468595?v=4","gravatar_id":"","url":"https://api.github.com/users/ymoisan","html_url":"https://github.com/ymoisan","followers_url":"https://api.github.com/users/ymoisan/followers","following_url":"https://api.github.com/users/ymoisan/following{/other_user}","gists_url":"https://api.github.com/users/ymoisan/gists{/gist_id}","starred_url":"https://api.github.com/users/ymoisan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ymoisan/subscriptions","organizations_url":"https://api.github.com/users/ymoisan/orgs","repos_url":"https://api.github.com/users/ymoisan/repos","events_url":"https://api.github.com/users/ymoisan/events{/privacy}","received_events_url":"https://api.github.com/users/ymoisan/received_events","type":"User","site_admin":false}}]