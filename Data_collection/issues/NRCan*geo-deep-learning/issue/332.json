{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/332","repository_url":"https://api.github.com/repos/NRCan/geo-deep-learning","labels_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/332/labels{/name}","comments_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/332/comments","events_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/332/events","html_url":"https://github.com/NRCan/geo-deep-learning/issues/332","id":1313587380,"node_id":"I_kwDOCNASdM5OS8C0","number":332,"title":"num_workers > 0 not working at inference, on Windows OS","user":{"login":"mpelchat04","id":38693210,"node_id":"MDQ6VXNlcjM4NjkzMjEw","avatar_url":"https://avatars.githubusercontent.com/u/38693210?v=4","gravatar_id":"","url":"https://api.github.com/users/mpelchat04","html_url":"https://github.com/mpelchat04","followers_url":"https://api.github.com/users/mpelchat04/followers","following_url":"https://api.github.com/users/mpelchat04/following{/other_user}","gists_url":"https://api.github.com/users/mpelchat04/gists{/gist_id}","starred_url":"https://api.github.com/users/mpelchat04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mpelchat04/subscriptions","organizations_url":"https://api.github.com/users/mpelchat04/orgs","repos_url":"https://api.github.com/users/mpelchat04/repos","events_url":"https://api.github.com/users/mpelchat04/events{/privacy}","received_events_url":"https://api.github.com/users/mpelchat04/received_events","type":"User","site_admin":false},"labels":[{"id":1049334791,"node_id":"MDU6TGFiZWwxMDQ5MzM0Nzkx","url":"https://api.github.com/repos/NRCan/geo-deep-learning/labels/wontfix","name":"wontfix","color":"ffffff","default":true,"description":"This will not be worked on"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-07-21T17:35:45Z","updated_at":"2022-09-09T17:25:19Z","closed_at":"2022-09-09T17:25:19Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"We've encountered an error using the inference mode on the test dataset.   \r\nThe error does not occur on Linux platform, only on Windows (both on CPU only and GPU devices).  \r\nThe error can be avoided when `num_workers` is set to 0 (no multiprocessing).  \r\n\r\nRelated references:  \r\n\r\n-  https://discuss.pytorch.org/t/errors-when-using-num-workers-0-in-dataloader/97564/3 \r\n- https://discuss.pytorch.org/t/dataloader-multiprocessing-error-cant-pickle-odict-keys-objects-when-num-workers-0/43951\r\n  \r\nHere's the stack trace:  \r\n```  \r\nInstantiating inference generator for looping over imagery chips\r\n  0%|                                                                                                                                                                                | 0/78 [00:00<?, ?it/s]\r\nError executing job with overrides: []\r\nTraceback (most recent call last):\r\n  File \"c:\\Users\\maturgeo\\Documents\\Processus\\pycharm\\geo-deep-learning\\GDL.py\", line 71, in run_gdl\r\n    task(cfg)\r\n  File \"c:\\Users\\maturgeo\\Documents\\Processus\\pycharm\\geo-deep-learning\\inference_segmentation.py\", line 354, in main\r\n    for inference_prediction in eval_gen:\r\n  File \"c:\\Users\\maturgeo\\Documents\\Processus\\pycharm\\geo-deep-learning\\inference_segmentation.py\", line 176, in eval_batch_generator\r\n    for batch in tqdm(dataloader, disable=not verbose):\r\n  File \"C:\\Users\\maturgeo\\Miniconda3\\envs\\geo_deep_env\\lib\\site-packages\\tqdm\\std.py\", line 1195, in __iter__\r\n    for obj in iterable:\r\n  File \"C:\\Users\\maturgeo\\Miniconda3\\envs\\geo_deep_env\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 438, in __iter__\r\n    return self._get_iterator()\r\n  File \"C:\\Users\\maturgeo\\Miniconda3\\envs\\geo_deep_env\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 384, in _get_iterator\r\n    return _MultiProcessingDataLoaderIter(self)\r\n  File \"C:\\Users\\maturgeo\\Miniconda3\\envs\\geo_deep_env\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 1048, in __init__\r\n    w.start()\r\n  File \"C:\\Users\\maturgeo\\Miniconda3\\envs\\geo_deep_env\\lib\\multiprocessing\\process.py\", line 121, in start\r\n    self._popen = self._Popen(self)\r\n  File \"C:\\Users\\maturgeo\\Miniconda3\\envs\\geo_deep_env\\lib\\multiprocessing\\context.py\", line 224, in _Popen\r\n    return _default_context.get_context().Process._Popen(process_obj)\r\n  File \"C:\\Users\\maturgeo\\Miniconda3\\envs\\geo_deep_env\\lib\\multiprocessing\\context.py\", line 327, in _Popen\r\n    return Popen(process_obj)\r\n  File \"C:\\Users\\maturgeo\\Miniconda3\\envs\\geo_deep_env\\lib\\multiprocessing\\popen_spawn_win32.py\", line 93, in __init__\r\n    reduction.dump(process_obj, to_child)\r\n  File \"C:\\Users\\maturgeo\\Miniconda3\\envs\\geo_deep_env\\lib\\multiprocessing\\reduction.py\", line 60, in dump\r\n    ForkingPickler(file, protocol).dump(obj)\r\nAttributeError: Can't pickle local object 'pad.<locals>._pad'\r\n\r\nSet the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.  \r\n```  \r\n\r\n","closed_by":{"login":"mpelchat04","id":38693210,"node_id":"MDQ6VXNlcjM4NjkzMjEw","avatar_url":"https://avatars.githubusercontent.com/u/38693210?v=4","gravatar_id":"","url":"https://api.github.com/users/mpelchat04","html_url":"https://github.com/mpelchat04","followers_url":"https://api.github.com/users/mpelchat04/followers","following_url":"https://api.github.com/users/mpelchat04/following{/other_user}","gists_url":"https://api.github.com/users/mpelchat04/gists{/gist_id}","starred_url":"https://api.github.com/users/mpelchat04/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mpelchat04/subscriptions","organizations_url":"https://api.github.com/users/mpelchat04/orgs","repos_url":"https://api.github.com/users/mpelchat04/repos","events_url":"https://api.github.com/users/mpelchat04/events{/privacy}","received_events_url":"https://api.github.com/users/mpelchat04/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/332/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/NRCan/geo-deep-learning/issues/332/timeline","performed_via_github_app":null,"state_reason":"not_planned"}