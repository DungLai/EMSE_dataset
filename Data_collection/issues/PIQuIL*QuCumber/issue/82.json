{"url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/82","repository_url":"https://api.github.com/repos/PIQuIL/QuCumber","labels_url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/82/labels{/name}","comments_url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/82/comments","events_url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/82/events","html_url":"https://github.com/PIQuIL/QuCumber/issues/82","id":437250083,"node_id":"MDU6SXNzdWU0MzcyNTAwODM=","number":82,"title":"Error with train_bases file in ComplexWavefunction","user":{"login":"andriusdc","id":49077073,"node_id":"MDQ6VXNlcjQ5MDc3MDcz","avatar_url":"https://avatars.githubusercontent.com/u/49077073?v=4","gravatar_id":"","url":"https://api.github.com/users/andriusdc","html_url":"https://github.com/andriusdc","followers_url":"https://api.github.com/users/andriusdc/followers","following_url":"https://api.github.com/users/andriusdc/following{/other_user}","gists_url":"https://api.github.com/users/andriusdc/gists{/gist_id}","starred_url":"https://api.github.com/users/andriusdc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andriusdc/subscriptions","organizations_url":"https://api.github.com/users/andriusdc/orgs","repos_url":"https://api.github.com/users/andriusdc/repos","events_url":"https://api.github.com/users/andriusdc/events{/privacy}","received_events_url":"https://api.github.com/users/andriusdc/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-04-25T15:04:02Z","updated_at":"2019-04-27T14:45:34Z","closed_at":"2019-04-27T14:45:34Z","author_association":"NONE","active_lock_reason":null,"body":"I am using QuCumber to try to learn based on some data that I have for a 4-qubit wavefunction. I am getting this error:\r\n\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-13-51745c6cced7> in <module>\r\n     78     lr=lr,\r\n     79     input_bases=train_bases,\r\n---> 80     callbacks=callbacks,\r\n     81 )\r\n     82 \r\n\r\n~/anaconda3/envs/Projeto/lib/python3.6/site-packages/qucumber/nn_states/complex_wavefunction.py in fit(self, data, epochs, pos_batch_size, neg_batch_size, k, lr, input_bases, progbar, starting_epoch, time, callbacks, optimizer, **kwargs)\r\n    280                 callbacks=callbacks,\r\n    281                 optimizer=optimizer,\r\n--> 282                 **kwargs\r\n    283             )\r\n    284 \r\n\r\n~/anaconda3/envs/Projeto/lib/python3.6/site-packages/qucumber/nn_states/wavefunction.py in fit(self, data, epochs, pos_batch_size, neg_batch_size, k, lr, input_bases, progbar, starting_epoch, time, callbacks, optimizer, **kwargs)\r\n    508                 train_samples,\r\n    509                 input_bases,\r\n--> 510                 z_samples,\r\n    511             )\r\n    512             callbacks.on_epoch_start(self, ep)\r\n\r\n~/anaconda3/envs/Projeto/lib/python3.6/site-packages/qucumber/nn_states/wavefunction.py in _shuffle_data(self, pos_batch_size, neg_batch_size, num_batches, train_samples, input_bases, z_samples)\r\n    388                 z_samples.shape[0],\r\n    389                 size=(num_batches * neg_batch_size,),\r\n--> 390                 dtype=torch.long,\r\n    391             )\r\n    392             shuffled_neg_samples = z_samples[neg_batch_perm]\r\n\r\nRuntimeError: invalid argument 2: max must be greater than min, but got: min = 0, max = 0 at /pytorch/aten/src/TH/generic/THTensorRandom.cpp:40\r\n\r\nIt seems like torch.randint which goes on line 387 of nn_states/wavefunction.py isn't working properly due to z_samples.shape[0] being equal to zero. I just can't figure out how to fix it. Complex Tutorial is working fine, so I really think it isn't about some outdated package  in my virtual environment. I also tried to change the input data files, and the error just keep going when I didn't change my train_bases file, so I think that the problem is there, but I can't find how to fix it. Can anyone please help ?","closed_by":{"login":"andriusdc","id":49077073,"node_id":"MDQ6VXNlcjQ5MDc3MDcz","avatar_url":"https://avatars.githubusercontent.com/u/49077073?v=4","gravatar_id":"","url":"https://api.github.com/users/andriusdc","html_url":"https://github.com/andriusdc","followers_url":"https://api.github.com/users/andriusdc/followers","following_url":"https://api.github.com/users/andriusdc/following{/other_user}","gists_url":"https://api.github.com/users/andriusdc/gists{/gist_id}","starred_url":"https://api.github.com/users/andriusdc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andriusdc/subscriptions","organizations_url":"https://api.github.com/users/andriusdc/orgs","repos_url":"https://api.github.com/users/andriusdc/repos","events_url":"https://api.github.com/users/andriusdc/events{/privacy}","received_events_url":"https://api.github.com/users/andriusdc/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/82/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/82/timeline","performed_via_github_app":null,"state_reason":"completed"}