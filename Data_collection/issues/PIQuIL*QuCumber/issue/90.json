{"url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/90","repository_url":"https://api.github.com/repos/PIQuIL/QuCumber","labels_url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/90/labels{/name}","comments_url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/90/comments","events_url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/90/events","html_url":"https://github.com/PIQuIL/QuCumber/issues/90","id":468381534,"node_id":"MDU6SXNzdWU0NjgzODE1MzQ=","number":90,"title":"Error with the unitaries dictionary","user":{"login":"andriusdc","id":49077073,"node_id":"MDQ6VXNlcjQ5MDc3MDcz","avatar_url":"https://avatars.githubusercontent.com/u/49077073?v=4","gravatar_id":"","url":"https://api.github.com/users/andriusdc","html_url":"https://github.com/andriusdc","followers_url":"https://api.github.com/users/andriusdc/followers","following_url":"https://api.github.com/users/andriusdc/following{/other_user}","gists_url":"https://api.github.com/users/andriusdc/gists{/gist_id}","starred_url":"https://api.github.com/users/andriusdc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andriusdc/subscriptions","organizations_url":"https://api.github.com/users/andriusdc/orgs","repos_url":"https://api.github.com/users/andriusdc/repos","events_url":"https://api.github.com/users/andriusdc/events{/privacy}","received_events_url":"https://api.github.com/users/andriusdc/received_events","type":"User","site_admin":false},"labels":[{"id":925446089,"node_id":"MDU6TGFiZWw5MjU0NDYwODk=","url":"https://api.github.com/repos/PIQuIL/QuCumber/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2019-07-15T23:43:29Z","updated_at":"2019-07-22T21:53:35Z","closed_at":"2019-07-22T21:53:35Z","author_association":"NONE","active_lock_reason":null,"body":"I am using Qucumber to reconstruct a experimental CHSH protocol wavefunction, but I am having some troubles. The first one happens when my txt with the qubits basis that I measured don't contains any measurement on \"Z Z\" basis ( working with 2-qubits). The error is this one:\r\n```\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-4-58215aa8cfb1> in <module>\r\n     73     lr=lr,\r\n     74     input_bases=train_bases,\r\n---> 75     callbacks=callbacks,\r\n     76 )\r\n     77 \r\n\r\n~/anaconda3/envs/Projeto/lib/python3.6/site-packages/qucumber/nn_states/complex_wavefunction.py in fit(self, data, epochs, pos_batch_size, neg_batch_size, k, lr, input_bases, progbar, starting_epoch, time, callbacks, optimizer, **kwargs)\r\n    280                 callbacks=callbacks,\r\n    281                 optimizer=optimizer,\r\n--> 282                 **kwargs\r\n    283             )\r\n    284 \r\n\r\n~/anaconda3/envs/Projeto/lib/python3.6/site-packages/qucumber/nn_states/wavefunction.py in fit(self, data, epochs, pos_batch_size, neg_batch_size, k, lr, input_bases, progbar, starting_epoch, time, callbacks, optimizer, **kwargs)\r\n    508                 train_samples,\r\n    509                 input_bases,\r\n--> 510                 z_samples,\r\n    511             )\r\n    512             callbacks.on_epoch_start(self, ep)\r\n\r\n~/anaconda3/envs/Projeto/lib/python3.6/site-packages/qucumber/nn_states/wavefunction.py in _shuffle_data(self, pos_batch_size, neg_batch_size, num_batches, train_samples, input_bases, z_samples)\r\n    388                 z_samples.shape[0],\r\n    389                 size=(num_batches * neg_batch_size,),\r\n--> 390                 dtype=torch.long,\r\n    391             )\r\n    392             shuffled_neg_samples = z_samples[neg_batch_perm]\r\n\r\nRuntimeError: invalid argument 2: max must be greater than min, but got: min = 0, max = 0 at /pytorch/aten/src/TH/generic/THTensorRandom.cpp:40\r\n```\r\n\r\n\r\nThe second one, is about the unitaries that I need do apply on the original wavefunction to rotate it. My dictionary is the following:\r\n```\r\nUx = torch.tensor ([[[np.divide(1,np.sqrt(2)),np.divide(1,np.sqrt(2))],[np.divide(1,np.sqrt(2)),-np.divide(1,np.sqrt(2))]], np.zeros((2,2))], dtype=torch.double)\r\nUz = torch.tensor ([np.identity(2),np.zeros((2,2))], dtype=torch.double)\r\nUa = torch.tensor ([np.real(Ry(-45)), np.imag(Ry(-45))], dtype=torch.double)\r\nUb = torch.tensor ([np.real(Ry(45)), np.imag(Ry(45))], dtype=torch.double)\r\n                    \r\nunitary_dict = unitaries.create_dict(Z=Uz,X=Ux, A=Ua, B=Ub)\r\n```\r\nSo I get a error which apparently seems to be because the package don't recognize my unitaries names \"A\" and \"B\". Here is the error:\r\n```\r\n---------------------------------------------------------------------------\r\nKeyError                                  Traceback (most recent call last)\r\n<ipython-input-3-d8490c311792> in <module>\r\n     73     lr=lr,\r\n     74     input_bases=train_bases,\r\n---> 75     callbacks=callbacks,\r\n     76 )\r\n     77 \r\n\r\n~/anaconda3/envs/Projeto/lib/python3.6/site-packages/qucumber/nn_states/complex_wavefunction.py in fit(self, data, epochs, pos_batch_size, neg_batch_size, k, lr, input_bases, progbar, starting_epoch, time, callbacks, optimizer, **kwargs)\r\n    280                 callbacks=callbacks,\r\n    281                 optimizer=optimizer,\r\n--> 282                 **kwargs\r\n    283             )\r\n    284 \r\n\r\n~/anaconda3/envs/Projeto/lib/python3.6/site-packages/qucumber/nn_states/wavefunction.py in fit(self, data, epochs, pos_batch_size, neg_batch_size, k, lr, input_bases, progbar, starting_epoch, time, callbacks, optimizer, **kwargs)\r\n    530                     break\r\n    531 \r\n--> 532             callbacks.on_epoch_end(self, ep)\r\n    533             if self.stop_training:  # check for stop_training signal\r\n    534                 break\r\n\r\n~/anaconda3/envs/Projeto/lib/python3.6/site-packages/qucumber/callbacks/callback_list.py in on_epoch_end(self, rbm, epoch)\r\n     73     def on_epoch_end(self, rbm, epoch):\r\n     74         for cb in self.callbacks:\r\n---> 75             cb.on_epoch_end(rbm, epoch)\r\n     76 \r\n     77     def on_batch_start(self, rbm, epoch, batch):\r\n\r\n~/anaconda3/envs/Projeto/lib/python3.6/site-packages/qucumber/callbacks/metric_evaluator.py in on_epoch_end(self, nn_state, epoch)\r\n    130             metric_vals_for_epoch = {}\r\n    131             for metric_name, metric_fn in self.metrics.items():\r\n--> 132                 val = metric_fn(nn_state, **self.metric_kwargs)\r\n    133                 metric_vals_for_epoch[metric_name] = val\r\n    134 \r\n\r\n~/anaconda3/envs/Projeto/lib/python3.6/site-packages/qucumber/utils/training_statistics.py in KL(nn_state, target_psi, space, bases, **kwargs)\r\n    201         num_bases = len(bases)\r\n    202         for b in range(1, len(bases)):\r\n--> 203             psi_r = rotate_psi(nn_state, bases[b], space, unitary_dict)\r\n    204             target_psi_r = rotate_psi(\r\n    205                 nn_state, bases[b], space, unitary_dict, target_psi\r\n\r\n~/anaconda3/envs/Projeto/lib/python3.6/site-packages/qucumber/utils/training_statistics.py in rotate_psi(nn_state, basis, space, unitaries, psi)\r\n     93             U = torch.tensor([1.0, 0.0], dtype=torch.double, device=nn_state.device)\r\n     94             for ii in range(num_nontrivial_U):\r\n---> 95                 tmp = unitaries[basis[nontrivial_sites[ii]]]\r\n     96                 tmp = tmp[\r\n     97                     :, int(space[x][nontrivial_sites[ii]]), int(v[nontrivial_sites[ii]])\r\n\r\nKeyError: 'A'\r\n```\r\nDoes anyone knows why this happens? Am I doing something wrong ? ","closed_by":{"login":"emerali","id":6067067,"node_id":"MDQ6VXNlcjYwNjcwNjc=","avatar_url":"https://avatars.githubusercontent.com/u/6067067?v=4","gravatar_id":"","url":"https://api.github.com/users/emerali","html_url":"https://github.com/emerali","followers_url":"https://api.github.com/users/emerali/followers","following_url":"https://api.github.com/users/emerali/following{/other_user}","gists_url":"https://api.github.com/users/emerali/gists{/gist_id}","starred_url":"https://api.github.com/users/emerali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emerali/subscriptions","organizations_url":"https://api.github.com/users/emerali/orgs","repos_url":"https://api.github.com/users/emerali/repos","events_url":"https://api.github.com/users/emerali/events{/privacy}","received_events_url":"https://api.github.com/users/emerali/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/90/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/90/timeline","performed_via_github_app":null,"state_reason":"completed"}