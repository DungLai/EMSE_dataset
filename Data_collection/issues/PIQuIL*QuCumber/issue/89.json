{"url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/89","repository_url":"https://api.github.com/repos/PIQuIL/QuCumber","labels_url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/89/labels{/name}","comments_url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/89/comments","events_url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/89/events","html_url":"https://github.com/PIQuIL/QuCumber/issues/89","id":467012028,"node_id":"MDU6SXNzdWU0NjcwMTIwMjg=","number":89,"title":"Bug in function rotate_psi() in utils.training_statistics.py","user":{"login":"sindhura97","id":42525474,"node_id":"MDQ6VXNlcjQyNTI1NDc0","avatar_url":"https://avatars.githubusercontent.com/u/42525474?v=4","gravatar_id":"","url":"https://api.github.com/users/sindhura97","html_url":"https://github.com/sindhura97","followers_url":"https://api.github.com/users/sindhura97/followers","following_url":"https://api.github.com/users/sindhura97/following{/other_user}","gists_url":"https://api.github.com/users/sindhura97/gists{/gist_id}","starred_url":"https://api.github.com/users/sindhura97/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sindhura97/subscriptions","organizations_url":"https://api.github.com/users/sindhura97/orgs","repos_url":"https://api.github.com/users/sindhura97/repos","events_url":"https://api.github.com/users/sindhura97/events{/privacy}","received_events_url":"https://api.github.com/users/sindhura97/received_events","type":"User","site_admin":false},"labels":[{"id":925446089,"node_id":"MDU6TGFiZWw5MjU0NDYwODk=","url":"https://api.github.com/repos/PIQuIL/QuCumber/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1026289014,"node_id":"MDU6TGFiZWwxMDI2Mjg5MDE0","url":"https://api.github.com/repos/PIQuIL/QuCumber/labels/Priority:%20High","name":"Priority: High","color":"ed3d2d","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-07-11T17:14:03Z","updated_at":"2019-07-17T15:28:22Z","closed_at":"2019-07-15T21:47:10Z","author_association":"NONE","active_lock_reason":null,"body":"I got this error trace while trying to train a complex RBM with 8 visible and 8 hidden nodes using measurements from an 8-qubit system.\r\n************************************************************************************************************\r\nTraceback (most recent call last):\r\n\r\n  File \"<ipython-input-2-5c4d04ebf34a>\", line 1, in <module>\r\n    runfile('/home/1ot/Desktop/ground_state_computation/qucu_train_rbm/train_rbm.py', wdir='/home/1ot/Desktop/ground_state_computation/qucu_train_rbm')\r\n\r\n  File \"/home/1ot/anaconda3/envs/venv/lib/python3.7/site-packages/spyder_kernels/customize/spydercustomize.py\", line 827, in runfile\r\n    execfile(filename, namespace)\r\n\r\n  File \"/home/1ot/anaconda3/envs/venv/lib/python3.7/site-packages/spyder_kernels/customize/spydercustomize.py\", line 110, in execfile\r\n    exec(compile(f.read(), filename, 'exec'), namespace)\r\n\r\n  File \"/home/1ot/Desktop/ground_state_computation/qucu_train_rbm/train_rbm.py\", line 58, in <module>\r\n    callbacks=callbacks)\r\n\r\n  File \"/home/1ot/anaconda3/envs/venv/lib//python3.7/site-packages/qucumber/nn_states/complex_wavefunction.py\", line 350, in fit\r\n    **kwargs\r\n\r\n  File \"/home/1ot/anaconda3/envs/venv/lib//python3.7/site-packages/qucumber/nn_states/wavefunction.py\", line 526, in fit\r\n    callbacks.on_epoch_end(self, ep)\r\n\r\n  File \"/home/1ot/anaconda3/envs/venv/lib//python3.7/site-packages/qucumber/callbacks/callback_list.py\", line 71, in on_epoch_end\r\n    cb.on_epoch_end(rbm, epoch)\r\n\r\n  File \"/home/1ot/anaconda3/envs/venv/lib//python3.7/site-packages/qucumber/callbacks/metric_evaluator.py\", line 133, in on_epoch_end\r\n    val = metric_fn(nn_state, **self.metric_kwargs)\r\n\r\n  File \"/home/1ot/anaconda3/envs/venv/lib//python3.7/site-packages/qucumber/utils/training_statistics.py\", line 223, in KL\r\n    psi_r = rotate_psi(nn_state, bases[b], space, unitary_dict)\r\n\r\n  File \"/home/1ot/anaconda3/envs/venv/lib//python3.7/site-packages/qucumber/utils/training_statistics.py\", line 85, in rotate_psi\r\n    psi_r[:, slc] = cplx.matmul(m, U)\r\n\r\n  File \"/home/1ot/anaconda3/envs/venv/lib//python3.7/site-packages/qucumber/utils/cplx.py\", line 108, in matmul\r\n    z[0] = torch.mv(x[0], y[0]) - torch.mv(x[1], y[1])\r\n\r\nRuntimeError: size mismatch, [2 x 2], [8] at /pytorch/aten/src/TH/generic/THTensorMath.cpp:842\r\n\r\n*******************************************************************************************************\r\n\r\nThe function rotate_psi() tries to multiply matrices of incompatibile sizes.\r\nline 81: slc is of length N\r\nline 82: U is of length N\r\nline 83: multiplies m with U \r\n\r\n'm' is a complex 2x2 matrix while 'U' is a complex vector of length N.\r\n\r\nThis method thus threw me an error when I had N=8 i.e; an 8 qubit system.\r\n","closed_by":{"login":"emerali","id":6067067,"node_id":"MDQ6VXNlcjYwNjcwNjc=","avatar_url":"https://avatars.githubusercontent.com/u/6067067?v=4","gravatar_id":"","url":"https://api.github.com/users/emerali","html_url":"https://github.com/emerali","followers_url":"https://api.github.com/users/emerali/followers","following_url":"https://api.github.com/users/emerali/following{/other_user}","gists_url":"https://api.github.com/users/emerali/gists{/gist_id}","starred_url":"https://api.github.com/users/emerali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emerali/subscriptions","organizations_url":"https://api.github.com/users/emerali/orgs","repos_url":"https://api.github.com/users/emerali/repos","events_url":"https://api.github.com/users/emerali/events{/privacy}","received_events_url":"https://api.github.com/users/emerali/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/89/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PIQuIL/QuCumber/issues/89/timeline","performed_via_github_app":null,"state_reason":"completed"}