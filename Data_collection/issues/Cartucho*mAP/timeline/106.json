[{"url":"https://api.github.com/repos/Cartucho/mAP/issues/comments/616272202","html_url":"https://github.com/Cartucho/mAP/issues/106#issuecomment-616272202","issue_url":"https://api.github.com/repos/Cartucho/mAP/issues/106","id":616272202,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNjI3MjIwMg==","user":{"login":"zjZSTU","id":13742735,"node_id":"MDQ6VXNlcjEzNzQyNzM1","avatar_url":"https://avatars.githubusercontent.com/u/13742735?v=4","gravatar_id":"","url":"https://api.github.com/users/zjZSTU","html_url":"https://github.com/zjZSTU","followers_url":"https://api.github.com/users/zjZSTU/followers","following_url":"https://api.github.com/users/zjZSTU/following{/other_user}","gists_url":"https://api.github.com/users/zjZSTU/gists{/gist_id}","starred_url":"https://api.github.com/users/zjZSTU/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zjZSTU/subscriptions","organizations_url":"https://api.github.com/users/zjZSTU/orgs","repos_url":"https://api.github.com/users/zjZSTU/repos","events_url":"https://api.github.com/users/zjZSTU/events{/privacy}","received_events_url":"https://api.github.com/users/zjZSTU/received_events","type":"User","site_admin":false},"created_at":"2020-04-20T02:15:52Z","updated_at":"2020-04-20T02:15:52Z","author_association":"NONE","body":"> Your code is very nice, thank you!\r\n> But in the main.py, you seem to forgot import cv2 ?\r\n\r\nyou are right, but it does exist, the premise is that you have used the corresponding option.\r\n\r\n```\r\n# try to import OpenCV if the user didn't choose the option --no-animation\r\nshow_animation = False\r\nif not args.no_animation:\r\n    try:\r\n        import cv2\r\n\r\n        show_animation = True\r\n    except ImportError:\r\n        print(\"\\\"opencv-python\\\" not found, please install to visualize the results.\")\r\n        args.no_animation = True\r\n\r\n# try to import Matplotlib if the user didn't choose the option --no-plot\r\ndraw_plot = False\r\nif not args.no_plot:\r\n    try:\r\n        import matplotlib.pyplot as plt\r\n\r\n        draw_plot = True\r\n    except ImportError:\r\n        print(\"\\\"matplotlib\\\" not found, please install it to get the resulting plots.\")\r\n        args.no_plot = True\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/Cartucho/mAP/issues/comments/616272202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zjZSTU","id":13742735,"node_id":"MDQ6VXNlcjEzNzQyNzM1","avatar_url":"https://avatars.githubusercontent.com/u/13742735?v=4","gravatar_id":"","url":"https://api.github.com/users/zjZSTU","html_url":"https://github.com/zjZSTU","followers_url":"https://api.github.com/users/zjZSTU/followers","following_url":"https://api.github.com/users/zjZSTU/following{/other_user}","gists_url":"https://api.github.com/users/zjZSTU/gists{/gist_id}","starred_url":"https://api.github.com/users/zjZSTU/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zjZSTU/subscriptions","organizations_url":"https://api.github.com/users/zjZSTU/orgs","repos_url":"https://api.github.com/users/zjZSTU/repos","events_url":"https://api.github.com/users/zjZSTU/events{/privacy}","received_events_url":"https://api.github.com/users/zjZSTU/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/Cartucho/mAP/issues/comments/616336909","html_url":"https://github.com/Cartucho/mAP/issues/106#issuecomment-616336909","issue_url":"https://api.github.com/repos/Cartucho/mAP/issues/106","id":616336909,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNjMzNjkwOQ==","user":{"login":"Cartucho","id":15831541,"node_id":"MDQ6VXNlcjE1ODMxNTQx","avatar_url":"https://avatars.githubusercontent.com/u/15831541?v=4","gravatar_id":"","url":"https://api.github.com/users/Cartucho","html_url":"https://github.com/Cartucho","followers_url":"https://api.github.com/users/Cartucho/followers","following_url":"https://api.github.com/users/Cartucho/following{/other_user}","gists_url":"https://api.github.com/users/Cartucho/gists{/gist_id}","starred_url":"https://api.github.com/users/Cartucho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Cartucho/subscriptions","organizations_url":"https://api.github.com/users/Cartucho/orgs","repos_url":"https://api.github.com/users/Cartucho/repos","events_url":"https://api.github.com/users/Cartucho/events{/privacy}","received_events_url":"https://api.github.com/users/Cartucho/received_events","type":"User","site_admin":false},"created_at":"2020-04-20T06:23:47Z","updated_at":"2020-04-20T06:23:47Z","author_association":"OWNER","body":"yes, I added that feature so that people were not required to have OpenCV in the beginning. The code should still work without OpenCV.","reactions":{"url":"https://api.github.com/repos/Cartucho/mAP/issues/comments/616336909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Cartucho","id":15831541,"node_id":"MDQ6VXNlcjE1ODMxNTQx","avatar_url":"https://avatars.githubusercontent.com/u/15831541?v=4","gravatar_id":"","url":"https://api.github.com/users/Cartucho","html_url":"https://github.com/Cartucho","followers_url":"https://api.github.com/users/Cartucho/followers","following_url":"https://api.github.com/users/Cartucho/following{/other_user}","gists_url":"https://api.github.com/users/Cartucho/gists{/gist_id}","starred_url":"https://api.github.com/users/Cartucho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Cartucho/subscriptions","organizations_url":"https://api.github.com/users/Cartucho/orgs","repos_url":"https://api.github.com/users/Cartucho/repos","events_url":"https://api.github.com/users/Cartucho/events{/privacy}","received_events_url":"https://api.github.com/users/Cartucho/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/Cartucho/mAP/issues/comments/616915670","html_url":"https://github.com/Cartucho/mAP/issues/106#issuecomment-616915670","issue_url":"https://api.github.com/repos/Cartucho/mAP/issues/106","id":616915670,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNjkxNTY3MA==","user":{"login":"zjZSTU","id":13742735,"node_id":"MDQ6VXNlcjEzNzQyNzM1","avatar_url":"https://avatars.githubusercontent.com/u/13742735?v=4","gravatar_id":"","url":"https://api.github.com/users/zjZSTU","html_url":"https://github.com/zjZSTU","followers_url":"https://api.github.com/users/zjZSTU/followers","following_url":"https://api.github.com/users/zjZSTU/following{/other_user}","gists_url":"https://api.github.com/users/zjZSTU/gists{/gist_id}","starred_url":"https://api.github.com/users/zjZSTU/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zjZSTU/subscriptions","organizations_url":"https://api.github.com/users/zjZSTU/orgs","repos_url":"https://api.github.com/users/zjZSTU/repos","events_url":"https://api.github.com/users/zjZSTU/events{/privacy}","received_events_url":"https://api.github.com/users/zjZSTU/received_events","type":"User","site_admin":false},"created_at":"2020-04-21T02:37:11Z","updated_at":"2020-04-21T02:37:11Z","author_association":"NONE","body":"> yes, I added that feature so that people were not required to have OpenCV in the beginning. The code should still work without OpenCV.\r\n\r\nemmmm, it exists , but it also work failed !!!\r\n\r\n```\r\npython main.py\r\n99.18% = cucumber AP \r\n98.72% = eggplant AP \r\n95.30% = mushroom AP \r\nTraceback (most recent call last):\r\n  File \"/home/zj/test/mAP/main.py\", line 743, in <module>\r\n    img = cv2.imread(img_cumulative_path)\r\nNameError: name 'cv2' is not defined\r\nmAP = 97.73%\r\n\r\nProcess finished with exit code 1\r\n```\r\n\r\nbecause the file will save the pr-curve image, so may be it should be imported in the begining\r\n\r\n```\r\n\"\"\"\r\n Draw false negatives\r\n\"\"\"\r\npink = (203,192,255)\r\nfor tmp_file in gt_files:\r\n    ground_truth_data = json.load(open(tmp_file))\r\n    #print(ground_truth_data)\r\n    # get name of corresponding image\r\n    start = TEMP_FILES_PATH + '/'\r\n    img_id = tmp_file[tmp_file.find(start)+len(start):tmp_file.rfind('_ground_truth.json')]\r\n    img_cumulative_path = output_files_path + \"/images/\" + img_id + \".jpg\"\r\n    img = cv2.imread(img_cumulative_path)                    《--------------------- here\r\n    if img is None:\r\n        img_path = IMG_PATH + '/' + img_id + \".jpg\"\r\n        img = cv2.imread(img_path)\r\n    # draw false negatives\r\n    for obj in ground_truth_data:\r\n        if not obj['used']:\r\n            bbgt = [ int(round(float(x))) for x in obj[\"bbox\"].split() ]\r\n            cv2.rectangle(img,(bbgt[0],bbgt[1]),(bbgt[2],bbgt[3]),pink,2)\r\n    cv2.imwrite(img_cumulative_path, img)\r\n```","reactions":{"url":"https://api.github.com/repos/Cartucho/mAP/issues/comments/616915670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zjZSTU","id":13742735,"node_id":"MDQ6VXNlcjEzNzQyNzM1","avatar_url":"https://avatars.githubusercontent.com/u/13742735?v=4","gravatar_id":"","url":"https://api.github.com/users/zjZSTU","html_url":"https://github.com/zjZSTU","followers_url":"https://api.github.com/users/zjZSTU/followers","following_url":"https://api.github.com/users/zjZSTU/following{/other_user}","gists_url":"https://api.github.com/users/zjZSTU/gists{/gist_id}","starred_url":"https://api.github.com/users/zjZSTU/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zjZSTU/subscriptions","organizations_url":"https://api.github.com/users/zjZSTU/orgs","repos_url":"https://api.github.com/users/zjZSTU/repos","events_url":"https://api.github.com/users/zjZSTU/events{/privacy}","received_events_url":"https://api.github.com/users/zjZSTU/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/Cartucho/mAP/issues/comments/616919803","html_url":"https://github.com/Cartucho/mAP/issues/106#issuecomment-616919803","issue_url":"https://api.github.com/repos/Cartucho/mAP/issues/106","id":616919803,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNjkxOTgwMw==","user":{"login":"zjZSTU","id":13742735,"node_id":"MDQ6VXNlcjEzNzQyNzM1","avatar_url":"https://avatars.githubusercontent.com/u/13742735?v=4","gravatar_id":"","url":"https://api.github.com/users/zjZSTU","html_url":"https://github.com/zjZSTU","followers_url":"https://api.github.com/users/zjZSTU/followers","following_url":"https://api.github.com/users/zjZSTU/following{/other_user}","gists_url":"https://api.github.com/users/zjZSTU/gists{/gist_id}","starred_url":"https://api.github.com/users/zjZSTU/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zjZSTU/subscriptions","organizations_url":"https://api.github.com/users/zjZSTU/orgs","repos_url":"https://api.github.com/users/zjZSTU/repos","events_url":"https://api.github.com/users/zjZSTU/events{/privacy}","received_events_url":"https://api.github.com/users/zjZSTU/received_events","type":"User","site_admin":false},"created_at":"2020-04-21T02:51:15Z","updated_at":"2020-04-21T02:51:15Z","author_association":"NONE","body":"> yes, I added that feature so that people were not required to have OpenCV in the beginning. The code should still work without OpenCV.\r\n\r\nwhen import cv2 at begin, there will be another problem:\r\n\r\n```\r\n99.18% = cucumber AP \r\n98.72% = eggplant AP \r\n95.30% = mushroom AP \r\nTraceback (most recent call last):\r\n  File \"/home/zj/test/mAP/main.py\", line 753, in <module>\r\n    cv2.imwrite(img_cumulative_path, img)\r\ncv2.error: OpenCV(4.2.0) ../modules/imgcodecs/src/loadsave.cpp:715: error: (-215:Assertion failed) !_img.empty() in function 'imwrite'\r\n\r\nmAP = 97.73%\r\n\r\nProcess finished with exit code 1\r\n```\r\n\r\nimg path doesn't exist \r\n\r\n```\r\nfor tmp_file in gt_files:\r\n    ground_truth_data = json.load(open(tmp_file))\r\n    #print(ground_truth_data)\r\n    # get name of corresponding image\r\n    start = TEMP_FILES_PATH + '/'\r\n    img_id = tmp_file[tmp_file.find(start)+len(start):tmp_file.rfind('_ground_truth.json')]\r\n    img_cumulative_path = output_files_path + \"/images/\" + img_id + \".jpg\"\r\n    img = cv2.imread(img_cumulative_path)\r\n    if img is None:\r\n        img_path = IMG_PATH + '/' + img_id + \".jpg\"\r\n        img = cv2.imread(img_path)\r\n    # draw false negatives\r\n    for obj in ground_truth_data:\r\n        if not obj['used']:\r\n            bbgt = [ int(round(float(x))) for x in obj[\"bbox\"].split() ]\r\n            cv2.rectangle(img,(bbgt[0],bbgt[1]),(bbgt[2],bbgt[3]),pink,2)\r\n    cv2.imwrite(img_cumulative_path, img)            《------------------------------- here \r\n```","reactions":{"url":"https://api.github.com/repos/Cartucho/mAP/issues/comments/616919803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zjZSTU","id":13742735,"node_id":"MDQ6VXNlcjEzNzQyNzM1","avatar_url":"https://avatars.githubusercontent.com/u/13742735?v=4","gravatar_id":"","url":"https://api.github.com/users/zjZSTU","html_url":"https://github.com/zjZSTU","followers_url":"https://api.github.com/users/zjZSTU/followers","following_url":"https://api.github.com/users/zjZSTU/following{/other_user}","gists_url":"https://api.github.com/users/zjZSTU/gists{/gist_id}","starred_url":"https://api.github.com/users/zjZSTU/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zjZSTU/subscriptions","organizations_url":"https://api.github.com/users/zjZSTU/orgs","repos_url":"https://api.github.com/users/zjZSTU/repos","events_url":"https://api.github.com/users/zjZSTU/events{/privacy}","received_events_url":"https://api.github.com/users/zjZSTU/received_events","type":"User","site_admin":false}},{"id":3256181779,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDMyNTYxODE3Nzk=","url":"https://api.github.com/repos/Cartucho/mAP/issues/events/3256181779","actor":{"login":"Cartucho","id":15831541,"node_id":"MDQ6VXNlcjE1ODMxNTQx","avatar_url":"https://avatars.githubusercontent.com/u/15831541?v=4","gravatar_id":"","url":"https://api.github.com/users/Cartucho","html_url":"https://github.com/Cartucho","followers_url":"https://api.github.com/users/Cartucho/followers","following_url":"https://api.github.com/users/Cartucho/following{/other_user}","gists_url":"https://api.github.com/users/Cartucho/gists{/gist_id}","starred_url":"https://api.github.com/users/Cartucho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Cartucho/subscriptions","organizations_url":"https://api.github.com/users/Cartucho/orgs","repos_url":"https://api.github.com/users/Cartucho/repos","events_url":"https://api.github.com/users/Cartucho/events{/privacy}","received_events_url":"https://api.github.com/users/Cartucho/received_events","type":"User","site_admin":false},"event":"referenced","commit_id":"0412e5f344c857a4e6150a8da6a5faf21fd91e5a","commit_url":"https://api.github.com/repos/Cartucho/mAP/commits/0412e5f344c857a4e6150a8da6a5faf21fd91e5a","created_at":"2020-04-21T13:16:17Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/Cartucho/mAP/issues/comments/617173726","html_url":"https://github.com/Cartucho/mAP/issues/106#issuecomment-617173726","issue_url":"https://api.github.com/repos/Cartucho/mAP/issues/106","id":617173726,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNzE3MzcyNg==","user":{"login":"Cartucho","id":15831541,"node_id":"MDQ6VXNlcjE1ODMxNTQx","avatar_url":"https://avatars.githubusercontent.com/u/15831541?v=4","gravatar_id":"","url":"https://api.github.com/users/Cartucho","html_url":"https://github.com/Cartucho","followers_url":"https://api.github.com/users/Cartucho/followers","following_url":"https://api.github.com/users/Cartucho/following{/other_user}","gists_url":"https://api.github.com/users/Cartucho/gists{/gist_id}","starred_url":"https://api.github.com/users/Cartucho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Cartucho/subscriptions","organizations_url":"https://api.github.com/users/Cartucho/orgs","repos_url":"https://api.github.com/users/Cartucho/repos","events_url":"https://api.github.com/users/Cartucho/events{/privacy}","received_events_url":"https://api.github.com/users/Cartucho/received_events","type":"User","site_admin":false},"created_at":"2020-04-21T13:17:46Z","updated_at":"2020-04-21T13:17:46Z","author_association":"OWNER","body":"I forgot to check if cv2 exists in that part of the code. Now it should work even without cv2 installed.","reactions":{"url":"https://api.github.com/repos/Cartucho/mAP/issues/comments/617173726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Cartucho","id":15831541,"node_id":"MDQ6VXNlcjE1ODMxNTQx","avatar_url":"https://avatars.githubusercontent.com/u/15831541?v=4","gravatar_id":"","url":"https://api.github.com/users/Cartucho","html_url":"https://github.com/Cartucho","followers_url":"https://api.github.com/users/Cartucho/followers","following_url":"https://api.github.com/users/Cartucho/following{/other_user}","gists_url":"https://api.github.com/users/Cartucho/gists{/gist_id}","starred_url":"https://api.github.com/users/Cartucho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Cartucho/subscriptions","organizations_url":"https://api.github.com/users/Cartucho/orgs","repos_url":"https://api.github.com/users/Cartucho/repos","events_url":"https://api.github.com/users/Cartucho/events{/privacy}","received_events_url":"https://api.github.com/users/Cartucho/received_events","type":"User","site_admin":false}}]