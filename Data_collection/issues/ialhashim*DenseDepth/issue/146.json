{"url":"https://api.github.com/repos/ialhashim/DenseDepth/issues/146","repository_url":"https://api.github.com/repos/ialhashim/DenseDepth","labels_url":"https://api.github.com/repos/ialhashim/DenseDepth/issues/146/labels{/name}","comments_url":"https://api.github.com/repos/ialhashim/DenseDepth/issues/146/comments","events_url":"https://api.github.com/repos/ialhashim/DenseDepth/issues/146/events","html_url":"https://github.com/ialhashim/DenseDepth/issues/146","id":700977833,"node_id":"MDU6SXNzdWU3MDA5Nzc4MzM=","number":146,"title":"model depth units","user":{"login":"B0RJA","id":1688261,"node_id":"MDQ6VXNlcjE2ODgyNjE=","avatar_url":"https://avatars.githubusercontent.com/u/1688261?v=4","gravatar_id":"","url":"https://api.github.com/users/B0RJA","html_url":"https://github.com/B0RJA","followers_url":"https://api.github.com/users/B0RJA/followers","following_url":"https://api.github.com/users/B0RJA/following{/other_user}","gists_url":"https://api.github.com/users/B0RJA/gists{/gist_id}","starred_url":"https://api.github.com/users/B0RJA/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/B0RJA/subscriptions","organizations_url":"https://api.github.com/users/B0RJA/orgs","repos_url":"https://api.github.com/users/B0RJA/repos","events_url":"https://api.github.com/users/B0RJA/events{/privacy}","received_events_url":"https://api.github.com/users/B0RJA/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-09-14T10:33:58Z","updated_at":"2020-09-15T16:43:13Z","closed_at":"2020-09-15T16:43:13Z","author_association":"NONE","active_lock_reason":null,"body":"Thank you for sharing your work. I just want to share some keys about depth representation in the nyu data and in the model to check with the author. There are several closed issues on this topic but I can't get the big picture.\r\n\r\n1. The provided depth images in the `nyu2_train` folder are 8-bit gray PNGs ranging from 0 to 256. These digital levels correspond to depths from 0 to 10m.\r\n\r\nTrain images are first loaded, scaled and clipped between o and maxDepth (1000 in the code):\r\n\r\nhttps://github.com/ialhashim/DenseDepth/blob/f376b01820cad7f57222c5a24e40e89577a2c269/data.py#L70-L71\r\n\r\nand then processed using `DepthNorm`:\r\n\r\nhttps://github.com/ialhashim/DenseDepth/blob/a72e70161d6d2afb2978824ae875310696349472/utils.py#L4-L5\r\n\r\nThis function is indeed an inversion which gives more dynamic range to the closest distances and produces a range of values from 1 to 10.\r\n\r\n```\r\nlevel\tm\tscaled\tDepthNorm\r\n25\t1.0\t98\t10.2\r\n50\t2.0\t196\t5.1\r\n102\t4.0\t400\t2.5\r\n255\t10.0\t1000\t1.0\r\n```\r\n\r\n2. The provided depth images in the `nyu2_test` folder are 16-bit gray PNGs. In this case, digital values typically range from 1000 to 10000 levels and correspond to Kinect's measurement range in mm.\r\n\r\nTest images are first divided by 10 to obtain a range between 100 and 1000, that matches the train images range, and then processed using `DepthNorm` to get a final range from 1 to 10.\r\n\r\nhttps://github.com/ialhashim/DenseDepth/blob/f376b01820cad7f57222c5a24e40e89577a2c269/data.py#L105-L106\r\n\r\n3. In the prediction phase, the results of the model are processed using `DepthNorm` to revert the inversion and get depth units between 0 and 1000. Note that calling `DepthNorm` twice leaves the data intact and the function is also its inversion.\r\n\r\nhttps://github.com/ialhashim/DenseDepth/blob/a72e70161d6d2afb2978824ae875310696349472/utils.py#L13-L14\r\n\r\nHere comes my questions.\r\n\r\n1. Is the model really working with depth vales from 0 to 1? My tests indicate that the model works in a range from 1 to 10. What am I missing?\r\n\r\n2. The inversion of values in `DepthNorm` is intentional and represents any benefit compared to a simple scaling?\r\n\r\nI have not commented on it before but I want to clarify this to train the model using my own data.\r\n\r\nThank you for your time.","closed_by":{"login":"ialhashim","id":2434978,"node_id":"MDQ6VXNlcjI0MzQ5Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2434978?v=4","gravatar_id":"","url":"https://api.github.com/users/ialhashim","html_url":"https://github.com/ialhashim","followers_url":"https://api.github.com/users/ialhashim/followers","following_url":"https://api.github.com/users/ialhashim/following{/other_user}","gists_url":"https://api.github.com/users/ialhashim/gists{/gist_id}","starred_url":"https://api.github.com/users/ialhashim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ialhashim/subscriptions","organizations_url":"https://api.github.com/users/ialhashim/orgs","repos_url":"https://api.github.com/users/ialhashim/repos","events_url":"https://api.github.com/users/ialhashim/events{/privacy}","received_events_url":"https://api.github.com/users/ialhashim/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ialhashim/DenseDepth/issues/146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ialhashim/DenseDepth/issues/146/timeline","performed_via_github_app":null,"state_reason":"completed"}