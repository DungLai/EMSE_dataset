{"url":"https://api.github.com/repos/ialhashim/DenseDepth/issues/128","repository_url":"https://api.github.com/repos/ialhashim/DenseDepth","labels_url":"https://api.github.com/repos/ialhashim/DenseDepth/issues/128/labels{/name}","comments_url":"https://api.github.com/repos/ialhashim/DenseDepth/issues/128/comments","events_url":"https://api.github.com/repos/ialhashim/DenseDepth/issues/128/events","html_url":"https://github.com/ialhashim/DenseDepth/issues/128","id":629421009,"node_id":"MDU6SXNzdWU2Mjk0MjEwMDk=","number":128,"title":"Shape issues when using Keras","user":{"login":"ahmeda14960","id":30680697,"node_id":"MDQ6VXNlcjMwNjgwNjk3","avatar_url":"https://avatars.githubusercontent.com/u/30680697?v=4","gravatar_id":"","url":"https://api.github.com/users/ahmeda14960","html_url":"https://github.com/ahmeda14960","followers_url":"https://api.github.com/users/ahmeda14960/followers","following_url":"https://api.github.com/users/ahmeda14960/following{/other_user}","gists_url":"https://api.github.com/users/ahmeda14960/gists{/gist_id}","starred_url":"https://api.github.com/users/ahmeda14960/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ahmeda14960/subscriptions","organizations_url":"https://api.github.com/users/ahmeda14960/orgs","repos_url":"https://api.github.com/users/ahmeda14960/repos","events_url":"https://api.github.com/users/ahmeda14960/events{/privacy}","received_events_url":"https://api.github.com/users/ahmeda14960/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-06-02T18:28:00Z","updated_at":"2020-06-02T18:34:02Z","closed_at":"2020-06-02T18:29:30Z","author_association":"NONE","active_lock_reason":null,"body":"Hello all,\r\n\r\nI am trying to use the dense depth network that was trained on the KITTI dataset for inference on a single image. After looking through test.py, I put together the following script\r\n```\r\nfrom keras.models import Model, load_model\r\nimport numpy as np\r\nfrom PIL import Image\r\nimport matplotlib.pyplot as plt\r\nimport keras.backend as K\r\nimport tensorflow as tf\r\nfrom keras.engine.topology import Layer, InputSpec\r\nimport keras.utils.conv_utils as conv_utils\r\n\r\nexisting = 'kitti.h5'\r\ncustom_objects = {'BilinearUpSampling2D': BilinearUpSampling2D, 'depth_loss_function': None}\r\nmodel = load_model(existing, custom_objects=custom_objects, compile=False)\r\n\r\n# just test on one image\r\n# convert this image to an RGB numpy array\r\nimage_files = ['28.png']\r\ndata = load_images(image_files)\r\n\r\n\r\npred_arr = predict(model, data, 1e-3, 80)\r\n\r\nplt.imshow(pred_arr, cmap='magma_r', vmin=0, vmax=80)\r\nplt.show()\r\n```\r\n\r\nHowever, after running this seemingly innocent script I got the following error:\r\n```bash\r\nTraceback (most recent call last):\r\n  File \"main.py\", line 100, in <module>\r\n    pred_arr = predict(model, data, 1e-3, 80)\r\n  File \"main.py\", line 86, in predict\r\n    predictions = model.predict(images, batch_size=batch_size)\r\n  File \"C:\\Users\\skull\\AppData\\Roaming\\Python\\Python37\\site-packages\\keras\\engine\\training.py\", line 1149, in predict\r\n    x, _, _ = self._standardize_user_data(x)\r\n  File \"C:\\Users\\skull\\AppData\\Roaming\\Python\\Python37\\site-packages\\keras\\engine\\training.py\", line 751, in _standardize_user_data\r\n    exception_prefix='input')\r\n  File \"C:\\Users\\skull\\AppData\\Roaming\\Python\\Python37\\site-packages\\keras\\engine\\training_utils.py\", line 138, in standardize_input_data\r\n    str(data_shape))\r\nValueError: Error when checking input: expected input_1 to have shape (None, None, 3) but got array with shape (320, 1024, 4)\r\n```\r\n\r\nDo you all know why this might be happening? My script above is essentially the same as the test.py file in this repository, so I'm not sure why I'm getting shape issues.","closed_by":{"login":"ialhashim","id":2434978,"node_id":"MDQ6VXNlcjI0MzQ5Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2434978?v=4","gravatar_id":"","url":"https://api.github.com/users/ialhashim","html_url":"https://github.com/ialhashim","followers_url":"https://api.github.com/users/ialhashim/followers","following_url":"https://api.github.com/users/ialhashim/following{/other_user}","gists_url":"https://api.github.com/users/ialhashim/gists{/gist_id}","starred_url":"https://api.github.com/users/ialhashim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ialhashim/subscriptions","organizations_url":"https://api.github.com/users/ialhashim/orgs","repos_url":"https://api.github.com/users/ialhashim/repos","events_url":"https://api.github.com/users/ialhashim/events{/privacy}","received_events_url":"https://api.github.com/users/ialhashim/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ialhashim/DenseDepth/issues/128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ialhashim/DenseDepth/issues/128/timeline","performed_via_github_app":null,"state_reason":"completed"}