{"url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/10","repository_url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn","labels_url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/10/labels{/name}","comments_url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/10/comments","events_url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/10/events","html_url":"https://github.com/AlexMa011/pytorch-polygon-rnn/issues/10","id":383736806,"node_id":"MDU6SXNzdWUzODM3MzY4MDY=","number":10,"title":"Visualizing the net-structure when training the net","user":{"login":"Jacoobr","id":25550204,"node_id":"MDQ6VXNlcjI1NTUwMjA0","avatar_url":"https://avatars.githubusercontent.com/u/25550204?v=4","gravatar_id":"","url":"https://api.github.com/users/Jacoobr","html_url":"https://github.com/Jacoobr","followers_url":"https://api.github.com/users/Jacoobr/followers","following_url":"https://api.github.com/users/Jacoobr/following{/other_user}","gists_url":"https://api.github.com/users/Jacoobr/gists{/gist_id}","starred_url":"https://api.github.com/users/Jacoobr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jacoobr/subscriptions","organizations_url":"https://api.github.com/users/Jacoobr/orgs","repos_url":"https://api.github.com/users/Jacoobr/repos","events_url":"https://api.github.com/users/Jacoobr/events{/privacy}","received_events_url":"https://api.github.com/users/Jacoobr/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-11-23T08:32:19Z","updated_at":"2020-09-06T06:33:25Z","closed_at":"2020-09-06T06:33:25Z","author_association":"NONE","active_lock_reason":null,"body":"Hi @AlexMa011 , Thanks for your great work. Now when i use \"make_dot\" function that from [graphviz](https://github.com/szagoruyko/pytorchviz) package to visulize the net-structure, i got a weird result. \r\n(1.) Firstly, i add two lines code in the [tarin.py](https://github.com/AlexMa011/pytorch-polygon-rnn/blob/master/train.py#L59) script as follow:\r\n\r\n        r = net(x,x1,x2,x3)\r\n        g = make_dot(r, params=dict(net.named_parameters()))\r\n        g.render('graph',view=False)\r\n        result = r.contiguous().view(-1, 28*28+3)\r\n`\r\nWhen i run the script train.py, the program just stopped at this line code: `g = make_dot(r, params=dict(net.named_parameters()))` , then i killed the thread by \"Ctrl+C\" shortcut. I can see\r\na dot format file called \"graph\" , there is the content of \"graph\":\r\n\r\n`digraph {\r\n\tgraph [size=\"12,12\"]\r\n\tnode [align=left fontsize=12 height=0.2 ranksep=0.1 shape=box style=filled]\r\n\t140010753187920 [label=GatherBackward]\r\n\t140010753109776 -> 140010753187920\r\n\t140010753109776 [label=ViewBackward]\r\n\t140010753242896 -> 140010753109776\r\n\t140010753242896 [label=ThAddmmBackward]\r\n\t140010753243024 -> 140010753242896\r\n\t140010753243024 [label=ExpandBackward]\r\n\t140010753190480 -> 140010753243024\r\n\t140010753190480 [label=BroadcastBackward]\r\n\t140010753243280 -> 140010753190480\r\n\t140010753243280 [label=\"module.model1.0.weight\r\n (64, 3, 3, 3)\" fillcolor=lightblue]\r\n\t140010753243152 -> 140010753190480\r\n\t140010753243152 [label=\"module.model1.0.bias\r\n (64)\" fillcolor=lightblue]\r\n\t140010753243344 -> 140010753190480\r\n\t140010753243344 [label=\"module.model1.1.weight\r\n (64)\" fillcolor=lightblue]\r\n\t140010753243408 -> 140010753190480\r\n\t140010753243408 [label=\"module.model1.1.bias\r\n (64)\" fillcolor=lightblue]\r\n\t140010753243472 -> 140010753190480\r\n\t140010753243472 [label=\"module.model1.3.weight\r\n (64, 64, 3, 3)\" fillcolor=lightblue]\r\n\t140010753243536 -> 140010753190480\r\n\t140010753243536 [label=\"module.model1.3.bias\r\n (64)\" fillcolor=lightblue]\r\n\t140010753243600 -> 140010753190480\r\n\t140010753243600 [label=\"module.model1.4.weight\r\n (64)\" fillcolor=lightblue]\r\n\t140010753243664 -> 140010753190480\r\n\t140010753243664 [label=\"module.model1.4.bias\r\n (64)\" fillcolor=lightblue]\r\n\t140010753243728 -> 140010753190480\r\n\t140010753243728 [label=\"module.model1.7.weight\r\n (128, 64, 3, 3)\" fillcolor=lightblue]\r\n\t140010753243792 -> 140010753190480\r\n\t140010753243792 [label=\"module.model1.7.bias\r\n (128)\" fillcolor=lightblue]\r\n\t140010753243856 -> 140010753190480\r\n\t140010753243856 [label=\"module.model1.8.weight\r\n (128)\" fillcolor=lightblue]\r\n\t140010753243920 -> 140010753190480\r\n\t140010753243920 [label=\"module.model1.8.bias\r\n (128)\" fillcolor=lightblue]\r\n\t140010753243984 -> 140010753190480\r\n\t140010753243984 [label=\"module.model1.10.weight\r\n (128, 128, 3, 3)\" fillcolor=lightblue]\r\n\t140010753244048 -> 140010753190480\r\n\t140010753244048 [label=\"module.model1.10.bias\r\n (128)\" fillcolor=lightblue]\r\n\t140010753244112 -> 140010753190480\r\n\t140010753244112 [label=\"module.model1.11.weight\r\n (128)\" fillcolor=lightblue]\r\n\t140010753244176 -> 140010753190480\r\n\t140010753244176 [label=\"module.model1.11.bias\r\n (128)\" fillcolor=lightblue]\r\n\t140010753244240 -> 140010753190480\r\n\t140010753244240 [label=\"module.model2.0.weight\r\n (256, 128, 3, 3)\" fillcolor=lightblue]\r\n\t140010753244304 -> 140010753190480\r\n\t140010753244304 [label=\"module.model2.0.bias\r\n (256)\" fillcolor=lightblue]\r\n\t140010753244368 -> 140010753190480\r\n\t140010753244368 [label=\"module.model2.1.weight\r\n (256)\" fillcolor=lightblue]\r\n\t140010753244432 -> 140010753190480\r\n\t140010753244432 [label=\"module.model2.1.bias\r\n (256)\" fillcolor=lightblue]\r\n\t140010753244496 -> 140010753190480\r\n\t140010753244496 [label=\"module.model2.3.weight\r\n (256, 256, 3, 3)\" fillcolor=lightblue]\r\n\t140010753244560 -> 140010753190480\r\n\t140010753244560 [label=\"module.model2.3.bias\r\n (256)\" fillcolor=lightblue]\r\n\t140010753244624 -> 140010753190480\r\n\t140010753244624 [label=\"module.model2.4.weight\r\n (256)\" fillcolor=lightblue]\r\n\t140010753244688 -> 140010753190480\r\n\t140010753244688 [label=\"module.model2.4.bias\r\n (256)\" fillcolor=lightblue]\r\n\t140010753244752 -> 140010753190480\r\n\t140010753244752 [label=\"module.model2.6.weight\r\n (256, 256, 3, 3)\" fillcolor=lightblue]\r\n\t140010753244816 -> 140010753190480\r\n\t140010753244816 [label=\"module.model2.6.bias\r\n (256)\" fillcolor=lightblue]\r\n\t140010753244880 -> 140010753190480\r\n\t140010753244880 [label=\"module.model2.7.weight\r\n (256)\" fillcolor=lightblue]\r\n\t140010753244944 -> 140010753190480\r\n\t140010753244944 [label=\"module.model2.7.bias\r\n (256)\" fillcolor=lightblue]\r\n\t140010753245008 -> 140010753190480\r\n\t140010753245008 [label=\"module.model3.0.weight\r\n (512, 256, 3, 3)\" fillcolor=lightblue]\r\n\t140010753245072 -> 140010753190480\r\n\t140010753245072 [label=\"module.model3.0.bias\r\n (512)\" fillcolor=lightblue]\r\n\t140010753245136 -> 140010753190480\r\n\t140010753245136 [label=\"module.model3.1.weight\r\n (512)\" fillcolor=lightblue]\r\n\t140010753286224 -> 140010753190480\r\n\t140010753286224 [label=\"module.model3.1.bias\r\n (512)\" fillcolor=lightblue]\r\n\t140010753286288 -> 140010753190480\r\n\t140010753286288 [label=\"module.model3.3.weight\r\n (512, 512, 3, 3)\" fillcolor=lightblue]\r\n\t140010753286352 -> 140010753190480\r\n\t140010753286352 [label=\"module.model3.3.bias\r\n (512)\" fillcolor=lightblue]\r\n\t140010753286416 -> 140010753190480\r\n\t140010753286416 [label=\"module.model3.4.weight\r\n (512)\" fillcolor=lightblue]\r\n\t140010753286480 -> 140010753190480\r\n\t140010753286480 [label=\"module.model3.4.bias\r\n (512)\" fillcolor=lightblue]\r\n\t140010753286544 -> 140010753190480\r\n\t140010753286544 [label=\"module.model3.6.weight\r\n (512, 512, 3, 3)\" fillcolor=lightblue]\r\n\t140010753286608 -> 140010753190480\r\n\t140010753286608 [label=\"module.model3.6.bias\r\n (512)\" fillcolor=lightblue]\r\n\t140010753286672 -> 140010753190480\r\n\t140010753286672 [label=\"module.model3.7.weight\r\n (512)\" fillcolor=lightblue]\r\n\t140010753286736 -> 140010753190480\r\n\t140010753286736 [label=\"module.model3.7.bias\r\n (512)\" fillcolor=lightblue]\r\n\t140010753286800 -> 140010753190480\r\n\t140010753286800 [label=\"module.model4.1.weight\r\n (512, 512, 3, 3)\" fillcolor=lightblue]\r\n\t140010753286864 -> 140010753190480\r\n\t140010753286864 [label=\"module.model4.1.bias\r\n (512)\" fillcolor=lightblue]\r\n\t140010753286928 -> 140010753190480\r\n\t140010753286928 [label=\"module.model4.2.weight\r\n (512)\" fillcolor=lightblue]\r\n\t140010753286992 -> 140010753190480\r\n\t140010753286992 [label=\"module.model4.2.bias\r\n (512)\" fillcolor=lightblue]\r\n\t140010753287056 -> 140010753190480\r\n\t140010753287056 [label=\"module.model4.4.weight\r\n (512, 512, 3, 3)\" fillcolor=lightblue]\r\n\t140010753287120 -> 140010753190480\r\n\t140010753287120 [label=\"module.model4.4.bias\r\n (512)\" fillcolor=lightblue]\r\n\t140010753287184 -> 140010753190480\r\n\t140010753287184 [label=\"module.model4.5.weight\r\n (512)\" fillcolor=lightblue]\r\n\t140010753287248 -> 140010753190480\r\n\t140010753287248 [label=\"module.model4.5.bias\r\n (512)\" fillcolor=lightblue]\r\n\t140010753287312 -> 140010753190480\r\n\t140010753287312 [label=\"module.model4.7.weight\r\n (512, 512, 3, 3)\" fillcolor=lightblue]\r\n\t140010753287376 -> 140010753190480\r\n\t140010753287376 [label=\"module.model4.7.bias\r\n (512)\" fillcolor=lightblue]\r\n\t140010753287440 -> 140010753190480\r\n\t140010753287440 [label=\"module.model4.8.weight\r\n (512)\" fillcolor=lightblue]\r\n\t140010753287504 -> 140010753190480\r\n\t140010753287504 [label=\"module.model4.8.bias\r\n (512)\" fillcolor=lightblue]\r\n\t140010753287568 -> 140010753190480\r\n\t140010753287568 [label=\"module.convlayer1.0.weight\r\n (128, 128, 3, 3)\" fillcolor=lightblue]\r\n\t140010753287632 -> 140010753190480\r\n\t140010753287632 [label=\"module.convlayer1.0.bias\r\n (128)\" fillcolor=lightblue]\r\n\t140010753287696 -> 140010753190480\r\n\t140010753287696 [label=\"module.convlayer1.2.weight\r\n (128)\" fillcolor=lightblue]\r\n\t140010753287760 -> 140010753190480\r\n\t140010753287760 [label=\"module.convlayer1.2.bias\r\n (128)\" fillcolor=lightblue]\r\n\t140010753287824 -> 140010753190480\r\n\t140010753287824 [label=\"module.convlayer2.0.weight\r\n (128, 256, 3, 3)\" fillcolor=lightblue]\r\n\t140010753287888 -> 140010753190480\r\n\t140010753287888 [label=\"module.convlayer2.0.bias\r\n (128)\" fillcolor=lightblue]\r\n\t140010753287952 -> 140010753190480\r\n\t140010753287952 [label=\"module.convlayer2.2.weight\r\n (128)\" fillcolor=lightblue]\r\n\t140010753288016 -> 140010753190480\r\n\t140010753288016 [label=\"module.convlayer2.2.bias\r\n (128)\" fillcolor=lightblue]\r\n\t140010753288080 -> 140010753190480\r\n\t140010753288080 [label=\"module.convlayer3.0.weight\r\n (128, 512, 3, 3)\" fillcolor=lightblue]\r\n\t140010753288144 -> 140010753190480\r\n\t140010753288144 [label=\"module.convlayer3.0.bias\r\n (128)\" fillcolor=lightblue]\r\n\t140010753288208 -> 140010753190480\r\n\t140010753288208 [label=\"module.convlayer3.2.weight\r\n (128)\" fillcolor=lightblue]\r\n\t140010753288272 -> 140010753190480\r\n\t140010753288272 [label=\"module.convlayer3.2.bias\r\n (128)\" fillcolor=lightblue]\r\n\t140010753288336 -> 140010753190480\r\n\t140010753288336 [label=\"module.convlayer4.0.weight\r\n (128, 512, 3, 3)\" fillcolor=lightblue]\r\n\t140010753288400 -> 140010753190480\r\n\t140010753288400 [label=\"module.convlayer4.0.bias\r\n (128)\" fillcolor=lightblue]\r\n\t140010753288464 -> 140010753190480\r\n\t140010753288464 [label=\"module.convlayer4.2.weight\r\n (128)\" fillcolor=lightblue]\r\n\t140010753288528 -> 140010753190480\r\n\t140010753288528 [label=\"module.convlayer4.2.bias\r\n (128)\" fillcolor=lightblue]\r\n\t140010753288592 -> 140010753190480\r\n\t140010753288592 [label=\"module.convlayer5.0.weight\r\n (128, 512, 3, 3)\" fillcolor=lightblue]\r\n\t140010753288656 -> 140010753190480\r\n\t140010753288656 [label=\"module.convlayer5.0.bias\r\n (128)\" fillcolor=lightblue]\r\n\t140010753288720 -> 140010753190480\r\n\t140010753288720 [label=\"module.convlayer5.2.weight\r\n (128)\" fillcolor=lightblue]\r\n\t140010753288784 -> 140010753190480\r\n\t140010753288784 [label=\"module.convlayer5.2.bias\r\n (128)\" fillcolor=lightblue]\r\n\t140010753288848 -> 140010753190480\r\n\t140010753288848 [label=\"module.linear2.weight\r\n (787, 1568)\" fillcolor=lightblue]\r\n\t140010753288912 -> 140010753190480\r\n\t140010753288912 [label=\"module.linear2.bias\r\n (787)\" fillcolor=lightblue]\r\n\t140010753288976 -> 140010753190480\r\n\t140010753288976 [label=\"module.lstmlayer.weight_ih_l0\r\n (6272, 7846)\" fillcolor=lightblue]\r\n\t140010753289040 -> 140010753190480\r\n\t140010753289040 [label=\"module.lstmlayer.weight_hh_l0\r\n (6272, 1568)\" fillcolor=lightblue]\r\n\t140010753289104 -> 140010753190480\r\n\t140010753289104 [label=\"module.lstmlayer.bias_ih_l0\r\n (6272)\" fillcolor=lightblue]\r\n\t140010753289168 -> 140010753190480\r\n\t140010753289168 [label=\"module.lstmlayer.bias_hh_l0\r\n (6272)\" fillcolor=lightblue]\r\n\t140010753289232 -> 140010753190480\r\n......\r\n}`\r\nFinally, I use the command `dot -Tpdf graph -o graph_.pdf` to convert the dot format to pdf for easily visual. \r\nI got a weird result:\r\n![issue](https://user-images.githubusercontent.com/25550204/48933925-f7d7ee80-ef3c-11e8-8762-46d542cc6674.PNG)\r\nI don't know what's wrong with my code and hope for your appreciative help or your suggestions for visulizing the net structure of polygon-rnn. Thank U again~.","closed_by":{"login":"AlexMa011","id":12776818,"node_id":"MDQ6VXNlcjEyNzc2ODE4","avatar_url":"https://avatars.githubusercontent.com/u/12776818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexMa011","html_url":"https://github.com/AlexMa011","followers_url":"https://api.github.com/users/AlexMa011/followers","following_url":"https://api.github.com/users/AlexMa011/following{/other_user}","gists_url":"https://api.github.com/users/AlexMa011/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexMa011/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexMa011/subscriptions","organizations_url":"https://api.github.com/users/AlexMa011/orgs","repos_url":"https://api.github.com/users/AlexMa011/repos","events_url":"https://api.github.com/users/AlexMa011/events{/privacy}","received_events_url":"https://api.github.com/users/AlexMa011/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/10/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/10/timeline","performed_via_github_app":null,"state_reason":"completed"}