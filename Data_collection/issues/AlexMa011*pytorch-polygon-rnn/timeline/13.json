[{"url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/comments/683536860","html_url":"https://github.com/AlexMa011/pytorch-polygon-rnn/issues/13#issuecomment-683536860","issue_url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/13","id":683536860,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MzUzNjg2MA==","user":{"login":"ethanjyx","id":3280308,"node_id":"MDQ6VXNlcjMyODAzMDg=","avatar_url":"https://avatars.githubusercontent.com/u/3280308?v=4","gravatar_id":"","url":"https://api.github.com/users/ethanjyx","html_url":"https://github.com/ethanjyx","followers_url":"https://api.github.com/users/ethanjyx/followers","following_url":"https://api.github.com/users/ethanjyx/following{/other_user}","gists_url":"https://api.github.com/users/ethanjyx/gists{/gist_id}","starred_url":"https://api.github.com/users/ethanjyx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ethanjyx/subscriptions","organizations_url":"https://api.github.com/users/ethanjyx/orgs","repos_url":"https://api.github.com/users/ethanjyx/repos","events_url":"https://api.github.com/users/ethanjyx/events{/privacy}","received_events_url":"https://api.github.com/users/ethanjyx/received_events","type":"User","site_admin":false},"created_at":"2020-08-31T04:01:53Z","updated_at":"2020-08-31T04:01:53Z","author_association":"NONE","body":"hi @qTipTip , i'm having the same question as you, hopefully @AlexMa011 can answer here.\r\n\r\nSpecifically, I have the following questions, \r\n1. for `label_array = np.zeros([self.length, 28 * 28 + 3])`, why do we need 28 * 28 + 3? what is the 3 slots for?\r\n2. \r\nwhat is this `kkk` doing in this block? https://github.com/AlexMa011/pytorch-polygon-rnn/blob/master/data.py#L45-L57\r\n\r\nthanks in advance!","reactions":{"url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/comments/683536860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ethanjyx","id":3280308,"node_id":"MDQ6VXNlcjMyODAzMDg=","avatar_url":"https://avatars.githubusercontent.com/u/3280308?v=4","gravatar_id":"","url":"https://api.github.com/users/ethanjyx","html_url":"https://github.com/ethanjyx","followers_url":"https://api.github.com/users/ethanjyx/followers","following_url":"https://api.github.com/users/ethanjyx/following{/other_user}","gists_url":"https://api.github.com/users/ethanjyx/gists{/gist_id}","starred_url":"https://api.github.com/users/ethanjyx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ethanjyx/subscriptions","organizations_url":"https://api.github.com/users/ethanjyx/orgs","repos_url":"https://api.github.com/users/ethanjyx/repos","events_url":"https://api.github.com/users/ethanjyx/events{/privacy}","received_events_url":"https://api.github.com/users/ethanjyx/received_events","type":"User","site_admin":false}},{"id":3708078356,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzcwODA3ODM1Ng==","url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/events/3708078356","actor":{"login":"qTipTip","id":11932512,"node_id":"MDQ6VXNlcjExOTMyNTEy","avatar_url":"https://avatars.githubusercontent.com/u/11932512?v=4","gravatar_id":"","url":"https://api.github.com/users/qTipTip","html_url":"https://github.com/qTipTip","followers_url":"https://api.github.com/users/qTipTip/followers","following_url":"https://api.github.com/users/qTipTip/following{/other_user}","gists_url":"https://api.github.com/users/qTipTip/gists{/gist_id}","starred_url":"https://api.github.com/users/qTipTip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qTipTip/subscriptions","organizations_url":"https://api.github.com/users/qTipTip/orgs","repos_url":"https://api.github.com/users/qTipTip/repos","events_url":"https://api.github.com/users/qTipTip/events{/privacy}","received_events_url":"https://api.github.com/users/qTipTip/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-08-31T04:01:53Z","performed_via_github_app":null},{"id":3708078357,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM3MDgwNzgzNTc=","url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/events/3708078357","actor":{"login":"qTipTip","id":11932512,"node_id":"MDQ6VXNlcjExOTMyNTEy","avatar_url":"https://avatars.githubusercontent.com/u/11932512?v=4","gravatar_id":"","url":"https://api.github.com/users/qTipTip","html_url":"https://github.com/qTipTip","followers_url":"https://api.github.com/users/qTipTip/followers","following_url":"https://api.github.com/users/qTipTip/following{/other_user}","gists_url":"https://api.github.com/users/qTipTip/gists{/gist_id}","starred_url":"https://api.github.com/users/qTipTip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qTipTip/subscriptions","organizations_url":"https://api.github.com/users/qTipTip/orgs","repos_url":"https://api.github.com/users/qTipTip/repos","events_url":"https://api.github.com/users/qTipTip/events{/privacy}","received_events_url":"https://api.github.com/users/qTipTip/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-08-31T04:01:53Z","performed_via_github_app":null},{"id":3708078359,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzcwODA3ODM1OQ==","url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/events/3708078359","actor":{"login":"AlexMa011","id":12776818,"node_id":"MDQ6VXNlcjEyNzc2ODE4","avatar_url":"https://avatars.githubusercontent.com/u/12776818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexMa011","html_url":"https://github.com/AlexMa011","followers_url":"https://api.github.com/users/AlexMa011/followers","following_url":"https://api.github.com/users/AlexMa011/following{/other_user}","gists_url":"https://api.github.com/users/AlexMa011/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexMa011/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexMa011/subscriptions","organizations_url":"https://api.github.com/users/AlexMa011/orgs","repos_url":"https://api.github.com/users/AlexMa011/repos","events_url":"https://api.github.com/users/AlexMa011/events{/privacy}","received_events_url":"https://api.github.com/users/AlexMa011/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-08-31T04:01:54Z","performed_via_github_app":null},{"id":3708078361,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM3MDgwNzgzNjE=","url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/events/3708078361","actor":{"login":"AlexMa011","id":12776818,"node_id":"MDQ6VXNlcjEyNzc2ODE4","avatar_url":"https://avatars.githubusercontent.com/u/12776818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexMa011","html_url":"https://github.com/AlexMa011","followers_url":"https://api.github.com/users/AlexMa011/followers","following_url":"https://api.github.com/users/AlexMa011/following{/other_user}","gists_url":"https://api.github.com/users/AlexMa011/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexMa011/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexMa011/subscriptions","organizations_url":"https://api.github.com/users/AlexMa011/orgs","repos_url":"https://api.github.com/users/AlexMa011/repos","events_url":"https://api.github.com/users/AlexMa011/events{/privacy}","received_events_url":"https://api.github.com/users/AlexMa011/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-08-31T04:01:54Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/comments/687709560","html_url":"https://github.com/AlexMa011/pytorch-polygon-rnn/issues/13#issuecomment-687709560","issue_url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/13","id":687709560,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NzcwOTU2MA==","user":{"login":"AlexMa011","id":12776818,"node_id":"MDQ6VXNlcjEyNzc2ODE4","avatar_url":"https://avatars.githubusercontent.com/u/12776818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexMa011","html_url":"https://github.com/AlexMa011","followers_url":"https://api.github.com/users/AlexMa011/followers","following_url":"https://api.github.com/users/AlexMa011/following{/other_user}","gists_url":"https://api.github.com/users/AlexMa011/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexMa011/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexMa011/subscriptions","organizations_url":"https://api.github.com/users/AlexMa011/orgs","repos_url":"https://api.github.com/users/AlexMa011/repos","events_url":"https://api.github.com/users/AlexMa011/events{/privacy}","received_events_url":"https://api.github.com/users/AlexMa011/received_events","type":"User","site_admin":false},"created_at":"2020-09-06T06:31:21Z","updated_at":"2020-09-06T06:31:21Z","author_association":"OWNER","body":"1. Sorry to reply so late, kind of busy in the last 2 years. The 3 more slots are for two starting vertices and one stop vertices.\r\n2. The filling vector process has two types: \r\n    a. the actual number of vertices is less than the fixed vector length: the vertices are repeated to avoid lots of zeros.\r\n    b. the actual number of vertices is larger than the fixed vector length: the vertices are proportionally selected to satisfy the fixed length.","reactions":{"url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/comments/687709560/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AlexMa011","id":12776818,"node_id":"MDQ6VXNlcjEyNzc2ODE4","avatar_url":"https://avatars.githubusercontent.com/u/12776818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexMa011","html_url":"https://github.com/AlexMa011","followers_url":"https://api.github.com/users/AlexMa011/followers","following_url":"https://api.github.com/users/AlexMa011/following{/other_user}","gists_url":"https://api.github.com/users/AlexMa011/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexMa011/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexMa011/subscriptions","organizations_url":"https://api.github.com/users/AlexMa011/orgs","repos_url":"https://api.github.com/users/AlexMa011/repos","events_url":"https://api.github.com/users/AlexMa011/events{/privacy}","received_events_url":"https://api.github.com/users/AlexMa011/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/comments/692059519","html_url":"https://github.com/AlexMa011/pytorch-polygon-rnn/issues/13#issuecomment-692059519","issue_url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/13","id":692059519,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MjA1OTUxOQ==","user":{"login":"qTipTip","id":11932512,"node_id":"MDQ6VXNlcjExOTMyNTEy","avatar_url":"https://avatars.githubusercontent.com/u/11932512?v=4","gravatar_id":"","url":"https://api.github.com/users/qTipTip","html_url":"https://github.com/qTipTip","followers_url":"https://api.github.com/users/qTipTip/followers","following_url":"https://api.github.com/users/qTipTip/following{/other_user}","gists_url":"https://api.github.com/users/qTipTip/gists{/gist_id}","starred_url":"https://api.github.com/users/qTipTip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qTipTip/subscriptions","organizations_url":"https://api.github.com/users/qTipTip/orgs","repos_url":"https://api.github.com/users/qTipTip/repos","events_url":"https://api.github.com/users/qTipTip/events{/privacy}","received_events_url":"https://api.github.com/users/qTipTip/received_events","type":"User","site_admin":false},"created_at":"2020-09-14T13:39:43Z","updated_at":"2020-09-14T13:39:43Z","author_association":"NONE","body":"I ended up writing it like this @ethanjyx, in case you are still interested. Been a year or so since I last looked at this, but I think this is what you want. Revisiting research code is always difficult 😄 \r\n\r\n```python\r\ndef process_polygon(polygon, polygon_resolution=28, cropped_image_size=224, max_polygon_length=60):\r\n    \"\"\"\r\n    We superimpose a grid of size polygon_resolution*polygon_resolution over the cropped image.\r\n    We then one-hot-encode the polygon by creating a polygon_resolution*polygon_resolution array of ints,\r\n    where a 0 tells us that there is no vertex present, and a 1 tells us there is a vertex present.\r\n    We need the output to be of a fixed size, so we make sure that every output is of size\r\n    (max_polygon_length, polygon_resolution**2 + additional_info_if_needed).\r\n    \"\"\"\r\n    assert cropped_image_size % polygon_resolution == 0\r\n\r\n    grid_size = cropped_image_size // polygon_resolution\r\n\r\n    # we add two to the length, so we can slice for previous, and previous previous vertices, the first vertex is then\r\n    # stored in one_hot_polygon[2].\r\n    one_hot_polygon = torch.zeros((max_polygon_length + 2, polygon_resolution ** 2 + 1))\r\n    one_hot_ordering = np.zeros((max_polygon_length + 2), dtype=np.int)\r\n\r\n    # if `polygon` contains more vertices than max_polygon_length, then we subsample the polygon.\r\n    if len(polygon) > max_polygon_length:\r\n        scale = len(polygon) / max_polygon_length\r\n        subsample_selection = (np.arange(0, max_polygon_length) * scale).astype(np.int)\r\n        polygon = polygon[subsample_selection]\r\n\r\n    # Fill in the original polygon vertices.\r\n    for i in range(len(polygon)):\r\n        vertex = polygon[i]\r\n        x, y = vertex[0] // grid_size, vertex[1] // grid_size\r\n        vertex_index = np.ravel_multi_index((x, y), dims=(polygon_resolution, polygon_resolution))\r\n        one_hot_polygon[i + 2, vertex_index] = 1\r\n        one_hot_ordering[i + 2] = vertex_index\r\n\r\n    # set end-of-polygon bit\r\n    one_hot_polygon[i + 2, polygon_resolution ** 2] = 1\r\n    one_hot_ordering[i + 2] = polygon_resolution ** 2\r\n\r\n    # If the polygon is shorter than max_polygon_length, then we pad with the ground truth indices with -1\r\n    for i in range(len(polygon), max_polygon_length):\r\n        one_hot_ordering[i + 2] = -1\r\n\r\n    return one_hot_polygon, torch.as_tensor(one_hot_ordering[2:])\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/comments/692059519/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"qTipTip","id":11932512,"node_id":"MDQ6VXNlcjExOTMyNTEy","avatar_url":"https://avatars.githubusercontent.com/u/11932512?v=4","gravatar_id":"","url":"https://api.github.com/users/qTipTip","html_url":"https://github.com/qTipTip","followers_url":"https://api.github.com/users/qTipTip/followers","following_url":"https://api.github.com/users/qTipTip/following{/other_user}","gists_url":"https://api.github.com/users/qTipTip/gists{/gist_id}","starred_url":"https://api.github.com/users/qTipTip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qTipTip/subscriptions","organizations_url":"https://api.github.com/users/qTipTip/orgs","repos_url":"https://api.github.com/users/qTipTip/repos","events_url":"https://api.github.com/users/qTipTip/events{/privacy}","received_events_url":"https://api.github.com/users/qTipTip/received_events","type":"User","site_admin":false}},{"id":3763394186,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mzc2MzM5NDE4Ng==","url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/events/3763394186","actor":{"login":"ethanjyx","id":3280308,"node_id":"MDQ6VXNlcjMyODAzMDg=","avatar_url":"https://avatars.githubusercontent.com/u/3280308?v=4","gravatar_id":"","url":"https://api.github.com/users/ethanjyx","html_url":"https://github.com/ethanjyx","followers_url":"https://api.github.com/users/ethanjyx/followers","following_url":"https://api.github.com/users/ethanjyx/following{/other_user}","gists_url":"https://api.github.com/users/ethanjyx/gists{/gist_id}","starred_url":"https://api.github.com/users/ethanjyx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ethanjyx/subscriptions","organizations_url":"https://api.github.com/users/ethanjyx/orgs","repos_url":"https://api.github.com/users/ethanjyx/repos","events_url":"https://api.github.com/users/ethanjyx/events{/privacy}","received_events_url":"https://api.github.com/users/ethanjyx/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-09-14T13:39:44Z","performed_via_github_app":null},{"id":3763394191,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM3NjMzOTQxOTE=","url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/events/3763394191","actor":{"login":"ethanjyx","id":3280308,"node_id":"MDQ6VXNlcjMyODAzMDg=","avatar_url":"https://avatars.githubusercontent.com/u/3280308?v=4","gravatar_id":"","url":"https://api.github.com/users/ethanjyx","html_url":"https://github.com/ethanjyx","followers_url":"https://api.github.com/users/ethanjyx/followers","following_url":"https://api.github.com/users/ethanjyx/following{/other_user}","gists_url":"https://api.github.com/users/ethanjyx/gists{/gist_id}","starred_url":"https://api.github.com/users/ethanjyx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ethanjyx/subscriptions","organizations_url":"https://api.github.com/users/ethanjyx/orgs","repos_url":"https://api.github.com/users/ethanjyx/repos","events_url":"https://api.github.com/users/ethanjyx/events{/privacy}","received_events_url":"https://api.github.com/users/ethanjyx/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-09-14T13:39:44Z","performed_via_github_app":null},{"id":4757809498,"node_id":"MDExOkNsb3NlZEV2ZW50NDc1NzgwOTQ5OA==","url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/events/4757809498","actor":{"login":"AlexMa011","id":12776818,"node_id":"MDQ6VXNlcjEyNzc2ODE4","avatar_url":"https://avatars.githubusercontent.com/u/12776818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexMa011","html_url":"https://github.com/AlexMa011","followers_url":"https://api.github.com/users/AlexMa011/followers","following_url":"https://api.github.com/users/AlexMa011/following{/other_user}","gists_url":"https://api.github.com/users/AlexMa011/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexMa011/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexMa011/subscriptions","organizations_url":"https://api.github.com/users/AlexMa011/orgs","repos_url":"https://api.github.com/users/AlexMa011/repos","events_url":"https://api.github.com/users/AlexMa011/events{/privacy}","received_events_url":"https://api.github.com/users/AlexMa011/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-05-18T02:09:13Z","state_reason":null,"performed_via_github_app":null},{"id":4757809737,"node_id":"MDExOlBpbm5lZEV2ZW50NDc1NzgwOTczNw==","url":"https://api.github.com/repos/AlexMa011/pytorch-polygon-rnn/issues/events/4757809737","actor":{"login":"AlexMa011","id":12776818,"node_id":"MDQ6VXNlcjEyNzc2ODE4","avatar_url":"https://avatars.githubusercontent.com/u/12776818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexMa011","html_url":"https://github.com/AlexMa011","followers_url":"https://api.github.com/users/AlexMa011/followers","following_url":"https://api.github.com/users/AlexMa011/following{/other_user}","gists_url":"https://api.github.com/users/AlexMa011/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexMa011/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexMa011/subscriptions","organizations_url":"https://api.github.com/users/AlexMa011/orgs","repos_url":"https://api.github.com/users/AlexMa011/repos","events_url":"https://api.github.com/users/AlexMa011/events{/privacy}","received_events_url":"https://api.github.com/users/AlexMa011/received_events","type":"User","site_admin":false},"event":"pinned","commit_id":null,"commit_url":null,"created_at":"2021-05-18T02:09:19Z","performed_via_github_app":null}]