[{"url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/comments/525608978","html_url":"https://github.com/cvjena/semantic-embeddings/issues/3#issuecomment-525608978","issue_url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/3","id":525608978,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNTYwODk3OA==","user":{"login":"Callidior","id":7915048,"node_id":"MDQ6VXNlcjc5MTUwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/7915048?v=4","gravatar_id":"","url":"https://api.github.com/users/Callidior","html_url":"https://github.com/Callidior","followers_url":"https://api.github.com/users/Callidior/followers","following_url":"https://api.github.com/users/Callidior/following{/other_user}","gists_url":"https://api.github.com/users/Callidior/gists{/gist_id}","starred_url":"https://api.github.com/users/Callidior/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Callidior/subscriptions","organizations_url":"https://api.github.com/users/Callidior/orgs","repos_url":"https://api.github.com/users/Callidior/repos","events_url":"https://api.github.com/users/Callidior/events{/privacy}","received_events_url":"https://api.github.com/users/Callidior/received_events","type":"User","site_admin":false},"created_at":"2019-08-28T06:52:15Z","updated_at":"2019-08-28T06:52:15Z","author_association":"COLLABORATOR","body":"Hi jalajjainai,\r\n\r\ncould you please be more specific about what you mean with \"inference\" here? It's as simple as conducting a forward-pass of the trained network and extracting activations from the \"l2norm\" layer if you want to compute semantic image embeddings. All the pre-trained checkpoint provided in this repository have been trained with a combination of the semantic embedding objective and a standard cross-entropy loss, so you can also extract class probabilities from the layer \"prob\" (last layer). You don't need to fiddle with the network architecture yourself, since all the pre-trained models have two outputs: The first one is the embeddings and the second one is class probabilities. Details about pre-processing of the images can be found in [section 4.2 of the readme](https://github.com/cvjena/semantic-embeddings#42-pre-processing).\r\nIf you use one-hot embeddings, you can also make class predictions directly from the embedding layer by taking the argmax.\r\n\r\nRegarding your other question: The point of this work was to integrate prior semantic knowledge into deep learning. In our case, this knowledge is given in the form of semantic similarities between classes. An embedding dimensionality that equals the number of classes is completely sufficient to capture this kind of knowledge. If you only have a handful of classes, there simply is not much knowledge. Consequently, there is not much benefit you could draw from this method in this case, unfortunately.","reactions":{"url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/comments/525608978/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Callidior","id":7915048,"node_id":"MDQ6VXNlcjc5MTUwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/7915048?v=4","gravatar_id":"","url":"https://api.github.com/users/Callidior","html_url":"https://github.com/Callidior","followers_url":"https://api.github.com/users/Callidior/followers","following_url":"https://api.github.com/users/Callidior/following{/other_user}","gists_url":"https://api.github.com/users/Callidior/gists{/gist_id}","starred_url":"https://api.github.com/users/Callidior/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Callidior/subscriptions","organizations_url":"https://api.github.com/users/Callidior/orgs","repos_url":"https://api.github.com/users/Callidior/repos","events_url":"https://api.github.com/users/Callidior/events{/privacy}","received_events_url":"https://api.github.com/users/Callidior/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/comments/527254565","html_url":"https://github.com/cvjena/semantic-embeddings/issues/3#issuecomment-527254565","issue_url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/3","id":527254565,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNzI1NDU2NQ==","user":{"login":"jalajjainai","id":48592683,"node_id":"MDQ6VXNlcjQ4NTkyNjgz","avatar_url":"https://avatars.githubusercontent.com/u/48592683?v=4","gravatar_id":"","url":"https://api.github.com/users/jalajjainai","html_url":"https://github.com/jalajjainai","followers_url":"https://api.github.com/users/jalajjainai/followers","following_url":"https://api.github.com/users/jalajjainai/following{/other_user}","gists_url":"https://api.github.com/users/jalajjainai/gists{/gist_id}","starred_url":"https://api.github.com/users/jalajjainai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jalajjainai/subscriptions","organizations_url":"https://api.github.com/users/jalajjainai/orgs","repos_url":"https://api.github.com/users/jalajjainai/repos","events_url":"https://api.github.com/users/jalajjainai/events{/privacy}","received_events_url":"https://api.github.com/users/jalajjainai/received_events","type":"User","site_admin":false},"created_at":"2019-09-02T22:58:13Z","updated_at":"2019-09-02T22:58:13Z","author_association":"NONE","body":"Hi,\r\n   Thanks for your detailed reply.  I thought same ,  argmax for one hot embedding. I am facing a weird problem. I have 2 class, normal vs abnormal for my project. What surprise me is following.\r\nLets say i have 2 class, and i trained the inverse cosine loss  based network for  classification. when i test a image which does not belong to either class from training, still network predicts to one of training class. \r\nit is very strange.\r\ndo u have any opinion on it ?\r\njalaj\r\n\r\n","reactions":{"url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/comments/527254565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jalajjainai","id":48592683,"node_id":"MDQ6VXNlcjQ4NTkyNjgz","avatar_url":"https://avatars.githubusercontent.com/u/48592683?v=4","gravatar_id":"","url":"https://api.github.com/users/jalajjainai","html_url":"https://github.com/jalajjainai","followers_url":"https://api.github.com/users/jalajjainai/followers","following_url":"https://api.github.com/users/jalajjainai/following{/other_user}","gists_url":"https://api.github.com/users/jalajjainai/gists{/gist_id}","starred_url":"https://api.github.com/users/jalajjainai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jalajjainai/subscriptions","organizations_url":"https://api.github.com/users/jalajjainai/orgs","repos_url":"https://api.github.com/users/jalajjainai/repos","events_url":"https://api.github.com/users/jalajjainai/events{/privacy}","received_events_url":"https://api.github.com/users/jalajjainai/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/comments/527328734","html_url":"https://github.com/cvjena/semantic-embeddings/issues/3#issuecomment-527328734","issue_url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/3","id":527328734,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNzMyODczNA==","user":{"login":"Callidior","id":7915048,"node_id":"MDQ6VXNlcjc5MTUwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/7915048?v=4","gravatar_id":"","url":"https://api.github.com/users/Callidior","html_url":"https://github.com/Callidior","followers_url":"https://api.github.com/users/Callidior/followers","following_url":"https://api.github.com/users/Callidior/following{/other_user}","gists_url":"https://api.github.com/users/Callidior/gists{/gist_id}","starred_url":"https://api.github.com/users/Callidior/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Callidior/subscriptions","organizations_url":"https://api.github.com/users/Callidior/orgs","repos_url":"https://api.github.com/users/Callidior/repos","events_url":"https://api.github.com/users/Callidior/events{/privacy}","received_events_url":"https://api.github.com/users/Callidior/received_events","type":"User","site_admin":false},"created_at":"2019-09-03T06:50:55Z","updated_at":"2019-09-03T06:50:55Z","author_association":"COLLABORATOR","body":"Hi,\r\nfirst I would like to note that this setup (anomaly detection) is not an optimal fit for the framework of hierarchy-based semantic embeddings. Not only is the number of classes much too small, but the classes are also very generic, so that there can be close to no prior knowledge about them.\r\nI am also wondering how any test image can be from neither one of the classes - it must be either normal or abnormal.\r\nOf course, the network will always predict a similarity between the sample and both classes. And one of these similarities will almost always be larger than all other ones. If you take the argmax, you always get a prediction. But how certain is this prediction? You could try looking at the similarity scores directly. They will always be between 1 (most similar) and -1 (most dissimilar). Maybe you can find a useful threshold for detecting novel samples.\r\nBut in general, I recommend looking into the novelty detection and anomaly detection literature for this task.","reactions":{"url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/comments/527328734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Callidior","id":7915048,"node_id":"MDQ6VXNlcjc5MTUwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/7915048?v=4","gravatar_id":"","url":"https://api.github.com/users/Callidior","html_url":"https://github.com/Callidior","followers_url":"https://api.github.com/users/Callidior/followers","following_url":"https://api.github.com/users/Callidior/following{/other_user}","gists_url":"https://api.github.com/users/Callidior/gists{/gist_id}","starred_url":"https://api.github.com/users/Callidior/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Callidior/subscriptions","organizations_url":"https://api.github.com/users/Callidior/orgs","repos_url":"https://api.github.com/users/Callidior/repos","events_url":"https://api.github.com/users/Callidior/events{/privacy}","received_events_url":"https://api.github.com/users/Callidior/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/comments/527671509","html_url":"https://github.com/cvjena/semantic-embeddings/issues/3#issuecomment-527671509","issue_url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/3","id":527671509,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNzY3MTUwOQ==","user":{"login":"jalajjainai","id":48592683,"node_id":"MDQ6VXNlcjQ4NTkyNjgz","avatar_url":"https://avatars.githubusercontent.com/u/48592683?v=4","gravatar_id":"","url":"https://api.github.com/users/jalajjainai","html_url":"https://github.com/jalajjainai","followers_url":"https://api.github.com/users/jalajjainai/followers","following_url":"https://api.github.com/users/jalajjainai/following{/other_user}","gists_url":"https://api.github.com/users/jalajjainai/gists{/gist_id}","starred_url":"https://api.github.com/users/jalajjainai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jalajjainai/subscriptions","organizations_url":"https://api.github.com/users/jalajjainai/orgs","repos_url":"https://api.github.com/users/jalajjainai/repos","events_url":"https://api.github.com/users/jalajjainai/events{/privacy}","received_events_url":"https://api.github.com/users/jalajjainai/received_events","type":"User","site_admin":false},"created_at":"2019-09-03T22:56:11Z","updated_at":"2019-09-03T22:56:11Z","author_association":"NONE","body":"Hi,\r\n     i meant to say that if there is a target class DOG which is normal and CAT is abnormal. During, testing, i found that if lets say test image is of class TIGER, network still produces high similarity score for one of the target class.\r\nHowever, i have very less sample   (Around 50) for the target class. And so, i was interested in your work to apply for my problem. \r\nI think with handful of the classes and less data, network is not able to learn, descriptive features even with cosine less.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/comments/527671509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jalajjainai","id":48592683,"node_id":"MDQ6VXNlcjQ4NTkyNjgz","avatar_url":"https://avatars.githubusercontent.com/u/48592683?v=4","gravatar_id":"","url":"https://api.github.com/users/jalajjainai","html_url":"https://github.com/jalajjainai","followers_url":"https://api.github.com/users/jalajjainai/followers","following_url":"https://api.github.com/users/jalajjainai/following{/other_user}","gists_url":"https://api.github.com/users/jalajjainai/gists{/gist_id}","starred_url":"https://api.github.com/users/jalajjainai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jalajjainai/subscriptions","organizations_url":"https://api.github.com/users/jalajjainai/orgs","repos_url":"https://api.github.com/users/jalajjainai/repos","events_url":"https://api.github.com/users/jalajjainai/events{/privacy}","received_events_url":"https://api.github.com/users/jalajjainai/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/comments/527796850","html_url":"https://github.com/cvjena/semantic-embeddings/issues/3#issuecomment-527796850","issue_url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/3","id":527796850,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNzc5Njg1MA==","user":{"login":"Callidior","id":7915048,"node_id":"MDQ6VXNlcjc5MTUwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/7915048?v=4","gravatar_id":"","url":"https://api.github.com/users/Callidior","html_url":"https://github.com/Callidior","followers_url":"https://api.github.com/users/Callidior/followers","following_url":"https://api.github.com/users/Callidior/following{/other_user}","gists_url":"https://api.github.com/users/Callidior/gists{/gist_id}","starred_url":"https://api.github.com/users/Callidior/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Callidior/subscriptions","organizations_url":"https://api.github.com/users/Callidior/orgs","repos_url":"https://api.github.com/users/Callidior/repos","events_url":"https://api.github.com/users/Callidior/events{/privacy}","received_events_url":"https://api.github.com/users/Callidior/received_events","type":"User","site_admin":false},"created_at":"2019-09-04T08:21:44Z","updated_at":"2019-09-04T08:21:44Z","author_association":"COLLABORATOR","body":"I understand your problem now. The smallest dataset we tested was for text classification with only 4 classes. We still saw a large benefit of cosine loss over cross-entropy with as few as 10 samples per class (i.e., 40 samples in total). However, pre-trained word embeddings have been used for this and the situation for image classification will probably be different if you learn everything from scratch due to severe overfitting.\r\nIt is true that wile our paper has shown results with few samples per class, we still had more than 100 classes in each experiment and never less than 2k images in total, so that there was much more diversity in the data than you have with two classes. CNN training from scratch in general has a closed-world assumption, which the cosine loss does not change either. It just might improve accuracy for these classes if you have few training data. But if you just train with images of cats and dogs and your CNN never sees anything else, it will just assume that every possible image either shows a cat or a dog, so that the learned features are very specific to this distinction. For example, for distinguishing between cats and dogs the network might have learned that it is sufficient to look whether there are whiskers in the image or not. Give it an image of a tiger: well, it has whiskers, must be a cat. The network just did not learn any other features because it was not necessary for the task you gave it.\r\n","reactions":{"url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/comments/527796850/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Callidior","id":7915048,"node_id":"MDQ6VXNlcjc5MTUwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/7915048?v=4","gravatar_id":"","url":"https://api.github.com/users/Callidior","html_url":"https://github.com/Callidior","followers_url":"https://api.github.com/users/Callidior/followers","following_url":"https://api.github.com/users/Callidior/following{/other_user}","gists_url":"https://api.github.com/users/Callidior/gists{/gist_id}","starred_url":"https://api.github.com/users/Callidior/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Callidior/subscriptions","organizations_url":"https://api.github.com/users/Callidior/orgs","repos_url":"https://api.github.com/users/Callidior/repos","events_url":"https://api.github.com/users/Callidior/events{/privacy}","received_events_url":"https://api.github.com/users/Callidior/received_events","type":"User","site_admin":false}},{"id":2807243888,"node_id":"MDExOkNsb3NlZEV2ZW50MjgwNzI0Mzg4OA==","url":"https://api.github.com/repos/cvjena/semantic-embeddings/issues/events/2807243888","actor":{"login":"Callidior","id":7915048,"node_id":"MDQ6VXNlcjc5MTUwNDg=","avatar_url":"https://avatars.githubusercontent.com/u/7915048?v=4","gravatar_id":"","url":"https://api.github.com/users/Callidior","html_url":"https://github.com/Callidior","followers_url":"https://api.github.com/users/Callidior/followers","following_url":"https://api.github.com/users/Callidior/following{/other_user}","gists_url":"https://api.github.com/users/Callidior/gists{/gist_id}","starred_url":"https://api.github.com/users/Callidior/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Callidior/subscriptions","organizations_url":"https://api.github.com/users/Callidior/orgs","repos_url":"https://api.github.com/users/Callidior/repos","events_url":"https://api.github.com/users/Callidior/events{/privacy}","received_events_url":"https://api.github.com/users/Callidior/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-11-18T11:59:40Z","state_reason":null,"performed_via_github_app":null}]