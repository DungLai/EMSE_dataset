{"url":"https://api.github.com/repos/bioinform/neusomatic/issues/79","repository_url":"https://api.github.com/repos/bioinform/neusomatic","labels_url":"https://api.github.com/repos/bioinform/neusomatic/issues/79/labels{/name}","comments_url":"https://api.github.com/repos/bioinform/neusomatic/issues/79/comments","events_url":"https://api.github.com/repos/bioinform/neusomatic/issues/79/events","html_url":"https://github.com/bioinform/neusomatic/issues/79","id":1107665070,"node_id":"I_kwDOCLR7Q85CBaCu","number":79,"title":"training using bamsurgeon on multiple samples","user":{"login":"kiranchari","id":1838910,"node_id":"MDQ6VXNlcjE4Mzg5MTA=","avatar_url":"https://avatars.githubusercontent.com/u/1838910?v=4","gravatar_id":"","url":"https://api.github.com/users/kiranchari","html_url":"https://github.com/kiranchari","followers_url":"https://api.github.com/users/kiranchari/followers","following_url":"https://api.github.com/users/kiranchari/following{/other_user}","gists_url":"https://api.github.com/users/kiranchari/gists{/gist_id}","starred_url":"https://api.github.com/users/kiranchari/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kiranchari/subscriptions","organizations_url":"https://api.github.com/users/kiranchari/orgs","repos_url":"https://api.github.com/users/kiranchari/repos","events_url":"https://api.github.com/users/kiranchari/events{/privacy}","received_events_url":"https://api.github.com/users/kiranchari/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-01-19T05:36:33Z","updated_at":"2022-01-19T07:08:38Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi, \r\n\r\nI generated a training set comprising multiple samples using the method suggested in the README (using somaticseq's docker pipeline for bamsurgeon): https://github.com/bioinform/neusomatic#creating-training-data\r\n\r\nAfter training Neusomatic on this dataset, I do not get the expected performance on an external test sample independent of the training set -  I am not sure where the issue is. I have previously evaluated Neusomatic's output without issues. \r\n\r\nOne issue I suspect is with the vcf generated by bamsurgeon. While I can view the alignments at the mutated sites in the generated insilico normal/tumor samples, bamsurgeon reports a DPR (depth) of 0 for most mutations in the VCF. Below is a sample of the synthetic vcf generated by bamsurgeon. Could this be an issue for Neusomatic? i.e. does it rely on the DPR reported in the VCF when generating training data? The insilico samples look fine otherwise, and the Neusomatic training ran smoothly for 1000 epochs.\r\n\r\nThank you.\r\n\r\n> ##fileformat=VCFv4.1\r\n##phasing=none\r\n##INDIVIDUAL=TRUTH\r\n##SAMPLE=<ID=TRUTH,Description=\"bamsurgeon spike-in\",Individual=TRUTH>\r\n##INFO=<ID=CIPOS,Number=2,Type=Integer,Description=\"Confidence interval around POS for imprecise variants\">\r\n##INFO=<ID=IMPRECISE,Number=0,Type=Flag,Description=\"Imprecise structural variation\">\r\n##INFO=<ID=SVTYPE,Number=1,Type=String,Description=\"Type of structural variant\">\r\n##INFO=<ID=SVLEN,Number=.,Type=Integer,Description=\"Difference in length between REF and ALT alleles\">\r\n##INFO=<ID=SOMATIC,Number=0,Type=Flag,Description=\"Somatic mutation in primary\">\r\n##INFO=<ID=VAF,Number=1,Type=Float,Description=\"Variant Allele Frequency\">\r\n##INFO=<ID=DPR,Number=1,Type=Float,Description=\"Avg Depth in Region (+/- 1bp)\">\r\n##INFO=<ID=MATEID,Number=1,Type=String,Description=\"Breakend mate\">\r\n##ALT=<ID=INV,Description=\"Inversion\">\r\n##ALT=<ID=DUP,Description=\"Duplication\">\r\n##ALT=<ID=DEL,Description=\"Deletion\">\r\n##ALT=<ID=INS,Description=\"Insertion\">\r\n##FORMAT=<ID=GT,Number=1,Type=String,Description=\"Genotype\">\r\n#CHROM  POS ID  REF ALT QUAL    FILTER  INFO    FORMAT  SPIKEIN\r\n1   139455  .   A   G   100 PASS    SOMATIC;VAF=0.288888888889;DPR=0.0  GT  0/1\r\n1   148410  .   C   A   100 PASS    SOMATIC;VAF=0.123595505618;DPR=0.0  GT  0/1\r\n1   148416  .   T   G   100 PASS    SOMATIC;VAF=0.239583333333;DPR=0.0  GT  0/1\r\n1   822932  .   G   C   100 PASS    SOMATIC;VAF=0.0903225806452;DPR=0.0 GT  0/1\r\n21  10569712    .   AT  A   100 PASS    SOMATIC GT  0/1\r\n21  10569714    .   TGA T   100 PASS    SOMATIC GT  0/1\r\n21  10703018    .   C   CCCT    100 PASS    SOMATIC GT  0/1\r\n21  10706729    .   G   GA  100 PASS    SOMATIC GT  0/1\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/bioinform/neusomatic/issues/79/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bioinform/neusomatic/issues/79/timeline","performed_via_github_app":null,"state_reason":null}