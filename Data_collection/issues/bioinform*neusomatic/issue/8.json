{"url":"https://api.github.com/repos/bioinform/neusomatic/issues/8","repository_url":"https://api.github.com/repos/bioinform/neusomatic","labels_url":"https://api.github.com/repos/bioinform/neusomatic/issues/8/labels{/name}","comments_url":"https://api.github.com/repos/bioinform/neusomatic/issues/8/comments","events_url":"https://api.github.com/repos/bioinform/neusomatic/issues/8/events","html_url":"https://github.com/bioinform/neusomatic/issues/8","id":360556409,"node_id":"MDU6SXNzdWUzNjA1NTY0MDk=","number":8,"title":"training -  input, target not matching","user":{"login":"vendig","id":26358653,"node_id":"MDQ6VXNlcjI2MzU4NjUz","avatar_url":"https://avatars.githubusercontent.com/u/26358653?v=4","gravatar_id":"","url":"https://api.github.com/users/vendig","html_url":"https://github.com/vendig","followers_url":"https://api.github.com/users/vendig/followers","following_url":"https://api.github.com/users/vendig/following{/other_user}","gists_url":"https://api.github.com/users/vendig/gists{/gist_id}","starred_url":"https://api.github.com/users/vendig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vendig/subscriptions","organizations_url":"https://api.github.com/users/vendig/orgs","repos_url":"https://api.github.com/users/vendig/repos","events_url":"https://api.github.com/users/vendig/events{/privacy}","received_events_url":"https://api.github.com/users/vendig/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-09-15T16:50:31Z","updated_at":"2018-09-18T23:30:06Z","closed_at":"2018-09-18T23:30:06Z","author_association":"NONE","active_lock_reason":null,"body":"An error: RuntimeError: input and target shapes do not match: input [24 x 1], target [24] at /pytorch/aten/src/THCUNN/generic/SmoothL1Criterion.cu:12 was already reported by other people. For example: \r\nhttps://discuss.pytorch.org/t/runtimeerror-multi-target-not-supported-newbie/10216/3\r\n\r\nI am using pytorch version 0.4.1.\r\n\r\nInput:\r\n%sh \r\nexport PYTHONPATH=\"/databricks/python/local/lib/python2.7/site-packages:$PYTHONPATH\"  # this is just a hack, don't use this code.\r\ncd /local_disk0/neu2/neusomatic-master/test/example\r\n\r\n \r\n/usr/bin/python ../../neusomatic/python/preprocess.py \\\r\n\t--mode train \\\r\n\t--reference Homo_sapiens.GRCh37.75.dna.chromosome.22.fa \\\r\n\t--region_bed ../region.bed \\\r\n\t--tumor_bam ../tumor.bam \\\r\n\t--normal_bam ../normal.bam \\\r\n\t--work work_train \\\r\n\t--truth_vcf ../NeuSomatic_ensemble.vcf \\\r\n\t--min_mapq 10 \\\r\n\t--num_threads 1 \\\r\n\t--scan_alignments_binary ../../neusomatic/bin/scan_alignments\r\n\r\n\r\n\r\n\r\n%sh \r\nexport PYTHONPATH=\"/databricks/python/local/lib/python2.7/site-packages:$PYTHONPATH\" \r\ncd /local_disk0/neu2/neusomatic-master/test/example\r\n\r\n/usr/bin/python  ../../neusomatic/python/train.py \\\r\n\t--candidates_tsv work_train/dataset/*/candidates*.tsv \\\r\n\t--out work_train \\\r\n\t--num_threads 10 \\\r\n\t--batch_size 100 \r\n\r\n\r\n\r\nOutput:\r\nINFO 2018-09-15 16:43:43,998 __main__             Namespace(batch_size=100, boost_none=10, candidates_tsv=['work_train/dataset/work.0/candidates_0.tsv'], checkpoint=None, coverage_thr=100, ensemble=False, lr=0.01, lr_drop_epochs=400, lr_drop_ratio=0.1, max_epochs=1000, max_load_candidates=1000000, momentum=0.9, none_count_scale=2, num_threads=10, out='work_train', validation_candidates_tsv=[])\r\nINFO 2018-09-15 16:43:44,018 __main__             use_cuda: True\r\nINFO 2018-09-15 16:43:44,018 __main__             -----------------------------------------------------------\r\nINFO 2018-09-15 16:43:44,018 __main__             Train NeuSomatic Network\r\nINFO 2018-09-15 16:43:44,018 __main__             -----------------------------------------------------------\r\nINFO 2018-09-15 16:43:46,327 __main__             tag: neusomatic_18-09-15-16-43-46\r\nINFO 2018-09-15 16:43:46,328 dataloader           [211]\r\nINFO 2018-09-15 16:43:46,478 dataloader           Loaded 211 candidates for work_train/dataset/work.0/candidates_0.tsv\r\nINFO 2018-09-15 16:43:46,484 __main__             Non-somatic candidates: 203\r\nINFO 2018-09-15 16:43:46,484 __main__             Somatic candidates: 8\r\nINFO 2018-09-15 16:43:46,484 __main__             Non-somatic considered in each epoch: 16\r\nINFO 2018-09-15 16:43:46,484 __main__             #Train cadidates: 211\r\nINFO 2018-09-15 16:43:46,484 __main__             count type classes: [('DEL', 2), ('INS', 1), ('NONE', 16), ('SNP', 8)]\r\nINFO 2018-09-15 16:43:46,485 __main__             weight type classes: [('DEL', 0.23148148148148148), ('INS', 0.24074074074074076), ('NONE', 0.10185185185185186), ('SNP', 0.17592592592592593)]\r\nINFO 2018-09-15 16:43:46,485 __main__             weight length classes: [(0, 16), (1, 8), (2, 2), (3, 1)]\r\nINFO 2018-09-15 16:43:46,485 __main__             weight length classes: [(0, 0.10185185185185186), (1, 0.17592592592592593), (2, 0.23148148148148148), (3, 0.24074074074074076)]\r\nINFO 2018-09-15 16:43:46,485 __main__             weights_type:[0.23148148 0.24074074 1.01851852 0.17592593], weights_length:[1.01851852 0.17592593 0.23148148 0.24074074]\r\nINFO 2018-09-15 16:43:46,487 __main__             Number of candidater per epoch: 24\r\nTraceback (most recent call last):\r\n  File \"../../neusomatic/python/train.py\", line 420, in <module>\r\n    args.max_load_candidates, args.coverage_thr, use_cuda)\r\n  File \"../../neusomatic/python/train.py\", line 326, in train_neusomatic\r\n    ) + 1 * criterion_crossentropy2(outputs_len, var_len_labels)\r\n  File \"/databricks/python/local/lib/python2.7/site-packages/torch/nn/modules/module.py\", line 477, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/databricks/python/local/lib/python2.7/site-packages/torch/nn/modules/loss.py\", line 735, in forward\r\n    return F.smooth_l1_loss(input, target, reduction=self.reduction)\r\n  File \"/databricks/python/local/lib/python2.7/site-packages/torch/nn/functional.py\", line 1687, in smooth_l1_loss\r\n    return torch._C._nn.smooth_l1_loss(input, target, reduction)\r\nRuntimeError: input and target shapes do not match: input [24 x 1], target [24] at /pytorch/aten/src/THCUNN/generic/SmoothL1Criterion.cu:12\r\n\r\nThank you.\r\nBest,\r\nvendi","closed_by":{"login":"msahraeian","id":11095648,"node_id":"MDQ6VXNlcjExMDk1NjQ4","avatar_url":"https://avatars.githubusercontent.com/u/11095648?v=4","gravatar_id":"","url":"https://api.github.com/users/msahraeian","html_url":"https://github.com/msahraeian","followers_url":"https://api.github.com/users/msahraeian/followers","following_url":"https://api.github.com/users/msahraeian/following{/other_user}","gists_url":"https://api.github.com/users/msahraeian/gists{/gist_id}","starred_url":"https://api.github.com/users/msahraeian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/msahraeian/subscriptions","organizations_url":"https://api.github.com/users/msahraeian/orgs","repos_url":"https://api.github.com/users/msahraeian/repos","events_url":"https://api.github.com/users/msahraeian/events{/privacy}","received_events_url":"https://api.github.com/users/msahraeian/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bioinform/neusomatic/issues/8/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bioinform/neusomatic/issues/8/timeline","performed_via_github_app":null,"state_reason":"completed"}