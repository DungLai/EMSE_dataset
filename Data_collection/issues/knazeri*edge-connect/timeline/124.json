[{"url":"https://api.github.com/repos/knazeri/edge-connect/issues/comments/712569331","html_url":"https://github.com/knazeri/edge-connect/issues/124#issuecomment-712569331","issue_url":"https://api.github.com/repos/knazeri/edge-connect/issues/124","id":712569331,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjU2OTMzMQ==","user":{"login":"Guanyunlph","id":43237388,"node_id":"MDQ6VXNlcjQzMjM3Mzg4","avatar_url":"https://avatars.githubusercontent.com/u/43237388?v=4","gravatar_id":"","url":"https://api.github.com/users/Guanyunlph","html_url":"https://github.com/Guanyunlph","followers_url":"https://api.github.com/users/Guanyunlph/followers","following_url":"https://api.github.com/users/Guanyunlph/following{/other_user}","gists_url":"https://api.github.com/users/Guanyunlph/gists{/gist_id}","starred_url":"https://api.github.com/users/Guanyunlph/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Guanyunlph/subscriptions","organizations_url":"https://api.github.com/users/Guanyunlph/orgs","repos_url":"https://api.github.com/users/Guanyunlph/repos","events_url":"https://api.github.com/users/Guanyunlph/events{/privacy}","received_events_url":"https://api.github.com/users/Guanyunlph/received_events","type":"User","site_admin":false},"created_at":"2020-10-20T03:44:08Z","updated_at":"2020-10-20T03:44:08Z","author_association":"NONE","body":"Hi, I met the same problem. Have you solved it?","reactions":{"url":"https://api.github.com/repos/knazeri/edge-connect/issues/comments/712569331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Guanyunlph","id":43237388,"node_id":"MDQ6VXNlcjQzMjM3Mzg4","avatar_url":"https://avatars.githubusercontent.com/u/43237388?v=4","gravatar_id":"","url":"https://api.github.com/users/Guanyunlph","html_url":"https://github.com/Guanyunlph","followers_url":"https://api.github.com/users/Guanyunlph/followers","following_url":"https://api.github.com/users/Guanyunlph/following{/other_user}","gists_url":"https://api.github.com/users/Guanyunlph/gists{/gist_id}","starred_url":"https://api.github.com/users/Guanyunlph/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Guanyunlph/subscriptions","organizations_url":"https://api.github.com/users/Guanyunlph/orgs","repos_url":"https://api.github.com/users/Guanyunlph/repos","events_url":"https://api.github.com/users/Guanyunlph/events{/privacy}","received_events_url":"https://api.github.com/users/Guanyunlph/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/knazeri/edge-connect/issues/comments/799479362","html_url":"https://github.com/knazeri/edge-connect/issues/124#issuecomment-799479362","issue_url":"https://api.github.com/repos/knazeri/edge-connect/issues/124","id":799479362,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTQ3OTM2Mg==","user":{"login":"g-h-anna","id":74008708,"node_id":"MDQ6VXNlcjc0MDA4NzA4","avatar_url":"https://avatars.githubusercontent.com/u/74008708?v=4","gravatar_id":"","url":"https://api.github.com/users/g-h-anna","html_url":"https://github.com/g-h-anna","followers_url":"https://api.github.com/users/g-h-anna/followers","following_url":"https://api.github.com/users/g-h-anna/following{/other_user}","gists_url":"https://api.github.com/users/g-h-anna/gists{/gist_id}","starred_url":"https://api.github.com/users/g-h-anna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-h-anna/subscriptions","organizations_url":"https://api.github.com/users/g-h-anna/orgs","repos_url":"https://api.github.com/users/g-h-anna/repos","events_url":"https://api.github.com/users/g-h-anna/events{/privacy}","received_events_url":"https://api.github.com/users/g-h-anna/received_events","type":"User","site_admin":false},"created_at":"2021-03-15T14:47:45Z","updated_at":"2021-03-15T15:56:41Z","author_association":"NONE","body":"> Hi, I met the same problem. Have you solved it?\r\n\r\nHi, do you have a solution?","reactions":{"url":"https://api.github.com/repos/knazeri/edge-connect/issues/comments/799479362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"g-h-anna","id":74008708,"node_id":"MDQ6VXNlcjc0MDA4NzA4","avatar_url":"https://avatars.githubusercontent.com/u/74008708?v=4","gravatar_id":"","url":"https://api.github.com/users/g-h-anna","html_url":"https://github.com/g-h-anna","followers_url":"https://api.github.com/users/g-h-anna/followers","following_url":"https://api.github.com/users/g-h-anna/following{/other_user}","gists_url":"https://api.github.com/users/g-h-anna/gists{/gist_id}","starred_url":"https://api.github.com/users/g-h-anna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/g-h-anna/subscriptions","organizations_url":"https://api.github.com/users/g-h-anna/orgs","repos_url":"https://api.github.com/users/g-h-anna/repos","events_url":"https://api.github.com/users/g-h-anna/events{/privacy}","received_events_url":"https://api.github.com/users/g-h-anna/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/knazeri/edge-connect/issues/comments/884132613","html_url":"https://github.com/knazeri/edge-connect/issues/124#issuecomment-884132613","issue_url":"https://api.github.com/repos/knazeri/edge-connect/issues/124","id":884132613,"node_id":"IC_kwDOCadRDc40sssF","user":{"login":"cgsaxner","id":29651139,"node_id":"MDQ6VXNlcjI5NjUxMTM5","avatar_url":"https://avatars.githubusercontent.com/u/29651139?v=4","gravatar_id":"","url":"https://api.github.com/users/cgsaxner","html_url":"https://github.com/cgsaxner","followers_url":"https://api.github.com/users/cgsaxner/followers","following_url":"https://api.github.com/users/cgsaxner/following{/other_user}","gists_url":"https://api.github.com/users/cgsaxner/gists{/gist_id}","starred_url":"https://api.github.com/users/cgsaxner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cgsaxner/subscriptions","organizations_url":"https://api.github.com/users/cgsaxner/orgs","repos_url":"https://api.github.com/users/cgsaxner/repos","events_url":"https://api.github.com/users/cgsaxner/events{/privacy}","received_events_url":"https://api.github.com/users/cgsaxner/received_events","type":"User","site_admin":false},"created_at":"2021-07-21T11:57:24Z","updated_at":"2021-07-21T11:57:24Z","author_association":"NONE","body":"I ran into the same problem when trying to train the network with a newer PyTorch version (1.9.0). It looks like it is connected to this issue:\r\nhttps://github.com/pytorch/pytorch/issues/39141\r\n\r\nAccording to what is described in this link, I adjusted the `backward` functions in the [edge](https://github.com/knazeri/edge-connect/blob/4cfdb856e3ab7885f50336034a6476c94fe5b25d/src/models.py#L143-L150) and [inpaint](https://github.com/knazeri/edge-connect/blob/4cfdb856e3ab7885f50336034a6476c94fe5b25d/src/models.py#L255-L260) model so that both `backward()` passes are done before the optimizer steps, e.g.:\r\n```\r\ndef backward(self, gen_loss=None, dis_loss=None):\r\n  dis_loss.backward()\r\n  gen_loss.backward()\r\n  \r\n  self.dis_optimizer.step()\r\n  self.gen_optimizer.step()\r\n```\r\nSince the optimizer checks causing this error seem to not have been implemented in PyTorch versions < 1.5.0, it might be that the computed gradients are actually not correct when using earlier versions.","reactions":{"url":"https://api.github.com/repos/knazeri/edge-connect/issues/comments/884132613/reactions","total_count":3,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":3,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cgsaxner","id":29651139,"node_id":"MDQ6VXNlcjI5NjUxMTM5","avatar_url":"https://avatars.githubusercontent.com/u/29651139?v=4","gravatar_id":"","url":"https://api.github.com/users/cgsaxner","html_url":"https://github.com/cgsaxner","followers_url":"https://api.github.com/users/cgsaxner/followers","following_url":"https://api.github.com/users/cgsaxner/following{/other_user}","gists_url":"https://api.github.com/users/cgsaxner/gists{/gist_id}","starred_url":"https://api.github.com/users/cgsaxner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cgsaxner/subscriptions","organizations_url":"https://api.github.com/users/cgsaxner/orgs","repos_url":"https://api.github.com/users/cgsaxner/repos","events_url":"https://api.github.com/users/cgsaxner/events{/privacy}","received_events_url":"https://api.github.com/users/cgsaxner/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/knazeri/edge-connect/issues/comments/887449876","html_url":"https://github.com/knazeri/edge-connect/issues/124#issuecomment-887449876","issue_url":"https://api.github.com/repos/knazeri/edge-connect/issues/124","id":887449876,"node_id":"IC_kwDOCadRDc405WkU","user":{"login":"dhruvagarwal","id":4587641,"node_id":"MDQ6VXNlcjQ1ODc2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/4587641?v=4","gravatar_id":"","url":"https://api.github.com/users/dhruvagarwal","html_url":"https://github.com/dhruvagarwal","followers_url":"https://api.github.com/users/dhruvagarwal/followers","following_url":"https://api.github.com/users/dhruvagarwal/following{/other_user}","gists_url":"https://api.github.com/users/dhruvagarwal/gists{/gist_id}","starred_url":"https://api.github.com/users/dhruvagarwal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhruvagarwal/subscriptions","organizations_url":"https://api.github.com/users/dhruvagarwal/orgs","repos_url":"https://api.github.com/users/dhruvagarwal/repos","events_url":"https://api.github.com/users/dhruvagarwal/events{/privacy}","received_events_url":"https://api.github.com/users/dhruvagarwal/received_events","type":"User","site_admin":false},"created_at":"2021-07-27T11:56:05Z","updated_at":"2021-07-27T11:56:05Z","author_association":"NONE","body":"The problem happens because of the pytorch version > 1.5.0.\r\nThis project uses pytorch version 1.0, try sticking to that and torchvision 0.3.0 to run it.","reactions":{"url":"https://api.github.com/repos/knazeri/edge-connect/issues/comments/887449876/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dhruvagarwal","id":4587641,"node_id":"MDQ6VXNlcjQ1ODc2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/4587641?v=4","gravatar_id":"","url":"https://api.github.com/users/dhruvagarwal","html_url":"https://github.com/dhruvagarwal","followers_url":"https://api.github.com/users/dhruvagarwal/followers","following_url":"https://api.github.com/users/dhruvagarwal/following{/other_user}","gists_url":"https://api.github.com/users/dhruvagarwal/gists{/gist_id}","starred_url":"https://api.github.com/users/dhruvagarwal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhruvagarwal/subscriptions","organizations_url":"https://api.github.com/users/dhruvagarwal/orgs","repos_url":"https://api.github.com/users/dhruvagarwal/repos","events_url":"https://api.github.com/users/dhruvagarwal/events{/privacy}","received_events_url":"https://api.github.com/users/dhruvagarwal/received_events","type":"User","site_admin":false}}]