{"url":"https://api.github.com/repos/knazeri/edge-connect/issues/152","repository_url":"https://api.github.com/repos/knazeri/edge-connect","labels_url":"https://api.github.com/repos/knazeri/edge-connect/issues/152/labels{/name}","comments_url":"https://api.github.com/repos/knazeri/edge-connect/issues/152/comments","events_url":"https://api.github.com/repos/knazeri/edge-connect/issues/152/events","html_url":"https://github.com/knazeri/edge-connect/issues/152","id":641075543,"node_id":"MDU6SXNzdWU2NDEwNzU1NDM=","number":152,"title":"RuntimeError: one of the variables needed for gradient computation has been modified by an inplace operation: [torch.cuda.FloatTensor [1, 512, 4, 4]] is at version 2; expected version 1 instead. Hint: enable anomaly detection to find the operation that failed to compute its gradient, with torch.autograd.set_detect_anomaly(True).","user":{"login":"CyrilShch","id":50148272,"node_id":"MDQ6VXNlcjUwMTQ4Mjcy","avatar_url":"https://avatars.githubusercontent.com/u/50148272?v=4","gravatar_id":"","url":"https://api.github.com/users/CyrilShch","html_url":"https://github.com/CyrilShch","followers_url":"https://api.github.com/users/CyrilShch/followers","following_url":"https://api.github.com/users/CyrilShch/following{/other_user}","gists_url":"https://api.github.com/users/CyrilShch/gists{/gist_id}","starred_url":"https://api.github.com/users/CyrilShch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CyrilShch/subscriptions","organizations_url":"https://api.github.com/users/CyrilShch/orgs","repos_url":"https://api.github.com/users/CyrilShch/repos","events_url":"https://api.github.com/users/CyrilShch/events{/privacy}","received_events_url":"https://api.github.com/users/CyrilShch/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-06-18T09:59:02Z","updated_at":"2021-05-20T11:43:14Z","closed_at":"2020-06-18T13:17:15Z","author_association":"NONE","active_lock_reason":null,"body":"Model configurations:\r\n---------------------------------\r\nMODE: 1             # 1: train, 2: test, 3: eval\r\nMODEL: 1            # 1: edge model, 2: inpaint model, 3: edge-inpaint model, 4: joint model\r\nMASK: 3             # 1: random block, 2: half, 3: external, 4: (external, random block), 5: (external, random block, half)\r\nEDGE: 1             # 1: canny, 2: external\r\nNMS: 1              # 0: no non-max-suppression, 1: applies non-max-suppression on the external edges by multiplying by Canny\r\nSEED: 10            # random seed\r\nGPU: [0]            # list of gpu ids\r\nDEBUG: 0            # turns on debugging mode\r\nVERBOSE: 0          # turns on verbose mode in the output console\r\n\r\nTRAIN_FLIST: ./datasets/places2_train.flist\r\nVAL_FLIST: ./datasets/places2_val.flist\r\nTEST_FLIST: ./datasets/places2_test.flist\r\n\r\nTRAIN_EDGE_FLIST: ./datasets/places2_edges_train.flist\r\nVAL_EDGE_FLIST: ./datasets/places2_edges_val.flist\r\nTEST_EDGE_FLIST: ./datasets/places2_edges_test.flist\r\n\r\nTRAIN_MASK_FLIST: ./datasets/masks_train.flist\r\nVAL_MASK_FLIST: ./datasets/masks_val.flist\r\nTEST_MASK_FLIST: ./datasets/masks_test.flist\r\n\r\nLR: 0.0001                    # learning rate\r\nD2G_LR: 0.1                   # discriminator/generator learning rate ratio\r\nBETA1: 0.0                    # adam optimizer beta1\r\nBETA2: 0.9                    # adam optimizer beta2\r\nBATCH_SIZE: 8                 # input batch size for training\r\nINPUT_SIZE: 256               # input image size for training 0 for original size\r\nSIGMA: 2                      # standard deviation of the Gaussian filter used in Canny edge detector (0: random, -1: no edge)\r\nMAX_ITERS: 2e6                # maximum number of iterations to train the model\r\n\r\nEDGE_THRESHOLD: 0.5           # edge detection threshold\r\nL1_LOSS_WEIGHT: 1             # l1 loss weight\r\nFM_LOSS_WEIGHT: 10            # feature-matching loss weight\r\nSTYLE_LOSS_WEIGHT: 250        # style loss weight\r\nCONTENT_LOSS_WEIGHT: 0.1      # perceptual loss weight\r\nINPAINT_ADV_LOSS_WEIGHT: 0.1  # adversarial loss weight\r\n\r\nGAN_LOSS: nsgan               # nsgan | lsgan | hinge\r\nGAN_POOL_SIZE: 0              # fake images pool size\r\n\r\nSAVE_INTERVAL: 1000           # how many iterations to wait before saving model (0: never)\r\nSAMPLE_INTERVAL: 1000         # how many iterations to wait before sampling (0: never)\r\nSAMPLE_SIZE: 12               # number of images to sample\r\nEVAL_INTERVAL: 0              # how many iterations to wait before model evaluation (0: never)\r\nLOG_INTERVAL: 10              # how many iterations to wait before logging training status (0: never)\r\n\r\n---------------------------------\r\n\r\n\r\nstart training...\r\n\r\n\r\n\r\nTraining epoch: 1\r\n/pytorch/torch/csrc/utils/tensor_numpy.cpp:141: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program.\r\n/pytorch/torch/csrc/utils/tensor_numpy.cpp:141: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program.\r\n/pytorch/torch/csrc/utils/tensor_numpy.cpp:141: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program.\r\n/pytorch/torch/csrc/utils/tensor_numpy.cpp:141: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program.\r\nTraceback (most recent call last):\r\n  File \"/content/edge-connect/train.py\", line 2, in <module>\r\n    main(mode=1)\r\n  File \"/content/edge-connect/main.py\", line 56, in main\r\n    model.train()\r\n  File \"/content/edge-connect/src/edge_connect.py\", line 115, in train\r\n    self.edge_model.backward(gen_loss, dis_loss)\r\n  File \"/content/edge-connect/src/models.py\", line 149, in backward\r\n    gen_loss.backward()\r\n  File \"/usr/local/lib/python3.6/dist-packages/torch/tensor.py\", line 198, in backward\r\n    torch.autograd.backward(self, gradient, retain_graph, create_graph)\r\n  File \"/usr/local/lib/python3.6/dist-packages/torch/autograd/__init__.py\", line 100, in backward\r\n    allow_unreachable=True)  # allow_unreachable flag\r\nRuntimeError: one of the variables needed for gradient computation has been modified by an inplace operation: [torch.cuda.FloatTensor [1, 512, 4, 4]] is at version 2; expected version 1 instead. Hint: enable anomaly detection to find the operation that failed to compute its gradient, with torch.autograd.set_detect_anomaly(True).\r\n\r\n\r\nDid anyone face with that problem? Thank you in advance","closed_by":{"login":"CyrilShch","id":50148272,"node_id":"MDQ6VXNlcjUwMTQ4Mjcy","avatar_url":"https://avatars.githubusercontent.com/u/50148272?v=4","gravatar_id":"","url":"https://api.github.com/users/CyrilShch","html_url":"https://github.com/CyrilShch","followers_url":"https://api.github.com/users/CyrilShch/followers","following_url":"https://api.github.com/users/CyrilShch/following{/other_user}","gists_url":"https://api.github.com/users/CyrilShch/gists{/gist_id}","starred_url":"https://api.github.com/users/CyrilShch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CyrilShch/subscriptions","organizations_url":"https://api.github.com/users/CyrilShch/orgs","repos_url":"https://api.github.com/users/CyrilShch/repos","events_url":"https://api.github.com/users/CyrilShch/events{/privacy}","received_events_url":"https://api.github.com/users/CyrilShch/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/knazeri/edge-connect/issues/152/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/knazeri/edge-connect/issues/152/timeline","performed_via_github_app":null,"state_reason":"completed"}