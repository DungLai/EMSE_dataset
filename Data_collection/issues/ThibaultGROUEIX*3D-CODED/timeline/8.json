[{"url":"https://api.github.com/repos/ThibaultGROUEIX/3D-CODED/issues/comments/469664875","html_url":"https://github.com/ThibaultGROUEIX/3D-CODED/issues/8#issuecomment-469664875","issue_url":"https://api.github.com/repos/ThibaultGROUEIX/3D-CODED/issues/8","id":469664875,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2OTY2NDg3NQ==","user":{"login":"kongsgard","id":13556755,"node_id":"MDQ6VXNlcjEzNTU2NzU1","avatar_url":"https://avatars.githubusercontent.com/u/13556755?v=4","gravatar_id":"","url":"https://api.github.com/users/kongsgard","html_url":"https://github.com/kongsgard","followers_url":"https://api.github.com/users/kongsgard/followers","following_url":"https://api.github.com/users/kongsgard/following{/other_user}","gists_url":"https://api.github.com/users/kongsgard/gists{/gist_id}","starred_url":"https://api.github.com/users/kongsgard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kongsgard/subscriptions","organizations_url":"https://api.github.com/users/kongsgard/orgs","repos_url":"https://api.github.com/users/kongsgard/repos","events_url":"https://api.github.com/users/kongsgard/events{/privacy}","received_events_url":"https://api.github.com/users/kongsgard/received_events","type":"User","site_admin":false},"created_at":"2019-03-05T12:38:48Z","updated_at":"2019-03-05T12:38:48Z","author_association":"NONE","body":"I quickly put together a script for comparison:\r\n```\r\nimport torch\r\nfrom graphs.losses.dist_chamfer import ChamferDist\r\n\r\ncuda0 = torch.device('cuda:0')\r\nx1 = torch.ones([1,2,3], device=cuda0)\r\nx2 = torch.zeros([1,4,3], device=cuda0)\r\n\r\ndistChamfer = ChamferDist()\r\ndist1, dist2 = distChamfer(x1, x2)\r\ndist_total = torch.mean(dist1) + torch.mean(dist2)\r\nprint(\"PyTorch Chamfer Loss:\", dist_total.item())\r\n\r\n\r\nimport numpy as np\r\nfrom sklearn.neighbors import KDTree\r\n\r\ndef chamfer_distance_sklearn(array1,array2):\r\n    batch_size, num_point = array1.shape[:2]\r\n    dist = 0\r\n    for i in range(batch_size):\r\n        tree1 = KDTree(array1[i], leaf_size=num_point+1)\r\n        tree2 = KDTree(array2[i], leaf_size=num_point+1)\r\n        distances1, _ = tree1.query(array2[i])\r\n        distances2, _ = tree2.query(array1[i])\r\n        av_dist1 = np.mean(distances1)\r\n        av_dist2 = np.mean(distances2)\r\n        dist = dist + (av_dist1+av_dist2)/batch_size\r\n    return dist\r\n\r\nx1_np = np.ones([1,2,3])\r\nx2_np = np.zeros([1,4,3])\r\nprint(\"sklearn Chamfer Loss:\", chamfer_distance_sklearn(x1_np, x2_np))\r\n```\r\n\r\nThis returns:\r\nPyTorch Chamfer Loss: 6.0\r\nsklearn Chamfer Loss: 3.46\r\n\r\nManual calculation validates the sklearn output.\r\nIt seems like it's simply a square root that's missing from the PyTorch implementation.\r\nBy calculating the distance with `dist_total = torch.mean(torch.sqrt(dist1)) + torch.mean(torch.sqrt(dist2))` we get the same output.","reactions":{"url":"https://api.github.com/repos/ThibaultGROUEIX/3D-CODED/issues/comments/469664875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kongsgard","id":13556755,"node_id":"MDQ6VXNlcjEzNTU2NzU1","avatar_url":"https://avatars.githubusercontent.com/u/13556755?v=4","gravatar_id":"","url":"https://api.github.com/users/kongsgard","html_url":"https://github.com/kongsgard","followers_url":"https://api.github.com/users/kongsgard/followers","following_url":"https://api.github.com/users/kongsgard/following{/other_user}","gists_url":"https://api.github.com/users/kongsgard/gists{/gist_id}","starred_url":"https://api.github.com/users/kongsgard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kongsgard/subscriptions","organizations_url":"https://api.github.com/users/kongsgard/orgs","repos_url":"https://api.github.com/users/kongsgard/repos","events_url":"https://api.github.com/users/kongsgard/events{/privacy}","received_events_url":"https://api.github.com/users/kongsgard/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ThibaultGROUEIX/3D-CODED/issues/comments/469679805","html_url":"https://github.com/ThibaultGROUEIX/3D-CODED/issues/8#issuecomment-469679805","issue_url":"https://api.github.com/repos/ThibaultGROUEIX/3D-CODED/issues/8","id":469679805,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2OTY3OTgwNQ==","user":{"login":"ThibaultGROUEIX","id":11445067,"node_id":"MDQ6VXNlcjExNDQ1MDY3","avatar_url":"https://avatars.githubusercontent.com/u/11445067?v=4","gravatar_id":"","url":"https://api.github.com/users/ThibaultGROUEIX","html_url":"https://github.com/ThibaultGROUEIX","followers_url":"https://api.github.com/users/ThibaultGROUEIX/followers","following_url":"https://api.github.com/users/ThibaultGROUEIX/following{/other_user}","gists_url":"https://api.github.com/users/ThibaultGROUEIX/gists{/gist_id}","starred_url":"https://api.github.com/users/ThibaultGROUEIX/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ThibaultGROUEIX/subscriptions","organizations_url":"https://api.github.com/users/ThibaultGROUEIX/orgs","repos_url":"https://api.github.com/users/ThibaultGROUEIX/repos","events_url":"https://api.github.com/users/ThibaultGROUEIX/events{/privacy}","received_events_url":"https://api.github.com/users/ThibaultGROUEIX/received_events","type":"User","site_admin":false},"created_at":"2019-03-05T13:30:07Z","updated_at":"2019-03-05T13:30:07Z","author_association":"OWNER","body":"Hi @kongsgard ,\r\nYes, your analysis is correct. It is actually intentional, It corresponds to how we define it in the paper :https://arxiv.org/pdf/1806.05228.pdf\r\nBest regards,\r\nThibault","reactions":{"url":"https://api.github.com/repos/ThibaultGROUEIX/3D-CODED/issues/comments/469679805/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ThibaultGROUEIX","id":11445067,"node_id":"MDQ6VXNlcjExNDQ1MDY3","avatar_url":"https://avatars.githubusercontent.com/u/11445067?v=4","gravatar_id":"","url":"https://api.github.com/users/ThibaultGROUEIX","html_url":"https://github.com/ThibaultGROUEIX","followers_url":"https://api.github.com/users/ThibaultGROUEIX/followers","following_url":"https://api.github.com/users/ThibaultGROUEIX/following{/other_user}","gists_url":"https://api.github.com/users/ThibaultGROUEIX/gists{/gist_id}","starred_url":"https://api.github.com/users/ThibaultGROUEIX/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ThibaultGROUEIX/subscriptions","organizations_url":"https://api.github.com/users/ThibaultGROUEIX/orgs","repos_url":"https://api.github.com/users/ThibaultGROUEIX/repos","events_url":"https://api.github.com/users/ThibaultGROUEIX/events{/privacy}","received_events_url":"https://api.github.com/users/ThibaultGROUEIX/received_events","type":"User","site_admin":false}},{"id":2180966826,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjE4MDk2NjgyNg==","url":"https://api.github.com/repos/ThibaultGROUEIX/3D-CODED/issues/events/2180966826","actor":{"login":"kongsgard","id":13556755,"node_id":"MDQ6VXNlcjEzNTU2NzU1","avatar_url":"https://avatars.githubusercontent.com/u/13556755?v=4","gravatar_id":"","url":"https://api.github.com/users/kongsgard","html_url":"https://github.com/kongsgard","followers_url":"https://api.github.com/users/kongsgard/followers","following_url":"https://api.github.com/users/kongsgard/following{/other_user}","gists_url":"https://api.github.com/users/kongsgard/gists{/gist_id}","starred_url":"https://api.github.com/users/kongsgard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kongsgard/subscriptions","organizations_url":"https://api.github.com/users/kongsgard/orgs","repos_url":"https://api.github.com/users/kongsgard/repos","events_url":"https://api.github.com/users/kongsgard/events{/privacy}","received_events_url":"https://api.github.com/users/kongsgard/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-03-05T13:30:07Z","performed_via_github_app":null},{"id":2180966827,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIxODA5NjY4Mjc=","url":"https://api.github.com/repos/ThibaultGROUEIX/3D-CODED/issues/events/2180966827","actor":{"login":"kongsgard","id":13556755,"node_id":"MDQ6VXNlcjEzNTU2NzU1","avatar_url":"https://avatars.githubusercontent.com/u/13556755?v=4","gravatar_id":"","url":"https://api.github.com/users/kongsgard","html_url":"https://github.com/kongsgard","followers_url":"https://api.github.com/users/kongsgard/followers","following_url":"https://api.github.com/users/kongsgard/following{/other_user}","gists_url":"https://api.github.com/users/kongsgard/gists{/gist_id}","starred_url":"https://api.github.com/users/kongsgard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kongsgard/subscriptions","organizations_url":"https://api.github.com/users/kongsgard/orgs","repos_url":"https://api.github.com/users/kongsgard/repos","events_url":"https://api.github.com/users/kongsgard/events{/privacy}","received_events_url":"https://api.github.com/users/kongsgard/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-03-05T13:30:07Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ThibaultGROUEIX/3D-CODED/issues/comments/469688303","html_url":"https://github.com/ThibaultGROUEIX/3D-CODED/issues/8#issuecomment-469688303","issue_url":"https://api.github.com/repos/ThibaultGROUEIX/3D-CODED/issues/8","id":469688303,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2OTY4ODMwMw==","user":{"login":"kongsgard","id":13556755,"node_id":"MDQ6VXNlcjEzNTU2NzU1","avatar_url":"https://avatars.githubusercontent.com/u/13556755?v=4","gravatar_id":"","url":"https://api.github.com/users/kongsgard","html_url":"https://github.com/kongsgard","followers_url":"https://api.github.com/users/kongsgard/followers","following_url":"https://api.github.com/users/kongsgard/following{/other_user}","gists_url":"https://api.github.com/users/kongsgard/gists{/gist_id}","starred_url":"https://api.github.com/users/kongsgard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kongsgard/subscriptions","organizations_url":"https://api.github.com/users/kongsgard/orgs","repos_url":"https://api.github.com/users/kongsgard/repos","events_url":"https://api.github.com/users/kongsgard/events{/privacy}","received_events_url":"https://api.github.com/users/kongsgard/received_events","type":"User","site_admin":false},"created_at":"2019-03-05T13:56:17Z","updated_at":"2019-03-05T13:56:17Z","author_association":"NONE","body":"I see. Thank you for your response!","reactions":{"url":"https://api.github.com/repos/ThibaultGROUEIX/3D-CODED/issues/comments/469688303/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kongsgard","id":13556755,"node_id":"MDQ6VXNlcjEzNTU2NzU1","avatar_url":"https://avatars.githubusercontent.com/u/13556755?v=4","gravatar_id":"","url":"https://api.github.com/users/kongsgard","html_url":"https://github.com/kongsgard","followers_url":"https://api.github.com/users/kongsgard/followers","following_url":"https://api.github.com/users/kongsgard/following{/other_user}","gists_url":"https://api.github.com/users/kongsgard/gists{/gist_id}","starred_url":"https://api.github.com/users/kongsgard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kongsgard/subscriptions","organizations_url":"https://api.github.com/users/kongsgard/orgs","repos_url":"https://api.github.com/users/kongsgard/repos","events_url":"https://api.github.com/users/kongsgard/events{/privacy}","received_events_url":"https://api.github.com/users/kongsgard/received_events","type":"User","site_admin":false}},{"id":2181037174,"node_id":"MDExOkNsb3NlZEV2ZW50MjE4MTAzNzE3NA==","url":"https://api.github.com/repos/ThibaultGROUEIX/3D-CODED/issues/events/2181037174","actor":{"login":"kongsgard","id":13556755,"node_id":"MDQ6VXNlcjEzNTU2NzU1","avatar_url":"https://avatars.githubusercontent.com/u/13556755?v=4","gravatar_id":"","url":"https://api.github.com/users/kongsgard","html_url":"https://github.com/kongsgard","followers_url":"https://api.github.com/users/kongsgard/followers","following_url":"https://api.github.com/users/kongsgard/following{/other_user}","gists_url":"https://api.github.com/users/kongsgard/gists{/gist_id}","starred_url":"https://api.github.com/users/kongsgard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kongsgard/subscriptions","organizations_url":"https://api.github.com/users/kongsgard/orgs","repos_url":"https://api.github.com/users/kongsgard/repos","events_url":"https://api.github.com/users/kongsgard/events{/privacy}","received_events_url":"https://api.github.com/users/kongsgard/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-03-05T13:56:17Z","state_reason":null,"performed_via_github_app":null},{"id":2794573037,"node_id":"MDEyOkxhYmVsZWRFdmVudDI3OTQ1NzMwMzc=","url":"https://api.github.com/repos/ThibaultGROUEIX/3D-CODED/issues/events/2794573037","actor":{"login":"ThibaultGROUEIX","id":11445067,"node_id":"MDQ6VXNlcjExNDQ1MDY3","avatar_url":"https://avatars.githubusercontent.com/u/11445067?v=4","gravatar_id":"","url":"https://api.github.com/users/ThibaultGROUEIX","html_url":"https://github.com/ThibaultGROUEIX","followers_url":"https://api.github.com/users/ThibaultGROUEIX/followers","following_url":"https://api.github.com/users/ThibaultGROUEIX/following{/other_user}","gists_url":"https://api.github.com/users/ThibaultGROUEIX/gists{/gist_id}","starred_url":"https://api.github.com/users/ThibaultGROUEIX/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ThibaultGROUEIX/subscriptions","organizations_url":"https://api.github.com/users/ThibaultGROUEIX/orgs","repos_url":"https://api.github.com/users/ThibaultGROUEIX/repos","events_url":"https://api.github.com/users/ThibaultGROUEIX/events{/privacy}","received_events_url":"https://api.github.com/users/ThibaultGROUEIX/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-11-13T09:48:38Z","label":{"name":"chamfer","color":"91ce27"},"performed_via_github_app":null}]