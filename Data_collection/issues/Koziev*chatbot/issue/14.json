{"url":"https://api.github.com/repos/Koziev/chatbot/issues/14","repository_url":"https://api.github.com/repos/Koziev/chatbot","labels_url":"https://api.github.com/repos/Koziev/chatbot/issues/14/labels{/name}","comments_url":"https://api.github.com/repos/Koziev/chatbot/issues/14/comments","events_url":"https://api.github.com/repos/Koziev/chatbot/issues/14/events","html_url":"https://github.com/Koziev/chatbot/issues/14","id":442895569,"node_id":"MDU6SXNzdWU0NDI4OTU1Njk=","number":14,"title":"Запуск бота на Flask выдает ошибки","user":{"login":"GraphGrailAi","id":4690353,"node_id":"MDQ6VXNlcjQ2OTAzNTM=","avatar_url":"https://avatars.githubusercontent.com/u/4690353?v=4","gravatar_id":"","url":"https://api.github.com/users/GraphGrailAi","html_url":"https://github.com/GraphGrailAi","followers_url":"https://api.github.com/users/GraphGrailAi/followers","following_url":"https://api.github.com/users/GraphGrailAi/following{/other_user}","gists_url":"https://api.github.com/users/GraphGrailAi/gists{/gist_id}","starred_url":"https://api.github.com/users/GraphGrailAi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GraphGrailAi/subscriptions","organizations_url":"https://api.github.com/users/GraphGrailAi/orgs","repos_url":"https://api.github.com/users/GraphGrailAi/repos","events_url":"https://api.github.com/users/GraphGrailAi/events{/privacy}","received_events_url":"https://api.github.com/users/GraphGrailAi/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2019-05-10T21:08:55Z","updated_at":"2019-05-15T05:16:41Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"При запуске flask_service_bot.py возникали всякие проблемы с путями:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"flask_service_bot.py\", line 87, in <module>\r\n    init_chatbot()\r\n  File \"flask_service_bot.py\", line 40, in init_chatbot\r\n    machine.load_models(w2v_folder, models_folder) # models_folder, w2v_folder было @joomler 10.09.2019\r\nTypeError: load_models() missing 1 required positional argument: 'w2v_folder'\r\n```\r\n\r\nисправил это, строка 40 добавлением data_folder:\r\n`machine.load_models(data_folder, models_folder, w2v_folder)`\r\n\r\nтакже, строка 67, убрал .. :\r\n`parser.add_argument('--tmp_folder', type=str, default='/tmp')`\r\n\r\nПосле этого фласк запустил сервер, подгрузил приветствие, но после ввода текст и отправки вышла ошибка:\r\n\r\n\r\n`\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/flask/app.py\", line 2309, in __call__\r\n\r\n    return self.wsgi_app(environ, start_response)\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/flask/app.py\", line 2295, in wsgi_app\r\n\r\n    response = self.handle_exception(e)\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/flask/app.py\", line 1741, in handle_exception\r\n\r\n    reraise(exc_type, exc_value, tb)\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/flask/_compat.py\", line 35, in reraise\r\n\r\n    raise value\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/flask/app.py\", line 2292, in wsgi_app\r\n\r\n    response = self.full_dispatch_request()\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/flask/app.py\", line 1815, in full_dispatch_request\r\n\r\n    rv = self.handle_user_exception(e)\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/flask/app.py\", line 1718, in handle_user_exception\r\n\r\n    reraise(exc_type, exc_value, tb)\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/flask/_compat.py\", line 35, in reraise\r\n\r\n    raise value\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/flask/app.py\", line 1813, in full_dispatch_request\r\n\r\n    rv = self.dispatch_request()\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/flask/app.py\", line 1799, in dispatch_request\r\n\r\n    return self.view_functions[rule.endpoint](**req.view_args)\r\n\r\n    File \"/home/joo/Документы/LocalRepository/chatbot-koziev-master/PyModels/bot_service/routes.py\", line 60, in index\r\n\r\n    bot.push_phrase(user_id, utterance)\r\n\r\n    File \"/home/joo/Документы/LocalRepository/chatbot-koziev-master/PyModels/bot/bot_personality.py\", line 42, in push_phrase\r\n\r\n    self.engine.push_phrase(self, user_id, question)\r\n\r\n    File \"/home/joo/Документы/LocalRepository/chatbot-koziev-master/PyModels/bot/simple_answering_machine.py\", line 291, in push_phrase\r\n\r\n    interpreted_phrase = self.interpret_phrase(bot, session, question)\r\n\r\n    File \"/home/joo/Документы/LocalRepository/chatbot-koziev-master/PyModels/bot/simple_answering_machine.py\", line 208, in interpret_phrase\r\n\r\n    self.word_embeddings):\r\n\r\n    File \"/home/joo/Документы/LocalRepository/chatbot-koziev-master/PyModels/bot/nn_req_interpretation.py\", line 59, in require_interpretation\r\n\r\n    y_pred = self.model.predict(x=X_batch, verbose=0)\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/keras/engine/training.py\", line 1164, in predict\r\n\r\n    self._make_predict_function()\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/keras/engine/training.py\", line 554, in _make_predict_function\r\n\r\n    **kwargs)\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py\", line 2744, in function\r\n\r\n    return Function(inputs, outputs, updates=updates, **kwargs)\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py\", line 2546, in __init__\r\n\r\n    with tf.control_dependencies(self.outputs):\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 5004, in control_dependencies\r\n\r\n    return get_default_graph().control_dependencies(control_inputs)\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 4543, in control_dependencies\r\n\r\n    c = self.as_graph_element(c)\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3490, in as_graph_element\r\n\r\n    return self._as_graph_element_locked(obj, allow_tensor, allow_operation)\r\n\r\n    File \"/home/joo/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3569, in _as_graph_element_locked\r\n\r\n    raise ValueError(\"Tensor %s is not an element of this graph.\" % obj)\r\n\r\n    ValueError: Tensor Tensor(\"output_1/Softmax:0\", shape=(?, 2), dtype=float32) is not an element of this graph.\r\n\r\n`\r\n\r\nНичего не трогал в моделях, поэтому тут что-то с фласком, не так подгружает что-то","closed_by":null,"reactions":{"url":"https://api.github.com/repos/Koziev/chatbot/issues/14/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Koziev/chatbot/issues/14/timeline","performed_via_github_app":null,"state_reason":null}