[{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1175718385","html_url":"https://github.com/voxelmorph/voxelmorph/issues/450#issuecomment-1175718385","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/450","id":1175718385,"node_id":"IC_kwDOB_Nd285GFAnx","user":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false},"created_at":"2022-07-06T02:47:04Z","updated_at":"2022-07-06T02:47:04Z","author_association":"NONE","body":"Hi @Fjr9516, I don't have the exact same issue but I find it weird that the atlas generation model actually adds the rough template to the decoded atlas at the very last step before outputting. The issue I am facing right now is that the atlas generation model seems to ignore the decoded attributes and produces atlases that look just like the rough template. ","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1175718385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false}},{"id":6938870693,"node_id":"MEE_lADOB_Nd285NGlTCzwAAAAGdlsOl","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6938870693","actor":{"login":"Fjr9516","id":31833999,"node_id":"MDQ6VXNlcjMxODMzOTk5","avatar_url":"https://avatars.githubusercontent.com/u/31833999?v=4","gravatar_id":"","url":"https://api.github.com/users/Fjr9516","html_url":"https://github.com/Fjr9516","followers_url":"https://api.github.com/users/Fjr9516/followers","following_url":"https://api.github.com/users/Fjr9516/following{/other_user}","gists_url":"https://api.github.com/users/Fjr9516/gists{/gist_id}","starred_url":"https://api.github.com/users/Fjr9516/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fjr9516/subscriptions","organizations_url":"https://api.github.com/users/Fjr9516/orgs","repos_url":"https://api.github.com/users/Fjr9516/repos","events_url":"https://api.github.com/users/Fjr9516/events{/privacy}","received_events_url":"https://api.github.com/users/Fjr9516/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-06T02:47:05Z","performed_via_github_app":null},{"id":6938870696,"node_id":"SE_lADOB_Nd285NGlTCzwAAAAGdlsOo","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6938870696","actor":{"login":"Fjr9516","id":31833999,"node_id":"MDQ6VXNlcjMxODMzOTk5","avatar_url":"https://avatars.githubusercontent.com/u/31833999?v=4","gravatar_id":"","url":"https://api.github.com/users/Fjr9516","html_url":"https://github.com/Fjr9516","followers_url":"https://api.github.com/users/Fjr9516/followers","following_url":"https://api.github.com/users/Fjr9516/following{/other_user}","gists_url":"https://api.github.com/users/Fjr9516/gists{/gist_id}","starred_url":"https://api.github.com/users/Fjr9516/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fjr9516/subscriptions","organizations_url":"https://api.github.com/users/Fjr9516/orgs","repos_url":"https://api.github.com/users/Fjr9516/repos","events_url":"https://api.github.com/users/Fjr9516/events{/privacy}","received_events_url":"https://api.github.com/users/Fjr9516/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-07-06T02:47:05Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1176285817","html_url":"https://github.com/voxelmorph/voxelmorph/issues/450#issuecomment-1176285817","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/450","id":1176285817,"node_id":"IC_kwDOB_Nd285GHLJ5","user":{"login":"Fjr9516","id":31833999,"node_id":"MDQ6VXNlcjMxODMzOTk5","avatar_url":"https://avatars.githubusercontent.com/u/31833999?v=4","gravatar_id":"","url":"https://api.github.com/users/Fjr9516","html_url":"https://github.com/Fjr9516","followers_url":"https://api.github.com/users/Fjr9516/followers","following_url":"https://api.github.com/users/Fjr9516/following{/other_user}","gists_url":"https://api.github.com/users/Fjr9516/gists{/gist_id}","starred_url":"https://api.github.com/users/Fjr9516/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fjr9516/subscriptions","organizations_url":"https://api.github.com/users/Fjr9516/orgs","repos_url":"https://api.github.com/users/Fjr9516/repos","events_url":"https://api.github.com/users/Fjr9516/events{/privacy}","received_events_url":"https://api.github.com/users/Fjr9516/received_events","type":"User","site_admin":false},"created_at":"2022-07-06T14:22:16Z","updated_at":"2022-07-06T14:22:16Z","author_association":"NONE","body":"> Hi @Fjr9516, I don't have the exact same issue but I find it weird that the atlas generation model actually adds the rough template to the decoded atlas at the very last step before outputting. The issue I am facing right now is that the atlas generation model seems to ignore the decoded attributes and produces atlases that look just like the rough template.\r\n\r\nHi, I think we are facing the same issue. I showed the outputs from \"atlas_gen\" directly, while you showed the outputs of the \"atlas\" layer. The only difference is whether the rough template is added to the decoded atlas. If you are also trying to use the provided pre-trained weights, my guess is they provided the wrong one.","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1176285817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Fjr9516","id":31833999,"node_id":"MDQ6VXNlcjMxODMzOTk5","avatar_url":"https://avatars.githubusercontent.com/u/31833999?v=4","gravatar_id":"","url":"https://api.github.com/users/Fjr9516","html_url":"https://github.com/Fjr9516","followers_url":"https://api.github.com/users/Fjr9516/followers","following_url":"https://api.github.com/users/Fjr9516/following{/other_user}","gists_url":"https://api.github.com/users/Fjr9516/gists{/gist_id}","starred_url":"https://api.github.com/users/Fjr9516/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fjr9516/subscriptions","organizations_url":"https://api.github.com/users/Fjr9516/orgs","repos_url":"https://api.github.com/users/Fjr9516/repos","events_url":"https://api.github.com/users/Fjr9516/events{/privacy}","received_events_url":"https://api.github.com/users/Fjr9516/received_events","type":"User","site_admin":false}},{"id":6943302620,"node_id":"MEE_lADOB_Nd285NGlTCzwAAAAGd2mPc","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6943302620","actor":{"login":"Fjr9516","id":31833999,"node_id":"MDQ6VXNlcjMxODMzOTk5","avatar_url":"https://avatars.githubusercontent.com/u/31833999?v=4","gravatar_id":"","url":"https://api.github.com/users/Fjr9516","html_url":"https://github.com/Fjr9516","followers_url":"https://api.github.com/users/Fjr9516/followers","following_url":"https://api.github.com/users/Fjr9516/following{/other_user}","gists_url":"https://api.github.com/users/Fjr9516/gists{/gist_id}","starred_url":"https://api.github.com/users/Fjr9516/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fjr9516/subscriptions","organizations_url":"https://api.github.com/users/Fjr9516/orgs","repos_url":"https://api.github.com/users/Fjr9516/repos","events_url":"https://api.github.com/users/Fjr9516/events{/privacy}","received_events_url":"https://api.github.com/users/Fjr9516/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-06T14:22:17Z","performed_via_github_app":null},{"id":6943302628,"node_id":"SE_lADOB_Nd285NGlTCzwAAAAGd2mPk","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6943302628","actor":{"login":"Fjr9516","id":31833999,"node_id":"MDQ6VXNlcjMxODMzOTk5","avatar_url":"https://avatars.githubusercontent.com/u/31833999?v=4","gravatar_id":"","url":"https://api.github.com/users/Fjr9516","html_url":"https://github.com/Fjr9516","followers_url":"https://api.github.com/users/Fjr9516/followers","following_url":"https://api.github.com/users/Fjr9516/following{/other_user}","gists_url":"https://api.github.com/users/Fjr9516/gists{/gist_id}","starred_url":"https://api.github.com/users/Fjr9516/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fjr9516/subscriptions","organizations_url":"https://api.github.com/users/Fjr9516/orgs","repos_url":"https://api.github.com/users/Fjr9516/repos","events_url":"https://api.github.com/users/Fjr9516/events{/privacy}","received_events_url":"https://api.github.com/users/Fjr9516/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-07-06T14:22:17Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1176289897","html_url":"https://github.com/voxelmorph/voxelmorph/issues/450#issuecomment-1176289897","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/450","id":1176289897,"node_id":"IC_kwDOB_Nd285GHMJp","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2022-07-06T14:25:45Z","updated_at":"2022-07-06T14:25:45Z","author_association":"COLLABORATOR","body":"hmm, did either/both of you use the code in the colab? It might be helpful to try to debug/figure this out with something simple like MNIST.\r\n\r\n@kvttt the reason to we add the initial rough template is that it acts like an \"initialization\", in a sense having the atlas part of the network learn just the residual.","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1176289897/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"id":6943332089,"node_id":"MEE_lADOB_Nd285NGlTCzwAAAAGd2tb5","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6943332089","actor":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-06T14:25:45Z","performed_via_github_app":null},{"id":6943332099,"node_id":"SE_lADOB_Nd285NGlTCzwAAAAGd2tcD","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6943332099","actor":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-07-06T14:25:45Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1176365494","html_url":"https://github.com/voxelmorph/voxelmorph/issues/450#issuecomment-1176365494","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/450","id":1176365494,"node_id":"IC_kwDOB_Nd285GHem2","user":{"login":"Fjr9516","id":31833999,"node_id":"MDQ6VXNlcjMxODMzOTk5","avatar_url":"https://avatars.githubusercontent.com/u/31833999?v=4","gravatar_id":"","url":"https://api.github.com/users/Fjr9516","html_url":"https://github.com/Fjr9516","followers_url":"https://api.github.com/users/Fjr9516/followers","following_url":"https://api.github.com/users/Fjr9516/following{/other_user}","gists_url":"https://api.github.com/users/Fjr9516/gists{/gist_id}","starred_url":"https://api.github.com/users/Fjr9516/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fjr9516/subscriptions","organizations_url":"https://api.github.com/users/Fjr9516/orgs","repos_url":"https://api.github.com/users/Fjr9516/repos","events_url":"https://api.github.com/users/Fjr9516/events{/privacy}","received_events_url":"https://api.github.com/users/Fjr9516/received_events","type":"User","site_admin":false},"created_at":"2022-07-06T15:29:51Z","updated_at":"2022-07-06T15:29:51Z","author_association":"NONE","body":"> hmm, did either/both of you use the code in the colab? It might be helpful to try to debug/figure this out with something simple like MNIST.\r\n> \r\n> @kvttt the reason to we add the initial rough template is that it acts like an \"initialization\", in a sense having the atlas part of the network learn just the residual.\r\n\r\nHi, thanks for your reply! I used the code in the GitHub repo and wrote test code by myself. And the pre-trained weights file was downloaded via this link: http://people.csail.mit.edu/adalca/voxelmorph/atlas_creation_cond_NCC_1022.h5. Actually, I have tried the MNIST demo you put in the colab and successfully tried MNIST model. Thanks for providing that, it is useful. But it should be more useful to use your pre-trained weights since my interest is the brain. But when I used the Model in h5 format weights you provided (conditional atlas), the outputs from the \"atlas_gen\" layer only give me noisy maps no matter the input attributes.  \r\n\r\nThe test code is shown here:\r\n```\r\n        pheno_shape = 14 # number of attributes, 7 ages for male and 7 for female\r\n        inshape = (160,  192, 224)  # (160, 192, 224)\r\n        nfeats = 1\r\n        # build the model\r\n        model = vxm.networks.ConditionalTemplateCreation(\r\n            inshape,\r\n            pheno_input_shape=pheno_shape,\r\n            nb_unet_features=[enc_nf, dec_nf],\r\n            conv_nb_features=4,\r\n            conv_nb_levels=0,\r\n            extra_conv_layers=3,\r\n            src_feats=nfeats,\r\n            trg_feats=nfeats\r\n        )\r\n \r\n        # load pre-trained weights\r\n        model_weights = os.path.abspath(\"../weights/atlas_creation_cond_NCC_1022.h5\")\r\n        model.load_weights(model_weights, by_name=True, skip_mismatch=True)\r\n \r\n        # extract atlas_model\r\n        atlas_gen_model = tf.keras.models.Model(model.inputs[:1], model.get_layer('atlas_gen').output)\r\n\r\n        input_samples = [tf.keras.utils.to_categorical(np.arange(pheno_shape), pheno_shape)]\r\n        pred = atlas_gen_model.predict(input_samples)\r\n```\r\nAnd the outputs look like this:\r\n![1657121351085](https://user-images.githubusercontent.com/31833999/177587644-740d64c7-87bc-47bf-aa2b-e0d664280395.png)\r\nAny suggestion would be grateful!\r\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1176365494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Fjr9516","id":31833999,"node_id":"MDQ6VXNlcjMxODMzOTk5","avatar_url":"https://avatars.githubusercontent.com/u/31833999?v=4","gravatar_id":"","url":"https://api.github.com/users/Fjr9516","html_url":"https://github.com/Fjr9516","followers_url":"https://api.github.com/users/Fjr9516/followers","following_url":"https://api.github.com/users/Fjr9516/following{/other_user}","gists_url":"https://api.github.com/users/Fjr9516/gists{/gist_id}","starred_url":"https://api.github.com/users/Fjr9516/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fjr9516/subscriptions","organizations_url":"https://api.github.com/users/Fjr9516/orgs","repos_url":"https://api.github.com/users/Fjr9516/repos","events_url":"https://api.github.com/users/Fjr9516/events{/privacy}","received_events_url":"https://api.github.com/users/Fjr9516/received_events","type":"User","site_admin":false}},{"id":6943865657,"node_id":"MEE_lADOB_Nd285NGlTCzwAAAAGd4vs5","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6943865657","actor":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-06T15:29:51Z","performed_via_github_app":null},{"id":6943865660,"node_id":"SE_lADOB_Nd285NGlTCzwAAAAGd4vs8","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6943865660","actor":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-07-06T15:29:51Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1176378920","html_url":"https://github.com/voxelmorph/voxelmorph/issues/450#issuecomment-1176378920","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/450","id":1176378920,"node_id":"IC_kwDOB_Nd285GHh4o","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2022-07-06T15:42:14Z","updated_at":"2022-07-06T15:42:14Z","author_association":"COLLABORATOR","body":"Oh I wonder if the code has changed substantially since we made those \nweights and that's why. You have \"skip_mismatch=True\", I'm assuming that \nmeans that it doesn't load weights in certain scenarios? SO perhaps it's \nnot loading the weights?\n\nOn 7/6/2022 11:30 AM, Fjr9516 wrote:\n>\n>     hmm, did either/both of you use the code in the colab? It might be\n>     helpful to try to debug/figure this out with something simple like\n>     MNIST.\n>\n>     @kvttt <https://github.com/kvttt> the reason to we add the initial\n>     rough template is that it acts like an \"initialization\", in a\n>     sense having the atlas part of the network learn just the residual.\n>\n> Hi, thanks for your reply! I used the code in the GitHub repo and \n> wrote test code by myself. And the pre-trained weights file was \n> downloaded via this link: \n> http://people.csail.mit.edu/adalca/voxelmorph/atlas_creation_cond_NCC_1022.h5. \n> Actually, I have tried the MNIST demo you put in the colab and \n> successfully tried MNIST model. Thanks for providing that, it is \n> useful. But it should be more useful to use your pre-trained weights \n> since my interest is the brain. But when I used the Model in h5 format \n> weights you provided (conditional atlas), the outputs from the \n> \"atlas_gen\" layer only give me noisy maps no matter the input attributes.\n>\n> The test code is shown here:\n>\n> |pheno_shape = 14 # number of attributes, 7 ages for male and 7 for \n> female inshape = (160, 192, 224) # (160, 192, 224) nfeats = 1 # build \n> the model model = vxm.networks.ConditionalTemplateCreation( inshape, \n> pheno_input_shape=pheno_shape, nb_unet_features=[enc_nf, dec_nf], \n> conv_nb_features=4, conv_nb_levels=0, extra_conv_layers=3, \n> src_feats=nfeats, trg_feats=nfeats ) # load pre-trained weights \n> model_weights = \n> os.path.abspath(\"../weights/atlas_creation_cond_NCC_1022.h5\") \n> model.load_weights(model_weights, by_name=True, skip_mismatch=True) # \n> extract atlas_model atlas_gen_model = \n> tf.keras.models.Model(model.inputs[:1], \n> model.get_layer('atlas_gen').output) input_samples = \n> [tf.keras.utils.to_categorical(np.arange(pheno_shape), pheno_shape)] \n> pred = atlas_gen_model.predict(input_samples) |\n>\n> And the outputs look like this:\n> 1657121351085 \n> <https://user-images.githubusercontent.com/31833999/177587644-740d64c7-87bc-47bf-aa2b-e0d664280395.png>\n> Any suggestion would be grateful!\n>\n> —\n> Reply to this email directly, view it on GitHub \n> <https://github.com/voxelmorph/voxelmorph/issues/450#issuecomment-1176365494>, \n> or unsubscribe \n> <https://github.com/notifications/unsubscribe-auth/AAYSBW5CJAMI3EI5WA3KZNTVSWQ7VANCNFSM52UGYI5A>.\n> You are receiving this because you commented.Message ID: \n> ***@***.***>\n>","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1176378920/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"id":6943964179,"node_id":"MEE_lADOB_Nd285NGlTCzwAAAAGd5HwT","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6943964179","actor":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-06T15:42:14Z","performed_via_github_app":null},{"id":6943964187,"node_id":"SE_lADOB_Nd285NGlTCzwAAAAGd5Hwb","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6943964187","actor":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-07-06T15:42:14Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1176755385","html_url":"https://github.com/voxelmorph/voxelmorph/issues/450#issuecomment-1176755385","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/450","id":1176755385,"node_id":"IC_kwDOB_Nd285GI9y5","user":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false},"created_at":"2022-07-06T21:14:57Z","updated_at":"2022-07-06T21:14:57Z","author_association":"NONE","body":"Hi @Fjr9516, I think I'm doing the same task as yours except that I am training from scratch on my own data. I have run 200 epochs so far. The losses seem to converge and the atlas I'm getting looks similar to the rough template from average. But as @adalca mentioned, I think the model did learned the residual. Attached are the residual between the final output and rough template, the rough template, and the final atlas.\n\n![image](https://user-images.githubusercontent.com/99367900/177643922-73656c80-9a3e-45ee-861a-bb293046c68a.png)\n\n![image](https://user-images.githubusercontent.com/99367900/177643940-1466fc07-74aa-4a39-9b08-9621283fecf3.png)\n\n![image](https://user-images.githubusercontent.com/99367900/177643952-cea96cfa-898c-4cb0-a933-8a9fb09e5581.png)\n\nWith that being said, I think your problem probably has to do with parameters not properly loaded, because the model seems to be working as expected when I am training from scratch. \n\nAnd by the way, @adalca thanks for the clarification!\n\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1176755385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false}},{"id":6946459091,"node_id":"MEE_lADOB_Nd285NGlTCzwAAAAGeCo3T","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6946459091","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-06T21:14:58Z","performed_via_github_app":null},{"id":6946459099,"node_id":"SE_lADOB_Nd285NGlTCzwAAAAGeCo3b","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6946459099","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-07-06T21:14:58Z","performed_via_github_app":null},{"id":6946459112,"node_id":"MEE_lADOB_Nd285NGlTCzwAAAAGeCo3o","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6946459112","actor":{"login":"Fjr9516","id":31833999,"node_id":"MDQ6VXNlcjMxODMzOTk5","avatar_url":"https://avatars.githubusercontent.com/u/31833999?v=4","gravatar_id":"","url":"https://api.github.com/users/Fjr9516","html_url":"https://github.com/Fjr9516","followers_url":"https://api.github.com/users/Fjr9516/followers","following_url":"https://api.github.com/users/Fjr9516/following{/other_user}","gists_url":"https://api.github.com/users/Fjr9516/gists{/gist_id}","starred_url":"https://api.github.com/users/Fjr9516/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fjr9516/subscriptions","organizations_url":"https://api.github.com/users/Fjr9516/orgs","repos_url":"https://api.github.com/users/Fjr9516/repos","events_url":"https://api.github.com/users/Fjr9516/events{/privacy}","received_events_url":"https://api.github.com/users/Fjr9516/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-06T21:14:58Z","performed_via_github_app":null},{"id":6946459121,"node_id":"SE_lADOB_Nd285NGlTCzwAAAAGeCo3x","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6946459121","actor":{"login":"Fjr9516","id":31833999,"node_id":"MDQ6VXNlcjMxODMzOTk5","avatar_url":"https://avatars.githubusercontent.com/u/31833999?v=4","gravatar_id":"","url":"https://api.github.com/users/Fjr9516","html_url":"https://github.com/Fjr9516","followers_url":"https://api.github.com/users/Fjr9516/followers","following_url":"https://api.github.com/users/Fjr9516/following{/other_user}","gists_url":"https://api.github.com/users/Fjr9516/gists{/gist_id}","starred_url":"https://api.github.com/users/Fjr9516/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fjr9516/subscriptions","organizations_url":"https://api.github.com/users/Fjr9516/orgs","repos_url":"https://api.github.com/users/Fjr9516/repos","events_url":"https://api.github.com/users/Fjr9516/events{/privacy}","received_events_url":"https://api.github.com/users/Fjr9516/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-07-06T21:14:58Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1177604967","html_url":"https://github.com/voxelmorph/voxelmorph/issues/450#issuecomment-1177604967","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/450","id":1177604967,"node_id":"IC_kwDOB_Nd285GMNNn","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2022-07-07T13:21:16Z","updated_at":"2022-07-07T13:21:23Z","author_association":"COLLABORATOR","body":"@kvttt just so i understand, the last image you showed is the final template when trained from scrach? That certainly seems much blurrier than I would expect. ","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1177604967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"id":6951750740,"node_id":"MEE_lADOB_Nd285NGlTCzwAAAAGeW0xU","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6951750740","actor":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-07T13:21:16Z","performed_via_github_app":null},{"id":6951750748,"node_id":"SE_lADOB_Nd285NGlTCzwAAAAGeW0xc","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6951750748","actor":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-07-07T13:21:16Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1177632198","html_url":"https://github.com/voxelmorph/voxelmorph/issues/450#issuecomment-1177632198","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/450","id":1177632198,"node_id":"IC_kwDOB_Nd285GMT3G","user":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false},"created_at":"2022-07-07T13:40:03Z","updated_at":"2022-07-07T13:40:03Z","author_association":"NONE","body":"> @kvttt just so i understand, the last image you showed is the final template when trained from scrach? That certainly seems much blurrier than I would expect. \n\nYes. And to provide more details, I only trained for around 200 epochs to get this template. And previously, I have training the rest of the network (the UNet portion) separately as a registration network. And I am currently fixing the parameters of the registration network and tuning the parameters of the conditional template creation network. In addition, I am testing the effect of another loss on the result and I am simultaneously running a control experiment without that loss (i.e. using only similarity loss for this step). Finally, I am implementing all this using PyTorch. So, there is a lot of stuff that could go wrong. I will update on how it goes after I finished training.","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1177632198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false}},{"id":6951926665,"node_id":"MEE_lADOB_Nd285NGlTCzwAAAAGeXfuJ","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6951926665","actor":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-07T13:40:03Z","performed_via_github_app":null},{"id":6951926672,"node_id":"SE_lADOB_Nd285NGlTCzwAAAAGeXfuQ","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6951926672","actor":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-07-07T13:40:03Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1177807828","html_url":"https://github.com/voxelmorph/voxelmorph/issues/450#issuecomment-1177807828","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/450","id":1177807828,"node_id":"IC_kwDOB_Nd285GM-vU","user":{"login":"Fjr9516","id":31833999,"node_id":"MDQ6VXNlcjMxODMzOTk5","avatar_url":"https://avatars.githubusercontent.com/u/31833999?v=4","gravatar_id":"","url":"https://api.github.com/users/Fjr9516","html_url":"https://github.com/Fjr9516","followers_url":"https://api.github.com/users/Fjr9516/followers","following_url":"https://api.github.com/users/Fjr9516/following{/other_user}","gists_url":"https://api.github.com/users/Fjr9516/gists{/gist_id}","starred_url":"https://api.github.com/users/Fjr9516/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fjr9516/subscriptions","organizations_url":"https://api.github.com/users/Fjr9516/orgs","repos_url":"https://api.github.com/users/Fjr9516/repos","events_url":"https://api.github.com/users/Fjr9516/events{/privacy}","received_events_url":"https://api.github.com/users/Fjr9516/received_events","type":"User","site_admin":false},"created_at":"2022-07-07T15:36:53Z","updated_at":"2022-07-07T15:36:53Z","author_association":"NONE","body":"Hi @kvttt and @adalca, thanks for your replies! I think you are all right, the load_weights() function didn't work properly. It's caused by different settings between the trained model and the source code in the repo, where I previously assumed they were the same. Based on my investigation of the provided weights, I found that your model sets the input attribute size at 2. But according to the paper, you said \"For conditional template, we do this for 7 ages equally spaced between 15 and 90 years old, for both males and females\". Therefore, you should have seven attributes. Could you elaborate on how these two pheno sizes can represent seven different attributes? Any suggestion would be grateful!","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/1177807828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Fjr9516","id":31833999,"node_id":"MDQ6VXNlcjMxODMzOTk5","avatar_url":"https://avatars.githubusercontent.com/u/31833999?v=4","gravatar_id":"","url":"https://api.github.com/users/Fjr9516","html_url":"https://github.com/Fjr9516","followers_url":"https://api.github.com/users/Fjr9516/followers","following_url":"https://api.github.com/users/Fjr9516/following{/other_user}","gists_url":"https://api.github.com/users/Fjr9516/gists{/gist_id}","starred_url":"https://api.github.com/users/Fjr9516/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fjr9516/subscriptions","organizations_url":"https://api.github.com/users/Fjr9516/orgs","repos_url":"https://api.github.com/users/Fjr9516/repos","events_url":"https://api.github.com/users/Fjr9516/events{/privacy}","received_events_url":"https://api.github.com/users/Fjr9516/received_events","type":"User","site_admin":false}},{"id":6953016328,"node_id":"MEE_lADOB_Nd285NGlTCzwAAAAGebpwI","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6953016328","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-07T15:36:53Z","performed_via_github_app":null},{"id":6953016338,"node_id":"SE_lADOB_Nd285NGlTCzwAAAAGebpwS","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6953016338","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-07-07T15:36:53Z","performed_via_github_app":null},{"id":6953016348,"node_id":"MEE_lADOB_Nd285NGlTCzwAAAAGebpwc","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/6953016348","actor":{"login":"kvttt","id":99367900,"node_id":"U_kgDOBew73A","avatar_url":"https://avatars.githubusercontent.com/u/99367900?v=4","gravatar_id":"","url":"https://api.github.com/users/kvttt","html_url":"https://github.com/kvttt","followers_url":"https://api.github.com/users/kvttt/followers","following_url":"https://api.github.com/users/kvttt/following{/other_user}","gists_url":"https://api.github.com/users/kvttt/gists{/gist_id}","starred_url":"https://api.github.com/users/kvttt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kvttt/subscriptions","organizations_url":"https://api.github.com/users/kvttt/orgs","repos_url":"https://api.github.com/users/kvttt/repos","events_url":"https://api.github.com/users/kvttt/events{/privacy}","received_events_url":"https://api.github.com/users/kvttt/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-07T15:36:53Z","performed_via_github_app":null}]