[{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/825323044","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-825323044","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":825323044,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNTMyMzA0NA==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2021-04-23T01:41:46Z","updated_at":"2021-04-23T01:41:46Z","author_association":"COLLABORATOR","body":"the `src`, `trg`, and `img` still have to be in keras size -- so in this case, `[1, 256, 256, 64, 1]`","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/825323044/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828302894","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828302894","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828302894,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODMwMjg5NA==","user":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T09:26:07Z","updated_at":"2021-04-28T09:26:07Z","author_association":"NONE","body":"Hello,\r\nI reshaped my arrays to [1,256,256,64,1] and applied the \"apply_transform\" function on it but the predicted transformation is all zeroes.\r\ntransformed_image = vxm_model.apply_transform(src, trg, img, interp_method='nearest')\r\n\r\nsrc: the original moving image [1,256,256,64,1]\r\ntrg: moved predicted image [1,256,256,64,1]\r\nimg: segmentation image to be warped [1,256,256,64,1]\r\ntransformed_image: [0..0] of shape [1,256,256,64,1]\r\n\r\nI'm not sure what could I be doing wrong here. As my predictions for the moved_image seems fine. Thanks for your help.","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828302894/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828420772","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828420772","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828420772,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODQyMDc3Mg==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T12:38:34Z","updated_at":"2021-04-28T12:38:34Z","author_association":"COLLABORATOR","body":"@Kanyq can you please share some screenshots or something like that? Also, how was the model trained?","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828420772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"id":4656579052,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDY1NjU3OTA1Mg==","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/4656579052","actor":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-28T12:38:34Z","performed_via_github_app":null},{"id":4656579055,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ2NTY1NzkwNTU=","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/4656579055","actor":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-28T12:38:34Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828448105","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828448105","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828448105,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODQ0ODEwNQ==","user":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T13:18:09Z","updated_at":"2021-04-28T13:18:09Z","author_association":"NONE","body":"The model was trained on 256,256,64 image resolution which was intensity normalized in the range [0,1]. \r\nfor convulational layer: kernel_size = 3, padding = \"same\"\r\n\r\nI have modified the **data generator** to suit my project needs: our data is a numpy array of moving and fix images (moving images are on even indexes like 0,2,4.. and their corresponding fix images on odd indexes like 1,3,5.. respectively).\r\n```\r\nidx1 = np.random.randint(0, x_data.shape[0], size=batch_size)  #batch_size=1\r\n        if idx1%2 == 0:   #for even idx1 we're using it as moving image index and idx+1 as fixed image index\r\n            moving_images = x_data[idx1, ..., np.newaxis]\r\n            fixed_images = x_data[idx1+1, ..., np.newaxis]\r\n        else:   #for odd idx1 we're using it as fix image index and idx-1 as moving image index\r\n            moving_images = x_data[idx1-1, ..., np.newaxis]\r\n            fixed_images = x_data[idx1, ..., np.newaxis]\r\ninputs = [moving_images, fixed_images]\r\n\r\n```\r\nFor \"**vxm_model**\": vxm_model = vxm.networks.VxmDense(vol_shape, nb_features, int_steps=0)\r\nvol_shape: 256,256,64\r\nnb_features = [\r\n    [16, 32 , 32, 32],         # encoder features\r\n    [32, 32 , 32, 32, 32, 16, 16]  # decoder features\r\n]\r\n\r\n**Losses:**\r\nlosses = ['mse', vxm.losses.Grad('l2').loss]\r\nloss_weights = [1, 0.01]\r\n\r\n**Optimizer:**\r\noptimizer=tf.keras.optimizers.Adam(lr=1e-3)\r\n\r\n**Training:**\r\nepochs: 30 epochs\r\nsteps_per_epochs: 88 (There are 88 training images, 44 pairs and since I'm using a batch_size of 1, I went with 88 SPE)\r\n\r\n**Training loss plot:** Final loss: 0.271\r\n![loss](https://user-images.githubusercontent.com/14558146/116408686-666ab600-a833-11eb-8b94-95537b3fa0d6.png)\r\n\r\n**Model Prediction:**\r\n![prediction](https://user-images.githubusercontent.com/14558146/116408797-8306ee00-a833-11eb-90b8-26b0f73ae9d4.png)\r\n\r\n**apply_transform on segmentation image:** Range[-1,1]\r\n![Screenshot 2021-04-28 at 14 52 56](https://user-images.githubusercontent.com/14558146/116408932-a5007080-a833-11eb-914a-e51a1c1883b4.png)\r\n\r\n**Segmentation warping:**\r\n![seg](https://user-images.githubusercontent.com/14558146/116409752-7040e900-a834-11eb-8469-c95059ead822.png)\r\n\r\nThe segmentation warping was generated using:\r\nwarped_seg_mov = warp_model.predict([segmentation_array[17][np.newaxis,...,np.newaxis], pred_warp])\r\nsegmentation_array[17]: moving segmentation image of size 256,256,64\r\npred_warp: \r\nval_pred = vxm_model.predict(val_input)\r\nmoved_pred = val_pred[0].squeeze() #This is the predicted moving image\r\npred_warp = val_pred[1] #This is used as warping for segmentation images\r\n\r\nLet me know if you need anymore information from me. Thank you\r\n\r\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828448105/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828456951","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828456951","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828456951,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODQ1Njk1MQ==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T13:30:41Z","updated_at":"2021-04-28T13:30:41Z","author_association":"COLLABORATOR","body":"Thanks. A couple of quick question/comments:\r\n\r\n- I would recommend just grabbing 2 random images at each iteration, rather than the odd/even scheme you have. It should give you much richer models\r\n- What is `warp_model` exactly in your case? I thought you said you used `apply_transform`?\r\n- Can you try the apply transform route to warp the image as well (not just the segmentation) and see how that comes out?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828456951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828464144","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828464144","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828464144,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODQ2NDE0NA==","user":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T13:40:19Z","updated_at":"2021-04-28T13:42:14Z","author_association":"NONE","body":"- Okay, but if I grab 2 random images it's possible that I grab two fixed or two moving images also it's possible that I grab a different fixed image and a different moving image. Wouldn't that train the model wrong? Since we want to learn transformation from moving to fixed, shouldn't we pick the images in pair?\r\n- warp_model is: warp_model = vxm.networks.Transform(vol_shape, interp_method='nearest')\r\n- For warping the images I'm just plotting the predicted moved image by the model and I'm not sure, what is the difference between trg and img parameter for the apply_transform function. I can imagine that the moving image will be the src and fix image will be the trg but what should be the img in this case?","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828464144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828474366","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828474366","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828474366,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODQ3NDM2Ng==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T13:53:23Z","updated_at":"2021-04-28T13:53:23Z","author_association":"COLLABORATOR","body":"> * Okay, but if I grab 2 random images it's possible that I grab two fixed or two moving images also it's possible that I grab a different fixed image and a different moving image. Wouldn't that train the model wrong? Since we want to learn transformation from moving to fixed, shouldn't we pick the images in pair?\r\n\r\nMaybe I'm not sure what your data is, but I'm not sure why you have sectioned them off in 'moving images' and 'fixed images'? Moving and fixed are just terminology used in the model -- but again, maybe it would help to know more about the data.\r\n\r\n> * warp_model is: warp_model = vxm.networks.Transform(vol_shape, interp_method='nearest')\r\n\r\nOk, got it\r\n\r\n> * For warping the images I'm just plotting the predicted moved image by the model and I'm not sure, what is the difference between trg and img parameter for the apply_transform function. I can imagine that the moving image will be the src and fix image will be the trg but what should be the img in this case?\r\n\r\n`img` would be the image you want to warp. So to warp an image you could do `vxm_model.apply_transform(mov, fix, mov)` and to warp a seg you could do `vxm_model.apply_transform(mov, fix, mov_seg, 'nearest')`\r\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828474366/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828481213","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828481213","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828481213,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODQ4MTIxMw==","user":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T14:01:55Z","updated_at":"2021-04-28T14:01:55Z","author_association":"NONE","body":"> Maybe I'm not sure what your data is, but I'm not sure why you have sectioned them off in 'moving images' and 'fixed images'? Moving and fixed are just terminology used in the model -- but again, maybe it would help to know more about the data.\r\n>> The data that we've been provided has fixed and moving image pairs (for both image and segmentation). This is how our data looks.\r\n![files](https://user-images.githubusercontent.com/14558146/116416089-560a0980-a83a-11eb-9542-f9d45a43dcb5.png)\r\n\r\n> `img` would be the image you want to warp. So to warp an image you could do `vxm_model.apply_transform(mov, fix, mov)` and to warp a seg you could do `vxm_model.apply_transform(mov, fix, mov_seg, 'nearest')`\r\n>> Okay so my understanding of it was correct but as I said when I use \"apply_transform\" function for segmentation images I'm getting a zero array of (1,256,256,64,1) and for \"images\" I'm just plotting the prediction of model and not actually applying the \"apply_transform\" function on moving image to get the moved image. But I'll try and see if \"apply_transform\" works in the image data or if it gives me a zero array again. Can you suggest a reason for why I'm getting the zero array after applying \"apply_transform\"?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828481213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828531694","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828531694","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828531694,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODUzMTY5NA==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T15:05:28Z","updated_at":"2021-04-28T15:05:28Z","author_association":"COLLABORATOR","body":"> The data that we've been provided has fixed and moving image pairs (for both image and segmentation). This is how our data looks.\r\n\r\nRight, but is there something special about those images? E.g. are they different scans of the same subject? If they're all just different subjects, I think you should just randomize. \r\n\r\n> Okay so my understanding of it was correct but as I said when I use \"apply_transform\" function for segmentation images I'm getting a zero array of (1,256,256,64,1) and for \"images\" I'm just plotting the prediction of model and not actually applying the \"apply_transform\" function on moving image to get the moved image. But I'll try and see if \"apply_transform\" works in the image data or if it gives me a zero array again. Can you suggest a reason for why I'm getting the zero array after applying \"apply_transform\"?\r\n\r\nI don't see why it would give you 0s at all really. Can you show me the exact line you used? ","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828531694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828539479","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828539479","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828539479,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODUzOTQ3OQ==","user":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T15:14:49Z","updated_at":"2021-04-28T15:14:49Z","author_association":"NONE","body":"> Right, but is there something special about those images? E.g. are they different scans of the same subject? If they're all just different subjects, I think you should just randomize.\r\n>> I think the image pairs are from the same subject but I'll try your suggestion and see if I'm getting better results. \r\n\r\n> I don't see why it would give you 0s at all really. Can you show me the exact line you used?\r\n>>transformed_image = vxm_model.apply_transform(mov_reshape, fix_reshape, segmentation_array_reshaped, interp_method='nearest')\r\nHere, mov_reshape is moving image reshaped to (1,256,256,64,1) shape. \"fix_shape\" is fixed image reshaped to (1,256,256,64,1) shape and \"segmentation_array_reshaped\" is segmentation image reshaped to (1,256,256,64,1) shape.\r\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828539479/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828543002","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828543002","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828543002,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODU0MzAwMg==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T15:19:10Z","updated_at":"2021-04-28T15:19:10Z","author_association":"COLLABORATOR","body":"Weird, that should work.\r\n\r\nCan you do `transformed_image = vxm_model.apply_transform(mov_reshape, fix_reshape, mov_reshape, interp_method='linear')` and post what you get? \r\n\r\nI suspect you have a bug in the image processing or something like that, but I'm just guessing.","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828543002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828564919","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828564919","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828564919,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODU2NDkxOQ==","user":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T15:47:46Z","updated_at":"2021-04-28T15:52:38Z","author_association":"NONE","body":"I tried doing transformed_image = vxm_model.apply_transform(mov_reshape, fix_reshape, mov_reshape, interp_method='linear') and I got the predicted moved image from the model.\r\n![prediction](https://user-images.githubusercontent.com/14558146/116433408-c2d8d000-a849-11eb-8ae0-47ade39a064c.png)\r\n![apply_transform](https://user-images.githubusercontent.com/14558146/116433466-d2581900-a849-11eb-8e8e-58e929f597c1.png)\r\n\r\nI rerun the apply_transform with segmentation image and now I'm getting a warping which was similar to the initial warping I showed.\r\n![seg](https://user-images.githubusercontent.com/14558146/116433973-4b577080-a84a-11eb-8307-a7608703af60.png)\r\n![warped](https://user-images.githubusercontent.com/14558146/116433995-4f838e00-a84a-11eb-9b8d-432d892bc088.png)\r\n\r\nEven though I can generate warping from the apply_transform function but it doesn't match the fixed image that well(it's closer to the moving image). Do you think the model is underfitting and I should train it for higher epochs(maybe 50epochs)?\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828564919/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828613082","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828613082","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828613082,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODYxMzA4Mg==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T16:51:27Z","updated_at":"2021-04-28T16:51:27Z","author_association":"COLLABORATOR","body":"it looks to me like the warp is a bit bad (under regulaized) here. \r\n\r\nTo visualize if this is the case, i recommend you get a bwgrid via `pystrum.pynd.ndutils.bw_grid(img.shape, 5)` and warp this with apply_transform. \r\n\r\nIf these images are from the same subject (each moving and fixed pair), then perhaps the regularization should be stronger. You might also want to look at our recent paper https://arxiv.org/abs/2101.01035","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828613082/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828678937","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828678937","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828678937,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODY3ODkzNw==","user":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T18:24:29Z","updated_at":"2021-04-28T18:24:29Z","author_association":"NONE","body":"I obtained the bw_grid for \"fixed img\" and kept rest of the parameters same and this is the warping I got:\r\n![warping](https://user-images.githubusercontent.com/14558146/116453691-77c9b780-a85f-11eb-9e45-f0459877563e.png)\r\n![seg](https://user-images.githubusercontent.com/14558146/116453836-9c259400-a85f-11eb-95dc-fb0cfae21fa3.png)\r\n\r\nThis warped image is close to the fixed segmentation, which is what I wanted.\r\nHowever, I don't understand the concept of bw_grid, and am I supposed to apply it to moving or fixed image?\r\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828678937/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828687219","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828687219","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828687219,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODY4NzIxOQ==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T18:36:01Z","updated_at":"2021-04-28T18:36:21Z","author_association":"COLLABORATOR","body":"I meant something *like* \r\n\r\n```\r\ngrid = pystrum.pynd.ndutils.bw_grid(mov.shape, 5)[np.newaxis, ..., np.newaxis]\r\ntransformed_image = vxm_model.apply_transform(mov_reshape, fix_reshape, grid , interp_method='linear')\r\n```\r\n\r\nThe idea is to visualize how `grid` is warped. See Fig 6 in https://arxiv.org/pdf/1809.05231.pdf","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828687219/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828710404","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828710404","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828710404,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODcxMDQwNA==","user":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false},"created_at":"2021-04-28T19:10:42Z","updated_at":"2021-04-28T19:10:42Z","author_association":"NONE","body":"Okay I understand, here is how the warped grid looks like:\r\n![w_grid](https://user-images.githubusercontent.com/14558146/116459496-2c66d780-a866-11eb-81b8-39be698211a1.png)\r\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828710404/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828881656","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-828881656","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":828881656,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODg4MTY1Ng==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2021-04-29T01:17:55Z","updated_at":"2021-04-29T01:17:55Z","author_association":"COLLABORATOR","body":"Right, it seems a bit underregularize (not very smooth), likely because you used the same regularization parameter that we used to register brains from different people. If mov and fix are from the same person, it's likely you'd want stronger regularization.","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/828881656/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/829374054","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-829374054","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":829374054,"node_id":"MDEyOklzc3VlQ29tbWVudDgyOTM3NDA1NA==","user":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false},"created_at":"2021-04-29T16:13:08Z","updated_at":"2021-04-29T16:13:08Z","author_association":"NONE","body":"Okay, so I've re-trained the model and have adjusted the loss weights and set int_steps=4.\r\nFor losses, I'm wnet with the implemented loss functions `losses = ['mse', vxm.losses.Grad('l2').loss]`\r\nBut I've adjusted the weights from `loss_weights = [1, 0.01]` to `loss_weights = [1, 0.05]` and I'm still not getting satisfactory results with segmentation images. Is there any other regularization that I should try or should I amplify(something like this maybe loss_weights = [1, 0.10]) this regularization a little more?","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/829374054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Kanyq","id":14558146,"node_id":"MDQ6VXNlcjE0NTU4MTQ2","avatar_url":"https://avatars.githubusercontent.com/u/14558146?v=4","gravatar_id":"","url":"https://api.github.com/users/Kanyq","html_url":"https://github.com/Kanyq","followers_url":"https://api.github.com/users/Kanyq/followers","following_url":"https://api.github.com/users/Kanyq/following{/other_user}","gists_url":"https://api.github.com/users/Kanyq/gists{/gist_id}","starred_url":"https://api.github.com/users/Kanyq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kanyq/subscriptions","organizations_url":"https://api.github.com/users/Kanyq/orgs","repos_url":"https://api.github.com/users/Kanyq/repos","events_url":"https://api.github.com/users/Kanyq/events{/privacy}","received_events_url":"https://api.github.com/users/Kanyq/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/829469923","html_url":"https://github.com/voxelmorph/voxelmorph/issues/300#issuecomment-829469923","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/300","id":829469923,"node_id":"MDEyOklzc3VlQ29tbWVudDgyOTQ2OTkyMw==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2021-04-29T17:56:32Z","updated_at":"2021-04-29T17:56:32Z","author_association":"COLLABORATOR","body":"If it's still too rough, yes! This is why we wrote hypermorph, btw.","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/829469923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"id":4820770663,"node_id":"MDExOkNsb3NlZEV2ZW50NDgyMDc3MDY2Mw==","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/4820770663","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-05-31T13:43:51Z","state_reason":null,"performed_via_github_app":null}]