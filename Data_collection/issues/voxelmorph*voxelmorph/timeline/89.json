[{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/523509094","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-523509094","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":523509094,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzUwOTA5NA==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2019-08-21T15:28:08Z","updated_at":"2019-08-21T15:28:08Z","author_association":"COLLABORATOR","body":"We have one in the works! Can you please check back, feel free to ping for an update if you don't see an update in a couple of weeks. \r\n\r\nNote that a quick hacky implementation is pretty easy: it's a network (e.g. a UNet ) that you can get from elsewhere, and a spatial transform layer which pytorch now has natively. ","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/523509094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"id":2573522136,"node_id":"MDEyOkxhYmVsZWRFdmVudDI1NzM1MjIxMzY=","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2573522136","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-08-21T15:28:12Z","label":{"name":"voxelmorph","color":"1d76db"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/523515413","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-523515413","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":523515413,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzUxNTQxMw==","user":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false},"created_at":"2019-08-21T15:40:29Z","updated_at":"2019-08-21T15:40:29Z","author_association":"NONE","body":"Great. Actually, for researcher the PyTorch is perfect and for the product is Tensorflow. I just want to ask some question to make it more clear\r\n\r\n1. First, you feed a concatenation of fixed and moving images to the Unet, the last feature size of `Bx3xDxHxW`- called `f_unet` feature or deformation field. We will warp the `f_unet` to the moving image to obtained the moved image using the below code, so Are the U feature in the below figure and deformation field same?\r\n```\r\ngrid = f_unet #F.affine_grid(theta, x.size())\r\nmoved_image = F.grid_sample(moving_image, grid)\r\n```\r\n ![stn-arch](https://user-images.githubusercontent.com/24875971/63446196-c32f8f80-c407-11e9-89d3-86aa628a8a47.png)\r\n\r\n2. To obtain the deformation field, we will train a loss (simplify as MSE loss) between moved_image and fixed_image (just ignore smooth term). Is it right?\r\n\r\nhttps://pytorch.org/tutorials/intermediate/spatial_transformer_tutorial.html ","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/523515413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false}},{"id":2573565032,"node_id":"MDExOkNsb3NlZEV2ZW50MjU3MzU2NTAzMg==","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2573565032","actor":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-08-21T15:40:30Z","state_reason":null,"performed_via_github_app":null},{"id":2573565544,"node_id":"MDEzOlJlb3BlbmVkRXZlbnQyNTczNTY1NTQ0","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2573565544","actor":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false},"event":"reopened","commit_id":null,"commit_url":null,"created_at":"2019-08-21T15:40:38Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/523571655","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-523571655","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":523571655,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzU3MTY1NQ==","user":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false},"created_at":"2019-08-21T17:42:13Z","updated_at":"2019-08-21T17:55:07Z","author_association":"NONE","body":"@adalca : Please correct if I was wrong in pytorch. I just ignore the smooth term. However, the loss does not reduce. \r\n\r\n```\r\nf_unet= unet_feature() # size of Bx3xDxHxW\r\nf_unet = f_unet.permute(0,2,3,4,1)# Because grid only allows size of BxDxHxWx3\r\nmoved = F.grid_sample(moving, f_unet)       \r\nreturn moved , f_unet # return moved image and deformation field\r\n```\r\n\r\nLoss function\r\n\r\n```\r\nmoved_image, df = voxel_morph(moving, fixed)              \r\nregestation_loss = self.L1(moved_image, fixed)\r\nregestation_loss.backward()\r\noptimizer.step()\r\n```","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/523571655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false}},{"id":2573925428,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjU3MzkyNTQyOA==","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2573925428","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-08-21T17:42:13Z","performed_via_github_app":null},{"id":2573925429,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI1NzM5MjU0Mjk=","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2573925429","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-08-21T17:42:13Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/523703784","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-523703784","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":523703784,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzcwMzc4NA==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2019-08-22T00:56:47Z","updated_at":"2019-08-22T00:56:47Z","author_association":"COLLABORATOR","body":"Hi @John1231983 ,\r\n\r\nConceptually I think you got the idea. \r\n\r\nI'm not super familiar with pytorch's built-in `grid_sample` or their spatial transformer tutorial. I do remember that there was an issue with the grid_sample domain space (it requires input in the space of -1, 1 or something similar). Unfortunately I think you'll have to wait for the voxelmorph pytorch release before I can speak a bit more intelligently about this. \r\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/523703784/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"id":2574891734,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjU3NDg5MTczNA==","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2574891734","actor":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-08-22T00:56:47Z","performed_via_github_app":null},{"id":2574891736,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI1NzQ4OTE3MzY=","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2574891736","actor":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-08-22T00:56:47Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/523715315","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-523715315","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":523715315,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzcxNTMxNQ==","user":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false},"created_at":"2019-08-22T01:59:54Z","updated_at":"2019-08-22T01:59:54Z","author_association":"NONE","body":"That is exactaly the bug what I am facing. I solve it by bellow code. The idea is that cumsum all value of feature map, then divide by shape size for each dim. I hope your work will be soon\r\n```\r\nspatial_gds = torch.rand(1,2,3,3,3)\r\nprint (spatial_gds)\r\n_, _, D, H, W = spatial_gds.size()\r\ngrids = [torch.cumsum(spatial_gds[:, i, ...], dim=i+1)    for i in range(3)]\r\n#print(grids)\r\ngrids_norm = torch.stack([(grid/dim)*2-1. for dim, grid in zip([D,H,W], grids)], dim=4)\r\nprint(grids_norm)\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/523715315/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/523718569","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-523718569","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":523718569,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzcxODU2OQ==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2019-08-22T02:16:32Z","updated_at":"2019-08-22T02:16:32Z","author_association":"COLLABORATOR","body":"excellent, thanks for the update!","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/523718569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"id":2574993791,"node_id":"MDExOkNsb3NlZEV2ZW50MjU3NDk5Mzc5MQ==","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2574993791","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-08-22T02:16:32Z","state_reason":null,"performed_via_github_app":null},{"id":2574994300,"node_id":"MDEyOkxhYmVsZWRFdmVudDI1NzQ5OTQzMDA=","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2574994300","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-08-22T02:16:57Z","label":{"name":"pytorch","color":"006b75"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524170426","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-524170426","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":524170426,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDE3MDQyNg==","user":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false},"created_at":"2019-08-23T04:45:07Z","updated_at":"2019-08-23T04:45:07Z","author_association":"NONE","body":"@adalca :Sorry for reopen the issue. The above code is wrong. I have a working code to normalize the df to -1, 1 such as (-1,-1,-1) in the top left. The process is that first we build a linear grid from [0 to (D-1) x 0 to (H-1) x 0 to (W-1)]. Then plus the grid with the last feature map of unet. \r\n```\r\ngrid = grid_linear + f_unet\r\n```\r\nThe normalized is done by\r\n\r\n```\r\ngrid_norm_i= 2* grid_i.clone() / dim_i -1.0 #dim_i is D-1, H-1 or W-1\r\n```\r\n\r\nSo, we can obtain the grid norm that satisfies the condition of grid_sample function. However, I have a question, we have grid_linear in range of max(H,D,W), while f_unet is unknown range. How we can summarize them together? I mean if we use the weight 1 and 1, then the grid result may highly depend on the f_unet range (for example range of f_unet is -10 to 100, while H=50,W=50 and D= 50 f","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524170426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false}},{"id":2578496253,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjU3ODQ5NjI1Mw==","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2578496253","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-08-23T04:45:08Z","performed_via_github_app":null},{"id":2578496254,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI1Nzg0OTYyNTQ=","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2578496254","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-08-23T04:45:08Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524170851","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-524170851","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":524170851,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDE3MDg1MQ==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2019-08-23T04:48:03Z","updated_at":"2019-08-23T04:48:03Z","author_association":"COLLABORATOR","body":"In the tensorflow implementation, we simply clip the transformation (meshgrid + displacement from `unet`) to the size of the iamges. So if the transformation takes a voxel to -2, we make it 0 -- if it takes a transformation to H+3 we clip it to H. ","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524170851/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524176588","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-524176588","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":524176588,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDE3NjU4OA==","user":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false},"created_at":"2019-08-23T05:22:21Z","updated_at":"2019-08-23T05:22:21Z","author_association":"NONE","body":"So, you clip value after summation between meshgrid and displacement (generated by UNet)., right? So, if the displacement is too high, then the summation just depends on the value of displacement. Why not clip displacement to range of size image before summation? For example\r\n```\r\ndisp= unet()\r\ndist[0]= tf.clip(disp[0], 0, D)\r\ndist[1]= tf.clip(disp[1], 0, H)\r\ndist[2]= tf.clip(disp[2], 0, W)\r\ndist = dist + meshgrid\r\n```\r\nAs I understand, you said as\r\n```\r\ndisp= unet()\r\ndist = dist + meshgrid\r\ndist[0]= tf.clip(disp[0], 0, D)\r\ndist[1]= tf.clip(disp[1], 0, H)\r\ndist[2]= tf.clip(disp[2], 0, W)\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524176588/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524177556","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-524177556","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":524177556,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDE3NzU1Ng==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2019-08-23T05:27:28Z","updated_at":"2019-08-23T05:27:28Z","author_association":"COLLABORATOR","body":"In your first case, the final `dist` can still go beyond the image sizes, which you don't want. It also doesn't make much sense to clip the displacement -- the limits (clips) will depend on where the displacement is. a voxel in the middle of the image can move quite a bit, a voxel at the edge of the image is very limited. \r\n\r\nThe idea is that based on the displacement, at *each location* you compute the new location of where you'll grab the voxel from, and then make sure that this final absolute value is within the image size.","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524177556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524178571","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-524178571","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":524178571,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDE3ODU3MQ==","user":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false},"created_at":"2019-08-23T05:33:01Z","updated_at":"2019-08-23T05:33:01Z","author_association":"NONE","body":"I understand ! For anyone is looking for the issue. You should you the solution\r\n```\r\ndisp= unet()\r\ndist = dist + meshgrid\r\ndist[0]= tf.clip(disp[0], 0, D)\r\ndist[1]= tf.clip(disp[1], 0, H)\r\ndist[2]= tf.clip(disp[2], 0, W)\r\n```","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524178571/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524179882","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-524179882","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":524179882,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDE3OTg4Mg==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2019-08-23T05:39:54Z","updated_at":"2019-08-23T05:39:54Z","author_association":"COLLABORATOR","body":"If you're going to use `tensorflow`, there's a clean implementation in the function `transform` in https://github.com/adalca/neuron/blob/master/neuron/utils.py","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524179882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524302484","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-524302484","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":524302484,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDMwMjQ4NA==","user":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false},"created_at":"2019-08-23T12:48:23Z","updated_at":"2019-08-23T12:48:23Z","author_association":"NONE","body":"Thanks. It worked now. The voxelmorpho is super fast and competitive with ants. Great job.\r\n\r\nFor smooth term. Do you think we will smooth f_unet (output of unet network) or f_unet_norm ( normalize with f_unet + meshgrid)? As my opinion, it should smooth to the result of (f_unet+mesh_grid after normalize coordinate)","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524302484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524303853","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-524303853","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":524303853,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDMwMzg1Mw==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2019-08-23T12:52:57Z","updated_at":"2019-08-23T12:53:14Z","author_association":"COLLABORATOR","body":"good to hear!\r\n\r\nthere's different ways to regularize the deformation. In the original voxelmorph paper (CVPR/TMI) we penalize the spatial gradient of the displacement (the output of the `unet`). \r\n\r\nDoing the exact same thing after adding the meshgrid is not recommended (since you would penalize the meshgrid) but you could certainly come up with other regularizations that make sense there. \r\n\r\nIn the MICCAI/MedIA paper we build a diffeomorphic layer that guarantees that the deformations are *invertible*, so it's a bit different and yet another way to control the deformation field.","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/524303853/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/532224912","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-532224912","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":532224912,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMjIyNDkxMg==","user":{"login":"zoujinger","id":27009979,"node_id":"MDQ6VXNlcjI3MDA5OTc5","avatar_url":"https://avatars.githubusercontent.com/u/27009979?v=4","gravatar_id":"","url":"https://api.github.com/users/zoujinger","html_url":"https://github.com/zoujinger","followers_url":"https://api.github.com/users/zoujinger/followers","following_url":"https://api.github.com/users/zoujinger/following{/other_user}","gists_url":"https://api.github.com/users/zoujinger/gists{/gist_id}","starred_url":"https://api.github.com/users/zoujinger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zoujinger/subscriptions","organizations_url":"https://api.github.com/users/zoujinger/orgs","repos_url":"https://api.github.com/users/zoujinger/repos","events_url":"https://api.github.com/users/zoujinger/events{/privacy}","received_events_url":"https://api.github.com/users/zoujinger/received_events","type":"User","site_admin":false},"created_at":"2019-09-17T13:38:38Z","updated_at":"2019-09-17T13:38:38Z","author_association":"NONE","body":"So when will the voxelmorph pytorch release be available?\r\nI was bothering by the STN for a long time.\r\nDid anyone implement the STN in pytorch?\r\nThanks so much!","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/532224912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zoujinger","id":27009979,"node_id":"MDQ6VXNlcjI3MDA5OTc5","avatar_url":"https://avatars.githubusercontent.com/u/27009979?v=4","gravatar_id":"","url":"https://api.github.com/users/zoujinger","html_url":"https://github.com/zoujinger","followers_url":"https://api.github.com/users/zoujinger/followers","following_url":"https://api.github.com/users/zoujinger/following{/other_user}","gists_url":"https://api.github.com/users/zoujinger/gists{/gist_id}","starred_url":"https://api.github.com/users/zoujinger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zoujinger/subscriptions","organizations_url":"https://api.github.com/users/zoujinger/orgs","repos_url":"https://api.github.com/users/zoujinger/repos","events_url":"https://api.github.com/users/zoujinger/events{/privacy}","received_events_url":"https://api.github.com/users/zoujinger/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/559578862","html_url":"https://github.com/voxelmorph/voxelmorph/issues/89#issuecomment-559578862","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/89","id":559578862,"node_id":"MDEyOklzc3VlQ29tbWVudDU1OTU3ODg2Mg==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2019-11-28T18:23:58Z","updated_at":"2019-11-28T18:23:58Z","author_association":"COLLABORATOR","body":"@John1231983 @zoujinger please see #109 for a discussion about a pytorch voxelmorph version.","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/559578862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"id":2839701815,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjgzOTcwMTgxNQ==","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2839701815","actor":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-11-28T18:23:58Z","performed_via_github_app":null},{"id":2839701816,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjgzOTcwMTgxNg==","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2839701816","actor":{"login":"zoujinger","id":27009979,"node_id":"MDQ6VXNlcjI3MDA5OTc5","avatar_url":"https://avatars.githubusercontent.com/u/27009979?v=4","gravatar_id":"","url":"https://api.github.com/users/zoujinger","html_url":"https://github.com/zoujinger","followers_url":"https://api.github.com/users/zoujinger/followers","following_url":"https://api.github.com/users/zoujinger/following{/other_user}","gists_url":"https://api.github.com/users/zoujinger/gists{/gist_id}","starred_url":"https://api.github.com/users/zoujinger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zoujinger/subscriptions","organizations_url":"https://api.github.com/users/zoujinger/orgs","repos_url":"https://api.github.com/users/zoujinger/repos","events_url":"https://api.github.com/users/zoujinger/events{/privacy}","received_events_url":"https://api.github.com/users/zoujinger/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-11-28T18:23:58Z","performed_via_github_app":null},{"id":2839701818,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI4Mzk3MDE4MTg=","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2839701818","actor":{"login":"John1231983","id":24875971,"node_id":"MDQ6VXNlcjI0ODc1OTcx","avatar_url":"https://avatars.githubusercontent.com/u/24875971?v=4","gravatar_id":"","url":"https://api.github.com/users/John1231983","html_url":"https://github.com/John1231983","followers_url":"https://api.github.com/users/John1231983/followers","following_url":"https://api.github.com/users/John1231983/following{/other_user}","gists_url":"https://api.github.com/users/John1231983/gists{/gist_id}","starred_url":"https://api.github.com/users/John1231983/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/John1231983/subscriptions","organizations_url":"https://api.github.com/users/John1231983/orgs","repos_url":"https://api.github.com/users/John1231983/repos","events_url":"https://api.github.com/users/John1231983/events{/privacy}","received_events_url":"https://api.github.com/users/John1231983/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-11-28T18:23:58Z","performed_via_github_app":null}]