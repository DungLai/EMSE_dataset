[{"id":2378384110,"node_id":"MDEyOkxhYmVsZWRFdmVudDIzNzgzODQxMTA=","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2378384110","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-05-30T15:06:03Z","label":{"name":"voxelmorph","color":"1d76db"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/497364474","html_url":"https://github.com/voxelmorph/voxelmorph/issues/55#issuecomment-497364474","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/55","id":497364474,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzM2NDQ3NA==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2019-05-30T15:09:41Z","updated_at":"2019-05-30T15:09:53Z","author_association":"COLLABORATOR","body":"hi @HANK538,\r\n\r\n1. You can do anything you want. We've tried registering an *atlas* (you can think of this as a \"centroid\" subject if you haven't worked with atlases) to each subject, subject to subject (that is, fixed and moving are *different subjects*), as well as different scans of the same subject. Obviously in the latter case, the deformations are a lot smaller.\r\n\r\n2. You can use RGB images just fine. You'll need to modify the networks so that the input and output take 3 channels instead of 1, but this is easy to do (e.g. within `cvpr2018_net` you can modify the `unet_core` code to use `src_feats=3` and `tgt_feats=3`. If you choose to work with grayscale (using some sort of `rgb2gray` conversion) then you can simply use the existing code.\r\n\r\nGood luck!\r\n\r\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/497364474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"id":2378394139,"node_id":"MDExOkNsb3NlZEV2ZW50MjM3ODM5NDEzOQ==","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2378394139","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-05-30T15:09:41Z","state_reason":null,"performed_via_github_app":null},{"id":2378394145,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjM3ODM5NDE0NQ==","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2378394145","actor":{"login":"HANK538","id":37690266,"node_id":"MDQ6VXNlcjM3NjkwMjY2","avatar_url":"https://avatars.githubusercontent.com/u/37690266?v=4","gravatar_id":"","url":"https://api.github.com/users/HANK538","html_url":"https://github.com/HANK538","followers_url":"https://api.github.com/users/HANK538/followers","following_url":"https://api.github.com/users/HANK538/following{/other_user}","gists_url":"https://api.github.com/users/HANK538/gists{/gist_id}","starred_url":"https://api.github.com/users/HANK538/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HANK538/subscriptions","organizations_url":"https://api.github.com/users/HANK538/orgs","repos_url":"https://api.github.com/users/HANK538/repos","events_url":"https://api.github.com/users/HANK538/events{/privacy}","received_events_url":"https://api.github.com/users/HANK538/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-05-30T15:09:41Z","performed_via_github_app":null},{"id":2378394146,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzNzgzOTQxNDY=","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/2378394146","actor":{"login":"HANK538","id":37690266,"node_id":"MDQ6VXNlcjM3NjkwMjY2","avatar_url":"https://avatars.githubusercontent.com/u/37690266?v=4","gravatar_id":"","url":"https://api.github.com/users/HANK538","html_url":"https://github.com/HANK538","followers_url":"https://api.github.com/users/HANK538/followers","following_url":"https://api.github.com/users/HANK538/following{/other_user}","gists_url":"https://api.github.com/users/HANK538/gists{/gist_id}","starred_url":"https://api.github.com/users/HANK538/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HANK538/subscriptions","organizations_url":"https://api.github.com/users/HANK538/orgs","repos_url":"https://api.github.com/users/HANK538/repos","events_url":"https://api.github.com/users/HANK538/events{/privacy}","received_events_url":"https://api.github.com/users/HANK538/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-05-30T15:09:41Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/497635513","html_url":"https://github.com/voxelmorph/voxelmorph/issues/55#issuecomment-497635513","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/55","id":497635513,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzYzNTUxMw==","user":{"login":"HANK538","id":37690266,"node_id":"MDQ6VXNlcjM3NjkwMjY2","avatar_url":"https://avatars.githubusercontent.com/u/37690266?v=4","gravatar_id":"","url":"https://api.github.com/users/HANK538","html_url":"https://github.com/HANK538","followers_url":"https://api.github.com/users/HANK538/followers","following_url":"https://api.github.com/users/HANK538/following{/other_user}","gists_url":"https://api.github.com/users/HANK538/gists{/gist_id}","starred_url":"https://api.github.com/users/HANK538/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HANK538/subscriptions","organizations_url":"https://api.github.com/users/HANK538/orgs","repos_url":"https://api.github.com/users/HANK538/repos","events_url":"https://api.github.com/users/HANK538/events{/privacy}","received_events_url":"https://api.github.com/users/HANK538/received_events","type":"User","site_admin":false},"created_at":"2019-05-31T09:04:30Z","updated_at":"2019-05-31T09:04:30Z","author_association":"NONE","body":"Hi Adalca\r\n\r\nThanks for your update!\r\nBut unfortunately, it still not work as following settings.\r\n    src_feats = 3\r\n    tgt_feats = 3\r\n\r\nMy input color image 2D shape and vol_size is (176, 1152, 3)\r\n\r\nError log:\r\n\\src\\networks.py\", line 75, in unet_core\r\nx = concatenate([x, x_enc[-2]])\r\nValueError: A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got inputs shapes: [(None, 22, 144, 2, 32), (None, 22, 144, 1, 32)]\r\n\r\nI tried different combination of parameters with no luck.\r\nAny idea? ","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/497635513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"HANK538","id":37690266,"node_id":"MDQ6VXNlcjM3NjkwMjY2","avatar_url":"https://avatars.githubusercontent.com/u/37690266?v=4","gravatar_id":"","url":"https://api.github.com/users/HANK538","html_url":"https://github.com/HANK538","followers_url":"https://api.github.com/users/HANK538/followers","following_url":"https://api.github.com/users/HANK538/following{/other_user}","gists_url":"https://api.github.com/users/HANK538/gists{/gist_id}","starred_url":"https://api.github.com/users/HANK538/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HANK538/subscriptions","organizations_url":"https://api.github.com/users/HANK538/orgs","repos_url":"https://api.github.com/users/HANK538/repos","events_url":"https://api.github.com/users/HANK538/events{/privacy}","received_events_url":"https://api.github.com/users/HANK538/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/497710975","html_url":"https://github.com/voxelmorph/voxelmorph/issues/55#issuecomment-497710975","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/55","id":497710975,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzcxMDk3NQ==","user":{"login":"balakg","id":8753801,"node_id":"MDQ6VXNlcjg3NTM4MDE=","avatar_url":"https://avatars.githubusercontent.com/u/8753801?v=4","gravatar_id":"","url":"https://api.github.com/users/balakg","html_url":"https://github.com/balakg","followers_url":"https://api.github.com/users/balakg/followers","following_url":"https://api.github.com/users/balakg/following{/other_user}","gists_url":"https://api.github.com/users/balakg/gists{/gist_id}","starred_url":"https://api.github.com/users/balakg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/balakg/subscriptions","organizations_url":"https://api.github.com/users/balakg/orgs","repos_url":"https://api.github.com/users/balakg/repos","events_url":"https://api.github.com/users/balakg/events{/privacy}","received_events_url":"https://api.github.com/users/balakg/received_events","type":"User","site_admin":false},"created_at":"2019-05-31T13:35:53Z","updated_at":"2019-05-31T13:35:53Z","author_association":"COLLABORATOR","body":"Are you sure the inputs that are fed to the network have 3 dimensions instead of 4?","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/497710975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"balakg","id":8753801,"node_id":"MDQ6VXNlcjg3NTM4MDE=","avatar_url":"https://avatars.githubusercontent.com/u/8753801?v=4","gravatar_id":"","url":"https://api.github.com/users/balakg","html_url":"https://github.com/balakg","followers_url":"https://api.github.com/users/balakg/followers","following_url":"https://api.github.com/users/balakg/following{/other_user}","gists_url":"https://api.github.com/users/balakg/gists{/gist_id}","starred_url":"https://api.github.com/users/balakg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/balakg/subscriptions","organizations_url":"https://api.github.com/users/balakg/orgs","repos_url":"https://api.github.com/users/balakg/repos","events_url":"https://api.github.com/users/balakg/events{/privacy}","received_events_url":"https://api.github.com/users/balakg/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/498118296","html_url":"https://github.com/voxelmorph/voxelmorph/issues/55#issuecomment-498118296","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/55","id":498118296,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODExODI5Ng==","user":{"login":"HANK538","id":37690266,"node_id":"MDQ6VXNlcjM3NjkwMjY2","avatar_url":"https://avatars.githubusercontent.com/u/37690266?v=4","gravatar_id":"","url":"https://api.github.com/users/HANK538","html_url":"https://github.com/HANK538","followers_url":"https://api.github.com/users/HANK538/followers","following_url":"https://api.github.com/users/HANK538/following{/other_user}","gists_url":"https://api.github.com/users/HANK538/gists{/gist_id}","starred_url":"https://api.github.com/users/HANK538/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HANK538/subscriptions","organizations_url":"https://api.github.com/users/HANK538/orgs","repos_url":"https://api.github.com/users/HANK538/repos","events_url":"https://api.github.com/users/HANK538/events{/privacy}","received_events_url":"https://api.github.com/users/HANK538/received_events","type":"User","site_admin":false},"created_at":"2019-06-03T05:32:28Z","updated_at":"2019-06-03T05:32:28Z","author_association":"NONE","body":"Hi balakg\r\n\r\nWhich input shape is correct ?\r\n [(None, 176, 1152, 3, 1)] or  [(None, 176, 1152, 3)] or  [(None, 176, 1152, 1, 3)] ?\r\nFor color 2D image, ndims should be 2 or 3 ?\r\n\r\nThanks\r\nHank","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/498118296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"HANK538","id":37690266,"node_id":"MDQ6VXNlcjM3NjkwMjY2","avatar_url":"https://avatars.githubusercontent.com/u/37690266?v=4","gravatar_id":"","url":"https://api.github.com/users/HANK538","html_url":"https://github.com/HANK538","followers_url":"https://api.github.com/users/HANK538/followers","following_url":"https://api.github.com/users/HANK538/following{/other_user}","gists_url":"https://api.github.com/users/HANK538/gists{/gist_id}","starred_url":"https://api.github.com/users/HANK538/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HANK538/subscriptions","organizations_url":"https://api.github.com/users/HANK538/orgs","repos_url":"https://api.github.com/users/HANK538/repos","events_url":"https://api.github.com/users/HANK538/events{/privacy}","received_events_url":"https://api.github.com/users/HANK538/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/498120137","html_url":"https://github.com/voxelmorph/voxelmorph/issues/55#issuecomment-498120137","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/55","id":498120137,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODEyMDEzNw==","user":{"login":"balakg","id":8753801,"node_id":"MDQ6VXNlcjg3NTM4MDE=","avatar_url":"https://avatars.githubusercontent.com/u/8753801?v=4","gravatar_id":"","url":"https://api.github.com/users/balakg","html_url":"https://github.com/balakg","followers_url":"https://api.github.com/users/balakg/followers","following_url":"https://api.github.com/users/balakg/following{/other_user}","gists_url":"https://api.github.com/users/balakg/gists{/gist_id}","starred_url":"https://api.github.com/users/balakg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/balakg/subscriptions","organizations_url":"https://api.github.com/users/balakg/orgs","repos_url":"https://api.github.com/users/balakg/repos","events_url":"https://api.github.com/users/balakg/events{/privacy}","received_events_url":"https://api.github.com/users/balakg/received_events","type":"User","site_admin":false},"created_at":"2019-06-03T05:43:40Z","updated_at":"2019-06-03T05:43:40Z","author_association":"COLLABORATOR","body":"For 2d images of size height x width x chan, the input should be (None, height, width, chan), where the first dimension is your batch size.","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/498120137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"balakg","id":8753801,"node_id":"MDQ6VXNlcjg3NTM4MDE=","avatar_url":"https://avatars.githubusercontent.com/u/8753801?v=4","gravatar_id":"","url":"https://api.github.com/users/balakg","html_url":"https://github.com/balakg","followers_url":"https://api.github.com/users/balakg/followers","following_url":"https://api.github.com/users/balakg/following{/other_user}","gists_url":"https://api.github.com/users/balakg/gists{/gist_id}","starred_url":"https://api.github.com/users/balakg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/balakg/subscriptions","organizations_url":"https://api.github.com/users/balakg/orgs","repos_url":"https://api.github.com/users/balakg/repos","events_url":"https://api.github.com/users/balakg/events{/privacy}","received_events_url":"https://api.github.com/users/balakg/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/498133596","html_url":"https://github.com/voxelmorph/voxelmorph/issues/55#issuecomment-498133596","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/55","id":498133596,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODEzMzU5Ng==","user":{"login":"HANK538","id":37690266,"node_id":"MDQ6VXNlcjM3NjkwMjY2","avatar_url":"https://avatars.githubusercontent.com/u/37690266?v=4","gravatar_id":"","url":"https://api.github.com/users/HANK538","html_url":"https://github.com/HANK538","followers_url":"https://api.github.com/users/HANK538/followers","following_url":"https://api.github.com/users/HANK538/following{/other_user}","gists_url":"https://api.github.com/users/HANK538/gists{/gist_id}","starred_url":"https://api.github.com/users/HANK538/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HANK538/subscriptions","organizations_url":"https://api.github.com/users/HANK538/orgs","repos_url":"https://api.github.com/users/HANK538/repos","events_url":"https://api.github.com/users/HANK538/events{/privacy}","received_events_url":"https://api.github.com/users/HANK538/received_events","type":"User","site_admin":false},"created_at":"2019-06-03T06:47:58Z","updated_at":"2019-06-03T06:47:58Z","author_association":"NONE","body":"Hi balakg\r\n\r\nIf I used ndims = 2, src and tgt = (None, 176, 1152, 3)\r\n\r\nI will encounter\r\nlosses.py\", line 64, in ncc\r\n    J_sum = conv_fn(J, sum_filt, strides, padding)\r\nValueError: Dimensions must be equal, but are 3 and 1 for 'loss/spatial_transformer_1_loss/Conv2D_1' (op: 'Conv2D') with input shapes: [?,176,1152,3], [9,9,1,1].\r\n\r\nAny idea?\r\n\r\nThanks\r\nHank","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/498133596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"HANK538","id":37690266,"node_id":"MDQ6VXNlcjM3NjkwMjY2","avatar_url":"https://avatars.githubusercontent.com/u/37690266?v=4","gravatar_id":"","url":"https://api.github.com/users/HANK538","html_url":"https://github.com/HANK538","followers_url":"https://api.github.com/users/HANK538/followers","following_url":"https://api.github.com/users/HANK538/following{/other_user}","gists_url":"https://api.github.com/users/HANK538/gists{/gist_id}","starred_url":"https://api.github.com/users/HANK538/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HANK538/subscriptions","organizations_url":"https://api.github.com/users/HANK538/orgs","repos_url":"https://api.github.com/users/HANK538/repos","events_url":"https://api.github.com/users/HANK538/events{/privacy}","received_events_url":"https://api.github.com/users/HANK538/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/498153696","html_url":"https://github.com/voxelmorph/voxelmorph/issues/55#issuecomment-498153696","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/55","id":498153696,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODE1MzY5Ng==","user":{"login":"HANK538","id":37690266,"node_id":"MDQ6VXNlcjM3NjkwMjY2","avatar_url":"https://avatars.githubusercontent.com/u/37690266?v=4","gravatar_id":"","url":"https://api.github.com/users/HANK538","html_url":"https://github.com/HANK538","followers_url":"https://api.github.com/users/HANK538/followers","following_url":"https://api.github.com/users/HANK538/following{/other_user}","gists_url":"https://api.github.com/users/HANK538/gists{/gist_id}","starred_url":"https://api.github.com/users/HANK538/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HANK538/subscriptions","organizations_url":"https://api.github.com/users/HANK538/orgs","repos_url":"https://api.github.com/users/HANK538/repos","events_url":"https://api.github.com/users/HANK538/events{/privacy}","received_events_url":"https://api.github.com/users/HANK538/received_events","type":"User","site_admin":false},"created_at":"2019-06-03T08:00:22Z","updated_at":"2019-06-03T08:00:22Z","author_association":"NONE","body":"Hi balakg\r\n\r\nI took some effort that set loss function to mse and modify input data generator as the same shape.\r\nFinally, it works now.\r\nHowever, Thanks for your help!\r\n\r\nThanks\r\nHank","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/498153696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"HANK538","id":37690266,"node_id":"MDQ6VXNlcjM3NjkwMjY2","avatar_url":"https://avatars.githubusercontent.com/u/37690266?v=4","gravatar_id":"","url":"https://api.github.com/users/HANK538","html_url":"https://github.com/HANK538","followers_url":"https://api.github.com/users/HANK538/followers","following_url":"https://api.github.com/users/HANK538/following{/other_user}","gists_url":"https://api.github.com/users/HANK538/gists{/gist_id}","starred_url":"https://api.github.com/users/HANK538/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HANK538/subscriptions","organizations_url":"https://api.github.com/users/HANK538/orgs","repos_url":"https://api.github.com/users/HANK538/repos","events_url":"https://api.github.com/users/HANK538/events{/privacy}","received_events_url":"https://api.github.com/users/HANK538/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/499422472","html_url":"https://github.com/voxelmorph/voxelmorph/issues/55#issuecomment-499422472","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/55","id":499422472,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTQyMjQ3Mg==","user":{"login":"HANK538","id":37690266,"node_id":"MDQ6VXNlcjM3NjkwMjY2","avatar_url":"https://avatars.githubusercontent.com/u/37690266?v=4","gravatar_id":"","url":"https://api.github.com/users/HANK538","html_url":"https://github.com/HANK538","followers_url":"https://api.github.com/users/HANK538/followers","following_url":"https://api.github.com/users/HANK538/following{/other_user}","gists_url":"https://api.github.com/users/HANK538/gists{/gist_id}","starred_url":"https://api.github.com/users/HANK538/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HANK538/subscriptions","organizations_url":"https://api.github.com/users/HANK538/orgs","repos_url":"https://api.github.com/users/HANK538/repos","events_url":"https://api.github.com/users/HANK538/events{/privacy}","received_events_url":"https://api.github.com/users/HANK538/received_events","type":"User","site_admin":false},"created_at":"2019-06-06T09:33:45Z","updated_at":"2019-06-06T09:33:45Z","author_association":"NONE","body":"Hi balakg\r\n\r\nI try and back to 2D color image training for cc loss.\r\n\r\nJ_sum = conv_fn(J, sum_filt, strides, padding)\r\nValueError: Dimensions must be equal, but are 3 and 1 for 'loss/spatial_transformer_1_loss/Conv2D_1' (op: 'Conv2D') with input shapes: [?,176,1152,3], [9,9,1,1].\r\n\r\nJ shape is [None, 176,1152,3]\r\nHow should I set sum_filt value so that make training work ?\r\nAny suggestion ?\r\n\r\nThanks","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/499422472/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"HANK538","id":37690266,"node_id":"MDQ6VXNlcjM3NjkwMjY2","avatar_url":"https://avatars.githubusercontent.com/u/37690266?v=4","gravatar_id":"","url":"https://api.github.com/users/HANK538","html_url":"https://github.com/HANK538","followers_url":"https://api.github.com/users/HANK538/followers","following_url":"https://api.github.com/users/HANK538/following{/other_user}","gists_url":"https://api.github.com/users/HANK538/gists{/gist_id}","starred_url":"https://api.github.com/users/HANK538/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HANK538/subscriptions","organizations_url":"https://api.github.com/users/HANK538/orgs","repos_url":"https://api.github.com/users/HANK538/repos","events_url":"https://api.github.com/users/HANK538/events{/privacy}","received_events_url":"https://api.github.com/users/HANK538/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/499566914","html_url":"https://github.com/voxelmorph/voxelmorph/issues/55#issuecomment-499566914","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/55","id":499566914,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTU2NjkxNA==","user":{"login":"balakg","id":8753801,"node_id":"MDQ6VXNlcjg3NTM4MDE=","avatar_url":"https://avatars.githubusercontent.com/u/8753801?v=4","gravatar_id":"","url":"https://api.github.com/users/balakg","html_url":"https://github.com/balakg","followers_url":"https://api.github.com/users/balakg/followers","following_url":"https://api.github.com/users/balakg/following{/other_user}","gists_url":"https://api.github.com/users/balakg/gists{/gist_id}","starred_url":"https://api.github.com/users/balakg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/balakg/subscriptions","organizations_url":"https://api.github.com/users/balakg/orgs","repos_url":"https://api.github.com/users/balakg/repos","events_url":"https://api.github.com/users/balakg/events{/privacy}","received_events_url":"https://api.github.com/users/balakg/received_events","type":"User","site_admin":false},"created_at":"2019-06-06T16:21:13Z","updated_at":"2019-06-06T16:21:45Z","author_association":"COLLABORATOR","body":"The problem is that the filter is set for one channel images. You have a few options for modifying the CC loss function for your needs: \r\n\r\n1. Before running the filter, collapse your images to one channel (grayscale it)\r\n\r\n2. Run the filter on each channel of your image separately, and then take an average over the channels\r\n\r\n3. modify the filter itself into a [9, 9, 3, 3] shape, but make sure you construct it correctly so that the channels are processed separately.\r\n\r\nI think 2 may be the easiest.\r\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/499566914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"balakg","id":8753801,"node_id":"MDQ6VXNlcjg3NTM4MDE=","avatar_url":"https://avatars.githubusercontent.com/u/8753801?v=4","gravatar_id":"","url":"https://api.github.com/users/balakg","html_url":"https://github.com/balakg","followers_url":"https://api.github.com/users/balakg/followers","following_url":"https://api.github.com/users/balakg/following{/other_user}","gists_url":"https://api.github.com/users/balakg/gists{/gist_id}","starred_url":"https://api.github.com/users/balakg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/balakg/subscriptions","organizations_url":"https://api.github.com/users/balakg/orgs","repos_url":"https://api.github.com/users/balakg/repos","events_url":"https://api.github.com/users/balakg/events{/privacy}","received_events_url":"https://api.github.com/users/balakg/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/584487334","html_url":"https://github.com/voxelmorph/voxelmorph/issues/55#issuecomment-584487334","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/55","id":584487334,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDQ4NzMzNA==","user":{"login":"davidz123","id":27669457,"node_id":"MDQ6VXNlcjI3NjY5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/27669457?v=4","gravatar_id":"","url":"https://api.github.com/users/davidz123","html_url":"https://github.com/davidz123","followers_url":"https://api.github.com/users/davidz123/followers","following_url":"https://api.github.com/users/davidz123/following{/other_user}","gists_url":"https://api.github.com/users/davidz123/gists{/gist_id}","starred_url":"https://api.github.com/users/davidz123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidz123/subscriptions","organizations_url":"https://api.github.com/users/davidz123/orgs","repos_url":"https://api.github.com/users/davidz123/repos","events_url":"https://api.github.com/users/davidz123/events{/privacy}","received_events_url":"https://api.github.com/users/davidz123/received_events","type":"User","site_admin":false},"created_at":"2020-02-11T05:52:37Z","updated_at":"2020-02-11T05:52:37Z","author_association":"NONE","body":"@HANK538  hi, I'm going to do registration on RGB image and see your issue, could you release your implement on RGB images or share the configuration you set for this project.\r\n","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/584487334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"davidz123","id":27669457,"node_id":"MDQ6VXNlcjI3NjY5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/27669457?v=4","gravatar_id":"","url":"https://api.github.com/users/davidz123","html_url":"https://github.com/davidz123","followers_url":"https://api.github.com/users/davidz123/followers","following_url":"https://api.github.com/users/davidz123/following{/other_user}","gists_url":"https://api.github.com/users/davidz123/gists{/gist_id}","starred_url":"https://api.github.com/users/davidz123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidz123/subscriptions","organizations_url":"https://api.github.com/users/davidz123/orgs","repos_url":"https://api.github.com/users/davidz123/repos","events_url":"https://api.github.com/users/davidz123/events{/privacy}","received_events_url":"https://api.github.com/users/davidz123/received_events","type":"User","site_admin":false}},{"id":3025300495,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzAyNTMwMDQ5NQ==","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/3025300495","actor":{"login":"HANK538","id":37690266,"node_id":"MDQ6VXNlcjM3NjkwMjY2","avatar_url":"https://avatars.githubusercontent.com/u/37690266?v=4","gravatar_id":"","url":"https://api.github.com/users/HANK538","html_url":"https://github.com/HANK538","followers_url":"https://api.github.com/users/HANK538/followers","following_url":"https://api.github.com/users/HANK538/following{/other_user}","gists_url":"https://api.github.com/users/HANK538/gists{/gist_id}","starred_url":"https://api.github.com/users/HANK538/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HANK538/subscriptions","organizations_url":"https://api.github.com/users/HANK538/orgs","repos_url":"https://api.github.com/users/HANK538/repos","events_url":"https://api.github.com/users/HANK538/events{/privacy}","received_events_url":"https://api.github.com/users/HANK538/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-02-11T05:52:37Z","performed_via_github_app":null},{"id":3025300497,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMwMjUzMDA0OTc=","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/3025300497","actor":{"login":"HANK538","id":37690266,"node_id":"MDQ6VXNlcjM3NjkwMjY2","avatar_url":"https://avatars.githubusercontent.com/u/37690266?v=4","gravatar_id":"","url":"https://api.github.com/users/HANK538","html_url":"https://github.com/HANK538","followers_url":"https://api.github.com/users/HANK538/followers","following_url":"https://api.github.com/users/HANK538/following{/other_user}","gists_url":"https://api.github.com/users/HANK538/gists{/gist_id}","starred_url":"https://api.github.com/users/HANK538/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HANK538/subscriptions","organizations_url":"https://api.github.com/users/HANK538/orgs","repos_url":"https://api.github.com/users/HANK538/repos","events_url":"https://api.github.com/users/HANK538/events{/privacy}","received_events_url":"https://api.github.com/users/HANK538/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-02-11T05:52:37Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/584643083","html_url":"https://github.com/voxelmorph/voxelmorph/issues/55#issuecomment-584643083","issue_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/55","id":584643083,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDY0MzA4Mw==","user":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false},"created_at":"2020-02-11T13:50:24Z","updated_at":"2020-02-11T13:50:24Z","author_association":"COLLABORATOR","body":"@davidz123 here's our implementation -- just replace `NCC().ncc` with:\r\n\r\n```\r\n    def ncc(self, I, J):\r\n        # get dimension of volume\r\n        # assumes I, J are sized [batch_size, *vol_shape, nb_feats]\r\n        ndims = len(I.get_shape().as_list()) - 2\r\n        assert ndims in [1, 2, 3], \"volumes should be 1 to 3 dimensions. found: %d\" % ndims\r\n\r\n        # set window size\r\n        if self.win is None:\r\n            self.win = [9] * ndims\r\n\r\n        # get convolution function\r\n        conv_fn = getattr(tf.nn, 'conv%dd' % ndims)\r\n\r\n        # compute CC squares\r\n        I2 = I*I\r\n        J2 = J*J\r\n        IJ = I*J\r\n\r\n        # compute filters\r\n        in_ch = J.get_shape().as_list()[-1]\r\n        sum_filt = tf.ones([*self.win, in_ch, 1])\r\n        if ndims > 1:\r\n            strides = [1] * (ndims + 2)\r\n        else:\r\n            strides = 1\r\n        padding = 'SAME'\r\n\r\n        # compute local sums via convolution\r\n        I_sum = conv_fn(I, sum_filt, strides, padding)\r\n        J_sum = conv_fn(J, sum_filt, strides, padding)\r\n        I2_sum = conv_fn(I2, sum_filt, strides, padding)\r\n        J2_sum = conv_fn(J2, sum_filt, strides, padding)\r\n        IJ_sum = conv_fn(IJ, sum_filt, strides, padding)\r\n\r\n        # compute cross correlation\r\n        win_size = np.prod(self.win) * in_ch\r\n        u_I = I_sum/win_size\r\n        u_J = J_sum/win_size\r\n\r\n        cross = IJ_sum - u_J*I_sum - u_I*J_sum + u_I*u_J*win_size\r\n        I_var = I2_sum - 2 * u_I * I_sum + u_I*u_I*win_size\r\n        J_var = J2_sum - 2 * u_J * J_sum + u_J*u_J*win_size\r\n\r\n        cc = cross*cross / (I_var*J_var + self.eps)\r\n\r\n        # return negative cc.\r\n        return tf.reduce_mean(cc)\r\n\r\n    def loss(self, I, J):\r\n        return - self.ncc(I, J)\r\n```","reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/comments/584643083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"adalca","id":3219675,"node_id":"MDQ6VXNlcjMyMTk2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/3219675?v=4","gravatar_id":"","url":"https://api.github.com/users/adalca","html_url":"https://github.com/adalca","followers_url":"https://api.github.com/users/adalca/followers","following_url":"https://api.github.com/users/adalca/following{/other_user}","gists_url":"https://api.github.com/users/adalca/gists{/gist_id}","starred_url":"https://api.github.com/users/adalca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adalca/subscriptions","organizations_url":"https://api.github.com/users/adalca/orgs","repos_url":"https://api.github.com/users/adalca/repos","events_url":"https://api.github.com/users/adalca/events{/privacy}","received_events_url":"https://api.github.com/users/adalca/received_events","type":"User","site_admin":false}},{"id":3026616207,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzAyNjYxNjIwNw==","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/3026616207","actor":{"login":"davidz123","id":27669457,"node_id":"MDQ6VXNlcjI3NjY5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/27669457?v=4","gravatar_id":"","url":"https://api.github.com/users/davidz123","html_url":"https://github.com/davidz123","followers_url":"https://api.github.com/users/davidz123/followers","following_url":"https://api.github.com/users/davidz123/following{/other_user}","gists_url":"https://api.github.com/users/davidz123/gists{/gist_id}","starred_url":"https://api.github.com/users/davidz123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidz123/subscriptions","organizations_url":"https://api.github.com/users/davidz123/orgs","repos_url":"https://api.github.com/users/davidz123/repos","events_url":"https://api.github.com/users/davidz123/events{/privacy}","received_events_url":"https://api.github.com/users/davidz123/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-02-11T13:50:24Z","performed_via_github_app":null},{"id":3026616209,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMwMjY2MTYyMDk=","url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/events/3026616209","actor":{"login":"davidz123","id":27669457,"node_id":"MDQ6VXNlcjI3NjY5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/27669457?v=4","gravatar_id":"","url":"https://api.github.com/users/davidz123","html_url":"https://github.com/davidz123","followers_url":"https://api.github.com/users/davidz123/followers","following_url":"https://api.github.com/users/davidz123/following{/other_user}","gists_url":"https://api.github.com/users/davidz123/gists{/gist_id}","starred_url":"https://api.github.com/users/davidz123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidz123/subscriptions","organizations_url":"https://api.github.com/users/davidz123/orgs","repos_url":"https://api.github.com/users/davidz123/repos","events_url":"https://api.github.com/users/davidz123/events{/privacy}","received_events_url":"https://api.github.com/users/davidz123/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-02-11T13:50:24Z","performed_via_github_app":null}]