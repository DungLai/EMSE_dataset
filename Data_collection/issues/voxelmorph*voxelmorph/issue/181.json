{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/181","repository_url":"https://api.github.com/repos/voxelmorph/voxelmorph","labels_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/181/labels{/name}","comments_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/181/comments","events_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/181/events","html_url":"https://github.com/voxelmorph/voxelmorph/issues/181","id":609068002,"node_id":"MDU6SXNzdWU2MDkwNjgwMDI=","number":181,"title":"pytorch backend - loss function - parameters","user":{"login":"mchlrnwld","id":8170486,"node_id":"MDQ6VXNlcjgxNzA0ODY=","avatar_url":"https://avatars.githubusercontent.com/u/8170486?v=4","gravatar_id":"","url":"https://api.github.com/users/mchlrnwld","html_url":"https://github.com/mchlrnwld","followers_url":"https://api.github.com/users/mchlrnwld/followers","following_url":"https://api.github.com/users/mchlrnwld/following{/other_user}","gists_url":"https://api.github.com/users/mchlrnwld/gists{/gist_id}","starred_url":"https://api.github.com/users/mchlrnwld/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mchlrnwld/subscriptions","organizations_url":"https://api.github.com/users/mchlrnwld/orgs","repos_url":"https://api.github.com/users/mchlrnwld/repos","events_url":"https://api.github.com/users/mchlrnwld/events{/privacy}","received_events_url":"https://api.github.com/users/mchlrnwld/received_events","type":"User","site_admin":false},"labels":[{"id":1347467145,"node_id":"MDU6TGFiZWwxMzQ3NDY3MTQ1","url":"https://api.github.com/repos/voxelmorph/voxelmorph/labels/voxelmorph","name":"voxelmorph","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-04-29T13:41:25Z","updated_at":"2020-08-22T00:05:51Z","closed_at":"2020-08-22T00:05:51Z","author_association":"NONE","active_lock_reason":null,"body":"Hi all,\r\n\r\nwhen using the pytorch implementation of the redesign branch, i discovered the following:\r\nThe deformation loss in pytorch_backend/losses.py is defined as \r\n\r\n```\r\nclass Grad:\r\n    \"\"\"\r\n    N-D gradient loss.\r\n    \"\"\"\r\n\r\n    def __init__(self, penalty='l1'):\r\n        self.penalty = penalty\r\n\r\n    def loss(self, y_true, y_pred):\r\n        dy = torch.abs(y_true[:, :, 1:, :, :] - y_true[:, :, :-1, :, :]) \r\n        dx = torch.abs(y_true[:, :, :, 1:, :] - y_true[:, :, :, :-1, :]) \r\n        dz = torch.abs(y_true[:, :, :, :, 1:] - y_true[:, :, :, :, :-1]) \r\n\r\n        if self.penalty == 'l2':\r\n            dy = dy * dy\r\n            dx = dx * dx\r\n            dz = dz * dz\r\n\r\n        d = torch.mean(dx) + torch.mean(dy) + torch.mean(dz)\r\n        return d / 3.0\r\n```\r\nHowever, the variable **y_pred** is not used in the function **loss**.\r\nWhen using this loss function, shouldn't it just be applied to one variable, ie the flow field, eg\r\n```\r\ndeformation_loss = vxm.losses.Grad('l2').loss\r\ndeformation_loss(flow)\r\n```\r\n\r\nMany thanks,\r\nMR\r\n\r\n","closed_by":{"login":"ahoopes","id":24280487,"node_id":"MDQ6VXNlcjI0MjgwNDg3","avatar_url":"https://avatars.githubusercontent.com/u/24280487?v=4","gravatar_id":"","url":"https://api.github.com/users/ahoopes","html_url":"https://github.com/ahoopes","followers_url":"https://api.github.com/users/ahoopes/followers","following_url":"https://api.github.com/users/ahoopes/following{/other_user}","gists_url":"https://api.github.com/users/ahoopes/gists{/gist_id}","starred_url":"https://api.github.com/users/ahoopes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ahoopes/subscriptions","organizations_url":"https://api.github.com/users/ahoopes/orgs","repos_url":"https://api.github.com/users/ahoopes/repos","events_url":"https://api.github.com/users/ahoopes/events{/privacy}","received_events_url":"https://api.github.com/users/ahoopes/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/181/timeline","performed_via_github_app":null,"state_reason":"completed"}