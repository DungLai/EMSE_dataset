{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/393","repository_url":"https://api.github.com/repos/voxelmorph/voxelmorph","labels_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/393/labels{/name}","comments_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/393/comments","events_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/393/events","html_url":"https://github.com/voxelmorph/voxelmorph/issues/393","id":1131488447,"node_id":"I_kwDOB_Nd285DcSS_","number":393,"title":"Input layer incompatibility error while trying to register with Synthmorph models","user":{"login":"Hoda1394","id":16392763,"node_id":"MDQ6VXNlcjE2MzkyNzYz","avatar_url":"https://avatars.githubusercontent.com/u/16392763?v=4","gravatar_id":"","url":"https://api.github.com/users/Hoda1394","html_url":"https://github.com/Hoda1394","followers_url":"https://api.github.com/users/Hoda1394/followers","following_url":"https://api.github.com/users/Hoda1394/following{/other_user}","gists_url":"https://api.github.com/users/Hoda1394/gists{/gist_id}","starred_url":"https://api.github.com/users/Hoda1394/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hoda1394/subscriptions","organizations_url":"https://api.github.com/users/Hoda1394/orgs","repos_url":"https://api.github.com/users/Hoda1394/repos","events_url":"https://api.github.com/users/Hoda1394/events{/privacy}","received_events_url":"https://api.github.com/users/Hoda1394/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-02-11T02:14:11Z","updated_at":"2022-02-17T16:38:52Z","closed_at":"2022-02-17T16:38:52Z","author_association":"NONE","active_lock_reason":null,"body":"I am trying to test the SynthMorph models for registration but I am getting an Input layer incompatibility error. I tried a couple of images but to make sure it is not due to the affine registration between the input and target, I used the same image for both and still got this error. This error appears for both `brains` and `shapes` models.\r\nThe command I run:\r\n```\r\n./scripts/tf/register.py --moving data/test_scan.npz --fixed data/test_scan.npz --model ../shapes-dice-vel-3-res-8-16-32-256f.h5 --moved ../moved_synth.nii.gz --warp ../warp_synth.nii.gz -g 0\r\n```\r\nerror:\r\n```\r\nValueError: in user code:\r\n\r\n    /om2/user/hodaraja/miniconda/envs/vxm_update/lib/python3.7/site-packages/keras/engine/training.py:1586 predict_function  *\r\n        return step_function(self, iterator)\r\n    /om2/user/hodaraja/miniconda/envs/vxm_update/lib/python3.7/site-packages/keras/engine/training.py:1576 step_function  **\r\n        outputs = model.distribute_strategy.run(run_step, args=(data,))\r\n    /om2/user/hodaraja/miniconda/envs/vxm_update/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:1286 run\r\n        return self._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)\r\n    /om2/user/hodaraja/miniconda/envs/vxm_update/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:2849 call_for_each_replica\r\n        return self._call_for_each_replica(fn, args, kwargs)\r\n    /om2/user/hodaraja/miniconda/envs/vxm_update/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:3632 _call_for_each_replica\r\n        return fn(*args, **kwargs)\r\n    /om2/user/hodaraja/miniconda/envs/vxm_update/lib/python3.7/site-packages/keras/engine/training.py:1569 run_step  **\r\n        outputs = model.predict_step(data)\r\n    /om2/user/hodaraja/miniconda/envs/vxm_update/lib/python3.7/site-packages/keras/engine/training.py:1537 predict_step\r\n        return self(x, training=False)\r\n    /om2/user/hodaraja/miniconda/envs/vxm_update/lib/python3.7/site-packages/keras/engine/base_layer.py:1020 __call__\r\n        input_spec.assert_input_compatibility(self.input_spec, inputs, self.name)\r\n    /om2/user/hodaraja/miniconda/envs/vxm_update/lib/python3.7/site-packages/keras/engine/input_spec.py:269 assert_input_compatibility\r\n        ', found shape=' + display_shape(x.shape))\r\n\r\n    ValueError: Input 0 is incompatible with layer model_1: expected shape=(None, 160, 160, 192, 1), found shape=(None, 160, 192, 224, 1)\r\n```\r\n@mu40 - any idea what might be wrong?","closed_by":{"login":"Hoda1394","id":16392763,"node_id":"MDQ6VXNlcjE2MzkyNzYz","avatar_url":"https://avatars.githubusercontent.com/u/16392763?v=4","gravatar_id":"","url":"https://api.github.com/users/Hoda1394","html_url":"https://github.com/Hoda1394","followers_url":"https://api.github.com/users/Hoda1394/followers","following_url":"https://api.github.com/users/Hoda1394/following{/other_user}","gists_url":"https://api.github.com/users/Hoda1394/gists{/gist_id}","starred_url":"https://api.github.com/users/Hoda1394/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hoda1394/subscriptions","organizations_url":"https://api.github.com/users/Hoda1394/orgs","repos_url":"https://api.github.com/users/Hoda1394/repos","events_url":"https://api.github.com/users/Hoda1394/events{/privacy}","received_events_url":"https://api.github.com/users/Hoda1394/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/393/timeline","performed_via_github_app":null,"state_reason":"completed"}