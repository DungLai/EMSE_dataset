{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/366","repository_url":"https://api.github.com/repos/voxelmorph/voxelmorph","labels_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/366/labels{/name}","comments_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/366/comments","events_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/366/events","html_url":"https://github.com/voxelmorph/voxelmorph/issues/366","id":1040694495,"node_id":"I_kwDOB_Nd284-B7zf","number":366,"title":"tensorflow.python.framework.errors_impl.InvalidArgumentError","user":{"login":"SangWoonJeong","id":53933067,"node_id":"MDQ6VXNlcjUzOTMzMDY3","avatar_url":"https://avatars.githubusercontent.com/u/53933067?v=4","gravatar_id":"","url":"https://api.github.com/users/SangWoonJeong","html_url":"https://github.com/SangWoonJeong","followers_url":"https://api.github.com/users/SangWoonJeong/followers","following_url":"https://api.github.com/users/SangWoonJeong/following{/other_user}","gists_url":"https://api.github.com/users/SangWoonJeong/gists{/gist_id}","starred_url":"https://api.github.com/users/SangWoonJeong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SangWoonJeong/subscriptions","organizations_url":"https://api.github.com/users/SangWoonJeong/orgs","repos_url":"https://api.github.com/users/SangWoonJeong/repos","events_url":"https://api.github.com/users/SangWoonJeong/events{/privacy}","received_events_url":"https://api.github.com/users/SangWoonJeong/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2021-11-01T02:41:19Z","updated_at":"2021-11-09T05:02:08Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Task** (what are you trying to do/register?)\r\n\r\nscript/tr/train\r\ni can using two 3d image(256x256x64).\r\nsample shape : (1, 256, 256, 64, 1)\r\ninshape : (256, 256, 64)\r\n\r\ni can read the image;\r\n    atlas = vxm.py.utils.load_volfile(\"prostate_data/case_0025_main/nii_file/case_00002.nii\", np_var='vol',\r\n                                      add_batch_axis=True, add_feat_axis=add_feat_axis)\r\n    generator = vxm.generators.scan_to_atlas(\"prostate_data/case_0025_main/nii_file/case_00001.nii\", atlas,\r\n                                             batch_size=args.batch_size,\r\n                                             bidir=args.bidir,\r\n                                             add_feat_axis=add_feat_axis)\r\n\r\nfix image : case_0002.nii\r\nmoving image  : case_0001.nii\r\n\r\n''\r\nmodel.fit_generator(generator,\r\n                    initial_epoch=args.initial_epoch,\r\n                    epochs=args.epochs,\r\n                    steps_per_epoch=args.steps_per_epoch,\r\n                    callbacks=[save_callback],\r\n                    verbose=1\r\n                    )\r\n/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/keras/engine/training_v1.py:1228: UserWarning: `model.fit_generator` is deprecated and will be removed in a future version. Please use `Model.fit`, which supports generators.\r\n  warnings.warn('`model.fit_generator` is deprecated and '\r\nEpoch 1/1500\r\n2021-11-01 11:14:36.292845: W tensorflow/c/c_api.cc:335] Operation '{name:'flow_resize/flow_resize_resize/map/while' id:1142 op device:{requested: '', assigned: ''} def:{{{node flow_resize/flow_resize_resize/map/while}} = StatelessWhile[T=[DT_INT32, DT_INT32, DT_INT32, DT_VARIANT, DT_INT32, ..., DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT], _lower_using_switch_merge=true, _num_original_outputs=419, _read_only_resource_inputs=[], _stateful_parallelism=false, body=flow_resize_flow_resize_resize_map_while_body_823_rewritten[], cond=flow_resize_flow_resize_resize_map_while_cond_822_rewritten[], output_shapes=[[], [], [], [], [], ..., [], [], [], [], []], parallel_iterations=10](flow_resize/flow_resize_resize/map/while/loop_counter, flow_resize/flow_resize_resize/map/strided_slice, flow_resize/flow_resize_resize/map/Const, flow_resize/flow_resize_resize/map/TensorArrayV2_1, flow_resize/flow_resize_resize/map/strided_slice, flow_resize/flow_resize_resize/map/TensorArrayUnstack/TensorListFromTensor, flow_resize/flow_resize_resize/map/while/EmptyTensorList, flow_resize/flow_resize_resize/map/while/EmptyTensorList_1, flow_resize/flow_resize_resize/map/while/EmptyTensorList_2, flow_resize/flow_resize_resize/map/while/EmptyTensorList_3, flow_resize/flow_resize_resize/map/while/EmptyTensorList_4, flow_resize/flow_resize_resize/map/while/EmptyTensorList_5, flow_resize/flow_resize_resize/map/while/EmptyTensorList_6, flow_resize/flow_resize_resize/map/while/EmptyTensorList_7, flow_resize/flow_resize_resize/map/while/EmptyTensorList_8, flow_resize/flow_resize_resize/map/while/EmptyTensorList_9, flow_resize/flow_resize_resize/map/while/EmptyTensorList_10, flow_resize/flow_resize_resize/map/while/EmptyTensorList_11, flow_resize/flow_resize_resize/map/while/EmptyTensorList_12, flow_resize/flow_resize_resize/map/while/EmptyTensorList_13, flow_resize/flow_resize_resize/map/while/EmptyTensorList_14, flow_resize/flow_resize_resize/map/while/EmptyTensorList_15, flow_resize/flow_resize_resize/map/while/EmptyTensorList_16, flow_resize/flow_resize_resize/map/while/EmptyTensorList_17, flow_resize/flow_resize_resize/map/while/EmptyTensorList_18, flow_resize/flow_resize_resize/map/while/EmptyTensorList_19, flow_resize/flow_resize_resize/map/while/EmptyTensorList_20, flow_resize/flow_resize_resize/map/while/EmptyTensorList_21, flow_resize/flow_resize_resize/map/while/EmptyTensorList_22, flow_resize/flow_resize_resize/map/while/EmptyTensorList_23, flow_resize/flow_resize_resize/map/while/EmptyTensorList_24, flow_resize/flow_resize_resize/map/while/EmptyTensorList_25, flow_resize/flow_resize_resize/map/while/EmptyTensorList_26, flow_resize/flow_resize_resize/map/while/EmptyTensorList_27, flow_resize/flow_resize_resize/map/while/EmptyTensorList_28, flow_resize/flow_resize_resize/map/while/EmptyTensorList_29, flow_resize/flow_resize_resize/map/while/EmptyTensorList_30, flow_resize/flow_resize_resize/map/while/EmptyTensorList_31, flow_resize/flow_resize_resize/map/while/EmptyTensorList_32, flow_resize/flow_resize_resize/map/while/EmptyTensorList_33, flow_resize/flow_resize_resize/map/while/EmptyTensorList_34, flow_resize/flow_resize_resize/map/while/EmptyTensorList_35, flow_resize/flow_resize_resize/map/while/EmptyTensorList_36, flow_resize/flow_resize_resize/map/while/EmptyTensorList_37, flow_resize/flow_resize_resize/map/while/EmptyTensorList_38, flow_resize/flow_resize_resize/map/while/EmptyTensorList_39, flow_resize/flow_resize_resize/map/while/EmptyTensorList_40, flow_resize/flow_resize_resize/map/while/EmptyTensorList_41, flow_resize/flow_resize_resize/map/while/EmptyTensorList_42, flow_resize/flow_resize_resize/map/while/EmptyTensorList_43, flow_resize/flow_resize_resize/map/while/EmptyTensorList_44, flow_resize/flow_resize_resize/map/while/EmptyTensorList_45, flow_resize/flow_resize_resize/map/while/EmptyTensorList_46, flow_resize/flow_resize_resize/map/while/EmptyTensorList_47, flow_resize/flow_resize_resize/map/while/EmptyTensorList_48, flow_resize/flow_resize_resize/map/while/EmptyTensorList_49, flow_resize/flow_resize_resize/map/while/EmptyTensorList_50, flow_resize/flow_resize_resize/map/while/EmptyTensorList_51, flow_resize/flow_resize_resize/map/while/EmptyTensorList_52, flow_resize/flow_resize_resize/map/while/EmptyTensorList_53, flow_resize/flow_resize_resize/map/while/EmptyTensorList_54, flow_resize/flow_resize_resize/map/while/EmptyTensorList_55, flow_resize/flow_resize_resize/map/while/EmptyTensorList_56, flow_resize/flow_resize_resize/map/while/EmptyTensorList_57, flow_resize/flow_resize_resize/map/while/EmptyTensorList_58, flow_resize/flow_resize_resize/map/while/EmptyTensorList_59, flow_resize/flow_resize_resize/map/while/EmptyTensorList_60, flow_resize/flow_resize_resize/map/while/EmptyTensorList_61, flow_resize/flow_resize_resize/map/while/EmptyTensorList_62, flow_resize/flow_resize_resize/map/while/EmptyTensorList_63, flow_resize/flow_resize_resize/map/while/EmptyTensorList_64, flow_resize/flow_resize_resize/map/while/EmptyTensorList_65, flow_resize/flow_resize_resize/map/while/EmptyTensorList_66, flow_resize/flow_resize_resize/map/while/EmptyTensorList_67, flow_resize/flow_resize_resize/map/while/EmptyTensorList_68, flow_resize/flow_resize_resize/map/while/EmptyTensorList_69, flow_resize/flow_resize_resize/map/while/EmptyTensorList_70, flow_resize/flow_resize_resize/map/while/EmptyTensorList_71, flow_resize/flow_resize_resize/map/while/EmptyTensorList_72, flow_resize/flow_resize_resize/map/while/EmptyTensorList_73, flow_resize/flow_resize_resize/map/while/EmptyTensorList_74, flow_resize/flow_resize_resize/map/while/EmptyTensorList_75, flow_resize/flow_resize_resize/map/while/EmptyTensorList_76, flow_resize/flow_resize_resize/map/while/EmptyTensorList_77, flow_resize/flow_resize_resize/map/while/EmptyTensorList_78, flow_resize/flow_resize_resize/map/while/EmptyTensorList_79, flow_resize/flow_resize_resize/map/while/EmptyTensorList_80, flow_resize/flow_resize_resize/map/while/EmptyTensorList_81, flow_resize/flow_resize_resize/map/while/EmptyTensorList_82, flow_resize/flow_resize_resize/map/while/EmptyTensorList_83, flow_resize/flow_resize_resize/map/while/EmptyTensorList_84, flow_resize/flow_resize_resize/map/while/EmptyTensorList_85, flow_resize/flow_resize_resize/map/while/EmptyTensorList_86, flow_resize/flow_resize_resize/map/while/EmptyTensorList_87, flow_resize/flow_resize_resize/map/while/EmptyTensorList_88, flow_resize/flow_resize_resize/map/while/EmptyTensorList_89, flow_resize/flow_resize_resize/map/while/EmptyTensorList_90, flow_resize/flow_resize_resize/map/while/EmptyTensorList_91, flow_resize/flow_resize_resize/map/while/EmptyTensorList_92, flow_resize/flow_resize_resize/map/while/EmptyTensorList_93, flow_resize/flow_resize_resize/map/while/EmptyTensorList_94, flow_resize/flow_resize_resize/map/while/EmptyTensorList_95, flow_resize/flow_resize_resize/map/while/EmptyTensorList_96, flow_resize/flow_resize_resize/map/while/EmptyTensorList_97, flow_resize/flow_resize_resize/map/while/EmptyTensorList_98, flow_resize/flow_resize_resize/map/while/EmptyTensorList_99, flow_resize/flow_resize_resize/map/while/EmptyTensorList_100, flow_resize/flow_resize_resize/map/while/EmptyTensorList_101, flow_resize/flow_resize_resize/map/while/EmptyTensorList_102, flow_resize/flow_resize_resize/map/while/EmptyTensorList_103, flow_resize/flow_resize_resize/map/while/EmptyTensorList_104, flow_resize/flow_resize_resize/map/while/EmptyTensorList_105, flow_resize/flow_resize_resize/map/while/EmptyTensorList_106, flow_resize/flow_resize_resize/map/while/EmptyTensorList_107, flow_resize/flow_resize_resize/map/while/EmptyTensorList_108, flow_resize/flow_resize_resize/map/while/EmptyTensorList_109, flow_resize/flow_resize_resize/map/while/EmptyTensorList_110, flow_resize/flow_resize_resize/map/while/EmptyTensorList_111, flow_resize/flow_resize_resize/map/while/EmptyTensorList_112, flow_resize/flow_resize_resize/map/while/EmptyTensorList_113, flow_resize/flow_resize_resize/map/while/EmptyTensorList_114, flow_resize/flow_resize_resize/map/while/EmptyTensorList_115, flow_resize/flow_resize_resize/map/while/EmptyTensorList_116, flow_resize/flow_resize_resize/map/while/EmptyTensorList_117, flow_resize/flow_resize_resize/map/while/EmptyTensorList_118, flow_resize/flow_resize_resize/map/while/EmptyTensorList_119, flow_resize/flow_resize_resize/map/while/EmptyTensorList_120, flow_resize/flow_resize_resize/map/while/EmptyTensorList_121, flow_resize/flow_resize_resize/map/while/EmptyTensorList_122, flow_resize/flow_resize_resize/map/while/EmptyTensorList_123, flow_resize/flow_resize_resize/map/while/EmptyTensorList_124, flow_resize/flow_resize_resize/map/while/EmptyTensorList_125, flow_resize/flow_resize_resize/map/while/EmptyTensorList_126, flow_resize/flow_resize_resize/map/while/EmptyTensorList_127, flow_resize/flow_resize_resize/map/while/EmptyTensorList_128, flow_resize/flow_resize_resize/map/while/EmptyTensorList_129, flow_resize/flow_resize_resize/map/while/EmptyTensorList_130, flow_resize/flow_resize_resize/map/while/EmptyTensorList_131, flow_resize/flow_resize_resize/map/while/EmptyTensorList_132, flow_resize/flow_resize_resize/map/while/EmptyTensorList_133, flow_resize/flow_resize_resize/map/while/EmptyTensorList_134, flow_resize/flow_resize_resize/map/while/EmptyTensorList_135, flow_resize/flow_resize_resize/map/while/EmptyTensorList_136, flow_resize/flow_resize_resize/map/while/EmptyTensorList_137, flow_resize/flow_resize_resize/map/while/EmptyTensorList_138, flow_resize/flow_resize_resize/map/while/EmptyTensorList_139, flow_resize/flow_resize_resize/map/while/EmptyTensorList_140, flow_resize/flow_resize_resize/map/while/EmptyTensorList_141, flow_resize/flow_resize_resize/map/while/EmptyTensorList_142, flow_resize/flow_resize_resize/map/while/EmptyTensorList_143, flow_resize/flow_resize_resize/map/while/EmptyTensorList_144, flow_resize/flow_resize_resize/map/while/EmptyTensorList_145, flow_resize/flow_resize_resize/map/while/EmptyTensorList_146, flow_resize/flow_resize_resize/map/while/EmptyTensorList_147, flow_resize/flow_resize_resize/map/while/EmptyTensorList_148, flow_resize/flow_resize_resize/map/while/EmptyTensorList_149, flow_resize/flow_resize_resize/map/while/EmptyTensorList_150, flow_resize/flow_resize_resize/map/while/EmptyTensorList_151, flow_resize/flow_resize_resize/map/while/EmptyTensorList_152, flow_resize/flow_resize_resize/map/while/EmptyTensorList_153, flow_resize/flow_resize_resize/map/while/EmptyTensorList_154, flow_resize/flow_resize_resize/map/while/EmptyTensorList_155, flow_resize/flow_resize_resize/map/while/EmptyTensorList_156, flow_resize/flow_resize_resize/map/while/EmptyTensorList_157, flow_resize/flow_resize_resize/map/while/EmptyTensorList_158, flow_resize/flow_resize_resize/map/while/EmptyTensorList_159, flow_resize/flow_resize_resize/map/while/EmptyTensorList_160, flow_resize/flow_resize_resize/map/while/EmptyTensorList_161, flow_resize/flow_resize_resize/map/while/EmptyTensorList_162, flow_resize/flow_resize_resize/map/while/EmptyTensorList_163, flow_resize/flow_resize_resize/map/while/EmptyTensorList_164, flow_resize/flow_resize_resize/map/while/EmptyTensorList_165, flow_resize/flow_resize_resize/map/while/EmptyTensorList_166, flow_resize/flow_resize_resize/map/while/EmptyTensorList_167, flow_resize/flow_resize_resize/map/while/EmptyTensorList_168, flow_resize/flow_resize_resize/map/while/EmptyTensorList_169, flow_resize/flow_resize_resize/map/while/EmptyTensorList_170, flow_resize/flow_resize_resize/map/while/EmptyTensorList_171, flow_resize/flow_resize_resize/map/while/EmptyTensorList_172, flow_resize/flow_resize_resize/map/while/EmptyTensorList_173, flow_resize/flow_resize_resize/map/while/EmptyTensorList_174, flow_resize/flow_resize_resize/map/while/EmptyTensorList_175, flow_resize/flow_resize_resize/map/while/EmptyTensorList_176, flow_resize/flow_resize_resize/map/while/EmptyTensorList_177, flow_resize/flow_resize_resize/map/while/EmptyTensorList_178, flow_resize/flow_resize_resize/map/while/EmptyTensorList_179, flow_resize/flow_resize_resize/map/while/EmptyTensorList_180, flow_resize/flow_resize_resize/map/while/EmptyTensorList_181, flow_resize/flow_resize_resize/map/while/EmptyTensorList_182, flow_resize/flow_resize_resize/map/while/EmptyTensorList_183, flow_resize/flow_resize_resize/map/while/EmptyTensorList_184, flow_resize/flow_resize_resize/map/while/EmptyTensorList_185, flow_resize/flow_resize_resize/map/while/EmptyTensorList_186, flow_resize/flow_resize_resize/map/while/EmptyTensorList_187, flow_resize/flow_resize_resize/map/while/EmptyTensorList_188, flow_resize/flow_resize_resize/map/while/EmptyTensorList_189, flow_resize/flow_resize_resize/map/while/EmptyTensorList_190, flow_resize/flow_resize_resize/map/while/EmptyTensorList_191, flow_resize/flow_resize_resize/map/while/EmptyTensorList_192, flow_resize/flow_resize_resize/map/while/EmptyTensorList_193, flow_resize/flow_resize_resize/map/while/EmptyTensorList_194, flow_resize/flow_resize_resize/map/while/EmptyTensorList_195, flow_resize/flow_resize_resize/map/while/EmptyTensorList_196, flow_resize/flow_resize_resize/map/while/EmptyTensorList_197, flow_resize/flow_resize_resize/map/while/EmptyTensorList_198, flow_resize/flow_resize_resize/map/while/EmptyTensorList_199, flow_resize/flow_resize_resize/map/while/EmptyTensorList_200, flow_resize/flow_resize_resize/map/while/EmptyTensorList_201, flow_resize/flow_resize_resize/map/while/EmptyTensorList_202, flow_resize/flow_resize_resize/map/while/EmptyTensorList_203, flow_resize/flow_resize_resize/map/while/EmptyTensorList_204, flow_resize/flow_resize_resize/map/while/EmptyTensorList_205, flow_resize/flow_resize_resize/map/while/EmptyTensorList_206, flow_resize/flow_resize_resize/map/while/EmptyTensorList_207, flow_resize/flow_resize_resize/map/while/EmptyTensorList_208, flow_resize/flow_resize_resize/map/while/EmptyTensorList_209, flow_resize/flow_resize_resize/map/while/EmptyTensorList_210, flow_resize/flow_resize_resize/map/while/EmptyTensorList_211, flow_resize/flow_resize_resize/map/while/EmptyTensorList_212, flow_resize/flow_resize_resize/map/while/EmptyTensorList_213, flow_resize/flow_resize_resize/map/while/EmptyTensorList_214, flow_resize/flow_resize_resize/map/while/EmptyTensorList_215, flow_resize/flow_resize_resize/map/while/EmptyTensorList_216, flow_resize/flow_resize_resize/map/while/EmptyTensorList_217, flow_resize/flow_resize_resize/map/while/EmptyTensorList_218, flow_resize/flow_resize_resize/map/while/EmptyTensorList_219, flow_resize/flow_resize_resize/map/while/EmptyTensorList_220, flow_resize/flow_resize_resize/map/while/EmptyTensorList_221, flow_resize/flow_resize_resize/map/while/EmptyTensorList_222, flow_resize/flow_resize_resize/map/while/EmptyTensorList_223, flow_resize/flow_resize_resize/map/while/EmptyTensorList_224, flow_resize/flow_resize_resize/map/while/EmptyTensorList_225, flow_resize/flow_resize_resize/map/while/EmptyTensorList_226, flow_resize/flow_resize_resize/map/while/EmptyTensorList_227, flow_resize/flow_resize_resize/map/while/EmptyTensorList_228, flow_resize/flow_resize_resize/map/while/EmptyTensorList_229, flow_resize/flow_resize_resize/map/while/EmptyTensorList_230, flow_resize/flow_resize_resize/map/while/EmptyTensorList_231, flow_resize/flow_resize_resize/map/while/EmptyTensorList_232, flow_resize/flow_resize_resize/map/while/EmptyTensorList_233, flow_resize/flow_resize_resize/map/while/EmptyTensorList_234, flow_resize/flow_resize_resize/map/while/EmptyTensorList_235, flow_resize/flow_resize_resize/map/while/EmptyTensorList_236, flow_resize/flow_resize_resize/map/while/EmptyTensorList_237, flow_resize/flow_resize_resize/map/while/EmptyTensorList_238, flow_resize/flow_resize_resize/map/while/EmptyTensorList_239, flow_resize/flow_resize_resize/map/while/EmptyTensorList_240, flow_resize/flow_resize_resize/map/while/EmptyTensorList_241, flow_resize/flow_resize_resize/map/while/EmptyTensorList_242, flow_resize/flow_resize_resize/map/while/EmptyTensorList_243, flow_resize/flow_resize_resize/map/while/EmptyTensorList_244, flow_resize/flow_resize_resize/map/while/EmptyTensorList_245, flow_resize/flow_resize_resize/map/while/EmptyTensorList_246, flow_resize/flow_resize_resize/map/while/EmptyTensorList_247, flow_resize/flow_resize_resize/map/while/EmptyTensorList_248, flow_resize/flow_resize_resize/map/while/EmptyTensorList_249, flow_resize/flow_resize_resize/map/while/EmptyTensorList_250, flow_resize/flow_resize_resize/map/while/EmptyTensorList_251, flow_resize/flow_resize_resize/map/while/EmptyTensorList_252, flow_resize/flow_resize_resize/map/while/EmptyTensorList_253, flow_resize/flow_resize_resize/map/while/EmptyTensorList_254, flow_resize/flow_resize_resize/map/while/EmptyTensorList_255, flow_resize/flow_resize_resize/map/while/EmptyTensorList_256, flow_resize/flow_resize_resize/map/while/EmptyTensorList_257, flow_resize/flow_resize_resize/map/while/EmptyTensorList_258, flow_resize/flow_resize_resize/map/while/EmptyTensorList_259, flow_resize/flow_resize_resize/map/while/EmptyTensorList_260, flow_resize/flow_resize_resize/map/while/EmptyTensorList_261, flow_resize/flow_resize_resize/map/while/EmptyTensorList_262, flow_resize/flow_resize_resize/map/while/EmptyTensorList_263, flow_resize/flow_resize_resize/map/while/EmptyTensorList_264, flow_resize/flow_resize_resize/map/while/EmptyTensorList_265, flow_resize/flow_resize_resize/map/while/EmptyTensorList_266, flow_resize/flow_resize_resize/map/while/EmptyTensorList_267, flow_resize/flow_resize_resize/map/while/EmptyTensorList_268, flow_resize/flow_resize_resize/map/while/EmptyTensorList_269, flow_resize/flow_resize_resize/map/while/EmptyTensorList_270, flow_resize/flow_resize_resize/map/while/EmptyTensorList_271, flow_resize/flow_resize_resize/map/while/EmptyTensorList_272, flow_resize/flow_resize_resize/map/while/EmptyTensorList_273, flow_resize/flow_resize_resize/map/while/EmptyTensorList_274, flow_resize/flow_resize_resize/map/while/EmptyTensorList_275, flow_resize/flow_resize_resize/map/while/EmptyTensorList_276, flow_resize/flow_resize_resize/map/while/EmptyTensorList_277, flow_resize/flow_resize_resize/map/while/EmptyTensorList_278, flow_resize/flow_resize_resize/map/while/EmptyTensorList_279, flow_resize/flow_resize_resize/map/while/EmptyTensorList_280, flow_resize/flow_resize_resize/map/while/EmptyTensorList_281, flow_resize/flow_resize_resize/map/while/EmptyTensorList_282, flow_resize/flow_resize_resize/map/while/EmptyTensorList_283, flow_resize/flow_resize_resize/map/while/EmptyTensorList_284, flow_resize/flow_resize_resize/map/while/EmptyTensorList_285, flow_resize/flow_resize_resize/map/while/EmptyTensorList_286, flow_resize/flow_resize_resize/map/while/EmptyTensorList_287, flow_resize/flow_resize_resize/map/while/EmptyTensorList_288, flow_resize/flow_resize_resize/map/while/EmptyTensorList_289, flow_resize/flow_resize_resize/map/while/EmptyTensorList_290, flow_resize/flow_resize_resize/map/while/EmptyTensorList_291, flow_resize/flow_resize_resize/map/while/EmptyTensorList_292, flow_resize/flow_resize_resize/map/while/EmptyTensorList_293, flow_resize/flow_resize_resize/map/while/EmptyTensorList_294, flow_resize/flow_resize_resize/map/while/EmptyTensorList_295, flow_resize/flow_resize_resize/map/while/EmptyTensorList_296, flow_resize/flow_resize_resize/map/while/EmptyTensorList_297, flow_resize/flow_resize_resize/map/while/EmptyTensorList_298, flow_resize/flow_resize_resize/map/while/EmptyTensorList_299, flow_resize/flow_resize_resize/map/while/EmptyTensorList_300, flow_resize/flow_resize_resize/map/while/EmptyTensorList_301, flow_resize/flow_resize_resize/map/while/EmptyTensorList_302, flow_resize/flow_resize_resize/map/while/EmptyTensorList_303, flow_resize/flow_resize_resize/map/while/EmptyTensorList_304, flow_resize/flow_resize_resize/map/while/EmptyTensorList_305, flow_resize/flow_resize_resize/map/while/EmptyTensorList_306, flow_resize/flow_resize_resize/map/while/EmptyTensorList_307, flow_resize/flow_resize_resize/map/while/EmptyTensorList_308, flow_resize/flow_resize_resize/map/while/EmptyTensorList_309, flow_resize/flow_resize_resize/map/while/EmptyTensorList_310, flow_resize/flow_resize_resize/map/while/EmptyTensorList_311, flow_resize/flow_resize_resize/map/while/EmptyTensorList_312, flow_resize/flow_resize_resize/map/while/EmptyTensorList_313, flow_resize/flow_resize_resize/map/while/EmptyTensorList_314, flow_resize/flow_resize_resize/map/while/EmptyTensorList_315, flow_resize/flow_resize_resize/map/while/EmptyTensorList_316, flow_resize/flow_resize_resize/map/while/EmptyTensorList_317, flow_resize/flow_resize_resize/map/while/EmptyTensorList_318, flow_resize/flow_resize_resize/map/while/EmptyTensorList_319, flow_resize/flow_resize_resize/map/while/EmptyTensorList_320, flow_resize/flow_resize_resize/map/while/EmptyTensorList_321, flow_resize/flow_resize_resize/map/while/EmptyTensorList_322, flow_resize/flow_resize_resize/map/while/EmptyTensorList_323, flow_resize/flow_resize_resize/map/while/EmptyTensorList_324, flow_resize/flow_resize_resize/map/while/EmptyTensorList_325, flow_resize/flow_resize_resize/map/while/EmptyTensorList_326, flow_resize/flow_resize_resize/map/while/EmptyTensorList_327, flow_resize/flow_resize_resize/map/while/EmptyTensorList_328, flow_resize/flow_resize_resize/map/while/EmptyTensorList_329, flow_resize/flow_resize_resize/map/while/EmptyTensorList_330, flow_resize/flow_resize_resize/map/while/EmptyTensorList_331, flow_resize/flow_resize_resize/map/while/EmptyTensorList_332, flow_resize/flow_resize_resize/map/while/EmptyTensorList_333, flow_resize/flow_resize_resize/map/while/EmptyTensorList_334, flow_resize/flow_resize_resize/map/while/EmptyTensorList_335, flow_resize/flow_resize_resize/map/while/EmptyTensorList_336, flow_resize/flow_resize_resize/map/while/EmptyTensorList_337, flow_resize/flow_resize_resize/map/while/EmptyTensorList_338, flow_resize/flow_resize_resize/map/while/EmptyTensorList_339, flow_resize/flow_resize_resize/map/while/EmptyTensorList_340, flow_resize/flow_resize_resize/map/while/EmptyTensorList_341, flow_resize/flow_resize_resize/map/while/EmptyTensorList_342, flow_resize/flow_resize_resize/map/while/EmptyTensorList_343, flow_resize/flow_resize_resize/map/while/EmptyTensorList_344, flow_resize/flow_resize_resize/map/while/EmptyTensorList_345, flow_resize/flow_resize_resize/map/while/EmptyTensorList_346, flow_resize/flow_resize_resize/map/while/EmptyTensorList_347, flow_resize/flow_resize_resize/map/while/EmptyTensorList_348, flow_resize/flow_resize_resize/map/while/EmptyTensorList_349, flow_resize/flow_resize_resize/map/while/EmptyTensorList_350, flow_resize/flow_resize_resize/map/while/EmptyTensorList_351, flow_resize/flow_resize_resize/map/while/EmptyTensorList_352, flow_resize/flow_resize_resize/map/while/EmptyTensorList_353, flow_resize/flow_resize_resize/map/while/EmptyTensorList_354, flow_resize/flow_resize_resize/map/while/EmptyTensorList_355, flow_resize/flow_resize_resize/map/while/EmptyTensorList_356, flow_resize/flow_resize_resize/map/while/EmptyTensorList_357, flow_resize/flow_resize_resize/map/while/EmptyTensorList_358, flow_resize/flow_resize_resize/map/while/EmptyTensorList_359, flow_resize/flow_resize_resize/map/while/EmptyTensorList_360, flow_resize/flow_resize_resize/map/while/EmptyTensorList_361, flow_resize/flow_resize_resize/map/while/EmptyTensorList_362, flow_resize/flow_resize_resize/map/while/EmptyTensorList_363, flow_resize/flow_resize_resize/map/while/EmptyTensorList_364, flow_resize/flow_resize_resize/map/while/EmptyTensorList_365, flow_resize/flow_resize_resize/map/while/EmptyTensorList_366, flow_resize/flow_resize_resize/map/while/EmptyTensorList_367, flow_resize/flow_resize_resize/map/while/EmptyTensorList_368, flow_resize/flow_resize_resize/map/while/EmptyTensorList_369, flow_resize/flow_resize_resize/map/while/EmptyTensorList_370, flow_resize/flow_resize_resize/map/while/EmptyTensorList_371, flow_resize/flow_resize_resize/map/while/EmptyTensorList_372, flow_resize/flow_resize_resize/map/while/EmptyTensorList_373, flow_resize/flow_resize_resize/map/while/EmptyTensorList_374, flow_resize/flow_resize_resize/map/while/EmptyTensorList_375, flow_resize/flow_resize_resize/map/while/EmptyTensorList_376, flow_resize/flow_resize_resize/map/while/EmptyTensorList_377, flow_resize/flow_resize_resize/map/while/EmptyTensorList_378, flow_resize/flow_resize_resize/map/while/EmptyTensorList_379, flow_resize/flow_resize_resize/map/while/EmptyTensorList_380, flow_resize/flow_resize_resize/map/while/EmptyTensorList_381, flow_resize/flow_resize_resize/map/while/EmptyTensorList_382, flow_resize/flow_resize_resize/map/while/EmptyTensorList_383, flow_resize/flow_resize_resize/map/while/EmptyTensorList_384, flow_resize/flow_resize_resize/map/while/EmptyTensorList_385, flow_resize/flow_resize_resize/map/while/EmptyTensorList_386, flow_resize/flow_resize_resize/map/while/EmptyTensorList_387, flow_resize/flow_resize_resize/map/while/EmptyTensorList_388, flow_resize/flow_resize_resize/map/while/EmptyTensorList_389, flow_resize/flow_resize_resize/map/while/EmptyTensorList_390, flow_resize/flow_resize_resize/map/while/EmptyTensorList_391, flow_resize/flow_resize_resize/map/while/EmptyTensorList_392, flow_resize/flow_resize_resize/map/while/EmptyTensorList_393, flow_resize/flow_resize_resize/map/while/EmptyTensorList_394, flow_resize/flow_resize_resize/map/while/EmptyTensorList_395, flow_resize/flow_resize_resize/map/while/EmptyTensorList_396, flow_resize/flow_resize_resize/map/while/EmptyTensorList_397, flow_resize/flow_resize_resize/map/while/EmptyTensorList_398, flow_resize/flow_resize_resize/map/while/EmptyTensorList_399, flow_resize/flow_resize_resize/map/while/EmptyTensorList_400, flow_resize/flow_resize_resize/map/while/EmptyTensorList_401, flow_resize/flow_resize_resize/map/while/EmptyTensorList_402, flow_resize/flow_resize_resize/map/while/EmptyTensorList_403, flow_resize/flow_resize_resize/map/while/EmptyTensorList_404, flow_resize/flow_resize_resize/map/while/EmptyTensorList_405, flow_resize/flow_resize_resize/map/while/EmptyTensorList_406, flow_resize/flow_resize_resize/map/while/EmptyTensorList_407, flow_resize/flow_resize_resize/map/while/EmptyTensorList_408, flow_resize/flow_resize_resize/map/while/EmptyTensorList_409, flow_resize/flow_resize_resize/map/while/EmptyTensorList_410, training/Adam/gradients/gradients/flow_resize/flow_resize_resize/map/while_grad/gradients/TensorArrayV2Read/TensorListGetItem_grad/TensorListElementShape_0/accumulator:0, training/Adam/gradients/gradients/flow_resize/flow_resize_resize/map/while_grad/gradients/TensorArrayV2Read/TensorListGetItem_grad/TensorListLength_0/accumulator:0)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.\r\nTraceback (most recent call last):\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1375, in _do_call\r\n    return fn(*args)\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1358, in _run_fn\r\n    self._extend_graph()\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1398, in _extend_graph\r\n    tf_session.ExtendSession(self._session)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Node 'training/Adam/gradients/gradients/transformer/map/while_grad/transformer/map/while_grad': Connecting to invalid output 276 of source node transformer/map/while which has 276 outputs. Try using tf.compat.v1.experimental.output_all_intermediates(True).\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"<input>\", line 6, in <module>\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/keras/engine/training_v1.py\", line 1245, in fit_generator\r\n    initial_epoch=initial_epoch)\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/keras/engine/training_v1.py\", line 796, in fit\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/keras/engine/training_generator_v1.py\", line 586, in fit\r\n    steps_name='steps_per_epoch')\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/keras/engine/training_generator_v1.py\", line 252, in model_iteration\r\n    batch_outs = batch_function(*batch_data)\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/keras/engine/training_v1.py\", line 1076, in train_on_batch\r\n    outputs = self.train_function(ins)  # pylint: disable=not-callable\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/keras/backend.py\", line 3997, in __call__\r\n    session = get_session(inputs)\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/keras/backend.py\", line 711, in get_session\r\n    _initialize_variables(session)\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/keras/backend.py\", line 1162, in _initialize_variables\r\n    [tf.compat.v1.is_variable_initialized(v) for v in candidate_vars])\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 968, in run\r\n    run_metadata_ptr)\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1191, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1369, in _do_run\r\n    run_metadata)\r\n  File \"/home/smc/anaconda3/envs/deform/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1394, in _do_call\r\n    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Node 'training/Adam/gradients/gradients/transformer/map/while_grad/transformer/map/while_grad': Connecting to invalid output 276 of source node transformer/map/while which has 276 outputs. Try using tf.compat.v1.experimental.output_all_intermediates(True).\r\n'''\r\n\r\n**What have you tried**\r\n\r\n# build the model\r\nmodel = vxm.networks.VxmDense(\r\n    inshape=inshape,\r\n    nb_unet_features=[enc_nf, dec_nf],\r\n    bidir=args.bidir,\r\n    use_probs=args.use_probs,\r\n    int_steps=args.int_steps,\r\n    int_downsize=args.int_downsize,\r\n    src_feats=nfeats,\r\n    trg_feats=nfeats\r\n)\r\n\r\n**Details of experiments**\r\n\r\nVariables in tf/train script are not changed.\r\nIt was executed by changing only the input data.","closed_by":null,"reactions":{"url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/366/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/voxelmorph/voxelmorph/issues/366/timeline","performed_via_github_app":null,"state_reason":null}