[{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/591024375","html_url":"https://github.com/ludwig-ai/ludwig/issues/642#issuecomment-591024375","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/642","id":591024375,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MTAyNDM3NQ==","user":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"created_at":"2020-02-25T19:24:14Z","updated_at":"2020-02-25T19:24:14Z","author_association":"COLLABORATOR","body":"@mangleddata thanks for posting this. In order to debug we need more information. Specifically, we need a way to reproduce the problem, be it a model_definition.yaml + data + command or a python script or notebook. If you can't share your data there's a script that synthesizes data for you in `data/dataset_synthesyzer.py`. Anyway, being it a tensorflow memory allocation problem, it's likely a model problem and not a dataset problem. In most cases the size of the dataset does not impact the size of the model.","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/591024375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false}},{"id":3070679068,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzA3MDY3OTA2OA==","url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events/3070679068","actor":{"login":"mangleddata","id":57873718,"node_id":"MDQ6VXNlcjU3ODczNzE4","avatar_url":"https://avatars.githubusercontent.com/u/57873718?v=4","gravatar_id":"","url":"https://api.github.com/users/mangleddata","html_url":"https://github.com/mangleddata","followers_url":"https://api.github.com/users/mangleddata/followers","following_url":"https://api.github.com/users/mangleddata/following{/other_user}","gists_url":"https://api.github.com/users/mangleddata/gists{/gist_id}","starred_url":"https://api.github.com/users/mangleddata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mangleddata/subscriptions","organizations_url":"https://api.github.com/users/mangleddata/orgs","repos_url":"https://api.github.com/users/mangleddata/repos","events_url":"https://api.github.com/users/mangleddata/events{/privacy}","received_events_url":"https://api.github.com/users/mangleddata/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-02-25T19:24:14Z","performed_via_github_app":null},{"id":3070679072,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMwNzA2NzkwNzI=","url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events/3070679072","actor":{"login":"mangleddata","id":57873718,"node_id":"MDQ6VXNlcjU3ODczNzE4","avatar_url":"https://avatars.githubusercontent.com/u/57873718?v=4","gravatar_id":"","url":"https://api.github.com/users/mangleddata","html_url":"https://github.com/mangleddata","followers_url":"https://api.github.com/users/mangleddata/followers","following_url":"https://api.github.com/users/mangleddata/following{/other_user}","gists_url":"https://api.github.com/users/mangleddata/gists{/gist_id}","starred_url":"https://api.github.com/users/mangleddata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mangleddata/subscriptions","organizations_url":"https://api.github.com/users/mangleddata/orgs","repos_url":"https://api.github.com/users/mangleddata/repos","events_url":"https://api.github.com/users/mangleddata/events{/privacy}","received_events_url":"https://api.github.com/users/mangleddata/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-02-25T19:24:14Z","performed_via_github_app":null},{"id":3070681918,"node_id":"MDEyOkxhYmVsZWRFdmVudDMwNzA2ODE5MTg=","url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events/3070681918","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-02-25T19:25:02Z","label":{"name":"waiting for answer","color":"fff36b"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/591161564","html_url":"https://github.com/ludwig-ai/ludwig/issues/642#issuecomment-591161564","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/642","id":591161564,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MTE2MTU2NA==","user":{"login":"mangleddata","id":57873718,"node_id":"MDQ6VXNlcjU3ODczNzE4","avatar_url":"https://avatars.githubusercontent.com/u/57873718?v=4","gravatar_id":"","url":"https://api.github.com/users/mangleddata","html_url":"https://github.com/mangleddata","followers_url":"https://api.github.com/users/mangleddata/followers","following_url":"https://api.github.com/users/mangleddata/following{/other_user}","gists_url":"https://api.github.com/users/mangleddata/gists{/gist_id}","starred_url":"https://api.github.com/users/mangleddata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mangleddata/subscriptions","organizations_url":"https://api.github.com/users/mangleddata/orgs","repos_url":"https://api.github.com/users/mangleddata/repos","events_url":"https://api.github.com/users/mangleddata/events{/privacy}","received_events_url":"https://api.github.com/users/mangleddata/received_events","type":"User","site_admin":false},"created_at":"2020-02-26T00:23:28Z","updated_at":"2020-02-26T00:23:28Z","author_association":"NONE","body":"Please take a look into https://github.com/mangleddata/repro_ludwig\r\nThe data is randomly created, so wont make sense. But you should be able to reproduce. Perhaps, you could take a look into the scripts to see if I am doing something basic incorrectly. \r\n\r\nThanks for looking into it.","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/591161564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mangleddata","id":57873718,"node_id":"MDQ6VXNlcjU3ODczNzE4","avatar_url":"https://avatars.githubusercontent.com/u/57873718?v=4","gravatar_id":"","url":"https://api.github.com/users/mangleddata","html_url":"https://github.com/mangleddata","followers_url":"https://api.github.com/users/mangleddata/followers","following_url":"https://api.github.com/users/mangleddata/following{/other_user}","gists_url":"https://api.github.com/users/mangleddata/gists{/gist_id}","starred_url":"https://api.github.com/users/mangleddata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mangleddata/subscriptions","organizations_url":"https://api.github.com/users/mangleddata/orgs","repos_url":"https://api.github.com/users/mangleddata/repos","events_url":"https://api.github.com/users/mangleddata/events{/privacy}","received_events_url":"https://api.github.com/users/mangleddata/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/591180049","html_url":"https://github.com/ludwig-ai/ludwig/issues/642#issuecomment-591180049","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/642","id":591180049,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MTE4MDA0OQ==","user":{"login":"mangleddata","id":57873718,"node_id":"MDQ6VXNlcjU3ODczNzE4","avatar_url":"https://avatars.githubusercontent.com/u/57873718?v=4","gravatar_id":"","url":"https://api.github.com/users/mangleddata","html_url":"https://github.com/mangleddata","followers_url":"https://api.github.com/users/mangleddata/followers","following_url":"https://api.github.com/users/mangleddata/following{/other_user}","gists_url":"https://api.github.com/users/mangleddata/gists{/gist_id}","starred_url":"https://api.github.com/users/mangleddata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mangleddata/subscriptions","organizations_url":"https://api.github.com/users/mangleddata/orgs","repos_url":"https://api.github.com/users/mangleddata/repos","events_url":"https://api.github.com/users/mangleddata/events{/privacy}","received_events_url":"https://api.github.com/users/mangleddata/received_events","type":"User","site_admin":false},"created_at":"2020-02-26T01:04:37Z","updated_at":"2020-02-26T01:04:59Z","author_association":"NONE","body":"Something I just found out. If I initialize from a previous model and run without a distributed trainer [so ```horovodrun -np 1 --stall-check-shutdown-time-seconds 120 ludwig ...```], it seems to work.  ","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/591180049/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mangleddata","id":57873718,"node_id":"MDQ6VXNlcjU3ODczNzE4","avatar_url":"https://avatars.githubusercontent.com/u/57873718?v=4","gravatar_id":"","url":"https://api.github.com/users/mangleddata","html_url":"https://github.com/mangleddata","followers_url":"https://api.github.com/users/mangleddata/followers","following_url":"https://api.github.com/users/mangleddata/following{/other_user}","gists_url":"https://api.github.com/users/mangleddata/gists{/gist_id}","starred_url":"https://api.github.com/users/mangleddata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mangleddata/subscriptions","organizations_url":"https://api.github.com/users/mangleddata/orgs","repos_url":"https://api.github.com/users/mangleddata/repos","events_url":"https://api.github.com/users/mangleddata/events{/privacy}","received_events_url":"https://api.github.com/users/mangleddata/received_events","type":"User","site_admin":false}},{"actor":{"login":"mangleddata","id":57873718,"node_id":"MDQ6VXNlcjU3ODczNzE4","avatar_url":"https://avatars.githubusercontent.com/u/57873718?v=4","gravatar_id":"","url":"https://api.github.com/users/mangleddata","html_url":"https://github.com/mangleddata","followers_url":"https://api.github.com/users/mangleddata/followers","following_url":"https://api.github.com/users/mangleddata/following{/other_user}","gists_url":"https://api.github.com/users/mangleddata/gists{/gist_id}","starred_url":"https://api.github.com/users/mangleddata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mangleddata/subscriptions","organizations_url":"https://api.github.com/users/mangleddata/orgs","repos_url":"https://api.github.com/users/mangleddata/repos","events_url":"https://api.github.com/users/mangleddata/events{/privacy}","received_events_url":"https://api.github.com/users/mangleddata/received_events","type":"User","site_admin":false},"created_at":"2020-02-26T06:07:54Z","updated_at":"2020-02-26T06:07:54Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/610","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/610/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/610/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/610/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/610","id":548274563,"node_id":"MDU6SXNzdWU1NDgyNzQ1NjM=","number":610,"title":"Deadlock with some datasets","user":{"login":"mangleddata","id":57873718,"node_id":"MDQ6VXNlcjU3ODczNzE4","avatar_url":"https://avatars.githubusercontent.com/u/57873718?v=4","gravatar_id":"","url":"https://api.github.com/users/mangleddata","html_url":"https://github.com/mangleddata","followers_url":"https://api.github.com/users/mangleddata/followers","following_url":"https://api.github.com/users/mangleddata/following{/other_user}","gists_url":"https://api.github.com/users/mangleddata/gists{/gist_id}","starred_url":"https://api.github.com/users/mangleddata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mangleddata/subscriptions","organizations_url":"https://api.github.com/users/mangleddata/orgs","repos_url":"https://api.github.com/users/mangleddata/repos","events_url":"https://api.github.com/users/mangleddata/events{/privacy}","received_events_url":"https://api.github.com/users/mangleddata/received_events","type":"User","site_admin":false},"labels":[{"id":1174068775,"node_id":"MDU6TGFiZWwxMTc0MDY4Nzc1","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/waiting%20for%20answer","name":"waiting for answer","color":"fff36b","default":false,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2020-01-10T20:27:29Z","updated_at":"2022-06-23T00:22:25Z","closed_at":"2022-06-23T00:22:25Z","author_association":"NONE","active_lock_reason":null,"repository":{"id":163346054,"node_id":"MDEwOlJlcG9zaXRvcnkxNjMzNDYwNTQ=","name":"ludwig","full_name":"ludwig-ai/ludwig","private":false,"owner":{"login":"ludwig-ai","id":65477820,"node_id":"MDEyOk9yZ2FuaXphdGlvbjY1NDc3ODIw","avatar_url":"https://avatars.githubusercontent.com/u/65477820?v=4","gravatar_id":"","url":"https://api.github.com/users/ludwig-ai","html_url":"https://github.com/ludwig-ai","followers_url":"https://api.github.com/users/ludwig-ai/followers","following_url":"https://api.github.com/users/ludwig-ai/following{/other_user}","gists_url":"https://api.github.com/users/ludwig-ai/gists{/gist_id}","starred_url":"https://api.github.com/users/ludwig-ai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ludwig-ai/subscriptions","organizations_url":"https://api.github.com/users/ludwig-ai/orgs","repos_url":"https://api.github.com/users/ludwig-ai/repos","events_url":"https://api.github.com/users/ludwig-ai/events{/privacy}","received_events_url":"https://api.github.com/users/ludwig-ai/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/ludwig-ai/ludwig","description":"Data-centric declarative deep learning framework","fork":false,"url":"https://api.github.com/repos/ludwig-ai/ludwig","forks_url":"https://api.github.com/repos/ludwig-ai/ludwig/forks","keys_url":"https://api.github.com/repos/ludwig-ai/ludwig/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ludwig-ai/ludwig/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ludwig-ai/ludwig/teams","hooks_url":"https://api.github.com/repos/ludwig-ai/ludwig/hooks","issue_events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events{/number}","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/events","assignees_url":"https://api.github.com/repos/ludwig-ai/ludwig/assignees{/user}","branches_url":"https://api.github.com/repos/ludwig-ai/ludwig/branches{/branch}","tags_url":"https://api.github.com/repos/ludwig-ai/ludwig/tags","blobs_url":"https://api.github.com/repos/ludwig-ai/ludwig/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ludwig-ai/ludwig/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ludwig-ai/ludwig/git/refs{/sha}","trees_url":"https://api.github.com/repos/ludwig-ai/ludwig/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ludwig-ai/ludwig/statuses/{sha}","languages_url":"https://api.github.com/repos/ludwig-ai/ludwig/languages","stargazers_url":"https://api.github.com/repos/ludwig-ai/ludwig/stargazers","contributors_url":"https://api.github.com/repos/ludwig-ai/ludwig/contributors","subscribers_url":"https://api.github.com/repos/ludwig-ai/ludwig/subscribers","subscription_url":"https://api.github.com/repos/ludwig-ai/ludwig/subscription","commits_url":"https://api.github.com/repos/ludwig-ai/ludwig/commits{/sha}","git_commits_url":"https://api.github.com/repos/ludwig-ai/ludwig/git/commits{/sha}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/comments{/number}","issue_comment_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments{/number}","contents_url":"https://api.github.com/repos/ludwig-ai/ludwig/contents/{+path}","compare_url":"https://api.github.com/repos/ludwig-ai/ludwig/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ludwig-ai/ludwig/merges","archive_url":"https://api.github.com/repos/ludwig-ai/ludwig/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ludwig-ai/ludwig/downloads","issues_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues{/number}","pulls_url":"https://api.github.com/repos/ludwig-ai/ludwig/pulls{/number}","milestones_url":"https://api.github.com/repos/ludwig-ai/ludwig/milestones{/number}","notifications_url":"https://api.github.com/repos/ludwig-ai/ludwig/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/labels{/name}","releases_url":"https://api.github.com/repos/ludwig-ai/ludwig/releases{/id}","deployments_url":"https://api.github.com/repos/ludwig-ai/ludwig/deployments","created_at":"2018-12-27T23:58:12Z","updated_at":"2023-01-19T21:01:40Z","pushed_at":"2023-01-19T23:08:58Z","git_url":"git://github.com/ludwig-ai/ludwig.git","ssh_url":"git@github.com:ludwig-ai/ludwig.git","clone_url":"https://github.com/ludwig-ai/ludwig.git","svn_url":"https://github.com/ludwig-ai/ludwig","homepage":"http://ludwig.ai","size":29868,"stargazers_count":8712,"watchers_count":8712,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":1027,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":241,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["computer-vision","data-centric","data-science","datascience","deep","deep-learning","deeplearning","learning","machine","machine-learning","machinelearning","ml","natural-language","natural-language-processing","neural-network","python","pytorch"],"visibility":"public","forks":1027,"open_issues":241,"watchers":8712,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"**Describe the bug**\r\nSome datasets cause hangup with no progress being made. \r\n\r\n**To Reproduce**\r\nUnfortunately, I don't know if I can provide a reproducer since the data is custom data. However, I am happy to provide log info or any other data that would be helpful. The log shows deadlock on 1st epoch \r\n\r\n1,0]<stdout>:╒══════════╕\r\n[1,0]<stdout>:│ TRAINING │\r\n[1,0]<stdout>:╘══════════╛\r\n[1,0]<stdout>:\r\n[1,0]<stdout>:\r\n[1,0]<stdout>:Epoch   1\r\nTraining: 100% 377/377 [01:32<00:00,  4.07it/s][1,0]<stdout>:\r\nEvaluation train: 100% 377/377 [00:25<00:00, 14.82it/s][1,0]<stdout>:\r\n\r\nTrain set = ~900K rows rows, 900 features\r\nValid set = ~100K rows\r\n\r\n[1,0]<stderr>:[2020-01-10 19:52:29.658590: W horovod/common/stall_inspector.cc:105] One or more tensors were submitted to be reduced, gath\r\nered or broadcasted by subset of ranks and are waiting for remainder of ranks for more than 60 seconds. This may indicate that different r\r\nanks are trying to submit different tensors or that only subset of ranks is submitting tensors, which will cause deadlock.\r\n[1,0]<stderr>:Stalled ranks:\r\n[1,0]<stderr>:0: [optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_0, optimizer/DistributedAdamOpt\r\nimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_10_0, optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_optimizer\r\n_gradients_concat_11_0, optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_1_0, optimizer/Distribute\r\ndAdamOptimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_2_0, optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_op\r\ntimizer_gradients_concat_3_0 ...]\r\n[1,0]<stderr>:1: [optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_0, optimizer/DistributedAdamOpt\r\nimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_10_0, optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_optimizer\r\n_gradients_concat_11_0, optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_1_0, optimizer/Distribute\r\ndAdamOptimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_2_0, optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_op\r\ntimizer_gradients_concat_3_0 ...]\r\n\r\n\r\n\r\n\r\n**Expected behavior**\r\nExpect to make training progress.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Ubuntu \r\n - Version 18.04\r\n- Python version 3.6.6\r\n- Ludwig version 0.2.1\r\n\r\nhorovodrun  -v\r\n0.18.2\r\n\r\n\r\n\r\nAny pointers to overcome this ? ","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/610/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/591647280","html_url":"https://github.com/ludwig-ai/ludwig/issues/642#issuecomment-591647280","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/642","id":591647280,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MTY0NzI4MA==","user":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"created_at":"2020-02-26T21:14:28Z","updated_at":"2020-02-26T21:14:28Z","author_association":"COLLABORATOR","body":"> Something I just found out. If I initialize from a previous model and run without a distributed trainer [so `horovodrun -np 1 --stall-check-shutdown-time-seconds 120 ludwig ...`], it seems to work.\r\n\r\nThank you, this is pretty valuable for us to reduce the scope and identify where the problem lies. Will look into it and keep you psoted.","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/591647280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/595478434","html_url":"https://github.com/ludwig-ai/ludwig/issues/642#issuecomment-595478434","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/642","id":595478434,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTQ3ODQzNA==","user":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"created_at":"2020-03-05T22:26:32Z","updated_at":"2020-03-05T22:26:32Z","author_association":"COLLABORATOR","body":"An update on this issue @mangleddata .\r\nI was able to run your code, thank you for being really through with it, it helps a lot.\r\nUnfortunately I was not able to replicate the error, most likely because either my machine has more RAM or my GPUs have more VRAM than yours.\r\nAnyway, while running your rerun script I noticed a weird thing when using horovodrun.\r\n```\r\n[1,0]<stdout>:╒══════════╕\r\n[1,0]<stdout>:│ TRAINING │\r\n[1,0]<stdout>:╘══════════╛\r\n[1,0]<stdout>:\r\n[1,0]<stderr>:2020-03-05 14:07:50.483284: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n[1,0]<stderr>:2020-03-05 14:07:50.514970: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2494365000 Hz\r\n[1,0]<stderr>:2020-03-05 14:07:50.515261: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x18ffe050 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n[1,0]<stderr>:2020-03-05 14:07:50.515284: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n[1,0]<stderr>:2020-03-05 14:07:50.519618: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1\r\n[1,0]<stderr>:2020-03-05 14:07:50.927518: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x61600c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:\r\n[1,0]<stderr>:2020-03-05 14:07:50.927561: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5\r\n[1,0]<stderr>:2020-03-05 14:07:50.927571: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): GeForce RTX 2080 Ti, Compute Capability 7.5\r\n[1,0]<stderr>:2020-03-05 14:07:50.929271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 0 with properties: \r\n[1,0]<stderr>:name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545\r\n[1,0]<stderr>:pciBusID: 0000:02:00.0\r\n[1,0]<stderr>:2020-03-05 14:07:50.930630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 1 with properties: \r\n[1,0]<stderr>:name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545\r\n[1,0]<stderr>:pciBusID: 0000:03:00.0\r\n[1,0]<stderr>:2020-03-05 14:07:50.931131: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0\r\n[1,0]<stderr>:2020-03-05 14:07:50.933364: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0\r\n[1,0]<stderr>:2020-03-05 14:07:50.935192: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0\r\n[1,0]<stderr>:2020-03-05 14:07:50.935716: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0\r\n[1,0]<stderr>:2020-03-05 14:07:50.938355: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0\r\n[1,0]<stderr>:2020-03-05 14:07:50.939922: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0\r\n[1,0]<stderr>:2020-03-05 14:07:50.943993: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n[1,0]<stderr>:2020-03-05 14:07:50.947199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0, 1\r\n[1,0]<stderr>:2020-03-05 14:07:50.947257: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0\r\n[1,0]<stderr>:2020-03-05 14:07:50.949328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1180] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n[1,0]<stderr>:2020-03-05 14:07:50.949344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1186]      0 1 \r\n[1,0]<stderr>:2020-03-05 14:07:50.949350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 0:   N N \r\n[1,0]<stderr>:2020-03-05 14:07:50.949354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 1:   N N \r\n[1,0]<stderr>:2020-03-05 14:07:50.951589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8565 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:02:00.0, compute capability: 7.5)\r\n[1,0]<stderr>:2020-03-05 14:07:50.953408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10311 MB memory) -> physical GPU (device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:03:00.0, compute capability: 7.5)\r\n[1,1]<stderr>:2020-03-05 14:07:52.543080: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n[1,1]<stderr>:2020-03-05 14:07:52.571127: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2494365000 Hz\r\n[1,1]<stderr>:2020-03-05 14:07:52.571545: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1c3d7eb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n[1,1]<stderr>:2020-03-05 14:07:52.571572: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n[1,1]<stderr>:2020-03-05 14:07:52.575486: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1\r\n[1,1]<stderr>:2020-03-05 14:07:52.764596: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5273260 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:\r\n[1,1]<stderr>:2020-03-05 14:07:52.764649: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5\r\n[1,1]<stderr>:2020-03-05 14:07:52.764662: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): GeForce RTX 2080 Ti, Compute Capability 7.5\r\n[1,1]<stderr>:2020-03-05 14:07:52.766768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 0 with properties: \r\n[1,1]<stderr>:name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545\r\n[1,1]<stderr>:pciBusID: 0000:02:00.0\r\n[1,1]<stderr>:2020-03-05 14:07:52.768520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 1 with properties: \r\n[1,1]<stderr>:name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545\r\n[1,1]<stderr>:pciBusID: 0000:03:00.0\r\n[1,1]<stderr>:2020-03-05 14:07:52.769013: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0\r\n[1,1]<stderr>:2020-03-05 14:07:52.771443: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0\r\n[1,1]<stderr>:2020-03-05 14:07:52.772868: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0\r\n[1,1]<stderr>:2020-03-05 14:07:52.773229: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0\r\n[1,1]<stderr>:2020-03-05 14:07:52.775173: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0\r\n[1,1]<stderr>:2020-03-05 14:07:52.776662: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0\r\n[1,1]<stderr>:2020-03-05 14:07:52.781237: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n[1,1]<stderr>:2020-03-05 14:07:52.784516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0, 1\r\n[1,1]<stderr>:2020-03-05 14:07:52.784575: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0\r\n[1,1]<stderr>:2020-03-05 14:07:52.786729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1180] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n[1,1]<stderr>:2020-03-05 14:07:52.786747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1186]      0 1 \r\n[1,1]<stderr>:2020-03-05 14:07:52.786754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 0:   N N \r\n[1,1]<stderr>:2020-03-05 14:07:52.786758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 1:   N N \r\n[1,1]<stderr>:2020-03-05 14:07:52.789056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8171 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:02:00.0, compute capability: 7.5)\r\n[1,1]<stderr>:2020-03-05 14:07:52.790358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10164 MB memory) -> physical GPU (device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:03:00.0, compute capability: 7.5)\r\n```\r\nAs you can see both processes are trying to use both GPUs, while when training the first time with horovod each process was using one GPU:\r\n```\r\n[1,0]<stdout>:╒══════════╕\r\n[1,0]<stdout>:│ TRAINING │\r\n[1,0]<stdout>:╘══════════╛\r\n[1,0]<stdout>:\r\n[1,0]<stderr>:2020-03-05 14:01:28.909995: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n[1,0]<stderr>:2020-03-05 14:01:28.939007: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2494365000 Hz\r\n[1,0]<stderr>:2020-03-05 14:01:28.939324: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56d54d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n[1,0]<stderr>:2020-03-05 14:01:28.939352: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n[1,0]<stderr>:2020-03-05 14:01:28.942797: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1\r\n[1,0]<stderr>:2020-03-05 14:01:29.219551: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xf398c70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:\r\n[1,0]<stderr>:2020-03-05 14:01:29.219592: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5\r\n[1,0]<stderr>:2020-03-05 14:01:29.221195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 0 with properties: \r\n[1,0]<stderr>:name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545\r\n[1,0]<stderr>:pciBusID: 0000:02:00.0\r\n[1,0]<stderr>:2020-03-05 14:01:29.222702: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0\r\n[1,0]<stderr>:2020-03-05 14:01:29.263498: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0\r\n[1,0]<stderr>:2020-03-05 14:01:29.279116: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0\r\n[1,0]<stderr>:2020-03-05 14:01:29.287012: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0\r\n[1,0]<stderr>:2020-03-05 14:01:29.331148: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0\r\n[1,0]<stderr>:2020-03-05 14:01:29.358297: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0\r\n[1,0]<stderr>:2020-03-05 14:01:29.430127: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n[1,0]<stderr>:2020-03-05 14:01:29.432621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0\r\n[1,0]<stderr>:2020-03-05 14:01:29.432714: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0\r\n[1,0]<stderr>:2020-03-05 14:01:29.436324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1180] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n[1,0]<stderr>:2020-03-05 14:01:29.436352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1186]      0 \r\n[1,0]<stderr>:2020-03-05 14:01:29.436365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 0:   N \r\n[1,0]<stderr>:2020-03-05 14:01:29.438562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8552 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:02:00.0, compute capability: 7.5)\r\n[1,1]<stderr>:2020-03-05 14:01:30.694960: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n[1,1]<stderr>:2020-03-05 14:01:30.723104: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2494365000 Hz\r\n[1,1]<stderr>:2020-03-05 14:01:30.723415: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5063230 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n[1,1]<stderr>:2020-03-05 14:01:30.723440: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n[1,1]<stderr>:2020-03-05 14:01:30.727007: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1\r\n[1,1]<stderr>:2020-03-05 14:01:30.885130: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5184550 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:\r\n[1,1]<stderr>:2020-03-05 14:01:30.885178: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5\r\n[1,1]<stderr>:2020-03-05 14:01:30.887298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 0 with properties: \r\n[1,1]<stderr>:name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545\r\n[1,1]<stderr>:pciBusID: 0000:03:00.0\r\n[1,1]<stderr>:2020-03-05 14:01:30.887833: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0\r\n[1,1]<stderr>:2020-03-05 14:01:30.890398: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0\r\n[1,1]<stderr>:2020-03-05 14:01:30.892588: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0\r\n[1,1]<stderr>:2020-03-05 14:01:30.893213: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0\r\n[1,1]<stderr>:2020-03-05 14:01:30.896081: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0\r\n[1,1]<stderr>:2020-03-05 14:01:30.898183: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0\r\n[1,1]<stderr>:2020-03-05 14:01:30.901979: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n[1,1]<stderr>:2020-03-05 14:01:30.903680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 1\r\n[1,1]<stderr>:2020-03-05 14:01:30.903744: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0\r\n[1,1]<stderr>:2020-03-05 14:01:30.905820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1180] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n[1,1]<stderr>:2020-03-05 14:01:30.905835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1186]      1 \r\n[1,1]<stderr>:2020-03-05 14:01:30.905852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 1:   N \r\n[1,1]<stderr>:2020-03-05 14:01:30.907516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10311 MB memory) -> physical GPU (device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:03:00.0, compute capability: 7.5)\r\n\r\n```\r\nSo my current suspicion is that when loading for some reason the GPU assignment gets mixed up.\r\nI will inspect more and keep you posted if that's the case and if I can find a solution.\r\n\r\nOne minor comment: your model is pretty complicated with dependencies between different outputs and heads with their own weights and different datatypes as inputs, it's really cool! These are the kind of things I would love users to be able to do with Ludwig :) I'm curious what it is actually used for, we can chat privately about it if you prefer. Anyway, there's one minor problem with the model definition. you define validation_field and validation_measure for each output feature, while they are parameters of the training section of the yaml file. Right now they are ignored. The logic is: when deciding if to do an early stopping, I have to keep track of a specific number to see if it improves, and that number can be any of the validation \"cells\" that are printed at the end of each epoch or all the features, so you have to decide which of the different output features to keep track of and which measure (loss, accuracy, etc.) and there's also a combined feature in which the loss is the weighted sum of all others. So you have to pick one of them fundamentally, if you don't know which one, pick `validation_field: combined` and `validation_measure: loss`.","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/595478434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false}},{"id":3103192455,"node_id":"MDExOkNsb3NlZEV2ZW50MzEwMzE5MjQ1NQ==","url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events/3103192455","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"event":"closed","commit_id":"358fb4ffafb66f24b4d58be136a7750c52e3d618","commit_url":"https://api.github.com/repos/ludwig-ai/ludwig/commits/358fb4ffafb66f24b4d58be136a7750c52e3d618","created_at":"2020-03-05T22:57:40Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/595489364","html_url":"https://github.com/ludwig-ai/ludwig/issues/642#issuecomment-595489364","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/642","id":595489364,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTQ4OTM2NA==","user":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"created_at":"2020-03-05T23:01:06Z","updated_at":"2020-03-05T23:01:06Z","author_association":"COLLABORATOR","body":"I believe I found a solution. It was actually a really simple minor error, the parameter `use_horovod` was not passed to the function that loads a model but only to the function that initializes the model when no loading model is specified (as you can see from the commit above).\r\n\r\nI can't be sure this fixes your issue as I wasn't able to reproduce it in the first place, but it's pretty likely that it will.\r\n\r\nPlease try it out by rerunning your stuff after having reinstalled Ludwig from master `pip uninstall ludwig & pip install git+http://github,com/uber/ludwig.git` and let me know if it actually solves your problem. If it doesn't I'll reopen and dig into it further.","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/595489364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false}},{"id":3103340313,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzEwMzM0MDMxMw==","url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events/3103340313","actor":{"login":"mangleddata","id":57873718,"node_id":"MDQ6VXNlcjU3ODczNzE4","avatar_url":"https://avatars.githubusercontent.com/u/57873718?v=4","gravatar_id":"","url":"https://api.github.com/users/mangleddata","html_url":"https://github.com/mangleddata","followers_url":"https://api.github.com/users/mangleddata/followers","following_url":"https://api.github.com/users/mangleddata/following{/other_user}","gists_url":"https://api.github.com/users/mangleddata/gists{/gist_id}","starred_url":"https://api.github.com/users/mangleddata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mangleddata/subscriptions","organizations_url":"https://api.github.com/users/mangleddata/orgs","repos_url":"https://api.github.com/users/mangleddata/repos","events_url":"https://api.github.com/users/mangleddata/events{/privacy}","received_events_url":"https://api.github.com/users/mangleddata/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-03-05T23:58:57Z","performed_via_github_app":null},{"id":3103340329,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMxMDMzNDAzMjk=","url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events/3103340329","actor":{"login":"mangleddata","id":57873718,"node_id":"MDQ6VXNlcjU3ODczNzE4","avatar_url":"https://avatars.githubusercontent.com/u/57873718?v=4","gravatar_id":"","url":"https://api.github.com/users/mangleddata","html_url":"https://github.com/mangleddata","followers_url":"https://api.github.com/users/mangleddata/followers","following_url":"https://api.github.com/users/mangleddata/following{/other_user}","gists_url":"https://api.github.com/users/mangleddata/gists{/gist_id}","starred_url":"https://api.github.com/users/mangleddata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mangleddata/subscriptions","organizations_url":"https://api.github.com/users/mangleddata/orgs","repos_url":"https://api.github.com/users/mangleddata/repos","events_url":"https://api.github.com/users/mangleddata/events{/privacy}","received_events_url":"https://api.github.com/users/mangleddata/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-03-05T23:58:57Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/596692771","html_url":"https://github.com/ludwig-ai/ludwig/issues/642#issuecomment-596692771","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/642","id":596692771,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NjY5Mjc3MQ==","user":{"login":"mangleddata","id":57873718,"node_id":"MDQ6VXNlcjU3ODczNzE4","avatar_url":"https://avatars.githubusercontent.com/u/57873718?v=4","gravatar_id":"","url":"https://api.github.com/users/mangleddata","html_url":"https://github.com/mangleddata","followers_url":"https://api.github.com/users/mangleddata/followers","following_url":"https://api.github.com/users/mangleddata/following{/other_user}","gists_url":"https://api.github.com/users/mangleddata/gists{/gist_id}","starred_url":"https://api.github.com/users/mangleddata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mangleddata/subscriptions","organizations_url":"https://api.github.com/users/mangleddata/orgs","repos_url":"https://api.github.com/users/mangleddata/repos","events_url":"https://api.github.com/users/mangleddata/events{/privacy}","received_events_url":"https://api.github.com/users/mangleddata/received_events","type":"User","site_admin":false},"created_at":"2020-03-09T18:11:41Z","updated_at":"2020-03-09T18:11:41Z","author_association":"NONE","body":"Thanks for looking into this. The fix you made did fix the load issue. I am able initialize the model from previous model results and it works great! One issue though, something got broke if I simply did a reinstall - not sure if some dependencies are messed up. So I had to manually merge the changes and that's good enough for me. I understand you may not have time, but it would be great if someone could build a docker image or some cloud image with major versions. That way all the prereq would be baked in and it would be much simpler to launch.\r\n\r\nAs for the complex model, it's a hobby project and I would be happy to chat more. It is more complex than what it needs to be, but it has been lot of fun and I am still at it during my free time. Please reach out to mangled.data@gmail.com and I will explain in detail what I am trying to do.","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/596692771/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mangleddata","id":57873718,"node_id":"MDQ6VXNlcjU3ODczNzE4","avatar_url":"https://avatars.githubusercontent.com/u/57873718?v=4","gravatar_id":"","url":"https://api.github.com/users/mangleddata","html_url":"https://github.com/mangleddata","followers_url":"https://api.github.com/users/mangleddata/followers","following_url":"https://api.github.com/users/mangleddata/following{/other_user}","gists_url":"https://api.github.com/users/mangleddata/gists{/gist_id}","starred_url":"https://api.github.com/users/mangleddata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mangleddata/subscriptions","organizations_url":"https://api.github.com/users/mangleddata/orgs","repos_url":"https://api.github.com/users/mangleddata/repos","events_url":"https://api.github.com/users/mangleddata/events{/privacy}","received_events_url":"https://api.github.com/users/mangleddata/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/596848272","html_url":"https://github.com/ludwig-ai/ludwig/issues/642#issuecomment-596848272","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/642","id":596848272,"node_id":"MDEyOklzc3VlQ29tbWVudDU5Njg0ODI3Mg==","user":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"created_at":"2020-03-10T00:56:19Z","updated_at":"2020-03-10T00:56:19Z","author_association":"COLLABORATOR","body":"What got broke when you reinstall? Can you try to start a fresh venv and see if that solves the problem?\r\n\r\nRegarding the docker, there is a dockerfile in the repo, that doesn't work for you?\r\n\r\nWill reach out to you regarding the project, I'm curious.","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/596848272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false}}]