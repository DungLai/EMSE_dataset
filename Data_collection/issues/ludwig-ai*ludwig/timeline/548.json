[{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/546728142","html_url":"https://github.com/ludwig-ai/ludwig/issues/548#issuecomment-546728142","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/548","id":546728142,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NjcyODE0Mg==","user":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"created_at":"2019-10-27T19:57:37Z","updated_at":"2019-10-27T19:57:37Z","author_association":"COLLABORATOR","body":"Hi Shankar, at the moment we don't have a model zoo with pre-trained models. It would be a nice addition in the future. You may start it by contributing your translation model if you end up building one yourself.","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/546728142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false}},{"id":2746856301,"node_id":"MDEyOkxhYmVsZWRFdmVudDI3NDY4NTYzMDE=","url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events/2746856301","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-10-27T19:57:46Z","label":{"name":"enhancement","color":"a2eeef"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/791905954","html_url":"https://github.com/ludwig-ai/ludwig/issues/548#issuecomment-791905954","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/548","id":791905954,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MTkwNTk1NA==","user":{"login":"justinepdevasia","id":40311683,"node_id":"MDQ6VXNlcjQwMzExNjgz","avatar_url":"https://avatars.githubusercontent.com/u/40311683?v=4","gravatar_id":"","url":"https://api.github.com/users/justinepdevasia","html_url":"https://github.com/justinepdevasia","followers_url":"https://api.github.com/users/justinepdevasia/followers","following_url":"https://api.github.com/users/justinepdevasia/following{/other_user}","gists_url":"https://api.github.com/users/justinepdevasia/gists{/gist_id}","starred_url":"https://api.github.com/users/justinepdevasia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinepdevasia/subscriptions","organizations_url":"https://api.github.com/users/justinepdevasia/orgs","repos_url":"https://api.github.com/users/justinepdevasia/repos","events_url":"https://api.github.com/users/justinepdevasia/events{/privacy}","received_events_url":"https://api.github.com/users/justinepdevasia/received_events","type":"User","site_admin":false},"created_at":"2021-03-06T10:03:03Z","updated_at":"2021-03-06T10:03:03Z","author_association":"NONE","body":"#### Hi, \r\n\r\n#### When I tried to do machine translation from english to hindi, I am getting the following error,\r\n#### I am getting the same for italian also\r\n#### The config file is given below\r\n`input_features:\r\n    -\r\n        name: english\r\n        type: text\r\n        level: word\r\n        encoder: rnn\r\n        cell_type: lstm\r\n        reduce_output: null\r\n        preprocessing:\r\n          word_tokenizer: english_tokenize\r\n\r\noutput_features:\r\n    -\r\n        name: hindi\r\n        type: text\r\n        level: word\r\n        decoder: generator\r\n        cell_type: lstm\r\n        attention: bahdanau\r\n        reduce_input: null\r\n        loss:\r\n            type: sampled_softmax_cross_entropy\r\n        preprocessing:\r\n          word_tokenizer: multi_tokenize\r\n\r\ntraining:\r\n    batch_size: 96\r\n`\r\n\r\n`2021-03-06 09:47:08.422559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0\r\n/usr/local/lib/python3.7/dist-packages/typeguard/__init__.py:804: UserWarning: no type annotations present -- not typechecking tensorflow_addons.layers.max_unpooling_2d.MaxUnpooling2D.__init__\r\n  warn('no type annotations present -- not typechecking {}'.format(function_name(func)))\r\n███████████████████████\r\n█ █ █ █  ▜█ █ █ █ █   █\r\n█ █ █ █ █ █ █ █ █ █ ███\r\n█ █   █ █ █ █ █ █ █ ▌ █\r\n█ █████ █ █ █ █ █ █ █ █\r\n█     █  ▟█     █ █   █\r\n███████████████████████\r\nludwig v0.3.3 - Experiment\r\n\r\n2021-03-06 09:47:09.938591: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set\r\n2021-03-06 09:47:09.939327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1\r\n2021-03-06 09:47:09.953477: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2021-03-06 09:47:09.954112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: \r\npciBusID: 0000:00:04.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0\r\ncoreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s\r\n2021-03-06 09:47:09.954158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0\r\n2021-03-06 09:47:09.956661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11\r\n2021-03-06 09:47:09.956750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11\r\n2021-03-06 09:47:09.958380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10\r\n2021-03-06 09:47:09.958744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10\r\n2021-03-06 09:47:09.960439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10\r\n2021-03-06 09:47:09.961020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11\r\n2021-03-06 09:47:09.961214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8\r\n2021-03-06 09:47:09.961307: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2021-03-06 09:47:09.961915: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2021-03-06 09:47:09.962437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0\r\nExperiment name: experiment\r\nModel name: run\r\nOutput directory: results/experiment_run_10\r\n\r\n\r\nludwig_version: '0.3.3'\r\ncommand: ('/usr/local/bin/ludwig experiment --dataset translation.csv --config_file '\r\n 'config.yaml')\r\nrandom_seed: 42\r\ndataset: 'translation.csv'\r\ndata_format: 'csv'\r\nconfig: {   'combiner': {'type': 'concat'},\r\n    'input_features': [   {   'cell_type': 'lstm',\r\n                              'column': 'english',\r\n                              'encoder': 'rnn',\r\n                              'level': 'word',\r\n                              'name': 'english',\r\n                              'preprocessing': {   'word_tokenizer': 'english_tokenize'},\r\n                              'proc_column': 'english_o_tfkJ',\r\n                              'reduce_output': None,\r\n                              'tied': None,\r\n                              'type': 'text'}],\r\n    'output_features': [   {   'attention': 'bahdanau',\r\n                               'cell_type': 'lstm',\r\n                               'column': 'hindi',\r\n                               'decoder': 'generator',\r\n                               'dependencies': [],\r\n                               'level': 'word',\r\n                               'loss': {   'class_similarities_temperature': 0,\r\n                                           'class_weights': 1,\r\n                                           'confidence_penalty': 0,\r\n                                           'distortion': 0.75,\r\n                                           'labels_smoothing': 0,\r\n                                           'negative_samples': 25,\r\n                                           'robust_lambda': 0,\r\n                                           'sampler': 'log_uniform',\r\n                                           'type': 'sampled_softmax_cross_entropy',\r\n                                           'unique': False,\r\n                                           'weight': 1},\r\n                               'name': 'hindi',\r\n                               'preprocessing': {   'word_tokenizer': 'multi_tokenize'},\r\n                               'proc_column': 'hindi_x50Q5l',\r\n                               'reduce_dependencies': 'sum',\r\n                               'reduce_input': None,\r\n                               'type': 'text'}],\r\n    'preprocessing': {   'audio': {   'audio_feature': {'type': 'raw'},\r\n                                      'audio_file_length_limit_in_s': 7.5,\r\n                                      'in_memory': True,\r\n                                      'missing_value_strategy': 'backfill',\r\n                                      'norm': None,\r\n                                      'padding_value': 0},\r\n                         'bag': {   'fill_value': '<UNK>',\r\n                                    'lowercase': False,\r\n                                    'missing_value_strategy': 'fill_with_const',\r\n                                    'most_common': 10000,\r\n                                    'tokenizer': 'space'},\r\n                         'binary': {   'fill_value': 0,\r\n                                       'missing_value_strategy': 'fill_with_const'},\r\n                         'category': {   'fill_value': '<UNK>',\r\n                                         'lowercase': False,\r\n                                         'missing_value_strategy': 'fill_with_const',\r\n                                         'most_common': 10000},\r\n                         'date': {   'datetime_format': None,\r\n                                     'fill_value': '',\r\n                                     'missing_value_strategy': 'fill_with_const'},\r\n                         'force_split': False,\r\n                         'h3': {   'fill_value': 576495936675512319,\r\n                                   'missing_value_strategy': 'fill_with_const'},\r\n                         'image': {   'in_memory': True,\r\n                                      'missing_value_strategy': 'backfill',\r\n                                      'num_processes': 1,\r\n                                      'resize_method': 'interpolate',\r\n                                      'scaling': 'pixel_normalization'},\r\n                         'numerical': {   'fill_value': 0,\r\n                                          'missing_value_strategy': 'fill_with_const',\r\n                                          'normalization': None},\r\n                         'sequence': {   'fill_value': '<UNK>',\r\n                                         'lowercase': False,\r\n                                         'missing_value_strategy': 'fill_with_const',\r\n                                         'most_common': 20000,\r\n                                         'padding': 'right',\r\n                                         'padding_symbol': '<PAD>',\r\n                                         'sequence_length_limit': 256,\r\n                                         'tokenizer': 'space',\r\n                                         'unknown_symbol': '<UNK>',\r\n                                         'vocab_file': None},\r\n                         'set': {   'fill_value': '<UNK>',\r\n                                    'lowercase': False,\r\n                                    'missing_value_strategy': 'fill_with_const',\r\n                                    'most_common': 10000,\r\n                                    'tokenizer': 'space'},\r\n                         'split_probabilities': (0.7, 0.1, 0.2),\r\n                         'stratify': None,\r\n                         'text': {   'char_most_common': 70,\r\n                                     'char_sequence_length_limit': 1024,\r\n                                     'char_tokenizer': 'characters',\r\n                                     'char_vocab_file': None,\r\n                                     'fill_value': '<UNK>',\r\n                                     'lowercase': True,\r\n                                     'missing_value_strategy': 'fill_with_const',\r\n                                     'padding': 'right',\r\n                                     'padding_symbol': '<PAD>',\r\n                                     'pretrained_model_name_or_path': None,\r\n                                     'unknown_symbol': '<UNK>',\r\n                                     'word_most_common': 20000,\r\n                                     'word_sequence_length_limit': 256,\r\n                                     'word_tokenizer': 'space_punct',\r\n                                     'word_vocab_file': None},\r\n                         'timeseries': {   'fill_value': '',\r\n                                           'missing_value_strategy': 'fill_with_const',\r\n                                           'padding': 'right',\r\n                                           'padding_value': 0,\r\n                                           'timeseries_length_limit': 256,\r\n                                           'tokenizer': 'space'},\r\n                         'vector': {   'fill_value': '',\r\n                                       'missing_value_strategy': 'fill_with_const'}},\r\n    'training': {   'batch_size': 96,\r\n                    'bucketing_field': None,\r\n                    'decay': False,\r\n                    'decay_rate': 0.96,\r\n                    'decay_steps': 10000,\r\n                    'early_stop': 5,\r\n                    'epochs': 100,\r\n                    'eval_batch_size': 0,\r\n                    'gradient_clipping': None,\r\n                    'increase_batch_size_on_plateau': 0,\r\n                    'increase_batch_size_on_plateau_max': 512,\r\n                    'increase_batch_size_on_plateau_patience': 5,\r\n                    'increase_batch_size_on_plateau_rate': 2,\r\n                    'learning_rate': 0.001,\r\n                    'learning_rate_warmup_epochs': 1,\r\n                    'optimizer': {   'beta_1': 0.9,\r\n                                     'beta_2': 0.999,\r\n                                     'epsilon': 1e-08,\r\n                                     'type': 'adam'},\r\n                    'reduce_learning_rate_on_plateau': 0,\r\n                    'reduce_learning_rate_on_plateau_patience': 5,\r\n                    'reduce_learning_rate_on_plateau_rate': 0.5,\r\n                    'regularization_lambda': 0,\r\n                    'regularizer': 'l2',\r\n                    'staircase': False,\r\n                    'validation_field': 'combined',\r\n                    'validation_metric': 'loss'}}\r\ntf_version: '2.4.1'\r\n\r\n\r\nFound hdf5 and meta.json with the same filename of the dataset, but checksum don't match, if saving of processed input is not skipped they will be overridden\r\nUsing full raw csv, no hdf5 and json file with the same name have been found\r\nBuilding dataset (it may take a while)\r\nLoading NLP pipeline\r\n2021-03-06 09:47:10.411369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0\r\nLoading NLP pipeline\r\nWriting preprocessed dataset cache\r\nWriting train set metadata\r\nTraining set: 2047\r\nValidation set: 282\r\nTest set: 586\r\n2021-03-06 09:47:14.369377: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set\r\n2021-03-06 09:47:14.369588: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2021-03-06 09:47:14.370201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: \r\npciBusID: 0000:00:04.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0\r\ncoreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s\r\n2021-03-06 09:47:14.370280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0\r\n2021-03-06 09:47:14.370321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11\r\n2021-03-06 09:47:14.370347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11\r\n2021-03-06 09:47:14.370371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10\r\n2021-03-06 09:47:14.370393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10\r\n2021-03-06 09:47:14.370419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10\r\n2021-03-06 09:47:14.370441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11\r\n2021-03-06 09:47:14.370463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8\r\n2021-03-06 09:47:14.370560: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2021-03-06 09:47:14.371143: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2021-03-06 09:47:14.371650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0\r\n2021-03-06 09:47:16.766733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2021-03-06 09:47:16.766796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 \r\n2021-03-06 09:47:16.766815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N \r\n2021-03-06 09:47:16.767034: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2021-03-06 09:47:16.767658: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2021-03-06 09:47:16.768229: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2021-03-06 09:47:16.768775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14445 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:00:04.0, compute capability: 6.0)\r\n\r\n╒══════════╕\r\n│ TRAINING │\r\n╘══════════╛\r\n\r\n\r\nEpoch   1\r\nTraining:   0% 0/22 [00:00<?, ?it/s]\r\ny\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/ludwig\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/usr/local/lib/python3.7/dist-packages/ludwig/cli.py\", line 146, in main\r\n    CLI()\r\n  File \"/usr/local/lib/python3.7/dist-packages/ludwig/cli.py\", line 72, in __init__\r\n    getattr(self, args.command)()\r\n  File \"/usr/local/lib/python3.7/dist-packages/ludwig/cli.py\", line 92, in experiment\r\n    experiment.cli(sys.argv[2:])\r\n  File \"/usr/local/lib/python3.7/dist-packages/ludwig/experiment.py\", line 571, in cli\r\n    experiment_cli(**vars(args))\r\n  File \"/usr/local/lib/python3.7/dist-packages/ludwig/experiment.py\", line 239, in experiment_cli\r\n    debug=debug,\r\n  File \"/usr/local/lib/python3.7/dist-packages/ludwig/api.py\", line 1054, in experiment\r\n    debug=debug,\r\n  File \"/usr/local/lib/python3.7/dist-packages/ludwig/api.py\", line 487, in train\r\n    save_path=model_dir,\r\n  File \"/usr/local/lib/python3.7/dist-packages/ludwig/models/trainer.py\", line 550, in train\r\n    self.regularization_lambda\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py\", line 828, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py\", line 871, in _call\r\n    self._initialize(args, kwds, add_initializers_to=initializers)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py\", line 726, in _initialize\r\n    *args, **kwds))\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py\", line 2969, in _get_concrete_function_internal_garbage_collected\r\n    graph_function, _ = self._maybe_define_function(args, kwargs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py\", line 3361, in _maybe_define_function\r\n    graph_function = self._create_graph_function(args, kwargs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py\", line 3206, in _create_graph_function\r\n    capture_by_value=self._capture_by_value),\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py\", line 990, in func_graph_from_py_func\r\n    func_outputs = python_func(*func_args, **func_kwargs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py\", line 634, in wrapped_fn\r\n    out = weak_wrapped_fn().__wrapped__(*args, **kwds)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py\", line 3887, in bound_method_wrapper\r\n    return wrapped_fn(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py\", line 977, in wrapper\r\n    raise e.ag_error_metadata.to_exception(e)\r\nValueError: in user code:\r\n\r\n    /usr/local/lib/python3.7/dist-packages/ludwig/models/ecd.py:177 train_step  *\r\n        loss, all_losses = self.train_loss(\r\n    /usr/local/lib/python3.7/dist-packages/ludwig/models/ecd.py:201 train_loss  *\r\n        of_train_loss = of_obj.train_loss(targets[of_name],\r\n    /usr/local/lib/python3.7/dist-packages/ludwig/features/base_feature.py:214 train_loss  *\r\n        return self.train_loss_function(targets, predictions)\r\n    /usr/local/lib/python3.7/dist-packages/ludwig/modules/loss_modules.py:131 call  *\r\n        loss = sampled_softmax_cross_entropy(\r\n    /usr/local/lib/python3.7/dist-packages/ludwig/modules/loss_modules.py:274 sampled_softmax_cross_entropy  *\r\n        sampled_values = sample_values_from_classes(labels, sampler, num_classes,\r\n    /usr/local/lib/python3.7/dist-packages/ludwig/modules/loss_modules.py:427 sample_values_from_classes  *\r\n        sampled_values = tf.random.log_uniform_candidate_sampler(\r\n    /usr/local/lib/python3.7/dist-packages/tensorflow/python/util/dispatch.py:201 wrapper  **\r\n        return target(*args, **kwargs)\r\n    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/candidate_sampling_ops.py:154 log_uniform_candidate_sampler\r\n        seed2=seed2, name=name)\r\n    /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_candidate_sampling_ops.py:662 log_uniform_candidate_sampler\r\n        seed2=seed2, name=name)\r\n    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/op_def_library.py:750 _apply_op_helper\r\n        attrs=attr_protos, op_def=op_def)\r\n    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/func_graph.py:592 _create_op_internal\r\n        compute_device)\r\n    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py:3536 _create_op_internal\r\n        op_def=op_def)\r\n    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py:2016 __init__\r\n        control_input_ops, op_def)\r\n    /usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py:1856 _create_c_op\r\n        raise ValueError(str(e))\r\n\r\n    ValueError: Shape must be rank 2 but is rank 3 for '{{node train_loss/LogUniformCandidateSampler}} = LogUniformCandidateSampler[num_sampled=25, num_true=1, range_max=2904, seed=42, seed2=0, unique=false](train_loss/Cast)' with input shapes: [96,28,1].\r\n\r\nTraining:   0% 0/22 [00:08<?, ?it/s]`\r\n","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/791905954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"justinepdevasia","id":40311683,"node_id":"MDQ6VXNlcjQwMzExNjgz","avatar_url":"https://avatars.githubusercontent.com/u/40311683?v=4","gravatar_id":"","url":"https://api.github.com/users/justinepdevasia","html_url":"https://github.com/justinepdevasia","followers_url":"https://api.github.com/users/justinepdevasia/followers","following_url":"https://api.github.com/users/justinepdevasia/following{/other_user}","gists_url":"https://api.github.com/users/justinepdevasia/gists{/gist_id}","starred_url":"https://api.github.com/users/justinepdevasia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinepdevasia/subscriptions","organizations_url":"https://api.github.com/users/justinepdevasia/orgs","repos_url":"https://api.github.com/users/justinepdevasia/repos","events_url":"https://api.github.com/users/justinepdevasia/events{/privacy}","received_events_url":"https://api.github.com/users/justinepdevasia/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/792192617","html_url":"https://github.com/ludwig-ai/ludwig/issues/548#issuecomment-792192617","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/548","id":792192617,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MjE5MjYxNw==","user":{"login":"jimthompson5802","id":1425269,"node_id":"MDQ6VXNlcjE0MjUyNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1425269?v=4","gravatar_id":"","url":"https://api.github.com/users/jimthompson5802","html_url":"https://github.com/jimthompson5802","followers_url":"https://api.github.com/users/jimthompson5802/followers","following_url":"https://api.github.com/users/jimthompson5802/following{/other_user}","gists_url":"https://api.github.com/users/jimthompson5802/gists{/gist_id}","starred_url":"https://api.github.com/users/jimthompson5802/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimthompson5802/subscriptions","organizations_url":"https://api.github.com/users/jimthompson5802/orgs","repos_url":"https://api.github.com/users/jimthompson5802/repos","events_url":"https://api.github.com/users/jimthompson5802/events{/privacy}","received_events_url":"https://api.github.com/users/jimthompson5802/received_events","type":"User","site_admin":false},"created_at":"2021-03-07T03:40:24Z","updated_at":"2021-03-07T03:40:24Z","author_association":"COLLABORATOR","body":"@justinepdevasia  There is a known error we are working to address involving the `sampled_softmax_cross_entropy` loss function.  Please monitor this issue for status updates: https://github.com/ludwig-ai/ludwig/issues/1096","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/792192617/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jimthompson5802","id":1425269,"node_id":"MDQ6VXNlcjE0MjUyNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1425269?v=4","gravatar_id":"","url":"https://api.github.com/users/jimthompson5802","html_url":"https://github.com/jimthompson5802","followers_url":"https://api.github.com/users/jimthompson5802/followers","following_url":"https://api.github.com/users/jimthompson5802/following{/other_user}","gists_url":"https://api.github.com/users/jimthompson5802/gists{/gist_id}","starred_url":"https://api.github.com/users/jimthompson5802/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimthompson5802/subscriptions","organizations_url":"https://api.github.com/users/jimthompson5802/orgs","repos_url":"https://api.github.com/users/jimthompson5802/repos","events_url":"https://api.github.com/users/jimthompson5802/events{/privacy}","received_events_url":"https://api.github.com/users/jimthompson5802/received_events","type":"User","site_admin":false}},{"id":4417598663,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDQxNzU5ODY2Mw==","url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events/4417598663","actor":{"login":"justinepdevasia","id":40311683,"node_id":"MDQ6VXNlcjQwMzExNjgz","avatar_url":"https://avatars.githubusercontent.com/u/40311683?v=4","gravatar_id":"","url":"https://api.github.com/users/justinepdevasia","html_url":"https://github.com/justinepdevasia","followers_url":"https://api.github.com/users/justinepdevasia/followers","following_url":"https://api.github.com/users/justinepdevasia/following{/other_user}","gists_url":"https://api.github.com/users/justinepdevasia/gists{/gist_id}","starred_url":"https://api.github.com/users/justinepdevasia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinepdevasia/subscriptions","organizations_url":"https://api.github.com/users/justinepdevasia/orgs","repos_url":"https://api.github.com/users/justinepdevasia/repos","events_url":"https://api.github.com/users/justinepdevasia/events{/privacy}","received_events_url":"https://api.github.com/users/justinepdevasia/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-07T03:40:24Z","performed_via_github_app":null},{"id":4417598664,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ0MTc1OTg2NjQ=","url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events/4417598664","actor":{"login":"justinepdevasia","id":40311683,"node_id":"MDQ6VXNlcjQwMzExNjgz","avatar_url":"https://avatars.githubusercontent.com/u/40311683?v=4","gravatar_id":"","url":"https://api.github.com/users/justinepdevasia","html_url":"https://github.com/justinepdevasia","followers_url":"https://api.github.com/users/justinepdevasia/followers","following_url":"https://api.github.com/users/justinepdevasia/following{/other_user}","gists_url":"https://api.github.com/users/justinepdevasia/gists{/gist_id}","starred_url":"https://api.github.com/users/justinepdevasia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinepdevasia/subscriptions","organizations_url":"https://api.github.com/users/justinepdevasia/orgs","repos_url":"https://api.github.com/users/justinepdevasia/repos","events_url":"https://api.github.com/users/justinepdevasia/events{/privacy}","received_events_url":"https://api.github.com/users/justinepdevasia/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-07T03:40:25Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/853470092","html_url":"https://github.com/ludwig-ai/ludwig/issues/548#issuecomment-853470092","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/548","id":853470092,"node_id":"MDEyOklzc3VlQ29tbWVudDg1MzQ3MDA5Mg==","user":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"created_at":"2021-06-03T00:31:02Z","updated_at":"2021-06-03T00:31:02Z","author_association":"COLLABORATOR","body":"@justinepdevasia the issue was solved in https://github.com/ludwig-ai/ludwig/pull/1103 Let me know is you still encouter the issue","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/853470092/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false}},{"id":4834676935,"node_id":"MDExOkNsb3NlZEV2ZW50NDgzNDY3NjkzNQ==","url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events/4834676935","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-06-03T00:31:02Z","state_reason":null,"performed_via_github_app":null},{"id":4834676943,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDgzNDY3Njk0Mw==","url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events/4834676943","actor":{"login":"justinepdevasia","id":40311683,"node_id":"MDQ6VXNlcjQwMzExNjgz","avatar_url":"https://avatars.githubusercontent.com/u/40311683?v=4","gravatar_id":"","url":"https://api.github.com/users/justinepdevasia","html_url":"https://github.com/justinepdevasia","followers_url":"https://api.github.com/users/justinepdevasia/followers","following_url":"https://api.github.com/users/justinepdevasia/following{/other_user}","gists_url":"https://api.github.com/users/justinepdevasia/gists{/gist_id}","starred_url":"https://api.github.com/users/justinepdevasia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinepdevasia/subscriptions","organizations_url":"https://api.github.com/users/justinepdevasia/orgs","repos_url":"https://api.github.com/users/justinepdevasia/repos","events_url":"https://api.github.com/users/justinepdevasia/events{/privacy}","received_events_url":"https://api.github.com/users/justinepdevasia/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-06-03T00:31:02Z","performed_via_github_app":null},{"id":4834676946,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ4MzQ2NzY5NDY=","url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events/4834676946","actor":{"login":"justinepdevasia","id":40311683,"node_id":"MDQ6VXNlcjQwMzExNjgz","avatar_url":"https://avatars.githubusercontent.com/u/40311683?v=4","gravatar_id":"","url":"https://api.github.com/users/justinepdevasia","html_url":"https://github.com/justinepdevasia","followers_url":"https://api.github.com/users/justinepdevasia/followers","following_url":"https://api.github.com/users/justinepdevasia/following{/other_user}","gists_url":"https://api.github.com/users/justinepdevasia/gists{/gist_id}","starred_url":"https://api.github.com/users/justinepdevasia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinepdevasia/subscriptions","organizations_url":"https://api.github.com/users/justinepdevasia/orgs","repos_url":"https://api.github.com/users/justinepdevasia/repos","events_url":"https://api.github.com/users/justinepdevasia/events{/privacy}","received_events_url":"https://api.github.com/users/justinepdevasia/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-06-03T00:31:02Z","performed_via_github_app":null}]