[{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/541210601","html_url":"https://github.com/ludwig-ai/ludwig/issues/535#issuecomment-541210601","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/535","id":541210601,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTIxMDYwMQ==","user":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"created_at":"2019-10-11T20:21:27Z","updated_at":"2019-10-11T20:21:27Z","author_association":"COLLABORATOR","body":"When using attention, memory consumption increases quite a bit. Also, for generating text with a vocabulary of 50k, the last logit matrix would be batch_size x sequence_length x 50k, which is pretty huge.\r\nI would suggest to decrease the batch size to an amount that make it fit in memory. I don't know what GPU you are using and what amount of ram you have, but you can keep halving it until it works. Also I would suggest to reduce the 50k vocabulary to something smaller, like 10k, but it may impact performance. You should look at the frequency distribution of your vocabulary (it you look at the `training_set_metadata.json` you can find the `str2freq` dictionary that contains it) and decide where to cut depending on that, if you are roving only misspells and other noisy tokens for instance you performance can actually improve.","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/541210601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false}},{"id":2707327131,"node_id":"MDEyOkxhYmVsZWRFdmVudDI3MDczMjcxMzE=","url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events/2707327131","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-10-11T20:21:37Z","label":{"name":"waiting for answer","color":"d876e3"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/703177426","html_url":"https://github.com/ludwig-ai/ludwig/issues/535#issuecomment-703177426","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/535","id":703177426,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzE3NzQyNg==","user":{"login":"Vfitstory","id":41283686,"node_id":"MDQ6VXNlcjQxMjgzNjg2","avatar_url":"https://avatars.githubusercontent.com/u/41283686?v=4","gravatar_id":"","url":"https://api.github.com/users/Vfitstory","html_url":"https://github.com/Vfitstory","followers_url":"https://api.github.com/users/Vfitstory/followers","following_url":"https://api.github.com/users/Vfitstory/following{/other_user}","gists_url":"https://api.github.com/users/Vfitstory/gists{/gist_id}","starred_url":"https://api.github.com/users/Vfitstory/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Vfitstory/subscriptions","organizations_url":"https://api.github.com/users/Vfitstory/orgs","repos_url":"https://api.github.com/users/Vfitstory/repos","events_url":"https://api.github.com/users/Vfitstory/events{/privacy}","received_events_url":"https://api.github.com/users/Vfitstory/received_events","type":"User","site_admin":false},"created_at":"2020-10-03T23:34:56Z","updated_at":"2020-10-03T23:35:49Z","author_association":"NONE","body":"woah, came here looking for a answer but if a Nvidia V100 is having a issue with this then i guess i shouldn't complain that my rtx2080 is having this issue, either how, any updates on this?","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/703177426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Vfitstory","id":41283686,"node_id":"MDQ6VXNlcjQxMjgzNjg2","avatar_url":"https://avatars.githubusercontent.com/u/41283686?v=4","gravatar_id":"","url":"https://api.github.com/users/Vfitstory","html_url":"https://github.com/Vfitstory","followers_url":"https://api.github.com/users/Vfitstory/followers","following_url":"https://api.github.com/users/Vfitstory/following{/other_user}","gists_url":"https://api.github.com/users/Vfitstory/gists{/gist_id}","starred_url":"https://api.github.com/users/Vfitstory/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Vfitstory/subscriptions","organizations_url":"https://api.github.com/users/Vfitstory/orgs","repos_url":"https://api.github.com/users/Vfitstory/repos","events_url":"https://api.github.com/users/Vfitstory/events{/privacy}","received_events_url":"https://api.github.com/users/Vfitstory/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/703178234","html_url":"https://github.com/ludwig-ai/ludwig/issues/535#issuecomment-703178234","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/535","id":703178234,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzE3ODIzNA==","user":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"created_at":"2020-10-03T23:47:36Z","updated_at":"2020-10-03T23:47:36Z","author_association":"COLLABORATOR","body":"There is no update, you get cuda out of memory when the combination of model weights and actications is too big to fit in memory. There are only two options: decrease the size of your model so that you have either less weights in memory or and the size of the activations are smaller, and/or decrease the batch size. I'm actually closing this for staleness and because there are no other solutions to the problem, it's not really a Ludwig bug.","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/703178234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false}},{"id":3837059937,"node_id":"MDExOkNsb3NlZEV2ZW50MzgzNzA1OTkzNw==","url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/events/3837059937","actor":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-10-03T23:47:40Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/704158624","html_url":"https://github.com/ludwig-ai/ludwig/issues/535#issuecomment-704158624","issue_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/535","id":704158624,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDE1ODYyNA==","user":{"login":"mikechen66","id":14157310,"node_id":"MDQ6VXNlcjE0MTU3MzEw","avatar_url":"https://avatars.githubusercontent.com/u/14157310?v=4","gravatar_id":"","url":"https://api.github.com/users/mikechen66","html_url":"https://github.com/mikechen66","followers_url":"https://api.github.com/users/mikechen66/followers","following_url":"https://api.github.com/users/mikechen66/following{/other_user}","gists_url":"https://api.github.com/users/mikechen66/gists{/gist_id}","starred_url":"https://api.github.com/users/mikechen66/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikechen66/subscriptions","organizations_url":"https://api.github.com/users/mikechen66/orgs","repos_url":"https://api.github.com/users/mikechen66/repos","events_url":"https://api.github.com/users/mikechen66/events{/privacy}","received_events_url":"https://api.github.com/users/mikechen66/received_events","type":"User","site_admin":false},"created_at":"2020-10-06T09:49:03Z","updated_at":"2020-10-06T09:49:03Z","author_association":"NONE","body":"I have used the following section of code to solve the the issue.\r\n\r\n```\r\ngpus = tf.config.experimental.list_physical_devices('GPU')\r\nif gpus:\r\n  # Restrict TensorFlow to only allocate 4GB of memory on the first GPU\r\n  try:\r\n    tf.config.experimental.set_virtual_device_configuration(\r\n        gpus[0],\r\n        [tf.config.experimental.VirtualDeviceConfiguration(memory_limit=4096)])\r\n    logical_gpus = tf.config.experimental.list_logical_devices('GPU')\r\n    print(len(gpus), \"Physical GPUs,\", len(logical_gpus), \"Logical GPUs\")\r\n  except RuntimeError as e:\r\n    # Virtual devices must be set before GPUs have been initialized\r\n    print(e)\r\n```\r\n\r\nCheers! ","reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/comments/704158624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mikechen66","id":14157310,"node_id":"MDQ6VXNlcjE0MTU3MzEw","avatar_url":"https://avatars.githubusercontent.com/u/14157310?v=4","gravatar_id":"","url":"https://api.github.com/users/mikechen66","html_url":"https://github.com/mikechen66","followers_url":"https://api.github.com/users/mikechen66/followers","following_url":"https://api.github.com/users/mikechen66/following{/other_user}","gists_url":"https://api.github.com/users/mikechen66/gists{/gist_id}","starred_url":"https://api.github.com/users/mikechen66/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikechen66/subscriptions","organizations_url":"https://api.github.com/users/mikechen66/orgs","repos_url":"https://api.github.com/users/mikechen66/repos","events_url":"https://api.github.com/users/mikechen66/events{/privacy}","received_events_url":"https://api.github.com/users/mikechen66/received_events","type":"User","site_admin":false}}]