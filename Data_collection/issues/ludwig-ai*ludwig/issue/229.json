{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/229","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/229/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/229/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/229/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/229","id":422456279,"node_id":"MDU6SXNzdWU0MjI0NTYyNzk=","number":229,"title":"Can't predict images from a CSV file on Kaggle","user":{"login":"EdVieira","id":22324316,"node_id":"MDQ6VXNlcjIyMzI0MzE2","avatar_url":"https://avatars.githubusercontent.com/u/22324316?v=4","gravatar_id":"","url":"https://api.github.com/users/EdVieira","html_url":"https://github.com/EdVieira","followers_url":"https://api.github.com/users/EdVieira/followers","following_url":"https://api.github.com/users/EdVieira/following{/other_user}","gists_url":"https://api.github.com/users/EdVieira/gists{/gist_id}","starred_url":"https://api.github.com/users/EdVieira/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdVieira/subscriptions","organizations_url":"https://api.github.com/users/EdVieira/orgs","repos_url":"https://api.github.com/users/EdVieira/repos","events_url":"https://api.github.com/users/EdVieira/events{/privacy}","received_events_url":"https://api.github.com/users/EdVieira/received_events","type":"User","site_admin":false},"labels":[{"id":1174068770,"node_id":"MDU6TGFiZWwxMTc0MDY4Nzcw","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/duplicate","name":"duplicate","color":"cfd3d7","default":true,"description":"This issue or pull request already exists"},{"id":1174068775,"node_id":"MDU6TGFiZWwxMTc0MDY4Nzc1","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/waiting%20for%20answer","name":"waiting for answer","color":"fff36b","default":false,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2019-03-18T22:06:06Z","updated_at":"2019-07-23T04:43:58Z","closed_at":"2019-07-23T04:43:58Z","author_association":"NONE","active_lock_reason":null,"body":"I'm tring to train a model and predict some data for an image classification problem on Kaggle, although I have read-only access I used those 'skip_save' parameters to disable file creation:\r\n\r\nobs: train_file is a string\r\n```\r\ntrain_stats = ludwig_model.train(data_csv=train_file,\r\n                                skip_save_model=True,\r\n                                skip_save_progress=True,\r\n                                skip_save_log=True,\r\n                                skip_save_processed_input=True,\r\n                                logging_level=0)\r\n```\r\n\r\nI've tried using pandas DataFrame for training and predicting using the data_df instead of data_csv as parameter, but it raised a similar error, until I prepare a custom dataset for properly refer to the image file path on the CSV column (still not working the df option), then it was able to be trained, but... Now it can't predict from the submission file, because \"'DataFrame' object has no attribute 'csv'\" that is caused when running the line:\r\n\r\nobs: test_file is a string\r\n```\r\npredictions = ludwig_model.test(data_csv=test_file,\r\n                                   #data_df=test_df,\r\n                                   return_type='dict',\r\n                                  logging_level=0)\r\n```\r\n\r\nIt raised:\r\n\r\n```\r\nDEBUG:root:Preprocessing 57458 datapoints\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-13-5893f61b9736> in <module>()\r\n      2                                    #data_df=test_df,\r\n      3                                    return_type='dict',\r\n----> 4                                   logging_level=0)\r\n\r\n/opt/conda/lib/python3.6/site-packages/ludwig/api.py in test(self, data_df, data_csv, data_dict, return_type, batch_size, gpus, gpu_fraction, logging_level)\r\n    989             gpu_fraction=gpu_fraction,\r\n    990             only_predictions=False,\r\n--> 991             logging_level=logging_level,\r\n    992         )\r\n    993 \r\n\r\n/opt/conda/lib/python3.6/site-packages/ludwig/api.py in _predict(self, data_df, data_csv, data_dict, return_type, batch_size, gpus, gpu_fraction, only_predictions, logging_level)\r\n    772             features_to_load,\r\n    773             self.train_set_metadata,\r\n--> 774             self.model_definition['preprocessing']\r\n    775         )\r\n    776         replace_text_feature_level(self.model_definition, [preprocessed_data])\r\n\r\n/opt/conda/lib/python3.6/site-packages/ludwig/data/preprocessing.py in build_data(dataset_df, features, train_set_metadata, global_preprocessing_parameters)\r\n    163             data,\r\n    164             train_set_metadata,\r\n--> 165             preprocessing_parameters\r\n    166         )\r\n    167     return data\r\n\r\n/opt/conda/lib/python3.6/site-packages/ludwig/features/image_feature.py in add_feature_data(feature, dataset_df, data, metadata, preprocessing_parameters)\r\n     55             preprocessing_parameters\r\n     56     ):\r\n---> 57         csv_path = os.path.dirname(os.path.abspath(dataset_df.csv))\r\n     58         an_image = imread(\r\n     59             os.path.join(csv_path, dataset_df[feature['name']][0])\r\n\r\n/opt/conda/lib/python3.6/site-packages/pandas/core/generic.py in __getattr__(self, name)\r\n   4374             if self._info_axis._can_hold_identifiers_and_holds_name(name):\r\n   4375                 return self[name]\r\n-> 4376             return object.__getattribute__(self, name)\r\n   4377 \r\n   4378     def __setattr__(self, name, value):\r\n\r\nAttributeError: 'DataFrame' object has no attribute 'csv'\r\n```\r\n\r\n\r\nHere is the link to the kernel:\r\nhttps://www.kaggle.com/edhenrivi/testing-for-image-classification\r\n","closed_by":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/229/timeline","performed_via_github_app":null,"state_reason":"completed"}