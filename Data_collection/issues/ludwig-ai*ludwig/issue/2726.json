{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2726","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2726/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2726/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2726/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/2726","id":1437492616,"node_id":"I_kwDOCbx2hs5VrmWI","number":2726,"title":"ValueError: invalid literal for int() with base 16 during data processing using minio","user":{"login":"Jeffwan","id":4739316,"node_id":"MDQ6VXNlcjQ3MzkzMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4739316?v=4","gravatar_id":"","url":"https://api.github.com/users/Jeffwan","html_url":"https://github.com/Jeffwan","followers_url":"https://api.github.com/users/Jeffwan/followers","following_url":"https://api.github.com/users/Jeffwan/following{/other_user}","gists_url":"https://api.github.com/users/Jeffwan/gists{/gist_id}","starred_url":"https://api.github.com/users/Jeffwan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jeffwan/subscriptions","organizations_url":"https://api.github.com/users/Jeffwan/orgs","repos_url":"https://api.github.com/users/Jeffwan/repos","events_url":"https://api.github.com/users/Jeffwan/events{/privacy}","received_events_url":"https://api.github.com/users/Jeffwan/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2022-11-06T18:14:42Z","updated_at":"2022-11-07T19:55:37Z","closed_at":"2022-11-07T18:49:45Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\n\r\nSeem there's an error thrown during cache checksum calculation. Seems it calculate the eTag of dataset and try to get original Hex representation.  Looks like hyphen ` 'b6e64f35b2cb730d93770942a59b2efa-2' ` is the problem but hyphen itself in ETag is correct which indicates multi parts. \r\nhttps://teppen.io/2018/06/23/aws_s3_etags/#what-is-an-s3-etag\r\n\r\n\r\n~~I didn't see this problem in the past using minio~~(update: I uploaded files from browser in the past, which means multi-part uploading was not used). I recently come back to the project and notice it's not working suddenly.. Not sure if community has seen similar issues\r\n\r\n**To Reproduce**\r\n\r\nrecently I create a new store for minio and notice it can not read and process minio files correctly. \r\n\r\n```\r\n╒═══════════════╕\r\n│ PREPROCESSING │\r\n╘═══════════════╛\r\n\r\nBackend config has num_cpu not set. provision_preprocessing_workers() is a no-op in this case.\r\nTraceback (most recent call last):\r\n  File \"auto_train.py\", line 384, in <module>\r\n    run_automl_job(args.job_id, args.type, args.dataset, args.target, args.time_limit_s, args.tune_for_memory, args.artifact_storage_backend, args.object_storage_path, args.output_directory, args.object_storage_endpoint)\r\n  File \"auto_train.py\", line 98, in run_automl_job\r\n    train_cli(automl_config, dataset_df, output_directory=output_dir, random_seed=default_random_seed, callbacks=[EarlyStopCallback()])\r\n  File \"/usr/local/lib/python3.8/site-packages/ludwig/train.py\", line 181, in train_cli\r\n    model.train(\r\n  File \"/usr/local/lib/python3.8/site-packages/ludwig/api.py\", line 449, in train\r\n    preprocessed_data = self.preprocess(\r\n  File \"/usr/local/lib/python3.8/site-packages/ludwig/api.py\", line 1294, in preprocess\r\n    preprocessed_data = preprocess_for_training(\r\n  File \"/usr/local/lib/python3.8/site-packages/ludwig/data/preprocessing.py\", line 1569, in preprocess_for_training\r\n    cache = backend.cache.get_dataset_cache(config, dataset, training_set, test_set, validation_set)\r\n  File \"/usr/local/lib/python3.8/site-packages/ludwig/data/cache/manager.py\", line 107, in get_dataset_cache\r\n    key = self.get_cache_key(dataset, config)\r\n  File \"/usr/local/lib/python3.8/site-packages/ludwig/data/cache/manager.py\", line 126, in get_cache_key\r\n    return calculate_checksum(dataset, config)\r\n  File \"/usr/local/lib/python3.8/site-packages/ludwig/data/cache/util.py\", line 11, in calculate_checksum\r\n    \"dataset_checksum\": original_dataset.checksum,\r\n  File \"/usr/local/lib/python3.8/site-packages/ludwig/data/cache/types.py\", line 77, in checksum\r\n    return checksum(self.path)\r\n  File \"/usr/local/lib/python3.8/site-packages/ludwig/utils/fs_utils.py\", line 181, in checksum\r\n    return fs.checksum(path)\r\n  File \"/usr/local/lib/python3.8/site-packages/s3fs/core.py\", line 573, in checksum\r\n    return int(info[\"ETag\"].strip('\"'), 16)\r\nValueError: invalid literal for int() with base 16: 'b6e64f35b2cb730d93770942a59b2efa-2'\r\n```\r\n\r\n\r\n**Expected behavior**\r\n\r\ndata processing should not return error.\r\n\r\n`python auto_train.py --target=recommended --time_limit_s=180 --type single_class --dataset=s3://openstudio-automl/dataset/rotten_tomatoes.csv`\r\n\r\npreprocessing config\r\n\r\n```\r\n    'preprocessing': {   'oversample_minority': None,\r\n                         'sample_ratio': 1.0,\r\n                         'split': {   'probabilities': [0.7, 0.1, 0.2],\r\n                                      'type': 'random'},\r\n```\r\n\r\n\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n- OS: \\[e.g. iOS\\]\r\n- Version \\[e.g. 22\\]\r\n- Python version 3.8.13\r\n- Ludwig version 0.6\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n","closed_by":{"login":"Jeffwan","id":4739316,"node_id":"MDQ6VXNlcjQ3MzkzMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4739316?v=4","gravatar_id":"","url":"https://api.github.com/users/Jeffwan","html_url":"https://github.com/Jeffwan","followers_url":"https://api.github.com/users/Jeffwan/followers","following_url":"https://api.github.com/users/Jeffwan/following{/other_user}","gists_url":"https://api.github.com/users/Jeffwan/gists{/gist_id}","starred_url":"https://api.github.com/users/Jeffwan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jeffwan/subscriptions","organizations_url":"https://api.github.com/users/Jeffwan/orgs","repos_url":"https://api.github.com/users/Jeffwan/repos","events_url":"https://api.github.com/users/Jeffwan/events{/privacy}","received_events_url":"https://api.github.com/users/Jeffwan/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2726/timeline","performed_via_github_app":null,"state_reason":"completed"}