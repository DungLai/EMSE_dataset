{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1036","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1036/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1036/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1036/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/1036","id":753453389,"node_id":"MDU6SXNzdWU3NTM0NTMzODk=","number":1036,"title":"training a simple chatbot model","user":{"login":"grigo210","id":59127137,"node_id":"MDQ6VXNlcjU5MTI3MTM3","avatar_url":"https://avatars.githubusercontent.com/u/59127137?v=4","gravatar_id":"","url":"https://api.github.com/users/grigo210","html_url":"https://github.com/grigo210","followers_url":"https://api.github.com/users/grigo210/followers","following_url":"https://api.github.com/users/grigo210/following{/other_user}","gists_url":"https://api.github.com/users/grigo210/gists{/gist_id}","starred_url":"https://api.github.com/users/grigo210/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/grigo210/subscriptions","organizations_url":"https://api.github.com/users/grigo210/orgs","repos_url":"https://api.github.com/users/grigo210/repos","events_url":"https://api.github.com/users/grigo210/events{/privacy}","received_events_url":"https://api.github.com/users/grigo210/received_events","type":"User","site_admin":false},"labels":[{"id":1174068769,"node_id":"MDU6TGFiZWwxMTc0MDY4NzY5","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1434966350,"node_id":"MDU6TGFiZWwxNDM0OTY2MzUw","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/looking%20into%20it","name":"looking into it","color":"ffa54f","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-11-30T12:52:11Z","updated_at":"2021-03-26T12:34:07Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi!\r\nI tried to create a model for a chatbot based on a data set created by me and I got an error:\r\n\r\n- csv file:\r\n\r\nEu,Chatbot\r\nsalut,salut\r\nce faci?,bine\r\n\r\n- config.yaml:\r\n\r\ninput_features:\r\n    -\r\n        name: Eu\r\n        type: text\r\n        level: word\r\n        encoder: rnn\r\n        cell_type: lstm\r\n        reduce_output: null\r\n\r\noutput_features:\r\n    -\r\n        name: Chatbot\r\n        type: text\r\n        level: word\r\n        decoder: generator\r\n        cell_type: lstm\r\n        attention: bahdanau\r\n        loss:\r\n            type: sampled_softmax_cross_entropy\r\n\r\ntraining:\r\n    batch_size: 96\r\n\r\n- terminal code:\r\nludwig experiment --dataset salut.csv --config_file config.yaml\r\n\r\nError:\r\nraceback (most recent call last):\r\n  File \"D:\\Ludwig\\venv\\Scripts\\ludwig-script.py\", line 33, in <module>\r\n    sys.exit(load_entry_point('ludwig==0.3.1', 'console_scripts', 'ludwig')())\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\cli.py\", line 146, in main\r\n    CLI()\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\cli.py\", line 72, in __init__\r\n    getattr(self, args.command)()\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\cli.py\", line 92, in experiment\r\n    experiment.cli(sys.argv[2:])\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\experiment.py\", line 571, in cli\r\n    experiment_cli(**vars(args))\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\experiment.py\", line 239, in experiment_cli\r\n    debug=debug,\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\api.py\", line 1036, in experiment\r\n    debug=debug,\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\api.py\", line 469, in train\r\n    save_path=model_dir,\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\models\\trainer.py\", line 552, in train\r\n    self.regularization_lambda\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\eager\\def_function.py\", line 780, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\eager\\def_function.py\", line 823, in _call\r\n    self._initialize(args, kwds, add_initializers_to=initializers)\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\eager\\def_function.py\", line 697, in _initialize\r\n    *args, **kwds))\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\eager\\function.py\", line 2855, in _get_concrete_function_internal_garbage_collected\r\n    graph_function, _, _ = self._maybe_define_function(args, kwargs)\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\eager\\function.py\", line 3213, in _maybe_define_function\r\n    graph_function = self._create_graph_function(args, kwargs)\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\eager\\function.py\", line 3075, in _create_graph_function\r\n    capture_by_value=self._capture_by_value),\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\framework\\func_graph.py\", line 986, in func_graph_from_py_func\r\n    func_outputs = python_func(*func_args, **func_kwargs)\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\eager\\def_function.py\", line 600, in wrapped_fn\r\n    return weak_wrapped_fn().__wrapped__(*args, **kwds)\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\eager\\function.py\", line 3735, in bound_method_wrapper\r\n    return wrapped_fn(*args, **kwargs)\r\n  File \"d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\framework\\func_graph.py\", line 973, in wrapper\r\n    raise e.ag_error_metadata.to_exception(e)\r\nValueError: in user code:\r\n\r\n    d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\models\\ecd.py:176 train_step  *\r\n        model_outputs = self((inputs, targets), training=True)\r\n    d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\models\\ecd.py:118 call  *\r\n        decoder_outputs = decoder(\r\n    d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\features\\base_feature.py:260 call  *\r\n        logits = self.logits(logits_input, target=target, training=training)\r\n    d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\features\\sequence_feature.py:252 logits  *\r\n        inputs,\r\n    d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\decoders\\sequence_decoders.py:150 _logits_training  *\r\n        logits = self.decoder_teacher_forcing(\r\n    d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\decoders\\sequence_decoders.py:310 decoder_teacher_forcing  *\r\n        encoder_sequence_length = sequence_length_3D(encoder_output)\r\n    d:\\ludwig\\venv\\lib\\site-packages\\ludwig\\utils\\tf_utils.py:26 sequence_length_3D  *\r\n        used = tf.sign(tf.reduce_max(tf.abs(sequence), 2))\r\n    d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\util\\dispatch.py:201 wrapper  **\r\n        return target(*args, **kwargs)\r\n    d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py:2685 reduce_max\r\n        _ReductionDims(input_tensor, axis))\r\n    d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\ops\\math_ops.py:2696 reduce_max_with_dims\r\n        gen_math_ops._max(input_tensor, dims, keepdims, name=name))\r\n    d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\ops\\gen_math_ops.py:5721 _max\r\n        name=name)\r\n    d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py:744 _apply_op_helper\r\n        attrs=attr_protos, op_def=op_def)\r\n    d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\framework\\func_graph.py:593 _create_op_internal\r\n        compute_device)\r\n    d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py:3485 _create_op_internal\r\n        op_def=op_def)\r\n    d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py:1975 __init__\r\n        control_input_ops, op_def)\r\n    d:\\ludwig\\venv\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py:1815 _create_c_op\r\n        raise ValueError(str(e))\r\n\r\n    ValueError: Invalid reduction dimension 2 for input with 2 dimensions. for '{{node ecd/text_output_feature/Max}} = Max[T=DT_FLOAT, Tidx=DT_INT32, keep_dims=false](ecd/text_output_feature/Abs_1, ecd/text_output_feature/Max/reduction\r\n_indices)' with input shapes: [1,256], [] and with computed input tensors: input[1] = <2>.\r\n\r\n\r\n\r\n\r\n - OS: [Windows]\r\n - Version [10]\r\n- Python version [3.7.9]\r\n- Ludwig version [ 0.3.1]\r\n\r\n''' How can I solve this problem?\r\n\r\nThank you!\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1036/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1036/timeline","performed_via_github_app":null,"state_reason":null}