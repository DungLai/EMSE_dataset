{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/286","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/286/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/286/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/286/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/286","id":432953313,"node_id":"MDU6SXNzdWU0MzI5NTMzMTM=","number":286,"title":"Web service wrapper around ludwig","user":{"login":"bertyhell","id":1710840,"node_id":"MDQ6VXNlcjE3MTA4NDA=","avatar_url":"https://avatars.githubusercontent.com/u/1710840?v=4","gravatar_id":"","url":"https://api.github.com/users/bertyhell","html_url":"https://github.com/bertyhell","followers_url":"https://api.github.com/users/bertyhell/followers","following_url":"https://api.github.com/users/bertyhell/following{/other_user}","gists_url":"https://api.github.com/users/bertyhell/gists{/gist_id}","starred_url":"https://api.github.com/users/bertyhell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bertyhell/subscriptions","organizations_url":"https://api.github.com/users/bertyhell/orgs","repos_url":"https://api.github.com/users/bertyhell/repos","events_url":"https://api.github.com/users/bertyhell/events{/privacy}","received_events_url":"https://api.github.com/users/bertyhell/received_events","type":"User","site_admin":false},"labels":[{"id":1174068771,"node_id":"MDU6TGFiZWwxMTc0MDY4Nzcx","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/feature","name":"feature","color":"0377d6","default":false,"description":"New feature or request"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-04-14T09:51:07Z","updated_at":"2019-04-15T20:49:43Z","closed_at":"2019-04-15T20:49:43Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I'm trying to make ludwig more accessable from other languages by wrapping it in a webservice (cherrypy)\r\n\r\nWhen i try to make a call to the webservice to train a model i get the error:\r\n```\r\n signal only works in main thread\r\n```\r\n\r\nI'm looking for some context around how these signals are used inside ludwig. I assume this could be resolved by starting ludwig in a separate process and then setup a socket connection between the ludwig process and the cherrypy web service.\r\n\r\nThis is the relevant code i have so far:\r\n\r\n\r\n**service in cherrypy:**\r\n```python\r\nclass AiWebService(object):\r\n\r\n    @cherrypy.expose\r\n    @cherrypy.tools.json_in()\r\n    @cherrypy.tools.json_out()\r\n    def train(self):\r\n        data = cherrypy.request.json\r\n        if 'training_samples' not in data:\r\n            return RecursiveError('\"training_samples\" property is required on body to begin training').to_json()\r\n        if 'definitions' not in data:\r\n            return RecursiveError('\"definitions\" property is required on body to begin training').to_json()\r\n\r\n        training_samples = pd.DataFrame(data.get('training_samples'))\r\n        definitions = data.get('definitions')\r\n        output = p.train(training_samples, definitions)\r\n        return output\r\n\r\nif __name__ == '__main__':\r\n    cherrypy.config.update({'server.socket_host': '0.0.0.0'})\r\n    cherrypy.quickstart(AiWebService())\r\n```\r\nhttps://gitlab.com/bertyhell/woody-puzzle-solver/blob/master/src/server/ludwigproxy.py\r\n\r\n\r\n**wrapper around the ludwig api:**\r\n```python\r\n    def train(self, training_samples, model_definitions):\r\n        model = LudwigModel(model_definitions)\r\n        train_stats = model.train(training_samples)\r\n        return {'message': 'ok'}\r\n```\r\nhttps://gitlab.com/bertyhell/woody-puzzle-solver/blob/master/src/server/service.py\r\n\r\n\r\n**full error:**\r\n```\r\nERROR:cherrypy.error.2203522445776:[14/Apr/2019:11:34:47] HTTP \r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\verhe\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\cherrypy\\_cprequest.py\", line 628, in respond\r\n    self._do_respond(path_info)\r\n  File \"C:\\Users\\verhe\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\cherrypy\\_cprequest.py\", line 687, in _do_respond\r\n    response.body = self.handler()\r\n  File \"C:\\Users\\verhe\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\cherrypy\\lib\\encoding.py\", line 219, in __call__\r\n    self.body = self.oldhandler(*args, **kwargs)\r\n  File \"C:\\Users\\verhe\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\cherrypy\\lib\\jsontools.py\", line 59, in json_handler\r\n    value = cherrypy.serving.request._json_inner_handler(*args, **kwargs)\r\n  File \"C:\\Users\\verhe\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\cherrypy\\_cpdispatch.py\", line 54, in __call__\r\n    return self.callable(*self.args, **self.kwargs)\r\n  File \"C:/Users/verhe/Documents/storied/repos/woody-puzzle-solver/src/server/service.py\", line 26, in train\r\n    output = p.train(training_samples, definitions)\r\n  File \"C:\\Users\\verhe\\Documents\\storied\\repos\\woody-puzzle-solver\\src\\server\\ludwigproxy.py\", line 7, in train\r\n    train_stats = model.train(training_samples)\r\n  File \"C:\\Users\\verhe\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\ludwig\\api.py\", line 494, in train\r\n    debug=debug\r\n  File \"C:\\Users\\verhe\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\ludwig\\train.py\", line 383, in train\r\n    **model_definition['training']\r\n  File \"C:\\Users\\verhe\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\ludwig\\models\\model.py\", line 363, in train\r\n    signal.signal(signal.SIGINT, self.set_epochs_to_1_or_quit)\r\n  File \"C:\\Users\\verhe\\AppData\\Local\\Programs\\Python\\Python36\\lib\\signal.py\", line 47, in signal\r\n    handler = _signal.signal(_enum_to_int(signalnum), _enum_to_int(handler))\r\nValueError: signal only works in main thread\r\n```","closed_by":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/286/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/286/timeline","performed_via_github_app":null,"state_reason":"completed"}