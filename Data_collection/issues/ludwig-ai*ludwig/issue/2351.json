{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2351","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2351/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2351/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2351/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/2351","id":1329493741,"node_id":"I_kwDOCbx2hs5PPnbt","number":2351,"title":"Hyperopt Bug: Ray Actors die sometimes once `time_budget_s` is reached during hyperopt with AsyncHyperband","user":{"login":"arnavgarg1","id":106701836,"node_id":"U_kgDOBlwkDA","avatar_url":"https://avatars.githubusercontent.com/u/106701836?v=4","gravatar_id":"","url":"https://api.github.com/users/arnavgarg1","html_url":"https://github.com/arnavgarg1","followers_url":"https://api.github.com/users/arnavgarg1/followers","following_url":"https://api.github.com/users/arnavgarg1/following{/other_user}","gists_url":"https://api.github.com/users/arnavgarg1/gists{/gist_id}","starred_url":"https://api.github.com/users/arnavgarg1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arnavgarg1/subscriptions","organizations_url":"https://api.github.com/users/arnavgarg1/orgs","repos_url":"https://api.github.com/users/arnavgarg1/repos","events_url":"https://api.github.com/users/arnavgarg1/events{/privacy}","received_events_url":"https://api.github.com/users/arnavgarg1/received_events","type":"User","site_admin":false},"labels":[{"id":1174068769,"node_id":"MDU6TGFiZWwxMTc0MDY4NzY5","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-08-05T06:10:25Z","updated_at":"2022-09-29T21:02:03Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Once `time_budget_s` is reached during hyperopt, all the Ray Actors incrementally die.\r\n\r\n```\r\n2022-08-04 17:47:10,441\tINFO stopper.py:350 -- Reached timeout of 180 seconds. Stopping all trials.\r\n== Status ==\r\nCurrent time: 2022-08-04 17:47:10 (running for 00:03:01.46)\r\nMemory usage on this node: 20.1/246.4 GiB\r\nUsing FIFO scheduling algorithm.\r\nResources requested: 0/150 CPUs, 0/12 GPUs, 0.0/500.0 GiB heap, 0.0/500.0 GiB objects (0.0/3.0 accelerator_type:T4)\r\nCurrent best trial: b74f3_00002 with metric_score=0.130369803722715 and parameters={'trainer.learning_rate': 0.005, 'trainer.decay_steps': 10000}\r\nResult logdir: /home/ray/src/hyperopt\r\nNumber of trials: 4/4 (4 TERMINATED)\r\n+-------------------+------------+----------------------+-----------------------+-------------------------+--------+------------------+----------------+\r\n| Trial name        | status     | loc                  |   trainer.decay_steps |   trainer.learning_rate |   iter |   total time (s) |   metric_score |\r\n|-------------------+------------+----------------------+-----------------------+-------------------------+--------+------------------+----------------|\r\n| trial_b74f3_00000 | TERMINATED | 192.168.44.226:44064 |                 10000 |                   0.001 |     10 |          165.849 |       0.132162 |\r\n| trial_b74f3_00001 | TERMINATED | 192.168.74.69:5093   |                  2000 |                   0.005 |     11 |          172.588 |       0.131108 |\r\n| trial_b74f3_00002 | TERMINATED | 192.168.72.27:6452   |                 10000 |                   0.005 |     10 |          166.155 |       0.13037  |\r\n| trial_b74f3_00003 | TERMINATED | 192.168.45.45:55382  |                  8000 |                   0.001 |     10 |          162.189 |       0.132678 |\r\n+-------------------+------------+----------------------+-----------------------+-------------------------+--------+------------------+----------------+\r\n\r\n\r\nTraining:  11%|â–ˆ         | 120/1100 [02:29<10:47,  1.51it/s]\r\n2022-08-04 17:47:10,603\tWARNING worker.py:1382 -- A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: 77003339209b3e674c1826ef52407c82b1d419681c000000 Worker ID: fd87e59263039f1b712913a4de1750c0f527bae210284a5c54307c2b Node ID: 0b05b201854acb7ec8473e64f8b224140dc47236ddc8ecfb9903c3fe Worker IP address: 192.168.45.45 Worker port: 10201 Worker PID: 56401\r\n```\r\n\r\n```\r\n(BaseWorkerMixin pid=5516, ip=192.168.35.224) The actor is dead because its owner has died. Owner Id: 7304cad6ec56a8c825c4de04dcb3f0106c885bc42b6ab195439eefe6 Owner Ip address: 192.168.45.45 Owner worker exit type: INTENDED_EXIT\r\n2022-08-04 17:47:13,554\tWARNING worker.py:1382 -- A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: 2fad8fa976dfdce26f68298242b39ff6194200d51c000000 Worker ID: a0a4f773d2064aa4385a9d7bf97b055a254d7e86b10b8ef35ffb6e91 Node ID: 0017c30b633d4339dba7461ec73a43b1f6e65ae839edf4bae757dcc9 Worker IP address: 192.168.86.8 Worker port: 10193 Worker PID: 957\r\n```\r\n\r\nThings then seem to hang momentarily (say ~30 second to 1 minute) before Ray Tune returns trial results. \r\n\r\nIdeally, no ray workers / actors should die. ","closed_by":null,"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2351/timeline","performed_via_github_app":null,"state_reason":null}