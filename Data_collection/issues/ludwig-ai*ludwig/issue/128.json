{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/128","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/128/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/128/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/128/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/128","id":412863751,"node_id":"MDU6SXNzdWU0MTI4NjM3NTE=","number":128,"title":"Image classification: ValueError: could not broadcast input array from shape (227,300,3) into shape (750,1000,3)","user":{"login":"meinnamehier","id":17614384,"node_id":"MDQ6VXNlcjE3NjE0Mzg0","avatar_url":"https://avatars.githubusercontent.com/u/17614384?v=4","gravatar_id":"","url":"https://api.github.com/users/meinnamehier","html_url":"https://github.com/meinnamehier","followers_url":"https://api.github.com/users/meinnamehier/followers","following_url":"https://api.github.com/users/meinnamehier/following{/other_user}","gists_url":"https://api.github.com/users/meinnamehier/gists{/gist_id}","starred_url":"https://api.github.com/users/meinnamehier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/meinnamehier/subscriptions","organizations_url":"https://api.github.com/users/meinnamehier/orgs","repos_url":"https://api.github.com/users/meinnamehier/repos","events_url":"https://api.github.com/users/meinnamehier/events{/privacy}","received_events_url":"https://api.github.com/users/meinnamehier/received_events","type":"User","site_admin":false},"labels":[{"id":1174068769,"node_id":"MDU6TGFiZWwxMTc0MDY4NzY5","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1174068770,"node_id":"MDU6TGFiZWwxMTc0MDY4Nzcw","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/duplicate","name":"duplicate","color":"cfd3d7","default":true,"description":"This issue or pull request already exists"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-02-21T10:54:00Z","updated_at":"2019-02-23T01:13:08Z","closed_at":"2019-02-22T07:49:34Z","author_association":"NONE","active_lock_reason":null,"body":"Hi, \r\nthis is my model definition:\r\n```yaml\r\ninput_features:\r\n    -\r\n        name: image_path\r\n        type: image\r\n        encoder: stacked_cnn\r\n\r\noutput_features:\r\n    -\r\n        name: class\r\n        type: category\r\n```\r\n\r\nThis is an excerpt from the data csv:\r\n```csv\r\nclass,image_path\r\ncoyote,coyote/0411-city-coyote.jpg\r\ncoyote,coyote/125545-004-bb8f48b2.jpg\r\ncoyote,coyote/1a4053ab-279c-45ef-bd29-0dae546ece73-large16x9_coyote_file_photo.jpg\r\ncoyote,coyote/220px-howl_%28cropped%29.jpg\r\ncoyote,coyote/2yowhhahmrghtksn6eibtyrcw4.jpg\r\ncoyote,coyote/300px-2009-coyote-yosemite.jpg\r\ncoyote,coyote/359744-coyote-dmid1-5ef0hkv48-953x532.jpg\r\ncoyote,coyote/5a3c4beb76446.image.jpg\r\ncoyote,coyote/5aaab3b7c7218.image.jpg\r\n```\r\n\r\nThis is the command:\r\n`ludwig experiment --data_csv coyo_road.csv --model_definition_file model_definition.yaml`\r\n\r\nThis is the output:\r\n```bash\r\nludwig v0.1.0 - Experiment\r\n\r\nExperiment name: experiment\r\nModel name: run\r\nOutput path: results/experiment_run_6\r\n\r\nludwig_version: '0.1.0'\r\ncommand: ('/usr/local/bin/ludwig experiment --data_csv coyo_road.csv '\r\n '--model_definition_file model_definition.yaml')\r\ndataset_type: 'coyo_road.csv'\r\nmodel_definition: {   'combiner': {'type': 'concat'},\r\n    'input_features': [   {   'encoder': 'stacked_cnn',\r\n                              'in_memory': True,\r\n                              'name': 'image_path',\r\n                              'should_resize': False,\r\n                              'tied_weights': None,\r\n                              'type': 'image'}],\r\n    'output_features': [   {   'dependencies': [],\r\n                               'loss': {   'class_distance_temperature': 0,\r\n                                           'class_weights': 1,\r\n                                           'confidence_penalty': 0,\r\n                                           'distortion': 1,\r\n                                           'labels_smoothing': 0,\r\n                                           'negative_samples': 0,\r\n                                           'robust_lambda': 0,\r\n                                           'sampler': None,\r\n                                           'type': 'softmax_cross_entropy',\r\n                                           'unique': False,\r\n                                           'weight': 1},\r\n                               'name': 'class',\r\n                               'reduce_dependencies': 'sum',\r\n                               'reduce_input': 'sum',\r\n                               'top_k': 3,\r\n                               'type': 'category'}],\r\n    'preprocessing': {   'bag': {   'fill_value': '',\r\n                                    'format': 'space',\r\n                                    'lowercase': 10000,\r\n                                    'missing_value_strategy': 'fill_with_const',\r\n                                    'most_common': False},\r\n                         'binary': {   'fill_value': 0,\r\n                                       'missing_value_strategy': 'fill_with_const'},\r\n                         'category': {   'fill_value': '<UNK>',\r\n                                         'lowercase': False,\r\n                                         'missing_value_strategy': 'fill_with_const',\r\n                                         'most_common': 10000},\r\n                         'force_split': False,\r\n                         'image': {'missing_value_strategy': 'backfill'},\r\n                         'numerical': {   'fill_value': 0,\r\n                                          'missing_value_strategy': 'fill_with_const'},\r\n                         'sequence': {   'fill_value': '',\r\n                                         'format': 'space',\r\n                                         'lowercase': False,\r\n                                         'missing_value_strategy': 'fill_with_const',\r\n                                         'most_common': 20000,\r\n                                         'padding': 'right',\r\n                                         'padding_symbol': '<PAD>',\r\n                                         'sequence_length_limit': 256,\r\n                                         'unknown_symbol': '<UNK>'},\r\n                         'set': {   'fill_value': '',\r\n                                    'format': 'space',\r\n                                    'lowercase': False,\r\n                                    'missing_value_strategy': 'fill_with_const',\r\n                                    'most_common': 10000},\r\n                         'split_probabilities': (0.7, 0.1, 0.2),\r\n                         'stratify': None,\r\n                         'text': {   'char_format': 'characters',\r\n                                     'char_most_common': 70,\r\n                                     'char_sequence_length_limit': 1024,\r\n                                     'fill_value': '',\r\n                                     'lowercase': True,\r\n                                     'missing_value_strategy': 'fill_with_const',\r\n                                     'padding': 'right',\r\n                                     'padding_symbol': '<PAD>',\r\n                                     'unknown_symbol': '<UNK>',\r\n                                     'word_format': 'space_punct',\r\n                                     'word_most_common': 20000,\r\n                                     'word_sequence_length_limit': 256},\r\n                         'timeseries': {   'fill_value': '',\r\n                                           'format': 'space',\r\n                                           'missing_value_strategy': 'fill_with_const',\r\n                                           'padding': 'right',\r\n                                           'padding_value': 0,\r\n                                           'timeseries_length_limit': 256}},\r\n    'training': {   'batch_size': 128,\r\n                    'bucketing_field': None,\r\n                    'decay': False,\r\n                    'decay_rate': 0.96,\r\n                    'decay_steps': 10000,\r\n                    'dropout_rate': 0.0,\r\n                    'early_stop': 3,\r\n                    'epochs': 200,\r\n                    'gradient_clipping': None,\r\n                    'increase_batch_size_on_plateau': 0,\r\n                    'increase_batch_size_on_plateau_max': 512,\r\n                    'increase_batch_size_on_plateau_patience': 5,\r\n                    'increase_batch_size_on_plateau_rate': 2,\r\n                    'learning_rate': 0.001,\r\n                    'learning_rate_warmup_epochs': 5,\r\n                    'optimizer': {   'beta1': 0.9,\r\n                                     'beta2': 0.999,\r\n                                     'epsilon': 1e-08,\r\n                                     'type': 'adam'},\r\n                    'reduce_learning_rate_on_plateau': 0,\r\n                    'reduce_learning_rate_on_plateau_patience': 5,\r\n                    'reduce_learning_rate_on_plateau_rate': 0.5,\r\n                    'regularization_lambda': 0,\r\n                    'regularizer': 'l2',\r\n                    'staircase': False,\r\n                    'validation_field': 'combined',\r\n                    'validation_measure': 'loss'}}\r\n\r\nUsing full raw csv, no hdf5 and json file with the same name have been found\r\nBuilding dataset (it may take a while)\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/ludwig\", line 11, in <module>\r\n    sys.exit(main())\r\n  File \"/usr/local/lib/python3.6/site-packages/ludwig/cli.py\", line 86, in main\r\n    CLI()\r\n  File \"/usr/local/lib/python3.6/site-packages/ludwig/cli.py\", line 64, in __init__\r\n    getattr(self, args.command)()\r\n  File \"/usr/local/lib/python3.6/site-packages/ludwig/cli.py\", line 67, in experiment\r\n    experiment.cli(sys.argv[2:])\r\n  File \"/usr/local/lib/python3.6/site-packages/ludwig/experiment.py\", line 548, in cli\r\n    experiment(**vars(args))\r\n  File \"/usr/local/lib/python3.6/site-packages/ludwig/experiment.py\", line 234, in experiment\r\n    random_seed=random_seed\r\n  File \"/usr/local/lib/python3.6/site-packages/ludwig/data/preprocessing.py\", line 457, in preprocess_for_training\r\n    random_seed=random_seed\r\n  File \"/usr/local/lib/python3.6/site-packages/ludwig/data/preprocessing.py\", line 62, in build_dataset\r\n    **kwargs\r\n  File \"/usr/local/lib/python3.6/site-packages/ludwig/data/preprocessing.py\", line 90, in build_dataset_df\r\n    global_preprocessing_parameters\r\n  File \"/usr/local/lib/python3.6/site-packages/ludwig/data/preprocessing.py\", line 165, in build_data\r\n    preprocessing_parameters\r\n  File \"/usr/local/lib/python3.6/site-packages/ludwig/features/image_feature.py\", line 101, in add_feature_data\r\n    data[feature['name']][i, :, :, :] = img\r\nValueError: could not broadcast input array from shape (227,300,3) into shape (750,1000,3)\r\n```\r\n\r\nRun on a Macbook running macOS Sierra (10.12.6) using python 3.6\r\n\r\n","closed_by":{"login":"meinnamehier","id":17614384,"node_id":"MDQ6VXNlcjE3NjE0Mzg0","avatar_url":"https://avatars.githubusercontent.com/u/17614384?v=4","gravatar_id":"","url":"https://api.github.com/users/meinnamehier","html_url":"https://github.com/meinnamehier","followers_url":"https://api.github.com/users/meinnamehier/followers","following_url":"https://api.github.com/users/meinnamehier/following{/other_user}","gists_url":"https://api.github.com/users/meinnamehier/gists{/gist_id}","starred_url":"https://api.github.com/users/meinnamehier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/meinnamehier/subscriptions","organizations_url":"https://api.github.com/users/meinnamehier/orgs","repos_url":"https://api.github.com/users/meinnamehier/repos","events_url":"https://api.github.com/users/meinnamehier/events{/privacy}","received_events_url":"https://api.github.com/users/meinnamehier/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/128/timeline","performed_via_github_app":null,"state_reason":"completed"}