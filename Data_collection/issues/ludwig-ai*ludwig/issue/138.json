{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/138","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/138/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/138/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/138/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/138","id":413997614,"node_id":"MDU6SXNzdWU0MTM5OTc2MTQ=","number":138,"title":"Classification model not getting trained","user":{"login":"pdsing","id":11045188,"node_id":"MDQ6VXNlcjExMDQ1MTg4","avatar_url":"https://avatars.githubusercontent.com/u/11045188?v=4","gravatar_id":"","url":"https://api.github.com/users/pdsing","html_url":"https://github.com/pdsing","followers_url":"https://api.github.com/users/pdsing/followers","following_url":"https://api.github.com/users/pdsing/following{/other_user}","gists_url":"https://api.github.com/users/pdsing/gists{/gist_id}","starred_url":"https://api.github.com/users/pdsing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pdsing/subscriptions","organizations_url":"https://api.github.com/users/pdsing/orgs","repos_url":"https://api.github.com/users/pdsing/repos","events_url":"https://api.github.com/users/pdsing/events{/privacy}","received_events_url":"https://api.github.com/users/pdsing/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-02-25T09:01:27Z","updated_at":"2019-02-26T19:33:08Z","closed_at":"2019-02-26T01:26:43Z","author_association":"NONE","active_lock_reason":null,"body":"I am trying to build a review to rating prediction model. I have a CSV of reviews and corresponding ratings by the users [data_500.csv.txt](https://github.com/uber/ludwig/files/2899633/data_500.csv.txt).\r\n\r\nI am using Google Colab.\r\n\r\nI create a model using: !ludwig train --data_csv data_500.csv --model_definition \"{input_features: [{name: review_text, type: text}], output_features: [{name: rating, type: category}]}\". The logs are attached below.\r\n\r\nWhen I try to predict the rating on my test data ([test_20.csv.txt](https://github.com/uber/ludwig/files/2899650/test_20.csv.txt)),  I get all ratings as 5.\r\n\r\nI am using !ludwig predict --data_csv test_20.csv --model_path results/experiment_run_0/model for prediction. The log is attached below.\r\n\r\nI think my model is not getting trained at all. Can you please guide me where I am going wrong?\r\n\r\n\r\n\r\n**When I train, I get the following log -**\r\n\r\nludwig_version: '0.1.0'\r\ncommand: ('/usr/local/bin/ludwig train --data_csv data_500.csv --model_definition '\r\n '{input_features: [{name: review_text, type: text}], output_features: [{name: '\r\n 'rating, type: category}]}')\r\ndataset_type: 'data_500.csv'\r\nmodel_definition: {   'combiner': {'type': 'concat'},\r\n    'input_features': [   {   'encoder': 'parallel_cnn',\r\n                              'level': 'word',\r\n                              'name': 'review_text',\r\n                              'tied_weights': None,\r\n                              'type': 'text'}],\r\n    'output_features': [   {   'dependencies': [],\r\n                               'loss': {   'class_distance_temperature': 0,\r\n                                           'class_weights': 1,\r\n                                           'confidence_penalty': 0,\r\n                                           'distortion': 1,\r\n                                           'labels_smoothing': 0,\r\n                                           'negative_samples': 0,\r\n                                           'robust_lambda': 0,\r\n                                           'sampler': None,\r\n                                           'type': 'softmax_cross_entropy',\r\n                                           'unique': False,\r\n                                           'weight': 1},\r\n                               'name': 'rating',\r\n                               'reduce_dependencies': 'sum',\r\n                               'reduce_input': 'sum',\r\n                               'top_k': 3,\r\n                               'type': 'category'}],\r\n    'preprocessing': {   'bag': {   'fill_value': '',\r\n                                    'format': 'space',\r\n                                    'lowercase': 10000,\r\n                                    'missing_value_strategy': 'fill_with_const',\r\n                                    'most_common': False},\r\n                         'binary': {   'fill_value': 0,\r\n                                       'missing_value_strategy': 'fill_with_const'},\r\n                         'category': {   'fill_value': '<UNK>',\r\n                                         'lowercase': False,\r\n                                         'missing_value_strategy': 'fill_with_const',\r\n                                         'most_common': 10000},\r\n                         'force_split': False,\r\n                         'image': {'missing_value_strategy': 'backfill'},\r\n                         'numerical': {   'fill_value': 0,\r\n                                          'missing_value_strategy': 'fill_with_const'},\r\n                         'sequence': {   'fill_value': '',\r\n                                         'format': 'space',\r\n                                         'lowercase': False,\r\n                                         'missing_value_strategy': 'fill_with_const',\r\n                                         'most_common': 20000,\r\n                                         'padding': 'right',\r\n                                         'padding_symbol': '<PAD>',\r\n                                         'sequence_length_limit': 256,\r\n                                         'unknown_symbol': '<UNK>'},\r\n                         'set': {   'fill_value': '',\r\n                                    'format': 'space',\r\n                                    'lowercase': False,\r\n                                    'missing_value_strategy': 'fill_with_const',\r\n                                    'most_common': 10000},\r\n                         'split_probabilities': (0.7, 0.1, 0.2),\r\n                         'stratify': None,\r\n                         'text': {   'char_format': 'characters',\r\n                                     'char_most_common': 70,\r\n                                     'char_sequence_length_limit': 1024,\r\n                                     'fill_value': '',\r\n                                     'lowercase': True,\r\n                                     'missing_value_strategy': 'fill_with_const',\r\n                                     'padding': 'right',\r\n                                     'padding_symbol': '<PAD>',\r\n                                     'unknown_symbol': '<UNK>',\r\n                                     'word_format': 'space_punct',\r\n                                     'word_most_common': 20000,\r\n                                     'word_sequence_length_limit': 256},\r\n                         'timeseries': {   'fill_value': '',\r\n                                           'format': 'space',\r\n                                           'missing_value_strategy': 'fill_with_const',\r\n                                           'padding': 'right',\r\n                                           'padding_value': 0,\r\n                                           'timeseries_length_limit': 256}},\r\n    'training': {   'batch_size': 128,\r\n                    'bucketing_field': None,\r\n                    'decay': False,\r\n                    'decay_rate': 0.96,\r\n                    'decay_steps': 10000,\r\n                    'dropout_rate': 0.0,\r\n                    'early_stop': 5,\r\n                    'epochs': 100,\r\n                    'gradient_clipping': None,\r\n                    'increase_batch_size_on_plateau': 0,\r\n                    'increase_batch_size_on_plateau_max': 512,\r\n                    'increase_batch_size_on_plateau_patience': 5,\r\n                    'increase_batch_size_on_plateau_rate': 2,\r\n                    'learning_rate': 0.001,\r\n                    'learning_rate_warmup_epochs': 5,\r\n                    'optimizer': {   'beta1': 0.9,\r\n                                     'beta2': 0.999,\r\n                                     'epsilon': 1e-08,\r\n                                     'type': 'adam'},\r\n                    'reduce_learning_rate_on_plateau': 0,\r\n                    'reduce_learning_rate_on_plateau_patience': 5,\r\n                    'reduce_learning_rate_on_plateau_rate': 0.5,\r\n                    'regularization_lambda': 0,\r\n                    'regularizer': 'l2',\r\n                    'staircase': False,\r\n                    'validation_field': 'combined',\r\n                    'validation_measure': 'loss'}}\r\n\r\n\r\nUsing full raw csv, no hdf5 and json file with the same name have been found\r\nBuilding dataset (it may take a while)\r\nLoading NLP pipeline\r\nWriting dataset\r\nWriting train set metadata with vocabulary\r\nTraining set: 346\r\nValidation set: 48\r\nTest set: 106\r\nWARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\nFrom /usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\nWARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.cast instead.\r\nFrom /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.cast instead.\r\nWARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.cast instead.\r\nFrom /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.cast instead.\r\nWARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_grad.py:102: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nDeprecated in favor of operator or tf.math.divide.\r\nFrom /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_grad.py:102: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nDeprecated in favor of operator or tf.math.divide.\r\n\r\n╒══════════╕\r\n│ TRAINING │\r\n╘══════════╛\r\n\r\n2019-02-25 07:53:20.563543: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2300000000 Hz\r\n2019-02-25 07:53:20.567917: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x21cf860 executing computations on platform Host. Devices:\r\n2019-02-25 07:53:20.567964: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>\r\n\r\nEpoch   1\r\nTraining: 100% 3/3 [00:10<00:00,  3.79s/it]\r\nEvaluation train: 100% 3/3 [00:02<00:00,  1.02s/it]\r\nEvaluation vali : 100% 1/1 [00:00<00:00,  2.40it/s]\r\nEvaluation test : 100% 1/1 [00:00<00:00,  1.10it/s]\r\nTook 15.2982s\r\n╒══════════╤════════╤════════════╤═════════════╕\r\n│ rating   │   loss │   accuracy │   hits_at_k │\r\n╞══════════╪════════╪════════════╪═════════════╡\r\n│ train    │ 4.8280 │     0.1301 │      0.9191 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ vali     │ 4.1219 │     0.2917 │      0.8958 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ test     │ 4.5526 │     0.1698 │      0.9528 │\r\n╘══════════╧════════╧════════════╧═════════════╛\r\nValidation loss on combined improved, model saved\r\n\r\n\r\nEpoch   2\r\nTraining: 100% 3/3 [00:10<00:00,  3.45s/it]\r\nEvaluation train: 100% 3/3 [00:03<00:00,  1.02s/it]\r\nEvaluation vali : 100% 1/1 [00:00<00:00,  2.34it/s]\r\nEvaluation test : 100% 1/1 [00:00<00:00,  1.10it/s]\r\nTook 14.6133s\r\n╒══════════╤════════╤════════════╤═════════════╕\r\n│ rating   │   loss │   accuracy │   hits_at_k │\r\n╞══════════╪════════╪════════════╪═════════════╡\r\n│ train    │ 1.6862 │     0.7543 │      0.8410 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ vali     │ 2.9535 │     0.5833 │      0.6875 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ test     │ 1.9904 │     0.7264 │      0.7925 │\r\n╘══════════╧════════╧════════════╧═════════════╛\r\nValidation loss on combined improved, model saved\r\n\r\n\r\nEpoch   3\r\nTraining: 100% 3/3 [00:10<00:00,  3.48s/it]\r\nEvaluation train: 100% 3/3 [00:03<00:00,  1.01s/it]\r\nEvaluation vali : 100% 1/1 [00:00<00:00,  2.34it/s]\r\nEvaluation test : 100% 1/1 [00:00<00:00,  1.08it/s]\r\nTook 14.6806s\r\n╒══════════╤════════╤════════════╤═════════════╕\r\n│ rating   │   loss │   accuracy │   hits_at_k │\r\n╞══════════╪════════╪════════════╪═════════════╡\r\n│ train    │ 1.2675 │     0.7543 │      0.8410 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ vali     │ 2.2575 │     0.5833 │      0.6875 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ test     │ 1.4940 │     0.7264 │      0.7925 │\r\n╘══════════╧════════╧════════════╧═════════════╛\r\nValidation loss on combined improved, model saved\r\n\r\n\r\nEpoch   4\r\nTraining: 100% 3/3 [00:10<00:00,  3.46s/it]\r\nEvaluation train: 100% 3/3 [00:03<00:00,  1.01s/it]\r\nEvaluation vali : 100% 1/1 [00:00<00:00,  2.37it/s]\r\nEvaluation test : 100% 1/1 [00:00<00:00,  1.08it/s]\r\nTook 14.6354s\r\n╒══════════╤════════╤════════════╤═════════════╕\r\n│ rating   │   loss │   accuracy │   hits_at_k │\r\n╞══════════╪════════╪════════════╪═════════════╡\r\n│ train    │ 1.1529 │     0.3988 │      0.9133 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ vali     │ 1.2190 │     0.2708 │      0.8958 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ test     │ 1.1510 │     0.3585 │      0.9340 │\r\n╘══════════╧════════╧════════════╧═════════════╛\r\nValidation loss on combined improved, model saved\r\n\r\n\r\nEpoch   5\r\nTraining: 100% 3/3 [00:10<00:00,  3.48s/it]\r\nEvaluation train: 100% 3/3 [00:03<00:00,  1.01s/it]\r\nEvaluation vali : 100% 1/1 [00:00<00:00,  2.37it/s]\r\nEvaluation test : 100% 1/1 [00:00<00:00,  1.08it/s]\r\nTook 14.7180s\r\n╒══════════╤════════╤════════════╤═════════════╕\r\n│ rating   │   loss │   accuracy │   hits_at_k │\r\n╞══════════╪════════╪════════════╪═════════════╡\r\n│ train    │ 1.0847 │     0.7543 │      0.9364 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ vali     │ 1.6780 │     0.5833 │      0.9583 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ test     │ 1.2223 │     0.7264 │      0.9057 │\r\n╘══════════╧════════╧════════════╧═════════════╛\r\nLast improvement of loss on combined happened 1 epoch ago\r\n\r\n\r\nEpoch   6\r\nTraining: 100% 3/3 [00:10<00:00,  3.45s/it]\r\nEvaluation train: 100% 3/3 [00:02<00:00,  1.01s/it]\r\nEvaluation vali : 100% 1/1 [00:00<00:00,  2.34it/s]\r\nEvaluation test : 100% 1/1 [00:00<00:00,  1.09it/s]\r\nTook 14.5831s\r\n╒══════════╤════════╤════════════╤═════════════╕\r\n│ rating   │   loss │   accuracy │   hits_at_k │\r\n╞══════════╪════════╪════════════╪═════════════╡\r\n│ train    │ 0.9503 │     0.7543 │      0.9364 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ vali     │ 1.1677 │     0.5833 │      0.9583 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ test     │ 1.0606 │     0.7264 │      0.9057 │\r\n╘══════════╧════════╧════════════╧═════════════╛\r\nValidation loss on combined improved, model saved\r\n\r\n\r\nEpoch   7\r\nTraining: 100% 3/3 [00:10<00:00,  3.47s/it]\r\nEvaluation train: 100% 3/3 [00:03<00:00,  1.02s/it]\r\nEvaluation vali : 100% 1/1 [00:00<00:00,  2.36it/s]\r\nEvaluation test : 100% 1/1 [00:00<00:00,  1.09it/s]\r\nTook 14.6443s\r\n╒══════════╤════════╤════════════╤═════════════╕\r\n│ rating   │   loss │   accuracy │   hits_at_k │\r\n╞══════════╪════════╪════════════╪═════════════╡\r\n│ train    │ 0.9198 │     0.7543 │      0.9277 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ vali     │ 1.4745 │     0.5833 │      0.8958 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ test     │ 0.9475 │     0.7264 │      0.9528 │\r\n╘══════════╧════════╧════════════╧═════════════╛\r\nLast improvement of loss on combined happened 1 epoch ago\r\n\r\n\r\nEpoch   8\r\nTraining: 100% 3/3 [00:10<00:00,  3.43s/it]\r\nEvaluation train: 100% 3/3 [00:02<00:00,  1.00s/it]\r\nEvaluation vali : 100% 1/1 [00:00<00:00,  2.38it/s]\r\nEvaluation test : 100% 1/1 [00:00<00:00,  1.10it/s]\r\nTook 14.4598s\r\n╒══════════╤════════╤════════════╤═════════════╕\r\n│ rating   │   loss │   accuracy │   hits_at_k │\r\n╞══════════╪════════╪════════════╪═════════════╡\r\n│ train    │ 0.8892 │     0.7543 │      0.9133 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ vali     │ 1.2088 │     0.5833 │      0.8958 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ test     │ 0.8997 │     0.7264 │      0.9340 │\r\n╘══════════╧════════╧════════════╧═════════════╛\r\nLast improvement of loss on combined happened 2 epochs ago\r\n\r\n\r\nEpoch   9\r\nTraining: 100% 3/3 [00:10<00:00,  3.45s/it]\r\nEvaluation train: 100% 3/3 [00:02<00:00,  1.01s/it]\r\nEvaluation vali : 100% 1/1 [00:00<00:00,  2.37it/s]\r\nEvaluation test : 100% 1/1 [00:00<00:00,  1.09it/s]\r\nTook 14.5781s\r\n╒══════════╤════════╤════════════╤═════════════╕\r\n│ rating   │   loss │   accuracy │   hits_at_k │\r\n╞══════════╪════════╪════════════╪═════════════╡\r\n│ train    │ 0.8413 │     0.7543 │      0.9364 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ vali     │ 1.2812 │     0.5833 │      0.9583 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ test     │ 0.9747 │     0.7264 │      0.9057 │\r\n╘══════════╧════════╧════════════╧═════════════╛\r\nLast improvement of loss on combined happened 3 epochs ago\r\n\r\n\r\nEpoch  10\r\nTraining: 100% 3/3 [00:10<00:00,  3.45s/it]\r\nEvaluation train: 100% 3/3 [00:02<00:00,  1.01it/s]\r\nEvaluation vali : 100% 1/1 [00:00<00:00,  2.40it/s]\r\nEvaluation test : 100% 1/1 [00:00<00:00,  1.09it/s]\r\nTook 14.5225s\r\n╒══════════╤════════╤════════════╤═════════════╕\r\n│ rating   │   loss │   accuracy │   hits_at_k │\r\n╞══════════╪════════╪════════════╪═════════════╡\r\n│ train    │ 0.8365 │     0.7543 │      0.9364 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ vali     │ 1.2758 │     0.5833 │      0.9583 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ test     │ 0.9576 │     0.7264 │      0.9057 │\r\n╘══════════╧════════╧════════════╧═════════════╛\r\nLast improvement of loss on combined happened 4 epochs ago\r\n\r\n\r\nEpoch  11\r\nTraining: 100% 3/3 [00:10<00:00,  3.47s/it]\r\nEvaluation train: 100% 3/3 [00:03<00:00,  1.02s/it]\r\nEvaluation vali : 100% 1/1 [00:00<00:00,  2.41it/s]\r\nEvaluation test : 100% 1/1 [00:00<00:00,  1.09it/s]\r\nTook 14.6348s\r\n╒══════════╤════════╤════════════╤═════════════╕\r\n│ rating   │   loss │   accuracy │   hits_at_k │\r\n╞══════════╪════════╪════════════╪═════════════╡\r\n│ train    │ 0.8353 │     0.7543 │      0.9277 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ vali     │ 1.2154 │     0.5833 │      0.8958 │\r\n├──────────┼────────┼────────────┼─────────────┤\r\n│ test     │ 0.8837 │     0.7264 │      0.9528 │\r\n╘══════════╧════════╧════════════╧═════════════╛\r\nLast improvement of loss on combined happened 5 epochs ago\r\n\r\nEARLY STOPPING due to lack of validation improvement, it has been 5 epochs since last validation accuracy improvement\r\n\r\nBest validation model epoch:\r\nBest validation model loss on validation set combined: 4.121904691060384\r\nBest validation model loss on test set combined: 4.5525981975051595\r\n\r\nFinished: experiment_run\r\nSaved to: results/experiment_run_0\r\n\r\n**Log at the time of prediction**\r\n _         _        _      \r\n| |_  _ __| |_ __ _(_)__ _ \r\n| | || / _` \\ V  V / / _` |\r\n|_|\\_,_\\__,_|\\_/\\_/|_\\__, |\r\n                     |___/ \r\nludwig v0.1.0 - Predict\r\n\r\nDataset type: generic\r\nDataset path: test_20.csv\r\nModel path: results/experiment_run_0/model\r\nOutput path: results_0\r\n\r\nLoading metadata from: results/experiment_run_0/model/train_set_metadata.json\r\n\r\n╒═══════════════╕\r\n│ LOADING MODEL │\r\n╘═══════════════╛\r\n\r\nWARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\nFrom /usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\nWARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.cast instead.\r\nFrom /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.cast instead.\r\nWARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.cast instead.\r\nFrom /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.cast instead.\r\nWARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_grad.py:102: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nDeprecated in favor of operator or tf.math.divide.\r\nFrom /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_grad.py:102: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nDeprecated in favor of operator or tf.math.divide.\r\n\r\n╒═════════╕\r\n│ PREDICT │\r\n╘═════════╛\r\n\r\n2019-02-25 08:49:16.742020: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2300000000 Hz\r\n2019-02-25 08:49:16.742365: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x228a7e0 executing computations on platform Host. Devices:\r\n2019-02-25 08:49:16.742433: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>\r\nWARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse standard file APIs to check for files with this prefix.\r\nFrom /usr/local/lib/python3.6/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse standard file APIs to check for files with this prefix.\r\nINFO:tensorflow:Restoring parameters from results/experiment_run_0/model/model_weights\r\nRestoring parameters from results/experiment_run_0/model/model_weights\r\nEvaluation: 100% 1/1 [00:00<00:00,  4.01it/s]\r\n/usr/local/lib/python3.6/dist-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples.\r\n  'precision', 'predicted', average, warn_for)\r\n/usr/local/lib/python3.6/dist-packages/sklearn/metrics/classification.py:1145: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples.\r\n  'recall', 'true', average, warn_for)\r\n/usr/local/lib/python3.6/dist-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no predicted samples.\r\n  'precision', 'predicted', average, warn_for)\r\n/usr/local/lib/python3.6/dist-packages/sklearn/metrics/classification.py:1145: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true samples.\r\n  'recall', 'true', average, warn_for)\r\n\r\n===== rating =====\r\naccuracy: 0.0\r\nhits_at_k: 0.0\r\nloss: 17.951489535245027\r\noverall_stats: { 'avg_f1_score_macro': 0.0,\r\n  'avg_f1_score_micro': 0.0,\r\n  'avg_f1_score_weighted': 0.0,\r\n  'avg_precision_macro': 0.0,\r\n  'avg_precision_micro': 0.0,\r\n  'avg_precision_weighted': 0.0,\r\n  'avg_recall_macro': 0.0,\r\n  'avg_recall_micro': 0.0,\r\n  'avg_recall_weighted': 0.0,\r\n  'kappa_score': 0.0,\r\n  'overall_accuracy': 0.0}\r\nper_class_stats: {<UNK>: {   'accuracy': 0.0,\r\n    'f1_score': 0,\r\n    'fall_out': 1.0,\r\n    'false_discovery_rate': 1.0,\r\n    'false_negative_rate': 1.0,\r\n    'false_negatives': 0,\r\n    'false_omission_rate': 1.0,\r\n    'false_positive_rate': 1.0,\r\n    'false_positives': 22,\r\n    'hit_rate': 0,\r\n    'informedness': -1.0,\r\n    'markedness': -1.0,\r\n    'matthews_correlation_coefficient': 0,\r\n    'miss_rate': 1.0,\r\n    'negative_predictive_value': 0,\r\n    'positive_predictive_value': 0.0,\r\n    'precision': 0.0,\r\n    'recall': 0,\r\n    'sensitivity': 0,\r\n    'specificity': 0.0,\r\n    'true_negative_rate': 0.0,\r\n    'true_negatives': 0,\r\n    'true_positive_rate': 0,\r\n    'true_positives': 0},\r\n  label_5: {   'accuracy': 0.0,\r\n    'f1_score': 0,\r\n    'fall_out': 1.0,\r\n    'false_discovery_rate': 1.0,\r\n    'false_negative_rate': 1.0,\r\n    'false_negatives': 22,\r\n    'false_omission_rate': 1.0,\r\n    'false_positive_rate': 1.0,\r\n    'false_positives': 0,\r\n    'hit_rate': 0.0,\r\n    'informedness': -1.0,\r\n    'markedness': -1.0,\r\n    'matthews_correlation_coefficient': 0,\r\n    'miss_rate': 1.0,\r\n    'negative_predictive_value': 0.0,\r\n    'positive_predictive_value': 0,\r\n    'precision': 0,\r\n    'recall': 0.0,\r\n    'sensitivity': 0.0,\r\n    'specificity': 0,\r\n    'true_negative_rate': 0,\r\n    'true_negatives': 0,\r\n    'true_positive_rate': 0.0,\r\n    'true_positives': 0},\r\n  label_4: {   'accuracy': 1.0,\r\n    'f1_score': 0,\r\n    'fall_out': 0.0,\r\n    'false_discovery_rate': 1.0,\r\n    'false_negative_rate': 1.0,\r\n    'false_negatives': 0,\r\n    'false_omission_rate': 0.0,\r\n    'false_positive_rate': 0.0,\r\n    'false_positives': 0,\r\n    'hit_rate': 0,\r\n    'informedness': 0.0,\r\n    'markedness': 0.0,\r\n    'matthews_correlation_coefficient': 0,\r\n    'miss_rate': 1.0,\r\n    'negative_predictive_value': 1.0,\r\n    'positive_predictive_value': 0,\r\n    'precision': 0,\r\n    'recall': 0,\r\n    'sensitivity': 0,\r\n    'specificity': 1.0,\r\n    'true_negative_rate': 1.0,\r\n    'true_negatives': 22,\r\n    'true_positive_rate': 0,\r\n    'true_positives': 0},\r\n  label_1: {   'accuracy': 1.0,\r\n    'f1_score': 0,\r\n    'fall_out': 0.0,\r\n    'false_discovery_rate': 1.0,\r\n    'false_negative_rate': 1.0,\r\n    'false_negatives': 0,\r\n    'false_omission_rate': 0.0,\r\n    'false_positive_rate': 0.0,\r\n    'false_positives': 0,\r\n    'hit_rate': 0,\r\n    'informedness': 0.0,\r\n    'markedness': 0.0,\r\n    'matthews_correlation_coefficient': 0,\r\n    'miss_rate': 1.0,\r\n    'negative_predictive_value': 1.0,\r\n    'positive_predictive_value': 0,\r\n    'precision': 0,\r\n    'recall': 0,\r\n    'sensitivity': 0,\r\n    'specificity': 1.0,\r\n    'true_negative_rate': 1.0,\r\n    'true_negatives': 22,\r\n    'true_positive_rate': 0,\r\n    'true_positives': 0},\r\n  label_2: {   'accuracy': 1.0,\r\n    'f1_score': 0,\r\n    'fall_out': 0.0,\r\n    'false_discovery_rate': 1.0,\r\n    'false_negative_rate': 1.0,\r\n    'false_negatives': 0,\r\n    'false_omission_rate': 0.0,\r\n    'false_positive_rate': 0.0,\r\n    'false_positives': 0,\r\n    'hit_rate': 0,\r\n    'informedness': 0.0,\r\n    'markedness': 0.0,\r\n    'matthews_correlation_coefficient': 0,\r\n    'miss_rate': 1.0,\r\n    'negative_predictive_value': 1.0,\r\n    'positive_predictive_value': 0,\r\n    'precision': 0,\r\n    'recall': 0,\r\n    'sensitivity': 0,\r\n    'specificity': 1.0,\r\n    'true_negative_rate': 1.0,\r\n    'true_negatives': 22,\r\n    'true_positive_rate': 0,\r\n    'true_positives': 0},\r\n  label_3: {   'accuracy': 1.0,\r\n    'f1_score': 0,\r\n    'fall_out': 0.0,\r\n    'false_discovery_rate': 1.0,\r\n    'false_negative_rate': 1.0,\r\n    'false_negatives': 0,\r\n    'false_omission_rate': 0.0,\r\n    'false_positive_rate': 0.0,\r\n    'false_positives': 0,\r\n    'hit_rate': 0,\r\n    'informedness': 0.0,\r\n    'markedness': 0.0,\r\n    'matthews_correlation_coefficient': 0,\r\n    'miss_rate': 1.0,\r\n    'negative_predictive_value': 1.0,\r\n    'positive_predictive_value': 0,\r\n    'precision': 0,\r\n    'recall': 0,\r\n    'sensitivity': 0,\r\n    'specificity': 1.0,\r\n    'true_negative_rate': 1.0,\r\n    'true_negatives': 22,\r\n    'true_positive_rate': 0,\r\n    'true_positives': 0}}\r\nSaved to: results_0\r\n\r\n","closed_by":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/138/timeline","performed_via_github_app":null,"state_reason":"completed"}