{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/271","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/271/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/271/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/271/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/271","id":429023433,"node_id":"MDU6SXNzdWU0MjkwMjM0MzM=","number":271,"title":"Cuda error","user":{"login":"mgc26","id":20780825,"node_id":"MDQ6VXNlcjIwNzgwODI1","avatar_url":"https://avatars.githubusercontent.com/u/20780825?v=4","gravatar_id":"","url":"https://api.github.com/users/mgc26","html_url":"https://github.com/mgc26","followers_url":"https://api.github.com/users/mgc26/followers","following_url":"https://api.github.com/users/mgc26/following{/other_user}","gists_url":"https://api.github.com/users/mgc26/gists{/gist_id}","starred_url":"https://api.github.com/users/mgc26/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgc26/subscriptions","organizations_url":"https://api.github.com/users/mgc26/orgs","repos_url":"https://api.github.com/users/mgc26/repos","events_url":"https://api.github.com/users/mgc26/events{/privacy}","received_events_url":"https://api.github.com/users/mgc26/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-04-03T23:55:54Z","updated_at":"2019-04-04T03:41:57Z","closed_at":"2019-04-04T03:41:33Z","author_association":"NONE","active_lock_reason":null,"body":"Hi all,\r\nHave been trying to fire up my first image classification model, but am hitting a OOM roadblock.  Using an EVGA RTX 2070 GPU (8gb). Without specifying batch size, I get this error:\r\n\r\n```\r\n`\r\n2019-04-03 18:49:56.804435: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-04-03 18:49:56.829467: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3393220000 Hz\r\n2019-04-03 18:49:56.831332: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x561f24441cd0 executing computations on platform Host. Devices:\r\n2019-04-03 18:49:56.831365: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>\r\n2019-04-03 18:49:56.949705: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x561f210d02d0 executing computations on platform CUDA. Devices:\r\n2019-04-03 18:49:56.949748: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): GeForce RTX 2070, Compute Capability 7.5\r\n2019-04-03 18:49:56.950422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: \r\nname: GeForce RTX 2070 major: 7 minor: 5 memoryClockRate(GHz): 1.62\r\npciBusID: 0000:41:00.0\r\ntotalMemory: 7.76GiB freeMemory: 7.40GiB\r\n2019-04-03 18:49:56.950445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0\r\n2019-04-03 18:49:56.951860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-04-03 18:49:56.951878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 \r\n2019-04-03 18:49:56.951886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N \r\n2019-04-03 18:49:56.952460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7203 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2070, pci bus id: 0000:41:00.0, compute capability: 7.5)\r\n\r\nEpoch   1\r\nTraining:   0%|                                                                      | 0/4 [00:00<?, ?it/s]2019-04-03 18:49:59.158357: I tensorflow/stream_executor/dso_loader.cc:152] successfully opened CUDA library libcublas.so.10.0 locally\r\n2019-04-03 18:50:09.372662: W tensorflow/core/common_runtime/bfc_allocator.cc:267] Allocator (GPU_0_bfc) ran out of memory trying to allocate 6.12GiB.  Current allocation summary follows.\r\n2019-04-03 18:50:09.372727: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (256): \tTotal Chunks: 28, Chunks in use: 27. 7.0KiB allocated for chunks. 6.8KiB in use in bin. 172B client-requested in use in bin.\r\n2019-04-03 18:50:09.372738: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (512): \tTotal Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.\r\n2019-04-03 18:50:09.372756: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (1024): \tTotal Chunks: 22, Chunks in use: 22. 22.2KiB allocated for chunks. 22.2KiB in use in bin. 22.0KiB client-requested in use in bin.\r\n2019-04-03 18:50:09.372766: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (2048): \tTotal Chunks: 2, Chunks in use: 1. 5.0KiB allocated for chunks. 2.5KiB in use in bin. 2.5KiB client-requested in use in bin.\r\n2019-04-03 18:50:09.372776: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (4096): \tTotal Chunks: 4, Chunks in use: 4. 20.0KiB allocated for chunks. 20.0KiB in use in bin. 20.0KiB client-requested in use in bin.\r\n2019-04-03 18:50:09.372785: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (8192): \tTotal Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.\r\n2019-04-03 18:50:09.372797: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (16384): \tTotal Chunks: 4, Chunks in use: 4. 108.0KiB allocated for chunks. 108.0KiB in use in bin. 108.0KiB client-requested in use in bin.\r\n2019-04-03 18:50:09.372807: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (32768): \tTotal Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.\r\n2019-04-03 18:50:09.372816: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (65536): \tTotal Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.\r\n2019-04-03 18:50:09.372824: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (131072): \tTotal Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.\r\n2019-04-03 18:50:09.372833: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (262144): \tTotal Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.\r\n2019-04-03 18:50:09.372842: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (524288): \tTotal Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.\r\n2019-04-03 18:50:09.372850: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (1048576): \tTotal Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.\r\n2019-04-03 18:50:09.372860: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (2097152): \tTotal Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.\r\n2019-04-03 18:50:09.372870: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (4194304): \tTotal Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.\r\n2019-04-03 18:50:09.372882: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (8388608): \tTotal Chunks: 7, Chunks in use: 7. 85.75MiB allocated for chunks. 85.75MiB in use in bin. 85.75MiB client-requested in use in bin.\r\n2019-04-03 18:50:09.372892: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (16777216): \tTotal Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.\r\n2019-04-03 18:50:09.372901: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (33554432): \tTotal Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.\r\n2019-04-03 18:50:09.372912: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (67108864): \tTotal Chunks: 2, Chunks in use: 1. 147.00MiB allocated for chunks. 73.50MiB in use in bin. 73.50MiB client-requested in use in bin.\r\n2019-04-03 18:50:09.372923: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (134217728): \tTotal Chunks: 4, Chunks in use: 4. 784.00MiB allocated for chunks. 784.00MiB in use in bin. 784.00MiB client-requested in use in bin.\r\n2019-04-03 18:50:09.372932: I tensorflow/core/common_runtime/bfc_allocator.cc:597] Bin (268435456): \tTotal Chunks: 1, Chunks in use: 0. 6.04GiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.\r\n2019-04-03 18:50:09.372945: I tensorflow/core/common_runtime/bfc_allocator.cc:613] Bin for 6.12GiB was 256.00MiB, Chunk State: \r\n2019-04-03 18:50:09.372961: I tensorflow/core/common_runtime/bfc_allocator.cc:619]   Size: 6.04GiB | Requested Size: 0B | in_use: 0, prev:   Size: 73.50MiB | Requested Size: 73.50MiB | in_use: 1\r\n2019-04-03 18:50:09.372972: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb384000000 of size 205520896\r\n2019-04-03 18:50:09.372979: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb390400000 of size 1024\r\n2019-04-03 18:50:09.372987: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb390400400 of size 12845056\r\n2019-04-03 18:50:09.372997: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391040400 of size 1024\r\n2019-04-03 18:50:09.373006: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391040800 of size 1024\r\n2019-04-03 18:50:09.373015: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391040c00 of size 27648\r\n2019-04-03 18:50:09.373026: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391047800 of size 1024\r\n2019-04-03 18:50:09.373037: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391047c00 of size 5120\r\n2019-04-03 18:50:09.373046: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391049000 of size 256\r\n2019-04-03 18:50:09.373055: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391049100 of size 256\r\n2019-04-03 18:50:09.373069: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391049200 of size 256\r\n2019-04-03 18:50:09.373080: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391049300 of size 256\r\n2019-04-03 18:50:09.373090: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391049400 of size 256\r\n2019-04-03 18:50:09.373100: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391049500 of size 1024\r\n2019-04-03 18:50:09.373109: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391049900 of size 256\r\n2019-04-03 18:50:09.373119: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391049a00 of size 256\r\n2019-04-03 18:50:09.373128: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391049b00 of size 1024\r\n2019-04-03 18:50:09.373137: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb391049f00 of size 256\r\n2019-04-03 18:50:09.373147: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb39104a000 of size 1024\r\n2019-04-03 18:50:09.373156: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb39104a400 of size 256\r\n2019-04-03 18:50:09.373164: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb39104a500 of size 256\r\n2019-04-03 18:50:09.373174: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb39104a600 of size 1024\r\n2019-04-03 18:50:09.373183: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb39104aa00 of size 256\r\n2019-04-03 18:50:09.373193: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb39104ab00 of size 256\r\n2019-04-03 18:50:09.373202: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb39104ac00 of size 256\r\n2019-04-03 18:50:09.373212: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb39104ad00 of size 256\r\n2019-04-03 18:50:09.373221: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb39104ae00 of size 1280\r\n2019-04-03 18:50:09.373231: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb39104b300 of size 205520896\r\n2019-04-03 18:50:09.373241: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb39d44b300 of size 205520896\r\n2019-04-03 18:50:09.373251: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3a984b300 of size 1024\r\n2019-04-03 18:50:09.373276: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3a984b700 of size 1024\r\n2019-04-03 18:50:09.373286: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3a984bb00 of size 12845056\r\n2019-04-03 18:50:09.373294: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3aa48bb00 of size 12845056\r\n2019-04-03 18:50:09.373304: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ab0cbb00 of size 1024\r\n2019-04-03 18:50:09.373313: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ab0cbf00 of size 1024\r\n2019-04-03 18:50:09.373320: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ab0cc300 of size 12845056\r\n2019-04-03 18:50:09.373330: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3abd0c300 of size 12845056\r\n2019-04-03 18:50:09.373339: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ac94c300 of size 1024\r\n2019-04-03 18:50:09.373347: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ac94c700 of size 1024\r\n2019-04-03 18:50:09.373357: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ac94cb00 of size 27648\r\n2019-04-03 18:50:09.373366: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ac953700 of size 27648\r\n2019-04-03 18:50:09.373374: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ac95a300 of size 1024\r\n2019-04-03 18:50:09.373384: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ac95a700 of size 1024\r\n2019-04-03 18:50:09.373394: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ac95ab00 of size 5120\r\n2019-04-03 18:50:09.373404: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ac95bf00 of size 5120\r\n2019-04-03 18:50:09.373413: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ac95d300 of size 256\r\n2019-04-03 18:50:09.373422: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ac95d400 of size 256\r\n2019-04-03 18:50:09.373431: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ac95d500 of size 256\r\n2019-04-03 18:50:09.373441: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ac95d600 of size 256\r\n2019-04-03 18:50:09.373451: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ac95d700 of size 205520896\r\n2019-04-03 18:50:09.373461: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3b8d5d700 of size 1024\r\n2019-04-03 18:50:09.373471: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3b8d5db00 of size 12845056\r\n2019-04-03 18:50:09.373480: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3b999db00 of size 1024\r\n2019-04-03 18:50:09.373488: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3b999df00 of size 12845056\r\n2019-04-03 18:50:09.373498: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ba5ddf00 of size 1024\r\n2019-04-03 18:50:09.373508: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ba5de300 of size 27648\r\n2019-04-03 18:50:09.373518: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ba5e4f00 of size 1024\r\n2019-04-03 18:50:09.373528: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ba5e5300 of size 5120\r\n2019-04-03 18:50:09.373537: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ba5e6700 of size 256\r\n2019-04-03 18:50:09.373546: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ba5e6800 of size 256\r\n2019-04-03 18:50:09.373555: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ba5e6900 of size 256\r\n2019-04-03 18:50:09.373564: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ba5e6a00 of size 256\r\n2019-04-03 18:50:09.373573: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ba5e6b00 of size 256\r\n2019-04-03 18:50:09.373581: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ba5e6c00 of size 256\r\n2019-04-03 18:50:09.373591: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ba5e6d00 of size 256\r\n2019-04-03 18:50:09.373600: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Free  at 0x7fb3ba5e6e00 of size 256\r\n2019-04-03 18:50:09.373608: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ba5e6f00 of size 256\r\n2019-04-03 18:50:09.373617: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ba5e7000 of size 1024\r\n2019-04-03 18:50:09.373627: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3ba5e7400 of size 2560\r\n2019-04-03 18:50:09.373637: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Free  at 0x7fb3ba5e7e00 of size 77068288\r\n2019-04-03 18:50:09.373647: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3bef67600 of size 256\r\n2019-04-03 18:50:09.373656: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Free  at 0x7fb3bef67700 of size 2560\r\n2019-04-03 18:50:09.373666: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Chunk at 0x7fb3bef68100 of size 77070336\r\n2019-04-03 18:50:09.373676: I tensorflow/core/common_runtime/bfc_allocator.cc:632] Free  at 0x7fb3c38e8100 of size 6487106816\r\n2019-04-03 18:50:09.373684: I tensorflow/core/common_runtime/bfc_allocator.cc:638]      Summary of in-use Chunks by size: \r\n2019-04-03 18:50:09.373697: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 27 Chunks of size 256 totalling 6.8KiB\r\n2019-04-03 18:50:09.373709: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 21 Chunks of size 1024 totalling 21.0KiB\r\n2019-04-03 18:50:09.373719: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 1 Chunks of size 1280 totalling 1.2KiB\r\n2019-04-03 18:50:09.373729: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 1 Chunks of size 2560 totalling 2.5KiB\r\n2019-04-03 18:50:09.373739: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 4 Chunks of size 5120 totalling 20.0KiB\r\n2019-04-03 18:50:09.373750: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 4 Chunks of size 27648 totalling 108.0KiB\r\n2019-04-03 18:50:09.373761: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 7 Chunks of size 12845056 totalling 85.75MiB\r\n2019-04-03 18:50:09.373770: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 1 Chunks of size 77070336 totalling 73.50MiB\r\n2019-04-03 18:50:09.373781: I tensorflow/core/common_runtime/bfc_allocator.cc:641] 4 Chunks of size 205520896 totalling 784.00MiB\r\n2019-04-03 18:50:09.373792: I tensorflow/core/common_runtime/bfc_allocator.cc:645] Sum Total of in-use chunks: 943.41MiB\r\n2019-04-03 18:50:09.373805: I tensorflow/core/common_runtime/bfc_allocator.cc:647] Stats: \r\nLimit:                  7553410663\r\nInUse:                   989232640\r\nMaxInUse:               1066303744\r\nNumAllocs:                      79\r\nMaxAllocSize:            205520896\r\n\r\n2019-04-03 18:50:09.373823: W tensorflow/core/common_runtime/bfc_allocator.cc:271] ***************_____________________________________________________________________________________\r\n2019-04-03 18:50:09.373855: W tensorflow/core/framework/op_kernel.cc:1401] OP_REQUIRES failed at conv_ops.cc:446 : Resource exhausted: OOM when allocating tensor with shape[128,256,224,224] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc\r\nTraceback (most recent call last):\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1334, in _do_call\r\n    return fn(*args)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1319, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1407, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[128,256,224,224] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc\r\n\t [[{{node image_path/conv_0/Conv2D}}]]\r\nHint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.\r\n\r\n\t [[{{node class/measures_class/accuracy_class}}]]\r\nHint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.\r\n\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/mcrowson/anaconda3/bin/ludwig\", line 11, in <module>\r\n    sys.exit(main())\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/cli.py\", line 86, in main\r\n    CLI()\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/cli.py\", line 64, in __init__\r\n    getattr(self, args.command)()\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/cli.py\", line 67, in experiment\r\n    experiment.cli(sys.argv[2:])\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/experiment.py\", line 548, in cli\r\n    experiment(**vars(args))\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/experiment.py\", line 258, in experiment\r\n    debug=debug\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/train.py\", line 383, in train\r\n    **model_definition['training']\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/model.py\", line 488, in train\r\n    is_training=True\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 929, in run\r\n    run_metadata_ptr)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1152, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1328, in _do_run\r\n    run_metadata)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1348, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[128,256,224,224] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc\r\n\t [[node image_path/conv_0/Conv2D (defined at /home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/convolutional_modules.py:54) ]]\r\nHint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.\r\n\r\n\t [[node class/measures_class/accuracy_class (defined at /home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/measure_modules.py:56) ]]\r\nHint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.\r\n\r\n\r\nCaused by op 'image_path/conv_0/Conv2D', defined at:\r\n  File \"/home/mcrowson/anaconda3/bin/ludwig\", line 11, in <module>\r\n    sys.exit(main())\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/cli.py\", line 86, in main\r\n    CLI()\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/cli.py\", line 64, in __init__\r\n    getattr(self, args.command)()\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/cli.py\", line 67, in experiment\r\n    experiment.cli(sys.argv[2:])\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/experiment.py\", line 548, in cli\r\n    experiment(**vars(args))\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/experiment.py\", line 258, in experiment\r\n    debug=debug\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/train.py\", line 368, in train\r\n    debug=debug\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/model.py\", line 110, in __init__\r\n    **kwargs\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/model.py\", line 160, in __build\r\n    is_training=self.is_training\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/inputs.py\", line 39, in build_inputs\r\n    **kwargs)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/inputs.py\", line 66, in build_single_input\r\n    **kwargs)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/features/image_feature.py\", line 180, in build_input\r\n    is_training,\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/image_encoders.py\", line 79, in __call__\r\n    is_training=is_training\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/convolutional_modules.py\", line 565, in __call__\r\n    is_training=is_training)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/convolutional_modules.py\", line 147, in conv_2d_layer\r\n    dimensions=2, is_training=is_training)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/convolutional_modules.py\", line 121, in conv_layer\r\n    is_training=is_training)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/convolutional_modules.py\", line 54, in conv_2d\r\n    padding=padding) + biases\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 1026, in conv2d\r\n    data_format=data_format, dilations=dilations, name=name)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 788, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 3300, in create_op\r\n    op_def=op_def)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 1801, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[128,256,224,224] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc\r\n\t [[node image_path/conv_0/Conv2D (defined at /home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/convolutional_modules.py:54) ]]\r\nHint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.\r\n\r\n\t [[node class/measures_class/accuracy_class (defined at /home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/measure_modules.py:56) ]]\r\nHint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.`\r\n```\r\n\r\nModel definition file:\r\n\r\n```\r\nModel Definition:\r\n\r\n`input_features:\r\n    -\r\n        name: image_path\r\n        type: image\r\n        encoder: stacked_cnn\r\n        resize_method: crop_or_pad\r\n        height: 112\r\n        width: 112\r\n\r\noutput_features:\r\n    -\r\n        name: class\r\n        type: category`\r\n```\r\n\r\nUpon adding batch size, of any number, to the model definition I get this error:\r\n\r\n```\r\nEpoch   1\r\nTraining:   0%|                                                                     | 0/30 [00:00<?, ?it/s]2019-04-03 18:52:37.276173: I tensorflow/stream_executor/dso_loader.cc:152] successfully opened CUDA library libcublas.so.10.0 locally\r\n2019-04-03 18:52:38.231678: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2019-04-03 18:52:38.240432: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\nTraceback (most recent call last):\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1334, in _do_call\r\n    return fn(*args)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1319, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1407, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[{{node image_path/conv_0/Conv2D}}]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/mcrowson/anaconda3/bin/ludwig\", line 11, in <module>\r\n    sys.exit(main())\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/cli.py\", line 86, in main\r\n    CLI()\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/cli.py\", line 64, in __init__\r\n    getattr(self, args.command)()\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/cli.py\", line 67, in experiment\r\n    experiment.cli(sys.argv[2:])\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/experiment.py\", line 548, in cli\r\n    experiment(**vars(args))\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/experiment.py\", line 258, in experiment\r\n    debug=debug\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/train.py\", line 383, in train\r\n    **model_definition['training']\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/model.py\", line 488, in train\r\n    is_training=True\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 929, in run\r\n    run_metadata_ptr)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1152, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1328, in _do_run\r\n    run_metadata)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1348, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[node image_path/conv_0/Conv2D (defined at /home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/convolutional_modules.py:54) ]]\r\n\r\nCaused by op 'image_path/conv_0/Conv2D', defined at:\r\n  File \"/home/mcrowson/anaconda3/bin/ludwig\", line 11, in <module>\r\n    sys.exit(main())\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/cli.py\", line 86, in main\r\n    CLI()\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/cli.py\", line 64, in __init__\r\n    getattr(self, args.command)()\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/cli.py\", line 67, in experiment\r\n    experiment.cli(sys.argv[2:])\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/experiment.py\", line 548, in cli\r\n    experiment(**vars(args))\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/experiment.py\", line 258, in experiment\r\n    debug=debug\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/train.py\", line 368, in train\r\n    debug=debug\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/model.py\", line 110, in __init__\r\n    **kwargs\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/model.py\", line 160, in __build\r\n    is_training=self.is_training\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/inputs.py\", line 39, in build_inputs\r\n    **kwargs)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/inputs.py\", line 66, in build_single_input\r\n    **kwargs)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/features/image_feature.py\", line 180, in build_input\r\n    is_training,\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/image_encoders.py\", line 79, in __call__\r\n    is_training=is_training\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/convolutional_modules.py\", line 565, in __call__\r\n    is_training=is_training)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/convolutional_modules.py\", line 147, in conv_2d_layer\r\n    dimensions=2, is_training=is_training)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/convolutional_modules.py\", line 121, in conv_layer\r\n    is_training=is_training)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/convolutional_modules.py\", line 54, in conv_2d\r\n    padding=padding) + biases\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/gen_nn_ops.py\", line 1026, in conv2d\r\n    data_format=data_format, dilations=dilations, name=name)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py\", line 788, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 3300, in create_op\r\n    op_def=op_def)\r\n  File \"/home/mcrowson/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/ops.py\", line 1801, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nUnknownError (see above for traceback): Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[node image_path/conv_0/Conv2D (defined at /home/mcrowson/anaconda3/lib/python3.7/site-packages/ludwig/models/modules/convolutional_modules.py:54) ]]\r\n```\r\n\r\n\r\nSeems odd to me that the model fails to load after coercing a batch size. Anyone else experience this? ","closed_by":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/271/timeline","performed_via_github_app":null,"state_reason":"completed"}