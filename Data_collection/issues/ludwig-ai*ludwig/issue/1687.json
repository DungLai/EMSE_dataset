{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1687","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1687/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1687/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1687/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/1687","id":1106322004,"node_id":"I_kwDOCbx2hs5B8SJU","number":1687,"title":"Address issue where lr gets set to auto for hyperparameter search on master/pytorch","user":{"login":"amholler","id":86269492,"node_id":"MDQ6VXNlcjg2MjY5NDky","avatar_url":"https://avatars.githubusercontent.com/u/86269492?v=4","gravatar_id":"","url":"https://api.github.com/users/amholler","html_url":"https://github.com/amholler","followers_url":"https://api.github.com/users/amholler/followers","following_url":"https://api.github.com/users/amholler/following{/other_user}","gists_url":"https://api.github.com/users/amholler/gists{/gist_id}","starred_url":"https://api.github.com/users/amholler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amholler/subscriptions","organizations_url":"https://api.github.com/users/amholler/orgs","repos_url":"https://api.github.com/users/amholler/repos","events_url":"https://api.github.com/users/amholler/events{/privacy}","received_events_url":"https://api.github.com/users/amholler/received_events","type":"User","site_admin":false},"labels":[{"id":1174068769,"node_id":"MDU6TGFiZWwxMTc0MDY4NzY5","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"dantreiman","id":687280,"node_id":"MDQ6VXNlcjY4NzI4MA==","avatar_url":"https://avatars.githubusercontent.com/u/687280?v=4","gravatar_id":"","url":"https://api.github.com/users/dantreiman","html_url":"https://github.com/dantreiman","followers_url":"https://api.github.com/users/dantreiman/followers","following_url":"https://api.github.com/users/dantreiman/following{/other_user}","gists_url":"https://api.github.com/users/dantreiman/gists{/gist_id}","starred_url":"https://api.github.com/users/dantreiman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dantreiman/subscriptions","organizations_url":"https://api.github.com/users/dantreiman/orgs","repos_url":"https://api.github.com/users/dantreiman/repos","events_url":"https://api.github.com/users/dantreiman/events{/privacy}","received_events_url":"https://api.github.com/users/dantreiman/received_events","type":"User","site_admin":false},"assignees":[{"login":"dantreiman","id":687280,"node_id":"MDQ6VXNlcjY4NzI4MA==","avatar_url":"https://avatars.githubusercontent.com/u/687280?v=4","gravatar_id":"","url":"https://api.github.com/users/dantreiman","html_url":"https://github.com/dantreiman","followers_url":"https://api.github.com/users/dantreiman/followers","following_url":"https://api.github.com/users/dantreiman/following{/other_user}","gists_url":"https://api.github.com/users/dantreiman/gists{/gist_id}","starred_url":"https://api.github.com/users/dantreiman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dantreiman/subscriptions","organizations_url":"https://api.github.com/users/dantreiman/orgs","repos_url":"https://api.github.com/users/dantreiman/repos","events_url":"https://api.github.com/users/dantreiman/events{/privacy}","received_events_url":"https://api.github.com/users/dantreiman/received_events","type":"User","site_admin":false},{"login":"justinxzhao","id":3459541,"node_id":"MDQ6VXNlcjM0NTk1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/3459541?v=4","gravatar_id":"","url":"https://api.github.com/users/justinxzhao","html_url":"https://github.com/justinxzhao","followers_url":"https://api.github.com/users/justinxzhao/followers","following_url":"https://api.github.com/users/justinxzhao/following{/other_user}","gists_url":"https://api.github.com/users/justinxzhao/gists{/gist_id}","starred_url":"https://api.github.com/users/justinxzhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinxzhao/subscriptions","organizations_url":"https://api.github.com/users/justinxzhao/orgs","repos_url":"https://api.github.com/users/justinxzhao/repos","events_url":"https://api.github.com/users/justinxzhao/events{/privacy}","received_events_url":"https://api.github.com/users/justinxzhao/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2022-01-17T22:59:50Z","updated_at":"2022-01-31T18:30:11Z","closed_at":"2022-01-31T18:30:11Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"Filing this ticket for tracking.\r\nRight now all automl jobs fail on master unless https://github.com/ludwig-ai/ludwig/pull/1650 is reverted, which is what I am doing to get results.\r\n@justinxzhao is working on a fix, as per slack discussion below.\r\n```\r\nAnne Holler Jan 14th at 7:11 AM\r\nHi, @Justin Zhao @Daniel Treiman There's a basic problem that is making everything fail.  AFAICT,\r\nthe issue is the introduction of the below line, which for hyperparameter search, sets lr to \"auto\":\r\n\r\n     # ===== Training Optimizer =====\r\n     optimizer = config[TRAINING][\"optimizer\"]\r\n+    set_default_value(optimizer, \"lr\", config[TRAINING][\"learning_rate\"])\r\n\r\nAnne Holler  7:14 AM\r\nAnd the substitution of training.learning rate that happens during hyperparameter search is not\r\nhappening for this lr field in the optimizer, so pytorch gets an lr set to the string \"auto\" and it doesn't like that.\r\n\r\n7 replies\r\nJustin Zhao  3 days ago\r\nThe issue is probably introduced by https://github.com/ludwig-ai/ludwig/pull/1650\r\n#1650 Removes lr from default_optimizer_params_registry\r\nFixes #1621Removes training.optimizer.lr defaults from default_optimizer_params_registry.Use training.learning_rate as default value for`training.optimizer.lr` instead.training.learning_rate will always be present, either from config or default_training_params\r\n\r\ndefault_training_params = {\r\n    \"learning_rate\": 0.001,\r\n\r\nComments\r\n1\r\n<https://github.com/ludwig-ai/ludwig|ludwig-ai/ludwig>ludwig-ai/ludwig | Jan 5th | Added by GitHub\r\nAnne Holler  3 days ago\r\nyes.  should it be reverted while the fix is developed or ? (edited) \r\n\r\nJustin Zhao  3 days ago\r\nWhere does hyperopt / ludwig set the actual learning rate?\r\n\r\nAnne Holler  3 days ago\r\nI think it is here https://github.com/ludwig-ai/ludwig/blob/master/ludwig/api.py#L521\r\napi.py\r\n\r\n                if self.config[TRAINING][LEARNING_RATE] == AUTO:\r\n\r\n<https://github.com/ludwig-ai/ludwig|ludwig-ai/ludwig>ludwig-ai/ludwig | Added by GitHub\r\n\r\n<SNIP>\r\n\r\nJustin Zhao  3 days ago\r\nDiscussed offline. Anne will revert locally while I take a look at a stable fix\r\n```","closed_by":{"login":"justinxzhao","id":3459541,"node_id":"MDQ6VXNlcjM0NTk1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/3459541?v=4","gravatar_id":"","url":"https://api.github.com/users/justinxzhao","html_url":"https://github.com/justinxzhao","followers_url":"https://api.github.com/users/justinxzhao/followers","following_url":"https://api.github.com/users/justinxzhao/following{/other_user}","gists_url":"https://api.github.com/users/justinxzhao/gists{/gist_id}","starred_url":"https://api.github.com/users/justinxzhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinxzhao/subscriptions","organizations_url":"https://api.github.com/users/justinxzhao/orgs","repos_url":"https://api.github.com/users/justinxzhao/repos","events_url":"https://api.github.com/users/justinxzhao/events{/privacy}","received_events_url":"https://api.github.com/users/justinxzhao/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1687/timeline","performed_via_github_app":null,"state_reason":"completed"}