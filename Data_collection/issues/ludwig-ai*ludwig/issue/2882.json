{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2882","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2882/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2882/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2882/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/2882","id":1510100994,"node_id":"I_kwDOCbx2hs5aAlAC","number":2882,"title":"SIGSEGV during imports for Ludwig components","user":{"login":"jimthompson5802","id":1425269,"node_id":"MDQ6VXNlcjE0MjUyNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1425269?v=4","gravatar_id":"","url":"https://api.github.com/users/jimthompson5802","html_url":"https://github.com/jimthompson5802","followers_url":"https://api.github.com/users/jimthompson5802/followers","following_url":"https://api.github.com/users/jimthompson5802/following{/other_user}","gists_url":"https://api.github.com/users/jimthompson5802/gists{/gist_id}","starred_url":"https://api.github.com/users/jimthompson5802/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimthompson5802/subscriptions","organizations_url":"https://api.github.com/users/jimthompson5802/orgs","repos_url":"https://api.github.com/users/jimthompson5802/repos","events_url":"https://api.github.com/users/jimthompson5802/events{/privacy}","received_events_url":"https://api.github.com/users/jimthompson5802/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-12-24T13:54:25Z","updated_at":"2023-01-13T13:46:59Z","closed_at":"2023-01-13T13:46:58Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"**Describe the bug**\r\nSIGSEGV fault occurs during import of Ludwig components\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n\r\n1. create python file `mwe_sigsegv_example.py`  with this contents:\r\n```\r\nfrom ludwig.schema.model_config import ModelConfig\r\nfrom tests.integration_tests.utils import number_feature\r\n\r\nprint(\"all done\")\r\n```\r\n2.  run `python mwe_sigsegv_example.py`\r\n\r\n\r\n**Expected behavior**\r\nNo errors for module imports\r\n\r\n**Screenshots**\r\nOutput from running the above program\r\n\r\n```\r\npython mwe_sigsegv_import.py\r\n\r\n# program output\r\nSegmentation fault\r\n```\r\n\r\n\r\n**Environment (please complete the following information):**\r\n\r\n- OS:  MacOS 12.6.1, Docker Desktop 4.9.1, Docker Image OS: Debian GNU/Linux 10 (buster)\r\n- Python version: 3.8.15\r\n- Ludwig version: ludwig v0.7.dev\r\n\r\n**Additional context**\r\n\r\n* First encountered this error during development of data augmentation feature on my development branch.  However, the problem also occurs on the `master` branch as well.\r\n\r\n* if the order of `from ...` statements are reversed, the SIGSEGV fault DOES NOT occur.   No error when the order of imports are this\r\n```\r\nfrom tests.integration_tests.utils import number_feature\r\nfrom ludwig.schema.model_config import ModelConfig\r\n\r\nprint(\"all done\")\r\n```\r\n\r\n* Here is output when `faulthandler` is enabled in the program\r\n```\r\nimport faulthandler\r\nfaulthandler.enable()\r\n\r\nfrom ludwig.schema.model_config import ModelConfig\r\nfrom tests.integration_tests.utils import number_feature\r\n\r\nprint(\"all done\")\r\n```\r\n\r\nOutput from the above\r\n```\r\npython mwe_sigsegv_import.py\r\nFatal Python error: Segmentation fault\r\n\r\nCurrent thread 0x00007fc062499740 (most recent call first):\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap_external>\", line 1166 in create_module\r\n  File \"<frozen importlib._bootstrap>\", line 556 in module_from_spec\r\n  File \"<frozen importlib._bootstrap>\", line 657 in _load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 975 in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 991 in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap>\", line 1042 in _handle_fromlist\r\n  File \"/usr/local/lib/python3.8/site-packages/google/protobuf/descriptor.py\", line 47 in <module>\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap_external>\", line 843 in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 671 in _load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 975 in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 991 in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap>\", line 1042 in _handle_fromlist\r\n  File \"/usr/local/lib/python3.8/site-packages/ray/core/generated/common_pb2.py\", line 6 in <module>\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap_external>\", line 843 in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 671 in _load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 975 in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 991 in _find_and_load\r\n  File \"/usr/local/lib/python3.8/site-packages/ray/exceptions.py\", line 10 in <module>\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap_external>\", line 843 in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 671 in _load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 975 in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 991 in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap_external>\", line 1174 in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 671 in _load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 975 in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 991 in _find_and_load\r\n  File \"/usr/local/lib/python3.8/site-packages/ray/__init__.py\", line 116 in <module>\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap_external>\", line 843 in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 671 in _load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 975 in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 991 in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap>\", line 961 in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 991 in _find_and_load\r\n  File \"/opt/project/ludwig/progress_bar.py\", line 7 in <module>\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap_external>\", line 843 in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 671 in _load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 975 in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 991 in _find_and_load\r\n  File \"/opt/project/ludwig/models/predictor.py\", line 19 in <module>\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap_external>\", line 843 in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 671 in _load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 975 in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 991 in _find_and_load\r\n  File \"/opt/project/ludwig/api.py\", line 68 in <module>\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap_external>\", line 843 in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 671 in _load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 975 in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 991 in _find_and_load\r\n  File \"/opt/project/tests/integration_tests/utils.py\", line 37 in <module>\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap_external>\", line 843 in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 671 in _load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 975 in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 991 in _find_and_load\r\n  File \"mwe_sigsegv_import.py\", line 5 in <module>\r\nSegmentation fault\r\n```","closed_by":{"login":"jimthompson5802","id":1425269,"node_id":"MDQ6VXNlcjE0MjUyNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1425269?v=4","gravatar_id":"","url":"https://api.github.com/users/jimthompson5802","html_url":"https://github.com/jimthompson5802","followers_url":"https://api.github.com/users/jimthompson5802/followers","following_url":"https://api.github.com/users/jimthompson5802/following{/other_user}","gists_url":"https://api.github.com/users/jimthompson5802/gists{/gist_id}","starred_url":"https://api.github.com/users/jimthompson5802/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimthompson5802/subscriptions","organizations_url":"https://api.github.com/users/jimthompson5802/orgs","repos_url":"https://api.github.com/users/jimthompson5802/repos","events_url":"https://api.github.com/users/jimthompson5802/events{/privacy}","received_events_url":"https://api.github.com/users/jimthompson5802/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2882/timeline","performed_via_github_app":null,"state_reason":"completed"}