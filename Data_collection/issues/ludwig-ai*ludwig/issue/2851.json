{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2851","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2851/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2851/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2851/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/2851","id":1500734043,"node_id":"I_kwDOCbx2hs5Zc2Jb","number":2851,"title":"encoder bug: missing argument `max_sequence_length` for RoBERTa encoder","user":{"login":"rudolfolah","id":89982117,"node_id":"MDQ6VXNlcjg5OTgyMTE3","avatar_url":"https://avatars.githubusercontent.com/u/89982117?v=4","gravatar_id":"","url":"https://api.github.com/users/rudolfolah","html_url":"https://github.com/rudolfolah","followers_url":"https://api.github.com/users/rudolfolah/followers","following_url":"https://api.github.com/users/rudolfolah/following{/other_user}","gists_url":"https://api.github.com/users/rudolfolah/gists{/gist_id}","starred_url":"https://api.github.com/users/rudolfolah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rudolfolah/subscriptions","organizations_url":"https://api.github.com/users/rudolfolah/orgs","repos_url":"https://api.github.com/users/rudolfolah/repos","events_url":"https://api.github.com/users/rudolfolah/events{/privacy}","received_events_url":"https://api.github.com/users/rudolfolah/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-12-16T19:12:47Z","updated_at":"2022-12-16T19:52:03Z","closed_at":"2022-12-16T19:52:03Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Describe the bug**\r\nCannot use the RoBERTa encoder for input and output features.\r\n\r\n**To Reproduce**\r\nConfiguration of model to reproduce the issue:\r\n\r\n```python\r\nconfig = {\r\n    \"input_features\": [\r\n        {\r\n            \"name\": \"source_code\",\r\n            \"type\": \"text\",\r\n            \"encoder\": {\r\n                \"type\": \"roberta\",\r\n                \"max_sequence_length\": 3000,\r\n            }\r\n        },\r\n    ],\r\n    \"output_features\": [\r\n        {\r\n            \"name\": \"test_code\",\r\n            \"type\": \"text\",\r\n            \"encoder\": {\r\n                \"type\": \"roberta\",\r\n                \"max_sequence_length\": 1000,\r\n            }\r\n        }\r\n    ],\r\n}\r\n```\r\n\r\nThe training data used:\r\n\r\n```\r\nsource_code,test_code\r\nfunction addOne(a) { return a + 1 },expect(addOne(1)).toEqual(2)\r\nfunction hello(a) { return 1+a },expect(hello(1)).toEqual(2)\r\n```\r\n\r\n**Expected behavior**\r\nThe model can be trained with the RoBERTa encoder and the `max_sequence_length` argument is passed through and can be adjusted through the features encoder configuration.\r\n\r\n**Environment:**\r\n\r\n- OS: macOS 12.6\r\n- Version \\[e.g. 22\\]\r\n- Python version 3.9\r\n- Ludwig version 0.6.4\r\n\r\n**Additional context**\r\nThe `\"max_sequence_length\"` was added to the configuration to try to fix the issue, when changing the encoder to \"bert\" the configuration worked so it seems an issue with this particular encoder.\r\n\r\nTraceback:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/Users/rudolfo/Workspace/ludwig-code-gen/main.py\", line 27, in <module>\r\n    model.train(\r\n  File \"/Users/rudolfo/Workspace/ludwig-code-gen/env/lib/python3.9/site-packages/ludwig/api.py\", line 505, in train\r\n    self.model = LudwigModel.create_model(self.config, random_seed=random_seed)\r\n  File \"/Users/rudolfo/Workspace/ludwig-code-gen/env/lib/python3.9/site-packages/ludwig/api.py\", line 1542, in create_model\r\n    return model_type(**config, random_seed=random_seed)\r\n  File \"/Users/rudolfo/Workspace/ludwig-code-gen/env/lib/python3.9/site-packages/ludwig/models/ecd.py\", line 46, in __init__\r\n    self.input_features.update(self.build_inputs(self._input_features_def))\r\n  File \"/Users/rudolfo/Workspace/ludwig-code-gen/env/lib/python3.9/site-packages/ludwig/models/base.py\", line 55, in build_inputs\r\n    input_features[input_feature_def[NAME]] = cls.build_single_input(input_feature_def, input_features)\r\n  File \"/Users/rudolfo/Workspace/ludwig-code-gen/env/lib/python3.9/site-packages/ludwig/models/base.py\", line 72, in build_single_input\r\n    input_feature_obj = input_feature_class(input_feature_def, encoder_obj=encoder_obj)\r\n  File \"/Users/rudolfo/Workspace/ludwig-code-gen/env/lib/python3.9/site-packages/ludwig/features/text_feature.py\", line 188, in __init__\r\n    super().__init__(input_feature_config, encoder_obj=encoder_obj, **kwargs)\r\n  File \"/Users/rudolfo/Workspace/ludwig-code-gen/env/lib/python3.9/site-packages/ludwig/features/sequence_feature.py\", line 271, in __init__\r\n    self.encoder_obj = self.initialize_encoder(input_feature_config.encoder)\r\n  File \"/Users/rudolfo/Workspace/ludwig-code-gen/env/lib/python3.9/site-packages/ludwig/features/base_feature.py\", line 170, in initialize_encoder\r\n    return encoder_cls(encoder_config=encoder_config, **encoder_params_dict)\r\nTypeError: __init__() missing 1 required positional argument: 'max_sequence_length'\r\n```\r\n","closed_by":{"login":"arnavgarg1","id":106701836,"node_id":"U_kgDOBlwkDA","avatar_url":"https://avatars.githubusercontent.com/u/106701836?v=4","gravatar_id":"","url":"https://api.github.com/users/arnavgarg1","html_url":"https://github.com/arnavgarg1","followers_url":"https://api.github.com/users/arnavgarg1/followers","following_url":"https://api.github.com/users/arnavgarg1/following{/other_user}","gists_url":"https://api.github.com/users/arnavgarg1/gists{/gist_id}","starred_url":"https://api.github.com/users/arnavgarg1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arnavgarg1/subscriptions","organizations_url":"https://api.github.com/users/arnavgarg1/orgs","repos_url":"https://api.github.com/users/arnavgarg1/repos","events_url":"https://api.github.com/users/arnavgarg1/events{/privacy}","received_events_url":"https://api.github.com/users/arnavgarg1/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2851/timeline","performed_via_github_app":null,"state_reason":"completed"}