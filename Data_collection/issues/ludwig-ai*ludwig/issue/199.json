{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/199","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/199/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/199/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/199/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/199","id":419622695,"node_id":"MDU6SXNzdWU0MTk2MjI2OTU=","number":199,"title":"Invalid Argument Error","user":{"login":"art-hack","id":31595652,"node_id":"MDQ6VXNlcjMxNTk1NjUy","avatar_url":"https://avatars.githubusercontent.com/u/31595652?v=4","gravatar_id":"","url":"https://api.github.com/users/art-hack","html_url":"https://github.com/art-hack","followers_url":"https://api.github.com/users/art-hack/followers","following_url":"https://api.github.com/users/art-hack/following{/other_user}","gists_url":"https://api.github.com/users/art-hack/gists{/gist_id}","starred_url":"https://api.github.com/users/art-hack/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/art-hack/subscriptions","organizations_url":"https://api.github.com/users/art-hack/orgs","repos_url":"https://api.github.com/users/art-hack/repos","events_url":"https://api.github.com/users/art-hack/events{/privacy}","received_events_url":"https://api.github.com/users/art-hack/received_events","type":"User","site_admin":false},"labels":[{"id":1174068775,"node_id":"MDU6TGFiZWwxMTc0MDY4Nzc1","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/waiting%20for%20answer","name":"waiting for answer","color":"fff36b","default":false,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-03-11T18:35:39Z","updated_at":"2019-03-11T20:14:47Z","closed_at":"2019-03-11T20:14:47Z","author_association":"NONE","active_lock_reason":null,"body":"I am getting Invalid argument error when i try to train the dataset\r\n\r\n```\r\n(venv) (base) quadro@Quadro:~/Desktop/Work/contest/ludwig$ ludwig train --data_csv train/train_file.csv -mdf train/model.yaml \r\n _         _        _      \r\n| |_  _ __| |_ __ _(_)__ _ \r\n| | || / _` \\ V  V / / _` |\r\n|_|\\_,_\\__,_|\\_/\\_/|_\\__, |\r\n                     |___/ \r\nludwig v0.1.0 - Train\r\n\r\nExperiment name: experiment\r\nModel name: run\r\nOutput path: results/experiment_run_3\r\n\r\n\r\nludwig_version: '0.1.0'\r\ncommand: ('/home/quadro/Desktop/Work/contest/ludwig/venv/bin/ludwig train --data_csv '\r\n 'train/train_file.csv -mdf train/model.yaml')\r\ncommit_hash: '7dc539a0590c'\r\ndataset_type: 'generic'\r\nrandom_seed: 42\r\ninput_data: 'train/train_file.csv'\r\nmodel_definition: {   'combiner': {'type': 'concat'},\r\n    'input_features': [   {   'name': 'ID',\r\n                              'tied_weights': None,\r\n                              'type': 'numerical'},\r\n                          {   'name': 'UsageClass',\r\n                              'tied_weights': None,\r\n                              'type': 'category'},\r\n                          {   'name': 'CheckoutType',\r\n                              'tied_weights': None,\r\n                              'type': 'category'},\r\n                          {   'name': 'CheckoutYear',\r\n                              'tied_weights': None,\r\n                              'type': 'numerical'},\r\n                          {   'name': 'CheckoutMonth',\r\n                              'tied_weights': None,\r\n                              'type': 'numerical'},\r\n                          {   'name': 'Checkouts',\r\n                              'tied_weights': None,\r\n                              'type': 'numerical'},\r\n                          {   'encoder': 'parallel_cnn',\r\n                              'level': 'word',\r\n                              'name': 'Title',\r\n                              'tied_weights': None,\r\n                              'type': 'text'},\r\n                          {   'encoder': 'parallel_cnn',\r\n                              'level': 'word',\r\n                              'name': 'Creator',\r\n                              'tied_weights': None,\r\n                              'type': 'text'},\r\n                          {   'name': 'Subjects',\r\n                              'tied_weights': None,\r\n                              'type': 'category'},\r\n                          {   'encoder': 'parallel_cnn',\r\n                              'level': 'word',\r\n                              'name': 'Publisher',\r\n                              'tied_weights': None,\r\n                              'type': 'text'},\r\n                          {   'encoder': 'parallel_cnn',\r\n                              'level': 'word',\r\n                              'name': 'PublicationYear',\r\n                              'tied_weights': None,\r\n                              'type': 'text'},\r\n                          {   'name': 'MaterialType',\r\n                              'tied_weights': None,\r\n                              'type': 'category'}],\r\n    'output_features': [   {   'dependencies': [],\r\n                               'loss': {   'type': 'mean_squared_error',\r\n                                           'weight': 1},\r\n                               'name': 'ID',\r\n                               'reduce_dependencies': 'sum',\r\n                               'reduce_input': 'sum',\r\n                               'type': 'numerical',\r\n                               'weight': 1},\r\n                           {   'dependencies': [],\r\n                               'loss': {   'class_distance_temperature': 0,\r\n                                           'class_weights': 1,\r\n                                           'confidence_penalty': 0,\r\n                                           'distortion': 1,\r\n                                           'labels_smoothing': 0,\r\n                                           'negative_samples': 0,\r\n                                           'robust_lambda': 0,\r\n                                           'sampler': None,\r\n                                           'type': 'softmax_cross_entropy',\r\n                                           'unique': False,\r\n                                           'weight': 1},\r\n                               'name': 'MaterialType',\r\n                               'reduce_dependencies': 'sum',\r\n                               'reduce_input': 'sum',\r\n                               'top_k': 3,\r\n                               'type': 'category'}],\r\n    'preprocessing': {   'bag': {   'fill_value': '',\r\n                                    'format': 'space',\r\n                                    'lowercase': False,\r\n                                    'missing_value_strategy': 'fill_with_const',\r\n                                    'most_common': 10000},\r\n                         'binary': {   'fill_value': 0,\r\n                                       'missing_value_strategy': 'fill_with_const'},\r\n                         'category': {   'fill_value': '<UNK>',\r\n                                         'lowercase': False,\r\n                                         'missing_value_strategy': 'fill_with_const',\r\n                                         'most_common': 10000},\r\n                         'force_split': False,\r\n                         'image': {   'in_memory': True,\r\n                                      'missing_value_strategy': 'backfill',\r\n                                      'resize_method': 'crop_or_pad'},\r\n                         'numerical': {   'fill_value': 0,\r\n                                          'missing_value_strategy': 'fill_with_const'},\r\n                         'sequence': {   'fill_value': '',\r\n                                         'format': 'space',\r\n                                         'lowercase': False,\r\n                                         'missing_value_strategy': 'fill_with_const',\r\n                                         'most_common': 20000,\r\n                                         'padding': 'right',\r\n                                         'padding_symbol': '<PAD>',\r\n                                         'sequence_length_limit': 256,\r\n                                         'unknown_symbol': '<UNK>'},\r\n                         'set': {   'fill_value': '',\r\n                                    'format': 'space',\r\n                                    'lowercase': False,\r\n                                    'missing_value_strategy': 'fill_with_const',\r\n                                    'most_common': 10000},\r\n                         'split_probabilities': (0.7, 0.1, 0.2),\r\n                         'stratify': None,\r\n                         'text': {   'char_format': 'characters',\r\n                                     'char_most_common': 70,\r\n                                     'char_sequence_length_limit': 1024,\r\n                                     'fill_value': '',\r\n                                     'lowercase': True,\r\n                                     'missing_value_strategy': 'fill_with_const',\r\n                                     'padding': 'right',\r\n                                     'padding_symbol': '<PAD>',\r\n                                     'unknown_symbol': '<UNK>',\r\n                                     'word_format': 'space_punct',\r\n                                     'word_most_common': 20000,\r\n                                     'word_sequence_length_limit': 256},\r\n                         'timeseries': {   'fill_value': '',\r\n                                           'format': 'space',\r\n                                           'missing_value_strategy': 'fill_with_const',\r\n                                           'padding': 'right',\r\n                                           'padding_value': 0,\r\n                                           'timeseries_length_limit': 256}},\r\n    'training': {   'batch_size': 128,\r\n                    'bucketing_field': None,\r\n                    'decay': False,\r\n                    'decay_rate': 0.96,\r\n                    'decay_steps': 10000,\r\n                    'dropout_rate': 0.0,\r\n                    'early_stop': 5,\r\n                    'epochs': 100,\r\n                    'eval_batch_size': 0,\r\n                    'gradient_clipping': None,\r\n                    'increase_batch_size_on_plateau': 0,\r\n                    'increase_batch_size_on_plateau_max': 512,\r\n                    'increase_batch_size_on_plateau_patience': 5,\r\n                    'increase_batch_size_on_plateau_rate': 2,\r\n                    'learning_rate': 0.001,\r\n                    'learning_rate_warmup_epochs': 5,\r\n                    'optimizer': {   'beta1': 0.9,\r\n                                     'beta2': 0.999,\r\n                                     'epsilon': 1e-08,\r\n                                     'type': 'adam'},\r\n                    'reduce_learning_rate_on_plateau': 0,\r\n                    'reduce_learning_rate_on_plateau_patience': 5,\r\n                    'reduce_learning_rate_on_plateau_rate': 0.5,\r\n                    'regularization_lambda': 0,\r\n                    'regularizer': 'l2',\r\n                    'staircase': False,\r\n                    'validation_field': 'combined',\r\n                    'validation_measure': 'loss'}}\r\n\r\n\r\nUsing full raw csv, no hdf5 and json file with the same name have been found\r\nBuilding dataset (it may take a while)\r\nLoading NLP pipeline\r\n/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/features/numerical_feature.py:63: FutureWarning: Method .as_matrix will be removed in a future version. Use .values instead.\r\nWriting dataset\r\nWriting train set metadata with vocabulary\r\nTraining set: 22220\r\nValidation set: 3125\r\nTest set: 6308\r\n  embedding_size (50) is greater than vocab_size (2). Setting embedding size to be equal to vocab_size.\r\n  embedding_size (50) is greater than vocab_size (2). Setting embedding size to be equal to vocab_size.\r\n  embedding_size (50) is greater than vocab_size (9). Setting embedding size to be equal to vocab_size.\r\n\r\n╒══════════╕\r\n│ TRAINING │\r\n╘══════════╛\r\n\r\n2019-03-12 00:00:50.143030: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n\r\nEpoch   1\r\nTraining:   0%|                                                                                                                                                                             | 0/174 [00:00<?, ?it/s]Traceback (most recent call last):\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1334, in _do_call\r\n    return fn(*args)\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1319, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1407, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'ID/ID_placeholder' with dtype float and shape [?]\r\n\t [[{{node ID/ID_placeholder}} = Placeholder[dtype=DT_FLOAT, shape=[?], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/bin/ludwig\", line 11, in <module>\r\n    load_entry_point('ludwig==0.1.0', 'console_scripts', 'ludwig')()\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/cli.py\", line 86, in main\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/cli.py\", line 64, in __init__\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/cli.py\", line 70, in train\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/train.py\", line 729, in cli\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/train.py\", line 272, in full_train\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/train.py\", line 426, in train\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/models/model.py\", line 520, in train\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 929, in run\r\n    run_metadata_ptr)\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1152, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1328, in _do_run\r\n    run_metadata)\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1348, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'ID/ID_placeholder' with dtype float and shape [?]\r\n\t [[node ID/ID_placeholder (defined at /home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/features/numerical_feature.py:79)  = Placeholder[dtype=DT_FLOAT, shape=[?], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n\r\nCaused by op 'ID/ID_placeholder', defined at:\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/bin/ludwig\", line 11, in <module>\r\n    load_entry_point('ludwig==0.1.0', 'console_scripts', 'ludwig')()\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/cli.py\", line 86, in main\r\n    CLI()\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/cli.py\", line 64, in __init__\r\n    getattr(self, args.command)()\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/cli.py\", line 70, in train\r\n    train.cli(sys.argv[2:])\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/train.py\", line 729, in cli\r\n    full_train(**vars(args))\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/train.py\", line 272, in full_train\r\n    debug=debug\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/train.py\", line 409, in train\r\n    debug=debug\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/models/model.py\", line 110, in __init__\r\n    **kwargs\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/models/model.py\", line 160, in __build\r\n    is_training=self.is_training\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/models/inputs.py\", line 39, in build_inputs\r\n    **kwargs)\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/models/inputs.py\", line 66, in build_single_input\r\n    **kwargs)\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/features/numerical_feature.py\", line 89, in build_input\r\n    placeholder = self._get_input_placeholder()\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/features/numerical_feature.py\", line 79, in _get_input_placeholder\r\n    name='{}_placeholder'.format(self.name)\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py\", line 1747, in placeholder\r\n    return gen_array_ops.placeholder(dtype=dtype, shape=shape, name=name)\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/tensorflow/python/ops/gen_array_ops.py\", line 5206, in placeholder\r\n    \"Placeholder\", dtype=dtype, shape=shape, name=name)\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 488, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3274, in create_op\r\n    op_def=op_def)\r\n  File \"/home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1770, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nInvalidArgumentError (see above for traceback): You must feed a value for placeholder tensor 'ID/ID_placeholder' with dtype float and shape [?]\r\n\t [[node ID/ID_placeholder (defined at /home/quadro/Desktop/Work/contest/ludwig/venv/lib/python3.6/site-packages/ludwig-0.1.0-py3.6.egg/ludwig/features/numerical_feature.py:79)  = Placeholder[dtype=DT_FLOAT, shape=[?], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n\r\n\r\n```\r\n\r\nIncase you want to know my model.yaml config, it is like this:\r\n\r\n```\r\ninput_features:\r\n    -\r\n        name: ID\r\n        type: numerical\r\n    -\r\n        name: UsageClass\r\n        type: category\r\n    -\r\n        name: CheckoutType\r\n        type: category\r\n    -\r\n        name: CheckoutYear\r\n        type: numerical\r\n    -\r\n        name: CheckoutMonth\r\n        type: numerical\r\n    -\r\n        name: Checkouts\r\n        type: numerical\r\n    -\r\n        name: Title\r\n        type: text\r\n    -\r\n        name: Creator\r\n        type: text\r\n    -\r\n        name: Subjects\r\n        type: category\r\n    -\r\n        name: Publisher\r\n        type: text\r\n    -\r\n        name: PublicationYear\r\n        type: text\r\n    -\r\n        name: MaterialType\r\n        type: category\r\n\r\noutput_features:\r\n    -\r\n        name: ID\r\n        type: numerical\r\n    -\r\n        name: MaterialType\r\n        type: category\r\n\r\n```","closed_by":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/199/timeline","performed_via_github_app":null,"state_reason":"completed"}