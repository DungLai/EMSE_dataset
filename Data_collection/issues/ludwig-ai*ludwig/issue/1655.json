{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1655","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1655/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1655/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1655/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/1655","id":1095926694,"node_id":"I_kwDOCbx2hs5BUoOm","number":1655,"title":"Formalize LudwigModule inputs and outputs.","user":{"login":"justinxzhao","id":3459541,"node_id":"MDQ6VXNlcjM0NTk1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/3459541?v=4","gravatar_id":"","url":"https://api.github.com/users/justinxzhao","html_url":"https://github.com/justinxzhao","followers_url":"https://api.github.com/users/justinxzhao/followers","following_url":"https://api.github.com/users/justinxzhao/following{/other_user}","gists_url":"https://api.github.com/users/justinxzhao/gists{/gist_id}","starred_url":"https://api.github.com/users/justinxzhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinxzhao/subscriptions","organizations_url":"https://api.github.com/users/justinxzhao/orgs","repos_url":"https://api.github.com/users/justinxzhao/repos","events_url":"https://api.github.com/users/justinxzhao/events{/privacy}","received_events_url":"https://api.github.com/users/justinxzhao/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":{"login":"justinxzhao","id":3459541,"node_id":"MDQ6VXNlcjM0NTk1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/3459541?v=4","gravatar_id":"","url":"https://api.github.com/users/justinxzhao","html_url":"https://github.com/justinxzhao","followers_url":"https://api.github.com/users/justinxzhao/followers","following_url":"https://api.github.com/users/justinxzhao/following{/other_user}","gists_url":"https://api.github.com/users/justinxzhao/gists{/gist_id}","starred_url":"https://api.github.com/users/justinxzhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinxzhao/subscriptions","organizations_url":"https://api.github.com/users/justinxzhao/orgs","repos_url":"https://api.github.com/users/justinxzhao/repos","events_url":"https://api.github.com/users/justinxzhao/events{/privacy}","received_events_url":"https://api.github.com/users/justinxzhao/received_events","type":"User","site_admin":false},"assignees":[{"login":"justinxzhao","id":3459541,"node_id":"MDQ6VXNlcjM0NTk1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/3459541?v=4","gravatar_id":"","url":"https://api.github.com/users/justinxzhao","html_url":"https://github.com/justinxzhao","followers_url":"https://api.github.com/users/justinxzhao/followers","following_url":"https://api.github.com/users/justinxzhao/following{/other_user}","gists_url":"https://api.github.com/users/justinxzhao/gists{/gist_id}","starred_url":"https://api.github.com/users/justinxzhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinxzhao/subscriptions","organizations_url":"https://api.github.com/users/justinxzhao/orgs","repos_url":"https://api.github.com/users/justinxzhao/repos","events_url":"https://api.github.com/users/justinxzhao/events{/privacy}","received_events_url":"https://api.github.com/users/justinxzhao/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-01-07T02:41:34Z","updated_at":"2022-01-11T01:32:42Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"Torchscript compilation requires all properties of all classes to be defined. This means that all LudwigModules must have input shape and output shapes. However, input and output shapes doesn't make sense for certain LudwigModules, like Decoders or ECD, which use dictionaries of tensors as input/output.\r\n\r\nProposal: Broaden the scope of input_shape and output_shape to include multi-tensor inputs and outputs by formalizing dictionary inputs/outputs in the form of named tuples, and then refer to those named tuples when defining the input_shape and output_shape properties of LudwigModules that have multi-tensor inputs or outputs.\r\n\r\nPurely computational ludwig modules should be downgraded to nn.Modules, and modules that accept single tensor inputs should remain the same.\r\n\r\nHere's one possible design:\r\n\r\n```\r\nModuleShape:\r\n- torch.Size([]) # No batch, all other dimensions\r\n\r\nEncoderInputShape/InputFeatureInputShape:\r\n- “encoder_input”: ModuleShape\r\n\r\nEncoderOutputShape:\r\n- “encoder_output”\r\n- “encoder_output_state”\r\n- ...\r\n\r\nInputFeatureOutputShape\r\n- EncoderOutputShape\r\n- \"lengths\"\r\n\r\nCombinerInputShape:\r\n- EncoderOutputShape[]\r\n\r\nCombinerOutputShape\r\n- EncoderOutputShape[]\r\n- \"combiner_output\"\r\n\r\nDecoderInput:\r\n- CombinerOutputShape\r\n- DecoderOutput[]\r\n\r\nDecoderOutput:\r\n- \"decoder_output\"\r\n- \"logits\"\r\n- \"probabilities\"\r\n- ...\r\n\r\nOutputFeatureOutput:\r\n- \"last_hidden\"\r\n- DecoderOutput\r\n\r\nOutputFeatureInput:\r\n- DecoderInput\r\n\r\nECDInputShape:\r\n- dictionary of EncoderInputShape\r\n\r\nECDOutputShape:\r\n- dictionary of DecoderOutputShape\r\n```","closed_by":null,"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1655/timeline","performed_via_github_app":null,"state_reason":null}