{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1802","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1802/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1802/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1802/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/1802","id":1165340592,"node_id":"I_kwDOCbx2hs5Fda-w","number":1802,"title":"Problem logging an experiment to wandb","user":{"login":"danielduckworth","id":18698360,"node_id":"MDQ6VXNlcjE4Njk4MzYw","avatar_url":"https://avatars.githubusercontent.com/u/18698360?v=4","gravatar_id":"","url":"https://api.github.com/users/danielduckworth","html_url":"https://github.com/danielduckworth","followers_url":"https://api.github.com/users/danielduckworth/followers","following_url":"https://api.github.com/users/danielduckworth/following{/other_user}","gists_url":"https://api.github.com/users/danielduckworth/gists{/gist_id}","starred_url":"https://api.github.com/users/danielduckworth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielduckworth/subscriptions","organizations_url":"https://api.github.com/users/danielduckworth/orgs","repos_url":"https://api.github.com/users/danielduckworth/repos","events_url":"https://api.github.com/users/danielduckworth/events{/privacy}","received_events_url":"https://api.github.com/users/danielduckworth/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2022-03-10T15:02:34Z","updated_at":"2022-03-22T02:12:43Z","closed_at":"2022-03-21T02:32:09Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nLogging a training run works fine, however when logging an experiment run (the evaluation part) with the default parameters, there is a OSError 22 relating to \"probabilities_<UNK>.csv\"\r\n\r\n`OSError: [Errno 22] Invalid argument: '/results/classification_Distilbert_2/label_probabilities_<UNK>.csv`\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n\r\n1. Run an experiment from the CLI with default parameters.\r\n2. Configure the model for text classification.\r\n3. Add the wandb flag\r\n\r\n**Model config**\r\n\r\n```\r\npreprocessing:\r\n    text:\r\n        word_tokenizer: hf_tokenizer\r\n\r\ninput_features:\r\n    -\r\n        name: feature1\r\n        type: text\r\n        level: word\r\n        encoder: distilbert\r\n        pretrained_model_name_or_path: distilbert-base-uncased\r\n    -\r\n        name: feature2\r\n        type: text\r\n        level: word\r\n        encoder: distilbert\r\n        pretrained_model_name_or_path: distilbert-base-uncased\r\n        tied_weights: feature1\r\n    -\r\n        name: feature3\r\n        type: category\r\n\r\noutput_features:\r\n    -\r\n        name: label\r\n        top_k: 5\r\n        type: category\r\n\r\ntraining:\r\n    epochs: 3\r\n    batch_size: 16\r\n    learning_rate: 0.000005\r\n```\r\n\r\n**wandb metadata**\r\n\r\n```\r\n{\r\n    \"os\": \"Windows-10-10.0.19041-SP0\",\r\n    \"python\": \"3.9.0\",\r\n    \"heartbeatAt\": \"2022-03-10T14:21:23.463980\",\r\n    \"startedAt\": \"2022-03-10T14:21:17.632459\",\r\n    \"docker\": null,\r\n    \"gpu\": \"NVIDIA GeForce RTX 2070\",\r\n    \"gpu_count\": 1,\r\n    \"cpu_count\": 6,\r\n    \"cuda\": null,\r\n    \"args\": [\r\n        \"experiment\",\r\n        \"--output_directory\",\r\n        \"results\",\r\n        \"--experiment_name\",\r\n        \"classification\",\r\n        \"--model_name\",\r\n        \"Distilbert\",\r\n        \"--training_set\",\r\n        \"TRAIN_en.arrow\",\r\n        \"--validation_set\",\r\n        \"VAL_en.arrow\",\r\n        \"--test_set\",\r\n        \"EVAL_en.arrow\",\r\n        \"--data_format\",\r\n        \"feather\",\r\n        \"--config_file\",\r\n        \"model1.yaml\",\r\n        \"--wandb\"\r\n    ],\r\n    \"state\": \"running\",\r\n    \"program\": \"-m __main__\",\r\n    \"executable\": \"I:\\\\Anaconda\\\\envs\\\\ludwig\\\\python.exe\"\r\n}\r\n```\r\n\r\n**Expected behavior**\r\nThe csv file for the UNK token should be created.\r\n\r\n\r\n**Environment**\r\n\r\n- OS: Windows-10-10.0.19041-SP0\r\n- Python version: 3.9\r\n- Ludwig version: 0.4.1\r\n\r\n**Additional context**\r\nThe problem can be avoided with the ludwig API and passing the parameter skip_save_predictions=True (not possible with the CLI).\r\n","closed_by":{"login":"danielduckworth","id":18698360,"node_id":"MDQ6VXNlcjE4Njk4MzYw","avatar_url":"https://avatars.githubusercontent.com/u/18698360?v=4","gravatar_id":"","url":"https://api.github.com/users/danielduckworth","html_url":"https://github.com/danielduckworth","followers_url":"https://api.github.com/users/danielduckworth/followers","following_url":"https://api.github.com/users/danielduckworth/following{/other_user}","gists_url":"https://api.github.com/users/danielduckworth/gists{/gist_id}","starred_url":"https://api.github.com/users/danielduckworth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielduckworth/subscriptions","organizations_url":"https://api.github.com/users/danielduckworth/orgs","repos_url":"https://api.github.com/users/danielduckworth/repos","events_url":"https://api.github.com/users/danielduckworth/events{/privacy}","received_events_url":"https://api.github.com/users/danielduckworth/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1802/timeline","performed_via_github_app":null,"state_reason":"completed"}