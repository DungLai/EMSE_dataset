{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2168","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2168/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2168/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2168/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/2168","id":1277896568,"node_id":"I_kwDOCbx2hs5MKyd4","number":2168,"title":"[Hyperopt] Config is merged with defaults twice unnecessarily","user":{"login":"arnavgarg1","id":106701836,"node_id":"U_kgDOBlwkDA","avatar_url":"https://avatars.githubusercontent.com/u/106701836?v=4","gravatar_id":"","url":"https://api.github.com/users/arnavgarg1","html_url":"https://github.com/arnavgarg1","followers_url":"https://api.github.com/users/arnavgarg1/followers","following_url":"https://api.github.com/users/arnavgarg1/following{/other_user}","gists_url":"https://api.github.com/users/arnavgarg1/gists{/gist_id}","starred_url":"https://api.github.com/users/arnavgarg1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arnavgarg1/subscriptions","organizations_url":"https://api.github.com/users/arnavgarg1/orgs","repos_url":"https://api.github.com/users/arnavgarg1/repos","events_url":"https://api.github.com/users/arnavgarg1/events{/privacy}","received_events_url":"https://api.github.com/users/arnavgarg1/received_events","type":"User","site_admin":false},"labels":[{"id":4032822844,"node_id":"LA_kwDOCbx2hs7wX_48","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/productivity%20and%20code%20quality","name":"productivity and code quality","color":"bfd4f2","default":false,"description":"Engineer productivity, maintainability, consistency, readability"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-06-21T05:01:37Z","updated_at":"2022-06-26T05:05:28Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"In the current hyperopt implementation, we call the `merge_with_defaults()` function to update the user-defined config. However, in our implementation, we unnecessarily do this twice.\r\n\r\n1. The first time this function is called is within the `run()` function within `hyperopt > run.py > hyperopt()`, where the input config passed in from `hyperopt_cli.py` is merged with any missing defaults. Some simple validation logic is also applied to check that some of the config parameters make sense.\r\n\r\n2. The second time this function is called is in the `run_experiment()` function that is called by `_run_experiment()` to actually train and evaluate each individual hyperopt trial. In this function, we create a `LudwigModel`, and in the constructor of the Ludwig model, we once again call `merge_with_defaults()` followed by a `validation_check()`. At this point, we've already merged and updated with defaults for each trial distinctly, but it is still important that we keep the validation check since the config is updated with new parameters from the hyperopt sampler.\r\n\r\nThe ideal fix here would be to remove one of the calls to `merge_with_defaults()` so as to only go through this loop once, and only keep one of the validation checks - ideally the one in the LudwigModel constructor. ","closed_by":null,"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2168/timeline","performed_via_github_app":null,"state_reason":null}