{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/660","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/660/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/660/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/660/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/660","id":585287472,"node_id":"MDU6SXNzdWU1ODUyODc0NzI=","number":660,"title":"Wrong tensorflow version","user":{"login":"pranavjha24","id":61943097,"node_id":"MDQ6VXNlcjYxOTQzMDk3","avatar_url":"https://avatars.githubusercontent.com/u/61943097?v=4","gravatar_id":"","url":"https://api.github.com/users/pranavjha24","html_url":"https://github.com/pranavjha24","followers_url":"https://api.github.com/users/pranavjha24/followers","following_url":"https://api.github.com/users/pranavjha24/following{/other_user}","gists_url":"https://api.github.com/users/pranavjha24/gists{/gist_id}","starred_url":"https://api.github.com/users/pranavjha24/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pranavjha24/subscriptions","organizations_url":"https://api.github.com/users/pranavjha24/orgs","repos_url":"https://api.github.com/users/pranavjha24/repos","events_url":"https://api.github.com/users/pranavjha24/events{/privacy}","received_events_url":"https://api.github.com/users/pranavjha24/received_events","type":"User","site_admin":false},"labels":[{"id":1174068775,"node_id":"MDU6TGFiZWwxMTc0MDY4Nzc1","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/waiting%20for%20answer","name":"waiting for answer","color":"fff36b","default":false,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2020-03-20T19:37:28Z","updated_at":"2020-03-21T01:10:23Z","closed_at":"2020-03-21T01:07:25Z","author_association":"NONE","active_lock_reason":null,"body":"The detailed descriptions are\r\n\r\nUsing TensorFlow backend.\r\n```\r\nTraceback (most recent call last):\r\n  File \"/Users/Pranav/Downloads/DL-hybrid-precoder-master/main_train_beamforming.py\", line 7, in <module>\r\n    from keras import back\r\nImportError: cannot import name 'back' from 'keras' (/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/keras/__init__.py)\r\n\r\nProcess finished with exit code 1\r\n```\r\n\r\nabsl-py | 0.9.0 |  \r\n-- | -- | --\r\narviz | 0.7.0 |  \r\nastor | 0.8.1 |  \r\nbackend | 0.2.4.1 |  \r\nca-certificates | 2020.1.1 |  \r\ncachetools | 4.0.0 |  \r\ncertifi | 2019.11.28 |  \r\ncftime | 1.1.1.1 |  \r\nchardet | 3.0.4 |  \r\nclick | 7.1.1 |  \r\ncycler | 0.10.0 |  \r\ndash | 1.9.1 |  \r\ndash-core-components | 1.8.1 |  \r\ndash-html-components | 1.0.2 |  \r\ndash-renderer | 1.2.4 |  \r\ndash-table | 4.6.1 |  \r\ndecorator | 4.4.2 |  \r\nflask | 1.1.1 |  \r\nflask-compress | 1.4.0 |  \r\nfuture | 0.18.2 |  \r\ngast | 0.2.2 |  \r\ngoogle-auth | 1.11.3 |  \r\ngoogle-auth-oauthlib | 0.4.1 |  \r\ngoogle-pasta | 0.2.0 |  \r\ngrpcio | 1.27.2 |  \r\nh5py | 2.10.0 |  \r\nidna | 2.9 |  \r\nimageio | 2.5.0 |  \r\nimgaug | 0.2.9 |  \r\nitsdangerous | 1.1.0 |  \r\njinja2 | 2.11.1 |  \r\njoblib | 0.14.1 |  \r\nkeras | 2.3.1 |  \r\nkeras-applications | 1.0.8 |  \r\nkeras-preprocessing | 1.1.0 |  \r\nkeras-segmentation | 0.3.0 |  \r\nkiwisolver | 1.1.0 |  \r\nlibcxx | 4.0.1 |  \r\nlibcxxabi | 4.0.1 |  \r\nlibedit | 3.1.20181209 |  \r\nlibffi | 3.2.1 |  \r\nmarkdown | 3.2.1 |  \r\nmarkupsafe | 1.1.1 |  \r\nmatplotlib | 3.2.1 |  \r\nncurses | 6.2 |  \r\nnetcdf4 | 1.5.3 |  \r\nnetworkx | 2.4 |  \r\nnumpy | 1.18.2 |  \r\noauthlib | 3.1.0 |  \r\nopencv-python | 4.2.0.32 |  \r\nopenssl | 1.1.1e |  \r\nopt-einsum | 3.2.0 |  \r\npackaging | 20.3 |  \r\npandas | 1.0.3 |  \r\npatsy | 0.5.1 |  \r\npillow | 7.0.0 |  \r\npip | 20.0.2 |  \r\nplotly | 4.5.4 |  \r\nprotobuf | 3.11.3 |  \r\npyasn1 | 0.4.8 |  \r\npyasn1-modules | 0.2.8 |  \r\npymc3 | 3.8 |  \r\npyparsing | 2.4.6 |  \r\npython | 3.7.6 |  \r\npython-dateutil | 2.8.1 |  \r\npytz | 2019.3 |  \r\npywavelets | 1.1.1 |  \r\npyyaml | 5.3.1 |  \r\nreadline | 7.0 |  \r\nrequests | 2.23.0 |  \r\nrequests-oauthlib | 1.3.0 |  \r\nretrying | 1.3.3 |  \r\nrsa | 4.0 |  \r\nscikit-image | 0.16.2 |  \r\nscikit-learn | 0.22.2.post1 |  \r\nscipy | 1.4.1 |  \r\nsetuptools | 46.0.0 |  \r\nshapely | 1.7.0 |  \r\nsix | 1.14.0 |  \r\nsqlite | 3.31.1 |  \r\ntensorboard | 2.1.1 |  \r\ntensorflow | 2.1.0 |  \r\ntensorflow-estimator | 2.1.0 |  \r\ntermcolor | 1.1.0 |  \r\ntf | 1.0.0 |  \r\ntheano | 1.0.4 |  \r\ntk | 8.6.8 |  \r\ntqdm | 4.43.0 |  \r\nurllib3 | 1.25.8 |  \r\nwerkzeug | 1.0.0 |  \r\nwheel | 0.34.2 |  \r\nwrapt | 1.12.1 |  \r\nxarray | 0.15.0 |  \r\nxz | 5.2.4 |  \r\nzlib | 1.2.11 |  \r\n\r\nWhen I ran a second file:\r\n```\r\n2020-03-20 17:20:54.258405: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\r\nWARNING:tensorflow:From /Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nIf using Keras pass *_constraint arguments to layers.\r\nTraceback (most recent call last):\r\n  File \"/Users/Pranav/Downloads/mnist.py\", line 32, in <module>\r\n    predictions = new_model.predict([x_test])\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py\", line 1013, in predict\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 498, in predict\r\n    workers=workers, use_multiprocessing=use_multiprocessing, **kwargs)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 426, in _model_iteration\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 646, in _process_inputs\r\n    x, y, sample_weight=sample_weights)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py\", line 2346, in _standardize_user_data\r\n    all_inputs, y_input, dict_inputs = self._build_model_with_inputs(x, y)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py\", line 2572, in _build_model_with_inputs\r\n    self._set_inputs(cast_inputs)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py\", line 2647, in _set_inputs\r\n    inputs = self._set_input_attrs(inputs)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/training/tracking/base.py\", line 457, in _method_wrapper\r\n    result = method(self, *args, **kwargs)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py\", line 2686, in _set_input_attrs\r\n    input_shape = (None,) + tuple(inputs.shape[1:])\r\nAttributeError: 'list' object has no attribute 'shape'\r\n```\r\n\r\nThird file:\r\n```\r\n/Users/Pranav/opt/anaconda3/envs/Research_DL/bin/python /Users/Pranav/Downloads/Test/train.py\r\nloading data...\r\nloading complete\r\nThe shape of CSI is:  (10, 1, 64)\r\n2020-03-20 17:22:33.388225: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fc0ab981a00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2020-03-20 17:22:33.388250: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\nModel: \"model\"\r\n__________________________________________________________________________________________________\r\nLayer (type)                    Output Shape         Param #     Connected to                     \r\n==================================================================================================\r\nimperfect_CSI (InputLayer)      [(None, 1, 2, 64)]   0                                            \r\n__________________________________________________________________________________________________\r\nbatch_normalization (BatchNorma (None, 1, 2, 64)     256         imperfect_CSI[0][0]              \r\n__________________________________________________________________________________________________\r\nflatten (Flatten)               (None, 128)          0           batch_normalization[0][0]        \r\n__________________________________________________________________________________________________\r\nbatch_normalization_1 (BatchNor (None, 128)          512         flatten[0][0]                    \r\n__________________________________________________________________________________________________\r\ndense (Dense)                   (None, 256)          33024       batch_normalization_1[0][0]      \r\n__________________________________________________________________________________________________\r\nbatch_normalization_2 (BatchNor (None, 256)          1024        dense[0][0]                      \r\n__________________________________________________________________________________________________\r\ndense_1 (Dense)                 (None, 128)          32896       batch_normalization_2[0][0]      \r\n__________________________________________________________________________________________________\r\ndense_2 (Dense)                 (None, 64)           8256        dense_1[0][0]                    \r\n__________________________________________________________________________________________________\r\nperfect_CSI (InputLayer)        [(None, 64)]         0                                            \r\n__________________________________________________________________________________________________\r\nlambda (Lambda)                 (None, 64)           0           dense_2[0][0]                    \r\n__________________________________________________________________________________________________\r\nSNR_input (InputLayer)          [(None, 1)]          0                                            \r\n__________________________________________________________________________________________________\r\nlambda_1 (Lambda)               (64, 1)              0           perfect_CSI[0][0]                \r\n                                                                 lambda[0][0]                     \r\n                                                                 SNR_input[0][0]                  \r\n==================================================================================================\r\nTotal params: 75,968\r\nTrainable params: 75,072\r\nNon-trainable params: 896\r\n__________________________________________________________________________________________________\r\nTrain on 9 samples, validate on 1 samples\r\nEpoch 1/50000\r\n2020-03-20 17:22:35.197791: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort Invalid argument: Incompatible shapes: [9] vs. [64]\r\n\t [[{{node BroadcastGradientArgs_4}}]]\r\nWARNING:tensorflow:Reduce LR on plateau conditioned on metric `val_loss` which is not available. Available metrics are: lr\r\nWARNING:tensorflow:Can save best model only with val_loss available, skipping.\r\nTraceback (most recent call last):\r\n  File \"/Users/Pranav/Downloads/Test/train.py\", line 51, in <module>\r\n    epochs=50000, verbose=2, validation_split=0.1, callbacks=[reduce_lr, checkpoint])\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py\", line 819, in fit\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 342, in fit\r\n    total_epochs=epochs)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 128, in run_one_epoch\r\n    batch_outs = execution_function(iterator)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py\", line 98, in execution_function\r\n    distributed_function(input_fn))\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 568, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 632, in _call\r\n    return self._stateless_fn(*args, **kwds)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 2363, in __call__\r\n    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 1611, in _filtered_call\r\n    self.captured_inputs)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 1692, in _call_flat\r\n    ctx, args, cancellation_manager=cancellation_manager))\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 545, in call\r\n    ctx=ctx)\r\n  File \"/Users/Pranav/opt/anaconda3/envs/Research_DL/lib/python3.7/site-packages/tensorflow_core/python/eager/execute.py\", line 67, in quick_execute\r\n    six.raise_from(core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError:  Incompatible shapes: [9] vs. [64]\r\n\t [[node BroadcastGradientArgs_4 (defined at /Downloads/Test/train.py:51) ]] [Op:__inference_distributed_function_1717]\r\n\r\nFunction call stack:\r\ndistributed_function\r\n\r\n9/9 - 2s\r\n\r\nProcess finished with exit code 1\r\n```\r\n\r\nPlease help. Thanks.","closed_by":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/660/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/660/timeline","performed_via_github_app":null,"state_reason":"completed"}