{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/266","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/266/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/266/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/266/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/266","id":428317145,"node_id":"MDU6SXNzdWU0MjgzMTcxNDU=","number":266,"title":"training on images fails","user":{"login":"Felix-N","id":1209409,"node_id":"MDQ6VXNlcjEyMDk0MDk=","avatar_url":"https://avatars.githubusercontent.com/u/1209409?v=4","gravatar_id":"","url":"https://api.github.com/users/Felix-N","html_url":"https://github.com/Felix-N","followers_url":"https://api.github.com/users/Felix-N/followers","following_url":"https://api.github.com/users/Felix-N/following{/other_user}","gists_url":"https://api.github.com/users/Felix-N/gists{/gist_id}","starred_url":"https://api.github.com/users/Felix-N/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Felix-N/subscriptions","organizations_url":"https://api.github.com/users/Felix-N/orgs","repos_url":"https://api.github.com/users/Felix-N/repos","events_url":"https://api.github.com/users/Felix-N/events{/privacy}","received_events_url":"https://api.github.com/users/Felix-N/received_events","type":"User","site_admin":false},"labels":[{"id":1174068775,"node_id":"MDU6TGFiZWwxMTc0MDY4Nzc1","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/waiting%20for%20answer","name":"waiting for answer","color":"fff36b","default":false,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2019-04-02T16:08:39Z","updated_at":"2019-04-03T20:21:07Z","closed_at":"2019-04-03T20:21:07Z","author_association":"NONE","active_lock_reason":null,"body":"I'm trying to do a simple image classification using ludwig running on windows 10.\r\n\r\nHowever when starting the ludwig experiment I'm getting the following output:\r\n\r\n> ╒══════════╕\r\n> │ TRAINING │\r\n> ╘══════════╛\r\n> \r\n> 2019-04-02 18:03:45.110161: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2\r\n> 2019-04-02 18:03:45.282447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties:\r\n> name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.635\r\n> pciBusID: 0000:01:00.0\r\n> totalMemory: 11.00GiB freeMemory: 9.03GiB\r\n> 2019-04-02 18:03:45.287903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0\r\n> 2019-04-02 18:03:45.687938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n> 2019-04-02 18:03:45.691258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0\r\n> 2019-04-02 18:03:45.693117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N\r\n> 2019-04-02 18:03:45.695118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8698 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5)\r\n> \r\n> Epoch   1\r\n> Training:   0%|                                                                                                                                                                                                                                                            | 0/1 [00:00<?, ?it/s]2019-04-02 18:03:47.229482: I tensorflow/stream_executor/dso_loader.cc:152] successfully opened CUDA library cublas64_100.dll locally\r\n> 2019-04-02 18:03:47.476850: E tensorflow/stream_executor/cuda/cuda_blas.cc:510] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n> 2019-04-02 18:03:47.479920: E tensorflow/stream_executor/cuda/cuda_blas.cc:510] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n> 2019-04-02 18:03:47.483445: E tensorflow/stream_executor/cuda/cuda_blas.cc:510] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n> 2019-04-02 18:03:47.489994: E tensorflow/stream_executor/cuda/cuda_blas.cc:510] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n> 2019-04-02 18:03:47.492981: E tensorflow/stream_executor/cuda/cuda_blas.cc:510] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n> 2019-04-02 18:03:47.495837: E tensorflow/stream_executor/cuda/cuda_blas.cc:510] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n> 2019-04-02 18:03:48.578870: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_ALLOC_FAILED\r\n> 2019-04-02 18:03:48.582129: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_ALLOC_FAILED\r\n> Traceback (most recent call last):\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1334, in _do_call\r\n>     return fn(*args)\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1319, in _run_fn\r\n>     options, feed_dict, fetch_list, target_list, run_metadata)\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1407, in _call_tf_sessionrun\r\n>     run_metadata)\r\n> tensorflow.python.framework.errors_impl.UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n>          [[{{node image_path/conv_0/Conv2D}}]]\r\n>          [[{{node class/loss_class/train_mean_loss_class}}]]\r\n> \r\n> During handling of the above exception, another exception occurred:\r\n> \r\n> Traceback (most recent call last):\r\n>   File \"c:\\development\\anaconda3\\lib\\runpy.py\", line 193, in _run_module_as_main\r\n>     \"__main__\", mod_spec)\r\n>   File \"c:\\development\\anaconda3\\lib\\runpy.py\", line 85, in _run_code\r\n>     exec(code, run_globals)\r\n>   File \"C:\\Development\\Anaconda3\\Scripts\\ludwig.exe\\__main__.py\", line 9, in <module>\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\cli.py\", line 86, in main\r\n>     CLI()\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\cli.py\", line 64, in __init__\r\n>     getattr(self, args.command)()\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\cli.py\", line 67, in experiment\r\n>     experiment.cli(sys.argv[2:])\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\experiment.py\", line 548, in cli\r\n>     experiment(**vars(args))\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\experiment.py\", line 258, in experiment\r\n>     debug=debug\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\train.py\", line 383, in train\r\n>     **model_definition['training']\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\models\\model.py\", line 488, in train\r\n>     is_training=True\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 929, in run\r\n>     run_metadata_ptr)\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1152, in _run\r\n>     feed_dict_tensor, options, run_metadata)\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1328, in _do_run\r\n>     run_metadata)\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1348, in _do_call\r\n>     raise type(e)(node_def, op, message)\r\n> tensorflow.python.framework.errors_impl.UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n>          [[node image_path/conv_0/Conv2D (defined at c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\models\\modules\\convolutional_modules.py:54) ]]\r\n>          [[node class/loss_class/train_mean_loss_class (defined at c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\features\\category_feature.py:371) ]]\r\n> \r\n> Caused by op 'image_path/conv_0/Conv2D', defined at:\r\n>   File \"c:\\development\\anaconda3\\lib\\runpy.py\", line 193, in _run_module_as_main\r\n>     \"__main__\", mod_spec)\r\n>   File \"c:\\development\\anaconda3\\lib\\runpy.py\", line 85, in _run_code\r\n>     exec(code, run_globals)\r\n>   File \"C:\\Development\\Anaconda3\\Scripts\\ludwig.exe\\__main__.py\", line 9, in <module>\r\n>     sys.exit(main())\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\cli.py\", line 86, in main\r\n>     CLI()\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\cli.py\", line 64, in __init__\r\n>     getattr(self, args.command)()\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\cli.py\", line 67, in experiment\r\n>     experiment.cli(sys.argv[2:])\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\experiment.py\", line 548, in cli\r\n>     experiment(**vars(args))\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\experiment.py\", line 258, in experiment\r\n>     debug=debug\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\train.py\", line 368, in train\r\n>     debug=debug\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\models\\model.py\", line 110, in __init__\r\n>     **kwargs\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\models\\model.py\", line 160, in __build\r\n>     is_training=self.is_training\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\models\\inputs.py\", line 39, in build_inputs\r\n>     **kwargs)\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\models\\inputs.py\", line 66, in build_single_input\r\n>     **kwargs)\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\features\\image_feature.py\", line 180, in build_input\r\n>     is_training,\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\models\\modules\\image_encoders.py\", line 79, in __call__\r\n>     is_training=is_training\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\models\\modules\\convolutional_modules.py\", line 565, in __call__\r\n>     is_training=is_training)\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\models\\modules\\convolutional_modules.py\", line 147, in conv_2d_layer\r\n>     dimensions=2, is_training=is_training)\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\models\\modules\\convolutional_modules.py\", line 121, in conv_layer\r\n>     is_training=is_training)\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\models\\modules\\convolutional_modules.py\", line 54, in conv_2d\r\n>     padding=padding) + biases\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_nn_ops.py\", line 1026, in conv2d\r\n>     data_format=data_format, dilations=dilations, name=name)\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 788, in _apply_op_helper\r\n>     op_def=op_def)\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\tensorflow\\python\\util\\deprecation.py\", line 507, in new_func\r\n>     return func(*args, **kwargs)\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3300, in create_op\r\n>     op_def=op_def)\r\n>   File \"c:\\development\\anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1801, in __init__\r\n>     self._traceback = tf_stack.extract_stack()\r\n> \r\n> UnknownError (see above for traceback): Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n>          [[node image_path/conv_0/Conv2D (defined at c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\models\\modules\\convolutional_modules.py:54) ]]\r\n>          [[node class/loss_class/train_mean_loss_class (defined at c:\\development\\anaconda3\\lib\\site-packages\\ludwig\\features\\category_feature.py:371) ]]\r\n\r\ncuDNN seems to be installed if i can trust this:\r\n\r\n> conda list cudnn\r\n> packages in environment at C:\\Development\\Anaconda3:\r\n> Name                    Version                   Build  Channel\r\n> cudnn                     7.3.1                cuda10.0_0\r\n\r\nany clue whats wrong?","closed_by":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/266/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/266/timeline","performed_via_github_app":null,"state_reason":"completed"}