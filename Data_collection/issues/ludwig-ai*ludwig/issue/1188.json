{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1188","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1188/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1188/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1188/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/1188","id":906597629,"node_id":"MDU6SXNzdWU5MDY1OTc2Mjk=","number":1188,"title":"How to provide class weights for an imbalanced datasets?","user":{"login":"farazk86","id":33456896,"node_id":"MDQ6VXNlcjMzNDU2ODk2","avatar_url":"https://avatars.githubusercontent.com/u/33456896?v=4","gravatar_id":"","url":"https://api.github.com/users/farazk86","html_url":"https://github.com/farazk86","followers_url":"https://api.github.com/users/farazk86/followers","following_url":"https://api.github.com/users/farazk86/following{/other_user}","gists_url":"https://api.github.com/users/farazk86/gists{/gist_id}","starred_url":"https://api.github.com/users/farazk86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farazk86/subscriptions","organizations_url":"https://api.github.com/users/farazk86/orgs","repos_url":"https://api.github.com/users/farazk86/repos","events_url":"https://api.github.com/users/farazk86/events{/privacy}","received_events_url":"https://api.github.com/users/farazk86/received_events","type":"User","site_admin":false},"labels":[{"id":1332772629,"node_id":"MDU6TGFiZWwxMzMyNzcyNjI5","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/discussion","name":"discussion","color":"008500","default":false,"description":"Open discussion"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2021-05-30T01:21:37Z","updated_at":"2022-07-28T20:49:24Z","closed_at":"2022-07-28T20:49:24Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\r\n\r\nI have a fairly imbalanced dataset. I am using this to learn a feature and am replying on dependency learning to get better results, i.e. [as explained here](https://ludwig-ai.github.io/ludwig-docs/user_guide/#output-features-dependencies), I have a coarse feature, who identification helps in identifying a fine feature. \r\n\r\nBelow is my model configuration for the above goal:\r\n```yaml\r\ninput_features:\r\n    -\r\n        name: nhl\r\n        type: sequence\r\n        encoder: rnn\r\n        cell_type: lstm\r\n        num_layers: 4\r\n        reduce_output: null\r\n\r\noutput_features:\r\n    -\r\n        name: mode\r\n        type: category\r\n        num_fc_layers: 2\r\n    -\r\n        name: volpiano\r\n        type: sequence\r\n        decoder: generator\r\n        cell_type: lstm\r\n        attention: bahdanau\r\n        num_fc_layers: 1\r\n        dependencies:\r\n            - mode\r\n        loss:\r\n            type: sampled_softmax_cross_entropy\r\n```\r\n\r\nThe problem is (or at least in my opinion) that the ``mode`` output on which the ``volpiano`` output depends is very imabalanced. Below is the distribution of this feature:\r\n\r\n![image_2021-05-30_021653](https://user-images.githubusercontent.com/33456896/120088885-19595880-c0ed-11eb-993d-5162c3c2d11f.png)\r\n\r\nAs can be seen mode ``8, 1 and 7`` are much better represented than the other categories in the dataset.\r\n\r\nIs there any way to perform weighted learning to reduce this class imbalance? I found this issue discussing this as well: https://github.com/ludwig-ai/ludwig/issues/615 and know that I can use ``class_weights`` to achieve this.. but am not very use how to do this?\r\n\r\nHow do I find the ``class_weights`` values? and if I have this many classes, how can I be sure which weight to associate with which? I mean if I write: ``class_wrights: [8, 7, 6, 6, 3, ....]`` how can I be sure which weight is associated with which label?\r\n\r\nThanks","closed_by":{"login":"connor-mccorm","id":97468934,"node_id":"U_kgDOBc9CBg","avatar_url":"https://avatars.githubusercontent.com/u/97468934?v=4","gravatar_id":"","url":"https://api.github.com/users/connor-mccorm","html_url":"https://github.com/connor-mccorm","followers_url":"https://api.github.com/users/connor-mccorm/followers","following_url":"https://api.github.com/users/connor-mccorm/following{/other_user}","gists_url":"https://api.github.com/users/connor-mccorm/gists{/gist_id}","starred_url":"https://api.github.com/users/connor-mccorm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/connor-mccorm/subscriptions","organizations_url":"https://api.github.com/users/connor-mccorm/orgs","repos_url":"https://api.github.com/users/connor-mccorm/repos","events_url":"https://api.github.com/users/connor-mccorm/events{/privacy}","received_events_url":"https://api.github.com/users/connor-mccorm/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1188/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1188/timeline","performed_via_github_app":null,"state_reason":"completed"}