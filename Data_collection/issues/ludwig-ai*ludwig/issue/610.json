{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/610","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/610/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/610/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/610/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/610","id":548274563,"node_id":"MDU6SXNzdWU1NDgyNzQ1NjM=","number":610,"title":"Deadlock with some datasets","user":{"login":"mangleddata","id":57873718,"node_id":"MDQ6VXNlcjU3ODczNzE4","avatar_url":"https://avatars.githubusercontent.com/u/57873718?v=4","gravatar_id":"","url":"https://api.github.com/users/mangleddata","html_url":"https://github.com/mangleddata","followers_url":"https://api.github.com/users/mangleddata/followers","following_url":"https://api.github.com/users/mangleddata/following{/other_user}","gists_url":"https://api.github.com/users/mangleddata/gists{/gist_id}","starred_url":"https://api.github.com/users/mangleddata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mangleddata/subscriptions","organizations_url":"https://api.github.com/users/mangleddata/orgs","repos_url":"https://api.github.com/users/mangleddata/repos","events_url":"https://api.github.com/users/mangleddata/events{/privacy}","received_events_url":"https://api.github.com/users/mangleddata/received_events","type":"User","site_admin":false},"labels":[{"id":1174068775,"node_id":"MDU6TGFiZWwxMTc0MDY4Nzc1","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/waiting%20for%20answer","name":"waiting for answer","color":"fff36b","default":false,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2020-01-10T20:27:29Z","updated_at":"2022-06-23T00:22:25Z","closed_at":"2022-06-23T00:22:25Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nSome datasets cause hangup with no progress being made. \r\n\r\n**To Reproduce**\r\nUnfortunately, I don't know if I can provide a reproducer since the data is custom data. However, I am happy to provide log info or any other data that would be helpful. The log shows deadlock on 1st epoch \r\n\r\n1,0]<stdout>:╒══════════╕\r\n[1,0]<stdout>:│ TRAINING │\r\n[1,0]<stdout>:╘══════════╛\r\n[1,0]<stdout>:\r\n[1,0]<stdout>:\r\n[1,0]<stdout>:Epoch   1\r\nTraining: 100% 377/377 [01:32<00:00,  4.07it/s][1,0]<stdout>:\r\nEvaluation train: 100% 377/377 [00:25<00:00, 14.82it/s][1,0]<stdout>:\r\n\r\nTrain set = ~900K rows rows, 900 features\r\nValid set = ~100K rows\r\n\r\n[1,0]<stderr>:[2020-01-10 19:52:29.658590: W horovod/common/stall_inspector.cc:105] One or more tensors were submitted to be reduced, gath\r\nered or broadcasted by subset of ranks and are waiting for remainder of ranks for more than 60 seconds. This may indicate that different r\r\nanks are trying to submit different tensors or that only subset of ranks is submitting tensors, which will cause deadlock.\r\n[1,0]<stderr>:Stalled ranks:\r\n[1,0]<stderr>:0: [optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_0, optimizer/DistributedAdamOpt\r\nimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_10_0, optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_optimizer\r\n_gradients_concat_11_0, optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_1_0, optimizer/Distribute\r\ndAdamOptimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_2_0, optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_op\r\ntimizer_gradients_concat_3_0 ...]\r\n[1,0]<stderr>:1: [optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_0, optimizer/DistributedAdamOpt\r\nimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_10_0, optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_optimizer\r\n_gradients_concat_11_0, optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_1_0, optimizer/Distribute\r\ndAdamOptimizer_Allreduce/HorovodAllgather_optimizer_gradients_concat_2_0, optimizer/DistributedAdamOptimizer_Allreduce/HorovodAllgather_op\r\ntimizer_gradients_concat_3_0 ...]\r\n\r\n\r\n\r\n\r\n**Expected behavior**\r\nExpect to make training progress.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Ubuntu \r\n - Version 18.04\r\n- Python version 3.6.6\r\n- Ludwig version 0.2.1\r\n\r\nhorovodrun  -v\r\n0.18.2\r\n\r\n\r\n\r\nAny pointers to overcome this ? ","closed_by":{"login":"justinxzhao","id":3459541,"node_id":"MDQ6VXNlcjM0NTk1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/3459541?v=4","gravatar_id":"","url":"https://api.github.com/users/justinxzhao","html_url":"https://github.com/justinxzhao","followers_url":"https://api.github.com/users/justinxzhao/followers","following_url":"https://api.github.com/users/justinxzhao/following{/other_user}","gists_url":"https://api.github.com/users/justinxzhao/gists{/gist_id}","starred_url":"https://api.github.com/users/justinxzhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinxzhao/subscriptions","organizations_url":"https://api.github.com/users/justinxzhao/orgs","repos_url":"https://api.github.com/users/justinxzhao/repos","events_url":"https://api.github.com/users/justinxzhao/events{/privacy}","received_events_url":"https://api.github.com/users/justinxzhao/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/610/timeline","performed_via_github_app":null,"state_reason":"completed"}