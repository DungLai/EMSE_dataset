{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/575","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/575/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/575/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/575/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/575","id":526134432,"node_id":"MDU6SXNzdWU1MjYxMzQ0MzI=","number":575,"title":"Can't parse SavedModel to use in TensorflowJs","user":{"login":"hamletbatista","id":1514243,"node_id":"MDQ6VXNlcjE1MTQyNDM=","avatar_url":"https://avatars.githubusercontent.com/u/1514243?v=4","gravatar_id":"","url":"https://api.github.com/users/hamletbatista","html_url":"https://github.com/hamletbatista","followers_url":"https://api.github.com/users/hamletbatista/followers","following_url":"https://api.github.com/users/hamletbatista/following{/other_user}","gists_url":"https://api.github.com/users/hamletbatista/gists{/gist_id}","starred_url":"https://api.github.com/users/hamletbatista/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hamletbatista/subscriptions","organizations_url":"https://api.github.com/users/hamletbatista/orgs","repos_url":"https://api.github.com/users/hamletbatista/repos","events_url":"https://api.github.com/users/hamletbatista/events{/privacy}","received_events_url":"https://api.github.com/users/hamletbatista/received_events","type":"User","site_admin":false},"labels":[{"id":1174068769,"node_id":"MDU6TGFiZWwxMTc0MDY4NzY5","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1174068771,"node_id":"MDU6TGFiZWwxMTc0MDY4Nzcx","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/feature","name":"feature","color":"0377d6","default":false,"description":"New feature or request"},{"id":1174068775,"node_id":"MDU6TGFiZWwxMTc0MDY4Nzc1","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/waiting%20for%20answer","name":"waiting for answer","color":"fff36b","default":false,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":18,"created_at":"2019-11-20T19:55:43Z","updated_at":"2020-02-28T19:49:35Z","closed_at":"2020-02-27T23:42:36Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nA clear and concise description of what the bug is.\r\nI'm trying to export a trained model so I can run inference using TensorflowJs, but the exported .pb doesn't work with the TensorflowJs converter tool. I get this error:\r\n\r\nWARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/resource_variable_ops.py:1781: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nIf using Keras pass *_constraint arguments to layers.\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/tensorflowjs_converter\", line 8, in <module>\r\n    sys.exit(pip_main())\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflowjs/converters/converter.py\", line 638, in pip_main\r\n    main([' '.join(sys.argv[1:])])\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflowjs/converters/converter.py\", line 642, in main\r\n    convert(argv[0].split(' '))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflowjs/converters/converter.py\", line 591, in convert\r\n    strip_debug_ops=args.strip_debug_ops)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflowjs/converters/tf_saved_model_conversion_v2.py\", line 419, in convert_tf_saved_model\r\n    model = load(saved_model_dir, saved_model_tags)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/saved_model/load.py\", line 519, in load\r\n    return load_internal(export_dir, tags)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/saved_model/load.py\", line 550, in load_internal\r\n    root = load_v1_in_v2.load(export_dir, tags)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/saved_model/load_v1_in_v2.py\", line 239, in load\r\n    return loader.load(tags=tags)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/saved_model/load_v1_in_v2.py\", line 222, in load\r\n    signature_functions = self._extract_signatures(wrapped, meta_graph_def)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/saved_model/load_v1_in_v2.py\", line 138, in _extract_signatures\r\n    signature_fn = wrapped.prune(feeds=feeds, fetches=fetches)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/wrap_function.py\", line 320, in prune\r\n    sources=flat_feeds + self.graph.internal_captures)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/lift_to_graph.py\", line 260, in lift_to_graph\r\n    add_sources=add_sources))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/op_selector.py\", line 413, in map_subgraph\r\n    % (repr(init_tensor), repr(op), _path_from(op, init_tensor, sources)))\r\ntensorflow.python.ops.op_selector.UnliftableError: A SavedModel signature needs an input for each placeholder the signature's outputs use. An output for signature 'predict' depends on a placeholder which is not an input (i.e. the placeholder is not fed a value).\r\n\r\nUnable to lift tensor <tf.Tensor 'Category0/predictions_Category0/predictions_Category0:0' shape=(?,) dtype=int64> because it depends transitively on placeholder <tf.Operation 'is_training' type=Placeholder> via at least one path, e.g.: Category0/predictions_Category0/predictions_Category0 (ArgMax) <- Category0/predictions_Category0/add (Add) <- Category0/predictions_Category0/MatMul (MatMul) <- concat_combiner/concat_combiner (Identity) <- concat_combiner/concat (Identity) <- Questions/Questions (Identity) <- Questions/dropout/cond/Merge (Merge) <- Questions/dropout/cond/dropout/mul_1 (Mul) <- Questions/dropout/cond/dropout/Cast (Cast) <- Questions/dropout/cond/dropout/GreaterEqual (GreaterEqual) <- Questions/dropout/cond/dropout/rate (Const) <- Questions/dropout/cond/switch_t (Identity) <- Questions/dropout/cond/Switch (Switch) <- is_training (Placeholder)\r\n\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\nYou can follow my steps in this colab notebook https://colab.research.google.com/drive/1c1REIK3G5FzwuCxmO8R0xA_0ODDlC57z#scrollTo=vNudSgJAZ7JB\r\n\r\nPlease provide code, yaml definition file and a sample of data in order to entirely reproduce the issue.\r\nIssues that are not reproducible will be ignored.\r\n\r\nEverything is in the Colab notebook.\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\nI am hoping to load the trained model in TensorflowJs\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: macOS \r\n - Version: Catalina\r\n- Python version: 3.6.8 \r\n- Ludwig version: 0.2.1\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\nI tried the ideas in this article https://github.com/uber/ludwig/issues/329#issuecomment-548854347\r\n","closed_by":{"login":"w4nderlust","id":349256,"node_id":"MDQ6VXNlcjM0OTI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/349256?v=4","gravatar_id":"","url":"https://api.github.com/users/w4nderlust","html_url":"https://github.com/w4nderlust","followers_url":"https://api.github.com/users/w4nderlust/followers","following_url":"https://api.github.com/users/w4nderlust/following{/other_user}","gists_url":"https://api.github.com/users/w4nderlust/gists{/gist_id}","starred_url":"https://api.github.com/users/w4nderlust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w4nderlust/subscriptions","organizations_url":"https://api.github.com/users/w4nderlust/orgs","repos_url":"https://api.github.com/users/w4nderlust/repos","events_url":"https://api.github.com/users/w4nderlust/events{/privacy}","received_events_url":"https://api.github.com/users/w4nderlust/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/575/timeline","performed_via_github_app":null,"state_reason":"completed"}