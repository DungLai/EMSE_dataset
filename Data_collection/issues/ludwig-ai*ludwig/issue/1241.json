{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1241","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1241/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1241/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1241/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/1241","id":950710990,"node_id":"MDU6SXNzdWU5NTA3MTA5OTA=","number":1241,"title":"Output sequence tagger has wrong probabilities output","user":{"login":"carlogrisetti","id":4464640,"node_id":"MDQ6VXNlcjQ0NjQ2NDA=","avatar_url":"https://avatars.githubusercontent.com/u/4464640?v=4","gravatar_id":"","url":"https://api.github.com/users/carlogrisetti","html_url":"https://github.com/carlogrisetti","followers_url":"https://api.github.com/users/carlogrisetti/followers","following_url":"https://api.github.com/users/carlogrisetti/following{/other_user}","gists_url":"https://api.github.com/users/carlogrisetti/gists{/gist_id}","starred_url":"https://api.github.com/users/carlogrisetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/carlogrisetti/subscriptions","organizations_url":"https://api.github.com/users/carlogrisetti/orgs","repos_url":"https://api.github.com/users/carlogrisetti/repos","events_url":"https://api.github.com/users/carlogrisetti/events{/privacy}","received_events_url":"https://api.github.com/users/carlogrisetti/received_events","type":"User","site_admin":false},"labels":[{"id":1174068775,"node_id":"MDU6TGFiZWwxMTc0MDY4Nzc1","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/waiting%20for%20answer","name":"waiting for answer","color":"fff36b","default":false,"description":"Further information is requested"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2021-07-22T14:08:48Z","updated_at":"2022-07-28T20:58:02Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Describe the bug**\r\nIn Ludwig 0.1.x and 0.2.x when having an output feature using a tagger (like in the https://ludwig-ai.github.io/ludwig-docs/examples/#natural-language-understanding example), all the various slots were correctly tagged, and for each slot you were presented with an array of confidence values, representing each possible slot tag confidence.\r\nIn 0.4.0 (and also happens in 0.3.x) you are presented with a fixed array of confidences, with length max_sequence_length, with one value per slot.\r\n\r\nI would expect having multiple arrays of confidences for each output slot as in previous versions, or, if this is an intended change, I would expect this array length to match the output tags length (in the case you want to only output the maximum confidence value for each slot, which I don't think is the case).\r\n\r\n**To Reproduce**\r\nTrain a model like presented in https://ludwig-ai.github.io/ludwig-docs/examples/#natural-language-understanding\r\nRun inference on an utterance\r\nObserve the prediction field `slots_predictions` and note its length\r\nObserve the prediction field `slots_probabilities` and note its length (always set to the maximum possible output value, and with a strange default value for non used tags, without all the sub-arrays representing each slot confidence)\r\n\r\n\r\nPython 3.6 and 3.9\r\nLudwig 0.3.x, 0.4.0, git+master current\r\n\r\nplease note: Ludwig 0.3.3 has a different `slots_probabilities` output format. In 0.4.0 strange \"\\n\"s were present in the array (like it was a text being parsed), while in 0.3.3 it is correctly parsed as an array.\r\n\r\nOne more thing: `slots_probability` which should be the overall confidence of all the slots being predicted, is often negative-valued (which should never happen).\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1241/timeline","performed_via_github_app":null,"state_reason":null}