{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2129","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2129/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2129/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2129/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/2129","id":1267896043,"node_id":"I_kwDOCbx2hs5Lko7r","number":2129,"title":"RFC: Reorganize split configuration to support time-based split strategy","user":{"login":"tgaddair","id":1742912,"node_id":"MDQ6VXNlcjE3NDI5MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1742912?v=4","gravatar_id":"","url":"https://api.github.com/users/tgaddair","html_url":"https://github.com/tgaddair","followers_url":"https://api.github.com/users/tgaddair/followers","following_url":"https://api.github.com/users/tgaddair/following{/other_user}","gists_url":"https://api.github.com/users/tgaddair/gists{/gist_id}","starred_url":"https://api.github.com/users/tgaddair/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tgaddair/subscriptions","organizations_url":"https://api.github.com/users/tgaddair/orgs","repos_url":"https://api.github.com/users/tgaddair/repos","events_url":"https://api.github.com/users/tgaddair/events{/privacy}","received_events_url":"https://api.github.com/users/tgaddair/received_events","type":"User","site_admin":false},"labels":[{"id":1174068771,"node_id":"MDU6TGFiZWwxMTc0MDY4Nzcx","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/feature","name":"feature","color":"0377d6","default":false,"description":"New feature or request"},{"id":3602609750,"node_id":"LA_kwDOCbx2hs7Wu3ZW","url":"https://api.github.com/repos/ludwig-ai/ludwig/labels/release-0.6","name":"release-0.6","color":"d4c5f9","default":false,"description":"Feature to be implemented in v0.6"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-06-10T18:50:06Z","updated_at":"2022-06-27T19:44:32Z","closed_at":"2022-06-27T19:44:32Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"Current preprocessing configuration supports splitting based on a split column, split probabilities (train-val-test), and stratified splitting based on a category. Currently this is all flattened into the top-level of the preprocessing section:\r\n\r\n```\r\npreprocessing:\r\n    force_split: false\r\n    split_probabilities: [0.7, 0.1, 0.2]\r\n    stratify: null\r\n    category: {...}\r\n    sequence: {...}\r\n    text: {...}\r\n```\r\n\r\nThe proposal here is to add the ability to split based on a date column such that the data is ordered by date (ascending) and then split according to the `split_probabilities`. For example, if `split_probabilities: [0.7, 0.1, 0.2]`, then the earliest 70% of the data will be used for training, the middle 10% used for validation, and the last 20% used for testing.\r\n\r\nThis feature is important to support [backtesting](https://en.wikipedia.org/wiki/Backtesting) where the user needs to know if a model trained on historical data would have performed well on unseen future data. If we use a uniformly random split strategy in these cases, then the model may not generalize well if the data distribution is subject to change over time.\r\n\r\nTo achieve this, we could add a new param in this structure, but it starts to get confusing juggling mutually exclusive params. As such, the proposal would be to both add a new param and restructure this section to be more modular:\r\n\r\n```\r\npreprocessing:\r\n    split:\r\n        type: datetime\r\n        column: created_ts\r\n        probabilities: [0.7, 0.1, 0.2]\r\n```\r\n\r\nExisting split types would similarly be reworked:\r\n\r\nDefault:\r\n\r\n```\r\npreprocessing:\r\n    split:\r\n        type: random\r\n        probabilities: [0.7, 0.1, 0.2]\r\n```\r\n\r\nFixed:\r\n\r\n```\r\npreprocessing:\r\n    split:\r\n        type: fixed\r\n        column: split\r\n```\r\n\r\nStratified:\r\n\r\n```\r\npreprocessing:\r\n    split:\r\n        type: stratify\r\n        column: color\r\n        probabilities: [0.7, 0.1, 0.2]\r\n```\r\n\r\nOne change in this approach would be that the user would need to be explicit about the split column, and splitting by fixed column would only happen if the user manually specifies it in the type.\r\n\r\nIn the future, we could also look to extend this to support bucketed backtesting, where we train and test on different windows of the data, but this is out of scope for this feature.","closed_by":{"login":"tgaddair","id":1742912,"node_id":"MDQ6VXNlcjE3NDI5MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1742912?v=4","gravatar_id":"","url":"https://api.github.com/users/tgaddair","html_url":"https://github.com/tgaddair","followers_url":"https://api.github.com/users/tgaddair/followers","following_url":"https://api.github.com/users/tgaddair/following{/other_user}","gists_url":"https://api.github.com/users/tgaddair/gists{/gist_id}","starred_url":"https://api.github.com/users/tgaddair/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tgaddair/subscriptions","organizations_url":"https://api.github.com/users/tgaddair/orgs","repos_url":"https://api.github.com/users/tgaddair/repos","events_url":"https://api.github.com/users/tgaddair/events{/privacy}","received_events_url":"https://api.github.com/users/tgaddair/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/2129/timeline","performed_via_github_app":null,"state_reason":"completed"}