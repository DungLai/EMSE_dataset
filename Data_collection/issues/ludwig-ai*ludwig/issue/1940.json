{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1940","repository_url":"https://api.github.com/repos/ludwig-ai/ludwig","labels_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1940/labels{/name}","comments_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1940/comments","events_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1940/events","html_url":"https://github.com/ludwig-ai/ludwig/issues/1940","id":1207698035,"node_id":"I_kwDOCbx2hs5H_AJz","number":1940,"title":"Twitter bots dataset fails to load most images because 4 channels not supported for JPEG.","user":{"login":"dantreiman","id":687280,"node_id":"MDQ6VXNlcjY4NzI4MA==","avatar_url":"https://avatars.githubusercontent.com/u/687280?v=4","gravatar_id":"","url":"https://api.github.com/users/dantreiman","html_url":"https://github.com/dantreiman","followers_url":"https://api.github.com/users/dantreiman/followers","following_url":"https://api.github.com/users/dantreiman/following{/other_user}","gists_url":"https://api.github.com/users/dantreiman/gists{/gist_id}","starred_url":"https://api.github.com/users/dantreiman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dantreiman/subscriptions","organizations_url":"https://api.github.com/users/dantreiman/orgs","repos_url":"https://api.github.com/users/dantreiman/repos","events_url":"https://api.github.com/users/dantreiman/events{/privacy}","received_events_url":"https://api.github.com/users/dantreiman/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"dantreiman","id":687280,"node_id":"MDQ6VXNlcjY4NzI4MA==","avatar_url":"https://avatars.githubusercontent.com/u/687280?v=4","gravatar_id":"","url":"https://api.github.com/users/dantreiman","html_url":"https://github.com/dantreiman","followers_url":"https://api.github.com/users/dantreiman/followers","following_url":"https://api.github.com/users/dantreiman/following{/other_user}","gists_url":"https://api.github.com/users/dantreiman/gists{/gist_id}","starred_url":"https://api.github.com/users/dantreiman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dantreiman/subscriptions","organizations_url":"https://api.github.com/users/dantreiman/orgs","repos_url":"https://api.github.com/users/dantreiman/repos","events_url":"https://api.github.com/users/dantreiman/events{/privacy}","received_events_url":"https://api.github.com/users/dantreiman/received_events","type":"User","site_admin":false},"assignees":[{"login":"dantreiman","id":687280,"node_id":"MDQ6VXNlcjY4NzI4MA==","avatar_url":"https://avatars.githubusercontent.com/u/687280?v=4","gravatar_id":"","url":"https://api.github.com/users/dantreiman","html_url":"https://github.com/dantreiman","followers_url":"https://api.github.com/users/dantreiman/followers","following_url":"https://api.github.com/users/dantreiman/following{/other_user}","gists_url":"https://api.github.com/users/dantreiman/gists{/gist_id}","starred_url":"https://api.github.com/users/dantreiman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dantreiman/subscriptions","organizations_url":"https://api.github.com/users/dantreiman/orgs","repos_url":"https://api.github.com/users/dantreiman/repos","events_url":"https://api.github.com/users/dantreiman/events{/privacy}","received_events_url":"https://api.github.com/users/dantreiman/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2022-04-19T03:56:51Z","updated_at":"2022-05-11T22:46:52Z","closed_at":"2022-05-11T22:46:51Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"Training with default settings for image feature, image preprocessing samples the first 100 images and takes the max of the number of channels.\r\n\r\nimage_feature.py:\r\n```python\r\n    if preprocessing_parameters[INFER_IMAGE_DIMENSIONS]:\r\n        user_specified_num_channels = True\r\n        # Use the maximum num_channels found across all sampled images. torchvision has built-in support for\r\n        # upsampling images.\r\n        num_channels = max(num_channels_in_image(x) for x in inferred_sample)\r\n```\r\n\r\nThis results in `num_channels = 4`, but the majority of images in the dataset are JPEGs, and torchvision's `read_image(img, mode=ImageReadMode.RGB_ALPHA)` throws an exception `The provided mode is not supported for JPEG files`:\r\n\r\n```\r\nreading image url /Users/daniel/Downloads/twitter_bots_kaggle/profile_images/ef985bc5d304e6fbe8c1bb65bead9ca24de7bb2c.jpg failed due to The provided mode is not supported for JPEG files\r\n/Users/daniel/Downloads/twitter_bots_kaggle/profile_images/ef985bc5d304e6fbe8c1bb65bead9ca24de7bb2c.jpg cannot be read\r\nreading image url /Users/daniel/Downloads/twitter_bots_kaggle/profile_images/c55fc16d98950aad439bfa44ac68712f1f10accf.jpeg failed due to The provided mode is not supported for JPEG files\r\n....\r\n```\r\n\r\nI'm not sure what the right heuristic is here, but I'm pretty certain we shouldn't use alpha channel if the majority of the images in dataset do not have an alpha channel. ","closed_by":{"login":"dantreiman","id":687280,"node_id":"MDQ6VXNlcjY4NzI4MA==","avatar_url":"https://avatars.githubusercontent.com/u/687280?v=4","gravatar_id":"","url":"https://api.github.com/users/dantreiman","html_url":"https://github.com/dantreiman","followers_url":"https://api.github.com/users/dantreiman/followers","following_url":"https://api.github.com/users/dantreiman/following{/other_user}","gists_url":"https://api.github.com/users/dantreiman/gists{/gist_id}","starred_url":"https://api.github.com/users/dantreiman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dantreiman/subscriptions","organizations_url":"https://api.github.com/users/dantreiman/orgs","repos_url":"https://api.github.com/users/dantreiman/repos","events_url":"https://api.github.com/users/dantreiman/events{/privacy}","received_events_url":"https://api.github.com/users/dantreiman/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1940/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ludwig-ai/ludwig/issues/1940/timeline","performed_via_github_app":null,"state_reason":"completed"}