{"url":"https://api.github.com/repos/stefanonardo/pytorch-esn/issues/14","repository_url":"https://api.github.com/repos/stefanonardo/pytorch-esn","labels_url":"https://api.github.com/repos/stefanonardo/pytorch-esn/issues/14/labels{/name}","comments_url":"https://api.github.com/repos/stefanonardo/pytorch-esn/issues/14/comments","events_url":"https://api.github.com/repos/stefanonardo/pytorch-esn/issues/14/events","html_url":"https://github.com/stefanonardo/pytorch-esn/issues/14","id":1381700690,"node_id":"I_kwDOB438r85SWxRS","number":14,"title":"The grad is none, please help me.","user":{"login":"yiyi123123132","id":35243293,"node_id":"MDQ6VXNlcjM1MjQzMjkz","avatar_url":"https://avatars.githubusercontent.com/u/35243293?v=4","gravatar_id":"","url":"https://api.github.com/users/yiyi123123132","html_url":"https://github.com/yiyi123123132","followers_url":"https://api.github.com/users/yiyi123123132/followers","following_url":"https://api.github.com/users/yiyi123123132/following{/other_user}","gists_url":"https://api.github.com/users/yiyi123123132/gists{/gist_id}","starred_url":"https://api.github.com/users/yiyi123123132/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yiyi123123132/subscriptions","organizations_url":"https://api.github.com/users/yiyi123123132/orgs","repos_url":"https://api.github.com/users/yiyi123123132/repos","events_url":"https://api.github.com/users/yiyi123123132/events{/privacy}","received_events_url":"https://api.github.com/users/yiyi123123132/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-09-22T01:42:35Z","updated_at":"2022-09-22T02:00:56Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I don't know why the grad is none.? this is my net code. CNN+ESN\r\n\r\n\r\nclass CNN_ESN(nn.Module):\r\n    def __init__(self, output_size,channel_num, device,drop_prob=0.5):\r\n        super(CNN_ESN, self).__init__()\r\n        self.conv = nn.Sequential(\r\n            nn.Conv2d(channel_num, 64, (5, 5), padding='same'),\r\n            nn.ReLU(),\r\n            nn.Conv2d(64, 128, (4, 4), padding='same'),\r\n            nn.ReLU(),\r\n            nn.Conv2d(128, 256, (4, 4), padding='same'),\r\n            nn.ReLU(),\r\n            nn.Conv2d(256, 64, (1, 1), padding='same'),\r\n            nn.ReLU(),\r\n            nn.MaxPool2d((2, 2)),\r\n            nn.Flatten(),\r\n            nn.Linear(1024, 512)\r\n        ).to(device)\r\n        self.esn = ESN(4,128,128,output_steps='mean', readout_training='svd').to(device)\r\n        self.fc = nn.Linear(128,output_size).to(device)\r\n        self.dropout = nn.Dropout(drop_prob)\r\n        self.sig = nn.Sigmoid()\r\n        self.washout_rate = 0.2\r\n    def forward(self, x):\r\n        conv_result = self.conv(x).reshape(128,x.shape[0],-1)\r\n        conv_result =self.dropout(conv_result)\r\n        washout_lst = [int(self.washout_rate * conv_result.size(0))] * conv_result.size(1)\r\n        out,hn = self.esn(conv_result,washout_lst)\r\n        hn = hn.transpose(1,0)\r\n        logit = self.fc(hn).squeeze(1)\r\n        return self.sig(logit).squeeze(1)\r\n\r\n        for inputs, labels in train_loader: \r\n            net.train()\r\n            inputs, labels = inputs.to(device), labels.to(device)\r\n            optimizer.zero_grad()  \r\n            output = net(inputs) \r\n            pred = torch.round(output)\r\n            loss = loss_func(output, labels)\r\n            pred_list = [float(i) for i in pred.tolist()]\r\n            for p, l in zip(pred_list, labels.tolist()):\r\n                tr_pre.append(int(p))\r\n                tr_lab.append(l)\r\n            tr_loss.append(loss.item())\r\n            loss.backward()\r\n            optimizer.step()\r\n\r\n\r\n\r\nand I print the grad as below, the 2nd epoch reulst:\r\n\r\nconv.0.weight        None\r\nconv.0.bias        None\r\nconv.2.weight        None\r\nconv.2.bias        None\r\nconv.4.weight        None\r\nconv.4.bias        None\r\nconv.6.weight        None\r\nconv.6.bias        None\r\nconv.10.weight        None\r\nconv.10.bias        None\r\nesn.reservoir.weight_ih_l0        None\r\nesn.reservoir.weight_hh_l0        None\r\nesn.reservoir.bias_ih_l0        None\r\nesn.readout.weight        None\r\nesn.readout.bias        None\r\nfc.weight        tensor([[ 0.0480, -0.0079,  0.0929,  0.1358,  0.1022, -0.1127,  0.0495,  0.1056,\r\n         -0.0923,  0.0720,  0.1122,  0.0139, -0.0619,  0.0796,  0.1433,  0.0295,\r\n          0.0884, -0.0504,  0.0305,  0.0264,  0.1352,  0.0467, -0.0607, -0.0363,\r\n         -0.0114, -0.1393, -0.0917,  0.0194,  0.1076, -0.0713, -0.0487,  0.0433,\r\n         -0.0875,  0.0212,  0.1007, -0.0711,  0.1098,  0.0577,  0.0607,  0.0299,\r\n          0.0380,  0.0955,  0.0062, -0.0620, -0.0463, -0.0354,  0.1050, -0.0920,\r\n          0.0742, -0.0550, -0.1270, -0.0597,  0.0736,  0.0246,  0.0521, -0.0866,\r\n         -0.0065, -0.0764,  0.0087, -0.0810,  0.0551,  0.0999,  0.1078, -0.0082,\r\n         -0.0940, -0.0628, -0.0624,  0.0779, -0.0107, -0.0069,  0.0793, -0.0318,\r\n          0.0086, -0.1427,  0.0617,  0.0839, -0.0904,  0.0535,  0.0678, -0.0232,\r\n          0.0361, -0.0065, -0.0806,  0.0824, -0.0336,  0.0707, -0.1042, -0.0336,\r\n         -0.1039,  0.0715, -0.1403, -0.0068, -0.0912, -0.1043,  0.0455, -0.0223,\r\n          0.0448,  0.0321,  0.0844, -0.0734, -0.0050,  0.1083,  0.0027, -0.0897,\r\n         -0.1176, -0.1059,  0.1006,  0.0873, -0.0715, -0.1130,  0.0707, -0.0015,\r\n          0.0257, -0.0536, -0.0769, -0.0671, -0.0329, -0.0666, -0.0631,  0.1100,\r\n         -0.1013, -0.0392, -0.1062,  0.1276, -0.0686, -0.1200, -0.0669,  0.0424]])\r\nfc.bias        tensor([0.1520])\r\n\r\ncould tell me the reason?\r\n\r\n\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/stefanonardo/pytorch-esn/issues/14/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/stefanonardo/pytorch-esn/issues/14/timeline","performed_via_github_app":null,"state_reason":null}