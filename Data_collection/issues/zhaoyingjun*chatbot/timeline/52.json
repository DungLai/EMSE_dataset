[{"url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/comments/540583417","html_url":"https://github.com/zhaoyingjun/chatbot/issues/52#issuecomment-540583417","issue_url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/52","id":540583417,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDU4MzQxNw==","user":{"login":"zhaoyingjun","id":12986443,"node_id":"MDQ6VXNlcjEyOTg2NDQz","avatar_url":"https://avatars.githubusercontent.com/u/12986443?v=4","gravatar_id":"","url":"https://api.github.com/users/zhaoyingjun","html_url":"https://github.com/zhaoyingjun","followers_url":"https://api.github.com/users/zhaoyingjun/followers","following_url":"https://api.github.com/users/zhaoyingjun/following{/other_user}","gists_url":"https://api.github.com/users/zhaoyingjun/gists{/gist_id}","starred_url":"https://api.github.com/users/zhaoyingjun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhaoyingjun/subscriptions","organizations_url":"https://api.github.com/users/zhaoyingjun/orgs","repos_url":"https://api.github.com/users/zhaoyingjun/repos","events_url":"https://api.github.com/users/zhaoyingjun/events{/privacy}","received_events_url":"https://api.github.com/users/zhaoyingjun/received_events","type":"User","site_admin":false},"created_at":"2019-10-10T13:32:16Z","updated_at":"2019-10-10T13:32:16Z","author_association":"OWNER","body":"是你的文件编码的问题","reactions":{"url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/comments/540583417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zhaoyingjun","id":12986443,"node_id":"MDQ6VXNlcjEyOTg2NDQz","avatar_url":"https://avatars.githubusercontent.com/u/12986443?v=4","gravatar_id":"","url":"https://api.github.com/users/zhaoyingjun","html_url":"https://github.com/zhaoyingjun","followers_url":"https://api.github.com/users/zhaoyingjun/followers","following_url":"https://api.github.com/users/zhaoyingjun/following{/other_user}","gists_url":"https://api.github.com/users/zhaoyingjun/gists{/gist_id}","starred_url":"https://api.github.com/users/zhaoyingjun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhaoyingjun/subscriptions","organizations_url":"https://api.github.com/users/zhaoyingjun/orgs","repos_url":"https://api.github.com/users/zhaoyingjun/repos","events_url":"https://api.github.com/users/zhaoyingjun/events{/privacy}","received_events_url":"https://api.github.com/users/zhaoyingjun/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/comments/547927370","html_url":"https://github.com/zhaoyingjun/chatbot/issues/52#issuecomment-547927370","issue_url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/52","id":547927370,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzkyNzM3MA==","user":{"login":"Iron-head","id":34657699,"node_id":"MDQ6VXNlcjM0NjU3Njk5","avatar_url":"https://avatars.githubusercontent.com/u/34657699?v=4","gravatar_id":"","url":"https://api.github.com/users/Iron-head","html_url":"https://github.com/Iron-head","followers_url":"https://api.github.com/users/Iron-head/followers","following_url":"https://api.github.com/users/Iron-head/following{/other_user}","gists_url":"https://api.github.com/users/Iron-head/gists{/gist_id}","starred_url":"https://api.github.com/users/Iron-head/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Iron-head/subscriptions","organizations_url":"https://api.github.com/users/Iron-head/orgs","repos_url":"https://api.github.com/users/Iron-head/repos","events_url":"https://api.github.com/users/Iron-head/events{/privacy}","received_events_url":"https://api.github.com/users/Iron-head/received_events","type":"User","site_admin":false},"created_at":"2019-10-30T14:19:17Z","updated_at":"2019-10-30T14:19:17Z","author_association":"NONE","body":"> execute.py下的decode_line（）函数会把中文词转为二进制表示，所以在词字典中是找不到的，token_ids一直是[3,3,3,3…]\r\n\r\n你好，我的也是这样，请问你解决了没","reactions":{"url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/comments/547927370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Iron-head","id":34657699,"node_id":"MDQ6VXNlcjM0NjU3Njk5","avatar_url":"https://avatars.githubusercontent.com/u/34657699?v=4","gravatar_id":"","url":"https://api.github.com/users/Iron-head","html_url":"https://github.com/Iron-head","followers_url":"https://api.github.com/users/Iron-head/followers","following_url":"https://api.github.com/users/Iron-head/following{/other_user}","gists_url":"https://api.github.com/users/Iron-head/gists{/gist_id}","starred_url":"https://api.github.com/users/Iron-head/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Iron-head/subscriptions","organizations_url":"https://api.github.com/users/Iron-head/orgs","repos_url":"https://api.github.com/users/Iron-head/repos","events_url":"https://api.github.com/users/Iron-head/events{/privacy}","received_events_url":"https://api.github.com/users/Iron-head/received_events","type":"User","site_admin":false}},{"id":2756273975,"node_id":"MDExOkNsb3NlZEV2ZW50Mjc1NjI3Mzk3NQ==","url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/events/2756273975","actor":{"login":"wdwcn","id":29766564,"node_id":"MDQ6VXNlcjI5NzY2NTY0","avatar_url":"https://avatars.githubusercontent.com/u/29766564?v=4","gravatar_id":"","url":"https://api.github.com/users/wdwcn","html_url":"https://github.com/wdwcn","followers_url":"https://api.github.com/users/wdwcn/followers","following_url":"https://api.github.com/users/wdwcn/following{/other_user}","gists_url":"https://api.github.com/users/wdwcn/gists{/gist_id}","starred_url":"https://api.github.com/users/wdwcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wdwcn/subscriptions","organizations_url":"https://api.github.com/users/wdwcn/orgs","repos_url":"https://api.github.com/users/wdwcn/repos","events_url":"https://api.github.com/users/wdwcn/events{/privacy}","received_events_url":"https://api.github.com/users/wdwcn/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-10-30T14:40:17Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/comments/547939144","html_url":"https://github.com/zhaoyingjun/chatbot/issues/52#issuecomment-547939144","issue_url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/52","id":547939144,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzkzOTE0NA==","user":{"login":"wdwcn","id":29766564,"node_id":"MDQ6VXNlcjI5NzY2NTY0","avatar_url":"https://avatars.githubusercontent.com/u/29766564?v=4","gravatar_id":"","url":"https://api.github.com/users/wdwcn","html_url":"https://github.com/wdwcn","followers_url":"https://api.github.com/users/wdwcn/followers","following_url":"https://api.github.com/users/wdwcn/following{/other_user}","gists_url":"https://api.github.com/users/wdwcn/gists{/gist_id}","starred_url":"https://api.github.com/users/wdwcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wdwcn/subscriptions","organizations_url":"https://api.github.com/users/wdwcn/orgs","repos_url":"https://api.github.com/users/wdwcn/repos","events_url":"https://api.github.com/users/wdwcn/events{/privacy}","received_events_url":"https://api.github.com/users/wdwcn/received_events","type":"User","site_admin":false},"created_at":"2019-10-30T14:41:17Z","updated_at":"2019-10-30T14:41:17Z","author_association":"NONE","body":"> > execute.py下的decode_line（）函数会把中文词转为二进制表示，所以在词字典中是找不到的，token_ids一直是[3,3,3,3…]\r\n> \r\n> 你好，我的也是这样，请问你解决了没\r\n\r\n有点记不清当时都改了哪些地方，我把大佬的代码注释了一部分，绕过了转二进制部分。其他地方有没有修改不是太确定了。\r\n\r\ndef decode_line(sess, model, enc_vocab, rev_dec_vocab, sentence):\r\n    # Get token-ids for the input sentence.\r\n    #token_ids = prepareData.sentence_to_token_ids(tf.compat.as_bytes(sentence), enc_vocab)\r\n    #token_ids = prepareData.sentence_to_token_ids(sentence, enc_vocab)\r\n    def sentence_to_token_ids(sentence, enc_vocab):\r\n        token_ids=[]\r\n        for word in re.split(r'\\s+',sentence):\r\n            token_ids.append(enc_vocab.get(word,3))\r\n        return(token_ids)\r\n    token_ids=sentence_to_token_ids(sentence,enc_vocab)\r\n\r\n    # Which bucket does it belong to?\r\n    bucket_id = min([b for b in xrange(len(_buckets)) if _buckets[b][0] > len(token_ids)])\r\n\r\n    # Get a 1-element batch to feed the sentence to the model.\r\n    encoder_inputs, decoder_inputs, target_weights = model.get_batch({bucket_id: [(token_ids, [])]}, bucket_id)\r\n\r\n    # Get output logits for the sentence.\r\n    _, _, output_logits = model.step(sess, encoder_inputs, decoder_inputs, target_weights, bucket_id, True)\r\n\r\n    # This is a greedy decoder - outputs are just argmaxes of output_logits.\r\n    outputs = [int(np.argmax(logit, axis=1)) for logit in output_logits]\r\n\r\n    # If there is an EOS symbol in outputs, cut them at that point.\r\n    if prepareData.EOS_ID in outputs:\r\n        outputs = outputs[:outputs.index(prepareData.EOS_ID)]\r\n\r\n    return \" \".join([tf.compat.as_str(rev_dec_vocab[output]) for output in outputs])\r\n\r\n","reactions":{"url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/comments/547939144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"wdwcn","id":29766564,"node_id":"MDQ6VXNlcjI5NzY2NTY0","avatar_url":"https://avatars.githubusercontent.com/u/29766564?v=4","gravatar_id":"","url":"https://api.github.com/users/wdwcn","html_url":"https://github.com/wdwcn","followers_url":"https://api.github.com/users/wdwcn/followers","following_url":"https://api.github.com/users/wdwcn/following{/other_user}","gists_url":"https://api.github.com/users/wdwcn/gists{/gist_id}","starred_url":"https://api.github.com/users/wdwcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wdwcn/subscriptions","organizations_url":"https://api.github.com/users/wdwcn/orgs","repos_url":"https://api.github.com/users/wdwcn/repos","events_url":"https://api.github.com/users/wdwcn/events{/privacy}","received_events_url":"https://api.github.com/users/wdwcn/received_events","type":"User","site_admin":false}}]