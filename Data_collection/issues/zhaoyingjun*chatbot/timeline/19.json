[{"url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/comments/431227833","html_url":"https://github.com/zhaoyingjun/chatbot/issues/19#issuecomment-431227833","issue_url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/19","id":431227833,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMTIyNzgzMw==","user":{"login":"Goooaaal","id":33569679,"node_id":"MDQ6VXNlcjMzNTY5Njc5","avatar_url":"https://avatars.githubusercontent.com/u/33569679?v=4","gravatar_id":"","url":"https://api.github.com/users/Goooaaal","html_url":"https://github.com/Goooaaal","followers_url":"https://api.github.com/users/Goooaaal/followers","following_url":"https://api.github.com/users/Goooaaal/following{/other_user}","gists_url":"https://api.github.com/users/Goooaaal/gists{/gist_id}","starred_url":"https://api.github.com/users/Goooaaal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Goooaaal/subscriptions","organizations_url":"https://api.github.com/users/Goooaaal/orgs","repos_url":"https://api.github.com/users/Goooaaal/repos","events_url":"https://api.github.com/users/Goooaaal/events{/privacy}","received_events_url":"https://api.github.com/users/Goooaaal/received_events","type":"User","site_admin":false},"created_at":"2018-10-19T02:46:55Z","updated_at":"2018-10-19T02:46:55Z","author_association":"NONE","body":"Traceback (most recent call last):\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1322, in _do_call\r\n    return fn(*args)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1307, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1409, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [20000,256] rhs shape= [50000,256]\r\n\t [[Node: save/Assign_14 = Assign[T=DT_FLOAT, _class=[\"loc:@embedding_attention_seq2seq/embedding_attention_decoder/embedding\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](embedding_attention_seq2seq/embedding_attention_decoder/embedding, save/RestoreV2:14)]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"C:/Users/Administrator/Desktop/cb/app.py\", line 76, in <module>\r\n    sess, model, enc_vocab, rev_dec_vocab = execute.init_session(sess, conf='seq2seq_serve.ini')\r\n  File \"C:\\Users\\Administrator\\Desktop\\cb\\execute.py\", line 214, in init_session\r\n    model = create_model(sess, True)\r\n  File \"C:\\Users\\Administrator\\Desktop\\cb\\execute.py\", line 104, in create_model\r\n    model.saver.restore(session, ckpt.model_checkpoint_path)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\saver.py\", line 1752, in restore\r\n    {self.saver_def.filename_tensor_name: save_path})\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 900, in run\r\n    run_metadata_ptr)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1135, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1316, in _do_run\r\n    run_metadata)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1335, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [20000,256] rhs shape= [50000,256]\r\n\t [[Node: save/Assign_14 = Assign[T=DT_FLOAT, _class=[\"loc:@embedding_attention_seq2seq/embedding_attention_decoder/embedding\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](embedding_attention_seq2seq/embedding_attention_decoder/embedding, save/RestoreV2:14)]]\r\n\r\n      Caused by op 'save/Assign_14', defined at:\r\n  File \"C:/Users/Administrator/Desktop/cb/app.py\", line 76, in <module>\r\n    sess, model, enc_vocab, rev_dec_vocab = execute.init_session(sess, conf='seq2seq_serve.ini')\r\n  File \"C:\\Users\\Administrator\\Desktop\\cb\\execute.py\", line 214, in init_session\r\n    model = create_model(sess, True)\r\n  File \"C:\\Users\\Administrator\\Desktop\\cb\\execute.py\", line 94, in create_model\r\n    model = seq2seq_model.Seq2SeqModel( gConfig['enc_vocab_size'], gConfig['dec_vocab_size'], _buckets, gConfig['layer_size'], gConfig['num_layers'], gConfig['max_gradient_norm'], gConfig['batch_size'], gConfig['learning_rate'], gConfig['learning_rate_decay_factor'], forward_only=forward_only)\r\n  File \"C:\\Users\\Administrator\\Desktop\\cb\\seq2seq_model.py\", line 168, in __init__\r\n    self.saver = tf.train.Saver(tf.all_variables())\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\saver.py\", line 1284, in __init__\r\n    self.build()\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\saver.py\", line 1296, in build\r\n    self._build(self._filename, build_save=True, build_restore=True)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\saver.py\", line 1333, in _build\r\n    build_save=build_save, build_restore=build_restore)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\saver.py\", line 781, in _build_internal\r\n    restore_sequentially, reshape)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\saver.py\", line 422, in _AddRestoreOps\r\n    assign_ops.append(saveable.restore(saveable_tensors, shapes))\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\training\\saver.py\", line 113, in restore\r\n    self.op.get_shape().is_fully_defined())\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\state_ops.py\", line 219, in assign\r\n    validate_shape=validate_shape)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\ops\\gen_state_ops.py\", line 59, in assign\r\n    use_locking=use_locking, name=name)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3414, in create_op\r\n    op_def=op_def)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1740, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nInvalidArgumentError (see above for traceback): Assign requires shapes of both tensors to match. lhs shape= [20000,256] rhs shape= [50000,256]\r\n\t [[Node: save/Assign_14 = Assign[T=DT_FLOAT, _class=[\"loc:@embedding_attention_seq2seq/embedding_attention_decoder/embedding\"], use_locking=true, validate_shape=true, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](embedding_attention_seq2seq/embedding_attention_decoder/embedding, save/RestoreV2:14)]]\r\n  作者说的直接更改字典大小应该是不可以的。如果不改变seq2seq.ini 的enc_vocab_size和dec_vaocab_size,仍然按照预定值20000使用，不会报错。 请问如何解决?","reactions":{"url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/comments/431227833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Goooaaal","id":33569679,"node_id":"MDQ6VXNlcjMzNTY5Njc5","avatar_url":"https://avatars.githubusercontent.com/u/33569679?v=4","gravatar_id":"","url":"https://api.github.com/users/Goooaaal","html_url":"https://github.com/Goooaaal","followers_url":"https://api.github.com/users/Goooaaal/followers","following_url":"https://api.github.com/users/Goooaaal/following{/other_user}","gists_url":"https://api.github.com/users/Goooaaal/gists{/gist_id}","starred_url":"https://api.github.com/users/Goooaaal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Goooaaal/subscriptions","organizations_url":"https://api.github.com/users/Goooaaal/orgs","repos_url":"https://api.github.com/users/Goooaaal/repos","events_url":"https://api.github.com/users/Goooaaal/events{/privacy}","received_events_url":"https://api.github.com/users/Goooaaal/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/comments/431228526","html_url":"https://github.com/zhaoyingjun/chatbot/issues/19#issuecomment-431228526","issue_url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/19","id":431228526,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMTIyODUyNg==","user":{"login":"zhaoyingjun","id":12986443,"node_id":"MDQ6VXNlcjEyOTg2NDQz","avatar_url":"https://avatars.githubusercontent.com/u/12986443?v=4","gravatar_id":"","url":"https://api.github.com/users/zhaoyingjun","html_url":"https://github.com/zhaoyingjun","followers_url":"https://api.github.com/users/zhaoyingjun/followers","following_url":"https://api.github.com/users/zhaoyingjun/following{/other_user}","gists_url":"https://api.github.com/users/zhaoyingjun/gists{/gist_id}","starred_url":"https://api.github.com/users/zhaoyingjun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhaoyingjun/subscriptions","organizations_url":"https://api.github.com/users/zhaoyingjun/orgs","repos_url":"https://api.github.com/users/zhaoyingjun/repos","events_url":"https://api.github.com/users/zhaoyingjun/events{/privacy}","received_events_url":"https://api.github.com/users/zhaoyingjun/received_events","type":"User","site_admin":false},"created_at":"2018-10-19T02:51:40Z","updated_at":"2018-10-19T02:51:40Z","author_association":"OWNER","body":"shape= [20000,256] rhs shape= [50000,256]   你修改了字典 要把之前的Model给删除了，要不然之前是按照[20000,256] Tensor当然会报错","reactions":{"url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/comments/431228526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zhaoyingjun","id":12986443,"node_id":"MDQ6VXNlcjEyOTg2NDQz","avatar_url":"https://avatars.githubusercontent.com/u/12986443?v=4","gravatar_id":"","url":"https://api.github.com/users/zhaoyingjun","html_url":"https://github.com/zhaoyingjun","followers_url":"https://api.github.com/users/zhaoyingjun/followers","following_url":"https://api.github.com/users/zhaoyingjun/following{/other_user}","gists_url":"https://api.github.com/users/zhaoyingjun/gists{/gist_id}","starred_url":"https://api.github.com/users/zhaoyingjun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhaoyingjun/subscriptions","organizations_url":"https://api.github.com/users/zhaoyingjun/orgs","repos_url":"https://api.github.com/users/zhaoyingjun/repos","events_url":"https://api.github.com/users/zhaoyingjun/events{/privacy}","received_events_url":"https://api.github.com/users/zhaoyingjun/received_events","type":"User","site_admin":false}},{"id":1913783001,"node_id":"MDExOkNsb3NlZEV2ZW50MTkxMzc4MzAwMQ==","url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/events/1913783001","actor":{"login":"zhaoyingjun","id":12986443,"node_id":"MDQ6VXNlcjEyOTg2NDQz","avatar_url":"https://avatars.githubusercontent.com/u/12986443?v=4","gravatar_id":"","url":"https://api.github.com/users/zhaoyingjun","html_url":"https://github.com/zhaoyingjun","followers_url":"https://api.github.com/users/zhaoyingjun/followers","following_url":"https://api.github.com/users/zhaoyingjun/following{/other_user}","gists_url":"https://api.github.com/users/zhaoyingjun/gists{/gist_id}","starred_url":"https://api.github.com/users/zhaoyingjun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhaoyingjun/subscriptions","organizations_url":"https://api.github.com/users/zhaoyingjun/orgs","repos_url":"https://api.github.com/users/zhaoyingjun/repos","events_url":"https://api.github.com/users/zhaoyingjun/events{/privacy}","received_events_url":"https://api.github.com/users/zhaoyingjun/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2018-10-19T02:51:40Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/comments/431229908","html_url":"https://github.com/zhaoyingjun/chatbot/issues/19#issuecomment-431229908","issue_url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/19","id":431229908,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMTIyOTkwOA==","user":{"login":"Goooaaal","id":33569679,"node_id":"MDQ6VXNlcjMzNTY5Njc5","avatar_url":"https://avatars.githubusercontent.com/u/33569679?v=4","gravatar_id":"","url":"https://api.github.com/users/Goooaaal","html_url":"https://github.com/Goooaaal","followers_url":"https://api.github.com/users/Goooaaal/followers","following_url":"https://api.github.com/users/Goooaaal/following{/other_user}","gists_url":"https://api.github.com/users/Goooaaal/gists{/gist_id}","starred_url":"https://api.github.com/users/Goooaaal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Goooaaal/subscriptions","organizations_url":"https://api.github.com/users/Goooaaal/orgs","repos_url":"https://api.github.com/users/Goooaaal/repos","events_url":"https://api.github.com/users/Goooaaal/events{/privacy}","received_events_url":"https://api.github.com/users/Goooaaal/received_events","type":"User","site_admin":false},"created_at":"2018-10-19T03:01:16Z","updated_at":"2018-10-19T03:01:16Z","author_association":"NONE","body":"不好意思 我没明白您的意思，是说要把working_dir里的文件删除吗   我是第一次运行此代码  working_dir下所有文件都是删除的  我运行的自己的代码和数据  之前应该没有model ","reactions":{"url":"https://api.github.com/repos/zhaoyingjun/chatbot/issues/comments/431229908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Goooaaal","id":33569679,"node_id":"MDQ6VXNlcjMzNTY5Njc5","avatar_url":"https://avatars.githubusercontent.com/u/33569679?v=4","gravatar_id":"","url":"https://api.github.com/users/Goooaaal","html_url":"https://github.com/Goooaaal","followers_url":"https://api.github.com/users/Goooaaal/followers","following_url":"https://api.github.com/users/Goooaaal/following{/other_user}","gists_url":"https://api.github.com/users/Goooaaal/gists{/gist_id}","starred_url":"https://api.github.com/users/Goooaaal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Goooaaal/subscriptions","organizations_url":"https://api.github.com/users/Goooaaal/orgs","repos_url":"https://api.github.com/users/Goooaaal/repos","events_url":"https://api.github.com/users/Goooaaal/events{/privacy}","received_events_url":"https://api.github.com/users/Goooaaal/received_events","type":"User","site_admin":false}}]