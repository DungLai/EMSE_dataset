[{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/689987011","html_url":"https://github.com/medipixel/rl_algorithms/issues/270#issuecomment-689987011","issue_url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/270","id":689987011,"node_id":"MDEyOklzc3VlQ29tbWVudDY4OTk4NzAxMQ==","user":{"login":"jinPrelude","id":16518993,"node_id":"MDQ6VXNlcjE2NTE4OTkz","avatar_url":"https://avatars.githubusercontent.com/u/16518993?v=4","gravatar_id":"","url":"https://api.github.com/users/jinPrelude","html_url":"https://github.com/jinPrelude","followers_url":"https://api.github.com/users/jinPrelude/followers","following_url":"https://api.github.com/users/jinPrelude/following{/other_user}","gists_url":"https://api.github.com/users/jinPrelude/gists{/gist_id}","starred_url":"https://api.github.com/users/jinPrelude/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jinPrelude/subscriptions","organizations_url":"https://api.github.com/users/jinPrelude/orgs","repos_url":"https://api.github.com/users/jinPrelude/repos","events_url":"https://api.github.com/users/jinPrelude/events{/privacy}","received_events_url":"https://api.github.com/users/jinPrelude/received_events","type":"User","site_admin":false},"created_at":"2020-09-10T05:12:07Z","updated_at":"2020-09-10T05:12:07Z","author_association":"COLLABORATOR","body":"Thanks for using our repo! Unfortunately, we only tested in the environment mentioned in README. And based on our several performance test of those environments and our own environment, we determined that our algorithms works pretty well. In certain environments, C51 has a higher performance than IQN, so various attempts are recommended including hyper-parameter tuning. We are sorry that we cannot help you further with your problem, and we will look forward to your good news. ","reactions":{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/689987011/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jinPrelude","id":16518993,"node_id":"MDQ6VXNlcjE2NTE4OTkz","avatar_url":"https://avatars.githubusercontent.com/u/16518993?v=4","gravatar_id":"","url":"https://api.github.com/users/jinPrelude","html_url":"https://github.com/jinPrelude","followers_url":"https://api.github.com/users/jinPrelude/followers","following_url":"https://api.github.com/users/jinPrelude/following{/other_user}","gists_url":"https://api.github.com/users/jinPrelude/gists{/gist_id}","starred_url":"https://api.github.com/users/jinPrelude/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jinPrelude/subscriptions","organizations_url":"https://api.github.com/users/jinPrelude/orgs","repos_url":"https://api.github.com/users/jinPrelude/repos","events_url":"https://api.github.com/users/jinPrelude/events{/privacy}","received_events_url":"https://api.github.com/users/jinPrelude/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/690122739","html_url":"https://github.com/medipixel/rl_algorithms/issues/270#issuecomment-690122739","issue_url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/270","id":690122739,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDEyMjczOQ==","user":{"login":"pedrolob","id":649124,"node_id":"MDQ6VXNlcjY0OTEyNA==","avatar_url":"https://avatars.githubusercontent.com/u/649124?v=4","gravatar_id":"","url":"https://api.github.com/users/pedrolob","html_url":"https://github.com/pedrolob","followers_url":"https://api.github.com/users/pedrolob/followers","following_url":"https://api.github.com/users/pedrolob/following{/other_user}","gists_url":"https://api.github.com/users/pedrolob/gists{/gist_id}","starred_url":"https://api.github.com/users/pedrolob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pedrolob/subscriptions","organizations_url":"https://api.github.com/users/pedrolob/orgs","repos_url":"https://api.github.com/users/pedrolob/repos","events_url":"https://api.github.com/users/pedrolob/events{/privacy}","received_events_url":"https://api.github.com/users/pedrolob/received_events","type":"User","site_admin":false},"created_at":"2020-09-10T09:52:20Z","updated_at":"2020-09-10T09:52:20Z","author_association":"NONE","body":"Thanks for the answer. Is there any config file for C51?","reactions":{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/690122739/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pedrolob","id":649124,"node_id":"MDQ6VXNlcjY0OTEyNA==","avatar_url":"https://avatars.githubusercontent.com/u/649124?v=4","gravatar_id":"","url":"https://api.github.com/users/pedrolob","html_url":"https://github.com/pedrolob","followers_url":"https://api.github.com/users/pedrolob/followers","following_url":"https://api.github.com/users/pedrolob/following{/other_user}","gists_url":"https://api.github.com/users/pedrolob/gists{/gist_id}","starred_url":"https://api.github.com/users/pedrolob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pedrolob/subscriptions","organizations_url":"https://api.github.com/users/pedrolob/orgs","repos_url":"https://api.github.com/users/pedrolob/repos","events_url":"https://api.github.com/users/pedrolob/events{/privacy}","received_events_url":"https://api.github.com/users/pedrolob/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/690819812","html_url":"https://github.com/medipixel/rl_algorithms/issues/270#issuecomment-690819812","issue_url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/270","id":690819812,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDgxOTgxMg==","user":{"login":"jinPrelude","id":16518993,"node_id":"MDQ6VXNlcjE2NTE4OTkz","avatar_url":"https://avatars.githubusercontent.com/u/16518993?v=4","gravatar_id":"","url":"https://api.github.com/users/jinPrelude","html_url":"https://github.com/jinPrelude","followers_url":"https://api.github.com/users/jinPrelude/followers","following_url":"https://api.github.com/users/jinPrelude/following{/other_user}","gists_url":"https://api.github.com/users/jinPrelude/gists{/gist_id}","starred_url":"https://api.github.com/users/jinPrelude/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jinPrelude/subscriptions","organizations_url":"https://api.github.com/users/jinPrelude/orgs","repos_url":"https://api.github.com/users/jinPrelude/repos","events_url":"https://api.github.com/users/jinPrelude/events{/privacy}","received_events_url":"https://api.github.com/users/jinPrelude/received_events","type":"User","site_admin":false},"created_at":"2020-09-11T01:32:15Z","updated_at":"2020-09-11T01:32:15Z","author_association":"COLLABORATOR","body":"We use C51 for training lunarlander(https://github.com/medipixel/rl_algorithms/blob/master/configs/lunarlander_v2/dqn.py). \r\nIf you want to train C51 in pong, you can train it by replacing pong_dqn's IQN head to lunarlander_dqn's c51 head, and fix pong_dqn's loss_type from \"IQNLoss\" to \"C51Loss\". This is what pong_c51 config looks like:\r\n```\r\n\"\"\"Config for C51 on Pong-No_FrameSkip-v4.\r\n- Author: Kyunghwan Kim\r\n- Contact: kh.kim@medipixel.io\r\n\"\"\"\r\nfrom rl_algorithms.common.helper_functions import identity\r\n\r\nagent = dict(\r\n    type=\"DQNAgent\",\r\n    hyper_params=dict(\r\n        gamma=0.99,\r\n        tau=5e-3,\r\n        buffer_size=int(1e4),  # openai baselines: int(1e4)\r\n        batch_size=32,  # openai baselines: 32\r\n        update_starts_from=int(1e4),  # openai baselines: int(1e4)\r\n        multiple_update=1,  # multiple learning updates\r\n        train_freq=4,  # in openai baselines, train_freq = 4\r\n        gradient_clip=10.0,  # dueling: 10.0\r\n        n_step=3,\r\n        w_n_step=1.0,\r\n        w_q_reg=0.0,\r\n        per_alpha=0.6,  # openai baselines: 0.6\r\n        per_beta=0.4,\r\n        per_eps=1e-6,\r\n        loss_type=dict(type=\"C51Loss\"),\r\n        # Epsilon Greedy\r\n        max_epsilon=0.0,\r\n        min_epsilon=0.0,  # openai baselines: 0.01\r\n        epsilon_decay=1e-6,  # openai baselines: 1e-7 / 1e-1\r\n        # grad_cam\r\n        grad_cam_layer_list=[\r\n            \"backbone.cnn.cnn_0.cnn\",\r\n            \"backbone.cnn.cnn_1.cnn\",\r\n            \"backbone.cnn.cnn_2.cnn\",\r\n        ],\r\n    ),\r\n    learner_cfg=dict(\r\n        type=\"DQNLearner\",\r\n        backbone=dict(\r\n            type=\"CNN\",\r\n            configs=dict(\r\n                input_sizes=[4, 32, 64],\r\n                output_sizes=[32, 64, 64],\r\n                kernel_sizes=[8, 4, 3],\r\n                strides=[4, 2, 1],\r\n                paddings=[1, 0, 0],\r\n            ),\r\n        ),\r\n        head=dict(\r\n            type=\"C51DuelingMLP\",\r\n            configs=dict(\r\n                hidden_sizes=[512],\r\n                v_min=-10,\r\n                v_max=10,\r\n                atom_size=51,\r\n                output_activation=identity,\r\n                # NoisyNet\r\n                use_noisy_net=True,\r\n                std_init=0.5,\r\n            ),\r\n        ),\r\n        optim_cfg=dict(\r\n            lr_dqn=1e-4,  # dueling: 6.25e-5, openai baselines: 1e-4\r\n            weight_decay=0.0,  # this makes saturation in cnn weights\r\n            adam_eps=1e-8,  # rainbow: 1.5e-4, openai baselines: 1e-8\r\n        ),\r\n    ),\r\n)\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/690819812/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jinPrelude","id":16518993,"node_id":"MDQ6VXNlcjE2NTE4OTkz","avatar_url":"https://avatars.githubusercontent.com/u/16518993?v=4","gravatar_id":"","url":"https://api.github.com/users/jinPrelude","html_url":"https://github.com/jinPrelude","followers_url":"https://api.github.com/users/jinPrelude/followers","following_url":"https://api.github.com/users/jinPrelude/following{/other_user}","gists_url":"https://api.github.com/users/jinPrelude/gists{/gist_id}","starred_url":"https://api.github.com/users/jinPrelude/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jinPrelude/subscriptions","organizations_url":"https://api.github.com/users/jinPrelude/orgs","repos_url":"https://api.github.com/users/jinPrelude/repos","events_url":"https://api.github.com/users/jinPrelude/events{/privacy}","received_events_url":"https://api.github.com/users/jinPrelude/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/691312670","html_url":"https://github.com/medipixel/rl_algorithms/issues/270#issuecomment-691312670","issue_url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/270","id":691312670,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MTMxMjY3MA==","user":{"login":"pedrolob","id":649124,"node_id":"MDQ6VXNlcjY0OTEyNA==","avatar_url":"https://avatars.githubusercontent.com/u/649124?v=4","gravatar_id":"","url":"https://api.github.com/users/pedrolob","html_url":"https://github.com/pedrolob","followers_url":"https://api.github.com/users/pedrolob/followers","following_url":"https://api.github.com/users/pedrolob/following{/other_user}","gists_url":"https://api.github.com/users/pedrolob/gists{/gist_id}","starred_url":"https://api.github.com/users/pedrolob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pedrolob/subscriptions","organizations_url":"https://api.github.com/users/pedrolob/orgs","repos_url":"https://api.github.com/users/pedrolob/repos","events_url":"https://api.github.com/users/pedrolob/events{/privacy}","received_events_url":"https://api.github.com/users/pedrolob/received_events","type":"User","site_admin":false},"created_at":"2020-09-11T21:08:05Z","updated_at":"2020-09-11T21:08:05Z","author_association":"NONE","body":"I did some testing with C51 but I didn't see any improvement. What I found is that the problem is in the Adam optimizer:\r\n\r\n- https://datascience.stackexchange.com/questions/25024/strange-behavior-with-adam-optimizer-when-training-for-too-long\r\n\r\n- https://discuss.pytorch.org/t/loss-suddenly-increases-using-adam-optimizer/11338/5\r\n\r\nThe \"amsgrad=True\" parameter makes the training slower, but at the end the same thing happened.\r\nOne of the solutions that someone proposed is gradient clipping (that I see the librar has) and batch normalization ( I don't know how to test that). Also, I wonder if \"adam_eps\" is for decrease the learning rate during the training (one of the solutions proposed).\r\n","reactions":{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/691312670/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pedrolob","id":649124,"node_id":"MDQ6VXNlcjY0OTEyNA==","avatar_url":"https://avatars.githubusercontent.com/u/649124?v=4","gravatar_id":"","url":"https://api.github.com/users/pedrolob","html_url":"https://github.com/pedrolob","followers_url":"https://api.github.com/users/pedrolob/followers","following_url":"https://api.github.com/users/pedrolob/following{/other_user}","gists_url":"https://api.github.com/users/pedrolob/gists{/gist_id}","starred_url":"https://api.github.com/users/pedrolob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pedrolob/subscriptions","organizations_url":"https://api.github.com/users/pedrolob/orgs","repos_url":"https://api.github.com/users/pedrolob/repos","events_url":"https://api.github.com/users/pedrolob/events{/privacy}","received_events_url":"https://api.github.com/users/pedrolob/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/692456168","html_url":"https://github.com/medipixel/rl_algorithms/issues/270#issuecomment-692456168","issue_url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/270","id":692456168,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MjQ1NjE2OA==","user":{"login":"jinPrelude","id":16518993,"node_id":"MDQ6VXNlcjE2NTE4OTkz","avatar_url":"https://avatars.githubusercontent.com/u/16518993?v=4","gravatar_id":"","url":"https://api.github.com/users/jinPrelude","html_url":"https://github.com/jinPrelude","followers_url":"https://api.github.com/users/jinPrelude/followers","following_url":"https://api.github.com/users/jinPrelude/following{/other_user}","gists_url":"https://api.github.com/users/jinPrelude/gists{/gist_id}","starred_url":"https://api.github.com/users/jinPrelude/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jinPrelude/subscriptions","organizations_url":"https://api.github.com/users/jinPrelude/orgs","repos_url":"https://api.github.com/users/jinPrelude/repos","events_url":"https://api.github.com/users/jinPrelude/events{/privacy}","received_events_url":"https://api.github.com/users/jinPrelude/received_events","type":"User","site_admin":false},"created_at":"2020-09-15T04:28:14Z","updated_at":"2020-09-15T04:28:14Z","author_association":"COLLABORATOR","body":"We are currently using gradient clipping for training, which you can edit the gradient clipping parameter in hyper_params in config file, and batch normalization and decreasing learning rate is not applied yet. Maybe you can use torch.optim.lr_scheduler for adjusting the learning rate(https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate). It might be hard to implement those methods in master branch as soon as possible since we have other primary tasks, But we'll try it when we can afford it. Applying rl_scheduler wouldn't be hard, so maybe you could try it. \r\nThanks for your feedback it really helped. And if you don't mind, please let me know in what environment you are training, so I could run our repo in the environment and check what the problems are in my personal time :)","reactions":{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/692456168/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jinPrelude","id":16518993,"node_id":"MDQ6VXNlcjE2NTE4OTkz","avatar_url":"https://avatars.githubusercontent.com/u/16518993?v=4","gravatar_id":"","url":"https://api.github.com/users/jinPrelude","html_url":"https://github.com/jinPrelude","followers_url":"https://api.github.com/users/jinPrelude/followers","following_url":"https://api.github.com/users/jinPrelude/following{/other_user}","gists_url":"https://api.github.com/users/jinPrelude/gists{/gist_id}","starred_url":"https://api.github.com/users/jinPrelude/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jinPrelude/subscriptions","organizations_url":"https://api.github.com/users/jinPrelude/orgs","repos_url":"https://api.github.com/users/jinPrelude/repos","events_url":"https://api.github.com/users/jinPrelude/events{/privacy}","received_events_url":"https://api.github.com/users/jinPrelude/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/692617976","html_url":"https://github.com/medipixel/rl_algorithms/issues/270#issuecomment-692617976","issue_url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/270","id":692617976,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MjYxNzk3Ng==","user":{"login":"pedrolob","id":649124,"node_id":"MDQ6VXNlcjY0OTEyNA==","avatar_url":"https://avatars.githubusercontent.com/u/649124?v=4","gravatar_id":"","url":"https://api.github.com/users/pedrolob","html_url":"https://github.com/pedrolob","followers_url":"https://api.github.com/users/pedrolob/followers","following_url":"https://api.github.com/users/pedrolob/following{/other_user}","gists_url":"https://api.github.com/users/pedrolob/gists{/gist_id}","starred_url":"https://api.github.com/users/pedrolob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pedrolob/subscriptions","organizations_url":"https://api.github.com/users/pedrolob/orgs","repos_url":"https://api.github.com/users/pedrolob/repos","events_url":"https://api.github.com/users/pedrolob/events{/privacy}","received_events_url":"https://api.github.com/users/pedrolob/received_events","type":"User","site_admin":false},"created_at":"2020-09-15T10:12:11Z","updated_at":"2020-09-15T10:12:11Z","author_association":"NONE","body":"My environment is Mario using retro gym. What I try, and seems to improve the situation, is using a bigger batch_size of 64 or 128. That helps with the training stability, and in my test I don't see the problem again. I have to test it more, but I like what I saw.\r\nI am going to give a try too to the adjust learning rate, when I have some result I will share it.","reactions":{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/692617976/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pedrolob","id":649124,"node_id":"MDQ6VXNlcjY0OTEyNA==","avatar_url":"https://avatars.githubusercontent.com/u/649124?v=4","gravatar_id":"","url":"https://api.github.com/users/pedrolob","html_url":"https://github.com/pedrolob","followers_url":"https://api.github.com/users/pedrolob/followers","following_url":"https://api.github.com/users/pedrolob/following{/other_user}","gists_url":"https://api.github.com/users/pedrolob/gists{/gist_id}","starred_url":"https://api.github.com/users/pedrolob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pedrolob/subscriptions","organizations_url":"https://api.github.com/users/pedrolob/orgs","repos_url":"https://api.github.com/users/pedrolob/repos","events_url":"https://api.github.com/users/pedrolob/events{/privacy}","received_events_url":"https://api.github.com/users/pedrolob/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/693338923","html_url":"https://github.com/medipixel/rl_algorithms/issues/270#issuecomment-693338923","issue_url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/270","id":693338923,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MzMzODkyMw==","user":{"login":"pedrolob","id":649124,"node_id":"MDQ6VXNlcjY0OTEyNA==","avatar_url":"https://avatars.githubusercontent.com/u/649124?v=4","gravatar_id":"","url":"https://api.github.com/users/pedrolob","html_url":"https://github.com/pedrolob","followers_url":"https://api.github.com/users/pedrolob/followers","following_url":"https://api.github.com/users/pedrolob/following{/other_user}","gists_url":"https://api.github.com/users/pedrolob/gists{/gist_id}","starred_url":"https://api.github.com/users/pedrolob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pedrolob/subscriptions","organizations_url":"https://api.github.com/users/pedrolob/orgs","repos_url":"https://api.github.com/users/pedrolob/repos","events_url":"https://api.github.com/users/pedrolob/events{/privacy}","received_events_url":"https://api.github.com/users/pedrolob/received_events","type":"User","site_admin":false},"created_at":"2020-09-16T11:15:19Z","updated_at":"2020-09-16T11:15:19Z","author_association":"NONE","body":"I've been do it more test but the problem continuous. The increase of batch size works sometime, but other not. That the problem with this issue, maybe occurs 5 minus after the training started or 5 hours, and sometimes never happens, but it's completely random. I didn't give a chance to the decreasing of learning rate because I don't think can help because of what I said before.\r\nI don't know what else to try, I test every parameter and none of them seems to improve or aggravate the situation (the last one was a very low LR). Maybe is some weird error with the version of numpy or pytorch, but really I don't know. Also I thought that maybe is an issue with my hardware, some kind of failure, unfortunately I don't have a way to prove it.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/693338923/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pedrolob","id":649124,"node_id":"MDQ6VXNlcjY0OTEyNA==","avatar_url":"https://avatars.githubusercontent.com/u/649124?v=4","gravatar_id":"","url":"https://api.github.com/users/pedrolob","html_url":"https://github.com/pedrolob","followers_url":"https://api.github.com/users/pedrolob/followers","following_url":"https://api.github.com/users/pedrolob/following{/other_user}","gists_url":"https://api.github.com/users/pedrolob/gists{/gist_id}","starred_url":"https://api.github.com/users/pedrolob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pedrolob/subscriptions","organizations_url":"https://api.github.com/users/pedrolob/orgs","repos_url":"https://api.github.com/users/pedrolob/repos","events_url":"https://api.github.com/users/pedrolob/events{/privacy}","received_events_url":"https://api.github.com/users/pedrolob/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/694609790","html_url":"https://github.com/medipixel/rl_algorithms/issues/270#issuecomment-694609790","issue_url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/270","id":694609790,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NDYwOTc5MA==","user":{"login":"jinPrelude","id":16518993,"node_id":"MDQ6VXNlcjE2NTE4OTkz","avatar_url":"https://avatars.githubusercontent.com/u/16518993?v=4","gravatar_id":"","url":"https://api.github.com/users/jinPrelude","html_url":"https://github.com/jinPrelude","followers_url":"https://api.github.com/users/jinPrelude/followers","following_url":"https://api.github.com/users/jinPrelude/following{/other_user}","gists_url":"https://api.github.com/users/jinPrelude/gists{/gist_id}","starred_url":"https://api.github.com/users/jinPrelude/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jinPrelude/subscriptions","organizations_url":"https://api.github.com/users/jinPrelude/orgs","repos_url":"https://api.github.com/users/jinPrelude/repos","events_url":"https://api.github.com/users/jinPrelude/events{/privacy}","received_events_url":"https://api.github.com/users/jinPrelude/received_events","type":"User","site_admin":false},"created_at":"2020-09-18T02:23:28Z","updated_at":"2020-09-18T02:25:22Z","author_association":"COLLABORATOR","body":"I tried training IQN in mario environment(https://pypi.org/project/gym-super-mario-bros/). Performance seems to require additional tuning, but training was stable(maybe our environment could be different). Loss was definitely bigger than I usually saw in other environment, but it didn't diverge or made fatal error. I made a branch for my mario environment test here, so give it a try : https://github.com/medipixel/rl_algorithms/tree/mario.\r\nThis is what training graphs looks like:\r\n![mario](https://user-images.githubusercontent.com/16518993/93547169-5e928b80-f99f-11ea-87f2-5daaa8d91ff5.png)\r\nBlue graph is CNN IQN with grayscale state & e-greddy & noisyNet, and green graph is ResNet IQN with grayscale state & noisyNet & 32 batch size. \r\nI only have tried only two types, but I think the following attempts are worth trying : \r\n- Bigger networks like using ResNet\r\n- reward scaling\r\n- state pre-process (resize, grayscale, etc)\r\n- Change buffer size & update-start-from & batch_size\r\n- longer training episode\r\n- etc\r\n\r\nIf you have other questions feel free to contact us. You can mail me for more questions.","reactions":{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/694609790/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jinPrelude","id":16518993,"node_id":"MDQ6VXNlcjE2NTE4OTkz","avatar_url":"https://avatars.githubusercontent.com/u/16518993?v=4","gravatar_id":"","url":"https://api.github.com/users/jinPrelude","html_url":"https://github.com/jinPrelude","followers_url":"https://api.github.com/users/jinPrelude/followers","following_url":"https://api.github.com/users/jinPrelude/following{/other_user}","gists_url":"https://api.github.com/users/jinPrelude/gists{/gist_id}","starred_url":"https://api.github.com/users/jinPrelude/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jinPrelude/subscriptions","organizations_url":"https://api.github.com/users/jinPrelude/orgs","repos_url":"https://api.github.com/users/jinPrelude/repos","events_url":"https://api.github.com/users/jinPrelude/events{/privacy}","received_events_url":"https://api.github.com/users/jinPrelude/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/694766086","html_url":"https://github.com/medipixel/rl_algorithms/issues/270#issuecomment-694766086","issue_url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/270","id":694766086,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NDc2NjA4Ng==","user":{"login":"pedrolob","id":649124,"node_id":"MDQ6VXNlcjY0OTEyNA==","avatar_url":"https://avatars.githubusercontent.com/u/649124?v=4","gravatar_id":"","url":"https://api.github.com/users/pedrolob","html_url":"https://github.com/pedrolob","followers_url":"https://api.github.com/users/pedrolob/followers","following_url":"https://api.github.com/users/pedrolob/following{/other_user}","gists_url":"https://api.github.com/users/pedrolob/gists{/gist_id}","starred_url":"https://api.github.com/users/pedrolob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pedrolob/subscriptions","organizations_url":"https://api.github.com/users/pedrolob/orgs","repos_url":"https://api.github.com/users/pedrolob/repos","events_url":"https://api.github.com/users/pedrolob/events{/privacy}","received_events_url":"https://api.github.com/users/pedrolob/received_events","type":"User","site_admin":false},"created_at":"2020-09-18T09:38:08Z","updated_at":"2020-09-18T09:38:08Z","author_association":"NONE","body":"I think I find the problem. When I train a game like Mario I use the change in position to reward the agent. Every positive changes in x is 1 reward. The issue seems to be in the n step algorithm that joins the rewards of 3 steps from what I saw, so you have 4 differents rewards: 0, 1, 2 and 2,97 (I don't know why). That seems to cause instability in the network and then the explode in loss occurs. \r\nWhat I tried was to remove n step (n_step = 1) and also clip the reward to 0.1. For now I don't see any issue but I nee to do more test in case I am having luck. It seems like having some many rewards cause some type of instability.\r\nAlso, I saw your test @jinPrelude, and I notice that you used gym-super-mario-bros. In my case I use retro gym, and maybe that is the problem. Also, when I use only the score to train I see that the problem doesn't occurs neither but doesn't converge so fast like using the position.\r\nIf not use use n step solve the problem maybe clipping the reward also when the experiences are joined maybe is the key. ","reactions":{"url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/comments/694766086/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pedrolob","id":649124,"node_id":"MDQ6VXNlcjY0OTEyNA==","avatar_url":"https://avatars.githubusercontent.com/u/649124?v=4","gravatar_id":"","url":"https://api.github.com/users/pedrolob","html_url":"https://github.com/pedrolob","followers_url":"https://api.github.com/users/pedrolob/followers","following_url":"https://api.github.com/users/pedrolob/following{/other_user}","gists_url":"https://api.github.com/users/pedrolob/gists{/gist_id}","starred_url":"https://api.github.com/users/pedrolob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pedrolob/subscriptions","organizations_url":"https://api.github.com/users/pedrolob/orgs","repos_url":"https://api.github.com/users/pedrolob/repos","events_url":"https://api.github.com/users/pedrolob/events{/privacy}","received_events_url":"https://api.github.com/users/pedrolob/received_events","type":"User","site_admin":false}},{"id":3781792473,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mzc4MTc5MjQ3Mw==","url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/events/3781792473","actor":{"login":"jinPrelude","id":16518993,"node_id":"MDQ6VXNlcjE2NTE4OTkz","avatar_url":"https://avatars.githubusercontent.com/u/16518993?v=4","gravatar_id":"","url":"https://api.github.com/users/jinPrelude","html_url":"https://github.com/jinPrelude","followers_url":"https://api.github.com/users/jinPrelude/followers","following_url":"https://api.github.com/users/jinPrelude/following{/other_user}","gists_url":"https://api.github.com/users/jinPrelude/gists{/gist_id}","starred_url":"https://api.github.com/users/jinPrelude/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jinPrelude/subscriptions","organizations_url":"https://api.github.com/users/jinPrelude/orgs","repos_url":"https://api.github.com/users/jinPrelude/repos","events_url":"https://api.github.com/users/jinPrelude/events{/privacy}","received_events_url":"https://api.github.com/users/jinPrelude/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-09-18T09:38:08Z","performed_via_github_app":null},{"id":3781792479,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM3ODE3OTI0Nzk=","url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/events/3781792479","actor":{"login":"jinPrelude","id":16518993,"node_id":"MDQ6VXNlcjE2NTE4OTkz","avatar_url":"https://avatars.githubusercontent.com/u/16518993?v=4","gravatar_id":"","url":"https://api.github.com/users/jinPrelude","html_url":"https://github.com/jinPrelude","followers_url":"https://api.github.com/users/jinPrelude/followers","following_url":"https://api.github.com/users/jinPrelude/following{/other_user}","gists_url":"https://api.github.com/users/jinPrelude/gists{/gist_id}","starred_url":"https://api.github.com/users/jinPrelude/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jinPrelude/subscriptions","organizations_url":"https://api.github.com/users/jinPrelude/orgs","repos_url":"https://api.github.com/users/jinPrelude/repos","events_url":"https://api.github.com/users/jinPrelude/events{/privacy}","received_events_url":"https://api.github.com/users/jinPrelude/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-09-18T09:38:08Z","performed_via_github_app":null},{"id":4406509521,"node_id":"MDExOkNsb3NlZEV2ZW50NDQwNjUwOTUyMQ==","url":"https://api.github.com/repos/medipixel/rl_algorithms/issues/events/4406509521","actor":{"login":"MrSyee","id":17582508,"node_id":"MDQ6VXNlcjE3NTgyNTA4","avatar_url":"https://avatars.githubusercontent.com/u/17582508?v=4","gravatar_id":"","url":"https://api.github.com/users/MrSyee","html_url":"https://github.com/MrSyee","followers_url":"https://api.github.com/users/MrSyee/followers","following_url":"https://api.github.com/users/MrSyee/following{/other_user}","gists_url":"https://api.github.com/users/MrSyee/gists{/gist_id}","starred_url":"https://api.github.com/users/MrSyee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MrSyee/subscriptions","organizations_url":"https://api.github.com/users/MrSyee/orgs","repos_url":"https://api.github.com/users/MrSyee/repos","events_url":"https://api.github.com/users/MrSyee/events{/privacy}","received_events_url":"https://api.github.com/users/MrSyee/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-03-04T08:13:50Z","state_reason":null,"performed_via_github_app":null}]