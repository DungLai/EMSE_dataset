[{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/424978989","html_url":"https://github.com/onnx/onnxmltools/issues/138#issuecomment-424978989","issue_url":"https://api.github.com/repos/onnx/onnxmltools/issues/138","id":424978989,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDk3ODk4OQ==","user":{"login":"pinkwerks","id":538256,"node_id":"MDQ6VXNlcjUzODI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/538256?v=4","gravatar_id":"","url":"https://api.github.com/users/pinkwerks","html_url":"https://github.com/pinkwerks","followers_url":"https://api.github.com/users/pinkwerks/followers","following_url":"https://api.github.com/users/pinkwerks/following{/other_user}","gists_url":"https://api.github.com/users/pinkwerks/gists{/gist_id}","starred_url":"https://api.github.com/users/pinkwerks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pinkwerks/subscriptions","organizations_url":"https://api.github.com/users/pinkwerks/orgs","repos_url":"https://api.github.com/users/pinkwerks/repos","events_url":"https://api.github.com/users/pinkwerks/events{/privacy}","received_events_url":"https://api.github.com/users/pinkwerks/received_events","type":"User","site_admin":false},"created_at":"2018-09-27T06:53:58Z","updated_at":"2018-09-27T22:18:57Z","author_association":"NONE","body":"To clarify, I wasn't sure if the file was invalid. Netron was able to view them both so.ill assume this is a loader problem with windows.ai.","reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/424978989/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pinkwerks","id":538256,"node_id":"MDQ6VXNlcjUzODI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/538256?v=4","gravatar_id":"","url":"https://api.github.com/users/pinkwerks","html_url":"https://github.com/pinkwerks","followers_url":"https://api.github.com/users/pinkwerks/followers","following_url":"https://api.github.com/users/pinkwerks/following{/other_user}","gists_url":"https://api.github.com/users/pinkwerks/gists{/gist_id}","starred_url":"https://api.github.com/users/pinkwerks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pinkwerks/subscriptions","organizations_url":"https://api.github.com/users/pinkwerks/orgs","repos_url":"https://api.github.com/users/pinkwerks/repos","events_url":"https://api.github.com/users/pinkwerks/events{/privacy}","received_events_url":"https://api.github.com/users/pinkwerks/received_events","type":"User","site_admin":false}},{"id":1870213237,"node_id":"MDExOkNsb3NlZEV2ZW50MTg3MDIxMzIzNw==","url":"https://api.github.com/repos/onnx/onnxmltools/issues/events/1870213237","actor":{"login":"pinkwerks","id":538256,"node_id":"MDQ6VXNlcjUzODI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/538256?v=4","gravatar_id":"","url":"https://api.github.com/users/pinkwerks","html_url":"https://github.com/pinkwerks","followers_url":"https://api.github.com/users/pinkwerks/followers","following_url":"https://api.github.com/users/pinkwerks/following{/other_user}","gists_url":"https://api.github.com/users/pinkwerks/gists{/gist_id}","starred_url":"https://api.github.com/users/pinkwerks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pinkwerks/subscriptions","organizations_url":"https://api.github.com/users/pinkwerks/orgs","repos_url":"https://api.github.com/users/pinkwerks/repos","events_url":"https://api.github.com/users/pinkwerks/events{/privacy}","received_events_url":"https://api.github.com/users/pinkwerks/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2018-09-27T06:53:58Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/425218074","html_url":"https://github.com/onnx/onnxmltools/issues/138#issuecomment-425218074","issue_url":"https://api.github.com/repos/onnx/onnxmltools/issues/138","id":425218074,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTIxODA3NA==","user":{"login":"yskim1501","id":2562001,"node_id":"MDQ6VXNlcjI1NjIwMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562001?v=4","gravatar_id":"","url":"https://api.github.com/users/yskim1501","html_url":"https://github.com/yskim1501","followers_url":"https://api.github.com/users/yskim1501/followers","following_url":"https://api.github.com/users/yskim1501/following{/other_user}","gists_url":"https://api.github.com/users/yskim1501/gists{/gist_id}","starred_url":"https://api.github.com/users/yskim1501/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yskim1501/subscriptions","organizations_url":"https://api.github.com/users/yskim1501/orgs","repos_url":"https://api.github.com/users/yskim1501/repos","events_url":"https://api.github.com/users/yskim1501/events{/privacy}","received_events_url":"https://api.github.com/users/yskim1501/received_events","type":"User","site_admin":false},"created_at":"2018-09-27T19:40:35Z","updated_at":"2018-09-27T19:40:35Z","author_association":"NONE","body":"Hi, thank you reporting your problem. In general, the fact that you can view the model in Netron does not imply that it can run on Windows.AI.Machinelearning platform. In the future, we will be providing a tool called winmltools that could potentially provide more information about validity of onnx model for Windows platform.\r\n\r\nHaving said that, we would still love to help this scenario! Were you able to solve this problem yet?","reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/425218074/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yskim1501","id":2562001,"node_id":"MDQ6VXNlcjI1NjIwMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562001?v=4","gravatar_id":"","url":"https://api.github.com/users/yskim1501","html_url":"https://github.com/yskim1501","followers_url":"https://api.github.com/users/yskim1501/followers","following_url":"https://api.github.com/users/yskim1501/following{/other_user}","gists_url":"https://api.github.com/users/yskim1501/gists{/gist_id}","starred_url":"https://api.github.com/users/yskim1501/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yskim1501/subscriptions","organizations_url":"https://api.github.com/users/yskim1501/orgs","repos_url":"https://api.github.com/users/yskim1501/repos","events_url":"https://api.github.com/users/yskim1501/events{/privacy}","received_events_url":"https://api.github.com/users/yskim1501/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/425220148","html_url":"https://github.com/onnx/onnxmltools/issues/138#issuecomment-425220148","issue_url":"https://api.github.com/repos/onnx/onnxmltools/issues/138","id":425220148,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTIyMDE0OA==","user":{"login":"yskim1501","id":2562001,"node_id":"MDQ6VXNlcjI1NjIwMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562001?v=4","gravatar_id":"","url":"https://api.github.com/users/yskim1501","html_url":"https://github.com/yskim1501","followers_url":"https://api.github.com/users/yskim1501/followers","following_url":"https://api.github.com/users/yskim1501/following{/other_user}","gists_url":"https://api.github.com/users/yskim1501/gists{/gist_id}","starred_url":"https://api.github.com/users/yskim1501/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yskim1501/subscriptions","organizations_url":"https://api.github.com/users/yskim1501/orgs","repos_url":"https://api.github.com/users/yskim1501/repos","events_url":"https://api.github.com/users/yskim1501/events{/privacy}","received_events_url":"https://api.github.com/users/yskim1501/received_events","type":"User","site_admin":false},"created_at":"2018-09-27T19:48:44Z","updated_at":"2018-09-27T19:48:44Z","author_association":"NONE","body":"It looks to me like the model does not have a right permutation attribute for transpose operator. Input Shape of transpose is 2 dimensions while permutation is specifying 4 dimensions. Is this model coming from the onnxmltool?","reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/425220148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yskim1501","id":2562001,"node_id":"MDQ6VXNlcjI1NjIwMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562001?v=4","gravatar_id":"","url":"https://api.github.com/users/yskim1501","html_url":"https://github.com/yskim1501","followers_url":"https://api.github.com/users/yskim1501/followers","following_url":"https://api.github.com/users/yskim1501/following{/other_user}","gists_url":"https://api.github.com/users/yskim1501/gists{/gist_id}","starred_url":"https://api.github.com/users/yskim1501/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yskim1501/subscriptions","organizations_url":"https://api.github.com/users/yskim1501/orgs","repos_url":"https://api.github.com/users/yskim1501/repos","events_url":"https://api.github.com/users/yskim1501/events{/privacy}","received_events_url":"https://api.github.com/users/yskim1501/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/425254772","html_url":"https://github.com/onnx/onnxmltools/issues/138#issuecomment-425254772","issue_url":"https://api.github.com/repos/onnx/onnxmltools/issues/138","id":425254772,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTI1NDc3Mg==","user":{"login":"pinkwerks","id":538256,"node_id":"MDQ6VXNlcjUzODI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/538256?v=4","gravatar_id":"","url":"https://api.github.com/users/pinkwerks","html_url":"https://github.com/pinkwerks","followers_url":"https://api.github.com/users/pinkwerks/followers","following_url":"https://api.github.com/users/pinkwerks/following{/other_user}","gists_url":"https://api.github.com/users/pinkwerks/gists{/gist_id}","starred_url":"https://api.github.com/users/pinkwerks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pinkwerks/subscriptions","organizations_url":"https://api.github.com/users/pinkwerks/orgs","repos_url":"https://api.github.com/users/pinkwerks/repos","events_url":"https://api.github.com/users/pinkwerks/events{/privacy}","received_events_url":"https://api.github.com/users/pinkwerks/received_events","type":"User","site_admin":false},"created_at":"2018-09-27T21:51:37Z","updated_at":"2018-09-27T22:03:14Z","author_association":"NONE","body":"Hi, thanks for the help!\r\n\r\nThis model was created in Keras. Then exported using onnxmltools. I'm unclear if this is a translation problem, or the Windows.AI API is having an issue parsing something valid. FWIW the model \"just worked\" in keras. This is my model in keras and how I'm exporting it.\r\n\r\n```\r\ndef baseline_model(num_classes=12, num_dim=33):\r\n    # create model\r\n    model = Sequential()   \r\n    model.add(Dense(num_classes * num_classes * num_classes, input_dim=num_dim))\r\n    model.add(BatchNormalization());\r\n    model.add(Activation('tanh'))\r\n    model.add(Dense(num_classes * num_classes, input_dim=num_dim))\r\n    model.add(BatchNormalization());\r\n    model.add(Activation('tanh'))\r\n    model.add(Dense(num_classes, input_dim=num_dim))\r\n    model.add(BatchNormalization());\r\n    model.add(Activation('tanh'))\r\n    model.add(Dense(num_classes, activation='softmax'))   \r\n    model.compile(loss='categorical_crossentropy', optimizer=\"adam\", metrics=['accuracy'])\r\n    return model\r\n\r\nmodel4 = baseline_model()\r\nonnx_model = onnxmltools.convert_keras(model4)\r\n\r\n# Save as protobuf\r\nonnxmltools.utils.save_model(onnx_model, 'model4.onnx')\r\n```\r\nAnd from this example:\r\nException thrown: 'System.Runtime.InteropServices.COMException' in System.Private.CoreLib.dll\r\nWinRT information: [TypeInferenceError] Invalid attribute perm {0, 3, 1, 2}, input shape = {1, 1728}\r\n\r\nAgain, I'm not enough of an expert to understand where this is going bonkers. Thanks for looking.","reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/425254772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pinkwerks","id":538256,"node_id":"MDQ6VXNlcjUzODI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/538256?v=4","gravatar_id":"","url":"https://api.github.com/users/pinkwerks","html_url":"https://github.com/pinkwerks","followers_url":"https://api.github.com/users/pinkwerks/followers","following_url":"https://api.github.com/users/pinkwerks/following{/other_user}","gists_url":"https://api.github.com/users/pinkwerks/gists{/gist_id}","starred_url":"https://api.github.com/users/pinkwerks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pinkwerks/subscriptions","organizations_url":"https://api.github.com/users/pinkwerks/orgs","repos_url":"https://api.github.com/users/pinkwerks/repos","events_url":"https://api.github.com/users/pinkwerks/events{/privacy}","received_events_url":"https://api.github.com/users/pinkwerks/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/425258298","html_url":"https://github.com/onnx/onnxmltools/issues/138#issuecomment-425258298","issue_url":"https://api.github.com/repos/onnx/onnxmltools/issues/138","id":425258298,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTI1ODI5OA==","user":{"login":"yskim1501","id":2562001,"node_id":"MDQ6VXNlcjI1NjIwMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562001?v=4","gravatar_id":"","url":"https://api.github.com/users/yskim1501","html_url":"https://github.com/yskim1501","followers_url":"https://api.github.com/users/yskim1501/followers","following_url":"https://api.github.com/users/yskim1501/following{/other_user}","gists_url":"https://api.github.com/users/yskim1501/gists{/gist_id}","starred_url":"https://api.github.com/users/yskim1501/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yskim1501/subscriptions","organizations_url":"https://api.github.com/users/yskim1501/orgs","repos_url":"https://api.github.com/users/yskim1501/repos","events_url":"https://api.github.com/users/yskim1501/events{/privacy}","received_events_url":"https://api.github.com/users/yskim1501/received_events","type":"User","site_admin":false},"created_at":"2018-09-27T22:07:08Z","updated_at":"2018-09-27T22:07:08Z","author_association":"NONE","body":"Thanks for that snippet. This will help us debug what is going on. My initial guess is that this problem is coming from the onnxmltools since this look like an invalid onnx file. I will update you with more details. ","reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/425258298/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yskim1501","id":2562001,"node_id":"MDQ6VXNlcjI1NjIwMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562001?v=4","gravatar_id":"","url":"https://api.github.com/users/yskim1501","html_url":"https://github.com/yskim1501","followers_url":"https://api.github.com/users/yskim1501/followers","following_url":"https://api.github.com/users/yskim1501/following{/other_user}","gists_url":"https://api.github.com/users/yskim1501/gists{/gist_id}","starred_url":"https://api.github.com/users/yskim1501/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yskim1501/subscriptions","organizations_url":"https://api.github.com/users/yskim1501/orgs","repos_url":"https://api.github.com/users/yskim1501/repos","events_url":"https://api.github.com/users/yskim1501/events{/privacy}","received_events_url":"https://api.github.com/users/yskim1501/received_events","type":"User","site_admin":false}},{"id":1877354667,"node_id":"MDEzOlJlb3BlbmVkRXZlbnQxODc3MzU0NjY3","url":"https://api.github.com/repos/onnx/onnxmltools/issues/events/1877354667","actor":{"login":"pinkwerks","id":538256,"node_id":"MDQ6VXNlcjUzODI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/538256?v=4","gravatar_id":"","url":"https://api.github.com/users/pinkwerks","html_url":"https://github.com/pinkwerks","followers_url":"https://api.github.com/users/pinkwerks/followers","following_url":"https://api.github.com/users/pinkwerks/following{/other_user}","gists_url":"https://api.github.com/users/pinkwerks/gists{/gist_id}","starred_url":"https://api.github.com/users/pinkwerks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pinkwerks/subscriptions","organizations_url":"https://api.github.com/users/pinkwerks/orgs","repos_url":"https://api.github.com/users/pinkwerks/repos","events_url":"https://api.github.com/users/pinkwerks/events{/privacy}","received_events_url":"https://api.github.com/users/pinkwerks/received_events","type":"User","site_admin":false},"event":"reopened","commit_id":null,"commit_url":null,"created_at":"2018-10-01T17:34:32Z","state_reason":null,"performed_via_github_app":null},{"actor":{"login":"yskim1501","id":2562001,"node_id":"MDQ6VXNlcjI1NjIwMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562001?v=4","gravatar_id":"","url":"https://api.github.com/users/yskim1501","html_url":"https://github.com/yskim1501","followers_url":"https://api.github.com/users/yskim1501/followers","following_url":"https://api.github.com/users/yskim1501/following{/other_user}","gists_url":"https://api.github.com/users/yskim1501/gists{/gist_id}","starred_url":"https://api.github.com/users/yskim1501/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yskim1501/subscriptions","organizations_url":"https://api.github.com/users/yskim1501/orgs","repos_url":"https://api.github.com/users/yskim1501/repos","events_url":"https://api.github.com/users/yskim1501/events{/privacy}","received_events_url":"https://api.github.com/users/yskim1501/received_events","type":"User","site_admin":false},"created_at":"2018-10-03T00:31:37Z","updated_at":"2018-10-03T00:31:37Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/141","repository_url":"https://api.github.com/repos/onnx/onnxmltools","labels_url":"https://api.github.com/repos/onnx/onnxmltools/issues/141/labels{/name}","comments_url":"https://api.github.com/repos/onnx/onnxmltools/issues/141/comments","events_url":"https://api.github.com/repos/onnx/onnxmltools/issues/141/events","html_url":"https://github.com/onnx/onnxmltools/pull/141","id":366129686,"node_id":"MDExOlB1bGxSZXF1ZXN0MjE5ODgzOTMw","number":141,"title":"Fix batch normalization","user":{"login":"yskim1501","id":2562001,"node_id":"MDQ6VXNlcjI1NjIwMDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562001?v=4","gravatar_id":"","url":"https://api.github.com/users/yskim1501","html_url":"https://github.com/yskim1501","followers_url":"https://api.github.com/users/yskim1501/followers","following_url":"https://api.github.com/users/yskim1501/following{/other_user}","gists_url":"https://api.github.com/users/yskim1501/gists{/gist_id}","starred_url":"https://api.github.com/users/yskim1501/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yskim1501/subscriptions","organizations_url":"https://api.github.com/users/yskim1501/orgs","repos_url":"https://api.github.com/users/yskim1501/repos","events_url":"https://api.github.com/users/yskim1501/events{/privacy}","received_events_url":"https://api.github.com/users/yskim1501/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-10-03T00:29:53Z","updated_at":"2018-10-26T06:15:29Z","closed_at":"2018-10-26T06:15:29Z","author_association":"NONE","active_lock_reason":null,"draft":false,"repository":{"id":121798175,"node_id":"MDEwOlJlcG9zaXRvcnkxMjE3OTgxNzU=","name":"onnxmltools","full_name":"onnx/onnxmltools","private":false,"owner":{"login":"onnx","id":31675368,"node_id":"MDEyOk9yZ2FuaXphdGlvbjMxNjc1MzY4","avatar_url":"https://avatars.githubusercontent.com/u/31675368?v=4","gravatar_id":"","url":"https://api.github.com/users/onnx","html_url":"https://github.com/onnx","followers_url":"https://api.github.com/users/onnx/followers","following_url":"https://api.github.com/users/onnx/following{/other_user}","gists_url":"https://api.github.com/users/onnx/gists{/gist_id}","starred_url":"https://api.github.com/users/onnx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/onnx/subscriptions","organizations_url":"https://api.github.com/users/onnx/orgs","repos_url":"https://api.github.com/users/onnx/repos","events_url":"https://api.github.com/users/onnx/events{/privacy}","received_events_url":"https://api.github.com/users/onnx/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/onnx/onnxmltools","description":"ONNXMLTools enables conversion of models to ONNX","fork":false,"url":"https://api.github.com/repos/onnx/onnxmltools","forks_url":"https://api.github.com/repos/onnx/onnxmltools/forks","keys_url":"https://api.github.com/repos/onnx/onnxmltools/keys{/key_id}","collaborators_url":"https://api.github.com/repos/onnx/onnxmltools/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/onnx/onnxmltools/teams","hooks_url":"https://api.github.com/repos/onnx/onnxmltools/hooks","issue_events_url":"https://api.github.com/repos/onnx/onnxmltools/issues/events{/number}","events_url":"https://api.github.com/repos/onnx/onnxmltools/events","assignees_url":"https://api.github.com/repos/onnx/onnxmltools/assignees{/user}","branches_url":"https://api.github.com/repos/onnx/onnxmltools/branches{/branch}","tags_url":"https://api.github.com/repos/onnx/onnxmltools/tags","blobs_url":"https://api.github.com/repos/onnx/onnxmltools/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/onnx/onnxmltools/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/onnx/onnxmltools/git/refs{/sha}","trees_url":"https://api.github.com/repos/onnx/onnxmltools/git/trees{/sha}","statuses_url":"https://api.github.com/repos/onnx/onnxmltools/statuses/{sha}","languages_url":"https://api.github.com/repos/onnx/onnxmltools/languages","stargazers_url":"https://api.github.com/repos/onnx/onnxmltools/stargazers","contributors_url":"https://api.github.com/repos/onnx/onnxmltools/contributors","subscribers_url":"https://api.github.com/repos/onnx/onnxmltools/subscribers","subscription_url":"https://api.github.com/repos/onnx/onnxmltools/subscription","commits_url":"https://api.github.com/repos/onnx/onnxmltools/commits{/sha}","git_commits_url":"https://api.github.com/repos/onnx/onnxmltools/git/commits{/sha}","comments_url":"https://api.github.com/repos/onnx/onnxmltools/comments{/number}","issue_comment_url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments{/number}","contents_url":"https://api.github.com/repos/onnx/onnxmltools/contents/{+path}","compare_url":"https://api.github.com/repos/onnx/onnxmltools/compare/{base}...{head}","merges_url":"https://api.github.com/repos/onnx/onnxmltools/merges","archive_url":"https://api.github.com/repos/onnx/onnxmltools/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/onnx/onnxmltools/downloads","issues_url":"https://api.github.com/repos/onnx/onnxmltools/issues{/number}","pulls_url":"https://api.github.com/repos/onnx/onnxmltools/pulls{/number}","milestones_url":"https://api.github.com/repos/onnx/onnxmltools/milestones{/number}","notifications_url":"https://api.github.com/repos/onnx/onnxmltools/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/onnx/onnxmltools/labels{/name}","releases_url":"https://api.github.com/repos/onnx/onnxmltools/releases{/id}","deployments_url":"https://api.github.com/repos/onnx/onnxmltools/deployments","created_at":"2018-02-16T20:37:33Z","updated_at":"2023-01-18T07:05:25Z","pushed_at":"2023-01-18T18:13:14Z","git_url":"git://github.com/onnx/onnxmltools.git","ssh_url":"git@github.com:onnx/onnxmltools.git","clone_url":"https://github.com/onnx/onnxmltools.git","svn_url":"https://github.com/onnx/onnxmltools","homepage":"https://onnx.ai","size":3395,"stargazers_count":720,"watchers_count":720,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":false,"forks_count":161,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":104,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["keras","machine-learning","onnx","python-library","scikit-learn"],"visibility":"public","forks":161,"open_issues":104,"watchers":720,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/onnx/onnxmltools/pulls/141","html_url":"https://github.com/onnx/onnxmltools/pull/141","diff_url":"https://github.com/onnx/onnxmltools/pull/141.diff","patch_url":"https://github.com/onnx/onnxmltools/pull/141.patch","merged_at":null},"body":"This change is to fix the case when batch normalization is applied to non 4-D dimensional tensors. ","reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/onnxmltools/issues/141/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/438459581","html_url":"https://github.com/onnx/onnxmltools/issues/138#issuecomment-438459581","issue_url":"https://api.github.com/repos/onnx/onnxmltools/issues/138","id":438459581,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODQ1OTU4MQ==","user":{"login":"pinkwerks","id":538256,"node_id":"MDQ6VXNlcjUzODI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/538256?v=4","gravatar_id":"","url":"https://api.github.com/users/pinkwerks","html_url":"https://github.com/pinkwerks","followers_url":"https://api.github.com/users/pinkwerks/followers","following_url":"https://api.github.com/users/pinkwerks/following{/other_user}","gists_url":"https://api.github.com/users/pinkwerks/gists{/gist_id}","starred_url":"https://api.github.com/users/pinkwerks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pinkwerks/subscriptions","organizations_url":"https://api.github.com/users/pinkwerks/orgs","repos_url":"https://api.github.com/users/pinkwerks/repos","events_url":"https://api.github.com/users/pinkwerks/events{/privacy}","received_events_url":"https://api.github.com/users/pinkwerks/received_events","type":"User","site_admin":false},"created_at":"2018-11-13T22:17:22Z","updated_at":"2018-11-13T22:17:22Z","author_association":"NONE","body":"The linked item was closed - does that mean this issue was resolved?","reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/438459581/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pinkwerks","id":538256,"node_id":"MDQ6VXNlcjUzODI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/538256?v=4","gravatar_id":"","url":"https://api.github.com/users/pinkwerks","html_url":"https://github.com/pinkwerks","followers_url":"https://api.github.com/users/pinkwerks/followers","following_url":"https://api.github.com/users/pinkwerks/following{/other_user}","gists_url":"https://api.github.com/users/pinkwerks/gists{/gist_id}","starred_url":"https://api.github.com/users/pinkwerks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pinkwerks/subscriptions","organizations_url":"https://api.github.com/users/pinkwerks/orgs","repos_url":"https://api.github.com/users/pinkwerks/repos","events_url":"https://api.github.com/users/pinkwerks/events{/privacy}","received_events_url":"https://api.github.com/users/pinkwerks/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/461203500","html_url":"https://github.com/onnx/onnxmltools/issues/138#issuecomment-461203500","issue_url":"https://api.github.com/repos/onnx/onnxmltools/issues/138","id":461203500,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MTIwMzUwMA==","user":{"login":"jiafatom","id":30608893,"node_id":"MDQ6VXNlcjMwNjA4ODkz","avatar_url":"https://avatars.githubusercontent.com/u/30608893?v=4","gravatar_id":"","url":"https://api.github.com/users/jiafatom","html_url":"https://github.com/jiafatom","followers_url":"https://api.github.com/users/jiafatom/followers","following_url":"https://api.github.com/users/jiafatom/following{/other_user}","gists_url":"https://api.github.com/users/jiafatom/gists{/gist_id}","starred_url":"https://api.github.com/users/jiafatom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiafatom/subscriptions","organizations_url":"https://api.github.com/users/jiafatom/orgs","repos_url":"https://api.github.com/users/jiafatom/repos","events_url":"https://api.github.com/users/jiafatom/events{/privacy}","received_events_url":"https://api.github.com/users/jiafatom/received_events","type":"User","site_admin":false},"created_at":"2019-02-06T21:55:25Z","updated_at":"2019-02-06T21:55:25Z","author_association":"COLLABORATOR","body":"@pinkwerks , I just tested your snippet, and it works well now. Please try https://github.com/onnx/keras-onnx because we have moved the keras2onnx converter there. See Readme.md there. I just use your snippet and use ```keras2onnx.convert_keras``` to convert keras model.\r\n```\r\ndef baseline_model(num_classes=12, num_dim=33):\r\n    # create model\r\n    model = Sequential()   \r\n    model.add(Dense(num_classes * num_classes * num_classes, input_dim=num_dim))\r\n    model.add(BatchNormalization());\r\n    model.add(Activation('tanh'))\r\n    model.add(Dense(num_classes * num_classes, input_dim=num_dim))\r\n    model.add(BatchNormalization());\r\n    model.add(Activation('tanh'))\r\n    model.add(Dense(num_classes, input_dim=num_dim))\r\n    model.add(BatchNormalization());\r\n    model.add(Activation('tanh'))\r\n    model.add(Dense(num_classes, activation='softmax'))   \r\n    model.compile(loss='categorical_crossentropy', optimizer=\"adam\", metrics=['accuracy'])\r\n    return model\r\n\r\nmodel4 = baseline_model()\r\n# use keras2onnx.convert_keras here\r\nonnx_model = keras2onnx.convert_keras(model4, \"model4\")\r\nonnx.save_model(onnx_model, 'model4.onnx')\r\n\r\ncontent = onnx_model.SerializeToString()\r\nsess = onnxruntime.InferenceSession(content)\r\nx = np.random.uniform(-0.5, 0.5, size=(1, 33)).astype(np.float32)\r\nx = x if isinstance(x, list) else [x]\r\nfeed = dict([(input.name, x[n]) for n, input in enumerate(sess.get_inputs())])\r\npred_onnx = sess.run(None, feed)\r\n```\r\nand it gives me the same result as original keras prediction. Please let us know if you have further questions.","reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/461203500/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jiafatom","id":30608893,"node_id":"MDQ6VXNlcjMwNjA4ODkz","avatar_url":"https://avatars.githubusercontent.com/u/30608893?v=4","gravatar_id":"","url":"https://api.github.com/users/jiafatom","html_url":"https://github.com/jiafatom","followers_url":"https://api.github.com/users/jiafatom/followers","following_url":"https://api.github.com/users/jiafatom/following{/other_user}","gists_url":"https://api.github.com/users/jiafatom/gists{/gist_id}","starred_url":"https://api.github.com/users/jiafatom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiafatom/subscriptions","organizations_url":"https://api.github.com/users/jiafatom/orgs","repos_url":"https://api.github.com/users/jiafatom/repos","events_url":"https://api.github.com/users/jiafatom/events{/privacy}","received_events_url":"https://api.github.com/users/jiafatom/received_events","type":"User","site_admin":false}},{"id":2122549068,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjEyMjU0OTA2OA==","url":"https://api.github.com/repos/onnx/onnxmltools/issues/events/2122549068","actor":{"login":"pinkwerks","id":538256,"node_id":"MDQ6VXNlcjUzODI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/538256?v=4","gravatar_id":"","url":"https://api.github.com/users/pinkwerks","html_url":"https://github.com/pinkwerks","followers_url":"https://api.github.com/users/pinkwerks/followers","following_url":"https://api.github.com/users/pinkwerks/following{/other_user}","gists_url":"https://api.github.com/users/pinkwerks/gists{/gist_id}","starred_url":"https://api.github.com/users/pinkwerks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pinkwerks/subscriptions","organizations_url":"https://api.github.com/users/pinkwerks/orgs","repos_url":"https://api.github.com/users/pinkwerks/repos","events_url":"https://api.github.com/users/pinkwerks/events{/privacy}","received_events_url":"https://api.github.com/users/pinkwerks/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-02-06T21:55:25Z","performed_via_github_app":null},{"id":2122549069,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIxMjI1NDkwNjk=","url":"https://api.github.com/repos/onnx/onnxmltools/issues/events/2122549069","actor":{"login":"pinkwerks","id":538256,"node_id":"MDQ6VXNlcjUzODI1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/538256?v=4","gravatar_id":"","url":"https://api.github.com/users/pinkwerks","html_url":"https://github.com/pinkwerks","followers_url":"https://api.github.com/users/pinkwerks/followers","following_url":"https://api.github.com/users/pinkwerks/following{/other_user}","gists_url":"https://api.github.com/users/pinkwerks/gists{/gist_id}","starred_url":"https://api.github.com/users/pinkwerks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pinkwerks/subscriptions","organizations_url":"https://api.github.com/users/pinkwerks/orgs","repos_url":"https://api.github.com/users/pinkwerks/repos","events_url":"https://api.github.com/users/pinkwerks/events{/privacy}","received_events_url":"https://api.github.com/users/pinkwerks/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-02-06T21:55:25Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/462454859","html_url":"https://github.com/onnx/onnxmltools/issues/138#issuecomment-462454859","issue_url":"https://api.github.com/repos/onnx/onnxmltools/issues/138","id":462454859,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MjQ1NDg1OQ==","user":{"login":"jiafatom","id":30608893,"node_id":"MDQ6VXNlcjMwNjA4ODkz","avatar_url":"https://avatars.githubusercontent.com/u/30608893?v=4","gravatar_id":"","url":"https://api.github.com/users/jiafatom","html_url":"https://github.com/jiafatom","followers_url":"https://api.github.com/users/jiafatom/followers","following_url":"https://api.github.com/users/jiafatom/following{/other_user}","gists_url":"https://api.github.com/users/jiafatom/gists{/gist_id}","starred_url":"https://api.github.com/users/jiafatom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiafatom/subscriptions","organizations_url":"https://api.github.com/users/jiafatom/orgs","repos_url":"https://api.github.com/users/jiafatom/repos","events_url":"https://api.github.com/users/jiafatom/events{/privacy}","received_events_url":"https://api.github.com/users/jiafatom/received_events","type":"User","site_admin":false},"created_at":"2019-02-11T19:11:02Z","updated_at":"2019-02-11T19:11:02Z","author_association":"COLLABORATOR","body":"Resolved -- see my comments above, close the issue. Feel free to reopen if there are further concerns.","reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/comments/462454859/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jiafatom","id":30608893,"node_id":"MDQ6VXNlcjMwNjA4ODkz","avatar_url":"https://avatars.githubusercontent.com/u/30608893?v=4","gravatar_id":"","url":"https://api.github.com/users/jiafatom","html_url":"https://github.com/jiafatom","followers_url":"https://api.github.com/users/jiafatom/followers","following_url":"https://api.github.com/users/jiafatom/following{/other_user}","gists_url":"https://api.github.com/users/jiafatom/gists{/gist_id}","starred_url":"https://api.github.com/users/jiafatom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiafatom/subscriptions","organizations_url":"https://api.github.com/users/jiafatom/orgs","repos_url":"https://api.github.com/users/jiafatom/repos","events_url":"https://api.github.com/users/jiafatom/events{/privacy}","received_events_url":"https://api.github.com/users/jiafatom/received_events","type":"User","site_admin":false}},{"id":2131514052,"node_id":"MDExOkNsb3NlZEV2ZW50MjEzMTUxNDA1Mg==","url":"https://api.github.com/repos/onnx/onnxmltools/issues/events/2131514052","actor":{"login":"jiafatom","id":30608893,"node_id":"MDQ6VXNlcjMwNjA4ODkz","avatar_url":"https://avatars.githubusercontent.com/u/30608893?v=4","gravatar_id":"","url":"https://api.github.com/users/jiafatom","html_url":"https://github.com/jiafatom","followers_url":"https://api.github.com/users/jiafatom/followers","following_url":"https://api.github.com/users/jiafatom/following{/other_user}","gists_url":"https://api.github.com/users/jiafatom/gists{/gist_id}","starred_url":"https://api.github.com/users/jiafatom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiafatom/subscriptions","organizations_url":"https://api.github.com/users/jiafatom/orgs","repos_url":"https://api.github.com/users/jiafatom/repos","events_url":"https://api.github.com/users/jiafatom/events{/privacy}","received_events_url":"https://api.github.com/users/jiafatom/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-02-11T19:11:02Z","state_reason":null,"performed_via_github_app":null},{"actor":{"login":"mikhail-barg","id":2208971,"node_id":"MDQ6VXNlcjIyMDg5NzE=","avatar_url":"https://avatars.githubusercontent.com/u/2208971?v=4","gravatar_id":"","url":"https://api.github.com/users/mikhail-barg","html_url":"https://github.com/mikhail-barg","followers_url":"https://api.github.com/users/mikhail-barg/followers","following_url":"https://api.github.com/users/mikhail-barg/following{/other_user}","gists_url":"https://api.github.com/users/mikhail-barg/gists{/gist_id}","starred_url":"https://api.github.com/users/mikhail-barg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikhail-barg/subscriptions","organizations_url":"https://api.github.com/users/mikhail-barg/orgs","repos_url":"https://api.github.com/users/mikhail-barg/repos","events_url":"https://api.github.com/users/mikhail-barg/events{/privacy}","received_events_url":"https://api.github.com/users/mikhail-barg/received_events","type":"User","site_admin":false},"created_at":"2019-05-03T12:42:51Z","updated_at":"2019-05-03T12:42:51Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/onnx/keras-onnx/issues/77","repository_url":"https://api.github.com/repos/onnx/keras-onnx","labels_url":"https://api.github.com/repos/onnx/keras-onnx/issues/77/labels{/name}","comments_url":"https://api.github.com/repos/onnx/keras-onnx/issues/77/comments","events_url":"https://api.github.com/repos/onnx/keras-onnx/issues/77/events","html_url":"https://github.com/onnx/keras-onnx/issues/77","id":440016320,"node_id":"MDU6SXNzdWU0NDAwMTYzMjA=","number":77,"title":"Failed to read converted model","user":{"login":"mikhail-barg","id":2208971,"node_id":"MDQ6VXNlcjIyMDg5NzE=","avatar_url":"https://avatars.githubusercontent.com/u/2208971?v=4","gravatar_id":"","url":"https://api.github.com/users/mikhail-barg","html_url":"https://github.com/mikhail-barg","followers_url":"https://api.github.com/users/mikhail-barg/followers","following_url":"https://api.github.com/users/mikhail-barg/following{/other_user}","gists_url":"https://api.github.com/users/mikhail-barg/gists{/gist_id}","starred_url":"https://api.github.com/users/mikhail-barg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikhail-barg/subscriptions","organizations_url":"https://api.github.com/users/mikhail-barg/orgs","repos_url":"https://api.github.com/users/mikhail-barg/repos","events_url":"https://api.github.com/users/mikhail-barg/events{/privacy}","received_events_url":"https://api.github.com/users/mikhail-barg/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2019-05-03T12:07:04Z","updated_at":"2019-05-09T17:44:32Z","closed_at":"2019-05-09T08:07:52Z","author_association":"NONE","active_lock_reason":null,"repository":{"id":162340677,"node_id":"MDEwOlJlcG9zaXRvcnkxNjIzNDA2Nzc=","name":"keras-onnx","full_name":"onnx/keras-onnx","private":false,"owner":{"login":"onnx","id":31675368,"node_id":"MDEyOk9yZ2FuaXphdGlvbjMxNjc1MzY4","avatar_url":"https://avatars.githubusercontent.com/u/31675368?v=4","gravatar_id":"","url":"https://api.github.com/users/onnx","html_url":"https://github.com/onnx","followers_url":"https://api.github.com/users/onnx/followers","following_url":"https://api.github.com/users/onnx/following{/other_user}","gists_url":"https://api.github.com/users/onnx/gists{/gist_id}","starred_url":"https://api.github.com/users/onnx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/onnx/subscriptions","organizations_url":"https://api.github.com/users/onnx/orgs","repos_url":"https://api.github.com/users/onnx/repos","events_url":"https://api.github.com/users/onnx/events{/privacy}","received_events_url":"https://api.github.com/users/onnx/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/onnx/keras-onnx","description":"Convert tf.keras/Keras models to ONNX","fork":false,"url":"https://api.github.com/repos/onnx/keras-onnx","forks_url":"https://api.github.com/repos/onnx/keras-onnx/forks","keys_url":"https://api.github.com/repos/onnx/keras-onnx/keys{/key_id}","collaborators_url":"https://api.github.com/repos/onnx/keras-onnx/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/onnx/keras-onnx/teams","hooks_url":"https://api.github.com/repos/onnx/keras-onnx/hooks","issue_events_url":"https://api.github.com/repos/onnx/keras-onnx/issues/events{/number}","events_url":"https://api.github.com/repos/onnx/keras-onnx/events","assignees_url":"https://api.github.com/repos/onnx/keras-onnx/assignees{/user}","branches_url":"https://api.github.com/repos/onnx/keras-onnx/branches{/branch}","tags_url":"https://api.github.com/repos/onnx/keras-onnx/tags","blobs_url":"https://api.github.com/repos/onnx/keras-onnx/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/onnx/keras-onnx/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/onnx/keras-onnx/git/refs{/sha}","trees_url":"https://api.github.com/repos/onnx/keras-onnx/git/trees{/sha}","statuses_url":"https://api.github.com/repos/onnx/keras-onnx/statuses/{sha}","languages_url":"https://api.github.com/repos/onnx/keras-onnx/languages","stargazers_url":"https://api.github.com/repos/onnx/keras-onnx/stargazers","contributors_url":"https://api.github.com/repos/onnx/keras-onnx/contributors","subscribers_url":"https://api.github.com/repos/onnx/keras-onnx/subscribers","subscription_url":"https://api.github.com/repos/onnx/keras-onnx/subscription","commits_url":"https://api.github.com/repos/onnx/keras-onnx/commits{/sha}","git_commits_url":"https://api.github.com/repos/onnx/keras-onnx/git/commits{/sha}","comments_url":"https://api.github.com/repos/onnx/keras-onnx/comments{/number}","issue_comment_url":"https://api.github.com/repos/onnx/keras-onnx/issues/comments{/number}","contents_url":"https://api.github.com/repos/onnx/keras-onnx/contents/{+path}","compare_url":"https://api.github.com/repos/onnx/keras-onnx/compare/{base}...{head}","merges_url":"https://api.github.com/repos/onnx/keras-onnx/merges","archive_url":"https://api.github.com/repos/onnx/keras-onnx/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/onnx/keras-onnx/downloads","issues_url":"https://api.github.com/repos/onnx/keras-onnx/issues{/number}","pulls_url":"https://api.github.com/repos/onnx/keras-onnx/pulls{/number}","milestones_url":"https://api.github.com/repos/onnx/keras-onnx/milestones{/number}","notifications_url":"https://api.github.com/repos/onnx/keras-onnx/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/onnx/keras-onnx/labels{/name}","releases_url":"https://api.github.com/repos/onnx/keras-onnx/releases{/id}","deployments_url":"https://api.github.com/repos/onnx/keras-onnx/deployments","created_at":"2018-12-18T20:15:57Z","updated_at":"2023-01-12T09:04:07Z","pushed_at":"2021-09-09T19:50:42Z","git_url":"git://github.com/onnx/keras-onnx.git","ssh_url":"git@github.com:onnx/keras-onnx.git","clone_url":"https://github.com/onnx/keras-onnx.git","svn_url":"https://github.com/onnx/keras-onnx","homepage":"","size":18426,"stargazers_count":369,"watchers_count":369,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":114,"mirror_url":null,"archived":true,"disabled":false,"open_issues_count":105,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["keras","onnx","subclassing","tensorflow"],"visibility":"public","forks":114,"open_issues":105,"watchers":369,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"I'm trying to convert and use a Keras model from [Russtres](https://github.com/MashaPo/russtress/tree/master/russtress):\r\n\r\n```python\r\nfrom keras.models import model_from_json\r\nimport keras2onnx\r\nimport onnx\r\nimport onnxruntime\r\n\r\nwith open('/home/user/russtress/dev/russtress/russtress/text_model.json', 'r') as content_file:\r\n\tjson_string = content_file.read()\r\nmodel = model_from_json(json_string)\r\nmodel.load_weights('/home/user/russtress/dev/russtress/russtress/weights.96.hdf5')\r\n\r\nonnx_model = keras2onnx.convert_keras(model, model.name)\r\nonnx.save_model(onnx_model, '/home/user/russtress/dev/model.onnx')\r\n\r\nsess = onnxruntime.InferenceSession( '/home/user/russtress/dev/model.onnx')\r\n```\r\n\r\nwhich gives me \r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/user/russtress/env/lib/python3.6/site-packages/onnxruntime/capi/session.py\", line 29, in __init__\r\n    self._sess.load_model(path_or_bytes)\r\nRuntimeError: [ONNXRuntimeError] : 1 : GENERAL ERROR : Load model from /home/user/russtress/dev/model.onnx failed:[TypeInferenceError] Invalid attribute perm {2, 0, 1, 3}, input shape = {2, 1, 64}\r\n```\r\n\r\nI'm using [latest](https://github.com/onnx/keras-onnx/commit/eca3cf302812a38c23137f60469d781c0918a9f4) keras2onnx from this repo. \r\n\r\nThe model in Netron looks like this:\r\n![image](https://user-images.githubusercontent.com/2208971/57136308-17f5be80-6db5-11e9-934d-bebef04f1a89.png)\r\n\r\nThe problem looks like [this one](https://github.com/onnx/onnxmltools/issues/138) which is marked as resolved.\r\n\r\nConverted model: [model.onnx.zip](https://github.com/onnx/keras-onnx/files/3142878/model.onnx.zip)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/onnx/keras-onnx/issues/77/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/keras-onnx/issues/77/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"actor":{"login":"atrostan","id":34785486,"node_id":"MDQ6VXNlcjM0Nzg1NDg2","avatar_url":"https://avatars.githubusercontent.com/u/34785486?v=4","gravatar_id":"","url":"https://api.github.com/users/atrostan","html_url":"https://github.com/atrostan","followers_url":"https://api.github.com/users/atrostan/followers","following_url":"https://api.github.com/users/atrostan/following{/other_user}","gists_url":"https://api.github.com/users/atrostan/gists{/gist_id}","starred_url":"https://api.github.com/users/atrostan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atrostan/subscriptions","organizations_url":"https://api.github.com/users/atrostan/orgs","repos_url":"https://api.github.com/users/atrostan/repos","events_url":"https://api.github.com/users/atrostan/events{/privacy}","received_events_url":"https://api.github.com/users/atrostan/received_events","type":"User","site_admin":false},"created_at":"2019-05-09T17:43:34Z","updated_at":"2019-05-09T17:43:34Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/onnx/keras-onnx/issues/88","repository_url":"https://api.github.com/repos/onnx/keras-onnx","labels_url":"https://api.github.com/repos/onnx/keras-onnx/issues/88/labels{/name}","comments_url":"https://api.github.com/repos/onnx/keras-onnx/issues/88/comments","events_url":"https://api.github.com/repos/onnx/keras-onnx/issues/88/events","html_url":"https://github.com/onnx/keras-onnx/issues/88","id":442353912,"node_id":"MDU6SXNzdWU0NDIzNTM5MTI=","number":88,"title":"Failed to read converted model ","user":{"login":"atrostan","id":34785486,"node_id":"MDQ6VXNlcjM0Nzg1NDg2","avatar_url":"https://avatars.githubusercontent.com/u/34785486?v=4","gravatar_id":"","url":"https://api.github.com/users/atrostan","html_url":"https://github.com/atrostan","followers_url":"https://api.github.com/users/atrostan/followers","following_url":"https://api.github.com/users/atrostan/following{/other_user}","gists_url":"https://api.github.com/users/atrostan/gists{/gist_id}","starred_url":"https://api.github.com/users/atrostan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atrostan/subscriptions","organizations_url":"https://api.github.com/users/atrostan/orgs","repos_url":"https://api.github.com/users/atrostan/repos","events_url":"https://api.github.com/users/atrostan/events{/privacy}","received_events_url":"https://api.github.com/users/atrostan/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2019-05-09T17:43:34Z","updated_at":"2019-06-11T17:25:14Z","closed_at":"2019-06-11T17:25:14Z","author_association":"NONE","active_lock_reason":null,"repository":{"id":162340677,"node_id":"MDEwOlJlcG9zaXRvcnkxNjIzNDA2Nzc=","name":"keras-onnx","full_name":"onnx/keras-onnx","private":false,"owner":{"login":"onnx","id":31675368,"node_id":"MDEyOk9yZ2FuaXphdGlvbjMxNjc1MzY4","avatar_url":"https://avatars.githubusercontent.com/u/31675368?v=4","gravatar_id":"","url":"https://api.github.com/users/onnx","html_url":"https://github.com/onnx","followers_url":"https://api.github.com/users/onnx/followers","following_url":"https://api.github.com/users/onnx/following{/other_user}","gists_url":"https://api.github.com/users/onnx/gists{/gist_id}","starred_url":"https://api.github.com/users/onnx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/onnx/subscriptions","organizations_url":"https://api.github.com/users/onnx/orgs","repos_url":"https://api.github.com/users/onnx/repos","events_url":"https://api.github.com/users/onnx/events{/privacy}","received_events_url":"https://api.github.com/users/onnx/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/onnx/keras-onnx","description":"Convert tf.keras/Keras models to ONNX","fork":false,"url":"https://api.github.com/repos/onnx/keras-onnx","forks_url":"https://api.github.com/repos/onnx/keras-onnx/forks","keys_url":"https://api.github.com/repos/onnx/keras-onnx/keys{/key_id}","collaborators_url":"https://api.github.com/repos/onnx/keras-onnx/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/onnx/keras-onnx/teams","hooks_url":"https://api.github.com/repos/onnx/keras-onnx/hooks","issue_events_url":"https://api.github.com/repos/onnx/keras-onnx/issues/events{/number}","events_url":"https://api.github.com/repos/onnx/keras-onnx/events","assignees_url":"https://api.github.com/repos/onnx/keras-onnx/assignees{/user}","branches_url":"https://api.github.com/repos/onnx/keras-onnx/branches{/branch}","tags_url":"https://api.github.com/repos/onnx/keras-onnx/tags","blobs_url":"https://api.github.com/repos/onnx/keras-onnx/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/onnx/keras-onnx/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/onnx/keras-onnx/git/refs{/sha}","trees_url":"https://api.github.com/repos/onnx/keras-onnx/git/trees{/sha}","statuses_url":"https://api.github.com/repos/onnx/keras-onnx/statuses/{sha}","languages_url":"https://api.github.com/repos/onnx/keras-onnx/languages","stargazers_url":"https://api.github.com/repos/onnx/keras-onnx/stargazers","contributors_url":"https://api.github.com/repos/onnx/keras-onnx/contributors","subscribers_url":"https://api.github.com/repos/onnx/keras-onnx/subscribers","subscription_url":"https://api.github.com/repos/onnx/keras-onnx/subscription","commits_url":"https://api.github.com/repos/onnx/keras-onnx/commits{/sha}","git_commits_url":"https://api.github.com/repos/onnx/keras-onnx/git/commits{/sha}","comments_url":"https://api.github.com/repos/onnx/keras-onnx/comments{/number}","issue_comment_url":"https://api.github.com/repos/onnx/keras-onnx/issues/comments{/number}","contents_url":"https://api.github.com/repos/onnx/keras-onnx/contents/{+path}","compare_url":"https://api.github.com/repos/onnx/keras-onnx/compare/{base}...{head}","merges_url":"https://api.github.com/repos/onnx/keras-onnx/merges","archive_url":"https://api.github.com/repos/onnx/keras-onnx/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/onnx/keras-onnx/downloads","issues_url":"https://api.github.com/repos/onnx/keras-onnx/issues{/number}","pulls_url":"https://api.github.com/repos/onnx/keras-onnx/pulls{/number}","milestones_url":"https://api.github.com/repos/onnx/keras-onnx/milestones{/number}","notifications_url":"https://api.github.com/repos/onnx/keras-onnx/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/onnx/keras-onnx/labels{/name}","releases_url":"https://api.github.com/repos/onnx/keras-onnx/releases{/id}","deployments_url":"https://api.github.com/repos/onnx/keras-onnx/deployments","created_at":"2018-12-18T20:15:57Z","updated_at":"2023-01-12T09:04:07Z","pushed_at":"2021-09-09T19:50:42Z","git_url":"git://github.com/onnx/keras-onnx.git","ssh_url":"git@github.com:onnx/keras-onnx.git","clone_url":"https://github.com/onnx/keras-onnx.git","svn_url":"https://github.com/onnx/keras-onnx","homepage":"","size":18426,"stargazers_count":369,"watchers_count":369,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":114,"mirror_url":null,"archived":true,"disabled":false,"open_issues_count":105,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["keras","onnx","subclassing","tensorflow"],"visibility":"public","forks":114,"open_issues":105,"watchers":369,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"I'm trying to convert and use a Keras model. \r\nHere is my `model.summary()`:\r\n```\r\n________________________________________________________________\r\nLayer (type)                 Output Shape              Param #   \r\n=================================================================\r\nconv1d_1 (Conv1D)            (None, 3, 64)             10432     \r\n_________________________________________________________________\r\nbatch_normalization_1 (Batch (None, 3, 64)             256       \r\n_________________________________________________________________\r\nflatten_1 (Flatten)          (None, 192)               0         \r\n_________________________________________________________________\r\ndense_1 (Dense)              (None, 16)                3088      \r\n_________________________________________________________________\r\nbatch_normalization_2 (Batch (None, 16)                64        \r\n_________________________________________________________________\r\ndense_2 (Dense)              (None, 1)                 17        \r\n=================================================================\r\nTotal params: 13,857\r\nTrainable params: 13,697\r\nNon-trainable params: 160\r\n_________________________________________________________________\r\n```\r\nFollowing the advice in https://github.com/onnx/onnxmltools/issues/138#issuecomment-461203500, I tried the following:\r\n```python\r\nonnx_model = keras2onnx.convert_keras(model, \"model4\")\r\nonnx.save_model(onnx_model, 'model4.onnx')\r\ncontent = onnx_model.SerializeToString()\r\nsess = rt.InferenceSession(content)\r\n``` \r\nwhich produces \r\n```\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-5-9753755dee63> in <module>\r\n      1 content = onnx_model.SerializeToString()\r\n----> 2 sess = rt.InferenceSession(content)\r\n\r\n/anaconda3/envs/onnx/lib/python3.6/site-packages/onnxruntime/capi/session.py in __init__(self, path_or_bytes, sess_options)\r\n     29             self._sess.load_model(path_or_bytes)\r\n     30         elif isinstance(path_or_bytes, bytes):\r\n---> 31             self._sess.read_bytes(path_or_bytes)\r\n     32         elif isinstance(path_or_bytes, tuple):\r\n     33             # to remove, hidden trick\r\n\r\nRuntimeError: [ONNXRuntimeError] : 1 : GENERAL ERROR : [TypeInferenceError] Invalid attribute perm {0, 3, 1, 2}, input shape = {1, 3, 64}\r\n```\r\nI've `pip install git+https://github.com/onnx/keras-onnx` and `keras2onnx/ke2onnx` contains the latest changes committed in https://github.com/onnx/keras-onnx/commit/77629e8a1d73056d0b6f2265c85f3197d4470660.\r\n\r\nAlso, for reference, here is the `Keras` model definition:\r\n\r\n```python\r\nmodel = keras.Sequential()\r\n    input_shape = (WINDOW_SIZE, FEATURE_LEN//WINDOW_SIZE, )\r\n    model\\\r\n        .add(\r\n        keras.layers\\\r\n            .Conv1D(\r\n                64, \r\n                kernel_size=(2), \r\n                activation='relu', \r\n                input_shape=input_shape, \r\n                padding=\"same\"\r\n            )\r\n        )\r\n    model.add(keras.layers.BatchNormalization())\r\n    model.add(keras.layers.Flatten())\r\n    model.add(keras.layers.Dense(16, activation='relu'))\r\n    model.add(keras.layers.BatchNormalization())\r\n    model.add(keras.layers.Dense(1, activation='sigmoid'))\r\n\r\n    model.compile(optimizer=keras.optimizers.Adam(lr=0.0001),\r\n                    loss='binary_crossentropy',\r\n                    metrics=['accuracy'])\r\n\r\n    model\\\r\n        .fit(\r\n            trX_resampled, \r\n            trY_resampled, \r\n            epochs=1,\r\n            batch_size=256,\r\n        )\r\n```\r\n\r\nAny help would be appreciated.","reactions":{"url":"https://api.github.com/repos/onnx/keras-onnx/issues/88/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/keras-onnx/issues/88/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"}]