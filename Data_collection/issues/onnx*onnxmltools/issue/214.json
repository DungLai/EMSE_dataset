{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/214","repository_url":"https://api.github.com/repos/onnx/onnxmltools","labels_url":"https://api.github.com/repos/onnx/onnxmltools/issues/214/labels{/name}","comments_url":"https://api.github.com/repos/onnx/onnxmltools/issues/214/comments","events_url":"https://api.github.com/repos/onnx/onnxmltools/issues/214/events","html_url":"https://github.com/onnx/onnxmltools/issues/214","id":401363920,"node_id":"MDU6SXNzdWU0MDEzNjM5MjA=","number":214,"title":"An error (Elu function) occured while loading model with winmltools which uses onnxmltools.","user":{"login":"faruknane","id":37745467,"node_id":"MDQ6VXNlcjM3NzQ1NDY3","avatar_url":"https://avatars.githubusercontent.com/u/37745467?v=4","gravatar_id":"","url":"https://api.github.com/users/faruknane","html_url":"https://github.com/faruknane","followers_url":"https://api.github.com/users/faruknane/followers","following_url":"https://api.github.com/users/faruknane/following{/other_user}","gists_url":"https://api.github.com/users/faruknane/gists{/gist_id}","starred_url":"https://api.github.com/users/faruknane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/faruknane/subscriptions","organizations_url":"https://api.github.com/users/faruknane/orgs","repos_url":"https://api.github.com/users/faruknane/repos","events_url":"https://api.github.com/users/faruknane/events{/privacy}","received_events_url":"https://api.github.com/users/faruknane/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":14,"created_at":"2019-01-21T13:54:50Z","updated_at":"2019-02-14T19:09:24Z","closed_at":"2019-02-14T19:09:24Z","author_association":"NONE","active_lock_reason":null,"body":"Hi, I use elu function in my model and I want to convert the model (from keras tensorflow) to ONNX format in order to use it with C# windows app. \r\n\r\nI try to load the model with winmltools using the code below:\r\n```\r\nfrom winmltools import convert_keras\r\nmodel_onnx = convert_keras(model, target_opset=8, name=\"cropper\")\r\n```\r\n\r\nIt gave me an error:\r\n```\r\n---------------------------------------------------------------------------\r\nKeyError                                  Traceback (most recent call last)\r\n<ipython-input-8-156ad53f924e> in <module>()\r\n      1 from winmltools import convert_keras\r\n      2 \r\n----> 3 model_onnx = convert_keras(model, target_opset=8, name=\"cropper\")\r\n      4 print(type(model_onnx))\r\n      5 if False:\r\n\r\n/usr/local/lib/python3.6/dist-packages/winmltools/convert/main.py in convert_keras(model, target_opset, name, initial_types, doc_string, default_batch_size, channel_first_inputs, custom_conversion_functions, custom_shape_calculators)\r\n    151     return _convert_keras(model, name=name, target_opset=target_opset, initial_types=initial_types, doc_string=doc_string,\r\n    152                           default_batch_size=default_batch_size, channel_first_inputs=channel_first_inputs,\r\n--> 153                           custom_conversion_functions=custom_conversion_functions, custom_shape_calculators=custom_shape_calculators)\r\n    154 \r\n    155 \r\n\r\n/usr/local/lib/python3.6/dist-packages/onnxmltools/convert/keras/convert.py in convert(model, name, default_batch_size, initial_types, doc_string, target_opset, targeted_onnx, channel_first_inputs, custom_conversion_functions, custom_shape_calculators)\r\n     46         name = str(uuid4().hex)\r\n     47 \r\n---> 48     onnx_model = convert_topology(topology, name, doc_string, target_opset, targeted_onnx, channel_first_inputs)\r\n     49     return onnx_model\r\n\r\n/usr/local/lib/python3.6/dist-packages/onnxmltools/convert/common/_topology.py in convert_topology(topology, model_name, doc_string, target_opset, targeted_onnx, channel_first_inputs)\r\n    719         else:\r\n    720             # Convert the selected operator into some ONNX objects and save them into the container\r\n--> 721             _registration.get_converter(operator.type)(scope, operator, container)\r\n    722 \r\n    723     # When calling ModelComponentContainer's add_initializer(...), nothing is added into the input list. However, in\r\n\r\n/usr/local/lib/python3.6/dist-packages/onnxmltools/convert/keras/operator_converters/Conv.py in convert_keras_conv2d(scope, operator, container)\r\n    144 def convert_keras_conv2d(scope, operator, container):\r\n    145     is_transpose, n_dims, input_perm, output_perm, weight_perm = get_converter_config(2, False)\r\n--> 146     convert_keras_conv_core(scope, operator, container, is_transpose, n_dims, input_perm, output_perm, weight_perm)\r\n    147 \r\n    148 \r\n\r\n/usr/local/lib/python3.6/dist-packages/onnxmltools/convert/keras/operator_converters/Conv.py in convert_keras_conv_core(scope, operator, container, is_transpose, n_dims, input_perm_axes, output_perm_axes, weight_perm_axes)\r\n    117     # The construction of convolution is done. Now, we create an activation operator to apply the activation specified\r\n    118     # in this Keras layer.\r\n--> 119     apply_activation_function = _activation_map[op.activation]\r\n    120     activation_output_name = scope.get_unique_variable_name('activation_output')\r\n    121     apply_activation_function(scope, intermediate_output_name, activation_output_name, container)\r\n\r\nKeyError: <function elu at 0x7f48da1697b8>\r\n```\r\nI did some research and found out that ONNX format supports ELU function. Is there anything that I do wrong or is it a bug?","closed_by":{"login":"faruknane","id":37745467,"node_id":"MDQ6VXNlcjM3NzQ1NDY3","avatar_url":"https://avatars.githubusercontent.com/u/37745467?v=4","gravatar_id":"","url":"https://api.github.com/users/faruknane","html_url":"https://github.com/faruknane","followers_url":"https://api.github.com/users/faruknane/followers","following_url":"https://api.github.com/users/faruknane/following{/other_user}","gists_url":"https://api.github.com/users/faruknane/gists{/gist_id}","starred_url":"https://api.github.com/users/faruknane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/faruknane/subscriptions","organizations_url":"https://api.github.com/users/faruknane/orgs","repos_url":"https://api.github.com/users/faruknane/repos","events_url":"https://api.github.com/users/faruknane/events{/privacy}","received_events_url":"https://api.github.com/users/faruknane/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/214/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/onnxmltools/issues/214/timeline","performed_via_github_app":null,"state_reason":"completed"}