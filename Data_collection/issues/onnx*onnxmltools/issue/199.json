{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/199","repository_url":"https://api.github.com/repos/onnx/onnxmltools","labels_url":"https://api.github.com/repos/onnx/onnxmltools/issues/199/labels{/name}","comments_url":"https://api.github.com/repos/onnx/onnxmltools/issues/199/comments","events_url":"https://api.github.com/repos/onnx/onnxmltools/issues/199/events","html_url":"https://github.com/onnx/onnxmltools/issues/199","id":390659616,"node_id":"MDU6SXNzdWUzOTA2NTk2MTY=","number":199,"title":"onnx + graphpipe","user":{"login":"NonaryR","id":8309465,"node_id":"MDQ6VXNlcjgzMDk0NjU=","avatar_url":"https://avatars.githubusercontent.com/u/8309465?v=4","gravatar_id":"","url":"https://api.github.com/users/NonaryR","html_url":"https://github.com/NonaryR","followers_url":"https://api.github.com/users/NonaryR/followers","following_url":"https://api.github.com/users/NonaryR/following{/other_user}","gists_url":"https://api.github.com/users/NonaryR/gists{/gist_id}","starred_url":"https://api.github.com/users/NonaryR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NonaryR/subscriptions","organizations_url":"https://api.github.com/users/NonaryR/orgs","repos_url":"https://api.github.com/users/NonaryR/repos","events_url":"https://api.github.com/users/NonaryR/events{/privacy}","received_events_url":"https://api.github.com/users/NonaryR/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-12-13T12:36:08Z","updated_at":"2019-03-23T15:20:25Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hello! I'm trying to use onnx model from sklearn with [graphpipe](https://oracle.github.io/graphpipe/#/guide/servers/graphpipe-onnx)\r\n\r\nSave an onnx model which contains `Pipeline` with `StandartScaler + LogisticRegression`\r\nAlso, I should provide `value-inputs.json`, with inputs specification\r\nIn my data i have 44 float features, so my `value-inputs` looks like this:\r\n```\r\n{\"float_input\": [1, [1, 44]]}\r\n```\r\nThen I run docker container and have this validation error\r\n```\r\ndocker run -it --rm -v $PWD:/root \\\r\n    -e https_proxy=${https_proxy} \\\r\n    -p 9000:9000 \\\r\n    sleepsonthefloor/graphpipe-onnx:cpu \\\r\n    --model=/root/pipeline.onnx \\\r\n    --value-inputs=/root/model.json \\\r\n    --listen=0.0.0.0:9000\r\nINFO[0000] Setting MKL_NUM_THREADS=4.  You can override this variable in your environment.\r\nINFO[0000] Starting graphpipe-caffe2 version 1.0.0.4.0a1675f.dev (built from sha 0a1675f)\r\nWARNING: Logging before InitGoogleLogging() is written to STDERR\r\nE1213 12:32:57.650635     1 c2_api.cc:309] Binary compiled without cuda support.  Using cpu backend.\r\nINFO[0000] Loading file %!(EXTRA string=/root/model.json)\r\nINFO[0000] Loading file %!(EXTRA string=/root/pipeline.onnx)\r\nE1213 12:32:57.661876     1 init_intrinsics_check.cc:43] CPU feature avx is present on your machine, but the Caffe2 binary is not compiled with it. It means you may not get the full speed of your CPU.\r\nE1213 12:32:57.662380     1 init_intrinsics_check.cc:43] CPU feature avx2 is present on your machine, but the Caffe2 binary is not compiled with it. It means you may not get the full speed of your CPU.\r\nE1213 12:32:57.662405     1 init_intrinsics_check.cc:43] CPU feature fma is present on your machine, but the Caffe2 binary is not compiled with it. It means you may not get the full speed of your CPU.\r\nterminate called after throwing an instance of 'onnx_c2::checker::ValidationError'\r\n  what():  Unrecognized type value case (value_info name: probabilities): 0\r\n*** Aborted at 1544704377 (unix time) try \"date -d @1544704377\" if you are using GNU date ***\r\nPC: @     0x7f79c1b27428 gsignal\r\n*** SIGABRT (@0x1) received by PID 1 (TID 0x7f79c3b04b40) from PID 1; stack trace: ***\r\n```\r\nIn my onnx model I have two outputs -- `label` and `probabilties`:\r\n```\r\noutput {\r\n    name: \"label\"\r\n    type {\r\n      tensor_type {\r\n        elem_type: INT64\r\n        shape {\r\n          dim {\r\n            dim_value: 1\r\n          }}}}}\r\n  output {\r\n    name: \"probabilities\"\r\n    type {\r\n      sequence_type {\r\n        elem_type {\r\n          map_type {\r\n            key_type: INT64\r\n            value_type {\r\n              tensor_type {\r\n                elem_type: FLOAT\r\n              }}}}}}}\r\n```\r\nHow can I resolve this?","closed_by":null,"reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/onnxmltools/issues/199/timeline","performed_via_github_app":null,"state_reason":null}