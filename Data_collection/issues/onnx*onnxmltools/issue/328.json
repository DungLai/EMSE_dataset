{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/328","repository_url":"https://api.github.com/repos/onnx/onnxmltools","labels_url":"https://api.github.com/repos/onnx/onnxmltools/issues/328/labels{/name}","comments_url":"https://api.github.com/repos/onnx/onnxmltools/issues/328/comments","events_url":"https://api.github.com/repos/onnx/onnxmltools/issues/328/events","html_url":"https://github.com/onnx/onnxmltools/issues/328","id":479590886,"node_id":"MDU6SXNzdWU0Nzk1OTA4ODY=","number":328,"title":"Convert Keras to ONNX Err on Mac","user":{"login":"TaylorHere","id":12156543,"node_id":"MDQ6VXNlcjEyMTU2NTQz","avatar_url":"https://avatars.githubusercontent.com/u/12156543?v=4","gravatar_id":"","url":"https://api.github.com/users/TaylorHere","html_url":"https://github.com/TaylorHere","followers_url":"https://api.github.com/users/TaylorHere/followers","following_url":"https://api.github.com/users/TaylorHere/following{/other_user}","gists_url":"https://api.github.com/users/TaylorHere/gists{/gist_id}","starred_url":"https://api.github.com/users/TaylorHere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TaylorHere/subscriptions","organizations_url":"https://api.github.com/users/TaylorHere/orgs","repos_url":"https://api.github.com/users/TaylorHere/repos","events_url":"https://api.github.com/users/TaylorHere/events{/privacy}","received_events_url":"https://api.github.com/users/TaylorHere/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-08-12T11:16:53Z","updated_at":"2019-08-20T06:30:50Z","closed_at":"2019-08-20T06:30:50Z","author_association":"NONE","active_lock_reason":null,"body":"```\r\n‚ùØ python3 test.py\r\nUsing TensorFlow backend.\r\nWARNING: Logging before flag parsing goes to stderr.\r\nW0812 19:11:07.967262 4745819584 deprecation_wrapper.py:119] From /usr/local/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.\r\n\r\nW0812 19:11:08.001241 4745819584 deprecation_wrapper.py:119] From /usr/local/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.\r\n\r\nW0812 19:11:08.006119 4745819584 deprecation_wrapper.py:119] From /usr/local/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.\r\n\r\ntest.py:24: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor(\"ad...)`\r\n  keras_model = Model(inputs=[input1, input2], output=sub_sum)\r\nW0812 19:11:08.181174 4745819584 deprecation_wrapper.py:119] From /usr/local/lib/python3.7/site-packages/keras2onnx/common/utils.py:42: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.\r\n\r\nW0812 19:11:08.181406 4745819584 deprecation_wrapper.py:119] From /usr/local/lib/python3.7/site-packages/keras2onnx/common/utils.py:42: The name tf.logging.WARN is deprecated. Please use tf.compat.v1.logging.WARN instead.\r\n\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 27, in <module>\r\n    onnx_model = onnxmltools.convert_keras(keras_model, target_opset=7)\r\n  File \"/usr/local/lib/python3.7/site-packages/onnxmltools/convert/main.py\", line 32, in convert_keras\r\n    return convert(model, name, doc_string, target_opset, channel_first_inputs)\r\n  File \"/usr/local/lib/python3.7/site-packages/keras2onnx/main.py\", line 103, in convert_keras\r\n    return convert_topology(topology, name, doc_string, target_opset, channel_first_inputs)\r\n  File \"/usr/local/lib/python3.7/site-packages/keras2onnx/topology.py\", line 216, in convert_topology\r\n    container.add_output(tensor_outputs[name])\r\n  File \"/usr/local/lib/python3.7/site-packages/keras2onnx/common/interim.py\", line 192, in add_output\r\n    self.outputs.append(self._make_value_info(variable))\r\n  File \"/usr/local/lib/python3.7/site-packages/keras2onnx/common/interim.py\", line 173, in _make_value_info\r\n    value_info.type.CopyFrom(variable.type.to_onnx_type())\r\n  File \"/usr/local/lib/python3.7/site-packages/onnxconverter_common/data_types.py\", line 87, in to_onnx_type\r\n    raise ValueError('Unsupported dimension type: %s' % type(d))\r\nValueError: Unsupported dimension type: <class 'NoneType'>\r\n\r\n```\r\nwhen I follow the code in README.md, I got this err output\r\nthis is my code looks like\r\nmy platform is MacOS\r\n\r\n\r\n\r\n```python3\r\nimport onnxmltools\r\nfrom keras.layers import Input, Dense, Add\r\nfrom keras.models import Model\r\n\r\n# N: batch size, C: sub-model input dimension, D: final model's input dimension\r\nN, C, D = 2, 3, 3\r\n\r\n# Define a sub-model, it will become a part of our final model\r\nsub_input1 = Input(shape=(C,))\r\nsub_mapped1 = Dense(D)(sub_input1)\r\nsub_model1 = Model(inputs=sub_input1, outputs=sub_mapped1)\r\n\r\n# Define another sub-model, it will become a part of our final model\r\nsub_input2 = Input(shape=(C,))\r\nsub_mapped2 = Dense(D)(sub_input2)\r\nsub_model2 = Model(inputs=sub_input2, outputs=sub_mapped2)\r\n\r\n# Define a model built upon the previous two sub-models\r\ninput1 = Input(shape=(D,))\r\ninput2 = Input(shape=(D,))\r\nmapped1_2 = sub_model1(input1)\r\nmapped2_2 = sub_model2(input2)\r\nsub_sum = Add()([mapped1_2, mapped2_2])\r\nkeras_model = Model(inputs=[input1, input2], output=sub_sum)\r\n\r\n# Convert it! The target_opset parameter is optional.\r\nonnx_model = onnxmltools.convert_keras(keras_model, target_opset=7) \r\n```","closed_by":{"login":"TaylorHere","id":12156543,"node_id":"MDQ6VXNlcjEyMTU2NTQz","avatar_url":"https://avatars.githubusercontent.com/u/12156543?v=4","gravatar_id":"","url":"https://api.github.com/users/TaylorHere","html_url":"https://github.com/TaylorHere","followers_url":"https://api.github.com/users/TaylorHere/followers","following_url":"https://api.github.com/users/TaylorHere/following{/other_user}","gists_url":"https://api.github.com/users/TaylorHere/gists{/gist_id}","starred_url":"https://api.github.com/users/TaylorHere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TaylorHere/subscriptions","organizations_url":"https://api.github.com/users/TaylorHere/orgs","repos_url":"https://api.github.com/users/TaylorHere/repos","events_url":"https://api.github.com/users/TaylorHere/events{/privacy}","received_events_url":"https://api.github.com/users/TaylorHere/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/onnxmltools/issues/328/timeline","performed_via_github_app":null,"state_reason":"completed"}