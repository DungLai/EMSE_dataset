{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/411","repository_url":"https://api.github.com/repos/onnx/onnxmltools","labels_url":"https://api.github.com/repos/onnx/onnxmltools/issues/411/labels{/name}","comments_url":"https://api.github.com/repos/onnx/onnxmltools/issues/411/comments","events_url":"https://api.github.com/repos/onnx/onnxmltools/issues/411/events","html_url":"https://github.com/onnx/onnxmltools/issues/411","id":673521488,"node_id":"MDU6SXNzdWU2NzM1MjE0ODg=","number":411,"title":"Converting keras model","user":{"login":"bedapisl","id":10141878,"node_id":"MDQ6VXNlcjEwMTQxODc4","avatar_url":"https://avatars.githubusercontent.com/u/10141878?v=4","gravatar_id":"","url":"https://api.github.com/users/bedapisl","html_url":"https://github.com/bedapisl","followers_url":"https://api.github.com/users/bedapisl/followers","following_url":"https://api.github.com/users/bedapisl/following{/other_user}","gists_url":"https://api.github.com/users/bedapisl/gists{/gist_id}","starred_url":"https://api.github.com/users/bedapisl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bedapisl/subscriptions","organizations_url":"https://api.github.com/users/bedapisl/orgs","repos_url":"https://api.github.com/users/bedapisl/repos","events_url":"https://api.github.com/users/bedapisl/events{/privacy}","received_events_url":"https://api.github.com/users/bedapisl/received_events","type":"User","site_admin":false},"labels":[{"id":3286917269,"node_id":"MDU6TGFiZWwzMjg2OTE3MjY5","url":"https://api.github.com/repos/onnx/onnxmltools/labels/pending%20user%20response","name":"pending user response","color":"D5B2F3","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2020-08-05T13:00:46Z","updated_at":"2022-09-21T13:03:54Z","closed_at":"2021-08-25T13:43:43Z","author_association":"NONE","active_lock_reason":null,"body":"Hello, I am trying to convert my Keras model to ONNX format, but I am getting lots of warnings and an error:\r\n\r\n```\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/TensorArrayStack/TensorArrayGatherV3 of type TensorArrayGatherV3\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/TensorArray_1 of type TensorArrayV3\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/Exit_2 of type Exit\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/TensorArrayStack/TensorArraySizeV3 of type TensorArraySizeV3\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/Switch_2 of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/Merge_2 of type Merge\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/LoopCond of type LoopCond\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/Enter_2 of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/NextIteration_2 of type NextIteration\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/cond/Merge of type Merge\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/cond/Merge_1 of type Merge\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/cond/Merge_2 of type Merge\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/cond/Merge_3 of type Merge\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/TensorArrayWrite/TensorArrayWriteV3 of type TensorArrayWriteV3\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/TensorArrayWrite/TensorArrayWriteV3/Enter of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/cond/Merge of type Merge\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/Merge of type Merge\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/Less/Enter of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/Merge_1 of type Merge\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/cond/ExpandDims_4/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/cond/ExpandDims_5/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/cond/ExpandDims_6/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/cond/ExpandDims_7/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/Switch_1 of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/Enter of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/NextIteration of type NextIteration\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/Enter_1 of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/NextIteration_1 of type NextIteration\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/cond/mul/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/cond/mul/Switch_1 of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/cond/mul_1/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/cond/mul_1/Switch_1 of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/cond/mul_2/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/cond/mul_3/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/cond/strided_slice/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/cond/Shape/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/cond/sub/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/cond/TopKV2/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/GreaterEqual/Enter of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/TensorArrayStack/TensorArrayGatherV3 of type TensorArrayGatherV3\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/TensorArray_1 of type TensorArrayV3\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/Exit_2 of type Exit\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/TensorArrayStack/TensorArraySizeV3 of type TensorArraySizeV3\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/Switch_2 of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/Merge_2 of type Merge\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/LoopCond of type LoopCond\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/Enter_2 of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/NextIteration_2 of type NextIteration\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/TensorArrayWrite/TensorArrayWriteV3 of type TensorArrayWriteV3\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/TensorArrayWrite/TensorArrayWriteV3/Enter of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/Merge of type Merge\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/Less/Enter of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/Merge_1 of type Merge\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/Switch_1 of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/cond/Merge of type Merge\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/Enter of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/NextIteration of type NextIteration\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/Enter_1 of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/NextIteration_1 of type NextIteration\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/cond/strided_slice/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/cond/non_maximum_suppresion/NonMaxSuppressionV3/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/cond/non_maximum_suppresion/NonMaxSuppressionV3/Enter_1 of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/Switch of type Switch\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/cond/non_maximum_suppresion/NonMaxSuppressionV3/Enter of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/strided_slice/Enter of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/TensorArrayReadV3 of type TensorArrayReadV3\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/TensorArrayReadV3 of type TensorArrayReadV3\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/Greater/Enter_1 of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/TensorArrayReadV3/Enter of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/TensorArrayReadV3/Enter_1 of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/TensorArrayReadV3/Enter of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/TensorArrayReadV3/Enter_1 of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/while/Greater/Enter of type Enter\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/TensorArray of type TensorArrayV3\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/while/loop_over_classes/TensorArrayUnstack/TensorArrayScatter/TensorArrayScatterV3 of type TensorArrayScatterV3\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/TensorArray of type TensorArrayV3\r\n      The generated ONNX model needs run with the custom op supports.\r\nWARN: No corresponding ONNX op matches the tf.op node decoded_predictions/loop_over_batch/TensorArrayUnstack/TensorArrayScatter/TensorArrayScatterV3 of type TensorArrayScatterV3\r\n      The generated ONNX model needs run with the custom op supports.\r\nTraceback (most recent call last):\r\n  File \"onnx_test.py\", line 11, in <module>\r\n    onnx_model = onnxmltools.convert_keras(keras_model)\r\n  File \"/home/pislb/packages/onnxmltools/onnxmltools/convert/main.py\", line 33, in convert_keras\r\n    return convert(model, name, doc_string, target_opset, channel_first_inputs)\r\n  File \"/home/pislb/.local/lib/python3.6/site-packages/keras2onnx/main.py\", line 80, in convert_keras\r\n    parse_graph(topology, tf_graph, target_opset, output_names, output_dict)\r\n  File \"/home/pislb/.local/lib/python3.6/site-packages/keras2onnx/parser.py\", line 842, in parse_graph\r\n    graph, keras_node_dict, topo, top_level, output_names)\r\n  File \"/home/pislb/.local/lib/python3.6/site-packages/keras2onnx/parser.py\", line 606, in _parse_graph_core\r\n    _on_parsing_tf_nodes(graph, nodes, varset, topology.debug_mode)\r\n  File \"/home/pislb/.local/lib/python3.6/site-packages/keras2onnx/parser.py\", line 323, in _on_parsing_tf_nodes\r\n    var_type = infer_variable_type(i_, varset.target_opset)\r\n  File \"/home/pislb/.local/lib/python3.6/site-packages/keras2onnx/_parser_tf.py\", line 48, in infer_variable_type\r\n    \"Unable to find out a correct type for tensor type = {} of {}\".format(tensor_type, tensor.name))\r\nValueError: Unable to find out a correct type for tensor type = 0 of decoded_predictions/loop_over_batch/while/TensorArrayWrite/TensorArrayWriteV3/Enter:0\r\n```\r\n\r\nDoes this mean I have to reimplement all the ops mentioned in the warnings in ONNX? And how do I fix the error? Thanks for help","closed_by":{"login":"xadupre","id":22452781,"node_id":"MDQ6VXNlcjIyNDUyNzgx","avatar_url":"https://avatars.githubusercontent.com/u/22452781?v=4","gravatar_id":"","url":"https://api.github.com/users/xadupre","html_url":"https://github.com/xadupre","followers_url":"https://api.github.com/users/xadupre/followers","following_url":"https://api.github.com/users/xadupre/following{/other_user}","gists_url":"https://api.github.com/users/xadupre/gists{/gist_id}","starred_url":"https://api.github.com/users/xadupre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xadupre/subscriptions","organizations_url":"https://api.github.com/users/xadupre/orgs","repos_url":"https://api.github.com/users/xadupre/repos","events_url":"https://api.github.com/users/xadupre/events{/privacy}","received_events_url":"https://api.github.com/users/xadupre/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/onnxmltools/issues/411/timeline","performed_via_github_app":null,"state_reason":"completed"}