{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/164","repository_url":"https://api.github.com/repos/onnx/onnxmltools","labels_url":"https://api.github.com/repos/onnx/onnxmltools/issues/164/labels{/name}","comments_url":"https://api.github.com/repos/onnx/onnxmltools/issues/164/comments","events_url":"https://api.github.com/repos/onnx/onnxmltools/issues/164/events","html_url":"https://github.com/onnx/onnxmltools/issues/164","id":378066488,"node_id":"MDU6SXNzdWUzNzgwNjY0ODg=","number":164,"title":"Flatten layer outputting incorrect values","user":{"login":"riacheruvu","id":22090501,"node_id":"MDQ6VXNlcjIyMDkwNTAx","avatar_url":"https://avatars.githubusercontent.com/u/22090501?v=4","gravatar_id":"","url":"https://api.github.com/users/riacheruvu","html_url":"https://github.com/riacheruvu","followers_url":"https://api.github.com/users/riacheruvu/followers","following_url":"https://api.github.com/users/riacheruvu/following{/other_user}","gists_url":"https://api.github.com/users/riacheruvu/gists{/gist_id}","starred_url":"https://api.github.com/users/riacheruvu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/riacheruvu/subscriptions","organizations_url":"https://api.github.com/users/riacheruvu/orgs","repos_url":"https://api.github.com/users/riacheruvu/repos","events_url":"https://api.github.com/users/riacheruvu/events{/privacy}","received_events_url":"https://api.github.com/users/riacheruvu/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-11-06T22:45:57Z","updated_at":"2019-01-16T18:58:04Z","closed_at":"2019-01-16T18:58:04Z","author_association":"NONE","active_lock_reason":null,"body":"I successfully converted [a Keras implementation of the Neural Collaborative Filtering model ](https://github.com/hexiangnan/neural_collaborative_filtering) to Onnx using OnnxMLTools, but the Flatten layer of the converted Onnx model is outputting incorrect values (for example, the Onnx model outputs        _dim_value: 1_) compared to the original Keras model (for example, the Keras model outputs _(None, 8)._). \r\n\r\nThe Onnx model I am using is available here: https://www.dropbox.com/s/fwiaqk6xy0n3z6o/NCF.onnx?dl=0 \r\n\r\nI'm not sure if this is a bug with the converter or if there are any problems with the Onnx model itself. Some relevant details include that I used Python 2.7.15, Keras 2.2.4, and OnnxMLTools 1.2.2.0129 when converting the Keras model to Onnx. \r\n\r\nCould someone please advise on this issue? I can share more details if needed.\r\n\r\n\r\nI've included a picture below of the Keras model:\r\n\r\n![model_plot](https://user-images.githubusercontent.com/22090501/48098391-d1465380-e1d9-11e8-90d8-a8e8a6a0c8cf.png) \r\n\r\nI'm also including a picture of the outputs for the Flatten layers for the Onnx model:\r\n\r\n![onnx_flatten](https://user-images.githubusercontent.com/22090501/48098553-5e89a800-e1da-11e8-85be-a4b5f98403dd.png)\r\n\r\nThank you!\r\n","closed_by":{"login":"wenbingl","id":10278425,"node_id":"MDQ6VXNlcjEwMjc4NDI1","avatar_url":"https://avatars.githubusercontent.com/u/10278425?v=4","gravatar_id":"","url":"https://api.github.com/users/wenbingl","html_url":"https://github.com/wenbingl","followers_url":"https://api.github.com/users/wenbingl/followers","following_url":"https://api.github.com/users/wenbingl/following{/other_user}","gists_url":"https://api.github.com/users/wenbingl/gists{/gist_id}","starred_url":"https://api.github.com/users/wenbingl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wenbingl/subscriptions","organizations_url":"https://api.github.com/users/wenbingl/orgs","repos_url":"https://api.github.com/users/wenbingl/repos","events_url":"https://api.github.com/users/wenbingl/events{/privacy}","received_events_url":"https://api.github.com/users/wenbingl/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/onnxmltools/issues/164/timeline","performed_via_github_app":null,"state_reason":"completed"}