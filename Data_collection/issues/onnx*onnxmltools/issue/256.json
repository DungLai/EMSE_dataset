{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/256","repository_url":"https://api.github.com/repos/onnx/onnxmltools","labels_url":"https://api.github.com/repos/onnx/onnxmltools/issues/256/labels{/name}","comments_url":"https://api.github.com/repos/onnx/onnxmltools/issues/256/comments","events_url":"https://api.github.com/repos/onnx/onnxmltools/issues/256/events","html_url":"https://github.com/onnx/onnxmltools/issues/256","id":418573240,"node_id":"MDU6SXNzdWU0MTg1NzMyNDA=","number":256,"title":"Core ML Tiny-yoloV2 confidence drops significantly after conversion","user":{"login":"walterPeyton","id":46744560,"node_id":"MDQ6VXNlcjQ2NzQ0NTYw","avatar_url":"https://avatars.githubusercontent.com/u/46744560?v=4","gravatar_id":"","url":"https://api.github.com/users/walterPeyton","html_url":"https://github.com/walterPeyton","followers_url":"https://api.github.com/users/walterPeyton/followers","following_url":"https://api.github.com/users/walterPeyton/following{/other_user}","gists_url":"https://api.github.com/users/walterPeyton/gists{/gist_id}","starred_url":"https://api.github.com/users/walterPeyton/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/walterPeyton/subscriptions","organizations_url":"https://api.github.com/users/walterPeyton/orgs","repos_url":"https://api.github.com/users/walterPeyton/repos","events_url":"https://api.github.com/users/walterPeyton/events{/privacy}","received_events_url":"https://api.github.com/users/walterPeyton/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-03-08T00:10:15Z","updated_at":"2019-10-07T15:52:15Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Dear fellow programmers,\r\n\r\nI'm currently trying to build my own self trained version of a tiny-yolov2 network comparable to: https://github.com/onnx/models/tree/master/tiny_yolov2\r\n\r\nI want only 6 custom classes instead of the given 20 classes that the Zoo model offers. So far I've successfully trained and converted the model from darknet to tensorflow, to CoreML. I'm very very sure that those conversions have been successful since I built dummy Apps for either Framework and they work like a charm.\r\n\r\nNow the problem:\r\n\r\nI'm not able to convert the Core ML model to ONNX. The conversion runs fine but the output values (such as predicted bounding boxes but especially the confidence) are getting super low. The network is practically unusable after the conversion.\r\n\r\nI'm currently using the following ONNX parser that I modified so that it only detects 6 classes (changed the class number to 6, channel count to 55 etc): https://github.com/TakahiroMiyaura/HoloLensOnnxTinyYoLo/blob/master/UwpOnnxTinyYoloV2_2D/UwpOnnxTinyYoloV2/UWPOnnxTinyYoloV2.Common/Yolo9000/YoloWinMLParser.cs\r\n\r\nAs I mentioned before, the confidence of the new model is very very small, the detection is worse than before as well.\r\n\r\nHere are the Graphs of the networks (created with Netron):\r\n\r\nFirst, the ONNX Model:\r\n![yolo_onnx](https://user-images.githubusercontent.com/46744560/53997327-0e950080-413c-11e9-966d-ae430425fd82.png)\r\n\r\nSecond, the Core ML that I used to create the ONNX model:\r\n\r\n![yolo_coreml](https://user-images.githubusercontent.com/46744560/53997423-6cc1e380-413c-11e9-927e-900aa29f36c9.png)\r\n\r\nThe code I used to convert the model was the one that was put on the official ONNXMLTools site:\r\nhttps://github.com/onnx/onnxmltools\r\n\r\n<img width=\"649\" alt=\"image\" src=\"https://user-images.githubusercontent.com/46744560/53997783-d989ad80-413d-11e9-8e3c-718478f20cd0.png\">\r\n\r\nIs there anything that I could change or maybe even a simpler way to train a tiny yolo model to run it in a UWP or even on the HoloLens directly?\r\n\r\nI'm very thankful for any idea, tip, opinion on this problem.\r\n\r\nIf you need more information, please ask! :) \r\n\r\nThanks in advance\r\n\r\nWalter","closed_by":null,"reactions":{"url":"https://api.github.com/repos/onnx/onnxmltools/issues/256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/onnx/onnxmltools/issues/256/timeline","performed_via_github_app":null,"state_reason":null}