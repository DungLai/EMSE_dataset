{"url":"https://api.github.com/repos/allenai/scispacy/issues/396","repository_url":"https://api.github.com/repos/allenai/scispacy","labels_url":"https://api.github.com/repos/allenai/scispacy/issues/396/labels{/name}","comments_url":"https://api.github.com/repos/allenai/scispacy/issues/396/comments","events_url":"https://api.github.com/repos/allenai/scispacy/issues/396/events","html_url":"https://github.com/allenai/scispacy/issues/396","id":1010126028,"node_id":"I_kwDOCPNzOc48NUzM","number":396,"title":"Getting Warnings when using custom KB","user":{"login":"farrandi","id":54917098,"node_id":"MDQ6VXNlcjU0OTE3MDk4","avatar_url":"https://avatars.githubusercontent.com/u/54917098?v=4","gravatar_id":"","url":"https://api.github.com/users/farrandi","html_url":"https://github.com/farrandi","followers_url":"https://api.github.com/users/farrandi/followers","following_url":"https://api.github.com/users/farrandi/following{/other_user}","gists_url":"https://api.github.com/users/farrandi/gists{/gist_id}","starred_url":"https://api.github.com/users/farrandi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farrandi/subscriptions","organizations_url":"https://api.github.com/users/farrandi/orgs","repos_url":"https://api.github.com/users/farrandi/repos","events_url":"https://api.github.com/users/farrandi/events{/privacy}","received_events_url":"https://api.github.com/users/farrandi/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-09-28T19:28:02Z","updated_at":"2022-09-07T00:39:34Z","closed_at":"2022-09-07T00:39:34Z","author_association":"NONE","active_lock_reason":null,"body":"I made my own KB as per #331 and it works perfectly. The only problem is I keep getting these warning messages.\r\n\r\nHere is my code:\r\n```\r\nfrom scispacy.candidate_generation import DEFAULT_PATHS, DEFAULT_KNOWLEDGE_BASES\r\nfrom scispacy.candidate_generation import (\r\n    CandidateGenerator,\r\n    LinkerPaths\r\n)\r\nfrom scispacy.linking_utils import KnowledgeBase\r\nfrom scispacy.linking import *\r\n\r\nCustomLinkerPaths_mycustom = LinkerPaths(\r\n    ann_index=\"../Metas/knowledge base/kb/nmslib_index.bin\",\r\n    tfidf_vectorizer=\"../Metas/knowledge base/kb/tfidf_vectorizer.joblib\",\r\n    tfidf_vectors=\"../Metas/knowledge base/kb/tfidf_vectors_sparse.npz\",\r\n    concept_aliases_list=\"../Metas/knowledge base/kb/concept_aliases.json\",\r\n)\r\nclass myKnowledgeBase(KnowledgeBase):\r\n    def __init__(\r\n        self,\r\n        file_path: str = \"../Metas/knowledge base/custom_kb.jsonl\",\r\n    ):\r\n        super().__init__(file_path)\r\n\r\nDEFAULT_PATHS[\"myCustom\"] = CustomLinkerPaths_mycustom\r\nDEFAULT_KNOWLEDGE_BASES[\"myCustom\"] = myKnowledgeBase\r\n\r\nnlp.add_pipe(\"scispacy_linker\", config={\"resolve_abbreviations\": True, \"linker_name\": \"myCustom\",\r\n                                        \"filter_for_definitions\": False, \"threshold\": \"0.5\"})\r\nlinker = CandidateGenerator(name=\"myCustom\")\r\n```\r\nand I got:\r\n```\r\nYour CPU supports instructions that this binary was not compiled to use: SSE3 SSE4.1 SSE4.2 AVX AVX2\r\nFor maximum performance, you can install NMSLIB from sources \r\npip install --no-binary :all: nmslib\r\n```\r\n\r\nalso when I made my own custom function and tested it, I got another warning. Here is the code:\r\n```\r\ndef get_id(word):\r\n    temp_doc = nlp(word)\r\n    try:\r\n        ents = temp_doc.ents[0]\r\n        possible_ents = [ent for ent in ents._.kb_ents]\r\n        most_likely_ent = possible_ents[0]\r\n        return most_likely_ent[0]\r\n    except:\r\n        return \"\"\r\n        \r\n\r\nx = get_id(\"LV\")\r\nprint(x)\r\n```\r\nThis is the warning for the code above:\r\n```\r\nhome/user/.local/lib/python3.8/site-packages/scispacy/candidate_generation.py:284: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\r\n  extended_neighbors[empty_vectors_boolean_flags] = numpy.array(neighbors)[:-1]\r\n/home/user/.local/lib/python3.8/site-packages/scispacy/candidate_generation.py:285: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\r\n  extended_distances[empty_vectors_boolean_flags] = numpy.array(distances)[:-1]\r\n```\r\nDo you know why this is the case? is there a way to fix this or remove the warning?","closed_by":{"login":"dakinggg","id":43149077,"node_id":"MDQ6VXNlcjQzMTQ5MDc3","avatar_url":"https://avatars.githubusercontent.com/u/43149077?v=4","gravatar_id":"","url":"https://api.github.com/users/dakinggg","html_url":"https://github.com/dakinggg","followers_url":"https://api.github.com/users/dakinggg/followers","following_url":"https://api.github.com/users/dakinggg/following{/other_user}","gists_url":"https://api.github.com/users/dakinggg/gists{/gist_id}","starred_url":"https://api.github.com/users/dakinggg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakinggg/subscriptions","organizations_url":"https://api.github.com/users/dakinggg/orgs","repos_url":"https://api.github.com/users/dakinggg/repos","events_url":"https://api.github.com/users/dakinggg/events{/privacy}","received_events_url":"https://api.github.com/users/dakinggg/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/allenai/scispacy/issues/396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/allenai/scispacy/issues/396/timeline","performed_via_github_app":null,"state_reason":"completed"}