{"url":"https://api.github.com/repos/allenai/scispacy/issues/383","repository_url":"https://api.github.com/repos/allenai/scispacy","labels_url":"https://api.github.com/repos/allenai/scispacy/issues/383/labels{/name}","comments_url":"https://api.github.com/repos/allenai/scispacy/issues/383/comments","events_url":"https://api.github.com/repos/allenai/scispacy/issues/383/events","html_url":"https://github.com/allenai/scispacy/issues/383","id":957019565,"node_id":"MDU6SXNzdWU5NTcwMTk1NjU=","number":383,"title":"Trying to add custom Knowledge base","user":{"login":"farrandi","id":54917098,"node_id":"MDQ6VXNlcjU0OTE3MDk4","avatar_url":"https://avatars.githubusercontent.com/u/54917098?v=4","gravatar_id":"","url":"https://api.github.com/users/farrandi","html_url":"https://github.com/farrandi","followers_url":"https://api.github.com/users/farrandi/followers","following_url":"https://api.github.com/users/farrandi/following{/other_user}","gists_url":"https://api.github.com/users/farrandi/gists{/gist_id}","starred_url":"https://api.github.com/users/farrandi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farrandi/subscriptions","organizations_url":"https://api.github.com/users/farrandi/orgs","repos_url":"https://api.github.com/users/farrandi/repos","events_url":"https://api.github.com/users/farrandi/events{/privacy}","received_events_url":"https://api.github.com/users/farrandi/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2021-07-30T19:49:18Z","updated_at":"2021-07-30T21:14:51Z","closed_at":"2021-07-30T21:14:51Z","author_association":"NONE","active_lock_reason":null,"body":"Hello, I read several previous discussions about adding a custom KB to scispacy instead of using the preset ones and a helpful discussion I found was in: #331 and #237.\r\n\r\nI followed the steps and I managed to run the script with my jsonl and managed to get some outputs (4 specifically) but I am not quite clear how to proceed from here.\r\n\r\nHere is my code (I ran on jupyter notebook):\r\n```\r\nfrom scispacy.candidate_generation import DEFAULT_PATHS, DEFAULT_KNOWLEDGE_BASES\r\nfrom scispacy.candidate_generation import (\r\n    CandidateGenerator,\r\n    LinkerPaths\r\n)\r\nfrom scispacy.linking_utils import KnowledgeBase\r\nimport spacy\r\n\r\nCustomLinkerPaths_mycustom = LinkerPaths(\r\n    ann_index=\"output/nmslib_index.bin\",\r\n    tfidf_vectorizer=\"output//nmslib_index.bin\",\r\n    tfidf_vectors=\"output/tfidf_vectorizer.joblib\",\r\n    concept_aliases_list=\"output/concept_aliases.json\",\r\n)\r\nclass myKnowledgeBase(KnowledgeBase):\r\n    def __init__(\r\n        self,\r\n        file_path: str = \"custom_kb.jsonl\",\r\n    ):\r\n        super().__init__(file_path)\r\n\r\n\r\nDEFAULT_PATHS[\"myCustom\"] = CustomLinkerPaths_mycustom\r\nDEFAULT_KNOWLEDGE_BASES[\"myCustom\"] = myKnowledgeBase\r\n\r\n\r\nnlp = spacy.load(\"new_model\")\r\nnlp.add_pipe(\"scispacy_linker\", config={\"resolve_abbreviations\": True, \"linker_name\": \"myCustom\"})\r\n```\r\n This gave me the error:\r\n```\r\nValueError: [E002] Can't find factory for 'scispacy_linker' for language English (en). This usually happens when spaCy calls `nlp.create_pipe` with a custom component name that's not registered on the current language class. If you're using a Transformer, make sure to install 'spacy-transformers'. If you're using a custom component, make sure you've added the decorator `@Language.component` (for function components) or `@Language.factory` (for class components).\r\n```\r\n\r\nSo I was wondering how I should do this. From my understanding, we would like to add this new `linker_name` and its paths to the scispacy EntityLinker class but is there a way to do it from importing the scispacy from pip install. Or is the only method to clone the scispacy repository and edit the EntityLinker file?\r\n\r\nIs my understanding right? Any help would be appreciated. Thanks!","closed_by":{"login":"farrandi","id":54917098,"node_id":"MDQ6VXNlcjU0OTE3MDk4","avatar_url":"https://avatars.githubusercontent.com/u/54917098?v=4","gravatar_id":"","url":"https://api.github.com/users/farrandi","html_url":"https://github.com/farrandi","followers_url":"https://api.github.com/users/farrandi/followers","following_url":"https://api.github.com/users/farrandi/following{/other_user}","gists_url":"https://api.github.com/users/farrandi/gists{/gist_id}","starred_url":"https://api.github.com/users/farrandi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/farrandi/subscriptions","organizations_url":"https://api.github.com/users/farrandi/orgs","repos_url":"https://api.github.com/users/farrandi/repos","events_url":"https://api.github.com/users/farrandi/events{/privacy}","received_events_url":"https://api.github.com/users/farrandi/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/allenai/scispacy/issues/383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/allenai/scispacy/issues/383/timeline","performed_via_github_app":null,"state_reason":"completed"}