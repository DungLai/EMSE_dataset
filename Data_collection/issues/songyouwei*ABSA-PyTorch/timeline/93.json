[{"url":"https://api.github.com/repos/songyouwei/ABSA-PyTorch/issues/comments/546707584","html_url":"https://github.com/songyouwei/ABSA-PyTorch/issues/93#issuecomment-546707584","issue_url":"https://api.github.com/repos/songyouwei/ABSA-PyTorch/issues/93","id":546707584,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NjcwNzU4NA==","user":{"login":"songyouwei","id":2573291,"node_id":"MDQ6VXNlcjI1NzMyOTE=","avatar_url":"https://avatars.githubusercontent.com/u/2573291?v=4","gravatar_id":"","url":"https://api.github.com/users/songyouwei","html_url":"https://github.com/songyouwei","followers_url":"https://api.github.com/users/songyouwei/followers","following_url":"https://api.github.com/users/songyouwei/following{/other_user}","gists_url":"https://api.github.com/users/songyouwei/gists{/gist_id}","starred_url":"https://api.github.com/users/songyouwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/songyouwei/subscriptions","organizations_url":"https://api.github.com/users/songyouwei/orgs","repos_url":"https://api.github.com/users/songyouwei/repos","events_url":"https://api.github.com/users/songyouwei/events{/privacy}","received_events_url":"https://api.github.com/users/songyouwei/received_events","type":"User","site_admin":false},"created_at":"2019-10-27T15:54:49Z","updated_at":"2019-10-27T15:54:49Z","author_association":"OWNER","body":"LSR is not used by default because other implemented models do not use this trick.\r\n\r\nhttps://github.com/songyouwei/ABSA-PyTorch/blob/bf55517ed5cb8dda5960b15575e87dd06101586d/train.py#L23\r\n\r\nYou can enable it by replacing `nn.CrossEntropyLoss()` with `CrossEntropyLoss_LSR()`\r\n\r\nhttps://github.com/songyouwei/ABSA-PyTorch/blob/bf55517ed5cb8dda5960b15575e87dd06101586d/train.py#L160","reactions":{"url":"https://api.github.com/repos/songyouwei/ABSA-PyTorch/issues/comments/546707584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"songyouwei","id":2573291,"node_id":"MDQ6VXNlcjI1NzMyOTE=","avatar_url":"https://avatars.githubusercontent.com/u/2573291?v=4","gravatar_id":"","url":"https://api.github.com/users/songyouwei","html_url":"https://github.com/songyouwei","followers_url":"https://api.github.com/users/songyouwei/followers","following_url":"https://api.github.com/users/songyouwei/following{/other_user}","gists_url":"https://api.github.com/users/songyouwei/gists{/gist_id}","starred_url":"https://api.github.com/users/songyouwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/songyouwei/subscriptions","organizations_url":"https://api.github.com/users/songyouwei/orgs","repos_url":"https://api.github.com/users/songyouwei/repos","events_url":"https://api.github.com/users/songyouwei/events{/privacy}","received_events_url":"https://api.github.com/users/songyouwei/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/songyouwei/ABSA-PyTorch/issues/comments/546896172","html_url":"https://github.com/songyouwei/ABSA-PyTorch/issues/93#issuecomment-546896172","issue_url":"https://api.github.com/repos/songyouwei/ABSA-PyTorch/issues/93","id":546896172,"node_id":"MDEyOklzc3VlQ29tbWVudDU0Njg5NjE3Mg==","user":{"login":"fhamborg","id":18700166,"node_id":"MDQ6VXNlcjE4NzAwMTY2","avatar_url":"https://avatars.githubusercontent.com/u/18700166?v=4","gravatar_id":"","url":"https://api.github.com/users/fhamborg","html_url":"https://github.com/fhamborg","followers_url":"https://api.github.com/users/fhamborg/followers","following_url":"https://api.github.com/users/fhamborg/following{/other_user}","gists_url":"https://api.github.com/users/fhamborg/gists{/gist_id}","starred_url":"https://api.github.com/users/fhamborg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhamborg/subscriptions","organizations_url":"https://api.github.com/users/fhamborg/orgs","repos_url":"https://api.github.com/users/fhamborg/repos","events_url":"https://api.github.com/users/fhamborg/events{/privacy}","received_events_url":"https://api.github.com/users/fhamborg/received_events","type":"User","site_admin":false},"created_at":"2019-10-28T11:01:48Z","updated_at":"2019-10-28T11:01:48Z","author_association":"NONE","body":"Alright, that's awesome. Thank you very much =)","reactions":{"url":"https://api.github.com/repos/songyouwei/ABSA-PyTorch/issues/comments/546896172/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fhamborg","id":18700166,"node_id":"MDQ6VXNlcjE4NzAwMTY2","avatar_url":"https://avatars.githubusercontent.com/u/18700166?v=4","gravatar_id":"","url":"https://api.github.com/users/fhamborg","html_url":"https://github.com/fhamborg","followers_url":"https://api.github.com/users/fhamborg/followers","following_url":"https://api.github.com/users/fhamborg/following{/other_user}","gists_url":"https://api.github.com/users/fhamborg/gists{/gist_id}","starred_url":"https://api.github.com/users/fhamborg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhamborg/subscriptions","organizations_url":"https://api.github.com/users/fhamborg/orgs","repos_url":"https://api.github.com/users/fhamborg/repos","events_url":"https://api.github.com/users/fhamborg/events{/privacy}","received_events_url":"https://api.github.com/users/fhamborg/received_events","type":"User","site_admin":false}},{"id":2748084850,"node_id":"MDExOkNsb3NlZEV2ZW50Mjc0ODA4NDg1MA==","url":"https://api.github.com/repos/songyouwei/ABSA-PyTorch/issues/events/2748084850","actor":{"login":"fhamborg","id":18700166,"node_id":"MDQ6VXNlcjE4NzAwMTY2","avatar_url":"https://avatars.githubusercontent.com/u/18700166?v=4","gravatar_id":"","url":"https://api.github.com/users/fhamborg","html_url":"https://github.com/fhamborg","followers_url":"https://api.github.com/users/fhamborg/followers","following_url":"https://api.github.com/users/fhamborg/following{/other_user}","gists_url":"https://api.github.com/users/fhamborg/gists{/gist_id}","starred_url":"https://api.github.com/users/fhamborg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhamborg/subscriptions","organizations_url":"https://api.github.com/users/fhamborg/orgs","repos_url":"https://api.github.com/users/fhamborg/repos","events_url":"https://api.github.com/users/fhamborg/events{/privacy}","received_events_url":"https://api.github.com/users/fhamborg/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-10-28T11:01:48Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/songyouwei/ABSA-PyTorch/issues/comments/547144290","html_url":"https://github.com/songyouwei/ABSA-PyTorch/issues/93#issuecomment-547144290","issue_url":"https://api.github.com/repos/songyouwei/ABSA-PyTorch/issues/93","id":547144290,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzE0NDI5MA==","user":{"login":"fhamborg","id":18700166,"node_id":"MDQ6VXNlcjE4NzAwMTY2","avatar_url":"https://avatars.githubusercontent.com/u/18700166?v=4","gravatar_id":"","url":"https://api.github.com/users/fhamborg","html_url":"https://github.com/fhamborg","followers_url":"https://api.github.com/users/fhamborg/followers","following_url":"https://api.github.com/users/fhamborg/following{/other_user}","gists_url":"https://api.github.com/users/fhamborg/gists{/gist_id}","starred_url":"https://api.github.com/users/fhamborg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhamborg/subscriptions","organizations_url":"https://api.github.com/users/fhamborg/orgs","repos_url":"https://api.github.com/users/fhamborg/repos","events_url":"https://api.github.com/users/fhamborg/events{/privacy}","received_events_url":"https://api.github.com/users/fhamborg/received_events","type":"User","site_admin":false},"created_at":"2019-10-28T21:01:57Z","updated_at":"2019-10-28T21:02:12Z","author_association":"NONE","body":"Do you happen to know how to weight the loss of different classes differently? E.g., our dataset is pretty imbalanced and we'd like to weight classes accordingly. In the regular `CrossEntropyLoss` provided by pytorch, there is a [weight parameter](https://pytorch.org/docs/stable/nn.html#crossentropyloss) that allows to do that. My current implementation changes your `_toOneHot_smooth` as follows:\r\n\r\n```\r\n    def _toOneHot_smooth(self, label, batchsize, classes):\r\n        base_prob = self.para_LSR * 1.0 / classes\r\n        one_hot_label = torch.zeros(batchsize, classes) + base_prob\r\n\r\n        if self.weight is not None:\r\n            one_hot_label = one_hot_label * self.weight\r\n\r\n        for i in range(batchsize):\r\n            index = label[i]\r\n            one_hot_label[i, index] += (1.0 - self.para_LSR)\r\n\r\n        return one_hot_label\r\n```\r\n\r\nwhereby self.weight is a tensor consisting of C numbers (where C is the number of classes or labels). Does this seem correct to you? I'd very much appreciate your feedback! ","reactions":{"url":"https://api.github.com/repos/songyouwei/ABSA-PyTorch/issues/comments/547144290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fhamborg","id":18700166,"node_id":"MDQ6VXNlcjE4NzAwMTY2","avatar_url":"https://avatars.githubusercontent.com/u/18700166?v=4","gravatar_id":"","url":"https://api.github.com/users/fhamborg","html_url":"https://github.com/fhamborg","followers_url":"https://api.github.com/users/fhamborg/followers","following_url":"https://api.github.com/users/fhamborg/following{/other_user}","gists_url":"https://api.github.com/users/fhamborg/gists{/gist_id}","starred_url":"https://api.github.com/users/fhamborg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhamborg/subscriptions","organizations_url":"https://api.github.com/users/fhamborg/orgs","repos_url":"https://api.github.com/users/fhamborg/repos","events_url":"https://api.github.com/users/fhamborg/events{/privacy}","received_events_url":"https://api.github.com/users/fhamborg/received_events","type":"User","site_admin":false}}]