{"url":"https://api.github.com/repos/lonePatient/Bert-Multi-Label-Text-Classification/issues/6","repository_url":"https://api.github.com/repos/lonePatient/Bert-Multi-Label-Text-Classification","labels_url":"https://api.github.com/repos/lonePatient/Bert-Multi-Label-Text-Classification/issues/6/labels{/name}","comments_url":"https://api.github.com/repos/lonePatient/Bert-Multi-Label-Text-Classification/issues/6/comments","events_url":"https://api.github.com/repos/lonePatient/Bert-Multi-Label-Text-Classification/issues/6/events","html_url":"https://github.com/lonePatient/Bert-Multi-Label-Text-Classification/issues/6","id":459552060,"node_id":"MDU6SXNzdWU0NTk1NTIwNjA=","number":6,"title":"RuntimeError: Expected tensor for argument #1 'indices' to have scalar type Long; but got CPUType instead (while checking arguments for embedding)","user":{"login":"wannibar","id":25928537,"node_id":"MDQ6VXNlcjI1OTI4NTM3","avatar_url":"https://avatars.githubusercontent.com/u/25928537?v=4","gravatar_id":"","url":"https://api.github.com/users/wannibar","html_url":"https://github.com/wannibar","followers_url":"https://api.github.com/users/wannibar/followers","following_url":"https://api.github.com/users/wannibar/following{/other_user}","gists_url":"https://api.github.com/users/wannibar/gists{/gist_id}","starred_url":"https://api.github.com/users/wannibar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wannibar/subscriptions","organizations_url":"https://api.github.com/users/wannibar/orgs","repos_url":"https://api.github.com/users/wannibar/repos","events_url":"https://api.github.com/users/wannibar/events{/privacy}","received_events_url":"https://api.github.com/users/wannibar/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-06-23T08:51:08Z","updated_at":"2020-03-20T11:54:46Z","closed_at":"2020-03-20T11:54:46Z","author_association":"NONE","active_lock_reason":null,"body":"when I run this repo. i first get encoding error in utils.py and i solve it by import io library and with open by pass encoding='utf-8'. by when i run \" python train_bert_multi_label.py\", i get  following error....\r\n\r\n\r\n\r\n[2019-06-23 16:47:10]: bert train_bert_multi_label.py[line:75] INFO  initializing model\r\n[2019-06-23 16:47:16]: bert train_bert_multi_label.py[line:98] INFO  initializing callbacks\r\n[2019-06-23 16:47:16]: bert train_bert_multi_label.py[line:116] INFO  training model....\r\n[2019-06-23 16:47:16]: bert utils.py[line:23] WARNING  Warning: There's no GPU available on this machine, training will be performed on CPU.\r\nmodel summary info:\r\nTraceback (most recent call last):\r\n  File \"train_bert_multi_label.py\", line 144, in <module>\r\n    main()\r\n  File \"train_bert_multi_label.py\", line 138, in main\r\n    trainer.train(train_data = train_loader,valid_data=valid_loader)\r\n  File \"E:\\迅雷下载\\Bert-Multi-Label-Text-Classification-master\\Bert-Multi-Label-Text-Classification-master\\pybert\\train\\trainer.py\", line 167, in train\r\n    summary(self.model,*(input_ids, segment_ids,input_mask),show_input=True)\r\n  File \"E:\\迅雷下载\\Bert-Multi-Label-Text-Classification-master\\Bert-Multi-Label-Text-Classification-master\\pybert\\utils\\utils.py\", line 190, in summary\r\n    model(*inputs)\r\n  File \"C:\\soft\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 493, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"E:\\迅雷下载\\Bert-Multi-Label-Text-Classification-master\\Bert-Multi-Label-Text-Classification-master\\pybert\\model\\nn\\bert_fine.py\", line 28, in forward\r\n    output_all_encoded_layers=output_all_encoded_layers)\r\n  File \"C:\\soft\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 493, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"C:\\soft\\Anaconda3\\lib\\site-packages\\pytorch_pretrained_bert\\modeling.py\", line 730, in forward\r\n    embedding_output = self.embeddings(input_ids, token_type_ids)\r\n  File \"C:\\soft\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 493, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"C:\\soft\\Anaconda3\\lib\\site-packages\\pytorch_pretrained_bert\\modeling.py\", line 267, in forward\r\n    words_embeddings = self.word_embeddings(input_ids)\r\n  File \"C:\\soft\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 493, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"C:\\soft\\Anaconda3\\lib\\site-packages\\torch\\nn\\modules\\sparse.py\", line 117, in forward\r\n    self.norm_type, self.scale_grad_by_freq, self.sparse)\r\n  File \"C:\\soft\\Anaconda3\\lib\\site-packages\\torch\\nn\\functional.py\", line 1506, in embedding\r\n    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)\r\nRuntimeError: Expected tensor for argument #1 'indices' to have scalar type Long; but got CPUType instead (while checking arguments for embedding)\r\n\r\n\r\nanybody knows how to solve it~ QAQ","closed_by":{"login":"lonePatient","id":35169745,"node_id":"MDQ6VXNlcjM1MTY5NzQ1","avatar_url":"https://avatars.githubusercontent.com/u/35169745?v=4","gravatar_id":"","url":"https://api.github.com/users/lonePatient","html_url":"https://github.com/lonePatient","followers_url":"https://api.github.com/users/lonePatient/followers","following_url":"https://api.github.com/users/lonePatient/following{/other_user}","gists_url":"https://api.github.com/users/lonePatient/gists{/gist_id}","starred_url":"https://api.github.com/users/lonePatient/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lonePatient/subscriptions","organizations_url":"https://api.github.com/users/lonePatient/orgs","repos_url":"https://api.github.com/users/lonePatient/repos","events_url":"https://api.github.com/users/lonePatient/events{/privacy}","received_events_url":"https://api.github.com/users/lonePatient/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/lonePatient/Bert-Multi-Label-Text-Classification/issues/6/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/lonePatient/Bert-Multi-Label-Text-Classification/issues/6/timeline","performed_via_github_app":null,"state_reason":"completed"}