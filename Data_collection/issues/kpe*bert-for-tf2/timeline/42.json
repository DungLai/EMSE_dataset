[{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/575725133","html_url":"https://github.com/kpe/bert-for-tf2/issues/42#issuecomment-575725133","issue_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/42","id":575725133,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTcyNTEzMw==","user":{"login":"atreyasha","id":35427332,"node_id":"MDQ6VXNlcjM1NDI3MzMy","avatar_url":"https://avatars.githubusercontent.com/u/35427332?v=4","gravatar_id":"","url":"https://api.github.com/users/atreyasha","html_url":"https://github.com/atreyasha","followers_url":"https://api.github.com/users/atreyasha/followers","following_url":"https://api.github.com/users/atreyasha/following{/other_user}","gists_url":"https://api.github.com/users/atreyasha/gists{/gist_id}","starred_url":"https://api.github.com/users/atreyasha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atreyasha/subscriptions","organizations_url":"https://api.github.com/users/atreyasha/orgs","repos_url":"https://api.github.com/users/atreyasha/repos","events_url":"https://api.github.com/users/atreyasha/events{/privacy}","received_events_url":"https://api.github.com/users/atreyasha/received_events","type":"User","site_admin":false},"created_at":"2020-01-17T17:41:38Z","updated_at":"2020-01-17T17:41:38Z","author_association":"NONE","body":"I am working on a similar sequence tagging task for argument candidate identification. Essentially BERT or ALBERT would perform the encoding aspect of the raw input. Then, you would need a layer on top of BERT|ALBERT to decode the representations to the desired target.\r\n\r\nI would essentially follow this example here: https://github.com/kpe/bert-for-tf2/blob/master/examples/gpu_movie_reviews.ipynb\r\n\r\nUnder `create_model`, you would need to modify the layers after the BERT|ALBERT layer to map to your output sequence dimension. I will probably do this task in another repo and can post some results soon.\r\n\r\n@kpe you mentioned in #30 to ignore the activations of the padding in the output layer, would you also suggest doing this for a sequence tagging task? If so, how would you propose doing this in the output layer?\r\n\r\nAlso, thank you for this awesome repo. Minor issue though: under NEWS on the readme, I think the first entry should be 6th Jan 2020. Just a minor thing, no biggie :)","reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/575725133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"atreyasha","id":35427332,"node_id":"MDQ6VXNlcjM1NDI3MzMy","avatar_url":"https://avatars.githubusercontent.com/u/35427332?v=4","gravatar_id":"","url":"https://api.github.com/users/atreyasha","html_url":"https://github.com/atreyasha","followers_url":"https://api.github.com/users/atreyasha/followers","following_url":"https://api.github.com/users/atreyasha/following{/other_user}","gists_url":"https://api.github.com/users/atreyasha/gists{/gist_id}","starred_url":"https://api.github.com/users/atreyasha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atreyasha/subscriptions","organizations_url":"https://api.github.com/users/atreyasha/orgs","repos_url":"https://api.github.com/users/atreyasha/repos","events_url":"https://api.github.com/users/atreyasha/events{/privacy}","received_events_url":"https://api.github.com/users/atreyasha/received_events","type":"User","site_admin":false}},{"id":2958960567,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mjk1ODk2MDU2Nw==","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/2958960567","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-01-17T17:41:39Z","performed_via_github_app":null},{"id":2958960568,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI5NTg5NjA1Njg=","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/2958960568","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-01-17T17:41:39Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/590137458","html_url":"https://github.com/kpe/bert-for-tf2/issues/42#issuecomment-590137458","issue_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/42","id":590137458,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MDEzNzQ1OA==","user":{"login":"harrystuart","id":42882697,"node_id":"MDQ6VXNlcjQyODgyNjk3","avatar_url":"https://avatars.githubusercontent.com/u/42882697?v=4","gravatar_id":"","url":"https://api.github.com/users/harrystuart","html_url":"https://github.com/harrystuart","followers_url":"https://api.github.com/users/harrystuart/followers","following_url":"https://api.github.com/users/harrystuart/following{/other_user}","gists_url":"https://api.github.com/users/harrystuart/gists{/gist_id}","starred_url":"https://api.github.com/users/harrystuart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harrystuart/subscriptions","organizations_url":"https://api.github.com/users/harrystuart/orgs","repos_url":"https://api.github.com/users/harrystuart/repos","events_url":"https://api.github.com/users/harrystuart/events{/privacy}","received_events_url":"https://api.github.com/users/harrystuart/received_events","type":"User","site_admin":false},"created_at":"2020-02-24T00:48:03Z","updated_at":"2020-02-24T00:48:03Z","author_association":"NONE","body":"Any update on NER tasks with this library?","reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/590137458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"harrystuart","id":42882697,"node_id":"MDQ6VXNlcjQyODgyNjk3","avatar_url":"https://avatars.githubusercontent.com/u/42882697?v=4","gravatar_id":"","url":"https://api.github.com/users/harrystuart","html_url":"https://github.com/harrystuart","followers_url":"https://api.github.com/users/harrystuart/followers","following_url":"https://api.github.com/users/harrystuart/following{/other_user}","gists_url":"https://api.github.com/users/harrystuart/gists{/gist_id}","starred_url":"https://api.github.com/users/harrystuart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harrystuart/subscriptions","organizations_url":"https://api.github.com/users/harrystuart/orgs","repos_url":"https://api.github.com/users/harrystuart/repos","events_url":"https://api.github.com/users/harrystuart/events{/privacy}","received_events_url":"https://api.github.com/users/harrystuart/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/910702791","html_url":"https://github.com/kpe/bert-for-tf2/issues/42#issuecomment-910702791","issue_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/42","id":910702791,"node_id":"IC_kwDOCzR_5M42SDjH","user":{"login":"yingchengsun","id":11466174,"node_id":"MDQ6VXNlcjExNDY2MTc0","avatar_url":"https://avatars.githubusercontent.com/u/11466174?v=4","gravatar_id":"","url":"https://api.github.com/users/yingchengsun","html_url":"https://github.com/yingchengsun","followers_url":"https://api.github.com/users/yingchengsun/followers","following_url":"https://api.github.com/users/yingchengsun/following{/other_user}","gists_url":"https://api.github.com/users/yingchengsun/gists{/gist_id}","starred_url":"https://api.github.com/users/yingchengsun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yingchengsun/subscriptions","organizations_url":"https://api.github.com/users/yingchengsun/orgs","repos_url":"https://api.github.com/users/yingchengsun/repos","events_url":"https://api.github.com/users/yingchengsun/events{/privacy}","received_events_url":"https://api.github.com/users/yingchengsun/received_events","type":"User","site_admin":false},"created_at":"2021-09-01T20:20:23Z","updated_at":"2021-09-01T20:20:23Z","author_association":"NONE","body":"If there is a NER example with this library, that will be very helpful!","reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/910702791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yingchengsun","id":11466174,"node_id":"MDQ6VXNlcjExNDY2MTc0","avatar_url":"https://avatars.githubusercontent.com/u/11466174?v=4","gravatar_id":"","url":"https://api.github.com/users/yingchengsun","html_url":"https://github.com/yingchengsun","followers_url":"https://api.github.com/users/yingchengsun/followers","following_url":"https://api.github.com/users/yingchengsun/following{/other_user}","gists_url":"https://api.github.com/users/yingchengsun/gists{/gist_id}","starred_url":"https://api.github.com/users/yingchengsun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yingchengsun/subscriptions","organizations_url":"https://api.github.com/users/yingchengsun/orgs","repos_url":"https://api.github.com/users/yingchengsun/repos","events_url":"https://api.github.com/users/yingchengsun/events{/privacy}","received_events_url":"https://api.github.com/users/yingchengsun/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/912355329","html_url":"https://github.com/kpe/bert-for-tf2/issues/42#issuecomment-912355329","issue_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/42","id":912355329,"node_id":"IC_kwDOCzR_5M42YXAB","user":{"login":"ptamas88","id":36891268,"node_id":"MDQ6VXNlcjM2ODkxMjY4","avatar_url":"https://avatars.githubusercontent.com/u/36891268?v=4","gravatar_id":"","url":"https://api.github.com/users/ptamas88","html_url":"https://github.com/ptamas88","followers_url":"https://api.github.com/users/ptamas88/followers","following_url":"https://api.github.com/users/ptamas88/following{/other_user}","gists_url":"https://api.github.com/users/ptamas88/gists{/gist_id}","starred_url":"https://api.github.com/users/ptamas88/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ptamas88/subscriptions","organizations_url":"https://api.github.com/users/ptamas88/orgs","repos_url":"https://api.github.com/users/ptamas88/repos","events_url":"https://api.github.com/users/ptamas88/events{/privacy}","received_events_url":"https://api.github.com/users/ptamas88/received_events","type":"User","site_admin":false},"created_at":"2021-09-03T08:21:16Z","updated_at":"2021-09-03T08:22:36Z","author_association":"NONE","body":"Hi,\r\nAs I managed to use this library for NER task i am happy to share my experiences.\r\nSorry, but I can't share the whole code, but trying to explain the key parts.\r\n\r\n1) The input text is tokenized by the tokenizer module and padded to a specified max lenght (in my case 200 tokens at max)\r\n2) For each token the output tags are transformed into a one-hot vector and if the tokenizer broke up one word into multiple tokens then I used the belonging tag for the first token and [MASK] for the remaining part of the original word\r\n3) So I have X sentences in the trainign set, then the input shape is (X,200) hence 200 is the padded lenght of each sentences. In this case the output shape is (X,200,NUMBER_OF_TAGS). NUMBER_OF_TAGS is the number of your entity types, depends of whether you use BIOE, or just BIO, and here you add the special tokens: [CLS], [PAD], [MASK]. In my case here are the tags:\r\n`['B-ORG', 'I-ORG', 'B-MISC', 'I-MISC', 'B-LOC', 'I-LOC', 'B-PER', 'I-PER', 'O', '[CLS]', '[MASK]', '[PAD]'].`\r\nThis way my shapes are (X,200) and (X,200,12)\r\n4) load the Bert model the same way as in the calssification example but here we will use a different model architecture for the remaining layers, hence it is not just a classification. This is basically the example codes of the packages description with a little tweak:\r\n```\r\nbert_layer = bert_tf2.BertModelLayer.from_params(bert_params, name=\"bert\")\r\n\r\ninput = tf.keras.layers.Input(shape=(200))\r\noutput = bert_layer(input)\r\noutput = tf.keras.layers.TimeDistributed(tf.keras.layers.Dense(units=12, activation='softmax'))(output)\r\nmodel = tf.keras.models.Model(inputs=input, outputs=output)\r\n\r\nmodel.build(input_shape=(200))\r\n\r\nbert_layer.apply_adapter_freeze()\r\nbert_layer.embeddings_layer.trainable=False \r\n```\r\n\r\nThe magic here is the TimeDistributed wrapper layer.\r\nMy results:\r\nAfter just 1 epoch on 29k trainign sentences:\r\nloss: 0.0227 - categorical_accuracy: 0.9933 - val_loss: 0.0042 - val_categorical_accuracy: 0.9988\r\n\r\nSo basically, that's it folks :)","reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/912355329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ptamas88","id":36891268,"node_id":"MDQ6VXNlcjM2ODkxMjY4","avatar_url":"https://avatars.githubusercontent.com/u/36891268?v=4","gravatar_id":"","url":"https://api.github.com/users/ptamas88","html_url":"https://github.com/ptamas88","followers_url":"https://api.github.com/users/ptamas88/followers","following_url":"https://api.github.com/users/ptamas88/following{/other_user}","gists_url":"https://api.github.com/users/ptamas88/gists{/gist_id}","starred_url":"https://api.github.com/users/ptamas88/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ptamas88/subscriptions","organizations_url":"https://api.github.com/users/ptamas88/orgs","repos_url":"https://api.github.com/users/ptamas88/repos","events_url":"https://api.github.com/users/ptamas88/events{/privacy}","received_events_url":"https://api.github.com/users/ptamas88/received_events","type":"User","site_admin":false}}]