[{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/810009815","html_url":"https://github.com/kpe/bert-for-tf2/issues/87#issuecomment-810009815","issue_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/87","id":810009815,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDAwOTgxNQ==","user":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"created_at":"2021-03-30T08:06:20Z","updated_at":"2021-03-30T08:06:20Z","author_association":"OWNER","body":"\r\nlooks like an error in the docu - try passing any additional keras parameters directly to the `BertModelLayer` constructor not the `Params`:\r\n\r\n``` python\r\nfrom bert import BertModelLayer\r\n\r\nl_bert = BertModelLayer(**BertModelLayer.Params(\r\n    vocab_size = 16000, # embedding params\r\n    use_token_type = True,\r\n    use_position_embeddings = True,\r\n    token_type_vocab_size = 2,\r\n\r\n    num_layers = 12, # transformer encoder params\r\n    hidden_size = 768,\r\n    hidden_dropout = 0.1,\r\n    intermediate_size = 4*768,\r\n    intermediate_activation = \"gelu\",\r\n\r\n    adapter_size = None, # see arXiv:1902.00751 (adapter-BERT)\r\n\r\n    shared_layer = False, # True for ALBERT (arXiv:1909.11942)\r\n    embedding_size = None, # None for BERT, wordpiece embedding size for ALBERT\r\n  ),\r\n  name = \"bert\" # any other Keras layer params\r\n)\r\n```","reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/810009815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false}},{"id":4525891884,"node_id":"MDExOkNsb3NlZEV2ZW50NDUyNTg5MTg4NA==","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/4525891884","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-03-30T08:06:20Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/819260261","html_url":"https://github.com/kpe/bert-for-tf2/issues/87#issuecomment-819260261","issue_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/87","id":819260261,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTI2MDI2MQ==","user":{"login":"lijiansong","id":10958439,"node_id":"MDQ6VXNlcjEwOTU4NDM5","avatar_url":"https://avatars.githubusercontent.com/u/10958439?v=4","gravatar_id":"","url":"https://api.github.com/users/lijiansong","html_url":"https://github.com/lijiansong","followers_url":"https://api.github.com/users/lijiansong/followers","following_url":"https://api.github.com/users/lijiansong/following{/other_user}","gists_url":"https://api.github.com/users/lijiansong/gists{/gist_id}","starred_url":"https://api.github.com/users/lijiansong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lijiansong/subscriptions","organizations_url":"https://api.github.com/users/lijiansong/orgs","repos_url":"https://api.github.com/users/lijiansong/repos","events_url":"https://api.github.com/users/lijiansong/events{/privacy}","received_events_url":"https://api.github.com/users/lijiansong/received_events","type":"User","site_admin":false},"created_at":"2021-04-14T06:19:48Z","updated_at":"2021-04-14T06:31:19Z","author_association":"NONE","body":"@kpe \r\nHi, when I run the `gpu` moive review example, the python script is here: <https://gist.github.com/lijiansong/95c84fbd0bddf82590203c3473f333e9>\r\nraise the following errors:\r\n```\r\nTraceback (most recent call last):\r\n  File \"gpu_movie_reviews.py\", line 218, in <module>\r\n    model = create_model(data.max_seq_len, adapter_size=adapter_size)\r\n  File \"gpu_movie_reviews.py\", line 183, in create_model\r\n    bert_params = map_stock_config_to_params(bc)\r\n  File \"/home/extend/work-space/memory/tensorflow-2.1.3/ml-examples/dl/bert-for-tf2/bert/loader.py\", line 155, in map_stock_config_to_params\r\n    shared_layer=bc.embedding_size is not None,\r\n  File \"/home/extend/work-space/anaconda2/envs/tf2-source/lib/python3.5/site-packages/params/params.py\", line 95, in __init__\r\n    self.update(kwargs)            # override with kwargs\r\n  File \"/home/extend/work-space/anaconda2/envs/tf2-source/lib/python3.5/site-packages/params/params.py\", line 102, in update\r\n    self[key] = arg[key]\r\n  File \"/home/extend/work-space/anaconda2/envs/tf2-source/lib/python3.5/site-packages/params/params.py\", line 120, in __setitem__\r\n    \"in Params instance '{}'\".format(key, self.__class__.__name__))\r\nAttributeError: Setting unexpected parameter 'hidden_size' in Params instance 'Params'\r\n```\r\nMy TensorFlow version is `2.1.3`\r\nparams_flow: `0.7.4`\r\nparams: `0.9.0`\r\n","reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/819260261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lijiansong","id":10958439,"node_id":"MDQ6VXNlcjEwOTU4NDM5","avatar_url":"https://avatars.githubusercontent.com/u/10958439?v=4","gravatar_id":"","url":"https://api.github.com/users/lijiansong","html_url":"https://github.com/lijiansong","followers_url":"https://api.github.com/users/lijiansong/followers","following_url":"https://api.github.com/users/lijiansong/following{/other_user}","gists_url":"https://api.github.com/users/lijiansong/gists{/gist_id}","starred_url":"https://api.github.com/users/lijiansong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lijiansong/subscriptions","organizations_url":"https://api.github.com/users/lijiansong/orgs","repos_url":"https://api.github.com/users/lijiansong/repos","events_url":"https://api.github.com/users/lijiansong/events{/privacy}","received_events_url":"https://api.github.com/users/lijiansong/received_events","type":"User","site_admin":false}},{"id":4591628230,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDU5MTYyODIzMA==","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/4591628230","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-14T06:19:48Z","performed_via_github_app":null},{"id":4591628233,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1OTE2MjgyMzM=","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/4591628233","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-14T06:19:48Z","performed_via_github_app":null}]