[{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/499217677","html_url":"https://github.com/kpe/bert-for-tf2/issues/2#issuecomment-499217677","issue_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/2","id":499217677,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTIxNzY3Nw==","user":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"created_at":"2019-06-05T19:15:00Z","updated_at":"2019-06-06T11:29:32Z","author_association":"OWNER","body":"@ralphbrooks - thank you for noting that. I think the example in the README was somewhat short. The model variables in Keras seems to be created only after the model has been build, i.e. keras needs to know some of the dimensions of the input to properly calculate the dimensions of the weights. So, a more complete example might look like this (note the call to `Model.build`):\r\n``` python\r\n        print(model_dir)\r\n\r\n        bert_config_file = os.path.join(model_dir, \"bert_config.json\")\r\n        bert_ckpt_file   = os.path.join(model_dir, \"bert_model.ckpt\")\r\n\r\n        with tf.io.gfile.GFile(bert_config_file, \"r\") as reader:\r\n            stock_params = StockBertConfig.from_json_string(reader.read())\r\n            bert_params  = stock_params.to_bert_model_layer_params()\r\n\r\n        l_bert = BertModelLayer.from_params(bert_params, name=\"bert\")\r\n\r\n        max_seq_len=128\r\n        l_input_ids      = keras.layers.Input(shape=(max_seq_len,), dtype='int32', name=\"input_ids\")\r\n        l_token_type_ids = keras.layers.Input(shape=(max_seq_len,), dtype='int32', name=\"token_type_ids\")\r\n        output = l_bert([l_input_ids, l_token_type_ids])\r\n\r\n        model = keras.Model(inputs=[l_input_ids, l_token_type_ids], outputs=output)\r\n        model.build(input_shape=[(None, max_seq_len),\r\n                                 (None, max_seq_len)])\r\n\r\n        load_stock_weights(l_bert, bert_ckpt_file)\r\n\r\n```\r\n\r\n**N.B** you might also find some of the unitests under `tests` useful.","reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/499217677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false}},{"id":2392256183,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjM5MjI1NjE4Mw==","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/2392256183","actor":{"login":"ralphbrooks","id":4589692,"node_id":"MDQ6VXNlcjQ1ODk2OTI=","avatar_url":"https://avatars.githubusercontent.com/u/4589692?v=4","gravatar_id":"","url":"https://api.github.com/users/ralphbrooks","html_url":"https://github.com/ralphbrooks","followers_url":"https://api.github.com/users/ralphbrooks/followers","following_url":"https://api.github.com/users/ralphbrooks/following{/other_user}","gists_url":"https://api.github.com/users/ralphbrooks/gists{/gist_id}","starred_url":"https://api.github.com/users/ralphbrooks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ralphbrooks/subscriptions","organizations_url":"https://api.github.com/users/ralphbrooks/orgs","repos_url":"https://api.github.com/users/ralphbrooks/repos","events_url":"https://api.github.com/users/ralphbrooks/events{/privacy}","received_events_url":"https://api.github.com/users/ralphbrooks/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-06-05T19:15:00Z","performed_via_github_app":null},{"id":2392256184,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIzOTIyNTYxODQ=","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/2392256184","actor":{"login":"ralphbrooks","id":4589692,"node_id":"MDQ6VXNlcjQ1ODk2OTI=","avatar_url":"https://avatars.githubusercontent.com/u/4589692?v=4","gravatar_id":"","url":"https://api.github.com/users/ralphbrooks","html_url":"https://github.com/ralphbrooks","followers_url":"https://api.github.com/users/ralphbrooks/followers","following_url":"https://api.github.com/users/ralphbrooks/following{/other_user}","gists_url":"https://api.github.com/users/ralphbrooks/gists{/gist_id}","starred_url":"https://api.github.com/users/ralphbrooks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ralphbrooks/subscriptions","organizations_url":"https://api.github.com/users/ralphbrooks/orgs","repos_url":"https://api.github.com/users/ralphbrooks/repos","events_url":"https://api.github.com/users/ralphbrooks/events{/privacy}","received_events_url":"https://api.github.com/users/ralphbrooks/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-06-05T19:15:00Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/515351248","html_url":"https://github.com/kpe/bert-for-tf2/issues/2#issuecomment-515351248","issue_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/2","id":515351248,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNTM1MTI0OA==","user":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"created_at":"2019-07-26T07:58:23Z","updated_at":"2019-07-26T07:58:23Z","author_association":"OWNER","body":"an example on sentiment classifier fine-tuning could now be found under `examples/`.","reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/515351248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false}},{"id":2511779102,"node_id":"MDExOkNsb3NlZEV2ZW50MjUxMTc3OTEwMg==","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/2511779102","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-07-26T07:58:27Z","state_reason":null,"performed_via_github_app":null}]