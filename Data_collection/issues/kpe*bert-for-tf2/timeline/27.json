[{"id":2887496576,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mjg4NzQ5NjU3Ng==","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/2887496576","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-12-16T21:10:39Z","performed_via_github_app":null},{"id":2887496579,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI4ODc0OTY1Nzk=","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/2887496579","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-12-16T21:10:39Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/566276493","html_url":"https://github.com/kpe/bert-for-tf2/issues/27#issuecomment-566276493","issue_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/27","id":566276493,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjI3NjQ5Mw==","user":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"created_at":"2019-12-16T22:31:58Z","updated_at":"2019-12-16T22:31:58Z","author_association":"OWNER","body":"@roebius - this is most likely an issue with keras and dict outputs - internally in tf.keras the dict is flattened to a list, and the order might get changed. I thought until now that the order in this case is alphabetical (and would be interested to understand why that's not the case - I believe it is different between TF versions; I also have issued a different but related bug to the TF team - https://github.com/tensorflow/tensorflow/issues/34199).\r\nI don't think it is an issue with bert-for-tf2. I guess you are using `BertModelLayer` which is just a layer (not aware of the \"outer\" keras model populating the outputs). You could easily replace it with an `EmbeddingLayer` and see, if the keras behavior will  change.","reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/566276493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false}},{"id":2887744957,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mjg4Nzc0NDk1Nw==","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/2887744957","actor":{"login":"roebius","id":8594073,"node_id":"MDQ6VXNlcjg1OTQwNzM=","avatar_url":"https://avatars.githubusercontent.com/u/8594073?v=4","gravatar_id":"","url":"https://api.github.com/users/roebius","html_url":"https://github.com/roebius","followers_url":"https://api.github.com/users/roebius/followers","following_url":"https://api.github.com/users/roebius/following{/other_user}","gists_url":"https://api.github.com/users/roebius/gists{/gist_id}","starred_url":"https://api.github.com/users/roebius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roebius/subscriptions","organizations_url":"https://api.github.com/users/roebius/orgs","repos_url":"https://api.github.com/users/roebius/repos","events_url":"https://api.github.com/users/roebius/events{/privacy}","received_events_url":"https://api.github.com/users/roebius/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-12-16T22:31:58Z","performed_via_github_app":null},{"id":2887744959,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI4ODc3NDQ5NTk=","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/2887744959","actor":{"login":"roebius","id":8594073,"node_id":"MDQ6VXNlcjg1OTQwNzM=","avatar_url":"https://avatars.githubusercontent.com/u/8594073?v=4","gravatar_id":"","url":"https://api.github.com/users/roebius","html_url":"https://github.com/roebius","followers_url":"https://api.github.com/users/roebius/followers","following_url":"https://api.github.com/users/roebius/following{/other_user}","gists_url":"https://api.github.com/users/roebius/gists{/gist_id}","starred_url":"https://api.github.com/users/roebius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roebius/subscriptions","organizations_url":"https://api.github.com/users/roebius/orgs","repos_url":"https://api.github.com/users/roebius/repos","events_url":"https://api.github.com/users/roebius/events{/privacy}","received_events_url":"https://api.github.com/users/roebius/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-12-16T22:31:58Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/566279568","html_url":"https://github.com/kpe/bert-for-tf2/issues/27#issuecomment-566279568","issue_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/27","id":566279568,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjI3OTU2OA==","user":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"created_at":"2019-12-16T22:39:59Z","updated_at":"2019-12-16T22:59:57Z","author_association":"OWNER","body":"@roebius - (edit: I believe it is name of the output tensor that counts not the dictionary entry ) - it is the dict key that counts (but it didn't worked right with a loss dict, therefore I've switched to using list outputs instead).\r\nI'm using a:\r\n```\r\nident = lambda n: tf.keras.layers.Lambda(lambda a: a, name=n)\r\noutputs = [ident(\"output-a\")(out_a), ident(\"output-b\")(out_b)]\r\n```\r\nto force the names on the output tensors.","reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/566279568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false}},{"id":2887767465,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mjg4Nzc2NzQ2NQ==","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/2887767465","actor":{"login":"roebius","id":8594073,"node_id":"MDQ6VXNlcjg1OTQwNzM=","avatar_url":"https://avatars.githubusercontent.com/u/8594073?v=4","gravatar_id":"","url":"https://api.github.com/users/roebius","html_url":"https://github.com/roebius","followers_url":"https://api.github.com/users/roebius/followers","following_url":"https://api.github.com/users/roebius/following{/other_user}","gists_url":"https://api.github.com/users/roebius/gists{/gist_id}","starred_url":"https://api.github.com/users/roebius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roebius/subscriptions","organizations_url":"https://api.github.com/users/roebius/orgs","repos_url":"https://api.github.com/users/roebius/repos","events_url":"https://api.github.com/users/roebius/events{/privacy}","received_events_url":"https://api.github.com/users/roebius/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-12-16T22:39:59Z","performed_via_github_app":null},{"id":2887767469,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI4ODc3Njc0Njk=","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/2887767469","actor":{"login":"roebius","id":8594073,"node_id":"MDQ6VXNlcjg1OTQwNzM=","avatar_url":"https://avatars.githubusercontent.com/u/8594073?v=4","gravatar_id":"","url":"https://api.github.com/users/roebius","html_url":"https://github.com/roebius","followers_url":"https://api.github.com/users/roebius/followers","following_url":"https://api.github.com/users/roebius/following{/other_user}","gists_url":"https://api.github.com/users/roebius/gists{/gist_id}","starred_url":"https://api.github.com/users/roebius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roebius/subscriptions","organizations_url":"https://api.github.com/users/roebius/orgs","repos_url":"https://api.github.com/users/roebius/repos","events_url":"https://api.github.com/users/roebius/events{/privacy}","received_events_url":"https://api.github.com/users/roebius/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-12-16T22:39:59Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/566301022","html_url":"https://github.com/kpe/bert-for-tf2/issues/27#issuecomment-566301022","issue_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/27","id":566301022,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjMwMTAyMg==","user":{"login":"roebius","id":8594073,"node_id":"MDQ6VXNlcjg1OTQwNzM=","avatar_url":"https://avatars.githubusercontent.com/u/8594073?v=4","gravatar_id":"","url":"https://api.github.com/users/roebius","html_url":"https://github.com/roebius","followers_url":"https://api.github.com/users/roebius/followers","following_url":"https://api.github.com/users/roebius/following{/other_user}","gists_url":"https://api.github.com/users/roebius/gists{/gist_id}","starred_url":"https://api.github.com/users/roebius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roebius/subscriptions","organizations_url":"https://api.github.com/users/roebius/orgs","repos_url":"https://api.github.com/users/roebius/repos","events_url":"https://api.github.com/users/roebius/events{/privacy}","received_events_url":"https://api.github.com/users/roebius/received_events","type":"User","site_admin":false},"created_at":"2019-12-16T23:42:45Z","updated_at":"2019-12-17T00:11:10Z","author_association":"NONE","body":"Thank you for your reply and suggestions.\r\nI confirm I am using `BertModelLayer`. I also believe it is a Keras issue, but it is a bit complicated for me to change the output layer names: some TF ops I am using force name prefixes for the output layers, so I have to use the actual layer names for my losses but I have to use different names in the output dictionary for the TFRecords I am feeding.\r\n(sorry that I cannot attach a schema as I am not allowed by the rules of a competition I am taking part in :(","reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/566301022/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roebius","id":8594073,"node_id":"MDQ6VXNlcjg1OTQwNzM=","avatar_url":"https://avatars.githubusercontent.com/u/8594073?v=4","gravatar_id":"","url":"https://api.github.com/users/roebius","html_url":"https://github.com/roebius","followers_url":"https://api.github.com/users/roebius/followers","following_url":"https://api.github.com/users/roebius/following{/other_user}","gists_url":"https://api.github.com/users/roebius/gists{/gist_id}","starred_url":"https://api.github.com/users/roebius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roebius/subscriptions","organizations_url":"https://api.github.com/users/roebius/orgs","repos_url":"https://api.github.com/users/roebius/repos","events_url":"https://api.github.com/users/roebius/events{/privacy}","received_events_url":"https://api.github.com/users/roebius/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/566435646","html_url":"https://github.com/kpe/bert-for-tf2/issues/27#issuecomment-566435646","issue_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/27","id":566435646,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjQzNTY0Ng==","user":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"created_at":"2019-12-17T08:24:11Z","updated_at":"2019-12-17T08:24:11Z","author_association":"OWNER","body":"@roebius - changing the output names can be done with the `ident` function/layer above. But if I remember correctly it is relevant for the model losses only. ","reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/566435646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false}},{"id":2888883775,"node_id":"MDExOkNsb3NlZEV2ZW50Mjg4ODg4Mzc3NQ==","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/2888883775","actor":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-12-17T08:24:11Z","state_reason":null,"performed_via_github_app":null},{"id":2888883783,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mjg4ODg4Mzc4Mw==","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/2888883783","actor":{"login":"roebius","id":8594073,"node_id":"MDQ6VXNlcjg1OTQwNzM=","avatar_url":"https://avatars.githubusercontent.com/u/8594073?v=4","gravatar_id":"","url":"https://api.github.com/users/roebius","html_url":"https://github.com/roebius","followers_url":"https://api.github.com/users/roebius/followers","following_url":"https://api.github.com/users/roebius/following{/other_user}","gists_url":"https://api.github.com/users/roebius/gists{/gist_id}","starred_url":"https://api.github.com/users/roebius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roebius/subscriptions","organizations_url":"https://api.github.com/users/roebius/orgs","repos_url":"https://api.github.com/users/roebius/repos","events_url":"https://api.github.com/users/roebius/events{/privacy}","received_events_url":"https://api.github.com/users/roebius/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-12-17T08:24:11Z","performed_via_github_app":null},{"id":2888883786,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI4ODg4ODM3ODY=","url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/events/2888883786","actor":{"login":"roebius","id":8594073,"node_id":"MDQ6VXNlcjg1OTQwNzM=","avatar_url":"https://avatars.githubusercontent.com/u/8594073?v=4","gravatar_id":"","url":"https://api.github.com/users/roebius","html_url":"https://github.com/roebius","followers_url":"https://api.github.com/users/roebius/followers","following_url":"https://api.github.com/users/roebius/following{/other_user}","gists_url":"https://api.github.com/users/roebius/gists{/gist_id}","starred_url":"https://api.github.com/users/roebius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roebius/subscriptions","organizations_url":"https://api.github.com/users/roebius/orgs","repos_url":"https://api.github.com/users/roebius/repos","events_url":"https://api.github.com/users/roebius/events{/privacy}","received_events_url":"https://api.github.com/users/roebius/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-12-17T08:24:11Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/566545309","html_url":"https://github.com/kpe/bert-for-tf2/issues/27#issuecomment-566545309","issue_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/27","id":566545309,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjU0NTMwOQ==","user":{"login":"roebius","id":8594073,"node_id":"MDQ6VXNlcjg1OTQwNzM=","avatar_url":"https://avatars.githubusercontent.com/u/8594073?v=4","gravatar_id":"","url":"https://api.github.com/users/roebius","html_url":"https://github.com/roebius","followers_url":"https://api.github.com/users/roebius/followers","following_url":"https://api.github.com/users/roebius/following{/other_user}","gists_url":"https://api.github.com/users/roebius/gists{/gist_id}","starred_url":"https://api.github.com/users/roebius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roebius/subscriptions","organizations_url":"https://api.github.com/users/roebius/orgs","repos_url":"https://api.github.com/users/roebius/repos","events_url":"https://api.github.com/users/roebius/events{/privacy}","received_events_url":"https://api.github.com/users/roebius/received_events","type":"User","site_admin":false},"created_at":"2019-12-17T13:39:40Z","updated_at":"2019-12-17T13:39:40Z","author_association":"NONE","body":"I was eventually able to solve the issue.\r\nFor the model creation, I am passing the outputs as a list instead of a dictionary: this way the prediction outputs are not switched anymore.\r\n\r\nThanks to your `ident` suggestion I was able to refactor my code in order to use the output layer names consistently between model output, model losses and TFRecord feature mapping when feeding the model for fit/predict.\r\nMany thanks again.","reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/comments/566545309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roebius","id":8594073,"node_id":"MDQ6VXNlcjg1OTQwNzM=","avatar_url":"https://avatars.githubusercontent.com/u/8594073?v=4","gravatar_id":"","url":"https://api.github.com/users/roebius","html_url":"https://github.com/roebius","followers_url":"https://api.github.com/users/roebius/followers","following_url":"https://api.github.com/users/roebius/following{/other_user}","gists_url":"https://api.github.com/users/roebius/gists{/gist_id}","starred_url":"https://api.github.com/users/roebius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roebius/subscriptions","organizations_url":"https://api.github.com/users/roebius/orgs","repos_url":"https://api.github.com/users/roebius/repos","events_url":"https://api.github.com/users/roebius/events{/privacy}","received_events_url":"https://api.github.com/users/roebius/received_events","type":"User","site_admin":false}}]