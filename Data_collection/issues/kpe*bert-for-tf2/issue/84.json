{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/84","repository_url":"https://api.github.com/repos/kpe/bert-for-tf2","labels_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/84/labels{/name}","comments_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/84/comments","events_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/84/events","html_url":"https://github.com/kpe/bert-for-tf2/issues/84","id":772712457,"node_id":"MDU6SXNzdWU3NzI3MTI0NTc=","number":84,"title":"ValueError: Found unexpected keys that do not correspond to any Model output","user":{"login":"callzhang","id":5102827,"node_id":"MDQ6VXNlcjUxMDI4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/5102827?v=4","gravatar_id":"","url":"https://api.github.com/users/callzhang","html_url":"https://github.com/callzhang","followers_url":"https://api.github.com/users/callzhang/followers","following_url":"https://api.github.com/users/callzhang/following{/other_user}","gists_url":"https://api.github.com/users/callzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/callzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/callzhang/subscriptions","organizations_url":"https://api.github.com/users/callzhang/orgs","repos_url":"https://api.github.com/users/callzhang/repos","events_url":"https://api.github.com/users/callzhang/events{/privacy}","received_events_url":"https://api.github.com/users/callzhang/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-12-22T07:26:22Z","updated_at":"2020-12-22T07:26:22Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubintu 18.04\r\n- TensorFlow version and how it was installed (source or binary): 2.3.0\r\n- TensorFlow-Addons version and how it was installed (source or binary): 0.12.0\r\n- Python version: 3.8.5\r\n- Is GPU used? (yes/no): both\r\n\r\n**Describe the bug**\r\n\r\nWhen using `tfa.losses.SigmoidFocalCrossEntropy(from_logits=True, reduction='auto')` the model raised ValueError:\r\n`ValueError: Found unexpected keys that do not correspond to any Model output: dict_keys(['class_name', 'config']). Expected: ['dense']`\r\n\r\n**Code to reproduce the issue**\r\n```\r\n...\r\nloss = tfa.losses.SigmoidFocalCrossEntropy(from_logits=True, reduction='auto')\r\nl_bert = bert.BertModelLayer.from_params(bert_params, name='albert' if albert else \"bert\")\r\nl_input_ids = tf.keras.layers.Input(shape=(max_seq_length,), dtype='int32', name=\"input_ids\")\r\nl_mask_ids = tf.keras.layers.Input(shape=(max_seq_length,), dtype='int32', name=\"mask_ids\")\r\nl_token_type_ids = tf.keras.layers.Input(shape=(max_seq_length,), dtype='int32', name=\"token_type_ids\")\r\noutput = l_bert([l_input_ids, l_token_type_ids], mask=l_mask_ids)\r\nlogits = tf.keras.layers.Dense(num_labels, kernel_initializer=tf.keras.initializers.TruncatedNormal(bert_params.initializer_range))(output)\r\nmodel = tf.keras.Model(inputs=[l_input_ids, l_mask_ids, l_token_type_ids], outputs=logits)\r\nmodel.build(input_shape=(None, max_seq_length))\r\nmodel.fit(...)\r\n...\r\n```\r\n\r\n**Other info / logs**\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/84/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/84/timeline","performed_via_github_app":null,"state_reason":null}