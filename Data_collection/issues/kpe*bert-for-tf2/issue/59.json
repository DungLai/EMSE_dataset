{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/59","repository_url":"https://api.github.com/repos/kpe/bert-for-tf2","labels_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/59/labels{/name}","comments_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/59/comments","events_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/59/events","html_url":"https://github.com/kpe/bert-for-tf2/issues/59","id":604381613,"node_id":"MDU6SXNzdWU2MDQzODE2MTM=","number":59,"title":"Max vocabulary issue?","user":{"login":"nectario","id":22030060,"node_id":"MDQ6VXNlcjIyMDMwMDYw","avatar_url":"https://avatars.githubusercontent.com/u/22030060?v=4","gravatar_id":"","url":"https://api.github.com/users/nectario","html_url":"https://github.com/nectario","followers_url":"https://api.github.com/users/nectario/followers","following_url":"https://api.github.com/users/nectario/following{/other_user}","gists_url":"https://api.github.com/users/nectario/gists{/gist_id}","starred_url":"https://api.github.com/users/nectario/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nectario/subscriptions","organizations_url":"https://api.github.com/users/nectario/orgs","repos_url":"https://api.github.com/users/nectario/repos","events_url":"https://api.github.com/users/nectario/events{/privacy}","received_events_url":"https://api.github.com/users/nectario/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-04-22T01:15:46Z","updated_at":"2020-04-23T08:48:50Z","closed_at":"2020-04-23T08:48:49Z","author_association":"NONE","active_lock_reason":null,"body":"I am getting the below error and I am having a hard time trying to fix it. It seems the model exceeded the max vocabulary size? How do I avoid this from happening if I am using pretrained model?\r\n\r\n\r\n_________________\r\n\r\nEpoch 1/1000\r\n2020-04-21 21:10:10.123738: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_10.dll\r\n2020-04-21 21:10:10.535980: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort **Invalid argument: indices[99,4] = 45642 is not in [0, 30522)**\r\n         [[{{node model_1/TimeDistributedSegment/model/bert/embeddings/word_embeddings/embedding_lookup}}]]\r\n         [[model_1/TimeDistributedSegment/model/bert/embeddings/word_embeddings/embedding_lookup/_28]]\r\n2020-04-21 21:10:10.551579: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort **Invalid argument: indices[99,4] = 45642 is not in [0, 30522)**\r\n         [[{{node model_1/TimeDistributedSegment/model/bert/embeddings/word_embeddings/embedding_lookup}}]]\r\n2020-04-21 21:10:11.269619: I tensorflow/core/profiler/lib/profiler_session.cc:225] Profiler session started.\r\n2020-04-21 21:10:11.274666: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1259] Profiler found 1 GPUs\r\n2020-04-21 21:10:11.287877: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cupti64_101.dll\r\n 1/96 [..............................] - ETA: 20:58WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are:\r\n2020-04-21 21:10:12.077116: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1378] CUPTI activity buffer flushed\r\n2020-04-21 21:10:12.080944: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:88]  GpuTracer has collected 211 callback api events and 211 activity events.\r\nTraceback (most recent call last):\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_v2.py\", line 767, in on_epoch\r\n    yield epoch_logs\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_v2.py\", line 342, in fit\r\n    total_epochs=epochs)\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_v2.py\", line 128, in run_one_epoch\r\n    batch_outs = execution_function(iterator)\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_v2_utils.py\", line 98, in execution_function\r\n    distributed_function(input_fn))\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\tensorflow_core\\python\\eager\\def_function.py\", line 568, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\tensorflow_core\\python\\eager\\def_function.py\", line 632, in _call\r\n    return self._stateless_fn(*args, **kwds)\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 2363, in __call__\r\n    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 1611, in _filtered_call\r\n    self.captured_inputs)\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 1692, in _call_flat\r\n    ctx, args, cancellation_manager=cancellation_manager))\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 545, in call\r\n    ctx=ctx)\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\tensorflow_core\\python\\eager\\execute.py\", line 67, in quick_execute\r\n    six.raise_from(core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.\r\n  (0) Invalid argument:  indices[99,4] = 45642 is not in [0, 30522)\r\n         [[node model_1/TimeDistributedSegment/model/bert/embeddings/word_embeddings/embedding_lookup (defined at C:\\Program Files\\Python37\\lib\\site-packages\\bert\\embeddings.py:208) ]]\r\n  (1) Invalid argument:  indices[99,4] = 45642 is not in [0, 30522)\r\n         [[node model_1/TimeDistributedSegment/model/bert/embeddings/word_embeddings/embedding_lookup (defined at C:\\Program Files\\Python37\\lib\\site-packages\\bert\\embeddings.py:208) ]]\r\n         [[model_1/TimeDistributedSegment/model/bert/embeddings/word_embeddings/embedding_lookup/_28]]","closed_by":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/59/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/59/timeline","performed_via_github_app":null,"state_reason":"completed"}