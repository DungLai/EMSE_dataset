{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/86","repository_url":"https://api.github.com/repos/kpe/bert-for-tf2","labels_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/86/labels{/name}","comments_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/86/comments","events_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/86/events","html_url":"https://github.com/kpe/bert-for-tf2/issues/86","id":814513956,"node_id":"MDU6SXNzdWU4MTQ1MTM5NTY=","number":86,"title":"Can't train BERT with loaded weights on QA Task","user":{"login":"danielesposito27","id":79523312,"node_id":"MDQ6VXNlcjc5NTIzMzEy","avatar_url":"https://avatars.githubusercontent.com/u/79523312?v=4","gravatar_id":"","url":"https://api.github.com/users/danielesposito27","html_url":"https://github.com/danielesposito27","followers_url":"https://api.github.com/users/danielesposito27/followers","following_url":"https://api.github.com/users/danielesposito27/following{/other_user}","gists_url":"https://api.github.com/users/danielesposito27/gists{/gist_id}","starred_url":"https://api.github.com/users/danielesposito27/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielesposito27/subscriptions","organizations_url":"https://api.github.com/users/danielesposito27/orgs","repos_url":"https://api.github.com/users/danielesposito27/repos","events_url":"https://api.github.com/users/danielesposito27/events{/privacy}","received_events_url":"https://api.github.com/users/danielesposito27/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2021-02-23T14:24:33Z","updated_at":"2021-02-24T15:42:34Z","closed_at":"2021-02-24T15:42:34Z","author_association":"NONE","active_lock_reason":null,"body":"Hey everyone!. Thanks for this awesome repo\r\n\r\nSo I loaded some BERT weights that I obtained through customized BERT pretraining on a Spanish corpus.\r\nI loaded my weights as indicated by the team on previous issues:\r\n\r\n```\r\nparams = bert.params_from_pretrained_ckpt('/content/drive/MyDrive/Proyectos IA/Vicky chatbot/entrenamiento_tf/berto/berto_checkpoint/berto_manuales')\r\n\r\nberto = bert.BertModelLayer.from_params(params)\r\n\r\nmodel = tf.keras.models.Sequential([berto])\r\nmodel.build((3, 128))\r\n\r\nbert.load_bert_weights(berto, '/content/drive/MyDrive/Proyectos IA/Vicky chatbot/entrenamiento_tf/berto/berto_checkpoint/berto_manuales/model.ckpt-20')\r\n```\r\nSo after I load my weights I try to pass it input data that looks like this:\r\n\r\n```\r\n{'input_mask': <tf.Tensor: shape=(4, 384), dtype=int32, numpy=\r\n array([[1, 1, 1, ..., 0, 0, 0],\r\n        [1, 1, 1, ..., 0, 0, 0],\r\n        [1, 1, 1, ..., 0, 0, 0],\r\n        [1, 1, 1, ..., 0, 0, 0]], dtype=int32)>,\r\n 'input_type_ids': <tf.Tensor: shape=(4, 384), dtype=int32, numpy=\r\n array([[0, 0, 0, ..., 0, 0, 0],\r\n        [0, 0, 0, ..., 0, 0, 0],\r\n        [0, 0, 0, ..., 0, 0, 0],\r\n        [0, 0, 0, ..., 0, 0, 0]], dtype=int32)>,\r\n 'input_word_ids': <tf.Tensor: shape=(4, 384), dtype=int32, numpy=\r\n array([[    4,  1036,  4920, ...,     0,     0,     0],\r\n        [    4,     3,  1013, ...,     0,     0,     0],\r\n        [    4,     3, 12767, ...,     0,     0,     0],\r\n        [    4,  1030,  1641, ...,     0,     0,     0]], dtype=int32)>}\r\n```\r\n\r\nAs you know these are inputs from SQuAD dataset. Problem is that I get the following error msg;\r\n\r\n```\r\nLayer bert_model_layer_14 expects 1 input(s), but it received 3 input tensors. Inputs received: [<tf.Tensor: shape=(4, 384), dtype=int32, numpy=\r\narray([[1, 1, 1, ..., 0, 0, 0],\r\n       [1, 1, 1, ..., 0, 0, 0],\r\n       [1, 1, 1, ..., 0, 0, 0],\r\n       [1, 1, 1, ..., 0, 0, 0]], dtype=int32)>, <tf.Tensor: shape=(4, 384), dtype=int32, numpy=\r\narray([[0, 0, 0, ..., 0, 0, 0],\r\n       [0, 0, 0, ..., 0, 0, 0],\r\n       [0, 0, 0, ..., 0, 0, 0],\r\n       [0, 0, 0, ..., 0, 0, 0]], dtype=int32)>, <tf.Tensor: shape=(4, 384), dtype=int32, numpy=\r\narray([[    4,  1036,  4920, ...,     0,     0,     0],\r\n       [    4,     3,  1013, ...,     0,     0,     0],\r\n       [    4,     3, 12767, ...,     0,     0,     0],\r\n       [    4,  1030,  1641, ...,     0,     0,     0]], dtype=int32)>]\r\n```\r\nBy the way I don't get this error msg when I load a pretrained model from tensorflow hub but I need to use my own weights on this problem.\r\n\r\nThanks in advance!","closed_by":{"login":"danielesposito27","id":79523312,"node_id":"MDQ6VXNlcjc5NTIzMzEy","avatar_url":"https://avatars.githubusercontent.com/u/79523312?v=4","gravatar_id":"","url":"https://api.github.com/users/danielesposito27","html_url":"https://github.com/danielesposito27","followers_url":"https://api.github.com/users/danielesposito27/followers","following_url":"https://api.github.com/users/danielesposito27/following{/other_user}","gists_url":"https://api.github.com/users/danielesposito27/gists{/gist_id}","starred_url":"https://api.github.com/users/danielesposito27/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielesposito27/subscriptions","organizations_url":"https://api.github.com/users/danielesposito27/orgs","repos_url":"https://api.github.com/users/danielesposito27/repos","events_url":"https://api.github.com/users/danielesposito27/events{/privacy}","received_events_url":"https://api.github.com/users/danielesposito27/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/86/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/86/timeline","performed_via_github_app":null,"state_reason":"completed"}