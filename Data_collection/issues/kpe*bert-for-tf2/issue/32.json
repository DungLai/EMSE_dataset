{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/32","repository_url":"https://api.github.com/repos/kpe/bert-for-tf2","labels_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/32/labels{/name}","comments_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/32/comments","events_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/32/events","html_url":"https://github.com/kpe/bert-for-tf2/issues/32","id":544015148,"node_id":"MDU6SXNzdWU1NDQwMTUxNDg=","number":32,"title":"test_albert_chinese_weights FAILED","user":{"login":"hankcs","id":5326890,"node_id":"MDQ6VXNlcjUzMjY4OTA=","avatar_url":"https://avatars.githubusercontent.com/u/5326890?v=4","gravatar_id":"","url":"https://api.github.com/users/hankcs","html_url":"https://github.com/hankcs","followers_url":"https://api.github.com/users/hankcs/followers","following_url":"https://api.github.com/users/hankcs/following{/other_user}","gists_url":"https://api.github.com/users/hankcs/gists{/gist_id}","starred_url":"https://api.github.com/users/hankcs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankcs/subscriptions","organizations_url":"https://api.github.com/users/hankcs/orgs","repos_url":"https://api.github.com/users/hankcs/repos","events_url":"https://api.github.com/users/hankcs/events{/privacy}","received_events_url":"https://api.github.com/users/hankcs/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"assignees":[{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2019-12-30T21:21:46Z","updated_at":"2020-01-03T04:43:34Z","closed_at":"2019-12-31T15:06:18Z","author_association":"NONE","active_lock_reason":null,"body":"Hi, it seems that this version fails to load the brightmart weights. \r\n\r\n```\r\ntest_load_pretrained_weights.py::TestLoadPreTrainedWeights::test_albert_chinese_weights FAILED [100%]Already  fetched:  albert_base_zh.zip\r\nalready unpacked at: .models/albert_base_zh\r\nbert/embeddings/word_embeddings/embeddings:0\r\nbert/embeddings/word_embeddings_projector/projector:0\r\nbert/embeddings/word_embeddings_projector/bias:0\r\nbert/embeddings/token_type_embeddings/embeddings:0\r\nbert/embeddings/position_embeddings/embeddings:0\r\nbert/embeddings/LayerNorm/gamma:0\r\nbert/embeddings/LayerNorm/beta:0\r\nbert/encoder/layer_shared/attention/self/query/kernel:0\r\nbert/encoder/layer_shared/attention/self/query/bias:0\r\nbert/encoder/layer_shared/attention/self/key/kernel:0\r\nbert/encoder/layer_shared/attention/self/key/bias:0\r\nbert/encoder/layer_shared/attention/self/value/kernel:0\r\nbert/encoder/layer_shared/attention/self/value/bias:0\r\nbert/encoder/layer_shared/attention/output/dense/kernel:0\r\nbert/encoder/layer_shared/attention/output/dense/bias:0\r\nbert/encoder/layer_shared/attention/output/LayerNorm/gamma:0\r\nbert/encoder/layer_shared/attention/output/LayerNorm/beta:0\r\nbert/encoder/layer_shared/intermediate/kernel:0\r\nbert/encoder/layer_shared/intermediate/bias:0\r\nbert/encoder/layer_shared/output/dense/kernel:0\r\nbert/encoder/layer_shared/output/dense/bias:0\r\nbert/encoder/layer_shared/output/LayerNorm/gamma:0\r\nbert/encoder/layer_shared/output/LayerNorm/beta:0\r\nLoading brightmart/albert_zh weights...\r\nloader: No value for:[bert/embeddings/word_embeddings_projector/bias:0], i.e.:[bert/embeddings/word_embeddings_2/bias] in:[.models/albert_base_zh/albert_model.ckpt]\r\nloader: Skipping weight:[bert/embeddings/token_type_embeddings/embeddings:0] as the weight shape:[(2, 128)] is not compatible with the checkpoint:[bert/embeddings/token_type_embeddings] shape:(2, 768)\r\nloader: Skipping weight:[bert/embeddings/position_embeddings/embeddings:0] as the weight shape:[(512, 128)] is not compatible with the checkpoint:[bert/embeddings/position_embeddings] shape:(512, 768)\r\nloader: Skipping weight:[bert/embeddings/LayerNorm/gamma:0] as the weight shape:[(128,)] is not compatible with the checkpoint:[bert/embeddings/LayerNorm/gamma] shape:(768,)\r\nloader: Skipping weight:[bert/embeddings/LayerNorm/beta:0] as the weight shape:[(128,)] is not compatible with the checkpoint:[bert/embeddings/LayerNorm/beta] shape:(768,)\r\nDone loading 18 BERT weights from: .models/albert_base_zh/albert_model.ckpt into <bert.model.BertModelLayer object at 0x7fb5fec254a8> (prefix:bert). Count of weights not found in the checkpoint was: [1]. Count of weights with mismatched shape: [4]\r\nUnused weights from checkpoint: \r\n\tbert/embeddings/LayerNorm/beta\r\n\tbert/embeddings/LayerNorm/gamma\r\n\tbert/embeddings/position_embeddings\r\n\tbert/embeddings/token_type_embeddings\r\n\tbert/pooler/dense/bias\r\n\tbert/pooler/dense/kernel\r\n\tcls/predictions/output_bias\r\n\tcls/predictions/transform/LayerNorm/beta\r\n\tcls/predictions/transform/LayerNorm/gamma\r\n\tcls/predictions/transform/dense/bias\r\n\tcls/predictions/transform/dense/kernel\r\n\tcls/seq_relationship/output_bias\r\n\tcls/seq_relationship/output_weights\r\n\r\n \r\n4 != 0\r\n\r\nExpected :0\r\nActual   :4\r\n```","closed_by":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/32/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/kpe/bert-for-tf2/issues/32/timeline","performed_via_github_app":null,"state_reason":"completed"}