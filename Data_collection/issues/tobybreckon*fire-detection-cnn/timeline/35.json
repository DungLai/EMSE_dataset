[{"url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/comments/557929699","html_url":"https://github.com/tobybreckon/fire-detection-cnn/issues/35#issuecomment-557929699","issue_url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/35","id":557929699,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NzkyOTY5OQ==","user":{"login":"tobybreckon","id":3429179,"node_id":"MDQ6VXNlcjM0MjkxNzk=","avatar_url":"https://avatars.githubusercontent.com/u/3429179?v=4","gravatar_id":"","url":"https://api.github.com/users/tobybreckon","html_url":"https://github.com/tobybreckon","followers_url":"https://api.github.com/users/tobybreckon/followers","following_url":"https://api.github.com/users/tobybreckon/following{/other_user}","gists_url":"https://api.github.com/users/tobybreckon/gists{/gist_id}","starred_url":"https://api.github.com/users/tobybreckon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tobybreckon/subscriptions","organizations_url":"https://api.github.com/users/tobybreckon/orgs","repos_url":"https://api.github.com/users/tobybreckon/repos","events_url":"https://api.github.com/users/tobybreckon/events{/privacy}","received_events_url":"https://api.github.com/users/tobybreckon/received_events","type":"User","site_admin":false},"created_at":"2019-11-24T21:26:53Z","updated_at":"2019-11-24T21:33:15Z","author_association":"OWNER","body":"Interesting, as when I check the model in tensorboard I see this:\r\n\r\n![image](https://user-images.githubusercontent.com/3429179/69501682-3cef8180-0eff-11ea-9f7d-2e3e144d92e5.png)\r\n\r\n.. which is consistent with the paper. My approach is\r\n\r\n- edit line 27 of  ``firenet-to-protobuf.py`` to pass an additional final ``True`` parameter to enable verbosity\r\n```\r\n    convert_to_pb(model, path, input_layer_name,  output_layer_name, pbfilename, True)\r\n``` \r\n- rerun the conversion command as in the README\r\n- then run: \r\n```\r\ntensorboard --logdir=\"logs\"\r\n```\r\n\r\n- and visualise it in the browser on ``http://127.0.0.1:6006/#graphs&run=.``\r\n\r\nWhat is your tool chain to visualize ?\r\n\r\nI think this is because of the way you are visualizing this **frozen** graph where all variable operations have been replaced by constant operations (using [ https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/graph_util/convert_variables_to_constants]( https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/graph_util/convert_variables_to_constants) in line 76 of ``convertor.py``) as part of the conversion process. This is standard practice in graph freezing as far as I am aware - see line 48 of the example here [https://blog.metaflow.fr/tensorflow-how-to-freeze-a-model-and-serve-it-with-a-python-api-d4f3596b3adc](https://blog.metaflow.fr/tensorflow-how-to-freeze-a-model-and-serve-it-with-a-python-api-d4f3596b3adcl). The ``const`` is the diagram are not extra graph nodes, they are present because the graph is frozen for inference AFIAK.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/comments/557929699/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tobybreckon","id":3429179,"node_id":"MDQ6VXNlcjM0MjkxNzk=","avatar_url":"https://avatars.githubusercontent.com/u/3429179?v=4","gravatar_id":"","url":"https://api.github.com/users/tobybreckon","html_url":"https://github.com/tobybreckon","followers_url":"https://api.github.com/users/tobybreckon/followers","following_url":"https://api.github.com/users/tobybreckon/following{/other_user}","gists_url":"https://api.github.com/users/tobybreckon/gists{/gist_id}","starred_url":"https://api.github.com/users/tobybreckon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tobybreckon/subscriptions","organizations_url":"https://api.github.com/users/tobybreckon/orgs","repos_url":"https://api.github.com/users/tobybreckon/repos","events_url":"https://api.github.com/users/tobybreckon/events{/privacy}","received_events_url":"https://api.github.com/users/tobybreckon/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/comments/557935238","html_url":"https://github.com/tobybreckon/fire-detection-cnn/issues/35#issuecomment-557935238","issue_url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/35","id":557935238,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NzkzNTIzOA==","user":{"login":"yurivict","id":271906,"node_id":"MDQ6VXNlcjI3MTkwNg==","avatar_url":"https://avatars.githubusercontent.com/u/271906?v=4","gravatar_id":"","url":"https://api.github.com/users/yurivict","html_url":"https://github.com/yurivict","followers_url":"https://api.github.com/users/yurivict/followers","following_url":"https://api.github.com/users/yurivict/following{/other_user}","gists_url":"https://api.github.com/users/yurivict/gists{/gist_id}","starred_url":"https://api.github.com/users/yurivict/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yurivict/subscriptions","organizations_url":"https://api.github.com/users/yurivict/orgs","repos_url":"https://api.github.com/users/yurivict/repos","events_url":"https://api.github.com/users/yurivict/events{/privacy}","received_events_url":"https://api.github.com/users/yurivict/received_events","type":"User","site_admin":false},"created_at":"2019-11-24T22:35:16Z","updated_at":"2019-11-24T22:36:32Z","author_association":"NONE","body":"The resulting firenet.pb has constants, switches, etc.\r\nYou can open it in Netron and see this for yourself.\r\nThese operations are redundant and rather inconvenient for those who just wants to compute.\r\n\r\nNormally models for computation don't have consts.\r\n","reactions":{"url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/comments/557935238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yurivict","id":271906,"node_id":"MDQ6VXNlcjI3MTkwNg==","avatar_url":"https://avatars.githubusercontent.com/u/271906?v=4","gravatar_id":"","url":"https://api.github.com/users/yurivict","html_url":"https://github.com/yurivict","followers_url":"https://api.github.com/users/yurivict/followers","following_url":"https://api.github.com/users/yurivict/following{/other_user}","gists_url":"https://api.github.com/users/yurivict/gists{/gist_id}","starred_url":"https://api.github.com/users/yurivict/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yurivict/subscriptions","organizations_url":"https://api.github.com/users/yurivict/orgs","repos_url":"https://api.github.com/users/yurivict/repos","events_url":"https://api.github.com/users/yurivict/events{/privacy}","received_events_url":"https://api.github.com/users/yurivict/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/comments/557945912","html_url":"https://github.com/tobybreckon/fire-detection-cnn/issues/35#issuecomment-557945912","issue_url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/35","id":557945912,"node_id":"MDEyOklzc3VlQ29tbWVudDU1Nzk0NTkxMg==","user":{"login":"tobybreckon","id":3429179,"node_id":"MDQ6VXNlcjM0MjkxNzk=","avatar_url":"https://avatars.githubusercontent.com/u/3429179?v=4","gravatar_id":"","url":"https://api.github.com/users/tobybreckon","html_url":"https://github.com/tobybreckon","followers_url":"https://api.github.com/users/tobybreckon/followers","following_url":"https://api.github.com/users/tobybreckon/following{/other_user}","gists_url":"https://api.github.com/users/tobybreckon/gists{/gist_id}","starred_url":"https://api.github.com/users/tobybreckon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tobybreckon/subscriptions","organizations_url":"https://api.github.com/users/tobybreckon/orgs","repos_url":"https://api.github.com/users/tobybreckon/repos","events_url":"https://api.github.com/users/tobybreckon/events{/privacy}","received_events_url":"https://api.github.com/users/tobybreckon/received_events","type":"User","site_admin":false},"created_at":"2019-11-25T00:27:15Z","updated_at":"2019-11-25T00:28:21Z","author_association":"OWNER","body":"I suspect the _experimental_ support (only) for TensorFlow .pb format from Netron is possibly not displaying the model correctly in this case - I doubt any extra operations or nodes are being actually added during the conversion as there is nowhere in the conversion process where this happens and they are not shown by the TensorFlow visualisation to which the pb net format is native.\r\n\r\nThis is on the basis that:\r\n- the model is displayed correctly by TensorFlow itself on tensorboard, which is the target framework for the conversion\r\n- the const nodes are in fact not operations in themselves, they are displayed because it is a frozen graph (as part of the freezing process replaces variables with constants) and are in fact labels/monikers on the existing layer operations)\r\n- the conversion follows the standard methodology using the built in TensorFlow, tflearn model routines \r\n- when you print out the network structure layer by layer in TensorFlow and/or OpenCV none of these additions are present\r\n- under test the operation and performance of the converted model is the same as before conversion\r\n\r\nI don't think there is any issue here unless you can visualize this in another tool that fully supports TensorFlow pb format or TensorFlow itself and get similar results.","reactions":{"url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/comments/557945912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tobybreckon","id":3429179,"node_id":"MDQ6VXNlcjM0MjkxNzk=","avatar_url":"https://avatars.githubusercontent.com/u/3429179?v=4","gravatar_id":"","url":"https://api.github.com/users/tobybreckon","html_url":"https://github.com/tobybreckon","followers_url":"https://api.github.com/users/tobybreckon/followers","following_url":"https://api.github.com/users/tobybreckon/following{/other_user}","gists_url":"https://api.github.com/users/tobybreckon/gists{/gist_id}","starred_url":"https://api.github.com/users/tobybreckon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tobybreckon/subscriptions","organizations_url":"https://api.github.com/users/tobybreckon/orgs","repos_url":"https://api.github.com/users/tobybreckon/repos","events_url":"https://api.github.com/users/tobybreckon/events{/privacy}","received_events_url":"https://api.github.com/users/tobybreckon/received_events","type":"User","site_admin":false}},{"id":2826361595,"node_id":"MDExOkNsb3NlZEV2ZW50MjgyNjM2MTU5NQ==","url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/events/2826361595","actor":{"login":"tobybreckon","id":3429179,"node_id":"MDQ6VXNlcjM0MjkxNzk=","avatar_url":"https://avatars.githubusercontent.com/u/3429179?v=4","gravatar_id":"","url":"https://api.github.com/users/tobybreckon","html_url":"https://github.com/tobybreckon","followers_url":"https://api.github.com/users/tobybreckon/followers","following_url":"https://api.github.com/users/tobybreckon/following{/other_user}","gists_url":"https://api.github.com/users/tobybreckon/gists{/gist_id}","starred_url":"https://api.github.com/users/tobybreckon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tobybreckon/subscriptions","organizations_url":"https://api.github.com/users/tobybreckon/orgs","repos_url":"https://api.github.com/users/tobybreckon/repos","events_url":"https://api.github.com/users/tobybreckon/events{/privacy}","received_events_url":"https://api.github.com/users/tobybreckon/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-11-25T00:27:15Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/comments/557948892","html_url":"https://github.com/tobybreckon/fire-detection-cnn/issues/35#issuecomment-557948892","issue_url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/35","id":557948892,"node_id":"MDEyOklzc3VlQ29tbWVudDU1Nzk0ODg5Mg==","user":{"login":"yurivict","id":271906,"node_id":"MDQ6VXNlcjI3MTkwNg==","avatar_url":"https://avatars.githubusercontent.com/u/271906?v=4","gravatar_id":"","url":"https://api.github.com/users/yurivict","html_url":"https://github.com/yurivict","followers_url":"https://api.github.com/users/yurivict/followers","following_url":"https://api.github.com/users/yurivict/following{/other_user}","gists_url":"https://api.github.com/users/yurivict/gists{/gist_id}","starred_url":"https://api.github.com/users/yurivict/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yurivict/subscriptions","organizations_url":"https://api.github.com/users/yurivict/orgs","repos_url":"https://api.github.com/users/yurivict/repos","events_url":"https://api.github.com/users/yurivict/events{/privacy}","received_events_url":"https://api.github.com/users/yurivict/received_events","type":"User","site_admin":false},"created_at":"2019-11-25T00:55:09Z","updated_at":"2019-11-25T00:55:09Z","author_association":"NONE","body":"Yes, extra nodes are added. I also see them when reading .pb file with my C++ program.\r\n\r\nI couldn't figure out how to remove them in TF yet.\r\n","reactions":{"url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/comments/557948892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yurivict","id":271906,"node_id":"MDQ6VXNlcjI3MTkwNg==","avatar_url":"https://avatars.githubusercontent.com/u/271906?v=4","gravatar_id":"","url":"https://api.github.com/users/yurivict","html_url":"https://github.com/yurivict","followers_url":"https://api.github.com/users/yurivict/followers","following_url":"https://api.github.com/users/yurivict/following{/other_user}","gists_url":"https://api.github.com/users/yurivict/gists{/gist_id}","starred_url":"https://api.github.com/users/yurivict/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yurivict/subscriptions","organizations_url":"https://api.github.com/users/yurivict/orgs","repos_url":"https://api.github.com/users/yurivict/repos","events_url":"https://api.github.com/users/yurivict/events{/privacy}","received_events_url":"https://api.github.com/users/yurivict/received_events","type":"User","site_admin":false}}]