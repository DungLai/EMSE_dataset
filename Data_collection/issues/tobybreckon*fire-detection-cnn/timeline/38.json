[{"url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/comments/565759518","html_url":"https://github.com/tobybreckon/fire-detection-cnn/issues/38#issuecomment-565759518","issue_url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/38","id":565759518,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTc1OTUxOA==","user":{"login":"tobybreckon","id":3429179,"node_id":"MDQ6VXNlcjM0MjkxNzk=","avatar_url":"https://avatars.githubusercontent.com/u/3429179?v=4","gravatar_id":"","url":"https://api.github.com/users/tobybreckon","html_url":"https://github.com/tobybreckon","followers_url":"https://api.github.com/users/tobybreckon/followers","following_url":"https://api.github.com/users/tobybreckon/following{/other_user}","gists_url":"https://api.github.com/users/tobybreckon/gists{/gist_id}","starred_url":"https://api.github.com/users/tobybreckon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tobybreckon/subscriptions","organizations_url":"https://api.github.com/users/tobybreckon/orgs","repos_url":"https://api.github.com/users/tobybreckon/repos","events_url":"https://api.github.com/users/tobybreckon/events{/privacy}","received_events_url":"https://api.github.com/users/tobybreckon/received_events","type":"User","site_admin":false},"created_at":"2019-12-14T22:43:16Z","updated_at":"2019-12-14T22:43:16Z","author_association":"OWNER","body":"We have reimplemented the models in Keras successfully beforehand. To clarify which model and which layer are you referring to (FireNet or InceptionV1-OnFire) ?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/comments/565759518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tobybreckon","id":3429179,"node_id":"MDQ6VXNlcjM0MjkxNzk=","avatar_url":"https://avatars.githubusercontent.com/u/3429179?v=4","gravatar_id":"","url":"https://api.github.com/users/tobybreckon","html_url":"https://github.com/tobybreckon","followers_url":"https://api.github.com/users/tobybreckon/followers","following_url":"https://api.github.com/users/tobybreckon/following{/other_user}","gists_url":"https://api.github.com/users/tobybreckon/gists{/gist_id}","starred_url":"https://api.github.com/users/tobybreckon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tobybreckon/subscriptions","organizations_url":"https://api.github.com/users/tobybreckon/orgs","repos_url":"https://api.github.com/users/tobybreckon/repos","events_url":"https://api.github.com/users/tobybreckon/events{/privacy}","received_events_url":"https://api.github.com/users/tobybreckon/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/comments/565761708","html_url":"https://github.com/tobybreckon/fire-detection-cnn/issues/38#issuecomment-565761708","issue_url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/38","id":565761708,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTc2MTcwOA==","user":{"login":"arvinnick","id":45213016,"node_id":"MDQ6VXNlcjQ1MjEzMDE2","avatar_url":"https://avatars.githubusercontent.com/u/45213016?v=4","gravatar_id":"","url":"https://api.github.com/users/arvinnick","html_url":"https://github.com/arvinnick","followers_url":"https://api.github.com/users/arvinnick/followers","following_url":"https://api.github.com/users/arvinnick/following{/other_user}","gists_url":"https://api.github.com/users/arvinnick/gists{/gist_id}","starred_url":"https://api.github.com/users/arvinnick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arvinnick/subscriptions","organizations_url":"https://api.github.com/users/arvinnick/orgs","repos_url":"https://api.github.com/users/arvinnick/repos","events_url":"https://api.github.com/users/arvinnick/events{/privacy}","received_events_url":"https://api.github.com/users/arvinnick/received_events","type":"User","site_admin":false},"created_at":"2019-12-14T23:19:56Z","updated_at":"2019-12-14T23:19:56Z","author_association":"NONE","body":"Thanks for your help.\r\nThe model is inceptionOnFire.\r\nThe layer is the first concatenate layer (I think all concatenate layers are the same).\r\nHere is my code:\r\n\r\n\r\n\r\n```\r\ndef inc_v1_on_fire(input_shape):\r\n    \r\n    input_layer = K.Input(input_shape)\r\n    conv_7_7 = K.Conv2D(64,\r\n                      7,\r\n                      strides = 2,\r\n                      activation = 'relu',\r\n                      padding = 'same',\r\n                      name = 'conv1_7_7_s2')(input_layer)\r\n    \r\n    pool1_3_3 = K.MaxPooling2D(3,\r\n                            strides = 2,\r\n                            padding = 'same')(conv_7_7)\r\n    pool1_3_3 = LRN()(pool1_3_3)\r\n    \r\n    conv2_3_3_reduce = K.Conv2D(64,\r\n                               1,\r\n                               activation = 'relu',\r\n                               name = 'conv2_3_3_reduce')(pool1_3_3)\r\n    conv2_3_3 = K.Conv2D(128,\r\n                        3,\r\n                        activation='relu',\r\n                        name='conv2_3_3')(conv2_3_3_reduce)\r\n    \r\n    conv2_3_3 = LRN()(conv2_3_3)\r\n    pool2_3_3 = K.MaxPooling2D(3,\r\n                             strides = 2,\r\n                             padding = 'same',\r\n                             name ='pool2_3_3_s2')(conv2_3_3)\r\n    \r\n    inception_3a_1_1 = K.Conv2D(64,\r\n                               1,\r\n                               activation = 'relu',\r\n                               name = 'inception_3a_1_1')(pool2_3_3)\r\n    \r\n    \r\n    inception_3a_3_3_reduce = K.Conv2D(96,\r\n                                      1,\r\n                                      activation ='relu',\r\n                                      name='inception_3a_3_3_reduce')(pool2_3_3)\r\n    \r\n    inception_3a_3_3 = K.Conv2D(128,\r\n                               3,\r\n                               activation = 'relu',\r\n                               name = 'inception_3a_3_3')(inception_3a_3_3_reduce)\r\n    inception_3a_5_5_reduce = K.Conv2D(16,\r\n                                      1,\r\n                                      activation = 'relu',\r\n                                      name ='inception_3a_5_5_reduce')(pool2_3_3)\r\n    inception_3a_5_5 = K.Conv2D(32,\r\n                               5,\r\n                               activation='relu',\r\n                               name= 'inception_3a_5_5')(inception_3a_5_5_reduce)\r\n    inception_3a_pool = K.MaxPooling2D(3,\r\n                                    strides = 1,\r\n                                    padding = 'same')(pool2_3_3)\r\n    inception_3a_pool_1_1 = K.Conv2D(32,\r\n                                    1,\r\n                                    activation='relu',\r\n                                    name='inception_3a_pool_1_1')(inception_3a_pool)\r\n    \r\n    # merge the inception_3a__\r\n    inception_3a_output = K.Concatenate(axis=3)([inception_3a_1_1,\r\n                                       inception_3a_3_3,\r\n                                       inception_3a_5_5,\r\n                                       inception_3a_pool_1_1])\r\n    \r\n    inception_3b_1_1 = K.Conv2D(128,\r\n                              1,\r\n                              activation='relu',\r\n                              name = 'inception_3b_1_1')(inception_3a_output)\r\n    inception_3b_3_3_reduce = K.Conv2D(128,\r\n                                      1,\r\n                                      activation = 'relu',\r\n                                      name='inception_3b_3_3_reduce')(inception_3a_output)\r\n    inception_3b_3_3 = K.Conv2D(192,\r\n                               3,\r\n                               activation = 'relu',\r\n                               name='inception_3b_3_3')(inception_3b_3_3_reduce)\r\n    inception_3b_5_5_reduce = K.Conv2D(32,\r\n                                      1,\r\n                                      activation='relu',\r\n                                      name = 'inception_3b_5_5_reduce')(inception_3a_output)\r\n    inception_3b_5_5 = K.Conv2D(96,\r\n                               5,\r\n                               name = 'inception_3b_5_5')(inception_3b_5_5_reduce)\r\n    inception_3b_pool = K.MaxPooling2D(3,\r\n                                     strides = 1,\r\n                                     padding = 'same',\r\n                                     name='inception_3b_pool')(inception_3a_output)\r\n    inception_3b_pool_1_1 = K.Conv2D(64,\r\n                                    kernel_size=1,\r\n                                    activation='relu',\r\n                                    name='inception_3b_pool_1_1')(inception_3b_pool)\r\n    \r\n    #merge the inception_3b_*\r\n    inception_3b_output = K.Concatenate(axis=3,\r\n                                      name='inception_3b_output')([inception_3b_1_1,\r\n                                       inception_3b_3_3,\r\n                                       inception_3b_5_5,\r\n                                       inception_3b_pool_1_1])\r\n    \r\n    pool3_3_3 = K.MaxPooling2D(pool_size=3,\r\n                             strides=2,\r\n                             padding = 'same',\r\n                             name='pool3_3_3')(inception_3b_output)\r\n    inception_4a_1_1 = K.Conv2D(192,\r\n                              kernel_size=1,\r\n                              activation='relu',\r\n                              name = 'inception_4a_1_1')(pool3_3_3)\r\n    inception_4a_3_3_reduce = K.Conv2D(96,\r\n                                     1,\r\n                                     activation = 'relu',\r\n                                     name = 'inception_4a_3_3_reduce')(pool3_3_3)\r\n    inception_4a_3_3 = K.Conv2D(208,\r\n                              3,\r\n                              activation = 'relu',\r\n                              name = 'inception_4a_3_3')(inception_4a_3_3_reduce)\r\n    inception_4a_5_5_reduce = K.Conv2D(16,\r\n                                     kernel_size=1,\r\n                                     activation='relu',\r\n                                     name='inception_4a_5_5_reduce')(pool3_3_3)\r\n    inception_4a_5_5 = K.Conv2D(48,\r\n                              kernel_size=5,\r\n                              activation='relu',\r\n                              name='inception_4a_5_5')(inception_4a_5_5_reduce)\r\n    inception_4a_pool = K.MaxPooling2D(pool_size=3,\r\n                                     strides=1,\r\n                                     padding='same',\r\n                                     name='inception_4a_pool')(pool3_3_3)\r\n    inception_4a_pool_1_1 = K.Conv2D(64,\r\n                                   kernel_size=1,\r\n                                   activation='relu',\r\n                                   name='inception_4a_pool_1_1')(inception_4a_pool)\r\n    \r\n    inception_4a_output = K.Concatenate(axis = 3,\r\n                                      name = 'inception_4a_output')([inception_4a_1_1,\r\n                                       inception_4a_3_3,\r\n                                       inception_4a_5_5,\r\n                                       inception_4a_pool_1_1])\r\n    \r\n    pool5_7_7 = K.AveragePooling2D(5,\r\n                                   padding = 'same',\r\n                                   strides = 1)(inception_4a_output)\r\n    pool5_7_7 = K.Dropout(0.4)(pool5_7_7)\r\n    output_layer = K.Dense(2,\r\n                   activation='softmax')(pool5_7_7)\r\n    model = Model(input_layer,output_layer)\r\n    model.compile(optimizer=opt,\r\n                  loss = loss_f)\r\n    return model\r\n```","reactions":{"url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/comments/565761708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"arvinnick","id":45213016,"node_id":"MDQ6VXNlcjQ1MjEzMDE2","avatar_url":"https://avatars.githubusercontent.com/u/45213016?v=4","gravatar_id":"","url":"https://api.github.com/users/arvinnick","html_url":"https://github.com/arvinnick","followers_url":"https://api.github.com/users/arvinnick/followers","following_url":"https://api.github.com/users/arvinnick/following{/other_user}","gists_url":"https://api.github.com/users/arvinnick/gists{/gist_id}","starred_url":"https://api.github.com/users/arvinnick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arvinnick/subscriptions","organizations_url":"https://api.github.com/users/arvinnick/orgs","repos_url":"https://api.github.com/users/arvinnick/repos","events_url":"https://api.github.com/users/arvinnick/events{/privacy}","received_events_url":"https://api.github.com/users/arvinnick/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/comments/565787085","html_url":"https://github.com/tobybreckon/fire-detection-cnn/issues/38#issuecomment-565787085","issue_url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/38","id":565787085,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTc4NzA4NQ==","user":{"login":"tobybreckon","id":3429179,"node_id":"MDQ6VXNlcjM0MjkxNzk=","avatar_url":"https://avatars.githubusercontent.com/u/3429179?v=4","gravatar_id":"","url":"https://api.github.com/users/tobybreckon","html_url":"https://github.com/tobybreckon","followers_url":"https://api.github.com/users/tobybreckon/followers","following_url":"https://api.github.com/users/tobybreckon/following{/other_user}","gists_url":"https://api.github.com/users/tobybreckon/gists{/gist_id}","starred_url":"https://api.github.com/users/tobybreckon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tobybreckon/subscriptions","organizations_url":"https://api.github.com/users/tobybreckon/orgs","repos_url":"https://api.github.com/users/tobybreckon/repos","events_url":"https://api.github.com/users/tobybreckon/events{/privacy}","received_events_url":"https://api.github.com/users/tobybreckon/received_events","type":"User","site_admin":false},"created_at":"2019-12-15T08:07:35Z","updated_at":"2019-12-15T08:07:35Z","author_association":"OWNER","body":"I am not very familiar with Keras directly.\r\n\r\nOur example is heavily based on the standard inceptionV1 (googlenet) example, it is a cut down version of it as explained in the paper:\r\nhttps://github.com/tflearn/tflearn/blob/master/examples/images/googlenet.py\r\nin tflearn, which uses the same ops for concat.\r\n\r\nHere is a Keras example of the same base inceptionV1 architecture:\r\nhttps://gist.github.com/joelouismarino/a2ede9ab3928f999575423b9887abd14\r\n\r\nI would suggest using this as a base. For example, in the Keras example for inceptionV1 they have ``axis=1``, whilst in tflearn ``axis=3`` used for concatenation to achieve the same effect it appears.\r\nYou have 3 in your code which is consistent with our tflearn code, but not the definition of inceptionV1 in Keras which uses ``axis=1``, try this perhaps.","reactions":{"url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/comments/565787085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tobybreckon","id":3429179,"node_id":"MDQ6VXNlcjM0MjkxNzk=","avatar_url":"https://avatars.githubusercontent.com/u/3429179?v=4","gravatar_id":"","url":"https://api.github.com/users/tobybreckon","html_url":"https://github.com/tobybreckon","followers_url":"https://api.github.com/users/tobybreckon/followers","following_url":"https://api.github.com/users/tobybreckon/following{/other_user}","gists_url":"https://api.github.com/users/tobybreckon/gists{/gist_id}","starred_url":"https://api.github.com/users/tobybreckon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tobybreckon/subscriptions","organizations_url":"https://api.github.com/users/tobybreckon/orgs","repos_url":"https://api.github.com/users/tobybreckon/repos","events_url":"https://api.github.com/users/tobybreckon/events{/privacy}","received_events_url":"https://api.github.com/users/tobybreckon/received_events","type":"User","site_admin":false}},{"id":2897289134,"node_id":"MDExOkNsb3NlZEV2ZW50Mjg5NzI4OTEzNA==","url":"https://api.github.com/repos/tobybreckon/fire-detection-cnn/issues/events/2897289134","actor":{"login":"tobybreckon","id":3429179,"node_id":"MDQ6VXNlcjM0MjkxNzk=","avatar_url":"https://avatars.githubusercontent.com/u/3429179?v=4","gravatar_id":"","url":"https://api.github.com/users/tobybreckon","html_url":"https://github.com/tobybreckon","followers_url":"https://api.github.com/users/tobybreckon/followers","following_url":"https://api.github.com/users/tobybreckon/following{/other_user}","gists_url":"https://api.github.com/users/tobybreckon/gists{/gist_id}","starred_url":"https://api.github.com/users/tobybreckon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tobybreckon/subscriptions","organizations_url":"https://api.github.com/users/tobybreckon/orgs","repos_url":"https://api.github.com/users/tobybreckon/repos","events_url":"https://api.github.com/users/tobybreckon/events{/privacy}","received_events_url":"https://api.github.com/users/tobybreckon/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-12-19T13:50:29Z","state_reason":null,"performed_via_github_app":null}]