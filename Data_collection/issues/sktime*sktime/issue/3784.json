{"url":"https://api.github.com/repos/sktime/sktime/issues/3784","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/3784/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/3784/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/3784/events","html_url":"https://github.com/sktime/sktime/issues/3784","id":1447910012,"node_id":"I_kwDOCVKAsc5WTVp8","number":3784,"title":"forecasting using LightGBM","user":{"login":"nyk2001","id":3079053,"node_id":"MDQ6VXNlcjMwNzkwNTM=","avatar_url":"https://avatars.githubusercontent.com/u/3079053?v=4","gravatar_id":"","url":"https://api.github.com/users/nyk2001","html_url":"https://github.com/nyk2001","followers_url":"https://api.github.com/users/nyk2001/followers","following_url":"https://api.github.com/users/nyk2001/following{/other_user}","gists_url":"https://api.github.com/users/nyk2001/gists{/gist_id}","starred_url":"https://api.github.com/users/nyk2001/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nyk2001/subscriptions","organizations_url":"https://api.github.com/users/nyk2001/orgs","repos_url":"https://api.github.com/users/nyk2001/repos","events_url":"https://api.github.com/users/nyk2001/events{/privacy}","received_events_url":"https://api.github.com/users/nyk2001/received_events","type":"User","site_admin":false},"labels":[{"id":3105906374,"node_id":"MDU6TGFiZWwzMTA1OTA2Mzc0","url":"https://api.github.com/repos/sktime/sktime/labels/module:forecasting","name":"module:forecasting","color":"35FCCE","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"danbartl","id":19947407,"node_id":"MDQ6VXNlcjE5OTQ3NDA3","avatar_url":"https://avatars.githubusercontent.com/u/19947407?v=4","gravatar_id":"","url":"https://api.github.com/users/danbartl","html_url":"https://github.com/danbartl","followers_url":"https://api.github.com/users/danbartl/followers","following_url":"https://api.github.com/users/danbartl/following{/other_user}","gists_url":"https://api.github.com/users/danbartl/gists{/gist_id}","starred_url":"https://api.github.com/users/danbartl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danbartl/subscriptions","organizations_url":"https://api.github.com/users/danbartl/orgs","repos_url":"https://api.github.com/users/danbartl/repos","events_url":"https://api.github.com/users/danbartl/events{/privacy}","received_events_url":"https://api.github.com/users/danbartl/received_events","type":"User","site_admin":false},"assignees":[{"login":"danbartl","id":19947407,"node_id":"MDQ6VXNlcjE5OTQ3NDA3","avatar_url":"https://avatars.githubusercontent.com/u/19947407?v=4","gravatar_id":"","url":"https://api.github.com/users/danbartl","html_url":"https://github.com/danbartl","followers_url":"https://api.github.com/users/danbartl/followers","following_url":"https://api.github.com/users/danbartl/following{/other_user}","gists_url":"https://api.github.com/users/danbartl/gists{/gist_id}","starred_url":"https://api.github.com/users/danbartl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danbartl/subscriptions","organizations_url":"https://api.github.com/users/danbartl/orgs","repos_url":"https://api.github.com/users/danbartl/repos","events_url":"https://api.github.com/users/danbartl/events{/privacy}","received_events_url":"https://api.github.com/users/danbartl/received_events","type":"User","site_admin":false}],"milestone":null,"comments":10,"created_at":"2022-11-14T11:44:48Z","updated_at":"2022-11-15T21:53:04Z","closed_at":"2022-11-14T22:09:26Z","author_association":"NONE","active_lock_reason":null,"body":"### Discussed in https://github.com/sktime/sktime/discussions/3783\r\n\r\n<div type='discussions-op-text'>\r\n\r\n<sup>Originally posted by **nyk2001** November 14, 2022</sup>\r\nI have used ARIMA and Prophet algorithms for multivariate forecasting, which works fine.  You can see the plot with Prophet as follows:\r\n\r\n![image](https://user-images.githubusercontent.com/3079053/201594068-3b15afa1-ddc5-4e1c-b866-d2deab379f45.png)\r\n\r\n\r\nNow, I am trying to use LightGBM to make predictions and it does not work. For instance, I am getting the following output:\r\n\r\n![image](https://user-images.githubusercontent.com/3079053/201594207-89d4df80-c6e7-4b31-a66d-c490b3ac42e7.png)\r\n\r\nIs it a bug ? I am only getting problem with LightGBM and GradientBooster regressor. My code is as follows: \r\n\r\n`\r\n# Load data\r\ndf = sm.datasets.macrodata.load_pandas()['data']\r\ndf['q_date'] = df.apply(lambda x: str(int(x['year'])) + '-Q' + str(int(x['quarter'])), axis=1)\r\ndf['date'] = pd.PeriodIndex(df['q_date'], freq='Q').to_timestamp()\r\ndf.loc[:, 'realinv_lagged'] = df.loc[:, 'realinv'].shift()\r\ndf[['realinv_lagged']] = df[['realinv_lagged']].fillna(method='backfill')\r\n\r\n# Split into x and y\r\ny = df['realgdp']\r\nX = df[['realinv_lagged','cpi','m1']] #could be more features\r\n\r\n# Split dataset\r\ny_train, y_test, X_train, X_test = temporal_train_test_split(y, X, test_size=30)\r\n\r\n# Create LGBM regressor\r\nregressor = lgb.LGBMRegressor()\r\nforecaster = make_reduction(regressor, window_length=10, strategy=\"recursive\", scitype=\"tabular-regressor\")\r\n    \r\n# Define horizon\r\nfh_abs = ForecastingHorizon(y_test.index, is_relative=False) \r\n\r\n# Fit model\r\nforecaster.fit(y_train, X_train)\r\n\r\n# Make predictions\r\ny_pred = forecaster.predict(X=X_test, fh=fh_abs)\r\n\r\n# Plot preditcions\r\nplot_series(y_train, y_test, y_pred, labels=[\"y_train\", \"y_test\", \"y_pred\"])\r\n`\r\n</div>","closed_by":{"login":"danbartl","id":19947407,"node_id":"MDQ6VXNlcjE5OTQ3NDA3","avatar_url":"https://avatars.githubusercontent.com/u/19947407?v=4","gravatar_id":"","url":"https://api.github.com/users/danbartl","html_url":"https://github.com/danbartl","followers_url":"https://api.github.com/users/danbartl/followers","following_url":"https://api.github.com/users/danbartl/following{/other_user}","gists_url":"https://api.github.com/users/danbartl/gists{/gist_id}","starred_url":"https://api.github.com/users/danbartl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danbartl/subscriptions","organizations_url":"https://api.github.com/users/danbartl/orgs","repos_url":"https://api.github.com/users/danbartl/repos","events_url":"https://api.github.com/users/danbartl/events{/privacy}","received_events_url":"https://api.github.com/users/danbartl/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/3784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/3784/timeline","performed_via_github_app":null,"state_reason":"completed"}