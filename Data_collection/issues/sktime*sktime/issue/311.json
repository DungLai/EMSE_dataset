{"url":"https://api.github.com/repos/sktime/sktime/issues/311","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/311/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/311/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/311/events","html_url":"https://github.com/sktime/sktime/issues/311","id":642431859,"node_id":"MDU6SXNzdWU2NDI0MzE4NTk=","number":311,"title":"Inconsistent `dtype` when converting from nested to long dataframe[BUG]","user":{"login":"hamzahiqb","id":10302415,"node_id":"MDQ6VXNlcjEwMzAyNDE1","avatar_url":"https://avatars.githubusercontent.com/u/10302415?v=4","gravatar_id":"","url":"https://api.github.com/users/hamzahiqb","html_url":"https://github.com/hamzahiqb","followers_url":"https://api.github.com/users/hamzahiqb/followers","following_url":"https://api.github.com/users/hamzahiqb/following{/other_user}","gists_url":"https://api.github.com/users/hamzahiqb/gists{/gist_id}","starred_url":"https://api.github.com/users/hamzahiqb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hamzahiqb/subscriptions","organizations_url":"https://api.github.com/users/hamzahiqb/orgs","repos_url":"https://api.github.com/users/hamzahiqb/repos","events_url":"https://api.github.com/users/hamzahiqb/events{/privacy}","received_events_url":"https://api.github.com/users/hamzahiqb/received_events","type":"User","site_admin":false},"labels":[{"id":1118163262,"node_id":"MDU6TGFiZWwxMTE4MTYzMjYy","url":"https://api.github.com/repos/sktime/sktime/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":3745673790,"node_id":"LA_kwDOCVKAsc7fQnI-","url":"https://api.github.com/repos/sktime/sktime/labels/module:datatypes","name":"module:datatypes","color":"bfdadc","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-06-20T19:24:18Z","updated_at":"2022-07-22T06:51:39Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Describe the bug**\r\n<!--\r\nA clear and concise description of what the bug is.\r\n-->\r\nThe `dtype` of the time index changes when I convert a nested dataframe to long format using the `from_nested_to_long()` function.\r\n\r\n**To Reproduce**\r\n<!--\r\nAdd a Minimal, Complete, and Verifiable example (for more details, see e.g. \r\nhttps://stackoverflow.com/help/mcve\r\n\r\nIf the code is too long, feel free to put it in a public gist and link\r\nit in the issue: https://gist.github.com\r\n-->\r\n\r\n```python\r\nimport numpy as np\r\nimport pandas as pd\r\nfrom sktime.utils.data_container import from_nested_to_long\r\nfrom sktime.utils._testing import generate_df_from_array, _assert_almost_equal\r\n\r\n# Create a nested array\r\nn_obs_X = 20\r\nn_cols_X = 3\r\nX = generate_df_from_array(np.random.normal(size=n_obs_X), n_rows=10,n_cols=n_cols_X)\r\n```\r\n\r\n\r\n```\r\n# Turn it into long format\r\nY = from_nested_to_long(X)\r\n\r\nY.head()\r\n```\r\n|    |   index |    value | column   |   time_index |\r\n|---:|--------:|---------:|:---------|-------------:|\r\n|  0 |       0 | 0.379048 | col0     |            0 |\r\n|  1 |       1 | 0.379048 | col0     |            0 |\r\n|  2 |       2 | 0.379048 | col0     |            0 |\r\n|  3 |       3 | 0.379048 | col0     |            0 |\r\n|  4 |       4 | 0.379048 | col0     |            0 |\r\n\r\nThe output of the `dtype` for X and Y are as follows:\r\n\r\n```\r\nX.iloc[0,0].index # RangeIndex(start=0, stop=20, step=1)\r\nX.iloc[0,0].index.dtype # dtype('int64')\r\n\r\nY.time_index.dtype # dtype('O')\r\ntype(Y.time_index.iloc[0]) # str\r\n```\r\n\r\n**Expected behavior**\r\n<!--\r\nA clear and concise description of what you expected to happen.\r\n-->\r\nThe dtype for Y should be `int64`\r\n\r\nY.time_index.dtype # dtype('int64')\r\ntype(Y.time_index.iloc[0]) # dtype('int64')\r\n\r\n**Additional context**\r\n<!--\r\nAdd any other context about the problem here.\r\n-->\r\n\r\nFrom what I understand, line 127 in https://github.com/alan-turing-institute/sktime/blob/master/sktime/utils/data_container.py#L127 is where the index is converted to a string.\r\n\r\n**Versions**\r\n<details>\r\n\r\n<!--\r\nPlease run the following snippet and paste the output here.\r\nimport platform; print(platform.platform())\r\nimport sys; print(\"Python\", sys.version)\r\nimport numpy; print(\"NumPy\", numpy.__version__)\r\nimport scipy; print(\"SciPy\", scipy.__version__)\r\nimport scipy; print(\"Pandas\", pandas.__version__)\r\nimport sktime; print(\"sktime\", sktime.__version__)\r\n-->\r\nDarwin-18.7.0-x86_64-i386-64bit\r\nPython 3.6.10 |Anaconda, Inc.| (default, Jan  7 2020, 15:01:53) \r\n[GCC 4.2.1 Compatible Clang 4.0.1 (tags/RELEASE_401/final)]\r\nNumPy 1.18.4\r\nSciPy 1.4.1\r\nPandas 1.0.4\r\nsktime 0.4.0\r\n\r\n</details>\r\n\r\n<!-- Thanks for contributing! -->\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/311/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/311/timeline","performed_via_github_app":null,"state_reason":null}