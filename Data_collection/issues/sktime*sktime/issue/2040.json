{"url":"https://api.github.com/repos/sktime/sktime/issues/2040","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/2040/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/2040/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/2040/events","html_url":"https://github.com/sktime/sktime/issues/2040","id":1130379735,"node_id":"I_kwDOCVKAsc5DYDnX","number":2040,"title":"[BUG] ColumnWiseTransformer fails with `PaddingTransformer` and `Imputer` transformer on multivariate time series","user":{"login":"roumail","id":32498483,"node_id":"MDQ6VXNlcjMyNDk4NDgz","avatar_url":"https://avatars.githubusercontent.com/u/32498483?v=4","gravatar_id":"","url":"https://api.github.com/users/roumail","html_url":"https://github.com/roumail","followers_url":"https://api.github.com/users/roumail/followers","following_url":"https://api.github.com/users/roumail/following{/other_user}","gists_url":"https://api.github.com/users/roumail/gists{/gist_id}","starred_url":"https://api.github.com/users/roumail/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roumail/subscriptions","organizations_url":"https://api.github.com/users/roumail/orgs","repos_url":"https://api.github.com/users/roumail/repos","events_url":"https://api.github.com/users/roumail/events{/privacy}","received_events_url":"https://api.github.com/users/roumail/received_events","type":"User","site_admin":false},"labels":[{"id":1118163262,"node_id":"MDU6TGFiZWwxMTE4MTYzMjYy","url":"https://api.github.com/repos/sktime/sktime/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2022-02-10T16:04:44Z","updated_at":"2022-02-11T14:18:45Z","closed_at":"2022-02-11T14:18:45Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\n\r\nColumnWiseTransformer isn't playing well, either in a pipeline where I apply `PaddingTransformer` and `Imputer` sequentially, nor when I try to apply one of these transformers directly to the japanese vowels dataset.\r\n\r\n**To Reproduce**\r\n\r\n```python\r\nfrom sktime.datasets import (\r\n    load_japanese_vowels,\r\n    #     load_basic_motions\r\n)\r\nfrom sklearn.pipeline import Pipeline\r\n\r\nfrom sktime.transformations.panel.padder import PaddingTransformer\r\nfrom sktime.transformations.series.impute import Imputer\r\nfrom sktime.transformations.series.compose import ColumnwiseTransformer\r\n\r\n# load data .. \r\nvowel_X, vowel_y = load_japanese_vowels()\r\n\r\n# helper to confirm padding transformer worked as expected\r\ndef summarize_data(df):\r\n    return df.apply(lambda dim: dim.apply(lambda series: len(series)))\r\n\r\n# Unequal time series as expected. \r\nsummarize_data(vowel_X)\r\n\r\n\r\n# Apply each of these transformers (padding and imputing), sequentially to each column using `ColumnWiseTransformer` but it gives me the error `get_tags` not found:\r\n\r\npadding_pipeline = Pipeline(\r\n    steps=[\r\n        (\"equalise\", PaddingTransformer(fill_value=np.nan)),\r\n        (\"forward_fill\", Imputer(method=\"ffill\")),\r\n        (\"passthrough\", \"passthrough\"),\r\n    ]\r\n)\r\ntransformer = ColumnwiseTransformer(transformer=padding_pipeline)\r\nex = padding_pipeline.fit_transform(vowel_X)\r\n\r\n# Note that applying this pipeline across the entire dataset without ColumnWiseTransformer works\r\n# However this gives me the same length time series across the entire dataset, which is not what I'm looking for\r\n\r\nex = padding_pipeline.fit_transform(vowel_X)\r\nsummarize_data(ex)\r\n\r\n# Using columnwisetransformer with any of these transformers gives me a recursion error\r\nequalize = ColumnwiseTransformer(PaddingTransformer(fill_value=np.nan))\r\nout1 = equalize.fit_transform(vowel_X)\r\n\r\nffill = ColumnwiseTransformer(Imputer(method=\"ffill\"))\r\nffill.fit_transform(vowel_X)\r\n```\r\n\r\n**Expected behavior**\r\n\r\nA time series that is padded and imputed separately for each column of the multivariate time series\r\n\r\n**Versions**\r\n\r\n```\r\nPython implementation: CPython\r\nPython version       : 3.8.12\r\nIPython version      : 7.29.0\r\n\r\nCompiler    : GCC 7.5.0\r\nOS          : Linux\r\nRelease     : 3.10.0-1160.45.1.el7.x86_64\r\nMachine     : x86_64\r\nProcessor   : x86_64\r\nCPU cores   : 20\r\nArchitecture: 64bit\r\n\r\nseaborn   : 0.11.2\r\nstumpy    : 1.9.2\r\npandas    : 1.3.5\r\nmatplotlib: 3.5.1\r\npyts      : 0.12.0\r\nnumpy     : 1.21.2\r\nsktime    : 0.10.0\r\n```","closed_by":{"login":"fkiraly","id":7985502,"node_id":"MDQ6VXNlcjc5ODU1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7985502?v=4","gravatar_id":"","url":"https://api.github.com/users/fkiraly","html_url":"https://github.com/fkiraly","followers_url":"https://api.github.com/users/fkiraly/followers","following_url":"https://api.github.com/users/fkiraly/following{/other_user}","gists_url":"https://api.github.com/users/fkiraly/gists{/gist_id}","starred_url":"https://api.github.com/users/fkiraly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkiraly/subscriptions","organizations_url":"https://api.github.com/users/fkiraly/orgs","repos_url":"https://api.github.com/users/fkiraly/repos","events_url":"https://api.github.com/users/fkiraly/events{/privacy}","received_events_url":"https://api.github.com/users/fkiraly/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/2040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/2040/timeline","performed_via_github_app":null,"state_reason":"completed"}