{"url":"https://api.github.com/repos/sktime/sktime/issues/2368","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/2368/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/2368/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/2368/events","html_url":"https://github.com/sktime/sktime/issues/2368","id":1190552299,"node_id":"I_kwDOCVKAsc5G9mLr","number":2368,"title":"[BUG] sporadic test failure of `test_evaluator` `test_plots` on Mac Python 3.7","user":{"login":"khrapovs","id":3774663,"node_id":"MDQ6VXNlcjM3NzQ2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/3774663?v=4","gravatar_id":"","url":"https://api.github.com/users/khrapovs","html_url":"https://github.com/khrapovs","followers_url":"https://api.github.com/users/khrapovs/followers","following_url":"https://api.github.com/users/khrapovs/following{/other_user}","gists_url":"https://api.github.com/users/khrapovs/gists{/gist_id}","starred_url":"https://api.github.com/users/khrapovs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khrapovs/subscriptions","organizations_url":"https://api.github.com/users/khrapovs/orgs","repos_url":"https://api.github.com/users/khrapovs/repos","events_url":"https://api.github.com/users/khrapovs/events{/privacy}","received_events_url":"https://api.github.com/users/khrapovs/received_events","type":"User","site_admin":false},"labels":[{"id":1118163262,"node_id":"MDU6TGFiZWwxMTE4MTYzMjYy","url":"https://api.github.com/repos/sktime/sktime/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2022-04-02T08:12:48Z","updated_at":"2022-07-20T13:02:38Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"**Describe the bug**\r\n<!--\r\nA clear and concise description of what the bug is.\r\n-->\r\n\r\nHere is the failed run: https://github.com/alan-turing-institute/sktime/runs/5788191259?check_suite_focus=true\r\n\r\n```\r\n=================================== FAILURES ===================================\r\n_____________________ benchmarking/tests/test_evaluator.py _____________________\r\n[gw0] darwin -- Python 3.7.12 /Users/runner/hostedtoolcache/Python/3.7.12/x64/bin/python\r\nworker 'gw0' crashed while running 'benchmarking/tests/test_evaluator.py::test_plots'\r\n=============================== warnings summary ===============================\r\n../../../../hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/coverage/inorout.py:472\r\n../../../../hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/coverage/inorout.py:472\r\n../../../../hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/coverage/inorout.py:472\r\n../../../../hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/coverage/inorout.py:472\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/coverage/inorout.py:472: CoverageWarning: --include is ignored because --source is set (include-ignored)\r\n    self.warn(\"--include is ignored because --source is set\", slug=\"include-ignored\")\r\n\r\nbenchmarking/tests/test_experiments.py::test_run_clustering_experiment\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/tslearn/utils/utils.py:156: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.\r\n  Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\r\n    def to_time_series_dataset(dataset, dtype=numpy.float):\r\n\r\nbenchmarking/tests/test_experiments.py::test_run_clustering_experiment\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/tslearn/utils/cast.py:15: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.\r\n  Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\r\n    def to_sklearn_dataset(dataset, dtype=numpy.float, return_dim=False):\r\n\r\nbenchmarking/tests/test_experiments.py::test_run_clustering_experiment\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/tslearn/metrics/utils.py:9: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.\r\n  Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\r\n    compute_diagonal=True, dtype=numpy.float, *args, **kwargs):\r\n\r\nbenchmarking/tests/test_experiments.py::test_run_clustering_experiment\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/tslearn/metrics/sax.py:2: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.\r\n  Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\r\n    from .cysax import cydist_sax\r\n\r\nbenchmarking/tests/test_experiments.py::test_run_clustering_experiment\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/tslearn/metrics/sax.py:2: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.\r\n  Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\r\n    from .cysax import cydist_sax\r\n\r\nbenchmarking/tests/test_experiments.py::test_run_clustering_experiment\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/tslearn/metrics/__init__.py:24: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.\r\n  Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\r\n    from .cycc import cdist_normalized_cc, y_shifted_sbd_vec\r\n\r\nbenchmarking/tests/test_experiments.py: 4530 warnings\r\nclustering/tests/test_k_shapes.py: 2093 warnings\r\ntests/test_all_estimators.py: 30028 warnings\r\nclustering/tests/test_kernel_k_means.py: 18730 warnings\r\n\r\ntests/test_all_estimators.py: 28 warnings\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/sktime/transformations/series/boxcox.py:377: RuntimeWarning: invalid value encountered in power\r\n    x_ratio = x_std / x_mean ** (1 - lmb)\r\n\r\ntests/test_all_estimators.py::TestAllEstimators::test_fit_idempotent[LogTransformer-TransformerFitTransformPanelUnivariateWithClassY]\r\ntests/test_all_estimators.py::TestAllEstimators::test_methods_do_not_change_state[LogTransformer-TransformerFitTransformPanelUnivariateWithClassY]\r\ntests/test_all_estimators.py::TestAllEstimators::test_methods_have_no_side_effects[LogTransformer-TransformerFitTransformPanelUnivariateWithClassY]\r\ntests/test_all_estimators.py::TestAllEstimators::test_persistence_via_pickle[LogTransformer-TransformerFitTransformPanelUnivariateWithClassY]\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/sktime/transformations/series/boxcox.py:250: RuntimeWarning: invalid value encountered in log\r\n    Xt = np.log(X)\r\n\r\ntransformations/tests/test_all_transformers.py::test_all_transformers[HampelFilter]\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1120: RuntimeWarning: All-NaN slice encountered\r\n    overwrite_input=overwrite_input)\r\n\r\ntransformations/tests/test_all_transformers.py::test_all_transformers[TransformedTargetForecaster]\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/sklearn/utils/extmath.py:985: RuntimeWarning: invalid value encountered in true_divide\r\n    updated_mean = (last_sum + new_sum) / updated_sample_count\r\n\r\ntransformations/tests/test_all_transformers.py::test_all_transformers[TransformedTargetForecaster]\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/sklearn/utils/extmath.py:990: RuntimeWarning: invalid value encountered in true_divide\r\n    T = new_sum / new_sample_count\r\n\r\ntransformations/tests/test_all_transformers.py::test_all_transformers[TransformedTargetForecaster]\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/sklearn/utils/extmath.py:1020: RuntimeWarning: invalid value encountered in true_divide\r\n    new_unnormalized_variance -= correction ** 2 / new_sample_count\r\n\r\nperformance_metrics/forecasting/_classes.py: 8 warnings\r\nperformance_metrics/forecasting/_functions.py: 8 warnings\r\nperformance_metrics/tests/test_performance_metrics_forecasting.py: 60 warnings\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/sktime/performance_metrics/forecasting/_functions.py:1802: FutureWarning: In the percentage error metric functions the default argument symmetric=True is changing to symmetric=False in v0.12.0.\r\n    FutureWarning,\r\n\r\nperformance_metrics/forecasting/_classes.py: 8 warnings\r\nperformance_metrics/forecasting/_functions.py: 8 warnings\r\nperformance_metrics/tests/test_performance_metrics_forecasting.py: 60 warnings\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/sktime/performance_metrics/forecasting/_functions.py:1669: FutureWarning: In the percentage error metric functions the default argument symmetric=True is changing to symmetric=False in v0.12.0.\r\n    FutureWarning,\r\n\r\nperformance_metrics/forecasting/_classes.py: 8 warnings\r\nperformance_metrics/forecasting/_functions.py: 8 warnings\r\nperformance_metrics/tests/test_performance_metrics_forecasting.py: 60 warnings\r\n  /Users/runner/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/sktime/performance_metrics/forecasting/_functions.py:1941: FutureWarning: In the percentage error metric functions the default argument symmetric=True is changing to symmetric=False in v0.12.0.\r\n    FutureWarning,\r\n\r\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\r\n\r\n---------- coverage: platform darwin, python 3.7.12-final-0 ----------\r\n---------------------- coverage: failed workers ----------------------\r\nThe following workers failed to return coverage data, ensure that pytest-cov is installed on these workers.\r\ngw0\r\nCoverage HTML written to dir htmlcov\r\n\r\n============================= slowest 20 durations =============================\r\n47.79s call     classification/distance_based/_proximity_forest.py::sktime.classification.distance_based._proximity_forest.ProximityForest\r\n42.98s call     classification/compose/_column_ensemble.py::sktime.classification.compose._column_ensemble.ColumnEnsembleClassifier\r\n28.47s call     forecasting/tests/test_all_forecasters.py::TestAllForecasters::test_update_predict_predicted_index[Prophet-update_params=True-window_length3-fh=1]\r\n28.12s call     forecasting/tests/test_all_forecasters.py::TestAllForecasters::test_update_predict_predicted_index[Prophet-update_params=True-5-fh=1]\r\n27.90s call     forecasting/tests/test_all_forecasters.py::TestAllForecasters::test_update_predict_predicted_index[Prophet-update_params=True-window_length2-fh=1]\r\n27.82s call     forecasting/tests/test_all_forecasters.py::TestAllForecasters::test_update_predict_predicted_index[Prophet-update_params=True-1-fh=1]\r\n27.74s call     forecasting/tests/test_all_forecasters.py::TestAllForecasters::test_update_predict_predicted_index[Prophet-update_params=True-window_length4-fh=1]\r\n27.73s call     forecasting/tests/test_all_forecasters.py::TestAllForecasters::test_update_predict_predicted_index[Prophet-update_params=True-window_length5-fh=1]\r\n27.57s call     forecasting/tests/test_all_forecasters.py::TestAllForecasters::test_update_predict_predicted_index[Prophet-update_params=False-step=1-window_length4-fh=1]\r\n27.33s call     forecasting/tests/test_all_forecasters.py::TestAllForecasters::test_update_predict_predicted_index[Prophet-update_params=False-step=1-1-fh=1]\r\n27.16s call     forecasting/tests/test_all_forecasters.py::TestAllForecasters::test_update_predict_predicted_index[Prophet-update_params=False-step=1-window_length3-fh=1]\r\n27.11s call     forecasting/tests/test_all_forecasters.py::TestAllForecasters::test_update_predict_predicted_index[Prophet-update_params=False-step=1-window_length2-fh=1]\r\n27.05s call     forecasting/tests/test_all_forecasters.py::TestAllForecasters::test_update_predict_predicted_index[Prophet-update_params=False-step=1-window_length5-fh=1]\r\n26.94s call     forecasting/tests/test_all_forecasters.py::TestAllForecasters::test_update_predict_predicted_index[Prophet-update_params=False-step=1-5-fh=1]\r\n26.54s call     forecasting/statsforecast.py::sktime.forecasting.statsforecast.StatsForecastAutoARIMA\r\n25.92s call     classification/distance_based/tests/test_proximity_forest.py::test_pf_on_unit_test_data\r\n23.90s call     tests/test_all_estimators.py::TestAllEstimators::test_fit_idempotent[MatrixProfileTransformer-TransformerFitTransformSeriesUnivariate]\r\n20.34s call     forecasting/tests/test_all_forecasters.py::TestAllForecasters::test_update_predict_predicted_index[Prophet-update_params=True-5-fh=[2 5]]\r\n19.99s call     tests/test_all_estimators.py::TestAllEstimators::test_raises_not_fitted_error[ARIMA-ForecasterFitPredictUnivariateNoX]\r\n19.81s call     forecasting/tests/test_all_forecasters.py::TestAllForecasters::test_update_predict_predicted_index[Prophet-update_params=True-1-fh=[2 5]]\r\n=========================== short test summary info ============================\r\nFAILED benchmarking/tests/test_evaluator.py::test_plots\r\n= 1 failed, 20210 passed, 1684 skipped, 5 xfailed, 1 xpassed, 123303 warnings in 2851.60s (0:47:31) =\r\nmake: *** [test] Error 1\r\nError: Process completed with exit code 2.\r\n```\r\n\r\n**Additional context**\r\n<!--\r\nAdd any other context about the problem here.\r\n-->\r\n\r\nDoes not seem related to anything in the PR itself. After updating the branch with newer commits the pipeline is successful again.","closed_by":null,"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/2368/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/2368/timeline","performed_via_github_app":null,"state_reason":null}