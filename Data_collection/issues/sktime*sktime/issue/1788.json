{"url":"https://api.github.com/repos/sktime/sktime/issues/1788","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/1788/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/1788/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/1788/events","html_url":"https://github.com/sktime/sktime/issues/1788","id":1086156442,"node_id":"I_kwDOCVKAsc5AvW6a","number":1788,"title":"[BUG] \"update_params=False\" for statsmodels adapter should call apply","user":{"login":"raphaccf","id":56556788,"node_id":"MDQ6VXNlcjU2NTU2Nzg4","avatar_url":"https://avatars.githubusercontent.com/u/56556788?v=4","gravatar_id":"","url":"https://api.github.com/users/raphaccf","html_url":"https://github.com/raphaccf","followers_url":"https://api.github.com/users/raphaccf/followers","following_url":"https://api.github.com/users/raphaccf/following{/other_user}","gists_url":"https://api.github.com/users/raphaccf/gists{/gist_id}","starred_url":"https://api.github.com/users/raphaccf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raphaccf/subscriptions","organizations_url":"https://api.github.com/users/raphaccf/orgs","repos_url":"https://api.github.com/users/raphaccf/repos","events_url":"https://api.github.com/users/raphaccf/events{/privacy}","received_events_url":"https://api.github.com/users/raphaccf/received_events","type":"User","site_admin":false},"labels":[{"id":1118163262,"node_id":"MDU6TGFiZWwxMTE4MTYzMjYy","url":"https://api.github.com/repos/sktime/sktime/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1118163266,"node_id":"MDU6TGFiZWwxMTE4MTYzMjY2","url":"https://api.github.com/repos/sktime/sktime/labels/good%20first%20issue","name":"good first issue","color":"9eff91","default":true,"description":"Good for newcomers"},{"id":3105906374,"node_id":"MDU6TGFiZWwzMTA1OTA2Mzc0","url":"https://api.github.com/repos/sktime/sktime/labels/module:forecasting","name":"module:forecasting","color":"35FCCE","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"chillerobscuro","id":5232872,"node_id":"MDQ6VXNlcjUyMzI4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/5232872?v=4","gravatar_id":"","url":"https://api.github.com/users/chillerobscuro","html_url":"https://github.com/chillerobscuro","followers_url":"https://api.github.com/users/chillerobscuro/followers","following_url":"https://api.github.com/users/chillerobscuro/following{/other_user}","gists_url":"https://api.github.com/users/chillerobscuro/gists{/gist_id}","starred_url":"https://api.github.com/users/chillerobscuro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chillerobscuro/subscriptions","organizations_url":"https://api.github.com/users/chillerobscuro/orgs","repos_url":"https://api.github.com/users/chillerobscuro/repos","events_url":"https://api.github.com/users/chillerobscuro/events{/privacy}","received_events_url":"https://api.github.com/users/chillerobscuro/received_events","type":"User","site_admin":false},"assignees":[{"login":"chillerobscuro","id":5232872,"node_id":"MDQ6VXNlcjUyMzI4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/5232872?v=4","gravatar_id":"","url":"https://api.github.com/users/chillerobscuro","html_url":"https://github.com/chillerobscuro","followers_url":"https://api.github.com/users/chillerobscuro/followers","following_url":"https://api.github.com/users/chillerobscuro/following{/other_user}","gists_url":"https://api.github.com/users/chillerobscuro/gists{/gist_id}","starred_url":"https://api.github.com/users/chillerobscuro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chillerobscuro/subscriptions","organizations_url":"https://api.github.com/users/chillerobscuro/orgs","repos_url":"https://api.github.com/users/chillerobscuro/repos","events_url":"https://api.github.com/users/chillerobscuro/events{/privacy}","received_events_url":"https://api.github.com/users/chillerobscuro/received_events","type":"User","site_admin":false}],"milestone":null,"comments":28,"created_at":"2021-12-21T19:21:24Z","updated_at":"2022-10-23T17:33:43Z","closed_at":"2022-10-23T17:33:42Z","author_association":"NONE","active_lock_reason":null,"body":"The current logic of  `update(update_params=False)` in the `statsmodels` interfaces is not correct, the model simply produces predictions it would have made before the update, instead of applying the fitted model to new data.\r\n\r\nInstead, the `apply` interface from `statsmodels` should be used appropriately, see the discussion below. Previously, this was available only for a few models, but seems to be a general interface point now.\r\n\r\n---\r\n**Describe the bug**\r\n\r\nAfter estimated a model, I would like to make forecast after my test set, but without updating parameters (changing the model parameters). This is specially important for comparison, moreover to forecast with new data without changing the model.\r\nI have tried to set `update_params=False` in \"update()\"  and in \"update_predict_single()\", but it seems that is not working. Dates (timestamp) are updated, but forecast is the same for the previous period. I do not know If I am doing something wrong, or it is a bug. I have an example with auto.arima (code bellow and pdf attached).\r\n\r\nKind regards\r\n\r\n**To Reproduce**\r\n\r\n```\r\nimport pandas as pd\r\nimport numpy as np\r\nfrom sktime.datasets import load_airline\r\nfrom sktime.forecasting.arima import AutoARIMA\r\nfrom sktime import show_versions \r\nshow_versions()\r\n```\r\n```\r\n## data split\r\ny=load_airline() ## total observations\r\ny1 = y.head(y.shape[0]-6)  #train observations\r\ny2 = y.tail(6) # test observations\r\n```\r\n```\r\nforecaster = AutoARIMA(sp=12, suppress_warnings=True,random_state=123)\r\nz=forecaster.fit(y1)\r\nAutoARIMA(...)\r\ny_pred = forecaster.predict(fh=[1,2,3,4,5,6])\r\n### model configuration and parameters for train\r\nz.summary()\r\n```\r\n```\r\ny_pred_semfit = forecaster.predict(fh=[1,2,3,4,5,6]) ## o cutoff 1960-06\r\ny_pred_semfit\r\n```\r\n```\r\n## using a function from stkime for not update_params, but to forecast using the test portion of the data set (to append to train y1)\r\ny_pred = forecaster.update_predict_single(y_new=y2, update_params=False)\r\ny_pred\r\n### dates changed, but forecasted values are the same as above\r\n```\r\n\r\n```\r\n### just changing the input of the function\r\ny_pred = forecaster.update_predict_single(y=y, update_params=False)\r\ny_pred\r\n```\r\n\r\n```\r\n### another function from stkime, without update/retrain model parameters using update_params=False\r\nupdated_model =  forecaster.update(y=y, update_params=False)\r\nupdated_model.predict()\r\n```\r\n```\r\n### however, if we set \"update_params=True\", time for command excution increase and forecasted values change\r\nupdated_model =  forecaster.update(y=y2, update_params=True)\r\nupdated_model.predict()\r\n```\r\n\r\n```\r\n## but model parameters/configuration are different\r\nupdated_model.summary()\r\n```\r\n\r\n```\r\n### using another function from Sktime, .fit_predict, the same results as above\r\ny_pred = forecaster.fit_predict(y,fh=[1,2,3,4,5,6])\r\ny_pred\r\n```\r\n[Sktime_update_model.pdf](https://github.com/alan-turing-institute/sktime/files/7757528/Sktime_update_model.pdf)\r\n\r\n`forecaster.summary()`","closed_by":{"login":"fkiraly","id":7985502,"node_id":"MDQ6VXNlcjc5ODU1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7985502?v=4","gravatar_id":"","url":"https://api.github.com/users/fkiraly","html_url":"https://github.com/fkiraly","followers_url":"https://api.github.com/users/fkiraly/followers","following_url":"https://api.github.com/users/fkiraly/following{/other_user}","gists_url":"https://api.github.com/users/fkiraly/gists{/gist_id}","starred_url":"https://api.github.com/users/fkiraly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkiraly/subscriptions","organizations_url":"https://api.github.com/users/fkiraly/orgs","repos_url":"https://api.github.com/users/fkiraly/repos","events_url":"https://api.github.com/users/fkiraly/events{/privacy}","received_events_url":"https://api.github.com/users/fkiraly/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/1788/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/1788/timeline","performed_via_github_app":null,"state_reason":"completed"}