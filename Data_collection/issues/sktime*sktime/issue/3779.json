{"url":"https://api.github.com/repos/sktime/sktime/issues/3779","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/3779/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/3779/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/3779/events","html_url":"https://github.com/sktime/sktime/issues/3779","id":1447138348,"node_id":"I_kwDOCVKAsc5WQZQs","number":3779,"title":"[BUG] Lag transformer returns a dataframe with more rows than the input dataframe","user":{"login":"KishManani","id":30973056,"node_id":"MDQ6VXNlcjMwOTczMDU2","avatar_url":"https://avatars.githubusercontent.com/u/30973056?v=4","gravatar_id":"","url":"https://api.github.com/users/KishManani","html_url":"https://github.com/KishManani","followers_url":"https://api.github.com/users/KishManani/followers","following_url":"https://api.github.com/users/KishManani/following{/other_user}","gists_url":"https://api.github.com/users/KishManani/gists{/gist_id}","starred_url":"https://api.github.com/users/KishManani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KishManani/subscriptions","organizations_url":"https://api.github.com/users/KishManani/orgs","repos_url":"https://api.github.com/users/KishManani/repos","events_url":"https://api.github.com/users/KishManani/events{/privacy}","received_events_url":"https://api.github.com/users/KishManani/received_events","type":"User","site_admin":false},"labels":[{"id":1118163262,"node_id":"MDU6TGFiZWwxMTE4MTYzMjYy","url":"https://api.github.com/repos/sktime/sktime/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":3105907331,"node_id":"MDU6TGFiZWwzMTA1OTA3MzMx","url":"https://api.github.com/repos/sktime/sktime/labels/module:transformations","name":"module:transformations","color":"0865AF","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-11-13T23:13:31Z","updated_at":"2022-11-14T00:13:41Z","closed_at":"2022-11-14T00:12:56Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Describe the bug**\r\n I noticed that if you have a dataframe with a non uniform time stamp that the Lag transformer will resample the dataframe and return more rows than the original dataframe. \r\n\r\n**To Reproduce**\r\n\r\n```python\r\nimport numpy as np\r\nimport pandas as pd\r\n\r\nfrom sktime.transformations.series.lag import Lag\r\nfrom sktime.transformations.series.fourier import FourierFeatures\r\n\r\n# Create dataframe with non-uniform integer index\r\ndata = {'ix': [1,2,3,4,5,9,10], 'y': [1,4,5,5,21,1,1]}\r\ndf_int_idx = pd.DataFrame(data=data[\"y\"], index=data[\"ix\"], columns=[\"y\"])\r\n\r\n# Apply transformers\r\nprint(Lag(lags=[1,2,3]).fit_transform(df_int_idx))\r\n```\r\n\r\nOutput:\r\n\r\n\r\n```python\r\n    lag_1__y  lag_2__y  lag_3__y\r\n1        NaN       NaN       NaN\r\n2        1.0       NaN       NaN\r\n3        4.0       1.0       NaN\r\n4        5.0       4.0       1.0\r\n5        5.0       5.0       4.0\r\n6       21.0       5.0       5.0\r\n7        NaN      21.0       5.0\r\n8        NaN       NaN      21.0\r\n9        NaN       NaN       NaN\r\n10       1.0       NaN       NaN\r\n11       1.0       1.0       NaN\r\n12       NaN       1.0       1.0\r\n13       NaN       NaN       1.0 \r\n```\r\n\r\n**Expected behavior**\r\nA dataframe which has the same index as the original dataframe with the lag features.\r\n\r\n**Versions**\r\n\r\nSystem:\r\npython: 3.8.7 (default, May  6 2021, 21:53:45)  [Clang 12.0.0 (clang-1200.0.32.29)]\r\nexecutable: /Users/kishan_manani/.pyenv/versions/3.8.7/envs/sktime-dev/bin/python\r\nmachine: macOS-11.6.6-x86_64-i386-64bit\r\n\r\nPython dependencies:\r\npip: 22.1.2\r\nsetuptools: 49.2.1\r\nsklearn: 1.1.1\r\nsktime: 0.14.0\r\nstatsmodels: 0.13.2\r\nnumpy: 1.21.6\r\nscipy: 1.8.1\r\npandas: 1.4.2\r\nmatplotlib: 3.5.2\r\njoblib: 1.1.0\r\nnumba: 0.55.2\r\npmdarima: 1.8.5\r\ntsfresh: 0.19.0\r\n","closed_by":{"login":"fkiraly","id":7985502,"node_id":"MDQ6VXNlcjc5ODU1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7985502?v=4","gravatar_id":"","url":"https://api.github.com/users/fkiraly","html_url":"https://github.com/fkiraly","followers_url":"https://api.github.com/users/fkiraly/followers","following_url":"https://api.github.com/users/fkiraly/following{/other_user}","gists_url":"https://api.github.com/users/fkiraly/gists{/gist_id}","starred_url":"https://api.github.com/users/fkiraly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkiraly/subscriptions","organizations_url":"https://api.github.com/users/fkiraly/orgs","repos_url":"https://api.github.com/users/fkiraly/repos","events_url":"https://api.github.com/users/fkiraly/events{/privacy}","received_events_url":"https://api.github.com/users/fkiraly/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/3779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/3779/timeline","performed_via_github_app":null,"state_reason":"completed"}