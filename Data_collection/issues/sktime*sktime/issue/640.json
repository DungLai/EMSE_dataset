{"url":"https://api.github.com/repos/sktime/sktime/issues/640","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/640/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/640/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/640/events","html_url":"https://github.com/sktime/sktime/issues/640","id":797756243,"node_id":"MDU6SXNzdWU3OTc3NTYyNDM=","number":640,"title":"[BUG] Fitting errors using WEASEL","user":{"login":"isma3ilsamir","id":45247141,"node_id":"MDQ6VXNlcjQ1MjQ3MTQx","avatar_url":"https://avatars.githubusercontent.com/u/45247141?v=4","gravatar_id":"","url":"https://api.github.com/users/isma3ilsamir","html_url":"https://github.com/isma3ilsamir","followers_url":"https://api.github.com/users/isma3ilsamir/followers","following_url":"https://api.github.com/users/isma3ilsamir/following{/other_user}","gists_url":"https://api.github.com/users/isma3ilsamir/gists{/gist_id}","starred_url":"https://api.github.com/users/isma3ilsamir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/isma3ilsamir/subscriptions","organizations_url":"https://api.github.com/users/isma3ilsamir/orgs","repos_url":"https://api.github.com/users/isma3ilsamir/repos","events_url":"https://api.github.com/users/isma3ilsamir/events{/privacy}","received_events_url":"https://api.github.com/users/isma3ilsamir/received_events","type":"User","site_admin":false},"labels":[{"id":1118163262,"node_id":"MDU6TGFiZWwxMTE4MTYzMjYy","url":"https://api.github.com/repos/sktime/sktime/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2021-01-31T16:52:41Z","updated_at":"2021-02-04T12:24:52Z","closed_at":"2021-02-04T12:24:52Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nI am trying to train `WEASEL` on different datasets, but I seem to get errors on many of them. Below is a table with the names of datasets that failed and their corresponding errors.\r\n\r\nThere seems to be 2 main errors\r\n * NO matching definition for argument type(s) readonly array(float64, 1d, C), int64, int64, array(float64, 1d, C)\r\n * Input contains NaN, infinity or a value too large for dtype('float64')\r\n\r\nFor the second error I checked the `PLAID` dataset and it does contain missing values. As per my understanding, I thought since the `data_io` utils have a `replace_missing_vals_with='NaN'` option that algorithms will be able to learn on data with missing values. **Am I correct ?** or do I have I handle missing values myself ?\r\n\r\n```python\r\ndataset                   error\r\nRefrigerationDevices\t\"NO matching definition for argument type(s) readonly array(float64, 1d, C), int64, int64, array(float64, 1d, C)\"\r\nScreenType\t\"NO matching definition for argument type(s) readonly array(float64, 1d, C), int64, int64, array(float64, 1d, C)\"\r\nElectricDevices\t\"NO matching definition for argument type(s) readonly array(float64, 1d, C), int64, int64, array(float64, 1d, C)\"\r\nComputers\t\"NO matching definition for argument type(s) readonly array(float64, 1d, C), int64, int64, array(float64, 1d, C)\"\r\nLargeKitchenAppliances\t\"NO matching definition for argument type(s) readonly array(float64, 1d, C), int64, int64, array(float64, 1d, C)\"\r\nSmallKitchenAppliances\t\"NO matching definition for argument type(s) readonly array(float64, 1d, C), int64, int64, array(float64, 1d, C)\"\r\nPLAID\t\"Input contains NaN, infinity or a value too large for dtype('float64')\"\r\nACSF1\t\"NO matching definition for argument type(s) readonly array(float64, 1d, C), int64, int64, array(float64, 1d, C)\"\r\n```\r\n\r\n**To Reproduce**\r\n```python\r\nfrom sktime.classification.dictionary_based import WEASEL\r\nfrom sklearn.model_selection import train_test_split\r\nfrom sktime.utils.data_io import load_from_arff_to_dataframe as load_arff\r\n\r\n## I import the desired dataset\r\nX_train, y_train = load_arff(f'{dataset}_TRAIN.arff')\r\nX_test, y_test = load_arff(f'{dataset}_TEST.arff')\r\n\r\nclassifier = WEASEL(p_threshold=0.05, n_jobs=-1)\r\nclassifier.fit(X_train, y_train)\r\n```\r\n\r\n**Expected behavior**\r\n<!--\r\nA clear and concise description of what you expected to happen.\r\n-->\r\n\r\n**Additional context**\r\n<!--\r\nAdd any other context about the problem here.\r\n-->\r\n\r\n**Versions**\r\n<details>\r\nSystem:\r\n    python: 3.7.4 (tags/v3.7.4:e09359112e, Jul  8 2019, 20:34:20) [MSC v.1916 64 bit (AMD64)]\r\nexecutable: C:\\Users\\Ismail\\.virtualenvs\\Code-h9r8g-fJ\\Scripts\\python.exe\r\n   machine: Windows-10-10.0.18362-SP0\r\n\r\nPython dependencies:\r\n          pip: 20.3.3\r\n   setuptools: 51.3.3\r\n      sklearn: 0.24.1\r\n       sktime: 0.5.2\r\n  statsmodels: 0.12.1\r\n        numpy: 1.19.5\r\n        scipy: 1.6.0\r\n       Cython: 0.29.21\r\n       pandas: 1.2.1\r\n   matplotlib: 3.3.4\r\n       joblib: 1.0.0\r\n        numba: 0.52.0\r\n     pmdarima: None\r\n      tsfresh: 0.17.0\r\n\r\n</details>\r\n\r\n<!-- Thanks for contributing! -->\r\n","closed_by":{"login":"mloning","id":21020482,"node_id":"MDQ6VXNlcjIxMDIwNDgy","avatar_url":"https://avatars.githubusercontent.com/u/21020482?v=4","gravatar_id":"","url":"https://api.github.com/users/mloning","html_url":"https://github.com/mloning","followers_url":"https://api.github.com/users/mloning/followers","following_url":"https://api.github.com/users/mloning/following{/other_user}","gists_url":"https://api.github.com/users/mloning/gists{/gist_id}","starred_url":"https://api.github.com/users/mloning/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mloning/subscriptions","organizations_url":"https://api.github.com/users/mloning/orgs","repos_url":"https://api.github.com/users/mloning/repos","events_url":"https://api.github.com/users/mloning/events{/privacy}","received_events_url":"https://api.github.com/users/mloning/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/640/timeline","performed_via_github_app":null,"state_reason":"completed"}