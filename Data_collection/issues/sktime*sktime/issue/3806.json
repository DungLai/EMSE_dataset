{"url":"https://api.github.com/repos/sktime/sktime/issues/3806","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/3806/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/3806/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/3806/events","html_url":"https://github.com/sktime/sktime/issues/3806","id":1453315102,"node_id":"I_kwDOCVKAsc5Wn9Qe","number":3806,"title":"[BUG] CNNClassifier loss and accuracy flat 0.5 on all epochs","user":{"login":"equ1","id":19189325,"node_id":"MDQ6VXNlcjE5MTg5MzI1","avatar_url":"https://avatars.githubusercontent.com/u/19189325?v=4","gravatar_id":"","url":"https://api.github.com/users/equ1","html_url":"https://github.com/equ1","followers_url":"https://api.github.com/users/equ1/followers","following_url":"https://api.github.com/users/equ1/following{/other_user}","gists_url":"https://api.github.com/users/equ1/gists{/gist_id}","starred_url":"https://api.github.com/users/equ1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/equ1/subscriptions","organizations_url":"https://api.github.com/users/equ1/orgs","repos_url":"https://api.github.com/users/equ1/repos","events_url":"https://api.github.com/users/equ1/events{/privacy}","received_events_url":"https://api.github.com/users/equ1/received_events","type":"User","site_admin":false},"labels":[{"id":1118163262,"node_id":"MDU6TGFiZWwxMTE4MTYzMjYy","url":"https://api.github.com/repos/sktime/sktime/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":3102418261,"node_id":"MDU6TGFiZWwzMTAyNDE4MjYx","url":"https://api.github.com/repos/sktime/sktime/labels/module:classification","name":"module:classification","color":"BEB114","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2022-11-17T13:06:32Z","updated_at":"2022-11-19T12:48:46Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nRunning `CNNClassifier` with nested_univ data type (multivariate time series) gives a loss/accuracy of 0.5 on each epoch. Each iteration takes 4 ms, and I highly suspect no actual training is happening. Here's screencaps of what's going on:\r\n\r\n![image](https://user-images.githubusercontent.com/19189325/202454225-7c334cc3-0a3f-45de-9b2b-9ecf36ee8420.png)\r\n![image](https://user-images.githubusercontent.com/19189325/202454282-15dd4ad3-408d-428b-b0ab-4cfd8049025d.png)\r\n![image](https://user-images.githubusercontent.com/19189325/202454340-86eb4b40-b369-4733-9c94-c5681ffcb580.png)\r\n\r\n**To Reproduce**\r\nGenerate a nested_univ dataframe X_train with dimensions 400x8, with a 10000 length series within each cell (datetime index). Then generate another dataframe X_test of size 100x8 in the same fashion. y_train and y_test are numpy arrays of size (400,) and (100,) respectively. Then run the regular training process:\r\n\r\n```python\r\nfrom sktime.classification.deep_learning.cnn import CNNClassifier\r\n\r\nnetwork = CNNClassifier(n_epochs=250, verbose=True)\r\nnetwork.fit(X_train, y_train)\r\nnetwork.score(X_test, y_test)\r\n```\r\n\r\n**Expected behavior**\r\nThe model should train normally. I don't think there should be any GPU memory issues - I'm using an A4000 with 16 GiBs of VRAM and there are only 27452 trainable parameters.\r\n\r\n**Versions**\r\nsktime version = 0.14.0 (`pip install sktime[dl]`)\r\ntensorflow version = 2.9.1\r\nkeras version = 2.9.0\r\ntensorflow-probability version = 0.17.0 (manually downgraded from 0.18.0 because of compatibility issues)\r\nkeras-self-attention version  = 0.51.0 (installed separately because of dependency issue. Maybe this should be included in sktime[dl]?) \r\n\r\n<!-- Thanks for contributing! -->\r\n","closed_by":{"login":"equ1","id":19189325,"node_id":"MDQ6VXNlcjE5MTg5MzI1","avatar_url":"https://avatars.githubusercontent.com/u/19189325?v=4","gravatar_id":"","url":"https://api.github.com/users/equ1","html_url":"https://github.com/equ1","followers_url":"https://api.github.com/users/equ1/followers","following_url":"https://api.github.com/users/equ1/following{/other_user}","gists_url":"https://api.github.com/users/equ1/gists{/gist_id}","starred_url":"https://api.github.com/users/equ1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/equ1/subscriptions","organizations_url":"https://api.github.com/users/equ1/orgs","repos_url":"https://api.github.com/users/equ1/repos","events_url":"https://api.github.com/users/equ1/events{/privacy}","received_events_url":"https://api.github.com/users/equ1/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/3806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/3806/timeline","performed_via_github_app":null,"state_reason":"reopened"}