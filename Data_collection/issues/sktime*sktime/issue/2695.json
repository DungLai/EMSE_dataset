{"url":"https://api.github.com/repos/sktime/sktime/issues/2695","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/2695/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/2695/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/2695/events","html_url":"https://github.com/sktime/sktime/issues/2695","id":1247887502,"node_id":"I_kwDOCVKAsc5KYUCO","number":2695,"title":"[ENH] Refactor/simplify `sktime.forecasting.model_selection._split.BaseSplitter._split_vectorized`","user":{"login":"khrapovs","id":3774663,"node_id":"MDQ6VXNlcjM3NzQ2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/3774663?v=4","gravatar_id":"","url":"https://api.github.com/users/khrapovs","html_url":"https://github.com/khrapovs","followers_url":"https://api.github.com/users/khrapovs/followers","following_url":"https://api.github.com/users/khrapovs/following{/other_user}","gists_url":"https://api.github.com/users/khrapovs/gists{/gist_id}","starred_url":"https://api.github.com/users/khrapovs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khrapovs/subscriptions","organizations_url":"https://api.github.com/users/khrapovs/orgs","repos_url":"https://api.github.com/users/khrapovs/repos","events_url":"https://api.github.com/users/khrapovs/events{/privacy}","received_events_url":"https://api.github.com/users/khrapovs/received_events","type":"User","site_admin":false},"labels":[{"id":1118163266,"node_id":"MDU6TGFiZWwxMTE4MTYzMjY2","url":"https://api.github.com/repos/sktime/sktime/labels/good%20first%20issue","name":"good first issue","color":"9eff91","default":true,"description":"Good for newcomers"},{"id":3105906374,"node_id":"MDU6TGFiZWwzMTA1OTA2Mzc0","url":"https://api.github.com/repos/sktime/sktime/labels/module:forecasting","name":"module:forecasting","color":"35FCCE","default":false,"description":""},{"id":3796180314,"node_id":"LA_kwDOCVKAsc7iRR1a","url":"https://api.github.com/repos/sktime/sktime/labels/enhancement","name":"enhancement","color":"fef2c0","default":true,"description":"Adding new functionality"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-05-25T10:25:34Z","updated_at":"2023-01-13T18:11:56Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"body":"`sktime.forecasting.model_selection._split.BaseSplitter._split_vectorized` is very hard to read and understand.\r\n\r\nThis method was introduced in https://github.com/alan-turing-institute/sktime/pull/2599. During the review I proposed the following refactoring idea: https://github.com/alan-turing-institute/sktime/pull/2599#issuecomment-1126736598 (see comments that followed). For convenience, I copy my main suggestion here:\r\n\r\n> I looked a bit closer inside of the sktime.forecasting.model_selection._split.BaseSplitter._split_vectorized. Again, I completely understand the result, for each series in the hierarchy you want to get train/test windows with numeration in the context of one big stacked time series. But I am worried about the implementation of this method. There are several enclosed loops, several temporary objects.\r\n\r\n> For each time series in hierarchy you can easily get train/test windows that start counting from zero in isolation for each series. What you want to do next is shift those windows by the iloc indices of each series beginning. Say you have two windows in isolation: [0, 1, 3] (out of [0, 1, 2, 3]), and [0, 2] (out of [0, 1, 2]). The index of the whole series is [0, 1, 2, 3, 4, 5, 6]. The \"anchors\" are then 0 and 4. So your final windows are [0, 1, 3] + 0 = [0, 1, 3], and [0, 2] + 4 = [4, 6]. I know, it is just a toy example, but isn't it easy to get those iloc \"anchors\"?","closed_by":null,"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/2695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/2695/timeline","performed_via_github_app":null,"state_reason":null}