{"url":"https://api.github.com/repos/sktime/sktime/issues/3648","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/3648/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/3648/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/3648/events","html_url":"https://github.com/sktime/sktime/issues/3648","id":1422820896,"node_id":"I_kwDOCVKAsc5UzoYg","number":3648,"title":"[BUG] Proximity Forest does not run with default values, deprecate?","user":{"login":"TonyBagnall","id":9594042,"node_id":"MDQ6VXNlcjk1OTQwNDI=","avatar_url":"https://avatars.githubusercontent.com/u/9594042?v=4","gravatar_id":"","url":"https://api.github.com/users/TonyBagnall","html_url":"https://github.com/TonyBagnall","followers_url":"https://api.github.com/users/TonyBagnall/followers","following_url":"https://api.github.com/users/TonyBagnall/following{/other_user}","gists_url":"https://api.github.com/users/TonyBagnall/gists{/gist_id}","starred_url":"https://api.github.com/users/TonyBagnall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TonyBagnall/subscriptions","organizations_url":"https://api.github.com/users/TonyBagnall/orgs","repos_url":"https://api.github.com/users/TonyBagnall/repos","events_url":"https://api.github.com/users/TonyBagnall/events{/privacy}","received_events_url":"https://api.github.com/users/TonyBagnall/received_events","type":"User","site_admin":false},"labels":[{"id":1118163262,"node_id":"MDU6TGFiZWwxMTE4MTYzMjYy","url":"https://api.github.com/repos/sktime/sktime/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":3102418261,"node_id":"MDU6TGFiZWwzMTAyNDE4MjYx","url":"https://api.github.com/repos/sktime/sktime/labels/module:classification","name":"module:classification","color":"BEB114","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2022-10-25T17:28:36Z","updated_at":"2022-10-25T18:08:11Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Describe the bug**\r\n In the course of black box testing all 37 classifiers on the archive data, we have identified that the ProximityForest classifier does not currently work with the default settings. It enters an infinite recursion with fit. \r\n\r\nI think we should deprecate this classifier. This classifier was introduced by a core dev who is no longer active, it has no code owner, it has no classifier specific unit tests and is excluded from some interface tests.  It has the following to do listed in the class:\r\n\r\ntodo unit tests / sort out current unit tests\r\ntodo logging package rather than print to screen\r\ntodo get params avoid func pointer - use name\r\ntodo set params use func name or func pointer\r\ntodo constructor accept str name func / pointer\r\ntodo duck-type functions\r\n\r\nand the following issues open issues.\r\nhttps://github.com/sktime/sktime/issues/1715\r\nhttps://github.com/sktime/sktime/issues/2490\r\nhttps://github.com/sktime/sktime/issues/3545\r\n\r\nPrevious testing identified the sktime implementation (with cython) was still significantly worse than the Java version in terms of accuracy (the algorithms authors own implementation and a recreation) and significantly slower. I tried to get it compliant with tests some time ago and I am not a fan of the code structure (local functions stop pickling iirc). As a classifier it is not competitive with more recent algorithms in terms of accuracy (e.g. ROCKET). I think we should remove it then raise an issue for someone to bring it back, preferably with a new implementation. Interface tests work with the testing parameters,             \r\nreturn {\"n_estimators\": 3, \"max_depth\": 2, \"n_stump_evaluations\": 2}\r\nso its probably to do with max_depth which defaults to max_depth=np.math.inf. This is usual with trees since it should stop at leaf nodes, but somehow it isn't. I can probably fix this so it works after a fashion, easily to bodge a fix by setting default max depth, but the bug is more complex and its more complex to find where it is going on forever because it will be due to incorrect leaf setting). However, I would like to discuss whether we should keep it, given the other problems with this classifier and the current version in the release is actually broken.  \r\n\r\n**To Reproduce**\r\n\r\n```python\r\n    from sktime.classification.distance_based import ProximityForest\r\n    from sktime.datasets import load_unit_test\r\n    pf = ProximityForest()\r\n    trainX, trainy = load_unit_test()\r\n    pf.fit(trainX, trainy)\r\n```\r\nthis results in an infinite recursion in _fit leading to stack overflow. \r\nRecursionError: maximum recursion depth exceeded while calling a Python object\r\nthis happens on all problems I tried (unit_test, arrow_head, GunPoint, ItalyPowerDemand)\r\n\r\n**Expected behavior**\r\n\r\nIt should fit and predict with default parameters on data in an allowed format. \r\n\r\n**Additional context**\r\n\r\nthis may have been caused by my alterations in April this year or the cython purge in January. I don't know what caused it, I'm not going to dig back and trace what happened. The fact is the last time this class altered was 7/8/22 means it has been in this state for at least more than two months, unless it was a knock on effect of interface changes. No one has raised an issue about this, which to me shows that it is not used and its removal is unlikely to disrupt peoples work flow. \r\n\r\n**Versions**\r\n<details>\r\nPython dependencies:\r\n          pip: 21.2.2\r\n   setuptools: 61.2.0\r\n      sklearn: 1.1.1\r\n       sktime: 0.13.4\r\n  statsmodels: 0.13.2\r\n        numpy: 1.21.6\r\n        scipy: 1.8.1\r\n       pandas: 1.4.3\r\n   matplotlib: 3.5.2\r\n       joblib: 1.1.0\r\n        numba: 0.55.2\r\n     pmdarima: 1.8.5\r\n      tsfresh: 0.19.0\r\n</details>\r\n\r\n<!-- Thanks for contributing! -->\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/3648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/3648/timeline","performed_via_github_app":null,"state_reason":null}