{"url":"https://api.github.com/repos/sktime/sktime/issues/3253","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/3253/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/3253/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/3253/events","html_url":"https://github.com/sktime/sktime/issues/3253","id":1337748388,"node_id":"I_kwDOCVKAsc5PvGuk","number":3253,"title":"[BUG] `WindowSummarizer` error when used in recursive reducer","user":{"login":"fkiraly","id":7985502,"node_id":"MDQ6VXNlcjc5ODU1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7985502?v=4","gravatar_id":"","url":"https://api.github.com/users/fkiraly","html_url":"https://github.com/fkiraly","followers_url":"https://api.github.com/users/fkiraly/followers","following_url":"https://api.github.com/users/fkiraly/following{/other_user}","gists_url":"https://api.github.com/users/fkiraly/gists{/gist_id}","starred_url":"https://api.github.com/users/fkiraly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkiraly/subscriptions","organizations_url":"https://api.github.com/users/fkiraly/orgs","repos_url":"https://api.github.com/users/fkiraly/repos","events_url":"https://api.github.com/users/fkiraly/events{/privacy}","received_events_url":"https://api.github.com/users/fkiraly/received_events","type":"User","site_admin":false},"labels":[{"id":1118163262,"node_id":"MDU6TGFiZWwxMTE4MTYzMjYy","url":"https://api.github.com/repos/sktime/sktime/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":3105907331,"node_id":"MDU6TGFiZWwzMTA1OTA3MzMx","url":"https://api.github.com/repos/sktime/sktime/labels/module:transformations","name":"module:transformations","color":"0865AF","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2022-08-12T22:18:15Z","updated_at":"2022-11-08T23:05:24Z","closed_at":"2022-11-08T22:38:45Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"From stackoverflow here:\r\nhttps://stackoverflow.com/questions/73325333/call-windowsummarizer-from-sktime-recursively-to-the-forecasting-target-y-in\r\n\r\noriginal message on stackoverflow:\r\n\r\n---\r\n\r\nI need help on how to use the WindowSummarizer function from the SKTIME library recursively in the future.\r\n\r\nBecause in the training and test data it is easy to generate the variables of moving averages and moving standard deviations.\r\n\r\nBut for future predictions, the WindowSummarizer function has to work interactively, with each new predicted observation, WindowSummarizer must recalculate all variables and thus make the next prediction, recursively, until the end.\r\n\r\nCan anyone help me?\r\n\r\nFollow a reproducible example:\r\n\r\n```python\r\n#!pip install sktime[all_extras]\r\n\r\nimport pandas as pd\r\nimport numpy as np\r\nfrom sktime.transformations.series.summarize import WindowSummarizer\r\nfrom sktime.forecasting.base import ForecastingHorizon\r\nfrom sktime.forecasting.compose import ForecastingPipeline\r\nfrom sklearn.linear_model import LinearRegression\r\nfrom sktime.datasets import load_airline\r\nfrom sktime.forecasting.model_selection import temporal_train_test_split\r\nfrom sktime.forecasting.compose import make_reduction, TransformedTargetForecaster\r\n\r\ny = load_airline()\r\n\r\nkwargs = {\r\n        \"lag_feature\": {\r\n            \"lag\": [0,1],\r\n            \"mean\": [[0, 7], [0, 14],[0, 28]],\r\n            \"std\": [[0, 7], [0, 14],[0, 28]],\r\n            \"kurt\": [[0, 7], [0, 14],[0, 28]],\r\n            \"skew\": [[0, 7], [0, 14],[0, 28]]\r\n        }\r\n    }\r\n\r\n\r\nforecaster = make_reduction(\r\n    LinearRegression(),\r\n    scitype=\"tabular-regressor\",\r\n    transformers=[WindowSummarizer(**kwargs, n_jobs=1,truncate = \"bfill\")],\r\n    window_length=None,\r\n    strategy=\"recursive\"\r\n)\r\n\r\npipe = ForecastingPipeline(\r\n    steps=[\r\n        (\"forecaster\", forecaster),\r\n    ]\r\n)\r\n\r\nmodel = pipe.fit(y)\r\n\r\nmodel.predict(fh = np.arange(1,100,1))\r\n```\r\n\r\nThis code return the error message:\r\n\r\n`Input contains NaN, infinity or a value too large for dtype('float64').`\r\n","closed_by":{"login":"danbartl","id":19947407,"node_id":"MDQ6VXNlcjE5OTQ3NDA3","avatar_url":"https://avatars.githubusercontent.com/u/19947407?v=4","gravatar_id":"","url":"https://api.github.com/users/danbartl","html_url":"https://github.com/danbartl","followers_url":"https://api.github.com/users/danbartl/followers","following_url":"https://api.github.com/users/danbartl/following{/other_user}","gists_url":"https://api.github.com/users/danbartl/gists{/gist_id}","starred_url":"https://api.github.com/users/danbartl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danbartl/subscriptions","organizations_url":"https://api.github.com/users/danbartl/orgs","repos_url":"https://api.github.com/users/danbartl/repos","events_url":"https://api.github.com/users/danbartl/events{/privacy}","received_events_url":"https://api.github.com/users/danbartl/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/3253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/3253/timeline","performed_via_github_app":null,"state_reason":"completed"}