{"url":"https://api.github.com/repos/sktime/sktime/issues/3190","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/3190/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/3190/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/3190/events","html_url":"https://github.com/sktime/sktime/issues/3190","id":1330172291,"node_id":"I_kwDOCVKAsc5PSNGD","number":3190,"title":"[ENH] Class Design for BaseDeepNetwork","user":{"login":"AurumnPegasus","id":54315149,"node_id":"MDQ6VXNlcjU0MzE1MTQ5","avatar_url":"https://avatars.githubusercontent.com/u/54315149?v=4","gravatar_id":"","url":"https://api.github.com/users/AurumnPegasus","html_url":"https://github.com/AurumnPegasus","followers_url":"https://api.github.com/users/AurumnPegasus/followers","following_url":"https://api.github.com/users/AurumnPegasus/following{/other_user}","gists_url":"https://api.github.com/users/AurumnPegasus/gists{/gist_id}","starred_url":"https://api.github.com/users/AurumnPegasus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AurumnPegasus/subscriptions","organizations_url":"https://api.github.com/users/AurumnPegasus/orgs","repos_url":"https://api.github.com/users/AurumnPegasus/repos","events_url":"https://api.github.com/users/AurumnPegasus/events{/privacy}","received_events_url":"https://api.github.com/users/AurumnPegasus/received_events","type":"User","site_admin":false},"labels":[{"id":1180363817,"node_id":"MDU6TGFiZWwxMTgwMzYzODE3","url":"https://api.github.com/repos/sktime/sktime/labels/API%20design","name":"API design","color":"874db7","default":false,"description":"API design & software architecture"},{"id":1180366006,"node_id":"MDU6TGFiZWwxMTgwMzY2MDA2","url":"https://api.github.com/repos/sktime/sktime/labels/implementing%20framework","name":"implementing framework","color":"61c7f9","default":false,"description":"Implementing frameworks for new learning tasks"},{"id":3796180314,"node_id":"LA_kwDOCVKAsc7iRR1a","url":"https://api.github.com/repos/sktime/sktime/labels/enhancement","name":"enhancement","color":"fef2c0","default":true,"description":"Adding new functionality"}],"state":"open","locked":false,"assignee":{"login":"fkiraly","id":7985502,"node_id":"MDQ6VXNlcjc5ODU1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7985502?v=4","gravatar_id":"","url":"https://api.github.com/users/fkiraly","html_url":"https://github.com/fkiraly","followers_url":"https://api.github.com/users/fkiraly/followers","following_url":"https://api.github.com/users/fkiraly/following{/other_user}","gists_url":"https://api.github.com/users/fkiraly/gists{/gist_id}","starred_url":"https://api.github.com/users/fkiraly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkiraly/subscriptions","organizations_url":"https://api.github.com/users/fkiraly/orgs","repos_url":"https://api.github.com/users/fkiraly/repos","events_url":"https://api.github.com/users/fkiraly/events{/privacy}","received_events_url":"https://api.github.com/users/fkiraly/received_events","type":"User","site_admin":false},"assignees":[{"login":"fkiraly","id":7985502,"node_id":"MDQ6VXNlcjc5ODU1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7985502?v=4","gravatar_id":"","url":"https://api.github.com/users/fkiraly","html_url":"https://github.com/fkiraly","followers_url":"https://api.github.com/users/fkiraly/followers","following_url":"https://api.github.com/users/fkiraly/following{/other_user}","gists_url":"https://api.github.com/users/fkiraly/gists{/gist_id}","starred_url":"https://api.github.com/users/fkiraly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkiraly/subscriptions","organizations_url":"https://api.github.com/users/fkiraly/orgs","repos_url":"https://api.github.com/users/fkiraly/repos","events_url":"https://api.github.com/users/fkiraly/events{/privacy}","received_events_url":"https://api.github.com/users/fkiraly/received_events","type":"User","site_admin":false},{"login":"AurumnPegasus","id":54315149,"node_id":"MDQ6VXNlcjU0MzE1MTQ5","avatar_url":"https://avatars.githubusercontent.com/u/54315149?v=4","gravatar_id":"","url":"https://api.github.com/users/AurumnPegasus","html_url":"https://github.com/AurumnPegasus","followers_url":"https://api.github.com/users/AurumnPegasus/followers","following_url":"https://api.github.com/users/AurumnPegasus/following{/other_user}","gists_url":"https://api.github.com/users/AurumnPegasus/gists{/gist_id}","starred_url":"https://api.github.com/users/AurumnPegasus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AurumnPegasus/subscriptions","organizations_url":"https://api.github.com/users/AurumnPegasus/orgs","repos_url":"https://api.github.com/users/AurumnPegasus/repos","events_url":"https://api.github.com/users/AurumnPegasus/events{/privacy}","received_events_url":"https://api.github.com/users/AurumnPegasus/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2022-08-05T17:08:10Z","updated_at":"2022-09-30T13:26:02Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Is your feature request related to a problem? Please describe.**\r\nAs discussed in Deep Learning mentoring meet of 05/08/2022:\r\n\r\nCurrent Implementation:\r\n`BaseDeepNetwork` is a base class for creating neural networks. Each specific neural network is child of the `BaseDeepNetwork`. For example, `CNNNetwork`, `CNTCNetwork`, `LSTMNetwork` etc would be classes inheriting *from* the `BaseDeepNetwork` having a single function called `build_model` (which builds and returns the created keras network)\r\nFor estimators, there exist specific `BaseDeepClassifier` and `BaseDeepRegressor`, inheriting from `BaseClassifier` and `BaseRegressor` respectively. Specific estimators like `CNNClassifier` inherit from `BaseDeepClassifier`, and within the `init` method create an object of the class `CNNNetwork`. Then, in the `fit` method, it gets the respective keras neural network by calling `build_model` method from the `CNNNetwork` object. The positive of this design is that when creating a `CNNRegressor`, we do not need to re-write the code for the main CNN, instead we just use `CNNNetwork` similar to how it is used in `CNNClassifer`.\r\nA point to note: `CNNNetwork` returns the keras network built with all except the output layer, which is added in the specific estimator like `CNNClassifier`\r\n\r\nNew Propositions (discussions with @fkiraly  @ltsaprounis today, and @GuzalBulatova  previously)\r\nMake `BaseDeepClassifer` inherit from both `BaseClassifier` and `BaseDeepNetwork`. In this case, `BaseDeepClassifier` will have all the methods and structure similar to other classifiers via `BaseClassifier`, and it can have methods specific to Deep Learning models via `BaseDeepNetwork`. This would reduce the amount of redundant code written across all DL models, and would lead to easier implementation of CustomNetworks by the users (when we move towards having that feature).\r\n\r\nAn example of redundant code occuring across all DL classes:\r\nCheck PR #3128 , where I have implemented a save model and load model functionality for DL model separately (since pickling keras networks is troublesome and not easily implementable). Here, the same `save` and `load` function needs to be implemented in `BaseDeepClassifer` and `BaseDeepRegressor` and `BaseDeepForecaster`, which could have easily solved by having a common DL class all DL networks inherit from. I am sure there will be other such redundancies which we will find as I continue to migrate DL models from sktime-dl to sktime. \r\n\r\nCurrently, input and discussion is required to better design `BaseDeepNetwork` so as to minimize code redundancy and make a more intuitive structure. ","closed_by":null,"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/3190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/3190/timeline","performed_via_github_app":null,"state_reason":null}