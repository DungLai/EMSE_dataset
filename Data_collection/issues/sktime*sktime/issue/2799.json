{"url":"https://api.github.com/repos/sktime/sktime/issues/2799","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/2799/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/2799/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/2799/events","html_url":"https://github.com/sktime/sktime/issues/2799","id":1268690468,"node_id":"I_kwDOCVKAsc5Lnq4k","number":2799,"title":"[ENH] [Annotation Workstream] Implement HMM annotation estimator","user":{"login":"miraep8","id":10511777,"node_id":"MDQ6VXNlcjEwNTExNzc3","avatar_url":"https://avatars.githubusercontent.com/u/10511777?v=4","gravatar_id":"","url":"https://api.github.com/users/miraep8","html_url":"https://github.com/miraep8","followers_url":"https://api.github.com/users/miraep8/followers","following_url":"https://api.github.com/users/miraep8/following{/other_user}","gists_url":"https://api.github.com/users/miraep8/gists{/gist_id}","starred_url":"https://api.github.com/users/miraep8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/miraep8/subscriptions","organizations_url":"https://api.github.com/users/miraep8/orgs","repos_url":"https://api.github.com/users/miraep8/repos","events_url":"https://api.github.com/users/miraep8/events{/privacy}","received_events_url":"https://api.github.com/users/miraep8/received_events","type":"User","site_admin":false},"labels":[{"id":1180387595,"node_id":"MDU6TGFiZWwxMTgwMzg3NTk1","url":"https://api.github.com/repos/sktime/sktime/labels/implementing%20algorithms","name":"implementing algorithms","color":"c5c0f7","default":false,"description":"Implementing new algorithms/estimators"},{"id":1180391124,"node_id":"MDU6TGFiZWwxMTgwMzkxMTI0","url":"https://api.github.com/repos/sktime/sktime/labels/interfacing%20algorithms","name":"interfacing algorithms","color":"ffc9cd","default":false,"description":"Interfacing existing algorithms/estimators for other packages"},{"id":3108854999,"node_id":"MDU6TGFiZWwzMTA4ODU0OTk5","url":"https://api.github.com/repos/sktime/sktime/labels/module:annotation","name":"module:annotation","color":"F1ECF1","default":false,"description":""},{"id":3796180314,"node_id":"LA_kwDOCVKAsc7iRR1a","url":"https://api.github.com/repos/sktime/sktime/labels/enhancement","name":"enhancement","color":"fef2c0","default":true,"description":"Adding new functionality"}],"state":"closed","locked":false,"assignee":{"login":"miraep8","id":10511777,"node_id":"MDQ6VXNlcjEwNTExNzc3","avatar_url":"https://avatars.githubusercontent.com/u/10511777?v=4","gravatar_id":"","url":"https://api.github.com/users/miraep8","html_url":"https://github.com/miraep8","followers_url":"https://api.github.com/users/miraep8/followers","following_url":"https://api.github.com/users/miraep8/following{/other_user}","gists_url":"https://api.github.com/users/miraep8/gists{/gist_id}","starred_url":"https://api.github.com/users/miraep8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/miraep8/subscriptions","organizations_url":"https://api.github.com/users/miraep8/orgs","repos_url":"https://api.github.com/users/miraep8/repos","events_url":"https://api.github.com/users/miraep8/events{/privacy}","received_events_url":"https://api.github.com/users/miraep8/received_events","type":"User","site_admin":false},"assignees":[{"login":"miraep8","id":10511777,"node_id":"MDQ6VXNlcjEwNTExNzc3","avatar_url":"https://avatars.githubusercontent.com/u/10511777?v=4","gravatar_id":"","url":"https://api.github.com/users/miraep8","html_url":"https://github.com/miraep8","followers_url":"https://api.github.com/users/miraep8/followers","following_url":"https://api.github.com/users/miraep8/following{/other_user}","gists_url":"https://api.github.com/users/miraep8/gists{/gist_id}","starred_url":"https://api.github.com/users/miraep8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/miraep8/subscriptions","organizations_url":"https://api.github.com/users/miraep8/orgs","repos_url":"https://api.github.com/users/miraep8/repos","events_url":"https://api.github.com/users/miraep8/events{/privacy}","received_events_url":"https://api.github.com/users/miraep8/received_events","type":"User","site_admin":false}],"milestone":null,"comments":9,"created_at":"2022-06-12T20:13:23Z","updated_at":"2022-08-29T13:15:01Z","closed_at":"2022-08-29T13:15:00Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"I am opening this up as an issue for the new annotation/segmentation workstream. \r\n\r\nMy plan is to implement a Hidden Markov Model (HMM) estimator for annotation of time series data. You can read more about the algorithm [here](https://en.wikipedia.org/wiki/Hidden_Markov_model), but for a brief overview:\r\n\r\n- You want to model a series of variables over time $X$, where $x_t$ represents the variable state at time $t$. \r\n- Unfortunately, you cannot measure or observe $X$ directly, it is a *hidden* variable, but fortunately you can observe a series of related variables $Y$, where $y_t$ represents your observation of $Y$ at time $t$. \r\n- You assume both that $y_t$ depends on $x_t$ (and only on $x_t$), and that $x_{t+1}$ depends on $x_t$ but only on $x_t$ (this assumption that each state is only influenced by the state immediately before it is known as a *Markov* assumption).\r\n- One can use the [Baum-Welch algorithm](https://en.wikipedia.org/wiki/Baum%E2%80%93Welch_algorithm) (a special case of EM) to help find the unknown parameters that define the probabilistic relationship that relates $x_t$ and both $y_t$ and $x_{t+1}$.\r\n- If you have defined the distributions that relate $x_t$ to $y_t$ (known as the emission distribution) and $x_t$ to $x_{t+1}$ (known as the transmission distribution) then you can calculate the most likely sequence of $X$ given the observed sequence $Y$ using a variety of algorithms (for example the [Viterbi algorithm](https://en.wikipedia.org/wiki/Viterbi_algorithm#Example))\r\n\r\nThis is an attractive algorithm for a variety of reasons - its been around for a long time (helped with the lunar landing if I am not mistaken), its a tool that people from a variety of different fields are familiar with, and has good statistical/algorithmic tools to work with it!   \r\n\r\nTo start with we will work with something that assigns non-overlapping single dimensional labels to univariate time series data (we will expand later, but getting this simple case to work would be nice). This will be a batch, not online approach, and will be an unsupervised algorithm. \r\n\r\nThere are two paths forward:\r\n\r\n1. one is to integrate [hmmlearn](https://github.com/hmmlearn/hmmlearn).  Its a pretty nice package, has a decent number of users, and what it does it does well.  But, its currently under limited maintenance mode (which *could* present issues in the future?) doesn't necessarily seem to be totally optimized for speed, which could be important for large data sets, and the multivariate case. And there doesn't seem to be a clear path forward for integrating it with other HMM-like algorithms (e.g. MEMM or CRF) other than integrating new libraries.  Could be nice to have it all under one roof. \r\n2. The path I plan to try out first is to write our own HMM estimator for at least the simple case.  Can we actually make it faster than the vanilla version in `hmmlearn`?  How easy will it be to build on this basic version? \r\n\r\nWill reference PRs/make comments below to update progress. \r\n\r\n\r\n@fkiraly @lmmentel \r\n","closed_by":{"login":"miraep8","id":10511777,"node_id":"MDQ6VXNlcjEwNTExNzc3","avatar_url":"https://avatars.githubusercontent.com/u/10511777?v=4","gravatar_id":"","url":"https://api.github.com/users/miraep8","html_url":"https://github.com/miraep8","followers_url":"https://api.github.com/users/miraep8/followers","following_url":"https://api.github.com/users/miraep8/following{/other_user}","gists_url":"https://api.github.com/users/miraep8/gists{/gist_id}","starred_url":"https://api.github.com/users/miraep8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/miraep8/subscriptions","organizations_url":"https://api.github.com/users/miraep8/orgs","repos_url":"https://api.github.com/users/miraep8/repos","events_url":"https://api.github.com/users/miraep8/events{/privacy}","received_events_url":"https://api.github.com/users/miraep8/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/2799/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/2799/timeline","performed_via_github_app":null,"state_reason":"completed"}