{"url":"https://api.github.com/repos/sktime/sktime/issues/3397","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/3397/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/3397/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/3397/events","html_url":"https://github.com/sktime/sktime/issues/3397","id":1367269025,"node_id":"I_kwDOCVKAsc5Rft6h","number":3397,"title":"[ENH] Hierarchical agglomerative estimation: E-Agglo","user":{"login":"KatieBuc","id":34525024,"node_id":"MDQ6VXNlcjM0NTI1MDI0","avatar_url":"https://avatars.githubusercontent.com/u/34525024?v=4","gravatar_id":"","url":"https://api.github.com/users/KatieBuc","html_url":"https://github.com/KatieBuc","followers_url":"https://api.github.com/users/KatieBuc/followers","following_url":"https://api.github.com/users/KatieBuc/following{/other_user}","gists_url":"https://api.github.com/users/KatieBuc/gists{/gist_id}","starred_url":"https://api.github.com/users/KatieBuc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KatieBuc/subscriptions","organizations_url":"https://api.github.com/users/KatieBuc/orgs","repos_url":"https://api.github.com/users/KatieBuc/repos","events_url":"https://api.github.com/users/KatieBuc/events{/privacy}","received_events_url":"https://api.github.com/users/KatieBuc/received_events","type":"User","site_admin":false},"labels":[{"id":3108854999,"node_id":"MDU6TGFiZWwzMTA4ODU0OTk5","url":"https://api.github.com/repos/sktime/sktime/labels/module:annotation","name":"module:annotation","color":"F1ECF1","default":false,"description":""},{"id":3796180314,"node_id":"LA_kwDOCVKAsc7iRR1a","url":"https://api.github.com/repos/sktime/sktime/labels/enhancement","name":"enhancement","color":"fef2c0","default":true,"description":"Adding new functionality"}],"state":"closed","locked":false,"assignee":{"login":"KatieBuc","id":34525024,"node_id":"MDQ6VXNlcjM0NTI1MDI0","avatar_url":"https://avatars.githubusercontent.com/u/34525024?v=4","gravatar_id":"","url":"https://api.github.com/users/KatieBuc","html_url":"https://github.com/KatieBuc","followers_url":"https://api.github.com/users/KatieBuc/followers","following_url":"https://api.github.com/users/KatieBuc/following{/other_user}","gists_url":"https://api.github.com/users/KatieBuc/gists{/gist_id}","starred_url":"https://api.github.com/users/KatieBuc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KatieBuc/subscriptions","organizations_url":"https://api.github.com/users/KatieBuc/orgs","repos_url":"https://api.github.com/users/KatieBuc/repos","events_url":"https://api.github.com/users/KatieBuc/events{/privacy}","received_events_url":"https://api.github.com/users/KatieBuc/received_events","type":"User","site_admin":false},"assignees":[{"login":"KatieBuc","id":34525024,"node_id":"MDQ6VXNlcjM0NTI1MDI0","avatar_url":"https://avatars.githubusercontent.com/u/34525024?v=4","gravatar_id":"","url":"https://api.github.com/users/KatieBuc","html_url":"https://github.com/KatieBuc","followers_url":"https://api.github.com/users/KatieBuc/followers","following_url":"https://api.github.com/users/KatieBuc/following{/other_user}","gists_url":"https://api.github.com/users/KatieBuc/gists{/gist_id}","starred_url":"https://api.github.com/users/KatieBuc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KatieBuc/subscriptions","organizations_url":"https://api.github.com/users/KatieBuc/orgs","repos_url":"https://api.github.com/users/KatieBuc/repos","events_url":"https://api.github.com/users/KatieBuc/events{/privacy}","received_events_url":"https://api.github.com/users/KatieBuc/received_events","type":"User","site_admin":false}],"milestone":null,"comments":7,"created_at":"2022-09-09T04:23:41Z","updated_at":"2022-12-22T01:22:32Z","closed_at":"2022-12-22T01:22:32Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"### Details \r\nE-Agglo is a nonparametric method for performing hierarchical agglomerative estimation of multiple change points based on [1][2]. Neighboring segments are then sequentially merged to maximize a goodness-of-fit statistic. The goodness-of-fit statistic is the \"between-within distance\" [3] among adjacent segments i.e.\r\n\r\n![image](https://user-images.githubusercontent.com/34525024/189269160-707c101a-6344-456b-8571-048344348322.png)\r\n\r\nwhere || . || is the Euclidean norm. Which is the scaled sample measure of divergence below\r\n\r\n![image](https://user-images.githubusercontent.com/34525024/189269751-d45fa4e1-5278-48ba-b9f5-033cc9137051.png)\r\n\r\ni.e.\r\n``e(A, B) = mn/(m+n) * [minimum energy clustering]`` as evidenced in [4].\r\n\r\nNote that minimum energy clustering can be computed with `scipy.stats.energy_distance(...)` [5].\r\n\r\n#### References\r\n[1] Matteson, David S., and Nicholas A. James. \"A nonparametric approach for multiple change point analysis of multivariate data.\" Journal of the American Statistical Association 109.505 (2014): 334-345. URL: https://www.tandfonline.com/doi/full/10.1080/01621459.2013.849605\r\n[2] James, Nicholas A., and David S. Matteson. \"ecp: An R package for nonparametric multiple change point analysis of multivariate data.\" arXiv preprint arXiv:1309.3295 (2013). URL: https://arxiv.org/pdf/1309.3295.pdf\r\n[3] Szekely, Gabor J., and Maria L. Rizzo. \"Hierarchical clustering via joint between-within distances: Extending Ward's minimum variance method.\" Journal of classification 22.2 (2005): 151-184. URL: https://home.ipipan.waw.pl/j.mielniczuk/Szekely-Rizzo_2005.pdf\r\n[4] https://en.wikipedia.org/wiki/Hierarchical_clustering#cite_ref-7\r\n[5] https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.energy_distance.html\r\n\r\n\r\n## Option 1: Interface sklearn.cluster.AgglomerativeClustering\r\n\r\n[sklearn.cluster.AgglomerativeClustering](https://scikit-learn.org/stable/modules/generated/sklearn.cluster.AgglomerativeClustering.html#sklearn.cluster.AgglomerativeClustering) has parameters `linkage{‘ward’, ‘complete’, ‘average’, ‘single’}, default=’ward’`.\r\n\r\nWe need another linkage type not offered in this list. Therefore, this task involves writing another version of [ward_tree](https://github.com/scikit-learn/scikit-learn/blob/36958fb24/sklearn/cluster/_agglomerative.py#L169), with distnace between clusters `e(A,B)` from above instead of Ward's linkage defined as\r\n\r\n![image](https://user-images.githubusercontent.com/34525024/189270752-245a4dc8-4747-4d28-959f-94f565bd0ba1.png)\r\n(the visualisation of linkage parameters comes from [here](https://towardsdatascience.com/machine-learning-algorithms-part-12-hierarchical-agglomerative-clustering-example-in-python-1e18e0075019))\r\n\r\nand interfacing `AgglomerativeClustering(ClusterMixin, BaseEstimator)` with this extended functionality.\r\n\r\n### Dependencies\r\n\r\n- [ ] `scipy.cluster.hierarchy.ward(X)` s called, where\r\n![image](https://user-images.githubusercontent.com/34525024/189275455-a94e6ade-cd19-47a4-8948-7e31a596c10a.png)\r\n\r\nwhich is (almost) the same as the desired incremental metric from [2]:\r\n![image](https://user-images.githubusercontent.com/34525024/189278041-e2f4b226-fc38-4cd1-affa-37090de43bd9.png)\r\n\r\n\r\n- [ ] `ward_dist` relies on c++ ` _hierarchical.compute_ward_dist` - can this be fully replaced with the scipy function? [5]\r\n- [ ] `ward_dist` relies on c++  `_hierarchical._get_parents` - can this be called?\r\n\r\n\r\n## Option 2: rewrite R code as stand alone\r\n\r\nThe R code is: https://github.com/cran/ecp/blob/master/R/e_agglomerative.R\r\n\r\n- [x] getWithin, getBetween are C functions that need to be re-written\r\nhttps://github.com/cran/ecp/blob/master/src/energyChangePoint.cpp\r\n\r\nbut maybe they can be replaced by `scipy.stats.energy_distance(...)` [5] - wouldn't take too long to verify.\r\n\r\n\r\n","closed_by":{"login":"fkiraly","id":7985502,"node_id":"MDQ6VXNlcjc5ODU1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7985502?v=4","gravatar_id":"","url":"https://api.github.com/users/fkiraly","html_url":"https://github.com/fkiraly","followers_url":"https://api.github.com/users/fkiraly/followers","following_url":"https://api.github.com/users/fkiraly/following{/other_user}","gists_url":"https://api.github.com/users/fkiraly/gists{/gist_id}","starred_url":"https://api.github.com/users/fkiraly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkiraly/subscriptions","organizations_url":"https://api.github.com/users/fkiraly/orgs","repos_url":"https://api.github.com/users/fkiraly/repos","events_url":"https://api.github.com/users/fkiraly/events{/privacy}","received_events_url":"https://api.github.com/users/fkiraly/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/3397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/3397/timeline","performed_via_github_app":null,"state_reason":"completed"}