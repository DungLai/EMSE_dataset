{"url":"https://api.github.com/repos/sktime/sktime/issues/413","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/413/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/413/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/413/events","html_url":"https://github.com/sktime/sktime/issues/413","id":713973966,"node_id":"MDU6SXNzdWU3MTM5NzM5NjY=","number":413,"title":"[BUG] KNN with DTW","user":{"login":"manu-torres","id":56218303,"node_id":"MDQ6VXNlcjU2MjE4MzAz","avatar_url":"https://avatars.githubusercontent.com/u/56218303?v=4","gravatar_id":"","url":"https://api.github.com/users/manu-torres","html_url":"https://github.com/manu-torres","followers_url":"https://api.github.com/users/manu-torres/followers","following_url":"https://api.github.com/users/manu-torres/following{/other_user}","gists_url":"https://api.github.com/users/manu-torres/gists{/gist_id}","starred_url":"https://api.github.com/users/manu-torres/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manu-torres/subscriptions","organizations_url":"https://api.github.com/users/manu-torres/orgs","repos_url":"https://api.github.com/users/manu-torres/repos","events_url":"https://api.github.com/users/manu-torres/events{/privacy}","received_events_url":"https://api.github.com/users/manu-torres/received_events","type":"User","site_admin":false},"labels":[{"id":1118163262,"node_id":"MDU6TGFiZWwxMTE4MTYzMjYy","url":"https://api.github.com/repos/sktime/sktime/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":14,"created_at":"2020-10-03T01:11:22Z","updated_at":"2021-01-06T15:24:10Z","closed_at":"2021-01-06T15:24:09Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\n\r\nKNeighborsClassifier(n_neighbors = 1, metric = \"euclidean\")) always gives exactly the same result than KNeighborsTimeSeriesClassifier(n_neighbors = 1, metric = \"dtw\")\r\n\r\n**To Reproduce**\r\n\r\nGo to the example jupyter notebook 02_classification_univariate, section \"K-nearest-neighbours classifier for time series\". \r\n\r\nThe last two code cells before the \"Other clasiffiers\" section show the difference between using regular euclidean distance and dynamic time warping for a K Neighbors Classifier. When executing those two cells both models always give the same score. The results only change when repeating the train test split, but both models still have the same score with the same samples.\r\n\r\n```python\r\nimport numpy as np\r\nfrom sklearn.model_selection import train_test_split\r\nfrom sklearn.metrics import classification_report\r\nfrom sktime.datasets import load_basic_motions\r\nfrom sklearn.pipeline import make_pipeline\r\nfrom sktime.transformers.series_as_features.reduce import Tabularizer\r\nX, y = load_basic_motions(return_X_y = True)\r\nx_train, x_test, y_train, y_test = train_test_split(X.iloc[:, [0]], y)\r\n\r\n#sklearn version\r\nfrom sklearn.neighbors import KNeighborsClassifier\r\n\r\nknn = make_pipeline(\r\n        Tabularizer(),\r\n        KNeighborsClassifier(n_neighbors = 1,\r\n                             metric = \"euclidean\"))\r\n\r\nknn.fit(x_train, y_train)\r\nprint(\"sklearn model performance (euclidean distance): \" + str(knn.score(x_test, y_test)))\r\nprint(classification_report(y_test, knn.predict(x_test)))\r\n\r\n#sktime adaptation (with the metric changed)\r\nfrom sktime.classification.distance_based import KNeighborsTimeSeriesClassifier\r\n\r\nknn = KNeighborsTimeSeriesClassifier(n_neighbors = 1,\r\n                           metric = \"dtw\")\r\n\r\nknn.fit(x_train, y_train)\r\nprint(\"sktime model performance (with dynamic time warping): \" + str(knn.score(x_test, y_test)))\r\nprint(classification_report(y_test, knn.predict(x_test)))\r\n```\r\n\r\n**Expected behavior**\r\n\r\nThe sktime version with dwt should have better performance, or at least not exactly the same.\r\n\r\n\r\n**Additional context**\r\n\r\nI was following the tutorial at PyData Amsterdam 2020 and all the output from my local installation mirrored the one in the video. However, those two cells of code had a strange behaviour. In the video it seemed that the sklearn classifier had a score of 0.65 while the sktime implementation had a 1. Of course different results are to be expected when running the code since there is randomness involved, but it is still odd.\r\n\r\nI thought I just made a mistake somewhere while copying the code, or maybe there was a problem with my installation (version 0.4.1), so I went to the notebook hosted on Binder and saw the same behaviour there.\r\n\r\n\r\n**Versions**\r\n<details>\r\n\r\nLocal installation version of sktime: 0.4.1\r\n\r\nAlso experienced the issue on the Binder notebook, with version 0.4.2\r\n\r\n</details>\r\n\r\n<!-- Thanks for contributing! -->\r\n","closed_by":{"login":"TonyBagnall","id":9594042,"node_id":"MDQ6VXNlcjk1OTQwNDI=","avatar_url":"https://avatars.githubusercontent.com/u/9594042?v=4","gravatar_id":"","url":"https://api.github.com/users/TonyBagnall","html_url":"https://github.com/TonyBagnall","followers_url":"https://api.github.com/users/TonyBagnall/followers","following_url":"https://api.github.com/users/TonyBagnall/following{/other_user}","gists_url":"https://api.github.com/users/TonyBagnall/gists{/gist_id}","starred_url":"https://api.github.com/users/TonyBagnall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TonyBagnall/subscriptions","organizations_url":"https://api.github.com/users/TonyBagnall/orgs","repos_url":"https://api.github.com/users/TonyBagnall/repos","events_url":"https://api.github.com/users/TonyBagnall/events{/privacy}","received_events_url":"https://api.github.com/users/TonyBagnall/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/413/timeline","performed_via_github_app":null,"state_reason":"completed"}