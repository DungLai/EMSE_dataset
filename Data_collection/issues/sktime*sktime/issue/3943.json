{"url":"https://api.github.com/repos/sktime/sktime/issues/3943","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/3943/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/3943/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/3943/events","html_url":"https://github.com/sktime/sktime/issues/3943","id":1499398602,"node_id":"I_kwDOCVKAsc5ZXwHK","number":3943,"title":"[ENH] CRPS and skill score for `predict_proba()` outputs - prototype","user":{"login":"chillerobscuro","id":5232872,"node_id":"MDQ6VXNlcjUyMzI4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/5232872?v=4","gravatar_id":"","url":"https://api.github.com/users/chillerobscuro","html_url":"https://github.com/chillerobscuro","followers_url":"https://api.github.com/users/chillerobscuro/followers","following_url":"https://api.github.com/users/chillerobscuro/following{/other_user}","gists_url":"https://api.github.com/users/chillerobscuro/gists{/gist_id}","starred_url":"https://api.github.com/users/chillerobscuro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chillerobscuro/subscriptions","organizations_url":"https://api.github.com/users/chillerobscuro/orgs","repos_url":"https://api.github.com/users/chillerobscuro/repos","events_url":"https://api.github.com/users/chillerobscuro/events{/privacy}","received_events_url":"https://api.github.com/users/chillerobscuro/received_events","type":"User","site_admin":false},"labels":[{"id":3796180314,"node_id":"LA_kwDOCVKAsc7iRR1a","url":"https://api.github.com/repos/sktime/sktime/labels/enhancement","name":"enhancement","color":"fef2c0","default":true,"description":"Adding new functionality"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-12-16T01:05:11Z","updated_at":"2022-12-16T01:05:11Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"We have a metric to calculate Pinball Loss, which scores quantile forecasts. Adding a [Continuous Ranked Probability Score](https://otexts.com/fpp3/distaccuracy.html#continuous-ranked-probability-score) would allow us to score distributional forecasts, ie the outputs of `predict_proba()`. To compare multiple probabilistic models we can also add a \"skill score\" which compares probabilistic predictions in a scale free way.\r\n\r\nUsing the `properscoring` library  we can compute both these metrics, starting with the Gaussian case although `properscoring` has a `quadriture` function that allows scoring of non-parametric distributions.  I wrote up some code that works with `sktime` style outputs, the following shows the logic for the Normal case:\r\n\r\n```\r\nimport properscoring as ps\r\nfirst_model_proba = forecaster_one.predict_proba()\r\nsecond_model_proba = forecaster_two.predict_proba()\r\n\r\ndef crps(obs, preds):\r\n    locs, scales = preds.loc, preds.scale\r\n    scores = ps.crps_gaussian(obs, mu=locs, sig=scales)\r\n    return np.diag(scores).mean()\r\n\r\ndef skill_score(targets, model_1_preds, model_2_preds):\r\n    # If score is positive, model_2 is better\r\n    baseline_score = crps(targets, model_1_preds)\r\n    compare_score = crps(targets, model_2_preds)\r\n    return (baseline_score - compare_score) / baseline_score\r\n\r\ncrps_score = crps(ytest, first_model_proba)\r\nskill = skill_score(ytest, first_model_proba, second_model_proba)\r\n```\r\n\r\nCould be a good first issue for anyone interested, otherwise I will likely get to it in the coming weeks.","closed_by":null,"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/3943/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/3943/timeline","performed_via_github_app":null,"state_reason":null}