{"url":"https://api.github.com/repos/sktime/sktime/issues/2133","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/2133/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/2133/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/2133/events","html_url":"https://github.com/sktime/sktime/issues/2133","id":1149214130,"node_id":"I_kwDOCVKAsc5Ef52y","number":2133,"title":"ROCKET transformer RAM consumption","user":{"login":"RafaAyGar","id":37343008,"node_id":"MDQ6VXNlcjM3MzQzMDA4","avatar_url":"https://avatars.githubusercontent.com/u/37343008?v=4","gravatar_id":"","url":"https://api.github.com/users/RafaAyGar","html_url":"https://github.com/RafaAyGar","followers_url":"https://api.github.com/users/RafaAyGar/followers","following_url":"https://api.github.com/users/RafaAyGar/following{/other_user}","gists_url":"https://api.github.com/users/RafaAyGar/gists{/gist_id}","starred_url":"https://api.github.com/users/RafaAyGar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RafaAyGar/subscriptions","organizations_url":"https://api.github.com/users/RafaAyGar/orgs","repos_url":"https://api.github.com/users/RafaAyGar/repos","events_url":"https://api.github.com/users/RafaAyGar/events{/privacy}","received_events_url":"https://api.github.com/users/RafaAyGar/received_events","type":"User","site_admin":false},"labels":[{"id":3796180314,"node_id":"LA_kwDOCVKAsc7iRR1a","url":"https://api.github.com/repos/sktime/sktime/labels/enhancement","name":"enhancement","color":"fef2c0","default":true,"description":"Adding new functionality"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-02-24T12:12:35Z","updated_at":"2022-03-01T15:39:37Z","closed_at":"2022-03-01T15:39:37Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"### **Problem Description**\r\n- ROCKET transformer _apply_kernels function create a dataframe of shape (n_data_instances x n_kernels*2). Leaving the number of kernels as default (=10000) and working with a dataset of 15000 instances, it results in a 300 million cells dataframe which takes around 1.8 GB of RAM. In the same way, for a data of 44k instances it goes over 8 GB of RAM consumption. If we extrapolate this 2 last results for a dataframe of 1 million instances it can consume over 120 GB.\r\n\r\n### **Solution**\r\n- The datatype of the dataframe cells is set to float64, we changed it to float32 halving the RAM consumption exposed above.\r\n\r\n### **Checking Experiments**\r\n- We tested both versions of ROCKET transformer (with float 64 and float 32) over the same data to check that model output is not changed, obtaining the exact same results but with the RAM consumption half reduced.\r\n- Used datasets (not stratified or resampled):\r\n- - DistalPhalanxOutlineAgeGroup\r\n- - DistalPhalanxTW\r\n- - EthanolLevel\r\n- - MiddlePhalanxOutlineAgeGroup\r\n- - MiddlePhalanxTW\r\n- - ProximalPhalanxOutlineAgeGroup\r\n- - ProximalPhalanxTW\r\n-  Each dataset was tested with 2 Rockets classifiers, one with the random state set to 0, and the other to 1.\r\n- RAM consumption were measured with memory_profiler python module, checking the increment produced on the fit_predict function of the classifiers (that is where ROCKET transformer is executed)\r\n\r\n### **Results obtained**\r\n- ROCKET transformer version with float 64:\r\n- - Execution RAM: 79.2 MB\r\n- - **Mean Accuracy Measure of Datasets for the 2 RocketClassifier runs:**\r\n- - - DistalPhalanxOutlineAgeGroup: 0.758993\r\n- - - DistalPhalanxTW: 0.705036\r\n- - - EthanolLevel: 0.594000\r\n- - - MiddlePhalanxOutlineAgeGroup: 0.558442\r\n- - - MiddlePhalanxTW: 0.538961\r\n- - - ProximalPhalanxOutlineAgeGroup: 0.858537\r\n- - - ProximalPhalanxTW: 0.797561\r\n- ROCKET transformer version with float 32:\r\n- - Execution RAM: 47.3 MB \r\n- - **Mean Accuracy Measure of Datasets for the 2 RocketClassifier runs:**\r\n- - - DistalPhalanxOutlineAgeGroup: 0.758993\r\n- - - DistalPhalanxTW: 0.705036\r\n- - - EthanolLevel: 0.594000\r\n- - - MiddlePhalanxOutlineAgeGroup: 0.558442\r\n- - - MiddlePhalanxTW: 0.538961\r\n- - - ProximalPhalanxOutlineAgeGroup: 0.858537\r\n- - - ProximalPhalanxTW: 0.797561\r\n\r\n## Participants:\r\n- RafaAyGar\r\n- @dguijo ","closed_by":{"login":"TonyBagnall","id":9594042,"node_id":"MDQ6VXNlcjk1OTQwNDI=","avatar_url":"https://avatars.githubusercontent.com/u/9594042?v=4","gravatar_id":"","url":"https://api.github.com/users/TonyBagnall","html_url":"https://github.com/TonyBagnall","followers_url":"https://api.github.com/users/TonyBagnall/followers","following_url":"https://api.github.com/users/TonyBagnall/following{/other_user}","gists_url":"https://api.github.com/users/TonyBagnall/gists{/gist_id}","starred_url":"https://api.github.com/users/TonyBagnall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TonyBagnall/subscriptions","organizations_url":"https://api.github.com/users/TonyBagnall/orgs","repos_url":"https://api.github.com/users/TonyBagnall/repos","events_url":"https://api.github.com/users/TonyBagnall/events{/privacy}","received_events_url":"https://api.github.com/users/TonyBagnall/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/2133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/2133/timeline","performed_via_github_app":null,"state_reason":"completed"}