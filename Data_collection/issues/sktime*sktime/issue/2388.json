{"url":"https://api.github.com/repos/sktime/sktime/issues/2388","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/2388/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/2388/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/2388/events","html_url":"https://github.com/sktime/sktime/issues/2388","id":1191516502,"node_id":"I_kwDOCVKAsc5HBRlW","number":2388,"title":"Add `random_state` to `statsmodel` adapter","user":{"login":"ngupta23","id":33585645,"node_id":"MDQ6VXNlcjMzNTg1NjQ1","avatar_url":"https://avatars.githubusercontent.com/u/33585645?v=4","gravatar_id":"","url":"https://api.github.com/users/ngupta23","html_url":"https://github.com/ngupta23","followers_url":"https://api.github.com/users/ngupta23/followers","following_url":"https://api.github.com/users/ngupta23/following{/other_user}","gists_url":"https://api.github.com/users/ngupta23/gists{/gist_id}","starred_url":"https://api.github.com/users/ngupta23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ngupta23/subscriptions","organizations_url":"https://api.github.com/users/ngupta23/orgs","repos_url":"https://api.github.com/users/ngupta23/repos","events_url":"https://api.github.com/users/ngupta23/events{/privacy}","received_events_url":"https://api.github.com/users/ngupta23/received_events","type":"User","site_admin":false},"labels":[{"id":1118163266,"node_id":"MDU6TGFiZWwxMTE4MTYzMjY2","url":"https://api.github.com/repos/sktime/sktime/labels/good%20first%20issue","name":"good first issue","color":"9eff91","default":true,"description":"Good for newcomers"},{"id":3105906374,"node_id":"MDU6TGFiZWwzMTA1OTA2Mzc0","url":"https://api.github.com/repos/sktime/sktime/labels/module:forecasting","name":"module:forecasting","color":"35FCCE","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2022-04-04T09:36:37Z","updated_at":"2022-04-07T15:45:37Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Requesting the addition of a `random_state` argument to the `statsmodels` adapter and passing it appropriately to underlying non-deterministic models such as ETS so that the predictions can be made reproducible. Currently, multiple runs result in different interval results for the same quantiles.\r\n\r\nMore on this below:\r\n\r\n------------------------------\r\n\r\n> Many statsmodels models are non-deterministic, e.g., as they do some random sampling inside, especially when it comes to estimating variation. Having some intrinsic randomness there is not unusual and expected.\r\n\r\n@fkiraly You are right, it looks like in this case, the intervals are based on simulations and those simulations are not exact or repeatable. This model has multiplicative components and hence exact method is not available\r\n\r\nhttps://www.statsmodels.org/stable/_modules/statsmodels/tsa/exponential_smoothing/ets.html\r\n\r\n```python\r\nif method is None:\r\n    exact_available = [\"ANN\", \"AAN\", \"AAdN\", \"ANA\", \"AAA\", \"AAdA\"]\r\n    if results.model.short_name in exact_available:\r\n        method = \"exact\"\r\n    else:\r\n        method = \"simulated\"\r\nself.method = method\r\n```\r\n\r\nHowever, they can be made repeatable by passing a `random_state` inside the sktime ets.py `_predict_interval` method. What do you think - maybe open an enhancement request for this?  \r\n\r\n```python\r\ndef _predict_interval(self, fh, X=None, coverage=None):\r\n    valid_indices = fh.to_absolute(self.cutoff).to_pandas()\r\n\r\n   start, end = valid_indices[[0, -1]]\r\n   # Maybe add random_state in get_predictions (and accept random_state in the AutoETS initialization)?\r\n   # https://www.statsmodels.org/stable/_modules/statsmodels/tsa/exponential_smoothing/ets.html\r\n   prediction_results = self._fitted_forecaster.get_prediction(\r\n       start=start, end=end\r\n   )\r\n```\r\n\r\n_Originally posted by @ngupta23 in https://github.com/alan-turing-institute/sktime/issues/2320#issuecomment-1080029680_","closed_by":null,"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/2388/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/2388/timeline","performed_via_github_app":null,"state_reason":null}