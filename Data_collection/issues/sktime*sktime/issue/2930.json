{"url":"https://api.github.com/repos/sktime/sktime/issues/2930","repository_url":"https://api.github.com/repos/sktime/sktime","labels_url":"https://api.github.com/repos/sktime/sktime/issues/2930/labels{/name}","comments_url":"https://api.github.com/repos/sktime/sktime/issues/2930/comments","events_url":"https://api.github.com/repos/sktime/sktime/issues/2930/events","html_url":"https://github.com/sktime/sktime/issues/2930","id":1294306038,"node_id":"I_kwDOCVKAsc5NJYr2","number":2930,"title":"[BUG] FeatureSelection on pd-multiindex with panel data - 'FeatureSelection' object has no attribute 'feature_importances_'","user":{"login":"CelieDs","id":66422896,"node_id":"MDQ6VXNlcjY2NDIyODk2","avatar_url":"https://avatars.githubusercontent.com/u/66422896?v=4","gravatar_id":"","url":"https://api.github.com/users/CelieDs","html_url":"https://github.com/CelieDs","followers_url":"https://api.github.com/users/CelieDs/followers","following_url":"https://api.github.com/users/CelieDs/following{/other_user}","gists_url":"https://api.github.com/users/CelieDs/gists{/gist_id}","starred_url":"https://api.github.com/users/CelieDs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CelieDs/subscriptions","organizations_url":"https://api.github.com/users/CelieDs/orgs","repos_url":"https://api.github.com/users/CelieDs/repos","events_url":"https://api.github.com/users/CelieDs/events{/privacy}","received_events_url":"https://api.github.com/users/CelieDs/received_events","type":"User","site_admin":false},"labels":[{"id":1118163262,"node_id":"MDU6TGFiZWwxMTE4MTYzMjYy","url":"https://api.github.com/repos/sktime/sktime/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":3105907331,"node_id":"MDU6TGFiZWwzMTA1OTA3MzMx","url":"https://api.github.com/repos/sktime/sktime/labels/module:transformations","name":"module:transformations","color":"0865AF","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-07-05T13:29:54Z","updated_at":"2022-10-04T22:15:07Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nNo attribute defined for 'FeatureSelection' object \r\n\r\n```python\r\ngetattr(transformer, 'feature_importances_')\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\nInput In [2], in <cell line: 1>()\r\n----> 1 getattr(transformer, 'feature_importances_')\r\n\r\nAttributeError: 'FeatureSelection' object has no attribute 'feature_importances_'\r\n```\r\n\r\n**To Reproduce**\r\n\r\n\r\n```python\r\nfrom sktime.datatypes import get_examples\r\nfrom sktime.transformations.series.feature_selection import FeatureSelection\r\n\r\nX = get_examples(\"pd-multiindex\")[0]\r\ny = get_examples(\"pd-multiindex\")[1]\r\n\r\ntransformer = FeatureSelection(method=\"feature-importances\", n_columns = 20)\r\ntransformer.fit_transform(X, y) \r\n\r\ngetattr(transformer, 'feature_importances_')\r\n```\r\n\r\n**Expected behavior**\r\n\r\nDisplay the numerical values of importance for each feature in a dict or None\r\n\r\n**Additional context**\r\nThis error might be the result of a warning that appears when running the FeatureSelection function on panel data:\r\n\r\n```python\r\n DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\r\n  y = column_or_1d(y, warn=True)\r\n```\r\nWhen trying to solve this warning using the following code : \r\n\r\n```python\r\nfrom sktime.datatypes import get_examples\r\nfrom sktime.transformations.series.feature_selection import FeatureSelection\r\n\r\nX = get_examples(\"pd-multiindex\")[0]\r\ny = get_examples(\"pd-multiindex\")[1]\r\n\r\ntransformer = FeatureSelection(method=\"feature-importances\", n_columns = 20)\r\ntransformer.fit_transform(X, y.values.ravel())  \r\n```\r\n\r\nThis error message appears:\r\n\r\n```python\r\nTypeError                                 Traceback (most recent call last)\r\nInput In [6], in <cell line: 8>()\r\n      5 y = get_examples(\"pd-multiindex\")[1]\r\n      7 transformer = FeatureSelection(method=\"feature-importances\", n_columns = 20)\r\n----> 8 transformer.fit_transform(X, y.values.ravel())\r\n\r\nFile ~\\Miniconda3\\lib\\site-packages\\sktime\\transformations\\base.py:452, in BaseTransformer.fit_transform(self, X, y)\r\n    398 \"\"\"Fit to data, then transform it.\r\n    399 \r\n    400 Fits the transformer to X and y and returns a transformed version of X.\r\n   (...)\r\n    448         Example: i-th instance of the output is the i-th window running over `X`\r\n    449 \"\"\"\r\n    450 # Non-optimized default implementation; override when a better\r\n    451 # method is possible for a given algorithm.\r\n--> 452 return self.fit(X, y).transform(X, y)\r\n\r\nFile ~\\Miniconda3\\lib\\site-packages\\sktime\\transformations\\base.py:311, in BaseTransformer.fit(self, X, y)\r\n    308     raise ValueError(f\"{self.__class__.__name__} requires `y` in `fit`.\")\r\n    310 # check and convert X/y\r\n--> 311 X_inner, y_inner = self._check_X_y(X=X, y=y)\r\n    313 # checks and conversions complete, pass to inner fit\r\n    314 #####################################################\r\n    315 vectorization_needed = isinstance(X_inner, VectorizedDF)\r\n\r\nFile ~\\Miniconda3\\lib\\site-packages\\sktime\\transformations\\base.py:717, in BaseTransformer._check_X_y(self, X, y, return_metadata)\r\n    713     y_valid, _, y_metadata = check_is_scitype(\r\n    714         y, scitype=y_possible_scitypes, return_metadata=True, var_name=\"y\"\r\n    715     )\r\n    716     if not y_valid:\r\n--> 717         raise TypeError(\"y \" + msg_invalid_input)\r\n    719     y_scitype = y_metadata[\"scitype\"]\r\n    721 else:\r\n    722     # y_scitype is used below - set to None if y is None\r\n\r\nTypeError: y must be in an sktime compatible format, of scitype Series, Panel or Hierarchical, for instance a pandas.DataFrame with sktime compatible time indices, or with MultiIndex and last(-1) level an sktime compatible time index. Allowed compatible mtype format specifications are: ['pd.Series', 'pd.DataFrame', 'np.ndarray', 'nested_univ', 'numpy3D', 'pd-multiindex', 'df-list', 'pd_multiindex_hier'] See the data format tutorial examples/AA_datatypes_and_datasets.ipynb, If you think the data is already in an sktime supported input format, run sktime.datatypes.check_raise(data, mtype) to diagnose the error, where mtype is the string of the type specification you want. \r\n```\r\n\r\n**Versions**\r\n<details>\r\n\r\nSystem:\r\n    python: 3.9.7 (default, Sep 16 2021, 16:59:28) [MSC v.1916 64 bit (AMD64)]\r\nexecutable: C:\\Users\\celie\\Miniconda3\\python.exe\r\n   machine: Windows-10-10.0.19044-SP0\r\n\r\nPython dependencies:\r\n          pip: 21.2.4\r\n   setuptools: 61.2.0\r\n      sklearn: 1.0.2\r\n       sktime: 0.12.1\r\n  statsmodels: 0.13.2\r\n        numpy: 1.21.0\r\n        scipy: 1.7.3\r\n       pandas: 1.4.2\r\n   matplotlib: 3.5.2\r\n       joblib: 1.1.0\r\n        numba: 0.55.1\r\n     pmdarima: None\r\n      tsfresh: 0.19.0\r\n\r\n\r\n</details>\r\n\r\nThank you in advance for your reply !\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/2930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sktime/sktime/issues/2930/timeline","performed_via_github_app":null,"state_reason":null}