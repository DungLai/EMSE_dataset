[{"id":7828989571,"node_id":"LE_lADOCVKAsc5Wkuj5zwAAAAHSpOaD","url":"https://api.github.com/repos/sktime/sktime/issues/events/7828989571","actor":{"login":"nyk2001","id":3079053,"node_id":"MDQ6VXNlcjMwNzkwNTM=","avatar_url":"https://avatars.githubusercontent.com/u/3079053?v=4","gravatar_id":"","url":"https://api.github.com/users/nyk2001","html_url":"https://github.com/nyk2001","followers_url":"https://api.github.com/users/nyk2001/followers","following_url":"https://api.github.com/users/nyk2001/following{/other_user}","gists_url":"https://api.github.com/users/nyk2001/gists{/gist_id}","starred_url":"https://api.github.com/users/nyk2001/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nyk2001/subscriptions","organizations_url":"https://api.github.com/users/nyk2001/orgs","repos_url":"https://api.github.com/users/nyk2001/repos","events_url":"https://api.github.com/users/nyk2001/events{/privacy}","received_events_url":"https://api.github.com/users/nyk2001/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-11-17T00:00:04Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"id":7832826182,"node_id":"LE_lADOCVKAsc5Wkuj5zwAAAAHS33FG","url":"https://api.github.com/repos/sktime/sktime/issues/events/7832826182","actor":{"login":"MatthewMiddlehurst","id":25731235,"node_id":"MDQ6VXNlcjI1NzMxMjM1","avatar_url":"https://avatars.githubusercontent.com/u/25731235?v=4","gravatar_id":"","url":"https://api.github.com/users/MatthewMiddlehurst","html_url":"https://github.com/MatthewMiddlehurst","followers_url":"https://api.github.com/users/MatthewMiddlehurst/followers","following_url":"https://api.github.com/users/MatthewMiddlehurst/following{/other_user}","gists_url":"https://api.github.com/users/MatthewMiddlehurst/gists{/gist_id}","starred_url":"https://api.github.com/users/MatthewMiddlehurst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MatthewMiddlehurst/subscriptions","organizations_url":"https://api.github.com/users/MatthewMiddlehurst/orgs","repos_url":"https://api.github.com/users/MatthewMiddlehurst/repos","events_url":"https://api.github.com/users/MatthewMiddlehurst/events{/privacy}","received_events_url":"https://api.github.com/users/MatthewMiddlehurst/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-11-17T11:15:16Z","label":{"name":"module:forecasting","color":"35FCCE"},"performed_via_github_app":null},{"id":7837594448,"node_id":"RTE_lADOCVKAsc5Wkuj5zwAAAAHTKDNQ","url":"https://api.github.com/repos/sktime/sktime/issues/events/7837594448","actor":{"login":"TonyBagnall","id":9594042,"node_id":"MDQ6VXNlcjk1OTQwNDI=","avatar_url":"https://avatars.githubusercontent.com/u/9594042?v=4","gravatar_id":"","url":"https://api.github.com/users/TonyBagnall","html_url":"https://github.com/TonyBagnall","followers_url":"https://api.github.com/users/TonyBagnall/followers","following_url":"https://api.github.com/users/TonyBagnall/following{/other_user}","gists_url":"https://api.github.com/users/TonyBagnall/gists{/gist_id}","starred_url":"https://api.github.com/users/TonyBagnall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TonyBagnall/subscriptions","organizations_url":"https://api.github.com/users/TonyBagnall/orgs","repos_url":"https://api.github.com/users/TonyBagnall/repos","events_url":"https://api.github.com/users/TonyBagnall/events{/privacy}","received_events_url":"https://api.github.com/users/TonyBagnall/received_events","type":"User","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2022-11-17T20:33:11Z","rename":{"from":"error prediction with global model  [BUG]","to":"[BUG] error prediction with global model  "},"performed_via_github_app":null},{"url":"https://api.github.com/repos/sktime/sktime/issues/comments/1319672045","html_url":"https://github.com/sktime/sktime/issues/3803#issuecomment-1319672045","issue_url":"https://api.github.com/repos/sktime/sktime/issues/3803","id":1319672045,"node_id":"IC_kwDOCVKAsc5OqJjt","user":{"login":"fkiraly","id":7985502,"node_id":"MDQ6VXNlcjc5ODU1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7985502?v=4","gravatar_id":"","url":"https://api.github.com/users/fkiraly","html_url":"https://github.com/fkiraly","followers_url":"https://api.github.com/users/fkiraly/followers","following_url":"https://api.github.com/users/fkiraly/following{/other_user}","gists_url":"https://api.github.com/users/fkiraly/gists{/gist_id}","starred_url":"https://api.github.com/users/fkiraly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkiraly/subscriptions","organizations_url":"https://api.github.com/users/fkiraly/orgs","repos_url":"https://api.github.com/users/fkiraly/repos","events_url":"https://api.github.com/users/fkiraly/events{/privacy}","received_events_url":"https://api.github.com/users/fkiraly/received_events","type":"User","site_admin":false},"created_at":"2022-11-18T08:07:27Z","updated_at":"2022-11-18T08:07:27Z","author_association":"COLLABORATOR","body":"can you provide us with your code, full imports, and optimally using dummy data from `sktime`?\r\n\r\nPlease also spell out your package versions, instructions are in the bug report template.","reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/comments/1319672045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fkiraly","id":7985502,"node_id":"MDQ6VXNlcjc5ODU1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7985502?v=4","gravatar_id":"","url":"https://api.github.com/users/fkiraly","html_url":"https://github.com/fkiraly","followers_url":"https://api.github.com/users/fkiraly/followers","following_url":"https://api.github.com/users/fkiraly/following{/other_user}","gists_url":"https://api.github.com/users/fkiraly/gists{/gist_id}","starred_url":"https://api.github.com/users/fkiraly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkiraly/subscriptions","organizations_url":"https://api.github.com/users/fkiraly/orgs","repos_url":"https://api.github.com/users/fkiraly/repos","events_url":"https://api.github.com/users/fkiraly/events{/privacy}","received_events_url":"https://api.github.com/users/fkiraly/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/sktime/sktime/issues/comments/1321918809","html_url":"https://github.com/sktime/sktime/issues/3803#issuecomment-1321918809","issue_url":"https://api.github.com/repos/sktime/sktime/issues/3803","id":1321918809,"node_id":"IC_kwDOCVKAsc5OyuFZ","user":{"login":"nyk2001","id":3079053,"node_id":"MDQ6VXNlcjMwNzkwNTM=","avatar_url":"https://avatars.githubusercontent.com/u/3079053?v=4","gravatar_id":"","url":"https://api.github.com/users/nyk2001","html_url":"https://github.com/nyk2001","followers_url":"https://api.github.com/users/nyk2001/followers","following_url":"https://api.github.com/users/nyk2001/following{/other_user}","gists_url":"https://api.github.com/users/nyk2001/gists{/gist_id}","starred_url":"https://api.github.com/users/nyk2001/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nyk2001/subscriptions","organizations_url":"https://api.github.com/users/nyk2001/orgs","repos_url":"https://api.github.com/users/nyk2001/repos","events_url":"https://api.github.com/users/nyk2001/events{/privacy}","received_events_url":"https://api.github.com/users/nyk2001/received_events","type":"User","site_admin":false},"created_at":"2022-11-21T11:34:53Z","updated_at":"2022-11-21T11:40:25Z","author_association":"NONE","body":"Hi @fkiraly , \r\n\r\nThe versions of libraries are as follows:\r\n\r\n![image](https://user-images.githubusercontent.com/3079053/203039820-47159ad7-8339-4725-9e6e-ab9aa94605bd.png)\r\n\r\n![image](https://user-images.githubusercontent.com/3079053/203039936-8409e3a1-4133-4f17-b733-8276c1c91913.png)\r\n\r\nThe dummy data is taken from the following Kaggle competition:\r\nhttps://www.kaggle.com/competitions/demand-forecasting-kernels-only/data\r\n\r\nI am using Azure Databricks to train the model. First, I split data into test and train. And, then I generate hierarchical data frame:\r\n\r\n![image](https://user-images.githubusercontent.com/3079053/203042342-8a6c02a6-844e-420b-af90-6297b7076677.png)\r\n\r\nI convert PySpark dataframe to Pandas dataframe before calling the Sktime function. The code to train the model is as follows:\r\n\r\n`\r\nimport lightgbm as lgb\r\nimport statsmodels.api as sm\r\nimport pandas as pd\r\nfrom sktime.forecasting.model_selection import temporal_train_test_split\r\nfrom sktime.transformations.series.detrend import Deseasonalizer, Detrender\r\nfrom sktime.forecasting.trend import PolynomialTrendForecaster\r\nfrom sktime.forecasting.compose import TransformedTargetForecaster, make_reduction\r\nfrom sklearn.pipeline import make_pipeline\r\nfrom sktime.forecasting.compose import ForecastingPipeline, make_reduction\r\n\r\ndef get_transformed_target_forecaster(alpha):\r\n    params ={'n_estimators': 3000,\r\n        'max_depth': 16,\r\n        'num_leaves': 2**4,\r\n        'learning_rate': 0.01,\r\n        'boosting_type': 'dart',\r\n        'objective':'quantile'}\r\n\r\n    #Initialize Light GBM Regressor   \r\n    regressor = lgb.LGBMRegressor(alpha=alpha, **params)\r\n    \r\n#-----------------------Forecaster Pipeline-----------------\r\n    \r\n  \r\n    pipe = ForecastingPipeline(\r\n        steps=[\r\n            (\"deseasonalise\", Deseasonalizer(model=\"additive\", sp=12)),\r\n            (\"detrend\", Detrender(forecaster=PolynomialTrendForecaster(degree=1))),\r\n             (\"forecast\", make_reduction(estimator=regressor, strategy=\"recursive\", pooling='global'))\r\n            ]\r\n        )\r\n\r\n    \r\n    return pipe\r\n\r\nforecaster = get_transformed_target_forecaster(0.9)\r\nforecaster_model = forecaster.fit(y_train.to_pandas(), X_train.to_pandas())\r\n`\r\n\r\n\r\nThe model trains but I cannot make predictions. On the other hand, if I just replace forecaster with Prophet then everything works fine. \r\n\r\nPlease let me know if you need more information. \r\n","reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/comments/1321918809/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nyk2001","id":3079053,"node_id":"MDQ6VXNlcjMwNzkwNTM=","avatar_url":"https://avatars.githubusercontent.com/u/3079053?v=4","gravatar_id":"","url":"https://api.github.com/users/nyk2001","html_url":"https://github.com/nyk2001","followers_url":"https://api.github.com/users/nyk2001/followers","following_url":"https://api.github.com/users/nyk2001/following{/other_user}","gists_url":"https://api.github.com/users/nyk2001/gists{/gist_id}","starred_url":"https://api.github.com/users/nyk2001/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nyk2001/subscriptions","organizations_url":"https://api.github.com/users/nyk2001/orgs","repos_url":"https://api.github.com/users/nyk2001/repos","events_url":"https://api.github.com/users/nyk2001/events{/privacy}","received_events_url":"https://api.github.com/users/nyk2001/received_events","type":"User","site_admin":false}},{"id":7856572135,"node_id":"MEE_lADOCVKAsc5Wkuj5zwAAAAHUScbn","url":"https://api.github.com/repos/sktime/sktime/issues/events/7856572135","actor":{"login":"fkiraly","id":7985502,"node_id":"MDQ6VXNlcjc5ODU1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7985502?v=4","gravatar_id":"","url":"https://api.github.com/users/fkiraly","html_url":"https://github.com/fkiraly","followers_url":"https://api.github.com/users/fkiraly/followers","following_url":"https://api.github.com/users/fkiraly/following{/other_user}","gists_url":"https://api.github.com/users/fkiraly/gists{/gist_id}","starred_url":"https://api.github.com/users/fkiraly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkiraly/subscriptions","organizations_url":"https://api.github.com/users/fkiraly/orgs","repos_url":"https://api.github.com/users/fkiraly/repos","events_url":"https://api.github.com/users/fkiraly/events{/privacy}","received_events_url":"https://api.github.com/users/fkiraly/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-11-21T11:34:53Z","performed_via_github_app":null},{"id":7856572146,"node_id":"SE_lADOCVKAsc5Wkuj5zwAAAAHUScby","url":"https://api.github.com/repos/sktime/sktime/issues/events/7856572146","actor":{"login":"fkiraly","id":7985502,"node_id":"MDQ6VXNlcjc5ODU1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7985502?v=4","gravatar_id":"","url":"https://api.github.com/users/fkiraly","html_url":"https://github.com/fkiraly","followers_url":"https://api.github.com/users/fkiraly/followers","following_url":"https://api.github.com/users/fkiraly/following{/other_user}","gists_url":"https://api.github.com/users/fkiraly/gists{/gist_id}","starred_url":"https://api.github.com/users/fkiraly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkiraly/subscriptions","organizations_url":"https://api.github.com/users/fkiraly/orgs","repos_url":"https://api.github.com/users/fkiraly/repos","events_url":"https://api.github.com/users/fkiraly/events{/privacy}","received_events_url":"https://api.github.com/users/fkiraly/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-11-21T11:34:53Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/sktime/sktime/issues/comments/1321993630","html_url":"https://github.com/sktime/sktime/issues/3803#issuecomment-1321993630","issue_url":"https://api.github.com/repos/sktime/sktime/issues/3803","id":1321993630,"node_id":"IC_kwDOCVKAsc5OzAWe","user":{"login":"nyk2001","id":3079053,"node_id":"MDQ6VXNlcjMwNzkwNTM=","avatar_url":"https://avatars.githubusercontent.com/u/3079053?v=4","gravatar_id":"","url":"https://api.github.com/users/nyk2001","html_url":"https://github.com/nyk2001","followers_url":"https://api.github.com/users/nyk2001/followers","following_url":"https://api.github.com/users/nyk2001/following{/other_user}","gists_url":"https://api.github.com/users/nyk2001/gists{/gist_id}","starred_url":"https://api.github.com/users/nyk2001/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nyk2001/subscriptions","organizations_url":"https://api.github.com/users/nyk2001/orgs","repos_url":"https://api.github.com/users/nyk2001/repos","events_url":"https://api.github.com/users/nyk2001/events{/privacy}","received_events_url":"https://api.github.com/users/nyk2001/received_events","type":"User","site_admin":false},"created_at":"2022-11-21T12:34:58Z","updated_at":"2022-11-21T12:34:58Z","author_association":"NONE","body":"[train.csv](https://github.com/sktime/sktime/files/10056515/train.csv)\r\n\r\n@fkiraly attached is the dataset I used ","reactions":{"url":"https://api.github.com/repos/sktime/sktime/issues/comments/1321993630/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nyk2001","id":3079053,"node_id":"MDQ6VXNlcjMwNzkwNTM=","avatar_url":"https://avatars.githubusercontent.com/u/3079053?v=4","gravatar_id":"","url":"https://api.github.com/users/nyk2001","html_url":"https://github.com/nyk2001","followers_url":"https://api.github.com/users/nyk2001/followers","following_url":"https://api.github.com/users/nyk2001/following{/other_user}","gists_url":"https://api.github.com/users/nyk2001/gists{/gist_id}","starred_url":"https://api.github.com/users/nyk2001/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nyk2001/subscriptions","organizations_url":"https://api.github.com/users/nyk2001/orgs","repos_url":"https://api.github.com/users/nyk2001/repos","events_url":"https://api.github.com/users/nyk2001/events{/privacy}","received_events_url":"https://api.github.com/users/nyk2001/received_events","type":"User","site_admin":false}},{"id":7857024752,"node_id":"MEE_lADOCVKAsc5Wkuj5zwAAAAHUUK7w","url":"https://api.github.com/repos/sktime/sktime/issues/events/7857024752","actor":{"login":"fkiraly","id":7985502,"node_id":"MDQ6VXNlcjc5ODU1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7985502?v=4","gravatar_id":"","url":"https://api.github.com/users/fkiraly","html_url":"https://github.com/fkiraly","followers_url":"https://api.github.com/users/fkiraly/followers","following_url":"https://api.github.com/users/fkiraly/following{/other_user}","gists_url":"https://api.github.com/users/fkiraly/gists{/gist_id}","starred_url":"https://api.github.com/users/fkiraly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkiraly/subscriptions","organizations_url":"https://api.github.com/users/fkiraly/orgs","repos_url":"https://api.github.com/users/fkiraly/repos","events_url":"https://api.github.com/users/fkiraly/events{/privacy}","received_events_url":"https://api.github.com/users/fkiraly/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-11-21T12:34:58Z","performed_via_github_app":null},{"id":7857024762,"node_id":"SE_lADOCVKAsc5Wkuj5zwAAAAHUUK76","url":"https://api.github.com/repos/sktime/sktime/issues/events/7857024762","actor":{"login":"fkiraly","id":7985502,"node_id":"MDQ6VXNlcjc5ODU1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7985502?v=4","gravatar_id":"","url":"https://api.github.com/users/fkiraly","html_url":"https://github.com/fkiraly","followers_url":"https://api.github.com/users/fkiraly/followers","following_url":"https://api.github.com/users/fkiraly/following{/other_user}","gists_url":"https://api.github.com/users/fkiraly/gists{/gist_id}","starred_url":"https://api.github.com/users/fkiraly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkiraly/subscriptions","organizations_url":"https://api.github.com/users/fkiraly/orgs","repos_url":"https://api.github.com/users/fkiraly/repos","events_url":"https://api.github.com/users/fkiraly/events{/privacy}","received_events_url":"https://api.github.com/users/fkiraly/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-11-21T12:34:58Z","performed_via_github_app":null}]