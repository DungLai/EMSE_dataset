{"url":"https://api.github.com/repos/zvtvz/zvt/issues/179","repository_url":"https://api.github.com/repos/zvtvz/zvt","labels_url":"https://api.github.com/repos/zvtvz/zvt/issues/179/labels{/name}","comments_url":"https://api.github.com/repos/zvtvz/zvt/issues/179/comments","events_url":"https://api.github.com/repos/zvtvz/zvt/issues/179/events","html_url":"https://github.com/zvtvz/zvt/issues/179","id":962800729,"node_id":"MDU6SXNzdWU5NjI4MDA3Mjk=","number":179,"title":"examples/recorders/joinquant_kdata_runner.py运行出错","user":{"login":"Leo-zhanglj","id":18610058,"node_id":"MDQ6VXNlcjE4NjEwMDU4","avatar_url":"https://avatars.githubusercontent.com/u/18610058?v=4","gravatar_id":"","url":"https://api.github.com/users/Leo-zhanglj","html_url":"https://github.com/Leo-zhanglj","followers_url":"https://api.github.com/users/Leo-zhanglj/followers","following_url":"https://api.github.com/users/Leo-zhanglj/following{/other_user}","gists_url":"https://api.github.com/users/Leo-zhanglj/gists{/gist_id}","starred_url":"https://api.github.com/users/Leo-zhanglj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Leo-zhanglj/subscriptions","organizations_url":"https://api.github.com/users/Leo-zhanglj/orgs","repos_url":"https://api.github.com/users/Leo-zhanglj/repos","events_url":"https://api.github.com/users/Leo-zhanglj/events{/privacy}","received_events_url":"https://api.github.com/users/Leo-zhanglj/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2021-08-06T14:42:13Z","updated_at":"2021-08-18T04:57:16Z","closed_at":"2021-08-18T04:57:16Z","author_association":"NONE","active_lock_reason":null,"body":"Stock1dHfqKdata registered recorders:{'joinquant': <class 'zvt.recorders.joinquant.quotes.jq_stock_kdata_recorder.JqChinaStockKdataRecorder'>}\r\n2021-08-06 22:39:51,236  INFO  MainThread  run to 1/4187\r\n2021-08-06 22:39:51,268  INFO  MainThread  entity_id:stock_sz_000001,evaluate_start_end_size_timestamps result:2021-02-09 00:00:00,None,179,None\r\n2021-08-06 22:39:54,204  ERROR  MainThread  recording data for entity_id:stock_sz_000001,<class 'zvt.domain.quotes.stock.stock_1d_hfq_kdata.Stock1dHfqKdata'>,error:msg:wrong data: b'error: \\xe5\\xb7\\xb2\\xe8\\xb6\\x85\\xe8\\xbf\\x87\\xe6\\xaf\\x8f\\xe6\\x97\\xa5\\xe6\\x9c\\x80\\xe5\\xa4\\xa7\\xe6\\x9f\\xa5\\xe8\\xaf\\xa2\\xe6\\x95\\xb0\\xe9\\x87\\x8f\\n\\xe6\\xb7\\xbb\\xe5\\x8a\\xa0\\xe7\\xae\\xa1\\xe7\\x90\\x86\\xe5\\x91\\x98\\xe5\\xbe\\xae\\xe4\\xbf\\xa1\\xe5\\x85\\x8d\\xe8\\xb4\\xb9\\xe9\\xa2\\x86\\xe5\\x8f\\x96\\xe6\\x9b\\xb4\\xe5\\xa4\\x9a\\xe9\\xa2\\x9d\\xe5\\xba\\xa6\\xef\\xbc\\x9b\\xe6\\x88\\x96\\xe4\\xbb\\x98\\xe8\\xb4\\xb9\\xe5\\x8d\\x87\\xe7\\xba\\xa7\\xe5\\x88\\xb02\\xe4\\xba\\xbf\\xe6\\x9d\\xa1/\\xe5\\xa4\\xa9\\xef\\xbc\\x8c\\xe8\\xaf\\xa6\\xe6\\x83\\x85\\xe8\\xaf\\xb7\\xe5\\x92\\xa8\\xe8\\xaf\\xa2\\xe7\\xae\\xa1\\xe7\\x90\\x86\\xe5\\x91\\x98\\xef\\xbc\\x8c\\xe5\\xbe\\xae\\xe4\\xbf\\xa1\\xe5\\x8f\\xb7\\xef\\xbc\\x9aJQData01'\r\nTraceback (most recent call last):\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/jqdatapy/api.py\", line 199, in request_jqdata\r\n    df = pd.read_csv(io.BytesIO(resp.content), dtype=dtype, header=header, parse_dates=parse_dates)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/pandas/io/parsers.py\", line 688, in read_csv\r\n    return _read(filepath_or_buffer, kwds)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/pandas/io/parsers.py\", line 454, in _read\r\n    parser = TextFileReader(fp_or_buf, **kwds)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/pandas/io/parsers.py\", line 948, in __init__\r\n    self._make_engine(self.engine)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/pandas/io/parsers.py\", line 1180, in _make_engine\r\n    self._engine = CParserWrapper(self.f, **self.options)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/pandas/io/parsers.py\", line 2068, in __init__\r\n    self._validate_parse_dates_presence(self.names)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/pandas/io/parsers.py\", line 1546, in _validate_parse_dates_presence\r\n    f\"Missing column provided to 'parse_dates': '{missing_cols}'\"\r\nValueError: Missing column provided to 'parse_dates': 'date'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/leo/zvt/zvt/contract/recorder.py\", line 387, in run\r\n    timestamps=timestamps)\r\n  File \"/Users/leo/zvt/zvt/recorders/joinquant/quotes/jq_stock_kdata_recorder.py\", line 82, in record\r\n    fq_ref_date=fq_ref_date)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/jqdatapy/api.py\", line 131, in get_bars\r\n    fq_ref_date=fq_ref_date, return_type=return_type, parse_dates=parse_dates)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/jqdatapy/api.py\", line 201, in request_jqdata\r\n    raise DataError(f'wrong data: {resp.content}')\r\njqdatapy.api.DataError: msg:wrong data: b'error: \\xe5\\xb7\\xb2\\xe8\\xb6\\x85\\xe8\\xbf\\x87\\xe6\\xaf\\x8f\\xe6\\x97\\xa5\\xe6\\x9c\\x80\\xe5\\xa4\\xa7\\xe6\\x9f\\xa5\\xe8\\xaf\\xa2\\xe6\\x95\\xb0\\xe9\\x87\\x8f\\n\\xe6\\xb7\\xbb\\xe5\\x8a\\xa0\\xe7\\xae\\xa1\\xe7\\x90\\x86\\xe5\\x91\\x98\\xe5\\xbe\\xae\\xe4\\xbf\\xa1\\xe5\\x85\\x8d\\xe8\\xb4\\xb9\\xe9\\xa2\\x86\\xe5\\x8f\\x96\\xe6\\x9b\\xb4\\xe5\\xa4\\x9a\\xe9\\xa2\\x9d\\xe5\\xba\\xa6\\xef\\xbc\\x9b\\xe6\\x88\\x96\\xe4\\xbb\\x98\\xe8\\xb4\\xb9\\xe5\\x8d\\x87\\xe7\\xba\\xa7\\xe5\\x88\\xb02\\xe4\\xba\\xbf\\xe6\\x9d\\xa1/\\xe5\\xa4\\xa9\\xef\\xbc\\x8c\\xe8\\xaf\\xa6\\xe6\\x83\\x85\\xe8\\xaf\\xb7\\xe5\\x92\\xa8\\xe8\\xaf\\xa2\\xe7\\xae\\xa1\\xe7\\x90\\x86\\xe5\\x91\\x98\\xef\\xbc\\x8c\\xe5\\xbe\\xae\\xe4\\xbf\\xa1\\xe5\\x8f\\xb7\\xef\\xbc\\x9aJQData01'\r\n2021-08-06 22:39:54,210  ERROR  MainThread  joinquant record kdata:msg:wrong data: b'error: \\xe5\\xb7\\xb2\\xe8\\xb6\\x85\\xe8\\xbf\\x87\\xe6\\xaf\\x8f\\xe6\\x97\\xa5\\xe6\\x9c\\x80\\xe5\\xa4\\xa7\\xe6\\x9f\\xa5\\xe8\\xaf\\xa2\\xe6\\x95\\xb0\\xe9\\x87\\x8f\\n\\xe6\\xb7\\xbb\\xe5\\x8a\\xa0\\xe7\\xae\\xa1\\xe7\\x90\\x86\\xe5\\x91\\x98\\xe5\\xbe\\xae\\xe4\\xbf\\xa1\\xe5\\x85\\x8d\\xe8\\xb4\\xb9\\xe9\\xa2\\x86\\xe5\\x8f\\x96\\xe6\\x9b\\xb4\\xe5\\xa4\\x9a\\xe9\\xa2\\x9d\\xe5\\xba\\xa6\\xef\\xbc\\x9b\\xe6\\x88\\x96\\xe4\\xbb\\x98\\xe8\\xb4\\xb9\\xe5\\x8d\\x87\\xe7\\xba\\xa7\\xe5\\x88\\xb02\\xe4\\xba\\xbf\\xe6\\x9d\\xa1/\\xe5\\xa4\\xa9\\xef\\xbc\\x8c\\xe8\\xaf\\xa6\\xe6\\x83\\x85\\xe8\\xaf\\xb7\\xe5\\x92\\xa8\\xe8\\xaf\\xa2\\xe7\\xae\\xa1\\xe7\\x90\\x86\\xe5\\x91\\x98\\xef\\xbc\\x8c\\xe5\\xbe\\xae\\xe4\\xbf\\xa1\\xe5\\x8f\\xb7\\xef\\xbc\\x9aJQData01'\r\nTraceback (most recent call last):\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/jqdatapy/api.py\", line 199, in request_jqdata\r\n    df = pd.read_csv(io.BytesIO(resp.content), dtype=dtype, header=header, parse_dates=parse_dates)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/pandas/io/parsers.py\", line 688, in read_csv\r\n    return _read(filepath_or_buffer, kwds)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/pandas/io/parsers.py\", line 454, in _read\r\n    parser = TextFileReader(fp_or_buf, **kwds)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/pandas/io/parsers.py\", line 948, in __init__\r\n    self._make_engine(self.engine)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/pandas/io/parsers.py\", line 1180, in _make_engine\r\n    self._engine = CParserWrapper(self.f, **self.options)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/pandas/io/parsers.py\", line 2068, in __init__\r\n    self._validate_parse_dates_presence(self.names)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/pandas/io/parsers.py\", line 1546, in _validate_parse_dates_presence\r\n    f\"Missing column provided to 'parse_dates': '{missing_cols}'\"\r\nValueError: Missing column provided to 'parse_dates': 'date'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/leo/zvt/examples/recorders/joinquant_kdata_runner.py\", line 42, in record_kdata\r\n    Stock1dHfqKdata.record_data(provider='joinquant', sleeping_time=0, day_data=True)\r\n  File \"/Users/leo/zvt/zvt/contract/schema.py\", line 175, in record_data\r\n    r.run()\r\n  File \"/Users/leo/zvt/zvt/contract/recorder.py\", line 468, in run\r\n    raise raising_exception\r\n  File \"/Users/leo/zvt/zvt/contract/recorder.py\", line 387, in run\r\n    timestamps=timestamps)\r\n  File \"/Users/leo/zvt/zvt/recorders/joinquant/quotes/jq_stock_kdata_recorder.py\", line 82, in record\r\n    fq_ref_date=fq_ref_date)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/jqdatapy/api.py\", line 131, in get_bars\r\n    fq_ref_date=fq_ref_date, return_type=return_type, parse_dates=parse_dates)\r\n  File \"/Users/leo/.virtualenvs/zvt/lib/python3.7/site-packages/jqdatapy/api.py\", line 201, in request_jqdata\r\n    raise DataError(f'wrong data: {resp.content}')\r\njqdatapy.api.DataError: msg:wrong data: b'error: \\xe5\\xb7\\xb2\\xe8\\xb6\\x85\\xe8\\xbf\\x87\\xe6\\xaf\\x8f\\xe6\\x97\\xa5\\xe6\\x9c\\x80\\xe5\\xa4\\xa7\\xe6\\x9f\\xa5\\xe8\\xaf\\xa2\\xe6\\x95\\xb0\\xe9\\x87\\x8f\\n\\xe6\\xb7\\xbb\\xe5\\x8a\\xa0\\xe7\\xae\\xa1\\xe7\\x90\\x86\\xe5\\x91\\x98\\xe5\\xbe\\xae\\xe4\\xbf\\xa1\\xe5\\x85\\x8d\\xe8\\xb4\\xb9\\xe9\\xa2\\x86\\xe5\\x8f\\x96\\xe6\\x9b\\xb4\\xe5\\xa4\\x9a\\xe9\\xa2\\x9d\\xe5\\xba\\xa6\\xef\\xbc\\x9b\\xe6\\x88\\x96\\xe4\\xbb\\x98\\xe8\\xb4\\xb9\\xe5\\x8d\\x87\\xe7\\xba\\xa7\\xe5\\x88\\xb02\\xe4\\xba\\xbf\\xe6\\x9d\\xa1/\\xe5\\xa4\\xa9\\xef\\xbc\\x8c\\xe8\\xaf\\xa6\\xe6\\x83\\x85\\xe8\\xaf\\xb7\\xe5\\x92\\xa8\\xe8\\xaf\\xa2\\xe7\\xae\\xa1\\xe7\\x90\\x86\\xe5\\x91\\x98\\xef\\xbc\\x8c\\xe5\\xbe\\xae\\xe4\\xbf\\xa1\\xe5\\x8f\\xb7\\xef\\xbc\\x9aJQData01'\r\n","closed_by":{"login":"Leo-zhanglj","id":18610058,"node_id":"MDQ6VXNlcjE4NjEwMDU4","avatar_url":"https://avatars.githubusercontent.com/u/18610058?v=4","gravatar_id":"","url":"https://api.github.com/users/Leo-zhanglj","html_url":"https://github.com/Leo-zhanglj","followers_url":"https://api.github.com/users/Leo-zhanglj/followers","following_url":"https://api.github.com/users/Leo-zhanglj/following{/other_user}","gists_url":"https://api.github.com/users/Leo-zhanglj/gists{/gist_id}","starred_url":"https://api.github.com/users/Leo-zhanglj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Leo-zhanglj/subscriptions","organizations_url":"https://api.github.com/users/Leo-zhanglj/orgs","repos_url":"https://api.github.com/users/Leo-zhanglj/repos","events_url":"https://api.github.com/users/Leo-zhanglj/events{/privacy}","received_events_url":"https://api.github.com/users/Leo-zhanglj/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/zvtvz/zvt/issues/179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/zvtvz/zvt/issues/179/timeline","performed_via_github_app":null,"state_reason":"completed"}