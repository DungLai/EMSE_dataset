{"url":"https://api.github.com/repos/msamogh/nonechucks/issues/8","repository_url":"https://api.github.com/repos/msamogh/nonechucks","labels_url":"https://api.github.com/repos/msamogh/nonechucks/issues/8/labels{/name}","comments_url":"https://api.github.com/repos/msamogh/nonechucks/issues/8/comments","events_url":"https://api.github.com/repos/msamogh/nonechucks/issues/8/events","html_url":"https://github.com/msamogh/nonechucks/issues/8","id":413672554,"node_id":"MDU6SXNzdWU0MTM2NzI1NTQ=","number":8,"title":"Failed to shuffle data across epoches","user":{"login":"chadHGY","id":22229425,"node_id":"MDQ6VXNlcjIyMjI5NDI1","avatar_url":"https://avatars.githubusercontent.com/u/22229425?v=4","gravatar_id":"","url":"https://api.github.com/users/chadHGY","html_url":"https://github.com/chadHGY","followers_url":"https://api.github.com/users/chadHGY/followers","following_url":"https://api.github.com/users/chadHGY/following{/other_user}","gists_url":"https://api.github.com/users/chadHGY/gists{/gist_id}","starred_url":"https://api.github.com/users/chadHGY/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chadHGY/subscriptions","organizations_url":"https://api.github.com/users/chadHGY/orgs","repos_url":"https://api.github.com/users/chadHGY/repos","events_url":"https://api.github.com/users/chadHGY/events{/privacy}","received_events_url":"https://api.github.com/users/chadHGY/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-02-23T08:27:32Z","updated_at":"2019-03-05T10:14:19Z","closed_at":"2019-03-05T09:39:05Z","author_association":"NONE","active_lock_reason":null,"body":"Hi, I found this project quite helpful and implement into my project. However, it seems something wrong with the shuffling method of the loader. Here is my testing code:\r\n```python\r\nimport torch\r\nimport torch.utils.data as Data\r\nimport nonechucks as nc\r\n\r\ntorch.manual_seed(1)    # reproducible\r\nBATCH_SIZE = 5\r\nSHUFFLE = True\r\nNUMWORKER = 2\r\n\r\nx = torch.linspace(1, 10, 10)       # x data (torch tensor)\r\ny = torch.linspace(10, 1, 10)       # y data (torch tensor)\r\n\r\ntorch_dataset = Data.TensorDataset(x,y)\r\nloader = Data.DataLoader(\r\n    dataset=torch_dataset,      # torch TensorDataset format\r\n    batch_size=BATCH_SIZE,      # mini batch size\r\n    shuffle=SHUFFLE,              \r\n    num_workers=NUMWORKER,\r\n    )\r\n\r\nloader_safe = nc.SafeDataLoader(nc.SafeDataset(torch_dataset), batch_size=BATCH_SIZE, shuffle=SHUFFLE, num_workers=NUMWORKER)\r\n\r\nprint('\\nNormal dataloader')\r\nfor epoch in range(3):\r\n    for step, (batch_x, batch_y) in enumerate(loader):\r\n        print('Epoch: ', epoch, '| Step: ', step, '| batch x: ',\r\n              batch_x.numpy(), '| batch y: ', batch_y.numpy())\r\n        \r\nprint('\\nSafe dataloader')\r\nfor epoch in range(3):\r\n    for step, (batch_x, batch_y) in enumerate(loader_safe):\r\n        print('Epoch: ', epoch, '| Step: ', step, '| batch x: ',\r\n              batch_x.numpy(), '| batch y: ', batch_y.numpy())\r\n```\r\n\r\n\r\nAnd the results are like this:\r\n```Shell\r\nNormal dataloader\r\nEpoch:  0 | Step:  0 | batch x:  [10.  3.  1.  6.  5.] | batch y:  [ 1.  8. 10.  5.  6.]\r\nEpoch:  0 | Step:  1 | batch x:  [8. 4. 2. 9. 7.] | batch y:  [3. 7. 9. 2. 4.]\r\nEpoch:  1 | Step:  0 | batch x:  [7. 9. 6. 2. 4.] | batch y:  [4. 2. 5. 9. fe  6. 10.  1.]\r\nEpoch:  2 | Step:  0 | batch x:  [4. 9. 1. 8. 5.] | batch y:  [ 7.  2. 10.  3.  6.]\r\nEpoch:  2 | Step:  1 | batch x:  [ 3.  2.  6. 10.  7.] | batch y:  [8. 9. 5. 1. 4.]\r\n\r\nSafe dataloader\r\nEpoch:  0 | Step:  0 | batch x:  [6. 7. 2. 3. 1.] | batch y:  [ 5.  4.  9.  8. 10.]\r\nEpoch:  0 | Step:  1 | batch x:  [ 9. 10.  4.  8.  5.] | batch y:  [2. 1. 7. 3. 6.]\r\nEpoch:  1 | Step:  0 | batch x:  [6. 7. 2. 3. 1.] | batch y:  [ 5.  4.  9.  8. 10.]\r\nEpoch:  1 | Step:  1 | batch x:  [ 9. 10.  4.  8.  5.] | batch y:  [2. 1. 7. 3. 6.]\r\nEpoch:  2 | Step:  0 | batch x:  [6. 7. 2. 3. 1.] | batch y:  [ 5.  4.  9.  8. 10.]\r\nEpoch:  2 | Step:  1 | batch x:  [ 9. 10.  4.  8.  5.] | batch y:  [2. 1. 7. 3. 6.]\r\n```\r\n\r\nIt seems that the safeloader doesn't shuffle correctly across epoches. Do I somehow miss use the package?\r\n\r\nBy the way, the pytorch version I used is  1.0.1.post2","closed_by":{"login":"msamogh","id":1230386,"node_id":"MDQ6VXNlcjEyMzAzODY=","avatar_url":"https://avatars.githubusercontent.com/u/1230386?v=4","gravatar_id":"","url":"https://api.github.com/users/msamogh","html_url":"https://github.com/msamogh","followers_url":"https://api.github.com/users/msamogh/followers","following_url":"https://api.github.com/users/msamogh/following{/other_user}","gists_url":"https://api.github.com/users/msamogh/gists{/gist_id}","starred_url":"https://api.github.com/users/msamogh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/msamogh/subscriptions","organizations_url":"https://api.github.com/users/msamogh/orgs","repos_url":"https://api.github.com/users/msamogh/repos","events_url":"https://api.github.com/users/msamogh/events{/privacy}","received_events_url":"https://api.github.com/users/msamogh/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/msamogh/nonechucks/issues/8/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/msamogh/nonechucks/issues/8/timeline","performed_via_github_app":null,"state_reason":"completed"}