{"url":"https://api.github.com/repos/developmentseed/label-maker/issues/42","repository_url":"https://api.github.com/repos/developmentseed/label-maker","labels_url":"https://api.github.com/repos/developmentseed/label-maker/issues/42/labels{/name}","comments_url":"https://api.github.com/repos/developmentseed/label-maker/issues/42/comments","events_url":"https://api.github.com/repos/developmentseed/label-maker/issues/42/events","html_url":"https://github.com/developmentseed/label-maker/issues/42","id":297120781,"node_id":"MDU6SXNzdWUyOTcxMjA3ODE=","number":42,"title":"Object detection example: tfexample_decoder has no attribute 'BackupHandler'","user":{"login":"giswqs","id":5016453,"node_id":"MDQ6VXNlcjUwMTY0NTM=","avatar_url":"https://avatars.githubusercontent.com/u/5016453?v=4","gravatar_id":"","url":"https://api.github.com/users/giswqs","html_url":"https://github.com/giswqs","followers_url":"https://api.github.com/users/giswqs/followers","following_url":"https://api.github.com/users/giswqs/following{/other_user}","gists_url":"https://api.github.com/users/giswqs/gists{/gist_id}","starred_url":"https://api.github.com/users/giswqs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giswqs/subscriptions","organizations_url":"https://api.github.com/users/giswqs/orgs","repos_url":"https://api.github.com/users/giswqs/repos","events_url":"https://api.github.com/users/giswqs/events{/privacy}","received_events_url":"https://api.github.com/users/giswqs/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2018-02-14T14:44:02Z","updated_at":"2018-04-17T20:36:53Z","closed_at":"2018-04-17T20:36:53Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"@Geoyi  Thank you for the great [tutorial](https://github.com/developmentseed/label-maker/blob/master/examples/walkthrough-tensorflow-object-detection.md)! I was able to follow through until the very last step to train the object detection model. Before I ran into the error, I had noticed two minor differences from your tutorial:\r\n\r\n1. I only got 196 image tiles for the Mexico example instead of 385 image tiles as stated in your tutorial. I did try on two different computers, both of which got the same 196 image titles.\r\n2. The original folder name in the zip file [ssd_inception_v2_coco](http://download.tensorflow.org/models/object_detection/ssd_inception_v2_coco_2017_11_17.tar.gz) is `ssd_inception_v2_coco_2017_11_17`, so I had to change the folder name to `ssd_inception_v2_coco`. You might want to note this in your tutorial. \r\n\r\nI went through the Object Detection Model Setup without any problem. However, when I started to train the model, I got an error `AttributeError: module 'tensorflow.contrib.slim.python.slim.data.tfexample_decoder' has no attribute 'BackupHandler'`, which is similar to the issue reported [here](https://github.com/tensorflow/models/issues/2653). I tried the suggested workaround to download the [tfexample_decoder.py](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/slim/python/slim/data/tfexample_decoder.py) and replace my local `tfexample_decoder.py`, but it did not work. It seems the solution is to upgrade to tensorflow v1.4 or a nightly build, which requires cuda 9.0. However, I am not yet ready to upgrade cuda. Any advice will be appreciated! See below for more information about the errors. \r\n\r\n\r\n## System information\r\n\r\n **What is the top-level directory of the model you are using:** \r\n\r\n~/tensorflow/models/research/object_detection\r\n\r\n**OS Platform and Distribution:** Linux Ubuntu 16.04, Elementary OS\r\n\r\n**TensorFlow installed from (source or binary):** pip install tensorflow-gpu\r\n\r\n**TensorFlow version**: v1.3.0\r\n\r\n**Python version:** v3.6.3\r\n\r\n**CUDA/cuDNN version:** CUDA 8.0, cudnn 6.0, nVidia driver: 384.111\r\n\r\n**GPU:** nVidia GeForce GTX 1050 Ti 4GB memory\r\n\r\n**CPU:** Intel x86-64 Intel Core i7-4790K @ 3.60GHz x 8, 32GB memory\r\n\r\n**Exact command to reproduce:**\r\n``` shell\r\npython train.py --logtostderr \\\r\n             --train_dir=training/ \\\r\n             --pipeline_config_path=training/ssd_inception_v2_coco.config\r\n```\r\n\r\n**Source code / logs:**\r\n``` shell\r\n(py36) qiusheng@wu-office:/media/hdd/Data/developmentseed/models/research/object_detection$ python train.py --logtostderr              --train_dir=training/              --pipeline_config_path=training/ssd_inception_v2_coco.config\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 169, in <module>\r\n    tf.app.run()\r\n  File \"/home/qiusheng/anaconda3/envs/py36/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 48, in run\r\n    _sys.exit(main(_sys.argv[:1] + flags_passthrough))\r\n  File \"train.py\", line 165, in main\r\n    worker_job_name, is_chief, FLAGS.train_dir)\r\n  File \"/media/hdd/Data/developmentseed/models/research/object_detection/trainer.py\", line 235, in train\r\n    train_config.prefetch_queue_capacity, data_augmentation_options)\r\n  File \"/media/hdd/Data/developmentseed/models/research/object_detection/trainer.py\", line 59, in create_input_queue\r\n    tensor_dict = create_tensor_dict_fn()\r\n  File \"train.py\", line 122, in get_next\r\n    worker_index=FLAGS.task)).get_next()\r\n  File \"/media/hdd/Data/developmentseed/models/research/object_detection/builders/dataset_builder.py\", line 140, in build\r\n    label_map_proto_file=label_map_proto_file)\r\n  File \"/media/hdd/Data/developmentseed/models/research/object_detection/data_decoders/tf_example_decoder.py\", line 153, in __init__\r\n    label_handler = slim_example_decoder.BackupHandler(\r\nAttributeError: module 'tensorflow.contrib.slim.python.slim.data.tfexample_decoder' has no attribute 'BackupHandler'\r\n```\r\nTried the suggested [workaround](https://github.com/tensorflow/models/issues/2653) to replace the local `tfexample_decoder.py` and got the following error:\r\n\r\n``` shell\r\n(py36) qiusheng@wu-office:/media/hdd/Data/developmentseed/models/research/object_detection$ python train.py --logtostderr              --train_dir=training/              --pipeline_config_path=training/ssd_inception_v2_coco.config\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 49, in <module>\r\n    from object_detection import trainer\r\n  File \"/media/hdd/Data/developmentseed/models/research/object_detection/trainer.py\", line 32, in <module>\r\n    from object_detection.utils import variables_helper\r\n  File \"/media/hdd/Data/developmentseed/models/research/object_detection/utils/variables_helper.py\", line 23, in <module>\r\n    slim = tf.contrib.slim\r\n  File \"/home/qiusheng/anaconda3/envs/py36/lib/python3.6/site-packages/tensorflow/python/util/lazy_loader.py\", line 53, in __getattr__\r\n    module = self._load()\r\n  File \"/home/qiusheng/anaconda3/envs/py36/lib/python3.6/site-packages/tensorflow/python/util/lazy_loader.py\", line 42, in _load\r\n    module = importlib.import_module(self.__name__)\r\n  File \"/home/qiusheng/anaconda3/envs/py36/lib/python3.6/importlib/__init__.py\", line 126, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"/home/qiusheng/anaconda3/envs/py36/lib/python3.6/site-packages/tensorflow/contrib/__init__.py\", line 60, in <module>\r\n    from tensorflow.contrib import slim\r\n  File \"/home/qiusheng/anaconda3/envs/py36/lib/python3.6/site-packages/tensorflow/contrib/slim/__init__.py\", line 44, in <module>\r\n    from tensorflow.contrib.slim.python.slim.data import tfexample_decoder\r\n  File \"/home/qiusheng/anaconda3/envs/py36/lib/python3.6/site-packages/tensorflow/contrib/slim/python/slim/data/tfexample_decoder.py\", line 7\r\n    <!DOCTYPE html>\r\n    ^\r\nSyntaxError: invalid syntax\r\n```","closed_by":{"login":"drewbo","id":7108211,"node_id":"MDQ6VXNlcjcxMDgyMTE=","avatar_url":"https://avatars.githubusercontent.com/u/7108211?v=4","gravatar_id":"","url":"https://api.github.com/users/drewbo","html_url":"https://github.com/drewbo","followers_url":"https://api.github.com/users/drewbo/followers","following_url":"https://api.github.com/users/drewbo/following{/other_user}","gists_url":"https://api.github.com/users/drewbo/gists{/gist_id}","starred_url":"https://api.github.com/users/drewbo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drewbo/subscriptions","organizations_url":"https://api.github.com/users/drewbo/orgs","repos_url":"https://api.github.com/users/drewbo/repos","events_url":"https://api.github.com/users/drewbo/events{/privacy}","received_events_url":"https://api.github.com/users/drewbo/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/developmentseed/label-maker/issues/42/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/developmentseed/label-maker/issues/42/timeline","performed_via_github_app":null,"state_reason":"completed"}