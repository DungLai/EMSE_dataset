{"url":"https://api.github.com/repos/theislab/diffxpy/issues/83","repository_url":"https://api.github.com/repos/theislab/diffxpy","labels_url":"https://api.github.com/repos/theislab/diffxpy/issues/83/labels{/name}","comments_url":"https://api.github.com/repos/theislab/diffxpy/issues/83/comments","events_url":"https://api.github.com/repos/theislab/diffxpy/issues/83/events","html_url":"https://github.com/theislab/diffxpy/issues/83","id":424930425,"node_id":"MDU6SXNzdWU0MjQ5MzA0MjU=","number":83,"title":"diffxpy.api.enrich.test throws error when used with gene_ids and pval input","user":{"login":"le-ander","id":20015434,"node_id":"MDQ6VXNlcjIwMDE1NDM0","avatar_url":"https://avatars.githubusercontent.com/u/20015434?v=4","gravatar_id":"","url":"https://api.github.com/users/le-ander","html_url":"https://github.com/le-ander","followers_url":"https://api.github.com/users/le-ander/followers","following_url":"https://api.github.com/users/le-ander/following{/other_user}","gists_url":"https://api.github.com/users/le-ander/gists{/gist_id}","starred_url":"https://api.github.com/users/le-ander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/le-ander/subscriptions","organizations_url":"https://api.github.com/users/le-ander/orgs","repos_url":"https://api.github.com/users/le-ander/repos","events_url":"https://api.github.com/users/le-ander/events{/privacy}","received_events_url":"https://api.github.com/users/le-ander/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-03-25T14:24:33Z","updated_at":"2019-04-04T08:03:03Z","closed_at":"2019-04-04T08:03:03Z","author_association":"MEMBER","active_lock_reason":null,"body":"I just tried to run an enrichment analysis using diffxpy 0.4.2. I do not use a DE Test object as input to the enrichment test, but manually specify the `gene_ids` and `pval` arguments.\r\n\r\nThis produces the following error:\r\n\r\n```Python\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-65-33921779303b> in <module>\r\n----> 1 test = de.enrich.test(RefSets=rs_curated, pval=de_allmerged_fdr[0], gene_ids=np.array(de_allmerged_genes[0]).tolist(), de_threshold=0.05)\r\n\r\n~/anaconda3/envs/orgacute/lib/python3.6/site-packages/diffxpy/enrichment/enrich.py in test(RefSets, DETest, pval, gene_ids, de_threshold, all_ids, clean_ref, upper)\r\n    234         all_ids=all_ids,\r\n    235         clean_ref=clean_ref,\r\n--> 236         upper=upper)\r\n    237 \r\n    238 \r\n\r\n~/anaconda3/envs/orgacute/lib/python3.6/site-packages/diffxpy/enrichment/enrich.py in __init__(self, RefSets, DETest, pval, gene_ids, de_threshold, all_ids, clean_ref, upper)\r\n    275 \r\n    276         self._significant_de = self._qval_de <= de_threshold\r\n--> 277         self._significant_ids = set(self._gene_ids[np.where(self._significant_de)[0]])\r\n    278         if all_ids is not None:\r\n    279             self._all_ids = set(all_ids)\r\n\r\nTypeError: only integer scalar arrays can be converted to a scalar index\r\n```\r\n\r\nI am pretty sure, that python lists such as self._gene_ids here: https://github.com/theislab/diffxpy/blob/7e47156e77f69c76942642cabdbffa5b32ea3bb0/diffxpy/enrichment/enrich.py#L277 do not support boolean indexing with numpy arrays. When `gene_ids` is passed as a numpy array (instead of a list as specified) the error disappears.","closed_by":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/83/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/theislab/diffxpy/issues/83/timeline","performed_via_github_app":null,"state_reason":"completed"}