{"url":"https://api.github.com/repos/theislab/diffxpy/issues/187","repository_url":"https://api.github.com/repos/theislab/diffxpy","labels_url":"https://api.github.com/repos/theislab/diffxpy/issues/187/labels{/name}","comments_url":"https://api.github.com/repos/theislab/diffxpy/issues/187/comments","events_url":"https://api.github.com/repos/theislab/diffxpy/issues/187/events","html_url":"https://github.com/theislab/diffxpy/issues/187","id":775107055,"node_id":"MDU6SXNzdWU3NzUxMDcwNTU=","number":187,"title":"Raw counts for testing of continuous covariates","user":{"login":"dsg03","id":64926556,"node_id":"MDQ6VXNlcjY0OTI2NTU2","avatar_url":"https://avatars.githubusercontent.com/u/64926556?v=4","gravatar_id":"","url":"https://api.github.com/users/dsg03","html_url":"https://github.com/dsg03","followers_url":"https://api.github.com/users/dsg03/followers","following_url":"https://api.github.com/users/dsg03/following{/other_user}","gists_url":"https://api.github.com/users/dsg03/gists{/gist_id}","starred_url":"https://api.github.com/users/dsg03/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsg03/subscriptions","organizations_url":"https://api.github.com/users/dsg03/orgs","repos_url":"https://api.github.com/users/dsg03/repos","events_url":"https://api.github.com/users/dsg03/events{/privacy}","received_events_url":"https://api.github.com/users/dsg03/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-12-27T20:59:38Z","updated_at":"2021-01-02T15:18:43Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi, \r\n\r\nThank you developing this great package! I was performing testing for continuous covariates in my single cell data. Please see the formula and function call:\r\n\r\nsize_factors = np.mean(X_pp.toarray(), axis=1) / np.mean(np.mean(X_pp.toarray(), axis=1))\r\n\r\ncon_1d = de.test.continuous_1d(data=X_pp.toarray(), \r\n                               formula_loc='~ 1 + pseudotime + repeat + n_genes + total_counts', \r\n                               formula_scale='~ 1', factor_loc_totest='pseudotime', continuous='pseudotime', \r\n                               size_factors=size_factors, df=4, \r\n                               sample_description=adata.obs, gene_names=adata.raw.var_names, \r\n                               as_numeric=['n_genes', 'total_counts'], \r\n                               quick_scale=False, dtype='float64')\r\n\r\nX_pp is cell vs gene matrix of raw counts.\r\n\r\nI have 2 questions:\r\n1. For more basic differential expression testing, such as with wald test, I have read that it is best to use raw counts(no normalization, logarithmization, or scaling). As such, I have used the raw counts for testing continuous covariates. However, many genes have counts of 0, likely due to the high dropout rates of single cell. It seems that the fitting of the model is affected by many 0 counts. Please see the two pictures below for the curves of fitted models for 2 genes. Is there a way to account for 0 counts for this type of test?\r\n\r\n<img src='https://user-images.githubusercontent.com/64926556/103179568-71004900-485b-11eb-8e85-5b810bcad2bb.png' width='250'>\r\n<img src='https://user-images.githubusercontent.com/64926556/103179569-71004900-485b-11eb-9f90-13e3d681ffcd.png' width='250'>\r\n\r\n2. I have tried to use gene expression after imputation with the magic package. The genes with low p-values are much more biologically relevant than when I use raw counts. However, the curve for the fitted model then below where most of the y-axis/ gene expression values are located. What is the reason for this? Also, the expression matrix is no longer raw counts. Is this still appropriate for the testing?\r\n\r\n<img src='https://user-images.githubusercontent.com/64926556/103179593-aa38b900-485b-11eb-80d8-1ba7978644d1.png' width='250'>\r\n\r\n@davidsebfischer ","closed_by":null,"reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/187/reactions","total_count":3,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/theislab/diffxpy/issues/187/timeline","performed_via_github_app":null,"state_reason":null}