{"url":"https://api.github.com/repos/theislab/diffxpy/issues/167","repository_url":"https://api.github.com/repos/theislab/diffxpy","labels_url":"https://api.github.com/repos/theislab/diffxpy/issues/167/labels{/name}","comments_url":"https://api.github.com/repos/theislab/diffxpy/issues/167/comments","events_url":"https://api.github.com/repos/theislab/diffxpy/issues/167/events","html_url":"https://github.com/theislab/diffxpy/issues/167","id":653699314,"node_id":"MDU6SXNzdWU2NTM2OTkzMTQ=","number":167,"title":"Unusual Log2fc Values from Tests","user":{"login":"mattmajo","id":65512275,"node_id":"MDQ6VXNlcjY1NTEyMjc1","avatar_url":"https://avatars.githubusercontent.com/u/65512275?v=4","gravatar_id":"","url":"https://api.github.com/users/mattmajo","html_url":"https://github.com/mattmajo","followers_url":"https://api.github.com/users/mattmajo/followers","following_url":"https://api.github.com/users/mattmajo/following{/other_user}","gists_url":"https://api.github.com/users/mattmajo/gists{/gist_id}","starred_url":"https://api.github.com/users/mattmajo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mattmajo/subscriptions","organizations_url":"https://api.github.com/users/mattmajo/orgs","repos_url":"https://api.github.com/users/mattmajo/repos","events_url":"https://api.github.com/users/mattmajo/events{/privacy}","received_events_url":"https://api.github.com/users/mattmajo/received_events","type":"User","site_admin":false},"labels":[{"id":1188205200,"node_id":"MDU6TGFiZWwxMTg4MjA1MjAw","url":"https://api.github.com/repos/theislab/diffxpy/labels/addressed","name":"addressed","color":"bde8fc","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"assignees":[{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2020-07-09T01:43:39Z","updated_at":"2020-07-17T11:45:27Z","closed_at":"2020-07-17T11:45:27Z","author_association":"NONE","active_lock_reason":null,"body":"Hi there, I have been trying to run diffxpy on my raw dataset:\r\n```\r\n> AnnData object with n_obs × n_vars = 76994 × 33694 \r\n     obs: 'n_counts', 'n_genes', 'mito', 'doublet_scores', 'predicted_doublets', 'name', 'Sample', 'donor', 'organ', 'sort', 'method', 'file',      'is_TRA_p', 'is_TRB_p', 'is_TRA_np', 'is_TRB_np', 'Age', 'Source', 'cell types', 'source', 'birth', 'batch', 'bbk', 'donor_method'\r\n     var: 'GeneName', 'GeneID\r\n```\r\nWhen I run any differential expression tests between a condition with 2 factors I end up getting a strange result.\r\n``` \r\n> import diffxpy.api as de\r\n> test = de.test.t_test(adata, grouping='cell types')\r\n> print(test.summary().iloc[:,:])\r\n\r\n               gene |      pval      |    qval    |   log2fc   |   mean\r\n--------|---------- | -------------- | ---------- | ---------- | -----------\r\n381             SIM1   3.173105e-01   4.275500e-01 -1061.023794   0.000107   \r\n1704         POU5F1B   3.173105e-01   4.275500e-01 -1061.023794   0.000107   \r\n869             DDX4   3.173105e-01   4.275500e-01 -1061.023794   0.000107   \r\n471            ESRRB   3.173105e-01   4.275500e-01 -1061.023794   0.000107   \r\n359             MYF5   3.173105e-01   4.275500e-01 -1061.023794   0.000107   \r\n955            FGF19   2.403784e-01   3.633407e-01     4.998926   0.000644   \r\n1478           LUZP2   3.397947e-19   7.599045e-18    -4.806819   0.019317   \r\n977              FEV   1.636333e-03   5.858140e-03     4.764461   0.002254   \r\n878            FEZF2   3.369594e-01   4.494532e-01     4.676998   0.000537   \r\n695             PAX3   1.166546e-02   3.124094e-02     4.484353   0.000966   \r\n1013           SOX17   1.262338e-01   2.227199e-01     4.221319   0.005044   \r\n351             DBX1   1.949431e-01   3.079743e-01     3.676998   0.000322   \r\n```\r\nI get absurdly large log2fc for some genes and then it drops off such that I am getting more reasonable number.\r\nI was wondering if it looks like there is an issue in the way things are running because all of the log2fc around |1060| doesn't seem quite right.\r\n\r\nThanks!\r\n\r\n","closed_by":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/theislab/diffxpy/issues/167/timeline","performed_via_github_app":null,"state_reason":"completed"}