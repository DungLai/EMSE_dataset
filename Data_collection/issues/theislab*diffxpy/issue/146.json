{"url":"https://api.github.com/repos/theislab/diffxpy/issues/146","repository_url":"https://api.github.com/repos/theislab/diffxpy","labels_url":"https://api.github.com/repos/theislab/diffxpy/issues/146/labels{/name}","comments_url":"https://api.github.com/repos/theislab/diffxpy/issues/146/comments","events_url":"https://api.github.com/repos/theislab/diffxpy/issues/146/events","html_url":"https://github.com/theislab/diffxpy/issues/146","id":576500944,"node_id":"MDU6SXNzdWU1NzY1MDA5NDQ=","number":146,"title":"Check for single group passed for tests","user":{"login":"dburkhardt","id":8322751,"node_id":"MDQ6VXNlcjgzMjI3NTE=","avatar_url":"https://avatars.githubusercontent.com/u/8322751?v=4","gravatar_id":"","url":"https://api.github.com/users/dburkhardt","html_url":"https://github.com/dburkhardt","followers_url":"https://api.github.com/users/dburkhardt/followers","following_url":"https://api.github.com/users/dburkhardt/following{/other_user}","gists_url":"https://api.github.com/users/dburkhardt/gists{/gist_id}","starred_url":"https://api.github.com/users/dburkhardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dburkhardt/subscriptions","organizations_url":"https://api.github.com/users/dburkhardt/orgs","repos_url":"https://api.github.com/users/dburkhardt/repos","events_url":"https://api.github.com/users/dburkhardt/events{/privacy}","received_events_url":"https://api.github.com/users/dburkhardt/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-03-05T20:07:53Z","updated_at":"2020-03-05T20:08:56Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Current behavior:\r\n\r\n```python\r\nimport scanpy as sc\r\nimport numpy as np\r\nimport diffxpy.api as de\r\n\r\nadata = sc.AnnData(np.random.normal(size=(100,10)))\r\nde.test.rank_sum(adata, grouping=np.tile('a', 100))\r\n```\r\n\r\nraises:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nIndexError                                Traceback (most recent call last)\r\n<ipython-input-2-0d8486632427> in <module>\r\n      4\r\n      5 adata = sc.AnnData(np.random.normal(size=(100,10)))\r\n----> 6 de.test.rank_test(adata, grouping=np.tile('a', 100))\r\n\r\n~/.local/lib/python3.8/site-packages/diffxpy/testing/tests.py in rank_test(data, grouping, gene_names, sample_description, is_logged, is_sig_zerovar)\r\n    894     grouping = parse_grouping(data, sample_description, grouping)\r\n    895\r\n--> 896     de_test = DifferentialExpressionTestRank(\r\n    897         data=data,\r\n    898         sample_description=sample_description,\r\n\r\n~/.local/lib/python3.8/site-packages/diffxpy/testing/det.py in __init__(self, data, sample_description, grouping, gene_names, is_logged, is_sig_zerovar)\r\n   1689         self._gene_names = np.asarray(gene_names)\r\n   1690\r\n-> 1691         x0, x1 = split_x(data, grouping)\r\n   1692\r\n   1693         mean_x0 = np.asarray(np.mean(x0, axis=0)).flatten().astype(dtype=np.float)\r\n\r\n~/.local/lib/python3.8/site-packages/diffxpy/testing/utils.py in split_x(data, grouping)\r\n    114     groups = np.unique(grouping)\r\n    115     x0 = data[np.where(grouping == groups[0])[0]]\r\n--> 116     x1 = data[np.where(grouping == groups[1])[0]]\r\n    117     return x0, x1\r\n    118\r\n\r\nIndexError: index 1 is out of bounds for axis 0 with size 1\r\n```\r\n\r\nDesired behavior:\r\n\r\n```python\r\nif np.unique(grouping).shape[0] < 2:\r\n    raise ValueError('`grouping` must have more than one unique value.')\r\n```\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/146/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/theislab/diffxpy/issues/146/timeline","performed_via_github_app":null,"state_reason":null}