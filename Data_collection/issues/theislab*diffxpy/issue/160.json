{"url":"https://api.github.com/repos/theislab/diffxpy/issues/160","repository_url":"https://api.github.com/repos/theislab/diffxpy","labels_url":"https://api.github.com/repos/theislab/diffxpy/issues/160/labels{/name}","comments_url":"https://api.github.com/repos/theislab/diffxpy/issues/160/comments","events_url":"https://api.github.com/repos/theislab/diffxpy/issues/160/events","html_url":"https://github.com/theislab/diffxpy/issues/160","id":622211344,"node_id":"MDU6SXNzdWU2MjIyMTEzNDQ=","number":160,"title":"ModuleNotFoundError: No module named 'batchglm.train.tf2'","user":{"login":"pchiang5","id":29170925,"node_id":"MDQ6VXNlcjI5MTcwOTI1","avatar_url":"https://avatars.githubusercontent.com/u/29170925?v=4","gravatar_id":"","url":"https://api.github.com/users/pchiang5","html_url":"https://github.com/pchiang5","followers_url":"https://api.github.com/users/pchiang5/followers","following_url":"https://api.github.com/users/pchiang5/following{/other_user}","gists_url":"https://api.github.com/users/pchiang5/gists{/gist_id}","starred_url":"https://api.github.com/users/pchiang5/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pchiang5/subscriptions","organizations_url":"https://api.github.com/users/pchiang5/orgs","repos_url":"https://api.github.com/users/pchiang5/repos","events_url":"https://api.github.com/users/pchiang5/events{/privacy}","received_events_url":"https://api.github.com/users/pchiang5/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-05-21T02:59:42Z","updated_at":"2020-05-21T06:07:16Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"When I tried to perform differential expression with the code below:\r\n\r\n```\r\n\r\ntest = de.test.versus_rest(\r\n    data=post_adata,\r\n    grouping=\"leiden\",\r\n    noise_model=\"nb\"\r\n)\r\n\r\n\r\n```\r\n\r\nThe following error showed:\r\n\r\n> \r\n> Traceback (most recent call last):\r\n>   File \"<stdin>\", line 6, in <module>\r\n>   File \"C:\\ProgramData\\Miniconda3\\lib\\site-packages\\diffxpy\\testing\\tests.py\", line 1489, in versus_rest\r\n>     **kwargs\r\n>   File \"C:\\ProgramData\\Miniconda3\\lib\\site-packages\\diffxpy\\testing\\tests.py\", line 1047, in two_sample\r\n>     **kwargs\r\n>   File \"C:\\ProgramData\\Miniconda3\\lib\\site-packages\\diffxpy\\testing\\tests.py\", line 736, in wald\r\n>     **kwargs,\r\n>   File \"C:\\ProgramData\\Miniconda3\\lib\\site-packages\\diffxpy\\testing\\tests.py\", line 146, in _fit\r\n>     from batchglm.api.models.tf2.glm_nb import Estimator, InputDataGLM\r\n>   File \"C:\\ProgramData\\Miniconda3\\lib\\site-packages\\batchglm\\api\\models\\tf2\\__init__.py\", line 2, in <module>\r\n>     from . import glm_nb\r\n>   File \"C:\\ProgramData\\Miniconda3\\lib\\site-packages\\batchglm\\api\\models\\tf2\\glm_nb.py\", line 2, in <module>\r\n>     from batchglm.train.tf2.glm_nb import Estimator\r\n> ModuleNotFoundError: No module named 'batchglm.train.tf2'\r\n> \r\n> \r\n\r\n\r\nUpdate:\r\n\r\nI successfully ran the code when the tf2-version at Github was cloned and installed. However, another error jumped out below. How shall I solve the error?\r\n\r\n> C:\\ProgramData\\Miniconda3\\lib\\site-packages\\batchglm\\utils\\linalg.py:107: FutureWarning: `rcond` parameter will change to the default of machine precision times ``max(M, N)`` where M and N are the input matrix dimensions.\r\n> To use the future default and silence this warning we advise to pass `rcond=None`, to keep using the old, explicitly pass `rcond=-1`.\r\n>   params\r\n> C:\\ProgramData\\Miniconda3\\lib\\site-packages\\batchglm\\utils\\linalg.py:107: FutureWarning: `rcond` parameter will change to the default of machine precision times ``max(M, N)`` where M and N are the input matrix dimensions.\r\n> To use the future default and silence this warning we advise to pass `rcond=None`, to keep using the old, explicitly pass `rcond=-1`.\r\n>   params\r\n> 2020-05-21 12:26:50.222981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties:\r\n> pciBusID: 0000:01:00.0 name: GeForce GTX 1650 computeCapability: 7.5\r\n> coreClock: 1.665GHz coreCount: 14 deviceMemorySize: 4.00GiB deviceMemoryBandwidth: 119.24GiB/s\r\n> 2020-05-21 12:26:50.223368: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_101.dll\r\n> 2020-05-21 12:26:50.224179: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_10.dll\r\n> 2020-05-21 12:26:50.225090: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_10.dll\r\n> 2020-05-21 12:26:50.226276: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_10.dll\r\n> 2020-05-21 12:26:50.228090: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_10.dll\r\n> 2020-05-21 12:26:50.228994: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_10.dll\r\n> 2020-05-21 12:26:50.230048: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll\r\n> 2020-05-21 12:26:50.233775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0\r\n> 2020-05-21 12:26:50.238937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties:\r\n> pciBusID: 0000:01:00.0 name: GeForce GTX 1650 computeCapability: 7.5\r\n> coreClock: 1.665GHz coreCount: 14 deviceMemorySize: 4.00GiB deviceMemoryBandwidth: 119.24GiB/s\r\n> 2020-05-21 12:26:50.241234: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_101.dll\r\n> 2020-05-21 12:26:50.243013: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_10.dll\r\n> 2020-05-21 12:26:50.243992: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_10.dll\r\n> 2020-05-21 12:26:50.244725: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_10.dll\r\n> 2020-05-21 12:26:50.246907: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_10.dll\r\n> 2020-05-21 12:26:50.247845: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_10.dll\r\n> 2020-05-21 12:26:50.248968: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll\r\n> 2020-05-21 12:26:50.251056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0\r\n> 2020-05-21 12:26:50.257788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n> 2020-05-21 12:26:50.258742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0\r\n> 2020-05-21 12:26:50.259786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N\r\n> 2020-05-21 12:26:50.262906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2917 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1650, pci bus id: 0000:01:00.0, compute capability: 7.5)\r\n> Traceback (most recent call last):\r\n>   File \"<stdin>\", line 5, in <module>\r\n>   File \"c:\\users\\pc\\downloads\\diffxpy\\diffxpy\\testing\\tests.py\", line 1493, in versus_rest\r\n>     **kwargs\r\n>   File \"c:\\users\\pc\\downloads\\diffxpy\\diffxpy\\testing\\tests.py\", line 1051, in two_sample\r\n>     **kwargs\r\n>   File \"c:\\users\\pc\\downloads\\diffxpy\\diffxpy\\testing\\tests.py\", line 738, in wald\r\n>     **kwargs,\r\n>   File \"c:\\users\\pc\\downloads\\diffxpy\\diffxpy\\testing\\tests.py\", line 246, in _fit\r\n>     **train_args\r\n>   File \"C:\\ProgramData\\Miniconda3\\lib\\site-packages\\batchglm\\models\\base\\estimator.py\", line 124, in train_sequence\r\n>     self.train(**d, **kwargs)\r\n>   File \"C:\\ProgramData\\Miniconda3\\lib\\site-packages\\batchglm\\train\\tf2\\glm_nb\\estimator.py\", line 117, in train\r\n>     optimizer_object = self.get_optimizer_object(optim_algo, learning_rate, intercept_scale)\r\n>   File \"C:\\ProgramData\\Miniconda3\\lib\\site-packages\\batchglm\\train\\tf2\\glm_nb\\estimator.py\", line 146, in get_optimizer_object\r\n>     intercept_scale=intercept_scale)\r\n>   File \"C:\\ProgramData\\Miniconda3\\lib\\site-packages\\batchglm\\train\\tf2\\glm_nb\\optim.py\", line 31, in __init__\r\n>     np.zeros(shape=[n_features]) + pkg_constants.TRUST_REGION_RADIUS_INIT_SCALE,\r\n> AttributeError: module 'batchglm.pkg_constants' has no attribute 'TRUST_REGION_RADIUS_INIT_SCALE'\r\n\r\nUpdate again:\r\n\r\nI changed the following code in the pkg_constants.py and it seemed to ran well with CUDA now. However, is it correct to do so?\r\n```\r\n\r\n# Trust region hyper parameters:\r\nTRUST_REGION_RADIUS_INIT_SCALE = 100.  # original  \"TRUST_REGION_RADIUS_INIT = 100.\"\r\n\r\nTRUST_REGIONT_T2_IRLS_GD_TR_SCALE = 1 # orginal \"T1\" instead of \"T2\"\r\n\r\n\r\n```\r\n\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/theislab/diffxpy/issues/160/timeline","performed_via_github_app":null,"state_reason":null}