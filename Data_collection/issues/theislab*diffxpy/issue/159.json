{"url":"https://api.github.com/repos/theislab/diffxpy/issues/159","repository_url":"https://api.github.com/repos/theislab/diffxpy","labels_url":"https://api.github.com/repos/theislab/diffxpy/issues/159/labels{/name}","comments_url":"https://api.github.com/repos/theislab/diffxpy/issues/159/comments","events_url":"https://api.github.com/repos/theislab/diffxpy/issues/159/events","html_url":"https://github.com/theislab/diffxpy/issues/159","id":617423218,"node_id":"MDU6SXNzdWU2MTc0MjMyMTg=","number":159,"title":"Error running de.test.lrt: type <class 'tuple'> not recognized","user":{"login":"cchrysostomou","id":2927161,"node_id":"MDQ6VXNlcjI5MjcxNjE=","avatar_url":"https://avatars.githubusercontent.com/u/2927161?v=4","gravatar_id":"","url":"https://api.github.com/users/cchrysostomou","html_url":"https://github.com/cchrysostomou","followers_url":"https://api.github.com/users/cchrysostomou/followers","following_url":"https://api.github.com/users/cchrysostomou/following{/other_user}","gists_url":"https://api.github.com/users/cchrysostomou/gists{/gist_id}","starred_url":"https://api.github.com/users/cchrysostomou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cchrysostomou/subscriptions","organizations_url":"https://api.github.com/users/cchrysostomou/orgs","repos_url":"https://api.github.com/users/cchrysostomou/repos","events_url":"https://api.github.com/users/cchrysostomou/events{/privacy}","received_events_url":"https://api.github.com/users/cchrysostomou/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-05-13T12:52:56Z","updated_at":"2020-05-19T17:45:58Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"When I try to run the LRT function I get the following error: \r\n\r\n```\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-378-462f6e08c1ed> in <module>\r\n     17    data=data,\r\n     18    full_formula_loc=\"1+condition\",\r\n---> 19    reduced_formula_loc=\"1\"\r\n     20 )\r\n\r\n~/batchglm/diffxpy/diffxpy/testing/tests.py in lrt(data, full_formula_loc, reduced_formula_loc, full_formula_scale, reduced_formula_scale, as_numeric, init_a, init_b, gene_names, sample_description, noise_model, size_factors, batch_size, backend, train_args, training_strategy, quick_scale, dtype, **kwargs)\r\n    412         quick_scale=quick_scale,\r\n    413         dtype=dtype,\r\n--> 414         **kwargs\r\n    415     )\r\n    416     full_model = _fit(\r\n\r\n~/batchglm/diffxpy/diffxpy/testing/tests.py in _fit(noise_model, data, design_loc, design_scale, design_loc_names, design_scale_names, constraints_loc, constraints_scale, init_model, init_a, init_b, gene_names, size_factors, batch_size, backend, training_strategy, quick_scale, train_args, close_session, dtype)\r\n    188         chunk_size_genes=chunk_size_genes,\r\n    189         as_dask=backend.lower() in [\"numpy\"],\r\n--> 190         cast_dtype=dtype\r\n    191     )\r\n    192 \r\n\r\n~/batchglm/batchglm/models/base_glm/input.py in __init__(self, data, design_loc, design_loc_names, design_scale, design_scale_names, constraints_loc, constraints_scale, size_factors, observation_names, feature_names, chunk_size_cells, chunk_size_genes, as_dask, cast_dtype)\r\n     94         design_loc, design_loc_names = parse_design(\r\n     95             design_matrix=design_loc,\r\n---> 96             param_names=design_loc_names\r\n     97         )\r\n     98         design_scale, design_scale_names = parse_design(\r\n\r\n~/batchglm/batchglm/models/base_glm/utils.py in parse_design(design_matrix, param_names)\r\n     39         params = None\r\n     40     else:\r\n---> 41         raise ValueError(\"type %s not recognized\" % type(design_matrix))\r\n     42 \r\n     43     if param_names is not None:\r\n\r\nValueError: type <class 'tuple'> not recognized\r\n```\r\n\r\nThis was the code block I ran to generate the error (versions I am using are: batchglm version v0.7.4+5.g31b905b, diffpy version v0.7.4+16.g3689ea8):\r\n\r\n```\r\nsim = Simulator(num_observations=200, num_features=100)\r\nsim.generate_sample_description(num_batches=0, num_conditions=4)\r\nsim.generate_params(\r\n    rand_fn_loc=lambda shape: np.random.uniform(-0.1, 0.1, shape),\r\n    rand_fn_scale=lambda shape: np.random.uniform(0.1, 2, shape)\r\n)\r\nsim.generate_data()\r\nsim.x.min()\r\n\r\ndata = anndata.AnnData(\r\n    X=sim.x,\r\n    var=pd.DataFrame(index=[\"gene\" + str(i) for i in range(sim.x.shape[1])]),\r\n    obs=sim.sample_description\r\n)\r\n\r\ntest_lrt = de.test.lrt(\r\n   data=data, \r\n   full_formula_loc=\"1+condition\",\r\n   reduced_formula_loc=\"1\"\r\n)\r\n```\r\n\r\nPlease let me know what I am doing incorrectly and how to properly run the code block above. \r\nThanks!","closed_by":null,"reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/theislab/diffxpy/issues/159/timeline","performed_via_github_app":null,"state_reason":null}