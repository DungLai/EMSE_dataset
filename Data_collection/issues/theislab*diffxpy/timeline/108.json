[{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/524211685","html_url":"https://github.com/theislab/diffxpy/issues/108#issuecomment-524211685","issue_url":"https://api.github.com/repos/theislab/diffxpy/issues/108","id":524211685,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDIxMTY4NQ==","user":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"created_at":"2019-08-23T07:48:11Z","updated_at":"2019-08-23T07:48:11Z","author_association":"MEMBER","body":"Thanks for the issue @ivirshup and example, this is a relatively small bug that sneaked in the last versions, I am working on it.","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/524211685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false}},{"id":2578833404,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjU3ODgzMzQwNA==","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2578833404","actor":{"login":"ivirshup","id":8238804,"node_id":"MDQ6VXNlcjgyMzg4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/8238804?v=4","gravatar_id":"","url":"https://api.github.com/users/ivirshup","html_url":"https://github.com/ivirshup","followers_url":"https://api.github.com/users/ivirshup/followers","following_url":"https://api.github.com/users/ivirshup/following{/other_user}","gists_url":"https://api.github.com/users/ivirshup/gists{/gist_id}","starred_url":"https://api.github.com/users/ivirshup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivirshup/subscriptions","organizations_url":"https://api.github.com/users/ivirshup/orgs","repos_url":"https://api.github.com/users/ivirshup/repos","events_url":"https://api.github.com/users/ivirshup/events{/privacy}","received_events_url":"https://api.github.com/users/ivirshup/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-08-23T07:48:12Z","performed_via_github_app":null},{"id":2578833406,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI1Nzg4MzM0MDY=","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2578833406","actor":{"login":"ivirshup","id":8238804,"node_id":"MDQ6VXNlcjgyMzg4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/8238804?v=4","gravatar_id":"","url":"https://api.github.com/users/ivirshup","html_url":"https://github.com/ivirshup","followers_url":"https://api.github.com/users/ivirshup/followers","following_url":"https://api.github.com/users/ivirshup/following{/other_user}","gists_url":"https://api.github.com/users/ivirshup/gists{/gist_id}","starred_url":"https://api.github.com/users/ivirshup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivirshup/subscriptions","organizations_url":"https://api.github.com/users/ivirshup/orgs","repos_url":"https://api.github.com/users/ivirshup/repos","events_url":"https://api.github.com/users/ivirshup/events{/privacy}","received_events_url":"https://api.github.com/users/ivirshup/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-08-23T07:48:12Z","performed_via_github_app":null},{"id":2578833576,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQyNTc4ODMzNTc2","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2578833576","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2019-08-23T07:48:15Z","assignee":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"id":2578835939,"node_id":"MDEyOkxhYmVsZWRFdmVudDI1Nzg4MzU5Mzk=","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2578835939","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-08-23T07:49:16Z","label":{"name":"in_progress","color":"d4c5f9"},"performed_via_github_app":null},{"id":2578836697,"node_id":"MDEyOkxhYmVsZWRFdmVudDI1Nzg4MzY2OTc=","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2578836697","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-08-23T07:49:35Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"id":2578836698,"node_id":"MDEyOkxhYmVsZWRFdmVudDI1Nzg4MzY2OTg=","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2578836698","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-08-23T07:49:35Z","label":{"name":"high-priority","color":"ed1e48"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/524526891","html_url":"https://github.com/theislab/diffxpy/issues/108#issuecomment-524526891","issue_url":"https://api.github.com/repos/theislab/diffxpy/issues/108","id":524526891,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDUyNjg5MQ==","user":{"login":"ivirshup","id":8238804,"node_id":"MDQ6VXNlcjgyMzg4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/8238804?v=4","gravatar_id":"","url":"https://api.github.com/users/ivirshup","html_url":"https://github.com/ivirshup","followers_url":"https://api.github.com/users/ivirshup/followers","following_url":"https://api.github.com/users/ivirshup/following{/other_user}","gists_url":"https://api.github.com/users/ivirshup/gists{/gist_id}","starred_url":"https://api.github.com/users/ivirshup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivirshup/subscriptions","organizations_url":"https://api.github.com/users/ivirshup/orgs","repos_url":"https://api.github.com/users/ivirshup/repos","events_url":"https://api.github.com/users/ivirshup/events{/privacy}","received_events_url":"https://api.github.com/users/ivirshup/received_events","type":"User","site_admin":false},"created_at":"2019-08-24T06:59:58Z","updated_at":"2019-08-24T06:59:58Z","author_association":"MEMBER","body":"Great, thanks for the quick response!\r\n\r\nAny chance there's a version this works in at the moment?","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/524526891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ivirshup","id":8238804,"node_id":"MDQ6VXNlcjgyMzg4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/8238804?v=4","gravatar_id":"","url":"https://api.github.com/users/ivirshup","html_url":"https://github.com/ivirshup","followers_url":"https://api.github.com/users/ivirshup/followers","following_url":"https://api.github.com/users/ivirshup/following{/other_user}","gists_url":"https://api.github.com/users/ivirshup/gists{/gist_id}","starred_url":"https://api.github.com/users/ivirshup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivirshup/subscriptions","organizations_url":"https://api.github.com/users/ivirshup/orgs","repos_url":"https://api.github.com/users/ivirshup/repos","events_url":"https://api.github.com/users/ivirshup/events{/privacy}","received_events_url":"https://api.github.com/users/ivirshup/received_events","type":"User","site_admin":false}},{"id":2582051871,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50MjU4MjA1MTg3MQ==","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2582051871","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2019-08-25T17:52:37Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"id":2582051872,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50MjU4MjA1MTg3Mg==","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2582051872","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2019-08-25T17:52:37Z","label":{"name":"high-priority","color":"ed1e48"},"performed_via_github_app":null},{"id":2582051874,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50MjU4MjA1MTg3NA==","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2582051874","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2019-08-25T17:52:37Z","label":{"name":"in_progress","color":"d4c5f9"},"performed_via_github_app":null},{"id":2582051876,"node_id":"MDEyOkxhYmVsZWRFdmVudDI1ODIwNTE4NzY=","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2582051876","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-08-25T17:52:37Z","label":{"name":"waiting to close","color":"c5def5"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/524652246","html_url":"https://github.com/theislab/diffxpy/issues/108#issuecomment-524652246","issue_url":"https://api.github.com/repos/theislab/diffxpy/issues/108","id":524652246,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDY1MjI0Ng==","user":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"created_at":"2019-08-25T18:17:18Z","updated_at":"2019-08-25T18:17:18Z","author_association":"MEMBER","body":"Hi @ivirshup, thanks for your patience, I figured it would be better to directly fix rather than point you to an older version which may have different problems. The necessary code of diffxpy and batchglm is up on github and pypi. I tested this in unit tests and also attach the now working example here\r\n\r\n```python\r\nimport diffxpy.api as de\r\nimport scanpy as sc\r\n\r\npbmc = sc.datasets.pbmc68k_reduced()\r\npbmc.X = pbmc.raw.X\r\ndet = de.test.pairwise(pbmc, \"bulk_labels\")  # Note that the defaults are lazy z-test on NB noise.\r\nprint(det.groups)  # Check out the group names.\r\npvals = det.pval_pairs('CD14+ Monocyte', 'CD19+ B')  # Produce p-values for a pair of groups based on model fits.\r\n```\r\nLet me know if you have questions about the pairwise API, this does not appear in other DE packages as far as I know so I am happy to help build an intuition / extend documentation as needed. A tutorial for this will also be out next week. The function is documented here: https://diffxpy.readthedocs.io/en/latest/api/diffxpy.api.test.pairwise.html#diffxpy.api.test.pairwise \r\n\r\nThis is diffpxy version v0.6.11 and batchglm version v0.6.6.","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/524652246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false}},{"id":2582062949,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjU4MjA2Mjk0OQ==","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2582062949","actor":{"login":"ivirshup","id":8238804,"node_id":"MDQ6VXNlcjgyMzg4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/8238804?v=4","gravatar_id":"","url":"https://api.github.com/users/ivirshup","html_url":"https://github.com/ivirshup","followers_url":"https://api.github.com/users/ivirshup/followers","following_url":"https://api.github.com/users/ivirshup/following{/other_user}","gists_url":"https://api.github.com/users/ivirshup/gists{/gist_id}","starred_url":"https://api.github.com/users/ivirshup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivirshup/subscriptions","organizations_url":"https://api.github.com/users/ivirshup/orgs","repos_url":"https://api.github.com/users/ivirshup/repos","events_url":"https://api.github.com/users/ivirshup/events{/privacy}","received_events_url":"https://api.github.com/users/ivirshup/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-08-25T18:17:18Z","performed_via_github_app":null},{"id":2582062950,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI1ODIwNjI5NTA=","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2582062950","actor":{"login":"ivirshup","id":8238804,"node_id":"MDQ6VXNlcjgyMzg4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/8238804?v=4","gravatar_id":"","url":"https://api.github.com/users/ivirshup","html_url":"https://github.com/ivirshup","followers_url":"https://api.github.com/users/ivirshup/followers","following_url":"https://api.github.com/users/ivirshup/following{/other_user}","gists_url":"https://api.github.com/users/ivirshup/gists{/gist_id}","starred_url":"https://api.github.com/users/ivirshup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivirshup/subscriptions","organizations_url":"https://api.github.com/users/ivirshup/orgs","repos_url":"https://api.github.com/users/ivirshup/repos","events_url":"https://api.github.com/users/ivirshup/events{/privacy}","received_events_url":"https://api.github.com/users/ivirshup/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-08-25T18:17:18Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/524652461","html_url":"https://github.com/theislab/diffxpy/issues/108#issuecomment-524652461","issue_url":"https://api.github.com/repos/theislab/diffxpy/issues/108","id":524652461,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDY1MjQ2MQ==","user":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"created_at":"2019-08-25T18:19:52Z","updated_at":"2019-08-25T18:19:52Z","author_association":"MEMBER","body":"By the way: If you want to avoid any model fitting for run time reasons in your scenario, you can set quick_scale to True to only work with the methods of moments estimator of the dispersion. What s happening right now is that we really estimate this dispersion to get the maximum likelihood estimator. Alternatively, you can also run a Welch's T-test, this has different distributional assumptions.","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/524652461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false}},{"actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"created_at":"2019-08-25T18:25:52Z","updated_at":"2019-08-25T18:25:52Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/92","repository_url":"https://api.github.com/repos/theislab/diffxpy","labels_url":"https://api.github.com/repos/theislab/diffxpy/issues/92/labels{/name}","comments_url":"https://api.github.com/repos/theislab/diffxpy/issues/92/comments","events_url":"https://api.github.com/repos/theislab/diffxpy/issues/92/events","html_url":"https://github.com/theislab/diffxpy/issues/92","id":460326448,"node_id":"MDU6SXNzdWU0NjAzMjY0NDg=","number":92,"title":"Test between two clusters of a Scanpy object","user":{"login":"Gpasquini","id":35536181,"node_id":"MDQ6VXNlcjM1NTM2MTgx","avatar_url":"https://avatars.githubusercontent.com/u/35536181?v=4","gravatar_id":"","url":"https://api.github.com/users/Gpasquini","html_url":"https://github.com/Gpasquini","followers_url":"https://api.github.com/users/Gpasquini/followers","following_url":"https://api.github.com/users/Gpasquini/following{/other_user}","gists_url":"https://api.github.com/users/Gpasquini/gists{/gist_id}","starred_url":"https://api.github.com/users/Gpasquini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gpasquini/subscriptions","organizations_url":"https://api.github.com/users/Gpasquini/orgs","repos_url":"https://api.github.com/users/Gpasquini/repos","events_url":"https://api.github.com/users/Gpasquini/events{/privacy}","received_events_url":"https://api.github.com/users/Gpasquini/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2019-06-25T09:56:27Z","updated_at":"2022-09-01T12:19:45Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"repository":{"id":139462224,"node_id":"MDEwOlJlcG9zaXRvcnkxMzk0NjIyMjQ=","name":"diffxpy","full_name":"theislab/diffxpy","private":false,"owner":{"login":"theislab","id":22319415,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIyMzE5NDE1","avatar_url":"https://avatars.githubusercontent.com/u/22319415?v=4","gravatar_id":"","url":"https://api.github.com/users/theislab","html_url":"https://github.com/theislab","followers_url":"https://api.github.com/users/theislab/followers","following_url":"https://api.github.com/users/theislab/following{/other_user}","gists_url":"https://api.github.com/users/theislab/gists{/gist_id}","starred_url":"https://api.github.com/users/theislab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/theislab/subscriptions","organizations_url":"https://api.github.com/users/theislab/orgs","repos_url":"https://api.github.com/users/theislab/repos","events_url":"https://api.github.com/users/theislab/events{/privacy}","received_events_url":"https://api.github.com/users/theislab/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/theislab/diffxpy","description":"Differential expression analysis for single-cell RNA-seq data.","fork":false,"url":"https://api.github.com/repos/theislab/diffxpy","forks_url":"https://api.github.com/repos/theislab/diffxpy/forks","keys_url":"https://api.github.com/repos/theislab/diffxpy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/theislab/diffxpy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/theislab/diffxpy/teams","hooks_url":"https://api.github.com/repos/theislab/diffxpy/hooks","issue_events_url":"https://api.github.com/repos/theislab/diffxpy/issues/events{/number}","events_url":"https://api.github.com/repos/theislab/diffxpy/events","assignees_url":"https://api.github.com/repos/theislab/diffxpy/assignees{/user}","branches_url":"https://api.github.com/repos/theislab/diffxpy/branches{/branch}","tags_url":"https://api.github.com/repos/theislab/diffxpy/tags","blobs_url":"https://api.github.com/repos/theislab/diffxpy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/theislab/diffxpy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/theislab/diffxpy/git/refs{/sha}","trees_url":"https://api.github.com/repos/theislab/diffxpy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/theislab/diffxpy/statuses/{sha}","languages_url":"https://api.github.com/repos/theislab/diffxpy/languages","stargazers_url":"https://api.github.com/repos/theislab/diffxpy/stargazers","contributors_url":"https://api.github.com/repos/theislab/diffxpy/contributors","subscribers_url":"https://api.github.com/repos/theislab/diffxpy/subscribers","subscription_url":"https://api.github.com/repos/theislab/diffxpy/subscription","commits_url":"https://api.github.com/repos/theislab/diffxpy/commits{/sha}","git_commits_url":"https://api.github.com/repos/theislab/diffxpy/git/commits{/sha}","comments_url":"https://api.github.com/repos/theislab/diffxpy/comments{/number}","issue_comment_url":"https://api.github.com/repos/theislab/diffxpy/issues/comments{/number}","contents_url":"https://api.github.com/repos/theislab/diffxpy/contents/{+path}","compare_url":"https://api.github.com/repos/theislab/diffxpy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/theislab/diffxpy/merges","archive_url":"https://api.github.com/repos/theislab/diffxpy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/theislab/diffxpy/downloads","issues_url":"https://api.github.com/repos/theislab/diffxpy/issues{/number}","pulls_url":"https://api.github.com/repos/theislab/diffxpy/pulls{/number}","milestones_url":"https://api.github.com/repos/theislab/diffxpy/milestones{/number}","notifications_url":"https://api.github.com/repos/theislab/diffxpy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/theislab/diffxpy/labels{/name}","releases_url":"https://api.github.com/repos/theislab/diffxpy/releases{/id}","deployments_url":"https://api.github.com/repos/theislab/diffxpy/deployments","created_at":"2018-07-02T15:37:56Z","updated_at":"2023-01-13T22:49:58Z","pushed_at":"2022-10-11T02:41:42Z","git_url":"git://github.com/theislab/diffxpy.git","ssh_url":"git@github.com:theislab/diffxpy.git","clone_url":"https://github.com/theislab/diffxpy.git","svn_url":"https://github.com/theislab/diffxpy","homepage":"https://diffxpy.rtfd.io","size":1794,"stargazers_count":143,"watchers_count":143,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":21,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":102,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause","node_id":"MDc6TGljZW5zZTU="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bioinformatics","differential-expression","gene-set-enrichment","single-cell-rna-seq","tensorflow","transcriptomics"],"visibility":"public","forks":21,"open_issues":102,"watchers":143,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"I am having hard times in performing a simple Wald test on two specified clusters of a data\r\n\r\nI annotate the sample description of my Scanpy AnnData. To test one group versus all the rest of the cells, this command works:\r\ntest = de.test.versus_rest(\r\n    data=adata.raw,\r\n    grouping=\"condition\",\r\n    test=\"wald\",\r\n    noise_model=\"nb\",\r\n    sample_description=adata.sample_description,\r\n    #batch_size=100,\r\n    training_strategy=\"DEFAULT\",\r\n    dtype=\"float64\"\r\n)\r\n\r\n*adata.sample_description is a DataFrame with one column 'condition'\r\n\r\nLet's say that in condition I have 5 labels like 'endo', 'neuron', 'fibro', 'beta', 'alpha', 'stem'.\r\nHow can I test the differential expressed genes between 'neuron' and 'stem'?\r\n\r\nThis is what I am trying to run:\r\ntest = de.test.wald(\r\n    data=adata.raw,\r\n    formula_loc=\"~ neuron - stem\",\r\n    factor_loc_totest=\"condition\",\r\n    grouping=\"condition\",\r\n    noise_model=\"nb\",\r\n    sample_description=adata.sample_description,\r\n    training_strategy=\"DEFAULT\",\r\n    dtype=\"float64\"\r\n)\r\n\r\nreturning:\r\n[...]\r\n~/Library/Python/3.7/lib/python/site-packages/patsy/compat.py in <module>\r\n\r\nPatsyError: Error evaluating factor: NameError: name 'neuron' is not defined\r\n    ~ neuron - stem\r\n       ^^^^^^\r\n\r\n","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/92/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/theislab/diffxpy/issues/92/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/524718213","html_url":"https://github.com/theislab/diffxpy/issues/108#issuecomment-524718213","issue_url":"https://api.github.com/repos/theislab/diffxpy/issues/108","id":524718213,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDcxODIxMw==","user":{"login":"ivirshup","id":8238804,"node_id":"MDQ6VXNlcjgyMzg4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/8238804?v=4","gravatar_id":"","url":"https://api.github.com/users/ivirshup","html_url":"https://github.com/ivirshup","followers_url":"https://api.github.com/users/ivirshup/followers","following_url":"https://api.github.com/users/ivirshup/following{/other_user}","gists_url":"https://api.github.com/users/ivirshup/gists{/gist_id}","starred_url":"https://api.github.com/users/ivirshup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivirshup/subscriptions","organizations_url":"https://api.github.com/users/ivirshup/orgs","repos_url":"https://api.github.com/users/ivirshup/repos","events_url":"https://api.github.com/users/ivirshup/events{/privacy}","received_events_url":"https://api.github.com/users/ivirshup/received_events","type":"User","site_admin":false},"created_at":"2019-08-26T05:12:47Z","updated_at":"2019-08-26T05:12:47Z","author_association":"MEMBER","body":"Thanks for the fix! My understanding of the pairwise function is that it's pretty similar to `scran`'s  `pairwiseTTests` and `pairwiseWilcox`. Is that right?\r\n\r\nI'm still getting a failure for the rank tests, unless I specify `lazy=False` and `noise_model=None`.\r\n\r\n```python\r\n# Fails:\r\nd = de.test.pairwise(pbmc, \"bulk_labels\", test=\"rank\")\r\n\r\n# Runs:\r\nd = de.test.pairwise(pbmc, \"bulk_labels\", test=\"rank\", lazy=False, noise_model=None) \r\n```\r\n\r\nOnce the testing has been run (for any kind of test I've tried), there seems to be a bug in the `summary_pair` function, which throws an error about array dimensionality:\r\n\r\n```python\r\nd.summary_pair('Dendritic', 'CD14+ Monocyte') \r\n```\r\n\r\n<details>\r\n<summary> Traceback </summary>\r\n\r\n```python\r\n/usr/local/lib/python3.7/site-packages/diffxpy/testing/det.py in summary_pair(self, group1, group2, qval_thres, fc_upper_thres, fc_lower_thres, mean_thres)\r\n   2066             \"qval\": self.qval_pair(group1=group1, group2=group2),\r\n   2067             \"log2fc\": self.log_fold_change_pair(group1=group1, group2=group2, base=2),\r\n-> 2068             \"mean\": np.asarray(self.mean)\r\n   2069         })\r\n   2070 \r\n\r\n/usr/local/lib/python3.7/site-packages/pandas/core/frame.py in __init__(self, data, index, columns, dtype, copy)\r\n    408             )\r\n    409         elif isinstance(data, dict):\r\n--> 410             mgr = init_dict(data, index, columns, dtype=dtype)\r\n    411         elif isinstance(data, ma.MaskedArray):\r\n    412             import numpy.ma.mrecords as mrecords\r\n\r\n/usr/local/lib/python3.7/site-packages/pandas/core/internals/construction.py in init_dict(data, index, columns, dtype)\r\n    255             arr if not is_datetime64tz_dtype(arr) else arr.copy() for arr in arrays\r\n    256         ]\r\n--> 257     return arrays_to_mgr(arrays, data_names, index, columns, dtype=dtype)\r\n    258 \r\n    259 \r\n\r\n/usr/local/lib/python3.7/site-packages/pandas/core/internals/construction.py in arrays_to_mgr(arrays, arr_names, index, columns, dtype)\r\n     80 \r\n     81     # don't force copy because getting jammed in an ndarray anyway\r\n---> 82     arrays = _homogenize(arrays, index, dtype)\r\n     83 \r\n     84     # from BlockManager perspective\r\n\r\n/usr/local/lib/python3.7/site-packages/pandas/core/internals/construction.py in _homogenize(data, index, dtype)\r\n    321                 val = lib.fast_multiget(val, oindex.values, default=np.nan)\r\n    322             val = sanitize_array(\r\n--> 323                 val, index, dtype=dtype, copy=False, raise_cast_failure=False\r\n    324             )\r\n    325 \r\n\r\n/usr/local/lib/python3.7/site-packages/pandas/core/internals/construction.py in sanitize_array(data, index, dtype, copy, raise_cast_failure)\r\n    727     elif subarr.ndim > 1:\r\n    728         if isinstance(data, np.ndarray):\r\n--> 729             raise Exception(\"Data must be 1-dimensional\")\r\n    730         else:\r\n    731             subarr = com.asarray_tuplesafe(data, dtype=dtype)\r\n\r\nException: Data must be 1-dimensional\r\n```\r\n\r\n</details>","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/524718213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ivirshup","id":8238804,"node_id":"MDQ6VXNlcjgyMzg4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/8238804?v=4","gravatar_id":"","url":"https://api.github.com/users/ivirshup","html_url":"https://github.com/ivirshup","followers_url":"https://api.github.com/users/ivirshup/followers","following_url":"https://api.github.com/users/ivirshup/following{/other_user}","gists_url":"https://api.github.com/users/ivirshup/gists{/gist_id}","starred_url":"https://api.github.com/users/ivirshup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivirshup/subscriptions","organizations_url":"https://api.github.com/users/ivirshup/orgs","repos_url":"https://api.github.com/users/ivirshup/repos","events_url":"https://api.github.com/users/ivirshup/events{/privacy}","received_events_url":"https://api.github.com/users/ivirshup/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/524767619","html_url":"https://github.com/theislab/diffxpy/issues/108#issuecomment-524767619","issue_url":"https://api.github.com/repos/theislab/diffxpy/issues/108","id":524767619,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDc2NzYxOQ==","user":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"created_at":"2019-08-26T08:20:21Z","updated_at":"2019-08-26T08:20:21Z","author_association":"MEMBER","body":"> Thanks for the fix! My understanding of the pairwise function is that it's pretty similar to `scran`'s `pairwiseTTests` and `pairwiseWilcox`. Is that right?\r\n\r\nI will check these out, it sounds similar!\r\n \r\n> I'm still getting a failure for the rank tests, unless I specify `lazy=False` and `noise_model=None`.\r\n\r\nFor now, this is desired behaviour, each of these attributes triggers an error telling the user no to do this. I understand that it may seem better to just auto-set these arguments to their allowed value but: \r\n\r\n1. I to make sure that all users understand that there is no way of doing a Wilcoxon rank sum test with a negative binomial noise model and similar for Welch's t-test. \r\n2. Lazy T-tests and rank tests will be implemented in the future, I havent done that yet, so I am keeping this argument setting open to not confuse future users.\r\n\r\n> Once the testing has been run (for any kind of test I've tried), there seems to be a bug in the `summary_pair` function, which throws an error about array dimensionality:\r\n\r\nI just fixed this error, thanks again for pointing this out! This was caused by csr_matrix vs ndarray input. The full working example is now (diffxpy v0.6.12):\r\n\r\n``` python\r\nimport diffxpy.api as de\r\nimport scanpy as sc\r\n\r\npbmc = sc.datasets.pbmc68k_reduced()\r\npbmc.X = pbmc.raw.X\r\ndet = de.test.pairwise(pbmc, \"bulk_labels\")  # Note that the defaults are lazy z-test on NB noise.\r\nprint(det.groups)  # Check out the group names.\r\npvals = det.pval_pairs('CD14+ Monocyte', 'CD19+ B')  # Produce p-values for a pair of groups based on model fits.\r\nd = de.test.pairwise(pbmc, \"bulk_labels\", test=\"rank\", lazy=False, noise_model=None) \r\nd.summary_pair('Dendritic', 'CD14+ Monocyte') \r\n```","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/524767619/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false}},{"id":2582908825,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50MjU4MjkwODgyNQ==","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2582908825","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2019-08-26T08:20:31Z","label":{"name":"waiting to close","color":"c5def5"},"performed_via_github_app":null},{"id":2582908826,"node_id":"MDEyOkxhYmVsZWRFdmVudDI1ODI5MDg4MjY=","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2582908826","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-08-26T08:20:31Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"id":2582909390,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50MjU4MjkwOTM5MA==","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2582909390","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2019-08-26T08:20:42Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"id":2582909391,"node_id":"MDEyOkxhYmVsZWRFdmVudDI1ODI5MDkzOTE=","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2582909391","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-08-26T08:20:42Z","label":{"name":"waiting to close","color":"c5def5"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/525118328","html_url":"https://github.com/theislab/diffxpy/issues/108#issuecomment-525118328","issue_url":"https://api.github.com/repos/theislab/diffxpy/issues/108","id":525118328,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNTExODMyOA==","user":{"login":"ivirshup","id":8238804,"node_id":"MDQ6VXNlcjgyMzg4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/8238804?v=4","gravatar_id":"","url":"https://api.github.com/users/ivirshup","html_url":"https://github.com/ivirshup","followers_url":"https://api.github.com/users/ivirshup/followers","following_url":"https://api.github.com/users/ivirshup/following{/other_user}","gists_url":"https://api.github.com/users/ivirshup/gists{/gist_id}","starred_url":"https://api.github.com/users/ivirshup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivirshup/subscriptions","organizations_url":"https://api.github.com/users/ivirshup/orgs","repos_url":"https://api.github.com/users/ivirshup/repos","events_url":"https://api.github.com/users/ivirshup/events{/privacy}","received_events_url":"https://api.github.com/users/ivirshup/received_events","type":"User","site_admin":false},"created_at":"2019-08-27T03:12:55Z","updated_at":"2019-08-27T03:12:55Z","author_association":"MEMBER","body":"Thanks for making these changes! Just a couple more things:\r\n\r\nFirst, the summary method for the lazy pairwise z-test has similar issues to the pairwise rank test:\r\n\r\n```python\r\nimport diffxpy.api as de\r\nimport scanpy as sc\r\n\r\nassert de.__version__ == \"v0.6.12\"\r\n\r\npbmc = sc.datasets.pbmc68k_reduced()\r\npbmc.X = pbmc.raw.X\r\ndet = de.test.pairwise(pbmc, \"bulk_labels\")\r\ndet.summary_pair('CD14+ Monocyte', 'CD19+ B')  # Throws a ValueError\r\ndet.summary_pairs('CD14+ Monocyte', 'CD19+ B')  # Throws an Exception\r\n```\r\n\r\nAnd should the methods `summary_pairs` and `pval_pairs` exist for the result of the pairwise rank test?\r\n\r\n> to make sure that all users understand that there is no way of doing a Wilcoxon rank sum test with a negative binomial noise model and similar for Welch's t-test.\r\n\r\nAh, that makes sense with the way default arguments are documented. My assumption was that the default arguments for any particular test would be the same as that test's standalone function. That is, I would expect to be doing the same kind of test for some `kwargs` when I called:\r\n\r\n```python\r\nde.test.pairwise(adata, kind={testkind}, **kwargs)\r\n# or \r\nde.test.{testkind}_test(adata, **kwargs)\r\n```\r\n\r\nMentally, I associated the keyword arguments with the kind of test being run, as opposed to the particular way it's called. This is just a personal API design preference though.","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/525118328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ivirshup","id":8238804,"node_id":"MDQ6VXNlcjgyMzg4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/8238804?v=4","gravatar_id":"","url":"https://api.github.com/users/ivirshup","html_url":"https://github.com/ivirshup","followers_url":"https://api.github.com/users/ivirshup/followers","following_url":"https://api.github.com/users/ivirshup/following{/other_user}","gists_url":"https://api.github.com/users/ivirshup/gists{/gist_id}","starred_url":"https://api.github.com/users/ivirshup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivirshup/subscriptions","organizations_url":"https://api.github.com/users/ivirshup/orgs","repos_url":"https://api.github.com/users/ivirshup/repos","events_url":"https://api.github.com/users/ivirshup/events{/privacy}","received_events_url":"https://api.github.com/users/ivirshup/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/525383153","html_url":"https://github.com/theislab/diffxpy/issues/108#issuecomment-525383153","issue_url":"https://api.github.com/repos/theislab/diffxpy/issues/108","id":525383153,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNTM4MzE1Mw==","user":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"created_at":"2019-08-27T16:37:04Z","updated_at":"2019-08-27T16:37:04Z","author_association":"MEMBER","body":"Hi @ivirshup, thanks for all of these comments, this is really productive! I just realised that the APIs of the individual pairwise test objects are not exactly the same, I am changing this today so that you can use all of the same accessors, independent of whether it s lazy or not etc. This will also resolve the bugs that you posted.\r\n\r\nHaving a set of default kwargs for a specific type of test would also be a nice alternative, I agree. I ll look into that this week, it will require some double checking that this doesnt cause inconsistent behaviour. Thanks for this suggestions.","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/525383153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false}},{"id":2587742065,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjU4Nzc0MjA2NQ==","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2587742065","actor":{"login":"ivirshup","id":8238804,"node_id":"MDQ6VXNlcjgyMzg4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/8238804?v=4","gravatar_id":"","url":"https://api.github.com/users/ivirshup","html_url":"https://github.com/ivirshup","followers_url":"https://api.github.com/users/ivirshup/followers","following_url":"https://api.github.com/users/ivirshup/following{/other_user}","gists_url":"https://api.github.com/users/ivirshup/gists{/gist_id}","starred_url":"https://api.github.com/users/ivirshup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivirshup/subscriptions","organizations_url":"https://api.github.com/users/ivirshup/orgs","repos_url":"https://api.github.com/users/ivirshup/repos","events_url":"https://api.github.com/users/ivirshup/events{/privacy}","received_events_url":"https://api.github.com/users/ivirshup/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-08-27T16:37:04Z","performed_via_github_app":null},{"id":2587742066,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI1ODc3NDIwNjY=","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/2587742066","actor":{"login":"ivirshup","id":8238804,"node_id":"MDQ6VXNlcjgyMzg4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/8238804?v=4","gravatar_id":"","url":"https://api.github.com/users/ivirshup","html_url":"https://github.com/ivirshup","followers_url":"https://api.github.com/users/ivirshup/followers","following_url":"https://api.github.com/users/ivirshup/following{/other_user}","gists_url":"https://api.github.com/users/ivirshup/gists{/gist_id}","starred_url":"https://api.github.com/users/ivirshup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivirshup/subscriptions","organizations_url":"https://api.github.com/users/ivirshup/orgs","repos_url":"https://api.github.com/users/ivirshup/repos","events_url":"https://api.github.com/users/ivirshup/events{/privacy}","received_events_url":"https://api.github.com/users/ivirshup/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-08-27T16:37:04Z","performed_via_github_app":null}]