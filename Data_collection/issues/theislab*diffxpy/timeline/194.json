[{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/823180158","html_url":"https://github.com/theislab/diffxpy/issues/194#issuecomment-823180158","issue_url":"https://api.github.com/repos/theislab/diffxpy/issues/194","id":823180158,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMzE4MDE1OA==","user":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false},"created_at":"2021-04-20T10:55:39Z","updated_at":"2021-04-22T16:19:18Z","author_association":"MEMBER","body":"@niklaslang and me ran into the same issue, although forcing dense arrays did not work either.","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/823180158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false}},{"id":4618455475,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDYxODQ1NTQ3NQ==","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/4618455475","actor":{"login":"niklaslang","id":46229145,"node_id":"MDQ6VXNlcjQ2MjI5MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/46229145?v=4","gravatar_id":"","url":"https://api.github.com/users/niklaslang","html_url":"https://github.com/niklaslang","followers_url":"https://api.github.com/users/niklaslang/followers","following_url":"https://api.github.com/users/niklaslang/following{/other_user}","gists_url":"https://api.github.com/users/niklaslang/gists{/gist_id}","starred_url":"https://api.github.com/users/niklaslang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niklaslang/subscriptions","organizations_url":"https://api.github.com/users/niklaslang/orgs","repos_url":"https://api.github.com/users/niklaslang/repos","events_url":"https://api.github.com/users/niklaslang/events{/privacy}","received_events_url":"https://api.github.com/users/niklaslang/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-20T10:55:39Z","performed_via_github_app":null},{"id":4618455477,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ2MTg0NTU0Nzc=","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/4618455477","actor":{"login":"niklaslang","id":46229145,"node_id":"MDQ6VXNlcjQ2MjI5MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/46229145?v=4","gravatar_id":"","url":"https://api.github.com/users/niklaslang","html_url":"https://github.com/niklaslang","followers_url":"https://api.github.com/users/niklaslang/followers","following_url":"https://api.github.com/users/niklaslang/following{/other_user}","gists_url":"https://api.github.com/users/niklaslang/gists{/gist_id}","starred_url":"https://api.github.com/users/niklaslang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niklaslang/subscriptions","organizations_url":"https://api.github.com/users/niklaslang/orgs","repos_url":"https://api.github.com/users/niklaslang/repos","events_url":"https://api.github.com/users/niklaslang/events{/privacy}","received_events_url":"https://api.github.com/users/niklaslang/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-20T10:55:39Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/824984106","html_url":"https://github.com/theislab/diffxpy/issues/194#issuecomment-824984106","issue_url":"https://api.github.com/repos/theislab/diffxpy/issues/194","id":824984106,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNDk4NDEwNg==","user":{"login":"oligomyeggo","id":13051802,"node_id":"MDQ6VXNlcjEzMDUxODAy","avatar_url":"https://avatars.githubusercontent.com/u/13051802?v=4","gravatar_id":"","url":"https://api.github.com/users/oligomyeggo","html_url":"https://github.com/oligomyeggo","followers_url":"https://api.github.com/users/oligomyeggo/followers","following_url":"https://api.github.com/users/oligomyeggo/following{/other_user}","gists_url":"https://api.github.com/users/oligomyeggo/gists{/gist_id}","starred_url":"https://api.github.com/users/oligomyeggo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oligomyeggo/subscriptions","organizations_url":"https://api.github.com/users/oligomyeggo/orgs","repos_url":"https://api.github.com/users/oligomyeggo/repos","events_url":"https://api.github.com/users/oligomyeggo/events{/privacy}","received_events_url":"https://api.github.com/users/oligomyeggo/received_events","type":"User","site_admin":false},"created_at":"2021-04-22T16:16:16Z","updated_at":"2021-04-22T16:16:16Z","author_association":"NONE","body":"I am also having this same issue and was wondering if there was any resolution/fix?\r\n\r\nI initially was getting the same error described in issue #145 but I was using diffxpy v0.7.4. I installed diffxpy v0.7.3 instead, and am now getting the `ValueError: All arrays must be instances of SparseArray.` error. I tried including `%env SPARSE_AUTO_DENSIFY=1` but it did not fix the problem.\r\n\r\nNot sure if relevant, but since I saw them listed in issue #145: I have batchglm v0.7.4, sparse v0.12.0 and dask v2021.4.0, which I believe are all the most current versions. Do any of these need to be downgraded as well?","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/824984106/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"oligomyeggo","id":13051802,"node_id":"MDQ6VXNlcjEzMDUxODAy","avatar_url":"https://avatars.githubusercontent.com/u/13051802?v=4","gravatar_id":"","url":"https://api.github.com/users/oligomyeggo","html_url":"https://github.com/oligomyeggo","followers_url":"https://api.github.com/users/oligomyeggo/followers","following_url":"https://api.github.com/users/oligomyeggo/following{/other_user}","gists_url":"https://api.github.com/users/oligomyeggo/gists{/gist_id}","starred_url":"https://api.github.com/users/oligomyeggo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oligomyeggo/subscriptions","organizations_url":"https://api.github.com/users/oligomyeggo/orgs","repos_url":"https://api.github.com/users/oligomyeggo/repos","events_url":"https://api.github.com/users/oligomyeggo/events{/privacy}","received_events_url":"https://api.github.com/users/oligomyeggo/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/824986523","html_url":"https://github.com/theislab/diffxpy/issues/194#issuecomment-824986523","issue_url":"https://api.github.com/repos/theislab/diffxpy/issues/194","id":824986523,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNDk4NjUyMw==","user":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false},"created_at":"2021-04-22T16:19:06Z","updated_at":"2021-04-22T16:19:06Z","author_association":"MEMBER","body":"> \r\n> \r\n> I am also having this same issue and was wondering if there was any resolution/fix?\r\n> \r\n> I initially was getting the same error described in issue #145 but I was using diffxpy v0.7.4. I installed diffxpy v0.7.3 instead, and am now getting the `ValueError: All arrays must be instances of SparseArray.` error. I tried including `%env SPARSE_AUTO_DENSIFY=1` but it did not fix the problem.\r\n> \r\n> Not sure if relevant, but since I saw them listed in issue #145: I have batchglm v0.7.4, sparse v0.12.0 and dask v2021.4.0, which I believe are all the most current versions. Do any of these need to be downgraded as well?\r\n\r\nHey,\r\n\r\nlooks like the issue lies within some seemingly unrelated dependencies. Diffxpy should be more strict here.\r\n\r\nTry to force:\r\n```\r\ndask==2021.4.0\r\nsparse==0.9.1\r\n```\r\n\r\nThis resolved it on our end.","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/824986523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/824987360","html_url":"https://github.com/theislab/diffxpy/issues/194#issuecomment-824987360","issue_url":"https://api.github.com/repos/theislab/diffxpy/issues/194","id":824987360,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNDk4NzM2MA==","user":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false},"created_at":"2021-04-22T16:19:58Z","updated_at":"2021-04-22T16:20:40Z","author_association":"MEMBER","body":"I'll likely submit a PR to pin sparse tomorrow or so.\r\nPlease report back whether this also works for you, @oligomyeggo","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/824987360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false}},{"id":4631932027,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDYzMTkzMjAyNw==","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/4631932027","actor":{"login":"oligomyeggo","id":13051802,"node_id":"MDQ6VXNlcjEzMDUxODAy","avatar_url":"https://avatars.githubusercontent.com/u/13051802?v=4","gravatar_id":"","url":"https://api.github.com/users/oligomyeggo","html_url":"https://github.com/oligomyeggo","followers_url":"https://api.github.com/users/oligomyeggo/followers","following_url":"https://api.github.com/users/oligomyeggo/following{/other_user}","gists_url":"https://api.github.com/users/oligomyeggo/gists{/gist_id}","starred_url":"https://api.github.com/users/oligomyeggo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oligomyeggo/subscriptions","organizations_url":"https://api.github.com/users/oligomyeggo/orgs","repos_url":"https://api.github.com/users/oligomyeggo/repos","events_url":"https://api.github.com/users/oligomyeggo/events{/privacy}","received_events_url":"https://api.github.com/users/oligomyeggo/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-22T16:20:40Z","performed_via_github_app":null},{"id":4631932031,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ2MzE5MzIwMzE=","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/4631932031","actor":{"login":"oligomyeggo","id":13051802,"node_id":"MDQ6VXNlcjEzMDUxODAy","avatar_url":"https://avatars.githubusercontent.com/u/13051802?v=4","gravatar_id":"","url":"https://api.github.com/users/oligomyeggo","html_url":"https://github.com/oligomyeggo","followers_url":"https://api.github.com/users/oligomyeggo/followers","following_url":"https://api.github.com/users/oligomyeggo/following{/other_user}","gists_url":"https://api.github.com/users/oligomyeggo/gists{/gist_id}","starred_url":"https://api.github.com/users/oligomyeggo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oligomyeggo/subscriptions","organizations_url":"https://api.github.com/users/oligomyeggo/orgs","repos_url":"https://api.github.com/users/oligomyeggo/repos","events_url":"https://api.github.com/users/oligomyeggo/events{/privacy}","received_events_url":"https://api.github.com/users/oligomyeggo/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-22T16:20:40Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/825039345","html_url":"https://github.com/theislab/diffxpy/issues/194#issuecomment-825039345","issue_url":"https://api.github.com/repos/theislab/diffxpy/issues/194","id":825039345,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNTAzOTM0NQ==","user":{"login":"oligomyeggo","id":13051802,"node_id":"MDQ6VXNlcjEzMDUxODAy","avatar_url":"https://avatars.githubusercontent.com/u/13051802?v=4","gravatar_id":"","url":"https://api.github.com/users/oligomyeggo","html_url":"https://github.com/oligomyeggo","followers_url":"https://api.github.com/users/oligomyeggo/followers","following_url":"https://api.github.com/users/oligomyeggo/following{/other_user}","gists_url":"https://api.github.com/users/oligomyeggo/gists{/gist_id}","starred_url":"https://api.github.com/users/oligomyeggo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oligomyeggo/subscriptions","organizations_url":"https://api.github.com/users/oligomyeggo/orgs","repos_url":"https://api.github.com/users/oligomyeggo/repos","events_url":"https://api.github.com/users/oligomyeggo/events{/privacy}","received_events_url":"https://api.github.com/users/oligomyeggo/received_events","type":"User","site_admin":false},"created_at":"2021-04-22T17:17:56Z","updated_at":"2021-04-22T17:17:56Z","author_association":"NONE","body":"Thanks @Zethson! Forcing `dask==2021.4.0` and `sparse==0.9.1` worked for me for both `diffxpy==0.7.3` and `diffxpy==0.7.4`. Though now I am hitting a new error which also seems potentially related (?). I am following [this tutorial](https://nbviewer.jupyter.org/github/theislab/diffxpy_tutorials/blob/master/diffxpy_tutorials/test/introduction_differential_testing.ipynb) (the first portion, for the standard Wald test), and now everything is working up until the `test.plot_vs_ttest()` function, which is returning the following error:\r\n\r\n`ValueError: Performing a mixed sparse-dense operation that would result in a dense array. Please make sure that func(sparse_fill_values, ndarrays) is a constant array.`\r\n\r\nThis occurred with both `diffxpy==0.7.3` and `diffxpy==0.7.4`.","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/825039345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"oligomyeggo","id":13051802,"node_id":"MDQ6VXNlcjEzMDUxODAy","avatar_url":"https://avatars.githubusercontent.com/u/13051802?v=4","gravatar_id":"","url":"https://api.github.com/users/oligomyeggo","html_url":"https://github.com/oligomyeggo","followers_url":"https://api.github.com/users/oligomyeggo/followers","following_url":"https://api.github.com/users/oligomyeggo/following{/other_user}","gists_url":"https://api.github.com/users/oligomyeggo/gists{/gist_id}","starred_url":"https://api.github.com/users/oligomyeggo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oligomyeggo/subscriptions","organizations_url":"https://api.github.com/users/oligomyeggo/orgs","repos_url":"https://api.github.com/users/oligomyeggo/repos","events_url":"https://api.github.com/users/oligomyeggo/events{/privacy}","received_events_url":"https://api.github.com/users/oligomyeggo/received_events","type":"User","site_admin":false}},{"id":4632326759,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDYzMjMyNjc1OQ==","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/4632326759","actor":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-22T17:17:56Z","performed_via_github_app":null},{"id":4632326766,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ2MzIzMjY3NjY=","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/4632326766","actor":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-22T17:17:56Z","performed_via_github_app":null},{"id":4819423631,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ4MTk0MjM2MzE=","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/4819423631","actor":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false},"event":"referenced","commit_id":"6f00abb341bb608aac7adda0ce82c2430db206f0","commit_url":"https://api.github.com/repos/theislab/diffxpy/commits/6f00abb341bb608aac7adda0ce82c2430db206f0","created_at":"2021-05-31T08:48:36Z","performed_via_github_app":null},{"actor":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false},"created_at":"2021-05-31T08:48:58Z","updated_at":"2021-05-31T08:48:58Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/200","repository_url":"https://api.github.com/repos/theislab/diffxpy","labels_url":"https://api.github.com/repos/theislab/diffxpy/issues/200/labels{/name}","comments_url":"https://api.github.com/repos/theislab/diffxpy/issues/200/comments","events_url":"https://api.github.com/repos/theislab/diffxpy/issues/200/events","html_url":"https://github.com/theislab/diffxpy/pull/200","id":907258214,"node_id":"MDExOlB1bGxSZXF1ZXN0NjU4MTMzMjMw","number":200,"title":"pin sparse to 0.9.1","user":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-05-31T08:48:57Z","updated_at":"2021-06-15T10:22:52Z","closed_at":"2021-05-31T13:18:54Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"repository":{"id":139462224,"node_id":"MDEwOlJlcG9zaXRvcnkxMzk0NjIyMjQ=","name":"diffxpy","full_name":"theislab/diffxpy","private":false,"owner":{"login":"theislab","id":22319415,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIyMzE5NDE1","avatar_url":"https://avatars.githubusercontent.com/u/22319415?v=4","gravatar_id":"","url":"https://api.github.com/users/theislab","html_url":"https://github.com/theislab","followers_url":"https://api.github.com/users/theislab/followers","following_url":"https://api.github.com/users/theislab/following{/other_user}","gists_url":"https://api.github.com/users/theislab/gists{/gist_id}","starred_url":"https://api.github.com/users/theislab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/theislab/subscriptions","organizations_url":"https://api.github.com/users/theislab/orgs","repos_url":"https://api.github.com/users/theislab/repos","events_url":"https://api.github.com/users/theislab/events{/privacy}","received_events_url":"https://api.github.com/users/theislab/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/theislab/diffxpy","description":"Differential expression analysis for single-cell RNA-seq data.","fork":false,"url":"https://api.github.com/repos/theislab/diffxpy","forks_url":"https://api.github.com/repos/theislab/diffxpy/forks","keys_url":"https://api.github.com/repos/theislab/diffxpy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/theislab/diffxpy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/theislab/diffxpy/teams","hooks_url":"https://api.github.com/repos/theislab/diffxpy/hooks","issue_events_url":"https://api.github.com/repos/theislab/diffxpy/issues/events{/number}","events_url":"https://api.github.com/repos/theislab/diffxpy/events","assignees_url":"https://api.github.com/repos/theislab/diffxpy/assignees{/user}","branches_url":"https://api.github.com/repos/theislab/diffxpy/branches{/branch}","tags_url":"https://api.github.com/repos/theislab/diffxpy/tags","blobs_url":"https://api.github.com/repos/theislab/diffxpy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/theislab/diffxpy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/theislab/diffxpy/git/refs{/sha}","trees_url":"https://api.github.com/repos/theislab/diffxpy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/theislab/diffxpy/statuses/{sha}","languages_url":"https://api.github.com/repos/theislab/diffxpy/languages","stargazers_url":"https://api.github.com/repos/theislab/diffxpy/stargazers","contributors_url":"https://api.github.com/repos/theislab/diffxpy/contributors","subscribers_url":"https://api.github.com/repos/theislab/diffxpy/subscribers","subscription_url":"https://api.github.com/repos/theislab/diffxpy/subscription","commits_url":"https://api.github.com/repos/theislab/diffxpy/commits{/sha}","git_commits_url":"https://api.github.com/repos/theislab/diffxpy/git/commits{/sha}","comments_url":"https://api.github.com/repos/theislab/diffxpy/comments{/number}","issue_comment_url":"https://api.github.com/repos/theislab/diffxpy/issues/comments{/number}","contents_url":"https://api.github.com/repos/theislab/diffxpy/contents/{+path}","compare_url":"https://api.github.com/repos/theislab/diffxpy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/theislab/diffxpy/merges","archive_url":"https://api.github.com/repos/theislab/diffxpy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/theislab/diffxpy/downloads","issues_url":"https://api.github.com/repos/theislab/diffxpy/issues{/number}","pulls_url":"https://api.github.com/repos/theislab/diffxpy/pulls{/number}","milestones_url":"https://api.github.com/repos/theislab/diffxpy/milestones{/number}","notifications_url":"https://api.github.com/repos/theislab/diffxpy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/theislab/diffxpy/labels{/name}","releases_url":"https://api.github.com/repos/theislab/diffxpy/releases{/id}","deployments_url":"https://api.github.com/repos/theislab/diffxpy/deployments","created_at":"2018-07-02T15:37:56Z","updated_at":"2023-01-13T22:49:58Z","pushed_at":"2022-10-11T02:41:42Z","git_url":"git://github.com/theislab/diffxpy.git","ssh_url":"git@github.com:theislab/diffxpy.git","clone_url":"https://github.com/theislab/diffxpy.git","svn_url":"https://github.com/theislab/diffxpy","homepage":"https://diffxpy.rtfd.io","size":1794,"stargazers_count":143,"watchers_count":143,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":21,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":102,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause","node_id":"MDc6TGljZW5zZTU="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bioinformatics","differential-expression","gene-set-enrichment","single-cell-rna-seq","tensorflow","transcriptomics"],"visibility":"public","forks":21,"open_issues":102,"watchers":143,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/theislab/diffxpy/pulls/200","html_url":"https://github.com/theislab/diffxpy/pull/200","diff_url":"https://github.com/theislab/diffxpy/pull/200.diff","patch_url":"https://github.com/theislab/diffxpy/pull/200.patch","merged_at":"2021-05-31T13:18:54Z"},"body":"fixes #194\r\n\r\nNot quite sure where sparse comes from, but I think that a pin in the final package should work either way.","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/theislab/diffxpy/issues/200/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/851331639","html_url":"https://github.com/theislab/diffxpy/issues/194#issuecomment-851331639","issue_url":"https://api.github.com/repos/theislab/diffxpy/issues/194","id":851331639,"node_id":"MDEyOklzc3VlQ29tbWVudDg1MTMzMTYzOQ==","user":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false},"created_at":"2021-05-31T08:50:45Z","updated_at":"2021-05-31T08:50:45Z","author_association":"MEMBER","body":"> Thanks @Zethson! Forcing `dask==2021.4.0` and `sparse==0.9.1` worked for me for both `diffxpy==0.7.3` and `diffxpy==0.7.4`. Though now I am hitting a new error which also seems potentially related (?). I am following [this tutorial](https://nbviewer.jupyter.org/github/theislab/diffxpy_tutorials/blob/master/diffxpy_tutorials/test/introduction_differential_testing.ipynb) (the first portion, for the standard Wald test), and now everything is working up until the `test.plot_vs_ttest()` function, which is returning the following error:\r\n> \r\n> `ValueError: Performing a mixed sparse-dense operation that would result in a dense array. Please make sure that func(sparse_fill_values, ndarrays) is a constant array.`\r\n> \r\n> This occurred with both `diffxpy==0.7.3` and `diffxpy==0.7.4`.\r\n\r\nI'd suggest to create a new issue for this.","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/comments/851331639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false}},{"id":4819434973,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDgxOTQzNDk3Mw==","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/4819434973","actor":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-05-31T08:50:45Z","performed_via_github_app":null},{"id":4819434979,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ4MTk0MzQ5Nzk=","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/4819434979","actor":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-05-31T08:50:46Z","performed_via_github_app":null},{"id":4820651241,"node_id":"MDExOkNsb3NlZEV2ZW50NDgyMDY1MTI0MQ==","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/4820651241","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-05-31T13:18:54Z","state_reason":null,"performed_via_github_app":null},{"actor":{"login":"Zethson","id":21954664,"node_id":"MDQ6VXNlcjIxOTU0NjY0","avatar_url":"https://avatars.githubusercontent.com/u/21954664?v=4","gravatar_id":"","url":"https://api.github.com/users/Zethson","html_url":"https://github.com/Zethson","followers_url":"https://api.github.com/users/Zethson/followers","following_url":"https://api.github.com/users/Zethson/following{/other_user}","gists_url":"https://api.github.com/users/Zethson/gists{/gist_id}","starred_url":"https://api.github.com/users/Zethson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zethson/subscriptions","organizations_url":"https://api.github.com/users/Zethson/orgs","repos_url":"https://api.github.com/users/Zethson/repos","events_url":"https://api.github.com/users/Zethson/events{/privacy}","received_events_url":"https://api.github.com/users/Zethson/received_events","type":"User","site_admin":false},"created_at":"2021-12-06T11:30:00Z","updated_at":"2021-12-06T11:30:00Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/212","repository_url":"https://api.github.com/repos/theislab/diffxpy","labels_url":"https://api.github.com/repos/theislab/diffxpy/issues/212/labels{/name}","comments_url":"https://api.github.com/repos/theislab/diffxpy/issues/212/comments","events_url":"https://api.github.com/repos/theislab/diffxpy/issues/212/events","html_url":"https://github.com/theislab/diffxpy/issues/212","id":1071408110,"node_id":"I_kwDOCFAGUM4_3GPu","number":212,"title":"TypeError: full_like() got an unexpected keyword argument 'shape' when running de.test.wald()","user":{"login":"niklaslang","id":46229145,"node_id":"MDQ6VXNlcjQ2MjI5MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/46229145?v=4","gravatar_id":"","url":"https://api.github.com/users/niklaslang","html_url":"https://github.com/niklaslang","followers_url":"https://api.github.com/users/niklaslang/followers","following_url":"https://api.github.com/users/niklaslang/following{/other_user}","gists_url":"https://api.github.com/users/niklaslang/gists{/gist_id}","starred_url":"https://api.github.com/users/niklaslang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niklaslang/subscriptions","organizations_url":"https://api.github.com/users/niklaslang/orgs","repos_url":"https://api.github.com/users/niklaslang/repos","events_url":"https://api.github.com/users/niklaslang/events{/privacy}","received_events_url":"https://api.github.com/users/niklaslang/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2021-12-05T09:07:37Z","updated_at":"2021-12-06T11:37:52Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"repository":{"id":139462224,"node_id":"MDEwOlJlcG9zaXRvcnkxMzk0NjIyMjQ=","name":"diffxpy","full_name":"theislab/diffxpy","private":false,"owner":{"login":"theislab","id":22319415,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIyMzE5NDE1","avatar_url":"https://avatars.githubusercontent.com/u/22319415?v=4","gravatar_id":"","url":"https://api.github.com/users/theislab","html_url":"https://github.com/theislab","followers_url":"https://api.github.com/users/theislab/followers","following_url":"https://api.github.com/users/theislab/following{/other_user}","gists_url":"https://api.github.com/users/theislab/gists{/gist_id}","starred_url":"https://api.github.com/users/theislab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/theislab/subscriptions","organizations_url":"https://api.github.com/users/theislab/orgs","repos_url":"https://api.github.com/users/theislab/repos","events_url":"https://api.github.com/users/theislab/events{/privacy}","received_events_url":"https://api.github.com/users/theislab/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/theislab/diffxpy","description":"Differential expression analysis for single-cell RNA-seq data.","fork":false,"url":"https://api.github.com/repos/theislab/diffxpy","forks_url":"https://api.github.com/repos/theislab/diffxpy/forks","keys_url":"https://api.github.com/repos/theislab/diffxpy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/theislab/diffxpy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/theislab/diffxpy/teams","hooks_url":"https://api.github.com/repos/theislab/diffxpy/hooks","issue_events_url":"https://api.github.com/repos/theislab/diffxpy/issues/events{/number}","events_url":"https://api.github.com/repos/theislab/diffxpy/events","assignees_url":"https://api.github.com/repos/theislab/diffxpy/assignees{/user}","branches_url":"https://api.github.com/repos/theislab/diffxpy/branches{/branch}","tags_url":"https://api.github.com/repos/theislab/diffxpy/tags","blobs_url":"https://api.github.com/repos/theislab/diffxpy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/theislab/diffxpy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/theislab/diffxpy/git/refs{/sha}","trees_url":"https://api.github.com/repos/theislab/diffxpy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/theislab/diffxpy/statuses/{sha}","languages_url":"https://api.github.com/repos/theislab/diffxpy/languages","stargazers_url":"https://api.github.com/repos/theislab/diffxpy/stargazers","contributors_url":"https://api.github.com/repos/theislab/diffxpy/contributors","subscribers_url":"https://api.github.com/repos/theislab/diffxpy/subscribers","subscription_url":"https://api.github.com/repos/theislab/diffxpy/subscription","commits_url":"https://api.github.com/repos/theislab/diffxpy/commits{/sha}","git_commits_url":"https://api.github.com/repos/theislab/diffxpy/git/commits{/sha}","comments_url":"https://api.github.com/repos/theislab/diffxpy/comments{/number}","issue_comment_url":"https://api.github.com/repos/theislab/diffxpy/issues/comments{/number}","contents_url":"https://api.github.com/repos/theislab/diffxpy/contents/{+path}","compare_url":"https://api.github.com/repos/theislab/diffxpy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/theislab/diffxpy/merges","archive_url":"https://api.github.com/repos/theislab/diffxpy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/theislab/diffxpy/downloads","issues_url":"https://api.github.com/repos/theislab/diffxpy/issues{/number}","pulls_url":"https://api.github.com/repos/theislab/diffxpy/pulls{/number}","milestones_url":"https://api.github.com/repos/theislab/diffxpy/milestones{/number}","notifications_url":"https://api.github.com/repos/theislab/diffxpy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/theislab/diffxpy/labels{/name}","releases_url":"https://api.github.com/repos/theislab/diffxpy/releases{/id}","deployments_url":"https://api.github.com/repos/theislab/diffxpy/deployments","created_at":"2018-07-02T15:37:56Z","updated_at":"2023-01-13T22:49:58Z","pushed_at":"2022-10-11T02:41:42Z","git_url":"git://github.com/theislab/diffxpy.git","ssh_url":"git@github.com:theislab/diffxpy.git","clone_url":"https://github.com/theislab/diffxpy.git","svn_url":"https://github.com/theislab/diffxpy","homepage":"https://diffxpy.rtfd.io","size":1794,"stargazers_count":143,"watchers_count":143,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":21,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":102,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause","node_id":"MDc6TGljZW5zZTU="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bioinformatics","differential-expression","gene-set-enrichment","single-cell-rna-seq","tensorflow","transcriptomics"],"visibility":"public","forks":21,"open_issues":102,"watchers":143,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Hi David,\r\n\r\nAfter using diffxpy for quite some time now, I am using it on a new machine now and\r\nI'm running into the following the error when running diffxpy's `de.test.wald()`:\r\n`de.test.wald(data = adata_raw.X,\r\n                               formula_loc = '~ 1 + treatment',\r\n                               factor_loc_totest = 'treatment',\r\n                               gene_names = adata_raw.var_names,\r\n                               sample_description = adata_raw.obs,\r\n                               noise_model = 'nb',\r\n                               size_factors = 'n_counts_scaled')`\r\n\r\nTypeError: full_like() got an unexpected keyword argument 'shape'\r\n\r\nI'm running diffxpy==0.7.4 and batchglm==0.7.4 as well as \r\nscanpy==1.8.1 anndata==0.7.6 umap==0.5.1 numpy==1.20.3 scipy==1.7.1 pandas==1.3.3 scikit-learn==1.0.1 statsmodels==0.12.2 pynndescent==0.5.4.\r\n\r\nAny help is greatly appreciated. Thank you so much!","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/theislab/diffxpy/issues/212/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":7140887943,"node_id":"REFE_lADOCFAGUM4yIv1SzwAAAAGpoU2H","url":"https://api.github.com/repos/theislab/diffxpy/issues/events/7140887943","actor":{"login":"davidsebfischer","id":11200205,"node_id":"MDQ6VXNlcjExMjAwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/11200205?v=4","gravatar_id":"","url":"https://api.github.com/users/davidsebfischer","html_url":"https://github.com/davidsebfischer","followers_url":"https://api.github.com/users/davidsebfischer/followers","following_url":"https://api.github.com/users/davidsebfischer/following{/other_user}","gists_url":"https://api.github.com/users/davidsebfischer/gists{/gist_id}","starred_url":"https://api.github.com/users/davidsebfischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidsebfischer/subscriptions","organizations_url":"https://api.github.com/users/davidsebfischer/orgs","repos_url":"https://api.github.com/users/davidsebfischer/repos","events_url":"https://api.github.com/users/davidsebfischer/events{/privacy}","received_events_url":"https://api.github.com/users/davidsebfischer/received_events","type":"User","site_admin":false},"event":"referenced","commit_id":"f2b167718954ce4a7c1978754259f260134e330d","commit_url":"https://api.github.com/repos/theislab/diffxpy/commits/f2b167718954ce4a7c1978754259f260134e330d","created_at":"2022-08-06T12:07:42Z","performed_via_github_app":null},{"actor":{"login":"merelkuijs","id":91097523,"node_id":"MDQ6VXNlcjkxMDk3NTIz","avatar_url":"https://avatars.githubusercontent.com/u/91097523?v=4","gravatar_id":"","url":"https://api.github.com/users/merelkuijs","html_url":"https://github.com/merelkuijs","followers_url":"https://api.github.com/users/merelkuijs/followers","following_url":"https://api.github.com/users/merelkuijs/following{/other_user}","gists_url":"https://api.github.com/users/merelkuijs/gists{/gist_id}","starred_url":"https://api.github.com/users/merelkuijs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/merelkuijs/subscriptions","organizations_url":"https://api.github.com/users/merelkuijs/orgs","repos_url":"https://api.github.com/users/merelkuijs/repos","events_url":"https://api.github.com/users/merelkuijs/events{/privacy}","received_events_url":"https://api.github.com/users/merelkuijs/received_events","type":"User","site_admin":false},"created_at":"2022-11-28T16:49:47Z","updated_at":"2022-11-28T16:49:47Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/217","repository_url":"https://api.github.com/repos/theislab/diffxpy","labels_url":"https://api.github.com/repos/theislab/diffxpy/issues/217/labels{/name}","comments_url":"https://api.github.com/repos/theislab/diffxpy/issues/217/comments","events_url":"https://api.github.com/repos/theislab/diffxpy/issues/217/events","html_url":"https://github.com/theislab/diffxpy/issues/217","id":1209885969,"node_id":"I_kwDOCFAGUM5IHWUR","number":217,"title":"RuntimeError: Cannot convert a sparse array to dense automatically. To manually densify, use the todense method.","user":{"login":"SimaDubnov","id":76960862,"node_id":"MDQ6VXNlcjc2OTYwODYy","avatar_url":"https://avatars.githubusercontent.com/u/76960862?v=4","gravatar_id":"","url":"https://api.github.com/users/SimaDubnov","html_url":"https://github.com/SimaDubnov","followers_url":"https://api.github.com/users/SimaDubnov/followers","following_url":"https://api.github.com/users/SimaDubnov/following{/other_user}","gists_url":"https://api.github.com/users/SimaDubnov/gists{/gist_id}","starred_url":"https://api.github.com/users/SimaDubnov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SimaDubnov/subscriptions","organizations_url":"https://api.github.com/users/SimaDubnov/orgs","repos_url":"https://api.github.com/users/SimaDubnov/repos","events_url":"https://api.github.com/users/SimaDubnov/events{/privacy}","received_events_url":"https://api.github.com/users/SimaDubnov/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-04-20T15:55:39Z","updated_at":"2022-11-28T16:49:48Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"repository":{"id":139462224,"node_id":"MDEwOlJlcG9zaXRvcnkxMzk0NjIyMjQ=","name":"diffxpy","full_name":"theislab/diffxpy","private":false,"owner":{"login":"theislab","id":22319415,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIyMzE5NDE1","avatar_url":"https://avatars.githubusercontent.com/u/22319415?v=4","gravatar_id":"","url":"https://api.github.com/users/theislab","html_url":"https://github.com/theislab","followers_url":"https://api.github.com/users/theislab/followers","following_url":"https://api.github.com/users/theislab/following{/other_user}","gists_url":"https://api.github.com/users/theislab/gists{/gist_id}","starred_url":"https://api.github.com/users/theislab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/theislab/subscriptions","organizations_url":"https://api.github.com/users/theislab/orgs","repos_url":"https://api.github.com/users/theislab/repos","events_url":"https://api.github.com/users/theislab/events{/privacy}","received_events_url":"https://api.github.com/users/theislab/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/theislab/diffxpy","description":"Differential expression analysis for single-cell RNA-seq data.","fork":false,"url":"https://api.github.com/repos/theislab/diffxpy","forks_url":"https://api.github.com/repos/theislab/diffxpy/forks","keys_url":"https://api.github.com/repos/theislab/diffxpy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/theislab/diffxpy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/theislab/diffxpy/teams","hooks_url":"https://api.github.com/repos/theislab/diffxpy/hooks","issue_events_url":"https://api.github.com/repos/theislab/diffxpy/issues/events{/number}","events_url":"https://api.github.com/repos/theislab/diffxpy/events","assignees_url":"https://api.github.com/repos/theislab/diffxpy/assignees{/user}","branches_url":"https://api.github.com/repos/theislab/diffxpy/branches{/branch}","tags_url":"https://api.github.com/repos/theislab/diffxpy/tags","blobs_url":"https://api.github.com/repos/theislab/diffxpy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/theislab/diffxpy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/theislab/diffxpy/git/refs{/sha}","trees_url":"https://api.github.com/repos/theislab/diffxpy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/theislab/diffxpy/statuses/{sha}","languages_url":"https://api.github.com/repos/theislab/diffxpy/languages","stargazers_url":"https://api.github.com/repos/theislab/diffxpy/stargazers","contributors_url":"https://api.github.com/repos/theislab/diffxpy/contributors","subscribers_url":"https://api.github.com/repos/theislab/diffxpy/subscribers","subscription_url":"https://api.github.com/repos/theislab/diffxpy/subscription","commits_url":"https://api.github.com/repos/theislab/diffxpy/commits{/sha}","git_commits_url":"https://api.github.com/repos/theislab/diffxpy/git/commits{/sha}","comments_url":"https://api.github.com/repos/theislab/diffxpy/comments{/number}","issue_comment_url":"https://api.github.com/repos/theislab/diffxpy/issues/comments{/number}","contents_url":"https://api.github.com/repos/theislab/diffxpy/contents/{+path}","compare_url":"https://api.github.com/repos/theislab/diffxpy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/theislab/diffxpy/merges","archive_url":"https://api.github.com/repos/theislab/diffxpy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/theislab/diffxpy/downloads","issues_url":"https://api.github.com/repos/theislab/diffxpy/issues{/number}","pulls_url":"https://api.github.com/repos/theislab/diffxpy/pulls{/number}","milestones_url":"https://api.github.com/repos/theislab/diffxpy/milestones{/number}","notifications_url":"https://api.github.com/repos/theislab/diffxpy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/theislab/diffxpy/labels{/name}","releases_url":"https://api.github.com/repos/theislab/diffxpy/releases{/id}","deployments_url":"https://api.github.com/repos/theislab/diffxpy/deployments","created_at":"2018-07-02T15:37:56Z","updated_at":"2023-01-13T22:49:58Z","pushed_at":"2022-10-11T02:41:42Z","git_url":"git://github.com/theislab/diffxpy.git","ssh_url":"git@github.com:theislab/diffxpy.git","clone_url":"https://github.com/theislab/diffxpy.git","svn_url":"https://github.com/theislab/diffxpy","homepage":"https://diffxpy.rtfd.io","size":1794,"stargazers_count":143,"watchers_count":143,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":21,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":102,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause","node_id":"MDc6TGljZW5zZTU="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bioinformatics","differential-expression","gene-set-enrichment","single-cell-rna-seq","tensorflow","transcriptomics"],"visibility":"public","forks":21,"open_issues":102,"watchers":143,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Hi!\r\nI get this error when running a very simple wald test. I saw that you solved the same problem two years ago but didn't publish how exactly. Could you please guide me here too?\r\n\r\nHere is the whole error:\r\n\r\nRuntimeError                              Traceback (most recent call last)\r\nInput In [26], in <cell line: 1>()\r\n----> 1 test=de.test.wald(data=data_Ast, formula_loc='~1 + AD', factor_loc_totest='AD')\r\n\r\nFile ~/.conda/envs/scRNAseq/lib/python3.10/site-packages/diffxpy/testing/tests.py:717, in wald(data, factor_loc_totest, coef_to_test, formula_loc, formula_scale, as_numeric, init_a, init_b, gene_names, sample_description, dmat_loc, dmat_scale, constraints_loc, constraints_scale, noise_model, size_factors, batch_size, backend, train_args, training_strategy, quick_scale, dtype, **kwargs)\r\n    714 col_indices = np.array([np.where(constraints_loc_temp[x, :] == 1)[0][0] for x in col_indices])\r\n    716 # Fit model.\r\n--> 717 model = _fit(\r\n    718     noise_model=noise_model,\r\n    719     data=data,\r\n    720     design_loc=design_loc,\r\n    721     design_scale=design_scale,\r\n    722     design_loc_names=design_loc_names,\r\n    723     design_scale_names=design_scale_names,\r\n    724     constraints_loc=constraints_loc,\r\n    725     constraints_scale=constraints_scale,\r\n    726     init_a=init_a,\r\n    727     init_b=init_b,\r\n    728     gene_names=gene_names,\r\n    729     size_factors=size_factors,\r\n    730     batch_size=batch_size,\r\n    731     backend=backend,\r\n    732     train_args=train_args,\r\n    733     training_strategy=training_strategy,\r\n    734     quick_scale=quick_scale,\r\n    735     dtype=dtype,\r\n    736     **kwargs,\r\n    737 )\r\n    739 # Prepare differential expression test.\r\n    740 de_test = DifferentialExpressionTestWald(\r\n    741     model_estim=model,\r\n    742     col_indices=col_indices,\r\n    743     noise_model=noise_model,\r\n    744     sample_description=sample_description\r\n    745 )\r\n\r\nFile ~/.conda/envs/scRNAseq/lib/python3.10/site-packages/diffxpy/testing/tests.py:222, in _fit(noise_model, data, design_loc, design_scale, design_loc_names, design_scale_names, constraints_loc, constraints_scale, init_model, init_a, init_b, gene_names, size_factors, batch_size, backend, training_strategy, quick_scale, train_args, close_session, dtype)\r\n    219 else:\r\n    220     raise ValueError('backend=\"%s\" not recognized.' % backend)\r\n--> 222 estim = Estimator(\r\n    223     input_data=input_data,\r\n    224     init_a=init_a,\r\n    225     init_b=init_b,\r\n    226     dtype=dtype,\r\n    227     **constructor_args\r\n    228 )\r\n    229 estim.initialize()\r\n    231 # Assemble backend specific key word arguments to training function:\r\n\r\nFile ~/.conda/envs/scRNAseq/lib/python3.10/site-packages/batchglm/train/numpy/glm_nb/estimator.py:59, in Estimator.__init__(self, input_data, init_a, init_b, batch_size, quick_scale, dtype, **kwargs)\r\n     19 def __init__(\r\n     20         self,\r\n     21         input_data: InputDataGLM,\r\n   (...)\r\n     27         **kwargs\r\n     28 ):\r\n     29     \"\"\"\r\n     30     Performs initialisation and creates a new estimator.\r\n     31 \r\n   (...)\r\n     57     :param dtype: Numerical precision.\r\n     58     \"\"\"\r\n---> 59     init_a, init_b, train_loc, train_scale = init_par(\r\n     60         input_data=input_data,\r\n     61         init_a=init_a,\r\n     62         init_b=init_b,\r\n     63         init_model=None\r\n     64     )\r\n     65     self._train_loc = train_loc\r\n     66     self._train_scale = train_scale\r\n\r\nFile ~/.conda/envs/scRNAseq/lib/python3.10/site-packages/batchglm/models/glm_nb/utils.py:120, in init_par(input_data, init_a, init_b, init_model)\r\n    117     init_a = \"standard\" if not one_hot else \"closed_form\"\r\n    119 if init_a.lower() == \"closed_form\":\r\n--> 120     groupwise_means, init_a, rmsd_a = closedform_nb_glm_logmu(\r\n    121         x=input_data.x,\r\n    122         design_loc=input_data.design_loc,\r\n    123         constraints_loc=input_data.constraints_loc,\r\n    124         size_factors=input_data.size_factors,\r\n    125         link_fn=lambda mu: np.log(mu+np.nextafter(0, 1, dtype=mu.dtype))\r\n    126     )\r\n    128     # train mu, if the closed-form solution is inaccurate\r\n    129     train_loc = not (np.all(np.abs(rmsd_a) < 1e-20) or rmsd_a.size == 0)\r\n\r\nFile ~/.conda/envs/scRNAseq/lib/python3.10/site-packages/batchglm/models/glm_nb/utils.py:30, in closedform_nb_glm_logmu(x, design_loc, constraints_loc, size_factors, link_fn, inv_link_fn)\r\n     10 def closedform_nb_glm_logmu(\r\n     11         x: Union[np.ndarray, scipy.sparse.csr_matrix],\r\n     12         design_loc: np.ndarray,\r\n   (...)\r\n     16         inv_link_fn=np.exp\r\n     17 ):\r\n     18     r\"\"\"\r\n     19     Calculates a closed-form solution for the `mu` parameters of negative-binomial GLMs.\r\n     20 \r\n   (...)\r\n     28     :return: tuple: (groupwise_means, mu, rmsd)\r\n     29     \"\"\"\r\n---> 30     return closedform_glm_mean(\r\n     31         x=x,\r\n     32         dmat=design_loc,\r\n     33         constraints=constraints_loc,\r\n     34         size_factors=size_factors,\r\n     35         link_fn=link_fn,\r\n     36         inv_link_fn=inv_link_fn\r\n     37     )\r\n\r\nFile ~/.conda/envs/scRNAseq/lib/python3.10/site-packages/batchglm/models/base_glm/utils.py:118, in closedform_glm_mean(x, dmat, constraints, size_factors, link_fn, inv_link_fn)\r\n    115     else:\r\n    116         return link_fn(groupwise_means)\r\n--> 118 linker_groupwise_means, mu, rmsd, rank, s = groupwise_solve_lm(\r\n    119     dmat=dmat,\r\n    120     apply_fun=apply_fun,\r\n    121     constraints=constraints\r\n    122 )\r\n    123 if inv_link_fn is not None:\r\n    124     return inv_link_fn(linker_groupwise_means), mu, rmsd\r\n\r\nFile ~/.conda/envs/scRNAseq/lib/python3.10/site-packages/batchglm/utils/linalg.py:93, in groupwise_solve_lm(dmat, apply_fun, constraints)\r\n     89     logger.error(\"model is not full rank!\")\r\n     91 # Get group-wise means in linker space based on group assignments\r\n     92 # based on unique rows of design matrix:\r\n---> 93 params = apply_fun(inverse_idx)\r\n     95 # Use least-squares solver to compute model parameterization\r\n     96 # accounting for dependent parameters, ie. degrees of freedom\r\n     97 # of the model which appear as groups in the design matrix\r\n   (...)\r\n    100 # <X, <theta, H> = means -> <X, theta>, H> = means -> lstsqs for theta\r\n    101 # (This is faster and more accurate than using matrix inversion.)\r\n    102 logger.debug(\" ** Solve lstsq problem\")\r\n\r\nFile ~/.conda/envs/scRNAseq/lib/python3.10/site-packages/batchglm/models/base_glm/utils.py:109, in closedform_glm_mean.<locals>.apply_fun(grouping)\r\n    108 def apply_fun(grouping):\r\n--> 109     groupwise_means = np.asarray(np.vstack([\r\n    110         np.mean(x[np.where(grouping == g)[0], :], axis=0)\r\n    111         for g in np.unique(grouping)\r\n    112     ]))\r\n    113     if link_fn is None:\r\n    114         return groupwise_means\r\n\r\nFile ~/.conda/envs/scRNAseq/lib/python3.10/site-packages/dask/array/core.py:1642, in Array.__array__(self, dtype, **kwargs)\r\n   1640     x = x.astype(dtype)\r\n   1641 if not isinstance(x, np.ndarray):\r\n-> 1642     x = np.array(x)\r\n   1643 return x\r\n\r\nFile ~/.conda/envs/scRNAseq/lib/python3.10/site-packages/sparse/_sparse_array.py:229, in SparseArray.__array__(self, *args, **kwargs)\r\n    226 from ._settings import AUTO_DENSIFY\r\n    228 if not AUTO_DENSIFY:\r\n--> 229     raise RuntimeError(\r\n    230         \"Cannot convert a sparse array to dense automatically. \"\r\n    231         \"To manually densify, use the todense method.\"\r\n    232     )\r\n    234 return np.asarray(self.todense(), *args, **kwargs)\r\n\r\nRuntimeError: Cannot convert a sparse array to dense automatically. To manually densify, use the todense method.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/theislab/diffxpy/issues/217/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/theislab/diffxpy/issues/217/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"}]