{"url":"https://api.github.com/repos/lufficc/SSD/issues/182","repository_url":"https://api.github.com/repos/lufficc/SSD","labels_url":"https://api.github.com/repos/lufficc/SSD/issues/182/labels{/name}","comments_url":"https://api.github.com/repos/lufficc/SSD/issues/182/comments","events_url":"https://api.github.com/repos/lufficc/SSD/issues/182/events","html_url":"https://github.com/lufficc/SSD/issues/182","id":728180528,"node_id":"MDU6SXNzdWU3MjgxODA1Mjg=","number":182,"title":"Wrong resizing of boxes?","user":{"login":"Shakesbeer333","id":50136885,"node_id":"MDQ6VXNlcjUwMTM2ODg1","avatar_url":"https://avatars.githubusercontent.com/u/50136885?v=4","gravatar_id":"","url":"https://api.github.com/users/Shakesbeer333","html_url":"https://github.com/Shakesbeer333","followers_url":"https://api.github.com/users/Shakesbeer333/followers","following_url":"https://api.github.com/users/Shakesbeer333/following{/other_user}","gists_url":"https://api.github.com/users/Shakesbeer333/gists{/gist_id}","starred_url":"https://api.github.com/users/Shakesbeer333/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Shakesbeer333/subscriptions","organizations_url":"https://api.github.com/users/Shakesbeer333/orgs","repos_url":"https://api.github.com/users/Shakesbeer333/repos","events_url":"https://api.github.com/users/Shakesbeer333/events{/privacy}","received_events_url":"https://api.github.com/users/Shakesbeer333/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-10-23T12:31:45Z","updated_at":"2020-11-13T13:45:43Z","closed_at":"2020-11-13T13:45:31Z","author_association":"NONE","active_lock_reason":null,"body":"Hi @lufficc,\r\n\r\nI have the feeling that the resizing of the (ground truth) boxes is wrong. The resizing is \"bypassed\" by taking the relative values of x1,y1,x2,y2 with regards to the original image shape. However, this leads to wrong results, as the images are resized to the squared shape = size x size (i.e. 512 x 512 or 300 x 300), thus, discarding the original aspect ration. \r\n\r\nA possible solution would be to change the `Resize` class in the following way:\r\n\r\n`class Resize(object):\r\n    def __init__(self, size=300):\r\n        self.size = size\r\n\r\n    def __call__(self, image, boxes=None, labels=None):\r\n\r\n        old_size = image.shape[:2]\r\n        ratio = float(self.size) / max(old_size)\r\n        new_size = tuple([int(x * ratio) for x in old_size])\r\n\r\n        image = cv2.resize(image, (new_size[1], new_size[0]))\r\n\r\n        delta_w = self.size - new_size[1]\r\n        delta_h = self.size - new_size[0]\r\n        top, bottom = delta_h // 2, delta_h - (delta_h // 2)\r\n        left, right = delta_w // 2, delta_w - (delta_w // 2)\r\n\r\n        color = [0, 0, 0]\r\n        image = cv2.copyMakeBorder(image, top, bottom, left, right, cv2.BORDER_CONSTANT,\r\n                                   value=color)\r\n\r\n        return image, boxes, labels\r\n`\r\n\r\nThis pads the shorter images size, such that the original aspect ration is kept.\r\n\r\nPlease let me know your thoughts about this.\r\n","closed_by":{"login":"lufficc","id":20706332,"node_id":"MDQ6VXNlcjIwNzA2MzMy","avatar_url":"https://avatars.githubusercontent.com/u/20706332?v=4","gravatar_id":"","url":"https://api.github.com/users/lufficc","html_url":"https://github.com/lufficc","followers_url":"https://api.github.com/users/lufficc/followers","following_url":"https://api.github.com/users/lufficc/following{/other_user}","gists_url":"https://api.github.com/users/lufficc/gists{/gist_id}","starred_url":"https://api.github.com/users/lufficc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lufficc/subscriptions","organizations_url":"https://api.github.com/users/lufficc/orgs","repos_url":"https://api.github.com/users/lufficc/repos","events_url":"https://api.github.com/users/lufficc/events{/privacy}","received_events_url":"https://api.github.com/users/lufficc/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/lufficc/SSD/issues/182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/lufficc/SSD/issues/182/timeline","performed_via_github_app":null,"state_reason":"completed"}