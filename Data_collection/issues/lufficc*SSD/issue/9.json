{"url":"https://api.github.com/repos/lufficc/SSD/issues/9","repository_url":"https://api.github.com/repos/lufficc/SSD","labels_url":"https://api.github.com/repos/lufficc/SSD/issues/9/labels{/name}","comments_url":"https://api.github.com/repos/lufficc/SSD/issues/9/comments","events_url":"https://api.github.com/repos/lufficc/SSD/issues/9/events","html_url":"https://github.com/lufficc/SSD/issues/9","id":391568980,"node_id":"MDU6SXNzdWUzOTE1Njg5ODA=","number":9,"title":"Training error with batch size 64 (two gpus)","user":{"login":"LightToYang","id":17929130,"node_id":"MDQ6VXNlcjE3OTI5MTMw","avatar_url":"https://avatars.githubusercontent.com/u/17929130?v=4","gravatar_id":"","url":"https://api.github.com/users/LightToYang","html_url":"https://github.com/LightToYang","followers_url":"https://api.github.com/users/LightToYang/followers","following_url":"https://api.github.com/users/LightToYang/following{/other_user}","gists_url":"https://api.github.com/users/LightToYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LightToYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LightToYang/subscriptions","organizations_url":"https://api.github.com/users/LightToYang/orgs","repos_url":"https://api.github.com/users/LightToYang/repos","events_url":"https://api.github.com/users/LightToYang/events{/privacy}","received_events_url":"https://api.github.com/users/LightToYang/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-12-17T06:02:36Z","updated_at":"2018-12-17T15:28:09Z","closed_at":"2018-12-17T15:28:09Z","author_association":"NONE","active_lock_reason":null,"body":"The loss is unstable, and the error comes after 430 iters.\r\n\r\n```\r\n2018-12-17 13:55:45,716 SSD.trainer INFO: Train dataset size: 16551\r\n2018-12-17 13:55:45,716 SSD.trainer INFO: Start training\r\n2018-12-17 13:55:53,054 SSD.trainer INFO: Iter: 000010, Lr: 0.00069, Cost: 6.79s, Eta: 11:18:23, Loss: 16.110, Regression Loss 2.962, Classification Loss: 13.149\r\n2018-12-17 13:55:59,009 SSD.trainer INFO: Iter: 000020, Lr: 0.00072, Cost: 5.54s, Eta: 10:35:03, Loss: 14.744, Regression Loss 2.703, Classification Loss: 12.041\r\n2018-12-17 13:56:05,192 SSD.trainer INFO: Iter: 000030, Lr: 0.00074, Cost: 5.78s, Eta: 10:29:42, Loss: 13.971, Regression Loss 2.775, Classification Loss: 11.196\r\n2018-12-17 13:56:11,117 SSD.trainer INFO: Iter: 000040, Lr: 0.00077, Cost: 5.54s, Eta: 10:20:49, Loss: 13.053, Regression Loss 2.877, Classification Loss: 10.176\r\n2018-12-17 13:56:17,044 SSD.trainer INFO: Iter: 000050, Lr: 0.00080, Cost: 5.54s, Eta: 10:14:58, Loss: 11.377, Regression Loss 2.694, Classification Loss: 8.683\r\n2018-12-17 13:56:22,996 SSD.trainer INFO: Iter: 000060, Lr: 0.00082, Cost: 5.57s, Eta: 10:11:33, Loss: 12.235, Regression Loss 2.856, Classification Loss: 9.379\r\n2018-12-17 13:56:28,939 SSD.trainer INFO: Iter: 000070, Lr: 0.00085, Cost: 5.56s, Eta: 10:08:50, Loss: 9.304, Regression Loss 2.722, Classification Loss: 6.582\r\n2018-12-17 13:56:34,890 SSD.trainer INFO: Iter: 000080, Lr: 0.00088, Cost: 5.57s, Eta: 10:06:57, Loss: 9.608, Regression Loss 2.600, Classification Loss: 7.008\r\n2018-12-17 13:56:40,899 SSD.trainer INFO: Iter: 000090, Lr: 0.00090, Cost: 5.63s, Eta: 10:06:10, Loss: 9.044, Regression Loss 2.633, Classification Loss: 6.411\r\n2018-12-17 13:56:46,872 SSD.trainer INFO: Iter: 000100, Lr: 0.00093, Cost: 5.59s, Eta: 10:05:02, Loss: 10.493, Regression Loss 2.597, Classification Loss: 7.896\r\n2018-12-17 13:56:52,839 SSD.trainer INFO: Iter: 000110, Lr: 0.00096, Cost: 5.58s, Eta: 10:04:02, Loss: 9.837, Regression Loss 2.504, Classification Loss: 7.333\r\n2018-12-17 13:56:58,813 SSD.trainer INFO: Iter: 000120, Lr: 0.00098, Cost: 5.59s, Eta: 10:03:18, Loss: 8.993, Regression Loss 2.577, Classification Loss: 6.416\r\n2018-12-17 13:57:04,785 SSD.trainer INFO: Iter: 000130, Lr: 0.00101, Cost: 5.58s, Eta: 10:02:36, Loss: 9.234, Regression Loss 2.366, Classification Loss: 6.868\r\n2018-12-17 13:57:10,782 SSD.trainer INFO: Iter: 000140, Lr: 0.00104, Cost: 5.61s, Eta: 10:02:12, Loss: 9.572, Regression Loss 2.397, Classification Loss: 7.175\r\n2018-12-17 13:57:16,768 SSD.trainer INFO: Iter: 000150, Lr: 0.00106, Cost: 5.60s, Eta: 10:01:47, Loss: 10.361, Regression Loss 2.455, Classification Loss: 7.906\r\n2018-12-17 13:57:22,772 SSD.trainer INFO: Iter: 000160, Lr: 0.00109, Cost: 5.62s, Eta: 10:01:32, Loss: 11.323, Regression Loss 2.497, Classification Loss: 8.826\r\n2018-12-17 13:57:28,794 SSD.trainer INFO: Iter: 000170, Lr: 0.00112, Cost: 5.63s, Eta: 10:01:19, Loss: 11.311, Regression Loss 2.368, Classification Loss: 8.942\r\n2018-12-17 13:57:34,801 SSD.trainer INFO: Iter: 000180, Lr: 0.00114, Cost: 5.62s, Eta: 10:01:07, Loss: 14.360, Regression Loss 2.493, Classification Loss: 11.866\r\n2018-12-17 13:57:40,815 SSD.trainer INFO: Iter: 000190, Lr: 0.00117, Cost: 5.62s, Eta: 10:00:55, Loss: 9.740, Regression Loss 2.547, Classification Loss: 7.192\r\n2018-12-17 13:57:46,815 SSD.trainer INFO: Iter: 000200, Lr: 0.00120, Cost: 5.61s, Eta: 10:00:42, Loss: 12.304, Regression Loss 2.444, Classification Loss: 9.860\r\n2018-12-17 13:57:53,002 SSD.trainer INFO: Iter: 000210, Lr: 0.00122, Cost: 5.76s, Eta: 10:01:10, Loss: 9.891, Regression Loss 2.465, Classification Loss: 7.427\r\n2018-12-17 13:57:59,044 SSD.trainer INFO: Iter: 000220, Lr: 0.00125, Cost: 5.66s, Eta: 10:01:18, Loss: 10.401, Regression Loss 2.495, Classification Loss: 7.905\r\n2018-12-17 13:58:05,060 SSD.trainer INFO: Iter: 000230, Lr: 0.00128, Cost: 5.63s, Eta: 10:01:06, Loss: 9.791, Regression Loss 2.253, Classification Loss: 7.538\r\n2018-12-17 13:58:11,072 SSD.trainer INFO: Iter: 000240, Lr: 0.00130, Cost: 5.63s, Eta: 10:00:55, Loss: 9.441, Regression Loss 2.396, Classification Loss: 7.045\r\n2018-12-17 13:58:17,158 SSD.trainer INFO: Iter: 000250, Lr: 0.00133, Cost: 5.68s, Eta: 10:00:57, Loss: 8.072, Regression Loss 2.440, Classification Loss: 5.632\r\n2018-12-17 13:58:23,013 SSD.trainer INFO: Iter: 000260, Lr: 0.00136, Cost: 5.47s, Eta: 10:00:13, Loss: 8.662, Regression Loss 2.442, Classification Loss: 6.221\r\n2018-12-17 13:58:29,099 SSD.trainer INFO: Iter: 000270, Lr: 0.00138, Cost: 5.70s, Eta: 10:00:20, Loss: 8.421, Regression Loss 2.250, Classification Loss: 6.171\r\n2018-12-17 13:58:35,208 SSD.trainer INFO: Iter: 000280, Lr: 0.00141, Cost: 5.72s, Eta: 10:00:30, Loss: 8.425, Regression Loss 2.143, Classification Loss: 6.281\r\n2018-12-17 13:58:41,339 SSD.trainer INFO: Iter: 000290, Lr: 0.00144, Cost: 5.73s, Eta: 10:00:41, Loss: 9.016, Regression Loss 2.448, Classification Loss: 6.568\r\n2018-12-17 13:58:47,479 SSD.trainer INFO: Iter: 000300, Lr: 0.00146, Cost: 5.74s, Eta: 10:00:57, Loss: 11.354, Regression Loss 2.215, Classification Loss: 9.139\r\n2018-12-17 13:58:53,697 SSD.trainer INFO: Iter: 000310, Lr: 0.00149, Cost: 5.81s, Eta: 10:01:23, Loss: 12.369, Regression Loss 2.147, Classification Loss: 10.221\r\n2018-12-17 13:58:59,810 SSD.trainer INFO: Iter: 000320, Lr: 0.00152, Cost: 5.72s, Eta: 10:01:33, Loss: 10.004, Regression Loss 2.278, Classification Loss: 7.726\r\n2018-12-17 13:59:05,849 SSD.trainer INFO: Iter: 000330, Lr: 0.00154, Cost: 5.65s, Eta: 10:01:26, Loss: 7.794, Regression Loss 2.384, Classification Loss: 5.411\r\n2018-12-17 13:59:11,847 SSD.trainer INFO: Iter: 000340, Lr: 0.00157, Cost: 5.61s, Eta: 10:01:11, Loss: 8.697, Regression Loss 2.366, Classification Loss: 6.331\r\n2018-12-17 13:59:17,999 SSD.trainer INFO: Iter: 000350, Lr: 0.00160, Cost: 5.75s, Eta: 10:01:21, Loss: 12.521, Regression Loss 2.570, Classification Loss: 9.951\r\n2018-12-17 13:59:24,357 SSD.trainer INFO: Iter: 000360, Lr: 0.00162, Cost: 5.98s, Eta: 10:02:10, Loss: 12.485, Regression Loss 2.474, Classification Loss: 10.012\r\n2018-12-17 13:59:30,369 SSD.trainer INFO: Iter: 000370, Lr: 0.00165, Cost: 5.63s, Eta: 10:01:55, Loss: 12.791, Regression Loss 2.641, Classification Loss: 10.150\r\n2018-12-17 13:59:36,477 SSD.trainer INFO: Iter: 000380, Lr: 0.00168, Cost: 5.73s, Eta: 10:01:59, Loss: 11.360, Regression Loss 2.661, Classification Loss: 8.699\r\n2018-12-17 13:59:42,585 SSD.trainer INFO: Iter: 000390, Lr: 0.00170, Cost: 5.72s, Eta: 10:01:59, Loss: 11.183, Regression Loss 2.592, Classification Loss: 8.591\r\n2018-12-17 13:59:48,701 SSD.trainer INFO: Iter: 000400, Lr: 0.00173, Cost: 5.72s, Eta: 10:01:59, Loss: 10.166, Regression Loss 2.575, Classification Loss: 7.590\r\n2018-12-17 13:59:54,813 SSD.trainer INFO: Iter: 000410, Lr: 0.00176, Cost: 5.72s, Eta: 10:02:02, Loss: 17.562, Regression Loss 2.554, Classification Loss: 15.008\r\n2018-12-17 14:00:00,942 SSD.trainer INFO: Iter: 000420, Lr: 0.00178, Cost: 5.74s, Eta: 10:02:05, Loss: 10.339, Regression Loss 2.592, Classification Loss: 7.747\r\n2018-12-17 14:00:07,075 SSD.trainer INFO: Iter: 000430, Lr: 0.00181, Cost: 5.75s, Eta: 10:02:10, Loss: 28.599, Regression Loss 9.237, Classification Loss: 19.362\r\nTraceback (most recent call last):\r\n  File \"train_ssd.py\", line 139, in <module>\r\n    main()\r\n  File \"train_ssd.py\", line 130, in main\r\n    model = train(cfg, args)\r\n  File \"train_ssd.py\", line 76, in train\r\n    return do_train(cfg, model, train_loader, optimizer, scheduler, criterion, device, args)\r\n  File \"/home/ycg/workspace/SSD/ssd/engine/trainer.py\", line 78, in do_train\r\n    regression_loss, classification_loss = criterion(confidence, locations, labels, boxes)\r\n  File \"/home/ycg/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ycg/workspace/SSD/ssd/modeling/multibox_loss.py\", line 31, in forward\r\n    mask = box_utils.hard_negative_mining(loss, labels, self.neg_pos_ratio)\r\n  File \"/home/ycg/workspace/SSD/ssd/utils/box_utils.py\", line 123, in hard_negative_mining\r\n    _, indexes = loss.sort(dim=1, descending=True)\r\nRuntimeError: merge_sort: failed to synchronize: an illegal memory access was encountered\r\nTraceback (most recent call last):\r\n  File \"train_ssd.py\", line 139, in <module>\r\n    main()\r\n  File \"train_ssd.py\", line 130, in main\r\n    model = train(cfg, args)\r\n  File \"train_ssd.py\", line 76, in train\r\n    return do_train(cfg, model, train_loader, optimizer, scheduler, criterion, device, args)\r\n  File \"/home/ycg/workspace/SSD/ssd/engine/trainer.py\", line 78, in do_train\r\n    regression_loss, classification_loss = criterion(confidence, locations, labels, boxes)\r\n  File \"/home/ycg/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ycg/workspace/SSD/ssd/modeling/multibox_loss.py\", line 31, in forward\r\n    mask = box_utils.hard_negative_mining(loss, labels, self.neg_pos_ratio)\r\n  File \"/home/ycg/workspace/SSD/ssd/utils/box_utils.py\", line 123, in hard_negative_mining\r\n    _, indexes = loss.sort(dim=1, descending=True)\r\nRuntimeError: merge_sort: failed to synchronize: an illegal memory access was encountered\r\nterminate called without an active exception\r\nterminate called without an active exception\r\n\r\n```","closed_by":{"login":"lufficc","id":20706332,"node_id":"MDQ6VXNlcjIwNzA2MzMy","avatar_url":"https://avatars.githubusercontent.com/u/20706332?v=4","gravatar_id":"","url":"https://api.github.com/users/lufficc","html_url":"https://github.com/lufficc","followers_url":"https://api.github.com/users/lufficc/followers","following_url":"https://api.github.com/users/lufficc/following{/other_user}","gists_url":"https://api.github.com/users/lufficc/gists{/gist_id}","starred_url":"https://api.github.com/users/lufficc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lufficc/subscriptions","organizations_url":"https://api.github.com/users/lufficc/orgs","repos_url":"https://api.github.com/users/lufficc/repos","events_url":"https://api.github.com/users/lufficc/events{/privacy}","received_events_url":"https://api.github.com/users/lufficc/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/lufficc/SSD/issues/9/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/lufficc/SSD/issues/9/timeline","performed_via_github_app":null,"state_reason":"completed"}