[{"url":"https://api.github.com/repos/lufficc/SSD/issues/comments/503404145","html_url":"https://github.com/lufficc/SSD/issues/69#issuecomment-503404145","issue_url":"https://api.github.com/repos/lufficc/SSD/issues/69","id":503404145,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMzQwNDE0NQ==","user":{"login":"lufficc","id":20706332,"node_id":"MDQ6VXNlcjIwNzA2MzMy","avatar_url":"https://avatars.githubusercontent.com/u/20706332?v=4","gravatar_id":"","url":"https://api.github.com/users/lufficc","html_url":"https://github.com/lufficc","followers_url":"https://api.github.com/users/lufficc/followers","following_url":"https://api.github.com/users/lufficc/following{/other_user}","gists_url":"https://api.github.com/users/lufficc/gists{/gist_id}","starred_url":"https://api.github.com/users/lufficc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lufficc/subscriptions","organizations_url":"https://api.github.com/users/lufficc/orgs","repos_url":"https://api.github.com/users/lufficc/repos","events_url":"https://api.github.com/users/lufficc/events{/privacy}","received_events_url":"https://api.github.com/users/lufficc/received_events","type":"User","site_admin":false},"created_at":"2019-06-19T04:45:34Z","updated_at":"2019-06-19T04:45:34Z","author_association":"OWNER","body":"The log shows that you are pass a 'None' `class_name` to `class_dict`. Maybe you can check your dataset and avoid some dirty data.","reactions":{"url":"https://api.github.com/repos/lufficc/SSD/issues/comments/503404145/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lufficc","id":20706332,"node_id":"MDQ6VXNlcjIwNzA2MzMy","avatar_url":"https://avatars.githubusercontent.com/u/20706332?v=4","gravatar_id":"","url":"https://api.github.com/users/lufficc","html_url":"https://github.com/lufficc","followers_url":"https://api.github.com/users/lufficc/followers","following_url":"https://api.github.com/users/lufficc/following{/other_user}","gists_url":"https://api.github.com/users/lufficc/gists{/gist_id}","starred_url":"https://api.github.com/users/lufficc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lufficc/subscriptions","organizations_url":"https://api.github.com/users/lufficc/orgs","repos_url":"https://api.github.com/users/lufficc/repos","events_url":"https://api.github.com/users/lufficc/events{/privacy}","received_events_url":"https://api.github.com/users/lufficc/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/lufficc/SSD/issues/comments/514870495","html_url":"https://github.com/lufficc/SSD/issues/69#issuecomment-514870495","issue_url":"https://api.github.com/repos/lufficc/SSD/issues/69","id":514870495,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNDg3MDQ5NQ==","user":{"login":"AmmonZ","id":18216061,"node_id":"MDQ6VXNlcjE4MjE2MDYx","avatar_url":"https://avatars.githubusercontent.com/u/18216061?v=4","gravatar_id":"","url":"https://api.github.com/users/AmmonZ","html_url":"https://github.com/AmmonZ","followers_url":"https://api.github.com/users/AmmonZ/followers","following_url":"https://api.github.com/users/AmmonZ/following{/other_user}","gists_url":"https://api.github.com/users/AmmonZ/gists{/gist_id}","starred_url":"https://api.github.com/users/AmmonZ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AmmonZ/subscriptions","organizations_url":"https://api.github.com/users/AmmonZ/orgs","repos_url":"https://api.github.com/users/AmmonZ/repos","events_url":"https://api.github.com/users/AmmonZ/events{/privacy}","received_events_url":"https://api.github.com/users/AmmonZ/received_events","type":"User","site_admin":false},"created_at":"2019-07-25T02:31:11Z","updated_at":"2019-07-25T02:31:11Z","author_association":"NONE","body":"Follow the author's DEVELOP GUIDE, I create a small VOC format dataset and related python file in this project as follows, BUT I met weird error that I don't understand why, Can anyone help me?  THANK YOU!\r\n![9H3)N$85YU2OL`P99FCSNI9](https://user-images.githubusercontent.com/18216061/61841335-00ffcd80-aec7-11e9-8860-0e8c148ffbb5.png)\r\n![9H3)N$85YU2OL`P99FCSNI9](https://user-images.githubusercontent.com/18216061/61841357-0ceb8f80-aec7-11e9-8337-70be5fcecf1a.png)\r\n![Z9Q``K2OG%ZFAXRG_WVUIJB](https://user-images.githubusercontent.com/18216061/61841366-14129d80-aec7-11e9-8ba2-bf779231f46e.png)\r\n![D}U8481%)~H)V LYZ5MQRJ9](https://user-images.githubusercontent.com/18216061/61841378-1ecd3280-aec7-11e9-97bd-6c77aaf7c143.png)\r\n\r\n\r\n(tensorflow1) 123456@ubuntu-server-syp1:~/SSD-1.2$ python train.py --config-file configs/vgg_ssd300_mydata.yaml\r\n2019-07-25 10:16:52,464 SSD INFO: Using 1 GPUs\r\n2019-07-25 10:16:52,465 SSD INFO: Namespace(config_file='configs/vgg_ssd300_mydata.yaml', distributed=False, eval_step=2500, local_rank=0, log_step=10, num_gpus=1, opts=[], save_step=2500, skip_test=False, use_tensorboard=True)\r\n2019-07-25 10:16:52,465 SSD INFO: Loaded configuration file configs/vgg_ssd300_mydata.yaml\r\n2019-07-25 10:16:52,465 SSD INFO:\r\nMODEL:\r\n  NUM_CLASSES: 1 \r\nINPUT:\r\n  IMAGE_SIZE: 300 \r\nDATASETS:\r\n  TRAIN: (\"my_custom_dataset_trainval\",)\r\n  TEST: (\"my_custom_dataset_test\", )\r\nSOLVER:\r\n  MAX_ITER: 120000 \r\n  LR_STEPS: [80000, 100000] \r\n  GAMMA: 0.1\r\n  BATCH_SIZE: 1 \r\n  #BATCH_SIZE: 16\r\n  LR: 1e-3 \r\n\r\nOUTPUT_DIR: 'outputs/vgg_ssd300_mydata'\r\n2019-07-25 10:16:52,465 SSD INFO: Running with config:\r\nDATASETS:\r\n  TEST: ('my_custom_dataset_test',)\r\n  TRAIN: ('my_custom_dataset_trainval',)\r\nDATA_LOADER:\r\n  NUM_WORKERS: 0\r\n  PIN_MEMORY: True\r\nINPUT:\r\n  IMAGE_SIZE: 300\r\n  PIXEL_MEAN: [0, 0, 0]\r\nMODEL:\r\n  BACKBONE:\r\n    NAME: vgg\r\n    OUT_CHANNELS: (512, 1024, 512, 256, 256, 256)\r\n    PRETRAINED: True\r\n  BOX_PREDICTOR: SSDBoxPredictor\r\n  CENTER_VARIANCE: 0.1\r\n  DEVICE: cuda\r\n  META_ARCHITECTURE: SSDDetector\r\n  NEG_POS_RATIO: 3\r\n  NUM_CLASSES: 1\r\n  PRIORS:\r\n    ASPECT_RATIOS: [[2], [2, 3], [2, 3], [2, 3], [2], [2]]\r\n    BOXES_PER_LOCATION: [4, 6, 6, 6, 4, 4]\r\n    CLIP: True\r\n    FEATURE_MAPS: [38, 19, 10, 5, 3, 1]\r\n    MAX_SIZES: [60, 111, 162, 213, 264, 315]\r\n    MIN_SIZES: [30, 60, 111, 162, 213, 264]\r\n    STRIDES: [8, 16, 32, 64, 100, 300]\r\n  SIZE_VARIANCE: 0.2\r\n  THRESHOLD: 0.5\r\nOUTPUT_DIR: outputs/vgg_ssd300_mydata\r\nSOLVER:\r\n  BATCH_SIZE: 1\r\n  GAMMA: 0.1\r\n  LR: 0.001\r\n  LR_STEPS: [80000, 100000]\r\n  MAX_ITER: 120000\r\n  MOMENTUM: 0.9\r\n  WARMUP_FACTOR: 0.3333333333333333\r\n  WARMUP_ITERS: 500\r\n  WEIGHT_DECAY: 0.0005\r\nTEST:\r\n  BATCH_SIZE: 10\r\n  CONFIDENCE_THRESHOLD: 0.01\r\n  MAX_PER_CLASS: -1\r\n  MAX_PER_IMAGE: 100\r\n  NMS_THRESHOLD: 0.45\r\n2019-07-25 10:16:54,062 SSD.trainer INFO: No checkpoint found.\r\n2019-07-25 10:16:54,069 SSD.trainer INFO: Start training ...\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 119, in <module>\r\n    main()\r\n  File \"train.py\", line 110, in main\r\n    model = train(cfg, args)\r\n  File \"train.py\", line 48, in train\r\n    model = do_train(cfg, model, train_loader, optimizer, scheduler, checkpointer, device, arguments, args)\r\n  File \"/home/123456/SSD-1.2/ssd/engine/trainer.py\", line 82, in do_train\r\n    loss_dict = model(images, targets=targets)\r\n  File \"/home/123456/anaconda3/envs/tensorflow1/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 493, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/123456/SSD-1.2/ssd/modeling/detector/ssd_detector.py\", line 16, in forward\r\n    detections, detector_losses = self.box_head(features, targets)\r\n  File \"/home/123456/anaconda3/envs/tensorflow1/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 493, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/123456/SSD-1.2/ssd/modeling/box_head/box_head.py\", line 25, in forward\r\n    return self._forward_train(cls_logits, bbox_pred, targets)\r\n  File \"/home/123456/SSD-1.2/ssd/modeling/box_head/box_head.py\", line 31, in _forward_train\r\n    reg_loss, cls_loss = self.loss_evaluator(cls_logits, bbox_pred, gt_labels, gt_boxes)\r\n  File \"/home/123456/anaconda3/envs/tensorflow1/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 493, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/123456/SSD-1.2/ssd/modeling/box_head/loss.py\", line 34, in forward\r\n    classification_loss = F.cross_entropy(confidence.view(-1, num_classes), labels[mask], reduction='sum')\r\n  File \"/home/123456/anaconda3/envs/tensorflow1/lib/python3.6/site-packages/torch/nn/functional.py\", line 2056, in cross_entropy\r\n    return nll_loss(log_softmax(input, 1), target, weight, None, ignore_index, None, reduction)\r\n  File \"/home/123456/anaconda3/envs/tensorflow1/lib/python3.6/site-packages/torch/nn/functional.py\", line 1871, in nll_loss\r\n    ret = torch._C._nn.nll_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index)\r\nRuntimeError: invalid argument 2: non-empty vector or matrix expected at /opt/conda/conda-bld/pytorch_1556653183467/work/aten/src/THCUNN/generic/ClassNLLCriterion.cu:31","reactions":{"url":"https://api.github.com/repos/lufficc/SSD/issues/comments/514870495/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AmmonZ","id":18216061,"node_id":"MDQ6VXNlcjE4MjE2MDYx","avatar_url":"https://avatars.githubusercontent.com/u/18216061?v=4","gravatar_id":"","url":"https://api.github.com/users/AmmonZ","html_url":"https://github.com/AmmonZ","followers_url":"https://api.github.com/users/AmmonZ/followers","following_url":"https://api.github.com/users/AmmonZ/following{/other_user}","gists_url":"https://api.github.com/users/AmmonZ/gists{/gist_id}","starred_url":"https://api.github.com/users/AmmonZ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AmmonZ/subscriptions","organizations_url":"https://api.github.com/users/AmmonZ/orgs","repos_url":"https://api.github.com/users/AmmonZ/repos","events_url":"https://api.github.com/users/AmmonZ/events{/privacy}","received_events_url":"https://api.github.com/users/AmmonZ/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/lufficc/SSD/issues/comments/544465061","html_url":"https://github.com/lufficc/SSD/issues/69#issuecomment-544465061","issue_url":"https://api.github.com/repos/lufficc/SSD/issues/69","id":544465061,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NDQ2NTA2MQ==","user":{"login":"fzoric8","id":26651809,"node_id":"MDQ6VXNlcjI2NjUxODA5","avatar_url":"https://avatars.githubusercontent.com/u/26651809?v=4","gravatar_id":"","url":"https://api.github.com/users/fzoric8","html_url":"https://github.com/fzoric8","followers_url":"https://api.github.com/users/fzoric8/followers","following_url":"https://api.github.com/users/fzoric8/following{/other_user}","gists_url":"https://api.github.com/users/fzoric8/gists{/gist_id}","starred_url":"https://api.github.com/users/fzoric8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fzoric8/subscriptions","organizations_url":"https://api.github.com/users/fzoric8/orgs","repos_url":"https://api.github.com/users/fzoric8/repos","events_url":"https://api.github.com/users/fzoric8/events{/privacy}","received_events_url":"https://api.github.com/users/fzoric8/received_events","type":"User","site_admin":false},"created_at":"2019-10-21T11:05:51Z","updated_at":"2019-10-21T11:05:51Z","author_association":"NONE","body":"I'm also having the same issue, whilst can't figure out why. Help would be appreciated. ","reactions":{"url":"https://api.github.com/repos/lufficc/SSD/issues/comments/544465061/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fzoric8","id":26651809,"node_id":"MDQ6VXNlcjI2NjUxODA5","avatar_url":"https://avatars.githubusercontent.com/u/26651809?v=4","gravatar_id":"","url":"https://api.github.com/users/fzoric8","html_url":"https://github.com/fzoric8","followers_url":"https://api.github.com/users/fzoric8/followers","following_url":"https://api.github.com/users/fzoric8/following{/other_user}","gists_url":"https://api.github.com/users/fzoric8/gists{/gist_id}","starred_url":"https://api.github.com/users/fzoric8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fzoric8/subscriptions","organizations_url":"https://api.github.com/users/fzoric8/orgs","repos_url":"https://api.github.com/users/fzoric8/repos","events_url":"https://api.github.com/users/fzoric8/events{/privacy}","received_events_url":"https://api.github.com/users/fzoric8/received_events","type":"User","site_admin":false}},{"id":3374847879,"node_id":"MDExOkNsb3NlZEV2ZW50MzM3NDg0Nzg3OQ==","url":"https://api.github.com/repos/lufficc/SSD/issues/events/3374847879","actor":{"login":"lufficc","id":20706332,"node_id":"MDQ6VXNlcjIwNzA2MzMy","avatar_url":"https://avatars.githubusercontent.com/u/20706332?v=4","gravatar_id":"","url":"https://api.github.com/users/lufficc","html_url":"https://github.com/lufficc","followers_url":"https://api.github.com/users/lufficc/followers","following_url":"https://api.github.com/users/lufficc/following{/other_user}","gists_url":"https://api.github.com/users/lufficc/gists{/gist_id}","starred_url":"https://api.github.com/users/lufficc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lufficc/subscriptions","organizations_url":"https://api.github.com/users/lufficc/orgs","repos_url":"https://api.github.com/users/lufficc/repos","events_url":"https://api.github.com/users/lufficc/events{/privacy}","received_events_url":"https://api.github.com/users/lufficc/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-05-26T18:31:23Z","state_reason":null,"performed_via_github_app":null}]