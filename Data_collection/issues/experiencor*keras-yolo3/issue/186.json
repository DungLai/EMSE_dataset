{"url":"https://api.github.com/repos/experiencor/keras-yolo3/issues/186","repository_url":"https://api.github.com/repos/experiencor/keras-yolo3","labels_url":"https://api.github.com/repos/experiencor/keras-yolo3/issues/186/labels{/name}","comments_url":"https://api.github.com/repos/experiencor/keras-yolo3/issues/186/comments","events_url":"https://api.github.com/repos/experiencor/keras-yolo3/issues/186/events","html_url":"https://github.com/experiencor/keras-yolo3/issues/186","id":443982764,"node_id":"MDU6SXNzdWU0NDM5ODI3NjQ=","number":186,"title":"tensor problem","user":{"login":"vcvishal","id":49521759,"node_id":"MDQ6VXNlcjQ5NTIxNzU5","avatar_url":"https://avatars.githubusercontent.com/u/49521759?v=4","gravatar_id":"","url":"https://api.github.com/users/vcvishal","html_url":"https://github.com/vcvishal","followers_url":"https://api.github.com/users/vcvishal/followers","following_url":"https://api.github.com/users/vcvishal/following{/other_user}","gists_url":"https://api.github.com/users/vcvishal/gists{/gist_id}","starred_url":"https://api.github.com/users/vcvishal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vcvishal/subscriptions","organizations_url":"https://api.github.com/users/vcvishal/orgs","repos_url":"https://api.github.com/users/vcvishal/repos","events_url":"https://api.github.com/users/vcvishal/events{/privacy}","received_events_url":"https://api.github.com/users/vcvishal/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-05-14T15:30:02Z","updated_at":"2019-11-06T02:28:43Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Using TensorFlow backend.\r\nvalid_annot_folder not exists. Spliting the trainining set.\r\nSeen labels:    {'WBC': 372, 'RBC': 4155, 'Platelets': 361}\r\n\r\nGiven labels:   ['Platelets', 'RBC', 'WBC']\r\n\r\nTraining on:    ['Platelets', 'RBC', 'WBC']\r\n\r\n2019-05-14 20:56:59.941932: I T:\\src\\github\\tensorflow\\tensorflow\\core\\platform\\cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2\r\n2019-05-14 20:57:00.898749: I T:\\src\\github\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1356] Found device 0 with properties:\r\nname: GeForce GTX 1050 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.62\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 4.00GiB freeMemory: 3.30GiB\r\n2019-05-14 20:57:00.907040: I T:\\src\\github\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1435] Adding visible gpu devices: 0\r\n2019-05-14 20:57:01.467095: I T:\\src\\github\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-05-14 20:57:01.471892: I T:\\src\\github\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:929]      0\r\n2019-05-14 20:57:01.474685: I T:\\src\\github\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:942] 0:   N\r\n2019-05-14 20:57:01.478907: I T:\\src\\github\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3030 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1050 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\nWARNING:tensorflow:From D:\\miniconda\\lib\\site-packages\\keras\\backend\\tensorflow_backend.py:1290: calling reduce_mean (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nkeep_dims is deprecated, use keepdims instead\r\nWARNING:tensorflow:From D:\\miniconda\\lib\\site-packages\\keras\\backend\\tensorflow_backend.py:1188: calling reduce_sum (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nkeep_dims is deprecated, use keepdims instead\r\nEpoch 1/103\r\nresizing:  256 256\r\n2019-05-14 20:58:51.568129: E T:\\src\\github\\tensorflow\\tensorflow\\core\\grappler\\clusters\\utils.cc:81] Failed to get device properties, error code: 30\r\nTraceback (most recent call last):\r\n  File \"D:\\miniconda\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1322, in _do_call\r\n    return fn(*args)\r\n  File \"D:\\miniconda\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1307, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"D:\\miniconda\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1409, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero\r\n         [[Node: replica_0/model_1/yolo_layer_1/Reshape = Reshape[T=DT_FLOAT, Tshape=DT_INT32, _class=[\"loc:@train...ad/Reshape\"], _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](replica_0/model_1/conv_81/BiasAdd, replica_0/model_1/yolo_layer_1/concat)]]\r\n         [[Node: training/Adam/gradients/replica_0/model_1/bnorm_84/batchnorm/mul_grad/Mul_1/_5057 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_36076...grad/Mul_1\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 280, in <module>\r\n    _main_(args)\r\n  File \"train.py\", line 257, in _main_\r\n    max_queue_size   = 8\r\n  File \"D:\\miniconda\\lib\\site-packages\\keras\\legacy\\interfaces.py\", line 87, in wrapper\r\n    return func(*args, **kwargs)\r\n  File \"D:\\miniconda\\lib\\site-packages\\keras\\engine\\training.py\", line 2042, in fit_generator\r\n    class_weight=class_weight)\r\n  File \"D:\\miniconda\\lib\\site-packages\\keras\\engine\\training.py\", line 1762, in train_on_batch\r\n    outputs = self.train_function(ins)\r\n  File \"D:\\miniconda\\lib\\site-packages\\keras\\backend\\tensorflow_backend.py\", line 2273, in __call__\r\n    **self.session_kwargs)\r\n  File \"D:\\miniconda\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 900, in run\r\n    run_metadata_ptr)\r\n  File \"D:\\miniconda\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1135, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"D:\\miniconda\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1316, in _do_run\r\n    run_metadata)\r\n  File \"D:\\miniconda\\lib\\site-packages\\tensorflow\\python\\client\\session.py\", line 1335, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero\r\n         [[Node: replica_0/model_1/yolo_layer_1/Reshape = Reshape[T=DT_FLOAT, Tshape=DT_INT32, _class=[\"loc:@train...ad/Reshape\"], _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](replica_0/model_1/conv_81/BiasAdd, replica_0/model_1/yolo_layer_1/concat)]]\r\n         [[Node: training/Adam/gradients/replica_0/model_1/bnorm_84/batchnorm/mul_grad/Mul_1/_5057 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_36076...grad/Mul_1\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n\r\nCaused by op 'replica_0/model_1/yolo_layer_1/Reshape', defined at:\r\n  File \"train.py\", line 280, in <module>\r\n    _main_(args)\r\n  File \"train.py\", line 242, in _main_\r\n    class_scale         = config['train']['class_scale'],\r\n  File \"train.py\", line 157, in create_model\r\n    train_model = multi_gpu_model(template_model, gpus=multi_gpu)\r\n  File \"C:\\Users\\vcvis\\Desktop\\keras-yolo3-master\\utils\\multi_gpu_model.py\", line 48, in multi_gpu_model\r\n    outputs = model(inputs)\r\n  File \"D:\\miniconda\\lib\\site-packages\\keras\\engine\\topology.py\", line 602, in __call__\r\n    output = self.call(inputs, **kwargs)\r\n  File \"D:\\miniconda\\lib\\site-packages\\keras\\engine\\topology.py\", line 2058, in call\r\n    output_tensors, _, _ = self.run_internal_graph(inputs, masks)\r\n  File \"D:\\miniconda\\lib\\site-packages\\keras\\engine\\topology.py\", line 2220, in run_internal_graph\r\n    output_tensors = _to_list(layer.call(computed_tensors, **kwargs))\r\n  File \"C:\\Users\\vcvis\\Desktop\\keras-yolo3-master\\yolo.py\", line 37, in call\r\n    y_pred = tf.reshape(y_pred, tf.concat([tf.shape(y_pred)[:3], tf.constant([3, -1])], axis=0))\r\n  File \"D:\\miniconda\\lib\\site-packages\\tensorflow\\python\\ops\\gen_array_ops.py\", line 7323, in reshape\r\n    \"Reshape\", tensor=tensor, shape=shape, name=name)\r\n  File \"D:\\miniconda\\lib\\site-packages\\tensorflow\\python\\framework\\op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"D:\\miniconda\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 3392, in create_op\r\n    op_def=op_def)\r\n  File \"D:\\miniconda\\lib\\site-packages\\tensorflow\\python\\framework\\ops.py\", line 1718, in __init__\r\n    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access\r\n\r\nInvalidArgumentError (see above for traceback): Reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero\r\n         [[Node: replica_0/model_1/yolo_layer_1/Reshape = Reshape[T=DT_FLOAT, Tshape=DT_INT32, _class=[\"loc:@train...ad/Reshape\"], _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](replica_0/model_1/conv_81/BiasAdd, replica_0/model_1/yolo_layer_1/concat)]]\r\n         [[Node: training/Adam/gradients/replica_0/model_1/bnorm_84/batchnorm/mul_grad/Mul_1/_5057 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device_incarnation=1, tensor_name=\"edge_36076...grad/Mul_1\", tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\r\n\r\n\r\nplease help","closed_by":null,"reactions":{"url":"https://api.github.com/repos/experiencor/keras-yolo3/issues/186/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/experiencor/keras-yolo3/issues/186/timeline","performed_via_github_app":null,"state_reason":null}