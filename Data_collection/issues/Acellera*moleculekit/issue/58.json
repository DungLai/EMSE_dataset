{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/58","repository_url":"https://api.github.com/repos/Acellera/moleculekit","labels_url":"https://api.github.com/repos/Acellera/moleculekit/issues/58/labels{/name}","comments_url":"https://api.github.com/repos/Acellera/moleculekit/issues/58/comments","events_url":"https://api.github.com/repos/Acellera/moleculekit/issues/58/events","html_url":"https://github.com/Acellera/moleculekit/issues/58","id":736048462,"node_id":"MDU6SXNzdWU3MzYwNDg0NjI=","number":58,"title":"Erro with voxelization","user":{"login":"cuzzo87","id":10772443,"node_id":"MDQ6VXNlcjEwNzcyNDQz","avatar_url":"https://avatars.githubusercontent.com/u/10772443?v=4","gravatar_id":"","url":"https://api.github.com/users/cuzzo87","html_url":"https://github.com/cuzzo87","followers_url":"https://api.github.com/users/cuzzo87/followers","following_url":"https://api.github.com/users/cuzzo87/following{/other_user}","gists_url":"https://api.github.com/users/cuzzo87/gists{/gist_id}","starred_url":"https://api.github.com/users/cuzzo87/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cuzzo87/subscriptions","organizations_url":"https://api.github.com/users/cuzzo87/orgs","repos_url":"https://api.github.com/users/cuzzo87/repos","events_url":"https://api.github.com/users/cuzzo87/events{/privacy}","received_events_url":"https://api.github.com/users/cuzzo87/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-11-04T11:44:14Z","updated_at":"2021-03-08T15:05:35Z","closed_at":"2021-03-08T15:05:35Z","author_association":"NONE","active_lock_reason":null,"body":"Hi guys,\r\n\r\nI am experiecing some problems in the voxelization procedure. Even following the example, an error is raised.\r\n\r\n```python\r\nfrom htmd.molecule.molecule import Molecule\r\nfrom moleculekit.tools.voxeldescriptors import getVoxelDescriptors\r\n\r\nm = Molecule('3PTB')\r\nm.filter('protein')\r\nfeatures, centers, N = getVoxelDescriptors(m, buffer=8)\r\n```\r\n\r\nThe error:\r\n\r\n```python\r\n  File \"current_session.py\", line 7, in <module>\r\n    features, centers, N = getVoxelDescriptors(m, buffer=8)\r\n  File \"/home/alberto/Software/miniconda3/envs/htmd/lib/python3.6/site-packages/moleculekit/tools/voxeldescriptors.py\", line 221, in getVoxelDescriptors\r\n    channels, mol = getChannels(mol, aromaticNitrogen, version, validitychecks)\r\n  File \"/home/alberto/Software/miniconda3/envs/htmd/lib/python3.6/site-packages/moleculekit/tools/voxeldescriptors.py\", line 106, in getChannels\r\n    mol.atomtype, mol.charge = getPDBQTAtomTypesAndCharges(mol, aromaticNitrogen=aromaticNitrogen, validitychecks=validitychecks)\r\n  File \"/home/alberto/Software/miniconda3/envs/htmd/lib/python3.6/site-packages/moleculekit/tools/atomtyper.py\", line 222, in getPDBQTAtomTypesAndCharges\r\n    atomtypingValidityChecks(mol)\r\n  File \"/home/alberto/Software/miniconda3/envs/htmd/lib/python3.6/site-packages/moleculekit/tools/atomtyper.py\", line 196, in atomtypingValidityChecks\r\n    raise ValueError('The protein has less bonds than (number of atoms - 1). This seems incorrect. You can assign bonds with `mol.bonds = mol._getBonds()`')\r\nValueError: The protein has less bonds than (number of atoms - 1). This seems incorrect. You can assign bonds with `mol.bonds = mol._getBonds()\r\n```\r\n\r\nI tried to follow the suggestion about the bonds:\r\n\r\n```python\r\nfrom htmd.molecule.molecule import Molecule\r\nfrom moleculekit.tools.voxeldescriptors import getVoxelDescriptors\r\n\r\nm = Molecule('3PTB')\r\nm.filter('protein')\r\nm.bonds = m._getBonds()\r\nfeatures, centers, N = getVoxelDescriptors(m, buffer=8)\r\n```\r\n\r\nThe error:\r\n\r\n```python\r\n  File \"current_session2.py\", line 8, in <module>\r\n    features, centers, N = getVoxelDescriptors(m, buffer=8)\r\n  File \"/home/alberto/Software/miniconda3/envs/htmd/lib/python3.6/site-packages/moleculekit/tools/voxeldescriptors.py\", line 221, in getVoxelDescriptors\r\n    channels, mol = getChannels(mol, aromaticNitrogen, version, validitychecks)\r\n  File \"/home/alberto/Software/miniconda3/envs/htmd/lib/python3.6/site-packages/moleculekit/tools/voxeldescriptors.py\", line 106, in getChannels\r\n    mol.atomtype, mol.charge = getPDBQTAtomTypesAndCharges(mol, aromaticNitrogen=aromaticNitrogen, validitychecks=validitychecks)\r\n  File \"/home/alberto/Software/miniconda3/envs/htmd/lib/python3.6/site-packages/moleculekit/tools/atomtyper.py\", line 222, in getPDBQTAtomTypesAndCharges\r\n    atomtypingValidityChecks(mol)\r\n  File \"/home/alberto/Software/miniconda3/envs/htmd/lib/python3.6/site-packages/moleculekit/tools/atomtyper.py\", line 201, in atomtypingValidityChecks\r\n    raise RuntimeError('The protein has duplicate bond information. This will mess up atom typing. Please keep only unique bonds in the molecule. If you want you can use moleculekit.molecule.calculateUniqueBonds for this.')\r\nRuntimeError: The protein has duplicate bond information. This will mess up atom typing. Please keep only unique bonds in the molecule. If you want you can use moleculekit.molecule.calculateUniqueBonds for this.\r\n```\r\n\r\nOk, as before I tried to follow the suggestion by using *calculateUniqueBonds* (following the example in the method).\r\n\r\n```python\r\nfrom htmd.molecule.molecule import Molecule\r\nfrom moleculekit.tools.voxeldescriptors import getVoxelDescriptors\r\nfrom moleculekit.molecule import calculateUniqueBonds\r\n\r\nm = Molecule('3PTB')\r\nm.filter('protein')\r\nm.bonds, m.bondtype = calculateUniqueBonds(m.bonds, m.bondtype)\r\nfeatures, centers, N = getVoxelDescriptors(m, buffer=8)\r\n```\r\n\r\nThe error:\r\n\r\n```python \r\nTraceback (most recent call last):\r\n  File \"current_session3.py\", line 9, in <module>\r\n    features, centers, N = getVoxelDescriptors(m, buffer=8)\r\n  File \"/home/alberto/Software/miniconda3/envs/htmd/lib/python3.6/site-packages/moleculekit/tools/voxeldescriptors.py\", line 221, in getVoxelDescriptors\r\n    channels, mol = getChannels(mol, aromaticNitrogen, version, validitychecks)\r\n  File \"/home/alberto/Software/miniconda3/envs/htmd/lib/python3.6/site-packages/moleculekit/tools/voxeldescriptors.py\", line 106, in getChannels\r\n    mol.atomtype, mol.charge = getPDBQTAtomTypesAndCharges(mol, aromaticNitrogen=aromaticNitrogen, validitychecks=validitychecks)\r\n  File \"/home/alberto/Software/miniconda3/envs/htmd/lib/python3.6/site-packages/moleculekit/tools/atomtyper.py\", line 222, in getPDBQTAtomTypesAndCharges\r\n    atomtypingValidityChecks(mol)\r\n  File \"/home/alberto/Software/miniconda3/envs/htmd/lib/python3.6/site-packages/moleculekit/tools/atomtyper.py\", line 196, in atomtypingValidityChecks\r\n    raise ValueError('The protein has less bonds than (number of atoms - 1). This seems incorrect. You can assign bonds with `mol.bonds = mol._getBonds()`')\r\nValueError: The protein has less bonds than (number of atoms - 1). This seems incorrect. You can assign bonds with `mol.bonds = mol._getBonds()\r\n```\r\n\r\n\r\nDo you have any suggestion?","closed_by":{"login":"stefdoerr","id":7935362,"node_id":"MDQ6VXNlcjc5MzUzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/7935362?v=4","gravatar_id":"","url":"https://api.github.com/users/stefdoerr","html_url":"https://github.com/stefdoerr","followers_url":"https://api.github.com/users/stefdoerr/followers","following_url":"https://api.github.com/users/stefdoerr/following{/other_user}","gists_url":"https://api.github.com/users/stefdoerr/gists{/gist_id}","starred_url":"https://api.github.com/users/stefdoerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefdoerr/subscriptions","organizations_url":"https://api.github.com/users/stefdoerr/orgs","repos_url":"https://api.github.com/users/stefdoerr/repos","events_url":"https://api.github.com/users/stefdoerr/events{/privacy}","received_events_url":"https://api.github.com/users/stefdoerr/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/58/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Acellera/moleculekit/issues/58/timeline","performed_via_github_app":null,"state_reason":"completed"}