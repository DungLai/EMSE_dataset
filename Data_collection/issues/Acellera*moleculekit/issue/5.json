{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/5","repository_url":"https://api.github.com/repos/Acellera/moleculekit","labels_url":"https://api.github.com/repos/Acellera/moleculekit/issues/5/labels{/name}","comments_url":"https://api.github.com/repos/Acellera/moleculekit/issues/5/comments","events_url":"https://api.github.com/repos/Acellera/moleculekit/issues/5/events","html_url":"https://github.com/Acellera/moleculekit/issues/5","id":436392310,"node_id":"MDU6SXNzdWU0MzYzOTIzMTA=","number":5,"title":"Voxel descriptors - problem with assigning atom types to SmallMol","user":{"login":"larry0x","id":26318510,"node_id":"MDQ6VXNlcjI2MzE4NTEw","avatar_url":"https://avatars.githubusercontent.com/u/26318510?v=4","gravatar_id":"","url":"https://api.github.com/users/larry0x","html_url":"https://github.com/larry0x","followers_url":"https://api.github.com/users/larry0x/followers","following_url":"https://api.github.com/users/larry0x/following{/other_user}","gists_url":"https://api.github.com/users/larry0x/gists{/gist_id}","starred_url":"https://api.github.com/users/larry0x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/larry0x/subscriptions","organizations_url":"https://api.github.com/users/larry0x/orgs","repos_url":"https://api.github.com/users/larry0x/repos","events_url":"https://api.github.com/users/larry0x/events{/privacy}","received_events_url":"https://api.github.com/users/larry0x/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-04-23T21:11:08Z","updated_at":"2019-05-30T13:53:35Z","closed_at":"2019-05-30T13:53:35Z","author_association":"NONE","active_lock_reason":null,"body":"Hi devs,\r\n\r\nBefore you get the documentations ready, I tried to figure out how to generate voxel descriptors for my small molecules myself. I used [this molecule](https://files.rcsb.org/ligands/view/GDP_ideal.sdf) from the PDB as a test. Below is the code:\r\n\r\n```python\r\nfrom rdkit import Chem\r\n\r\nfrom moleculekit.smallmol.smallmol import SmallMol\r\nfrom moleculekit.tools.voxeldescriptors import getVoxelDescriptors\r\n\r\nimport matplotlib.pyplot as plt\r\nfrom mpl_toolkits.mplot3d import axes3d\r\n\r\n# read molecule\r\nsuppl = Chem.SDMolSupplier(\"../data/GDP_model.sdf\")\r\nmol = SmallMol(suppl[0])\r\n\r\n# generate voxels\r\nfeatures, _, _ = getVoxelDescriptors(mol,\r\n                                     boxsize=(16, 16, 16),\r\n                                     voxelsize=0.5,\r\n                                     center=mol.getCenter())\r\nfeatures = features.reshape(32, 32, 32, 8)\r\n\r\n# visualize voxels\r\nchannel_names = [\"hydrophobic\", \"aromatic\", \"hbond_acceptor\", \"hbond_donor\",\r\n                 \"positive_ionizable\", \"negative_ionizable\", \"metal\", \"occupancies\"]\r\nthreshold = 0.9\r\nfeatures = (features >= threshold).astype(float)\r\n\r\nfig = plt.figure(figsize=(16, 8))\r\n\r\nfor i in range(8):\r\n    ax = fig.add_subplot(241+i, projection=\"3d\")\r\n    ax.voxels(features[:, :, :, i], facecolors=\"red\", edgecolor=\"k\")\r\n    ax.set_title(channel_names[i])\r\n\r\nfig.tight_layout()\r\nplt.show()\r\n```\r\n\r\nMost of the channels generated by this code look fine, **but `hydrophobic` and `negative_ionizable` channels are completely empty.** This does not make sense chemically, since at least some carbon atoms on the guanine and ribose rings should be considered hydrophobic, and the hydroxyls on the phosphates are definitively negatively ionizable.\r\n\r\nI noticed when a `SmallMol` object is passed into `getVoxelDescriptors`, the function calls `_getPropertiesRDkit`, which in turn calls some RDKit functions to assign properties to atoms. I tried to print the `channels` array generated by this function, and it looked like all atoms are assigned zeros for `hydrophobic` and `negative_ionizable` channels. \r\n\r\nDid I do this wrong, or is this an issue with RDKit? Thank you","closed_by":{"login":"stefdoerr","id":7935362,"node_id":"MDQ6VXNlcjc5MzUzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/7935362?v=4","gravatar_id":"","url":"https://api.github.com/users/stefdoerr","html_url":"https://github.com/stefdoerr","followers_url":"https://api.github.com/users/stefdoerr/followers","following_url":"https://api.github.com/users/stefdoerr/following{/other_user}","gists_url":"https://api.github.com/users/stefdoerr/gists{/gist_id}","starred_url":"https://api.github.com/users/stefdoerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefdoerr/subscriptions","organizations_url":"https://api.github.com/users/stefdoerr/orgs","repos_url":"https://api.github.com/users/stefdoerr/repos","events_url":"https://api.github.com/users/stefdoerr/events{/privacy}","received_events_url":"https://api.github.com/users/stefdoerr/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/5/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Acellera/moleculekit/issues/5/timeline","performed_via_github_app":null,"state_reason":"completed"}