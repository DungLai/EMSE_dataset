{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/68","repository_url":"https://api.github.com/repos/Acellera/moleculekit","labels_url":"https://api.github.com/repos/Acellera/moleculekit/issues/68/labels{/name}","comments_url":"https://api.github.com/repos/Acellera/moleculekit/issues/68/comments","events_url":"https://api.github.com/repos/Acellera/moleculekit/issues/68/events","html_url":"https://github.com/Acellera/moleculekit/issues/68","id":812390675,"node_id":"MDU6SXNzdWU4MTIzOTA2NzU=","number":68,"title":"Molecule from SDF file cannot be constructed if there are >100 atoms/bond","user":{"login":"cisert","id":38595078,"node_id":"MDQ6VXNlcjM4NTk1MDc4","avatar_url":"https://avatars.githubusercontent.com/u/38595078?v=4","gravatar_id":"","url":"https://api.github.com/users/cisert","html_url":"https://github.com/cisert","followers_url":"https://api.github.com/users/cisert/followers","following_url":"https://api.github.com/users/cisert/following{/other_user}","gists_url":"https://api.github.com/users/cisert/gists{/gist_id}","starred_url":"https://api.github.com/users/cisert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cisert/subscriptions","organizations_url":"https://api.github.com/users/cisert/orgs","repos_url":"https://api.github.com/users/cisert/repos","events_url":"https://api.github.com/users/cisert/events{/privacy}","received_events_url":"https://api.github.com/users/cisert/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-02-19T22:14:13Z","updated_at":"2021-02-22T07:46:45Z","closed_at":"2021-02-22T07:46:45Z","author_association":"NONE","active_lock_reason":null,"body":"Dear all, \r\n\r\nI noticed that constructing a Molecule object from an SDF file throws an error if there are more than 100 atoms/bonds in the file, since the counts line does not include a space between the `atom_number` and `bond_number` in this case (https://www.daylight.com/meetings/mug05/Kappler/ctfile.pdf, p. 10). Currently, the number of atoms and bonds in the molecule is determined using \r\n```\r\nn_atoms, n_bonds = lines[mol_start+3].split()[:2]\r\n```\r\n(https://github.com/Acellera/moleculekit/blob/master/moleculekit/readers.py#L2151) which doesn't work it there's no space between n_atoms and n_bonds. E.g. for a counts line like \r\n```\r\n110115  0  0  0  0  0  0  0  0999 V2000\\n\r\n```\r\nwe get `n_atoms = 110115, n_bonds = 0`. See attached [CHEMBL2315234_example.txt](https://github.com/Acellera/moleculekit/files/6013243/CHEMBL2315234_example.txt), which I couldn't upload as an SDF, so I changed the extension to something GitHub supports. \r\n\r\nAccording to the documentation above, the first three characters of the counts line correspond to `n_atoms`, and characters 4-6 to `n_bonds`, so \r\n```\r\nn_atoms = lines[mol_start+3][:3]\r\nn_bonds = lines[mol_start+3][3:6]\r\n```\r\nworks (`n_atoms` and `n_bonds` are `str` in the current implementation too). I checked this with one-, two-, and three-digit atom and bond numbers and it works fine. \r\n\r\nSince I don't have a signed contributor license, feel free to include this if deemed beneficial. \r\n\r\nBest, \r\nClemens \r\n\r\n\r\n\r\n","closed_by":{"login":"stefdoerr","id":7935362,"node_id":"MDQ6VXNlcjc5MzUzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/7935362?v=4","gravatar_id":"","url":"https://api.github.com/users/stefdoerr","html_url":"https://github.com/stefdoerr","followers_url":"https://api.github.com/users/stefdoerr/followers","following_url":"https://api.github.com/users/stefdoerr/following{/other_user}","gists_url":"https://api.github.com/users/stefdoerr/gists{/gist_id}","starred_url":"https://api.github.com/users/stefdoerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefdoerr/subscriptions","organizations_url":"https://api.github.com/users/stefdoerr/orgs","repos_url":"https://api.github.com/users/stefdoerr/repos","events_url":"https://api.github.com/users/stefdoerr/events{/privacy}","received_events_url":"https://api.github.com/users/stefdoerr/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/68/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Acellera/moleculekit/issues/68/timeline","performed_via_github_app":null,"state_reason":"completed"}