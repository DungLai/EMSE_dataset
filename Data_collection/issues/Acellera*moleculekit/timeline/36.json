[{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/comments/542104267","html_url":"https://github.com/Acellera/moleculekit/issues/36#issuecomment-542104267","issue_url":"https://api.github.com/repos/Acellera/moleculekit/issues/36","id":542104267,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjEwNDI2Nw==","user":{"login":"stefdoerr","id":7935362,"node_id":"MDQ6VXNlcjc5MzUzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/7935362?v=4","gravatar_id":"","url":"https://api.github.com/users/stefdoerr","html_url":"https://github.com/stefdoerr","followers_url":"https://api.github.com/users/stefdoerr/followers","following_url":"https://api.github.com/users/stefdoerr/following{/other_user}","gists_url":"https://api.github.com/users/stefdoerr/gists{/gist_id}","starred_url":"https://api.github.com/users/stefdoerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefdoerr/subscriptions","organizations_url":"https://api.github.com/users/stefdoerr/orgs","repos_url":"https://api.github.com/users/stefdoerr/repos","events_url":"https://api.github.com/users/stefdoerr/events{/privacy}","received_events_url":"https://api.github.com/users/stefdoerr/received_events","type":"User","site_admin":false},"created_at":"2019-10-15T08:38:36Z","updated_at":"2019-10-15T08:38:36Z","author_association":"CONTRIBUTOR","body":"Ugh, this is a protein preparation / bonding issue. `pdb2pqr` adds terminal atoms to GLN 227 during the protein preparation but the distances are probably a bit off for atom 3514 so the bonds are not guessed correctly for it and it's not considered \"protein\" anymore.\r\n\r\n```python\r\nIn [8]: prot = prepareProteinForAtomtyping(prot)\r\n\r\nIn [11]: prot.atomselect('not protein', indexes=True)                                                                                                                                                              \r\nOut[11]: array([3514], dtype=int32)\r\n\r\nIn [12]: prot.get('resname', sel='not protein')                                                                                                                                                                    \r\nOut[12]: array(['GLN'], dtype=object)\r\n\r\nIn [13]: prot.get('resid', sel='not protein')                                                                                                                                                                      \r\nOut[13]: array([227])\r\n````\r\nIf that atom is not close to any site of interest I would suggest removing it with `prot.remove('index 3514')` and continuing with the voxelization. A bit of an extreme solution but sometimes you really can't win with such complex protocols and external software.\r\nIf it occurs in many other cases feel free to report them and I will check if anything can be done about it.\r\n","reactions":{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/comments/542104267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"stefdoerr","id":7935362,"node_id":"MDQ6VXNlcjc5MzUzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/7935362?v=4","gravatar_id":"","url":"https://api.github.com/users/stefdoerr","html_url":"https://github.com/stefdoerr","followers_url":"https://api.github.com/users/stefdoerr/followers","following_url":"https://api.github.com/users/stefdoerr/following{/other_user}","gists_url":"https://api.github.com/users/stefdoerr/gists{/gist_id}","starred_url":"https://api.github.com/users/stefdoerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefdoerr/subscriptions","organizations_url":"https://api.github.com/users/stefdoerr/orgs","repos_url":"https://api.github.com/users/stefdoerr/repos","events_url":"https://api.github.com/users/stefdoerr/events{/privacy}","received_events_url":"https://api.github.com/users/stefdoerr/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/comments/542276784","html_url":"https://github.com/Acellera/moleculekit/issues/36#issuecomment-542276784","issue_url":"https://api.github.com/repos/Acellera/moleculekit/issues/36","id":542276784,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjI3Njc4NA==","user":{"login":"keisuke-yanagisawa","id":6902135,"node_id":"MDQ6VXNlcjY5MDIxMzU=","avatar_url":"https://avatars.githubusercontent.com/u/6902135?v=4","gravatar_id":"","url":"https://api.github.com/users/keisuke-yanagisawa","html_url":"https://github.com/keisuke-yanagisawa","followers_url":"https://api.github.com/users/keisuke-yanagisawa/followers","following_url":"https://api.github.com/users/keisuke-yanagisawa/following{/other_user}","gists_url":"https://api.github.com/users/keisuke-yanagisawa/gists{/gist_id}","starred_url":"https://api.github.com/users/keisuke-yanagisawa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keisuke-yanagisawa/subscriptions","organizations_url":"https://api.github.com/users/keisuke-yanagisawa/orgs","repos_url":"https://api.github.com/users/keisuke-yanagisawa/repos","events_url":"https://api.github.com/users/keisuke-yanagisawa/events{/privacy}","received_events_url":"https://api.github.com/users/keisuke-yanagisawa/received_events","type":"User","site_admin":false},"created_at":"2019-10-15T15:42:04Z","updated_at":"2019-10-15T15:42:04Z","author_association":"NONE","body":"I catch the reason. Hmmmmm...\r\nActually I met the error several times, and thus far I avoided those by downloading atomtyper.py and voxeldescriptors.py and modified `notallowed = ~(protsel | metalsel)` to `notallowed = ~(protsel | metalsel | stdaasel)` (there is an another reason to decide modify atomtyper.py: some protein has PB, BA, and other metals, btw). \r\n\r\nActually, I utilized preprocessed PDB files, thus I could not guarantee which PDB record raise the error in original state. If you want, I will check it for original PDB files of interest.\r\n","reactions":{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/comments/542276784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"keisuke-yanagisawa","id":6902135,"node_id":"MDQ6VXNlcjY5MDIxMzU=","avatar_url":"https://avatars.githubusercontent.com/u/6902135?v=4","gravatar_id":"","url":"https://api.github.com/users/keisuke-yanagisawa","html_url":"https://github.com/keisuke-yanagisawa","followers_url":"https://api.github.com/users/keisuke-yanagisawa/followers","following_url":"https://api.github.com/users/keisuke-yanagisawa/following{/other_user}","gists_url":"https://api.github.com/users/keisuke-yanagisawa/gists{/gist_id}","starred_url":"https://api.github.com/users/keisuke-yanagisawa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keisuke-yanagisawa/subscriptions","organizations_url":"https://api.github.com/users/keisuke-yanagisawa/orgs","repos_url":"https://api.github.com/users/keisuke-yanagisawa/repos","events_url":"https://api.github.com/users/keisuke-yanagisawa/events{/privacy}","received_events_url":"https://api.github.com/users/keisuke-yanagisawa/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/comments/542280358","html_url":"https://github.com/Acellera/moleculekit/issues/36#issuecomment-542280358","issue_url":"https://api.github.com/repos/Acellera/moleculekit/issues/36","id":542280358,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjI4MDM1OA==","user":{"login":"keisuke-yanagisawa","id":6902135,"node_id":"MDQ6VXNlcjY5MDIxMzU=","avatar_url":"https://avatars.githubusercontent.com/u/6902135?v=4","gravatar_id":"","url":"https://api.github.com/users/keisuke-yanagisawa","html_url":"https://github.com/keisuke-yanagisawa","followers_url":"https://api.github.com/users/keisuke-yanagisawa/followers","following_url":"https://api.github.com/users/keisuke-yanagisawa/following{/other_user}","gists_url":"https://api.github.com/users/keisuke-yanagisawa/gists{/gist_id}","starred_url":"https://api.github.com/users/keisuke-yanagisawa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keisuke-yanagisawa/subscriptions","organizations_url":"https://api.github.com/users/keisuke-yanagisawa/orgs","repos_url":"https://api.github.com/users/keisuke-yanagisawa/repos","events_url":"https://api.github.com/users/keisuke-yanagisawa/events{/privacy}","received_events_url":"https://api.github.com/users/keisuke-yanagisawa/received_events","type":"User","site_admin":false},"created_at":"2019-10-15T15:50:06Z","updated_at":"2019-10-15T15:50:17Z","author_association":"NONE","body":"But my second thought is that below code is probably more robust:\r\n```py\r\nprot = Molecule(\"pdb1e2x.ent.gz\")\r\nprot.filter(\"protein or ions\") # remove H2O and SO4\r\nprot = prepareProteinForAtomtyping(prot)\r\nprot.filter(\"protein or ions\") # remove isolated atoms\r\n\r\nprot_vox, prot_centers, prot_N = getVoxelDescriptors(prot, buffer=1)\r\n```\r\nIs it valid way to avoid the issue for you?","reactions":{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/comments/542280358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"keisuke-yanagisawa","id":6902135,"node_id":"MDQ6VXNlcjY5MDIxMzU=","avatar_url":"https://avatars.githubusercontent.com/u/6902135?v=4","gravatar_id":"","url":"https://api.github.com/users/keisuke-yanagisawa","html_url":"https://github.com/keisuke-yanagisawa","followers_url":"https://api.github.com/users/keisuke-yanagisawa/followers","following_url":"https://api.github.com/users/keisuke-yanagisawa/following{/other_user}","gists_url":"https://api.github.com/users/keisuke-yanagisawa/gists{/gist_id}","starred_url":"https://api.github.com/users/keisuke-yanagisawa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keisuke-yanagisawa/subscriptions","organizations_url":"https://api.github.com/users/keisuke-yanagisawa/orgs","repos_url":"https://api.github.com/users/keisuke-yanagisawa/repos","events_url":"https://api.github.com/users/keisuke-yanagisawa/events{/privacy}","received_events_url":"https://api.github.com/users/keisuke-yanagisawa/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/comments/542287602","html_url":"https://github.com/Acellera/moleculekit/issues/36#issuecomment-542287602","issue_url":"https://api.github.com/repos/Acellera/moleculekit/issues/36","id":542287602,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjI4NzYwMg==","user":{"login":"stefdoerr","id":7935362,"node_id":"MDQ6VXNlcjc5MzUzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/7935362?v=4","gravatar_id":"","url":"https://api.github.com/users/stefdoerr","html_url":"https://github.com/stefdoerr","followers_url":"https://api.github.com/users/stefdoerr/followers","following_url":"https://api.github.com/users/stefdoerr/following{/other_user}","gists_url":"https://api.github.com/users/stefdoerr/gists{/gist_id}","starred_url":"https://api.github.com/users/stefdoerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefdoerr/subscriptions","organizations_url":"https://api.github.com/users/stefdoerr/orgs","repos_url":"https://api.github.com/users/stefdoerr/repos","events_url":"https://api.github.com/users/stefdoerr/events{/privacy}","received_events_url":"https://api.github.com/users/stefdoerr/received_events","type":"User","site_admin":false},"created_at":"2019-10-15T16:05:32Z","updated_at":"2019-10-15T16:05:32Z","author_association":"CONTRIBUTOR","body":"Yes but maybe take a look at how many atoms get removed. the filter method\nreturns the atoms which were removed so check that it doesnt suddenly\ndelete 200 atoms or something ;)\n\n\nOn Tue, Oct 15, 2019 at 6:50 PM K. Yanagisawa <notifications@github.com>\nwrote:\n\n> But my second thought is that below code is probably more robust:\n>\n> prot = Molecule(\"pdb1e2x.ent.gz\")\n> prot.filter(\"protein or ions\") # remove H2O and SO4\n> prot = prepareProteinForAtomtyping(prot)\n> prot.filter(\"protein or ions\") # remove isolated atoms\n>\n> prot_vox, prot_centers, prot_N = getVoxelDescriptors(prot, buffer=1)\n>\n> Is it valid way to avoid the issue for you?\n>\n> —\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/Acellera/moleculekit/issues/36?email_source=notifications&email_token=AB4RLAV2ZZQCZQ63ZKLECMLQOXRC5A5CNFSM4JARSV52YY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGOEBJIVJQ#issuecomment-542280358>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AB4RLAVD3FA44GU2V4IJGVLQOXRC5ANCNFSM4JARSV5Q>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/comments/542287602/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"stefdoerr","id":7935362,"node_id":"MDQ6VXNlcjc5MzUzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/7935362?v=4","gravatar_id":"","url":"https://api.github.com/users/stefdoerr","html_url":"https://github.com/stefdoerr","followers_url":"https://api.github.com/users/stefdoerr/followers","following_url":"https://api.github.com/users/stefdoerr/following{/other_user}","gists_url":"https://api.github.com/users/stefdoerr/gists{/gist_id}","starred_url":"https://api.github.com/users/stefdoerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefdoerr/subscriptions","organizations_url":"https://api.github.com/users/stefdoerr/orgs","repos_url":"https://api.github.com/users/stefdoerr/repos","events_url":"https://api.github.com/users/stefdoerr/events{/privacy}","received_events_url":"https://api.github.com/users/stefdoerr/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/comments/542433993","html_url":"https://github.com/Acellera/moleculekit/issues/36#issuecomment-542433993","issue_url":"https://api.github.com/repos/Acellera/moleculekit/issues/36","id":542433993,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjQzMzk5Mw==","user":{"login":"keisuke-yanagisawa","id":6902135,"node_id":"MDQ6VXNlcjY5MDIxMzU=","avatar_url":"https://avatars.githubusercontent.com/u/6902135?v=4","gravatar_id":"","url":"https://api.github.com/users/keisuke-yanagisawa","html_url":"https://github.com/keisuke-yanagisawa","followers_url":"https://api.github.com/users/keisuke-yanagisawa/followers","following_url":"https://api.github.com/users/keisuke-yanagisawa/following{/other_user}","gists_url":"https://api.github.com/users/keisuke-yanagisawa/gists{/gist_id}","starred_url":"https://api.github.com/users/keisuke-yanagisawa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keisuke-yanagisawa/subscriptions","organizations_url":"https://api.github.com/users/keisuke-yanagisawa/orgs","repos_url":"https://api.github.com/users/keisuke-yanagisawa/repos","events_url":"https://api.github.com/users/keisuke-yanagisawa/events{/privacy}","received_events_url":"https://api.github.com/users/keisuke-yanagisawa/received_events","type":"User","site_admin":false},"created_at":"2019-10-15T22:37:13Z","updated_at":"2019-10-15T22:37:13Z","author_association":"NONE","body":"Okay I understand! I will monitor the numbers.","reactions":{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/comments/542433993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"keisuke-yanagisawa","id":6902135,"node_id":"MDQ6VXNlcjY5MDIxMzU=","avatar_url":"https://avatars.githubusercontent.com/u/6902135?v=4","gravatar_id":"","url":"https://api.github.com/users/keisuke-yanagisawa","html_url":"https://github.com/keisuke-yanagisawa","followers_url":"https://api.github.com/users/keisuke-yanagisawa/followers","following_url":"https://api.github.com/users/keisuke-yanagisawa/following{/other_user}","gists_url":"https://api.github.com/users/keisuke-yanagisawa/gists{/gist_id}","starred_url":"https://api.github.com/users/keisuke-yanagisawa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keisuke-yanagisawa/subscriptions","organizations_url":"https://api.github.com/users/keisuke-yanagisawa/orgs","repos_url":"https://api.github.com/users/keisuke-yanagisawa/repos","events_url":"https://api.github.com/users/keisuke-yanagisawa/events{/privacy}","received_events_url":"https://api.github.com/users/keisuke-yanagisawa/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/comments/553202487","html_url":"https://github.com/Acellera/moleculekit/issues/36#issuecomment-553202487","issue_url":"https://api.github.com/repos/Acellera/moleculekit/issues/36","id":553202487,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzIwMjQ4Nw==","user":{"login":"stefdoerr","id":7935362,"node_id":"MDQ6VXNlcjc5MzUzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/7935362?v=4","gravatar_id":"","url":"https://api.github.com/users/stefdoerr","html_url":"https://github.com/stefdoerr","followers_url":"https://api.github.com/users/stefdoerr/followers","following_url":"https://api.github.com/users/stefdoerr/following{/other_user}","gists_url":"https://api.github.com/users/stefdoerr/gists{/gist_id}","starred_url":"https://api.github.com/users/stefdoerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefdoerr/subscriptions","organizations_url":"https://api.github.com/users/stefdoerr/orgs","repos_url":"https://api.github.com/users/stefdoerr/repos","events_url":"https://api.github.com/users/stefdoerr/events{/privacy}","received_events_url":"https://api.github.com/users/stefdoerr/received_events","type":"User","site_admin":false},"created_at":"2019-11-13T01:59:44Z","updated_at":"2019-11-13T01:59:44Z","author_association":"CONTRIBUTOR","body":"I will close the issue for now. If you have any further questions feel free to comment here or open a new one","reactions":{"url":"https://api.github.com/repos/Acellera/moleculekit/issues/comments/553202487/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"stefdoerr","id":7935362,"node_id":"MDQ6VXNlcjc5MzUzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/7935362?v=4","gravatar_id":"","url":"https://api.github.com/users/stefdoerr","html_url":"https://github.com/stefdoerr","followers_url":"https://api.github.com/users/stefdoerr/followers","following_url":"https://api.github.com/users/stefdoerr/following{/other_user}","gists_url":"https://api.github.com/users/stefdoerr/gists{/gist_id}","starred_url":"https://api.github.com/users/stefdoerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefdoerr/subscriptions","organizations_url":"https://api.github.com/users/stefdoerr/orgs","repos_url":"https://api.github.com/users/stefdoerr/repos","events_url":"https://api.github.com/users/stefdoerr/events{/privacy}","received_events_url":"https://api.github.com/users/stefdoerr/received_events","type":"User","site_admin":false}},{"id":2793639237,"node_id":"MDExOkNsb3NlZEV2ZW50Mjc5MzYzOTIzNw==","url":"https://api.github.com/repos/Acellera/moleculekit/issues/events/2793639237","actor":{"login":"stefdoerr","id":7935362,"node_id":"MDQ6VXNlcjc5MzUzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/7935362?v=4","gravatar_id":"","url":"https://api.github.com/users/stefdoerr","html_url":"https://github.com/stefdoerr","followers_url":"https://api.github.com/users/stefdoerr/followers","following_url":"https://api.github.com/users/stefdoerr/following{/other_user}","gists_url":"https://api.github.com/users/stefdoerr/gists{/gist_id}","starred_url":"https://api.github.com/users/stefdoerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefdoerr/subscriptions","organizations_url":"https://api.github.com/users/stefdoerr/orgs","repos_url":"https://api.github.com/users/stefdoerr/repos","events_url":"https://api.github.com/users/stefdoerr/events{/privacy}","received_events_url":"https://api.github.com/users/stefdoerr/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-11-13T01:59:44Z","state_reason":null,"performed_via_github_app":null}]