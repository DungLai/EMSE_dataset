[{"url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/comments/608191421","html_url":"https://github.com/ildoonet/pytorch-gradual-warmup-lr/issues/8#issuecomment-608191421","issue_url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/8","id":608191421,"node_id":"MDEyOklzc3VlQ29tbWVudDYwODE5MTQyMQ==","user":{"login":"ildoonet","id":1115758,"node_id":"MDQ6VXNlcjExMTU3NTg=","avatar_url":"https://avatars.githubusercontent.com/u/1115758?v=4","gravatar_id":"","url":"https://api.github.com/users/ildoonet","html_url":"https://github.com/ildoonet","followers_url":"https://api.github.com/users/ildoonet/followers","following_url":"https://api.github.com/users/ildoonet/following{/other_user}","gists_url":"https://api.github.com/users/ildoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/ildoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ildoonet/subscriptions","organizations_url":"https://api.github.com/users/ildoonet/orgs","repos_url":"https://api.github.com/users/ildoonet/repos","events_url":"https://api.github.com/users/ildoonet/events{/privacy}","received_events_url":"https://api.github.com/users/ildoonet/received_events","type":"User","site_admin":false},"created_at":"2020-04-03T02:15:13Z","updated_at":"2020-04-03T02:15:13Z","author_association":"OWNER","body":"@Bryce1010 Thanks. I will update thie repo for torch 1.4\r\n\r\n","reactions":{"url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/comments/608191421/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ildoonet","id":1115758,"node_id":"MDQ6VXNlcjExMTU3NTg=","avatar_url":"https://avatars.githubusercontent.com/u/1115758?v=4","gravatar_id":"","url":"https://api.github.com/users/ildoonet","html_url":"https://github.com/ildoonet","followers_url":"https://api.github.com/users/ildoonet/followers","following_url":"https://api.github.com/users/ildoonet/following{/other_user}","gists_url":"https://api.github.com/users/ildoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/ildoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ildoonet/subscriptions","organizations_url":"https://api.github.com/users/ildoonet/orgs","repos_url":"https://api.github.com/users/ildoonet/repos","events_url":"https://api.github.com/users/ildoonet/events{/privacy}","received_events_url":"https://api.github.com/users/ildoonet/received_events","type":"User","site_admin":false}},{"id":3194577039,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzE5NDU3NzAzOQ==","url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/events/3194577039","actor":{"login":"Bryce1010","id":30361513,"node_id":"MDQ6VXNlcjMwMzYxNTEz","avatar_url":"https://avatars.githubusercontent.com/u/30361513?v=4","gravatar_id":"","url":"https://api.github.com/users/Bryce1010","html_url":"https://github.com/Bryce1010","followers_url":"https://api.github.com/users/Bryce1010/followers","following_url":"https://api.github.com/users/Bryce1010/following{/other_user}","gists_url":"https://api.github.com/users/Bryce1010/gists{/gist_id}","starred_url":"https://api.github.com/users/Bryce1010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bryce1010/subscriptions","organizations_url":"https://api.github.com/users/Bryce1010/orgs","repos_url":"https://api.github.com/users/Bryce1010/repos","events_url":"https://api.github.com/users/Bryce1010/events{/privacy}","received_events_url":"https://api.github.com/users/Bryce1010/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-04-03T02:15:14Z","performed_via_github_app":null},{"id":3194577041,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMxOTQ1NzcwNDE=","url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/events/3194577041","actor":{"login":"Bryce1010","id":30361513,"node_id":"MDQ6VXNlcjMwMzYxNTEz","avatar_url":"https://avatars.githubusercontent.com/u/30361513?v=4","gravatar_id":"","url":"https://api.github.com/users/Bryce1010","html_url":"https://github.com/Bryce1010","followers_url":"https://api.github.com/users/Bryce1010/followers","following_url":"https://api.github.com/users/Bryce1010/following{/other_user}","gists_url":"https://api.github.com/users/Bryce1010/gists{/gist_id}","starred_url":"https://api.github.com/users/Bryce1010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bryce1010/subscriptions","organizations_url":"https://api.github.com/users/Bryce1010/orgs","repos_url":"https://api.github.com/users/Bryce1010/repos","events_url":"https://api.github.com/users/Bryce1010/events{/privacy}","received_events_url":"https://api.github.com/users/Bryce1010/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-04-03T02:15:14Z","performed_via_github_app":null},{"id":3198824723,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDMxOTg4MjQ3MjM=","url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/events/3198824723","actor":{"login":"ildoonet","id":1115758,"node_id":"MDQ6VXNlcjExMTU3NTg=","avatar_url":"https://avatars.githubusercontent.com/u/1115758?v=4","gravatar_id":"","url":"https://api.github.com/users/ildoonet","html_url":"https://github.com/ildoonet","followers_url":"https://api.github.com/users/ildoonet/followers","following_url":"https://api.github.com/users/ildoonet/following{/other_user}","gists_url":"https://api.github.com/users/ildoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/ildoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ildoonet/subscriptions","organizations_url":"https://api.github.com/users/ildoonet/orgs","repos_url":"https://api.github.com/users/ildoonet/repos","events_url":"https://api.github.com/users/ildoonet/events{/privacy}","received_events_url":"https://api.github.com/users/ildoonet/received_events","type":"User","site_admin":false},"event":"referenced","commit_id":"4d1d35535caac4864d9133455f175c41b2c82bcd","commit_url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/commits/4d1d35535caac4864d9133455f175c41b2c82bcd","created_at":"2020-04-04T05:04:32Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/comments/608975742","html_url":"https://github.com/ildoonet/pytorch-gradual-warmup-lr/issues/8#issuecomment-608975742","issue_url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/8","id":608975742,"node_id":"MDEyOklzc3VlQ29tbWVudDYwODk3NTc0Mg==","user":{"login":"ildoonet","id":1115758,"node_id":"MDQ6VXNlcjExMTU3NTg=","avatar_url":"https://avatars.githubusercontent.com/u/1115758?v=4","gravatar_id":"","url":"https://api.github.com/users/ildoonet","html_url":"https://github.com/ildoonet","followers_url":"https://api.github.com/users/ildoonet/followers","following_url":"https://api.github.com/users/ildoonet/following{/other_user}","gists_url":"https://api.github.com/users/ildoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/ildoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ildoonet/subscriptions","organizations_url":"https://api.github.com/users/ildoonet/orgs","repos_url":"https://api.github.com/users/ildoonet/repos","events_url":"https://api.github.com/users/ildoonet/events{/privacy}","received_events_url":"https://api.github.com/users/ildoonet/received_events","type":"User","site_admin":false},"created_at":"2020-04-04T05:12:49Z","updated_at":"2020-04-04T05:12:49Z","author_association":"OWNER","body":"@Bryce1010 I check the warning, but it seems to be unavoidable.\r\n\r\nUnlike most of the schedulers, which start with the given initial learning rate and adapt it step by step, this gradual warmup scheduler should modify the initial learning rate as zero before any backward update on weights. \r\n\r\nBut if you want to avoid this warning message, there is a walk-around. See the latest code. I call 'optimizer.step()' with zero gradients, right after I create schedulers. \r\n","reactions":{"url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/comments/608975742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ildoonet","id":1115758,"node_id":"MDQ6VXNlcjExMTU3NTg=","avatar_url":"https://avatars.githubusercontent.com/u/1115758?v=4","gravatar_id":"","url":"https://api.github.com/users/ildoonet","html_url":"https://github.com/ildoonet","followers_url":"https://api.github.com/users/ildoonet/followers","following_url":"https://api.github.com/users/ildoonet/following{/other_user}","gists_url":"https://api.github.com/users/ildoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/ildoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ildoonet/subscriptions","organizations_url":"https://api.github.com/users/ildoonet/orgs","repos_url":"https://api.github.com/users/ildoonet/repos","events_url":"https://api.github.com/users/ildoonet/events{/privacy}","received_events_url":"https://api.github.com/users/ildoonet/received_events","type":"User","site_admin":false}},{"id":3198850677,"node_id":"MDExOkNsb3NlZEV2ZW50MzE5ODg1MDY3Nw==","url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/events/3198850677","actor":{"login":"ildoonet","id":1115758,"node_id":"MDQ6VXNlcjExMTU3NTg=","avatar_url":"https://avatars.githubusercontent.com/u/1115758?v=4","gravatar_id":"","url":"https://api.github.com/users/ildoonet","html_url":"https://github.com/ildoonet","followers_url":"https://api.github.com/users/ildoonet/followers","following_url":"https://api.github.com/users/ildoonet/following{/other_user}","gists_url":"https://api.github.com/users/ildoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/ildoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ildoonet/subscriptions","organizations_url":"https://api.github.com/users/ildoonet/orgs","repos_url":"https://api.github.com/users/ildoonet/repos","events_url":"https://api.github.com/users/ildoonet/events{/privacy}","received_events_url":"https://api.github.com/users/ildoonet/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-04-04T05:12:50Z","state_reason":null,"performed_via_github_app":null},{"id":3198850683,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzE5ODg1MDY4Mw==","url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/events/3198850683","actor":{"login":"Bryce1010","id":30361513,"node_id":"MDQ6VXNlcjMwMzYxNTEz","avatar_url":"https://avatars.githubusercontent.com/u/30361513?v=4","gravatar_id":"","url":"https://api.github.com/users/Bryce1010","html_url":"https://github.com/Bryce1010","followers_url":"https://api.github.com/users/Bryce1010/followers","following_url":"https://api.github.com/users/Bryce1010/following{/other_user}","gists_url":"https://api.github.com/users/Bryce1010/gists{/gist_id}","starred_url":"https://api.github.com/users/Bryce1010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bryce1010/subscriptions","organizations_url":"https://api.github.com/users/Bryce1010/orgs","repos_url":"https://api.github.com/users/Bryce1010/repos","events_url":"https://api.github.com/users/Bryce1010/events{/privacy}","received_events_url":"https://api.github.com/users/Bryce1010/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-04-04T05:12:50Z","performed_via_github_app":null},{"id":3198850687,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDMxOTg4NTA2ODc=","url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/events/3198850687","actor":{"login":"Bryce1010","id":30361513,"node_id":"MDQ6VXNlcjMwMzYxNTEz","avatar_url":"https://avatars.githubusercontent.com/u/30361513?v=4","gravatar_id":"","url":"https://api.github.com/users/Bryce1010","html_url":"https://github.com/Bryce1010","followers_url":"https://api.github.com/users/Bryce1010/followers","following_url":"https://api.github.com/users/Bryce1010/following{/other_user}","gists_url":"https://api.github.com/users/Bryce1010/gists{/gist_id}","starred_url":"https://api.github.com/users/Bryce1010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bryce1010/subscriptions","organizations_url":"https://api.github.com/users/Bryce1010/orgs","repos_url":"https://api.github.com/users/Bryce1010/repos","events_url":"https://api.github.com/users/Bryce1010/events{/privacy}","received_events_url":"https://api.github.com/users/Bryce1010/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-04-04T05:12:50Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/comments/1339394505","html_url":"https://github.com/ildoonet/pytorch-gradual-warmup-lr/issues/8#issuecomment-1339394505","issue_url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/8","id":1339394505,"node_id":"IC_kwDOCeStC85P1YnJ","user":{"login":"lucasbrynte","id":9484028,"node_id":"MDQ6VXNlcjk0ODQwMjg=","avatar_url":"https://avatars.githubusercontent.com/u/9484028?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasbrynte","html_url":"https://github.com/lucasbrynte","followers_url":"https://api.github.com/users/lucasbrynte/followers","following_url":"https://api.github.com/users/lucasbrynte/following{/other_user}","gists_url":"https://api.github.com/users/lucasbrynte/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasbrynte/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasbrynte/subscriptions","organizations_url":"https://api.github.com/users/lucasbrynte/orgs","repos_url":"https://api.github.com/users/lucasbrynte/repos","events_url":"https://api.github.com/users/lucasbrynte/events{/privacy}","received_events_url":"https://api.github.com/users/lucasbrynte/received_events","type":"User","site_admin":false},"created_at":"2022-12-06T13:31:15Z","updated_at":"2022-12-06T13:31:15Z","author_association":"NONE","body":"I think this work-around does the job (meaning nothing, except suppressing the warning), but I also think perhaps the design of the scheduler was based on a wrong assumption that the .step() method is only called directly by the user. On the contrary, PyTorch indeed makes an initial call to .step() from the scheduler's constructor, via the ._initial_step() function (at least in recent versions, perhaps ever since version 1.1). Before this implicit initial step, `self._last_epoch = -1`, and after the initial step, `self._last_epoch = 0`. Consequently, while I do not fully understand why .get_lr() alone could not compute the correct learning rates (without any preceding .step() calls), .step() will in any case have been called once in the scheduler constructor.\r\n\r\nPerhaps by simply replacing most occurences of `self._last_epoch` by `self._last_epoch+1` in the current implementation, one could preserve the functionality even if .step() is only called at the end of each epoch by the user..?\r\n\r\nI do however think the whole scheduler would be easier / less error-prone to implement using the built-in PyTorch LR scheduler [LinearLR](https://pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.LinearLR.html) for the warmup part, optionally chained with one or more other schedulers (the equivalent of \"after_scheduler\") using [SequentialLR](https://pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.SequentialLR.html).","reactions":{"url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/comments/1339394505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lucasbrynte","id":9484028,"node_id":"MDQ6VXNlcjk0ODQwMjg=","avatar_url":"https://avatars.githubusercontent.com/u/9484028?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasbrynte","html_url":"https://github.com/lucasbrynte","followers_url":"https://api.github.com/users/lucasbrynte/followers","following_url":"https://api.github.com/users/lucasbrynte/following{/other_user}","gists_url":"https://api.github.com/users/lucasbrynte/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasbrynte/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasbrynte/subscriptions","organizations_url":"https://api.github.com/users/lucasbrynte/orgs","repos_url":"https://api.github.com/users/lucasbrynte/repos","events_url":"https://api.github.com/users/lucasbrynte/events{/privacy}","received_events_url":"https://api.github.com/users/lucasbrynte/received_events","type":"User","site_admin":false}}]