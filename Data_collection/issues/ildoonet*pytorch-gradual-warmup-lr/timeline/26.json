[{"url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/comments/1339355568","html_url":"https://github.com/ildoonet/pytorch-gradual-warmup-lr/issues/26#issuecomment-1339355568","issue_url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/26","id":1339355568,"node_id":"IC_kwDOCeStC85P1PGw","user":{"login":"lucasbrynte","id":9484028,"node_id":"MDQ6VXNlcjk0ODQwMjg=","avatar_url":"https://avatars.githubusercontent.com/u/9484028?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasbrynte","html_url":"https://github.com/lucasbrynte","followers_url":"https://api.github.com/users/lucasbrynte/followers","following_url":"https://api.github.com/users/lucasbrynte/following{/other_user}","gists_url":"https://api.github.com/users/lucasbrynte/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasbrynte/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasbrynte/subscriptions","organizations_url":"https://api.github.com/users/lucasbrynte/orgs","repos_url":"https://api.github.com/users/lucasbrynte/repos","events_url":"https://api.github.com/users/lucasbrynte/events{/privacy}","received_events_url":"https://api.github.com/users/lucasbrynte/received_events","type":"User","site_admin":false},"created_at":"2022-12-06T13:14:20Z","updated_at":"2022-12-06T13:14:20Z","author_association":"NONE","body":"I can confirm this behavior. I think line 31 in `warmup_scheduler/scheduler.py` is troublesome, and that\r\n```\r\nreturn self.after_scheduler.get_last_lr()\r\n```\r\nshould rather be:\r\n```\r\nreturn self.after_scheduler.get_lr()\r\n```\r\nI do however think the whole scheduler would be easier / less error-prone to implement using the built-in PyTorch LR scheduler [LinearLR](https://pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.LinearLR.html) for the warmup part, optionally chained with one or more other schedulers (the equivalent of \"after_scheduler\") using [SequentialLR](https://pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.SequentialLR.html).","reactions":{"url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/comments/1339355568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lucasbrynte","id":9484028,"node_id":"MDQ6VXNlcjk0ODQwMjg=","avatar_url":"https://avatars.githubusercontent.com/u/9484028?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasbrynte","html_url":"https://github.com/lucasbrynte","followers_url":"https://api.github.com/users/lucasbrynte/followers","following_url":"https://api.github.com/users/lucasbrynte/following{/other_user}","gists_url":"https://api.github.com/users/lucasbrynte/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasbrynte/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasbrynte/subscriptions","organizations_url":"https://api.github.com/users/lucasbrynte/orgs","repos_url":"https://api.github.com/users/lucasbrynte/repos","events_url":"https://api.github.com/users/lucasbrynte/events{/privacy}","received_events_url":"https://api.github.com/users/lucasbrynte/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/comments/1339582418","html_url":"https://github.com/ildoonet/pytorch-gradual-warmup-lr/issues/26#issuecomment-1339582418","issue_url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/26","id":1339582418,"node_id":"IC_kwDOCeStC85P2GfS","user":{"login":"lucasbrynte","id":9484028,"node_id":"MDQ6VXNlcjk0ODQwMjg=","avatar_url":"https://avatars.githubusercontent.com/u/9484028?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasbrynte","html_url":"https://github.com/lucasbrynte","followers_url":"https://api.github.com/users/lucasbrynte/followers","following_url":"https://api.github.com/users/lucasbrynte/following{/other_user}","gists_url":"https://api.github.com/users/lucasbrynte/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasbrynte/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasbrynte/subscriptions","organizations_url":"https://api.github.com/users/lucasbrynte/orgs","repos_url":"https://api.github.com/users/lucasbrynte/repos","events_url":"https://api.github.com/users/lucasbrynte/events{/privacy}","received_events_url":"https://api.github.com/users/lucasbrynte/received_events","type":"User","site_admin":false},"created_at":"2022-12-06T15:49:15Z","updated_at":"2022-12-06T15:49:15Z","author_association":"NONE","body":"Just to nuance my comment: For some reason it actually seems users are not supposed to call the `.get_lr()` function. It generates a warning message if called from elsewhere than `.step()`, in which case this is indicated by a `with _enable_get_lr_call(self):` statement.","reactions":{"url":"https://api.github.com/repos/ildoonet/pytorch-gradual-warmup-lr/issues/comments/1339582418/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lucasbrynte","id":9484028,"node_id":"MDQ6VXNlcjk0ODQwMjg=","avatar_url":"https://avatars.githubusercontent.com/u/9484028?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasbrynte","html_url":"https://github.com/lucasbrynte","followers_url":"https://api.github.com/users/lucasbrynte/followers","following_url":"https://api.github.com/users/lucasbrynte/following{/other_user}","gists_url":"https://api.github.com/users/lucasbrynte/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasbrynte/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasbrynte/subscriptions","organizations_url":"https://api.github.com/users/lucasbrynte/orgs","repos_url":"https://api.github.com/users/lucasbrynte/repos","events_url":"https://api.github.com/users/lucasbrynte/events{/privacy}","received_events_url":"https://api.github.com/users/lucasbrynte/received_events","type":"User","site_admin":false}}]