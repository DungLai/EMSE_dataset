{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/284","repository_url":"https://api.github.com/repos/kylebarron/stata_kernel","labels_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/284/labels{/name}","comments_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/284/comments","events_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/284/events","html_url":"https://github.com/kylebarron/stata_kernel/issues/284","id":400236537,"node_id":"MDU6SXNzdWU0MDAyMzY1Mzc=","number":284,"title":"Graph does not display with long graph commands","user":{"login":"simon-d-s","id":6119342,"node_id":"MDQ6VXNlcjYxMTkzNDI=","avatar_url":"https://avatars.githubusercontent.com/u/6119342?v=4","gravatar_id":"","url":"https://api.github.com/users/simon-d-s","html_url":"https://github.com/simon-d-s","followers_url":"https://api.github.com/users/simon-d-s/followers","following_url":"https://api.github.com/users/simon-d-s/following{/other_user}","gists_url":"https://api.github.com/users/simon-d-s/gists{/gist_id}","starred_url":"https://api.github.com/users/simon-d-s/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simon-d-s/subscriptions","organizations_url":"https://api.github.com/users/simon-d-s/orgs","repos_url":"https://api.github.com/users/simon-d-s/repos","events_url":"https://api.github.com/users/simon-d-s/events{/privacy}","received_events_url":"https://api.github.com/users/simon-d-s/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":26,"created_at":"2019-01-17T11:38:06Z","updated_at":"2019-01-29T17:23:45Z","closed_at":"2019-01-29T17:21:13Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"#### Problem description\r\n\r\n- If a long code is needed for producing a single graph, the graph will not display. Rather, Atom/Hydrogen stops the execution, throws an error (see below) and does not import the produced graph. The graph will only be displayed after the same or a different piece of code is run (again).\r\n\r\n\r\n\r\n#### Debugging log\r\n[console_debug.log](https://github.com/kylebarron/stata_kernel/files/2768418/console_debug.log)\r\n\r\n#### Code Sample\r\n```stata\r\nsysuse auto\r\n\r\n// this example runs without problem:\r\ngraph two (scatter price mpg) ///\r\n          (lfit    price mpg) ///\r\n          (qfit    price mpg) ///\r\n          (lowess  price mpg) ///\r\n          (lpoly   price mpg), ///\r\n            xsize(3) ///\r\n            ysize(3) ///\r\n            ytitle(price) ///\r\n            xtitle(`: var label mpg') ///\r\n            by(foreign, ///\r\n                title(\"Minimal Example\") ///\r\n                scale(0.8) ///\r\n                iscale(*1.2) ///\r\n            ) ///\r\n            legend( ///\r\n                order( ///\r\n                    1 \"test1\" ///\r\n                ) ///\r\n            )\r\n// this example (one line longer) does not run correctly:\r\ngraph two (scatter price mpg) ///\r\n          (lfit    price mpg) ///\r\n          (qfit    price mpg) ///\r\n          (lowess  price mpg) ///\r\n          (lpoly   price mpg), ///\r\n            xsize(3) ///\r\n            ysize(3) ///\r\n            ytitle(price) ///\r\n            xtitle(`: var label mpg') ///\r\n            by(foreign, ///\r\n                title(\"Minimal Example\") ///\r\n                scale(0.8) ///\r\n                iscale(*1.2) ///\r\n            ) ///\r\n            legend( ///\r\n                order( ///\r\n                    1 \"test1\" ///\r\n                    2 \"test2\" ///\r\n                ) ///\r\n            )\r\n```\r\n\r\n#### Expected Output\r\nThe Graph should be displayed in both cases.\r\n\r\n#### Other information\r\nThe following error message is issued by Atom:\r\n```\r\nStata\r\n[IPKernelApp] ERROR | Exception in message handler: Traceback (most recent call last): File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\pexpect\\expect.py\", line 111, in expect_loop incoming = spawn.read_nonblocking(spawn.maxread, timeout) File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\pexpect\\fdpexpect.py\", line 148, in read_nonblocking return super(fdspawn, self).read_nonblocking(size) File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\pexpect\\spawnbase.py\", line 176, in read_nonblocking raise EOF('End Of File (EOF). Empty string style platform.') pexpect.exceptions.EOF: End Of File (EOF). Empty string style platform.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last): File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 267, in dispatch_shell yield gen.maybe_future(handler(stream, idents, msg)) File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\tornado\\gen.py\", line 1133, in run value = future.result() File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\tornado\\gen.py\", line 326, in wrapper yielded = next(result) File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\ipykernel\\kernelbase.py\", line 534, in execute_request user_expressions, allow_stdin, File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\stata_kernel\\kernel.py\", line 124, in do_execute text_to_run, md5, text_to_exclude=text_to_exclude) File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\stata_kernel\\stata_session.py\", line 263, in do rc, res = self.expect(text=text, child=child, md5=md5, **kwargs) File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\stata_kernel\\stata_session.py\", line 357, in expect code_lines, res = self.clean_log_eol(child, code_lines, res) File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\stata_kernel\\stata_session.py\", line 451, in clean_log_eol child.expect(r'\\r?\\n', timeout=5) File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\pexpect\\spawnbase.py\", line 341, in expect timeout, searchwindowsize, async_) File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\pexpect\\spawnbase.py\", line 369, in expect_list return exp.expect_loop(timeout) File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\pexpect\\expect.py\", line 117, in expect_loop return self.eof(e) File \"C:\\Users\\sseiler\\AppData\\Local\\Continuum\\miniconda3\\lib\\site-packages\\pexpect\\expect.py\", line 63, in eof raise EOF(msg) pexpect.exceptions.EOF: End Of File (EOF). Empty string style platform.\r\n\r\n<pexpect.fdpexpect.fdspawn object at 0x0000024B21856B00> searcher: searcher_re: 0: re.compile('\\r?\\n')\r\n```\r\n","closed_by":{"login":"kylebarron","id":15164633,"node_id":"MDQ6VXNlcjE1MTY0NjMz","avatar_url":"https://avatars.githubusercontent.com/u/15164633?v=4","gravatar_id":"","url":"https://api.github.com/users/kylebarron","html_url":"https://github.com/kylebarron","followers_url":"https://api.github.com/users/kylebarron/followers","following_url":"https://api.github.com/users/kylebarron/following{/other_user}","gists_url":"https://api.github.com/users/kylebarron/gists{/gist_id}","starred_url":"https://api.github.com/users/kylebarron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kylebarron/subscriptions","organizations_url":"https://api.github.com/users/kylebarron/orgs","repos_url":"https://api.github.com/users/kylebarron/repos","events_url":"https://api.github.com/users/kylebarron/events{/privacy}","received_events_url":"https://api.github.com/users/kylebarron/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/284/timeline","performed_via_github_app":null,"state_reason":"completed"}