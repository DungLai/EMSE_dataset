{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/339","repository_url":"https://api.github.com/repos/kylebarron/stata_kernel","labels_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/339/labels{/name}","comments_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/339/comments","events_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/339/events","html_url":"https://github.com/kylebarron/stata_kernel/issues/339","id":587139997,"node_id":"MDU6SXNzdWU1ODcxMzk5OTc=","number":339,"title":"Kernel fails to start","user":{"login":"FHeidemann","id":13793793,"node_id":"MDQ6VXNlcjEzNzkzNzkz","avatar_url":"https://avatars.githubusercontent.com/u/13793793?v=4","gravatar_id":"","url":"https://api.github.com/users/FHeidemann","html_url":"https://github.com/FHeidemann","followers_url":"https://api.github.com/users/FHeidemann/followers","following_url":"https://api.github.com/users/FHeidemann/following{/other_user}","gists_url":"https://api.github.com/users/FHeidemann/gists{/gist_id}","starred_url":"https://api.github.com/users/FHeidemann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FHeidemann/subscriptions","organizations_url":"https://api.github.com/users/FHeidemann/orgs","repos_url":"https://api.github.com/users/FHeidemann/repos","events_url":"https://api.github.com/users/FHeidemann/events{/privacy}","received_events_url":"https://api.github.com/users/FHeidemann/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2020-03-24T17:23:33Z","updated_at":"2020-03-25T18:17:38Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I am trying to use the stata kernel under linux after using it under windows for some time and loved it!\r\nUnfortunately, the kernal fails to start. When opening a notebook or console, jupyter tries to start the kernel but fails to do so with the stack trace below. Afterwards, jupyter tries to restart the kernel but fails and is stuck in the loop forever (it's always restart attempt 1/5).\r\nI did the following checks to eliminate error sources:\r\n- other notebooks (such as python itself) work\r\n- the cache dir is accessible. In fact, during every try, the .stata_kernel_cache/console_debug.log file is written with the start STATA opening lines (see below)\r\n- the stata path is set correctly in the .stata_kernel.conf file\r\n- I can run stata in batch mode correctly, e.g. \"/path/to/stata -b test.do\"\r\n\r\nI am running the following system:\r\n- Operating System: Ubuntu 18.04.4 LTS under WSL (fully inside WSL/Linux, nothing to do with Windows)\r\n- Stata version 13.1\r\n- Package version 1.11.2\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.6/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/usr/lib/python3.6/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/fheidemann/.local/lib/python3.6/site-packages/stata_kernel/__main__.py\", line 4, in <module>\r\n    IPKernelApp.launch_instance(kernel_class=StataKernel)\r\n  File \"/home/fheidemann/.local/lib/python3.6/site-packages/traitlets/config/application.py\", line 663, in launch_instance\r\n    app.initialize(argv)\r\n  File \"<decorator-gen-124>\", line 2, in initialize\r\n  File \"/home/fheidemann/.local/lib/python3.6/site-packages/traitlets/config/application.py\", line 87, in catch_config_error\r\n    return method(app, *args, **kwargs)\r\n  File \"/home/fheidemann/.local/lib/python3.6/site-packages/ipykernel/kernelapp.py\", line 562, in initialize\r\n    self.init_kernel()\r\n  File \"/home/fheidemann/.local/lib/python3.6/site-packages/ipykernel/kernelapp.py\", line 447, in init_kernel\r\n    user_ns=self.user_ns,\r\n  File \"/home/fheidemann/.local/lib/python3.6/site-packages/traitlets/config/configurable.py\", line 412, in instance\r\n    inst = cls(*args, **kwargs)\r\n  File \"/home/fheidemann/.local/lib/python3.6/site-packages/stata_kernel/kernel.py\", line 71, in __init__\r\n    self.stata = StataSession(self)\r\n  File \"/home/fheidemann/.local/lib/python3.6/site-packages/stata_kernel/stata_session.py\", line 94, in __init__\r\n    self.init_console()\r\n  File \"/home/fheidemann/.local/lib/python3.6/site-packages/stata_kernel/stata_session.py\", line 199, in init_console\r\n    self.child.expect(self.prompt)\r\n  File \"/home/fheidemann/.local/lib/python3.6/site-packages/pexpect/spawnbase.py\", line 344, in expect\r\n    timeout, searchwindowsize, async_)\r\n  File \"/home/fheidemann/.local/lib/python3.6/site-packages/pexpect/spawnbase.py\", line 372, in expect_list\r\n    return exp.expect_loop(timeout)\r\n  File \"/home/fheidemann/.local/lib/python3.6/site-packages/pexpect/expect.py\", line 181, in expect_loop\r\n    return self.timeout(e)\r\n  File \"/home/fheidemann/.local/lib/python3.6/site-packages/pexpect/expect.py\", line 144, in timeout\r\n    raise exc\r\npexpect.exceptions.TIMEOUT: Timeout exceeded.\r\n<pexpect.pty_spawn.spawn object at 0x7fe5c81a84a8>\r\ncommand: /usr/local/stata13/stata\r\nargs: [b'/usr/local/stata13/stata']\r\nbuffer (last 100 chars): '--\\x08\\x08\\x08\\x08\\x08\\x08\\x08\\x08        \\x08\\x08\\x08\\x08\\x08\\x08\\x08\\x08. '\r\nbefore (last 100 chars): '--\\x08\\x08\\x08\\x08\\x08\\x08\\x08\\x08        \\x08\\x08\\x08\\x08\\x08\\x08\\x08\\x08. '\r\nafter: <class 'pexpect.exceptions.TIMEOUT'>\r\nmatch: None\r\nmatch_index: None\r\nexitstatus: None\r\nflag_eof: False\r\npid: 870\r\nchild_fd: 49\r\nclosed: False\r\ntimeout: 30\r\ndelimiter: <class 'pexpect.exceptions.EOF'>\r\nlogfile: <_io.TextIOWrapper name='/home/fheidemann/.stata_kernel_cache/console_debug.log' mode='w' encoding='utf-8'>\r\nlogfile_read: None\r\nlogfile_send: None\r\nmaxread: 2000\r\nignorecase: False\r\nsearchwindowsize: None\r\ndelaybeforesend: None\r\ndelayafterclose: 0.1\r\ndelayafterterminate: 0.1\r\nsearcher: searcher_re:\r\n    0: re.compile('\\\\r\\\\n\\\\. ')\r\n```\r\n\r\n```stata\r\n\r\n  ___  ____  ____  ____  ____ (R)\r\n /__    /   ____/   /   ____/\r\n___/   /   /___/   /   /___/   13.1   Copyright 1985-2013 StataCorp LP\r\n  Statistics/Data Analysis            StataCorp\r\n                                      4905 Lakeway Drive\r\n                                      College Station, Texas 77845 USA\r\n                                      800-STATA-PC        http://www.stata.com\r\n                                      979-696-4600        stata@stata.com\r\n                                      979-696-4601 (fax)\r\n\r\nSingle-user Stata perpetual license:\r\n       Serial number:  XXXXX\r\n         Licensed to:  XXXXX\r\n                       XXXXX\r\n\r\nNotes:\r\n      1.  Command line editing enabled\r\n\r\nNote:  Your site can add messages to the introduction by editing the file\r\n       stata.msg in the directory where Stata is installed.\r\n```","closed_by":{"login":"FHeidemann","id":13793793,"node_id":"MDQ6VXNlcjEzNzkzNzkz","avatar_url":"https://avatars.githubusercontent.com/u/13793793?v=4","gravatar_id":"","url":"https://api.github.com/users/FHeidemann","html_url":"https://github.com/FHeidemann","followers_url":"https://api.github.com/users/FHeidemann/followers","following_url":"https://api.github.com/users/FHeidemann/following{/other_user}","gists_url":"https://api.github.com/users/FHeidemann/gists{/gist_id}","starred_url":"https://api.github.com/users/FHeidemann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FHeidemann/subscriptions","organizations_url":"https://api.github.com/users/FHeidemann/orgs","repos_url":"https://api.github.com/users/FHeidemann/repos","events_url":"https://api.github.com/users/FHeidemann/events{/privacy}","received_events_url":"https://api.github.com/users/FHeidemann/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/339/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/339/timeline","performed_via_github_app":null,"state_reason":null}