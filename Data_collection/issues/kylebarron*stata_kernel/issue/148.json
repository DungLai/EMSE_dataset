{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/148","repository_url":"https://api.github.com/repos/kylebarron/stata_kernel","labels_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/148/labels{/name}","comments_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/148/comments","events_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/148/events","html_url":"https://github.com/kylebarron/stata_kernel/issues/148","id":358094358,"node_id":"MDU6SXNzdWUzNTgwOTQzNTg=","number":148,"title":"Kernel updates but then crashes","user":{"login":"hugobaltasar","id":41026281,"node_id":"MDQ6VXNlcjQxMDI2Mjgx","avatar_url":"https://avatars.githubusercontent.com/u/41026281?v=4","gravatar_id":"","url":"https://api.github.com/users/hugobaltasar","html_url":"https://github.com/hugobaltasar","followers_url":"https://api.github.com/users/hugobaltasar/followers","following_url":"https://api.github.com/users/hugobaltasar/following{/other_user}","gists_url":"https://api.github.com/users/hugobaltasar/gists{/gist_id}","starred_url":"https://api.github.com/users/hugobaltasar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hugobaltasar/subscriptions","organizations_url":"https://api.github.com/users/hugobaltasar/orgs","repos_url":"https://api.github.com/users/hugobaltasar/repos","events_url":"https://api.github.com/users/hugobaltasar/events{/privacy}","received_events_url":"https://api.github.com/users/hugobaltasar/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2018-09-07T14:40:33Z","updated_at":"2018-09-07T16:38:15Z","closed_at":"2018-09-07T16:31:02Z","author_association":"NONE","active_lock_reason":null,"body":"#### Problem description\r\n\r\nI am not sure if this is the correct place to post this, excuses in advance if it's not. I have installed the kernel following your instructions at [stata_kernel](https://kylebarron.github.io/stata_kernel/), but setting up a virtual env, like this:\r\n\r\n```\r\npython3 -m venv env\r\nsource ./env/bin/activate\r\npip install stata_kernel\r\n```\r\n\r\nHowever, when I try to run it I get the following (long) error message, either in Atom or Jupyter console:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/pexpect/spawnbase.py\", line 166, in read_nonblocking\r\n    s = os.read(self.child_fd, size)\r\nOSError: [Errno 5] Input/output error\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/pexpect/expect.py\", line 111, in expect_loop\r\n    incoming = spawn.read_nonblocking(spawn.maxread, timeout)\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/pexpect/pty_spawn.py\", line 485, in read_nonblocking\r\n    return super(spawn, self).read_nonblocking(size)\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/pexpect/spawnbase.py\", line 171, in read_nonblocking\r\n    raise EOF('End Of File (EOF). Exception style platform.')\r\npexpect.exceptions.EOF: End Of File (EOF). Exception style platform.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/anaconda3/lib/python3.6/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/usr/local/anaconda3/lib/python3.6/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/stata_kernel/__main__.py\", line 4, in <module>\r\n    IPKernelApp.launch_instance(kernel_class=StataKernel)\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/traitlets/config/application.py\", line 657, in launch_instance\r\n    app.initialize(argv)\r\n  File \"<decorator-gen-123>\", line 2, in initialize\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/traitlets/config/application.py\", line 87, in catch_config_error\r\n    return method(app, *args, **kwargs)\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/ipykernel/kernelapp.py\", line 476, in initialize\r\n    self.init_kernel()\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/ipykernel/kernelapp.py\", line 387, in init_kernel\r\n    user_ns=self.user_ns,\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/traitlets/config/configurable.py\", line 412, in instance\r\n    inst = cls(*args, **kwargs)\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/stata_kernel/kernel.py\", line 36, in __init__\r\n    self.stata = StataSession(self, self.conf)\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/stata_kernel/stata_session.py\", line 55, in __init__\r\n    self.init_console()\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/stata_kernel/stata_session.py\", line 118, in init_console\r\n    self.child.expect('\\r\\n\\. ', timeout=0.2)\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/pexpect/spawnbase.py\", line 341, in expect\r\n    timeout, searchwindowsize, async_)\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/pexpect/spawnbase.py\", line 369, in expect_list\r\n    return exp.expect_loop(timeout)\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/pexpect/expect.py\", line 117, in expect_loop\r\n    return self.eof(e)\r\n  File \"/home/hugomv/env/lib/python3.6/site-packages/pexpect/expect.py\", line 63, in eof\r\n    raise EOF(msg)\r\npexpect.exceptions.EOF: End Of File (EOF). Exception style platform.\r\n<pexpect.pty_spawn.spawn object at 0x7f661ca958d0>\r\ncommand: /usr/local/stata14/xstata-mp\r\nargs: [b'/usr/local/stata14/xstata-mp']\r\nbuffer (last 100 chars): ''\r\n\r\nafter: <class 'pexpect.exceptions.EOF'>\r\nmatch: None\r\nmatch_index: None\r\nexitstatus: None\r\nflag_eof: True\r\npid: 9198\r\nchild_fd: 50\r\nclosed: False\r\ntimeout: 30\r\ndelimiter: <class 'pexpect.exceptions.EOF'>\r\nlogfile: <_io.TextIOWrapper name='/home/hugomv/.stata_kernel_cache/console_debug.log' mode='w' encoding='UTF-8'>\r\nlogfile_read: None\r\nlogfile_send: None\r\nmaxread: 2000\r\nignorecase: False\r\nsearchwindowsize: None\r\ndelaybeforesend: None\r\ndelayafterclose: 0.1\r\ndelayafterterminate: 0.1\r\nsearcher: searcher_re:\r\n    0: re.compile('\\r\\n\\\\. ')\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/anaconda3/bin/jupyter-console\", line 11, in <module>\r\n    sys.exit(main())\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_core/application.py\", line 266, in launch_instance\r\n    return super(JupyterApp, cls).launch_instance(argv=argv, **kwargs)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/traitlets/config/application.py\", line 657, in launch_instance\r\n    app.initialize(argv)\r\n  File \"<decorator-gen-116>\", line 2, in initialize\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/traitlets/config/application.py\", line 87, in catch_config_error\r\n    return method(app, *args, **kwargs)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_console/app.py\", line 141, in initialize\r\n    self.init_shell()\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_console/app.py\", line 114, in init_shell\r\n    client=self.kernel_client,\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/traitlets/config/configurable.py\", line 412, in instance\r\n    inst = cls(*args, **kwargs)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_console/ptshell.py\", line 272, in __init__\r\n    self.init_kernel_info()\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_console/ptshell.py\", line 323, in init_kernel_info\r\n    reply = self.client.get_shell_msg(timeout=1)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_client/client.py\", line 77, in get_shell_msg\r\n    return self.shell_channel.get_msg(*args, **kwargs)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_client/blocking/channels.py\", line 50, in get_msg\r\n    ready = self.socket.poll(timeout)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/zmq/sugar/socket.py\", line 695, in poll\r\n    evts = dict(p.poll(timeout))\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/zmq/sugar/poll.py\", line 99, in poll\r\n    return zmq_poll(self.sockets, timeout=timeout)\r\n  File \"zmq/backend/cython/_poll.pyx\", line 143, in zmq.backend.cython._poll.zmq_poll\r\n  File \"zmq/backend/cython/_poll.pyx\", line 123, in zmq.backend.cython._poll.zmq_poll\r\n  File \"zmq/backend/cython/checkrc.pxd\", line 12, in zmq.backend.cython.checkrc._check_rc\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_console/app.py\", line 123, in handle_sigint\r\n    if self.shell._executing:\r\nAttributeError: 'ZMQTerminalIPythonApp' object has no attribute 'shell'\r\n```\r\n\r\nOr course, the kernel does not work. I had no problems with Hydrogen, and R, Python and Julia kernels work properly. In fact, if I run `jupyter kernelspec list` I get the following:\r\n\r\n```\r\nAvailable kernels:\r\n  ir           /home/hugomv/.local/share/jupyter/kernels/ir\r\n  julia-0.6    /home/hugomv/.local/share/jupyter/kernels/julia-0.6\r\n  stata        /home/hugomv/.local/share/jupyter/kernels/stata\r\n  python3      /usr/local/anaconda3/share/jupyter/kernels/python3\r\n```\r\n\r\nAlso, if I run `sudo jupyter console --kernel stata`, the error message is considerably shorter, but it doesn't work anyway:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/local/anaconda3/bin/jupyter-console\", line 11, in <module>\r\n    sys.exit(main())\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_core/application.py\", line 266, in launch_instance\r\n    return super(JupyterApp, cls).launch_instance(argv=argv, **kwargs)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/traitlets/config/application.py\", line 657, in launch_instance\r\n    app.initialize(argv)\r\n  File \"<decorator-gen-116>\", line 2, in initialize\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/traitlets/config/application.py\", line 87, in catch_config_error\r\n    return method(app, *args, **kwargs)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_console/app.py\", line 141, in initialize\r\n    self.init_shell()\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_console/app.py\", line 109, in init_shell\r\n    JupyterConsoleApp.initialize(self)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_client/consoleapp.py\", line 334, in initialize\r\n    self.init_kernel_manager()\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_client/consoleapp.py\", line 288, in init_kernel_manager\r\n    self.kernel_manager.start_kernel(**kwargs)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_client/manager.py\", line 246, in start_kernel\r\n    kernel_cmd = self.format_kernel_cmd(extra_arguments=extra_arguments)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_client/manager.py\", line 170, in format_kernel_cmd\r\n    cmd = self.kernel_spec.argv + extra_arguments\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_client/manager.py\", line 82, in kernel_spec\r\n    self._kernel_spec = self.kernel_spec_manager.get_kernel_spec(self.kernel_name)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/jupyter_client/kernelspec.py\", line 236, in get_kernel_spec\r\n    raise NoSuchKernel(kernel_name)\r\njupyter_client.kernelspec.NoSuchKernel: No such kernel named stata\r\n```\r\n\r\n#### Debugging log\r\n\r\nThe debugging log is empty.\r\n\r\n#### Other information\r\n\r\n- Operating System: Manjaro Linux GNOME 17.1.12\r\n- Stata version: 14.2 64-bit x86-64\r\n- Package version: 1.4.5\r\n","closed_by":{"login":"hugobaltasar","id":41026281,"node_id":"MDQ6VXNlcjQxMDI2Mjgx","avatar_url":"https://avatars.githubusercontent.com/u/41026281?v=4","gravatar_id":"","url":"https://api.github.com/users/hugobaltasar","html_url":"https://github.com/hugobaltasar","followers_url":"https://api.github.com/users/hugobaltasar/followers","following_url":"https://api.github.com/users/hugobaltasar/following{/other_user}","gists_url":"https://api.github.com/users/hugobaltasar/gists{/gist_id}","starred_url":"https://api.github.com/users/hugobaltasar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hugobaltasar/subscriptions","organizations_url":"https://api.github.com/users/hugobaltasar/orgs","repos_url":"https://api.github.com/users/hugobaltasar/repos","events_url":"https://api.github.com/users/hugobaltasar/events{/privacy}","received_events_url":"https://api.github.com/users/hugobaltasar/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/148/timeline","performed_via_github_app":null,"state_reason":"completed"}