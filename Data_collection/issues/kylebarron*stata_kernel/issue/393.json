{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/393","repository_url":"https://api.github.com/repos/kylebarron/stata_kernel","labels_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/393/labels{/name}","comments_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/393/comments","events_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/393/events","html_url":"https://github.com/kylebarron/stata_kernel/issues/393","id":890342945,"node_id":"MDU6SXNzdWU4OTAzNDI5NDU=","number":393,"title":"Stream output problem when publishing with `jupyter-book`","user":{"login":"roblem","id":1871086,"node_id":"MDQ6VXNlcjE4NzEwODY=","avatar_url":"https://avatars.githubusercontent.com/u/1871086?v=4","gravatar_id":"","url":"https://api.github.com/users/roblem","html_url":"https://github.com/roblem","followers_url":"https://api.github.com/users/roblem/followers","following_url":"https://api.github.com/users/roblem/following{/other_user}","gists_url":"https://api.github.com/users/roblem/gists{/gist_id}","starred_url":"https://api.github.com/users/roblem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roblem/subscriptions","organizations_url":"https://api.github.com/users/roblem/orgs","repos_url":"https://api.github.com/users/roblem/repos","events_url":"https://api.github.com/users/roblem/events{/privacy}","received_events_url":"https://api.github.com/users/roblem/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2021-05-12T17:50:40Z","updated_at":"2021-05-14T09:08:37Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"There is [a jupyter-book issue](https://github.com/executablebooks/jupyter-book/issues/973) that is causing problems with jupyter-book publishing when using `stata_kernel`.  Basically, streaming output for a command is split by `jupyter-book` into multiple output cells per code block, which isn't pretty, as seen in the screenshot of the compiled document:\r\n![stata_kernel_issues](https://user-images.githubusercontent.com/1871086/118020514-71a50200-b35a-11eb-91da-1878042853c4.png)\r\n\r\nAccording to [this response](https://github.com/executablebooks/jupyter-book/issues/973#issuecomment-694364738), it is a matter of switching from stream output to coalescing into `text/plain` output.\r\n\r\nAs a side note, Stata 17 with the `%%stata` magic has similar issues but the undocumented `config.set_streaming_output_mode('off')` fixes it so it behaves like Python.  This does cause output to appear to hang as no intermediate output is printed as the command runs.  Rather it is collected until the command is finished.  This fixes the problem seen in the picture above.","closed_by":null,"reactions":{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/393/timeline","performed_via_github_app":null,"state_reason":null}