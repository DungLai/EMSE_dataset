[{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/comments/840099792","html_url":"https://github.com/kylebarron/stata_kernel/issues/393#issuecomment-840099792","issue_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/393","id":840099792,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDA5OTc5Mg==","user":{"login":"kylebarron","id":15164633,"node_id":"MDQ6VXNlcjE1MTY0NjMz","avatar_url":"https://avatars.githubusercontent.com/u/15164633?v=4","gravatar_id":"","url":"https://api.github.com/users/kylebarron","html_url":"https://github.com/kylebarron","followers_url":"https://api.github.com/users/kylebarron/followers","following_url":"https://api.github.com/users/kylebarron/following{/other_user}","gists_url":"https://api.github.com/users/kylebarron/gists{/gist_id}","starred_url":"https://api.github.com/users/kylebarron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kylebarron/subscriptions","organizations_url":"https://api.github.com/users/kylebarron/orgs","repos_url":"https://api.github.com/users/kylebarron/repos","events_url":"https://api.github.com/users/kylebarron/events{/privacy}","received_events_url":"https://api.github.com/users/kylebarron/received_events","type":"User","site_admin":false},"created_at":"2021-05-12T21:11:29Z","updated_at":"2021-05-12T21:11:38Z","author_association":"OWNER","body":"> fixes it so it behaves like Python\r\n\r\nPython must do something special when it hooks into Jupyter Book. As mentioned in the [specific comment](https://github.com/executablebooks/jupyter-book/issues/973#issuecomment-694364738) you linked to, 99% of the time you _don't_ want to coalesce into a single output block. \r\n\r\n> With stdout/stderr streams, Jupyter dumps the output periodically, e.g. if you had:\r\n> \r\n> ```python\r\n> print(1)\r\n> sleep(10)\r\n> print(2)\r\n> ```\r\n> \r\n> Then you want don't want to have to wait 10 seconds to see `1`, it will update with `1` then later will add `2`.\r\n\r\nThat's a feature, not a bug, of stata_kernel, because you don't want to wait for the entire Stata block to finish before you get output. I don't see any way to fix this without a significant overhaul to optionally not return a stream.","reactions":{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/comments/840099792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kylebarron","id":15164633,"node_id":"MDQ6VXNlcjE1MTY0NjMz","avatar_url":"https://avatars.githubusercontent.com/u/15164633?v=4","gravatar_id":"","url":"https://api.github.com/users/kylebarron","html_url":"https://github.com/kylebarron","followers_url":"https://api.github.com/users/kylebarron/followers","following_url":"https://api.github.com/users/kylebarron/following{/other_user}","gists_url":"https://api.github.com/users/kylebarron/gists{/gist_id}","starred_url":"https://api.github.com/users/kylebarron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kylebarron/subscriptions","organizations_url":"https://api.github.com/users/kylebarron/orgs","repos_url":"https://api.github.com/users/kylebarron/repos","events_url":"https://api.github.com/users/kylebarron/events{/privacy}","received_events_url":"https://api.github.com/users/kylebarron/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/comments/840313643","html_url":"https://github.com/kylebarron/stata_kernel/issues/393#issuecomment-840313643","issue_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/393","id":840313643,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDMxMzY0Mw==","user":{"login":"roblem","id":1871086,"node_id":"MDQ6VXNlcjE4NzEwODY=","avatar_url":"https://avatars.githubusercontent.com/u/1871086?v=4","gravatar_id":"","url":"https://api.github.com/users/roblem","html_url":"https://github.com/roblem","followers_url":"https://api.github.com/users/roblem/followers","following_url":"https://api.github.com/users/roblem/following{/other_user}","gists_url":"https://api.github.com/users/roblem/gists{/gist_id}","starred_url":"https://api.github.com/users/roblem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roblem/subscriptions","organizations_url":"https://api.github.com/users/roblem/orgs","repos_url":"https://api.github.com/users/roblem/repos","events_url":"https://api.github.com/users/roblem/events{/privacy}","received_events_url":"https://api.github.com/users/roblem/received_events","type":"User","site_admin":false},"created_at":"2021-05-13T05:32:59Z","updated_at":"2021-05-13T05:32:59Z","author_association":"NONE","body":"Totally agree.  The only time you want the non-stream output is with certain automated publishing pipelines like jupyter-book, although in my particular use case the models I am running are computationally trivial so any hangs are not noticeable.\r\n\r\nTaking a second look at emacs org mode and how it handles stata output with `stata_kernel`, it wraps things in an example block which I haven't seen in any other language, so it is coalescing the stream into a block of text. I verified this by inserting and  running (in emacs orgmode):\r\n```stata\r\n sysuse auto\r\n sum\r\n sleep 10000\r\n reg price mpg\r\n```\r\nand no results are returned until the completion of all code in the block and both sets of results are included in the block.  So this seems to be more of a client-side issue where clients can \"clean up\" the stream if need be, as emacs does by constructing an example block of results.","reactions":{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/comments/840313643/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roblem","id":1871086,"node_id":"MDQ6VXNlcjE4NzEwODY=","avatar_url":"https://avatars.githubusercontent.com/u/1871086?v=4","gravatar_id":"","url":"https://api.github.com/users/roblem","html_url":"https://github.com/roblem","followers_url":"https://api.github.com/users/roblem/followers","following_url":"https://api.github.com/users/roblem/following{/other_user}","gists_url":"https://api.github.com/users/roblem/gists{/gist_id}","starred_url":"https://api.github.com/users/roblem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roblem/subscriptions","organizations_url":"https://api.github.com/users/roblem/orgs","repos_url":"https://api.github.com/users/roblem/repos","events_url":"https://api.github.com/users/roblem/events{/privacy}","received_events_url":"https://api.github.com/users/roblem/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/comments/840754855","html_url":"https://github.com/kylebarron/stata_kernel/issues/393#issuecomment-840754855","issue_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/393","id":840754855,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDc1NDg1NQ==","user":{"login":"kylebarron","id":15164633,"node_id":"MDQ6VXNlcjE1MTY0NjMz","avatar_url":"https://avatars.githubusercontent.com/u/15164633?v=4","gravatar_id":"","url":"https://api.github.com/users/kylebarron","html_url":"https://github.com/kylebarron","followers_url":"https://api.github.com/users/kylebarron/followers","following_url":"https://api.github.com/users/kylebarron/following{/other_user}","gists_url":"https://api.github.com/users/kylebarron/gists{/gist_id}","starred_url":"https://api.github.com/users/kylebarron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kylebarron/subscriptions","organizations_url":"https://api.github.com/users/kylebarron/orgs","repos_url":"https://api.github.com/users/kylebarron/repos","events_url":"https://api.github.com/users/kylebarron/events{/privacy}","received_events_url":"https://api.github.com/users/kylebarron/received_events","type":"User","site_admin":false},"created_at":"2021-05-13T18:42:00Z","updated_at":"2021-05-13T18:42:03Z","author_association":"OWNER","body":"I can't remember if the jupyter protocol ends a stream response with a custom message. If so, seems easy to collect a stream into a single block (as long as you assume a continuous stream is intended to go into a single block). Otherwise seems impossible to know how long to wait on the stream.","reactions":{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/comments/840754855/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kylebarron","id":15164633,"node_id":"MDQ6VXNlcjE1MTY0NjMz","avatar_url":"https://avatars.githubusercontent.com/u/15164633?v=4","gravatar_id":"","url":"https://api.github.com/users/kylebarron","html_url":"https://github.com/kylebarron","followers_url":"https://api.github.com/users/kylebarron/followers","following_url":"https://api.github.com/users/kylebarron/following{/other_user}","gists_url":"https://api.github.com/users/kylebarron/gists{/gist_id}","starred_url":"https://api.github.com/users/kylebarron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kylebarron/subscriptions","organizations_url":"https://api.github.com/users/kylebarron/orgs","repos_url":"https://api.github.com/users/kylebarron/repos","events_url":"https://api.github.com/users/kylebarron/events{/privacy}","received_events_url":"https://api.github.com/users/kylebarron/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/comments/841118693","html_url":"https://github.com/kylebarron/stata_kernel/issues/393#issuecomment-841118693","issue_url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/393","id":841118693,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTExODY5Mw==","user":{"login":"roblem","id":1871086,"node_id":"MDQ6VXNlcjE4NzEwODY=","avatar_url":"https://avatars.githubusercontent.com/u/1871086?v=4","gravatar_id":"","url":"https://api.github.com/users/roblem","html_url":"https://github.com/roblem","followers_url":"https://api.github.com/users/roblem/followers","following_url":"https://api.github.com/users/roblem/following{/other_user}","gists_url":"https://api.github.com/users/roblem/gists{/gist_id}","starred_url":"https://api.github.com/users/roblem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roblem/subscriptions","organizations_url":"https://api.github.com/users/roblem/orgs","repos_url":"https://api.github.com/users/roblem/repos","events_url":"https://api.github.com/users/roblem/events{/privacy}","received_events_url":"https://api.github.com/users/roblem/received_events","type":"User","site_admin":false},"created_at":"2021-05-14T09:08:37Z","updated_at":"2021-05-14T09:08:37Z","author_association":"NONE","body":"I played around a bit more and noticed that in Emacs, the `emacs-jupyter` package (the middleware that allows emacs orgmode to communicate to the jupyter kernel) coalesces Python streams the same way so that all output for a code block is placed in a single output block (unless you use the `:async` option, then it dumps results out as they come in), so I'll poke around there and see if I can find some clues as to how it knows when execution is done.","reactions":{"url":"https://api.github.com/repos/kylebarron/stata_kernel/issues/comments/841118693/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roblem","id":1871086,"node_id":"MDQ6VXNlcjE4NzEwODY=","avatar_url":"https://avatars.githubusercontent.com/u/1871086?v=4","gravatar_id":"","url":"https://api.github.com/users/roblem","html_url":"https://github.com/roblem","followers_url":"https://api.github.com/users/roblem/followers","following_url":"https://api.github.com/users/roblem/following{/other_user}","gists_url":"https://api.github.com/users/roblem/gists{/gist_id}","starred_url":"https://api.github.com/users/roblem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roblem/subscriptions","organizations_url":"https://api.github.com/users/roblem/orgs","repos_url":"https://api.github.com/users/roblem/repos","events_url":"https://api.github.com/users/roblem/events{/privacy}","received_events_url":"https://api.github.com/users/roblem/received_events","type":"User","site_admin":false}}]