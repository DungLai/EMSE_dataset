{"url":"https://api.github.com/repos/wq2012/SpectralCluster/issues/22","repository_url":"https://api.github.com/repos/wq2012/SpectralCluster","labels_url":"https://api.github.com/repos/wq2012/SpectralCluster/issues/22/labels{/name}","comments_url":"https://api.github.com/repos/wq2012/SpectralCluster/issues/22/comments","events_url":"https://api.github.com/repos/wq2012/SpectralCluster/issues/22/events","html_url":"https://github.com/wq2012/SpectralCluster/issues/22","id":941289027,"node_id":"MDU6SXNzdWU5NDEyODkwMjc=","number":22,"title":"LinAlgError: Array must not contain infs or NaNs","user":{"login":"anon747","id":52316826,"node_id":"MDQ6VXNlcjUyMzE2ODI2","avatar_url":"https://avatars.githubusercontent.com/u/52316826?v=4","gravatar_id":"","url":"https://api.github.com/users/anon747","html_url":"https://github.com/anon747","followers_url":"https://api.github.com/users/anon747/followers","following_url":"https://api.github.com/users/anon747/following{/other_user}","gists_url":"https://api.github.com/users/anon747/gists{/gist_id}","starred_url":"https://api.github.com/users/anon747/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anon747/subscriptions","organizations_url":"https://api.github.com/users/anon747/orgs","repos_url":"https://api.github.com/users/anon747/repos","events_url":"https://api.github.com/users/anon747/events{/privacy}","received_events_url":"https://api.github.com/users/anon747/received_events","type":"User","site_admin":false},"labels":[{"id":1199083314,"node_id":"MDU6TGFiZWwxMTk5MDgzMzE0","url":"https://api.github.com/repos/wq2012/SpectralCluster/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-07-10T17:11:25Z","updated_at":"2021-07-14T20:47:25Z","closed_at":"2021-07-14T20:47:25Z","author_association":"NONE","active_lock_reason":null,"body":"Hello!\r\n\r\nI trying to use the spectral-clusterer algorithm that this repository implements.\r\n\r\nI have performed the following steps:-\r\n1. Load audio file\r\n2. Obtain windows corresponding to 25ms and the time difference between the starts of successive windows being 10ms.\r\n3. I then obtained the log-mel-filterbank-energies of dimension 40.\r\n4. At this stage, I have a (n_samples, 40) dimensional numpy array.\r\n5. I then run this through a 3-layer LSTM (as described in the paper) and finally have an array of dimensions (n_samples, 256).\r\n6. I then L2-normalized each sample.\r\n\r\nHowever, once I try to run the spectral clustered on the final L2-normalized numpy array (dimensions: (n_samples, 256)), I get the following error:-\r\n\r\nLinAlgError                               Traceback (most recent call last)\r\n<ipython-input-32-05e5c8562a2e> in <module>()\r\n     10     gaussian_blur_sigma=1)\r\n     11 \r\n---> 12 labels = clusterer.predict(X_l2)\r\n3 frames\r\n/usr/local/lib/python3.7/dist-packages/spectralcluster/spectral_clusterer.py in predict(self, X)\r\n    117         # Perform eigen decomposion.\r\n    118         (eigenvalues, eigenvectors) = utils.compute_sorted_eigenvectors(\r\n--> 119             affinity)\r\n    120         # Get number of clusters.\r\n    121         k = utils.compute_number_of_clusters(\r\n\r\n/usr/local/lib/python3.7/dist-packages/spectralcluster/utils.py in compute_sorted_eigenvectors(A)\r\n     40     \"\"\"\r\n     41     # Eigen decomposition.\r\n---> 42     eigenvalues, eigenvectors = np.linalg.eig(A)\r\n     43     eigenvalues = eigenvalues.real\r\n     44     eigenvectors = eigenvectors.real\r\n<__array_function__ internals> in eig(*args, **kwargs)\r\n/usr/local/lib/python3.7/dist-packages/numpy/linalg/linalg.py in eig(a)\r\n   1316     \"\"\"\r\n   1317     Return the eigenvalues and eigenvectors of a complex Hermitian\r\n-> 1318     (conjugate symmetric) or a real symmetric matrix.\r\n   1319 \r\n   1320     Returns two objects, a 1-D array containing the eigenvalues of `a`, and\r\n/usr/local/lib/python3.7/dist-packages/numpy/linalg/linalg.py in _assert_finite(*arrays)\r\n    207                     'at least two-dimensional' % a.ndim)\r\n    208 \r\n--> 209 def _assert_stacked_square(*arrays):\r\n    210     for a in arrays:\r\n    211         m, n = a.shape[-2:]\r\nLinAlgError: Array must not contain infs or NaNs\r\n\r\n**Please note that my input array 'X_l2' of dimensions (n_samples,256) DOES NOT contain any nan or inf values.** My input however does contain samples where all values are 0. For example, a sample might have all 256 entries as 0. Is it the cause of my problem?\r\n\r\nAny help would be greatly appreciated. \r\n\r\nThank you! :)","closed_by":{"login":"wq2012","id":3002724,"node_id":"MDQ6VXNlcjMwMDI3MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/3002724?v=4","gravatar_id":"","url":"https://api.github.com/users/wq2012","html_url":"https://github.com/wq2012","followers_url":"https://api.github.com/users/wq2012/followers","following_url":"https://api.github.com/users/wq2012/following{/other_user}","gists_url":"https://api.github.com/users/wq2012/gists{/gist_id}","starred_url":"https://api.github.com/users/wq2012/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wq2012/subscriptions","organizations_url":"https://api.github.com/users/wq2012/orgs","repos_url":"https://api.github.com/users/wq2012/repos","events_url":"https://api.github.com/users/wq2012/events{/privacy}","received_events_url":"https://api.github.com/users/wq2012/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/wq2012/SpectralCluster/issues/22/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/wq2012/SpectralCluster/issues/22/timeline","performed_via_github_app":null,"state_reason":"completed"}