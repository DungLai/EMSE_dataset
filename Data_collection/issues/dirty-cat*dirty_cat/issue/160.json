{"url":"https://api.github.com/repos/dirty-cat/dirty_cat/issues/160","repository_url":"https://api.github.com/repos/dirty-cat/dirty_cat","labels_url":"https://api.github.com/repos/dirty-cat/dirty_cat/issues/160/labels{/name}","comments_url":"https://api.github.com/repos/dirty-cat/dirty_cat/issues/160/comments","events_url":"https://api.github.com/repos/dirty-cat/dirty_cat/issues/160/events","html_url":"https://github.com/dirty-cat/dirty_cat/issues/160","id":811240820,"node_id":"MDU6SXNzdWU4MTEyNDA4MjA=","number":160,"title":"GapEncoder - RuntimeWarning: overflow encountered in reciprocal , overflow encountered in true_divide","user":{"login":"krumeto","id":11272436,"node_id":"MDQ6VXNlcjExMjcyNDM2","avatar_url":"https://avatars.githubusercontent.com/u/11272436?v=4","gravatar_id":"","url":"https://api.github.com/users/krumeto","html_url":"https://github.com/krumeto","followers_url":"https://api.github.com/users/krumeto/followers","following_url":"https://api.github.com/users/krumeto/following{/other_user}","gists_url":"https://api.github.com/users/krumeto/gists{/gist_id}","starred_url":"https://api.github.com/users/krumeto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krumeto/subscriptions","organizations_url":"https://api.github.com/users/krumeto/orgs","repos_url":"https://api.github.com/users/krumeto/repos","events_url":"https://api.github.com/users/krumeto/events{/privacy}","received_events_url":"https://api.github.com/users/krumeto/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2021-02-18T16:08:17Z","updated_at":"2021-02-27T13:49:41Z","closed_at":"2021-02-27T13:49:41Z","author_association":"NONE","active_lock_reason":null,"body":"Dear Team,\r\n\r\nI am working on a roughly 4 mil rows dataset with 9 categorical features, having from 35 to 5300 unique values. I am trying to use GapEncoder, due to the combination of size and cardinality. \r\n\r\nWhen trying to encode the full dataset, I keep running into the **RuntimeWarnings** below:\r\n```\r\n/home/cdsw/.local/lib/python3.6/site-packages/dirty_cat/gap_encoder.py:558: RuntimeWarning: overflow encountered in reciprocal\r\n  A += W * safe_sparse_dot(Ht.T, Vt.multiply(np.dot(Ht, W) ** -1))\r\n/home/cdsw/.local/lib/python3.6/site-packages/dirty_cat/gap_encoder.py:600: RuntimeWarning: overflow encountered in true_divide\r\n  aux = np.dot(W_WT1_, vt_ / np.dot(ht, W_))\r\n/home/cdsw/.local/lib/python3.6/site-packages/dirty_cat/gap_encoder.py:601: RuntimeWarning: invalid value encountered in multiply\r\n  ht_out = ht * aux + const\r\n```\r\nI have tried initializing with 'random' and using hashing, but keep running into the same. \r\nWhen trying to encode column by column, I cannot find a clear pattern - the overflow happens for columns with low cardinality, as well as for such with high ones. At the same time, some columns are encoded successfully.\r\n\r\nAn example of a column that runs into the Warning:\r\n\r\n[Mercy Medical Center (Des Moines, IA), Mercy Medical Center (Roseburg, OR), Harrison Medical Center (Bremerton, WA), St. Joseph Hospital East (Lexington, KY), Lakeside Hospital (Omaha, NE), ..., Plainview Hospital (Plainview, NE), Continuing Care Hospital (Lexington, KY), Regional Hospital for Resp (Seattle, WA), Creighton University Medical Center (Omaha, NE), St. Alexius Garrison Family Clinic (Garrison, ND)]\r\n\r\nPython 3.6.8, [GCC 5.4.0 20160609] on Cloudera Workbench (Linux)\r\nsklearn version = '0.23.1'\r\nscipy version = '1.5.0'\r\nnumpy version = '1.18.5'\r\npandas version = '1.0.4'\r\n\r\n**Any advice or direction would be more than welcome! Please let me know if you need anything else.**\r\n\r\n","closed_by":{"login":"alexis-cvetkov","id":33491786,"node_id":"MDQ6VXNlcjMzNDkxNzg2","avatar_url":"https://avatars.githubusercontent.com/u/33491786?v=4","gravatar_id":"","url":"https://api.github.com/users/alexis-cvetkov","html_url":"https://github.com/alexis-cvetkov","followers_url":"https://api.github.com/users/alexis-cvetkov/followers","following_url":"https://api.github.com/users/alexis-cvetkov/following{/other_user}","gists_url":"https://api.github.com/users/alexis-cvetkov/gists{/gist_id}","starred_url":"https://api.github.com/users/alexis-cvetkov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexis-cvetkov/subscriptions","organizations_url":"https://api.github.com/users/alexis-cvetkov/orgs","repos_url":"https://api.github.com/users/alexis-cvetkov/repos","events_url":"https://api.github.com/users/alexis-cvetkov/events{/privacy}","received_events_url":"https://api.github.com/users/alexis-cvetkov/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/dirty-cat/dirty_cat/issues/160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dirty-cat/dirty_cat/issues/160/timeline","performed_via_github_app":null,"state_reason":"completed"}