[{"url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/comments/678791200","html_url":"https://github.com/YannDubs/disentangling-vae/issues/59#issuecomment-678791200","issue_url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/59","id":678791200,"node_id":"MDEyOklzc3VlQ29tbWVudDY3ODc5MTIwMA==","user":{"login":"YannDubs","id":24327668,"node_id":"MDQ6VXNlcjI0MzI3NjY4","avatar_url":"https://avatars.githubusercontent.com/u/24327668?v=4","gravatar_id":"","url":"https://api.github.com/users/YannDubs","html_url":"https://github.com/YannDubs","followers_url":"https://api.github.com/users/YannDubs/followers","following_url":"https://api.github.com/users/YannDubs/following{/other_user}","gists_url":"https://api.github.com/users/YannDubs/gists{/gist_id}","starred_url":"https://api.github.com/users/YannDubs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YannDubs/subscriptions","organizations_url":"https://api.github.com/users/YannDubs/orgs","repos_url":"https://api.github.com/users/YannDubs/repos","events_url":"https://api.github.com/users/YannDubs/events{/privacy}","received_events_url":"https://api.github.com/users/YannDubs/received_events","type":"User","site_admin":false},"created_at":"2020-08-23T15:57:24Z","updated_at":"2020-08-23T16:01:54Z","author_association":"OWNER","body":"I don't see any issue in that part of the code, the marginalization is at this line using the logsumexp for numerically stable computations:\r\n\r\nhttps://github.com/YannDubs/disentangling-vae/blob/6a007067af1729ff556fa0b003096d200f80cb9f/disvae/evaluate.py#L288\r\n\r\nYou can check the comment above this line if that is not clear. The computations of the entropy then comes at:\r\n\r\nhttps://github.com/YannDubs/disentangling-vae/blob/6a007067af1729ff556fa0b003096d200f80cb9f/disvae/evaluate.py#L291\r\n\r\nFeel free to reopen if I missed your point\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/comments/678791200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"YannDubs","id":24327668,"node_id":"MDQ6VXNlcjI0MzI3NjY4","avatar_url":"https://avatars.githubusercontent.com/u/24327668?v=4","gravatar_id":"","url":"https://api.github.com/users/YannDubs","html_url":"https://github.com/YannDubs","followers_url":"https://api.github.com/users/YannDubs/followers","following_url":"https://api.github.com/users/YannDubs/following{/other_user}","gists_url":"https://api.github.com/users/YannDubs/gists{/gist_id}","starred_url":"https://api.github.com/users/YannDubs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YannDubs/subscriptions","organizations_url":"https://api.github.com/users/YannDubs/orgs","repos_url":"https://api.github.com/users/YannDubs/repos","events_url":"https://api.github.com/users/YannDubs/events{/privacy}","received_events_url":"https://api.github.com/users/YannDubs/received_events","type":"User","site_admin":false}},{"id":3682935645,"node_id":"MDExOkNsb3NlZEV2ZW50MzY4MjkzNTY0NQ==","url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/events/3682935645","actor":{"login":"YannDubs","id":24327668,"node_id":"MDQ6VXNlcjI0MzI3NjY4","avatar_url":"https://avatars.githubusercontent.com/u/24327668?v=4","gravatar_id":"","url":"https://api.github.com/users/YannDubs","html_url":"https://github.com/YannDubs","followers_url":"https://api.github.com/users/YannDubs/followers","following_url":"https://api.github.com/users/YannDubs/following{/other_user}","gists_url":"https://api.github.com/users/YannDubs/gists{/gist_id}","starred_url":"https://api.github.com/users/YannDubs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YannDubs/subscriptions","organizations_url":"https://api.github.com/users/YannDubs/orgs","repos_url":"https://api.github.com/users/YannDubs/repos","events_url":"https://api.github.com/users/YannDubs/events{/privacy}","received_events_url":"https://api.github.com/users/YannDubs/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-08-23T16:01:57Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/comments/678851964","html_url":"https://github.com/YannDubs/disentangling-vae/issues/59#issuecomment-678851964","issue_url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/59","id":678851964,"node_id":"MDEyOklzc3VlQ29tbWVudDY3ODg1MTk2NA==","user":{"login":"erow","id":7524356,"node_id":"MDQ6VXNlcjc1MjQzNTY=","avatar_url":"https://avatars.githubusercontent.com/u/7524356?v=4","gravatar_id":"","url":"https://api.github.com/users/erow","html_url":"https://github.com/erow","followers_url":"https://api.github.com/users/erow/followers","following_url":"https://api.github.com/users/erow/following{/other_user}","gists_url":"https://api.github.com/users/erow/gists{/gist_id}","starred_url":"https://api.github.com/users/erow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erow/subscriptions","organizations_url":"https://api.github.com/users/erow/orgs","repos_url":"https://api.github.com/users/erow/repos","events_url":"https://api.github.com/users/erow/events{/privacy}","received_events_url":"https://api.github.com/users/erow/received_events","type":"User","site_admin":false},"created_at":"2020-08-24T00:55:56Z","updated_at":"2020-08-24T00:55:56Z","author_association":"NONE","body":"To simplify this issue, assume 'z' obeys a standard normal distribution. \r\nSo H(z) = integrate(-p(z)*log(p(z)),{z,-inf,inf}). But here you sample 'z' and get some points. The corresponding calculation is sum(-p(zi)*log(p(zi)),{i,1,N}), which is not right.\r\nAnd a better way is  sum(-p(zi)*0.1*log(p(zi)),{zi,-4,4,0.1}), zi is a set of linspace -4, -3.9, ..., 4\r\n","reactions":{"url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/comments/678851964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"erow","id":7524356,"node_id":"MDQ6VXNlcjc1MjQzNTY=","avatar_url":"https://avatars.githubusercontent.com/u/7524356?v=4","gravatar_id":"","url":"https://api.github.com/users/erow","html_url":"https://github.com/erow","followers_url":"https://api.github.com/users/erow/followers","following_url":"https://api.github.com/users/erow/following{/other_user}","gists_url":"https://api.github.com/users/erow/gists{/gist_id}","starred_url":"https://api.github.com/users/erow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erow/subscriptions","organizations_url":"https://api.github.com/users/erow/orgs","repos_url":"https://api.github.com/users/erow/repos","events_url":"https://api.github.com/users/erow/events{/privacy}","received_events_url":"https://api.github.com/users/erow/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/comments/678853158","html_url":"https://github.com/YannDubs/disentangling-vae/issues/59#issuecomment-678853158","issue_url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/59","id":678853158,"node_id":"MDEyOklzc3VlQ29tbWVudDY3ODg1MzE1OA==","user":{"login":"YannDubs","id":24327668,"node_id":"MDQ6VXNlcjI0MzI3NjY4","avatar_url":"https://avatars.githubusercontent.com/u/24327668?v=4","gravatar_id":"","url":"https://api.github.com/users/YannDubs","html_url":"https://github.com/YannDubs","followers_url":"https://api.github.com/users/YannDubs/followers","following_url":"https://api.github.com/users/YannDubs/following{/other_user}","gists_url":"https://api.github.com/users/YannDubs/gists{/gist_id}","starred_url":"https://api.github.com/users/YannDubs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YannDubs/subscriptions","organizations_url":"https://api.github.com/users/YannDubs/orgs","repos_url":"https://api.github.com/users/YannDubs/repos","events_url":"https://api.github.com/users/YannDubs/events{/privacy}","received_events_url":"https://api.github.com/users/YannDubs/received_events","type":"User","site_admin":false},"created_at":"2020-08-24T01:01:59Z","updated_at":"2020-08-24T01:01:59Z","author_association":"OWNER","body":"It's not a sum but a mean because its divide by the number of samples \r\n\r\nhttps://github.com/YannDubs/disentangling-vae/blob/6a007067af1729ff556fa0b003096d200f80cb9f/disvae/evaluate.py#L295\r\n\r\nThis is simply a Monte Carlo approximation of the integral you are talking about. Using a grid as you suggest suffers from 2 issues:\r\n- it  scales exponentially with the number of dimensions\r\n- it requires evaluating p(z) multiple times (here we are not doing any additional evaluations, simply using the samples we already have access to)","reactions":{"url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/comments/678853158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"YannDubs","id":24327668,"node_id":"MDQ6VXNlcjI0MzI3NjY4","avatar_url":"https://avatars.githubusercontent.com/u/24327668?v=4","gravatar_id":"","url":"https://api.github.com/users/YannDubs","html_url":"https://github.com/YannDubs","followers_url":"https://api.github.com/users/YannDubs/followers","following_url":"https://api.github.com/users/YannDubs/following{/other_user}","gists_url":"https://api.github.com/users/YannDubs/gists{/gist_id}","starred_url":"https://api.github.com/users/YannDubs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YannDubs/subscriptions","organizations_url":"https://api.github.com/users/YannDubs/orgs","repos_url":"https://api.github.com/users/YannDubs/repos","events_url":"https://api.github.com/users/YannDubs/events{/privacy}","received_events_url":"https://api.github.com/users/YannDubs/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/comments/679003746","html_url":"https://github.com/YannDubs/disentangling-vae/issues/59#issuecomment-679003746","issue_url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/59","id":679003746,"node_id":"MDEyOklzc3VlQ29tbWVudDY3OTAwMzc0Ng==","user":{"login":"erow","id":7524356,"node_id":"MDQ6VXNlcjc1MjQzNTY=","avatar_url":"https://avatars.githubusercontent.com/u/7524356?v=4","gravatar_id":"","url":"https://api.github.com/users/erow","html_url":"https://github.com/erow","followers_url":"https://api.github.com/users/erow/followers","following_url":"https://api.github.com/users/erow/following{/other_user}","gists_url":"https://api.github.com/users/erow/gists{/gist_id}","starred_url":"https://api.github.com/users/erow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erow/subscriptions","organizations_url":"https://api.github.com/users/erow/orgs","repos_url":"https://api.github.com/users/erow/repos","events_url":"https://api.github.com/users/erow/events{/privacy}","received_events_url":"https://api.github.com/users/erow/received_events","type":"User","site_admin":false},"created_at":"2020-08-24T09:02:26Z","updated_at":"2020-08-24T09:02:26Z","author_association":"NONE","body":"Better to make an error analysis. My implementation refers to A.10(https://arxiv.org/abs/1908.09961).\r\nThe entropy of standard normal distribution is `0.5*(math.log(2*math.pi)+1)=1.418`, however, this approach is 0.9189.\r\n```\r\nparam=(torch.zeros(100,1),torch.zeros(100,1))\r\nsamples_zCx=self.model.reparameterize(*param)\r\nlen_dataset, latent_dim = samples_zCx.shape\r\n\r\n# marginal entropy H(z_j)\r\nH_z = self._estimate_latent_entropies(samples_zCx, param)\r\n```\r\n ","reactions":{"url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/comments/679003746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"erow","id":7524356,"node_id":"MDQ6VXNlcjc1MjQzNTY=","avatar_url":"https://avatars.githubusercontent.com/u/7524356?v=4","gravatar_id":"","url":"https://api.github.com/users/erow","html_url":"https://github.com/erow","followers_url":"https://api.github.com/users/erow/followers","following_url":"https://api.github.com/users/erow/following{/other_user}","gists_url":"https://api.github.com/users/erow/gists{/gist_id}","starred_url":"https://api.github.com/users/erow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erow/subscriptions","organizations_url":"https://api.github.com/users/erow/orgs","repos_url":"https://api.github.com/users/erow/repos","events_url":"https://api.github.com/users/erow/events{/privacy}","received_events_url":"https://api.github.com/users/erow/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/comments/679193651","html_url":"https://github.com/YannDubs/disentangling-vae/issues/59#issuecomment-679193651","issue_url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/59","id":679193651,"node_id":"MDEyOklzc3VlQ29tbWVudDY3OTE5MzY1MQ==","user":{"login":"YannDubs","id":24327668,"node_id":"MDQ6VXNlcjI0MzI3NjY4","avatar_url":"https://avatars.githubusercontent.com/u/24327668?v=4","gravatar_id":"","url":"https://api.github.com/users/YannDubs","html_url":"https://github.com/YannDubs","followers_url":"https://api.github.com/users/YannDubs/followers","following_url":"https://api.github.com/users/YannDubs/following{/other_user}","gists_url":"https://api.github.com/users/YannDubs/gists{/gist_id}","starred_url":"https://api.github.com/users/YannDubs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YannDubs/subscriptions","organizations_url":"https://api.github.com/users/YannDubs/orgs","repos_url":"https://api.github.com/users/YannDubs/repos","events_url":"https://api.github.com/users/YannDubs/events{/privacy}","received_events_url":"https://api.github.com/users/YannDubs/received_events","type":"User","site_admin":false},"created_at":"2020-08-24T15:22:49Z","updated_at":"2020-08-24T15:22:49Z","author_association":"OWNER","body":"we are exaxtly doing what is called \"estimating by sampling\" in the paper you sent. They even explicitly say that \"estimation by quantization\" that you said only works for scalars z (this is actually not true but it becomes computationally intractable in higher dimensions)\r\n\r\nAn error analysis on one try does not make sense as it's a stochastic approximation. Can you please run the same code but average over ~10000 trials and see whether the average is close to H_z ?","reactions":{"url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/comments/679193651/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"YannDubs","id":24327668,"node_id":"MDQ6VXNlcjI0MzI3NjY4","avatar_url":"https://avatars.githubusercontent.com/u/24327668?v=4","gravatar_id":"","url":"https://api.github.com/users/YannDubs","html_url":"https://github.com/YannDubs","followers_url":"https://api.github.com/users/YannDubs/followers","following_url":"https://api.github.com/users/YannDubs/following{/other_user}","gists_url":"https://api.github.com/users/YannDubs/gists{/gist_id}","starred_url":"https://api.github.com/users/YannDubs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YannDubs/subscriptions","organizations_url":"https://api.github.com/users/YannDubs/orgs","repos_url":"https://api.github.com/users/YannDubs/repos","events_url":"https://api.github.com/users/YannDubs/events{/privacy}","received_events_url":"https://api.github.com/users/YannDubs/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/comments/679945318","html_url":"https://github.com/YannDubs/disentangling-vae/issues/59#issuecomment-679945318","issue_url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/59","id":679945318,"node_id":"MDEyOklzc3VlQ29tbWVudDY3OTk0NTMxOA==","user":{"login":"erow","id":7524356,"node_id":"MDQ6VXNlcjc1MjQzNTY=","avatar_url":"https://avatars.githubusercontent.com/u/7524356?v=4","gravatar_id":"","url":"https://api.github.com/users/erow","html_url":"https://github.com/erow","followers_url":"https://api.github.com/users/erow/followers","following_url":"https://api.github.com/users/erow/following{/other_user}","gists_url":"https://api.github.com/users/erow/gists{/gist_id}","starred_url":"https://api.github.com/users/erow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erow/subscriptions","organizations_url":"https://api.github.com/users/erow/orgs","repos_url":"https://api.github.com/users/erow/repos","events_url":"https://api.github.com/users/erow/events{/privacy}","received_events_url":"https://api.github.com/users/erow/received_events","type":"User","site_admin":false},"created_at":"2020-08-25T10:35:25Z","updated_at":"2020-08-25T10:35:25Z","author_association":"NONE","body":"But our goal is to estimate z_j instead of z. I have to say quantization has a lower error and compute-time is acceptable.","reactions":{"url":"https://api.github.com/repos/YannDubs/disentangling-vae/issues/comments/679945318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"erow","id":7524356,"node_id":"MDQ6VXNlcjc1MjQzNTY=","avatar_url":"https://avatars.githubusercontent.com/u/7524356?v=4","gravatar_id":"","url":"https://api.github.com/users/erow","html_url":"https://github.com/erow","followers_url":"https://api.github.com/users/erow/followers","following_url":"https://api.github.com/users/erow/following{/other_user}","gists_url":"https://api.github.com/users/erow/gists{/gist_id}","starred_url":"https://api.github.com/users/erow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erow/subscriptions","organizations_url":"https://api.github.com/users/erow/orgs","repos_url":"https://api.github.com/users/erow/repos","events_url":"https://api.github.com/users/erow/events{/privacy}","received_events_url":"https://api.github.com/users/erow/received_events","type":"User","site_admin":false}}]