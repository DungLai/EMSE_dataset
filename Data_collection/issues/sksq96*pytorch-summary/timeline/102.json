[{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/570113845","html_url":"https://github.com/sksq96/pytorch-summary/issues/102#issuecomment-570113845","issue_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/102","id":570113845,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDExMzg0NQ==","user":{"login":"Naireen","id":13244787,"node_id":"MDQ6VXNlcjEzMjQ0Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/13244787?v=4","gravatar_id":"","url":"https://api.github.com/users/Naireen","html_url":"https://github.com/Naireen","followers_url":"https://api.github.com/users/Naireen/followers","following_url":"https://api.github.com/users/Naireen/following{/other_user}","gists_url":"https://api.github.com/users/Naireen/gists{/gist_id}","starred_url":"https://api.github.com/users/Naireen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Naireen/subscriptions","organizations_url":"https://api.github.com/users/Naireen/orgs","repos_url":"https://api.github.com/users/Naireen/repos","events_url":"https://api.github.com/users/Naireen/events{/privacy}","received_events_url":"https://api.github.com/users/Naireen/received_events","type":"User","site_admin":false},"created_at":"2020-01-02T04:01:38Z","updated_at":"2020-01-02T04:01:38Z","author_association":"COLLABORATOR","body":"What use case would this be for? the current design is to ensure that the user doesn't accidentally pass in certain dtypes as `torch.FloatTensor`,  and then other types as  `torch.cuda.FloatTensor`, as that wouldn't work. However, depending on the network architecture, you can't even pass in  `torch.FloatTensor` and  `torch.ByteTensor` for multi-inputs, due to the expected input types (eg for conv layers). ","reactions":{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/570113845/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Naireen","id":13244787,"node_id":"MDQ6VXNlcjEzMjQ0Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/13244787?v=4","gravatar_id":"","url":"https://api.github.com/users/Naireen","html_url":"https://github.com/Naireen","followers_url":"https://api.github.com/users/Naireen/followers","following_url":"https://api.github.com/users/Naireen/following{/other_user}","gists_url":"https://api.github.com/users/Naireen/gists{/gist_id}","starred_url":"https://api.github.com/users/Naireen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Naireen/subscriptions","organizations_url":"https://api.github.com/users/Naireen/orgs","repos_url":"https://api.github.com/users/Naireen/repos","events_url":"https://api.github.com/users/Naireen/events{/privacy}","received_events_url":"https://api.github.com/users/Naireen/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/570755570","html_url":"https://github.com/sksq96/pytorch-summary/issues/102#issuecomment-570755570","issue_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/102","id":570755570,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDc1NTU3MA==","user":{"login":"trajepl","id":13343117,"node_id":"MDQ6VXNlcjEzMzQzMTE3","avatar_url":"https://avatars.githubusercontent.com/u/13343117?v=4","gravatar_id":"","url":"https://api.github.com/users/trajepl","html_url":"https://github.com/trajepl","followers_url":"https://api.github.com/users/trajepl/followers","following_url":"https://api.github.com/users/trajepl/following{/other_user}","gists_url":"https://api.github.com/users/trajepl/gists{/gist_id}","starred_url":"https://api.github.com/users/trajepl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trajepl/subscriptions","organizations_url":"https://api.github.com/users/trajepl/orgs","repos_url":"https://api.github.com/users/trajepl/repos","events_url":"https://api.github.com/users/trajepl/events{/privacy}","received_events_url":"https://api.github.com/users/trajepl/received_events","type":"User","site_admin":false},"created_at":"2020-01-04T04:25:45Z","updated_at":"2020-01-04T04:27:26Z","author_association":"NONE","body":"So I show the code of my model as following:\r\n```python\r\nclass WNGat(nn.Module):\r\n    def __init__(\r\n            self,\r\n            in_channels: int,\r\n            hidden_channels: int,\r\n            out_channels: int,\r\n            heads: int = 1,\r\n            concat: bool = True,\r\n            negative_slope: float = 0.2,\r\n            dropout: float = 0.,\r\n            use_checkpoint: bool = False,\r\n            **kwargs) -> None:\r\n\r\n        super(WNGat, self).__init__()\r\n        self.conv1 = GATConv(in_channels, hidden_channels,\r\n                             heads, dropout=dropout)\r\n        self.conv2 = GATConv(hidden_channels*heads,\r\n                             hidden_channels, heads, dropout=dropout)\r\n        self.conv3 = GATConv(hidden_channels*heads,\r\n                             out_channels, heads, dropout=dropout)\r\n        self.use_checkpoint = use_checkpoint\r\n\r\n    def forward(self, inp, edge_index, size=None):\r\n        if self.use_checkpoint:\r\n            inp = torch.autograd.Variable(inp, requires_grad=True)\r\n            h1 = F.elu(checkpoint(self.conv1, inp, edge_index))\r\n            h2 = F.elu(checkpoint(self.conv2, h1, edge_index))\r\n            oup = F.elu(checkpoint(self.conv3, h2, edge_index))\r\n        else:\r\n            h1 = F.elu(self.conv1(inp, edge_index))\r\n            # h2 = F.elu(self.conv2(h1, edge_index))\r\n            oup = F.elu(self.conv3(h1, edge_index))\r\n        return oup\r\n```\r\nSimply, the input of 'GATConv' is a graph where contains node features`size: (num_nodes, num_node_features)` and edges `size:(2, num_nodes)`. For example, there is a graph contains three nodes(0, 1, 2) and each node owns 128-dim features vector:\r\n```\r\nedges:\r\n    0->1\r\n    1->2\r\n    2->0\r\n    2->2\r\n```\r\nso the parameters for our model are:\r\n```\r\ninp: size: [3, 128]  dtype: torch.FloatTensor\r\nedge_index: size: [2, 4]  dtype: torch.Long Tensor  data: [[0, 1, 2, 2],[1, 2, 0, 2]]\r\n```\r\nIn this case, [the code](https://github.com/sksq96/pytorch-summary/blob/dbcb1bdbb2c8addf7e9e1b64a17152462fcaf7a9/torchsummary/torchsummary.py#L49) would not work as the dtype of `inp` and `edge_index` are changed to `FloatTensor`.\r\n\r\nIn order to make the code to fit my model, I change some lines in `torchsummary.py` locally:\r\n```python\r\n## 1 - line 49\r\n # if device == \"cuda\" and torch.cuda.is_available():\r\n    #     dtype = torch.cuda.FloatTensor\r\n    # else:\r\n    #     dtype = torch.FloatTensor\r\n\r\n    # multiple inputs to the network\r\n    if isinstance(input_size, tuple):\r\n        input_size = [input_size]\r\n\r\n    # batch_size of 2 for batchnorm\r\n    x = [torch.rand(*in_size).type(dtype) for in_size, dtype in input_size]\r\n    # print(type(x[0]))\r\n\r\n\r\n## 2 - line 100\r\n    if input_size and len(input_size[0]) > 1 and type(input_size[0][0]) is tuple:\r\n        total_prod = 1\r\n        for input_item in input_size:\r\n            total_prod *= np.prod(input_item[0])\r\n        total_input_size = abs(np.prod(total_prod) * batch_size * 4. / (1024 ** 2.))    \r\n    else:\r\n        total_input_size = abs(np.prod(input_size) * batch_size * 4. / (1024 ** 2.))\r\n\r\n```\r\n\r\nFinally, I call the function `summary` as following to get the right results:\r\n```python\r\n\r\nmodel = model.to(device)\r\nsummary(model, [((data.num_nodes, data.num_node_features),\r\n                 torch.FloatTensor), ((2, data.num_edges), torch.LongTensor)])\r\n```\r\n```bash\r\n----------------------------------------------------------------\r\n        Layer (type)               Output Shape         Param #\r\n================================================================\r\n           GATConv-1                  [-1, 512]         734,208\r\n           GATConv-2                  [-1, 256]         131,328\r\n================================================================\r\nTotal params: 865,536\r\nTrainable params: 865,536\r\nNon-trainable params: 0\r\n----------------------------------------------------------------\r\nInput size (MB): 80174.01\r\nForward/backward pass size (MB): 0.01\r\nParams size (MB): 3.30\r\nEstimated Total Size (MB): 80177.31\r\n----------------------------------------------------------------\r\n```","reactions":{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/570755570/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"trajepl","id":13343117,"node_id":"MDQ6VXNlcjEzMzQzMTE3","avatar_url":"https://avatars.githubusercontent.com/u/13343117?v=4","gravatar_id":"","url":"https://api.github.com/users/trajepl","html_url":"https://github.com/trajepl","followers_url":"https://api.github.com/users/trajepl/followers","following_url":"https://api.github.com/users/trajepl/following{/other_user}","gists_url":"https://api.github.com/users/trajepl/gists{/gist_id}","starred_url":"https://api.github.com/users/trajepl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trajepl/subscriptions","organizations_url":"https://api.github.com/users/trajepl/orgs","repos_url":"https://api.github.com/users/trajepl/repos","events_url":"https://api.github.com/users/trajepl/events{/privacy}","received_events_url":"https://api.github.com/users/trajepl/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/570756435","html_url":"https://github.com/sksq96/pytorch-summary/issues/102#issuecomment-570756435","issue_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/102","id":570756435,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDc1NjQzNQ==","user":{"login":"trajepl","id":13343117,"node_id":"MDQ6VXNlcjEzMzQzMTE3","avatar_url":"https://avatars.githubusercontent.com/u/13343117?v=4","gravatar_id":"","url":"https://api.github.com/users/trajepl","html_url":"https://github.com/trajepl","followers_url":"https://api.github.com/users/trajepl/followers","following_url":"https://api.github.com/users/trajepl/following{/other_user}","gists_url":"https://api.github.com/users/trajepl/gists{/gist_id}","starred_url":"https://api.github.com/users/trajepl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trajepl/subscriptions","organizations_url":"https://api.github.com/users/trajepl/orgs","repos_url":"https://api.github.com/users/trajepl/repos","events_url":"https://api.github.com/users/trajepl/events{/privacy}","received_events_url":"https://api.github.com/users/trajepl/received_events","type":"User","site_admin":false},"created_at":"2020-01-04T04:44:37Z","updated_at":"2020-01-04T04:44:37Z","author_association":"NONE","body":"I find a [pull request](https://github.com/sksq96/pytorch-summary/pull/104) which maybe work in my case.","reactions":{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/570756435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"trajepl","id":13343117,"node_id":"MDQ6VXNlcjEzMzQzMTE3","avatar_url":"https://avatars.githubusercontent.com/u/13343117?v=4","gravatar_id":"","url":"https://api.github.com/users/trajepl","html_url":"https://github.com/trajepl","followers_url":"https://api.github.com/users/trajepl/followers","following_url":"https://api.github.com/users/trajepl/following{/other_user}","gists_url":"https://api.github.com/users/trajepl/gists{/gist_id}","starred_url":"https://api.github.com/users/trajepl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trajepl/subscriptions","organizations_url":"https://api.github.com/users/trajepl/orgs","repos_url":"https://api.github.com/users/trajepl/repos","events_url":"https://api.github.com/users/trajepl/events{/privacy}","received_events_url":"https://api.github.com/users/trajepl/received_events","type":"User","site_admin":false}},{"id":2922223971,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5MjIyMjM5NzE=","url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/events/2922223971","actor":{"login":"Naireen","id":13244787,"node_id":"MDQ6VXNlcjEzMjQ0Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/13244787?v=4","gravatar_id":"","url":"https://api.github.com/users/Naireen","html_url":"https://github.com/Naireen","followers_url":"https://api.github.com/users/Naireen/followers","following_url":"https://api.github.com/users/Naireen/following{/other_user}","gists_url":"https://api.github.com/users/Naireen/gists{/gist_id}","starred_url":"https://api.github.com/users/Naireen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Naireen/subscriptions","organizations_url":"https://api.github.com/users/Naireen/orgs","repos_url":"https://api.github.com/users/Naireen/repos","events_url":"https://api.github.com/users/Naireen/events{/privacy}","received_events_url":"https://api.github.com/users/Naireen/received_events","type":"User","site_admin":false},"event":"referenced","commit_id":"4cc6a9b9248248ea039191511671e02113f48f36","commit_url":"https://api.github.com/repos/sksq96/pytorch-summary/commits/4cc6a9b9248248ea039191511671e02113f48f36","created_at":"2020-01-05T04:40:17Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/570859064","html_url":"https://github.com/sksq96/pytorch-summary/issues/102#issuecomment-570859064","issue_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/102","id":570859064,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDg1OTA2NA==","user":{"login":"Naireen","id":13244787,"node_id":"MDQ6VXNlcjEzMjQ0Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/13244787?v=4","gravatar_id":"","url":"https://api.github.com/users/Naireen","html_url":"https://github.com/Naireen","followers_url":"https://api.github.com/users/Naireen/followers","following_url":"https://api.github.com/users/Naireen/following{/other_user}","gists_url":"https://api.github.com/users/Naireen/gists{/gist_id}","starred_url":"https://api.github.com/users/Naireen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Naireen/subscriptions","organizations_url":"https://api.github.com/users/Naireen/orgs","repos_url":"https://api.github.com/users/Naireen/repos","events_url":"https://api.github.com/users/Naireen/events{/privacy}","received_events_url":"https://api.github.com/users/Naireen/received_events","type":"User","site_admin":false},"created_at":"2020-01-05T04:49:15Z","updated_at":"2020-01-05T05:45:34Z","author_association":"COLLABORATOR","body":"Passing in the either dtypes or device type explicitly seems like a popular request, so it's something I would like to add, as this will also address other issues such as being able to run on a specified gpu, eg #92 . However, based on your use case, that PR actually isn't sufficient, as it only allows you to pass in one dtype, and then forces all inputs to that dtype. In your example, you have both `torch.FloatTensor`, and `torch.LongTensor`. I have a branch named `issue_102` up, let me know if that addresses your issue! I was unable to run your code sample, as its incomplete since   `GATConv` is undefined. ","reactions":{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/570859064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Naireen","id":13244787,"node_id":"MDQ6VXNlcjEzMjQ0Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/13244787?v=4","gravatar_id":"","url":"https://api.github.com/users/Naireen","html_url":"https://github.com/Naireen","followers_url":"https://api.github.com/users/Naireen/followers","following_url":"https://api.github.com/users/Naireen/following{/other_user}","gists_url":"https://api.github.com/users/Naireen/gists{/gist_id}","starred_url":"https://api.github.com/users/Naireen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Naireen/subscriptions","organizations_url":"https://api.github.com/users/Naireen/orgs","repos_url":"https://api.github.com/users/Naireen/repos","events_url":"https://api.github.com/users/Naireen/events{/privacy}","received_events_url":"https://api.github.com/users/Naireen/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/570867144","html_url":"https://github.com/sksq96/pytorch-summary/issues/102#issuecomment-570867144","issue_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/102","id":570867144,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDg2NzE0NA==","user":{"login":"trajepl","id":13343117,"node_id":"MDQ6VXNlcjEzMzQzMTE3","avatar_url":"https://avatars.githubusercontent.com/u/13343117?v=4","gravatar_id":"","url":"https://api.github.com/users/trajepl","html_url":"https://github.com/trajepl","followers_url":"https://api.github.com/users/trajepl/followers","following_url":"https://api.github.com/users/trajepl/following{/other_user}","gists_url":"https://api.github.com/users/trajepl/gists{/gist_id}","starred_url":"https://api.github.com/users/trajepl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trajepl/subscriptions","organizations_url":"https://api.github.com/users/trajepl/orgs","repos_url":"https://api.github.com/users/trajepl/repos","events_url":"https://api.github.com/users/trajepl/events{/privacy}","received_events_url":"https://api.github.com/users/trajepl/received_events","type":"User","site_admin":false},"created_at":"2020-01-05T05:36:38Z","updated_at":"2020-01-05T05:36:38Z","author_association":"NONE","body":"Thanks. It worked.","reactions":{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/570867144/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"trajepl","id":13343117,"node_id":"MDQ6VXNlcjEzMzQzMTE3","avatar_url":"https://avatars.githubusercontent.com/u/13343117?v=4","gravatar_id":"","url":"https://api.github.com/users/trajepl","html_url":"https://github.com/trajepl","followers_url":"https://api.github.com/users/trajepl/followers","following_url":"https://api.github.com/users/trajepl/following{/other_user}","gists_url":"https://api.github.com/users/trajepl/gists{/gist_id}","starred_url":"https://api.github.com/users/trajepl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trajepl/subscriptions","organizations_url":"https://api.github.com/users/trajepl/orgs","repos_url":"https://api.github.com/users/trajepl/repos","events_url":"https://api.github.com/users/trajepl/events{/privacy}","received_events_url":"https://api.github.com/users/trajepl/received_events","type":"User","site_admin":false}},{"id":2922256101,"node_id":"MDExOkNsb3NlZEV2ZW50MjkyMjI1NjEwMQ==","url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/events/2922256101","actor":{"login":"Naireen","id":13244787,"node_id":"MDQ6VXNlcjEzMjQ0Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/13244787?v=4","gravatar_id":"","url":"https://api.github.com/users/Naireen","html_url":"https://github.com/Naireen","followers_url":"https://api.github.com/users/Naireen/followers","following_url":"https://api.github.com/users/Naireen/following{/other_user}","gists_url":"https://api.github.com/users/Naireen/gists{/gist_id}","starred_url":"https://api.github.com/users/Naireen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Naireen/subscriptions","organizations_url":"https://api.github.com/users/Naireen/orgs","repos_url":"https://api.github.com/users/Naireen/repos","events_url":"https://api.github.com/users/Naireen/events{/privacy}","received_events_url":"https://api.github.com/users/Naireen/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-01-05T05:45:54Z","state_reason":null,"performed_via_github_app":null},{"id":2922257043,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5MjIyNTcwNDM=","url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/events/2922257043","actor":{"login":"Naireen","id":13244787,"node_id":"MDQ6VXNlcjEzMjQ0Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/13244787?v=4","gravatar_id":"","url":"https://api.github.com/users/Naireen","html_url":"https://github.com/Naireen","followers_url":"https://api.github.com/users/Naireen/followers","following_url":"https://api.github.com/users/Naireen/following{/other_user}","gists_url":"https://api.github.com/users/Naireen/gists{/gist_id}","starred_url":"https://api.github.com/users/Naireen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Naireen/subscriptions","organizations_url":"https://api.github.com/users/Naireen/orgs","repos_url":"https://api.github.com/users/Naireen/repos","events_url":"https://api.github.com/users/Naireen/events{/privacy}","received_events_url":"https://api.github.com/users/Naireen/received_events","type":"User","site_admin":false},"event":"referenced","commit_id":"8af9926383c9aef9f26150a3d407ca87c6fac1bc","commit_url":"https://api.github.com/repos/sksq96/pytorch-summary/commits/8af9926383c9aef9f26150a3d407ca87c6fac1bc","created_at":"2020-01-05T05:48:43Z","performed_via_github_app":null}]