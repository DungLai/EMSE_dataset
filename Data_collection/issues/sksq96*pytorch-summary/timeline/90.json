[{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/525325501","html_url":"https://github.com/sksq96/pytorch-summary/issues/90#issuecomment-525325501","issue_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/90","id":525325501,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNTMyNTUwMQ==","user":{"login":"apacha","id":594497,"node_id":"MDQ6VXNlcjU5NDQ5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/594497?v=4","gravatar_id":"","url":"https://api.github.com/users/apacha","html_url":"https://github.com/apacha","followers_url":"https://api.github.com/users/apacha/followers","following_url":"https://api.github.com/users/apacha/following{/other_user}","gists_url":"https://api.github.com/users/apacha/gists{/gist_id}","starred_url":"https://api.github.com/users/apacha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apacha/subscriptions","organizations_url":"https://api.github.com/users/apacha/orgs","repos_url":"https://api.github.com/users/apacha/repos","events_url":"https://api.github.com/users/apacha/events{/privacy}","received_events_url":"https://api.github.com/users/apacha/received_events","type":"User","site_admin":false},"created_at":"2019-08-27T14:24:57Z","updated_at":"2019-08-27T14:24:57Z","author_association":"NONE","body":"Wow! That is a great solution to the problem! Just had the same issue here.\r\n\r\n```\r\nimport torch.nn.functional as F\r\nfrom torch.nn import Module, Conv2d, MaxPool2d, Linear, AdaptiveAvgPool2d\r\nfrom torchsummary import summary\r\n\r\n\r\nclass DetectionRefinementModel(Module):\r\n\r\n    def __init__(self):\r\n        super(DetectionRefinementModel, self).__init__()\r\n        self.pool = MaxPool2d(2, 2)\r\n        self.conv1 = Conv2d(3, 64, 3, padding=1)\r\n        self.conv2 = Conv2d(64, 96, 3, padding=1)\r\n        self.conv3 = Conv2d(96, 128, 3, padding=1)\r\n        self.conv4 = Conv2d(128, 192, 3, padding=1)\r\n        self.avg_pool = AdaptiveAvgPool2d((1, 1))\r\n        self.linear1 = Linear(192, 64)\r\n        self.linear2 = Linear(64, 4)\r\n\r\n    def forward(self, image, unrefined_bounding_box):\r\n        x = self.pool(F.relu(self.conv1(image)))\r\n        x = self.pool(F.relu(self.conv2(x)))\r\n        x = self.pool(F.relu(self.conv3(x)))\r\n        x = F.relu(self.conv4(x))\r\n\r\n        x = self.avg_pool(x)\r\n        x = x.view(x.size(0), -1)\r\n        x = F.relu(self.linear1(x))\r\n        x = F.relu(self.linear2(x))\r\n        x = x + unrefined_bounding_box\r\n\r\n        return x\r\n\r\n\r\nif __name__ == '__main__':\r\n    network = DetectionRefinementModel()\r\n    print(network)\r\n    summary(network, [(3, 128, 1024), (4,)], device=\"cpu\")\r\n```\r\n\r\nYour workaround fixed the problem here.","reactions":{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/525325501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"apacha","id":594497,"node_id":"MDQ6VXNlcjU5NDQ5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/594497?v=4","gravatar_id":"","url":"https://api.github.com/users/apacha","html_url":"https://github.com/apacha","followers_url":"https://api.github.com/users/apacha/followers","following_url":"https://api.github.com/users/apacha/following{/other_user}","gists_url":"https://api.github.com/users/apacha/gists{/gist_id}","starred_url":"https://api.github.com/users/apacha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apacha/subscriptions","organizations_url":"https://api.github.com/users/apacha/orgs","repos_url":"https://api.github.com/users/apacha/repos","events_url":"https://api.github.com/users/apacha/events{/privacy}","received_events_url":"https://api.github.com/users/apacha/received_events","type":"User","site_admin":false}},{"id":2912206971,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQyOTEyMjA2OTcx","url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/events/2912206971","actor":{"login":"Naireen","id":13244787,"node_id":"MDQ6VXNlcjEzMjQ0Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/13244787?v=4","gravatar_id":"","url":"https://api.github.com/users/Naireen","html_url":"https://github.com/Naireen","followers_url":"https://api.github.com/users/Naireen/followers","following_url":"https://api.github.com/users/Naireen/following{/other_user}","gists_url":"https://api.github.com/users/Naireen/gists{/gist_id}","starred_url":"https://api.github.com/users/Naireen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Naireen/subscriptions","organizations_url":"https://api.github.com/users/Naireen/orgs","repos_url":"https://api.github.com/users/Naireen/repos","events_url":"https://api.github.com/users/Naireen/events{/privacy}","received_events_url":"https://api.github.com/users/Naireen/received_events","type":"User","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2019-12-29T01:05:30Z","assignee":{"login":"Naireen","id":13244787,"node_id":"MDQ6VXNlcjEzMjQ0Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/13244787?v=4","gravatar_id":"","url":"https://api.github.com/users/Naireen","html_url":"https://github.com/Naireen","followers_url":"https://api.github.com/users/Naireen/followers","following_url":"https://api.github.com/users/Naireen/following{/other_user}","gists_url":"https://api.github.com/users/Naireen/gists{/gist_id}","starred_url":"https://api.github.com/users/Naireen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Naireen/subscriptions","organizations_url":"https://api.github.com/users/Naireen/orgs","repos_url":"https://api.github.com/users/Naireen/repos","events_url":"https://api.github.com/users/Naireen/events{/privacy}","received_events_url":"https://api.github.com/users/Naireen/received_events","type":"User","site_admin":false},"performed_via_github_app":null},{"id":2912228930,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5MTIyMjg5MzA=","url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/events/2912228930","actor":{"login":"Naireen","id":13244787,"node_id":"MDQ6VXNlcjEzMjQ0Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/13244787?v=4","gravatar_id":"","url":"https://api.github.com/users/Naireen","html_url":"https://github.com/Naireen","followers_url":"https://api.github.com/users/Naireen/followers","following_url":"https://api.github.com/users/Naireen/following{/other_user}","gists_url":"https://api.github.com/users/Naireen/gists{/gist_id}","starred_url":"https://api.github.com/users/Naireen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Naireen/subscriptions","organizations_url":"https://api.github.com/users/Naireen/orgs","repos_url":"https://api.github.com/users/Naireen/repos","events_url":"https://api.github.com/users/Naireen/events{/privacy}","received_events_url":"https://api.github.com/users/Naireen/received_events","type":"User","site_admin":false},"event":"referenced","commit_id":"eb07421c49ddc99f943577bef9f0792d4e6a89b2","commit_url":"https://api.github.com/repos/sksq96/pytorch-summary/commits/eb07421c49ddc99f943577bef9f0792d4e6a89b2","created_at":"2019-12-29T02:23:30Z","performed_via_github_app":null},{"id":2912926862,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5MTI5MjY4NjI=","url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/events/2912926862","actor":{"login":"sksq96","id":8557728,"node_id":"MDQ6VXNlcjg1NTc3Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/8557728?v=4","gravatar_id":"","url":"https://api.github.com/users/sksq96","html_url":"https://github.com/sksq96","followers_url":"https://api.github.com/users/sksq96/followers","following_url":"https://api.github.com/users/sksq96/following{/other_user}","gists_url":"https://api.github.com/users/sksq96/gists{/gist_id}","starred_url":"https://api.github.com/users/sksq96/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sksq96/subscriptions","organizations_url":"https://api.github.com/users/sksq96/orgs","repos_url":"https://api.github.com/users/sksq96/repos","events_url":"https://api.github.com/users/sksq96/events{/privacy}","received_events_url":"https://api.github.com/users/sksq96/received_events","type":"User","site_admin":false},"event":"referenced","commit_id":"2818454ee9f7f8ce73799530de5857343dcd273a","commit_url":"https://api.github.com/repos/sksq96/pytorch-summary/commits/2818454ee9f7f8ce73799530de5857343dcd273a","created_at":"2019-12-29T23:43:16Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/569584384","html_url":"https://github.com/sksq96/pytorch-summary/issues/90#issuecomment-569584384","issue_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/90","id":569584384,"node_id":"MDEyOklzc3VlQ29tbWVudDU2OTU4NDM4NA==","user":{"login":"Naireen","id":13244787,"node_id":"MDQ6VXNlcjEzMjQ0Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/13244787?v=4","gravatar_id":"","url":"https://api.github.com/users/Naireen","html_url":"https://github.com/Naireen","followers_url":"https://api.github.com/users/Naireen/followers","following_url":"https://api.github.com/users/Naireen/following{/other_user}","gists_url":"https://api.github.com/users/Naireen/gists{/gist_id}","starred_url":"https://api.github.com/users/Naireen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Naireen/subscriptions","organizations_url":"https://api.github.com/users/Naireen/orgs","repos_url":"https://api.github.com/users/Naireen/repos","events_url":"https://api.github.com/users/Naireen/events{/privacy}","received_events_url":"https://api.github.com/users/Naireen/received_events","type":"User","site_admin":false},"created_at":"2019-12-30T05:02:37Z","updated_at":"2019-12-30T05:02:37Z","author_association":"COLLABORATOR","body":"Thank you @mfinean for the suggestion, the latest version of the code on master should now work! ","reactions":{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/569584384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Naireen","id":13244787,"node_id":"MDQ6VXNlcjEzMjQ0Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/13244787?v=4","gravatar_id":"","url":"https://api.github.com/users/Naireen","html_url":"https://github.com/Naireen","followers_url":"https://api.github.com/users/Naireen/followers","following_url":"https://api.github.com/users/Naireen/following{/other_user}","gists_url":"https://api.github.com/users/Naireen/gists{/gist_id}","starred_url":"https://api.github.com/users/Naireen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Naireen/subscriptions","organizations_url":"https://api.github.com/users/Naireen/orgs","repos_url":"https://api.github.com/users/Naireen/repos","events_url":"https://api.github.com/users/Naireen/events{/privacy}","received_events_url":"https://api.github.com/users/Naireen/received_events","type":"User","site_admin":false}},{"id":2913200148,"node_id":"MDExOkNsb3NlZEV2ZW50MjkxMzIwMDE0OA==","url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/events/2913200148","actor":{"login":"Naireen","id":13244787,"node_id":"MDQ6VXNlcjEzMjQ0Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/13244787?v=4","gravatar_id":"","url":"https://api.github.com/users/Naireen","html_url":"https://github.com/Naireen","followers_url":"https://api.github.com/users/Naireen/followers","following_url":"https://api.github.com/users/Naireen/following{/other_user}","gists_url":"https://api.github.com/users/Naireen/gists{/gist_id}","starred_url":"https://api.github.com/users/Naireen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Naireen/subscriptions","organizations_url":"https://api.github.com/users/Naireen/orgs","repos_url":"https://api.github.com/users/Naireen/repos","events_url":"https://api.github.com/users/Naireen/events{/privacy}","received_events_url":"https://api.github.com/users/Naireen/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-12-30T05:02:37Z","state_reason":null,"performed_via_github_app":null},{"id":2913200152,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjkxMzIwMDE1Mg==","url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/events/2913200152","actor":{"login":"mfinean","id":33692727,"node_id":"MDQ6VXNlcjMzNjkyNzI3","avatar_url":"https://avatars.githubusercontent.com/u/33692727?v=4","gravatar_id":"","url":"https://api.github.com/users/mfinean","html_url":"https://github.com/mfinean","followers_url":"https://api.github.com/users/mfinean/followers","following_url":"https://api.github.com/users/mfinean/following{/other_user}","gists_url":"https://api.github.com/users/mfinean/gists{/gist_id}","starred_url":"https://api.github.com/users/mfinean/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mfinean/subscriptions","organizations_url":"https://api.github.com/users/mfinean/orgs","repos_url":"https://api.github.com/users/mfinean/repos","events_url":"https://api.github.com/users/mfinean/events{/privacy}","received_events_url":"https://api.github.com/users/mfinean/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-12-30T05:02:37Z","performed_via_github_app":null},{"id":2913200154,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI5MTMyMDAxNTQ=","url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/events/2913200154","actor":{"login":"mfinean","id":33692727,"node_id":"MDQ6VXNlcjMzNjkyNzI3","avatar_url":"https://avatars.githubusercontent.com/u/33692727?v=4","gravatar_id":"","url":"https://api.github.com/users/mfinean","html_url":"https://github.com/mfinean","followers_url":"https://api.github.com/users/mfinean/followers","following_url":"https://api.github.com/users/mfinean/following{/other_user}","gists_url":"https://api.github.com/users/mfinean/gists{/gist_id}","starred_url":"https://api.github.com/users/mfinean/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mfinean/subscriptions","organizations_url":"https://api.github.com/users/mfinean/orgs","repos_url":"https://api.github.com/users/mfinean/repos","events_url":"https://api.github.com/users/mfinean/events{/privacy}","received_events_url":"https://api.github.com/users/mfinean/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-12-30T05:02:37Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/1353906640","html_url":"https://github.com/sksq96/pytorch-summary/issues/90#issuecomment-1353906640","issue_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/90","id":1353906640,"node_id":"IC_kwDOB8pl4c5QsvnQ","user":{"login":"shuboyang","id":114553962,"node_id":"U_kgDOBtP0ag","avatar_url":"https://avatars.githubusercontent.com/u/114553962?v=4","gravatar_id":"","url":"https://api.github.com/users/shuboyang","html_url":"https://github.com/shuboyang","followers_url":"https://api.github.com/users/shuboyang/followers","following_url":"https://api.github.com/users/shuboyang/following{/other_user}","gists_url":"https://api.github.com/users/shuboyang/gists{/gist_id}","starred_url":"https://api.github.com/users/shuboyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shuboyang/subscriptions","organizations_url":"https://api.github.com/users/shuboyang/orgs","repos_url":"https://api.github.com/users/shuboyang/repos","events_url":"https://api.github.com/users/shuboyang/events{/privacy}","received_events_url":"https://api.github.com/users/shuboyang/received_events","type":"User","site_admin":false},"created_at":"2022-12-16T00:04:14Z","updated_at":"2022-12-16T00:04:14Z","author_association":"NONE","body":"Amazing! That really works!","reactions":{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/comments/1353906640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"shuboyang","id":114553962,"node_id":"U_kgDOBtP0ag","avatar_url":"https://avatars.githubusercontent.com/u/114553962?v=4","gravatar_id":"","url":"https://api.github.com/users/shuboyang","html_url":"https://github.com/shuboyang","followers_url":"https://api.github.com/users/shuboyang/followers","following_url":"https://api.github.com/users/shuboyang/following{/other_user}","gists_url":"https://api.github.com/users/shuboyang/gists{/gist_id}","starred_url":"https://api.github.com/users/shuboyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shuboyang/subscriptions","organizations_url":"https://api.github.com/users/shuboyang/orgs","repos_url":"https://api.github.com/users/shuboyang/repos","events_url":"https://api.github.com/users/shuboyang/events{/privacy}","received_events_url":"https://api.github.com/users/shuboyang/received_events","type":"User","site_admin":false}}]