{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/186","repository_url":"https://api.github.com/repos/sksq96/pytorch-summary","labels_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/186/labels{/name}","comments_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/186/comments","events_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/186/events","html_url":"https://github.com/sksq96/pytorch-summary/issues/186","id":1241915215,"node_id":"I_kwDOB8pl4c5KBh9P","number":186,"title":"AttributeError: 'BertForSequenceClassification' object has no attribute 'layers'","user":{"login":"furkaano","id":62816021,"node_id":"MDQ6VXNlcjYyODE2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/62816021?v=4","gravatar_id":"","url":"https://api.github.com/users/furkaano","html_url":"https://github.com/furkaano","followers_url":"https://api.github.com/users/furkaano/followers","following_url":"https://api.github.com/users/furkaano/following{/other_user}","gists_url":"https://api.github.com/users/furkaano/gists{/gist_id}","starred_url":"https://api.github.com/users/furkaano/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/furkaano/subscriptions","organizations_url":"https://api.github.com/users/furkaano/orgs","repos_url":"https://api.github.com/users/furkaano/repos","events_url":"https://api.github.com/users/furkaano/events{/privacy}","received_events_url":"https://api.github.com/users/furkaano/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-05-19T14:55:56Z","updated_at":"2022-05-21T12:14:07Z","closed_at":"2022-05-21T12:14:07Z","author_association":"NONE","active_lock_reason":null,"body":"```\r\nfrom tensorflow.keras.initializers import TruncatedNormal\r\nfrom tensorflow.keras.layers import Input, Dropout, Dense\r\nfrom tensorflow.keras.losses import BinaryCrossentropy\r\nfrom tensorflow.keras.metrics import AUC\r\nfrom tensorflow.keras.models import Model\r\nfrom tensorflow.keras.optimizers import Adam\r\n\r\ntransformer_model = BertForSequenceClassification.from_pretrained(\r\n                                                                MODEL_NAME, \r\n                                                                output_hidden_states=False\r\n                                                                )\r\n\r\nbert = transformer_model.layers[0]\r\n\r\ninput_ids = Input(shape=(MAX_LENGTH,), \r\n                  name='input_ids', \r\n                  dtype='int32')\r\ninputs = {'input_ids': input_ids}\r\n\r\nbert_model = bert(inputs)[0][:, 0, :] \r\n\r\ndropout = Dropout(config.dropout, name='pooled_output')\r\npooled_output = dropout(bert_model, training=False)\r\noutput = Dense(\r\n    units=train_labels.shape[1],\r\n    kernel_initializer=TruncatedNormal(stddev=config.initializer_range), \r\n    activation=\"sigmoid\",  # Choose a sigmoid for multi-label classification\r\n    name='output'\r\n)(pooled_output)\r\n\r\nmodel = Model(inputs=inputs, \r\n              outputs=output, \r\n              name='BERT_MultiLabel')\r\nmodel.summary()\r\n```\r\n\r\nI'm trying to multi-label classification by using Bert and Tensorflow. But I've a problem after I run that code. The output shows that \r\n\r\n```\r\nSome weights of the model checkpoint at dbmdz/bert-base-turkish-128k-cased were not used when initializing BertForSequenceClassification: ['cls.seq_relationship.bias', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.bias', 'cls.seq_relationship.weight']\r\n- This IS expected if you are initializing BertForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\r\n- This IS NOT expected if you are initializing BertForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\r\nSome weights of BertForSequenceClassification were not initialized from the model checkpoint at dbmdz/bert-base-turkish-128k-cased and are newly initialized: ['classifier.weight', 'classifier.bias']\r\nYou should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\nInput In [63], in <module>\r\n      6 from tensorflow.keras.optimizers import Adam\r\n      8 transformer_model = BertForSequenceClassification.from_pretrained(\r\n      9                                                                 MODEL_NAME, \r\n     10                                                                 output_hidden_states=False\r\n     11                                                                 )\r\n---> 13 bert = transformer_model.layers[0]\r\n     16 input_ids = Input(shape=(MAX_LENGTH,), \r\n     17                   name='input_ids', \r\n     18                   dtype='int32')\r\n\r\nFile ~\\AppData\\Roaming\\Python\\Python39\\site-packages\\torch\\nn\\modules\\module.py:1177, in Module.__getattr__(self, name)\r\n   1175     if name in modules:\r\n   1176         return modules[name]\r\n-> 1177 raise AttributeError(\"'{}' object has no attribute '{}'\".format(\r\n   1178     type(self).__name__, name))\r\n\r\nAttributeError: 'BertForSequenceClassification' object has no attribute layers\r\n```\r\n\r\n**What should I do at this point ?** ","closed_by":{"login":"furkaano","id":62816021,"node_id":"MDQ6VXNlcjYyODE2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/62816021?v=4","gravatar_id":"","url":"https://api.github.com/users/furkaano","html_url":"https://github.com/furkaano","followers_url":"https://api.github.com/users/furkaano/followers","following_url":"https://api.github.com/users/furkaano/following{/other_user}","gists_url":"https://api.github.com/users/furkaano/gists{/gist_id}","starred_url":"https://api.github.com/users/furkaano/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/furkaano/subscriptions","organizations_url":"https://api.github.com/users/furkaano/orgs","repos_url":"https://api.github.com/users/furkaano/repos","events_url":"https://api.github.com/users/furkaano/events{/privacy}","received_events_url":"https://api.github.com/users/furkaano/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/186/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/186/timeline","performed_via_github_app":null,"state_reason":"completed"}