{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/127","repository_url":"https://api.github.com/repos/sksq96/pytorch-summary","labels_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/127/labels{/name}","comments_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/127/comments","events_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/127/events","html_url":"https://github.com/sksq96/pytorch-summary/issues/127","id":596032860,"node_id":"MDU6SXNzdWU1OTYwMzI4NjA=","number":127,"title":"Parameters being calculated using forward pass","user":{"login":"praneet195","id":14840749,"node_id":"MDQ6VXNlcjE0ODQwNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/14840749?v=4","gravatar_id":"","url":"https://api.github.com/users/praneet195","html_url":"https://github.com/praneet195","followers_url":"https://api.github.com/users/praneet195/followers","following_url":"https://api.github.com/users/praneet195/following{/other_user}","gists_url":"https://api.github.com/users/praneet195/gists{/gist_id}","starred_url":"https://api.github.com/users/praneet195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/praneet195/subscriptions","organizations_url":"https://api.github.com/users/praneet195/orgs","repos_url":"https://api.github.com/users/praneet195/repos","events_url":"https://api.github.com/users/praneet195/events{/privacy}","received_events_url":"https://api.github.com/users/praneet195/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-04-07T17:28:00Z","updated_at":"2020-04-18T21:29:33Z","closed_at":"2020-04-18T21:29:33Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\r\n\r\nSo, I found this issue and I think it's slightly misleading. Torchsummary uses a forward pass to determine layer structure and calculate parameters. Hence, if there is a for loop in the forward pass there is an issue.\r\n```\r\ndef __init__: \r\n                self.conv1 = nn.Conv2d(x,y,z)\r\ndef forward(self,x):\r\n                for i in range(5):\r\n                    x = self.conv1(x)\r\n```\r\nAs seen from the above snippet, I'm passing through the same layer again and again.\r\nTorchsummary in this case will say that there are 5 layers (report 5 times the parameters) instead of 1 layer being cycled again and again. \r\nAlthough this is wrong code and goes against the concept of Neural Nets being Direct Acyclic Graphs, I hope there is some sort of check  in place to ensure the correct structure of the network created and parameters counted.\r\n5 layers should only be reported when I use this:\r\n```\r\ndef __init__:\r\n        self.conv1 = nn.ModuleList([nn.Conv2d(x,y,z) for _ in range(5)])\r\ndef forward(self,x):\r\n        for i in self.conv1:\r\n               x = self.conv1(x)\r\n```\r\nHere, I've created 5 new layers and torchsummary prints the correct result but it should not print this type of result in the previous case\r\n\r\n\r\n","closed_by":{"login":"praneet195","id":14840749,"node_id":"MDQ6VXNlcjE0ODQwNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/14840749?v=4","gravatar_id":"","url":"https://api.github.com/users/praneet195","html_url":"https://github.com/praneet195","followers_url":"https://api.github.com/users/praneet195/followers","following_url":"https://api.github.com/users/praneet195/following{/other_user}","gists_url":"https://api.github.com/users/praneet195/gists{/gist_id}","starred_url":"https://api.github.com/users/praneet195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/praneet195/subscriptions","organizations_url":"https://api.github.com/users/praneet195/orgs","repos_url":"https://api.github.com/users/praneet195/repos","events_url":"https://api.github.com/users/praneet195/events{/privacy}","received_events_url":"https://api.github.com/users/praneet195/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/127/timeline","performed_via_github_app":null,"state_reason":"completed"}