{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/68","repository_url":"https://api.github.com/repos/sksq96/pytorch-summary","labels_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/68/labels{/name}","comments_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/68/comments","events_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/68/events","html_url":"https://github.com/sksq96/pytorch-summary/issues/68","id":442999318,"node_id":"MDU6SXNzdWU0NDI5OTkzMTg=","number":68,"title":"can not use for inception block","user":{"login":"yuwl798180","id":18118119,"node_id":"MDQ6VXNlcjE4MTE4MTE5","avatar_url":"https://avatars.githubusercontent.com/u/18118119?v=4","gravatar_id":"","url":"https://api.github.com/users/yuwl798180","html_url":"https://github.com/yuwl798180","followers_url":"https://api.github.com/users/yuwl798180/followers","following_url":"https://api.github.com/users/yuwl798180/following{/other_user}","gists_url":"https://api.github.com/users/yuwl798180/gists{/gist_id}","starred_url":"https://api.github.com/users/yuwl798180/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yuwl798180/subscriptions","organizations_url":"https://api.github.com/users/yuwl798180/orgs","repos_url":"https://api.github.com/users/yuwl798180/repos","events_url":"https://api.github.com/users/yuwl798180/events{/privacy}","received_events_url":"https://api.github.com/users/yuwl798180/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-05-11T14:30:28Z","updated_at":"2019-05-11T14:32:54Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"my inception net such as below:\r\n\r\n```python\r\nclass InceptionA(nn.Module):\r\n    def __init__(self, in_channels):\r\n        super(InceptionA, self).__init__()\r\n        self.branch1x1 = nn.Conv2d(in_channels, 16, kernel_size=1)\r\n\r\n        self.branch5x5_1 = nn.Conv2d(in_channels, 16, kernel_size=1)\r\n        self.branch5x5_2 = nn.Conv2d(16, 24, kernel_size=5, padding=2)\r\n\r\n        self.branch3x3dbl_1 = nn.Conv2d(in_channels, 16, kernel_size=1)\r\n        self.branch3x3dbl_2 = nn.Conv2d(16, 24, kernel_size=3, padding=1)\r\n        self.branch3x3dbl_3 = nn.Conv2d(24, 24, kernel_size=3, padding=1)\r\n\r\n        self.branch_pool = nn.Conv2d(in_channels, 24, kernel_size=1)\r\n\r\n    def forward(self, x):\r\n        branch1x1 = self.branch1x1(x)\r\n\r\n        branch5x5 = self.branch5x5_1(x)\r\n        branch5x5 = self.branch5x5_2(branch5x5)\r\n\r\n        branch3x3dbl = self.branch3x3dbl_1(x)\r\n        branch3x3dbl = self.branch3x3dbl_2(branch3x3dbl)\r\n        branch3x3dbl = self.branch3x3dbl_3(branch3x3dbl)\r\n\r\n        branch_pool = F.avg_pool2d(x, kernel_size=3, stride=1, padding=1)\r\n        branch_pool = self.branch_pool(branch_pool)\r\n\r\n        outputs = [branch1x1, branch5x5, branch3x3dbl, branch_pool]\r\n        return torch.cat(outputs, 1)\r\n\r\n\r\nclass Net(nn.Module):\r\n    def __init__(self):\r\n        super(Net, self).__init__()\r\n        self.conv1 = nn.Conv2d(1, 10, kernel_size=5)\r\n        self.conv2 = nn.Conv2d(88, 20, kernel_size=5)\r\n\r\n        self.incept1 = InceptionA(in_channels=10)\r\n        self.incept2 = InceptionA(in_channels=20)\r\n\r\n        self.mp = nn.MaxPool2d(2)\r\n        self.fc = nn.Linear(1408, 10)\r\n\r\n    def forward(self, x):\r\n        in_size = x.size(0)  # 64\r\n        x = F.relu(self.mp(self.conv1(x)))\r\n        x = self.incept1(x)\r\n        x = F.relu(self.mp(self.conv2(x)))\r\n        x = self.incept2(x)\r\n        x = x.view(in_size, -1)  # flatten the tensor\r\n        x = self.fc(x)\r\n        return F.log_softmax(x)\r\n\r\n\r\nmodel = Net()\r\n\r\nsummary(model, input_size=(1, 28, 28))\r\n```\r\n\r\nuse mnist data for this network, this program works good.\r\nbut summary can not work, with the error message:\r\n\r\n```\r\nRuntimeError: size mismatch, m1: [2 x 2200], m2: [1408 x 10] at /Users/distiller/project/conda/conda-bld/pytorch_1556653464916/work/aten/src/TH/generic/THTensorMath.cpp:961\r\n```\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/68/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/68/timeline","performed_via_github_app":null,"state_reason":null}