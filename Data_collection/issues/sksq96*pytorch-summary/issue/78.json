{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/78","repository_url":"https://api.github.com/repos/sksq96/pytorch-summary","labels_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/78/labels{/name}","comments_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/78/comments","events_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/78/events","html_url":"https://github.com/sksq96/pytorch-summary/issues/78","id":463937964,"node_id":"MDU6SXNzdWU0NjM5Mzc5NjQ=","number":78,"title":"Crash on custom module with Parameter","user":{"login":"jvanheugten","id":12444498,"node_id":"MDQ6VXNlcjEyNDQ0NDk4","avatar_url":"https://avatars.githubusercontent.com/u/12444498?v=4","gravatar_id":"","url":"https://api.github.com/users/jvanheugten","html_url":"https://github.com/jvanheugten","followers_url":"https://api.github.com/users/jvanheugten/followers","following_url":"https://api.github.com/users/jvanheugten/following{/other_user}","gists_url":"https://api.github.com/users/jvanheugten/gists{/gist_id}","starred_url":"https://api.github.com/users/jvanheugten/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jvanheugten/subscriptions","organizations_url":"https://api.github.com/users/jvanheugten/orgs","repos_url":"https://api.github.com/users/jvanheugten/repos","events_url":"https://api.github.com/users/jvanheugten/events{/privacy}","received_events_url":"https://api.github.com/users/jvanheugten/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-07-03T20:25:48Z","updated_at":"2020-12-30T09:34:33Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I was trying to create a custom layer and check it with summary, however, it kept crashing.\r\nHere is a simple example for which the summary code crashes:\r\n```\r\nclass TestMod(nn.Module):\r\n    def __init__(self, input_size, attention_size, eps=0.0):\r\n        super().__init__()\r\n        self.weight = nn.Parameter(torch.Tensor(attention_size, input_size))\r\n        nn.init.kaiming_uniform_(self.weight, a=math.sqrt(5))\r\n\r\n    def forward(self, x):\r\n        return self.weight\r\ntest = TestMod(2,3)\r\nprint(list(test.named_parameters()))\r\ntorchsummary.summary(test, [[2]])\r\n```\r\nOutput:\r\n```\r\n[('weight', Parameter containing:\r\ntensor([[-0.7039, -0.1902],\r\n        [-0.3078, -0.1418],\r\n        [-0.4269, -0.4219]], requires_grad=True))]\r\n----------------------------------------------------------------\r\n        Layer (type)               Output Shape         Param #\r\n================================================================\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-161-ff76d1f01e72> in <module>\r\n      9 test = TestMod(2,3)\r\n     10 print(list(test.named_parameters()))\r\n---> 11 torchsummary.summary(test, [[2]])\r\n\r\n~/miniconda3/lib/python3.6/site-packages/torchsummary/torchsummary.py in summary(model, input_size, batch_size, device)\r\n    100     total_input_size = abs(np.prod(input_size) * batch_size * 4. / (1024 ** 2.))\r\n    101     total_output_size = abs(2. * total_output * 4. / (1024 ** 2.))  # x2 for gradients\r\n--> 102     total_params_size = abs(total_params.numpy() * 4. / (1024 ** 2.))\r\n    103     total_size = total_params_size + total_output_size + total_input_size\r\n    104 \r\n\r\nAttributeError: 'int' object has no attribute 'numpy'\r\n```","closed_by":null,"reactions":{"url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/78/reactions","total_count":15,"+1":15,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sksq96/pytorch-summary/issues/78/timeline","performed_via_github_app":null,"state_reason":null}