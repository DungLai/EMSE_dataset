[{"url":"https://api.github.com/repos/brendanhasz/probflow/issues/comments/652852562","html_url":"https://github.com/brendanhasz/probflow/issues/15#issuecomment-652852562","issue_url":"https://api.github.com/repos/brendanhasz/probflow/issues/15","id":652852562,"node_id":"MDEyOklzc3VlQ29tbWVudDY1Mjg1MjU2Mg==","user":{"login":"brendanhasz","id":3465846,"node_id":"MDQ6VXNlcjM0NjU4NDY=","avatar_url":"https://avatars.githubusercontent.com/u/3465846?v=4","gravatar_id":"","url":"https://api.github.com/users/brendanhasz","html_url":"https://github.com/brendanhasz","followers_url":"https://api.github.com/users/brendanhasz/followers","following_url":"https://api.github.com/users/brendanhasz/following{/other_user}","gists_url":"https://api.github.com/users/brendanhasz/gists{/gist_id}","starred_url":"https://api.github.com/users/brendanhasz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brendanhasz/subscriptions","organizations_url":"https://api.github.com/users/brendanhasz/orgs","repos_url":"https://api.github.com/users/brendanhasz/repos","events_url":"https://api.github.com/users/brendanhasz/events{/privacy}","received_events_url":"https://api.github.com/users/brendanhasz/received_events","type":"User","site_admin":false},"created_at":"2020-07-02T08:01:53Z","updated_at":"2020-07-02T08:01:53Z","author_association":"OWNER","body":"Hi!  Sorry for the late reply.  From that error message I'd guess that your test data (`xx_test`) has a `float64` datatype, but probflow's default datatype is `float32` (and so all the weight and bias parameters were `float32` tensors), so TensorFlow threw a hissy fit when it tried to do an operation with two tensors of different datatypes.\r\n\r\nAssuming your `xx_test` is a numpy array, this should work:\r\n\r\n```python\r\nlb, ub = model.predictive_interval(xx_test.astype('float32'), ci=0.95)\r\n```\r\n\r\nAlternatively you could change the default datatype used by probflow to be `float64` (though I figure variational inference is already super noisy as it is, so do we _really_ need all that extra precision? Thus the choice of a default datatype of float32.  I.e. I'd gently discourange this 2nd option both because it's more complicated and because it's probably wicked overkill haha):\r\n\r\n```python\r\n# x_train, y_train, and x_test are all float64\r\n\r\n# Set the default datatype used by probflow\r\n# note that this must be done before initializing and fitting  the model\r\npf.set_datatype(tf.dtypes.float64)\r\n\r\nmodel = DenseRegression([1, 32, 32, 1])\r\nmodel.fit(x_train, y_train)\r\nlb, ub = model.predictive_interval(x_test, ci=0.95)\r\n```\r\n\r\nAnd sorry, I definitely should have included a discussion of datatypes and how to set the default datatype in the user guide, but I hadn't gotten around to it ðŸ˜¬  I've added it [here](https://probflow.readthedocs.io/en/latest/ug_backend.html)!\r\n\r\nHope that helps!","reactions":{"url":"https://api.github.com/repos/brendanhasz/probflow/issues/comments/652852562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"brendanhasz","id":3465846,"node_id":"MDQ6VXNlcjM0NjU4NDY=","avatar_url":"https://avatars.githubusercontent.com/u/3465846?v=4","gravatar_id":"","url":"https://api.github.com/users/brendanhasz","html_url":"https://github.com/brendanhasz","followers_url":"https://api.github.com/users/brendanhasz/followers","following_url":"https://api.github.com/users/brendanhasz/following{/other_user}","gists_url":"https://api.github.com/users/brendanhasz/gists{/gist_id}","starred_url":"https://api.github.com/users/brendanhasz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brendanhasz/subscriptions","organizations_url":"https://api.github.com/users/brendanhasz/orgs","repos_url":"https://api.github.com/users/brendanhasz/repos","events_url":"https://api.github.com/users/brendanhasz/events{/privacy}","received_events_url":"https://api.github.com/users/brendanhasz/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/brendanhasz/probflow/issues/comments/652889695","html_url":"https://github.com/brendanhasz/probflow/issues/15#issuecomment-652889695","issue_url":"https://api.github.com/repos/brendanhasz/probflow/issues/15","id":652889695,"node_id":"MDEyOklzc3VlQ29tbWVudDY1Mjg4OTY5NQ==","user":{"login":"gerardcelio","id":16068356,"node_id":"MDQ6VXNlcjE2MDY4MzU2","avatar_url":"https://avatars.githubusercontent.com/u/16068356?v=4","gravatar_id":"","url":"https://api.github.com/users/gerardcelio","html_url":"https://github.com/gerardcelio","followers_url":"https://api.github.com/users/gerardcelio/followers","following_url":"https://api.github.com/users/gerardcelio/following{/other_user}","gists_url":"https://api.github.com/users/gerardcelio/gists{/gist_id}","starred_url":"https://api.github.com/users/gerardcelio/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gerardcelio/subscriptions","organizations_url":"https://api.github.com/users/gerardcelio/orgs","repos_url":"https://api.github.com/users/gerardcelio/repos","events_url":"https://api.github.com/users/gerardcelio/events{/privacy}","received_events_url":"https://api.github.com/users/gerardcelio/received_events","type":"User","site_admin":false},"created_at":"2020-07-02T09:12:43Z","updated_at":"2020-07-02T09:12:43Z","author_association":"NONE","body":"Works like a charm, thanks!\r\n","reactions":{"url":"https://api.github.com/repos/brendanhasz/probflow/issues/comments/652889695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gerardcelio","id":16068356,"node_id":"MDQ6VXNlcjE2MDY4MzU2","avatar_url":"https://avatars.githubusercontent.com/u/16068356?v=4","gravatar_id":"","url":"https://api.github.com/users/gerardcelio","html_url":"https://github.com/gerardcelio","followers_url":"https://api.github.com/users/gerardcelio/followers","following_url":"https://api.github.com/users/gerardcelio/following{/other_user}","gists_url":"https://api.github.com/users/gerardcelio/gists{/gist_id}","starred_url":"https://api.github.com/users/gerardcelio/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gerardcelio/subscriptions","organizations_url":"https://api.github.com/users/gerardcelio/orgs","repos_url":"https://api.github.com/users/gerardcelio/repos","events_url":"https://api.github.com/users/gerardcelio/events{/privacy}","received_events_url":"https://api.github.com/users/gerardcelio/received_events","type":"User","site_admin":false}},{"id":3506156471,"node_id":"MDExOkNsb3NlZEV2ZW50MzUwNjE1NjQ3MQ==","url":"https://api.github.com/repos/brendanhasz/probflow/issues/events/3506156471","actor":{"login":"gerardcelio","id":16068356,"node_id":"MDQ6VXNlcjE2MDY4MzU2","avatar_url":"https://avatars.githubusercontent.com/u/16068356?v=4","gravatar_id":"","url":"https://api.github.com/users/gerardcelio","html_url":"https://github.com/gerardcelio","followers_url":"https://api.github.com/users/gerardcelio/followers","following_url":"https://api.github.com/users/gerardcelio/following{/other_user}","gists_url":"https://api.github.com/users/gerardcelio/gists{/gist_id}","starred_url":"https://api.github.com/users/gerardcelio/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gerardcelio/subscriptions","organizations_url":"https://api.github.com/users/gerardcelio/orgs","repos_url":"https://api.github.com/users/gerardcelio/repos","events_url":"https://api.github.com/users/gerardcelio/events{/privacy}","received_events_url":"https://api.github.com/users/gerardcelio/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-07-02T09:12:45Z","state_reason":null,"performed_via_github_app":null}]