{"url":"https://api.github.com/repos/brendanhasz/probflow/issues/6","repository_url":"https://api.github.com/repos/brendanhasz/probflow","labels_url":"https://api.github.com/repos/brendanhasz/probflow/issues/6/labels{/name}","comments_url":"https://api.github.com/repos/brendanhasz/probflow/issues/6/comments","events_url":"https://api.github.com/repos/brendanhasz/probflow/issues/6/events","html_url":"https://github.com/brendanhasz/probflow/issues/6","id":512521881,"node_id":"MDU6SXNzdWU1MTI1MjE4ODE=","number":6,"title":"Maximum Recursion Depth error in modules.py","user":{"login":"arainboldt","id":54881218,"node_id":"MDQ6VXNlcjU0ODgxMjE4","avatar_url":"https://avatars.githubusercontent.com/u/54881218?v=4","gravatar_id":"","url":"https://api.github.com/users/arainboldt","html_url":"https://github.com/arainboldt","followers_url":"https://api.github.com/users/arainboldt/followers","following_url":"https://api.github.com/users/arainboldt/following{/other_user}","gists_url":"https://api.github.com/users/arainboldt/gists{/gist_id}","starred_url":"https://api.github.com/users/arainboldt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arainboldt/subscriptions","organizations_url":"https://api.github.com/users/arainboldt/orgs","repos_url":"https://api.github.com/users/arainboldt/repos","events_url":"https://api.github.com/users/arainboldt/events{/privacy}","received_events_url":"https://api.github.com/users/arainboldt/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-10-25T13:37:42Z","updated_at":"2019-10-26T10:24:52Z","closed_at":"2019-10-26T10:21:05Z","author_association":"NONE","active_lock_reason":null,"body":"Hi Brendan,\r\n\r\nIn further experimentation I'm encountering the following error. The code I'm using is a bit more involved, but I can provide it if the issue it would help.  Any ideas where to start? What is the purpose of the Module listing where the error occurs?\r\n\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nRecursionError                            Traceback (most recent call last)\r\n<ipython-input-12-271ef7ecd1c9> in <module>\r\n----> 1 model.G.fit(dataset.X.values)\r\n\r\n~/virtualenvs/tf2/lib/python3.7/site-packages/probflow/models.py in fit(self, x, y, batch_size, epochs, shuffle, optimizer, optimizer_kwargs, learning_rate, flipout, callbacks)\r\n    256             # Update gradients for each batch\r\n    257             for x_data, y_data in self._data:\r\n--> 258                 self.train_step(x_data, y_data)\r\n    259 \r\n    260             # Run callbacks at end of epoch\r\n\r\n~/virtualenvs/tf2/lib/python3.7/site-packages/probflow/models.py in train_step(self, x_data, y_data)\r\n    161     def train_step(self, x_data, y_data):\r\n    162         \"\"\"Perform one training step\"\"\"\r\n--> 163         self._train_fn(x_data, y_data)\r\n    164 \r\n    165 \r\n\r\n~/virtualenvs/tf2/lib/python3.7/site-packages/probflow/models.py in train_step(x_data, y_data)\r\n    139         def train_step(x_data, y_data):\r\n    140             nb = y_data.shape[0] #number of samples in this batch\r\n--> 141             self.reset_kl_loss()\r\n    142             with Sampling(n=1, flipout=flipout):\r\n    143                 with tf.GradientTape() as tape:\r\n\r\n~/virtualenvs/tf2/lib/python3.7/site-packages/probflow/modules.py in reset_kl_loss(self)\r\n    109     def reset_kl_loss(self):\r\n    110         \"\"\"Reset additional loss due to KL divergences\"\"\"\r\n--> 111         for m in self.modules:\r\n    112             m._kl_losses = []\r\n    113 \r\n\r\n~/virtualenvs/tf2/lib/python3.7/site-packages/probflow/modules.py in modules(self)\r\n     81     def modules(self):\r\n     82         \"\"\"A list of sub-Modules in this |Module|, including itself.\"\"\"\r\n---> 83         return [m for a in vars(self).values()\r\n     84                 if isinstance(a, BaseModule)\r\n     85                 for m in a.modules] + [self]\r\n\r\n~/virtualenvs/tf2/lib/python3.7/site-packages/probflow/modules.py in <listcomp>(.0)\r\n     83         return [m for a in vars(self).values()\r\n     84                 if isinstance(a, BaseModule)\r\n---> 85                 for m in a.modules] + [self]\r\n     86 \r\n     87 \r\n\r\n... last 2 frames repeated, from the frame below ...\r\n\r\n~/virtualenvs/tf2/lib/python3.7/site-packages/probflow/modules.py in modules(self)\r\n     81     def modules(self):\r\n     82         \"\"\"A list of sub-Modules in this |Module|, including itself.\"\"\"\r\n---> 83         return [m for a in vars(self).values()\r\n     84                 if isinstance(a, BaseModule)\r\n     85                 for m in a.modules] + [self]\r\n\r\nRecursionError: maximum recursion depth exceeded in comparison\r\n```","closed_by":{"login":"arainboldt","id":54881218,"node_id":"MDQ6VXNlcjU0ODgxMjE4","avatar_url":"https://avatars.githubusercontent.com/u/54881218?v=4","gravatar_id":"","url":"https://api.github.com/users/arainboldt","html_url":"https://github.com/arainboldt","followers_url":"https://api.github.com/users/arainboldt/followers","following_url":"https://api.github.com/users/arainboldt/following{/other_user}","gists_url":"https://api.github.com/users/arainboldt/gists{/gist_id}","starred_url":"https://api.github.com/users/arainboldt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arainboldt/subscriptions","organizations_url":"https://api.github.com/users/arainboldt/orgs","repos_url":"https://api.github.com/users/arainboldt/repos","events_url":"https://api.github.com/users/arainboldt/events{/privacy}","received_events_url":"https://api.github.com/users/arainboldt/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/brendanhasz/probflow/issues/6/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/brendanhasz/probflow/issues/6/timeline","performed_via_github_app":null,"state_reason":"completed"}