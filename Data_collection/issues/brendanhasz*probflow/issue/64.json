{"url":"https://api.github.com/repos/brendanhasz/probflow/issues/64","repository_url":"https://api.github.com/repos/brendanhasz/probflow","labels_url":"https://api.github.com/repos/brendanhasz/probflow/issues/64/labels{/name}","comments_url":"https://api.github.com/repos/brendanhasz/probflow/issues/64/comments","events_url":"https://api.github.com/repos/brendanhasz/probflow/issues/64/events","html_url":"https://github.com/brendanhasz/probflow/issues/64","id":925657552,"node_id":"MDU6SXNzdWU5MjU2NTc1NTI=","number":64,"title":"Predictive interval fails for Dense model example","user":{"login":"edebrouwer","id":22655671,"node_id":"MDQ6VXNlcjIyNjU1Njcx","avatar_url":"https://avatars.githubusercontent.com/u/22655671?v=4","gravatar_id":"","url":"https://api.github.com/users/edebrouwer","html_url":"https://github.com/edebrouwer","followers_url":"https://api.github.com/users/edebrouwer/followers","following_url":"https://api.github.com/users/edebrouwer/following{/other_user}","gists_url":"https://api.github.com/users/edebrouwer/gists{/gist_id}","starred_url":"https://api.github.com/users/edebrouwer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edebrouwer/subscriptions","organizations_url":"https://api.github.com/users/edebrouwer/orgs","repos_url":"https://api.github.com/users/edebrouwer/repos","events_url":"https://api.github.com/users/edebrouwer/events{/privacy}","received_events_url":"https://api.github.com/users/edebrouwer/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-06-20T18:35:14Z","updated_at":"2021-06-21T05:38:02Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"\r\nHi, while trying to run the example of dense regression for fully connected NN, I run into an issue when I try to sample from the posterior of the model. I use exactly the commands as shown in the documentation.\r\n\r\nMy backend is pytorch,\r\n\r\nThank you so much !\r\n\r\n```\r\n# Compute 95% confidence intervals\r\nlb, ub = model.predictive_interval(x_test, ci=0.95, batch_size=1)\r\n\r\n# Plot em!\r\nplt.fill_between(x_test[:, 0], lb[:, 0], ub[:, 0],\r\n                 alpha=0.2, label='95% ci')\r\nplt.plot(x, y, '.', label='Data')```\r\n\r\n\r\nI get :\r\n\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-61-eb2905895d26> in <module>\r\n      3 \r\n      4 # Plot em!\r\n----> 5 plt.fill_between(x_test[:, 0], lb[:, 0], ub[:, 0],\r\n      6                  alpha=0.2, label='95% ci')\r\n      7 plt.plot(x, y, '.', label='Data')\r\n\r\n~/anaconda3/envs/causalode/lib/python3.8/site-packages/matplotlib/pyplot.py in fill_between(x, y1, y2, where, interpolate, step, data, **kwargs)\r\n   2636         x, y1, y2=0, where=None, interpolate=False, step=None, *,\r\n   2637         data=None, **kwargs):\r\n-> 2638     return gca().fill_between(\r\n   2639         x, y1, y2=y2, where=where, interpolate=interpolate, step=step,\r\n   2640         **({\"data\": data} if data is not None else {}), **kwargs)\r\n\r\n~/anaconda3/envs/causalode/lib/python3.8/site-packages/matplotlib/__init__.py in inner(ax, data, *args, **kwargs)\r\n   1445     def inner(ax, *args, data=None, **kwargs):\r\n   1446         if data is None:\r\n-> 1447             return func(ax, *map(sanitize_sequence, args), **kwargs)\r\n   1448 \r\n   1449         bound = new_sig.bind(ax, *args, **kwargs)\r\n\r\n~/anaconda3/envs/causalode/lib/python3.8/site-packages/matplotlib/axes/_axes.py in fill_between(self, x, y1, y2, where, interpolate, step, **kwargs)\r\n   5299     def fill_between(self, x, y1, y2=0, where=None, interpolate=False,\r\n   5300                      step=None, **kwargs):\r\n-> 5301         return self._fill_between_x_or_y(\r\n   5302             \"x\", x, y1, y2,\r\n   5303             where=where, interpolate=interpolate, step=step, **kwargs)\r\n\r\n~/anaconda3/envs/causalode/lib/python3.8/site-packages/matplotlib/axes/_axes.py in _fill_between_x_or_y(self, ind_dir, ind, dep1, dep2, where, interpolate, step, **kwargs)\r\n   5221                     f\"must have the same size as {ind} in {func_name}(). This \"\r\n   5222                     \"will become an error %(removal)s.\")\r\n-> 5223         where = where & ~functools.reduce(\r\n   5224             np.logical_or, map(np.ma.getmask, [ind, dep1, dep2]))\r\n   5225 \r\n\r\nValueError: operands could not be broadcast together with shapes (101,) (101000,) ","closed_by":null,"reactions":{"url":"https://api.github.com/repos/brendanhasz/probflow/issues/64/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/brendanhasz/probflow/issues/64/timeline","performed_via_github_app":null,"state_reason":null}