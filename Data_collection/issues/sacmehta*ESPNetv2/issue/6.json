{"url":"https://api.github.com/repos/sacmehta/ESPNetv2/issues/6","repository_url":"https://api.github.com/repos/sacmehta/ESPNetv2","labels_url":"https://api.github.com/repos/sacmehta/ESPNetv2/issues/6/labels{/name}","comments_url":"https://api.github.com/repos/sacmehta/ESPNetv2/issues/6/comments","events_url":"https://api.github.com/repos/sacmehta/ESPNetv2/issues/6/events","html_url":"https://github.com/sacmehta/ESPNetv2/issues/6","id":392973935,"node_id":"MDU6SXNzdWUzOTI5NzM5MzU=","number":6,"title":"RuntimeError: invalid argument 0: Sizes of tensors must match except in dimension 1. Got 136 and 135 in dimension 2 at /opt/conda/conda-bld/pytorch_1532581333611/work/aten/src/THC/generic/THCTensorMath.cu:87`","user":{"login":"tokyokuma","id":27120492,"node_id":"MDQ6VXNlcjI3MTIwNDky","avatar_url":"https://avatars.githubusercontent.com/u/27120492?v=4","gravatar_id":"","url":"https://api.github.com/users/tokyokuma","html_url":"https://github.com/tokyokuma","followers_url":"https://api.github.com/users/tokyokuma/followers","following_url":"https://api.github.com/users/tokyokuma/following{/other_user}","gists_url":"https://api.github.com/users/tokyokuma/gists{/gist_id}","starred_url":"https://api.github.com/users/tokyokuma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tokyokuma/subscriptions","organizations_url":"https://api.github.com/users/tokyokuma/orgs","repos_url":"https://api.github.com/users/tokyokuma/repos","events_url":"https://api.github.com/users/tokyokuma/events{/privacy}","received_events_url":"https://api.github.com/users/tokyokuma/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2018-12-20T10:09:11Z","updated_at":"2018-12-21T15:34:53Z","closed_at":"2018-12-21T15:34:53Z","author_association":"NONE","active_lock_reason":null,"body":"Thank you for developing ESPNet!\r\nI have three questions\r\n\r\n・ About labels to be ignored\r\nMy own dataset has 11 classes except the background. And we assigned 255 labels to the background.\r\nSo in Dataset.py and loaddata.py\r\nlabel_img [label_img == 255] = 19\r\nlabel_img [label_img == 255] = 11\r\nWritten and executed\r\nCUDA_VISIBLE_DEVICES = 0, 1, 2, 3 python main.py - data_dir ./izunuma - classes 11 - batch_size 10 - s 1.0\r\n\r\nLabels can take value between 0 and number of classes 10.\r\nYou have following values ​​as class labels:\r\n[0 1 11]\r\nSome problem with labels. Please check image file\r\n\r\nI encountered this error.\r\nTo solve this, include the background in the number of classes, assign 12 to the --classes argument The solution is correct.\r\n\r\n・About errors during learning\r\nI set the number of classes in the above method and started training, the following error occurred.\r\nImage size width 640 height 360\r\n~/github/ESPNetv2/segmentation$ CUDA_VISIBLE_DEVICES=0,1,2,3 python main.py --data_dir ./izunuma --classes 12 --batch_size 10 --s 1.0\r\nTotal network parameters: 338430\r\nData statistics\r\n[131.47914 144.9144  134.75436] [76.80522  68.83018  71.792274]\r\n[ 9.698015   9.98296    7.912603   8.275558   3.726631  10.492059\r\n 10.192185   4.4507203 10.4207115 10.338895  10.329051   1.9822153]\r\nLearning rate: 0.0005\r\nTraceback (most recent call last):\r\n  File \"main.py\", line 263, in <module>\r\n    trainValidateSegmentation(parser.parse_args())\r\n  File \"main.py\", line 200, in trainValidateSegmentation\r\n    train(args, trainLoader_scale1, model, criteria, optimizer, epoch)\r\n  File \"/home/nouki/github/ESPNetv2/segmentation/train_utils.py\", line 89, in train\r\n    output1, output2 = model(input)\r\n  File \"/home/nouki/.pyenv/versions/anaconda3-5.3.1/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 477, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/nouki/.pyenv/versions/anaconda3-5.3.1/lib/python3.6/site-packages/torch/nn/parallel/data_parallel.py\", line 121, in forward\r\n    return self.module(*inputs[0], **kwargs[0])\r\n  File \"/home/nouki/.pyenv/versions/anaconda3-5.3.1/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 477, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/nouki/github/ESPNetv2/segmentation/cnn/SegmentationModel.py\", line 62, in forward\r\n    merge_l2 = self.project_l2(torch.cat([out_l2, out_up_l3], 1))\r\nRuntimeError: invalid argument 0: Sizes of tensors must match except in dimension 1. Got 136 and 135 in dimension 2 at /opt/conda/conda-bld/pytorch_1532581333611/work/aten/src/THC/generic/THCTensorMath.cu:87\r\n\r\nI have not had time to learn pytorch, so I did not know what this error means by examining.\r\n\r\n\r\n・Code mistake?\r\nPerhaps the code of this part is wrong\r\nloadData.py line 41\r\nlabel_img [label_img = 255] = 19\r\n↓\r\nlabel_img [label_img == 255] = 19\r\n\r\nDataSet.py\r\nlabel [label = 255] = 19\r\n↓\r\nlabel [label == 255] = 19\r\n\r\nThank you!\r\n","closed_by":{"login":"sacmehta","id":18603245,"node_id":"MDQ6VXNlcjE4NjAzMjQ1","avatar_url":"https://avatars.githubusercontent.com/u/18603245?v=4","gravatar_id":"","url":"https://api.github.com/users/sacmehta","html_url":"https://github.com/sacmehta","followers_url":"https://api.github.com/users/sacmehta/followers","following_url":"https://api.github.com/users/sacmehta/following{/other_user}","gists_url":"https://api.github.com/users/sacmehta/gists{/gist_id}","starred_url":"https://api.github.com/users/sacmehta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sacmehta/subscriptions","organizations_url":"https://api.github.com/users/sacmehta/orgs","repos_url":"https://api.github.com/users/sacmehta/repos","events_url":"https://api.github.com/users/sacmehta/events{/privacy}","received_events_url":"https://api.github.com/users/sacmehta/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sacmehta/ESPNetv2/issues/6/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sacmehta/ESPNetv2/issues/6/timeline","performed_via_github_app":null,"state_reason":"completed"}