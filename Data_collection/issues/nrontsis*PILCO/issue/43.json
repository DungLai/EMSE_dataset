{"url":"https://api.github.com/repos/nrontsis/PILCO/issues/43","repository_url":"https://api.github.com/repos/nrontsis/PILCO","labels_url":"https://api.github.com/repos/nrontsis/PILCO/issues/43/labels{/name}","comments_url":"https://api.github.com/repos/nrontsis/PILCO/issues/43/comments","events_url":"https://api.github.com/repos/nrontsis/PILCO/issues/43/events","html_url":"https://github.com/nrontsis/PILCO/issues/43","id":605479490,"node_id":"MDU6SXNzdWU2MDU0Nzk0OTA=","number":43,"title":"calculate_factorizations question","user":{"login":"NicolayP","id":24211531,"node_id":"MDQ6VXNlcjI0MjExNTMx","avatar_url":"https://avatars.githubusercontent.com/u/24211531?v=4","gravatar_id":"","url":"https://api.github.com/users/NicolayP","html_url":"https://github.com/NicolayP","followers_url":"https://api.github.com/users/NicolayP/followers","following_url":"https://api.github.com/users/NicolayP/following{/other_user}","gists_url":"https://api.github.com/users/NicolayP/gists{/gist_id}","starred_url":"https://api.github.com/users/NicolayP/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NicolayP/subscriptions","organizations_url":"https://api.github.com/users/NicolayP/orgs","repos_url":"https://api.github.com/users/NicolayP/repos","events_url":"https://api.github.com/users/NicolayP/events{/privacy}","received_events_url":"https://api.github.com/users/NicolayP/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-04-23T12:07:52Z","updated_at":"2020-04-23T12:16:37Z","closed_at":"2020-04-23T12:16:37Z","author_association":"NONE","active_lock_reason":null,"body":"I'm a little confused with this following line. K has dimensions (target_dim * n * n) where n is the number of training points.\r\nline 71 [python](https://github.com/nrontsis/PILCO/blob/7125590afebd50e923b91669f65a70141b229a61/pilco/models/mgpr.py#L71)\r\n`L = tf.cholesky(K + self.noise[:, None, None]*batched_eye)`\r\nIn the reference paper and implementation, they do moment matching for every target dimension. \r\n\r\nline 50 [matlab](https://github.com/nrontsis/PILCO/blob/master/tests/Matlab%20Code/gp0.m#L50)\r\n\r\n`for i=1:E                                              % compute K and inv(K)`\r\n`    inp = bsxfun(@rdivide,gpmodel.inputs,exp(X(1:D,i)'));`\r\n`    K(:,:,i) = exp(2*X(D+1,i)-maha(inp,inp)/2);`\r\n`    if isfield(gpmodel,'nigp')`\r\n`      L = chol(K(:,:,i) + exp(2*X(D+2,i))*eye(n) + diag(gpmodel.nigp(:,i)))';`\r\n`    else        `\r\n`      L = chol(K(:,:,i) + exp(2*X(D+2,i))*eye(n))';`\r\n`    end`\r\n`    iK(:,:,i) = L'\\(L\\eye(n));`\r\n`    beta(:,i) = L'\\(L\\gpmodel.targets(:,i));`\r\n`  end`\r\n\r\nIs finding the inverse of K + noise for every target dimension the same a stacking the inverse of every target dimension computed inside the for loop? I know you tested the code but I'm still confused and couldn't find any information regarding the tensorflow cholesky decomposition and solution for tensors with more than \"3 dimension\". \r\n\r\nThe same question applies for the rest of the moment matching implementation.\r\n\r\nRegards\r\n","closed_by":{"login":"NicolayP","id":24211531,"node_id":"MDQ6VXNlcjI0MjExNTMx","avatar_url":"https://avatars.githubusercontent.com/u/24211531?v=4","gravatar_id":"","url":"https://api.github.com/users/NicolayP","html_url":"https://github.com/NicolayP","followers_url":"https://api.github.com/users/NicolayP/followers","following_url":"https://api.github.com/users/NicolayP/following{/other_user}","gists_url":"https://api.github.com/users/NicolayP/gists{/gist_id}","starred_url":"https://api.github.com/users/NicolayP/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NicolayP/subscriptions","organizations_url":"https://api.github.com/users/NicolayP/orgs","repos_url":"https://api.github.com/users/NicolayP/repos","events_url":"https://api.github.com/users/NicolayP/events{/privacy}","received_events_url":"https://api.github.com/users/NicolayP/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/nrontsis/PILCO/issues/43/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/nrontsis/PILCO/issues/43/timeline","performed_via_github_app":null,"state_reason":"completed"}