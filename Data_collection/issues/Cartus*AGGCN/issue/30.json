{"url":"https://api.github.com/repos/Cartus/AGGCN/issues/30","repository_url":"https://api.github.com/repos/Cartus/AGGCN","labels_url":"https://api.github.com/repos/Cartus/AGGCN/issues/30/labels{/name}","comments_url":"https://api.github.com/repos/Cartus/AGGCN/issues/30/comments","events_url":"https://api.github.com/repos/Cartus/AGGCN/issues/30/events","html_url":"https://github.com/Cartus/AGGCN/issues/30","id":842728704,"node_id":"MDU6SXNzdWU4NDI3Mjg3MDQ=","number":30,"title":"RuntimeError: cuda runtime error (100) : no CUDA-capable device is detected at /tmp/pip-req-build-ufslq_a9/aten/src/THC/THCGeneral.cpp:50","user":{"login":"ZohaibRamzan","id":48449038,"node_id":"MDQ6VXNlcjQ4NDQ5MDM4","avatar_url":"https://avatars.githubusercontent.com/u/48449038?v=4","gravatar_id":"","url":"https://api.github.com/users/ZohaibRamzan","html_url":"https://github.com/ZohaibRamzan","followers_url":"https://api.github.com/users/ZohaibRamzan/followers","following_url":"https://api.github.com/users/ZohaibRamzan/following{/other_user}","gists_url":"https://api.github.com/users/ZohaibRamzan/gists{/gist_id}","starred_url":"https://api.github.com/users/ZohaibRamzan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ZohaibRamzan/subscriptions","organizations_url":"https://api.github.com/users/ZohaibRamzan/orgs","repos_url":"https://api.github.com/users/ZohaibRamzan/repos","events_url":"https://api.github.com/users/ZohaibRamzan/events{/privacy}","received_events_url":"https://api.github.com/users/ZohaibRamzan/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-03-28T12:31:29Z","updated_at":"2021-04-18T01:37:29Z","closed_at":"2021-04-18T01:37:29Z","author_association":"NONE","active_lock_reason":null,"body":"(GPU_pytorch) hz071@hamilton:~/AGGCNN/AGGCN$ bash train_aggcn.sh 1\r\nVocab size 53953 loaded from file\r\nLoading data from dataset/tacred with batch size 50...\r\n1363 batches created for dataset/tacred/train.json\r\n453 batches created for dataset/tacred/dev.json\r\nConfig saved to file ./saved_models/01/config.json\r\nOverwriting old vocab file at ./saved_models/01/vocab.pkl\r\n\r\nRunning with the following configs:\r\n        data_dir : dataset/tacred\r\n        vocab_dir : dataset/vocab\r\n        emb_dim : 300\r\n        ner_dim : 30\r\n        pos_dim : 30\r\n        hidden_dim : 300\r\n        num_layers : 2\r\n        input_dropout : 0.5\r\n        gcn_dropout : 0.5\r\n        word_dropout : 0.04\r\n        topn : 10000000000.0\r\n        lower : False\r\n        heads : 3\r\n        sublayer_first : 2\r\n        sublayer_second : 4\r\n        pooling : max\r\n        pooling_l2 : 0.002\r\n        mlp_layers : 1\r\n        no_adj : False\r\n        rnn : True\r\n        rnn_hidden : 300\r\n        rnn_layers : 1\r\n        rnn_dropout : 0.5\r\n        lr : 0.7\r\n        lr_decay : 0.9\r\n        decay_epoch : 5\r\n        optim : sgd\r\n        num_epoch : 100\r\n        batch_size : 50\r\n        max_grad_norm : 5.0\r\n        log_step : 20\r\n        log : logs.txt\r\n        save_epoch : 100\r\n        save_dir : ./saved_models\r\n        id : 1\r\n        info :\r\n        seed : 0\r\n        cuda : False\r\n        cpu : False\r\n        load : False\r\n        model_file : None\r\n        num_class : 42\r\n        vocab_size : 53953\r\n        model_save_dir : ./saved_models/01\r\n\r\n\r\nFinetune all embeddings.\r\n/home/hz071/.conda/envs/GPU_pytorch/lib/python3.7/site-packages/torch/nn/modules/rnn.py:50: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.5 and num_layers=1\r\n  \"num_layers={}\".format(dropout, num_layers))\r\nTHCudaCheck FAIL file=/tmp/pip-req-build-ufslq_a9/aten/src/THC/THCGeneral.cpp line=50 error=100 : no CUDA-capable device is detected\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 119, in <module>\r\n    trainer = GCNTrainer(opt, emb_matrix=emb_matrix)\r\n  File \"/home/hz071/AGGCNN/AGGCN/model/trainer.py\", line 67, in __init__\r\n    self.model = GCNClassifier(opt, emb_matrix=emb_matrix)\r\n  File \"/home/hz071/AGGCNN/AGGCN/model/aggcn.py\", line 22, in __init__\r\n    self.gcn_model = GCNRelationModel(opt, emb_matrix=emb_matrix)\r\n  File \"/home/hz071/AGGCNN/AGGCN/model/aggcn.py\", line 47, in __init__\r\n    self.gcn = AGGCN(opt, embeddings)\r\n  File \"/home/hz071/AGGCNN/AGGCN/model/aggcn.py\", line 129, in __init__\r\n    self.layers.append(GraphConvLayer(opt, self.mem_dim, self.sublayer_first))\r\n  File \"/home/hz071/AGGCNN/AGGCN/model/aggcn.py\", line 205, in __init__\r\n    self.weight_list = self.weight_list.cuda()\r\n  File \"/home/hz071/.conda/envs/GPU_pytorch/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 304, in cuda\r\n    return self._apply(lambda t: t.cuda(device))\r\n  File \"/home/hz071/.conda/envs/GPU_pytorch/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 201, in _apply\r\n    module._apply(fn)\r\n  File \"/home/hz071/.conda/envs/GPU_pytorch/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 223, in _apply\r\n    param_applied = fn(param)\r\n  File \"/home/hz071/.conda/envs/GPU_pytorch/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 304, in <lambda>\r\n    return self._apply(lambda t: t.cuda(device))\r\n  File \"/home/hz071/.conda/envs/GPU_pytorch/lib/python3.7/site-packages/torch/cuda/__init__.py\", line 197, in _lazy_init\r\n    torch._C._cuda_init()\r\nRuntimeError: cuda runtime error (100) : no CUDA-capable device is detected at /tmp/pip-req-build-ufslq_a9/aten/src/THC/THCGeneral.cpp:50\r\n(GPU_pytorch) hz071@hamilton:~/AGGCNN/AGGCN$ python\r\nPython 3.7.10 (default, Feb 26 2021, 18:47:35)\r\n[GCC 7.3.0] :: Anaconda, Inc. on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import torch\r\n>>> torch.cuda.is_available()\r\nTrue\r\n>>>\r\n\r\n\r\nI am using pytorch=1.4.0,  python=3.7 and you can see above Cuda is available too. What should i do?","closed_by":{"login":"Cartus","id":8509368,"node_id":"MDQ6VXNlcjg1MDkzNjg=","avatar_url":"https://avatars.githubusercontent.com/u/8509368?v=4","gravatar_id":"","url":"https://api.github.com/users/Cartus","html_url":"https://github.com/Cartus","followers_url":"https://api.github.com/users/Cartus/followers","following_url":"https://api.github.com/users/Cartus/following{/other_user}","gists_url":"https://api.github.com/users/Cartus/gists{/gist_id}","starred_url":"https://api.github.com/users/Cartus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Cartus/subscriptions","organizations_url":"https://api.github.com/users/Cartus/orgs","repos_url":"https://api.github.com/users/Cartus/repos","events_url":"https://api.github.com/users/Cartus/events{/privacy}","received_events_url":"https://api.github.com/users/Cartus/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Cartus/AGGCN/issues/30/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Cartus/AGGCN/issues/30/timeline","performed_via_github_app":null,"state_reason":"completed"}