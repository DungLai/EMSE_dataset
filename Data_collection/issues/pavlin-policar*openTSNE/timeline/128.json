[{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624033230","html_url":"https://github.com/pavlin-policar/openTSNE/issues/128#issuecomment-624033230","issue_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/128","id":624033230,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDAzMzIzMA==","user":{"login":"dkobak","id":8970231,"node_id":"MDQ6VXNlcjg5NzAyMzE=","avatar_url":"https://avatars.githubusercontent.com/u/8970231?v=4","gravatar_id":"","url":"https://api.github.com/users/dkobak","html_url":"https://github.com/dkobak","followers_url":"https://api.github.com/users/dkobak/followers","following_url":"https://api.github.com/users/dkobak/following{/other_user}","gists_url":"https://api.github.com/users/dkobak/gists{/gist_id}","starred_url":"https://api.github.com/users/dkobak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkobak/subscriptions","organizations_url":"https://api.github.com/users/dkobak/orgs","repos_url":"https://api.github.com/users/dkobak/repos","events_url":"https://api.github.com/users/dkobak/events{/privacy}","received_events_url":"https://api.github.com/users/dkobak/received_events","type":"User","site_admin":false},"created_at":"2020-05-05T12:44:42Z","updated_at":"2020-05-05T12:52:12Z","author_association":"CONTRIBUTOR","body":"I went ahead and tried it out: I installed `fftw` from conda-forge, recompiled openTSNE (it said `FFTW3 header files found. Using FFTW implementation of FFT`) and reran my code. I got ~120 seconds.\r\n\r\nLooks like a big speed-up!\r\n\r\nGiven that `fftw` is available on conda-forge, what's the benefit of not depending on it by default?\r\n\r\nIn any case, I would suggest to more explicitly write in the README that one could install via \r\n```\r\nconda install --channel conda-forge fftw\r\nconda install --channel conda-forge opentsne\r\n```\r\nto make it much faster.","reactions":{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624033230/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dkobak","id":8970231,"node_id":"MDQ6VXNlcjg5NzAyMzE=","avatar_url":"https://avatars.githubusercontent.com/u/8970231?v=4","gravatar_id":"","url":"https://api.github.com/users/dkobak","html_url":"https://github.com/dkobak","followers_url":"https://api.github.com/users/dkobak/followers","following_url":"https://api.github.com/users/dkobak/following{/other_user}","gists_url":"https://api.github.com/users/dkobak/gists{/gist_id}","starred_url":"https://api.github.com/users/dkobak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkobak/subscriptions","organizations_url":"https://api.github.com/users/dkobak/orgs","repos_url":"https://api.github.com/users/dkobak/repos","events_url":"https://api.github.com/users/dkobak/events{/privacy}","received_events_url":"https://api.github.com/users/dkobak/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624081865","html_url":"https://github.com/pavlin-policar/openTSNE/issues/128#issuecomment-624081865","issue_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/128","id":624081865,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDA4MTg2NQ==","user":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false},"created_at":"2020-05-05T14:15:21Z","updated_at":"2020-05-05T14:15:21Z","author_association":"OWNER","body":"That's quite significant indeed. I never really did benchmark this without FFTW I suppose, and it should be the default in that case. The timing is a bit curious though. In my benchmarks, I found openTSNE to actually be marginally _faster_ than FIt-SNE when using 8 cores and slower when using 1 core. I haven't figured out why yet. So it's interesting to see that openTSNE is slower than FIt-SNE using multiple cores on your end. What CPU, OS, and Python version are you using, if you don't mind me asking? I ran all the benchmarks on an Intel Xeon, which is probably different from laptop CPUs.\r\n\r\n> Would it be avoided by using FFTW?\r\n\r\nYes, if it uses FFTW, there's no need to go back into Python-land and I call the FFTW libraries directly.\r\n\r\n```\r\nconda install --channel conda-forge opentsne\r\n```\r\n\r\nwouldn't be the correct thing to do here I think because the conda packages come precompiled. FFTW needs to be available at compile-time, so on the conda-forge servers. The correct thing to do would probably to compile openTSNE using `python setup.py install`.\r\n\r\nThis is something that can probably be done, but I realised after the release yesterday that Annoy doesn't provide wheels, and it doesn't provide Windows conda builds. So that's going to have to take priority, since I can release a new version onto conda-forge until that's taken care of.","reactions":{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624081865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624089034","html_url":"https://github.com/pavlin-policar/openTSNE/issues/128#issuecomment-624089034","issue_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/128","id":624089034,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDA4OTAzNA==","user":{"login":"dkobak","id":8970231,"node_id":"MDQ6VXNlcjg5NzAyMzE=","avatar_url":"https://avatars.githubusercontent.com/u/8970231?v=4","gravatar_id":"","url":"https://api.github.com/users/dkobak","html_url":"https://github.com/dkobak","followers_url":"https://api.github.com/users/dkobak/followers","following_url":"https://api.github.com/users/dkobak/following{/other_user}","gists_url":"https://api.github.com/users/dkobak/gists{/gist_id}","starred_url":"https://api.github.com/users/dkobak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkobak/subscriptions","organizations_url":"https://api.github.com/users/dkobak/orgs","repos_url":"https://api.github.com/users/dkobak/repos","events_url":"https://api.github.com/users/dkobak/events{/privacy}","received_events_url":"https://api.github.com/users/dkobak/received_events","type":"User","site_admin":false},"created_at":"2020-05-05T14:28:02Z","updated_at":"2020-05-05T14:28:02Z","author_association":"CONTRIBUTOR","body":"> In my benchmarks, I found openTSNE to actually be marginally faster than FIt-SNE when using 8 cores and slower when using 1 core. I haven't figured out why yet. So it's interesting to see that openTSNE is slower than FIt-SNE using multiple cores on your end. What CPU, OS, and Python version are you using, if you don't mind me asking? I ran all the benchmarks on an Intel Xeon, which is probably different from laptop CPUs.\r\n\r\nRight now I am running everything on my not-very-powerful laptop running Ubuntu and Python 3.7. But my recollection is that FIt-SNE has always been faster then openTSNE on my lab computer, which is a powerful workstation (also Ubuntu). So that's strange.\r\n\r\n> because the conda packages come precompiled. FFTW needs to be available at compile-time, so on the conda-forge servers.\r\n\r\nI don't really understand how all this works, but somebody put FIt-SNE to conda, and it seems to work, even though it uses FFTW. \r\n\r\n> I realised after the release yesterday that Annoy doesn't provide wheels, and it doesn't provide Windows conda builds.\r\n\r\nOops. Again I am not sure what this means exactly, but sounds like a mess. Is it something you can workaround?","reactions":{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624089034/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dkobak","id":8970231,"node_id":"MDQ6VXNlcjg5NzAyMzE=","avatar_url":"https://avatars.githubusercontent.com/u/8970231?v=4","gravatar_id":"","url":"https://api.github.com/users/dkobak","html_url":"https://github.com/dkobak","followers_url":"https://api.github.com/users/dkobak/followers","following_url":"https://api.github.com/users/dkobak/following{/other_user}","gists_url":"https://api.github.com/users/dkobak/gists{/gist_id}","starred_url":"https://api.github.com/users/dkobak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkobak/subscriptions","organizations_url":"https://api.github.com/users/dkobak/orgs","repos_url":"https://api.github.com/users/dkobak/repos","events_url":"https://api.github.com/users/dkobak/events{/privacy}","received_events_url":"https://api.github.com/users/dkobak/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624096336","html_url":"https://github.com/pavlin-policar/openTSNE/issues/128#issuecomment-624096336","issue_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/128","id":624096336,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDA5NjMzNg==","user":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false},"created_at":"2020-05-05T14:41:10Z","updated_at":"2020-05-05T16:50:53Z","author_association":"OWNER","body":"The speed difference I noticed was marginal, but it was consistent. This was run with FFTW. FIt-SNE is faster on a single core. Again, this was on a Xeon processor, so I'd like to run this on laptop computers as well before making any definitive statements. And to figure out why this might be happening...\r\n\r\n![benchmarks](https://user-images.githubusercontent.com/5758119/81077792-bb5c4080-8eed-11ea-83e2-0b077b3b72f0.png)\r\n\r\nWhen you make a python package that includes C code, you can distribute it in two ways: 1) source dist (sdist) which is a tar file which has the source code and needs to be compiled on your computer when you run `pip install x` 2) wheels which are compiled ahead of time somewhere else. With wheels you get a binary which you can use straight away. Why wheels? Because some people (mainly windows folks) don't have a C compiler installed, or they might not have the appropriate libraries. Without a compiler, the sdist is useless to them, but a wheel will run straight away. Conda is similar to wheels, where it builds the package on their servers. When you run conda install x you get the prebuilt binary which you can use straight away, without needing to compile locally.\r\n\r\nIn both FIt-SNE and openTSNE FFTW needs to be available at compile-time, when the binaries are being built. So for your example above, running `conda install fftw` would pull down the binary for fftw and `conda install openTSNE` would pull down the binary for openTSNE. This is already compiled somewhere else, so having the FFTW thing doesn't do anything. However, if you compiled from source i.e. `python setup.py install` or even `pip install openTSNE` (assuming it pulls down the sdist and not the wheels) after `conda install fftw` then compilation would occur locally on your computer, and it could use the FFTW headers.\r\n\r\nHopefully, that clears things up a bit. Don't hold me to all the details, but conceptually, that's how it works ðŸ˜„ \r\n","reactions":{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624096336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624151020","html_url":"https://github.com/pavlin-policar/openTSNE/issues/128#issuecomment-624151020","issue_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/128","id":624151020,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDE1MTAyMA==","user":{"login":"dkobak","id":8970231,"node_id":"MDQ6VXNlcjg5NzAyMzE=","avatar_url":"https://avatars.githubusercontent.com/u/8970231?v=4","gravatar_id":"","url":"https://api.github.com/users/dkobak","html_url":"https://github.com/dkobak","followers_url":"https://api.github.com/users/dkobak/followers","following_url":"https://api.github.com/users/dkobak/following{/other_user}","gists_url":"https://api.github.com/users/dkobak/gists{/gist_id}","starred_url":"https://api.github.com/users/dkobak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkobak/subscriptions","organizations_url":"https://api.github.com/users/dkobak/orgs","repos_url":"https://api.github.com/users/dkobak/repos","events_url":"https://api.github.com/users/dkobak/events{/privacy}","received_events_url":"https://api.github.com/users/dkobak/received_events","type":"User","site_admin":false},"created_at":"2020-05-05T16:14:24Z","updated_at":"2020-05-05T16:14:24Z","author_association":"CONTRIBUTOR","body":"> Again, this was on a Xeon processor, so I'd like to run this on laptop computers as well before making any definitive statements. \r\n\r\nInteresting. Definitely run it on your laptop and if it still disagrees with that I see on my laptop, we can try to dig into it deeper. My laptop processor is `Intel(R) Core(TM) i5-8265U CPU @ 1.60GHz`.\r\n\r\n> Hopefully, that clears things up a bit.\r\n\r\nYes it does! Very helpful, thanks.\r\n\r\nSo for FIt-SNE package on conda, the FFTW has been built in at compilation time on conda servers? Could you use the same approach for your conda package then? Then anybody installing openTSNE from conda would get it with FFTW, which would be a good thing?\r\n\r\n> Annoy doesn't provide wheels, and it doesn't provide Windows conda builds.\r\n\r\nSo it's not possible to install Annoy from conda under Windows? Which means that it's currently not possible to install the openTSNE from conda under Windows? What could be a solution to that? I think FIt-SNE includes all the necessary Annoy .lib files for Windows within its source code... That said, conda package for FIt-SNE currently does not work under Windows :-/","reactions":{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624151020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dkobak","id":8970231,"node_id":"MDQ6VXNlcjg5NzAyMzE=","avatar_url":"https://avatars.githubusercontent.com/u/8970231?v=4","gravatar_id":"","url":"https://api.github.com/users/dkobak","html_url":"https://github.com/dkobak","followers_url":"https://api.github.com/users/dkobak/followers","following_url":"https://api.github.com/users/dkobak/following{/other_user}","gists_url":"https://api.github.com/users/dkobak/gists{/gist_id}","starred_url":"https://api.github.com/users/dkobak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkobak/subscriptions","organizations_url":"https://api.github.com/users/dkobak/orgs","repos_url":"https://api.github.com/users/dkobak/repos","events_url":"https://api.github.com/users/dkobak/events{/privacy}","received_events_url":"https://api.github.com/users/dkobak/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624181655","html_url":"https://github.com/pavlin-policar/openTSNE/issues/128#issuecomment-624181655","issue_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/128","id":624181655,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDE4MTY1NQ==","user":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false},"created_at":"2020-05-05T17:04:58Z","updated_at":"2020-05-05T17:04:58Z","author_association":"OWNER","body":"> So for FIt-SNE package on conda, the FFTW has been built in at compilation time on conda servers?\r\n\r\nYes, exactly, this build command is specified in [build.sh](https://github.com/conda-forge/fit-sne-feedstock/blob/master/recipe/build.sh) in the FIt-SNE feedstock, which is run on the conda-forge servers.\r\n\r\n> Could you use the same approach for your conda package then?\r\n\r\nYes, this would be the goal. I think I actually tried this at some point but forgot why I abandoned it.\r\n\r\n> So it's not possible to install Annoy from conda under Windows?\r\n\r\nIt's possible, it's just going to use the old version v0.3.12 because I didn't want to merge something that doesn't work on Windows. Pip pulls from PyPi, which has v0.4, and conda has the old version. I will try to get this resolved ASAP.\r\n\r\nI'll probably end up packaging Annoy into openTSNE, like FIt-SNE does, and make my own bindings to it. That's probably the fastest solution. I've opened up an issue on Annoy, and they seem open to doing it, but my experience is that these types of things don't tend to move that quickly. Setting the build process up can be a real pain. Ideally, annoy would include a conda binary for windows (which they currently don't), as well as wheels (which they currently don't). ","reactions":{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624181655/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624294419","html_url":"https://github.com/pavlin-policar/openTSNE/issues/128#issuecomment-624294419","issue_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/128","id":624294419,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDI5NDQxOQ==","user":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false},"created_at":"2020-05-05T20:41:10Z","updated_at":"2020-05-05T20:41:10Z","author_association":"OWNER","body":"Ok, so I just tested MNIST on my Macbook pro which has an Intel(R) Core(TM) i5-8257U CPU @ 1.40GHz.\r\n\r\n```\r\nopenTSNE (FFTW): 119.76 sec\r\nopenTSNE (numpy): 113.29 sec\r\nFIt-SNE: 57.38 sec\r\n```\r\n\r\nI think both t-SNE runs are within the error bounds and after several runs they even out. I definitely don't see the drastic difference you saw earlier. FIt-SNE is faster here on 8 cores, unlike on the Xeon processor. Maybe it has something to do with the CPU architecture or something... In any case, I need to benchmark things on other CPUs.","reactions":{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624294419/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624303921","html_url":"https://github.com/pavlin-policar/openTSNE/issues/128#issuecomment-624303921","issue_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/128","id":624303921,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDMwMzkyMQ==","user":{"login":"dkobak","id":8970231,"node_id":"MDQ6VXNlcjg5NzAyMzE=","avatar_url":"https://avatars.githubusercontent.com/u/8970231?v=4","gravatar_id":"","url":"https://api.github.com/users/dkobak","html_url":"https://github.com/dkobak","followers_url":"https://api.github.com/users/dkobak/followers","following_url":"https://api.github.com/users/dkobak/following{/other_user}","gists_url":"https://api.github.com/users/dkobak/gists{/gist_id}","starred_url":"https://api.github.com/users/dkobak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkobak/subscriptions","organizations_url":"https://api.github.com/users/dkobak/orgs","repos_url":"https://api.github.com/users/dkobak/repos","events_url":"https://api.github.com/users/dkobak/events{/privacy}","received_events_url":"https://api.github.com/users/dkobak/received_events","type":"User","site_admin":false},"created_at":"2020-05-05T21:01:13Z","updated_at":"2020-05-05T21:02:07Z","author_association":"CONTRIBUTOR","body":"That's weird, because it looks like it's basically the same processor. My runtimes are reported here: https://twitter.com/hippopedoid/status/1257673387184394240. (That's after I recompiled openTSNE with FFTW. Before it was just over 3 minutes.)","reactions":{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624303921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dkobak","id":8970231,"node_id":"MDQ6VXNlcjg5NzAyMzE=","avatar_url":"https://avatars.githubusercontent.com/u/8970231?v=4","gravatar_id":"","url":"https://api.github.com/users/dkobak","html_url":"https://github.com/dkobak","followers_url":"https://api.github.com/users/dkobak/followers","following_url":"https://api.github.com/users/dkobak/following{/other_user}","gists_url":"https://api.github.com/users/dkobak/gists{/gist_id}","starred_url":"https://api.github.com/users/dkobak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkobak/subscriptions","organizations_url":"https://api.github.com/users/dkobak/orgs","repos_url":"https://api.github.com/users/dkobak/repos","events_url":"https://api.github.com/users/dkobak/events{/privacy}","received_events_url":"https://api.github.com/users/dkobak/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624306690","html_url":"https://github.com/pavlin-policar/openTSNE/issues/128#issuecomment-624306690","issue_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/128","id":624306690,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDMwNjY5MA==","user":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false},"created_at":"2020-05-05T21:07:20Z","updated_at":"2020-05-05T21:07:20Z","author_association":"OWNER","body":"Here are the benchmarks from the server. These are just the results of a single run, but it should give a rough idea of how things behave. \r\n\r\n| | 1000 | 100000 | 250000 | 500000 | 750000 | 1000000 |\r\n|------|------|--------|--------|--------|--------|--------|\r\n| FFTW (1 core) | 16 | 342 | 896 | 1878 | 2838 | 3814 |\r\n| numpy (1 core) | 29 | 358 | 924 | 1921 | 2904 | 3922 |\r\n| FFTW (8 core) | 14 | 97 | 252 | 547 | 860 | 1185 | \r\n| numpy (8 core) |  25 | 108 | 265 | 578\r\n\r\n(top row indicates data set size, numbers in cells indicate time in seconds)\r\n\r\nSo it definitely looks like there's about a 20-30 sec difference between the FFTW implementation and numpy implementation, which is consistent with what you were seeing. The fact that it's a pretty constant difference regardless of data set size supports this theory. Benchmarks on personal laptops are always shaky because who knows what else is running in the background. In any case, it's clear that numpy is slower, so I'll try to get everything to use FFTW.\r\n","reactions":{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/624306690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/625749391","html_url":"https://github.com/pavlin-policar/openTSNE/issues/128#issuecomment-625749391","issue_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/128","id":625749391,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTc0OTM5MQ==","user":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false},"created_at":"2020-05-08T10:25:10Z","updated_at":"2020-05-08T10:25:10Z","author_association":"OWNER","body":"So I ran the MNIST benchmark again on my MacBook:\r\n\r\n```\r\nopenTSNE (FFTW): 76.02 sec\r\nopenTSNE (numpy): 80.09 sec\r\nFIt-SNE: 55.04 sec\r\n```\r\nThe difference between FIt-SNE and openTSNE is not as large as it was the first time I ran it. I haven't really changed anything in any meaningful way, other than moving annoy to the repo, so I don't know what was going on in the benchmark I ran two days ago.","reactions":{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/625749391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/625780504","html_url":"https://github.com/pavlin-policar/openTSNE/issues/128#issuecomment-625780504","issue_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/128","id":625780504,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTc4MDUwNA==","user":{"login":"dkobak","id":8970231,"node_id":"MDQ6VXNlcjg5NzAyMzE=","avatar_url":"https://avatars.githubusercontent.com/u/8970231?v=4","gravatar_id":"","url":"https://api.github.com/users/dkobak","html_url":"https://github.com/dkobak","followers_url":"https://api.github.com/users/dkobak/followers","following_url":"https://api.github.com/users/dkobak/following{/other_user}","gists_url":"https://api.github.com/users/dkobak/gists{/gist_id}","starred_url":"https://api.github.com/users/dkobak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkobak/subscriptions","organizations_url":"https://api.github.com/users/dkobak/orgs","repos_url":"https://api.github.com/users/dkobak/repos","events_url":"https://api.github.com/users/dkobak/events{/privacy}","received_events_url":"https://api.github.com/users/dkobak/received_events","type":"User","site_admin":false},"created_at":"2020-05-08T11:56:48Z","updated_at":"2020-05-08T11:56:48Z","author_association":"CONTRIBUTOR","body":"In any case, FIt-SNE is the fastest, and openTSNE+FFTW is a little faster than openTSNE+numpy, so this qualitatively agrees with what I got on my laptop, even though for me the speed-up from FFTW was much higher. But who knows, maybe something was wrong with my test.","reactions":{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/625780504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dkobak","id":8970231,"node_id":"MDQ6VXNlcjg5NzAyMzE=","avatar_url":"https://avatars.githubusercontent.com/u/8970231?v=4","gravatar_id":"","url":"https://api.github.com/users/dkobak","html_url":"https://github.com/dkobak","followers_url":"https://api.github.com/users/dkobak/followers","following_url":"https://api.github.com/users/dkobak/following{/other_user}","gists_url":"https://api.github.com/users/dkobak/gists{/gist_id}","starred_url":"https://api.github.com/users/dkobak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkobak/subscriptions","organizations_url":"https://api.github.com/users/dkobak/orgs","repos_url":"https://api.github.com/users/dkobak/repos","events_url":"https://api.github.com/users/dkobak/events{/privacy}","received_events_url":"https://api.github.com/users/dkobak/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/625880844","html_url":"https://github.com/pavlin-policar/openTSNE/issues/128#issuecomment-625880844","issue_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/128","id":625880844,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTg4MDg0NA==","user":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false},"created_at":"2020-05-08T15:49:28Z","updated_at":"2020-05-08T15:49:28Z","author_association":"OWNER","body":"Either way, I am running the same set of benchmarks on another laptop with an i7, which is comparable to what most people have in their laptops. Xeon processors are super optimized and have a lot of enhancements and different instruction sets specifically for math-type operations, which consumer-grade CPUs don't have.\r\n\r\nI will update the readme so that it better describes the speed difference. Otherwise, I'm closing this, there doesn't seem to be anything to fix. I did try to get FFTW into the wheels and conda packages today, but I was unsuccessful, so this will have to wait a bit.","reactions":{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/625880844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false}},{"id":3317462774,"node_id":"MDExOkNsb3NlZEV2ZW50MzMxNzQ2Mjc3NA==","url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/events/3317462774","actor":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-05-08T15:49:28Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/626036995","html_url":"https://github.com/pavlin-policar/openTSNE/issues/128#issuecomment-626036995","issue_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/128","id":626036995,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNjAzNjk5NQ==","user":{"login":"dkobak","id":8970231,"node_id":"MDQ6VXNlcjg5NzAyMzE=","avatar_url":"https://avatars.githubusercontent.com/u/8970231?v=4","gravatar_id":"","url":"https://api.github.com/users/dkobak","html_url":"https://github.com/dkobak","followers_url":"https://api.github.com/users/dkobak/followers","following_url":"https://api.github.com/users/dkobak/following{/other_user}","gists_url":"https://api.github.com/users/dkobak/gists{/gist_id}","starred_url":"https://api.github.com/users/dkobak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkobak/subscriptions","organizations_url":"https://api.github.com/users/dkobak/orgs","repos_url":"https://api.github.com/users/dkobak/repos","events_url":"https://api.github.com/users/dkobak/events{/privacy}","received_events_url":"https://api.github.com/users/dkobak/received_events","type":"User","site_admin":false},"created_at":"2020-05-08T21:52:37Z","updated_at":"2020-05-08T21:52:37Z","author_association":"CONTRIBUTOR","body":"> I did try to get FFTW into the wheels and conda packages today, but I was unsuccessful, so this will have to wait a bit.\r\n\r\nToo bad!\r\n\r\n> I will update the readme so that it better describes the speed difference.\r\n\r\nYeah, I think basically adding a more explicit instruction for how to install it using FFTW (e.g. mention that FFTW can be installed from conda), and also maybe mention that the speed increase on some systems can be noticeable even earlier than with \"millions\" of points.","reactions":{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/comments/626036995/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dkobak","id":8970231,"node_id":"MDQ6VXNlcjg5NzAyMzE=","avatar_url":"https://avatars.githubusercontent.com/u/8970231?v=4","gravatar_id":"","url":"https://api.github.com/users/dkobak","html_url":"https://github.com/dkobak","followers_url":"https://api.github.com/users/dkobak/followers","following_url":"https://api.github.com/users/dkobak/following{/other_user}","gists_url":"https://api.github.com/users/dkobak/gists{/gist_id}","starred_url":"https://api.github.com/users/dkobak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkobak/subscriptions","organizations_url":"https://api.github.com/users/dkobak/orgs","repos_url":"https://api.github.com/users/dkobak/repos","events_url":"https://api.github.com/users/dkobak/events{/privacy}","received_events_url":"https://api.github.com/users/dkobak/received_events","type":"User","site_admin":false}}]