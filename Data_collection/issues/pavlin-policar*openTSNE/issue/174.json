{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/174","repository_url":"https://api.github.com/repos/pavlin-policar/openTSNE","labels_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/174/labels{/name}","comments_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/174/comments","events_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/174/events","html_url":"https://github.com/pavlin-policar/openTSNE/issues/174","id":859791098,"node_id":"MDU6SXNzdWU4NTk3OTEwOTg=","number":174,"title":"FFT parameters and runtime for very expanded embeddings","user":{"login":"dkobak","id":8970231,"node_id":"MDQ6VXNlcjg5NzAyMzE=","avatar_url":"https://avatars.githubusercontent.com/u/8970231?v=4","gravatar_id":"","url":"https://api.github.com/users/dkobak","html_url":"https://github.com/dkobak","followers_url":"https://api.github.com/users/dkobak/followers","following_url":"https://api.github.com/users/dkobak/following{/other_user}","gists_url":"https://api.github.com/users/dkobak/gists{/gist_id}","starred_url":"https://api.github.com/users/dkobak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkobak/subscriptions","organizations_url":"https://api.github.com/users/dkobak/orgs","repos_url":"https://api.github.com/users/dkobak/repos","events_url":"https://api.github.com/users/dkobak/events{/privacy}","received_events_url":"https://api.github.com/users/dkobak/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":15,"created_at":"2021-04-16T12:58:28Z","updated_at":"2021-04-17T13:42:57Z","closed_at":"2021-04-17T13:42:57Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I have been doing some experiments on convergence and running t-SNE for many more iterations than I normally do. And I again noticed something that I used to see every now and then: the runtime jumps wildly between \"epochs\" of 50 iterations. This only happens when the embedding is very expanded and so FFT gets really slow. Look:\r\n\r\n```\r\nIteration   50, KL divergence 4.8674, 50 iterations in 1.8320 sec\r\nIteration  100, KL divergence 4.3461, 50 iterations in 1.8760 sec\r\nIteration  150, KL divergence 4.0797, 50 iterations in 2.6252 sec\r\nIteration  200, KL divergence 3.9082, 50 iterations in 4.5062 sec\r\nIteration  250, KL divergence 3.7864, 50 iterations in 5.4258 sec\r\nIteration  300, KL divergence 3.6957, 50 iterations in 7.2500 sec\r\nIteration  350, KL divergence 3.6259, 50 iterations in 9.0705 sec\r\nIteration  400, KL divergence 3.5711, 50 iterations in 10.1077 sec\r\nIteration  450, KL divergence 3.5271, 50 iterations in 12.2412 sec\r\nIteration  500, KL divergence 3.4909, 50 iterations in 13.6440 sec\r\nIteration  550, KL divergence 3.4604, 50 iterations in 14.6127 sec\r\nIteration  600, KL divergence 3.4356, 50 iterations in 17.2364 sec\r\nIteration  650, KL divergence 3.4143, 50 iterations in 17.6973 sec\r\nIteration  700, KL divergence 3.3986, 50 iterations in 27.9720 sec\r\nIteration  750, KL divergence 3.3914, 50 iterations in 34.0480 sec\r\nIteration  800, KL divergence 3.3863, 50 iterations in 34.4572 sec\r\nIteration  850, KL divergence 3.3820, 50 iterations in 36.9247 sec\r\nIteration  900, KL divergence 3.3779, 50 iterations in 47.0994 sec\r\nIteration  950, KL divergence 3.3737, 50 iterations in 40.8424 sec\r\nIteration 1000, KL divergence 3.3696, 50 iterations in 62.1549 sec\r\nIteration 1050, KL divergence 3.3653, 50 iterations in 30.6310 sec\r\nIteration 1100, KL divergence 3.3613, 50 iterations in 44.9781 sec\r\nIteration 1150, KL divergence 3.3571, 50 iterations in 36.9257 sec\r\nIteration 1200, KL divergence 3.3531, 50 iterations in 66.3830 sec\r\nIteration 1250, KL divergence 3.3493, 50 iterations in 37.7215 sec\r\nIteration 1300, KL divergence 3.3457, 50 iterations in 33.7942 sec\r\nIteration 1350, KL divergence 3.3421, 50 iterations in 33.7507 sec\r\nIteration 1400, KL divergence 3.3387, 50 iterations in 59.2065 sec\r\nIteration 1450, KL divergence 3.3354, 50 iterations in 36.3713 sec\r\nIteration 1500, KL divergence 3.3323, 50 iterations in 39.1894 sec\r\nIteration 1550, KL divergence 3.3293, 50 iterations in 67.3239 sec\r\nIteration 1600, KL divergence 3.3265, 50 iterations in 33.9837 sec\r\nIteration 1650, KL divergence 3.3238, 50 iterations in 63.5015 sec\r\n```\r\nFor the record, this is on full MNIST with uniform k=15 affinity, `n_jobs=-1`. Note that after it gets to 30 seconds / 50 iterations, it starts fluctuating between 30 and 60. This does not make sense.\r\n\r\nI suspect it may be related to how interpolation params are chosen depending on the grid size. Can it be that those heuristics may need improvement?\r\n\r\nIncidentally, can it be that the interpolation params can be relaxed once the embedding becomes very large (e.g. span larger than [-100,100]) so that optimisation runs faster without -- perhaps! -- compromising the approximation too much?\r\n\r\nCCing to @linqiaozhi.","closed_by":{"login":"pavlin-policar","id":5758119,"node_id":"MDQ6VXNlcjU3NTgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/5758119?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlin-policar","html_url":"https://github.com/pavlin-policar","followers_url":"https://api.github.com/users/pavlin-policar/followers","following_url":"https://api.github.com/users/pavlin-policar/following{/other_user}","gists_url":"https://api.github.com/users/pavlin-policar/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlin-policar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlin-policar/subscriptions","organizations_url":"https://api.github.com/users/pavlin-policar/orgs","repos_url":"https://api.github.com/users/pavlin-policar/repos","events_url":"https://api.github.com/users/pavlin-policar/events{/privacy}","received_events_url":"https://api.github.com/users/pavlin-policar/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/174/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pavlin-policar/openTSNE/issues/174/timeline","performed_via_github_app":null,"state_reason":"completed"}