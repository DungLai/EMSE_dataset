{"url":"https://api.github.com/repos/Neuraxio/Neuraxle/issues/493","repository_url":"https://api.github.com/repos/Neuraxio/Neuraxle","labels_url":"https://api.github.com/repos/Neuraxio/Neuraxle/issues/493/labels{/name}","comments_url":"https://api.github.com/repos/Neuraxio/Neuraxle/issues/493/comments","events_url":"https://api.github.com/repos/Neuraxio/Neuraxle/issues/493/events","html_url":"https://github.com/Neuraxio/Neuraxle/issues/493","id":904136897,"node_id":"MDU6SXNzdWU5MDQxMzY4OTc=","number":493,"title":"Bug: Possible conflicts with trial_hash name and multiprocessing","user":{"login":"vincent-antaki","id":74119210,"node_id":"MDQ6VXNlcjc0MTE5MjEw","avatar_url":"https://avatars.githubusercontent.com/u/74119210?v=4","gravatar_id":"","url":"https://api.github.com/users/vincent-antaki","html_url":"https://github.com/vincent-antaki","followers_url":"https://api.github.com/users/vincent-antaki/followers","following_url":"https://api.github.com/users/vincent-antaki/following{/other_user}","gists_url":"https://api.github.com/users/vincent-antaki/gists{/gist_id}","starred_url":"https://api.github.com/users/vincent-antaki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vincent-antaki/subscriptions","organizations_url":"https://api.github.com/users/vincent-antaki/orgs","repos_url":"https://api.github.com/users/vincent-antaki/repos","events_url":"https://api.github.com/users/vincent-antaki/events{/privacy}","received_events_url":"https://api.github.com/users/vincent-antaki/received_events","type":"User","site_admin":false},"labels":[{"id":1290971220,"node_id":"MDU6TGFiZWwxMjkwOTcxMjIw","url":"https://api.github.com/repos/Neuraxio/Neuraxle/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1290971225,"node_id":"MDU6TGFiZWwxMjkwOTcxMjI1","url":"https://api.github.com/repos/Neuraxio/Neuraxle/labels/invalid","name":"invalid","color":"e4e669","default":true,"description":"This doesn't seem right"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2021-05-27T20:00:02Z","updated_at":"2022-03-30T23:13:54Z","closed_at":"2022-03-30T23:13:54Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Describe the bug**\r\nSo this bug involves HyperparameterJSONRepo and the get_trial_hash_function. It is very unlikely to happen if your model has hyperparameters which are reals and more likely if your hp space is small, discrete and the pipeline computation are quick.\r\n\r\nHere is the gist of it:\r\n- A trial_hash is generated solely by hashing the hyperparameter dictionary\r\n- The trial_hash is used as a unique key in the file name that stores the trial state and results.\r\n- If the hyperparams are the same, multiple trials can be trying to use the same file.\r\n\r\nIn case of non-parallel execution, this means that we are overwriting the previous trial with the same hyperparameters.\r\nIn case of parallel execution, this is a potential race hazard. See example to reproduce.\r\n\r\n**To Reproduce**\r\nTake the test_logger_automl and the the following:\r\n- add \"n_jobs=-1\" to the AutoML loop constructor call\r\n- add \"execution_number\" argument to the test after \"tmpdir\"\r\n- add \"@pytest.mark.parametrize(\"execution_number\", range(100))\"  decorator to the test.\r\n\r\n\r\n**Expected behavior and suggested fix**\r\nFirst of I'm not convinced that the the overwriting behaviour in non parallel setting is problematic. If the hyperparameters are the same, we shouldn't see any difference in outputs unless they are due to sampling random values. If that is considered problematic, then users should set a random seed as part of their hyperparameter space.\r\n\r\nSecond, I'd assume not crashing when running in parallel is the expected behaviour. To achieve that, development of Multiprocess safe HyperparamsRepo should be considered.\r\n","closed_by":{"login":"guillaume-chevalier","id":11862328,"node_id":"MDQ6VXNlcjExODYyMzI4","avatar_url":"https://avatars.githubusercontent.com/u/11862328?v=4","gravatar_id":"","url":"https://api.github.com/users/guillaume-chevalier","html_url":"https://github.com/guillaume-chevalier","followers_url":"https://api.github.com/users/guillaume-chevalier/followers","following_url":"https://api.github.com/users/guillaume-chevalier/following{/other_user}","gists_url":"https://api.github.com/users/guillaume-chevalier/gists{/gist_id}","starred_url":"https://api.github.com/users/guillaume-chevalier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guillaume-chevalier/subscriptions","organizations_url":"https://api.github.com/users/guillaume-chevalier/orgs","repos_url":"https://api.github.com/users/guillaume-chevalier/repos","events_url":"https://api.github.com/users/guillaume-chevalier/events{/privacy}","received_events_url":"https://api.github.com/users/guillaume-chevalier/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Neuraxio/Neuraxle/issues/493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Neuraxio/Neuraxle/issues/493/timeline","performed_via_github_app":null,"state_reason":"completed"}