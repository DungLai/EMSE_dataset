{"url":"https://api.github.com/repos/Neuraxio/Neuraxle/issues/406","repository_url":"https://api.github.com/repos/Neuraxio/Neuraxle","labels_url":"https://api.github.com/repos/Neuraxio/Neuraxle/issues/406/labels{/name}","comments_url":"https://api.github.com/repos/Neuraxio/Neuraxle/issues/406/comments","events_url":"https://api.github.com/repos/Neuraxio/Neuraxle/issues/406/events","html_url":"https://github.com/Neuraxio/Neuraxle/issues/406","id":709803639,"node_id":"MDU6SXNzdWU3MDk4MDM2Mzk=","number":406,"title":"Question: How to use RandomizedSearchCV from sklearn inside neuraxle with PyTorch model?","user":{"login":"patrickctrf","id":21196739,"node_id":"MDQ6VXNlcjIxMTk2NzM5","avatar_url":"https://avatars.githubusercontent.com/u/21196739?v=4","gravatar_id":"","url":"https://api.github.com/users/patrickctrf","html_url":"https://github.com/patrickctrf","followers_url":"https://api.github.com/users/patrickctrf/followers","following_url":"https://api.github.com/users/patrickctrf/following{/other_user}","gists_url":"https://api.github.com/users/patrickctrf/gists{/gist_id}","starred_url":"https://api.github.com/users/patrickctrf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/patrickctrf/subscriptions","organizations_url":"https://api.github.com/users/patrickctrf/orgs","repos_url":"https://api.github.com/users/patrickctrf/repos","events_url":"https://api.github.com/users/patrickctrf/events{/privacy}","received_events_url":"https://api.github.com/users/patrickctrf/received_events","type":"User","site_admin":false},"labels":[{"id":1290971226,"node_id":"MDU6TGFiZWwxMjkwOTcxMjI2","url":"https://api.github.com/repos/Neuraxio/Neuraxle/labels/question","name":"question","color":"d876e3","default":true,"description":"Further information is requested"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-09-27T19:46:28Z","updated_at":"2021-09-16T02:51:18Z","closed_at":"2021-09-16T02:51:18Z","author_association":"NONE","active_lock_reason":null,"body":"I have a PyTorch model built as a sklearn-like estimator and I'm using [RandomizedSearchCV](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html) to tune hyperparameters. It works fine when n_jobs==1, but fails with n_jobs>1 when I'm using GPU (Cuda). n_jobs>1 without gpu (cpu only) works fine.\r\n\r\nI see that Neuraxle intends to solve this serialization problem using savers, but when I wrap my RandomizedSearchCV with [MetaSKlearnWrapper](https://www.neuraxle.org/stable/api/neuraxle.metaopt.sklearn.html?highlight=searchcv), it changes nothing and I get the same error:\r\n\r\n`cv_search = MetaSKLearnWrapper(cv_search)`\r\n\r\n> PicklingError: Can't pickle <class 'main.LSTM'>: attribute lookup LSTM on main failed\r\n\r\n\r\nI've opened a [question](https://stackoverflow.com/questions/64084881/n-jobs-1-using-sklearn-and-pytorch-is-possible-inside-neuraxle) in StackOverflow with more details and my code. I saw that Neuraxle has its own method for [RandomSearch,](https://www.neuraxle.org/stable/api/neuraxle.metaopt.auto_ml.html?highlight=auto_ml%20randomsearch#neuraxle.metaopt.auto_ml.RandomSearchHyperparameterSelectionStrategy) but I'm in doubt if I can use sklearn wrapper or must use Neuraxle's own RandomSearch.\r\n\r\nI am grateful to anyone who can give me an example or explanation of how to do the random search using neuraxle and without having to rewrite my entire code without sklearn. Thank you.\r\n\r\n\r\n","closed_by":{"login":"patrickctrf","id":21196739,"node_id":"MDQ6VXNlcjIxMTk2NzM5","avatar_url":"https://avatars.githubusercontent.com/u/21196739?v=4","gravatar_id":"","url":"https://api.github.com/users/patrickctrf","html_url":"https://github.com/patrickctrf","followers_url":"https://api.github.com/users/patrickctrf/followers","following_url":"https://api.github.com/users/patrickctrf/following{/other_user}","gists_url":"https://api.github.com/users/patrickctrf/gists{/gist_id}","starred_url":"https://api.github.com/users/patrickctrf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/patrickctrf/subscriptions","organizations_url":"https://api.github.com/users/patrickctrf/orgs","repos_url":"https://api.github.com/users/patrickctrf/repos","events_url":"https://api.github.com/users/patrickctrf/events{/privacy}","received_events_url":"https://api.github.com/users/patrickctrf/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Neuraxio/Neuraxle/issues/406/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Neuraxio/Neuraxle/issues/406/timeline","performed_via_github_app":null,"state_reason":"completed"}