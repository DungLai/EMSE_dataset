[{"url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/comments/639387351","html_url":"https://github.com/clovaai/deep-text-recognition-benchmark/issues/170#issuecomment-639387351","issue_url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/170","id":639387351,"node_id":"MDEyOklzc3VlQ29tbWVudDYzOTM4NzM1MQ==","user":{"login":"ku21fan","id":7953971,"node_id":"MDQ6VXNlcjc5NTM5NzE=","avatar_url":"https://avatars.githubusercontent.com/u/7953971?v=4","gravatar_id":"","url":"https://api.github.com/users/ku21fan","html_url":"https://github.com/ku21fan","followers_url":"https://api.github.com/users/ku21fan/followers","following_url":"https://api.github.com/users/ku21fan/following{/other_user}","gists_url":"https://api.github.com/users/ku21fan/gists{/gist_id}","starred_url":"https://api.github.com/users/ku21fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ku21fan/subscriptions","organizations_url":"https://api.github.com/users/ku21fan/orgs","repos_url":"https://api.github.com/users/ku21fan/repos","events_url":"https://api.github.com/users/ku21fan/events{/privacy}","received_events_url":"https://api.github.com/users/ku21fan/received_events","type":"User","site_admin":false},"created_at":"2020-06-05T10:13:33Z","updated_at":"2020-06-05T10:13:40Z","author_association":"CONTRIBUTOR","body":"Hello, \r\n\r\nCould you upload the messages just before the error msg?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/comments/639387351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ku21fan","id":7953971,"node_id":"MDQ6VXNlcjc5NTM5NzE=","avatar_url":"https://avatars.githubusercontent.com/u/7953971?v=4","gravatar_id":"","url":"https://api.github.com/users/ku21fan","html_url":"https://github.com/ku21fan","followers_url":"https://api.github.com/users/ku21fan/followers","following_url":"https://api.github.com/users/ku21fan/following{/other_user}","gists_url":"https://api.github.com/users/ku21fan/gists{/gist_id}","starred_url":"https://api.github.com/users/ku21fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ku21fan/subscriptions","organizations_url":"https://api.github.com/users/ku21fan/orgs","repos_url":"https://api.github.com/users/ku21fan/repos","events_url":"https://api.github.com/users/ku21fan/events{/privacy}","received_events_url":"https://api.github.com/users/ku21fan/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/comments/661191179","html_url":"https://github.com/clovaai/deep-text-recognition-benchmark/issues/170#issuecomment-661191179","issue_url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/170","id":661191179,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MTE5MTE3OQ==","user":{"login":"csmcallister","id":33464354,"node_id":"MDQ6VXNlcjMzNDY0MzU0","avatar_url":"https://avatars.githubusercontent.com/u/33464354?v=4","gravatar_id":"","url":"https://api.github.com/users/csmcallister","html_url":"https://github.com/csmcallister","followers_url":"https://api.github.com/users/csmcallister/followers","following_url":"https://api.github.com/users/csmcallister/following{/other_user}","gists_url":"https://api.github.com/users/csmcallister/gists{/gist_id}","starred_url":"https://api.github.com/users/csmcallister/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/csmcallister/subscriptions","organizations_url":"https://api.github.com/users/csmcallister/orgs","repos_url":"https://api.github.com/users/csmcallister/repos","events_url":"https://api.github.com/users/csmcallister/events{/privacy}","received_events_url":"https://api.github.com/users/csmcallister/received_events","type":"User","site_admin":false},"created_at":"2020-07-20T17:00:38Z","updated_at":"2020-07-20T17:00:38Z","author_association":"NONE","body":"I'm also experiencing this issue.\r\n\r\nWindows 10 (1809)\r\ntorch 1.4.0\r\ncuda 10.1\r\n\r\nHere's how to reproduce.\r\n\r\nFirst, I adjusted the model to support ONNX convesion by changing the following in model.py:\r\n\r\n```python\r\n self.AdaptiveAvgPool = nn.AdaptiveAvgPool2d((512, 1)) # 512 used to be None\r\n```\r\n\r\nThen I used the following to train from scratch:\r\n```bash\r\npython train.py --train_data data\\train --valid_data data\\validation --select_data MJ-SJ --batch_ratio 0.5-0.5 --Transformation TPS --FeatureExtraction ResNet --SequenceModeling BiLSTM --Prediction Attn\r\n```\r\n\r\nThen I try to load the model for inference on dummy data.\r\n\r\n```python\r\nfrom mlflow import pytorch\r\nimport torch\r\n\r\ndevice = torch.device('cuda')\r\nmodel = pytorch.load_model(r'saved_models\\TPS-ResNet-BiLSTM-Attn\\07_20_20-1206\\best_accuracy')\r\n\r\nmodel.module.eval()\r\nx = torch.randn(1, 1, opt.imgW, opt.imgH)\r\n_ = model.module(x)\r\n```\r\n\r\nTraceback:\r\n```python\r\nTraceback (most recent call last):\r\n  File \"to_onnx.py\", line 15, in <module>\r\n    _ = model.module(x)\r\n  File \"C:\\Users\\scottmcallister\\anaconda3\\envs\\xact_model\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 532, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"C:\\Users\\scottmcallister\\xact_model\\benchmark_model\\saved_models\\TPS-ResNet-BiLSTM-Attn\\07_20_20-1206\\best_accuracy\\code\\model.py\", line 70, in forward\r\n    input = self.Transformation(input)\r\n  File \"C:\\Users\\scottmcallister\\anaconda3\\envs\\xact_model\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 532, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"C:\\Users\\scottmcallister\\xact_model\\benchmark_model\\saved_models\\TPS-ResNet-BiLSTM-Attn\\07_20_20-1206\\best_accuracy\\code\\modules\\transformation.py\",\r\nline 31, in forward\r\n    batch_C_prime = self.LocalizationNetwork(batch_I)  # batch_size x K x 2\r\n  File \"C:\\Users\\scottmcallister\\anaconda3\\envs\\xact_model\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 532, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"C:\\Users\\scottmcallister\\xact_model\\benchmark_model\\saved_models\\TPS-ResNet-BiLSTM-Attn\\07_20_20-1206\\best_accuracy\\code\\modules\\transformation.py\",\r\nline 78, in forward\r\n    features = self.conv(batch_I).view(batch_size, -1)\r\n  File \"C:\\Users\\scottmcallister\\anaconda3\\envs\\xact_model\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 532, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"C:\\Users\\scottmcallister\\anaconda3\\envs\\xact_model\\lib\\site-packages\\torch\\nn\\modules\\container.py\", line 100, in forward\r\n    input = module(input)\r\n  File \"C:\\Users\\scottmcallister\\anaconda3\\envs\\xact_model\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 532, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"C:\\Users\\scottmcallister\\anaconda3\\envs\\xact_model\\lib\\site-packages\\torch\\nn\\modules\\conv.py\", line 345, in forward\r\n    return self.conv2d_forward(input, self.weight)\r\n  File \"C:\\Users\\scottmcallister\\anaconda3\\envs\\xact_model\\lib\\site-packages\\torch\\nn\\modules\\conv.py\", line 342, in conv2d_forward\r\n    self.padding, self.dilation, self.groups)\r\nRuntimeError: Expected object of device type cuda but got device type cpu for argument #1 'self' in call to _thnn_conv2d_forward\r\n```\r\n\r\nConversely, if I tried to use the cpu:\r\n\r\n```python\r\nfrom mlflow import pytorch\r\nimport torch\r\nfrom torchvision import transforms\r\ndevice = torch.device('cpu')\r\nmodel = pytorch.load_model(r'saved_models\\TPS-ResNet-BiLSTM-Attn\\07_20_20-1242\\best_accuracy', map_location='cpu')\r\nmodel.module.eval()\r\nx = torch.randn(1, 1, opt.imgW, opt.imgH)\r\n_ = model.module(x)\r\n```\r\n\r\nTraceback:\r\n\r\n```python\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"C:\\Users\\scottmcallister\\anaconda3\\envs\\xact_model\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 532, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"C:\\Users\\scottmcallister\\xact_model\\benchmark_model\\saved_models\\TPS-ResNet-BiLSTM-Attn\\07_20_20-1242\\best_accuracy\\code\\model.py\", line 70, in forward\r\n    input = self.Transformation(input)\r\n  File \"C:\\Users\\scottmcallister\\anaconda3\\envs\\xact_model\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 532, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"C:\\Users\\scottmcallister\\xact_model\\benchmark_model\\saved_models\\TPS-ResNet-BiLSTM-Attn\\07_20_20-1242\\best_accuracy\\code\\modules\\transformation.py\",\r\nline 32, in forward\r\n    build_P_prime = self.GridGenerator.build_P_prime(batch_C_prime)  # batch_size x n (= I_r_width x I_r_height) x 2\r\n  File \"C:\\Users\\scottmcallister\\xact_model\\benchmark_model\\saved_models\\TPS-ResNet-BiLSTM-Attn\\07_20_20-1242\\best_accuracy\\code\\modules\\transformation.py\",\r\nline 158, in build_P_prime\r\n    batch_size, 3, 2).float().to(device)), dim=1)  # batch_size x F+3 x 2\r\nRuntimeError: Expected object of backend CUDA but got backend CPU for sequence element 0 in sequence argument at position #1 'tensors'\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/comments/661191179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"csmcallister","id":33464354,"node_id":"MDQ6VXNlcjMzNDY0MzU0","avatar_url":"https://avatars.githubusercontent.com/u/33464354?v=4","gravatar_id":"","url":"https://api.github.com/users/csmcallister","html_url":"https://github.com/csmcallister","followers_url":"https://api.github.com/users/csmcallister/followers","following_url":"https://api.github.com/users/csmcallister/following{/other_user}","gists_url":"https://api.github.com/users/csmcallister/gists{/gist_id}","starred_url":"https://api.github.com/users/csmcallister/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/csmcallister/subscriptions","organizations_url":"https://api.github.com/users/csmcallister/orgs","repos_url":"https://api.github.com/users/csmcallister/repos","events_url":"https://api.github.com/users/csmcallister/events{/privacy}","received_events_url":"https://api.github.com/users/csmcallister/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/comments/849420348","html_url":"https://github.com/clovaai/deep-text-recognition-benchmark/issues/170#issuecomment-849420348","issue_url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/170","id":849420348,"node_id":"MDEyOklzc3VlQ29tbWVudDg0OTQyMDM0OA==","user":{"login":"bharatsubedi","id":14069935,"node_id":"MDQ6VXNlcjE0MDY5OTM1","avatar_url":"https://avatars.githubusercontent.com/u/14069935?v=4","gravatar_id":"","url":"https://api.github.com/users/bharatsubedi","html_url":"https://github.com/bharatsubedi","followers_url":"https://api.github.com/users/bharatsubedi/followers","following_url":"https://api.github.com/users/bharatsubedi/following{/other_user}","gists_url":"https://api.github.com/users/bharatsubedi/gists{/gist_id}","starred_url":"https://api.github.com/users/bharatsubedi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bharatsubedi/subscriptions","organizations_url":"https://api.github.com/users/bharatsubedi/orgs","repos_url":"https://api.github.com/users/bharatsubedi/repos","events_url":"https://api.github.com/users/bharatsubedi/events{/privacy}","received_events_url":"https://api.github.com/users/bharatsubedi/received_events","type":"User","site_admin":false},"created_at":"2021-05-27T07:53:44Z","updated_at":"2021-05-27T07:53:44Z","author_association":"NONE","body":"@csmcallister did you convert `TPS-ResNet-BiLSTM-Attn` module to onnx format? could you please share the idea?","reactions":{"url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/comments/849420348/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bharatsubedi","id":14069935,"node_id":"MDQ6VXNlcjE0MDY5OTM1","avatar_url":"https://avatars.githubusercontent.com/u/14069935?v=4","gravatar_id":"","url":"https://api.github.com/users/bharatsubedi","html_url":"https://github.com/bharatsubedi","followers_url":"https://api.github.com/users/bharatsubedi/followers","following_url":"https://api.github.com/users/bharatsubedi/following{/other_user}","gists_url":"https://api.github.com/users/bharatsubedi/gists{/gist_id}","starred_url":"https://api.github.com/users/bharatsubedi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bharatsubedi/subscriptions","organizations_url":"https://api.github.com/users/bharatsubedi/orgs","repos_url":"https://api.github.com/users/bharatsubedi/repos","events_url":"https://api.github.com/users/bharatsubedi/events{/privacy}","received_events_url":"https://api.github.com/users/bharatsubedi/received_events","type":"User","site_admin":false}},{"id":4804003872,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDgwNDAwMzg3Mg==","url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/events/4804003872","actor":{"login":"csmcallister","id":33464354,"node_id":"MDQ6VXNlcjMzNDY0MzU0","avatar_url":"https://avatars.githubusercontent.com/u/33464354?v=4","gravatar_id":"","url":"https://api.github.com/users/csmcallister","html_url":"https://github.com/csmcallister","followers_url":"https://api.github.com/users/csmcallister/followers","following_url":"https://api.github.com/users/csmcallister/following{/other_user}","gists_url":"https://api.github.com/users/csmcallister/gists{/gist_id}","starred_url":"https://api.github.com/users/csmcallister/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/csmcallister/subscriptions","organizations_url":"https://api.github.com/users/csmcallister/orgs","repos_url":"https://api.github.com/users/csmcallister/repos","events_url":"https://api.github.com/users/csmcallister/events{/privacy}","received_events_url":"https://api.github.com/users/csmcallister/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-05-27T07:53:44Z","performed_via_github_app":null},{"id":4804003875,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ4MDQwMDM4NzU=","url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/events/4804003875","actor":{"login":"csmcallister","id":33464354,"node_id":"MDQ6VXNlcjMzNDY0MzU0","avatar_url":"https://avatars.githubusercontent.com/u/33464354?v=4","gravatar_id":"","url":"https://api.github.com/users/csmcallister","html_url":"https://github.com/csmcallister","followers_url":"https://api.github.com/users/csmcallister/followers","following_url":"https://api.github.com/users/csmcallister/following{/other_user}","gists_url":"https://api.github.com/users/csmcallister/gists{/gist_id}","starred_url":"https://api.github.com/users/csmcallister/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/csmcallister/subscriptions","organizations_url":"https://api.github.com/users/csmcallister/orgs","repos_url":"https://api.github.com/users/csmcallister/repos","events_url":"https://api.github.com/users/csmcallister/events{/privacy}","received_events_url":"https://api.github.com/users/csmcallister/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-05-27T07:53:44Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/comments/849920325","html_url":"https://github.com/clovaai/deep-text-recognition-benchmark/issues/170#issuecomment-849920325","issue_url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/170","id":849920325,"node_id":"MDEyOklzc3VlQ29tbWVudDg0OTkyMDMyNQ==","user":{"login":"csmcallister","id":33464354,"node_id":"MDQ6VXNlcjMzNDY0MzU0","avatar_url":"https://avatars.githubusercontent.com/u/33464354?v=4","gravatar_id":"","url":"https://api.github.com/users/csmcallister","html_url":"https://github.com/csmcallister","followers_url":"https://api.github.com/users/csmcallister/followers","following_url":"https://api.github.com/users/csmcallister/following{/other_user}","gists_url":"https://api.github.com/users/csmcallister/gists{/gist_id}","starred_url":"https://api.github.com/users/csmcallister/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/csmcallister/subscriptions","organizations_url":"https://api.github.com/users/csmcallister/orgs","repos_url":"https://api.github.com/users/csmcallister/repos","events_url":"https://api.github.com/users/csmcallister/events{/privacy}","received_events_url":"https://api.github.com/users/csmcallister/received_events","type":"User","site_admin":false},"created_at":"2021-05-27T20:29:48Z","updated_at":"2021-05-27T20:29:48Z","author_association":"NONE","body":"> @csmcallister did you convert `TPS-ResNet-BiLSTM-Attn` module to onnx format? could you please share the idea?\r\n\r\nUnfortunately not. Sorry!","reactions":{"url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/comments/849920325/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"csmcallister","id":33464354,"node_id":"MDQ6VXNlcjMzNDY0MzU0","avatar_url":"https://avatars.githubusercontent.com/u/33464354?v=4","gravatar_id":"","url":"https://api.github.com/users/csmcallister","html_url":"https://github.com/csmcallister","followers_url":"https://api.github.com/users/csmcallister/followers","following_url":"https://api.github.com/users/csmcallister/following{/other_user}","gists_url":"https://api.github.com/users/csmcallister/gists{/gist_id}","starred_url":"https://api.github.com/users/csmcallister/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/csmcallister/subscriptions","organizations_url":"https://api.github.com/users/csmcallister/orgs","repos_url":"https://api.github.com/users/csmcallister/repos","events_url":"https://api.github.com/users/csmcallister/events{/privacy}","received_events_url":"https://api.github.com/users/csmcallister/received_events","type":"User","site_admin":false}},{"id":4808093298,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDgwODA5MzI5OA==","url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/events/4808093298","actor":{"login":"csmcallister","id":33464354,"node_id":"MDQ6VXNlcjMzNDY0MzU0","avatar_url":"https://avatars.githubusercontent.com/u/33464354?v=4","gravatar_id":"","url":"https://api.github.com/users/csmcallister","html_url":"https://github.com/csmcallister","followers_url":"https://api.github.com/users/csmcallister/followers","following_url":"https://api.github.com/users/csmcallister/following{/other_user}","gists_url":"https://api.github.com/users/csmcallister/gists{/gist_id}","starred_url":"https://api.github.com/users/csmcallister/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/csmcallister/subscriptions","organizations_url":"https://api.github.com/users/csmcallister/orgs","repos_url":"https://api.github.com/users/csmcallister/repos","events_url":"https://api.github.com/users/csmcallister/events{/privacy}","received_events_url":"https://api.github.com/users/csmcallister/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-05-27T20:29:49Z","performed_via_github_app":null},{"id":4808093302,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ4MDgwOTMzMDI=","url":"https://api.github.com/repos/clovaai/deep-text-recognition-benchmark/issues/events/4808093302","actor":{"login":"csmcallister","id":33464354,"node_id":"MDQ6VXNlcjMzNDY0MzU0","avatar_url":"https://avatars.githubusercontent.com/u/33464354?v=4","gravatar_id":"","url":"https://api.github.com/users/csmcallister","html_url":"https://github.com/csmcallister","followers_url":"https://api.github.com/users/csmcallister/followers","following_url":"https://api.github.com/users/csmcallister/following{/other_user}","gists_url":"https://api.github.com/users/csmcallister/gists{/gist_id}","starred_url":"https://api.github.com/users/csmcallister/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/csmcallister/subscriptions","organizations_url":"https://api.github.com/users/csmcallister/orgs","repos_url":"https://api.github.com/users/csmcallister/repos","events_url":"https://api.github.com/users/csmcallister/events{/privacy}","received_events_url":"https://api.github.com/users/csmcallister/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-05-27T20:29:49Z","performed_via_github_app":null}]