{"url":"https://api.github.com/repos/asreview/asreview/issues/1274","repository_url":"https://api.github.com/repos/asreview/asreview","labels_url":"https://api.github.com/repos/asreview/asreview/issues/1274/labels{/name}","comments_url":"https://api.github.com/repos/asreview/asreview/issues/1274/comments","events_url":"https://api.github.com/repos/asreview/asreview/issues/1274/events","html_url":"https://github.com/asreview/asreview/issues/1274","id":1461066948,"node_id":"I_kwDOCdPKjs5XFhzE","number":1274,"title":"nn-2-layer with doc2vec simulation uses all available memory","user":{"login":"moeezm","id":26047425,"node_id":"MDQ6VXNlcjI2MDQ3NDI1","avatar_url":"https://avatars.githubusercontent.com/u/26047425?v=4","gravatar_id":"","url":"https://api.github.com/users/moeezm","html_url":"https://github.com/moeezm","followers_url":"https://api.github.com/users/moeezm/followers","following_url":"https://api.github.com/users/moeezm/following{/other_user}","gists_url":"https://api.github.com/users/moeezm/gists{/gist_id}","starred_url":"https://api.github.com/users/moeezm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/moeezm/subscriptions","organizations_url":"https://api.github.com/users/moeezm/orgs","repos_url":"https://api.github.com/users/moeezm/repos","events_url":"https://api.github.com/users/moeezm/events{/privacy}","received_events_url":"https://api.github.com/users/moeezm/received_events","type":"User","site_admin":false},"labels":[{"id":1186392107,"node_id":"MDU6TGFiZWwxMTg2MzkyMTA3","url":"https://api.github.com/repos/asreview/asreview/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-11-23T05:46:51Z","updated_at":"2022-11-23T05:46:51Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nI ran a simulation using nn-2-layer and doc2vec on a server and it always crashes after using all the memory I give it. I originally ran it on a server node with 5G of memory and that crashed so I reran it with 20G and it still crashed. I don't think it's a doc2vec issue by itself because running logistic with doc2vec worked fine.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the problem:\r\nRun a simulation using the Python API with nn-2-layer and doc2vec. Here's the code:\r\n```python\r\nwhile True:\r\n    try:\r\n        project = ASReviewProject.create(\r\n            project_path=f\"{PROJECT_NAME}\",\r\n            project_id=PROJECT_NAME,\r\n            project_mode=\"simulate\",\r\n            project_name=PROJECT_NAME\r\n        )\r\n        break\r\n    except asreview.project.ProjectExistsError:\r\n        shutil.rmtree(f\"{PROJECT_NAME}\")\r\nproject.add_dataset(f\"{FOLDER}/{DATASET_FOLDER}/{DATASET}.csv\")\r\n\r\nclassifier = asreview.models.classifiers.get_classifier(CLASSIFIER)\r\nfeature = asreview.models.feature_extraction.get_feature_model(FEATURE_EXTRACTION)\r\nquery = asreview.models.query.MaxQuery()\r\nbalance = asreview.models.balance.DoubleBalance()\r\n\r\nprint(f\"Simulating classifier {CLASSIFIER} with feature-extraction {FEATURE_EXTRACTION} on {DATASET} dataset with {PRIORS} priors\")\r\n\r\nreviewer = ReviewSimulate(\r\n    as_data = ASReviewData.from_file(f\"{FOLDER}/{DATASET_FOLDER}/{DATASET}.csv\"),\r\n    model = classifier,\r\n    query_model = query,\r\n    balance_model = balance,\r\n    feature_model = feature,\r\n    project = project,\r\n    n_prior_excluded=PRIORS,\r\n    n_prior_included=PRIORS\r\n)\r\nproject.update_review(status=\"review\")\r\nreviewer.review()\r\nproject.export(f\"{FOLDER}/{EXPORT_FOLDER}/{PROJECT_NAME}/{DATASET}.asreview\")\r\n```\r\n`CLASSIFIER` and `FEATURE_EXTRACTION` are `nn-2-layer` and `doc2vec`, respectively.\r\n\r\n**Screenshots**\r\nHere's a screenshot showing the output log\r\n![image](https://user-images.githubusercontent.com/26047425/203477493-381c4d02-36fd-4f14-badb-6093e2dff660.png)\r\n\r\n**Version information**\r\n - OS: Windows 10\r\n - ASReview version: 1.1\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/asreview/asreview/issues/1274/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/asreview/asreview/issues/1274/timeline","performed_via_github_app":null,"state_reason":null}