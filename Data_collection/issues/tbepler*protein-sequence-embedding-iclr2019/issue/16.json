{"url":"https://api.github.com/repos/tbepler/protein-sequence-embedding-iclr2019/issues/16","repository_url":"https://api.github.com/repos/tbepler/protein-sequence-embedding-iclr2019","labels_url":"https://api.github.com/repos/tbepler/protein-sequence-embedding-iclr2019/issues/16/labels{/name}","comments_url":"https://api.github.com/repos/tbepler/protein-sequence-embedding-iclr2019/issues/16/comments","events_url":"https://api.github.com/repos/tbepler/protein-sequence-embedding-iclr2019/issues/16/events","html_url":"https://github.com/tbepler/protein-sequence-embedding-iclr2019/issues/16","id":543824839,"node_id":"MDU6SXNzdWU1NDM4MjQ4Mzk=","number":16,"title":"RuntimeError in training scripts","user":{"login":"DaHaiHuha","id":38548370,"node_id":"MDQ6VXNlcjM4NTQ4Mzcw","avatar_url":"https://avatars.githubusercontent.com/u/38548370?v=4","gravatar_id":"","url":"https://api.github.com/users/DaHaiHuha","html_url":"https://github.com/DaHaiHuha","followers_url":"https://api.github.com/users/DaHaiHuha/followers","following_url":"https://api.github.com/users/DaHaiHuha/following{/other_user}","gists_url":"https://api.github.com/users/DaHaiHuha/gists{/gist_id}","starred_url":"https://api.github.com/users/DaHaiHuha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaHaiHuha/subscriptions","organizations_url":"https://api.github.com/users/DaHaiHuha/orgs","repos_url":"https://api.github.com/users/DaHaiHuha/repos","events_url":"https://api.github.com/users/DaHaiHuha/events{/privacy}","received_events_url":"https://api.github.com/users/DaHaiHuha/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-12-30T10:15:04Z","updated_at":"2019-12-31T03:35:07Z","closed_at":"2019-12-31T03:35:07Z","author_association":"NONE","active_lock_reason":null,"body":"with the default parameters in repo, RuntimeError occurs in train_similarity_and_contact.py\r\n```\r\nTraceback (most recent call last):\r\n  File \"*/.pycharm_helpers/pydev/pydevd.py\", line 1415, in _exec\r\n    pydev_imports.execfile(file, globals, locals)  # execute the script\r\n  File \"*/.pycharm_helpers/pydev/_pydev_imps/_pydev_execfile.py\", line 18, in execfile\r\n    exec(compile(contents+\"\\n\", file, 'exec'), glob, loc)\r\n  File \"*/protein-sequence-embedding-iclr2019/train_similarity_and_contact.py\", line 587, in <module>\r\n    main()\r\n  File \"*/protein-sequence-embedding-iclr2019/train_similarity_and_contact.py\", line 508, in main\r\n    for (cmap_x, cmap_y), (scop_x0, scop_x1, scop_y) in zip(cmap_train_iterator, scop_train_iterator):\r\n  File \"*/anaconda3/envs/iclr/lib/python3.7/site-packages/torch/utils/data/dataloader.py\", line 345, in __next__\r\n    index = self._next_index()  # may raise StopIteration\r\n  File \"*/anaconda3/envs/iclr/lib/python3.7/site-packages/torch/utils/data/dataloader.py\", line 318, in _next_index\r\n    return next(self._sampler_iter)  # may raise StopIteration\r\n  File \"*/anaconda3/envs/iclr/lib/python3.7/site-packages/torch/utils/data/sampler.py\", line 200, in __iter__\r\n    for idx in self.sampler:\r\n  File \"*/anaconda3/envs/iclr/lib/python3.7/site-packages/torch/utils/data/sampler.py\", line 160, in __iter__\r\n    return iter(torch.multinomial(self.weights, self.num_samples, self.replacement).tolist())\r\nRuntimeError: number of categories cannot exceed 2^24\r\n```\r\n\r\nIt seems that there's a BUG in WeightedRandomSampler, could be pytorch version's problem, so any ideas for solving this? Or @tbepler could you please provide the version number of the pytorch when you developed it? Thanks!","closed_by":{"login":"DaHaiHuha","id":38548370,"node_id":"MDQ6VXNlcjM4NTQ4Mzcw","avatar_url":"https://avatars.githubusercontent.com/u/38548370?v=4","gravatar_id":"","url":"https://api.github.com/users/DaHaiHuha","html_url":"https://github.com/DaHaiHuha","followers_url":"https://api.github.com/users/DaHaiHuha/followers","following_url":"https://api.github.com/users/DaHaiHuha/following{/other_user}","gists_url":"https://api.github.com/users/DaHaiHuha/gists{/gist_id}","starred_url":"https://api.github.com/users/DaHaiHuha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaHaiHuha/subscriptions","organizations_url":"https://api.github.com/users/DaHaiHuha/orgs","repos_url":"https://api.github.com/users/DaHaiHuha/repos","events_url":"https://api.github.com/users/DaHaiHuha/events{/privacy}","received_events_url":"https://api.github.com/users/DaHaiHuha/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/tbepler/protein-sequence-embedding-iclr2019/issues/16/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tbepler/protein-sequence-embedding-iclr2019/issues/16/timeline","performed_via_github_app":null,"state_reason":"completed"}