[{"id":5389399019,"node_id":"LE_lADOCgoJts48WNd6zwAAAAFBO7Pr","url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events/5389399019","actor":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-09-30T17:47:30Z","label":{"name":"enhancement","color":"0e8a16"},"performed_via_github_app":null},{"id":5389399022,"node_id":"LE_lADOCgoJts48WNd6zwAAAAFBO7Pu","url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events/5389399022","actor":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-09-30T17:47:30Z","label":{"name":"discussion","color":"fef2c0"},"performed_via_github_app":null},{"actor":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false},"created_at":"2021-10-05T16:43:52Z","updated_at":"2021-10-05T16:43:52Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/564","repository_url":"https://api.github.com/repos/pyro-ppl/funsor","labels_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/564/labels{/name}","comments_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/564/comments","events_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/564/events","html_url":"https://github.com/pyro-ppl/funsor/pull/564","id":1016545193,"node_id":"PR_kwDOCgoJts4stOxF","number":564,"title":"Optimize ops.triangular_solve() for 1x1 matrices","user":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false},"labels":[{"id":1243847501,"node_id":"MDU6TGFiZWwxMjQzODQ3NTAx","url":"https://api.github.com/repos/pyro-ppl/funsor/labels/awaiting%20review","name":"awaiting review","color":"fbca04","default":false,"description":""},{"id":1251701144,"node_id":"MDU6TGFiZWwxMjUxNzAxMTQ0","url":"https://api.github.com/repos/pyro-ppl/funsor/labels/easy","name":"easy","color":"0e8a16","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-10-05T16:43:51Z","updated_at":"2021-10-05T17:52:24Z","closed_at":"2021-10-05T17:52:23Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"repository":{"id":168430006,"node_id":"MDEwOlJlcG9zaXRvcnkxNjg0MzAwMDY=","name":"funsor","full_name":"pyro-ppl/funsor","private":false,"owner":{"login":"pyro-ppl","id":46794900,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ2Nzk0OTAw","avatar_url":"https://avatars.githubusercontent.com/u/46794900?v=4","gravatar_id":"","url":"https://api.github.com/users/pyro-ppl","html_url":"https://github.com/pyro-ppl","followers_url":"https://api.github.com/users/pyro-ppl/followers","following_url":"https://api.github.com/users/pyro-ppl/following{/other_user}","gists_url":"https://api.github.com/users/pyro-ppl/gists{/gist_id}","starred_url":"https://api.github.com/users/pyro-ppl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyro-ppl/subscriptions","organizations_url":"https://api.github.com/users/pyro-ppl/orgs","repos_url":"https://api.github.com/users/pyro-ppl/repos","events_url":"https://api.github.com/users/pyro-ppl/events{/privacy}","received_events_url":"https://api.github.com/users/pyro-ppl/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/pyro-ppl/funsor","description":"Functional tensors for probabilistic programming","fork":false,"url":"https://api.github.com/repos/pyro-ppl/funsor","forks_url":"https://api.github.com/repos/pyro-ppl/funsor/forks","keys_url":"https://api.github.com/repos/pyro-ppl/funsor/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pyro-ppl/funsor/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pyro-ppl/funsor/teams","hooks_url":"https://api.github.com/repos/pyro-ppl/funsor/hooks","issue_events_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events{/number}","events_url":"https://api.github.com/repos/pyro-ppl/funsor/events","assignees_url":"https://api.github.com/repos/pyro-ppl/funsor/assignees{/user}","branches_url":"https://api.github.com/repos/pyro-ppl/funsor/branches{/branch}","tags_url":"https://api.github.com/repos/pyro-ppl/funsor/tags","blobs_url":"https://api.github.com/repos/pyro-ppl/funsor/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pyro-ppl/funsor/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pyro-ppl/funsor/git/refs{/sha}","trees_url":"https://api.github.com/repos/pyro-ppl/funsor/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pyro-ppl/funsor/statuses/{sha}","languages_url":"https://api.github.com/repos/pyro-ppl/funsor/languages","stargazers_url":"https://api.github.com/repos/pyro-ppl/funsor/stargazers","contributors_url":"https://api.github.com/repos/pyro-ppl/funsor/contributors","subscribers_url":"https://api.github.com/repos/pyro-ppl/funsor/subscribers","subscription_url":"https://api.github.com/repos/pyro-ppl/funsor/subscription","commits_url":"https://api.github.com/repos/pyro-ppl/funsor/commits{/sha}","git_commits_url":"https://api.github.com/repos/pyro-ppl/funsor/git/commits{/sha}","comments_url":"https://api.github.com/repos/pyro-ppl/funsor/comments{/number}","issue_comment_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments{/number}","contents_url":"https://api.github.com/repos/pyro-ppl/funsor/contents/{+path}","compare_url":"https://api.github.com/repos/pyro-ppl/funsor/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pyro-ppl/funsor/merges","archive_url":"https://api.github.com/repos/pyro-ppl/funsor/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pyro-ppl/funsor/downloads","issues_url":"https://api.github.com/repos/pyro-ppl/funsor/issues{/number}","pulls_url":"https://api.github.com/repos/pyro-ppl/funsor/pulls{/number}","milestones_url":"https://api.github.com/repos/pyro-ppl/funsor/milestones{/number}","notifications_url":"https://api.github.com/repos/pyro-ppl/funsor/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pyro-ppl/funsor/labels{/name}","releases_url":"https://api.github.com/repos/pyro-ppl/funsor/releases{/id}","deployments_url":"https://api.github.com/repos/pyro-ppl/funsor/deployments","created_at":"2019-01-30T23:13:39Z","updated_at":"2023-01-03T19:08:54Z","pushed_at":"2022-12-28T19:16:12Z","git_url":"git://github.com/pyro-ppl/funsor.git","ssh_url":"git@github.com:pyro-ppl/funsor.git","clone_url":"https://github.com/pyro-ppl/funsor.git","svn_url":"https://github.com/pyro-ppl/funsor","homepage":"https://funsor.pyro.ai","size":2622,"stargazers_count":209,"watchers_count":209,"language":"Python","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":18,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":89,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["jax","machine-learning","numpy","probabilistic-programming","pyro","pytorch","symbolic"],"visibility":"public","forks":18,"open_issues":89,"watchers":209,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/pyro-ppl/funsor/pulls/564","html_url":"https://github.com/pyro-ppl/funsor/pull/564","diff_url":"https://github.com/pyro-ppl/funsor/pull/564.diff","patch_url":"https://github.com/pyro-ppl/funsor/pull/564.patch","merged_at":"2021-10-05T17:52:23Z"},"body":"Addresses #559 \r\n\r\nThis adds a scalar special case for the torch implementation of `ops.triangular_solve`. This op is frequently used in Gaussian funsor variable elimination, and the scalar case is very common.\r\n\r\n## Profiling results\r\nI've tested on both a profiling jig (big speedup!) and the full [pyro-cov model](https://github.com/broadinstitute/pyro-cov/blob/9496e8d2d78239950f58470afd516b9dd9e5d594/pyrocov/mutrans.py#L400) (minor speedup). The jig is invoked via\r\n```sh\r\nFUNSOR_PROFILE=100 python -m tests.infer.autoguide.test_gaussian -s 700 -n 10 --cuda --no-jit\r\n```\r\nThe full model is invoked with the jit enabled.\r\n\r\n**Before:** full model speed = 11.14 iters/sec\r\n\r\n<details>\r\n\r\n```\r\n     count triangular_solve(b.shape, A.shape)\r\n       682 total\r\n       341 ((1, 1), (1, 1))\r\n        88 ((701, 702, 1, 1), (701, 702, 1, 1))\r\n        88 ((702, 1, 1), (702, 1, 1))\r\n        44 ((50, 701, 1, 1), (50, 701, 1, 1))\r\n        44 ((703, 1), (703, 703))\r\n        22 ((701, 702, 1, 2), (701, 702, 1, 1))\r\n        11 ((50, 701, 1, 2), (50, 701, 1, 1))\r\n        11 ((702, 1, 2), (702, 1, 1))\r\n        11 ((702, 1, 705), (702, 1, 1))\r\n        11 ((703, 3), (703, 703))\r\n        11 ((1, 2), (1, 1))\r\n```\r\n```\r\n      time triangular_solve(b.shape, A.shape)\r\n  1.359707 total\r\n  0.889114 ((702, 1, 705), (702, 1, 1))\r\n  0.213148 ((701, 702, 1, 1), (701, 702, 1, 1))\r\n  0.125360 ((702, 1, 1), (702, 1, 1))\r\n  0.050415 ((1, 1), (1, 1))\r\n  0.048711 ((701, 702, 1, 2), (701, 702, 1, 1))\r\n  0.013856 ((50, 701, 1, 1), (50, 701, 1, 1))\r\n  0.009279 ((703, 1), (703, 703))\r\n  0.003506 ((50, 701, 1, 2), (50, 701, 1, 1))\r\n  0.002740 ((703, 3), (703, 703))\r\n  0.001800 ((702, 1, 2), (702, 1, 1))\r\n  0.001777 ((1, 2), (1, 1))\r\n```\r\n\r\n</details>\r\n\r\n**After:** full model speed = 11.75 iters/sec\r\n\r\n<details>\r\n\r\n```\r\n     count triangular_solve(b.shape, A.shape)\r\n       682 total\r\n       341 ((1, 1), (1, 1))\r\n        88 ((701, 702, 1, 1), (701, 702, 1, 1))\r\n        88 ((702, 1, 1), (702, 1, 1))\r\n        44 ((50, 701, 1, 1), (50, 701, 1, 1))\r\n        44 ((703, 1), (703, 703))\r\n        22 ((701, 702, 1, 2), (701, 702, 1, 1))\r\n        11 ((50, 701, 1, 2), (50, 701, 1, 1))\r\n        11 ((702, 1, 2), (702, 1, 1))\r\n        11 ((702, 1, 705), (702, 1, 1))\r\n        11 ((703, 3), (703, 703))\r\n        11 ((1, 2), (1, 1))\r\n```\r\n```\r\n      time triangular_solve(b.shape, A.shape)\r\n  0.035639 total\r\n  0.012077 ((1, 1), (1, 1))\r\n  0.009859 ((703, 1), (703, 703))\r\n  0.003245 ((702, 1, 1), (702, 1, 1))\r\n  0.003106 ((701, 702, 1, 1), (701, 702, 1, 1))\r\n  0.003078 ((703, 3), (703, 703))\r\n  0.001585 ((50, 701, 1, 1), (50, 701, 1, 1))\r\n  0.000910 ((701, 702, 1, 2), (701, 702, 1, 1))\r\n  0.000463 ((702, 1, 705), (702, 1, 1))\r\n  0.000459 ((50, 701, 1, 2), (50, 701, 1, 1))\r\n  0.000438 ((702, 1, 2), (702, 1, 1))\r\n  0.000419 ((1, 2), (1, 1))\r\n```\r\n\r\n</details>\r\n\r\n## Tested\r\n- [x] added a unit test","reactions":{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/564/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments/934676309","html_url":"https://github.com/pyro-ppl/funsor/issues/559#issuecomment-934676309","issue_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/559","id":934676309,"node_id":"IC_kwDOCgoJts43tgdV","user":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false},"created_at":"2021-10-05T18:48:10Z","updated_at":"2021-10-06T00:18:13Z","author_association":"MEMBER","body":"@eb8680 it looks like `AutoGaussian(pyrocov_model)` runs out of GPU memory in constructing a low-rank  matrices `precision = sqrt @ sqrt.T`. One possible solution is to use a sqrt(precision) representation in funsor's `Gaussian`. I guess the crux is whether we can implement cheap [Gaussian tensordot](https://github.com/pyro-ppl/funsor/issues/238) without materializing intermediate low-rank precision matrices. @fehiepsi already worked out most of the sqrt representation in [Pyro PR #2019](https://github.com/pyro-ppl/pyro/pull/2019), where `ops.add` becomes mere concatenation.\r\n\r\n@fehiepsi how much effort do you think it would it take for us to port your [Pyro PR #2019](https://github.com/pyro-ppl/pyro/pull/2019) to funsor (where it would also be available in NumPyro 😉)?","reactions":{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments/934676309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false}},{"id":5412751740,"node_id":"MEE_lADOCgoJts48WNd6zwAAAAFCoAl8","url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events/5412751740","actor":{"login":"eb8680","id":2032320,"node_id":"MDQ6VXNlcjIwMzIzMjA=","avatar_url":"https://avatars.githubusercontent.com/u/2032320?v=4","gravatar_id":"","url":"https://api.github.com/users/eb8680","html_url":"https://github.com/eb8680","followers_url":"https://api.github.com/users/eb8680/followers","following_url":"https://api.github.com/users/eb8680/following{/other_user}","gists_url":"https://api.github.com/users/eb8680/gists{/gist_id}","starred_url":"https://api.github.com/users/eb8680/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eb8680/subscriptions","organizations_url":"https://api.github.com/users/eb8680/orgs","repos_url":"https://api.github.com/users/eb8680/repos","events_url":"https://api.github.com/users/eb8680/events{/privacy}","received_events_url":"https://api.github.com/users/eb8680/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-05T18:48:11Z","performed_via_github_app":null},{"id":5412751743,"node_id":"SE_lADOCgoJts48WNd6zwAAAAFCoAl_","url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events/5412751743","actor":{"login":"eb8680","id":2032320,"node_id":"MDQ6VXNlcjIwMzIzMjA=","avatar_url":"https://avatars.githubusercontent.com/u/2032320?v=4","gravatar_id":"","url":"https://api.github.com/users/eb8680","html_url":"https://github.com/eb8680","followers_url":"https://api.github.com/users/eb8680/followers","following_url":"https://api.github.com/users/eb8680/following{/other_user}","gists_url":"https://api.github.com/users/eb8680/gists{/gist_id}","starred_url":"https://api.github.com/users/eb8680/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eb8680/subscriptions","organizations_url":"https://api.github.com/users/eb8680/orgs","repos_url":"https://api.github.com/users/eb8680/repos","events_url":"https://api.github.com/users/eb8680/events{/privacy}","received_events_url":"https://api.github.com/users/eb8680/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-05T18:48:11Z","performed_via_github_app":null},{"id":5412751745,"node_id":"MEE_lADOCgoJts48WNd6zwAAAAFCoAmB","url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events/5412751745","actor":{"login":"fehiepsi","id":4736342,"node_id":"MDQ6VXNlcjQ3MzYzNDI=","avatar_url":"https://avatars.githubusercontent.com/u/4736342?v=4","gravatar_id":"","url":"https://api.github.com/users/fehiepsi","html_url":"https://github.com/fehiepsi","followers_url":"https://api.github.com/users/fehiepsi/followers","following_url":"https://api.github.com/users/fehiepsi/following{/other_user}","gists_url":"https://api.github.com/users/fehiepsi/gists{/gist_id}","starred_url":"https://api.github.com/users/fehiepsi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fehiepsi/subscriptions","organizations_url":"https://api.github.com/users/fehiepsi/orgs","repos_url":"https://api.github.com/users/fehiepsi/repos","events_url":"https://api.github.com/users/fehiepsi/events{/privacy}","received_events_url":"https://api.github.com/users/fehiepsi/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-05T18:48:11Z","performed_via_github_app":null},{"id":5412751747,"node_id":"SE_lADOCgoJts48WNd6zwAAAAFCoAmD","url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events/5412751747","actor":{"login":"fehiepsi","id":4736342,"node_id":"MDQ6VXNlcjQ3MzYzNDI=","avatar_url":"https://avatars.githubusercontent.com/u/4736342?v=4","gravatar_id":"","url":"https://api.github.com/users/fehiepsi","html_url":"https://github.com/fehiepsi","followers_url":"https://api.github.com/users/fehiepsi/followers","following_url":"https://api.github.com/users/fehiepsi/following{/other_user}","gists_url":"https://api.github.com/users/fehiepsi/gists{/gist_id}","starred_url":"https://api.github.com/users/fehiepsi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fehiepsi/subscriptions","organizations_url":"https://api.github.com/users/fehiepsi/orgs","repos_url":"https://api.github.com/users/fehiepsi/repos","events_url":"https://api.github.com/users/fehiepsi/events{/privacy}","received_events_url":"https://api.github.com/users/fehiepsi/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-05T18:48:11Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments/935130575","html_url":"https://github.com/pyro-ppl/funsor/issues/559#issuecomment-935130575","issue_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/559","id":935130575,"node_id":"IC_kwDOCgoJts43vPXP","user":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false},"created_at":"2021-10-06T00:17:59Z","updated_at":"2021-10-06T01:54:11Z","author_association":"MEMBER","body":"Here is the optimized GFVE schedule for my pyro-cov model. It fits in main memory but runs out of GPU memory.\r\n\r\n<details>\r\n\r\n```\r\nContraction(ops.null, ops.add,\r\n frozenset(),\r\n (Contraction(ops.logaddexp, ops.add,\r\n   frozenset({Variable('rate_loc_scale__BOUND_13', Real)}),\r\n   (Gaussian(\r\n   │ torch.tensor(...1..., dtype=torch.float32),\r\n   │ torch.tensor(...1 x 1..., dtype=torch.float32),\r\n   │ (('rate_loc_scale__BOUND_13', Real),)),\r\n   │Contraction(ops.logaddexp, ops.add,\r\n   │ frozenset({Variable('rate_scale__BOUND_14', Real)}),\r\n   │ (Gaussian(\r\n   │   torch.tensor(...1..., dtype=torch.float32),\r\n   │   torch.tensor(...1 x 1..., dtype=torch.float32),\r\n   │   (('rate_scale__BOUND_14', Real),)),\r\n   │  Contraction(ops.logaddexp, ops.add,\r\n   │   frozenset({Variable('coef__BOUND_12', Reals[2367])}),\r\n   │   (Gaussian(\r\n   │   │ torch.tensor(...2367..., dtype=torch.float32),\r\n   │   │ torch.tensor(...2367 x 2367..., dtype=torch.float32),\r\n   │   │ (('coef__BOUND_12', Reals[2367]),)),\r\n   │   │Contraction(ops.add, ops.null,\r\n   │   │ frozenset({Variable('strain__BOUND_11', Bint[1343])}),\r\n   │   │ (Contraction(ops.logaddexp, ops.add,\r\n   │   │   frozenset({Variable('rate_loc__BOUND_10', Real)}),\r\n   │   │   (Gaussian(\r\n   │   │   │ torch.tensor(...1343 x 2369..., dtype=torch.float32),\r\n   │   │   │ torch.tensor(...1343 x 2369 x 2369..., dtype=torch.float32),\r\n   │   │   │ (('strain__BOUND_11', Bint[1343]),\r\n   │   │   │  ('rate_loc__BOUND_10', Real),\r\n   │   │   │  ('rate_loc_scale__BOUND_13', Real),\r\n   │   │   │  ('coef__BOUND_12', Reals[2367]),)),\r\n   │   │   │Contraction(ops.add, ops.null,\r\n   │   │   │ frozenset({Variable('place__BOUND_4', Bint[1372])}),\r\n   │   │   │ (Contraction(ops.logaddexp, ops.null,\r\n   │   │   │   frozenset({Variable('rate__BOUND_3', Real)}),\r\n   │   │   │   (Gaussian(\r\n   │   │   │   │ torch.tensor(...1372 x 1343 x 3..., dtype=torch.float32),\r\n   │   │   │   │ torch.tensor(...1372 x 1343 x 3 x 3..., dtype=torch.float32),\r\n   │   │   │   │ (('place__BOUND_4', Bint[1372]),\r\n   │   │   │   │  ('strain__BOUND_11', Bint[1343]),\r\n   │   │   │   │  ('rate__BOUND_3', Real),\r\n   │   │   │   │  ('rate_scale__BOUND_14', Real),\r\n   │   │   │   │  ('rate_loc__BOUND_10', Real),)),)),)),)),)),)),)),)),\r\n  Contraction(ops.null, ops.add,\r\n   frozenset(),\r\n   (Contraction(ops.logaddexp, ops.add,\r\n   │ frozenset({Variable('pois_loc__BOUND_16', Real)}),\r\n   │ (Gaussian(\r\n   │   torch.tensor(...1..., dtype=torch.float32),\r\n   │   torch.tensor(...1 x 1..., dtype=torch.float32),\r\n   │   (('pois_loc__BOUND_16', Real),)),\r\n   │  Contraction(ops.logaddexp, ops.add,\r\n   │   frozenset({Variable('pois_scale__BOUND_15', Real)}),\r\n   │   (Gaussian(\r\n   │   │ torch.tensor(...1..., dtype=torch.float32),\r\n   │   │ torch.tensor(...1 x 1..., dtype=torch.float32),\r\n   │   │ (('pois_scale__BOUND_15', Real),)),\r\n   │   │Contraction(ops.add, ops.null,\r\n   │   │ frozenset({Variable('place__BOUND_6', Bint[1372]), Variable('time__BOUND_7', Bint[49])}),\r\n   │   │ (Contraction(ops.logaddexp, ops.null,\r\n   │   │   frozenset({Variable('pois__BOUND_5', Real)}),\r\n   │   │   (Gaussian(\r\n   │   │   │ torch.tensor(...49 x 1372 x 3..., dtype=torch.float32),\r\n   │   │   │ torch.tensor(...49 x 1372 x 3 x 3..., dtype=torch.float32),\r\n   │   │   │ (('time__BOUND_7', Bint[49]),\r\n   │   │   │  ('place__BOUND_6', Bint[1372]),\r\n   │   │   │  ('pois__BOUND_5', Real),\r\n   │   │   │  ('pois_loc__BOUND_16', Real),\r\n   │   │   │  ('pois_scale__BOUND_15', Real),)),)),)),)),)),\r\n   │Contraction(ops.logaddexp, ops.add,\r\n   │ frozenset({Variable('init_loc_scale__BOUND_17', Real)}),\r\n   │ (Gaussian(\r\n   │   torch.tensor(...1..., dtype=torch.float32),\r\n   │   torch.tensor(...1 x 1..., dtype=torch.float32),\r\n   │   (('init_loc_scale__BOUND_17', Real),)),\r\n   │  Contraction(ops.logaddexp, ops.add,\r\n   │   frozenset({Variable('init_scale__BOUND_18', Real)}),\r\n   │   (Gaussian(\r\n   │   │ torch.tensor(...1..., dtype=torch.float32),\r\n   │   │ torch.tensor(...1 x 1..., dtype=torch.float32),\r\n   │   │ (('init_scale__BOUND_18', Real),)),\r\n   │   │Contraction(ops.add, ops.null,\r\n   │   │ frozenset({Variable('strain__BOUND_9', Bint[1343])}),\r\n   │   │ (Contraction(ops.logaddexp, ops.add,\r\n   │   │   frozenset({Variable('init_loc__BOUND_8', Real)}),\r\n   │   │   (Gaussian(\r\n   │   │   │ torch.tensor(...1343 x 2..., dtype=torch.float32),\r\n   │   │   │ torch.tensor(...1343 x 2 x 2..., dtype=torch.float32),\r\n   │   │   │ (('strain__BOUND_9', Bint[1343]),\r\n   │   │   │  ('init_loc__BOUND_8', Real),\r\n   │   │   │  ('init_loc_scale__BOUND_17', Real),)),\r\n   │   │   │Contraction(ops.add, ops.null,\r\n   │   │   │ frozenset({Variable('place__BOUND_2', Bint[1372])}),\r\n   │   │   │ (Contraction(ops.logaddexp, ops.null,\r\n   │   │   │   frozenset({Variable('init__BOUND_1', Real)}),\r\n   │   │   │   (Gaussian(\r\n   │   │   │   │ torch.tensor(...1372 x 1343 x 3..., dtype=torch.float32),\r\n   │   │   │   │ torch.tensor(...1372 x 1343 x 3 x 3..., dtype=torch.float32),\r\n   │   │   │   │ (('place__BOUND_2', Bint[1372]),\r\n   │   │   │   │  ('strain__BOUND_9', Bint[1343]),\r\n   │   │   │   │  ('init__BOUND_1', Real),\r\n   │   │   │   │  ('init_scale__BOUND_18', Real),\r\n   │   │   │   │  ('init_loc__BOUND_8', Real),)),)),)),)),)),)),)),)),))\r\n```\r\n\r\n</details>\r\n\r\nThe crux is this pair of Gaussian contractions with over 1e9 elements\r\n\r\n<details>\r\n\r\n```\r\n   │  Contraction(ops.logaddexp, ops.add,\r\n   │   frozenset({Variable('coef__BOUND_12', Reals[2367])}),\r\n   │   (Gaussian(\r\n   │   │ torch.tensor(...2367..., dtype=torch.float32),\r\n   │   │ torch.tensor(...2367 x 2367..., dtype=torch.float32),\r\n   │   │ (('coef__BOUND_12', Reals[2367]),)),\r\n   │   │Contraction(ops.add, ops.null,\r\n   │   │ frozenset({Variable('strain__BOUND_11', Bint[1343])}),\r\n   │   │ (Contraction(ops.logaddexp, ops.add,\r\n   │   │   frozenset({Variable('rate_loc__BOUND_10', Real)}),\r\n   │   │   (Gaussian(\r\n   │   │   │ torch.tensor(...1343 x 2369..., dtype=torch.float32),\r\n   │   │   │ torch.tensor(...1343 x 2369 x 2369..., dtype=torch.float32),  # <-------- OOM here\r\n   │   │   │ (('strain__BOUND_11', Bint[1343]),\r\n   │   │   │  ('rate_loc__BOUND_10', Real),\r\n   │   │   │  ('rate_loc_scale__BOUND_13', Real),\r\n   │   │   │  ('coef__BOUND_12', Reals[2367]),)),\r\n   │   │   │Contraction(ops.add, ops.null,\r\n   │   │   │ frozenset({Variable('place__BOUND_4', Bint[1372])}),\r\n   │   │   │ (Contraction(ops.logaddexp, ops.null,\r\n   │   │   │   frozenset({Variable('rate__BOUND_3', Real)}),\r\n   │   │   │   (Gaussian(\r\n   │   │   │   │ torch.tensor(...1372 x 1343 x 3..., dtype=torch.float32),\r\n   │   │   │   │ torch.tensor(...1372 x 1343 x 3 x 3..., dtype=torch.float32),\r\n   │   │   │   │ (('place__BOUND_4', Bint[1372]),\r\n   │   │   │   │  ('strain__BOUND_11', Bint[1343]),\r\n   │   │   │   │  ('rate__BOUND_3', Real),\r\n   │   │   │   │  ('rate_scale__BOUND_14', Real),\r\n   │   │   │   │  ('rate_loc__BOUND_10', Real),)),)),)),)),)),)),)),)),\r\n```\r\n\r\n</details>\r\n\r\nI believe we can work around this using a combination of @fehiepsi's `prec_sqrt` representation https://github.com/pyro-ppl/pyro/pull/2019 and a `ConditionalGaussian` that generalizes `AffineNormal`. Happy to discuss.","reactions":{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments/935130575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false}},{"id":5414736709,"node_id":"MEE_lADOCgoJts48WNd6zwAAAAFCvlNF","url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events/5414736709","actor":{"login":"fehiepsi","id":4736342,"node_id":"MDQ6VXNlcjQ3MzYzNDI=","avatar_url":"https://avatars.githubusercontent.com/u/4736342?v=4","gravatar_id":"","url":"https://api.github.com/users/fehiepsi","html_url":"https://github.com/fehiepsi","followers_url":"https://api.github.com/users/fehiepsi/followers","following_url":"https://api.github.com/users/fehiepsi/following{/other_user}","gists_url":"https://api.github.com/users/fehiepsi/gists{/gist_id}","starred_url":"https://api.github.com/users/fehiepsi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fehiepsi/subscriptions","organizations_url":"https://api.github.com/users/fehiepsi/orgs","repos_url":"https://api.github.com/users/fehiepsi/repos","events_url":"https://api.github.com/users/fehiepsi/events{/privacy}","received_events_url":"https://api.github.com/users/fehiepsi/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-06T00:17:59Z","performed_via_github_app":null},{"id":5414736715,"node_id":"SE_lADOCgoJts48WNd6zwAAAAFCvlNL","url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events/5414736715","actor":{"login":"fehiepsi","id":4736342,"node_id":"MDQ6VXNlcjQ3MzYzNDI=","avatar_url":"https://avatars.githubusercontent.com/u/4736342?v=4","gravatar_id":"","url":"https://api.github.com/users/fehiepsi","html_url":"https://github.com/fehiepsi","followers_url":"https://api.github.com/users/fehiepsi/followers","following_url":"https://api.github.com/users/fehiepsi/following{/other_user}","gists_url":"https://api.github.com/users/fehiepsi/gists{/gist_id}","starred_url":"https://api.github.com/users/fehiepsi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fehiepsi/subscriptions","organizations_url":"https://api.github.com/users/fehiepsi/orgs","repos_url":"https://api.github.com/users/fehiepsi/repos","events_url":"https://api.github.com/users/fehiepsi/events{/privacy}","received_events_url":"https://api.github.com/users/fehiepsi/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-06T00:17:59Z","performed_via_github_app":null},{"actor":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false},"created_at":"2021-10-06T14:41:01Z","updated_at":"2021-10-06T14:41:01Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/567","repository_url":"https://api.github.com/repos/pyro-ppl/funsor","labels_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/567/labels{/name}","comments_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/567/comments","events_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/567/events","html_url":"https://github.com/pyro-ppl/funsor/issues/567","id":1018469198,"node_id":"I_kwDOCgoJts48tJtO","number":567,"title":"Switch to sqrt(prescision) representation in Gaussian?","user":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false},"labels":[{"id":1262045842,"node_id":"MDU6TGFiZWwxMjYyMDQ1ODQy","url":"https://api.github.com/repos/pyro-ppl/funsor/labels/discussion","name":"discussion","color":"fef2c0","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-10-06T14:38:34Z","updated_at":"2021-10-18T14:39:04Z","closed_at":"2021-10-18T14:39:04Z","author_association":"MEMBER","active_lock_reason":null,"repository":{"id":168430006,"node_id":"MDEwOlJlcG9zaXRvcnkxNjg0MzAwMDY=","name":"funsor","full_name":"pyro-ppl/funsor","private":false,"owner":{"login":"pyro-ppl","id":46794900,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ2Nzk0OTAw","avatar_url":"https://avatars.githubusercontent.com/u/46794900?v=4","gravatar_id":"","url":"https://api.github.com/users/pyro-ppl","html_url":"https://github.com/pyro-ppl","followers_url":"https://api.github.com/users/pyro-ppl/followers","following_url":"https://api.github.com/users/pyro-ppl/following{/other_user}","gists_url":"https://api.github.com/users/pyro-ppl/gists{/gist_id}","starred_url":"https://api.github.com/users/pyro-ppl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyro-ppl/subscriptions","organizations_url":"https://api.github.com/users/pyro-ppl/orgs","repos_url":"https://api.github.com/users/pyro-ppl/repos","events_url":"https://api.github.com/users/pyro-ppl/events{/privacy}","received_events_url":"https://api.github.com/users/pyro-ppl/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/pyro-ppl/funsor","description":"Functional tensors for probabilistic programming","fork":false,"url":"https://api.github.com/repos/pyro-ppl/funsor","forks_url":"https://api.github.com/repos/pyro-ppl/funsor/forks","keys_url":"https://api.github.com/repos/pyro-ppl/funsor/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pyro-ppl/funsor/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pyro-ppl/funsor/teams","hooks_url":"https://api.github.com/repos/pyro-ppl/funsor/hooks","issue_events_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events{/number}","events_url":"https://api.github.com/repos/pyro-ppl/funsor/events","assignees_url":"https://api.github.com/repos/pyro-ppl/funsor/assignees{/user}","branches_url":"https://api.github.com/repos/pyro-ppl/funsor/branches{/branch}","tags_url":"https://api.github.com/repos/pyro-ppl/funsor/tags","blobs_url":"https://api.github.com/repos/pyro-ppl/funsor/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pyro-ppl/funsor/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pyro-ppl/funsor/git/refs{/sha}","trees_url":"https://api.github.com/repos/pyro-ppl/funsor/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pyro-ppl/funsor/statuses/{sha}","languages_url":"https://api.github.com/repos/pyro-ppl/funsor/languages","stargazers_url":"https://api.github.com/repos/pyro-ppl/funsor/stargazers","contributors_url":"https://api.github.com/repos/pyro-ppl/funsor/contributors","subscribers_url":"https://api.github.com/repos/pyro-ppl/funsor/subscribers","subscription_url":"https://api.github.com/repos/pyro-ppl/funsor/subscription","commits_url":"https://api.github.com/repos/pyro-ppl/funsor/commits{/sha}","git_commits_url":"https://api.github.com/repos/pyro-ppl/funsor/git/commits{/sha}","comments_url":"https://api.github.com/repos/pyro-ppl/funsor/comments{/number}","issue_comment_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments{/number}","contents_url":"https://api.github.com/repos/pyro-ppl/funsor/contents/{+path}","compare_url":"https://api.github.com/repos/pyro-ppl/funsor/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pyro-ppl/funsor/merges","archive_url":"https://api.github.com/repos/pyro-ppl/funsor/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pyro-ppl/funsor/downloads","issues_url":"https://api.github.com/repos/pyro-ppl/funsor/issues{/number}","pulls_url":"https://api.github.com/repos/pyro-ppl/funsor/pulls{/number}","milestones_url":"https://api.github.com/repos/pyro-ppl/funsor/milestones{/number}","notifications_url":"https://api.github.com/repos/pyro-ppl/funsor/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pyro-ppl/funsor/labels{/name}","releases_url":"https://api.github.com/repos/pyro-ppl/funsor/releases{/id}","deployments_url":"https://api.github.com/repos/pyro-ppl/funsor/deployments","created_at":"2019-01-30T23:13:39Z","updated_at":"2023-01-03T19:08:54Z","pushed_at":"2022-12-28T19:16:12Z","git_url":"git://github.com/pyro-ppl/funsor.git","ssh_url":"git@github.com:pyro-ppl/funsor.git","clone_url":"https://github.com/pyro-ppl/funsor.git","svn_url":"https://github.com/pyro-ppl/funsor","homepage":"https://funsor.pyro.ai","size":2622,"stargazers_count":209,"watchers_count":209,"language":"Python","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":18,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":89,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["jax","machine-learning","numpy","probabilistic-programming","pyro","pytorch","symbolic"],"visibility":"public","forks":18,"open_issues":89,"watchers":209,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Addresses #559 \r\n\r\nThis issue proposes switching the `Gaussian` parameters from `(info_vec, precision)` to `(info_vec, prec_sqrt)`, following @fehiepsi's work in https://github.com/pyro-ppl/pyro/pull/2019.\r\n\r\n## Motivation\r\n\r\nOur original motivation for representing Gaussians as `(info_vec, precision)` was to support operations on rank-deficient precision matrices, which occur in conditional probability distributions. This design choice allows us to uniformly handle priors, conditional distributions, and likelihoods by treating all three agnostically as mere factors in a factor graph.\r\n\r\nHowever while the `(info_vec, precision)` representation is numerically stable, it is computationally inefficient when making low-dimensional observations of a high-dimensional variable.  For example to store a conditional distribution of a 1-dimensional variable given a 1000-dimensional variable, the precision matrix has 1001**2 elements, but since it has rank 1 its square root would cost only 1001 elements.  Indeed we recognized this https://github.com/pyro-ppl/pyro/pull/2005 and https://github.com/pyro-ppl/funsor/pull/217 and created a special `AffineNormal` pattern to avoid materializing rank-1 precision matrices.\r\n\r\nAn alternative representation is the classic square root information filter (SRIF), explored by @fehiepsi in https://github.com/pyro-ppl/pyro/pull/2019. This represents a Gaussian as a pair `(info_vec, prec_sqrt)`, of shapes `batch_shape + (dim,)` and `batch_shape + (dim, rank)` respectively, so that\r\n```py\r\nprecision = prec_sqrt @ prec_sqrt.transpose(-2, -1)\r\n```\r\nAdvantages of the square root information representation include:\r\n- space storage cost is `O(dim * rank)` which can be much smaller than `O(dim ** 2)`\r\n- ops.add can be implemented by mere concatenation (optionally [followed by compression](https://github.com/pyro-ppl/pyro/pull/2019/files#r317249339) if `rank > dim` or maybe `rank > 1.5 * dim`)\r\n- we could drop `AffineNormal`\r\n\r\n## Design questions\r\n\r\n- [x] Should we make this change?\r\n- [x] If we change `Gaussian` interface what will break?\r\n    - the [arXiv paper](https://arxiv.org/abs/1910.10775) will be out of date\r\n    - I believe all Pyro & NumPyro code uses `to_funsor()`, so will be unaffected\r\n- [x] How should we make this change?  Possibilities include:\r\n    - :+1: Simply replace the existing `Gaussian`.\r\n    - ~~Build a separate `GaussianS`.~~\r\n    - ~~Create a new `ConditionalGaussian` as the basic thing and make `Gaussian` a mere alias~~\r\n        (but how do we unify priors, conditionals, and likelihoods?)\r\n    - ~~Create an abstraction for structured precision matrices as in GPyTorch.~~\r\n        (or is it cleaner to allow structured square root matrices, since they have natural block structure?)","reactions":{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/567/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments/937349345","html_url":"https://github.com/pyro-ppl/funsor/issues/559#issuecomment-937349345","issue_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/559","id":937349345,"node_id":"IC_kwDOCgoJts433tDh","user":{"login":"fehiepsi","id":4736342,"node_id":"MDQ6VXNlcjQ3MzYzNDI=","avatar_url":"https://avatars.githubusercontent.com/u/4736342?v=4","gravatar_id":"","url":"https://api.github.com/users/fehiepsi","html_url":"https://github.com/fehiepsi","followers_url":"https://api.github.com/users/fehiepsi/followers","following_url":"https://api.github.com/users/fehiepsi/following{/other_user}","gists_url":"https://api.github.com/users/fehiepsi/gists{/gist_id}","starred_url":"https://api.github.com/users/fehiepsi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fehiepsi/subscriptions","organizations_url":"https://api.github.com/users/fehiepsi/orgs","repos_url":"https://api.github.com/users/fehiepsi/repos","events_url":"https://api.github.com/users/fehiepsi/events{/privacy}","received_events_url":"https://api.github.com/users/fehiepsi/received_events","type":"User","site_admin":false},"created_at":"2021-10-07T00:37:47Z","updated_at":"2021-10-07T00:37:47Z","author_association":"MEMBER","body":"My impression is most of the details can be preserved (e.g. block vector, block matrix, align gaussian). Back then, one issue was batch qr is very slow on GPU, but torch linalg seems to have been improved a lot since then.","reactions":{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments/937349345/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null,"event":"commented","actor":{"login":"fehiepsi","id":4736342,"node_id":"MDQ6VXNlcjQ3MzYzNDI=","avatar_url":"https://avatars.githubusercontent.com/u/4736342?v=4","gravatar_id":"","url":"https://api.github.com/users/fehiepsi","html_url":"https://github.com/fehiepsi","followers_url":"https://api.github.com/users/fehiepsi/followers","following_url":"https://api.github.com/users/fehiepsi/following{/other_user}","gists_url":"https://api.github.com/users/fehiepsi/gists{/gist_id}","starred_url":"https://api.github.com/users/fehiepsi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fehiepsi/subscriptions","organizations_url":"https://api.github.com/users/fehiepsi/orgs","repos_url":"https://api.github.com/users/fehiepsi/repos","events_url":"https://api.github.com/users/fehiepsi/events{/privacy}","received_events_url":"https://api.github.com/users/fehiepsi/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments/937373494","html_url":"https://github.com/pyro-ppl/funsor/issues/559#issuecomment-937373494","issue_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/559","id":937373494,"node_id":"IC_kwDOCgoJts433y82","user":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false},"created_at":"2021-10-07T01:33:25Z","updated_at":"2021-10-07T02:49:17Z","author_association":"MEMBER","body":"@fehiepsi do you recall whether Cholesky was sufficient instead of QR?  IIRC there was a PyTorch discussion about cheaply testing for positive definiteness or condition number using [torch.linalg.cholesky_ex()](https://pytorch.org/docs/1.9.1/generated/torch.linalg.cholesky_ex.html#torch.linalg.cholesky_ex).","reactions":{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments/937373494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false}},{"id":5425409353,"node_id":"MEE_lADOCgoJts48WNd6zwAAAAFDYS1J","url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events/5425409353","actor":{"login":"fehiepsi","id":4736342,"node_id":"MDQ6VXNlcjQ3MzYzNDI=","avatar_url":"https://avatars.githubusercontent.com/u/4736342?v=4","gravatar_id":"","url":"https://api.github.com/users/fehiepsi","html_url":"https://github.com/fehiepsi","followers_url":"https://api.github.com/users/fehiepsi/followers","following_url":"https://api.github.com/users/fehiepsi/following{/other_user}","gists_url":"https://api.github.com/users/fehiepsi/gists{/gist_id}","starred_url":"https://api.github.com/users/fehiepsi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fehiepsi/subscriptions","organizations_url":"https://api.github.com/users/fehiepsi/orgs","repos_url":"https://api.github.com/users/fehiepsi/repos","events_url":"https://api.github.com/users/fehiepsi/events{/privacy}","received_events_url":"https://api.github.com/users/fehiepsi/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-07T01:33:25Z","performed_via_github_app":null},{"id":5425409358,"node_id":"SE_lADOCgoJts48WNd6zwAAAAFDYS1O","url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events/5425409358","actor":{"login":"fehiepsi","id":4736342,"node_id":"MDQ6VXNlcjQ3MzYzNDI=","avatar_url":"https://avatars.githubusercontent.com/u/4736342?v=4","gravatar_id":"","url":"https://api.github.com/users/fehiepsi","html_url":"https://github.com/fehiepsi","followers_url":"https://api.github.com/users/fehiepsi/followers","following_url":"https://api.github.com/users/fehiepsi/following{/other_user}","gists_url":"https://api.github.com/users/fehiepsi/gists{/gist_id}","starred_url":"https://api.github.com/users/fehiepsi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fehiepsi/subscriptions","organizations_url":"https://api.github.com/users/fehiepsi/orgs","repos_url":"https://api.github.com/users/fehiepsi/repos","events_url":"https://api.github.com/users/fehiepsi/events{/privacy}","received_events_url":"https://api.github.com/users/fehiepsi/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-07T01:33:26Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments/937403968","html_url":"https://github.com/pyro-ppl/funsor/issues/559#issuecomment-937403968","issue_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/559","id":937403968,"node_id":"IC_kwDOCgoJts4336ZA","user":{"login":"fehiepsi","id":4736342,"node_id":"MDQ6VXNlcjQ3MzYzNDI=","avatar_url":"https://avatars.githubusercontent.com/u/4736342?v=4","gravatar_id":"","url":"https://api.github.com/users/fehiepsi","html_url":"https://github.com/fehiepsi","followers_url":"https://api.github.com/users/fehiepsi/followers","following_url":"https://api.github.com/users/fehiepsi/following{/other_user}","gists_url":"https://api.github.com/users/fehiepsi/gists{/gist_id}","starred_url":"https://api.github.com/users/fehiepsi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fehiepsi/subscriptions","organizations_url":"https://api.github.com/users/fehiepsi/orgs","repos_url":"https://api.github.com/users/fehiepsi/repos","events_url":"https://api.github.com/users/fehiepsi/events{/privacy}","received_events_url":"https://api.github.com/users/fehiepsi/received_events","type":"User","site_admin":false},"created_at":"2021-10-07T03:00:04Z","updated_at":"2021-10-07T03:00:04Z","author_association":"MEMBER","body":"Looking at the code, I guess we need to triangulate a non-positive-definite precision matrix (e.g. zeros matrix) but I can't recall when we need such triangularization. :( Probably, it is unnecessary. (anyway, we can switch to qr if we face the positive definiteness issue)","reactions":{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments/937403968/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fehiepsi","id":4736342,"node_id":"MDQ6VXNlcjQ3MzYzNDI=","avatar_url":"https://avatars.githubusercontent.com/u/4736342?v=4","gravatar_id":"","url":"https://api.github.com/users/fehiepsi","html_url":"https://github.com/fehiepsi","followers_url":"https://api.github.com/users/fehiepsi/followers","following_url":"https://api.github.com/users/fehiepsi/following{/other_user}","gists_url":"https://api.github.com/users/fehiepsi/gists{/gist_id}","starred_url":"https://api.github.com/users/fehiepsi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fehiepsi/subscriptions","organizations_url":"https://api.github.com/users/fehiepsi/orgs","repos_url":"https://api.github.com/users/fehiepsi/repos","events_url":"https://api.github.com/users/fehiepsi/events{/privacy}","received_events_url":"https://api.github.com/users/fehiepsi/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments/1046033973","html_url":"https://github.com/pyro-ppl/funsor/issues/559#issuecomment-1046033973","issue_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/559","id":1046033973,"node_id":"IC_kwDOCgoJts4-WTY1","user":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false},"created_at":"2022-02-19T14:45:50Z","updated_at":"2022-02-19T14:45:50Z","author_association":"MEMBER","body":"@eb8680 want to pair code next week on the high-level algorithm for variable elimination, continuing our work from https://github.com/pyro-ppl/funsor/compare/tractable-for-gaussians ?","reactions":{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments/1046033973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false}},{"id":6105999182,"node_id":"MEE_lADOCgoJts48WNd6zwAAAAFr8idO","url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events/6105999182","actor":{"login":"eb8680","id":2032320,"node_id":"MDQ6VXNlcjIwMzIzMjA=","avatar_url":"https://avatars.githubusercontent.com/u/2032320?v=4","gravatar_id":"","url":"https://api.github.com/users/eb8680","html_url":"https://github.com/eb8680","followers_url":"https://api.github.com/users/eb8680/followers","following_url":"https://api.github.com/users/eb8680/following{/other_user}","gists_url":"https://api.github.com/users/eb8680/gists{/gist_id}","starred_url":"https://api.github.com/users/eb8680/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eb8680/subscriptions","organizations_url":"https://api.github.com/users/eb8680/orgs","repos_url":"https://api.github.com/users/eb8680/repos","events_url":"https://api.github.com/users/eb8680/events{/privacy}","received_events_url":"https://api.github.com/users/eb8680/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-02-19T14:45:50Z","performed_via_github_app":null},{"id":6105999183,"node_id":"SE_lADOCgoJts48WNd6zwAAAAFr8idP","url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events/6105999183","actor":{"login":"eb8680","id":2032320,"node_id":"MDQ6VXNlcjIwMzIzMjA=","avatar_url":"https://avatars.githubusercontent.com/u/2032320?v=4","gravatar_id":"","url":"https://api.github.com/users/eb8680","html_url":"https://github.com/eb8680","followers_url":"https://api.github.com/users/eb8680/followers","following_url":"https://api.github.com/users/eb8680/following{/other_user}","gists_url":"https://api.github.com/users/eb8680/gists{/gist_id}","starred_url":"https://api.github.com/users/eb8680/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eb8680/subscriptions","organizations_url":"https://api.github.com/users/eb8680/orgs","repos_url":"https://api.github.com/users/eb8680/repos","events_url":"https://api.github.com/users/eb8680/events{/privacy}","received_events_url":"https://api.github.com/users/eb8680/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-02-19T14:45:50Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments/1046057900","html_url":"https://github.com/pyro-ppl/funsor/issues/559#issuecomment-1046057900","issue_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/559","id":1046057900,"node_id":"IC_kwDOCgoJts4-WZOs","user":{"login":"eb8680","id":2032320,"node_id":"MDQ6VXNlcjIwMzIzMjA=","avatar_url":"https://avatars.githubusercontent.com/u/2032320?v=4","gravatar_id":"","url":"https://api.github.com/users/eb8680","html_url":"https://github.com/eb8680","followers_url":"https://api.github.com/users/eb8680/followers","following_url":"https://api.github.com/users/eb8680/following{/other_user}","gists_url":"https://api.github.com/users/eb8680/gists{/gist_id}","starred_url":"https://api.github.com/users/eb8680/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eb8680/subscriptions","organizations_url":"https://api.github.com/users/eb8680/orgs","repos_url":"https://api.github.com/users/eb8680/repos","events_url":"https://api.github.com/users/eb8680/events{/privacy}","received_events_url":"https://api.github.com/users/eb8680/received_events","type":"User","site_admin":false},"created_at":"2022-02-19T16:46:40Z","updated_at":"2022-02-19T16:46:40Z","author_association":"MEMBER","body":"Sure!","reactions":{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments/1046057900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"eb8680","id":2032320,"node_id":"MDQ6VXNlcjIwMzIzMjA=","avatar_url":"https://avatars.githubusercontent.com/u/2032320?v=4","gravatar_id":"","url":"https://api.github.com/users/eb8680","html_url":"https://github.com/eb8680","followers_url":"https://api.github.com/users/eb8680/followers","following_url":"https://api.github.com/users/eb8680/following{/other_user}","gists_url":"https://api.github.com/users/eb8680/gists{/gist_id}","starred_url":"https://api.github.com/users/eb8680/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eb8680/subscriptions","organizations_url":"https://api.github.com/users/eb8680/orgs","repos_url":"https://api.github.com/users/eb8680/repos","events_url":"https://api.github.com/users/eb8680/events{/privacy}","received_events_url":"https://api.github.com/users/eb8680/received_events","type":"User","site_admin":false}},{"actor":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false},"created_at":"2022-02-24T00:08:15Z","updated_at":"2022-02-24T00:08:15Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/584","repository_url":"https://api.github.com/repos/pyro-ppl/funsor","labels_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/584/labels{/name}","comments_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/584/comments","events_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/584/events","html_url":"https://github.com/pyro-ppl/funsor/pull/584","id":1148712087,"node_id":"PR_kwDOCgoJts4zYDqX","number":584,"title":"Extend partial_sum_product() to cases tractable for Gaussians","user":{"login":"fritzo","id":648532,"node_id":"MDQ6VXNlcjY0ODUzMg==","avatar_url":"https://avatars.githubusercontent.com/u/648532?v=4","gravatar_id":"","url":"https://api.github.com/users/fritzo","html_url":"https://github.com/fritzo","followers_url":"https://api.github.com/users/fritzo/followers","following_url":"https://api.github.com/users/fritzo/following{/other_user}","gists_url":"https://api.github.com/users/fritzo/gists{/gist_id}","starred_url":"https://api.github.com/users/fritzo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fritzo/subscriptions","organizations_url":"https://api.github.com/users/fritzo/orgs","repos_url":"https://api.github.com/users/fritzo/repos","events_url":"https://api.github.com/users/fritzo/events{/privacy}","received_events_url":"https://api.github.com/users/fritzo/received_events","type":"User","site_admin":false},"labels":[{"id":1243847501,"node_id":"MDU6TGFiZWwxMjQzODQ3NTAx","url":"https://api.github.com/repos/pyro-ppl/funsor/labels/awaiting%20review","name":"awaiting review","color":"fbca04","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-02-24T00:08:15Z","updated_at":"2022-03-02T19:58:18Z","closed_at":"2022-03-02T19:58:17Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"repository":{"id":168430006,"node_id":"MDEwOlJlcG9zaXRvcnkxNjg0MzAwMDY=","name":"funsor","full_name":"pyro-ppl/funsor","private":false,"owner":{"login":"pyro-ppl","id":46794900,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ2Nzk0OTAw","avatar_url":"https://avatars.githubusercontent.com/u/46794900?v=4","gravatar_id":"","url":"https://api.github.com/users/pyro-ppl","html_url":"https://github.com/pyro-ppl","followers_url":"https://api.github.com/users/pyro-ppl/followers","following_url":"https://api.github.com/users/pyro-ppl/following{/other_user}","gists_url":"https://api.github.com/users/pyro-ppl/gists{/gist_id}","starred_url":"https://api.github.com/users/pyro-ppl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyro-ppl/subscriptions","organizations_url":"https://api.github.com/users/pyro-ppl/orgs","repos_url":"https://api.github.com/users/pyro-ppl/repos","events_url":"https://api.github.com/users/pyro-ppl/events{/privacy}","received_events_url":"https://api.github.com/users/pyro-ppl/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/pyro-ppl/funsor","description":"Functional tensors for probabilistic programming","fork":false,"url":"https://api.github.com/repos/pyro-ppl/funsor","forks_url":"https://api.github.com/repos/pyro-ppl/funsor/forks","keys_url":"https://api.github.com/repos/pyro-ppl/funsor/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pyro-ppl/funsor/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pyro-ppl/funsor/teams","hooks_url":"https://api.github.com/repos/pyro-ppl/funsor/hooks","issue_events_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/events{/number}","events_url":"https://api.github.com/repos/pyro-ppl/funsor/events","assignees_url":"https://api.github.com/repos/pyro-ppl/funsor/assignees{/user}","branches_url":"https://api.github.com/repos/pyro-ppl/funsor/branches{/branch}","tags_url":"https://api.github.com/repos/pyro-ppl/funsor/tags","blobs_url":"https://api.github.com/repos/pyro-ppl/funsor/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pyro-ppl/funsor/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pyro-ppl/funsor/git/refs{/sha}","trees_url":"https://api.github.com/repos/pyro-ppl/funsor/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pyro-ppl/funsor/statuses/{sha}","languages_url":"https://api.github.com/repos/pyro-ppl/funsor/languages","stargazers_url":"https://api.github.com/repos/pyro-ppl/funsor/stargazers","contributors_url":"https://api.github.com/repos/pyro-ppl/funsor/contributors","subscribers_url":"https://api.github.com/repos/pyro-ppl/funsor/subscribers","subscription_url":"https://api.github.com/repos/pyro-ppl/funsor/subscription","commits_url":"https://api.github.com/repos/pyro-ppl/funsor/commits{/sha}","git_commits_url":"https://api.github.com/repos/pyro-ppl/funsor/git/commits{/sha}","comments_url":"https://api.github.com/repos/pyro-ppl/funsor/comments{/number}","issue_comment_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/comments{/number}","contents_url":"https://api.github.com/repos/pyro-ppl/funsor/contents/{+path}","compare_url":"https://api.github.com/repos/pyro-ppl/funsor/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pyro-ppl/funsor/merges","archive_url":"https://api.github.com/repos/pyro-ppl/funsor/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pyro-ppl/funsor/downloads","issues_url":"https://api.github.com/repos/pyro-ppl/funsor/issues{/number}","pulls_url":"https://api.github.com/repos/pyro-ppl/funsor/pulls{/number}","milestones_url":"https://api.github.com/repos/pyro-ppl/funsor/milestones{/number}","notifications_url":"https://api.github.com/repos/pyro-ppl/funsor/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pyro-ppl/funsor/labels{/name}","releases_url":"https://api.github.com/repos/pyro-ppl/funsor/releases{/id}","deployments_url":"https://api.github.com/repos/pyro-ppl/funsor/deployments","created_at":"2019-01-30T23:13:39Z","updated_at":"2023-01-03T19:08:54Z","pushed_at":"2022-12-28T19:16:12Z","git_url":"git://github.com/pyro-ppl/funsor.git","ssh_url":"git@github.com:pyro-ppl/funsor.git","clone_url":"https://github.com/pyro-ppl/funsor.git","svn_url":"https://github.com/pyro-ppl/funsor","homepage":"https://funsor.pyro.ai","size":2622,"stargazers_count":209,"watchers_count":209,"language":"Python","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":18,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":89,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["jax","machine-learning","numpy","probabilistic-programming","pyro","pytorch","symbolic"],"visibility":"public","forks":18,"open_issues":89,"watchers":209,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/pyro-ppl/funsor/pulls/584","html_url":"https://github.com/pyro-ppl/funsor/pull/584","diff_url":"https://github.com/pyro-ppl/funsor/pull/584.diff","patch_url":"https://github.com/pyro-ppl/funsor/pull/584.patch","merged_at":"2022-03-02T19:58:17Z"},"body":"Addresses #559 \r\n~~Blocked by #583~~\r\npair coded with @eb8680 \r\n\r\n## Tested\r\n- added tests of intractable cases\r\n- added tests for unreduced sum variables in plates\r\n- added tests for batching, i.e. unreduced plate variables","reactions":{"url":"https://api.github.com/repos/pyro-ppl/funsor/issues/584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pyro-ppl/funsor/issues/584/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"}]