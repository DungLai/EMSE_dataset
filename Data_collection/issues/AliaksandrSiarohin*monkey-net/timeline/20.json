[{"url":"https://api.github.com/repos/AliaksandrSiarohin/monkey-net/issues/comments/563350378","html_url":"https://github.com/AliaksandrSiarohin/monkey-net/issues/20#issuecomment-563350378","issue_url":"https://api.github.com/repos/AliaksandrSiarohin/monkey-net/issues/20","id":563350378,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MzM1MDM3OA==","user":{"login":"AliaksandrSiarohin","id":3857997,"node_id":"MDQ6VXNlcjM4NTc5OTc=","avatar_url":"https://avatars.githubusercontent.com/u/3857997?v=4","gravatar_id":"","url":"https://api.github.com/users/AliaksandrSiarohin","html_url":"https://github.com/AliaksandrSiarohin","followers_url":"https://api.github.com/users/AliaksandrSiarohin/followers","following_url":"https://api.github.com/users/AliaksandrSiarohin/following{/other_user}","gists_url":"https://api.github.com/users/AliaksandrSiarohin/gists{/gist_id}","starred_url":"https://api.github.com/users/AliaksandrSiarohin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AliaksandrSiarohin/subscriptions","organizations_url":"https://api.github.com/users/AliaksandrSiarohin/orgs","repos_url":"https://api.github.com/users/AliaksandrSiarohin/repos","events_url":"https://api.github.com/users/AliaksandrSiarohin/events{/privacy}","received_events_url":"https://api.github.com/users/AliaksandrSiarohin/received_events","type":"User","site_admin":false},"created_at":"2019-12-09T17:42:32Z","updated_at":"2019-12-09T17:42:32Z","author_association":"OWNER","body":"Hi,\r\n1) kp2gaussian(gaussian2kp(x)) != x, is this is what are you asking? This is the case because, gaussian2kp produce unormalized heatmaps. E.g. The heatmaps that does not sum to one, while kp2gaussian requires maps like this. Why do you need to invert it? \r\n2) This operation is called soft-argmax, and it computes the weighted mean of the coordinate grid. More formally heatmap defines a probability distribution over the image coordinates, and we compute the mean coordinate given this probability distribution.\r\n3) Do you have a pytorch landmark detector?\r\nIn that case follow these steps:\r\n1. Replace architecture of the keypoint_detector with your architecture. Modify the forward method so that it return a dict with a single value ['mean']. It should have the following shape [bs, num_kp, 2].\r\n2. Modify the config.yaml, replace num_kp with number of keypoiths in your case and modify the kp_var from 'matrix' to 0.01.\r\n3. Modify train.py, load your keypoint detector weights and commend lines wich do optimizer_kp_detector.step().\r\n\r\nIf you don't have acces to the architecrure of detector or it is complicated, you can do the following:\r\n1. Compute the keypoints for all the videos and all the frames offline and save it to some file.\r\n2. In frames dataset load this file and for each frame load the appropriate keypoints. Alternatively you can just run you keypoint detector on your frames at this point. Without offline computation and file saving. \r\n\r\nPut the keypoints in the out dict under the key 'kp'. \r\n3. Replace keypoint detector with some dummy class that will just forward you the keypoints. In other words just do out['mean'] = x['kp'].\r\n4. Modify the config and train as in previous method. ","reactions":{"url":"https://api.github.com/repos/AliaksandrSiarohin/monkey-net/issues/comments/563350378/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AliaksandrSiarohin","id":3857997,"node_id":"MDQ6VXNlcjM4NTc5OTc=","avatar_url":"https://avatars.githubusercontent.com/u/3857997?v=4","gravatar_id":"","url":"https://api.github.com/users/AliaksandrSiarohin","html_url":"https://github.com/AliaksandrSiarohin","followers_url":"https://api.github.com/users/AliaksandrSiarohin/followers","following_url":"https://api.github.com/users/AliaksandrSiarohin/following{/other_user}","gists_url":"https://api.github.com/users/AliaksandrSiarohin/gists{/gist_id}","starred_url":"https://api.github.com/users/AliaksandrSiarohin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AliaksandrSiarohin/subscriptions","organizations_url":"https://api.github.com/users/AliaksandrSiarohin/orgs","repos_url":"https://api.github.com/users/AliaksandrSiarohin/repos","events_url":"https://api.github.com/users/AliaksandrSiarohin/events{/privacy}","received_events_url":"https://api.github.com/users/AliaksandrSiarohin/received_events","type":"User","site_admin":false}}]