{"url":"https://api.github.com/repos/Seanny123/da-rnn/issues/2","repository_url":"https://api.github.com/repos/Seanny123/da-rnn","labels_url":"https://api.github.com/repos/Seanny123/da-rnn/issues/2/labels{/name}","comments_url":"https://api.github.com/repos/Seanny123/da-rnn/issues/2/comments","events_url":"https://api.github.com/repos/Seanny123/da-rnn/issues/2/events","html_url":"https://github.com/Seanny123/da-rnn/issues/2","id":381044707,"node_id":"MDU6SXNzdWUzODEwNDQ3MDc=","number":2,"title":"Error while executing main_predict.py","user":{"login":"notonlyvandalzzz","id":20763637,"node_id":"MDQ6VXNlcjIwNzYzNjM3","avatar_url":"https://avatars.githubusercontent.com/u/20763637?v=4","gravatar_id":"","url":"https://api.github.com/users/notonlyvandalzzz","html_url":"https://github.com/notonlyvandalzzz","followers_url":"https://api.github.com/users/notonlyvandalzzz/followers","following_url":"https://api.github.com/users/notonlyvandalzzz/following{/other_user}","gists_url":"https://api.github.com/users/notonlyvandalzzz/gists{/gist_id}","starred_url":"https://api.github.com/users/notonlyvandalzzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/notonlyvandalzzz/subscriptions","organizations_url":"https://api.github.com/users/notonlyvandalzzz/orgs","repos_url":"https://api.github.com/users/notonlyvandalzzz/repos","events_url":"https://api.github.com/users/notonlyvandalzzz/events{/privacy}","received_events_url":"https://api.github.com/users/notonlyvandalzzz/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-11-15T08:11:06Z","updated_at":"2019-10-10T13:34:45Z","closed_at":"2019-04-10T05:04:48Z","author_association":"NONE","active_lock_reason":null,"body":"Got this error trying just to run code from github:\r\n`Traceback (most recent call last):\r\nFile \"main_predict.py\", line 76, in <module>\r\nfinal_y_pred = predict(enc, dec, data, **da_rnn_kwargs)\r\nFile \"main_predict.py\", line 51, in predict\r\ny_pred[y_slc] = decoder(input_encoded, y_history).cpu().data.numpy()\r\nFile \"/home/halcyon/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 477, in __call__\r\nresult = self.forward(*input, **kwargs)\r\nFile \"/home/halcyon/darnn/modules.py\", line 106, in forward\r\ny_tilde = self.fc(torch.cat((context, y_history[:, t]), dim=1)) # (batch_size, out_size)\r\nFile \"/home/halcyon/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 477, in __call__\r\nresult = self.forward(*input, **kwargs)\r\nFile \"/home/halcyon/anaconda3/lib/python3.6/site-packages/torch/nn/modules/linear.py\", line 55, in forward\r\nreturn F.linear(input, self.weight, self.bias)\r\nFile \"/home/halcyon/anaconda3/lib/python3.6/site-packages/torch/nn/functional.py\", line 1024, in linear\r\nreturn torch.addmm(bias, input, weight.t())\r\nRuntimeError: size mismatch, m1: [128 x 40624], m2: [65 x 1] at /opt/conda/conda-bld/pytorch_1533672544752/work/aten/src/THC/generic/THCTensorMathBlas.cu:249`\r\nRunning main.py gives no error, so looks like somehow tensor sizes got mismatch at prediction stage\r\nThe only modification to code i've made is just added this string in the beginning:\r\n`torch.set_default_tensor_type('torch.cuda.FloatTensor')`\r\nw/o that string i've got 'type mismatch' from torch","closed_by":{"login":"notonlyvandalzzz","id":20763637,"node_id":"MDQ6VXNlcjIwNzYzNjM3","avatar_url":"https://avatars.githubusercontent.com/u/20763637?v=4","gravatar_id":"","url":"https://api.github.com/users/notonlyvandalzzz","html_url":"https://github.com/notonlyvandalzzz","followers_url":"https://api.github.com/users/notonlyvandalzzz/followers","following_url":"https://api.github.com/users/notonlyvandalzzz/following{/other_user}","gists_url":"https://api.github.com/users/notonlyvandalzzz/gists{/gist_id}","starred_url":"https://api.github.com/users/notonlyvandalzzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/notonlyvandalzzz/subscriptions","organizations_url":"https://api.github.com/users/notonlyvandalzzz/orgs","repos_url":"https://api.github.com/users/notonlyvandalzzz/repos","events_url":"https://api.github.com/users/notonlyvandalzzz/events{/privacy}","received_events_url":"https://api.github.com/users/notonlyvandalzzz/received_events","type":"User","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Seanny123/da-rnn/issues/2/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Seanny123/da-rnn/issues/2/timeline","performed_via_github_app":null,"state_reason":"completed"}