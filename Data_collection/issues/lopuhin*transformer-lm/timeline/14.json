[{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/520492616","html_url":"https://github.com/lopuhin/transformer-lm/issues/14#issuecomment-520492616","issue_url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/14","id":520492616,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMDQ5MjYxNg==","user":{"login":"lopuhin","id":424613,"node_id":"MDQ6VXNlcjQyNDYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/424613?v=4","gravatar_id":"","url":"https://api.github.com/users/lopuhin","html_url":"https://github.com/lopuhin","followers_url":"https://api.github.com/users/lopuhin/followers","following_url":"https://api.github.com/users/lopuhin/following{/other_user}","gists_url":"https://api.github.com/users/lopuhin/gists{/gist_id}","starred_url":"https://api.github.com/users/lopuhin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lopuhin/subscriptions","organizations_url":"https://api.github.com/users/lopuhin/orgs","repos_url":"https://api.github.com/users/lopuhin/repos","events_url":"https://api.github.com/users/lopuhin/events{/privacy}","received_events_url":"https://api.github.com/users/lopuhin/received_events","type":"User","site_admin":false},"created_at":"2019-08-12T16:16:12Z","updated_at":"2019-08-12T16:16:12Z","author_association":"OWNER","body":"@vilhub I see, thanks for the report. This is using pytorch, right? I haven't seen such an error to be honest, not sure what could cause it. Does this happen only with two GPUs, or with one as well?","reactions":{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/520492616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lopuhin","id":424613,"node_id":"MDQ6VXNlcjQyNDYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/424613?v=4","gravatar_id":"","url":"https://api.github.com/users/lopuhin","html_url":"https://github.com/lopuhin","followers_url":"https://api.github.com/users/lopuhin/followers","following_url":"https://api.github.com/users/lopuhin/following{/other_user}","gists_url":"https://api.github.com/users/lopuhin/gists{/gist_id}","starred_url":"https://api.github.com/users/lopuhin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lopuhin/subscriptions","organizations_url":"https://api.github.com/users/lopuhin/orgs","repos_url":"https://api.github.com/users/lopuhin/repos","events_url":"https://api.github.com/users/lopuhin/events{/privacy}","received_events_url":"https://api.github.com/users/lopuhin/received_events","type":"User","site_admin":false}},{"id":2550750907,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjU1MDc1MDkwNw==","url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/events/2550750907","actor":{"login":"vilhub","id":10402864,"node_id":"MDQ6VXNlcjEwNDAyODY0","avatar_url":"https://avatars.githubusercontent.com/u/10402864?v=4","gravatar_id":"","url":"https://api.github.com/users/vilhub","html_url":"https://github.com/vilhub","followers_url":"https://api.github.com/users/vilhub/followers","following_url":"https://api.github.com/users/vilhub/following{/other_user}","gists_url":"https://api.github.com/users/vilhub/gists{/gist_id}","starred_url":"https://api.github.com/users/vilhub/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vilhub/subscriptions","organizations_url":"https://api.github.com/users/vilhub/orgs","repos_url":"https://api.github.com/users/vilhub/repos","events_url":"https://api.github.com/users/vilhub/events{/privacy}","received_events_url":"https://api.github.com/users/vilhub/received_events","type":"User","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-08-12T16:16:12Z","performed_via_github_app":null},{"id":2550750909,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI1NTA3NTA5MDk=","url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/events/2550750909","actor":{"login":"vilhub","id":10402864,"node_id":"MDQ6VXNlcjEwNDAyODY0","avatar_url":"https://avatars.githubusercontent.com/u/10402864?v=4","gravatar_id":"","url":"https://api.github.com/users/vilhub","html_url":"https://github.com/vilhub","followers_url":"https://api.github.com/users/vilhub/followers","following_url":"https://api.github.com/users/vilhub/following{/other_user}","gists_url":"https://api.github.com/users/vilhub/gists{/gist_id}","starred_url":"https://api.github.com/users/vilhub/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vilhub/subscriptions","organizations_url":"https://api.github.com/users/vilhub/orgs","repos_url":"https://api.github.com/users/vilhub/repos","events_url":"https://api.github.com/users/vilhub/events{/privacy}","received_events_url":"https://api.github.com/users/vilhub/received_events","type":"User","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-08-12T16:16:13Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/520754668","html_url":"https://github.com/lopuhin/transformer-lm/issues/14#issuecomment-520754668","issue_url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/14","id":520754668,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMDc1NDY2OA==","user":{"login":"vilhub","id":10402864,"node_id":"MDQ6VXNlcjEwNDAyODY0","avatar_url":"https://avatars.githubusercontent.com/u/10402864?v=4","gravatar_id":"","url":"https://api.github.com/users/vilhub","html_url":"https://github.com/vilhub","followers_url":"https://api.github.com/users/vilhub/followers","following_url":"https://api.github.com/users/vilhub/following{/other_user}","gists_url":"https://api.github.com/users/vilhub/gists{/gist_id}","starred_url":"https://api.github.com/users/vilhub/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vilhub/subscriptions","organizations_url":"https://api.github.com/users/vilhub/orgs","repos_url":"https://api.github.com/users/vilhub/repos","events_url":"https://api.github.com/users/vilhub/events{/privacy}","received_events_url":"https://api.github.com/users/vilhub/received_events","type":"User","site_admin":false},"created_at":"2019-08-13T09:08:24Z","updated_at":"2019-08-13T09:08:24Z","author_association":"NONE","body":"Hey, thanks for your answer. Yes exactly, using pytorch. It does it with both one and two GPUs. I will investigate some more to see if I can at least find an error message or understand why it terminates. I will report back shortly.","reactions":{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/520754668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vilhub","id":10402864,"node_id":"MDQ6VXNlcjEwNDAyODY0","avatar_url":"https://avatars.githubusercontent.com/u/10402864?v=4","gravatar_id":"","url":"https://api.github.com/users/vilhub","html_url":"https://github.com/vilhub","followers_url":"https://api.github.com/users/vilhub/followers","following_url":"https://api.github.com/users/vilhub/following{/other_user}","gists_url":"https://api.github.com/users/vilhub/gists{/gist_id}","starred_url":"https://api.github.com/users/vilhub/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vilhub/subscriptions","organizations_url":"https://api.github.com/users/vilhub/orgs","repos_url":"https://api.github.com/users/vilhub/repos","events_url":"https://api.github.com/users/vilhub/events{/privacy}","received_events_url":"https://api.github.com/users/vilhub/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/520796483","html_url":"https://github.com/lopuhin/transformer-lm/issues/14#issuecomment-520796483","issue_url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/14","id":520796483,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMDc5NjQ4Mw==","user":{"login":"vilhub","id":10402864,"node_id":"MDQ6VXNlcjEwNDAyODY0","avatar_url":"https://avatars.githubusercontent.com/u/10402864?v=4","gravatar_id":"","url":"https://api.github.com/users/vilhub","html_url":"https://github.com/vilhub","followers_url":"https://api.github.com/users/vilhub/followers","following_url":"https://api.github.com/users/vilhub/following{/other_user}","gists_url":"https://api.github.com/users/vilhub/gists{/gist_id}","starred_url":"https://api.github.com/users/vilhub/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vilhub/subscriptions","organizations_url":"https://api.github.com/users/vilhub/orgs","repos_url":"https://api.github.com/users/vilhub/repos","events_url":"https://api.github.com/users/vilhub/events{/privacy}","received_events_url":"https://api.github.com/users/vilhub/received_events","type":"User","site_admin":false},"created_at":"2019-08-13T11:27:05Z","updated_at":"2019-08-13T11:40:15Z","author_association":"NONE","body":"Hi again,\r\nSo the issue was in the end that I was continuing training of a model that I load and therefore the `seen_tokens` variable which is loaded would already be greater than `epochs * epoch_size` so the training loop is done. Perhaps printing the `seen_tokens` variable would be useful if someone encounters the same issue?\r\n\r\nThanks again for the reply and the code!\r\n\r\nEdit : This wouldn't explain the failure of the shakespeare test though, I will look into it as well.","reactions":{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/520796483/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vilhub","id":10402864,"node_id":"MDQ6VXNlcjEwNDAyODY0","avatar_url":"https://avatars.githubusercontent.com/u/10402864?v=4","gravatar_id":"","url":"https://api.github.com/users/vilhub","html_url":"https://github.com/vilhub","followers_url":"https://api.github.com/users/vilhub/followers","following_url":"https://api.github.com/users/vilhub/following{/other_user}","gists_url":"https://api.github.com/users/vilhub/gists{/gist_id}","starred_url":"https://api.github.com/users/vilhub/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vilhub/subscriptions","organizations_url":"https://api.github.com/users/vilhub/orgs","repos_url":"https://api.github.com/users/vilhub/repos","events_url":"https://api.github.com/users/vilhub/events{/privacy}","received_events_url":"https://api.github.com/users/vilhub/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/521549224","html_url":"https://github.com/lopuhin/transformer-lm/issues/14#issuecomment-521549224","issue_url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/14","id":521549224,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMTU0OTIyNA==","user":{"login":"vilhub","id":10402864,"node_id":"MDQ6VXNlcjEwNDAyODY0","avatar_url":"https://avatars.githubusercontent.com/u/10402864?v=4","gravatar_id":"","url":"https://api.github.com/users/vilhub","html_url":"https://github.com/vilhub","followers_url":"https://api.github.com/users/vilhub/followers","following_url":"https://api.github.com/users/vilhub/following{/other_user}","gists_url":"https://api.github.com/users/vilhub/gists{/gist_id}","starred_url":"https://api.github.com/users/vilhub/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vilhub/subscriptions","organizations_url":"https://api.github.com/users/vilhub/orgs","repos_url":"https://api.github.com/users/vilhub/repos","events_url":"https://api.github.com/users/vilhub/events{/privacy}","received_events_url":"https://api.github.com/users/vilhub/received_events","type":"User","site_admin":false},"created_at":"2019-08-15T07:45:55Z","updated_at":"2019-08-15T07:45:55Z","author_association":"NONE","body":"OK the Shakespeare test works too, I don't know why it didn't at the time. I will close this now, thanks!","reactions":{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/521549224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vilhub","id":10402864,"node_id":"MDQ6VXNlcjEwNDAyODY0","avatar_url":"https://avatars.githubusercontent.com/u/10402864?v=4","gravatar_id":"","url":"https://api.github.com/users/vilhub","html_url":"https://github.com/vilhub","followers_url":"https://api.github.com/users/vilhub/followers","following_url":"https://api.github.com/users/vilhub/following{/other_user}","gists_url":"https://api.github.com/users/vilhub/gists{/gist_id}","starred_url":"https://api.github.com/users/vilhub/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vilhub/subscriptions","organizations_url":"https://api.github.com/users/vilhub/orgs","repos_url":"https://api.github.com/users/vilhub/repos","events_url":"https://api.github.com/users/vilhub/events{/privacy}","received_events_url":"https://api.github.com/users/vilhub/received_events","type":"User","site_admin":false}},{"id":2558798872,"node_id":"MDExOkNsb3NlZEV2ZW50MjU1ODc5ODg3Mg==","url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/events/2558798872","actor":{"login":"vilhub","id":10402864,"node_id":"MDQ6VXNlcjEwNDAyODY0","avatar_url":"https://avatars.githubusercontent.com/u/10402864?v=4","gravatar_id":"","url":"https://api.github.com/users/vilhub","html_url":"https://github.com/vilhub","followers_url":"https://api.github.com/users/vilhub/followers","following_url":"https://api.github.com/users/vilhub/following{/other_user}","gists_url":"https://api.github.com/users/vilhub/gists{/gist_id}","starred_url":"https://api.github.com/users/vilhub/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vilhub/subscriptions","organizations_url":"https://api.github.com/users/vilhub/orgs","repos_url":"https://api.github.com/users/vilhub/repos","events_url":"https://api.github.com/users/vilhub/events{/privacy}","received_events_url":"https://api.github.com/users/vilhub/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-08-15T07:45:55Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/666948564","html_url":"https://github.com/lopuhin/transformer-lm/issues/14#issuecomment-666948564","issue_url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/14","id":666948564,"node_id":"MDEyOklzc3VlQ29tbWVudDY2Njk0ODU2NA==","user":{"login":"hafsabukhary","id":16378547,"node_id":"MDQ6VXNlcjE2Mzc4NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/16378547?v=4","gravatar_id":"","url":"https://api.github.com/users/hafsabukhary","html_url":"https://github.com/hafsabukhary","followers_url":"https://api.github.com/users/hafsabukhary/followers","following_url":"https://api.github.com/users/hafsabukhary/following{/other_user}","gists_url":"https://api.github.com/users/hafsabukhary/gists{/gist_id}","starred_url":"https://api.github.com/users/hafsabukhary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hafsabukhary/subscriptions","organizations_url":"https://api.github.com/users/hafsabukhary/orgs","repos_url":"https://api.github.com/users/hafsabukhary/repos","events_url":"https://api.github.com/users/hafsabukhary/events{/privacy}","received_events_url":"https://api.github.com/users/hafsabukhary/received_events","type":"User","site_admin":false},"created_at":"2020-07-31T06:17:09Z","updated_at":"2020-07-31T06:17:09Z","author_association":"NONE","body":"I am reloading German model and training on my own dataset. I have vocab size 50000\r\nWhen I start training it does not complete set number of epochs it silently finishes like mentioned above. \r\n`Loading dataset from tests/german-encoded\r\nTrain dataset has 806,414 tokens\r\nValidation dataset has 210,954 tokens\r\n135,790 \"sentences\" found for sampling\r\n34,354 \"sentences\" found for sampling\r\nResuming from seen_tokens 11,962,060,800\r\nepochs:   0% 0/10 [00:00<?, ?it/s]`\r\n\r\nI set max-tokens  15,962,060,800\r\nBut it still stops at 21%\r\nMy code\r\n`%%shell\r\ngpt-2 \\\r\n    tests/de345-root/ \\\r\n    tests/german-encoded \\\r\n    tests/de345-root/sp-model.model \\\r\n    --batch-size 3 \\\r\n    --g-accum-gradients 1 \\\r\n    --gradient_checkpointing 1\\\r\n    --n-ctx 1024 \\\r\n    --n-embed 1024 \\\r\n    --n-hidden 1024 \\\r\n    --n-head 16 \\\r\n    --n-layer 24 \\\r\n    --epochs 10 \\\r\n    --log-every 2 \\\r\n    --save-every 50 \\\r\n    --validate-every 100 \\\r\n    --sample-sentences \\\r\n    --max_tokens 15,962,060,800\\`","reactions":{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/666948564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hafsabukhary","id":16378547,"node_id":"MDQ6VXNlcjE2Mzc4NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/16378547?v=4","gravatar_id":"","url":"https://api.github.com/users/hafsabukhary","html_url":"https://github.com/hafsabukhary","followers_url":"https://api.github.com/users/hafsabukhary/followers","following_url":"https://api.github.com/users/hafsabukhary/following{/other_user}","gists_url":"https://api.github.com/users/hafsabukhary/gists{/gist_id}","starred_url":"https://api.github.com/users/hafsabukhary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hafsabukhary/subscriptions","organizations_url":"https://api.github.com/users/hafsabukhary/orgs","repos_url":"https://api.github.com/users/hafsabukhary/repos","events_url":"https://api.github.com/users/hafsabukhary/events{/privacy}","received_events_url":"https://api.github.com/users/hafsabukhary/received_events","type":"User","site_admin":false}}]