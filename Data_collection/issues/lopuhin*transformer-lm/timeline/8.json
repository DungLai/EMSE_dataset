[{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/508739862","html_url":"https://github.com/lopuhin/transformer-lm/issues/8#issuecomment-508739862","issue_url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/8","id":508739862,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODczOTg2Mg==","user":{"login":"lopuhin","id":424613,"node_id":"MDQ6VXNlcjQyNDYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/424613?v=4","gravatar_id":"","url":"https://api.github.com/users/lopuhin","html_url":"https://github.com/lopuhin","followers_url":"https://api.github.com/users/lopuhin/followers","following_url":"https://api.github.com/users/lopuhin/following{/other_user}","gists_url":"https://api.github.com/users/lopuhin/gists{/gist_id}","starred_url":"https://api.github.com/users/lopuhin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lopuhin/subscriptions","organizations_url":"https://api.github.com/users/lopuhin/orgs","repos_url":"https://api.github.com/users/lopuhin/repos","events_url":"https://api.github.com/users/lopuhin/events{/privacy}","received_events_url":"https://api.github.com/users/lopuhin/received_events","type":"User","site_admin":false},"created_at":"2019-07-05T12:16:32Z","updated_at":"2019-07-05T12:16:32Z","author_association":"OWNER","body":"> corpus is 433MB of articles (scraped from twitter) - is this enough/too little/too much?\r\n\r\nThat's a good start I think. GPT-2 was trained on a much much larger corpus, but 500MB should already be ok.\r\n\r\n> I am currently at epoch 31 - loss is decreasing very very slowly, currently at 6.7 - is this to be expected?\r\n\r\nThis looks a bit odd. Sorry for asking, but are you sure it's epoch 31? I don't remember that training code reported number of epochs, could it be something else? Also loss 6.7 looks high. For reference, below I'm showing some learning curves for a Russian corpora of around 4 GB of texts, with 16k or 50k vocab size, on X axis is number of tokens x 1e9, and on Y is loss, so it's much lower.\r\n\r\n<img width=\"729\" alt=\"Screenshot 2019-07-05 at 15 08 36\" src=\"https://user-images.githubusercontent.com/424613/60721810-cba33800-9f37-11e9-8b93-afe461d947ea.png\">\r\n\r\n\r\n> I am using gpt-2-tf-train - is this expected to work or should I switch to the torch one for better/faster results?\r\n\r\nIt's expected to work with a similar speed to pytorch one, pytorch one is a bit better developed and I plan to update only it, leaving TF as it is. For example, there is a web UI for pytorch one but not for TF, and probably more features related to training as well.","reactions":{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/508739862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lopuhin","id":424613,"node_id":"MDQ6VXNlcjQyNDYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/424613?v=4","gravatar_id":"","url":"https://api.github.com/users/lopuhin","html_url":"https://github.com/lopuhin","followers_url":"https://api.github.com/users/lopuhin/followers","following_url":"https://api.github.com/users/lopuhin/following{/other_user}","gists_url":"https://api.github.com/users/lopuhin/gists{/gist_id}","starred_url":"https://api.github.com/users/lopuhin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lopuhin/subscriptions","organizations_url":"https://api.github.com/users/lopuhin/orgs","repos_url":"https://api.github.com/users/lopuhin/repos","events_url":"https://api.github.com/users/lopuhin/events{/privacy}","received_events_url":"https://api.github.com/users/lopuhin/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/508858709","html_url":"https://github.com/lopuhin/transformer-lm/issues/8#issuecomment-508858709","issue_url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/8","id":508858709,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODg1ODcwOQ==","user":{"login":"gooofy","id":6418859,"node_id":"MDQ6VXNlcjY0MTg4NTk=","avatar_url":"https://avatars.githubusercontent.com/u/6418859?v=4","gravatar_id":"","url":"https://api.github.com/users/gooofy","html_url":"https://github.com/gooofy","followers_url":"https://api.github.com/users/gooofy/followers","following_url":"https://api.github.com/users/gooofy/following{/other_user}","gists_url":"https://api.github.com/users/gooofy/gists{/gist_id}","starred_url":"https://api.github.com/users/gooofy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gooofy/subscriptions","organizations_url":"https://api.github.com/users/gooofy/orgs","repos_url":"https://api.github.com/users/gooofy/repos","events_url":"https://api.github.com/users/gooofy/events{/privacy}","received_events_url":"https://api.github.com/users/gooofy/received_events","type":"User","site_admin":false},"created_at":"2019-07-05T20:44:42Z","updated_at":"2019-07-05T20:44:42Z","author_association":"CONTRIBUTOR","body":"hey, thanks for the quick and detailed reply, appreciate it! :)\r\n\r\n> This looks a bit odd. Sorry for asking, but are you sure it's epoch 31? I don't remember that training code reported number of epochs, could it be something else? \r\n\r\nmaybe I am confused here already :o) this is what I am currently looking at:\r\n\r\nepoch 31:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                          | 10338/16914 [1:59:03<54:54,  2.00it/s, step=686900, loss=6.81, avg=6.74]\r\n\r\n(I did a run of 3 epochs before this one hence I guess this is epoch 34 now). maybe this is different from the torch version of the training code (I will give that one a try very soon)\r\n\r\nvocab size is 50k - but when I just checked it I noticed my text corpus could definitely need some cleanup, this is what I will work on now before I start another run.\r\n\r\nfor reference, here is what train + valid loss look like in tensorboard:\r\n\r\n![gpt2_loss](https://user-images.githubusercontent.com/6418859/60744094-a4b72700-9f74-11e9-83f0-451a3c28e84a.png)\r\n\r\nso I guess I am at 1.4e9 tokens now - and I should expect the loss to be much lower at this point.\r\n\r\nonce again thanks for all those hints, that should help me with my next steps. I will report when I have new results. If you notice anything in the results I have posted above, please let me know :)\r\n","reactions":{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/508858709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gooofy","id":6418859,"node_id":"MDQ6VXNlcjY0MTg4NTk=","avatar_url":"https://avatars.githubusercontent.com/u/6418859?v=4","gravatar_id":"","url":"https://api.github.com/users/gooofy","html_url":"https://github.com/gooofy","followers_url":"https://api.github.com/users/gooofy/followers","following_url":"https://api.github.com/users/gooofy/following{/other_user}","gists_url":"https://api.github.com/users/gooofy/gists{/gist_id}","starred_url":"https://api.github.com/users/gooofy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gooofy/subscriptions","organizations_url":"https://api.github.com/users/gooofy/orgs","repos_url":"https://api.github.com/users/gooofy/repos","events_url":"https://api.github.com/users/gooofy/events{/privacy}","received_events_url":"https://api.github.com/users/gooofy/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/508859342","html_url":"https://github.com/lopuhin/transformer-lm/issues/8#issuecomment-508859342","issue_url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/8","id":508859342,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODg1OTM0Mg==","user":{"login":"lopuhin","id":424613,"node_id":"MDQ6VXNlcjQyNDYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/424613?v=4","gravatar_id":"","url":"https://api.github.com/users/lopuhin","html_url":"https://github.com/lopuhin","followers_url":"https://api.github.com/users/lopuhin/followers","following_url":"https://api.github.com/users/lopuhin/following{/other_user}","gists_url":"https://api.github.com/users/lopuhin/gists{/gist_id}","starred_url":"https://api.github.com/users/lopuhin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lopuhin/subscriptions","organizations_url":"https://api.github.com/users/lopuhin/orgs","repos_url":"https://api.github.com/users/lopuhin/repos","events_url":"https://api.github.com/users/lopuhin/events{/privacy}","received_events_url":"https://api.github.com/users/lopuhin/received_events","type":"User","site_admin":false},"created_at":"2019-07-05T20:48:18Z","updated_at":"2019-07-05T20:48:18Z","author_association":"OWNER","body":"Thanks for posting the curves - looks like it's indeed epoch 31, and the curves suggest that either it's some bug in tf training code, or a sub-optimal learning rate (too high?).","reactions":{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/508859342/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lopuhin","id":424613,"node_id":"MDQ6VXNlcjQyNDYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/424613?v=4","gravatar_id":"","url":"https://api.github.com/users/lopuhin","html_url":"https://github.com/lopuhin","followers_url":"https://api.github.com/users/lopuhin/followers","following_url":"https://api.github.com/users/lopuhin/following{/other_user}","gists_url":"https://api.github.com/users/lopuhin/gists{/gist_id}","starred_url":"https://api.github.com/users/lopuhin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lopuhin/subscriptions","organizations_url":"https://api.github.com/users/lopuhin/orgs","repos_url":"https://api.github.com/users/lopuhin/repos","events_url":"https://api.github.com/users/lopuhin/events{/privacy}","received_events_url":"https://api.github.com/users/lopuhin/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/508860945","html_url":"https://github.com/lopuhin/transformer-lm/issues/8#issuecomment-508860945","issue_url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/8","id":508860945,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODg2MDk0NQ==","user":{"login":"gooofy","id":6418859,"node_id":"MDQ6VXNlcjY0MTg4NTk=","avatar_url":"https://avatars.githubusercontent.com/u/6418859?v=4","gravatar_id":"","url":"https://api.github.com/users/gooofy","html_url":"https://github.com/gooofy","followers_url":"https://api.github.com/users/gooofy/followers","following_url":"https://api.github.com/users/gooofy/following{/other_user}","gists_url":"https://api.github.com/users/gooofy/gists{/gist_id}","starred_url":"https://api.github.com/users/gooofy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gooofy/subscriptions","organizations_url":"https://api.github.com/users/gooofy/orgs","repos_url":"https://api.github.com/users/gooofy/repos","events_url":"https://api.github.com/users/gooofy/events{/privacy}","received_events_url":"https://api.github.com/users/gooofy/received_events","type":"User","site_admin":false},"created_at":"2019-07-05T20:58:11Z","updated_at":"2019-07-05T20:58:11Z","author_association":"CONTRIBUTOR","body":"thanks again for the quick reply! :))\r\n\r\nok, I will definitely try torch training next (working on that setup right now :) )\r\n\r\nI was suspicious about learning rate settings - I did not specify anything here, what lr would you recommend?","reactions":{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/508860945/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gooofy","id":6418859,"node_id":"MDQ6VXNlcjY0MTg4NTk=","avatar_url":"https://avatars.githubusercontent.com/u/6418859?v=4","gravatar_id":"","url":"https://api.github.com/users/gooofy","html_url":"https://github.com/gooofy","followers_url":"https://api.github.com/users/gooofy/followers","following_url":"https://api.github.com/users/gooofy/following{/other_user}","gists_url":"https://api.github.com/users/gooofy/gists{/gist_id}","starred_url":"https://api.github.com/users/gooofy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gooofy/subscriptions","organizations_url":"https://api.github.com/users/gooofy/orgs","repos_url":"https://api.github.com/users/gooofy/repos","events_url":"https://api.github.com/users/gooofy/events{/privacy}","received_events_url":"https://api.github.com/users/gooofy/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/508861374","html_url":"https://github.com/lopuhin/transformer-lm/issues/8#issuecomment-508861374","issue_url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/8","id":508861374,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODg2MTM3NA==","user":{"login":"lopuhin","id":424613,"node_id":"MDQ6VXNlcjQyNDYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/424613?v=4","gravatar_id":"","url":"https://api.github.com/users/lopuhin","html_url":"https://github.com/lopuhin","followers_url":"https://api.github.com/users/lopuhin/followers","following_url":"https://api.github.com/users/lopuhin/following{/other_user}","gists_url":"https://api.github.com/users/lopuhin/gists{/gist_id}","starred_url":"https://api.github.com/users/lopuhin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lopuhin/subscriptions","organizations_url":"https://api.github.com/users/lopuhin/orgs","repos_url":"https://api.github.com/users/lopuhin/repos","events_url":"https://api.github.com/users/lopuhin/events{/privacy}","received_events_url":"https://api.github.com/users/lopuhin/received_events","type":"User","site_admin":false},"created_at":"2019-07-05T21:00:49Z","updated_at":"2019-07-05T21:00:49Z","author_association":"OWNER","body":"For pytorch code, I hope that default learning rate should be a good start, but I'll double-check parameters of the runs I referenced above tomorrow.","reactions":{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/508861374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lopuhin","id":424613,"node_id":"MDQ6VXNlcjQyNDYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/424613?v=4","gravatar_id":"","url":"https://api.github.com/users/lopuhin","html_url":"https://github.com/lopuhin","followers_url":"https://api.github.com/users/lopuhin/followers","following_url":"https://api.github.com/users/lopuhin/following{/other_user}","gists_url":"https://api.github.com/users/lopuhin/gists{/gist_id}","starred_url":"https://api.github.com/users/lopuhin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lopuhin/subscriptions","organizations_url":"https://api.github.com/users/lopuhin/orgs","repos_url":"https://api.github.com/users/lopuhin/repos","events_url":"https://api.github.com/users/lopuhin/events{/privacy}","received_events_url":"https://api.github.com/users/lopuhin/received_events","type":"User","site_admin":false}},{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/508912508","html_url":"https://github.com/lopuhin/transformer-lm/issues/8#issuecomment-508912508","issue_url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/8","id":508912508,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODkxMjUwOA==","user":{"login":"gooofy","id":6418859,"node_id":"MDQ6VXNlcjY0MTg4NTk=","avatar_url":"https://avatars.githubusercontent.com/u/6418859?v=4","gravatar_id":"","url":"https://api.github.com/users/gooofy","html_url":"https://github.com/gooofy","followers_url":"https://api.github.com/users/gooofy/followers","following_url":"https://api.github.com/users/gooofy/following{/other_user}","gists_url":"https://api.github.com/users/gooofy/gists{/gist_id}","starred_url":"https://api.github.com/users/gooofy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gooofy/subscriptions","organizations_url":"https://api.github.com/users/gooofy/orgs","repos_url":"https://api.github.com/users/gooofy/repos","events_url":"https://api.github.com/users/gooofy/events{/privacy}","received_events_url":"https://api.github.com/users/gooofy/received_events","type":"User","site_admin":false},"created_at":"2019-07-06T09:44:03Z","updated_at":"2019-07-06T09:44:03Z","author_association":"CONTRIBUTOR","body":"quick status update: using the torch training code and a cleaned up corpus (which also lead to a much nicer vocab set) things look much better now:\r\n\r\n![torch_412M](https://user-images.githubusercontent.com/6418859/60754565-2c3b7f00-9fe3-11e9-83bf-3e5777bf7e1e.png)\r\n\r\nwill work on a much larger german corpus next\r\n\r\nthanks again for your kind support, helped me a lot!! :)","reactions":{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/508912508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gooofy","id":6418859,"node_id":"MDQ6VXNlcjY0MTg4NTk=","avatar_url":"https://avatars.githubusercontent.com/u/6418859?v=4","gravatar_id":"","url":"https://api.github.com/users/gooofy","html_url":"https://github.com/gooofy","followers_url":"https://api.github.com/users/gooofy/followers","following_url":"https://api.github.com/users/gooofy/following{/other_user}","gists_url":"https://api.github.com/users/gooofy/gists{/gist_id}","starred_url":"https://api.github.com/users/gooofy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gooofy/subscriptions","organizations_url":"https://api.github.com/users/gooofy/orgs","repos_url":"https://api.github.com/users/gooofy/repos","events_url":"https://api.github.com/users/gooofy/events{/privacy}","received_events_url":"https://api.github.com/users/gooofy/received_events","type":"User","site_admin":false}},{"id":2463865435,"node_id":"MDExOkNsb3NlZEV2ZW50MjQ2Mzg2NTQzNQ==","url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/events/2463865435","actor":{"login":"gooofy","id":6418859,"node_id":"MDQ6VXNlcjY0MTg4NTk=","avatar_url":"https://avatars.githubusercontent.com/u/6418859?v=4","gravatar_id":"","url":"https://api.github.com/users/gooofy","html_url":"https://github.com/gooofy","followers_url":"https://api.github.com/users/gooofy/followers","following_url":"https://api.github.com/users/gooofy/following{/other_user}","gists_url":"https://api.github.com/users/gooofy/gists{/gist_id}","starred_url":"https://api.github.com/users/gooofy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gooofy/subscriptions","organizations_url":"https://api.github.com/users/gooofy/orgs","repos_url":"https://api.github.com/users/gooofy/repos","events_url":"https://api.github.com/users/gooofy/events{/privacy}","received_events_url":"https://api.github.com/users/gooofy/received_events","type":"User","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-07-06T09:44:03Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/508912571","html_url":"https://github.com/lopuhin/transformer-lm/issues/8#issuecomment-508912571","issue_url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/8","id":508912571,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODkxMjU3MQ==","user":{"login":"lopuhin","id":424613,"node_id":"MDQ6VXNlcjQyNDYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/424613?v=4","gravatar_id":"","url":"https://api.github.com/users/lopuhin","html_url":"https://github.com/lopuhin","followers_url":"https://api.github.com/users/lopuhin/followers","following_url":"https://api.github.com/users/lopuhin/following{/other_user}","gists_url":"https://api.github.com/users/lopuhin/gists{/gist_id}","starred_url":"https://api.github.com/users/lopuhin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lopuhin/subscriptions","organizations_url":"https://api.github.com/users/lopuhin/orgs","repos_url":"https://api.github.com/users/lopuhin/repos","events_url":"https://api.github.com/users/lopuhin/events{/privacy}","received_events_url":"https://api.github.com/users/lopuhin/received_events","type":"User","site_admin":false},"created_at":"2019-07-06T09:44:56Z","updated_at":"2019-07-06T09:44:56Z","author_association":"OWNER","body":"Wow, that looks nice!! Good luck with the bigger corpus ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/lopuhin/transformer-lm/issues/comments/508912571/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lopuhin","id":424613,"node_id":"MDQ6VXNlcjQyNDYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/424613?v=4","gravatar_id":"","url":"https://api.github.com/users/lopuhin","html_url":"https://github.com/lopuhin","followers_url":"https://api.github.com/users/lopuhin/followers","following_url":"https://api.github.com/users/lopuhin/following{/other_user}","gists_url":"https://api.github.com/users/lopuhin/gists{/gist_id}","starred_url":"https://api.github.com/users/lopuhin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lopuhin/subscriptions","organizations_url":"https://api.github.com/users/lopuhin/orgs","repos_url":"https://api.github.com/users/lopuhin/repos","events_url":"https://api.github.com/users/lopuhin/events{/privacy}","received_events_url":"https://api.github.com/users/lopuhin/received_events","type":"User","site_admin":false}}]